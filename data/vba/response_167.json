[{"tags": ["excel", "string", "vba", "variables", "colors"], "comments": [{"owner": {"reputation": 405, "user_id": 1100554, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dd1c1863bd1c9da58ede1932822cb99e?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/1100554/sam"}, "edited": false, "score": 0, "creation_date": 1521677942, "post_id": 49418275, "comment_id": 85838828, "body": "So, if you know you should use <code>.font.colorindex = ##</code> then just look up the color palette (ex: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/colorindex-property\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>).  Also, are you trying to color the values from the cell before putting them in the email or after?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1521678405, "creation_date": 1521678405, "answer_id": 49418648, "question_id": 49418275, "link": "https://stackoverflow.com/questions/49418275/trying-to-assign-color-to-string-variable-excel-vba/49418648#49418648", "title": "Trying to assign color to string variable (Excel VBA)", "body": "<p>You just need to generate a simple HTML element to wrap around the value then insert the whole thing into the text string.</p>\n\n<pre><code>dim strExtractedText as string\n\nstrExtractedText = \"&lt;font style='color:red'&gt;\" &amp; Sheet1.Cells(2, 1).value &amp; \"&lt;/font&gt;\"\n\n...\n.HTMLBody = \"This is an automated message generated from an Excel macro.&lt;p&gt;Info 1 \" &amp; strExtractedText &amp; \" Info 2: \" &amp; Sheet1.Cells(2, 2) &amp; \" Info 3 \" &amp; Sheet1.Cells(2, 3) &amp; \".  Please see attached.\"\n...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9531632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93038f7e9aeda9423315b1db8f94cc92?s=128&d=identicon&r=PG&f=1", "display_name": "Fosphor", "link": "https://stackoverflow.com/users/9531632/fosphor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521678405, "creation_date": 1521675708, "question_id": 49418275, "link": "https://stackoverflow.com/questions/49418275/trying-to-assign-color-to-string-variable-excel-vba", "title": "Trying to assign color to string variable (Excel VBA)", "body": "<p>I'm utilizing excel to gather, format, and email info to other users.  I'd like to format the information that is generated by this code with a different color to make it stand out.  I'm aware of \".Font.colorindex = ??\", but am not familiar enough with the intracasies of variable types to get what I'm trying to make function...</p>\n\n<p>Example:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim outlookApp As Outlook.Application\nDim outlookMail As Outlook.MailItem\nDim ExtractedText As String\n\nSet outlookApp = New Outlook.Application\nSet outlookMail = outlookApp.CreateItem(olMailItem)\n\nWith outlookMail\n\n    .To = \"person@company.com\"\n    .CC = \"\"\n    .BCC = \"\"\n\n    .Subject = \"This is a test email automated by excel\"\n    .BodyFormat = olFormatHTML\n    .HTMLBody = \"This is an automated message generated from an Excel macro.&lt;p&gt;Info 1 \" &amp; Sheet1.Cells(2, 1) &amp; \" Info 2: \" &amp; Sheet1.Cells(2, 2) &amp; \" Info 3 \" &amp; Sheet1.Cells(2, 3) &amp; \".  Please see attached.\"\n    .Attachments.Add \"C:\\Users\\xyz\\Desktop\\Test Attachment.xlsx\"\n    .Importance = olImportanceHigh\n    .Send\n\nEnd With\n\nSet outlookMail = Nothing\nSet outlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I would like to define \"ExtractedText\" as Cell(2, 1), set a color to it and insert it into the body of the email in place of \"Sheet1.Cells(2, 1)\" used above. I've spent a few hours searching and trying different approaches with litrtle to show for it.  While wait for my order of VBA coding books to arrive, I thought I'd ask the community.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521676918, "post_id": 49418259, "comment_id": 85838594, "body": "If it is a CSV in Excel, <code>Activesheet.UsedRange.Rows.Count</code>"}, {"owner": {"reputation": 1, "user_id": 9531618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fa8026068727f2eb5ca904728631d2?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Gallatin", "link": "https://stackoverflow.com/users/9531618/chris-gallatin"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521682056, "post_id": 49418259, "comment_id": 85839670, "body": "Plugged that formula into my macro to see what it would do, if anything and it threw an error. I am looking for it to automatically enter a number in a cell somewhere on my spreadsheet that tells how many records (rows) are in the spreadsheet. Then I need to grab those rows in one of the columns."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521683086, "post_id": 49418259, "comment_id": 85839883, "body": "You did ask for VBA right (for part A)? Or are you just looking at basic Excel formula something like <code>=COUNTA(A:A)</code>? There are many ways to determine the last row."}, {"owner": {"reputation": 1, "user_id": 9531618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fa8026068727f2eb5ca904728631d2?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Gallatin", "link": "https://stackoverflow.com/users/9531618/chris-gallatin"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521685192, "post_id": 49418259, "comment_id": 85840422, "body": "Yes, please. VBA for both parts a and b. I am trying to speed up with the macro what will be a very painstaking process on a weekly basis. My VBA knowledge was last put to use in 2014.. If you don&#39;t use it, you lose it.."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9531618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fa8026068727f2eb5ca904728631d2?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Gallatin", "link": "https://stackoverflow.com/users/9531618/chris-gallatin"}, "edited": false, "score": 0, "creation_date": 1521739546, "post_id": 49419595, "comment_id": 85871572, "body": "I appreciate you taking the time to answer my query here. I haven&#39;t had any luck with that code though. As I mentioned, &quot; I am looking for it to automatically ENTER A NUMBER IN A CELL  somewhere on my spreadsheet that tells how many records (rows) are in the spreadsheet.&quot;"}, {"owner": {"reputation": 1, "user_id": 9531618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fa8026068727f2eb5ca904728631d2?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Gallatin", "link": "https://stackoverflow.com/users/9531618/chris-gallatin"}, "edited": false, "score": 0, "creation_date": 1521740482, "post_id": 49419595, "comment_id": 85872162, "body": "Okay, I solved that with an ActiveCell.FormulaR1C1 = lRows statement."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1521685933, "creation_date": 1521685933, "answer_id": 49419595, "question_id": 49418259, "link": "https://stackoverflow.com/questions/49418259/vba-generating-data-totals-in-a-dynamically-changing-excel-sheet/49419595#49419595", "title": "VBA: Generating data totals in a dynamically changing Excel sheet", "body": "<p>Your part A (using column G on active sheet as example), replace <code>ActiveSheet</code> with <code>Worksheets(\"Your worksheet name\")</code></p>\n\n<pre><code>Dim lRows As Long, lLastRow As Long\n\nlLastRow = ActiveSheet.Cells(Rows.Count,\"G\").End(xlUp).Row\nlRows = lLastRow - 1 ' Less the header row\n</code></pre>\n\n<p>Part B will be your task, some hint here.</p>\n\n<pre><code>Dim lLastCol As Long\nlLastCol = ActiveSheet.Cells(1,Columns.Count).End(xlToLeft).Column\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9531618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96fa8026068727f2eb5ca904728631d2?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Gallatin", "link": "https://stackoverflow.com/users/9531618/chris-gallatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1521685933, "creation_date": 1521675606, "last_edit_date": 1592644375, "question_id": 49418259, "link": "https://stackoverflow.com/questions/49418259/vba-generating-data-totals-in-a-dynamically-changing-excel-sheet", "title": "VBA: Generating data totals in a dynamically changing Excel sheet", "body": "<p>In a spreadsheet that has raw data generated from a .CSV file, I end up with 5 columns of data. There could be 300 rows or 354. It always changes. I can't come up with a way to (in a macro):\nA) calculate how many rows of data are in the spreadsheet. (Use that number for calculating medians and averages)\nB) Select each column and automatically calculate the median number.</p>\n<p><a href=\"https://i.stack.imgur.com/r4u6x.jpg\" rel=\"nofollow noreferrer\">sample of data</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521675715, "post_id": 49418211, "comment_id": 85838252, "body": "Open Name Manager and create one with that path."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1521677380, "post_id": 49418304, "comment_id": 85838705, "body": "Or a custom xml part"}], "tags": [], "owner": {"reputation": 1157, "user_id": 3505188, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zm9V5.jpg?s=128&g=1", "display_name": "Patrick Wynne", "link": "https://stackoverflow.com/users/3505188/patrick-wynne"}, "is_accepted": true, "score": 1, "last_activity_date": 1521675845, "creation_date": 1521675845, "answer_id": 49418304, "question_id": 49418211, "link": "https://stackoverflow.com/questions/49418211/is-there-another-way-to-store-folder-path-in-excel-vba-than-using-sheets/49418304#49418304", "title": "Is there another way to store Folder Path in EXCEL VBA than using Sheets?", "body": "<p>You can store it in a Custom Document Property.</p>\n\n<p>Or in a Name using the Name Manager.</p>\n\n<p>Or in a cell of a hidden Worksheet.</p>\n"}], "owner": {"reputation": 69, "user_id": 7950199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154605469197947/picture?type=large", "display_name": "Raphael Yaghdjian", "link": "https://stackoverflow.com/users/7950199/raphael-yaghdjian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1521721949, "accepted_answer_id": 49418304, "answer_count": 1, "score": 0, "last_activity_date": 1521682871, "creation_date": 1521675307, "last_edit_date": 1531164843, "question_id": 49418211, "link": "https://stackoverflow.com/questions/49418211/is-there-another-way-to-store-folder-path-in-excel-vba-than-using-sheets", "closed_reason": "Not suitable for this site", "title": "Is there another way to store Folder Path in EXCEL VBA than using Sheets?", "body": "<p>I have an excel VBA project that uses ADODB and manipulates data in an ACCDB.</p>\n\n<p>I know that you can store the path for the ACCDB in a cell of the excel sheet. However I would like to know: Is there another way to store the path rather than in the sheet?</p>\n\n<p>I know that if I store it in a variable, when the program closes it releases the variable.</p>\n\n<p>If you ask me why I want this, it's more because I want the code not being too dependent in the front-end of the excel, as some unskilled people will also use this project.</p>\n\n<p>Perhaps there is a more professional or known way to store folder or file paths?</p>\n"}, {"tags": ["vba", "excel", "pivot"], "answers": [{"comments": [{"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "edited": false, "score": 0, "creation_date": 1521762867, "post_id": 49418366, "comment_id": 85882590, "body": "If you deem this as the answer, please mark as Answered so people would still think you are trying to solve"}, {"owner": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "edited": false, "score": 0, "creation_date": 1521814779, "post_id": 49418366, "comment_id": 85905956, "body": "Hey thanks for your help! I&#39;m still getting an error though. It works perfectly for the first pivot table, but then I get an error: &quot;Run-time error &#39;1004&#39;: Method &#39;PivotItems&#39; of object &#39;PivotField&#39; failed&quot;.  I tried to search for a solution, but haven&#39;t been able to figure it out. One person suggested using this code to clear the pivot cache. It didn&#39;t cause any new problems, but didn&#39;t solve my issue either:  I also tried changing the data source to use R1C1 notation."}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "reply_to_user": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "edited": false, "score": 0, "creation_date": 1521814967, "post_id": 49418366, "comment_id": 85906114, "body": "Is there a \u201c(blank)\u201d in the second pivot table? If not then add the Error catch (see edit) if there are no blanks in the pivot table the macro can\u2019t hide them since they don\u2019t exist. If you catch the Error then it will ignore those pivot tables without the blank value"}, {"owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "reply_to_user": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "edited": false, "score": 0, "creation_date": 1521999529, "post_id": 49418366, "comment_id": 85960414, "body": "If this was the correct answer, please mark as answered so other users will know this is closed"}, {"owner": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "edited": false, "score": 0, "creation_date": 1522088867, "post_id": 49418366, "comment_id": 86000375, "body": "That did it. Thanks for the help!"}], "tags": [], "owner": {"reputation": 631, "user_id": 8036406, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m0Scf8dNQ_c/AAAAAAAAAAI/AAAAAAAAEQs/DiQc1axnLXc/photo.jpg?sz=128", "display_name": "Dude_Scott", "link": "https://stackoverflow.com/users/8036406/dude-scott"}, "is_accepted": true, "score": 4, "last_activity_date": 1521815139, "last_edit_date": 1521815139, "creation_date": 1521676311, "answer_id": 49418366, "question_id": 49418194, "link": "https://stackoverflow.com/questions/49418194/i-have-a-macro-to-refresh-all-pivot-tables-in-my-workbook-i-need-to-add-code-to/49418366#49418366", "title": "I have a macro to refresh all pivot tables in my workbook, I need to add code to remove (blanks)&#39;s", "body": "<p>Try this. Basically just added the loop through each of the Pivot Fields</p>\n\n<pre><code>Sub RefreshAllPivotTables()\n\nDim PT As PivotTable\nDim WS As Worksheet\nDim PF As PivotField\n\n    For Each WS In ThisWorkbook.Worksheets\n        For Each PT In WS.PivotTables\n            PT.RefreshTable\n            For Each PF In PT.PivotFields\n                On Error Resume Next\n                PF.PivotItems(\"(blank)\").Visible = False\n            Next PF\n        Next PT\n    Next WS\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9531470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f553627979dce8cbcd6f1d7afdb4e4b?s=128&d=identicon&r=PG&f=1", "display_name": "jashad2", "link": "https://stackoverflow.com/users/9531470/jashad2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2764, "favorite_count": 0, "accepted_answer_id": 49418366, "answer_count": 1, "score": 2, "last_activity_date": 1521815139, "creation_date": 1521675206, "last_edit_date": 1521703077, "question_id": 49418194, "link": "https://stackoverflow.com/questions/49418194/i-have-a-macro-to-refresh-all-pivot-tables-in-my-workbook-i-need-to-add-code-to", "title": "I have a macro to refresh all pivot tables in my workbook, I need to add code to remove (blanks)&#39;s", "body": "<p>I have a workbook with multiple pivot tables throughout. I have found some code that works for refreshing all of my pivot tables at once (assigned to a button). But in order for the rest of my calculations to work, I currently have to go to each table and deselect (blank) from the Row Labels filter.</p>\n\n<p>I've tried many options to add code that will also filter out the blanks, but can't seem to get the syntax right.</p>\n\n<p>Here's what I'm currently using to refresh all of my pivot tables; what do I need to add to filter the blanks as well?</p>\n\n<pre><code>Sub RefreshAllPivotTables()\n    Dim PT As PivotTable\n    Dim WS As Worksheet\n\n    For Each WS In ThisWorkbook.Worksheets\n        For Each PT In WS.PivotTables\n            PT.RefreshTable\n        Next PT\n    Next WS\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1521708645, "creation_date": 1521708645, "answer_id": 49424151, "question_id": 49418141, "link": "https://stackoverflow.com/questions/49418141/print-the-value-in-next-line-once-it-reached-6th-cell-value-in-excel-using-vba/49424151#49424151", "title": "Print the value in next line once it reached 6th cell value in excel using VBA", "body": "<p>I doubt this code has run ever. </p>\n\n<p>No need for Do loop. BTW While condition is wrong as you compare a range with an int. </p>\n\n<p>Print command prints entire line including crlf, so the line should be assembled in another way, like this: </p>\n\n<pre><code>For i = 1 To LastRow\n        sOut = vbNullString\n        For j = 1 To LastCol\n            str = .Cells(i, j).Value\n            MStr = ws2.Cells(i, j).Value\n            Lstr = Len(str)\n            rest = MStr - Lstr\n            sOut = sOut &amp; str &amp; Space(rest)\n        Next\n        Print #2, sOut\n    Next\nNext\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 49424151, "answer_count": 1, "score": 0, "last_activity_date": 1521708645, "creation_date": 1521674816, "last_edit_date": 1521693317, "question_id": 49418141, "link": "https://stackoverflow.com/questions/49418141/print-the-value-in-next-line-once-it-reached-6th-cell-value-in-excel-using-vba", "title": "Print the value in next line once it reached 6th cell value in excel using VBA", "body": "<p>I am new to VBA.</p>\n\n<p>I have an excel sheet,\n<code>Sheet1</code> contains values <code>6 * 6</code> matrix with values\nVariables in each cell </p>\n\n<p><img src=\"https://i.stack.imgur.com/2PAPj.jpg\" alt=\"enter image description here\"></p>\n\n<p><code>Sheet2</code> contains Maximum Character length <code>6* 6</code> matrix of each values in <code>Sheet1</code>\nMaximum Character length of each values in <code>sheet1</code> </p>\n\n<p><img src=\"https://i.stack.imgur.com/3NpbT.jpg\" alt=\"enter image description here\"></p>\n\n<p>I tried to create a notepad and print the values which is in Sheet1 and place the cursor based on the maximum character length.</p>\n\n<p>For Example: In sheet1, Value \"First Message\" as 13 character so it compare the Sheet2 same row and column as Maximum character length(30) and print in notepad, it should have 17 character length should be empty in notepad. As the same it has to print the same next values in the notepad in the same line which has to start from 31st character. \nFinally at every 1st row 6th column, it has to go to newline and start from 1st character position.</p>\n\n<p>Below is my piece of code, Kindly help me to print in the notepad.</p>\n\n<pre><code>Sub myself()\n\nDim str As String\nDim MaxStrLen As String\nDim rest As Integer\nDim Lstr As Integer\nDim LMstr As Integer\nDim MStr As Integer\nDim LR As Range\nDim CNT As Integer\n\nDim LastRow As Long\nDim LastCol As Long\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim i As Long\nDim j As Long\nDim h As Long\n\nDim FilePath As String\n\nSet ws1 = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\n\n\nOpen \"C:\\Users\\Antony\\Desktop\\test.txt\" For Output As #2\n\n\nh = 1\n\nWith ws1\n    LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\nDo\n    For i = 1 To LastRow\n        For j = 1 To LastCol\n\n            str = .Cells(i, j).Value\n            MStr = ws2.Cells(i, j).Value\n\n                Lstr = Len(str)\n\n            rest = MStr - Lstr\n            Set LR = .Range(.Cells(i, j), .Cells(i, LastCol))\n            'CNT = ActiveSheet.UsedRange.Count\n\n\n Print #2, str &amp; Space(rest)\n            If j = Lastcolumn Then\n            Print #2, vbNewLine\n\n                    Else: End If\n\n            Next\n        Next\n\n    Loop While LR &lt;= LastRow\n\nEnd With\n\n\nClose #2\n\nEnd Sub\n</code></pre>\n\n<p>Really appreciate your effort in this.</p>\n"}, {"tags": ["vba", "excel", "powerquery"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1521686116, "post_id": 49418017, "comment_id": 85840662, "body": "<code>.ListObjects(&quot;mylist&quot;).Range</code>?"}, {"owner": {"reputation": 170, "user_id": 4221011, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-qPQKMMbAg3k/AAAAAAAAAAI/AAAAAAAAAn8/BiIbI_tGzmw/photo.jpg?sz=128", "display_name": "rellik", "link": "https://stackoverflow.com/users/4221011/rellik"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521753863, "post_id": 49418017, "comment_id": 85879381, "body": "Hi @PatricK Thank you. yes, this would work but my list is filtered, .Rnage copy the whole table but not what visible/filtered"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521757973, "post_id": 49418017, "comment_id": 85880994, "body": "I was just hinting the Range object instead of DataBodyRange, try <code>.ListObjects(&quot;mylist&quot;).Range.SpecialCells(xlCellTypeVisible)</code>"}], "owner": {"reputation": 170, "user_id": 4221011, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-qPQKMMbAg3k/AAAAAAAAAAI/AAAAAAAAAn8/BiIbI_tGzmw/photo.jpg?sz=128", "display_name": "rellik", "link": "https://stackoverflow.com/users/4221011/rellik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521683940, "creation_date": 1521674164, "last_edit_date": 1521683940, "question_id": 49418017, "link": "https://stackoverflow.com/questions/49418017/what-is-the-equivalent-of-set-rng-sheetssheet1-pivottables1-tablerange1", "title": "what is the equivalent of Set rng = Sheets(&quot;Sheet1&quot;).PivotTables(1).TableRange1 for working with Power Query Table", "body": "<p>I have used a Pivot table and using vba</p>\n\n<pre><code>Set rng = Sheets(\"Sheet1\").PivotTables(1).TableRange1\n</code></pre>\n\n<p>to select the range and copy the selected range in to an outlook object to be send as an email.</p>\n\n<p>is there an equivalent code to use with power query?</p>\n\n<p>i have limited success with </p>\n\n<pre><code>Set rng = Sheets(\"sheet1\").ListObjects(\"mylist\").DataBodyRange.SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>as this does not copy column headers</p>\n\n<p>how do i use the same or similar code to use with a power query?\nThanks</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1521701473, "post_id": 49418009, "comment_id": 85845261, "body": "Create a function that is able to parse your recordings. Then use this in a query, or open the table as a recordset in VBA and search."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521715688, "post_id": 49418009, "comment_id": 85854250, "body": "Your IP field is multivalue? or users can type several IP Addresses, separating values by commas? Also, post the code/design you have tried until now"}, {"owner": {"reputation": 33, "user_id": 9437228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58352407bf86bdd46ccd3b1c5afc4b?s=128&d=identicon&r=PG&f=1", "display_name": "k.bratt", "link": "https://stackoverflow.com/users/9437228/k-bratt"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521744238, "post_id": 49418009, "comment_id": 85874351, "body": "@Foxfire And Burns And Burns users are asked to potentially list several IP&#39;s, separated by commas. Found an article that helped me sort out part of the issue; I&#39;ve successfully sorted out how to search for an entire IP within a list. In the query builder, I&#39;ve created 4 extra columns to parse out and sort (ascending) the individual bits of the IP, then just use a form&#39;s text box as criteria to search:"}, {"owner": {"reputation": 33, "user_id": 9437228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58352407bf86bdd46ccd3b1c5afc4b?s=128&d=identicon&r=PG&f=1", "display_name": "k.bratt", "link": "https://stackoverflow.com/users/9437228/k-bratt"}, "edited": false, "score": 0, "creation_date": 1521744614, "post_id": 49418009, "comment_id": 85874557, "body": "The problem I&#39;m having now is that I get errors when I add additional criteria for other fields. Access returns the expression is too complex to evaluate."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522064502, "post_id": 49418009, "comment_id": 85984153, "body": "Can you post some example data?"}], "owner": {"reputation": 33, "user_id": 9437228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe58352407bf86bdd46ccd3b1c5afc4b?s=128&d=identicon&r=PG&f=1", "display_name": "k.bratt", "link": "https://stackoverflow.com/users/9437228/k-bratt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594650795, "creation_date": 1521674062, "last_edit_date": 1594650795, "question_id": 49418009, "link": "https://stackoverflow.com/questions/49418009/search-ip-addresses-in-access-tables", "title": "Search IP Addresses in Access tables", "body": "<p>I have a database with a table that houses many fields which I've successfully created queries to search for, with the exception of IP Addresses. I have been asked, by leadership, to find a way to search by IP Address. This is a HUGE challenge for me... The IP Addresses are currently stored in Text format in the table and using an expression such as:\n<code>Like \"*\" &amp; [Forms]![FormName]![IPAddress] &amp; \"*\" OR [Forms]![FormName]![IPAddress] Is Null</code> returns an error saying the expression is incorrect or too complicated for Access. In some of the IP Address fields, several IP's are listed, separated by a comma (Though I think I'd prefer a semicolon) and need to be able to search for all or portions of any IP in the list.</p>\n\n<p>Help?</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1521685873, "post_id": 49418076, "comment_id": 85840599, "body": "Hey, that&#39;s really slick!  A lot for me to learn in here.  One little typ0:  The <code>Instr(i, customList(i)....</code> should start at <code>1</code>, not <code>i.</code>  It is searching through a string, which has 1 based positioning, not a list, which has 0-based positioning.  Without this change, it will crash if the very first item in the input is non-numeric.  With the change it works great - thank you!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1521687756, "post_id": 49418076, "comment_id": 85841076, "body": "Thanks for catchimg that!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1521687734, "last_edit_date": 1521687734, "creation_date": 1521674445, "answer_id": 49418076, "question_id": 49417771, "link": "https://stackoverflow.com/questions/49417771/enter-comma-separated-list-of-years-year-islands-convert-to-list-of-years-in-v/49418076#49418076", "title": "Enter comma-separated list of years, year islands, convert to list of years in VBA", "body": "<p>This accomplishes what you're looking for but additional error control could be added to ensure no duplication in the year list if that is an issue. Sorting the end result is another option not tackled but there are many examples of a simple array sort.</p>\n\n<pre><code>Sub customYearList()\n    Dim i As Long, mny As Long, mxy As Long, y As Long, customListEntry As String\n    Dim tmp As Variant, customList As Variant, yearList As Variant\n\n    mny = 1946: mxy = 2050\n    customListEntry = InputBox(\"Enter list of years to activate\")\n    'customListEntry = Sheet1.Cells(2, 1).Value\n\n    customList = Split(customListEntry, \",\")\n    ReDim yearList(0)\n    For i = LBound(customList) To UBound(customList)\n        If IsNumeric(customList(i)) Then\n            If CLng(customList(i)) &gt;= mny And CLng(customList(i)) &lt;= mxy Then\n                yearList(UBound(yearList)) = CLng(customList(i))\n                ReDim Preserve yearList(UBound(yearList) + 1)\n            End If\n        ElseIf CBool(InStr(1, customList(i), Chr(45))) Then\n            tmp = Split(customList(i), Chr(45))\n            If IsNumeric(tmp(LBound(tmp))) And IsNumeric(tmp(UBound(tmp))) Then\n                For y = CLng(tmp(LBound(tmp))) To CLng(tmp(UBound(tmp)))\n                    If y &gt;= mny And y &lt;= mxy Then\n                        yearList(UBound(yearList)) = y\n                        ReDim Preserve yearList(UBound(yearList) + 1)\n                    End If\n                Next y\n            End If\n        End If\n    Next i\n    ReDim Preserve yearList(UBound(yearList) - 1)\n\n    Sheet1.Cells(3, \"B\").Resize(1, UBound(yearList) + 1) = yearList\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 49418076, "answer_count": 1, "score": 0, "last_activity_date": 1521687734, "creation_date": 1521672441, "last_edit_date": 1531161705, "question_id": 49417771, "link": "https://stackoverflow.com/questions/49417771/enter-comma-separated-list-of-years-year-islands-convert-to-list-of-years-in-v", "title": "Enter comma-separated list of years, year islands, convert to list of years in VBA", "body": "<p>I am trying to validate a list of years and year ranges into a list of year.  For instance, if the user enters:</p>\n\n<p><code>1946, 1948, cat, 1950-1954, dog, 1960</code></p>\n\n<p>I want VBA to parse this as a list:</p>\n\n<p><code>1946, 1948, 1950, 1951, 1952, 1952, 1953, 1954, 1960</code></p>\n\n<p>I will then use the year to modify specific cells on a worksheet.</p>\n\n<p>I can deal with the cats and dogs easily with by splitting on commas and then validating for numeric values when I use the list:</p>\n\n<pre><code>Sub customYearList\n customListEntry = InputBox(\"Enter list of years to activate\")\n\n customList = Split(customListEntry, \",\")\n\n       For Each cYear In customList\n          If IsNumeric(cYear) Then\n               [[use the year to reference a WS.cell(myRow, cYear) ]]\n          end if\n       Next\nEnd sub\n</code></pre>\n\n<p>I can't figure out how to also catch the dashes, and fill in in between.  Psuedocode for what I am picturing:</p>\n\n<pre><code>if cYear[i] = \"-\"\n    act on all integer values from cYear[i-1] to cYear[i+1]  \n</code></pre>\n\n<p>But my list referencing doesn't even have an index to modify like that.  And there would be some funny looping.</p>\n\n<p>FWIW</p>\n\n<ul>\n<li>valid years will always be between 1946 and 2050.  All of those years are\nlisted in row 13.  </li>\n<li>The end goal is to change to value in row 12, immediately above the year, to a <code>1</code> if the year is in the custom list, or a <code>0</code> if it is not.</li>\n</ul>\n\n<p>I am having trouble searching for this, because I can't think of how to describe it without using the overloaded term \"range\".</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 191, "user_id": 5038071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153423493121948/picture?type=large", "display_name": "Salvador Ruiz Guevara", "link": "https://stackoverflow.com/users/5038071/salvador-ruiz-guevara"}, "edited": false, "score": 0, "creation_date": 1521672642, "post_id": 49417761, "comment_id": 85837291, "body": "It would be very useful if you showed us the errors the code throws up and the line that is causing it"}, {"owner": {"reputation": 45, "user_id": 5629923, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/uQVrQ.jpg?s=128&g=1", "display_name": "Henrique", "link": "https://stackoverflow.com/users/5629923/henrique"}, "reply_to_user": {"reputation": 191, "user_id": 5038071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153423493121948/picture?type=large", "display_name": "Salvador Ruiz Guevara", "link": "https://stackoverflow.com/users/5038071/salvador-ruiz-guevara"}, "edited": false, "score": 0, "creation_date": 1521672852, "post_id": 49417761, "comment_id": 85837373, "body": "I&#39;ve tried a few lines, but this one seemed the most logical throws error 1004   Worksheets(&quot;Sheet2&quot;).Cells(1, counter).Value = Worksheets(&quot;Sheet1&quot;).Cells(27, rw).Value"}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 2, "creation_date": 1521673331, "post_id": 49417761, "comment_id": 85837541, "body": "You are not setting the <code>counter</code> before copying to another sheet, And <code>rw</code> represents a <code>Range</code> so doing <code>Worksheets(&quot;Sheet1&quot;).Cells(27, rw).Value</code> will throw an error"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521704912, "post_id": 49417761, "comment_id": 85846983, "body": "Note: Use <code>Long</code> instead of <code>Integer</code> Excel has more rows than <code>Integer</code> can handle, and there is no benefit at all in using <code>Integer</code> over <code>Long</code> in VBA."}], "answers": [{"tags": [], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "is_accepted": true, "score": 1, "last_activity_date": 1521673702, "creation_date": 1521673702, "answer_id": 49417960, "question_id": 49417761, "link": "https://stackoverflow.com/questions/49417761/copy-specific-cell-to-another-worksheet/49417960#49417960", "title": "Copy specific cell to another worksheet", "body": "<p>Try this:</p>\n\n<pre><code>If month(rw.row) = chomonth Then\n\n    counter = counter + 1\n    Worksheets(\"Sheet2\").Cells(counter, 1).Value = Worksheets(\"Sheet1\").Cells(rw.row, 27).Value\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5629923, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/uQVrQ.jpg?s=128&g=1", "display_name": "Henrique", "link": "https://stackoverflow.com/users/5629923/henrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 49417960, "answer_count": 1, "score": -1, "last_activity_date": 1521673702, "creation_date": 1521672387, "question_id": 49417761, "link": "https://stackoverflow.com/questions/49417761/copy-specific-cell-to-another-worksheet", "title": "Copy specific cell to another worksheet", "body": "<p>This has been driving me crazy and is something that should be easy, but I never touched vba before, so... </p>\n\n<p>I have a for loop iterating on a row searching for matching occurrences, I know the loop is working because I can get an accurate count of the number of matching occurrences. Essentially \"if month = month then counter=counter+1\"</p>\n\n<p>Whenever the loop finds a matching occurrence I need it to copy a specific cell (let's say AA22) to another worksheet, but I cant get it to work, it keeps throwing error codes with super broad and vague descriptions. I've tried a few of the solutions here and a few on other forums, nothing works correctly. Also, it seems every solution works with ranges, I need one that copies cells one by one.\nHere's my code:</p>\n\n<pre><code>Dim chomonth As Integer\n\n   chomonth = InputBox(\"Insira o mes \", \"Inserir dados\")\n\n   Dim counter As Integer\n   Dim rng As Range\n   Dim rw As Range\n   Dim cell As Range\n\n   Set rng = Range(\"S3:S9999\")\n\n    For Each rw In rng.Rows\n\n        If month(rw.row) = chomonth Then\n          //Code that copies AArw to worksheet 2 goes here\n\n        counter = counter + 1\n\n\n\n        End If\n\n    Next rw\n\n    MsgBox (\"Numero de entradas:\" &amp; Count)\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "combobox", "variable-assignment"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521670027, "post_id": 49417298, "comment_id": 85836440, "body": "Is that a multi-select combobox, or a normal combobox?"}, {"owner": {"reputation": 1, "user_id": 7512006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04428aed851b47b19c9752367ca02832?s=128&d=identicon&r=PG&f=1", "display_name": "Biorn Veiro", "link": "https://stackoverflow.com/users/7512006/biorn-veiro"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521715291, "post_id": 49417298, "comment_id": 85853939, "body": "It is a normal combobox. I want to show the first name of an author, where I have the primary key of the authors table available."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1521743130, "post_id": 49417298, "comment_id": 85873754, "body": "Why do you have author name split into two comboboxes? Why not one combobox and save the AuthorID into record? Reference combobox columns by index. Index begins with 0. If value is in column 1, its index is 0; column 2 has index 1, etc. But you can&#39;t &#39;set&#39; the value of combobox Column, you set combobox Value. Remove the Column(1) and default to Value property."}, {"owner": {"reputation": 1, "user_id": 7512006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04428aed851b47b19c9752367ca02832?s=128&d=identicon&r=PG&f=1", "display_name": "Biorn Veiro", "link": "https://stackoverflow.com/users/7512006/biorn-veiro"}, "edited": false, "score": 0, "creation_date": 1521754843, "post_id": 49417298, "comment_id": 85879778, "body": "Thank you for the tip. It works now, but when I used one combobox I could only display one name, so I went back to my original two with first name in one and last name in the other."}], "owner": {"reputation": 1, "user_id": 7512006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04428aed851b47b19c9752367ca02832?s=128&d=identicon&r=PG&f=1", "display_name": "Biorn Veiro", "link": "https://stackoverflow.com/users/7512006/biorn-veiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521725190, "creation_date": 1521669942, "last_edit_date": 1521725190, "question_id": 49417298, "link": "https://stackoverflow.com/questions/49417298/how-can-i-assign-a-value-to-an-access-combobox", "title": "How can I assign a value to an Access Combobox?", "body": "<p>I have a form (FrmAddBookReviews) that is opened when certain events in another form (FrmAddArticles) occur.\nI want to initialize the FrmAddBookReviews with some values from FrmAddArticles. It works fine except for the Author of the book review who I have in 2 comboboxes, where I want to write the first name in one and the last name in the other combobox. I do not want to use an unbound textbox, because I want the value of the primary key of the reviewer to appear in the table belonging to FrmAddBookReviews.\nIf I do (rstauth.Fields(0) is the primary key to TabAuth)</p>\n\n<pre><code>Me!cmbFnam.SetFocus\n  Me!cmbFnam.Selected(1) = True\n  Me.cmbFnam.Column(1) = rstauth.Fields(1).Value\n</code></pre>\n\n<p>I get run time error 424: Object required\nI have tried a DLookup to get the name followed by</p>\n\n<pre><code> Me.cmbFnam.Column(1) = strFnam\n</code></pre>\n\n<p>gives \"the value does not match this field\", in spite of the fact that column 1 of the combobox is text (but the control-source is the id of the reviewer). the same happens when I do</p>\n\n<pre><code>Me.cmbFnam.Column(1) = rstauth.Fields(1).Value\n</code></pre>\n\n<p>I have also tried to give the row-number in the Columns-clause. This gives me the \"object required\" error.</p>\n\n<p>Can I get any help?</p>\n\n<p>Biorn Veiro </p>\n"}, {"tags": ["excel", "vba", "add-in"], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1521729019, "post_id": 49417562, "comment_id": 85864196, "body": "Thanks Jarom. Yes, wrapping the Workbook Open event code in the .xlam with the IFs would achieve this. Your answer creates an additional question though that I didn&#39;t first consider. I might want to work after-hours sometimes and would like the ability to move code to the repository at those times. The IF statement solution would not provide this flexibility (and neither would the automatic No click option). I&#39;d like to know if I can create an automated task to deactivate the Add-in and still retain the ability to activate/deactivate manually when required."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1521733224, "post_id": 49417562, "comment_id": 85867404, "body": "See the edit I made to my previous answer.  I think this will address your concern.  If it does answer your question, you can let other users know by clicking the green check mark.  Let me know if you have any more questions."}], "tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": true, "score": 1, "last_activity_date": 1521733410, "last_edit_date": 1521733410, "creation_date": 1521671340, "answer_id": 49417562, "question_id": 49416993, "link": "https://stackoverflow.com/questions/49416993/deactivate-excel-add-in-outside-business-hours/49417562#49417562", "title": "Deactivate Excel add-in outside business hours", "body": "<p>Try putting two IF statements around all of your code like this:</p>\n\n<pre><code>Sub test()\n\n\nIf TimeValue(Now) &lt; TimeValue(\"06:00 PM\") Then\n    If TimeValue(Now) &lt; TimeValue(\"08:00 AM\") Then\n    'Original Code Here\n    Else: Exit Sub\n    End If\nElse: Exit Sub\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This will automatically exit the sub if it is later than 6:00 PM or earlier than 8:00 AM.</p>\n\n<p>If you want to be able to have the flexibility to choose to execute your code after hours you can do this:</p>\n\n<pre><code>Sub test()\n\nShowDurationSecs = 5\n\nDim Rslt As Integer\n\nIf TimeValue(Now) &lt; TimeValue(\"06:00 PM\") Then\n    If TimeValue(Now) &lt; TimeValue(\"08:00 AM\") Then\n        Rslt = CreateObject(\"WScript.Shell\").PopUp(\"Move Code to Repository?\", ShowDurationSecs, \"Message Title\", 4 + 32)\n        If Rslt = 6 Then\n        'Original Code Here\n        Else: Exit Sub\n        End If\n    Else: Exit Sub\n    End If\nElse: Exit Sub\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This code creates a dialogue box that is on a timer.  If the box times out or the user clicks 'No', then <code>Rslt</code> will not equal 6 and the code will not execute.  If it the user clicks 'Yes', <code>Rslt</code> will equal 6 and the code will execute.  The pop up box will only show when it is between those hours.  If the dialogue box is not that much of an inconvenience, you could get rid of the time conditions and require the user to answer 'Yes' every time in order to run the code.  Whatever works better for your process.</p>\n"}, {"tags": [], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "is_accepted": false, "score": 1, "last_activity_date": 1522167268, "creation_date": 1522167268, "answer_id": 49517813, "question_id": 49416993, "link": "https://stackoverflow.com/questions/49416993/deactivate-excel-add-in-outside-business-hours/49517813#49517813", "title": "Deactivate Excel add-in outside business hours", "body": "<p>Jarom's suggestions led to this solution (Thanks Jarom!). The conditionals were reworked a bit using booleans:</p>\n\n<pre><code>Sub test()\n\nDim Rslt As Integer\n\nShowDurationSecs = 5\n\n'if after hours, then pop up timed-dialog and acquire Rslt value (actively or passively)\n\nIf TimeValue(Now) &lt; TimeValue(\"07:00 AM\") And TimeValue(Now) &gt; TimeValue(\"07:00 PM\") Then Rslt = CreateObject(\"WScript.Shell\").PopUp(\"Do you want to save the VBA code in this workbook to the git repository?\", ShowDurationSecs, \"Save Code to Repository\", 4 + 32)\n\nIf (TimeValue(Now) &gt; TimeValue(\"07:00 AM\") And TimeValue(Now) &lt; TimeValue(\"07:00 PM\")) Or Rslt = 6 Then 'if business hours OR Rslt = 6\n'run code export routine\nElse: Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>+1 to Jarom for the timed pop-up idea...I'd never used that technique before and will certainly use it again.</p>\n"}], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 49417562, "answer_count": 2, "score": 1, "last_activity_date": 1522167268, "creation_date": 1521668534, "question_id": 49416993, "link": "https://stackoverflow.com/questions/49416993/deactivate-excel-add-in-outside-business-hours", "title": "Deactivate Excel add-in outside business hours", "body": "<p>I use an Add-in to export all vba code to a repository whenever a workbook is opened. It works great for versioning, but I must remember to deactivate it before I leave the office every evening. If I don't, the automated Excel processes that run overnight generate the prompt and can't proceed until the dialog is cleared (i.e. export code...Yes/No?). When I log in, I'm staring at several Excel dialogs waiting for a response.</p>\n\n<p>Note that I don't always want to export the code...sometimes I just want to open the file and check something, so the Yes/No dialog is required.</p>\n\n<p>How would one automatically deactivate the Add-in every night at a set time before the automated processes start running? Note that manually reactivating it in the morning is not a problem.</p>\n\n<p>If automated Add-in deactivation is not possible, automatically answering the dialog with a \"No\" during the overnight hours might be an option. Is there a way to automatically click the No button of a MsgBox?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1521669174, "last_edit_date": 1521669174, "creation_date": 1521668576, "answer_id": 49417011, "question_id": 49416962, "link": "https://stackoverflow.com/questions/49416962/vba-if-statement-works-when-condition-is-met-but-get-mismatch-error-when-conditi/49417011#49417011", "title": "VBA IF statement works when condition is met but get mismatch error when condition not met.", "body": "<p>The Error <code>#N/A</code> is not a string, so the <code>.Value</code> does not actually equal the text <code>#N/A</code>; it's an <code>Error</code> value (<code>Error</code> being a data type), and an <code>Error</code> can't be coerced to/from a <code>String</code>.</p>\n\n<p>You test for the error with:</p>\n\n<pre><code>If not IsError(ActiveSheet.Range(\"B1\").Value) Then\n</code></pre>\n\n<p>Or test the <code>.Text</code></p>\n\n<pre><code>If ActiveSheet.Range(\"B1\").Text &lt;&gt; \"#N/A\" Then\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 1, "accepted_answer_id": 49417011, "answer_count": 1, "score": 0, "last_activity_date": 1521669174, "creation_date": 1521668396, "question_id": 49416962, "link": "https://stackoverflow.com/questions/49416962/vba-if-statement-works-when-condition-is-met-but-get-mismatch-error-when-conditi", "title": "VBA IF statement works when condition is met but get mismatch error when condition not met.", "body": "<p>VBA beginner here... This is probably a simple solution I am overlooking but I could not find other questions that fixed my issue. \nI am using the below code to delete the first row if cell B1 is not #N/A...otherwise do nothing. </p>\n\n<pre><code>If [B1].Value &lt;&gt; \"#N/A\" Then\n[B1].EntireRow.Delete\nEnd If\n</code></pre>\n\n<p>If the condition is met, the first row is deleted and the code works perfectly. However, if the condition is not met I get a mismatch error (instead of just moving on to the next line). Any ideas? Thanks. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9531178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B5cNxOKWFPA/AAAAAAAAAAI/AAAAAAAAD1o/Df51TDY9VXU/photo.jpg?sz=128", "display_name": "Martyn Rankin", "link": "https://stackoverflow.com/users/9531178/martyn-rankin"}, "edited": false, "score": 0, "creation_date": 1521801767, "post_id": 49418002, "comment_id": 85897178, "body": "Hello.  Thank you for your help.  This worked perfectly."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1521674976, "last_edit_date": 1521674976, "creation_date": 1521674003, "answer_id": 49418002, "question_id": 49416668, "link": "https://stackoverflow.com/questions/49416668/combining-two-vba-codes-together/49418002#49418002", "title": "Combining two VBA codes together", "body": "<p>If the edited Cell is in column J (row 2 or higher), and Target contains only one Cell</p>\n\n<ul>\n<li>Unprotect sheet</li>\n<li>If the cell is not empty\n\n<ul>\n<li>Stop Excel from processing all other events (editing other cells)</li>\n<li>Add the Date-Time stamp in Cell column I, same row as edited cell</li>\n<li>Start processing events again</li>\n</ul></li>\n<li>Lock edited cell (Target)</li>\n<li>Protect sheet again </li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Const PW = \"PW\"\n\n    With Target\n        If .Column = 10 And .Row &gt; 1 And .CountLarge = 1 Then   'J2:J(lastRow)\n            .Worksheet.Unprotect Password:=PW\n            If Len(.Value2) &gt; 0 Then\n                Application.EnableEvents = False\n                .Offset(, -1) = Now\n                Application.EnableEvents = True\n            End If\n            .Locked = True\n            .Worksheet.Protect Password:=PW\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9531178, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B5cNxOKWFPA/AAAAAAAAAAI/AAAAAAAAD1o/Df51TDY9VXU/photo.jpg?sz=128", "display_name": "Martyn Rankin", "link": "https://stackoverflow.com/users/9531178/martyn-rankin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525199468, "creation_date": 1521667053, "last_edit_date": 1531164843, "question_id": 49416668, "link": "https://stackoverflow.com/questions/49416668/combining-two-vba-codes-together", "title": "Combining two VBA codes together", "body": "<p>Apologises if this is a silly question, but I am a novice at this.</p>\n\n<p>I am sure this is a simple fix, but I just can't figure it out.</p>\n\n<p>I want to be able to run the two VBA's at the same time.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim xRg As Range\n    On Error Resume Next\n    Set xRg = Intersect(Range(\"J2:J40\"), Target)\n    If xRg Is Nothing Then Exit Sub\n    Target.Worksheet.Unprotect Password:=\"PW\"\n    xRg.Locked = True\n    Target.Worksheet.Protect Password:=\"PW\"\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim xCellColumn As Integer\nDim xTimeColumn As Integer\nDim xRow, xCol As Integer\nxCellColumn = 10\nxTimeColumn = 9\nxRow = Target.Row\nxCol = Target.Column\nIf Target.Text &lt;&gt; \"\" Then\n    If xCol = xCellColumn Then\n       Cells(xRow, xTimeColumn) = Now()\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Can anyone help me please?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521666891, "post_id": 49416571, "comment_id": 85835016, "body": "<i>I can&#39;t get the &quot;First&quot; and &quot;Last&quot; variables to load</i> What does this mean? Also, delete the <code>On Error Resume Next</code> to see if any error raises that causes your code to fail"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9339568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gY1gQ.jpg?s=128&g=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/9339568/scott"}, "edited": false, "score": 0, "creation_date": 1521750815, "post_id": 49416844, "comment_id": 85877927, "body": "Thanks again Scott .  Much appreciated."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1521667799, "creation_date": 1521667799, "answer_id": 49416844, "question_id": 49416571, "link": "https://stackoverflow.com/questions/49416571/locate-first-row-number-of-data-set/49416844#49416844", "title": "Locate first row number of data set", "body": "<pre><code>Public Sub Create_Report()\n\n\n'Define range of report\nDim ww_from As Long\nww_from = Application.InputBox _\n    (prompt:=\"From what is the workweek do you want to report?\", Type:=1)\n\nDim ww_to As Long\nww_to = Application.InputBox _\n    (prompt:=\"To what workweek do you want to report?\", Type:=1)\n\n\n'Select first row of data set locations\nWith ThisWorkbook.Worksheets(\"Sheet1\").Range(\"C:C\")\n    Dim First As Range\n    Set First = .Find(ww_from)\n      'Locate data set for report by row number\n\n    Dim k As Long\n    If Not First Is Nothing Then k = First.Row\n\n    Dim Last As Range\n    Set Last = .Find(ww_to)\n    Dim l As Long\n    If Not Last Is Nothing Then\n        l = Last.Row\n    Else\n        l = k\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9339568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gY1gQ.jpg?s=128&g=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/9339568/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 49416844, "answer_count": 1, "score": 0, "last_activity_date": 1521667799, "creation_date": 1521666615, "last_edit_date": 1531164843, "question_id": 49416571, "link": "https://stackoverflow.com/questions/49416571/locate-first-row-number-of-data-set", "title": "Locate first row number of data set", "body": "<p>I'm trying to locate the data set I want to filter.  The range is determined by the users input into InputBox.  I want to search column \"C\" for the ww_from and ww_to. Column \"C\" is all integers. When I use the code below I can't get the \"First\" and \"Last\" variables to load a (x,y) location. Thanks in advance. Scott </p>\n\n<pre><code>Public Sub Create_Report()\n\n   'Define range of report\n    On Error Resume Next\n    ww_from = Application.InputBox _\n    (\"From what is the workweek do you want to report?\")\n\n    ww_to = Application.InputBox _\n    (prompt:=\"To what workweek do you want to report?\")\n\n\n'Select first row of data set locations\nWith ThisWorkbook.Worksheets(\"Sheet1\")\nActiveWorkbook.Worksheets(\"Sheet1\").Activate\nSet ws = Worksheets(\"Sheet1\")\nSet First = .Column(\"C\").Find(What:=\"ww_from\")\n\n      'Locate data set for report by row number\n       k = First.Row\n   End With\n\n 'Select last row of data set locations\n With ThisWorkbook.Worksheets(\"Sheet1\")\n Set ws = Worksheets(\"Sheet1\")\n  Set Last = .Column(\"C\").Cells.Find(What:=\"ww_to\")\n\nEnd With\n         'Case where only one ww is requested in report meaning ww_from = ww_to.\n         If l = k Then l = k\n         l = Last.Row\n</code></pre>\n"}, {"tags": ["vba", "types", "runtime", "incompatibility"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1521696938, "post_id": 49416545, "comment_id": 85843433, "body": "<code>Option Explicit</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1521667313, "creation_date": 1521667313, "answer_id": 49416734, "question_id": 49416545, "link": "https://stackoverflow.com/questions/49416545/vba-select-case-type-incompatibility/49416734#49416734", "title": "VBA Select Case type incompatibility", "body": "<p>I suspect that those <em>\"cells with no content\"</em> may have some spaces content</p>\n\n<p>so just convert them to zero via the <code>Val()</code> function</p>\n\n<pre><code>Select Case ((val(cell.Offset(0, -2).Value) - val(cell.Offset(0, -1).Value)) - (val(cellX.Offset(0, -2).Value) - val(cellX.Offset(0, -1).Value)))\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 9435663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ba553ef4f64c17445912eec0de6e01?s=128&d=identicon&r=PG&f=1", "display_name": "T. P. ", "link": "https://stackoverflow.com/users/9435663/t-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521667313, "creation_date": 1521666508, "last_edit_date": 1521667227, "question_id": 49416545, "link": "https://stackoverflow.com/questions/49416545/vba-select-case-type-incompatibility", "title": "VBA Select Case type incompatibility", "body": "<p>I have got this sub and this function you see below. It gives me a runtime error 13: type incompatibility on the following row and I dont know whats wrong</p>\n\n<p><code>Select Case ((Cell.Offset(0, -2).Value - Cell.Offset(0, -1).Value) - (CellX.Offset(0, -2).Value - CellX.Offset(0, -1).Value))</code></p>\n\n<p>I am working on this piece of code for hours, so you are my last resort.</p>\n\n<p>You may also need to know, that in the Cells of <code>Range rngX</code> there are cells with floating point numbers and cells with no content and in <code>Cell.Offset(0,-2)</code> and <code>Cell.Offset(0,-1)</code> there are integral numbers or cells with no content</p>\n\n<pre><code>Sub X()\n\n    Dim boolFunction as Boolean\n\n    With ThisWorkbook.Sheets(\"IntTab\")\n        boolFunction = Function1(.Range(\"O2:O19\"))\n        boolFunction = Function1(.Range(\"AA2:AA19\"))\n    End With\n\nEnd Sub\n\n\nFunction Function1(ByVal rngX As Range) As Boolean\n\n    Dim intTab As Integer\n\n    For Each Cell In rngX\n        intTab = 1\n        For Each CellX In rngX\n            Select Case Cell.Value - CellX.Value\n                Case Is &gt; 0\n                    'Do nothing\n                Case Is = 0\n                    Select Case ((Cell.Offset(0, -2).Value - Cell.Offset(0, -1).Value) - (CellX.Offset(0, -2).Value - CellX.Offset(0, -1).Value))\n                        Case Is &gt; 0\n                            'Do nothing\n                        Case Is = 0\n                            'Do nothing\n                        Case Is &lt; 0\n                            intTab = intTab + 1\n                    End Select\n                Case Is &lt; 0\n                    intTab = intTab + 1\n            End Select\n        Next CellX\n        Cell.Offset(0, (-9)).Value = intTab\n    Next Cell\n\n    Function1 = True\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521667057, "post_id": 49416514, "comment_id": 85835088, "body": "So you want the second IF execute only if the first one executed?"}, {"owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521667287, "post_id": 49416514, "comment_id": 85835187, "body": "Hi, Foxfire And Burns And Burns. No, I want for the second if to execute independent of the first If but to keep both conditions (if possible) in the same code. Truth be told, I do not know how to separate two IFs, when working in the Private Sub mode. Thanks!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521667519, "post_id": 49416514, "comment_id": 85835304, "body": "what happens if you use your code as shown?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521667565, "post_id": 49416514, "comment_id": 85835327, "body": "but your code does that now. What happends if you execute that code now? also, remove the <code>On Error GoTo ErrorOccured</code> to see if any error arises"}, {"owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "edited": false, "score": 0, "creation_date": 1521668189, "post_id": 49416514, "comment_id": 85835638, "body": "You know what,  Foxfire And Burns And Burns? It works!!! :-) Thank you for the error suggestion and for replying."}], "owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521666372, "creation_date": 1521666372, "last_edit_date": 1531164843, "question_id": 49416514, "link": "https://stackoverflow.com/questions/49416514/vba-connect-2-if-conditions-2-message-boxes", "title": "VBA - Connect 2 If Conditions &amp; 2 Message Boxes", "body": "<p>I have written the following code:</p>\n\n<pre><code>  Dim myValue As Variant\n    Dim myValue2 As Variant\n    Dim myValue3 As Variant\n    Dim myValue4 As Variant\n    On Error GoTo ErrorOccured\n    If Target.Address = \"$B$10\" And Target.Value = \"Yes\" Then\n        myValue = InputBox(\"Insert initialDate1\")\n        myValue2 = InputBox(\"Insert initialDate2\")\n        Range(\"C10\").Value = myValue\n        Range(\"D10\").Value = myValue2\n        End If\n\n\n   If Target.Address = \"$B$12\" And Target.Value = \"Yes\" Then\n        myValue3 = InputBox(\"InitialDate3\")\n        myValue4 = InputBox(\"InitialDate4\")\n        Range(\"C12\").Value = myValue3\n        Range(\"D12\").Value = myValue4\n        End If\nErrorOccured:\n    'Do when value is not valid\n    End Sub\n</code></pre>\n\n<p>Its purpose is the following:\nif I select Yes from a drop down list, the code must ask me to fill a beginning and ending date of the first event and then\nit should go to the second event, again select yes from a drop down list and ask for beginning and and dates. My problem is that I don't know how to connect these two conditions so that they stay independent. I cannot use And Or, Else or the other classic connectors. I should be able to select Yes for the first Event and input the dates and for ex select No for the second event end no pop up appears. It worked when I wrote the code for only one Event </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim myValue As Variant\n    Dim myValue2 As Variant\n    On Error GoTo ErrorOccured\n    If Target.Address = \"$B$10\" And Target.Value = \"Yes\" Then\n        myValue = InputBox(\"Insert initialDate1\")\n        myValue2 = InputBox(\"Insert initialDate2\")\n        Range(\"C10\").Value = myValue\n        Range(\"D10\").Value = myValue2\n         End If\nErrorOccured:\n End Sub\n</code></pre>\n\n<p>Please, could you help me with this one? </p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521667383, "post_id": 49416100, "comment_id": 85835238, "body": "Your first line should be <code>With ActiveWorkbook.Worksheets(mysheet)</code> and then line 2 and 3, delete the <code>(sheet)</code> part. And the, right before line <code>With ActiveWorkbook.Worksheets(mysheet).AutoFilter.Sort  </code> insert a line that says <code>End With</code>"}], "answers": [{"tags": [], "owner": {"reputation": 279, "user_id": 3145067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99eb4dd101551aed7402d68e4a2ea58f?s=128&d=identicon&r=PG&f=1", "display_name": "GadgetGuy", "link": "https://stackoverflow.com/users/3145067/gadgetguy"}, "is_accepted": false, "score": -1, "last_activity_date": 1521669356, "creation_date": 1521669356, "answer_id": 49417169, "question_id": 49416100, "link": "https://stackoverflow.com/questions/49416100/need-to-use-a-variable-in-choosing-a-tab/49417169#49417169", "title": "Need to use a variable in choosing a Tab", "body": "<p>Try this</p>\n\n<pre><code>ActiveSheet.AutoFilter.Sort.SortFields.Clear\nActiveSheet.AutoFilter.Sort.SortFields.Add Key:=Range(\"C1\"),SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= xlSortNormal\nWith ActiveSheet.AutoFilter.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5578482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6zb4.jpg?s=128&g=1", "display_name": "learn2shoot", "link": "https://stackoverflow.com/users/5578482/learn2shoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521669356, "creation_date": 1521664856, "last_edit_date": 1521664892, "question_id": 49416100, "link": "https://stackoverflow.com/questions/49416100/need-to-use-a-variable-in-choosing-a-tab", "title": "Need to use a variable in choosing a Tab", "body": "<p>I am in Excel I have collected a variable correctly.</p>\n\n<pre><code>Dim mysheet As String\nmysheet = ActiveSheet.Name\n</code></pre>\n\n<p>mysheet has a value os in one case \"Agent_State_Log20180320\"  - so this part seems right.</p>\n\n<p>I am trying to use it in the following places - but my syntax is off.</p>\n\n<pre><code>ActiveWorkbook.Worksheets\n(mysheet).AutoFilter.Sort.SortFields.ClearActiveWorkbook.Worksheets\n(mysheet).AutoFilter.Sort.SortFields.Add Key:=Range\n(\"C1\"),SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= xlSortNormal\nWith ActiveWorkbook.Worksheets(mysheet).AutoFilter.Sort   \n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>What should I change to get this to work correctly?</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1521676911, "post_id": 49416080, "comment_id": 85838590, "body": "SenderEmailAddress &quot;Returns a String that represents the e-mail address of the sender of the Outlook item. Read-only.&quot; Does not exists on unsent mail."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1521688840, "post_id": 49416080, "comment_id": 85841316, "body": "Are you checking the sender address or the recipient address?"}, {"owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521765604, "post_id": 49416080, "comment_id": 85883241, "body": "Checking the sender (from) address"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521765643, "post_id": 49434018, "comment_id": 85883248, "body": "Thank you so much! I will give this a try."}, {"owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521766435, "post_id": 49434018, "comment_id": 85883465, "body": "It seems to be giving the warning no matter which account I send from."}, {"owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521766465, "post_id": 49434018, "comment_id": 85883474, "body": "Is it checking the actual email address, or just the display name? Because the display name may be the same for each account."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521767553, "post_id": 49434018, "comment_id": 85883746, "body": "Edited - try SmtpAddress instead of DisplayName."}, {"owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521768010, "post_id": 49434018, "comment_id": 85883858, "body": "That doesn&#39;t work either. It just sends the emails as normal with no warning."}, {"owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521770105, "post_id": 49434018, "comment_id": 85884367, "body": "Nevermind, I didn&#39;t realize I had to put in the addresses that are Good to send from. I had the prohibited addresses in before.   The problem now is with both SmtpAddress and DisplayName gives a warning on each address.   For example ben.company@gmail.com and ben@company.com both gives warnings when only ben.company@gmail.com should give a warning. Each account has the same display name."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1521771852, "post_id": 49434018, "comment_id": 85884766, "body": "Use Debug.Print Send_Address to compare the Item&#39;s send address to the addresses you have typed it in your Case statement - possibly a typo?"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1521767453, "last_edit_date": 1521767453, "creation_date": 1521736737, "answer_id": 49434018, "question_id": 49416080, "link": "https://stackoverflow.com/questions/49416080/outlook-macro-check-sending-email-address-before-sending/49434018#49434018", "title": "Outlook macro check sending email address before sending", "body": "<p>Try using <code>SendUsingAccount</code> - as noted, <code>SenderEmailAddress</code> doesn't exist on unsent mail.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\nDim Send_Address As String\nDim Prompt As String\n\n' Check Send_from name\nSend_Address = Item.SendUsingAccount.SmtpAddress\n\nSelect Case Send_Address\n    Case \"alias@domain.com\", \"alias2@domain3.com\", \"alias3@domain3.com\"\n        Item.Send\n    Case Else\n\n        Prompt = \"You are currently sending this email from \" &amp; Send_Address &amp; \". Are you sure you want to proceed?\"\n        If MsgBox(Prompt, vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Check Address\") = vbNo Then\n            Cancel = True\n        End If\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p>You should paste this code \"ThisOutlookSession,\" under Microsoft Outlook Objects in the VBA Editor.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "edited": false, "score": 0, "creation_date": 1522001002, "post_id": 49445238, "comment_id": 85960970, "body": "This doesn&#39;t seem to be working for me either, I get no prompts."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1586978456, "last_edit_date": 1586978456, "creation_date": 1521793463, "answer_id": 49445238, "question_id": 49416080, "link": "https://stackoverflow.com/questions/49416080/outlook-macro-check-sending-email-address-before-sending/49445238#49445238", "title": "Outlook macro check sending email address before sending", "body": "<p><em>I  think it should be <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-sendusingaccount-property-outlook\" rel=\"nofollow noreferrer\">MailItem.SendUsingAccount Property (Outlook)</a></em></p>\n\n<blockquote>\n  <p><sub>Which returns or sets an <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/account-object-outlook\" rel=\"nofollow noreferrer\">Account</a> object that represents the account under which the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-object-outlook\" rel=\"nofollow noreferrer\">MailItem</a> is to be sent. Read/write, also see <a href=\"https://msdn.microsoft.com/en-us/library/bb207787(v=office.12).aspx\" rel=\"nofollow noreferrer\">MailItem.SendUsingAccount Property.</a></sub></p>\n</blockquote>\n\n<p><em>Example</em> </p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    Dim Prompt As String\n        Prompt = \"Are you sure you want to send from 0m3r@Email.com?\"\n\n        If Item.SendUsingAccount = \"0m3r@Email.com\" Then\n            If MsgBox(Prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then\n                Cancel = True\n            End If\n        End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6632302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09902ed4dd6588c56b878f13bc8e92c2?s=128&d=identicon&r=PG&f=1", "display_name": "inputchip", "link": "https://stackoverflow.com/users/6632302/inputchip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3847, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1592695983, "creation_date": 1521664770, "last_edit_date": 1592695983, "question_id": 49416080, "link": "https://stackoverflow.com/questions/49416080/outlook-macro-check-sending-email-address-before-sending", "title": "Outlook macro check sending email address before sending", "body": "<p>I use multiple accounts in Outlook and therefore send from many different email addresses. I want to give a warning box if I am sending from an address I should not be sending from. I have two addresses that I should never send from (they are receive only accounts. I do not want to accidentally send from these accounts. </p>\n\n<p>This example is almost what I am looking for. \n<a href=\"http://www.slipstick.com/how-to-outlook/prevent-sending-messages-to-wrong-email-address/\" rel=\"nofollow noreferrer\">Example - Checking the \"To\" address.</a></p>\n\n<p>I believe using a string comparison (StrComp) and Item.SenderEmailAddress is what I need. However I can't seem to get it to work. </p>\n\n<p>Here is my current attempt for giving a warning for a single email address (bad.email@gmail.com).</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\nOn Error Resume Next\n ' use lower case for the address\n ' LCase converts all addresses in the To field to lower case\nIf StrComp((Item.SenderEmailAddress), \"bad.email@gmail.com\") Then\n    Exit Sub\nEnd If\n\n        Prompt$ = \"You sending this from \" &amp; Item.SenderEmailAddress &amp; \". Are you sure you want to send it?\"\n       If MsgBox(Prompt$, vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Check Address\") = vbNo Then\n         Cancel = True\n       End If\n\nEnd Sub\n</code></pre>\n\n<p>Ideally I would be able to check two or more addresses with the same code. Using something like they did in that example should work. </p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    On Error Resume Next\n   Select Case LCase(Item.To)\n    Case \"alias@domain.com\", \"alias2@domain3.com\", \"alias3@domain3.com\"\n        Item.Send\n    Case Else\n      Prompt$ = \"You are not sending this to \" &amp; Item.To &amp; \". Are you sure you want to send the Mail?\"\n       If MsgBox(Prompt$, vbYesNo + vbQuestion + vbMsgBoxSetForeground, \"Check Address\") = vbNo Then\n         Cancel = True\n       End If\n\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>Also, where do I place the code to ensure that it is constantly running and ready?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1521664504, "post_id": 49416004, "comment_id": 85833849, "body": "Range expects two cells, a start and a finish.  Just use <code>.Cells(i, j).Value = str</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1521664548, "post_id": 49416004, "comment_id": 85833881, "body": "I think he wants the value of the cell stored in the variable <code>str</code>, so need to flip the sides of that assignment: <code>str = .Cells(i, j).Value</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1521664614, "post_id": 49416004, "comment_id": 85833924, "body": "And to output each cell value individually in your loop, move the <code>Print</code> line within your inner <code>For j</code> loop, or else you&#39;ll only ever print out the last value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "edited": false, "score": 0, "creation_date": 1521664901, "post_id": 49416004, "comment_id": 85834073, "body": "str = .Cells(i, j).Value     tried this line too still throws an error 1004"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1521665007, "post_id": 49416004, "comment_id": 85834132, "body": "@AntonyPPeter The problem is that your For loops start at 0.  There is no row 0 and there is no column 0, that&#39;s what&#39;s causing your error.  Change your loops to start at 1."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1521665313, "post_id": 49416004, "comment_id": 85834280, "body": "@tigeravatar you are right, I corrected now and its working fine thanks"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "edited": false, "score": 0, "creation_date": 1521664787, "post_id": 49416020, "comment_id": 85834017, "body": "Initially I tried the same but it shows the same error."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1521664912, "post_id": 49416020, "comment_id": 85834080, "body": "@DisplayName the problem isn&#39;t how he&#39;s defining the end, it&#39;s how he&#39;s defining the beginning.  From his original post: <code>For i = 0 To LastRow</code> Because there is no row 0, it will always result in the 1004 error."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521664934, "post_id": 49416020, "comment_id": 85834090, "body": "but it&#39;s the right syntax, so what&#39;s the outcome now?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1521664967, "post_id": 49416020, "comment_id": 85834116, "body": "You are correct, syntax is fine.  OP just need to make his For loop start at an actual row number instead of 0"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "edited": false, "score": 0, "creation_date": 1521665016, "post_id": 49416020, "comment_id": 85834137, "body": "I used both options still it fails to execute"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1521665058, "post_id": 49416020, "comment_id": 85834161, "body": "@tigeravatar, you&#39;re right. that is the root of the 1004. and then she has to use the right syntax, too"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521665113, "post_id": 49416020, "comment_id": 85834185, "body": "Cells start at (1,1)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "edited": false, "score": 0, "creation_date": 1521665114, "post_id": 49416020, "comment_id": 85834188, "body": "I tried the options you shared but still it fails by mentioning the same error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "edited": false, "score": 0, "creation_date": 1521665184, "post_id": 49416020, "comment_id": 85834218, "body": "I got it now... For i = 1 To LastRow     For j = 1 To LastCol"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "edited": false, "score": 0, "creation_date": 1521665213, "post_id": 49416020, "comment_id": 85834230, "body": "I initialised by 0...thats y the error...thank you so much for your time"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1521665491, "post_id": 49416020, "comment_id": 85834350, "body": "see edited answer for a complete code where I also adopted: 1) the switching of <code>str</code> and <code>.Range(.Cells(i, j)).Value</code> (as noticed by @tigeravatar) 2) enclosed the <code>Print #2, str</code> inside the nested  loop"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "edited": false, "score": 0, "creation_date": 1521665802, "post_id": 49416020, "comment_id": 85834498, "body": "@DisplayName I used your code and its working fine. thanks"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521750492, "post_id": 49416020, "comment_id": 85877735, "body": "@AntonyPPeter, you are welcome. You may then consider marking the answer as accepted. Thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1521665305, "last_edit_date": 1521665305, "creation_date": 1521664495, "answer_id": 49416020, "question_id": 49416004, "link": "https://stackoverflow.com/questions/49416004/using-vba-not-able-to-store-the-cell-value-in-a-variable-and-throws-1004-error/49416020#49416020", "title": "Using VBA, Not able to store the cell value in a variable and throws 1004 error", "body": "<p>just use</p>\n\n<pre><code>.Cells(i, j).Value = str\n</code></pre>\n\n<p>BTW you'd better explicitly qualify your range references up to the <code>worksheet</code> object (and, if multiple workbooks are involved, up to the <code>workbook</code> object) , otherwise it would implicitly assumed <code>ActiveSheet</code> (and ActiveWorkbook)</p>\n\n<p>so, instead of</p>\n\n<pre><code>LastRow= Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>use</p>\n\n<pre><code>LastRow= ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row\nLastCol = ws1.Cells(1, ws1.Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>or </p>\n\n<pre><code>With ws1\n    LastRow= .Cells(.Rows.Count, 1).End(xlUp).Row\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\nEnd With\n</code></pre>\n\n<hr>\n\n<p>so your code could be refactored as follows:</p>\n\n<pre><code>Option Explicit\n\nSub myself()\n\n    Dim str As String\n    Dim LastRow As Long\n    Dim LastCol As Long\n    Dim ws1 As Worksheet\n    Dim ws2 As Worksheet\n    Dim i As Long\n    Dim j As Long\n\n    Dim FilePath As String\n\n    Set ws1 = Sheets(\"Sheet1\")\n    Set ws2 = Sheets(\"Sheet2\")\n\n\n    Open \"C:\\Users\\Antony\\Desktop\\test.txt\" For Output As #2\n\n    With ws1\n        LastRow = .Cells(.Rows.count, 1).End(xlUp).Row\n        LastCol = .Cells(1, .Columns.count).End(xlToLeft).Column\n\n        For i = 1 To LastRow\n            For j = 1 To LastCol\n                str = .Range(.Cells(i, j)).Value\n                Print #2, str\n            Next\n        Next\n    End With\n\n    Close #2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6314105"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 49416020, "answer_count": 1, "score": 0, "last_activity_date": 1521665305, "creation_date": 1521664424, "question_id": 49416004, "link": "https://stackoverflow.com/questions/49416004/using-vba-not-able-to-store-the-cell-value-in-a-variable-and-throws-1004-error", "title": "Using VBA, Not able to store the cell value in a variable and throws 1004 error", "body": "<p>I am in learning phase in vba. I am trying to store a value in a variable but not able do with Cell and also Range and it throws an 1004 error</p>\n\n<p>Below is my code</p>\n\n<pre><code>Sub myself()\n\nDim str As String\nDim rock As String\nDim MaxStrLen As Integer\nDim StrLen As String\nDim LastRow As Long\nDim LastCol As Long\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim i As Integer\nDim j As Integer\n\nDim FilePath As String\n\nSet ws1 = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\n\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nOpen \"C:\\Users\\Antony\\Desktop\\test.txt\" For Output As #2\n\nws1.Activate\n\nWith ws1\nFor i = 0 To LastRow\nFor j = 0 To LastCol\n</code></pre>\n\n<p><strong>.Range(.Cells(i, j)).Value = str</strong></p>\n\n<pre><code>Next j\n\nNext i\n\nPrint #2, str\nEnd With\n\nClose #2\n\nEnd Sub\n</code></pre>\n\n<p>Highlighted line is the 1004 error. Please help to solve and store in a variable in Notepad.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1521664276, "post_id": 49415784, "comment_id": 85833736, "body": "Your code only refers to column <code>col_a</code>, not column <code>col_c</code>.  Try setting <code>tblArr</code> to be the whole table, and make the <code>rowArr = </code> line in the for-loop be a bit more complicated, picking and choosing only the columns you want.  Maybe <code>rowArr = Application.Index(tblArr, i, 0) + Application.Index(tblArr, i, 2)</code>? (after you&#39;ve set <code>tblArr</code> to be the whole table, of course)"}], "answers": [{"comments": [{"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1521664513, "post_id": 49415993, "comment_id": 85833853, "body": "I think you&#39;ll need to tweak the <code>rowArr = </code> line later on, too."}, {"owner": {"reputation": 3240, "user_id": 2694306, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/a36c65851474c1cca6200426379fd82f?s=128&d=identicon&r=PG&f=1", "display_name": "user2694306", "link": "https://stackoverflow.com/users/2694306/user2694306"}, "edited": false, "score": 0, "creation_date": 1521664628, "post_id": 49415993, "comment_id": 85833935, "body": "Worked great. Is there anyway to alter that so I can reference a particular header field values (col_a and col_c) rather than the column number (1,3) ?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1521667532, "post_id": 49415993, "comment_id": 85835314, "body": "May be using Application.Match to find the desired header then store that number in a variable and use it. I think it is easier to determine the column numbers"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 4, "last_activity_date": 1521664360, "creation_date": 1521664360, "answer_id": 49415993, "question_id": 49415784, "link": "https://stackoverflow.com/questions/49415784/exporting-to-csv-non-sequential-columns-from-a-table/49415993#49415993", "title": "Exporting to CSV, Non Sequential Columns from a Table", "body": "<p>Replace that line</p>\n\n<pre><code>tblArr = Range(\"main[[col_a]]\").Value\n</code></pre>\n\n<p>with these two lines</p>\n\n<pre><code>    tblArr = tbl.DataBodyRange.Value\n    tblArr = Application.Index(tblArr, Evaluate(\"ROW(1:\" &amp; UBound(tblArr) &amp; \")\"), [{1,3}])\n</code></pre>\n"}], "owner": {"reputation": 3240, "user_id": 2694306, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/a36c65851474c1cca6200426379fd82f?s=128&d=identicon&r=PG&f=1", "display_name": "user2694306", "link": "https://stackoverflow.com/users/2694306/user2694306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 49415993, "answer_count": 1, "score": 1, "last_activity_date": 1521664360, "creation_date": 1521663477, "last_edit_date": 1521663621, "question_id": 49415784, "link": "https://stackoverflow.com/questions/49415784/exporting-to-csv-non-sequential-columns-from-a-table", "title": "Exporting to CSV, Non Sequential Columns from a Table", "body": "<p>I am trying to write a VBA macro to export the content of table to a csv file. I would like to include only certain columns and ignore all other ones. My code works fine for a single column (in the case below, <code>col_a</code>), but it fails when trying to export multiple columns (e.g. <code>col_a</code> and <code>col_c</code>).</p>\n\n<pre><code>Sub saveTableToCSV()\n\n    Dim tbl As ListObject\n    Dim csvFilePath As String\n    Dim fNum As Integer\n    Dim tblArr\n    Dim rowArr\n    Dim csvVal\n\n    Set tbl = Worksheets(\"primary\").ListObjects(\"main\")\n    csvFilePath = \"C:\\Users\\USERNAME\\Downloads\\testsheet.csv\"\n\n    Application.DisplayAlerts = False\n    tblArr = Range(\"main[[col_a]]\").Value\n\n    fNum = FreeFile()\n    Open csvFilePath For Output As #fNum\n    For i = 1 To UBound(tblArr)\n        rowArr = Application.Index(tblArr, i, 0)\n        csvVal = VBA.Join(rowArr, \",\")\n        Print #1, csvVal\n    Next\n    Application.DisplayAlerts = False\n\n    Close #fNum\n    Set tblArr = Nothing\n    Set rowArr = Nothing\n    Set csvVal = Nothing\nEnd Sub\n</code></pre>\n\n<p>An example of my data would be below. The table name is \"main\" and the sheet name is \"primary\":</p>\n\n<pre><code>-------------------------\n| col_a | col_b | col_c |\n-------------------------\n|   1   |   2   |   3   |\n|   4   |   5   |   6   |\n-------------------------\n</code></pre>\n\n<p>My desired output would be a csv file that looks like the following:</p>\n\n<pre><code>a,c\n1,3\n4,6\n</code></pre>\n\n<p>Can anyone point out what I am doing wrong? Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1521663246, "post_id": 49415627, "comment_id": 85833202, "body": "what is the problem? do you have errors or it does not do what it should? also, if you are using <code>with</code> you should prepend your <code>Range</code> with a dot: <code>.Range</code>"}, {"owner": {"reputation": 61, "user_id": 8914879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662b72fa1a0c6e98e0144db62ec12685?s=128&d=identicon&r=PG&f=1", "display_name": "user2574", "link": "https://stackoverflow.com/users/8914879/user2574"}, "reply_to_user": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1521663676, "post_id": 49415627, "comment_id": 85833436, "body": "@avb - I got It. Was referring some other column in the code. Thank you so much for looking through my code and replying back. Appreciate it!"}], "owner": {"reputation": 61, "user_id": 8914879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/662b72fa1a0c6e98e0144db62ec12685?s=128&d=identicon&r=PG&f=1", "display_name": "user2574", "link": "https://stackoverflow.com/users/8914879/user2574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521663412, "creation_date": 1521662820, "last_edit_date": 1531164843, "question_id": 49415627, "link": "https://stackoverflow.com/questions/49415627/vba-code-to-autofill-a-column-based-on-values-from-a-different-column", "title": "VBA Code to Autofill a Column Based on values from a different column", "body": "<p>In Column E i have numbers and NA. For all NA in column E, I have to Autofill Column D with \"create/map\". can someone help me in fixing my code? Thanks.  </p>\n\n<pre><code>Sub Rules1()\n'\n'Autofill based on Rules\n'\n\n'\n    Worksheets(\"ORD_CS\").Activate\nDim sht As Worksheet\nDim LR As Long\nDim i As Long\n\nSet sht = ActiveWorkbook.Worksheets(\"ORD_CS\")\nLR = sht.UsedRange.Rows.Count\n\n    With sht\n        For i = 8 To LR\n            If Range(\"H\" &amp; i).Value = \"NA\" Then\n                Range(\"D\" &amp; i).Value = \"Create/Map\"\n            End If\n        Next i\n    End With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "sorting", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521662454, "post_id": 49415482, "comment_id": 85832752, "body": "first off, <b>that&#39;s not VBA</b>.  Besides that, I would just prepare for the maximum amount of data, and just keep formulas in <b>all</b> the appropriate cells, using conditional formatting or an <code>if</code> statement to hide formulas for rows that don&#39;t have data yet."}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 3, "creation_date": 1521662500, "post_id": 49415482, "comment_id": 85832784, "body": "If you format the data range as a table Excel will automatically enter formulas as the new rows are entered."}, {"owner": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "edited": false, "score": 0, "creation_date": 1521662819, "post_id": 49415482, "comment_id": 85832963, "body": "&quot;If you format the data range as a table Excel will automatically enter formulas as the new rows are entered.&quot; What do you mean? Could you explain in more detail please?"}, {"owner": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "edited": false, "score": 0, "creation_date": 1521662924, "post_id": 49415482, "comment_id": 85833022, "body": "&quot; I would just prepare for the maximum amount of data, and just keep formulas in all the appropriate cells&quot; - the maximum data is until the last row of excel... so if i copy the formula to all cells, the calculations will be already really slow, from the first entry onwards..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521663605, "post_id": 49415482, "comment_id": 85833397, "body": "Select any single cell in your range, then from the [Home] Ribbon, under the [Styles] group, select [Format as Table]. Go to the table&#39;s bottom-right cell, hit TAB. A new row is inserted, and your formulas followed. If not, delete the formulas and re-type them. You should only need to enter a formula in a single row to populate the entire table."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521663644, "post_id": 49415482, "comment_id": 85833418, "body": "In any case, your question is way too broad to be answerable in this site&#39;s Q&amp;A format."}, {"owner": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "edited": false, "score": 0, "creation_date": 1521663885, "post_id": 49415482, "comment_id": 85833530, "body": "You are right. Basically what I&#39;m asking excel to do is copy a worksheet and have the rows sorted on the second worksheet. And as the table expends, of course the sorted table has more values. This process should be done automatically, with the user only entering new data in the first worksheet and seeing the results in the second worksheet... I hope this is specific enough!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521663973, "post_id": 49415482, "comment_id": 85833568, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521664352, "post_id": 49415482, "comment_id": 85833771, "body": "<code>maximum data is until the last row of excel</code> ... if you&#39;re planning ahead <b>to store a million+ records in an Excel sheet</b>, then you have some fundamental organizational flaws that should be re-thought before you proceed any further."}, {"owner": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "edited": false, "score": 0, "creation_date": 1521664662, "post_id": 49415482, "comment_id": 85833952, "body": "Let it be 1000-5000 rows/year. This &quot;maximum&quot; form is already really slow with the 5000 rows already being filled with formulas - that&#39;s why i consecutively want to fill the data automatically, so the last 4000 rows don&#39;t bother the CPU with nonsense-calculations as only the first 1000 matter... Do you know what I mean?"}, {"owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "edited": false, "score": 0, "creation_date": 1521671528, "post_id": 49415482, "comment_id": 85836967, "body": "I disagree with the folks who say that it&#39;s a simple matter of filling-down (i.e. duplicate question)... the user inputs need to be sorted into their correct location on the report sheet.  That&#39;s not possible without a processing step in between."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521664521, "post_id": 49415979, "comment_id": 85833857, "body": "re: Link-only answers: <a href=\"https://meta.stackexchange.com/questions/225370/your-answer-is-in-another-castle-when-is-an-answer-not-an-answer\">Your answer is in another castle: when is an answer not an answer?</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521664567, "post_id": 49415979, "comment_id": 85833902, "body": "Notice <a href=\"https://stackoverflow.com/questions/22104743/excel-vba-autofill-multiple-cells-with-formulas#comment33532249_22104743\">this comment</a> on the post you&#39;re linking to."}, {"owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "edited": false, "score": 1, "creation_date": 1521671653, "post_id": 49415979, "comment_id": 85837018, "body": "Oh! If there&#39;s absolutely no data processing other than to sort the table, then yes!  Just make a table; add the inputs at the bottom; and sort... done!  I have a table like this; I make it sort automatically every time I hit &quot;save&quot;."}], "tags": [], "owner": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "is_accepted": false, "score": 1, "last_activity_date": 1521665591, "last_edit_date": 1521665591, "creation_date": 1521664319, "answer_id": 49415979, "question_id": 49415482, "link": "https://stackoverflow.com/questions/49415482/filling-formulas-automatically-as-data-increase-and-sort-dynamically/49415979#49415979", "title": "Filling formulas automatically as data increase and sort dynamically", "body": "<p>I think I've found the answer here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22104743/excel-vba-autofill-multiple-cells-with-formulas#comment33532249_22104743\">Excel VBA: AutoFill Multiple Cells with Formulas</a></p>\n\n<p>Sorry that my question was so misleading, basically the above answer is all I was asking for... Thanks for your time and your answers!</p>\n\n<p>edit: linked to the specific post containing the answer</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "edited": false, "score": 0, "creation_date": 1521669885, "post_id": 49416664, "comment_id": 85836365, "body": "Thanks a lot! This helped me already together with the linked answer, the only disadvantage using this method is that the dependent table doesn&#39;t get updated automatically, but this is a crucial element in my table"}, {"owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "reply_to_user": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "edited": false, "score": 0, "creation_date": 1521670016, "post_id": 49416664, "comment_id": 85836434, "body": "If you like everything else than the way it gets updated, then maybe you can do a code that refreshes the pivottable whenever the data changes--- that would be very simple, I think.  I think the PivotTable has the advantage of your solution being 100% within Excel&#39;s pre-built features."}, {"owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "reply_to_user": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "edited": false, "score": 1, "creation_date": 1521670273, "post_id": 49416664, "comment_id": 85836534, "body": "I added this feature to the Answer above.  I don&#39;t know if this will slow down the worksheet too much, though."}], "tags": [], "owner": {"reputation": 593, "user_id": 4650381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrWhe.jpg?s=128&g=1", "display_name": "elliot svensson", "link": "https://stackoverflow.com/users/4650381/elliot-svensson"}, "is_accepted": true, "score": 1, "last_activity_date": 1521670456, "last_edit_date": 1521670456, "creation_date": 1521667025, "answer_id": 49416664, "question_id": 49415482, "link": "https://stackoverflow.com/questions/49415482/filling-formulas-automatically-as-data-increase-and-sort-dynamically/49416664#49416664", "title": "Filling formulas automatically as data increase and sort dynamically", "body": "<p>I suggest making the second table, the dependent one, out of a PivotTable. </p>\n\n<p>This will grow and shrink with the first sheet every time you refresh the data, which can be set to automatically refresh when you open the file.  Here's how:</p>\n\n<p>Use \"Insert > Table\" to format the first list.  Then use \"Summarize with PivotTable\" or \"Insert > PivotTable\" (2 names for the same feature) to put your PivotTable on the next sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lc8Sp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lc8Sp.png\" alt=\"Make your data into a table\"></a></p>\n\n<p>Put all the columns you want in the second sheet under \"Row Labels\" on the PivotTable wizard thingy that appears.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Iph2o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Iph2o.png\" alt=\"enter image description here\"></a></p>\n\n<p>Under PivotTable Tools > Design > Layout > Subtotals, choose \"Do not show subtotals.\"\nUnder PivotTable Tools > Design > Layout > Grand Totals, choose \"Off for Rows and Columns.\"\nUnder PivotTable Tools > Design > Layout > Report Layout, choose \"Show in Tabular Form.\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/XIj9n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XIj9n.png\" alt=\"Here&#39;s what you get\"></a></p>\n\n<p>Note that if you don't have something unique at the top of the list in Row Labels, similar to \"ID\" in my example (  =ROW()  ), the PivotTable will do intelligent things with the data that you may not want.</p>\n\n<p>Here's how to get the thing to refresh automatically when the file opens.  Alternately, you right-click on the table and choose \"refresh\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/fxejZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fxejZ.png\" alt=\"PivotTable options\"></a>\n<a href=\"https://i.stack.imgur.com/cj9po.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cj9po.png\" alt=\"Refresh data on file open\"></a></p>\n\n<p>If you wanted to refresh the PivotTable every time the data changes, put</p>\n\n<pre><code>Sheets(\"Sheet2\").PivotTables(1).PivotCache.Refresh\n</code></pre>\n\n<p>(substituting \"Sheet2\" with the name of the sheet where the table appears; activating the data sheet on the left side; select Worksheet on the first pull-down, and select Change on the second pull-down to access the Sub Worksheet_Change code area)</p>\n\n<p>...here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9HicC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9HicC.png\" alt=\"Refresh PivotTable on data changes\"></a></p>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 19, "user_id": 6696048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77fdcac8e640f29a9c35d89a60648c2?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Albertson", "link": "https://stackoverflow.com/users/6696048/peter-albertson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "closed_date": 1521668306, "accepted_answer_id": 49416664, "answer_count": 2, "score": -2, "last_activity_date": 1521670456, "creation_date": 1521662233, "last_edit_date": 1531161705, "question_id": 49415482, "link": "https://stackoverflow.com/questions/49415482/filling-formulas-automatically-as-data-increase-and-sort-dynamically", "closed_reason": "Duplicate", "title": "Filling formulas automatically as data increase and sort dynamically", "body": "<p>I want to sort data in a worksheet, which gets new rows daily, in a second worksheet.</p>\n\n<p>The problem is, if I use the SMALL()-function and fill the cells automatically till the last row (A102482 or something like that), my file gets very huge and laggy (>20mb). </p>\n\n<p>Of course the person adding a new line could expand the formula in the second worksheet into a new row, but this is not userfriendly at all!</p>\n\n<p>What would be the best solution? I thought about vba-code, which counts the entries in the first worksheet, and then runs a code like this </p>\n\n<pre><code>for (i to numberrows; i++) { SMALL(A + i + 2*3, i) }\n</code></pre>\n\n<p>filling the first few rows in the second worksheet so the excel-file doesn't get too big...</p>\n\n<p>Thanks in advance!</p>\n\n<p>Edit.:</p>\n\n<p>To be more specific:</p>\n\n<p>What I'm asking excel to do is copy a worksheet and have the rows sorted on the second worksheet. And as the table expends, of course the sorted table has more values. This process should be done automatically, with the user only entering new data in the first worksheet and seeing the results in the second worksheet. Having the second worksheet's cells all already populates witht the SMALL() function is not an option, as this would work in my case, but this is way too slow and the files get too big...</p>\n"}, {"tags": ["vba", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1521663070, "post_id": 49415526, "comment_id": 85833110, "body": "YOu should also try to not use Select.  Just access the pivot table directly like: Sheets(&quot;Labor Detail&quot;).PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;WBS1&quot;)."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 2, "last_activity_date": 1521662408, "creation_date": 1521662408, "answer_id": 49415526, "question_id": 49414537, "link": "https://stackoverflow.com/questions/49414537/macro-to-filter-pivot-table/49415526#49415526", "title": "Macro to Filter Pivot Table", "body": "<p>Try this instead:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Column = 1 And Target.Value &lt;&gt; \"\" Then\n        Sheets(\"Labor Detail\").Select\n        ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"WBS1\").ClearAllFilters\n        ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"WBS1\").CurrentPage = Target.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p>I got rid of <code>Selection.Count = 1</code> as I don't think that's really doing anything. Instead I'm testing against <code>Target.Value</code> to make sure you have something to filter your pivot table by.</p>\n"}], "owner": {"reputation": 23, "user_id": 3740736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4011bd9cbe2475e66c16c0d975710aad?s=128&d=identicon&r=PG&f=1", "display_name": "user3740736", "link": "https://stackoverflow.com/users/3740736/user3740736"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 49415526, "answer_count": 1, "score": 1, "last_activity_date": 1521662408, "creation_date": 1521658585, "question_id": 49414537, "link": "https://stackoverflow.com/questions/49414537/macro-to-filter-pivot-table", "title": "Macro to Filter Pivot Table", "body": "<p>I have a dataset where i want to click on a cell in column A and it filters a pivot table on a different worksheet. I have this code so far:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Selection.Count = 1 Then\n        If Not Intersect(Target, Range(\"A2\")) Is Nothing Then           \n            Sheets(\"Labor Detail\").Select\n            ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"WBS1\").ClearAllFilters\n            ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"WBS1\").CurrentPage = Range(\"A2\").Value \n               End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>It does what i want but only for one cell. I want to be able to click on ANY cell in column A and have the cell value filter the pivot table. How do i specify a range instead of just one cell?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1521658798, "creation_date": 1521658798, "answer_id": 49414596, "question_id": 49414144, "link": "https://stackoverflow.com/questions/49414144/changing-color-of-cell-based-on-color-of-different-cell/49414596#49414596", "title": "Changing color of cell based on color of different cell", "body": "<p>I'd avoid conditional formatting since it can quickly run out of control</p>\n\n<p>furthermore cells formatted by conditional formatting need a special way of getting spotted</p>\n\n<p>so I propose you the following code:</p>\n\n<pre><code>Option Explicit\n\nSub ColorUniquesInEachRow()\n    Dim LastColumn As Long\n    Dim RowIndex As Long\n    Dim cell As Range\n    Dim unique As Boolean\n\n    For RowIndex = 6 To Cells(Rows.count, 1).End(xlUp).Row\n        LastColumn = Cells(RowIndex, Columns.count).End(xlToLeft).Column\n\n        unique = False\n\n        With Range(Cells(RowIndex, 4), Cells(RowIndex, LastColumn))\n\n            For Each cell In .SpecialCells(xlCellTypeConstants)\n                If WorksheetFunction.CountIf(.Cells, cell.Value) = 1 Then\n                    With cell.Font\n                        .ColorIndex = 3\n                        .Bold = True\n                    End With\n                    unique = True\n                End If\n            Next\n\n            If unique Then Cells(RowIndex, 1).Interior.ColorIndex = 6\n\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 9259753, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7207f19162660433529f7f726ae62f3b?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine Reed", "link": "https://stackoverflow.com/users/9259753/katherine-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 49414596, "answer_count": 1, "score": 0, "last_activity_date": 1521658798, "creation_date": 1521657225, "last_edit_date": 1521658302, "question_id": 49414144, "link": "https://stackoverflow.com/questions/49414144/changing-color-of-cell-based-on-color-of-different-cell", "title": "Changing color of cell based on color of different cell", "body": "<p>I found Excel VBA code online that highlights unique values in a row in excel. My table has about a hundred rows, and the code checks each row for unique values. I have tweaked the code a little bit for my purposes, so the code now just changes the font color of the unique values. The code works perfectly, but I want to add an additional element to the code, and I'm not sure how to do it. </p>\n\n<p><a href=\"https://i.stack.imgur.com/jxBVG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jxBVG.png\" alt=\"img\"></a></p>\n\n<p>You can see in this partial photo of my table the red unique numbers. However, the code is set up to only search for unique values from the third column in the photo to the last column (the column containing all 1s is its own column). What I want to add to the code is that after a unique value is found in a row and the font color of that value is changed, I want the cell in the first column of that row to be highlighted yellow. </p>\n\n<p>For example, I know that there is a unique value in the first row because the last value in that row is red. Now that a unique value in the first row has been found, I want the first cell in that row to be highlighted yellow. However, in the fifth row of my table, there are no unique values and so none of the values in that row are red, so I don't want anything about the first cell in that row to change.</p>\n\n<p>Does anyone have any ideas about how to change my code in order to produce the desired results?</p>\n\n<p>Thank you in advance.</p>\n\n<p>The current code:</p>\n\n<pre><code>Option Explicit\n\nSub ColorUniquesInEachRow()\n\n    Dim LastRow As Long\n    Dim LastColumn As Long\n    Dim RowIndex As Long\n\n    LastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For RowIndex = 6 To LastRow\n        LastColumn = Cells(RowIndex, Columns.Count).End(xlToLeft).Column\n\n        With Range(Cells(RowIndex, 4), Cells(RowIndex, LastColumn))\n            .FormatConditions.AddUniqueValues\n            .FormatConditions(.FormatConditions.Count).SetFirstPriority\n            .FormatConditions(1).DupeUnique = xlUnique\n            With .FormatConditions(1).Font\n                .ColorIndex = 3\n                .Bold = True\n            End With\n            .FormatConditions(1).StopIfTrue = False\n        End With\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel", "nodevalue"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521656989, "post_id": 49413994, "comment_id": 85829708, "body": "what error? where?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521657222, "post_id": 49413994, "comment_id": 85829824, "body": "Also, the XML is malformed.  Last line should be <code>&lt;&#47;Application&gt; &lt;&#47;Applications&gt; &lt;&#47;Extract&gt;</code>"}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521657246, "post_id": 49413994, "comment_id": 85829837, "body": "Run time error - 91 : Object variable or with block variable not set  errors occurs in   Extract = extractnodes(i).NodeValue ; since the node value returns empty from input XML"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521657281, "post_id": 49413994, "comment_id": 85829854, "body": "error on which line?"}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521657489, "post_id": 49413994, "comment_id": 85829955, "body": "error on line 6:  Extract = extractnodes(i).NodeValue"}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521657597, "post_id": 49413994, "comment_id": 85830015, "body": "updated the input XML;  My results should be as below. This is how it looks in the table.  extract date--name--addr"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1521663716, "post_id": 49413994, "comment_id": 85833456, "body": "@Raja, Fix your malformed xml snippet that ashleedawg has already pointed out. I believe, you are here to seek a solution not to confuse others with the portion of elements you have pasted above."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521663989, "post_id": 49413994, "comment_id": 85833577, "body": "I&#39;ve already tidied up your code myself once...  After you fix it, does the error still occur?  If so, what is the value of the related variable(s) at the time of the error?"}], "answers": [{"comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1521667733, "post_id": 49416056, "comment_id": 85835414, "body": "Nice! A side question: which is the meaning of the colon after <code>r=r+1</code>?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 1, "creation_date": 1521667946, "post_id": 49416056, "comment_id": 85835512, "body": "Using colon you can fit multiple lines in a single line. That is not necessary to use. However, I did it to save the space."}, {"owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "edited": false, "score": 0, "creation_date": 1521743996, "post_id": 49416056, "comment_id": 85874209, "body": "Thank you for the response.  Can you tell the meaning of the statement                 For Each post In .SelectNodes(&quot;//Extract//Application&quot;)                         ***what does the &quot;//&quot; mean ?                     ***  what happens if I use the FIlename.SelectNode                              instead of .SelectNode"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1521666392, "last_edit_date": 1521666392, "creation_date": 1521664643, "answer_id": 49416056, "question_id": 49413994, "link": "https://stackoverflow.com/questions/49413994/node-value-returns-null-for-a-xml-input/49416056#49416056", "title": "Node value returns null for a XML Input", "body": "<p>Try using the below portion of elements within <code>content.xml</code> file in desktop and run the below code.</p>\n\n<p>within <code>content.xml</code> file:</p>\n\n<pre><code>&lt;Extract&gt;\n    &lt;ExtractDate&gt;2018-02-21 10:01:01&lt;/ExtractDate&gt;\n    &lt;Applications&gt;\n        &lt;Application&gt;         \n            &lt;Name&gt;1234&lt;/Name&gt;\n            &lt;Addr&gt;700ST&lt;/Addr&gt;\n        &lt;/Application&gt;    \n        &lt;Application&gt;            \n            &lt;Name&gt;123466&lt;/Name&gt;\n            &lt;Addr&gt;277AVD&lt;/Addr&gt;\n        &lt;/Application&gt;\n    &lt;/Applications&gt;\n&lt;/Extract&gt;\n</code></pre>\n\n<p>Script to parse the value from:</p>\n\n<pre><code>Sub DemoXML()\n    Dim post As Object\n\n    With CreateObject(\"MSXML2.DOMDocument\")\n        .async = False: .validateOnParse = False\n        .Load (ThisWorkbook.path &amp; \"\\content.xml\")\n\n        For Each post In .SelectNodes(\"//Extract//Application\")\n            r = r + 1: Cells(r, 1) = post.ParentNode.ParentNode.FirstChild.Text\n            Cells(r, 2) = post.SelectNodes(\".//Name\")(0).Text\n            Cells(r, 3) = post.SelectNodes(\".//Addr\")(0).Text\n        Next post\n    End With\nEnd Sub\n</code></pre>\n\n<p>Populated results:</p>\n\n<pre><code>2/21/2018 10:01 1234    700ST\n2/21/2018 10:01 123466  277AVD\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1532274628, "creation_date": 1532274628, "answer_id": 51466779, "question_id": 49413994, "link": "https://stackoverflow.com/questions/49413994/node-value-returns-null-for-a-xml-input/51466779#51466779", "title": "Node value returns null for a XML Input", "body": "<p>Better answer already given but here is a variation:</p>\n\n<pre><code>Option Explicit\nPublic Sub DemoXML()\n    Dim post As Object, R As Long, C As Long, dateString As String\n    With CreateObject(\"MSXML2.DOMDocument\")\n         .async = False: .validateOnParse = False\n        .Load \"C:\\Users\\User\\Desktop\\random.xml\"\n        dateString = .SelectSingleNode(\"//ExtractDate\").Text\n\n        For Each post In .SelectNodes(\"//Application\")\n            R = R + 1: Cells(R, 1) = dateString\n            Cells(R, 2) = post.FirstChild.Text\n            Cells(R, 3) = post.LastChild.Text\n        Next post\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8382644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06600844895d17930ab396e99175081f?s=128&d=identicon&r=PG&f=1", "display_name": "Raja", "link": "https://stackoverflow.com/users/8382644/raja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532274628, "creation_date": 1521656689, "last_edit_date": 1521658318, "question_id": 49413994, "link": "https://stackoverflow.com/questions/49413994/node-value-returns-null-for-a-xml-input", "title": "Node value returns null for a XML Input", "body": "<p>GETTING ERROR for the below macro script. Need extract date, name and address in a single table. Since there is only one value of date, the second value returns null. </p>\n\n<p>However I need the same value to be present in all records of extract date </p>\n\n<pre><code>Set ApplicationsNode = oXMLFile.SelectNodes(\"/Extract/Applications/Application\")\nSet extractnodes = oXMLFile.SelectNodes(\"/Extract/ExtractDate\")\nSet NameNode = oXMLFile.SelectNodes(\"/Extract/Applications/Application/Name/text()\")\nSet AddrNode = oXMLFile.SelectNodes(\"/Extract/Applications/Application/Addr/text()\")\n\nFor i = 0 To (ApplicationsNode.Length - 1)\n\n    Extract = extractnodes(i).NodeValue\n    Name = NameNode(i).NodeValue\n    Addr = AddrNode(i).NodeValue\n\n    mainWorkBook.Sheets(\"Sheet1\").Range(\"A\" &amp; i + 2).Value = Extract\n    mainWorkBook.Sheets(\"Sheet1\").Range(\"C\" &amp; i + 2).Value = Name\n    mainWorkBook.Sheets(\"Sheet1\").Range(\"D\" &amp; i + 2).Value = Addr\n\nNext\n</code></pre>\n\n<p>Input XML:</p>\n\n<pre><code> &lt;Extract&gt;\n     &lt;ExtractDate&gt;2018-02-21 10:01:01&lt;/ExtractDate&gt;\n       &lt;Applications&gt;\n          &lt;Application&gt;         \n             &lt;Name&gt;1234&lt;/Name&gt;\n             &lt;Addr&gt;700ST&lt;/Addr&gt;\n          &lt;/Application&gt;    \n       &lt;Application&gt;            \n            &lt;Name&gt;123466&lt;/Name&gt;\n            &lt;Addr&gt;277AVD&lt;/Addr&gt;\n       &lt;/Application&gt;\n       &lt;Applications&gt;\n      &lt;/Extract&gt;\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "hash", "passwords", "ms-access-2016"], "comments": [{"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1521658029, "post_id": 49413844, "comment_id": 85830297, "body": "1. Rfc2898DeriveBytes is the way to go, you just need to figure out how to pass the arguments and debug. 2. Where does the error occur? 3. Why do you need to convert the binary to hex? Just save the binary and later compare."}, {"owner": {"reputation": 73, "user_id": 2677623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1bcaf5f6b2743b08d75edc998f7b01?s=128&d=identicon&r=PG&f=1", "display_name": "OofYeetMcGee", "link": "https://stackoverflow.com/users/2677623/oofyeetmcgee"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1521660181, "post_id": 49413844, "comment_id": 85831543, "body": "The error occurs at PBKDF2 = ByteArrayToHex(bytes), but it&#39;s a compile error not a runtime error. Also, they don&#39;t need to be converted to Hex, but that&#39;s how I stored the SHA1 hashes and was trying to be consistent"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1521662352, "post_id": 49413844, "comment_id": 85832697, "body": "Figure out how to pass the arguments, read the documentation."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 1, "creation_date": 1521663500, "post_id": 49413844, "comment_id": 85833328, "body": "I don&#39;t know what language you are using, but it is <i>not</i> VBA! First clue: <code>inter As Int32</code>. The correct VBA type is <code>Long</code>. When I correct the code in Access, and run it, it fails at the <code>Set oRFC = CreateObject(&quot;...</code> line with <code>Error 429: ActiveX component can&#39;t create object</code>. Please edit your code so it compiles in VBA, and fix the <code>CreateObject</code> line, and resubmit your question if you have any further problems."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1521668209, "post_id": 49413844, "comment_id": 85835643, "body": "Can&#39;t fix that <code>CreateObject</code>, though. Afaik <code>Rfc2898DeriveBytes</code> is not available through COM. You need to make a custom COM class using a .Net programming language (VB.Net, C#, C++)"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1521670478, "post_id": 49413844, "comment_id": 85836620, "body": "Since PBKDF2 rely on hmac and sha1, an alternative would be to use <code>System.Security.Cryptography.HMACSHA1</code> in a loop. See <a href=\"https://www.sjoerdlangkemper.nl/2016/05/25/iterative-password-hashing/\" rel=\"nofollow noreferrer\">sjoerdlangkemper.nl/2016/05/25/iterative-password-hashing</a>"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1521719344, "post_id": 49413844, "comment_id": 85856818, "body": "@ErikvonAsmuth See <a href=\"https://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=vb#code-snippet-1\" rel=\"nofollow noreferrer\">Rfc2898DeriveBytes Class</a> <code>&lt;ComVisibleAttribute(True)&gt; Public Class Rfc2898DeriveBytes \tInherits DeriveBytes</code>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 1, "creation_date": 1521722771, "post_id": 49413844, "comment_id": 85859359, "body": "@zaph I guess I didn&#39;t word it well. You can&#39;t fix it because the VBA doesn&#39;t support constructors with parameters. I don&#39;t know of a workaround outside of using a different programming language to create a com class that doesn&#39;t require them."}], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 1, "last_activity_date": 1521838925, "creation_date": 1521838925, "answer_id": 49458258, "question_id": 49413844, "link": "https://stackoverflow.com/questions/49413844/implementing-pbkdf2/49458258#49458258", "title": "Implementing PBKDF2", "body": "<p>@zaph and @EricvonAsmuth both have valid points. It looks like <code>Rfc2898DeriveBytes</code> can't be directly used in VBA. It might be simpler to try another path.</p>\n\n<p>There are native VB6/VBA SHA1 implementations you can find online. You can test these against online SHA1 generators to verify validity. </p>\n\n<p>Depending on your comfort level with .NET and COM, this approach might be easier.</p>\n"}], "owner": {"reputation": 73, "user_id": 2677623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1bcaf5f6b2743b08d75edc998f7b01?s=128&d=identicon&r=PG&f=1", "display_name": "OofYeetMcGee", "link": "https://stackoverflow.com/users/2677623/oofyeetmcgee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 49458258, "answer_count": 1, "score": 0, "last_activity_date": 1594650774, "creation_date": 1521656206, "last_edit_date": 1594650774, "question_id": 49413844, "link": "https://stackoverflow.com/questions/49413844/implementing-pbkdf2", "title": "Implementing PBKDF2", "body": "<p>I've been building a custom access DB and I have added a login screen with usernames and passwords. Originally I used SHA1 and no salt to hash the passwords. (I know that's not very secure, but it was only meant for a few users and contained no personal information)</p>\n\n<p>However corporate has seen the DB application and they want to install it and add more users and features. I'd like to start using Salts and PBKDF2 to has the passwords, but I couldn't find any information on PBKDF2 with MS Acess specifically. Below are the 2 functions I pieced together</p>\n\n<pre><code>Public Function PBKDF2(pass As String, salt As String, inter As Int32) As String\n\n    Set oT = CreateObject(\"System.Text.UTF8Encoding\")\n    Dim bytes() As Byte\n\n    TextToHash = oT.GetBytes_4((pass))\n    SaltBytes = oT.GetBytes_4((salt))\n\n    Set oRFC = CreateObject(\"System.Security.Cryptography.Rfc2898DeriveBytes( (TextToHash), (SaltBytes), inter )\")\n\n    bytes() = oRFC.GetBytes(16)\n\n    PBKDF2 = ByteArrayToHex(bytes())\n\nEnd Function\n\n\nPrivate Function ByteArrayToHex(ByRef ByteArray() As Byte) As String\n\n    Dim lb As Long, ub As Long\n    Dim l As Long, strRet As String\n    Dim lonRetLen As Long, lonPos As Long\n    Dim strHex As String, lonLenHex As Long\n\n    lb = LBound(ByteArray)\n    ub = UBound(ByteArray)\n    lonRetLen = ((ub - lb) + 1) * 3\n    strRet = Space$(lonRetLen)\n    lonPos = 1\n\n    For l = lb To ub\n        strHex = Hex$(ByteArray(l))\n        If Len(strHex) = 1 Then\n            strHex = \"0\" &amp; strHex\n        End If\n        If l &lt;&gt; ub Then\n            Mid$(strRet, lonPos, 3) = strHex &amp; \" \"\n            lonPos = lonPos + 3\n        Else\n            Mid$(strRet, lonPos, 3) = strHex\n        End If\n    Next l\n\n    ByteArrayToHex = strRet\n\nEnd Function\n</code></pre>\n\n<p>I get the error </p>\n\n<blockquote>\n  <p>\"ByRef argument mismatch\"</p>\n</blockquote>\n\n<p>Is there a better way to implement PBKDF2 in Access VBA, or is there a fix for these functions?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521655604, "post_id": 49413682, "comment_id": 85828924, "body": "This is an \u201cI want a pony\u201d question and it\u2019s too broad to give a specific technical answer, making it off-topic here on Stack Overflow. You\u2019ll need to attempt to solve this problem and show your code so we can understand what you\u2019re trying to do on a technical level as well as to demonstrate your commitment to solving this problem."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9530320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "vincent g&#233;linas", "link": "https://stackoverflow.com/users/9530320/vincent-g%c3%a9linas"}, "edited": false, "score": 0, "creation_date": 1521656991, "post_id": 49413758, "comment_id": 85829711, "body": "This is perfect thank you very much !"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1521655895, "creation_date": 1521655895, "answer_id": 49413758, "question_id": 49413682, "link": "https://stackoverflow.com/questions/49413682/convert-csv-separated-file-to-xlsx-file/49413758#49413758", "title": "Convert .CSV |-separated file to .xlsx file", "body": "<p>you could use this sub</p>\n\n<pre><code>Sub main()\n\n    Range(\"A1\", Cells(Rows.count, 1).End(xlUp)).TextToColumns , , , , , , , , True, \"|\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9530320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "vincent g&#233;linas", "link": "https://stackoverflow.com/users/9530320/vincent-g%c3%a9linas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1521709965, "accepted_answer_id": 49413758, "answer_count": 1, "score": -2, "last_activity_date": 1521655895, "creation_date": 1521655563, "question_id": 49413682, "link": "https://stackoverflow.com/questions/49413682/convert-csv-separated-file-to-xlsx-file", "closed_reason": "Needs more focus", "title": "Convert .CSV |-separated file to .xlsx file", "body": "<p>I have a .CSV file that is generated every day that opens in an Excel workbook. It is separated by | character like this: </p>\n\n<pre><code>0-1-C|COUTEAU \u00c0 HUITRE RICHARD|||||40|5,99|0|0|0|0|0|0|0|0|0|2,65|\n 0000|ARTICLEVENTEFINALEd\u00e9monstrateur|||||945|9999,99|0|0|0|0|0|0|0|0|0|0|||||\n00007|SUPER D\u00c9TACHANT OOPS!|||SUPER D\u00c9TACHANT||100|3,99|\n</code></pre>\n\n<p>Each line of the text above is in the first cell of a line .I'd like to generate a version of this file in another Excel workbook that uses one cell per string between |. The file is about 6200 lines long and since its generated everyday, I need it to juste loop over every line and create a new one in the document. I'm very new to VBA and and this website so p-lease be patient with me, thank you very much !</p>\n"}, {"tags": ["vba", "dropdown", "excel-web-query"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521656723, "post_id": 49413670, "comment_id": 85829557, "body": "Application.DisplayAlerts = False before and set to true at end if otherwise your code is fine?"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521656814, "post_id": 49413670, "comment_id": 85829606, "body": "@QHarr, do you mean before the call to the function? Because I disable events in my function code."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521657583, "post_id": 49413670, "comment_id": 85830008, "body": "Excel needs to resize the table because there&#39;s new data (etc) but it can&#39;t because you have other stuff in the way."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521658898, "post_id": 49413670, "comment_id": 85830836, "body": "&quot;I have 3 web queries on a single data sheet&quot; - a while back I started treating Excel sheets as data entities: one data sheet only ever contains one single table. Never had this kind of problem ever since. Is there any particular reason why the 3 tables need to be on the same sheet?"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521659024, "post_id": 49413670, "comment_id": 85830901, "body": "@ashleedawg I understand there is new data. I tried changing the refresh style to xlInsertEntireRows , but I&#39;m wondering if I should change it to xlOverwritecells."}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521659065, "post_id": 49413670, "comment_id": 85830927, "body": "@MathieuGuindon Not really I could technically place them on different sheets, but the idea was to minimize the number of tabs on my template, so because they are small tables I ideally want them all on one sheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521659130, "post_id": 49413670, "comment_id": 85830966, "body": "I hear ya. If they&#39;s just data that the rest of the workbook uses, I&#39;d make them hidden sheets - then it doesn&#39;t matter how many sheets there are :)"}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "edited": false, "score": 0, "creation_date": 1521659441, "post_id": 49413670, "comment_id": 85831129, "body": "Is there no property / fix for this issue? This is bugging me :S"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521660436, "post_id": 49413670, "comment_id": 85831680, "body": "The table needs to expand to accomodate the query results, but as @ashleedawg noted, another table is in the way. You need to make sure there&#39;s sufficient available space to refresh. IMO the best way to ensure that is to only ever have 1 table per worksheet. YMMV, but at the end of the day, you need extra columns (rows?) somewhere."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1521664102, "post_id": 49413670, "comment_id": 85833649, "body": "agreed - always isolate each raw data source away from formatting, formulas, and other data sources."}, {"owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "edited": false, "score": 0, "creation_date": 1521664139, "post_id": 49413670, "comment_id": 85833674, "body": "Ok thanks I guess I will put in on a separate sheet and try that ."}], "owner": {"reputation": 280, "user_id": 6372968, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4db80129e8b21b08aa62b4aa1255b4cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mirabelli", "link": "https://stackoverflow.com/users/6372968/mike-mirabelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521655609, "creation_date": 1521655531, "last_edit_date": 1521655609, "question_id": 49413670, "link": "https://stackoverflow.com/questions/49413670/web-query-refresh-error", "title": "Web query refresh error", "body": "<p>I have 3 workbook web queries on a single data sheet , and I have a dropdown object with a  list of months in the year (1-12). My idea for the automation was to have the query formula update based on the user selection of the dropdown value and update the query formula accordingly and refresh.</p>\n\n<p>The VBA code works fine, but I get this message for one of the queries.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mCdw2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mCdw2.png\" alt=\"enter image description here\"></a></p>\n\n<p>The reason is that the query (ex when changed from month 2 to month 3), has 2 more lines and is not the exact table height.</p>\n\n<p>Any ideas how to debug this / circumvent this message. Code below:</p>\n\n<pre><code>Sub DropDown9_Change()\n\nDim wbconn As WorkbookConnection, qT As QueryTable\nDim wB As Workbook, wS As Worksheet\n\n'For Each wbconn In ThisWorkbook.Connections\n'Debug.Print wbconn.Name &amp; \" - \" &amp; wbconn.OLEDBConnection.CommandText &amp; \" - \" &amp; _\n'wbconn.OLEDBConnection.SourceDataFile\n''wbconn.Refresh\n'Next wbconn\n\nSet wB = Workbooks(\"OH Burdening Template.xlsb\")\n\nIf ShData.Shapes(\"Drop Down 9\").ControlFormat.Value &gt; _\nShCalendar.Range(\"B3\").Value Then\n\n    MsgBox \"Cannot be based on future periods!\", vbExclamation\n\nElse\n    'Refresh WB queries\n    Call Refresh_Queries(ShData.Shapes(\"Drop Down 9\").ControlFormat.Value, wB, ShData)\n\nEnd If\n\nShData.Columns.AutoFit\n\nEnd Sub\n\n\nPrivate Function Refresh_Queries(ByVal Period As Integer, ByVal wB As Workbook, _\nByVal thisSheet As Worksheet)\n\nWith Application\n.StatusBar = \"Now refreshing queries on :\" &amp; ShData.Name\n.ScreenUpdating = False\n.EnableEvents = False\nEnd With\n\nDim I As Integer, LObj As ListObject\nDim strL As Integer, str As String\nDim Pos As Integer\nDim F As String\nDim startPos As Integer\n\nstr = \"?year=2018&amp;period=\"\nstrL = Len(str)\n\nFor I = 1 To wB.Queries.Count\n\n    On Error GoTo view_err\n\n    F = wB.Queries(I).Formula\n    Pos = VBA.InStr(1, F, str, vbBinaryCompare)\n    startPos = Pos + strL\n\n    'Debug.Print F\n    'Replacing the period part of the string with the period entered in the dropdown\n\n    F = WorksheetFunction.Replace(F, startPos, 1, Period)\n    wB.Queries.Item(I).Formula = F\n\n    'Debug.Print Mid(F, startPos, 1)\n\nNext I\n\nFor Each LObj In thisSheet.ListObjects\n    Application.StatusBar = \"Refreshing \" &amp; LObj.Name\n    LObj.QueryTable.Refresh False\n    Debug.Print LObj.Name &amp; Chr(32) &amp; \"Refreshed successfully!\"\nNext LObj\n\nWith Application\n.StatusBar = False\n.ScreenUpdating = True\n.EnableEvents = True\nEnd With\n\nSet LObj = Nothing\n\nExit Function\n\nview_err:\nDebug.Print LObj.Name &amp; Chr(32) &amp; \"Refresh Failed!\"\nMsgBox Err.Description &amp; \" (\" &amp; Err.Number &amp; \")\", vbExclamation\n\nWith Application\n.StatusBar = False\n.ScreenUpdating = True\n.EnableEvents = True\nEnd With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "iteration"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521654727, "post_id": 49413115, "comment_id": 85828429, "body": "are you running this code from Excel or from another Office application?"}, {"owner": {"reputation": 1, "user_id": 8201976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776b400c4b4801d379160d0008e70992?s=128&d=identicon&r=PG&f=1", "display_name": "lclambe", "link": "https://stackoverflow.com/users/8201976/lclambe"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521665509, "post_id": 49413115, "comment_id": 85834360, "body": "I&#39;m running it from Access."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8201976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776b400c4b4801d379160d0008e70992?s=128&d=identicon&r=PG&f=1", "display_name": "lclambe", "link": "https://stackoverflow.com/users/8201976/lclambe"}, "edited": false, "score": 0, "creation_date": 1521663519, "post_id": 49413277, "comment_id": 85833339, "body": "Thanks for the quick response. I ran it and the msg correctly displays the full filename, but it still fails at the same place, with the same error.  Note: There are 3 xlsx files in the folder. They are identical except for their filenames."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1521654303, "creation_date": 1521654303, "answer_id": 49413277, "question_id": 49413115, "link": "https://stackoverflow.com/questions/49413115/error-on-second-iteration-application-defined-or-object-defined-error/49413277#49413277", "title": "Error On Second Iteration: Application-defined or object-defined error", "body": "<p>Just guessing that you are not iterating through an Excel file the second time, thus it throws an error. To debug it in ELI5 style, change your code like this:</p>\n\n<pre><code>Do While myfile &lt;&gt; \"\"\n    MsgBox myFile\n    'Format the excel report\n    strPathFileName = mypath &amp; myfile\n    'use for unpresented\n    Call formatExcelUnPresentedForImport(strPathFileName)\n    i = i + 1\n    myfile = Dir()\nLoop\n</code></pre>\n\n<p>and pay attention to the <code>MsgBox</code> every time. Is it showing what you think it should be showing?</p>\n"}], "owner": {"reputation": 1, "user_id": 8201976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/776b400c4b4801d379160d0008e70992?s=128&d=identicon&r=PG&f=1", "display_name": "lclambe", "link": "https://stackoverflow.com/users/8201976/lclambe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521654601, "creation_date": 1521653798, "last_edit_date": 1521654601, "question_id": 49413115, "link": "https://stackoverflow.com/questions/49413115/error-on-second-iteration-application-defined-or-object-defined-error", "title": "Error On Second Iteration: Application-defined or object-defined error", "body": "<p>This year I inherited support of about a dozen accdb applications in Office 2010 Win 7 that often manipulate external excel files. </p>\n\n<p>I keep getting the same error scenario. It is in my vba for excel commands, \nbut only AFTER the first iteration of a loop. It always works fine the first time through. Seems to have something to do with how I am identifying the objects. I've read multiple articles on best practices for working with the objects and the specific error but nothing has translated into a solution. Can someone ELI5 what I am doing wrong?</p>\n\n<p>In the example below it is throwing the error early in the second iteration at the <code>Range(\"A1\").Select</code> command. </p>\n\n<p>Code:</p>\n\n<pre><code>Sub runCleanAndImportUnpre()\n\nDim strFolder As String\nDim strTableDest As String\n\nstrTableDest = \"Unpresented_EOD_Import\"\nstrFolder = \"C:\\Users\\lclambe\\Projects\\Inputs\\test2\"\n\nCall CleanAndImportUnpresentedInAGivenFolder(strTableDest, strFolder)\n\nEnd Sub\n\n\nFunction CleanAndImportUnpresentedInAGivenFolder(strTable As String, strFolder As String)\n\n' Function that opens files in a folder, cleans them up and saves them.\n\nDim myfile\nDim mypath\nDim strPathFileName As String\nDim i As Integer\n'Call ClearData(strTable)\n\n'if it needs a backslash on the end, add one\nIf Right(strFolder, 1) &lt;&gt; \"\\\" Then\n   strFolder = strFolder &amp; \"\\\"\nEnd If\n\nmypath = strFolder\nChDir (strFolder)\nmyfile = Dir(mypath)\nChDir (mypath)\nmyfile = Dir(\"\")\ni = 1\n\nDo While myfile &lt;&gt; \"\"\n\n                'Format the excel report\n                 strPathFileName = mypath &amp; myfile\n\n                'use for unpresented\n                   Call formatExcelUnPresentedForImport(strPathFileName)\n\n            i = i + 1\n\n        myfile = Dir()\nLoop\nEnd Function\n\n\n\nFunction formatExcelUnPresentedForImport(filePath As String)\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' Note:\n' Called from CleanAndImportUnpresentedInAGivenFolder when\n' importing Unpresented reports\n'\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\nOn Error GoTo formatExcelUnPresentedForImport_Error\n\nDim strFilePath As String\nDim strReportType As String\nDim i As Integer\nDim iTotal_Row\nDim Lastrow As Long\nDim iCol As Integer\n\nDim appExcel As excel.Application\nDim wkb As excel.Workbook\nDim sht As Worksheet\nDim rng As Range\n\n\nstrReportType = reportType\nstrFilePath = filePath\n\nSet appExcel = New excel.Application\n appExcel.Visible = False\n\n           'Define the worksheet\n            Set wkb = appExcel.Workbooks.Open(strFilePath, ReadOnly:=False)\n\n          'Turn off error msg: \"minor loss of fidelity\" if you are sure no data will be lost\n            wkb.CheckCompatibility = False\n\n            'Expand Column to avoid scientific notation\n            appExcel.Columns(\"A:A\").EntireColumn.AutoFit\n\n           'Find last row\n\n           'FAILS HERE ON SECOND ITERATION OF LOOP:\n            Range(\"A1\").Select\n            ActiveCell(\"A1\").Select\n            Selection.End(xlDown).Select\n\n            'Delete the last 3 rows of totals\n            ActiveCell.offset(-2, 0).Select\n            Selection.EntireRow.Delete\n            Selection.EntireRow.Delete\n            Selection.EntireRow.Delete\n\n           'Add a TRIM of Cash Amount Field2 at column L\n            Range(\"L2\").Select\n            ActiveCell.FormulaR1C1 = \"=TRIM(RC[-9])\"\n            Range(\"L2\").Select\n\n            'Copy it to rest of cells to bottom\n            Selection.Copy\n            Lastrow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n            Selection.AutoFill Destination:=Range(\"L2:L\" &amp; Lastrow), Type:=xlFillDefault\n            Range(\"L2:L\" &amp; Lastrow).Select\n\n            'Delete original unformatted unpresented\n            Selection.Copy\n            ActiveSheet.Paste\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n\n            'Delete all the rows except Unpresented\n            Range(\"B:B,C:C,D:D,E:E,F:F,G:G,H:H,I:I,J:J,K:K\").Select\n            Range(\"K1\").Activate\n            Selection.Delete Shift:=xlToLeft\n\n            'Add a Header\n            Range(\"B1\").Select\n            ActiveCell.FormulaR1C1 = \"Unpresented\"\n\n        wkb.Save\n        wkb.Close\n        appExcel.Quit\n        Set wkb = Nothing\n        Set appExcel = Nothing\n\n On Error GoTo 0\n Exit Function\n\n  formatExcelUnPresentedForImport_Error:\n        Set wkb = Nothing\n        Set appExcel = Nothing\n\nstrMessage = \"Error \" &amp; err.Number &amp; \" (\" &amp; err.Description &amp; \") in procedure formatExcelUnPresentedForImport of Module modExternalExcelClean.\"\nstrMessage = strMessage &amp; \" Application will stop processing now.\" &amp; vbNewLine\nstrMessage = strMessage &amp; \"Please note or copy this error message and contact application developer for assistance.\"\nMsgBox strMessage, vbCritical + vbOKOnly, \"Error\"\nEnd\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521653770, "post_id": 49412921, "comment_id": 85827882, "body": "have a local boolean variable you pass out as the return of the function (i.e. pass an array back with (0) as your original and (1) as your boolean) set to True if err.number 5? Pass that back to SAData and test If ... ? Or use a global variable and set that"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557472121, "post_id": 49413219, "comment_id": 98783662, "body": "Did you try these answers?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521654630, "last_edit_date": 1521654630, "creation_date": 1521654137, "answer_id": 49413219, "question_id": 49412921, "link": "https://stackoverflow.com/questions/49412921/error-handling-between-modules/49413219#49413219", "title": "Error handling between modules", "body": "<p>Something like this if using global</p>\n\n<pre><code>Option Explicit\nPublic error5 As Boolean\n\nSub test()\n    '. . . . 'macro code Part1\n\n    SAtext = SAdata(SApage, \"A\")\n\n    If error5 Then\n\n        '. . . . . 'macro code part2\n    End If\n\n    '....\nEnd Sub\n\nPublic Function SAdata(SApage , \"A\" )\n    '. . . . Function code part1\n\n    On Error Resume Next\n    myresponse = Mid(xmlHTTP.responseText, InStr(1, xmlHTTP.responseText, \"Ref No.\", vbTextCompare), Len(xmlHTTP.responseText))\n\n    If Err.Number = 5 Then GoTo myBlank\n\n    On Error GoTo 0\n\n\n    '. . . . . function code part2\n\n    Exit Function\n\nmyBlank:\n    error5 = True\n    Set xmlHTTP = Nothing\n    Set oDoc = Nothing\n    Set objData = Nothing\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>Here is a rough and ready test case</p>\n\n<pre><code>Option Explicit\nPublic error5 As Boolean\n\n\nSub test()\n    '. . . . 'macro code Part1\n    Dim SAPage As Variant\n    Dim SAtext As String\n\n    SAPage = 1\n\n    SAtext = SAdata(SAPage, \"A\")\n\n    If error5 Then\n       '. . . . . 'macro code part2\n       Debug.Print \"The was a runtime error: \" &amp; error5\n\n    Else\n      Debug.Print \"No show\"\n    End If\n\n    '....\nEnd Sub\n\nPublic Function SAdata(ByVal SAPage As Variant, Optional ByVal myString As String = \"A\") As String\n    Dim myresponse As String\n    Dim xmlHTTP As Object\n    Dim oDoc As Object\n    Dim objData As Object\n\n    '. . . . Function code part1\n\n    On Error Resume Next\n    myresponse = Mid(vbNullString, Len(vbNullString) - 1)\n\n    If Err.Number = 5 Then GoTo myBlank\n\n    On Error GoTo 0\n\n\n    '. . . . . function code part2\n\n   Exit Function\n\nmyBlank:\n    error5 = True\n    Set xmlHTTP = Nothing\n    Set oDoc = Nothing\n    Set objData = Nothing\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 0, "last_activity_date": 1521656356, "creation_date": 1521656356, "answer_id": 49413891, "question_id": 49412921, "link": "https://stackoverflow.com/questions/49412921/error-handling-between-modules/49413891#49413891", "title": "Error handling between modules", "body": "<p>Another approach would be to rethrow an error instead of using a global flag.  Then in the calling method simply add error handling.  In the following code, I added the necessary code including <code>Exit Sub</code>:</p>\n\n<pre><code>Sub test()\n   'macro code Part1\n\n   On Error GoTo my5Error\n   SAtext = SAdata(SApage, \"A\")\n   On Error GoTo 0\n\n   'macro code part2\n\n   Exit Sub\n\nmy5Error:\n   ASSoffice = Empty\n   prv1 = Empty\n   TNT = Empty\n   On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>In the following code, don't forget to include the <code>Exit Function</code> statement, and then add the <code>Err.Raise</code> at the end.</p>\n\n<pre><code>Function SAdata(SApage, SALetter)\n   'Function code part1\n\n   On Error Resume Next\n   myresponse = Mid(xmlHTTP.responseText, InStr(1, xmlHTTP.responseText, \"Ref No.\", vbTextCompare), Len(xmlHTTP.responseText))\n   If Err.Number = 5 Then GoTo myBlank\n   On Error GoTo 0\n\n   'function code part2\n\n   Exit Function\n\nmyBlank:\n   Set xmlHTTP = Nothing\n   Set oDoc = Nothing\n   Set objData = Nothing\n   On Error GoTo 0\n   Err.Raise vbObjectError + 513, \"SAdata\", \"My error\"\nEnd Function\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 172, "user_id": 2885853, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5e8bdecf6b7e421c73f0470edbad4c63?s=128&d=identicon&r=PG&f=1", "display_name": "Glib", "link": "https://stackoverflow.com/users/2885853/glib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521656356, "creation_date": 1521653187, "question_id": 49412921, "link": "https://stackoverflow.com/questions/49412921/error-handling-between-modules", "title": "Error handling between modules", "body": "<p>I am trying to ensure that my error trapping is working correctly but not sure I understand the proper procedure for handling an error that was found in another module.</p>\n\n<p>If I had in module1</p>\n\n<pre><code>Sub test()\n. . . . 'macro code Part1\n\nSAtext = SAdata(SApage, \"A\")\n\n. . . . . 'macro code part2\n\nmy5Error:\nASSoffice = Empty\nprv1 = Empty\nTNT = Empty\nEnd sub\n</code></pre>\n\n<p>I would want the macro code part1 to run and call the SAdata function.  When the function runs, I want it to run the function code part1 and then check if err.number = 5 will occur.  If it doesn't then the error handling is reset, but if it does I want it to skip the 'function code part2' section and run the code at myBlank:  This part seems to work okay. </p>\n\n<pre><code>Function SAdata(SApage, \"A\")\n. . . . Function code part1\n\nOn Error Resume Next\n    myresponse = Mid(xmlHTTP.responseText, InStr(1, xmlHTTP.responseText, \"Ref No.\", vbTextCompare), Len(xmlHTTP.responseText))\n    If Err.Number = 5 Then GoTo myBlank\n    On Error GoTo 0\n\n. . . . . function code part2\nmyBlank:\nSet xmlHTTP = Nothing\nSet oDoc = Nothing\nSet objData = Nothing\nOn Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>After the error handling is complete for the function, how would I identify that an error had occurred in the function and to skip the 'macro code part2' section?</p>\n"}, {"tags": ["vba", "ms-word", "office-2007"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1521656045, "post_id": 49412736, "comment_id": 85829171, "body": "You must be really upset, considering the typos in the original of this message... I take it AutoNumDoc is supposed to be in Normal.dotm? Is this a Normal.dotm or a Normal.dot? Has it been moved at any point? Is the folder in which it&#39;s stored no longer trusted? Is it possible company IT policy has done something to change the trust settings of that folder? What does this code look like? Are you able to create a test macro in Normal.dot(m) and call that from another document?"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1521654266, "creation_date": 1521654266, "answer_id": 49413265, "question_id": 49412736, "link": "https://stackoverflow.com/questions/49412736/word-says-macros-are-disabled-but-settings-show-they-are-enabled/49413265#49413265", "title": "Word says macros are disabled but settings show they are enabled", "body": "<p>The problem is not the WordBasic.Call instruction.</p>\n\n<p>The hint was that macros were disbled, even though the Word settings said the were enabled.</p>\n\n<p>The cause is that I moved my templates to a new location so they would be backed-up, but didn't add that path to the <strong>Trusted Locations</strong> of the <strong>Trust Center</strong>.</p>\n"}], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 655, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593731339, "creation_date": 1521652637, "last_edit_date": 1593731339, "question_id": 49412736, "link": "https://stackoverflow.com/questions/49412736/word-says-macros-are-disabled-but-settings-show-they-are-enabled", "title": "Word says macros are disabled but settings show they are enabled", "body": "<p>I use Word 2007. I have a Word template that has an AutoNew macro. That macro sets a few document variables and then calls a macro in Normal.dot to do the real work. This was developed in WordBasic (Word 6.0).</p>\n\n<p>Suddenly it doesn't work anymore...</p>\n\n<pre><code>Public Sub MAIN()\n    ' This is an Auto-numbering document.\n    '\n    WordBasic.SetDocumentVar \"DocType\", \"brf\"   'communicate document type\n    WordBasic.SetDocumentVar \"DocLang\", \"e\"     'communicate document language\n    '\n    WordBasic.Call \"AutoNumDoc\"                 ' &lt;-- doesn't work anymore\nEnd Sub\n</code></pre>\n\n<p>It still worked on 5/17/2017. Macros are enabled. What has changed? Any suggestions?\n<hr>\nUpdate: Actually it complains that </p>\n\n<blockquote>\n  <p>macros in this project are disabled</p>\n</blockquote>\n\n<p>but WordOptions -> Trust Center -> Macro Options says they are enabled.</p>\n"}, {"tags": ["vba", "excel", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 2284846, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7fcb1600544529d8184ea1f10aa43d85?s=128&d=identicon&r=PG", "display_name": "JDCAce", "link": "https://stackoverflow.com/users/2284846/jdcace"}, "edited": false, "score": 1, "creation_date": 1521655766, "post_id": 49413025, "comment_id": 85829010, "body": "Excellent! That worked perfectly. I&#39;m still pretty new to VBA (coming from C#). Now that I have a method name, I can read up on it more."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 97, "user_id": 2284846, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7fcb1600544529d8184ea1f10aa43d85?s=128&d=identicon&r=PG", "display_name": "JDCAce", "link": "https://stackoverflow.com/users/2284846/jdcace"}, "edited": false, "score": 0, "creation_date": 1521656181, "post_id": 49413025, "comment_id": 85829252, "body": "@JDCAce - glad I could help. \u263a"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1521653807, "last_edit_date": 1521653807, "creation_date": 1521653499, "answer_id": 49413025, "question_id": 49412560, "link": "https://stackoverflow.com/questions/49412560/accessing-excel-sheet-specific-objects-from-a-self-defined-worksheet-object/49413025#49413025", "title": "Accessing Excel sheet-specific objects from a self-defined Worksheet object", "body": "<p>Considering the code below, your question can be rephrased to: Why <code>Debug.Print ws.checkbox1.value</code> gives an error and how to refer it:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Worksheets(1)\n    Debug.Print Worksheets(1).CheckBox1.Value\n\n    'v----&lt; Error if you uncomment!\n    'debug.Print ws.CheckBox1.value\n\n    'v----&lt; This works:\n    Debug.Print ws.OLEObjects(\"CheckBox1\").Object.Value\n\nEnd Sub\n</code></pre>\n\n<p>The answer is - with <code>OLEObjects(\"name\").Object</code></p>\n"}], "owner": {"reputation": 97, "user_id": 2284846, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7fcb1600544529d8184ea1f10aa43d85?s=128&d=identicon&r=PG", "display_name": "JDCAce", "link": "https://stackoverflow.com/users/2284846/jdcace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 49413025, "answer_count": 1, "score": 1, "last_activity_date": 1521653807, "creation_date": 1521652083, "last_edit_date": 1521652389, "question_id": 49412560, "link": "https://stackoverflow.com/questions/49412560/accessing-excel-sheet-specific-objects-from-a-self-defined-worksheet-object", "title": "Accessing Excel sheet-specific objects from a self-defined Worksheet object", "body": "<p>I have a workbook containing one sheet with a checkbox. I am currently accessing that checkbox (named cbFee) using <code>Sheets(\"Voltest\").cbFee</code>. This works as intended. However, I want to create a second workbook, so I've saved the first workbook containing my macros and the \"Voltest\" sheet as an object <code>wbMacros</code>. To help cut down on all the typing for <code>wbMacros.Sheets(\"Voltest\")</code>, I've shortened it by creating a Worksheet object <code>wsVoltest</code> and set it to that worksheet.</p>\n\n<p>However, when I then try to access the checkbox using <code>wsVoltest.cbFee</code>, I'm prompted with \"Compile error: Method or data member not found.\"</p>\n\n<p>Here's my code:</p>\n\n<p>Module 1:</p>\n\n<pre><code>Public wbMacros As Workbook\nPublic wbFinish As Workbook\nPublic wsVoltest As Worksheet\n\nSub Voltest()\n    Set wbMacros = ThisWorkbook\n    Set wbFinish = Workbooks.Add\n    Set wsVoltest = wbMacros.Sheets(\"Voltest\")\n\n    Application.run \"TabNames\"\nEnd Sub\n</code></pre>\n\n<p>Module 2:</p>\n\n<pre><code>Sub TabNames()\nDim voltestSheet As Worksheet\nSet voltestSheet = wbMacros.Sheets(\"Voltest\")\n\n' These two message boxes are for testing. They both display the correct value\nMsgBox \"wbMacros.Sheets: \" &amp; wbMacros.Sheets(\"Voltest\").Name\nMsgBox \"Voltest sheet: \" &amp; voltestSheet.Name\n\n' This If works just fine\nIf wbMacros.Sheets(\"Voltest\").cbFee.Value Then\n    MsgBox \"If hit\"\nEnd If\n' This If gives the compile error\nIf voltestSheet.cbFee.Value Then\n    MsgBox \"2nd If hit\"\nEnd If\n</code></pre>\n\n<p>I'm guessing wsVoltest.Name is working correctly because the Name property is inherent to all Worksheet objects, but checkboxes are not. How do I force the compiler to \"know\" about the objects that sheet contains?</p>\n"}, {"tags": ["vba", "ms-word", "classification", "document-classification"], "comments": [{"owner": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "edited": false, "score": 1, "creation_date": 1521652390, "post_id": 49412351, "comment_id": 85827011, "body": "Are you using <a href=\"http://www.itprotoday.com/windows-8/windows-server-2012-file-classification-infrastructure\" rel=\"nofollow noreferrer\">File Classification Infrastructure (FCI)</a>?"}, {"owner": {"reputation": 21, "user_id": 9530001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d336d5ecaf603315334c0e3154190ea6?s=128&d=identicon&r=PG&f=1", "display_name": "StuckwithVBA", "link": "https://stackoverflow.com/users/9530001/stuckwithvba"}, "reply_to_user": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "edited": false, "score": 0, "creation_date": 1521665234, "post_id": 49412351, "comment_id": 85834239, "body": "Hi @JoelSpolsky. I don\u2019t think so. I believe we have a very simple selection using the Microsoft Data Classification Toolkit. There is no system selection that takes place, or any official storage solution based on classification. All we have is 4 options on the menu in MS Word (highly restricted, restricted, internal, and public). When a document is created/edited the user then selects the classification based on our own rules. There is no system restriction on distribution or storage based on classification. It\u2019s solely used for the footers on the documents."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1521728907, "post_id": 49412351, "comment_id": 85864107, "body": "FWIW what you describe is not part of Microsoft Word and is not part of its object model. I don&#39;t know whether this functionality is exposed in any way VBA can access it..."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1521874999, "post_id": 49412351, "comment_id": 85927058, "body": "You say you&#39;re using content controls and formfields in the same document. You really shouldn&#39;t do that, since they weren&#39;t designed to work together and doing so is known to cause problems. FWIW content controls work with/without editing restrictions and, if desired, can work with either &#39;read only&#39; (with exceptions) and &#39;filling in forms&#39; protection."}], "owner": {"reputation": 21, "user_id": 9530001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d336d5ecaf603315334c0e3154190ea6?s=128&d=identicon&r=PG&f=1", "display_name": "StuckwithVBA", "link": "https://stackoverflow.com/users/9530001/stuckwithvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 598, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521651431, "creation_date": 1521651431, "question_id": 49412351, "link": "https://stackoverflow.com/questions/49412351/vba-code-to-change-microsoft-word-document-classification", "title": "VBA code to change Microsoft Word Document Classification", "body": "<p>I am really sorry for the newbie question. </p>\n\n<p>I have searched online for hours, and tried numerous options to see if I can do it, but haven\u2019t got very far. </p>\n\n<p>To start this question, I should say I am not a VBA coder by any stretch of the imagination, but I have created a document for my workplace that uses Rich text content controls (to provide guidelines in the document ensuring consistency), legacy form fields (to allow me to paste information into a set box based on selections) etc. \nThis document requires protection (and a password) to stop anyone editing it and to allow the legacy form fields to work. \nI have proven that the document works with around 1000 completed documents so far. \nI appreciate it is probably not the neatest of solutions, but the company is happy with it. \nA by product of the protection is that the document classification cannot be changed by the end user. \nFor reasons unknown to me, the company want to have the \u2018blank\u2019 document to be listed as \u2018internal\u2019, while a completed document needs to be \u2018restricted\u2019. Because the document is protected it gives an error stating that the original document has a different classification and to contact the owner (me). \nSo far, by cobbling together some information I have found online, I have managed to get a pop up box (via user form) to show when saving the document. \nI just cannot utilise these selections to change the document classification. \nAs far as I can tell, the classification system is the standard Microsoft option (not a third party software) \nMy question is, can this be done by VBA, even if I have to have the code remove the password, and then re-input the password. (I have done this for some other macros on the document. So I know that much). \nIf it is possible, can you point me in the direction of where to start. </p>\n"}, {"tags": ["excel", "ssis", "script-task", "vba"], "comments": [{"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1521662892, "post_id": 49412326, "comment_id": 85833002, "body": "Just a suggestion - is it possible your script tries to delete all sheets? - that would cause an error since there must be at least one left."}, {"owner": {"reputation": 99, "user_id": 9530039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8PMHm.jpg?s=128&g=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/9530039/bumblebee"}, "reply_to_user": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "edited": false, "score": 0, "creation_date": 1521677563, "post_id": 49412326, "comment_id": 85838740, "body": "your right !! it was my fault i was just deleting all the sheets. thanks for the help!!!"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 9530039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8PMHm.jpg?s=128&g=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/9530039/bumblebee"}, "edited": false, "score": 0, "creation_date": 1521676838, "post_id": 49416584, "comment_id": 85838569, "body": "Absolutely right !!!! awesome , It Worked!!!!!! Thank you for the help!!"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1521666670, "creation_date": 1521666670, "answer_id": 49416584, "question_id": 49412326, "link": "https://stackoverflow.com/questions/49412326/delete-certain-range-of-content-on-excel-using-script-task-on-ssis/49416584#49416584", "title": "Delete Certain Range of Content on Excel Using Script Task on SSIS", "body": "<p><em>I'm Trying to Delete some range(A2:BC2000) of Content</em></p>\n\n<p>In your code, you have these lines:</p>\n\n<pre><code> Wexcel.DisplayAlerts = False\nsheet.Delete()\nWexcel.DisplayAlerts = True\n</code></pre>\n\n<p>These 3 lines delete the sheet, not the range.</p>\n\n<p>If you just want to clear contents of the specified range, then use:</p>\n\n<pre><code>sheet.Range(\"A2:BC2000\").ClearContents\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 99, "user_id": 9530039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8PMHm.jpg?s=128&g=1", "display_name": "Bumblebee", "link": "https://stackoverflow.com/users/9530039/bumblebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 1, "accepted_answer_id": 49416584, "answer_count": 1, "score": 0, "last_activity_date": 1521666670, "creation_date": 1521651362, "last_edit_date": 1531164843, "question_id": 49412326, "link": "https://stackoverflow.com/questions/49412326/delete-certain-range-of-content-on-excel-using-script-task-on-ssis", "title": "Delete Certain Range of Content on Excel Using Script Task on SSIS", "body": "<p>I'm Trying to Delete some range(A2:BC2000) of Content on Excel using Script task on SSIS, or do you guys gave any alternate methods.\nHere is the code that i used </p>\n\n<pre><code>Public Sub Main()\n        Dim Wexcel As Microsoft.Office.Interop.Excel.Application = New Microsoft.Office.Interop.Excel.Application()\n        Dim Wb As Workbook = Wexcel.Workbooks.Open(\"C:\\Users\\Shawn\\Documents\\Depart.xlsx\")\n        Dim wf As WorksheetFunction = Wexcel.WorksheetFunction\n        Dim sheet As Worksheet\n\n        For Each sheet In Wexcel.Worksheets\n            If wf.CountA(sheet.Range(\"A2:BC20000\").Value) &gt; 0 Then\n                Wexcel.DisplayAlerts = False\n                sheet.Delete()\n                Wexcel.DisplayAlerts = True\n\n\n            End If\n        Next sheet\n        Dts.TaskResult = ScriptResults.Success\n    End Sub\n</code></pre>\n\n<p>if i run my package with this scripttask i'm getting an error below</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q9O77.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q9O77.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Can anyone has solution to this??</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1521656084, "last_edit_date": 1521656084, "creation_date": 1521655294, "answer_id": 49413596, "question_id": 49412242, "link": "https://stackoverflow.com/questions/49412242/using-vba-to-search-on-a-website/49413596#49413596", "title": "Using VBA to search on a website", "body": "<p>As at present you are only after the search results for a search term you could use either of the following where the searchTerm = \"BBC\" is concatenated into the URL. XMLHTTP60 would be what ever version is for your Excel as the XML reference library.</p>\n\n<pre><code>Option Explicit\n\nSub Getinfo2()\n\n    Dim http As New XMLHTTP60\n    Dim html As New HTMLDocument\n    Dim searchTerm As String\n\n    searchTerm = \"BBC\"\n\n    With http\n        .Open \"GET\", \"https://www.google.co.uk/search?safe=strict&amp;source=hp&amp;ei=Ep2yWvPDN8visAfVwIagBg&amp;q=\" &amp; searchTerm &amp; \"&amp;oq=\" &amp; searchTerm &amp; \"&amp;gs_l=psy-ab.3..35i39k1j0i131i67k1l3j0i131k1j0i131i67k1l3j0i67k1j0i131i67k1.1897.1897.0.3045.3.2.0.0.0.0.134.134.0j1.2.0....0...1.1.64.psy-ab..1.2.269.6...135.zC-Z7B8DrM4\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    Dim posts As MSHTML.IHTMLElementCollection 'add stuff to a collection etc\n    Dim post As MSHTML.IHTMLElement\n\n    '......\n\n\nEnd Sub\n</code></pre>\n\n<p>Or with IE    </p>\n\n<pre><code>Public Sub ScrapeIE()\n\n    Dim appIE As Object\n    Dim ihtml As Object\n    Dim searchTerm As String\n\n    searchTerm = \"BBC\"\n    Set appIE = CreateObject(\"internetexplorer.application\")\n\n    With appIE\n\n        .Visible = True\n        .navigate \"https://www.google.co.uk/search?safe=strict&amp;source=hp&amp;ei=Ep2yWvPDN8visAfVwIagBg&amp;q=\" &amp; searchTerm &amp; \"&amp;oq=\" &amp; searchTerm &amp; \"&amp;gs_l=psy-ab.3..35i39k1j0i131i67k1l3j0i131k1j0i131i67k1l3j0i67k1j0i131i67k1.1897.1897.0.3045.3.2.0.0.0.0.134.134.0j1.2.0....0...1.1.64.psy-ab..1.2.269.6...135.zC-Z7B8DrM4\"\n\n        While .Busy = True Or .readyState &lt; 4: DoEvents: Wend\n\n        Set ihtml = .document\n\n\n       ' .Quit\n\n    End With\n\n    Set appIE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1522365343, "last_edit_date": 1522365343, "creation_date": 1522365023, "answer_id": 49566320, "question_id": 49412242, "link": "https://stackoverflow.com/questions/49412242/using-vba-to-search-on-a-website/49566320#49566320", "title": "Using VBA to search on a website", "body": "<p>What are you trying to do?  Do Google searches and count the number of hits?  Try the script below and give me feedback.</p>\n\n<pre><code>Sub Gethits()\n    Dim url As String, lastRow As Long\n    Dim XMLHTTP As Object, html As Object, objResultDiv As Object, objH3 As Object, link As Object\n    Dim start_time As Date\n    Dim end_time As Date\n    Dim var As String\n    Dim var1 As Object\n\n    lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Dim cookie As String\n    Dim result_cookie As String\n\n    start_time = Time\n    Debug.Print \"start_time:\" &amp; start_time\n\n    For i = 2 To lastRow\n\n        url = \"https://www.google.com/search?q=\" &amp; Cells(i, 1) &amp; \"&amp;rnd=\" &amp; WorksheetFunction.RandBetween(1, 10000)\n\n        Set XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n        XMLHTTP.Open \"GET\", url, False\n        XMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\n        XMLHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0\"\n        XMLHTTP.send\n\n        Set html = CreateObject(\"htmlfile\")\n        html.body.innerHTML = XMLHTTP.ResponseText\n        Set objResultDiv = html.getelementbyid(\"rso\")\n        Set var1 = html.getelementbyid(\"resultStats\")\n        Cells(i, 2).Value = var1.innerText\n\n        DoEvents\n    Next\n\n    end_time = Time\n    Debug.Print \"end_time:\" &amp; end_time\n\n    Debug.Print \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\n    MsgBox \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\nEnd Sub\n</code></pre>\n\n<p>Put your search terms in ColumnA and run the script.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xdFij.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xdFij.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 9529984, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MidgetMan6711", "link": "https://stackoverflow.com/users/9529984/midgetman6711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 49413596, "answer_count": 2, "score": 0, "last_activity_date": 1522365343, "creation_date": 1521651135, "last_edit_date": 1521651591, "question_id": 49412242, "link": "https://stackoverflow.com/questions/49412242/using-vba-to-search-on-a-website", "title": "Using VBA to search on a website", "body": "<p>I'm trying to wrap my head around this as looking online this code though basic from what i can understand as no knowledge of VBA, Should at least just put in the search bar for google the word I put in. But it doesn't seem to am I missing something or have I done it completely wrong any pointers?</p>\n\n<p>I know it won't hit enter as not been added in yet, It will load the google page but that is it. </p>\n\n<p>Ideally after getting it to search is to expand on it to update an internal website with the information from a spreadsheet</p>\n\n<p>Also if anyone knows any good places to see for VBA code meaning ect, please advise.</p>\n\n<pre><code>Sub test()\nDim MyHTML_Element As IHTMLElement\nDim MyURL As String\n\nOn Error GoTo Err_Clear\nMyURL = \"google.com\"\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\nMyBrowser.navigate MyURL\nMyBrowser.Visible = True\nDo\nLoop Until MyBrowser.readyState = READYSTATE_COMPLETE\nSet HTMLDoc = MyBrowser.document\nie.document.getElementById(\"lst-ib\").Value = \"bbc\"\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nErr.Clear\nResume Next\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 2, "creation_date": 1521650969, "post_id": 49412128, "comment_id": 85826068, "body": "On the Redim Preserve line add &quot;As String&quot;  Why do you need <code>preserve</code> anyway if you are going to write over the array?  And another thing, use Dictionaries it saves hassle with arrays."}, {"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1521651134, "post_id": 49412128, "comment_id": 85826187, "body": "Should I just make all my arrays variant (since my array count is variant)?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1521651181, "post_id": 49412128, "comment_id": 85826212, "body": "I make all my dynamic &#39;array-like&#39;, &#39;list-like&#39; structures Dictionaries."}, {"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1521651355, "post_id": 49412128, "comment_id": 85826339, "body": "What&#39;s your key?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1521669901, "post_id": 49412128, "comment_id": 85836371, "body": "ah in those instances I write <code>dict.Add dict.Count, data</code> , so the key is the count of the dict"}], "answers": [{"comments": [{"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521651867, "post_id": 49412433, "comment_id": 85826679, "body": "Getting a Subscript out of range in ArrayCount() now."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521652187, "post_id": 49412433, "comment_id": 85826881, "body": "see edit to handle some flaws in your code. if my answer solved your <i>original</i> question you may consider marking it as accepted. thank you"}, {"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521652270, "post_id": 49412433, "comment_id": 85826934, "body": "Shoud it not be Private sRelatedTimekeeperNumbers()  As Variant with a ()?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521652407, "post_id": 49412433, "comment_id": 85827026, "body": "as you already experienced, it should not. since that way you are declaring an array of <code>Variant</code>s instead of a <code>Variant</code> variable  (that will eventually hold an array)"}, {"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521652497, "post_id": 49412433, "comment_id": 85827070, "body": "Ok, so if I do that, I get a &quot;type mismatch&quot; which I&#39;m assuming &quot;tmpArr As String&quot; needs to be &quot;tmpArr As Variant&quot; as well"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521652536, "post_id": 49412433, "comment_id": 85827097, "body": "and it solved the <i>original</i> question which is <i>&quot;Can&#39;t assign to array&quot;</i>. new issues call for new posts"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521653092, "post_id": 49412433, "comment_id": 85827446, "body": "you seem not to appreciate my solving your issue (and correcting some other code flaws, too) nor understand this site rules."}, {"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521653313, "post_id": 49412433, "comment_id": 85827580, "body": "Sorry, my mistake"}, {"owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "edited": false, "score": 0, "creation_date": 1521729572, "post_id": 49412433, "comment_id": 85864599, "body": "Thanks adding a clear critique and going above an beyond.  I&#39;m new to VB, so really helps."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1521661147, "last_edit_date": 1521661147, "creation_date": 1521651651, "answer_id": 49412433, "question_id": 49412128, "link": "https://stackoverflow.com/questions/49412128/cant-assign-to-array/49412433#49412433", "title": "Can&#39;t assign to array", "body": "<p><strong>edited</strong> to add some hints about the rest of the code</p>\n\n<p>as to the very issue of your question, just dim</p>\n\n<pre><code>Private sRelatedTimekeeperNumbers  As Variant\n</code></pre>\n\n<p>BTW the shown code has two typos:</p>\n\n<pre><code>lArrayCount = UBound(vArray) - LBound(vArray) + 1\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>ArrayCount = UBound(vArray) - LBound(vArray) + 1\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>Public Sub AddRelatedTimekeeperNumber(RelatedTimkeeperNumber As String)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Public Sub AddRelatedTimekeeperNumber(RelatedTimekeeperNumber As String)\n</code></pre>\n\n<hr>\n\n<p>From your scenario description, I'd say you need the following changes (and consequent refactoring) to your code:</p>\n\n<ol>\n<li><p>Handle <code>sRelatedTimekeeperNumbers</code> being initially empty</p>\n\n<p>then you have to change <code>ArrayCount</code> to:</p>\n\n<pre><code>Function ArrayCount(ByRef vArray As Variant) As Long\n    If IsEmpty(vArray) Then\n        ArrayCount = 0\n    Else\n        ArrayCount = UBound(vArray) - LBound(vArray) + 1\n    End If\nEnd Function\n</code></pre></li>\n<li><p>add a new element to the array</p>\n\n<p>then change <code>AddRelatedTimekeeperNumber(RelatedTimekeeperNumber As String)</code> to:</p>\n\n<pre><code>Public Sub AddRelatedTimekeeperNumber(RelatedTimekeeperNumber As String)\n    Dim sRelatedTimekeeperNumbersLength As Long\n\n    sRelatedTimekeeperNumbersLength = ArrayCount(sRelatedTimekeeperNumbers)\n    If sRelatedTimekeeperNumbersLength = 0 Then\n        ReDim sRelatedTimekeeperNumbers(1 To 1) As String\n    Else\n        ReDim Preserve sRelatedTimekeeperNumbers(1 To sRelatedTimekeeperNumbersLength + 1) As String\n    End If\n    sRelatedTimekeeperNumbers(sRelatedTimekeeperNumbersLength + 1) = RelatedTimekeeperNumber\nEnd Sub\n</code></pre>\n\n<p>and finally, change <code>PrintRelatedTimekeeperNumbers()</code> to:</p>\n\n<pre><code>Public Sub PrintRelatedTimekeeperNumbers()\n    If UBound(sRelatedTimekeeperNumbers) &gt; 0 Then\n        MsgBox Join(sRelatedTimekeeperNumbers, \" \")\n    Else\n        MsgBox \"no time keepers related to \" &amp; sTimekeeperNumber\n    End If\nEnd Sub\n</code></pre></li>\n</ol>\n\n<hr>\n\n<p>but you make a step further by adopting other objects instead of arrays, like a <code>Collection</code> or a <code>Dictionary</code> Object</p>\n\n<p>in the former case you class code would condense to:</p>\n\n<pre><code>    Option Explicit\n\n    Private sTimekeeperNumber As String\n    Private sRelatedTimekeeperNumbers As New Collection\n\n    Public Property Let TimekeeperNumber(TimekeeperNumber As String)\n        sTimekeeperNumber = TimekeeperNumber        \n    End Property\n\n    Public Property Get TimekeeperNumber() As String\n        TimekeeperNumber = sTimekeeperNumber        \n    End Property\n\n    Public Sub AddRelatedTimekeeperNumber(RelatedTimekeeperNumber As String)            \n        sRelatedTimekeeperNumbers.Add RelatedTimekeeperNumber\n    End Sub\n\n    Public Sub PrintRelatedTimekeeperNumbers()\n        Dim item As Variant\n        Dim txt As String\n        If sRelatedTimekeeperNumbers.count &gt; 0 Then\n            For Each item In sRelatedTimekeeperNumbers\n                txt = txt &amp; item &amp; \" \"\n            Next\n            MsgBox Trim(txt)\n        Else\n            MsgBox \"no time keepers related to \" &amp; sTimekeeperNumber\n        End If\n    End Sub\n</code></pre>\n\n<p>in the latter case it'd become:</p>\n\n<pre><code>    Option Explicit\n\n    Private sTimekeeperNumber As String\n    Private sRelatedTimekeeperNumbers As New Scripting.Dictionary\n\n    Public Property Let TimekeeperNumber(TimekeeperNumber As String)\n        sTimekeeperNumber = TimekeeperNumber\n\n    End Property\n\n    Public Property Get TimekeeperNumber() As String\n        TimekeeperNumber = sTimekeeperNumber\n\n    End Property\n\n    Public Sub AddRelatedTimekeeperNumber(RelatedTimekeeperNumber As String)\n        sRelatedTimekeeperNumbers.Add RelatedTimekeeperNumber, \"\"\n    End Sub\n\n    Public Sub PrintRelatedTimekeeperNumbers()\n        Dim item As Variant\n        Dim txt As String\n        If sRelatedTimekeeperNumbers.count &gt; 0 Then\n            MsgBox Join(sRelatedTimekeeperNumbers.Keys, \" \")\n        Else\n            MsgBox \"no time keepers related to \" &amp; sTimekeeperNumber\n        End If\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1071, "user_id": 1093111, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/42808d0742af6ac66f05e593b1e06067?s=128&d=identicon&r=PG", "display_name": "user1093111", "link": "https://stackoverflow.com/users/1093111/user1093111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 49412433, "answer_count": 1, "score": 0, "last_activity_date": 1521661147, "creation_date": 1521650811, "last_edit_date": 1521650860, "question_id": 49412128, "link": "https://stackoverflow.com/questions/49412128/cant-assign-to-array", "title": "Can&#39;t assign to array", "body": "<p>Trying to initialize an object class.  In the object, I keep the ID of the timekeeper (person) and an array of RelatedTimekeepers. To do this, I need to append to an array with a list of RelatedID.  </p>\n\n<p>The function is question is AddRelatedTimekeeperNumber.  Currently, it fails a the commented line. </p>\n\n<p>These are added to a object called timekeeper.</p>\n\n<p>My class looks like:</p>\n\n<pre><code>' TIMEKEEPER CLASS\nPrivate sTimekeeperNumber As String\nPrivate sRelatedTimekeeperNumbers() As Variant\n\nPublic Property Let TimekeeperNumber(TimekeeperNumber As String)\n    sTimekeeperNumber = TimekeeperNumber\n\nEnd Property\n\nPublic Property Get TimekeeperNumber() As String\n    TimekeeperNumber = sTimekeeperNumber\n\nEnd Property\n\nPublic Sub AddRelatedTimekeeperNumber(RelatedTimkeeperNumber As String)\n    Dim tmpArr() As String\n    Dim i As Integer\n    Dim sRelatedTimekeeperNumbersLength As Integer\n    sRelatedTimekeeperNumbersLength = ArrayCount(sRelatedTimekeeperNumbers)\n    ReDim tmpArr(1 To sRelatedTimekeeperNumbersLength) As String\n    For i = 1 To sRelatedTimekeeperNumbersLength\n\n        If i = sRelatedTimekeeperNumbersLength Then\n            tmpArr(i) = RelatedTimekeeperNumber\n        Else\n            tmpArr(i) = sRelatedTimekeeperNumbers(i)\n        End If\n\n    Next i\n\n    ReDim Preserve sRelatedTimekeeperNumbers(1 To ArrayCount(tmpArr))\n\n    sRelatedTimekeeperNumbers = tmpArr ' &lt;- \"Can't Reassign to array, despite ReDim'ing\"\n\nEnd Sub\n\nPublic Sub PrintRelatedTimekeeperNumbers()\n    Dim myArray() As Variant\n    Dim txt As String\n    Dim i As Long\n\n    myArray = sRelatedTimekeeperNumbers\n\n    For i = LBound(myArray) To UBound(myArray)\n      txt = txt &amp; myArray(i) &amp; vbCrLf\n    Next i\n\n    MsgBox txt\n\nEnd Sub\n\nFunction ArrayCount(ByRef vArray As Variant) As Long\n    lArrayCount = UBound(vArray) - LBound(vArray) + 1\n\nEnd Function\n</code></pre>\n\n<p>and My procedure to build the class is:</p>\n\n<pre><code>Sub Init_Timekeepers()\n\n    Dim oTimekeeper As New clsTimekeeper\n\n    Dim sTkID As String\n    oTimekeeper.TimekeeperNumber = \"00089\"\n    oTimekeeper.AddRelatedTimekeeperNumber (\"00089\")\n    sTkID = oTimekeeper.TimekeeperNumber\n\n    oTimekeeper.AddRelatedTimekeeperNumber (\"00091\")\n    oTimekeeper.AddRelatedTimekeeperNumber (\"00092\")\n\n    oTimekeeper.PrintRelatedTimekeeperNumbers\n\nEnd Sub\n</code></pre>\n\n<p>Before setting array, I think I am ReDim'ing, however, the compiler throws and error at the commented line.</p>\n"}, {"tags": ["vba", "vsto", "office-interop", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521817911, "post_id": 49452321, "comment_id": 85908447, "body": "That&#39;s an interesting approach, but wouldn&#39;t this change the visual representation of the chart for a short time?"}, {"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "reply_to_user": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521820244, "post_id": 49452321, "comment_id": 85910111, "body": "@DanielHilgarth yes, that could happen (especially if the PC running the code is an older vintage). There is no native way in PowerPoint&#39;s object model to turn off screen updating, but I imagine this code could be converted to C#: <a href=\"http://skp.mvps.org/ppt00033.htm\" rel=\"nofollow noreferrer\">PowerPoint VBA Equivalent of Application.ScreenUpdating</a>. You could then turn off <code>ScreenUpdating</code>, run the code to grab the Category Names, and then turn <code>ScreenUpdating</code> back on."}, {"owner": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521822817, "post_id": 49452321, "comment_id": 85911740, "body": "OK, that could work. I have an entirely different problem with this approach though: I am starting my work from the current selection, i.e. I do something like <code>var chart = Selection.ShapeRange(1).Chart</code>. After changing the chart type, not only my current <code>chart</code> object is invalid, the whole hierarchy has changed. The <code>ShapeRange(1).Chart</code> throws an exception and even <code>Selection.ShapeRange</code> throws. Only <code>SlideRange</code> works, so it seems as if the selection changed."}, {"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "reply_to_user": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521826196, "post_id": 49452321, "comment_id": 85913580, "body": "@DanielHilgarth it is possible the conversion of the chart is altering the <code>Selection</code> object. If possible, I would refactor to replace the use of <code>Selection</code> to identify the desired chart by looping through the <code>Shapes</code> collection in each slide using <code>HasChart</code> and/or other identifying properties. If issues still arise after <code>Selection</code> has been removed, I would try exploring other enumeration members for the conversion."}, {"owner": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521826612, "post_id": 49452321, "comment_id": 85913785, "body": "And how would I identify a chart? It doesn&#39;t have an ID or something, does it?"}, {"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "reply_to_user": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521829166, "post_id": 49452321, "comment_id": 85915088, "body": "@DanielHilgarth shapes in PowerPoint have a <a href=\"https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/shape-name-property-powerpoint\" rel=\"nofollow noreferrer\">Shape.Name property</a>. They also have a <a href=\"https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/shape-id-property-powerpoint?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Shape.Id property</a> These can be used to identify a shape that contains the chart. Here is an example: <a href=\"https://stackoverflow.com/questions/5527073/get-shape-by-id-or-name\">Get Shape by Id or Name</a>."}, {"owner": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521831570, "post_id": 49452321, "comment_id": 85916258, "body": "Yeah, that works. Is all of this only an issue of VSTO? Or of VBA as well? This is REALLY bad..."}, {"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "reply_to_user": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521835338, "post_id": 49452321, "comment_id": 85917915, "body": "@DanielHilgarth PowerPoint VBA and VSTO share the same object model, so they, for the most part, share the same difficulties. IMHO, developing in VSTO is easier as the .NET libraries can be leveraged. PowerPoint VBA was released in 1997, the language is virtually unchanged since then, and the object model has received very little maintenance. Most issues remain for years or decades. For example, Office 2016 was released in September 2015, which means the Waterfall enumeration issue has gone uncorrected for almost 2.5 years. So when you write that this is REALLY bad, you are being charitable."}, {"owner": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "edited": false, "score": 0, "creation_date": 1521878059, "post_id": 49452321, "comment_id": 85927729, "body": "Thanks, that comment made my day ;)"}], "tags": [], "owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "is_accepted": true, "score": 2, "last_activity_date": 1521816265, "creation_date": 1521816265, "answer_id": 49452321, "question_id": 49411763, "link": "https://stackoverflow.com/questions/49411763/get-category-names-of-waterfall-chart/49452321#49452321", "title": "Get category names of waterfall chart", "body": "<p>It appears that, as of this writing, the <a href=\"https://msdn.microsoft.com/query/dev15.query?appId=Dev15IDEF1&amp;l=EN-US&amp;k=k(Microsoft.Office.Core.XlChartType);k(VST.ProjectItem.Addin);k(TargetFrameworkMoniker-.NETFramework,Version%3Dv4.6.1);k(DevLang-csharp)&amp;rd=true\" rel=\"nofollow noreferrer\">XlChartType enumeration</a> is missing a member for Waterfall. (Waterfall has a <code>ChartType</code> integer value of 119, which is simply missing in the enumeration.)</p>\n\n<p>As the missing enumeration creates all sorts of issues, I decided to write code that would convert the chart to an enumerated type, place the Category Names into an array, and then use PowerPoint's <code>Undo</code> functionality to restore the chart.</p>\n\n<pre><code>PowerPoint.Chart myChart = Globals.ThisAddIn.Application.ActivePresentation.Slides[1].Shapes[2].Chart;\nmyChart.ChartType = Office.XlChartType.xlBarStacked;\nPowerPoint.Axis CategoryAxis = Globals.ThisAddIn.Application.ActivePresentation.Slides[1].Shapes[2].Chart.Axes(PowerPoint.XlAxisType.xlCategory, PowerPoint.XlAxisGroup.xlPrimary);\nArray CatNames = (Array)((object)CategoryAxis.CategoryNames);\nGlobals.ThisAddIn.Application.CommandBars.ExecuteMso(\"Undo\");\n//Do something here with the CatNames array\n</code></pre>\n"}], "owner": {"reputation": 159275, "user_id": 572644, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/afd0124e3eaa2f2dbe0eb6741aafcd03?s=128&d=identicon&r=PG", "display_name": "Daniel Hilgarth", "link": "https://stackoverflow.com/users/572644/daniel-hilgarth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 49452321, "answer_count": 1, "score": 4, "last_activity_date": 1521822963, "creation_date": 1521649762, "question_id": 49411763, "link": "https://stackoverflow.com/questions/49411763/get-category-names-of-waterfall-chart", "title": "Get category names of waterfall chart", "body": "<p>I am trying to read the category names of a waterfall chart in a PowerPoint VSTO project.<br>\nSo far, I was unable to do so.</p>\n\n<p>Here is what I tried:</p>\n\n<ul>\n<li><code>chart.SeriesCollection(x).Axes(y).CategoryNames</code> - not available for this chart type</li>\n<li><code>chart.SeriesCollection(x).XValues</code> - not available for this chart type</li>\n<li><code>chart.SeriesCollection(x).Points(y).DataLabel.Text</code> / <code>.Caption</code> - this returns the point value, not the category name, e.g. -130</li>\n<li><code>chart.SeriesCollection(x).DataLabels(y).Text</code> / <code>.Caption</code> - same as previous: It returns the point values</li>\n</ul>\n\n<p>Then, I tried reading the source data directly via <code>chart.ChartData.Workbook</code> but this is also not available.</p>\n\n<p>So, how can I read the category names?</p>\n"}, {"tags": ["vba", "error-handling", "runtime-error", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9412290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stuart", "link": "https://stackoverflow.com/users/9412290/stuart"}, "edited": false, "score": 0, "creation_date": 1521652018, "post_id": 49411976, "comment_id": 85826781, "body": "Wow, what a great answer! Thank you for your help, that worked."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15, "user_id": 9412290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stuart", "link": "https://stackoverflow.com/users/9412290/stuart"}, "edited": false, "score": 0, "creation_date": 1521652055, "post_id": 49411976, "comment_id": 85826800, "body": "@Stuart feel free to mark this answer as &quot;accepted&quot;, by clicking the hollow checkmark next to the voting buttons, near the top of the post!"}, {"owner": {"reputation": 15, "user_id": 9412290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stuart", "link": "https://stackoverflow.com/users/9412290/stuart"}, "edited": false, "score": 0, "creation_date": 1521653190, "post_id": 49411976, "comment_id": 85827503, "body": "Thanks again for that. It really streamlines the code. I implemented the function that you suggested. Still learning VBA and appreciate your help!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15, "user_id": 9412290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stuart", "link": "https://stackoverflow.com/users/9412290/stuart"}, "edited": false, "score": 0, "creation_date": 1521653270, "post_id": 49411976, "comment_id": 85827550, "body": "@Stuart allow me to shamelessly plug my VBIDE add-in project then - see the links in my profile =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1521650382, "creation_date": 1521650382, "answer_id": 49411976, "question_id": 49411310, "link": "https://stackoverflow.com/questions/49411310/error-handling-not-working-for-slide-id/49411976#49411976", "title": "Error handling not working for slide ID", "body": "<p>Your error path is intertwined with your \"happy path\".</p>\n\n<p>Good error handling should be in its own execution path.</p>\n\n<p>I'd rename that <code>errCatch</code> label to e.g. <code>Skip</code>, and then at the bottom of the procedure, add this:</p>\n\n<pre><code>    Exit Sub\n ErrCatch:\n     Err.Clear\n     Resume Skip\n</code></pre>\n\n<p>Now the \"happy path\" ends at <code>Exit Sub</code>, and the \"error path\" jumps to this little subroutine which clears the error and resumes to the <code>Skip</code> label. That \"resume\" part is what tells the VBA runtime \"hey, we're no longer in an error state\" - currently your code enters error state, and then nothing tells VBA you're done handling that error, so <code>errCatch</code> gets jumped to, and then the \"happy path\" is understood by VBA as being the error-handling subroutine: it's expecting you to handle the error and eventually <code>Resume</code> to the \"happy path\", but what's happening is that the error is essentially unhandled, and the error state is persisting into the next loop iteration.</p>\n\n<p>That said the <code>On Error GoTo</code> statement should probably be pulled out of the loop scope, assuming <code>oTbl.Rows.Count</code> has no reason to fail (or does it?). It running on every iteration is redundant.</p>\n\n<hr>\n\n<blockquote>\n  <p>I cannot use <em>resume next</em></p>\n</blockquote>\n\n<p>Why not? In its own limited scope, it's a fine tool to have!</p>\n\n<pre><code>Private Function GetSlideByID(ByVal id As Long) As Slide\n    On Error Resume Next\n    Set GetSlideByID = ActivePresentation.slideS.FindBySlideID(id)\nEnd Function\n</code></pre>\n\n<p>Now you can do this:</p>\n\n<pre><code>Dim thisSlide As Slide\nSet thisSlide = GetSlideByID(CLng(pLinkNumber))\nIf Not thisSlide Is Nothing Then\n    aStorage(j - 1, 1) = thisSlide.SlideIndex\n    aStorage(j - 1, 0) = subAd\nEnd If\n</code></pre>\n\n<p>And there's no need for an <code>On Error</code> statement <em>or</em> line labels anymore!</p>\n"}], "owner": {"reputation": 15, "user_id": 9412290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stuart", "link": "https://stackoverflow.com/users/9412290/stuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 49411976, "answer_count": 1, "score": 1, "last_activity_date": 1521650382, "creation_date": 1521648513, "last_edit_date": 1521650196, "question_id": 49411310, "link": "https://stackoverflow.com/questions/49411310/error-handling-not-working-for-slide-id", "title": "Error handling not working for slide ID", "body": "<p>having trouble dealing with an exception in my code. I have written the code below to transfer the contents of a powerpoint table into an array, but it keeps throwing an exception saying</p>\n\n<blockquote>\n  <p>Slides (unknown member): Invalid request. Invalid Slide ID.</p>\n</blockquote>\n\n<p>I put in the error handle to try and skip this, as it does not matter to me if the entry is left blank in the case of errors. However, I cannot get it to pass this error! (I cannot use resume next). Any help would be great. </p>\n\n<pre><code>'loop through table and store values to a temporary array in order to sort it\n'NOTE that the Table starts at (1,1) and the  storage array starts at (0,0) (see \"j\")\nFor j = 1 To oTbl.Rows.Count\n\n    'First check that the string being stored is a hyperlink and not an empty cell\n    If Not (oTbl.Cell(j, 2).Shape.TextFrame.TextRange.ActionSettings(ppMouseClick).Hyperlink.SubAddress) = \"\" Then\n\n        'create a temp variable to operate on the hyperlink address in each row in the table\n        subAd = oTbl.Cell(j, 2).Shape.TextFrame.TextRange.ActionSettings(ppMouseClick).Hyperlink.SubAddress\n\n        'Find the CURRENT slideIndex and store in column 1 (for sorting)\n        'write error condition for if the slideID points to a slide that has been deleted\nOn Error GoTo errCatch\n        pLinkNumber = Left(subAd, InStr(subAd, \",\") - 1)\n        aStorage(j - 1, 1) = ActivePresentation.slideS.FindBySlideID(CLng(pLinkNumber)).SlideIndex\n\n        'store the CURRENT hyperlink address as column 0 (after defining colum 1 for error handling reasons)\n        aStorage(j - 1, 0) = subAd\n\n    Else\nerrCatch:\n    End If\nNext j\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1521648630, "post_id": 49411291, "comment_id": 85824332, "body": "PS, sorry for posting an error message, but I can&#39;t work out what&#39;s going on, since writing code-modules means you can&#39;t enter debug-mode. Also, the entire contents of those code-blocks is the string I want to write, not just the bit that&#39;s formatted as a string."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1521649077, "post_id": 49411291, "comment_id": 85824679, "body": "Can you put this into a simple, recreatable problem that we can work on?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1521650790, "post_id": 49411291, "comment_id": 85825950, "body": "Why would you want to have code write code?"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1521651399, "post_id": 49411291, "comment_id": 85826365, "body": "@CallumDA Added some test code, you need to enable access to VBProject for it to work"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1521652947, "post_id": 49411291, "comment_id": 85827358, "body": "@jkpieterse I&#39;ve made a function which compresses the code from all the files in your project into a single module. You then import this single module into another workbook, and it self-extracts back into the original code modules. Sort of like a zip file so you only have to import one thing rather than many. I&#39;m <a href=\"https://gist.github.com/Greedquest/cd02a7d191bcf2ccf0bf498641d9e161\" rel=\"nofollow noreferrer\">putting it online</a> for others to use"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1521701490, "post_id": 49411291, "comment_id": 85845271, "body": "Sounds ilke an interesting project. But wouldn&#39;t is be a lot simpler to just use the plain exported text files? Usually VBA code isn&#39;t that much?"}], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1521651685, "post_id": 49412375, "comment_id": 85826567, "body": "Awww I never would&#39;ve guessed that! Do you know what the limit is?"}, {"owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1521651786, "post_id": 49412375, "comment_id": 85826635, "body": "I don&#39;t but the statement you wrote is in fact one line ca 18k chars long"}], "tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 1, "last_activity_date": 1521651497, "creation_date": 1521651497, "answer_id": 49412375, "question_id": 49411291, "link": "https://stackoverflow.com/questions/49411291/run-time-error-40046-statement-too-complex/49412375#49412375", "title": "Run-Time Error 40046: Statement too complex", "body": "<p>There is a limit of \"prolonging\" lines with <code>_</code> at the end, try building your string part by part:</p>\n\n<pre><code>.code_content = \"first part\"\n.code_content = .code_content &amp; \"second part\"\n</code></pre>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521651603, "creation_date": 1521648471, "last_edit_date": 1531164843, "question_id": 49411291, "link": "https://stackoverflow.com/questions/49411291/run-time-error-40046-statement-too-complex", "title": "Run-Time Error 40046: Statement too complex", "body": "<p>I'm trying to write a code module using the <code>InsertLines</code> method, but am getting the </p>\n\n<blockquote>\n  <p>Statement too complex Error</p>\n</blockquote>\n\n<p>My code boils down to this loop:</p>\n\n<pre><code>Dim extractorModule As VBComponent\nWith extractorModule.codeModule\n    Dim singItem As codeItem\n    Dim i As Long\n    For i = LBound(codeItems) To UBound(codeItems)\n        singItem = codeItems(i) 'array of private type with .value property\n        .InsertLines 5, singItem.value 'write to line 5\n    Next i\n\nEnd With\n</code></pre>\n\n<p>Which loops through an array of custom <code>codeItems</code>, and writes their <code>.value</code> to a new module with <code>.InsertLines</code></p>\n\n<hr>\n\n<p><code>singItem.value</code> is a base64 encoded string. If it is a short one, 100 characters say, like this string:</p>\n\n<pre><code>.code_content = \"QXR0cmlidXRlIFZCX05hbWUgPSAic2ltcGxlTW9kdWxlIg0KUHJpdmF0ZSBhIEFzIExvbmcNCg==\"\n</code></pre>\n\n<p>no problem. However I want a longer string, this one for example (19000 chars, contains newlines):</p>\n\n<pre><code>                .code_content = \"QXR0cmlidXRlIFZCX05hbWUgPSAicHJvamVjdENvbXByZXNzb3IiDQonQ29tcHJlc3NvciBtb2R1bGUsIGNvbXByZXNzZXMgYSBsb2FkIG9mIGZpbGVzIGludG8gc3RyaW5ncyB0byBleHBvcnQNCk9wdGlvbiBFeHBsaWNpdA0KUHJpdmF0ZSBUeXBlIGNvZGVJdGVtDQogICAgZXh0ZW5zaW9uIEFzIFN0cmluZw0KICAgIG1vZHVsZV9uYW1lIEFzIFN0cmluZw0KICAgIGNvZGVfY29udGVudCBBcyBTdHJpbmcNCkVuZCBUeXBlDQpQcml2YXRlIENvbnN0IFR5cGVCaW5hcnkgPSAxDQoNClB1YmxpYyBTdWIgY29tcHJlc3NQcm9qZWN0KFBhcmFtQXJyYXkgZmlsZW5hbWVzKCkpDQogICAgJ1N1YiB0byBjb252ZXJ0IHNlbGVjdGVkIGZpbGVzIGludG8gc2VsZi1leHRyYWN0aW5nIG1vZHVsZQ0KICAgICdJbnB1dDoNCiAgICAnICAgZmlsZW5hbWVzOiBhcnJheSBvZiBzdHJpbmdzIGJhc2VkIG9uIG5hbWVzIG9mIG1vZHVsZXMgaW4gcHJvamVjdA0KICAgIElmIE5vdCBwcm9qZWN0X2FjY2Vzc2libGUgVGhlbg0KICAgICAgICBNc2dCb3ggIkFjY2VzcyB0byBWQkEgcHJvamVjdCBpcyByZXN0cmljdGVkLCB0aGlzIHdvbid0IHdvcmshIg0KICAgICAgICBFeGl0IFN1Yg0KICAgIEVuZCBJZg0KDQogICAgRGltIGNvZGVJdGVtcygpIEFzIGNvZGVJdGVtDQogICAgRGltIGFycmF5U3QgQXMgTG9uZywg\" &amp; _\n\"YXJyYXlFbmQgQXMgTG9uZywgaSBBcyBMb25nDQogICAgYXJyYXlTdCA9IExCb3VuZChmaWxlbmFtZXMpDQogICAgYXJyYXlFbmQgPSBVQm91bmQoZmlsZW5hbWVzKQ0KICAgIFJlRGltIGNvZGVJdGVtcyhhcnJheVN0IFRvIGFycmF5RW5kKQ0KICAgIA0KICAgIERlYnVnLlByaW50ICJHZXR0aW5nIERlZmluaXRpb25zLi4uIg0KICAgIFdpdGggVGhpc1dvcmtib29rLlZCUHJvamVjdC5WQkNvbXBvbmVudHMNCiAgICAgICAgJ2xvb3AgdGhyb3VnaCBmaWxlcyBjb21wcmVzc2luZyB0aGVtIGludCA2NCBiaXQgc3RyaW5ncw0KICAgICAgICBGb3IgaSA9IGFycmF5U3QgVG8gYXJyYXlFbmQNCiAgICAgICAgICAgIGNvZGVJdGVtcyhpKSA9IG1vZHVsZURlZmluaXRpb24oZmlsZW5hbWVzKGkpKQ0KICAgICAgICBOZXh0IGkNCiAgICBFbmQgV2l0aA0KICAgIERlYnVnLlByaW50ICwgIkRlZmluaXRpb25zIHNhdmVkIg0KICAgICd3cml0ZSBzdHJpbmdzIHRvIHNrZWxldG9uIGZpbGUNCiAgICAgICAgRGVidWcuUHJpbnQgIldyaXRpbmcgZmlsZS4uLiINCiAgICB3cml0ZVNrZWxldG9uIGNvZGVJdGVtcw0KRGVidWcuUHJpbnQgIkNvbXBsZXRlIg0KRW5kIFN1Yg0KUHJpdmF0ZSBTdWIgd3JpdGVTa2VsZXRvbihjb2RlSXRlbXMoKSBBcyBjb2RlSXRlbSwgT3B0aW9uYWwgd2IgQXMgVmFyaWFudCwg\" &amp; _\n\"T3B0aW9uYWwgQnlSZWYgcHJvamVjdE5hbWUgQXMgU3RyaW5nID0gIm15UHJvamVjdCIpICcgLCBPcHRpb25hbCB3YiBBcyBWYXJpYW50KQ0KICAgIERpbSBpdGVtQ291bnQgQXMgTG9uZw0KICAgIGl0ZW1Db3VudCA9IFVCb3VuZChjb2RlSXRlbXMpIC0gTEJvdW5kKGNvZGVJdGVtcykgKyAxDQogICAgSWYgaXRlbUNvdW50IDwgMSBUaGVuIEV4aXQgU3ViDQogICAgDQogICAgRGltIGJvb2sgQXMgV29ya2Jvb2sNCiAgICBJZiBJc01pc3Npbmcod2IpIFRoZW4gU2V0IGJvb2sgPSBUaGlzV29ya2Jvb2sgRWxzZSBTZXQgYm9vayA9IHdiDQogICAgJ2NyZWF0ZSBzZWxmLWV4dHJhY3RpbmcgbW9kdWxlIGFuZCBzZXQgbmFtZQ0KDQogICAgRGltIGV4dHJhY3Rvck1vZHVsZSBBcyBWQkNvbXBvbmVudA0KICAgIFNldCBleHRyYWN0b3JNb2R1bGUgPSBib29rLlZCUHJvamVjdC5WQkNvbXBvbmVudHMuQWRkKHZiZXh0X2N0X1N0ZE1vZHVsZSkNCiAgICBleHRyYWN0b3JNb2R1bGUuTmFtZSA9IHByb2plY3ROYW1lICdtYXkgZXJyIGlmIGR1cGxpY2F0ZSAtIGNoYW5nZXMNCkRlYnVnLlByaW50ICwgIlByb2plY3QgZmlsZSBhZGRlZCINCiAgICAnd3JpdGUgY29kZSB0byBtb2R1bGUNCiAgICBEaW0gY29kZUluc2VydFBvaW50IEFzIExvbmcNCiAgICBjb2RlSW5zZXJ0UG9pbnQgPSBmaWxsTW9kdWxl\" &amp; _\n\"KGV4dHJhY3Rvck1vZHVsZS5jb2RlTW9kdWxlKSgwKSAneCBjb29yZA0KRGVidWcuUHJpbnQgLCAiUHJvamVjdCBza2VsZXRvbiB3cml0dGVuIg0KICAgICdhbW1lbmQgY29kZSB3aXRoIGNvZGVpdGVtcyBhbmQga2lsbGluZyBsaW5lDQogICAgJ1dpdGggZXh0cmFjdG9yTW9kdWxlLmNvZGVNb2R1bGUNCiAgICANCiAgICBEaW0gdiBBcyBjb2RlTW9kdWxlDQogICAgU2V0IHYgPSBleHRyYWN0b3JNb2R1bGUuY29kZU1vZHVsZQ0KICAgIHYuRGVsZXRlTGluZXMgY29kZUluc2VydFBvaW50DQogICAgRGltIHNpbmdJdGVtIEFzIGNvZGVJdGVtDQogICAgRGltIGkgQXMgTG9uZywgbG93ZXJWYWwgQXMgTG9uZywgdXBwZXJWYWwgQXMgTG9uZw0KICAgIGxvd2VyVmFsID0gTEJvdW5kKGNvZGVJdGVtcykNCiAgICB1cHBlclZhbCA9IFVCb3VuZChjb2RlSXRlbXMpDQoNCiAgICAgICAgDQogICAgJ2xvb3AgdGhyb3VnaCBhZGRpbmcgY29kZSBkZWZpbml0aW9ucw0KICAgIEZvciBpID0gbG93ZXJWYWwgVG8gdXBwZXJWYWwNCiAgICAgICAgc2luZ0l0ZW0gPSBjb2RlSXRlbXMoaSkNCiAgICAgICAgRGltIHMgQXMgU3RyaW5nOiBzID0gcHJpbnRmKFN0cmluZyg0LCB2YlRhYikgJiAiLmNvZGVfY29udGVudCA9IHswfSIsIHNpbmdJdGVtLmNvZGVfY29udGVudCkNCiAgICAgICAgRGVidWcuUHJpbnQg\" &amp; _\n\"LCAiRm9ybWF0dGVkIGZpbmUiDQoNCiAgICAgICAgRGVidWcuUHJpbnQgIm1hZGUgaXQgdG8iDQogICAgICAgIERlYnVnLlByaW50IHMNCiAgICAgICAgdi5JbnNlcnRMaW5lcyBjb2RlSW5zZXJ0UG9pbnQsIHMNCiAgICAgICAgRGVidWcuUHJpbnQgIm1hZGUgaXQgcGFzdCINCicgICAgICAgIC5JbnNlcnRMaW5lcyBjb2RlSW5zZXJ0UG9pbnQsIHByaW50ZihTdHJpbmcoNCwgdmJUYWIpICYgIi5tb2R1bGVfbmFtZSA9ICIiezB9IiIiLCBzaW5nSXRlbS5tb2R1bGVfbmFtZSkNCicgICAgICAgIC5JbnNlcnRMaW5lcyBjb2RlSW5zZXJ0UG9pbnQsIHByaW50ZihTdHJpbmcoNCwgdmJUYWIpICYgIi5leHRlbnNpb24gPSAiInswfSIiIiwgc2luZ0l0ZW0uZXh0ZW5zaW9uKQ0KJw0KJyAgICAgICAgLkluc2VydExpbmVzIGNvZGVJbnNlcnRQb2ludCwgcHJpbnRmKFN0cmluZygzLCB2YlRhYikgJiAiQ2FzZSB7MH0iLCBpdGVtQ291bnQpDQogICAgICAgIGl0ZW1Db3VudCA9IGl0ZW1Db3VudCAtIDENCkRlYnVnLlByaW50ICwgIkluc2VydGVkIGNvZGUgY29udGVudCBmb3IgZmlsZTogIjsgaQ0KICAgIE5leHQgaQ0KDQogICAgRGltIGtpbGxMaW5lIEFzIExvbmcgJ3BsYWNlIGZvciBhZGRpbmcgbGFzdCBiaXQgb2YgY29kZSB0byByZW1vdmUgc2VsZi1leHRyYWN0b3INCicgICAgLkZpbmQgInsx\" &amp; _\n\"fSIsIGtpbGxMaW5lLCAxLCAtMSwgLTENCicgICAgLlJlcGxhY2VMaW5lIGtpbGxMaW5lLCBSZXBsYWNlKC5MaW5lcyhraWxsTGluZSwgMSksICJ7MX0iLCBwcm9qZWN0TmFtZSkNCkRlYnVnLlByaW50ICwgIkluc2VydGVkIGtpbGxMaW5lIg0KICAgICdFbmQgV2l0aA0KICAgIA0KRW5kIFN1Yg0KDQoNClByaXZhdGUgRnVuY3Rpb24gbW9kdWxlRGVmaW5pdGlvbihtb2R1bGVOYW1lLCBPcHRpb25hbCB3YiBBcyBWYXJpYW50KSBBcyBjb2RlSXRlbQ0KICAgIERpbSBjb2RlTW9kdWxlIEFzIFZCQ29tcG9uZW50DQogICAgRGltIGJvb2sgQXMgV29ya2Jvb2sNCiAgICBEaW0gcmVzdWx0IEFzIGNvZGVJdGVtDQogICAgSWYgSXNNaXNzaW5nKHdiKSBUaGVuIFNldCBib29rID0gVGhpc1dvcmtib29rIEVsc2UgU2V0IGJvb2sgPSB3Yg0KICAgIFNldCBjb2RlTW9kdWxlID0gYm9vay5WQlByb2plY3QuVkJDb21wb25lbnRzKG1vZHVsZU5hbWUpDQogICAgJ2dldCBleHRlbnNpb24gYW5kIG5hbWUNCiAgICBTZWxlY3QgQ2FzZSBjb2RlTW9kdWxlLlR5cGUNCiAgICBDYXNlIHZiZXh0X2N0X1N0ZE1vZHVsZQ0KICAgICAgICByZXN1bHQuZXh0ZW5zaW9uID0gIi5iYXMiDQogICAgQ2FzZSB2YmV4dF9jdF9DbGFzc01vZHVsZQ0KICAgICAgICByZXN1bHQuZXh0ZW5zaW9uID0gIi5jbHMiDQogICAgQ2Fz\" &amp; _\n\"ZSB2YmV4dF9jdF9NU0Zvcm0NCiAgICAgICAgcmVzdWx0LmV4dGVuc2lvbiA9ICIuZnJtIg0KICAgIENhc2UgRWxzZQ0KICAgICAgICByZXN1bHQuZXh0ZW5zaW9uID0gIm1pc3NpbmciDQogICAgICAgIG1vZHVsZURlZmluaXRpb24gPSByZXN1bHQNCiAgICAgICAgRXhpdCBGdW5jdGlvbg0KICAgIEVuZCBTZWxlY3QNCiAgICANCiAgICByZXN1bHQubW9kdWxlX25hbWUgPSBjb2RlTW9kdWxlLk5hbWUNCiAgICAnc2F2ZSB0byB0ZW1wIHBhdGgNCiAgICBEaW0gdGVtcFBhdGggQXMgU3RyaW5nDQogICAgdGVtcFBhdGggPSBwcmludGYoInswfVx7MX17Mn0iLCBFbnZpcm9uJCgidGVtcCIpLCByZXN1bHQubW9kdWxlX25hbWUsIHJlc3VsdC5leHRlbnNpb24pDQogICAgY29kZU1vZHVsZS5FeHBvcnQgdGVtcFBhdGgNCiAgICBPbiBFcnJvciBHb1RvIHNhZmVFeGl0DQogICAgcmVzdWx0LmNvZGVfY29udGVudCA9IGNodW5raWZ5KFRvQmFzZTY0KHJlYWRCeXRlcyh0ZW1wUGF0aCkpKSAnZW5jb2RlIGFuZCBjaHVua2lmeQ0KICAgIA0Kc2FmZUV4aXQ6DQogICAgS2lsbCB0ZW1wUGF0aA0KICAgIG1vZHVsZURlZmluaXRpb24gPSByZXN1bHQNCiAgICBJZiBFcnIuTnVtYmVyIDw+IDAgVGhlbiBtb2R1bGVEZWZpbml0aW9uLmV4dGVuc2lvbiA9ICJtaXNzaW5nIg0KRW5kIEZ1bmN0aW9uDQoNClBy\" &amp; _\n\"aXZhdGUgRnVuY3Rpb24gcHJpbnRmKG1hc2sgQXMgU3RyaW5nLCBQYXJhbUFycmF5IHRva2VucygpKSBBcyBTdHJpbmcNCiAgICBEZWJ1Zy5QcmludCAsICIgLT4gRm9ybWF0dGluZyI7IExlbih0b2tlbnMoMCkpOyAiY2hhcnMgaW50byIsICIiIiI7IG1hc2s7ICIiIiINCiAgICBEaW0gaSBBcyBMb25nDQpPbiBFcnJvciBHb1RvIGJhZFByaW50DQogICAgRm9yIGkgPSAwIFRvIFVCb3VuZCh0b2tlbnMpDQogICAgICAgIG1hc2sgPSBSZXBsYWNlJChtYXNrLCAieyIgJiBpICYgIn0iLCB0b2tlbnMoaSkpDQogICAgTmV4dA0KICAgIHByaW50ZiA9IG1hc2sNCiAgICAgICAgRXhpdCBGdW5jdGlvbg0KYmFkUHJpbnQ6DQogICAgcHJpbnRmID0gbWFzaw0KICAgIERlYnVnLlByaW50IFN0cmluZygxMCwgIi0iKQ0KICAgIERlYnVnLlByaW50ICJQcmludEYgZXJyb3Igb24iLCB0b2tlbnMoMCkNCiAgICBEZWJ1Zy5QcmludCBTdHJpbmcoMTAsICItIikNCkVuZCBGdW5jdGlvbg0KDQpQcml2YXRlIEZ1bmN0aW9uIHByb2plY3RfYWNjZXNzaWJsZSgpIEFzIEJvb2xlYW4NCiAgICBPbiBFcnJvciBSZXN1bWUgTmV4dA0KICAgIFdpdGggVGhpc1dvcmtib29rLlZCUHJvamVjdA0KICAgICAgICBwcm9qZWN0X2FjY2Vzc2libGUgPSAuUHJvdGVjdGlvbiA9IHZiZXh0X3BwX25vbmUNCiAgICAgICAgcHJv\" &amp; _\n\"amVjdF9hY2Nlc3NpYmxlID0gcHJvamVjdF9hY2Nlc3NpYmxlIEFuZCBFcnIuTnVtYmVyID0gMA0KICAgIEVuZCBXaXRoDQpFbmQgRnVuY3Rpb24NCg0KUHJpdmF0ZSBGdW5jdGlvbiByZWFkQnl0ZXMoZmlsZSBBcyBTdHJpbmcpIEFzIEJ5dGUoKQ0KICBEaW0gaW5TdHJlYW0gQXMgT2JqZWN0DQogICcgQURPREIgc3RyZWFtIG9iamVjdCB1c2VkDQogIFNldCBpblN0cmVhbSA9IENyZWF0ZU9iamVjdCgiQURPREIuU3RyZWFtIikNCiAgJyBvcGVuIHdpdGggbm8gYXJndW1lbnRzIG1ha2VzIHRoZSBzdHJlYW0gYW4gZW1wdHkgY29udGFpbmVyDQogIGluU3RyZWFtLk9wZW4NCiAgaW5TdHJlYW0uVHlwZSA9IFR5cGVCaW5hcnkNCiAgaW5TdHJlYW0uTG9hZEZyb21GaWxlIChmaWxlKQ0KICByZWFkQnl0ZXMgPSBpblN0cmVhbS5SZWFkKCkNCkVuZCBGdW5jdGlvbg0KUHJpdmF0ZSBGdW5jdGlvbiBjaHVua2lmeShCeVZhbCBiYXNlIEFzIFN0cmluZywgT3B0aW9uYWwgQnlWYWwgc3RyaW5nTGVuZ3RoIEFzIExvbmcgPSA5MDApIEFzIFN0cmluZw0KJ3NwbGl0cyBhIHN0cmluZyBhdCBldmVyeSBzdHJpbmdMZW5ndGggY2hhcmFjaHRlcnMgYW5kIGRlbGltaXRzDQonMTAyNCBpcyBtYXggY2hhcnMgaW4gYSBsaW5lDQpjaHVua2lmeSA9IEpvaW4oU3BsaXRTdHJpbmcoYmFzZSwgc3RyaW5nTGVuZ3Ro\" &amp; _\n\"KSwgIiAmIF8iICYgdmJDckxmKQ0KRW5kIEZ1bmN0aW9uDQoNClByaXZhdGUgRnVuY3Rpb24gU3BsaXRTdHJpbmcoQnlWYWwgc3RyIEFzIFN0cmluZywgQnlWYWwgbnVtT2ZDaGFyIEFzIExvbmcpIEFzIFN0cmluZygpDQogICAgRGltIHNBcnIoKSBBcyBTdHJpbmcNCiAgICBEaW0gbkNvdW50IEFzIExvbmcNCiAgICBSZURpbSBzQXJyKChMZW4oc3RyKSAtIDEpIFwgbnVtT2ZDaGFyKQ0KICAgIERvIFdoaWxlIExlbihzdHIpDQogICAgICAgIHNBcnIobkNvdW50KSA9ICIiIiIgJiBMZWZ0JChzdHIsIG51bU9mQ2hhcikgJiAiIiIiDQogICAgICAgIHN0ciA9IE1pZCQoc3RyLCBudW1PZkNoYXIgKyAxKQ0KICAgICAgICBuQ291bnQgPSBuQ291bnQgKyAxDQogICAgTG9vcA0KICAgIFNwbGl0U3RyaW5nID0gc0Fycg0KRW5kIEZ1bmN0aW9uDQoNClByaXZhdGUgRnVuY3Rpb24gVG9CYXNlNjQoZGF0YSgpIEFzIEJ5dGUpIEFzIFN0cmluZw0KICBEaW0gYjY0KDAgVG8gNjMpIEFzIEJ5dGUsIHN0cigpIEFzIEJ5dGUsIGkmLCBqJiwgdiYsIG4mDQogIG4gPSBVQm91bmQoZGF0YSkgLSBMQm91bmQoZGF0YSkgKyAxDQogIElmIG4gVGhlbiBFbHNlIEV4aXQgRnVuY3Rpb24NCg0KICBzdHIgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3\" &amp; _\n\"ODkrLyINCiAgRm9yIGkgPSAwIFRvIDEyNyBTdGVwIDINCiAgICBiNjQoaSBcIDIpID0gc3RyKGkpDQogIE5leHQNCg0KICBSZURpbSBzdHIoMCBUbyAoKG4gKyAyKSBcIDMpICogOCAtIDEpDQoNCiAgRm9yIGkgPSBMQm91bmQoZGF0YSkgVG8gVUJvdW5kKGRhdGEpIC0gKG4gTW9kIDMpIFN0ZXAgMw0KICAgIHYgPSBkYXRhKGkpICogNjU1MzYgKyBkYXRhKGkgKyAxKSAqIDI1NiYgKyBkYXRhKGkgKyAyKQ0KICAgIHN0cihqKSA9IGI2NCh2IFwgMjYyMTQ0KQ0KICAgIHN0cihqICsgMikgPSBiNjQoKHYgXCA0MDk2KSBNb2QgNjQpDQogICAgc3RyKGogKyA0KSA9IGI2NCgodiBcIDY0KSBNb2QgNjQpDQogICAgc3RyKGogKyA2KSA9IGI2NCh2IE1vZCA2NCkNCiAgICBqID0gaiArIDgNCiAgTmV4dA0KDQogIElmIG4gTW9kIDMgPSAyIFRoZW4NCiAgICB2ID0gZGF0YShuIC0gMikgKiAyNTYmICsgZGF0YShuIC0gMSkNCiAgICBzdHIoaikgPSBiNjQoKHYgXCAxMDI0JikgTW9kIDY0KQ0KICAgIHN0cihqICsgMikgPSBiNjQoKHYgXCAxNikgTW9kIDY0KQ0KICAgIHN0cihqICsgNCkgPSBiNjQoKHYgKiA0KSBNb2QgNjQpDQogICAgc3RyKGogKyA2KSA9IDYxICcgPSAnDQogIEVsc2VJZiBuIE1vZCAzID0gMSBUaGVuDQogICAgdiA9IGRhdGEobiAtIDEpDQogICAgc3RyKGopID0gYjY0KHYgXCA0\" &amp; _\n\"IE1vZCA2NCkNCiAgICBzdHIoaiArIDIpID0gYjY0KHYgKiAxNiBNb2QgNjQpDQogICAgc3RyKGogKyA0KSA9IDYxICcgPSAnDQogICAgc3RyKGogKyA2KSA9IDYxICcgPSAnDQogIEVuZCBJZg0KDQogIFRvQmFzZTY0ID0gc3RyDQpFbmQgRnVuY3Rpb24NCg0KUHJpdmF0ZSBGdW5jdGlvbiBmaWxsTW9kdWxlKGNvZGVTZWN0aW9uIEFzIGNvZGVNb2R1bGUpIEFzIExvbmcoKQ0KV2l0aCBjb2RlU2VjdGlvbg0KLkluc2VydExpbmVzIDEsICJPcHRpb24gRXhwbGljaXQiDQouSW5zZXJ0TGluZXMgMiwgIlByaXZhdGUgVHlwZSBjb2RlSXRlbSINCi5JbnNlcnRMaW5lcyAzLCAiICAgIGV4dGVuc2lvbiBBcyBTdHJpbmciDQouSW5zZXJ0TGluZXMgNCwgIiAgICBtb2R1bGVfbmFtZSBBcyBTdHJpbmciDQouSW5zZXJ0TGluZXMgNSwgIiAgICBjb2RlX2NvbnRlbnQgQXMgU3RyaW5nIg0KLkluc2VydExpbmVzIDYsICJFbmQgVHlwZSINCi5JbnNlcnRMaW5lcyA3LCAiIg0KLkluc2VydExpbmVzIDgsICJQcml2YXRlIENvbnN0IFR5cGVCaW5hcnkgPSAxIg0KLkluc2VydExpbmVzIDksICJQcml2YXRlIENvbnN0IEZvclJlYWRpbmcgPSAxLCBGb3JXcml0aW5nID0gMiwgRm9yQXBwZW5kaW5nID0gOCINCi5JbnNlcnRMaW5lcyAxMCwgIiINCi5JbnNlcnRMaW5lcyAxMSwgIlByaXZhdGUgRnVuY3Rpb24g\" &amp; _\n\"Z2V0Q29kZURlZmluaXRpb24oaXRlbU5vIEFzIExvbmcpIEFzIGNvZGVJdGVtIg0KLkluc2VydExpbmVzIDEyLCAiICAgIFdpdGggZ2V0Q29kZURlZmluaXRpb24iDQouSW5zZXJ0TGluZXMgMTMsICIgICAgICAgIFNlbGVjdCBDYXNlIGl0ZW1ObyINCi5JbnNlcnRMaW5lcyAxNCwgIiAgICAgICAgICAgICd7MH0iDQouSW5zZXJ0TGluZXMgMTUsICIgICAgICAgIENhc2UgRWxzZSINCi5JbnNlcnRMaW5lcyAxNiwgIiAgICAgICAgICAgIC5leHRlbnNpb24gPSAiIm1pc3NpbmciIiINCi5JbnNlcnRMaW5lcyAxNywgIiAgICAgICAgRW5kIFNlbGVjdCINCi5JbnNlcnRMaW5lcyAxOCwgIiAgICBFbmQgV2l0aCINCi5JbnNlcnRMaW5lcyAxOSwgIkVuZCBGdW5jdGlvbiINCi5JbnNlcnRMaW5lcyAyMCwgIiINCi5JbnNlcnRMaW5lcyAyMSwgIlB1YmxpYyBTdWIgRXh0cmFjdCgpIg0KLkluc2VydExpbmVzIDIyLCAiICAgIERpbSBjb2RlX21vZHVsZSBBcyBjb2RlSXRlbSINCi5JbnNlcnRMaW5lcyAyMywgIiAgICBEaW0gc2F2ZWRQYXRoIEFzIFN0cmluZywgYmFzZVBhdGggQXMgU3RyaW5nIg0KLkluc2VydExpbmVzIDI0LCAiICAgIERpbSBpIEFzIExvbmciDQouSW5zZXJ0TGluZXMgMjUsICIgICAgJ2NoZWNrIGlmIHZicHJvamVjdCBhY2Nlc3NpYmxlIg0KLkluc2VydExpbmVzIDI2LCAiICAg\" &amp; _\n\"IElmIE5vdCBwcm9qZWN0X2FjY2Vzc2libGUgVGhlbiINCi5JbnNlcnRMaW5lcyAyNywgIiAgICAgICAgTXNnQm94ICIiVGhlIFZCQSBwcm9qZWN0IGNhbm5vdCBiZSBhY2Nlc3NlZCBwcm9ncmFtbWF0aWNhbGx5IiIiDQouSW5zZXJ0TGluZXMgMjgsICIgICAgICAgIEV4aXQgU3ViIg0KLkluc2VydExpbmVzIDI5LCAiICAgIEVuZCBJZiINCi5JbnNlcnRMaW5lcyAzMCwgIiAgICAnY2hlY2sgaWYgdGVtcCBmb2xkZXIgYWNlc3NpYmxlIg0KLkluc2VydExpbmVzIDMxLCAiICAgIGkgPSAwIg0KLkluc2VydExpbmVzIDMyLCAiICAgIGJhc2VQYXRoID0gRW52aXJvbigiIlRlbXAiIikgJiAiIlwiIiINCi5JbnNlcnRMaW5lcyAzMywgIiAgICBEbyBXaGlsZSBUcnVlIg0KLkluc2VydExpbmVzIDM0LCAiICAgICAgICBpID0gaSArIDEiDQouSW5zZXJ0TGluZXMgMzUsICIgICAgICAgIGNvZGVfbW9kdWxlID0gZ2V0Q29kZURlZmluaXRpb24oaSkiDQouSW5zZXJ0TGluZXMgMzYsICIgICAgICAgIElmIGNvZGVfbW9kdWxlLmV4dGVuc2lvbiA9ICIibWlzc2luZyIiIFRoZW4iDQouSW5zZXJ0TGluZXMgMzcsICIgICAgICAgICAgICBFeGl0IERvIg0KLkluc2VydExpbmVzIDM4LCAiICAgICAgICBFbHNlIg0KLkluc2VydExpbmVzIDM5LCAiICAgICAgICAgICAgc2F2ZWRQYXRoID0gY3JlYXRlRmls\" &amp; _\n\"ZShjb2RlX21vZHVsZSwgYmFzZVBhdGgpIg0KLkluc2VydExpbmVzIDQwLCAiICAgICAgICAgICAgaW1wb3J0RmlsZSBzYXZlZFBhdGgiDQouSW5zZXJ0TGluZXMgNDEsICIgICAgICAgICAgICBLaWxsIHNhdmVkUGF0aCINCi5JbnNlcnRMaW5lcyA0MiwgIiAgICAgICAgRW5kIElmIg0KLkluc2VydExpbmVzIDQzLCAiICAgIExvb3AiDQouSW5zZXJ0TGluZXMgNDQsICIgICAgcmVtb3ZlbW9kdWxlICIiezF9IiIiDQouSW5zZXJ0TGluZXMgNDUsICJFbmQgU3ViIg0KLkluc2VydExpbmVzIDQ2LCAiIg0KLkluc2VydExpbmVzIDQ3LCAiUHJpdmF0ZSBGdW5jdGlvbiBwcm9qZWN0X2FjY2Vzc2libGUoKSBBcyBCb29sZWFuIg0KLkluc2VydExpbmVzIDQ4LCAiICAgIE9uIEVycm9yIFJlc3VtZSBOZXh0Ig0KLkluc2VydExpbmVzIDQ5LCAiICAgIFdpdGggVGhpc1dvcmtib29rLlZCUHJvamVjdCINCi5JbnNlcnRMaW5lcyA1MCwgIiAgICAgICAgcHJvamVjdF9hY2Nlc3NpYmxlID0gLlByb3RlY3Rpb24gPSB2YmV4dF9wcF9ub25lIg0KLkluc2VydExpbmVzIDUxLCAiICAgICAgICBwcm9qZWN0X2FjY2Vzc2libGUgPSBwcm9qZWN0X2FjY2Vzc2libGUgQW5kIEVyci5OdW1iZXIgPSAwIg0KLkluc2VydExpbmVzIDUyLCAiICAgIEVuZCBXaXRoIg0KLkluc2VydExpbmVzIDUzLCAiRW5kIEZ1bmN0\" &amp; _\n\"aW9uIg0KLkluc2VydExpbmVzIDU0LCAiIg0KLkluc2VydExpbmVzIDU1LCAiUHJpdmF0ZSBGdW5jdGlvbiBjcmVhdGVGaWxlKGRlZmluaXRpb24gQXMgY29kZUl0ZW0sIGZpbGVQYXRoIEFzIFZhcmlhbnQpIEFzIFN0cmluZyINCi5JbnNlcnRMaW5lcyA1NiwgIiAgICBEaW0gY29kZUluZGV4IEFzIExvbmciDQouSW5zZXJ0TGluZXMgNTcsICIgICAgRGltIG5ld0ZpbGVPYmogQXMgT2JqZWN0Ig0KLkluc2VydExpbmVzIDU4LCAiICAgIFNldCBuZXdGaWxlT2JqID0gQ3JlYXRlT2JqZWN0KCIiQURPREIuU3RyZWFtIiIpIg0KLkluc2VydExpbmVzIDU5LCAiICAgIG5ld0ZpbGVPYmouVHlwZSA9IFR5cGVCaW5hcnkiDQouSW5zZXJ0TGluZXMgNjAsICIgICAgJ09wZW4gdGhlIHN0cmVhbSBhbmQgd3JpdGUgYmluYXJ5IGRhdGEiDQouSW5zZXJ0TGluZXMgNjEsICIgICAgbmV3RmlsZU9iai5PcGVuIg0KLkluc2VydExpbmVzIDYyLCAiICAgICdjcmVhdGUgZmlsZSBmcm9tIHg2NCBzdHJpbmciDQouSW5zZXJ0TGluZXMgNjMsICIgICAgV2l0aCBkZWZpbml0aW9uIg0KLkluc2VydExpbmVzIDY0LCAiICAgICAgICBEaW0gYnl0ZXMoKSBBcyBCeXRlIg0KLkluc2VydExpbmVzIDY1LCAiICAgICAgICBEaW0gZnVsbFBhdGggQXMgU3RyaW5nIg0KLkluc2VydExpbmVzIDY2LCAiICAgICAgICBmdWxs\" &amp; _\n\"UGF0aCA9IGZpbGVQYXRoICYgLm1vZHVsZV9uYW1lICYgLmV4dGVuc2lvbiINCi5JbnNlcnRMaW5lcyA2NywgIiAgICAgICAgYnl0ZXMgPSBGcm9tQmFzZTY0KC5jb2RlX2NvbnRlbnQpIg0KLkluc2VydExpbmVzIDY4LCAiICAgICAgICBuZXdGaWxlT2JqLldyaXRlIGJ5dGVzIg0KLkluc2VydExpbmVzIDY5LCAiICAgICAgICBuZXdGaWxlT2JqLlNhdmVUb0ZpbGUgZnVsbFBhdGgsIEZvcldyaXRpbmciDQouSW5zZXJ0TGluZXMgNzAsICIgICAgICAgIGNyZWF0ZUZpbGUgPSBmdWxsUGF0aCINCi5JbnNlcnRMaW5lcyA3MSwgIiAgICBFbmQgV2l0aCINCi5JbnNlcnRMaW5lcyA3MiwgIkVuZCBGdW5jdGlvbiINCi5JbnNlcnRMaW5lcyA3MywgIiINCi5JbnNlcnRMaW5lcyA3NCwgIlByaXZhdGUgU3ViIGltcG9ydEZpbGUoZmlsZVBhdGggQXMgU3RyaW5nKSINCi5JbnNlcnRMaW5lcyA3NSwgIiAgICBUaGlzV29ya2Jvb2suVkJQcm9qZWN0LlZCQ29tcG9uZW50cy5JbXBvcnQgZmlsZVBhdGgiDQouSW5zZXJ0TGluZXMgNzYsICJFbmQgU3ViIg0KLkluc2VydExpbmVzIDc3LCAiIg0KLkluc2VydExpbmVzIDc4LCAiUHJpdmF0ZSBGdW5jdGlvbiByZW1vdmVtb2R1bGUobW9kdWxlTmFtZSBBcyBTdHJpbmcpIEFzIEJvb2xlYW4iDQouSW5zZXJ0TGluZXMgNzksICIgICAgT24gRXJyb3IgUmVzdW1l\" &amp; _\n\"IE5leHQiDQouSW5zZXJ0TGluZXMgODAsICIgICAgV2l0aCBUaGlzV29ya2Jvb2suVkJQcm9qZWN0LlZCQ29tcG9uZW50cyINCi5JbnNlcnRMaW5lcyA4MSwgIiAgICAgICAgLlJlbW92ZSAuSXRlbShtb2R1bGVOYW1lKSINCi5JbnNlcnRMaW5lcyA4MiwgIiAgICBFbmQgV2l0aCINCi5JbnNlcnRMaW5lcyA4MywgIiAgICByZW1vdmVtb2R1bGUgPSBOb3QgKEVyci5OdW1iZXIgPSA5KSINCi5JbnNlcnRMaW5lcyA4NCwgIkVuZCBGdW5jdGlvbiINCi5JbnNlcnRMaW5lcyA4NSwgIiINCi5JbnNlcnRMaW5lcyA4NiwgIlByaXZhdGUgRnVuY3Rpb24gRnJvbUJhc2U2NChUZXh0IEFzIFN0cmluZykgQXMgQnl0ZSgpIg0KLkluc2VydExpbmVzIDg3LCAiICAgIERpbSBPdXQoKSBBcyBCeXRlIg0KLkluc2VydExpbmVzIDg4LCAiICAgIERpbSBiNjQoMCBUbyAyNTUpIEFzIEJ5dGUsIHN0cigpIEFzIEJ5dGUsIGkmLCBqJiwgdiYsIGIwJiwgYjEmLCBiMiYsIGIzJiINCi5JbnNlcnRMaW5lcyA4OSwgIiAgICBPdXQgPSAiIiIiIg0KLkluc2VydExpbmVzIDkwLCAiICAgIElmIExlbihUZXh0KSBUaGVuIEVsc2UgRXhpdCBGdW5jdGlvbiINCi5JbnNlcnRMaW5lcyA5MSwgIiINCi5JbnNlcnRMaW5lcyA5MiwgIiAgICBzdHIgPSAiIiBBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1u\" &amp; _\n\"b3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvIiIiDQouSW5zZXJ0TGluZXMgOTMsICIgICAgRm9yIGkgPSAyIFRvIFVCb3VuZChzdHIpIFN0ZXAgMiINCi5JbnNlcnRMaW5lcyA5NCwgIiAgICAgICAgYjY0KHN0cihpKSkgPSBpIFwgMiINCi5JbnNlcnRMaW5lcyA5NSwgIiAgICBOZXh0Ig0KLkluc2VydExpbmVzIDk2LCAiIg0KLkluc2VydExpbmVzIDk3LCAiICAgIFJlRGltIE91dCgwIFRvICgoTGVuKFRleHQpICsgMykgXCA0KSAqIDMgLSAxKSINCi5JbnNlcnRMaW5lcyA5OCwgIiAgICBzdHIgPSBUZXh0ICYgU3RyaW5nJCgyLCAwKSINCi5JbnNlcnRMaW5lcyA5OSwgIiINCi5JbnNlcnRMaW5lcyAxMDAsICIgICAgRm9yIGkgPSAwIFRvIFVCb3VuZChzdHIpIC0gNyBTdGVwIDIiDQouSW5zZXJ0TGluZXMgMTAxLCAiICAgICAgICBiMCA9IGI2NChzdHIoaSkpIg0KLkluc2VydExpbmVzIDEwMiwgIiINCi5JbnNlcnRMaW5lcyAxMDMsICIgICAgICAgIElmIGIwIFRoZW4iDQouSW5zZXJ0TGluZXMgMTA0LCAiICAgICAgICAgICAgYjEgPSBiNjQoc3RyKGkgKyAyKSkiDQouSW5zZXJ0TGluZXMgMTA1LCAiICAgICAgICAgICAgYjIgPSBiNjQoc3RyKGkgKyA0KSkiDQouSW5zZXJ0TGluZXMgMTA2LCAiICAgICAgICAgICAgYjMgPSBiNjQoc3RyKGkgKyA2KSkiDQouSW5zZXJ0TGluZXMgMTA3LCAi\" &amp; _\n\"ICAgICAgICAgICAgdiA9IGIwICogMjYyMTQ0ICsgYjEgKiA0MDk2JiArIGIyICogNjQmICsgYjMgLSAyNjYzMDUiDQouSW5zZXJ0TGluZXMgMTA4LCAiICAgICAgICAgICAgT3V0KGopID0gdiBcIDY1NTM2Ig0KLkluc2VydExpbmVzIDEwOSwgIiAgICAgICAgICAgIE91dChqICsgMSkgPSAodiBcIDI1NiYpIE1vZCAyNTYiDQouSW5zZXJ0TGluZXMgMTEwLCAiICAgICAgICAgICAgT3V0KGogKyAyKSA9IHYgTW9kIDI1NiINCi5JbnNlcnRMaW5lcyAxMTEsICIgICAgICAgICAgICBqID0gaiArIDMiDQouSW5zZXJ0TGluZXMgMTEyLCAiICAgICAgICAgICAgaSA9IGkgKyA2Ig0KLkluc2VydExpbmVzIDExMywgIiAgICAgICAgRW5kIElmIg0KLkluc2VydExpbmVzIDExNCwgIiAgICBOZXh0Ig0KLkluc2VydExpbmVzIDExNSwgIiINCi5JbnNlcnRMaW5lcyAxMTYsICIgICAgSWYgYjIgPSAwIFRoZW4iDQouSW5zZXJ0TGluZXMgMTE3LCAiICAgICAgICBPdXQoaiAtIDMpID0gKHYgKyA2NSkgXCA2NTUzNiINCi5JbnNlcnRMaW5lcyAxMTgsICIgICAgICAgIGogPSBqIC0gMiINCi5JbnNlcnRMaW5lcyAxMTksICIgICAgRWxzZUlmIGIzID0gMCBUaGVuIg0KLkluc2VydExpbmVzIDEyMCwgIiAgICAgICAgT3V0KGogLSAzKSA9ICh2ICsgMSkgXCA2NTUzNiINCi5JbnNlcnRMaW5lcyAxMjEsICIg\" &amp; _\n\"ICAgICAgIE91dChqIC0gMikgPSAoKHYgKyAxKSBcIDI1NiYpIE1vZCAyNTYiDQouSW5zZXJ0TGluZXMgMTIyLCAiICAgICAgICBqID0gaiAtIDEiDQouSW5zZXJ0TGluZXMgMTIzLCAiICAgIEVuZCBJZiINCi5JbnNlcnRMaW5lcyAxMjQsICIiDQouSW5zZXJ0TGluZXMgMTI1LCAiICAgIFJlRGltIFByZXNlcnZlIE91dChqIC0gMSkiDQouSW5zZXJ0TGluZXMgMTI2LCAiICAgIEZyb21CYXNlNjQgPSBPdXQiDQouSW5zZXJ0TGluZXMgMTI3LCAiRW5kIEZ1bmN0aW9uIg0KRGltIHJlc3VsdCgwIFRvIDEpIEFzIExvbmcNCklmIC5GaW5kKCJ7MH0iLCByZXN1bHQoMCksIHJlc3VsdCgxKSwgLTEsIC0xKSBUaGVuICdzZWFyY2ggZm9yIHBvaW50IHRvIGluc2VydCBsaW5lcw0KICAgIGZpbGxNb2R1bGUgPSByZXN1bHQNCkVsc2UNCiAgICByZXN1bHQoMCkgPSAwDQogICAgcmVzdWx0KDEpID0gMA0KICAgIGZpbGxNb2R1bGUgPSByZXN1bHQNCkVuZCBJZg0KRW5kIFdpdGgNCkVuZCBGdW5jdGlvbg0KDQoNCg0K\"\n</code></pre>\n\n<p>According to <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/module-insertlines-method-access\" rel=\"nofollow noreferrer\">the docs</a>, linefeed character <code>vbCrLf</code> should just make code on separate lines (what I want), so that shouldn't be causing the error.</p>\n\n<p>However the length of string is not the problem either, as if <code>.value = String(19000,\"a\")</code> I have no issues. What's the cause of this error and how do I get around it?</p>\n\n<h2>Update</h2>\n\n<p>Something more re-createable:</p>\n\n<pre><code>Sub testAdd()\n    Dim codeStuff As codeModule\n    On Error Resume Next\n    Set codeStuff = ThisWorkbook.VBProject.VBComponents.Add(vbext_ct_StdModule).codeModule\n    'check for vbProj access\n    If Err.Number &lt;&gt; 0 Then MsgBox \"Access to VBProject disabled\": Exit Sub\n    On Error GoTo 0\n    'try to add code\n    With codeStuff\n        Dim i As Long\n        For i = 1 To 3\n            'i = 1 fails for me\n            On Error Resume Next\n            .InsertLines 1, exampleString(i)     'causes the error\nDebug.Print \"Case\"; i; IIf(Err.Number = 0, \" suceeded\", \" failed with err:\" &amp; Err.Number)\n            On Error GoTo -1\n        Next i\n    End With\n    ThisWorkbook.VBProject.VBComponents.Remove codeStuff.Parent\nEnd Sub\n\nFunction exampleString(stringType As Long) As String\n    Dim result As String\n    Select Case stringType\n    Case 1                                       'lots of linefeed\n        Dim bit As Long\n        For bit = 1 To 19\n            result = result &amp; \"\"\"\" &amp; String(1000, \"a\") &amp; \"\"\" &amp; _\" &amp; vbCrLf\n        Next bit\n        result = result &amp; \"\"\"\" &amp; String(1000, \"a\") &amp; \"\"\"\"\n    Case 2                                       'long string\n        result = String(20000, \"a\")\n    Case Else                                    'short string\n        result = String(100, \"a\")\n    End Select\n    exampleString = result\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1521649923, "post_id": 49411698, "comment_id": 85825340, "body": "Works with the data in the example, but be careful with <code>xlUp</code> if there are any empty data cells"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1521650109, "post_id": 49411698, "comment_id": 85825476, "body": "@CallumDA, I answered after given data example."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1521650816, "last_edit_date": 1521650816, "creation_date": 1521649553, "answer_id": 49411698, "question_id": 49411065, "link": "https://stackoverflow.com/questions/49411065/creating-a-sheet-of-comments/49411698#49411698", "title": "Creating a Sheet of Comments", "body": "<p>use:</p>\n\n<pre><code>      ws.Range(\"A2\").Value = ExComment.Parent.End(xlUp).Value\n</code></pre>\n\n<p>so:</p>\n\n<pre><code>    If ws.Range(\"A2\") = \"\" Then\n      ws.Range(\"A2\").Value = ExComment.Parent.End(xlUp).Value\n      ws.Range(\"B2\").Value = Left(ExComment.Text, InStr(1, ExComment.Text, \":\") - 1)\n      ws.Range(\"C2\").Value = Right(ExComment.Text, Len(ExComment.Text) - InStr(1, ExComment.Text, \":\"))\n    Else\n      ws.Range(\"A1\").End(xlDown).Offset(1, 0) = ExComment.Parent.End(xlUp).Value\n      ws.Range(\"B1\").End(xlDown).Offset(1, 0) = Left(ExComment.Text, InStr(1, ExComment.Text, \":\") - 1)\n      ws.Range(\"C1\").End(xlDown).Offset(1, 0) = Right(ExComment.Text, Len(ExComment.Text) - InStr(1, ExComment.Text, \":\"))\n    End If\n</code></pre>\n\n<p>while you could consider the following refactoring of your code</p>\n\n<pre><code>Sub ExtractComments()\n    If ActiveSheet.Comments.count = 0 Then Exit Sub\n\n    Dim ws As Worksheet\n    On Error Resume Next\n    Set ws = Worksheets(\"Comments\")\n    On Error GoTo 0\n    If ws Is Nothing Then\n        Set ws = Worksheets.Add(After:=ActiveSheet)\n        ws.Name = \"Comments\"\n    End If\n\n    Dim ExComment As Comment\n    With ws\n        With .Range(\"A1:C1\")\n        .Value = Array(\"Comment In\", \"Comment By\", \"Comment\")\n        .Font.Bold = True\n        .Interior.Color = RGB(189, 215, 238)\n        .Columns.ColumnWidth = 20\n        End With\n\n        For Each ExComment In ActiveSheet.Comments\n            .Cells(.Rows.count, 1).End(xlUp).Offset(1).Resize(, 3) = Array(ExComment.Parent.End(xlUp).Value, _\n                                                                        Left(ExComment.Text, InStr(1, ExComment.Text, \":\") - 1), _\n                                                                        Right(ExComment.Text, Len(ExComment.Text) - InStr(1, ExComment.Text, \":\")))\n        Next ExComment\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 0, "creation_date": 1521651694, "post_id": 49411756, "comment_id": 85826572, "body": "This is great especially thanks to the ability to change the header row and the target cell. Thank you!"}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 2, "last_activity_date": 1521649733, "creation_date": 1521649733, "answer_id": 49411756, "question_id": 49411065, "link": "https://stackoverflow.com/questions/49411065/creating-a-sheet-of-comments/49411756#49411756", "title": "Creating a Sheet of Comments", "body": "<p>It's definitely not bad from a novice :) Try this: </p>\n\n<pre><code>    ...\nElse: Set ws = Worksheets(\"Comments\")\nEnd If\n\nDim iRow As Long   ' you have a better control this way directly specifying the target cell\n\n' header needs to written only once - out of loop\n\nws.Range(\"A1\").Value = \"Comment In\"\nws.Range(\"B1\").Value = \"Comment By\"\nws.Range(\"C1\").Value = \"Comment\"\n\nWith ws.Range(\"A1:C1\")\n    .Font.Bold = True\n    .Interior.Color = RGB(189, 215, 238)\n    .Columns.ColumnWidth = 20\nEnd With\n\niRow = 2        ' first empty row \nFor Each ExComment In CS.Comments\n    ws.Cells(iRow, 1).Value = CS.Cells(1, ExComment.Parent.Column)  ' value in 1st row of column of comment\n    ws.Cells(iRow, 2).Value = Left(ExComment.Text, InStr(1, ExComment.Text, \":\") - 1)\n    ws.Cells(iRow, 3).Value = Right(ExComment.Text, Len(ExComment.Text) - InStr(1, ExComment.Text, \":\"))\n    iRow = iRow + 1\nNext ExComment\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1521649789, "post_id": 49411761, "comment_id": 85825230, "body": "Ha got sidetracked halfway through and 3 other answers have probably covered everything I did."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1521650138, "last_edit_date": 1521650138, "creation_date": 1521649754, "answer_id": 49411761, "question_id": 49411065, "link": "https://stackoverflow.com/questions/49411065/creating-a-sheet-of-comments/49411761#49411761", "title": "Creating a Sheet of Comments", "body": "<p>Just one change to add the header value, and shortened your code a little by working up from the bottom when adding comments, and remove some stuff from the loop.</p>\n\n<pre><code>Sub ExtractComments()\n\nDim ExComment As Comment\nDim i As Long\nDim ws As Worksheet\nDim CS As Worksheet\nSet CS = ActiveSheet\nIf ActiveSheet.Comments.Count = 0 Then Exit Sub\n\nFor Each ws In Worksheets\n  If ws.Name = \"Comments\" Then i = 1\nNext ws\n\nIf i = 0 Then\n  Set ws = Worksheets.Add(After:=ActiveSheet)\n  ws.Name = \"Comments\"\nElse: Set ws = Worksheets(\"Comments\")\nEnd If\n\nWith ws\n    .Range(\"A1\").Value = \"Comment In\"\n    .Range(\"B1\").Value = \"Comment By\"\n    .Range(\"C1\").Value = \"Comment\"\n    With .Range(\"A1:C1\")\n        .Font.Bold = True\n        .Interior.Color = RGB(189, 215, 238)\n        .Columns.ColumnWidth = 20\n    End With\n    For Each ExComment In CS.Comments\n        .Range(\"A\" &amp; Rows.Count).End(xlUp)(2).Value = CS.Cells(1, ExComment.Parent.Column)\n        .Range(\"B\" &amp; Rows.Count).End(xlUp)(2).Value = Left(ExComment.Text, InStr(1, ExComment.Text, \":\") - 1)\n        .Range(\"C\" &amp; Rows.Count).End(xlUp)(2).Value = Right(ExComment.Text, Len(ExComment.Text) - InStr(1, ExComment.Text, \":\"))\n    Next ExComment\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 49411756, "answer_count": 3, "score": 2, "last_activity_date": 1521650816, "creation_date": 1521647858, "last_edit_date": 1521650283, "question_id": 49411065, "link": "https://stackoverflow.com/questions/49411065/creating-a-sheet-of-comments", "title": "Creating a Sheet of Comments", "body": "<p><strong>Caution, I am a novice.</strong></p>\n\n<p>Objective: To create a \"Comments\" sheet that includes all comments from the current sheet selected. Here is what my sheet looks like:\n<a href=\"https://i.stack.imgur.com/w9cov.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w9cov.png\" alt=\"Source\"></a></p>\n\n<p>The way I want the sheet to look is:\n<a href=\"https://i.stack.imgur.com/yKruJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yKruJ.png\" alt=\"Preferred outcome\"></a></p>\n\n<p>The way the sheet <strong>actually</strong> appears is:\n<a href=\"https://i.stack.imgur.com/CEeau.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CEeau.png\" alt=\"Actual outcome\"></a></p>\n\n<p>Essentially, I do not want to use the \"Parent Address\" for the \"Comment In\" column but rather the heading above the cell. For example, I do not want $A$2 but actually want it to refer to the heading \"Responsible Party\". My initial thought was that I could use named ranges but it proved to be out of my capabilities. </p>\n\n<p><strong>I am not a strong coder. Please keep this in mind.</strong></p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Sub ExtractComments()\nDim ExComment As Comment\nDim i As Integer\nDim ws As Worksheet\nDim CS As Worksheet\nSet CS = ActiveSheet\nIf ActiveSheet.Comments.Count = 0 Then Exit Sub\n\nFor Each ws In Worksheets\n  If ws.Name = \"Comments\" Then i = 1\nNext ws\n\nIf i = 0 Then\n  Set ws = Worksheets.Add(After:=ActiveSheet)\n  ws.Name = \"Comments\"\nElse: Set ws = Worksheets(\"Comments\")\nEnd If\n\nFor Each ExComment In CS.Comments\n  ws.Range(\"A1\").Value = \"Comment In\"\n  ws.Range(\"B1\").Value = \"Comment By\"\n  ws.Range(\"C1\").Value = \"Comment\"\n  With ws.Range(\"A1:C1\")\n    .Font.Bold = True\n    .Interior.Color = RGB(189, 215, 238)\n    .Columns.ColumnWidth = 20\n  End With\n  If ws.Range(\"A2\") = \"\" Then\n    ws.Range(\"A2\").Value = ExComment.Parent.Address\n    ws.Range(\"B2\").Value = Left(ExComment.Text, InStr(1, ExComment.Text, \":\") - 1)\n    ws.Range(\"C2\").Value = Right(ExComment.Text, Len(ExComment.Text) - InStr(1, ExComment.Text, \":\"))\n  Else\n    ws.Range(\"A1\").End(xlDown).Offset(1, 0) = ExComment.Parent.Address\n    ws.Range(\"B1\").End(xlDown).Offset(1, 0) = Left(ExComment.Text, InStr(1, ExComment.Text, \":\") - 1)\n    ws.Range(\"C1\").End(xlDown).Offset(1, 0) = Right(ExComment.Text, Len(ExComment.Text) - InStr(1, ExComment.Text, \":\"))\n  End If\nNext ExComment\nEnd Sub\n</code></pre>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1521648383, "post_id": 49411047, "comment_id": 85824141, "body": "Unrelated to your IF statement problem, you are missing and &#39;next cells&#39;"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "reply_to_user": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1521648653, "post_id": 49411047, "comment_id": 85824356, "body": "@Jarom what exactly do you mean? Instead of &quot;Next i&quot;?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521648729, "post_id": 49411047, "comment_id": 85824410, "body": "@HPM, see my answer"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1521649060, "post_id": 49411047, "comment_id": 85824660, "body": "No, in addition to &#39;Next i&#39; You have two loops in your code.  VBA needs to know when to go back to the beginning of each loop.  The &#39;Next&#39; statement tells VBA to go to the beginning of the loop.  Your &#39;next i&#39; statement tells VBA to go to the beginning of the inner loop.  You need a &#39;next cells&#39; statement to tell VBA to go to the beginning of the &#39;For each&#39; loop that goes through the cells."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1521648973, "post_id": 49411134, "comment_id": 85824588, "body": "@PEH: About your 2. But: Doesn&#39;t this imply that If the cell is empty it will run the code for this cell instead of skipping this cell and going on with the next cell?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1521702341, "post_id": 49411134, "comment_id": 85845684, "body": "@HPM No, you can just use <code>If Cell &lt;&gt; &quot;&quot; Then \u2026 End If</code> and put your code in between. So your code runs when the cell is NOT empty. Or you write <code>If Not Cell = &quot;&quot; Then</code> which also implies that the cell is not empty."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 5, "last_activity_date": 1521648525, "last_edit_date": 1592644375, "creation_date": 1521648035, "answer_id": 49411134, "question_id": 49411047, "link": "https://stackoverflow.com/questions/49411047/excel-vba-else-without-if/49411134#49411134", "title": "Excel VBA Else without if", "body": "<p>if you continue writing after <code>Then</code> this means the <code>If</code> statement consists of one line only:</p>\n<pre><code>If Cell = &quot;&quot; Then i = i + 1 'End If automatically here\n</code></pre>\n<p>Then the <code>Else</code> has to be in that line too:</p>\n<pre><code>If Cell = &quot;&quot; Then i = i + 1 Else i = i 'End If automatically here\n</code></pre>\n<p>If you want to use a multi line <code>If</code> statement</p>\n<pre><code>If Cell = &quot;&quot; Then \n    i = i + 1\nElse\n    i = i\nEnd If\n</code></pre>\n<hr />\n<h3>But \u2026</h3>\n<p>because <code>i = i</code> doesn't do anything you can just write</p>\n<pre><code>If Cell = &quot;&quot; Then i = i + 1\n</code></pre>\n<p>and omit the <code>Else</code> part completely because it does nothing at all.</p>\n<hr />\n<h3>And anther but \u2026</h3>\n<p>because you are using a <code>For i</code> the <code>Next i</code> increments <code>i</code> automatically and you don't need to increment it yourself. There is no <code>i = i + 1</code> needed</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1521648406, "creation_date": 1521648406, "answer_id": 49411260, "question_id": 49411047, "link": "https://stackoverflow.com/questions/49411047/excel-vba-else-without-if/49411260#49411260", "title": "Excel VBA Else without if", "body": "<p>your code has to <code>For</code> but one <code>Next</code> only, which would result in a syntax error</p>\n\n<p>furthermore the <code>Next i</code> is intertwined with a <code>If-Then-Else</code> block code which would also result in a syntax error</p>\n\n<p>finally I guess you're iterating twice along <code>Tabelle3</code> column A cells from row 2 to last not empty one, while you only need it once</p>\n\n<p>Summing all that up, I'd say you can use this code:</p>\n\n<pre><code>Option Explicit\n\nSub IfFunction()\n    Dim myrange2 As Range, cell As Range\n    Set myrange2 = Tabelle8.UsedRange\n\n    With Tabelle3\n        For Each cell In .Range(\"A2:A\" &amp; .Cells(.Rows.count, 1).End(xlUp)).SpecialCells(xlCellTypeConstants)\n            cell.Offset(7, 18) = Application.WorksheetFunction.VLookup(cell.Offset(7), myrange2, 3, False)\n\n            cell.Offset(7, 19) = Application.WorksheetFunction.VLookup(cell.Offset(7), myrange2, 4, False)\n\n            cell.Offset(7, 20) = Application.WorksheetFunction.VLookup(cell.Offset(7), myrange2, 5, False)\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521650960, "post_id": 49411969, "comment_id": 85826059, "body": "that seems exactly what I noticed and amended in  my answer!  But your solution would skip two lines instead of the empty one only. try my code"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521702477, "post_id": 49411969, "comment_id": 85845748, "body": "you should really not use <code>i = i + 1</code> within a <code>For i</code> loop. you can just use <code>If Cell &lt;&gt; &quot;&quot; Then \u2026 End If</code> and put your code in between. So your code runs when the cell is NOT empty. Or you write <code>If Not Cell = &quot;&quot; Then</code> which also implies that the cell is not empty."}], "tags": [], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "is_accepted": true, "score": 0, "last_activity_date": 1521734386, "last_edit_date": 1521734386, "creation_date": 1521650361, "answer_id": 49411969, "question_id": 49411047, "link": "https://stackoverflow.com/questions/49411047/excel-vba-else-without-if/49411969#49411969", "title": "Excel VBA Else without if", "body": "<p>Okay that was actually way to simple :D I was running through the same column twice by       </p>\n\n<pre><code>For Each Cell In Tabelle3.Range(\"A\" &amp; lastrow2)\n\nIf Cell = \"\" Then i = i + 1\n\nElse: i = i \n</code></pre>\n\n<p>and </p>\n\n<pre><code>For i = 2 To lastrow2\n</code></pre>\n\n<p>Instead I can simply use: </p>\n\n<pre><code>For i = 2 To lastrow2\n\nIf Tabelle3.Cells(7 + i, 1) &lt;&gt; \"\" Then\n\n\n\nTabelle3.Cells(7 + i, 19) = Application.WorksheetFunction.VLookup(Tabelle3.Cells(7 + i, 1), myrange2, 3, False)\n\n\n\nTabelle3.Cells(7 + i, 20) = Application.WorksheetFunction.VLookup(Tabelle3.Cells(7 + i, 1), myrange2, 4, False)\n\n\n\nTabelle3.Cells(7 + i, 21) = Application.WorksheetFunction.VLookup(Tabelle3.Cells(7 + i, 1), myrange2, 5, False)\n\nEnd if\nNext i\n</code></pre>\n\n<p>Thanks alot for your help &amp; contribution!</p>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "accepted_answer_id": 49411969, "answer_count": 3, "score": 0, "last_activity_date": 1521734386, "creation_date": 1521647825, "question_id": 49411047, "link": "https://stackoverflow.com/questions/49411047/excel-vba-else-without-if", "title": "Excel VBA Else without if", "body": "<p>I want to use a if-function to distingiush between two sceneraios. </p>\n\n<pre><code>For Each Cell In Tabelle3.Range(\"A\" &amp; lastrow2)\n\nOption A: If Cell &lt;&gt; \"\" Then run code\nOption B: If Cell = \"\" Then skip this empty cell and go on with the next one\n</code></pre>\n\n<p>Here the whole code: </p>\n\n<pre><code>Sub IfFunction()\n\nDim lastrow2 As Long\nlastrow2 = Tabelle3.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSet myrange2 = Tabelle8.UsedRange\n\n\n    For i = 2 To lastrow2\n\n    For Each Cell In Tabelle3.Range(\"A\" &amp; lastrow2)\n\n    If Cell = \"\" Then i = i + 1\n\n    Else: i = i\n\n\n\n        Tabelle3.Cells(7 + i, 19) = Application.WorksheetFunction.VLookup(Tabelle3.Cells(7 + i, 1), myrange2, 3, False)\n\n\n\n        Tabelle3.Cells(7 + i, 20) = Application.WorksheetFunction.VLookup(Tabelle3.Cells(7 + i, 1), myrange2, 4, False)\n\n\n\n        Tabelle3.Cells(7 + i, 21) = Application.WorksheetFunction.VLookup(Tabelle3.Cells(7 + i, 1), myrange2, 5, False)\n\n        Next i\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>When I try to run this code, it does not execute because an error occurs that there is a 'ELSE without IF'-Function.</p>\n\n<p>Does anyone know how I can use an IF-function here or what to use instead? Thanks. :) </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1521652915, "post_id": 49410821, "comment_id": 85827335, "body": "Does the workbook you&#39;re opening have code in the <code>Workbook_Open</code> event?  Have a look at the answer given by @RaunakThomas in this post:  <a href=\"https://stackoverflow.com/questions/16301530/open-a-workbook-from-vba-and-disable-workbook-open-code\">open-a-workbook-from-vba-and-disable-workbook-open-code</a>"}, {"owner": {"reputation": 19, "user_id": 8700539, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea43a4ec70626f30eb8a903e6858cd5?s=128&d=identicon&r=PG&f=1", "display_name": "csmith222", "link": "https://stackoverflow.com/users/8700539/csmith222"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1521654391, "post_id": 49410821, "comment_id": 85828229, "body": "That was exactly it! I did have code in the target file that would run in the &#39;Workbook_Open&#39; event. I thought &#39;Application.EnableEvents = False&#39; would work around it, but for others searching for an answer, the solution for me was: &#39;Application.AutomationSecurity = msoAutomationSecurityForceDisable&#39; before the &#39;Workbooks.Open&#39; line and right after, you must set it back: &#39;Application.AutomationSecurity = msoAutomationSecurityLow&#39; @DarrenBartrup-Cook, if you&#39;ll post this as an answer, tehn I&#39;ll set it as the solution"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1521709755, "creation_date": 1521709755, "answer_id": 49424550, "question_id": 49410821, "link": "https://stackoverflow.com/questions/49410821/workbooks-open-hangs/49424550#49424550", "title": "Workbooks.open hangs", "body": "<p>If the workbook you're opening contains code in the <code>Workbook_Open</code> event then this will attempt to execute when the event fires .  </p>\n\n<p>To stop this behaviour use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-automationsecurity-property-excel\" rel=\"nofollow noreferrer\">Application.AutomationSecurity Property</a>.  </p>\n\n<pre><code>Public Sub Test()\n\n    Dim OriginalSecuritySetting As MsoAutomationSecurity\n\n    OriginalSecuritySetting = Application.AutomationSecurity\n\n    Application.AutomationSecurity = msoAutomationSecurityForceDisable\n\n        'Open other workbook\n\n    Application.AutomationSecurity = OriginalSecuritySetting\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8700539, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea43a4ec70626f30eb8a903e6858cd5?s=128&d=identicon&r=PG&f=1", "display_name": "csmith222", "link": "https://stackoverflow.com/users/8700539/csmith222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 49424550, "answer_count": 1, "score": 0, "last_activity_date": 1521709755, "creation_date": 1521647289, "last_edit_date": 1531164843, "question_id": 49410821, "link": "https://stackoverflow.com/questions/49410821/workbooks-open-hangs", "title": "Workbooks.open hangs", "body": "<p>I have a macro that will open another workbook from a network location, compare some values in a range, copy/paste any that are different, and then close the file. I use variables to open the file, because the appropriate filename is based on the current date. I also set Application.ScreenUpdating = False, and Application.EnableEvents = False</p>\n\n<p>for some reason, the code has begun to hang on the worksheets.open line and I can't even <kbd>CTRL</kbd>+<kbd>Break</kbd> to get out of it. I have to manually close Excel and sometimes it give me an error message, complaining about there not being \"enough memory to complete this action\". </p>\n\n<p>I can put a stop in the code and confirmed the variables are supplying the correct string, which equates to:</p>\n\n<p>\"\\Clarkbg01\\public\\PRODUCTION MEETING\\PROD MEETING 3-21-18.xlsm\"</p>\n\n<p>I can paste this into Windows Explorer and it will open right up with no issues. I can manually select the file from Explorer and it will open with no issues. I can paste the following line into the immediate window and it will hang...</p>\n\n<pre><code>workbooks.Open(\"\\\\Clarkbg01\\public\\PRODUCTION MEETING\\PROD MEETING 3-21-18.xlsm\")\n</code></pre>\n\n<p>This happens even if I open a blank sheet and execute that line from the immediate window. </p>\n\n<p>from my macro, stepping through the code goes without a hitch. I can verify all the variables are correct, but when it steps across workbooks.open, it hangs. </p>\n\n<p>I have other macros that open workbooks, do much more complicated routines, then close them with zero issues, but I'm really stuck on why this one is giving me so many problems. </p>\n\n<p>Any ideas?</p>\n\n<p>Here is the code: </p>\n\n<pre><code>'This will open the most recent meeting file and copy over the latest for jobs flagged with offsets\n\nDim Path As String\nPath = ThisWorkbook.Path\n'Debug.Print Path\n\nDim FileDate As String\nFileDate = ThisWorkbook.Sheets(\"MEETING\").Range(\"3:3\").Find(\"PREVIOUS NOTES\").Offset(-1, 0).Text\n'Debug.Print FileDate\n\nDim FileName As String\nFileName = \"PROD MEETING \" &amp; FileDate &amp; \".xlsm\"\nDebug.Print \"Looking up Offsets from: \" &amp; FileName\n\nDim TargetFile As String\nTargetFile = Path &amp; \"\\\" &amp; FileName\nDebug.Print TargetFile\n\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\n'The old way I was opening it...\n'Workbooks.Open FileName:=Path &amp; \"\\\" &amp; FileName, UpdateLinks:=False ', ReadOnly:=True\n\n'The most recent way to open\nDim wb As Workbook\nSet wb = Workbooks.Open(TargetFile, UpdateLinks:=False, ReadOnly:=True)\n\n    'Do Stuff\n\nwb.Close savechanges:=False\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nMsgBox \"Offsets should now reflect settings made in meeting on \" &amp; FileDate\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9260448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-H5XoFA9PaxU/AAAAAAAAAAI/AAAAAAAAAaI/vfxy9MDwa3A/photo.jpg?sz=128", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/9260448/saurabh-sharma"}, "edited": false, "score": 0, "creation_date": 1521649322, "post_id": 49411329, "comment_id": 85824839, "body": "but what if i have some more values in col &quot;A&quot; like 3,3,3,3 which has values may be, may be, may be , may be in corresponding column col&quot;B&quot; &amp; i want to put &quot;confirm &quot; in col&quot;C &quot; in front of 3 in col&quot; A&quot; along with the other 1, 2 values   @virtualdvid"}, {"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "reply_to_user": {"reputation": 27, "user_id": 9260448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-H5XoFA9PaxU/AAAAAAAAAAI/AAAAAAAAAaI/vfxy9MDwa3A/photo.jpg?sz=128", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/9260448/saurabh-sharma"}, "edited": false, "score": 0, "creation_date": 1521649706, "post_id": 49411329, "comment_id": 85825150, "body": "You have to nest a third condition in the formula <code>IF</code>. How many conditions do you have? Can you update your question to understand better your process?"}, {"owner": {"reputation": 27, "user_id": 9260448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-H5XoFA9PaxU/AAAAAAAAAAI/AAAAAAAAAaI/vfxy9MDwa3A/photo.jpg?sz=128", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/9260448/saurabh-sharma"}, "edited": false, "score": 0, "creation_date": 1521650138, "post_id": 49411329, "comment_id": 85825500, "body": "only three condition like that i told you just want to know whether it will work for third condition or not. thanks alot for your help @virtualdvid"}, {"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "reply_to_user": {"reputation": 27, "user_id": 9260448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-H5XoFA9PaxU/AAAAAAAAAAI/AAAAAAAAAaI/vfxy9MDwa3A/photo.jpg?sz=128", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/9260448/saurabh-sharma"}, "edited": false, "score": 0, "creation_date": 1521650769, "post_id": 49411329, "comment_id": 85825930, "body": "I updated my answer. It is an example. Let me know if this is your case. it is not clear to me if the third condition is a mix like you showed in the first case or it is just the word &quot;may be&quot;."}, {"owner": {"reputation": 27, "user_id": 9260448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-H5XoFA9PaxU/AAAAAAAAAAI/AAAAAAAAAaI/vfxy9MDwa3A/photo.jpg?sz=128", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/9260448/saurabh-sharma"}, "edited": false, "score": 0, "creation_date": 1521703231, "post_id": 49411329, "comment_id": 85846081, "body": "Hi @virtualdvid can you explain your formula because i am trying to implement this in a vba code if you can explain this it will give me some idea to write a vba code for that . thanks much"}, {"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "reply_to_user": {"reputation": 27, "user_id": 9260448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-H5XoFA9PaxU/AAAAAAAAAAI/AAAAAAAAAaI/vfxy9MDwa3A/photo.jpg?sz=128", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/9260448/saurabh-sharma"}, "edited": false, "score": 0, "creation_date": 1521733164, "post_id": 49411329, "comment_id": 85867343, "body": "I tried, English is not my native language so excuse me if I made a grammar mistake or if it is confusing. It was a good challenge for me :D. Feel free to ask me if you have another question."}], "tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": true, "score": 0, "last_activity_date": 1521732973, "last_edit_date": 1521732973, "creation_date": 1521648561, "answer_id": 49411329, "question_id": 49410807, "link": "https://stackoverflow.com/questions/49410807/marking-repeating-or-both-in-corresponding-cell-based-on-the-criteria/49411329#49411329", "title": "Marking repeating or both in corresponding cell based on the criteria", "body": "<p>If you have Excel 2016 you can use <code>COUNTIFS</code> nested in an <code>IF</code> like:</p>\n\n<p><code>Countifs</code> will count the values based on two criteria.</p>\n\n<pre><code>=IF(COUNTIF($A$1:$A$7,A1)=COUNTIFS($A$1:$A$7,A1,$B$1:$B$7,B1),\"Repeating\",\"Both\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LcnFg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LcnFg.png\" alt=\"\"></a></p>\n\n<p>You can nest a third condition like this:</p>\n\n<pre><code>=IF(B1=\"may be\",\"Confirm\",IF(COUNTIF($A$1:$A$9,A1)=COUNTIFS($A$1:$A$9,A1,$B$1:$B$9,B1),\"Repeating\",\"Both\"))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vp8aG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vp8aG.png\" alt=\"\"></a></p>\n\n<p><strong>Explanation:</strong></p>\n\n<blockquote>\n  <p>The formula consists of two conditional <code>IF</code>nested:</p>\n  \n  <p>The first <code>IF(B1=\"may be\",\"Confirm\"</code> evaluates if <code>B1 = \"may be\"</code> when is\n  <code>true</code> it returns <code>\"Confirm\"</code>.</p>\n  \n  <p>when is <code>false</code> start the second <code>IF</code> to compare one condition:</p>\n  \n  <p><code>COUNTIF($A$1:$A$9,A1)</code> - <code>Countsif</code> function counts values in a range\n  based on one condition. In this case, the criteria are each cell in\n  column <code>A</code> and count how many times are this value in the range\n  <code>$A$1:$A$9</code>.</p>\n  \n  <p><code>COUNTIFS($A$1:$A$9,A1,$B$1:$B$9,B1)</code> - <code>Countifs</code> function counts\n  values in a range based on multiple conditions. In this case, it is\n  counting based on two criteria for each value in <code>A</code> and <code>B</code>.</p>\n</blockquote>\n\n<p><strong>Evaluating second conditional:</strong></p>\n\n<blockquote>\n  <p><strong>For C1:</strong></p>\n  \n  <p><code>COUNTIF($A$1:$A$9,A1) = 3</code> 3 times the value (1) in the range\n  <code>$A$1:$A$9</code>.</p>\n  \n  <p><code>COUNTIFS($A$1:$A$9,A1,$B$1:$B$9,B1) = 3</code> 3 times the values (1) and (yes).</p>\n  \n  <p>So, if 3 = 3 then \"Repeating\".</p>\n  \n  <p><strong>For C4:</strong></p>\n  \n  <p><code>COUNTIF($A$1:$A$9,A4) = 4</code> 4 times the value (2) in the range\n  <code>$A$1:$A$9</code>.</p>\n  \n  <p><code>COUNTIFS($A$1:$A$9,A4,$B$1:$B$9,B4) = 2</code> 2 times the values (2) and (yes).</p>\n  \n  <p>So, if 4 = 2 is false it returns \"Both\".</p>\n</blockquote>\n"}], "owner": {"reputation": 27, "user_id": 9260448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-H5XoFA9PaxU/AAAAAAAAAAI/AAAAAAAAAaI/vfxy9MDwa3A/photo.jpg?sz=128", "display_name": "Saurabh Sharma", "link": "https://stackoverflow.com/users/9260448/saurabh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 49411329, "answer_count": 1, "score": -2, "last_activity_date": 1521732973, "creation_date": 1521647256, "last_edit_date": 1521650386, "question_id": 49410807, "link": "https://stackoverflow.com/questions/49410807/marking-repeating-or-both-in-corresponding-cell-based-on-the-criteria", "title": "Marking repeating or both in corresponding cell based on the criteria", "body": "<p>i have a sheet in excel which have two columns Col \"A\" &amp; Col \"B\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y77tT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y77tT.jpg\" alt=\"Image click here\"></a></p>\n\n<p>in col \"A\" i have values like 1,1,1  - 3 times &amp; 2,2,2,2 - 4 times</p>\n\n<p>and in col \"B\" i have  yes, yes, yes corresponding to column A value 1,1,1 &amp; </p>\n\n<p>yes, no ,yes no corresponding to column \"A\" value 2,2,2,2 as shown in the image.</p>\n\n<p>now i want to add some values in col \"C\" based on codition like</p>\n\n<p>if col \"A\" 1,1,1 all values are <strong>yes</strong> in col \"B\" then put SOME TEXT LIKE <strong>\"repeating\" in Col \"C\"</strong> in front of  every value of col\"A\"</p>\n\n<p>and if col \"A\" 2,2,2,2 all values are different like yes, no, yes , no in col \"B\" then put SOME TEXT LIKE <strong>\"both\" in Col \"C\"</strong> in front of  every value of col\"A\"</p>\n\n<p>for example see below image.-</p>\n\n<p><a href=\"https://i.stack.imgur.com/p7P9B.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p7P9B.jpg\" alt=\"image 2 click here\"></a> </p>\n\n<p><strong>-it will check all the similar values in col \"A\" First suppose it will take \"1\" first then it will check its corresponding value in col \"B\" and it will keep on checking all of the values of \"1\" in col\"B\" if all values are \"yes\" then it will simply put \"repeating\" in col\"C\" in front of every \"1\"</strong> </p>\n\n<p><strong>-but again it will check for all the values of \"2\" in col\"B\" if all values are \"yes\" then it will simply put \"repeating\" in col\"C\" in front of every \"2\" but as you can see all values are not same in front of \"2\" some are \"yes\" and some are \"no\" in col\"B\" so if all values of \"2\" are not same in col \"B\" then it will put \"both in col\"C\" in front of every \"2\"</strong></p>\n\n<p>i  want to know is there any formula for doing this or vba code is needed . please help me regarding this.</p>\n"}, {"tags": ["vba", "listboxitem"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9396407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2760aba1d5e51818b46bba2d6fcb9538?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/9396407/william"}, "edited": false, "score": 0, "creation_date": 1521652802, "post_id": 49411035, "comment_id": 85827274, "body": "Liiikkee a gllovee. Thanks!!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 25, "user_id": 9396407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2760aba1d5e51818b46bba2d6fcb9538?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/9396407/william"}, "edited": false, "score": 0, "creation_date": 1521653431, "post_id": 49411035, "comment_id": 85827666, "body": "you are welcome. BTW I wrote the code to account for a multiselect listbox also. should it be a single select listbox, it can be reduced"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1521671353, "last_edit_date": 1521671353, "creation_date": 1521647798, "answer_id": 49411035, "question_id": 49410535, "link": "https://stackoverflow.com/questions/49410535/item-transfer-between-listboxes-last-row-issue/49411035#49411035", "title": "Item transfer between Listboxes Last Row Issue", "body": "<p>you could use this</p>\n\n<pre><code>Private Sub Add_Click()\n    Dim x As Integer\n    Dim nSelecteds As Long\n\n    With Me\n        With .Unsorted\n            ReDim selecteds(1 To .ListCount) As Long\n            For x = .ListCount - 1 To 0 Step -1\n                If .Selected(x) Then\n                    nSelecteds = nSelecteds + 1\n                    selecteds(nSelecteds) = x\n                    Me.Sorted.AddItem .List(x)\n                End If\n            Next x\n            If nSelecteds &gt; 0 Then\n                For x = 1 To nSelecteds\n                    .RemoveItem selecteds(x)\n                Next x\n            End If\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9396407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2760aba1d5e51818b46bba2d6fcb9538?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/9396407/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 49411035, "answer_count": 1, "score": 1, "last_activity_date": 1521671353, "creation_date": 1521646532, "last_edit_date": 1521646547, "question_id": 49410535, "link": "https://stackoverflow.com/questions/49410535/item-transfer-between-listboxes-last-row-issue", "title": "Item transfer between Listboxes Last Row Issue", "body": "<p>I have a listbox with values that I want to move to another listbox so the user can sort the items. When the last item is selected, it only moves that item and erases the values above it. How can I have it function like the other items in the list?</p>\n\n<p>FYI, it is a single item selection, if that changes anything</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nPrivate Sub Add_Click()\n Dim x As Integer, count As Integer\n  count = Me.Unsorted.ListCount\n    For x = 0 To count\n        If Me.Unsorted.Selected(x) = True Then\n            Me.Sorted.AddItem Me.Unsorted.List(x)\n        End If\n    Next x\n\n    For x = count To 0 Step -1\n        If Me.Unsorted.Selected(x) = True Then\n            Me.Unsorted.RemoveItem x\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "optimization", "msgbox"], "comments": [{"owner": {"reputation": 493, "user_id": 6604777, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m94TKba8Sp0/AAAAAAAAAAI/AAAAAAAAAFE/1XaUDRENJZE/photo.jpg?sz=128", "display_name": "Zoilo Reyes", "link": "https://stackoverflow.com/users/6604777/zoilo-reyes"}, "edited": false, "score": 0, "creation_date": 1521647897, "post_id": 49410492, "comment_id": 85823755, "body": "Selection Change is triggered when you change the selected range or cell, Are you sure you don&#39;t want to use Change instead?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "edited": false, "score": 0, "creation_date": 1521647333, "post_id": 49410560, "comment_id": 85823300, "body": "Vityata, thank you for your help. I ran the code and I get this error message: &quot;Object variable or With block variable not set&quot;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "edited": false, "score": 0, "creation_date": 1521647543, "post_id": 49410560, "comment_id": 85823478, "body": "@RobertC - this is what happens when I write code and I do not test it. See the update."}, {"owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "edited": false, "score": 1, "creation_date": 1521647867, "post_id": 49410560, "comment_id": 85823738, "body": "Indeed it works, Vityata. Thank you for your help and for making me understand the lack of the synthax in the initial code."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1521647523, "last_edit_date": 1521647523, "creation_date": 1521646598, "answer_id": 49410560, "question_id": 49410492, "link": "https://stackoverflow.com/questions/49410492/msgbox-selectionchange-define-range/49410560#49410560", "title": "MsgBox SelectionChange define range", "body": "<p>Would this be ok:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim myValue As Variant\n    If (Not Intersect(Range(\"B22\"), Target) Is Nothing) And (Range(\"B22\") = \"Yes\") Then\n        myValue = InputBox(\"InsertInitialDetach\")\n        Range(\"C22\").Value = myValue\n    End If\nEnd Sub\n</code></pre>\n\n<p>It checks every time whether you are changing <code>Range(\"B22\")</code> and whether <code>Range(\"B22\")</code> \"Yes\".</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "edited": false, "score": 0, "creation_date": 1521648624, "post_id": 49411237, "comment_id": 85824328, "body": "Thank you, Zoilo Reyes. I have now understood my mistake."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1521649928, "post_id": 49411237, "comment_id": 85825344, "body": "If you select <code>B1:B2</code> and press delete, the code explodes in error <code>13</code>."}], "tags": [], "owner": {"reputation": 493, "user_id": 6604777, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m94TKba8Sp0/AAAAAAAAAAI/AAAAAAAAAFE/1XaUDRENJZE/photo.jpg?sz=128", "display_name": "Zoilo Reyes", "link": "https://stackoverflow.com/users/6604777/zoilo-reyes"}, "is_accepted": true, "score": 1, "last_activity_date": 1521652923, "last_edit_date": 1521652923, "creation_date": 1521648352, "answer_id": 49411237, "question_id": 49410492, "link": "https://stackoverflow.com/questions/49410492/msgbox-selectionchange-define-range/49411237#49411237", "title": "MsgBox SelectionChange define range", "body": "<p>You are using the selectionChange event which triggers after any change in the area selected, if want to trigger on value changes use the change event</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim myValue As Variant\n    On Error GoTo ErrorOccured\n    If Target.Address = \"$B$1\" And Target.Value = \"Yes\" Then\n        myValue = InputBox(\"Insert initialDetach\")\n        Range(\"B2\").Value = myValue\n    End If\n    ErrorOccured:\n    'Do when value is not valid\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6355232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/093873125a7bd14f69cef56691beda8e?s=128&d=identicon&r=PG&f=1", "display_name": "RobertC", "link": "https://stackoverflow.com/users/6355232/robertc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 49411237, "answer_count": 2, "score": 2, "last_activity_date": 1521652923, "creation_date": 1521646415, "last_edit_date": 1521646468, "question_id": 49410492, "link": "https://stackoverflow.com/questions/49410492/msgbox-selectionchange-define-range", "title": "MsgBox SelectionChange define range", "body": "<p>I have written the following code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim myValue As Variant\nIf Range(\"B22\") = \"Yes\" Then\n        myValue = InputBox(\"InsertInitialDetach\")\n        Range(\"C22\").Value = myValue\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code is meant to do the following thing: If I select Yes from a Yes/No drop down list, a message box appears and asks me to fill in a date. \nThe problem is that even after I fill the date, whatever I do afterwards, the box keeps on appearing and asking for the date. If I move two cells down, for example, the popup will continue to ask me for a date. \nPlease tell me what should I do to fix this error? </p>\n"}, {"tags": ["vba", "sendkeys", "printdocument"], "owner": {"reputation": 21, "user_id": 9528355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37e075a5ff7b8f4ede6609a384dcc8e3?s=128&d=identicon&r=PG&f=1", "display_name": "Shaiy10", "link": "https://stackoverflow.com/users/9528355/shaiy10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1521648967, "creation_date": 1521645882, "last_edit_date": 1521648967, "question_id": 49410301, "link": "https://stackoverflow.com/questions/49410301/print-to-pdf-from-excel-with-variable-filename-interpreted-with-sendkeys", "title": "Print to PDF from Excel with variable filename interpreted with Sendkeys", "body": "<p>I tried searching throughout but could not find a definite answer. Rather people have only suggested alternatives to similar questions but not a proper answer.</p>\n\n<p>My excel version is 2010.</p>\n\n<p>I need to print multiple pages from multiple excel files to a single PDF file, the code for which I have already prepared. The only issue I am facing is with the below section where I need to send the print to a saved PDF file. The code wont move forward unless I type the file name and click save.</p>\n\n<p>The relevant code is below</p>\n\n<pre><code>Sub printout()\n\nActiveSheet.printout ActivePrinter:=\"Adobe PDF on Ne00:\", From:=1, To:=1\n\nSendKeys (Variable &amp; \".pdf\")\n\nSendKeys \"{Enter}\"\n\nEnd Sub\n</code></pre>\n\n<p>what is happening here is the first line of the code opens up the \"Save PDF File As\" dialogue box. Thereafter I am unable to execute the Sendkeys method to enter the file name and click save/enter. <strong>Which is what I want to achieve through the VB macro code and the same is my question here?</strong></p>\n\n<p>I also tried the below</p>\n\n<pre><code>ActiveSheet.printout ActivePrinter:=\"Adobe PDF Son Ne00:\", From:=1, To:=1, PrintToFile:=True, PrToFileName:=\"Path\\PDFs\\1.pdf\"\n</code></pre>\n\n<p>but this gives me a Post Script error</p>\n\n<p><strong>\"When you create a PostScript file you must rely on system fonts and use document fonts. Please go to the printer properties, Adobe PDF settings page and turn OFF the option Rely on system fonts only; do not use document fonts.\"</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ozo35.jpg\" rel=\"nofollow noreferrer\">Error Screenshot</a></p>\n\n<p>if I change the PDF settings as per the error message the file does save but it saves a corrupt file which is blank when I open the saved PDF file.</p>\n\n<p><strong>I also tried the exporttoPDF method but it gives me other different problems one of them being with respect to paper size which is a different question altogether and would not include it here. I tried various techniques to solve the paper size issue but does not solve my problem. just including the reference so that no one suggests the exporttoPDF alternative.</strong></p>\n\n<p>I need to resolve the issue with the .printout method only moreover now it has become an understanding issue wherein I have to understand how to resolve it.</p>\n\n<p>In the save as dialogue box when my above code runs, If I enter the file name manually and click save then everything works perfectly. It is only the sendkeys part I am unable to figure out to automate the entering of filename and clicking save. Need the solution only using the <strong>.PRINTOUT</strong></p>\n\n<p>please let me know for any additional details.</p>\n"}, {"tags": ["vba", "excel", "excel-addins"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1521645941, "post_id": 49410273, "comment_id": 85822167, "body": "Try <code>Me.Repaint</code> ?"}, {"owner": {"reputation": 561, "user_id": 2206455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0245bd691b817b691d20fcd73fb7239?s=128&d=identicon&r=PG", "display_name": "plocks", "link": "https://stackoverflow.com/users/2206455/plocks"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1521645995, "post_id": 49410273, "comment_id": 85822211, "body": "No, where would I need to put that?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1521646024, "post_id": 49410273, "comment_id": 85822231, "body": "Put it after the <code>.Visible = False</code>"}, {"owner": {"reputation": 561, "user_id": 2206455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0245bd691b817b691d20fcd73fb7239?s=128&d=identicon&r=PG", "display_name": "plocks", "link": "https://stackoverflow.com/users/2206455/plocks"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1521646175, "post_id": 49410273, "comment_id": 85822360, "body": "I&#39;ve clarified the question. Both functions never execute."}], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 2206455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0245bd691b817b691d20fcd73fb7239?s=128&d=identicon&r=PG", "display_name": "plocks", "link": "https://stackoverflow.com/users/2206455/plocks"}, "edited": false, "score": 0, "creation_date": 1521646110, "post_id": 49410359, "comment_id": 85822302, "body": "If I double click on the form in design mode it jumps to the forms activate function ..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 561, "user_id": 2206455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0245bd691b817b691d20fcd73fb7239?s=128&d=identicon&r=PG", "display_name": "plocks", "link": "https://stackoverflow.com/users/2206455/plocks"}, "edited": false, "score": 1, "creation_date": 1521646983, "post_id": 49410359, "comment_id": 85822993, "body": "@plocks use the dropdowns at the top of the code pane to add handlers manually (without using the designer). The left-hand dropdown contains the available event providers / interfaces, the right-hand dropdown contains the available events / members for the selected event provider/interface."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 4, "last_activity_date": 1521646020, "creation_date": 1521646020, "answer_id": 49410359, "question_id": 49410273, "link": "https://stackoverflow.com/questions/49410273/click-event-handler-on-userform/49410359#49410359", "title": "Click event handler on Userform", "body": "<p>It should be like this:</p>\n\n<pre><code>Sub UserForm_Click()    \n     If ListBoxSearch.Visible = True Then    \n        ListBoxSearch.Visible = False    \n     End If    \nEnd Sub\n</code></pre>\n\n<p>You dont use the actual name of the form to access its events. If you double click on the form in design mode, it will create the proper event for you.</p>\n"}], "owner": {"reputation": 561, "user_id": 2206455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0245bd691b817b691d20fcd73fb7239?s=128&d=identicon&r=PG", "display_name": "plocks", "link": "https://stackoverflow.com/users/2206455/plocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 1, "accepted_answer_id": 49410359, "answer_count": 1, "score": 0, "last_activity_date": 1521646525, "creation_date": 1521645799, "last_edit_date": 1521646525, "question_id": 49410273, "link": "https://stackoverflow.com/questions/49410273/click-event-handler-on-userform", "title": "Click event handler on Userform", "body": "<p>I want to hide a ListBox Object within an Excel UserForm when a click is registered outside of the ListBox object. So I figured I use a Click or MouseUp event on the UserForm, but both do not seem to work. Is there any way I can achive this functionality?</p>\n\n<p>What I have tried so far:</p>\n\n<pre><code>Sub TestUserForm_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)    \n     If ListBoxSearch.Visible = True Then    \n        ListBoxSearch.Visible = False    \n     End If    \nEnd Sub\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>Sub TestUserForm_Click()    \n     If ListBoxSearch.Visible = True Then    \n        ListBoxSearch.Visible = False    \n     End If    \nEnd Sub\n</code></pre>\n\n<p>Both events do not fire.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1521644030, "post_id": 49409499, "comment_id": 85820598, "body": "Look into split.  split on the <code>_</code> and take the result of position <code>1</code>:"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 3, "creation_date": 1521644053, "post_id": 49409499, "comment_id": 85820616, "body": "Debug.Print Split(&quot;I_HEAD_FOR&quot;, &quot;_&quot;)(1)"}, {"owner": {"reputation": 71, "user_id": 3782064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbhHg.png?s=128&g=1", "display_name": "CodeNinja", "link": "https://stackoverflow.com/users/3782064/codeninja"}, "edited": false, "score": 0, "creation_date": 1521644457, "post_id": 49409499, "comment_id": 85820959, "body": "Thank you storex!! It works perfectly well."}, {"owner": {"reputation": 71, "user_id": 3782064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbhHg.png?s=128&g=1", "display_name": "CodeNinja", "link": "https://stackoverflow.com/users/3782064/codeninja"}, "edited": false, "score": 0, "creation_date": 1521644948, "post_id": 49409499, "comment_id": 85821318, "body": "Why my question gets voted down, Is there any issue with my Question."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1521646270, "post_id": 49409499, "comment_id": 85822442, "body": "Yes, because you did not show any effort on your own and you just wrote &quot; I need code snippet &quot; but this is not a code writing service"}, {"owner": {"reputation": 71, "user_id": 3782064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbhHg.png?s=128&g=1", "display_name": "CodeNinja", "link": "https://stackoverflow.com/users/3782064/codeninja"}, "edited": false, "score": 1, "creation_date": 1521647149, "post_id": 49409499, "comment_id": 85823122, "body": "May be I have to describe what I have tried and tested to do better.@Storex  Thank you for quick help"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3782064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbhHg.png?s=128&g=1", "display_name": "CodeNinja", "link": "https://stackoverflow.com/users/3782064/codeninja"}, "edited": false, "score": 1, "creation_date": 1521644346, "post_id": 49409663, "comment_id": 85820871, "body": "Thank you Gary&#39;s Student !!! You save my day :-)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 71, "user_id": 3782064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbhHg.png?s=128&g=1", "display_name": "CodeNinja", "link": "https://stackoverflow.com/users/3782064/codeninja"}, "edited": false, "score": 1, "creation_date": 1521644511, "post_id": 49409663, "comment_id": 85821005, "body": "@CodeNinja  You ae quite welcome."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1521644240, "creation_date": 1521644240, "answer_id": 49409663, "question_id": 49409499, "link": "https://stackoverflow.com/questions/49409499/need-to-extract-substring-from-string-surrounded-by-special-character-in-vba/49409663#49409663", "title": "Need to extract substring from string surrounded by special character in VBA", "body": "<p>How about:</p>\n\n<pre><code>Public Function UnderScore(s As String) As String\n    UnderScore = Split(s, \"_\")(1)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1521647067, "post_id": 49410275, "comment_id": 85823048, "body": "Or <code>TRIM(MID(SUBSTITUTE(A1,&quot;_&quot;,REPT(&quot; &quot;,10000)),10000,10000))</code>, which is slightly easier to turn into a general form for the <code>n</code>th item in the deliminated string (The second <code>10000</code> becomes <code>(n-1)*10000</code>)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521647420, "post_id": 49410275, "comment_id": 85823382, "body": "@Chronocidal - impressive - it works and it is smaller :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1521645806, "creation_date": 1521645806, "answer_id": 49410275, "question_id": 49409499, "link": "https://stackoverflow.com/questions/49409499/need-to-extract-substring-from-string-surrounded-by-special-character-in-vba/49410275#49410275", "title": "Need to extract substring from string surrounded by special character in VBA", "body": "<p>If you want to use Excel, without VBA, this is the way you should think to make the formula:</p>\n\n<ul>\n<li>On which position is the first <code>_</code> sign?</li>\n<li>Knowing the first position of the first sign, can I find the second <code>_</code> sign?</li>\n<li>Now, knowing the first and the second position, is there a way to extract only the string, which is between the two positions? </li>\n<li>How can I unite the whole party into one formula, without getting crazy?</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/v3XMc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v3XMc.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Formulas <code>SEARCH</code> and <code>MID</code> together are pretty powerful. The <code>SEARCH</code> formula has optional value, saying where should you start search (see the second formula). Thus, we add <code>+1</code> to the first found value. In the second formula, the <code>-1</code> is added, because we do not want the position of the <code>_</code>, but the position before.</p>\n\n<p>The formulas in text:</p>\n\n<pre><code>=SEARCH(\"_\",A1,1)\n=SEARCH(\"_\",A1,SEARCH(\"_\",A1,1)+1)-1\n=MID(A1,B1+1,B2-B1)\n=MID(A1,SEARCH(\"_\",A1,1)+1,SEARCH(\"_\",A1,SEARCH(\"_\",A1,1)+1)-1-SEARCH(\"_\",A1,1))\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 3782064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QbhHg.png?s=128&g=1", "display_name": "CodeNinja", "link": "https://stackoverflow.com/users/3782064/codeninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 832, "favorite_count": 0, "closed_date": 1521650266, "answer_count": 2, "score": -3, "last_activity_date": 1521646788, "creation_date": 1521643811, "last_edit_date": 1592644375, "question_id": 49409499, "link": "https://stackoverflow.com/questions/49409499/need-to-extract-substring-from-string-surrounded-by-special-character-in-vba", "closed_reason": "Needs more focus", "title": "Need to extract substring from string surrounded by special character in VBA", "body": "<p>I am new to VBA,I have a string <strong>I_HEAD_FOR</strong>\nI wanted to extract the substring which is started and ended by special character '_'(Underscore) in VBA.\nI need code snippet which can do above task,Could you please help me with it\nHere in this case The code should extract substring <strong>HEAD</strong></p>\n<hr />\n<p>This the idea is from:\n<strong>I_HEAD_FOR</strong></p>\n<p>to get as a result:   <strong>HEAD</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1064, "user_id": 4722577, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/df632265f05cfef80f4d3da89de8cd7b?s=128&d=identicon&r=PG&f=1", "display_name": "CAM_344", "link": "https://stackoverflow.com/users/4722577/cam-344"}, "edited": false, "score": 0, "creation_date": 1521643897, "post_id": 49409354, "comment_id": 85820499, "body": "Do you have some sample code for us to look at that you attempted?  You could also look at this link for some ideas <a href=\"https://stackoverflow.com/questions/43468467/copy-sheet-content-to-another-sheet/43469300#43469300\" title=\"copy sheet content to another sheet\">stackoverflow.com/questions/43468467/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1521644288, "post_id": 49409580, "comment_id": 85820814, "body": "<code>lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1521644383, "post_id": 49409580, "comment_id": 85820895, "body": "You&#39;re right (y) .."}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521645456, "post_id": 49409580, "comment_id": 85821736, "body": "Thanks. But it pasted the values but I would like to insert entire rows so that everything below in sheet2 get push down and that way I don&#39;t loose formulas."}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1521645759, "post_id": 49409580, "comment_id": 85822008, "body": "I&#39;m not sure if I understand you .. do you mean the sheet2 is not empty ? and you want to add the values of column A in sheet1 to column A in sheet2 above the existing values ?"}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521645966, "post_id": 49409580, "comment_id": 85822189, "body": "ok, so let me try to explain... I have a list of orders that increases every month so all I want to do is add the new ones but that is a section of sheet2 so I will like to add rows so I can push the bottom down instead of copying over."}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521646025, "post_id": 49409580, "comment_id": 85822233, "body": "Can I send you a file so you can see what I mean?"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1521646276, "post_id": 49409580, "comment_id": 85822448, "body": "I edited my answer, check it and give me a feedback .."}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521646824, "post_id": 49409580, "comment_id": 85822860, "body": "This is close. is there a way we can have it to look at the latest order on sheet 2 and olnly add the new ones? for example, I have orders 1 thru 20 and now this month I have 1 thru 25, can I have it to just add 5 rows after the last one (20) and paste the new 5 values? Usually column A is only order numbers nothing else so it can look at the latest entry on sheet2."}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1521647398, "post_id": 49409580, "comment_id": 85823359, "body": "So you need to add your entires at the end of sheet2 not at the top .. and you know your latest entry based on what ? the lastrow in sheet2 ? .. I need to see an example of what you want .."}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521649810, "post_id": 49409580, "comment_id": 85825248, "body": "can I send you and email with a file?"}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521653161, "post_id": 49409580, "comment_id": 85827481, "body": "That is correct. I need to add entries at the end of sheet2, I would like it to compare to what I already have in sheet2 and add if there is new ones. sheet1 will always have the same or more than sheet2."}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521722114, "post_id": 49409580, "comment_id": 85858834, "body": "Hi, are you trying something? @LatifaShi ?"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1521741168, "post_id": 49409580, "comment_id": 85872620, "body": "I am sorry I wasn&#39;t home .. check again my edited answer .. Hope it is what you are looking for this time .."}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521741627, "post_id": 49409580, "comment_id": 85872893, "body": "it brings the contents good but it doesnot insert rows for those new ones...it just past them below the last one"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1521741958, "post_id": 49409580, "comment_id": 85873073, "body": "check my answer again I added a line : ws2.Rows(lastRow2 + 1).EntireRow.Insert"}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521742953, "post_id": 49409580, "comment_id": 85873648, "body": "That&#39;s Perfect!!! Youre the best!!!!!! OMG you are going to save me hours of work!!"}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521743026, "post_id": 49409580, "comment_id": 85873693, "body": "Sorry, I didn&#39;t say Thank You...too excited!"}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521743126, "post_id": 49409580, "comment_id": 85873752, "body": "I have another little request...can I bring the formulas from above to the new lines? starting in column B of sheet2?"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1521744048, "post_id": 49409580, "comment_id": 85874232, "body": "You&#39;re welcome :). By the way, you could mark The answer as accepted for others by clicking the check mark next to the answer. For your other request  i&#39;m sorry but I have never worked with formulas in excel so I&#39;m not sure about How to manipulate them with VBA :p .."}, {"owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "edited": false, "score": 0, "creation_date": 1521744171, "post_id": 49409580, "comment_id": 85874307, "body": "No problem. Thanks!!"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "edited": false, "score": 0, "creation_date": 1521744823, "post_id": 49409580, "comment_id": 85874658, "body": "You&#39;re welcome ^^ .."}], "tags": [], "owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "is_accepted": true, "score": 0, "last_activity_date": 1521741480, "last_edit_date": 1521741480, "creation_date": 1521644032, "answer_id": 49409580, "question_id": 49409354, "link": "https://stackoverflow.com/questions/49409354/count-insert-row-paste-in-other-tab/49409580#49409580", "title": "Count, insert row, paste in other tab", "body": "<p>try the code below :</p>\n\n<pre><code>Sub test()\n\n            Dim ws As Worksheet\n            Dim ws2 As Worksheet\n\n            Set ws = ThisWorkbook.Sheets(\"sheet1\")\n            Set ws2 = ThisWorkbook.Sheets(\"sheet2\")\n\n            lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n            lastRow2 = ws2.Cells(ws2.Rows.Count, 1).End(xlUp).Row\n\n            i = 1\n            Do While ws.Cells(i, 1).Value = ws2.Cells(i, 1).Value\n                 i = i + 1\n            Loop\n\n            For j = i To lastRow\n                lastRow2 = ws2.Cells(ws2.Rows.Count, 1).End(xlUp).Row\n                ws2.Rows(lastRow2 + 1).EntireRow.Insert\n                ws2.Range(\"A\" &amp; lastRow2 + 1).Value = ws.Range(\"A\" &amp; j).Value\n            Next j\n\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9529328, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nelson Veras", "link": "https://stackoverflow.com/users/9529328/nelson-veras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "closed_date": 1521648484, "accepted_answer_id": 49409580, "answer_count": 1, "score": -5, "last_activity_date": 1521741480, "creation_date": 1521643456, "last_edit_date": 1521739210, "question_id": 49409354, "link": "https://stackoverflow.com/questions/49409354/count-insert-row-paste-in-other-tab", "closed_reason": "Needs more focus", "title": "Count, insert row, paste in other tab", "body": "<p>I am trying to create a code that looks at column A in sheet1, then insert new lines in sheet2. Then paste the contents of column A (sheet1) into column A on sheet2. See attached pictures:\nSheet1 - total list\nSheet2 - existing list, need to add new lines from sheet1 and shift down the rest of contents.\nSheet3 - Result.</p>\n\n<p>I do this manually every time but I am trying to make it automatic so I can save some time. I will assign a button to this.</p>\n\n<p>Thanks in advance.\nNelson </p>\n\n<p><a href=\"https://i.stack.imgur.com/5NwIf.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/T9ZOP.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/VX3QK.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["ms-access", "sharepoint", "vba", "multi-factor-authentication"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1521661772, "post_id": 49409130, "comment_id": 85832393, "body": "Is this the actual code you have attempted to accomplish your requirement? What happens - error message, wrong results, nothing?"}, {"owner": {"reputation": 100, "user_id": 3919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae394ac1e62c9c3b9e469c23224f284?s=128&d=identicon&r=PG&f=1", "display_name": "Erin B", "link": "https://stackoverflow.com/users/3919757/erin-b"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1521726740, "post_id": 49409130, "comment_id": 85862471, "body": "If you&#39;re on the VPN, the tdf.RefreshLink line pops up an authentication window, asking for username/password. If you&#39;re not on the VPN, nothing pops up, and the connection is not made to sharepoint.  I&#39;d like to know how to pass the authentication parameters to Sharepoint to enable those off VPN have access."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1521742787, "post_id": 49409130, "comment_id": 85873550, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22149169/how-to-pass-authentication-credentials-in-vba\">How to pass authentication credentials in VBA</a>"}], "owner": {"reputation": 100, "user_id": 3919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae394ac1e62c9c3b9e469c23224f284?s=128&d=identicon&r=PG&f=1", "display_name": "Erin B", "link": "https://stackoverflow.com/users/3919757/erin-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 542, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521930473, "creation_date": 1521642886, "last_edit_date": 1521930473, "question_id": 49409130, "link": "https://stackoverflow.com/questions/49409130/multi-factor-authentication-prompts", "title": "Multi-factor Authentication prompts", "body": "<p>I have an Access (2010, 2013, 2016) application sent to users throughout the world. This application downloads data from a Sharepoint-based ticketing system for use offline.</p>\n\n<p>The Sharepoint system we use recently implemented a requirement for multi-factor authentication in order to connect. However, the MS Access prompt for credentials doesn't include the MFA argument. How can we pass MFA credentials from Microsoft Access to Sharepoint?</p>\n\n<p>Users on the company VPN can connect just fine. In order to get on the VPN, one must enter their MFA credentials, so Sharepoint uses that. However, if users aren't on the VPN (some contractors do not have access), they aren't prompted for the MFA token and cannnot connect. However, if they go directly to the Sharepoint URL, they can login via MFA just fine - but the access application doesn't recognize that MFA connection/credientials even if the Sharepoint site is open.</p>\n\n<p>Users do not have admin rights to their machines and cannot download third-part applications to circumvent this issue. The Access application is using DAO to connect to the Sharepoint server in VBA.</p>\n\n<p>We must refresh the link to the sharepoint list before downloading, otherwise those outside the VPN have their connection timeout. Code is below to illustrate:</p>\n\n<pre><code>Dim tdf As DAO.TableDef\nDim userName As String, myPassword As String\nDim thisDB As DAO.Database\nDoCmd.SetWarnings False\nDoCmd.Hourglass True\n\nSet thisDB = CurrentDb\n RemoveInvalidRelationships \"Linked_FSE_List_Field_Service_Request\"\n\n For Each tdf In CurrentDb.TableDefs\n\nIf Left(tdf.Connect, 3) = \"ACE\" Then\n        tdf.RefreshLink\n    End If\nNext\n</code></pre>\n\n<p>For clarity purposes: this question is about how to pass authentication parameters to Sharepoint.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": false, "score": 3, "last_activity_date": 1521642942, "creation_date": 1521642942, "answer_id": 49409157, "question_id": 49409090, "link": "https://stackoverflow.com/questions/49409090/excel-create-a-generic-space-delmited-string/49409157#49409157", "title": "Excel, create a generic space delmited string", "body": "<p>Use the formula : <code>=REPT(\"NA \",A1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1521643562, "last_edit_date": 1521643562, "creation_date": 1521643000, "answer_id": 49409182, "question_id": 49409090, "link": "https://stackoverflow.com/questions/49409090/excel-create-a-generic-space-delmited-string/49409182#49409182", "title": "Excel, create a generic space delmited string", "body": "<p>Use the formula</p>\n\n<pre><code>=TRIM(REPT(\"NA \",A1))\n</code></pre>\n\n<p>to have spaces in between but not have a space in the end.</p>\n"}], "owner": {"reputation": 401, "user_id": 9447717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb09b69d0f17fba2ea789d698574414f?s=128&d=identicon&r=PG", "display_name": "user9447717", "link": "https://stackoverflow.com/users/9447717/user9447717"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1521643562, "creation_date": 1521642780, "last_edit_date": 1531161705, "question_id": 49409090, "link": "https://stackoverflow.com/questions/49409090/excel-create-a-generic-space-delmited-string", "title": "Excel, create a generic space delmited string", "body": "<p>I have a column of data in excel containing a number.</p>\n\n<p>What I need is a formula that can add the word NA ( repeated with a space) for whatever the number value is, for example:</p>\n\n<pre><code>A1       A2  \n3        NA NA NA  \n1        NA  \n8        NA NA NA NA NA NA NA NA  \n</code></pre>\n\n<p>Is this possible?</p>\n"}, {"tags": ["excel", "type-conversion", "vba"], "comments": [{"owner": {"reputation": 637, "user_id": 6434216, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4e370f952f6548bba0f27e0b1f8f825?s=128&d=identicon&r=PG&f=1", "display_name": "Flocke", "link": "https://stackoverflow.com/users/6434216/flocke"}, "edited": false, "score": 0, "creation_date": 1521643685, "post_id": 49409084, "comment_id": 85820321, "body": "I suggest to split the OVERFLOW-LINE into at least 3 lines of code. Thus, you can see were the error occures."}], "answers": [{"tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": true, "score": 0, "last_activity_date": 1521652128, "creation_date": 1521652128, "answer_id": 49412582, "question_id": 49409084, "link": "https://stackoverflow.com/questions/49409084/convert-data-as-string-into-a-number/49412582#49412582", "title": "Convert data as string into a number", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/VBA/Language-Reference-VBA/articles/integer-data-type\" rel=\"nofollow noreferrer\">Here</a> you will see value ranges for Integer.</p>\n\n<p>Today's date casted as int is 43180 which exeeds integer.</p>\n\n<p>Use <code>Long</code> ( <code>CLng()</code> ) instead</p>\n"}], "owner": {"reputation": 25, "user_id": 8685655, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/abe9de9c393bfc2c2c46f7966174e701?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142", "link": "https://stackoverflow.com/users/8685655/pawe%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 49412582, "answer_count": 1, "score": 0, "last_activity_date": 1521652128, "creation_date": 1521642764, "last_edit_date": 1531164843, "question_id": 49409084, "link": "https://stackoverflow.com/questions/49409084/convert-data-as-string-into-a-number", "title": "Convert data as string into a number", "body": "<p>I have a trouble with converting a date as String into Long. Generally speaking, I don't know how to convert dates into numbers using VBA. There is an overflow in the line marked with 'OVERFLOW. Why?\nPS: The first value of the array \"daty\" is \"2018-03-26\".</p>\n\n<pre><code>Sub Sortuj_daty()\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ActiveWorkbook\nSet ws = wb.Worksheets(1)\n\nDim i As Long\nDim daty(1 To 10) As String\nDim daty_int(1 To 10) As Long\nDim daty_uporzadkowane(1 To 10) As String\n\n    For i = 1 To 10\n        daty(i) = ws.Cells(i, 1).Value\n        daty_int(i) = CInt(CDate(Format(daty(i), \"yyyy-mm-dd\"))) 'OVERFLOW\n    Next i\n\n    For j = 1 To 10\n        daty_uporzadkowane(j) = Application.WorksheetFunction.Small(daty_int, j)\n        ws.Cells(j, 2) = daty_uporzadkowane(j)\n    Next j\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521642744, "post_id": 49408953, "comment_id": 85819536, "body": "can you provide some example of <code>Fixture</code> where it goes wrong?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1521642933, "post_id": 49408953, "comment_id": 85819697, "body": "Ive just tried it with <code>can- 1 4 pin</code> and it worked ok."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521643186, "post_id": 49408953, "comment_id": 85819907, "body": "Remember that <code>InStr</code> is case-sensitive.  You may have more luck with <code>InStr(LCase(Fixture), LCase(T(i)))</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1521643407, "post_id": 49408953, "comment_id": 85820076, "body": "HOw is a value getting assigned to Fixture? It sounds as if it&#39;s always something from T and never gets to evaluating from C..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1521643651, "post_id": 49408953, "comment_id": 85820292, "body": "@Chronocidal remember that <code>InStr</code> has a <code>Compare</code> optional parameter that defaults to <code>vbBinaryCompare</code>. Instead of <code>LCase</code>-ing the two strings, why not just provide a <code>vbTextCompare</code> parameter and make 1 function call instead of 3?"}, {"owner": {"reputation": 297, "user_id": 8238422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/269d43e984a11277f9b8777410aa1f3c?s=128&d=identicon&r=PG&f=1", "display_name": "Used", "link": "https://stackoverflow.com/users/8238422/used"}, "edited": false, "score": 0, "creation_date": 1521643970, "post_id": 49408953, "comment_id": 85820555, "body": "I&#39;ve found my mistake. The mistake wasn&#39;t show in the code.   my different array were not the same lenght this caused the C(4) to containt no data while T(4) did.  This made the InStr find a &quot;&quot; in every situation causing my problem.  Thank for your help."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521643990, "post_id": 49408953, "comment_id": 85820576, "body": "@MathieuGuindon Or even just put <code>Option Compare Text</code> at the top of the Module to change all the comparisons at once"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1521644034, "post_id": 49408953, "comment_id": 85820602, "body": "@Used - You should put that as an answer then accept it so others don&#39;t try to fix your code without reading all the comments."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521644281, "post_id": 49408953, "comment_id": 85820811, "body": "@Used - You can use a different loop for each array, and the <code>UBound</code> and <code>LBound</code> functions to skip that issue: <code>For i=LBound(T) to UBound(T)</code> will automatically loop through all elements of <code>T</code> whatever size you have made it"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521645374, "post_id": 49408953, "comment_id": 85821665, "body": "@Chronocidal yeah.. except <code>Option Compare</code> and <code>Option Base</code> have that tendency of being utterly ignored by certain APIs... IMO it&#39;s best to stick to <code>Option Explicit</code> (and <code>Option Private Module</code> where appropriate), and be explicit about string comparisons (and array base indices) ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1521643899, "creation_date": 1521643899, "answer_id": 49409530, "question_id": 49408953, "link": "https://stackoverflow.com/questions/49408953/if-string-contain-a-certain-substring/49409530#49409530", "title": "If String contain a certain substring", "body": "<p>Not an answer, but rejigged your code in testing and added a bit, but the essence is still yours, and works fine.</p>\n\n<pre><code>Function ERP_Lamp(strFixture As String) As String\n\nDim t(3) As String\nDim c(3)   As String\n\nt(1) = \"1x4 1l\"\nt(2) = \"1x4 1l basket\"\nt(3) = \"1x4 2l\"\n\n'CFL\nc(1) = \"can- 1 4 pin\"\nc(2) = \"can- 2 2 pin\"\nc(3) = \"can- 2 4 pin\"\n\nstrFixture = LCase(strFixture)\n\nFor i = 1 To 3\n\n    If InStr(strFixture, LCase(t(i))) &gt;= 1 Then\n\n        ERP_Lamp = \"Linear Fluorescent\"\n        Exit For\n\n    ElseIf InStr(strFixture, LCase(c(i))) &gt;= 1 Then\n\n        ERP_Lamp = \"Compact Fluorescent\"\n        Exit For\n\n    End If\n\nNext i\n\nErase t\nErase c\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 8238422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/269d43e984a11277f9b8777410aa1f3c?s=128&d=identicon&r=PG&f=1", "display_name": "Used", "link": "https://stackoverflow.com/users/8238422/used"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5822, "favorite_count": 0, "accepted_answer_id": 49409530, "answer_count": 1, "score": 0, "last_activity_date": 1521643899, "creation_date": 1521642430, "last_edit_date": 1531164843, "question_id": 49408953, "link": "https://stackoverflow.com/questions/49408953/if-string-contain-a-certain-substring", "title": "If String contain a certain substring", "body": "<p>In my function, I'm trying to check if a certain string contains a certain substring. For very short string it works perfectly but when I have a long string with space it doesn't seem to work anymore.</p>\n\n<pre><code>'Linear Fluorescent\nT(1) = \"1x4 1l\"\nT(2) = \"1x4 1l basket\"\nT(3) = \"1x4 2l\"\n\n'CFL\nC(1) = \"can- 1 4 pin\"\nC(2) = \"can- 2 2 pin\"\nC(3) = \"can- 2 4 pin\"\n\nFor i = 1 To 3\nIf InStr(Fixture, T(i)) &gt;= 1 Then\n\n    ERP_Lamp = \"Linear Fluorescent\"\n\nElseIf InStr(Fixture, C(i)) &gt;= 1 Then\n\n    ERP_Lamp = \"Compact Fluorescent\"\n\nEnd If\nNext i\n</code></pre>\n\n<p>The result I'm getting is alway : \"Linear Fluorescent\" or 0.\nI seem to be unable to get \"Compact Fluorescent\" even if the Fixture is \"can- 1 4 pin\" it will still say Linear Fluorescent.</p>\n\n<p>So the questions is : How can I check is my string is contain in my other string \"Fixture\" ?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "internet-explorer", "getelementbyid", "getelementsbytagname"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 2887755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1505530026/picture?type=large", "display_name": "Filip Ondo", "link": "https://stackoverflow.com/users/2887755/filip-ondo"}, "edited": false, "score": 0, "creation_date": 1521643034, "post_id": 49409067, "comment_id": 85819790, "body": "Hi, so I would loop through &lt;a&gt; until element is href? or similar?"}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 155, "user_id": 2887755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1505530026/picture?type=large", "display_name": "Filip Ondo", "link": "https://stackoverflow.com/users/2887755/filip-ondo"}, "edited": false, "score": 0, "creation_date": 1521643498, "post_id": 49409067, "comment_id": 85820145, "body": "You can also use a <code>For each</code> loop through that array, maybe until finding the given <code>.Title</code> property or the href, or you can just start counting all <code>&lt;a&gt;</code> tags to find the index of the one you need."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 155, "user_id": 2887755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1505530026/picture?type=large", "display_name": "Filip Ondo", "link": "https://stackoverflow.com/users/2887755/filip-ondo"}, "edited": false, "score": 0, "creation_date": 1521643498, "post_id": 49409067, "comment_id": 85820146, "body": "@FilipOndo there&#39;s an <code>&lt;a&gt;</code> tag for every single hyperlink in <code>IE.document</code> - the array return by <code>getElementsByTagName</code> contains every single one of them. You need to look at your page and see what&#39;s making <i>that link</i> the link you want to be clicking on."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521643567, "post_id": 49409067, "comment_id": 85820219, "body": "@NicholasKemp <code>For Each</code> should be used for iterating collections. Iterating an array performs best with a <code>For</code> loop. See <a href=\"http://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">VBA For vs For Each</a>."}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521643743, "post_id": 49409067, "comment_id": 85820373, "body": "@MathieuGuindon thanks for the info, it&#39;s always good to learn something new."}, {"owner": {"reputation": 155, "user_id": 2887755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1505530026/picture?type=large", "display_name": "Filip Ondo", "link": "https://stackoverflow.com/users/2887755/filip-ondo"}, "edited": false, "score": 0, "creation_date": 1521645684, "post_id": 49409067, "comment_id": 85821945, "body": "thanks for inputs can I use this? <code>Dim elements As Object, element As Object, count As Long  count = 0 Set elements = IE.document.getElementsByTagName(&quot;a&quot;)(i)  For Each element In elements     If element.Title = &quot;View document&quot; Then         count = count + 1         If count = 4 Then         element.Click         End If     End If Next</code>"}, {"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1521646428, "post_id": 49409067, "comment_id": 85822550, "body": "That should work, just delete <code>(i)</code> from <code>getElementsByTagName</code> since you want to use the whole array in that case (Also, when you want a single value from the array you dont use <code>(i)</code> but an actual number)."}], "tags": [], "owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "is_accepted": true, "score": 2, "last_activity_date": 1521642715, "last_edit_date": 1592644375, "creation_date": 1521642715, "answer_id": 49409067, "question_id": 49408920, "link": "https://stackoverflow.com/questions/49408920/click-on-picture-or-link-behind-it/49409067#49409067", "title": "Click on picture or link behind it", "body": "<blockquote>\n<p>I also tried</p>\n<p><code>IE.document.getElementByTagName(&quot;a&quot;).FireEvent (&quot;onclick&quot;)</code></p>\n</blockquote>\n<p>This should work for you, but you are missing something. You need to specify which <code>&lt;a&gt;</code> tag you are looking for, so <code>.getElementsByTagName(&quot;a&quot;)</code> turns into <code>.getElementsByTagName(&quot;a&quot;)(i)</code>, where <code>i</code> is the index of the tag you are looking for (you get the index by counting in order every <code>&lt;a&gt;</code> tag in the HTML, starting from 0).</p>\n<p>The index is needed because <code>.getElementsByTagName(&quot;tagName&quot;)</code> returns an array, not a single value.</p>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 2887755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1505530026/picture?type=large", "display_name": "Filip Ondo", "link": "https://stackoverflow.com/users/2887755/filip-ondo"}, "is_accepted": false, "score": 0, "last_activity_date": 1521713854, "creation_date": 1521713854, "answer_id": 49426015, "question_id": 49408920, "link": "https://stackoverflow.com/questions/49408920/click-on-picture-or-link-behind-it/49426015#49426015", "title": "Click on picture or link behind it", "body": "<p>In the end I came up with this. Thank you for help Nicholas Kemp, your answer send me to right direction</p>\n\n<pre><code>Set elements = IE.document.getElementsByTagName(\"a\")\n\nFor Each element In elements\n    If Left(element, 33) = \"javascript:FSResults_fsopenWindow\" Then\n\n    Debug.Print element\n    IE.Navigate element\n\n    End If\n\n Next\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1538468410, "creation_date": 1538468410, "answer_id": 52604536, "question_id": 49408920, "link": "https://stackoverflow.com/questions/49408920/click-on-picture-or-link-behind-it/52604536#52604536", "title": "Click on picture or link behind it", "body": "<p>You could have used CSS selectors.</p>\n\n<p>For example, an attribute selector</p>\n\n<pre><code>ie.document.querySelector(\"[title='View document']\").Click\n</code></pre>\n\n<p>Or same thing to target href by its value</p>\n\n<pre><code>ie.document.querySelector(\"[href*=fsopenWindow]\").Click\n</code></pre>\n\n<p>The last one looks for href containing <code>'fsopenWindow'</code></p>\n\n<p>Both of these avoid looping over collections of elements and use CSS so are faster.</p>\n"}], "owner": {"reputation": 155, "user_id": 2887755, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1505530026/picture?type=large", "display_name": "Filip Ondo", "link": "https://stackoverflow.com/users/2887755/filip-ondo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 49409067, "answer_count": 3, "score": 0, "last_activity_date": 1538468410, "creation_date": 1521642322, "last_edit_date": 1521642374, "question_id": 49408920, "link": "https://stackoverflow.com/questions/49408920/click-on-picture-or-link-behind-it", "title": "Click on picture or link behind it", "body": "<p>Hi I have macro which supposed to click on button on web page..problem is there is no ID behind just this code. Its intranet web page. </p>\n\n<p>Begining of my code</p>\n\n<pre><code>    Set IE = New InternetExplorerMedium\n\n    IE.Navigate = \"some website\"\n\n        While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n          DoEvents\n        Wend\n\nIE.Visible = True\n\n    IE.document.getElementById(\"CategoryCombo\").Value = \"78\"\n    IE.document.getElementById(\"CategoryCombo\").FireEvent (\"onchange\")\n\n'~~&gt; wait until element is present on web page\n    Do\n\n        Set ieobj = Nothing\n\n    On Error Resume Next\n\n        Set ieobj = IE.document.getElementById(\"text1265\")\n\n        DoEvents\n\n    Loop Until Not ieobj Is Nothing\n\n'~~&gt; search box\n   IE.document.getElementById(\"text1265\").Value = \"some value\"\n\n'~~&gt; button click example\n   IE.document.getElementById(\"subBtn\").Click\n</code></pre>\n\n<p>Part of website code</p>\n\n<pre><code>&lt;a title=\"View document\" href=\"javascript:FSResults_fsopenWindow('index.fsp?pn=DOLViewDocument&amp;amp;d=78&amp;amp;q=78-17158635-1&amp;amp;o=78-17158635-1&amp;amp;p=DOCUMENT_NAME#ensureVisible')\" onclick=\"fsCancelEvent(event)\"&gt;&lt;img border=\"0\" alt=\"View document\" align=\"absmiddle\" src=\"Images/DocTypes/PDF.gif\"&gt;&lt;/a&gt;\n</code></pre>\n\n<p>I tried </p>\n\n<pre><code>   IE.document.getElementByTitle(\"View document\").FireEvent (\"onclick\")\n</code></pre>\n\n<p>I also tried </p>\n\n<pre><code>   IE.document.getElementByTagName(\"a\").FireEvent (\"onclick\")\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vlookup", "vba"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 9529162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8959c883d92979bbde5d2bc6e9994ed?s=128&d=identicon&r=PG&f=1", "display_name": "GiantSilver", "link": "https://stackoverflow.com/users/9529162/giantsilver"}, "edited": false, "score": 0, "creation_date": 1521663156, "post_id": 49415531, "comment_id": 85833155, "body": "Thanks for commenting.  Unfortunately, as much as I understand it, wouldn&#39;t this code 1)Determine if B is blank, using C if it is.  Then Search the sheet for an exact match of Column C?  As of now I am fixing it up by sorting it and guaranteeing that one instance for each Name has a number and moving from there."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 111, "user_id": 9529162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8959c883d92979bbde5d2bc6e9994ed?s=128&d=identicon&r=PG&f=1", "display_name": "GiantSilver", "link": "https://stackoverflow.com/users/9529162/giantsilver"}, "edited": false, "score": 0, "creation_date": 1521663237, "post_id": 49415531, "comment_id": 85833197, "body": "You&#39;ll have to provide more detail on your problem, including what you&#39;ve tried and the errors you get, in order for anyone to provide more detailed and correct help."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1521662439, "creation_date": 1521662439, "answer_id": 49415531, "question_id": 49408885, "link": "https://stackoverflow.com/questions/49408885/excel-lookup-where-another-column-has-value/49415531#49415531", "title": "Excel Lookup Where another Column has Value", "body": "<p>Use an embedded <code>If</code> statement. I can't give you the exact statement because you've not posted any code or what you've tried. To illustrate your situation, you would use a statement similar to:</p>\n\n<pre><code>=IF(ISBLANK(B3),C3,B3)\n</code></pre>\n\n<p>Then embed this into your <code>VLOOKUP</code> like this:</p>\n\n<pre><code>=VLOOKUP(IF(ISBLANK(B3),C3,B3),Sheet2!A1:G132,3,FALSE)\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 9529162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8959c883d92979bbde5d2bc6e9994ed?s=128&d=identicon&r=PG&f=1", "display_name": "GiantSilver", "link": "https://stackoverflow.com/users/9529162/giantsilver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521663651, "creation_date": 1521642216, "last_edit_date": 1531164843, "question_id": 49408885, "link": "https://stackoverflow.com/questions/49408885/excel-lookup-where-another-column-has-value", "title": "Excel Lookup Where another Column has Value", "body": "<p>I am attempting to create a macro in excel vba that performs the following functions.  We have a list of transactions, and the same customer can have multiple transactions.  </p>\n\n<p>However, the Customer's ID, which is required, is not always listed.  For Example, Say Column 'A' has the customer names and 'B' has the IDs.  If Column 'B' is blank for a particular instance I want to find the next instance of Column 'B' under the same Customer Name that has value, and put that value into all of the Column 'B's (I could also do this line by line).</p>\n\n<p>I have considered using a vlookup, but the columns are unordered and I cannot find how to add a \"Vlookup where XXX\".</p>\n\n<p>Thanks.<br>\nI cannot embed an image yet, so here is a link to how the sheet may be formatted.\n<a href=\"https://i.stack.imgur.com/Dx8m7.png\" rel=\"nofollow noreferrer\">Excel</a></p>\n\n<p>I am looking have the same numbers for each of the names in VBA.</p>\n\n<p>Thanks for the help. </p>\n"}, {"tags": ["vba", "variables", "encapsulation", "local-variables"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1521639757, "post_id": 49407926, "comment_id": 85817069, "body": "make it a public variable and declare it at the top of the module.  do not re declare inside the sub."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 6, "creation_date": 1521639939, "post_id": 49407926, "comment_id": 85817201, "body": "You can also do <code>Static runCount As Integer</code>"}, {"owner": {"reputation": 207, "user_id": 9351557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697b4490e57f8f056898af8a98e0eb2d?s=128&d=identicon&r=PG&f=1", "display_name": "J R", "link": "https://stackoverflow.com/users/9351557/j-r"}, "edited": false, "score": 2, "creation_date": 1521640025, "post_id": 49407926, "comment_id": 85817284, "body": "Yes, but doing that will also make it accessible from outside the function. I want it accessible only on the inside."}, {"owner": {"reputation": 114165, "user_id": 13087, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/260e2731006271646d36705a95c4db48?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/13087/joe"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 3, "creation_date": 1521640047, "post_id": 49407926, "comment_id": 85817308, "body": "This is not a duplicate of &quot;How to declare a <i>global</i> variable&quot;, he specifically asks how to persist a <i>local</i> variable.  As @CallumDA says, this can be done by declaring it as <code>Static</code> inside the function"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521645573, "post_id": 49408376, "comment_id": 85821851, "body": "Happy to hear about how this answer can be improved, @downvoter."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 2, "creation_date": 1521647430, "post_id": 49408376, "comment_id": 85823388, "body": "Worth mentioning in my opinion that by moving the <code>Static</code> keyword to the method declaration, all local variables (passed to the function and within the body of the method) preserve their values."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 3, "creation_date": 1521647803, "post_id": 49408376, "comment_id": 85823693, "body": "@KostasK. good point - I tend to try and avoid <code>Static</code> locals in the first place though... IMO a <code>Static</code> procedure is an evil thing, makes locals <i>implicitly</i> static (and you probably know how much I &quot;love&quot; the implicit stuff VBA does!), so... I&#39;ll upvote your comment and leave it out of my answer =)"}, {"owner": {"reputation": 207, "user_id": 9351557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697b4490e57f8f056898af8a98e0eb2d?s=128&d=identicon&r=PG&f=1", "display_name": "J R", "link": "https://stackoverflow.com/users/9351557/j-r"}, "edited": false, "score": 0, "creation_date": 1521648264, "post_id": 49408376, "comment_id": 85824063, "body": "Mathieu, thank you very much, this is exactly what I&#39;ve been looking for. But could you please elaborate on that last comment? How does using Static make locals implicitly static, and why is that bad?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 207, "user_id": 9351557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697b4490e57f8f056898af8a98e0eb2d?s=128&d=identicon&r=PG&f=1", "display_name": "J R", "link": "https://stackoverflow.com/users/9351557/j-r"}, "edited": false, "score": 2, "creation_date": 1521649062, "post_id": 49408376, "comment_id": 85824663, "body": "@JR it&#39;s essentially a language feature: if the <code>Static</code> modifier is applied to a procedure, then every local variable in that procedure is implicitly <code>Static</code>, so you have local <code>Dim foo As Long</code> that&#39;s static even if it doesn&#39;t explicitly says so. IMO that&#39;s bug-prone, since static locals, as you now know, retain their value between procedure calls. One last note, your <code>Function</code> is also implicitly returning a <code>Variant</code>. You&#39;ll want to declare an <code>As [Type]</code> return type, and assign its return value <code>myFunction = result</code> so that the caller can use that return value."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 8, "last_activity_date": 1521648549, "last_edit_date": 1521648549, "creation_date": 1521640802, "answer_id": 49408376, "question_id": 49407926, "link": "https://stackoverflow.com/questions/49407926/having-a-local-variable-that-persists-after-the-procedure-is-ended/49408376#49408376", "title": "Having a local variable that persists after the procedure is ended", "body": "<p>Use the <code>Static</code> keyword to declare your local variable, instead of <code>Dim</code>, and the variable's content will outlive a call to the procedure it's declared in.</p>\n\n<p>e.g. this will work as intended:</p>\n\n<pre><code>Function myFunction()\n   Static runCount As Integer\n\n   runCount = runCount + 1\n\n   debug.print \"This function is now running for the \" &amp; runCount &amp; \" time.\"\nEnd Function\n</code></pre>\n\n<p>Using <code>Static</code> locals is arguably preferable to declaring module-scope variables, when the variable only makes sense in a local scope or is only used in one procedure.</p>\n\n<hr>\n\n<p>Note that module-scope does not equate global scope. This variable is accessible anywhere in the module it's declared in, but not outside of it:</p>\n\n<pre><code>Option Explicit\nPrivate foo As Long\n</code></pre>\n\n<p>Use the <code>Private</code> (or <code>Dim</code>, but I prefer to keep <code>Dim</code> for declaring locals) or <code>Public</code> keyword to declare module-scope variables. The <code>Global</code> keyword is deprecated, and does exactly the same thing as <code>Public</code>.</p>\n\n<hr>\n\n<p>As <a href=\"https://stackoverflow.com/questions/49407926/having-a-local-variable-that-persists-after-the-procedure-is-ended/49408376?noredirect=1#comment85823388_49408376\">Kostas K. correctly points out</a>, VBA also supports <code>Static</code> members.</p>\n\n<p>See this signature:</p>\n\n<pre><code>Function myFunction()\n</code></pre>\n\n<p>Is implicitly a <code>Public</code> member. This would be explicit:</p>\n\n<pre><code>Public Function myFunction()\n</code></pre>\n\n<p>VBA supports adding the <code>Static</code> modifier at the procedure level, so you can do this:</p>\n\n<pre><code>Public Static Function myFunction()\n</code></pre>\n\n<p>And now you have a <code>Public</code> function where every local variable is implicitly <code>Static</code>. This is too much implicit, easily bug-prone stuff going on for my own personal taste, so I would avoid it. But it's probably good to know it's there <em>if you need it</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 3, "creation_date": 1521644166, "post_id": 49409585, "comment_id": 85820709, "body": "Can you explain why a <code>Public</code> global is better than a <code>Static</code>? That seems to go against the prevailing common wisdom of the age."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1521645113, "post_id": 49409585, "comment_id": 85821455, "body": "For what it&#39;s worth, I don&#39;t like <code>Static</code> much either, because it interferes with my constant context-switching between VBA and .NET, where <code>static</code> means something entirely different - but see I didn&#39;t bring it up, because it&#39;s unsubstantiated opinion and besides, sometimes it <i>is</i> the right tool for the job. As I said in my own answer, it&#39;s <i>arguably</i> preferable to declaring at module scope. I would warmly recommend you <a href=\"https://stackoverflow.com/posts/49409585/edit\">edit</a> your answer to back up your claims with <i>some</i> arguments. I don&#39;t see the point of exposing a formerly local variable outside the module it&#39;s in. Why <code>Public</code>?"}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1521645397, "post_id": 49409585, "comment_id": 85821687, "body": "@FreeMan as you minus me, so I prefere to listen to you about prevalation Static on Global. However, there is two main reason (applying to this case). The first is that author have a very low skill, cause he don&#39;t know about Static. The second is that  Static on procedure level is subject to loss for eyes among other code.  Concerning to 1-st reason - it is very important. And 3-rd. There are tohns of discussions on Static vs. Global. You are free to do rtfm and to make your own imo. Do not forget - I mark it as imo. And mark as preferable p.3."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521645701, "post_id": 49409585, "comment_id": 85821954, "body": "@Mathieu Guindon thank you. Public is typo. Private on module level, of course..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521645910, "post_id": 49409585, "comment_id": 85822141, "body": "Then you need to <a href=\"https://stackoverflow.com/posts/49409585/edit\">edit</a> your answer to fix it, and back up your claim about passing a <code>ByRef</code> parameter, especially given OP&#39;s goal to count invokes, with a <code>ByRef</code> counter the value lives outside the function and is no longer guaranteed to fulfill its purpose - it&#39;s now all in the hands of the caller."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "edited": false, "score": 0, "creation_date": 1521646765, "post_id": 49409585, "comment_id": 85822803, "body": "Thank you once more. However, it was very easy to detect typo cause the phrase &#39;Public on module level&#39; itself is absurd :) In case given OP&#39;s there are no risks it will be changed somewhere. As I wrote - there are no reasons to assume sophisticated options for calling this function from different places. And do not have to jump above question skill  itself."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1521646982, "post_id": 49409585, "comment_id": 85822990, "body": "Ironically, @user6698332, I didn&#39;t downvote your answer. Also, the OP <i>explicitly stated</i> in his question, &quot;Of course, the simplest solution would be to declare a global variable instead, but in some cases, I want to avoid that for the sake of simplicity, encapsulation or other reasons.&quot; By answering the question with &quot;You should do what you just said you didn&#39;t want to do&quot; without giving a good reason (beyond &quot;my opinion&quot;) doesn&#39;t make for a particularly good answer. Unfortunately, when prompted to try to make your answer better, you only got defensive, and will probably now leave in a huff."}, {"owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1521647594, "post_id": 49409585, "comment_id": 85823523, "body": "@FreeMan, I repeat in 3-rd. Global was a typo. I do not know what came over me :) I apologize to everyone who was misled by my typo. &#39;imo&#39; and explicity marked as preferable variant with ByRef, they clearly say that I am not inclined to holiwars on on the empty place and on very simple question. ."}], "tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": false, "score": -4, "last_activity_date": 1521646087, "last_edit_date": 1521646087, "creation_date": 1521644044, "answer_id": 49409585, "question_id": 49407926, "link": "https://stackoverflow.com/questions/49407926/having-a-local-variable-that-persists-after-the-procedure-is-ended/49409585#49409585", "title": "Having a local variable that persists after the procedure is ended", "body": "<p>Do not use <code>Static</code> (<em>imo</em>).<br>\nUse <strong><code>Private</code></strong> on module level instead of is more preferable.<br>\nBut much more preferable will be to pass counter to function <code>ByRef</code>.  </p>\n"}], "owner": {"reputation": 207, "user_id": 9351557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697b4490e57f8f056898af8a98e0eb2d?s=128&d=identicon&r=PG&f=1", "display_name": "J R", "link": "https://stackoverflow.com/users/9351557/j-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1521648549, "creation_date": 1521639681, "last_edit_date": 1521640217, "question_id": 49407926, "link": "https://stackoverflow.com/questions/49407926/having-a-local-variable-that-persists-after-the-procedure-is-ended", "title": "Having a local variable that persists after the procedure is ended", "body": "<p>I'm not sure if this was asked before, but I couldn't find it. Suppose I have a procedure with a local variable inside it. Normally, that variable is destroyed after the function finishes running. But in some cases, I'd like for it to persist, like in this example:</p>\n\n<pre><code>Function myFunction()\n   Dim runCount As Integer\n\n   runCount = runCount +1\n\n   debug.print \"This function is now running for the \" &amp; runCount &amp; \" time.\"\nEnd Function\n</code></pre>\n\n<p>In this example, the code wouldn't work, because the runCount would be reset each time. Of course, the simplest solution would be to declare a global variable instead, but in some cases, I want to avoid that for the sake of simplicity, encapsulation or other reasons.</p>\n\n<p>So, is there any way to have the local variable persist after the procedure has finished running?</p>\n"}, {"tags": ["excel", "vba", "extraction"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521639995, "post_id": 49407682, "comment_id": 85817249, "body": "You current code is copying, but not pasting."}, {"owner": {"reputation": 11, "user_id": 9528802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289bdc97ea58faa7cc226119634e75ca?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Lindley", "link": "https://stackoverflow.com/users/9528802/dale-lindley"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521640910, "post_id": 49407682, "comment_id": 85818041, "body": "@Nathan_Sav Good point, I will remove that. Thanks mate!"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521642061, "post_id": 49407682, "comment_id": 85818943, "body": "also assign this value to a variable <code>Range(&quot;V&quot; &amp; Rows.Count).End(xlUp).Row</code> and increment this by 1 each time, rather than finding the end point again may help."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521697199, "post_id": 49407682, "comment_id": 85843528, "body": "Why not just <code>cel.Offset(, 2).Value = cel.Offset(, -10).Value</code> etc. Skip the <code>Set</code> and <code>.Copy</code>"}, {"owner": {"reputation": 11, "user_id": 9528802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289bdc97ea58faa7cc226119634e75ca?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Lindley", "link": "https://stackoverflow.com/users/9528802/dale-lindley"}, "edited": false, "score": 0, "creation_date": 1521729518, "post_id": 49407682, "comment_id": 85864562, "body": "Nathan_Sav I removed the copy and now everything runs very smoothly. I think I was unnesscarily copying because I was not really understanding fully my VBA code. @PatrickK That&#39;s perfect thanks for the feedback, I&#39;ll try to trim down the code further. Cheers guys!"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1521641606, "creation_date": 1521641606, "answer_id": 49408673, "question_id": 49407682, "link": "https://stackoverflow.com/questions/49407682/is-there-a-faster-more-efficient-way-of-executing-a-grab-and-collate-code-grab/49408673#49408673", "title": "Is there a faster/more efficient way of executing a grab and collate code? (Grab and collect specific data)", "body": "<p>The first thing to try is to add a </p>\n\n<pre><code>DoEvents\n</code></pre>\n\n<p>inside the loops. It won't make it faster, but you will not get the freeze effect.</p>\n"}], "owner": {"reputation": 11, "user_id": 9528802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289bdc97ea58faa7cc226119634e75ca?s=128&d=identicon&r=PG&f=1", "display_name": "Dale Lindley", "link": "https://stackoverflow.com/users/9528802/dale-lindley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521641606, "creation_date": 1521638998, "question_id": 49407682, "link": "https://stackoverflow.com/questions/49407682/is-there-a-faster-more-efficient-way-of-executing-a-grab-and-collate-code-grab", "title": "Is there a faster/more efficient way of executing a grab and collate code? (Grab and collect specific data)", "body": "<p>I have an excel sheet that that uses a macro to order items in chronological order respective to their deadlines. This sheet then uses a separate macro to check if there is a value in the \"hour\" column (signalling time spent on this item). If there is a value then the code will extract the data and collate these instances into a ordered format - which can then be submitted as a daily timesheet. It may look VERY messy, but I am new so please be understanding of this. </p>\n\n<p>I believe this code may also be the reason excel is not operating smoothly - I.E. ribbon icons are greyed until I hover over them and cell selection can lag (I have to move the excel window around the monitor screen to refresh and see new values after the code below has been run.)</p>\n\n<p>Any comments please do not hold back. </p>\n\n<p>Please click this link for the full file. \n<a href=\"https://drive.google.com/file/d/1C_sZINdalhi1Z2zMwzKAAyzvZg1gPu2Y/view?usp=sharing\" rel=\"nofollow noreferrer\">WORKBREAKDOWN STRUCTURE</a></p>\n\n<pre><code>Public CalcState As Long\nPublic EventState As Boolean\nPublic PageBreakState As Boolean\n\nSub OptimizeCode_Begin()\n\nApplication.ScreenUpdating = False\n\nEventState = Application.EnableEvents\nApplication.EnableEvents = False\n\nCalcState = Application.Calculation\nApplication.Calculation = xlCalculationManual\n\nPageBreakState = ActiveSheet.DisplayPageBreaks\nActiveSheet.DisplayPageBreaks = False\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Timesheet()\n\n    Dim SrchRng As Range\n    Dim PastRng As Range\n    Dim Laststp As Range\n    Dim cel As Range\n    Dim AdSt As Range\n    Dim refe As Range\n\n\n    Dim Hours As Long\n\n    Call OptimizeCode_Begin\n\n\n    Set SrchRng = Range(\"K4:K400\")\n    For Each cel In SrchRng\n        If cel.Value &lt;&gt; \"\" Then\n\n        'Setting up data cells to copy to temporary range\n        Set PastRng = Range(\"L1\")\n        PastRng.Copy\n        cel.Offset(, 1) = PastRng\n\n        'Copy Proj number to temp range\n        Set PastRng = cel.Offset(, -10)\n        PastRng.Copy\n        cel.Offset(, 2) = PastRng\n\n        'Copy Proj name into temp range\n        Set PastRng = cel.Offset(, -9)\n        PastRng.Copy\n        cel.Offset(, 3) = PastRng\n\n        'Copy Activity into temp range\n        Set PastRng = cel.Offset(, -6)\n        PastRng.Copy\n        cel.Offset(, 4) = PastRng\n\n\n        'Copy cell x1 to right and paste in order in column S\n        Set PastRng = cel.Offset(, 1)\n        PastRng.Copy\n        Range(\"S\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy cell x2 to right and paste in order in column T\n        Set PastRng = cel.Offset(, 2)\n        PastRng.Copy\n        Range(\"T\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy cell x3 to right and paste in order in column U\n        Set PastRng = cel.Offset(, 3)\n        PastRng.Copy\n        Range(\"U\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy cell x3 to right and paste in order in column V\n        Set PastRng = cel.Offset(, 4)\n        PastRng.Copy\n        Range(\"V\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy hour to column X\n        Set PastRng = cel\n        PastRng.Copy\n        Range(\"X\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        End If\n\n        Next cel\n\n        'Clear temporary sheet\n        Range(\"L4:O200\").Clear\n\n    'do the same for above but now for the \"Add Hour\" column\n    Set SrchRng = Range(\"J4:J400\")\n    For Each cel In SrchRng\n\n    If cel.Value &lt;&gt; \"\" Then\n\n        'Setting up data cells to copy onto\n        Set PastRng = Range(\"L1\")\n        PastRng.Copy\n        cel.Offset(, 2) = PastRng\n\n        'Copy Proj number into temp range\n        Set PastRng = cel.Offset(, -9)\n        PastRng.Copy\n        cel.Offset(, 3) = PastRng\n\n        'Copy Proj name into copy temp range\n        Set PastRng = cel.Offset(, -8)\n        PastRng.Copy\n        cel.Offset(, 4) = PastRng\n\n        'Copy Activity into copy temp range\n        Set PastRng = cel.Offset(, -5)\n        PastRng.Copy\n        cel.Offset(, 5) = PastRng\n\n\n        'Copy cell x2 to right and paste in order in column S\n        Set PastRng = cel.Offset(, 2)\n        PastRng.Copy\n        Range(\"S\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy cell x3 to right and paste in order in column T\n        Set PastRng = cel.Offset(, 3)\n        PastRng.Copy\n        Range(\"T\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy cell x4 to right and paste in order in column U\n        Set PastRng = cel.Offset(, 4)\n        PastRng.Copy\n        Range(\"U\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy cell x5 to right and paste in order in column V\n        Set PastRng = cel.Offset(, 5)\n        PastRng.Copy\n        Range(\"V\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n        'Copy hour to column X\n\n    End If\n\n    Set refe = Range(\"X\" &amp; Rows.Count).End(xlUp).Offset(1, -1)\n\n        If refe &lt;&gt; \"\" Then\n            Set PastRng = cel\n            PastRng.Copy\n            Range(\"W\" &amp; Rows.Count).End(xlUp).Offset(1) = PastRng\n\n            Else\n            Set PastRng = cel\n            PastRng.Copy\n            Range(\"X\" &amp; Rows.Count).End(xlUp).Offset(1, -1) = PastRng\n\n        End If\n\n    Next cel\n\n    'clear temporary range\n    Range(\"L4:O200\").Clear\n\n    Call OptimizeCode_End\n\n\nMsgBox \"Complete!\"\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub OptimizeCode_End()\n\nActiveSheet.DisplayPageBreaks = PageBreakState\nApplication.Calculation = CalcState\nApplication.EnableEvents = EventState\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 7020737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4192b5c5c9aae24034bfe1922b25ff54?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis vd Eijnde", "link": "https://stackoverflow.com/users/7020737/dennis-vd-eijnde"}, "edited": false, "score": 0, "creation_date": 1521640816, "post_id": 49408008, "comment_id": 85817955, "body": "I&#39;ve added the filter part to the question"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 173, "user_id": 7020737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4192b5c5c9aae24034bfe1922b25ff54?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis vd Eijnde", "link": "https://stackoverflow.com/users/7020737/dennis-vd-eijnde"}, "edited": false, "score": 0, "creation_date": 1521641941, "post_id": 49408008, "comment_id": 85818846, "body": "That doesn&#39;t include the code actually applying the filter"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1521639915, "creation_date": 1521639915, "answer_id": 49408008, "question_id": 49407594, "link": "https://stackoverflow.com/questions/49407594/print-all-records-form-continious-form-access/49408008#49408008", "title": "Print all records form continious form Access", "body": "<p>To print all records on the current object to the default printer for that object, you can use the following VBA:</p>\n\n<pre><code>DoCmd.PrintOut acPrintAll\n</code></pre>\n\n<p>Continuous forms are clumsy for printing, though. I recommend you use a report. If you want me to show you how to transfer filters from a form to a report, you need to be specific about how you're adding those filters.</p>\n"}], "owner": {"reputation": 173, "user_id": 7020737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4192b5c5c9aae24034bfe1922b25ff54?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis vd Eijnde", "link": "https://stackoverflow.com/users/7020737/dennis-vd-eijnde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 49408008, "answer_count": 1, "score": 0, "last_activity_date": 1522228367, "creation_date": 1521638782, "last_edit_date": 1522228367, "question_id": 49407594, "link": "https://stackoverflow.com/questions/49407594/print-all-records-form-continious-form-access", "title": "Print all records form continious form Access", "body": "<p>I have a continious form in Access containing a recordset that can be filtered from within the form. See image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pgSfo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pgSfo.png\" alt=\"Continious form access\"></a></p>\n\n<p>I would like to be able to print all the selected records. Exporting the selected records to a report or printing the records directly are both fine for me. I have been searching everywhere but all posts are about printing single records.</p>\n\n<p>The filter is added to the form making a filter string that updates when one of the filter fields on the form is changed.</p>\n\n<pre><code>If txtDatumvan &lt;&gt; \"\" Then\n    strFilter = \" Clng(format(s.Begin_DatumTijd, 'yyyymmdd')) &gt;= \" &amp; CLng(Format(Me.txtDatumvan, \"yyyymmdd\")) &amp; \" \"\n\n    If txtDatumTot &lt;&gt; \"\" Then\n        strFilter = strFilter + \" AND Clng(format(s.Begin_DatumTijd, 'yyyymmdd')) &lt;= \" &amp; CLng(Format(Me.txtDatumTot, \"yyyymmdd\")) &amp; \"\"\n    End If\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>FIXED: I loaded the records into a report instead of printing the form directly. I did this using a filter string which is filled by the input of the textboxes on top of the form.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 147, "user_id": 2502611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae952c58a383bba685487718c933a029?s=128&d=identicon&r=PG", "display_name": "user2502611", "link": "https://stackoverflow.com/users/2502611/user2502611"}, "edited": false, "score": 3, "creation_date": 1521638671, "post_id": 49407473, "comment_id": 85816153, "body": "Please can you show us what you have tried so far?"}, {"owner": {"reputation": 19, "user_id": 9396601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9b87dcb818326d8562994ad1b2fca?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9396601/chris"}, "reply_to_user": {"reputation": 147, "user_id": 2502611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae952c58a383bba685487718c933a029?s=128&d=identicon&r=PG", "display_name": "user2502611", "link": "https://stackoverflow.com/users/2502611/user2502611"}, "edited": false, "score": 1, "creation_date": 1521639451, "post_id": 49407473, "comment_id": 85816833, "body": "code added to the thread. This code makes it to copy the header of the columns. and while pasting it will check for the last entry in the row. I need the macro to always to start pasting data at on row 12 every time.  The code has been copied and edited a bit."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1521640272, "post_id": 49407473, "comment_id": 85817482, "body": "Is there a reason that you are doing this by means of a Macro? This would be easily managed by a simple <code>INDEX(MATCH())</code> formula... In terms of your loop though, is the data always going to be fixed for rows 8 to 18? I would perhaps just loop through the 11 cells in the M column if that&#39;s the case as with such a small data set there wouldn&#39;t be any performance issues"}, {"owner": {"reputation": 19, "user_id": 9396601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9b87dcb818326d8562994ad1b2fca?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9396601/chris"}, "edited": false, "score": 0, "creation_date": 1521640549, "post_id": 49407473, "comment_id": 85817735, "body": "the file crashes when i use the index match formula, Ive used the formula to bring to the interface sheet this data."}, {"owner": {"reputation": 19, "user_id": 9396601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9b87dcb818326d8562994ad1b2fca?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9396601/chris"}, "edited": false, "score": 0, "creation_date": 1521695296, "post_id": 49407473, "comment_id": 85842871, "body": "Yes the range will be always fixed through the columns, but the data within the cells can be changed."}, {"owner": {"reputation": 19, "user_id": 9396601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9b87dcb818326d8562994ad1b2fca?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9396601/chris"}, "reply_to_user": {"reputation": 147, "user_id": 2502611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae952c58a383bba685487718c933a029?s=128&d=identicon&r=PG", "display_name": "user2502611", "link": "https://stackoverflow.com/users/2502611/user2502611"}, "edited": false, "score": 0, "creation_date": 1521703048, "post_id": 49407473, "comment_id": 85845990, "body": "@user2502611 Hi, can anyone edit the formula, so that always the paste would start with row 12 and end at row 22"}, {"owner": {"reputation": 147, "user_id": 2502611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae952c58a383bba685487718c933a029?s=128&d=identicon&r=PG", "display_name": "user2502611", "link": "https://stackoverflow.com/users/2502611/user2502611"}, "edited": false, "score": 0, "creation_date": 1521711910, "post_id": 49407473, "comment_id": 85851451, "body": "@Chris Can I ask what is not working with your code? I just ran your code through a dummy sheet and it pulled the 6 &quot;Y&quot; values into the range &quot;D12:E17&quot;. Please could you let me know what issues you are facing?"}], "owner": {"reputation": 19, "user_id": 9396601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7e9b87dcb818326d8562994ad1b2fca?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/9396601/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521643057, "creation_date": 1521638481, "last_edit_date": 1521639329, "question_id": 49407473, "link": "https://stackoverflow.com/questions/49407473/copy-paste-data-from-two-cells-within-the-sheet-if-another-cell-value-is-true-on", "title": "Copy-Paste data from two cells within the sheet if another cell value is true on the same sheet;but the data to be pasted within a specific range", "body": "<p>I require to paste the value of 2 cells to a different destination on the same sheet, having checked the condition to be true.</p>\n\n<p>Columns K and L have the data that needs to be copied if condition is true on column M. Total range of data would be from K8 to K18; similarly for L and M.</p>\n\n<p>If Value of column M is \"Y\" then values of K and L on the same row needs to be pasted to the same sheet in column D and E, but it should start with row 12 and paste any other value if \"Y\" below each other without blanks.</p>\n\n<p>The loop should stop checking at row 18 and the data cannot be pasted beyond row 22.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Nnr1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Nnr1.png\" alt=\"screen-shot from excel\"></a></p>\n\n<p>Kindly check the screen shot.\n if any other information is required; kindly let me know.</p>\n\n<pre><code> Sub Search_and_Move()\n\nDim wsSource As Worksheet, wsDest As Worksheet\nDim FoundX As Range, Firstfound As String, Lastrow As Long\n\nSet wsSource = Worksheets(\"Draft\")     ' Source worksheet\nSet wsDest = Worksheets(\"Draft\")       ' Destination worksheet\n\n' Find the first cell in column M with an \"Y\" in it\nSet FoundX = wsSource.Range(\"M:M\").Find(\"Y\", After:=wsSource.Range(\"M\" &amp; Rows.Count), _\n                             LookAt:=xlPart, SearchDirection:=xlNext, MatchCase:=False)\n\nIf FoundX Is Nothing Then\n\n    MsgBox \"No Y's found.\", vbCritical, \"Done!\"\n    Exit Sub\n\nElse    'Copy values\n\n\n    Firstfound = FoundX.Address                                     ' Remember the first found \"Y\" cell address. Prevents an endless loop.\n\n    Lastrow = wsSource.Range(\"D\" &amp; Rows.Count).End(xlUp).Row + 1      ' Next empty row on Destination sheet\n    If Lastrow &lt; 11 Then Lastrow = 11\n\n    Do\n\n        'Copy K:L values from source worksheet to next empty row on the destination worksheet in columns D:E\n        wsDest.Range(\"D\" &amp; Lastrow).Resize(1, 2).Value = FoundX.Offset(0, -2).Resize(1, 2).Value\n\n        Lastrow = Lastrow + 1                                       ' Row counter\n\n        Set FoundX = wsSource.Range(\"M:M\").FindNext(FoundX)         ' Find next \"Y\" in column M\n\n    Loop Until FoundX.Address = Firstfound                          ' Do until the first \"Y\" address is found again\n\nEnd If\n\nMsgBox \"All Y values copied.\", vbInformation, \"Done!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 357, "user_id": 7053699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kfwzm.png?s=128&g=1", "display_name": "brianyates", "link": "https://stackoverflow.com/users/7053699/brianyates"}, "edited": false, "score": 1, "creation_date": 1521636902, "post_id": 49406821, "comment_id": 85814787, "body": "Please post your code"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1521637573, "post_id": 49406821, "comment_id": 85815273, "body": "When you press the button, is the <i>active</i> sheet the one you think it should be?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1521637728, "post_id": 49406821, "comment_id": 85815395, "body": "Your lastRow is being defined off the ActiveSheet, but your formula are going into Tabelle3"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521638008, "post_id": 49406821, "comment_id": 85815614, "body": "@Nathan_Sav you are right. This one was to obvious! Thanks a lot :)"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1521638037, "creation_date": 1521638037, "answer_id": 49407318, "question_id": 49406821, "link": "https://stackoverflow.com/questions/49406821/assign-macro-to-command-button-fail/49407318#49407318", "title": "Assign Macro to Command Button Fail", "body": "<p>Your lastRow is being defined off the ActiveSheet, but your formula are going into Tabelle3 </p>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 49407318, "answer_count": 1, "score": -1, "last_activity_date": 1521649746, "creation_date": 1521636679, "last_edit_date": 1521649746, "question_id": 49406821, "link": "https://stackoverflow.com/questions/49406821/assign-macro-to-command-button-fail", "title": "Assign Macro to Command Button Fail", "body": "<p>I have written a macro which is working smoothly for approximately 1,000 rows when I run it in the Developer but when I link it to a command button and start it by pressing the button it is just executing it for one row. </p>\n\n<p>Does someone know what is going wrong here and how to solve this issue? Thanks :) </p>\n\n<pre><code>Sub AutomaticallyCalculateted()\n\nDim lastrow As Long\n\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(8).Row\n\n\nTabelle3.Range(\"O9:O\" &amp; lastrow).FormulaLocal = \"=WENN(ODER(K9=\"\"\"\";L9=\"\"\"\");\"\"\"\";WENNFEHLER((L9-K9)/K9;\"\"\"\"))\"\n\n\nTabelle3.Range(\"P9:P\" &amp; lastrow).FormulaLocal = \"=WENN(ODER(L9=\"\"\"\";M9=\"\"\"\");\"\"\"\";WENNFEHLER((M9-L9)/L9;\"\"\"\"))\"\n\n\nTabelle3.Range(\"Q9:Q\" &amp; lastrow).FormulaLocal = \"=WENN(ODER(M9=\"\"\"\";N9=\"\"\"\");\"\"\"\";WENNFEHLER((N9-M9)/M9;\"\"\"\"))\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 8665787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rCMfm.jpg?s=128&g=1", "display_name": "HonnSolo", "link": "https://stackoverflow.com/users/8665787/honnsolo"}, "edited": false, "score": 0, "creation_date": 1521663277, "post_id": 49407052, "comment_id": 85833223, "body": "Excellent answer."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 3, "last_activity_date": 1521638190, "last_edit_date": 1521638190, "creation_date": 1521637354, "answer_id": 49407052, "question_id": 49406720, "link": "https://stackoverflow.com/questions/49406720/select-a-file-based-on-expected-name/49407052#49407052", "title": "Select a File based on Expected Name", "body": "<pre><code>Function GET_LATEST_FILE(strFolder As String, strWildCardStart As String) As String\n\nDim d As Date, fld as Object, f As Object\n\nd = DateSerial(1900, 1, 1)\n\nWith CreateObject(\"scripting.filesystemobject\")\n    Set fld = .getfolder(strFolder)\n    For Each f In fld.Files\n        If f.Name Like strWildCardStart &amp; \"*\" Then\n            If f.datelastmodified &gt; d Then\n                d = f.datelastmodified\n                GET_LATEST_FILE = f.Name\n            End If\n        End If\n    Next f\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Use this like so</p>\n\n<p><code>GET_LATEST_FILE(\"C:\\Workspace\\Dummy Data\",\"Sample\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1521639079, "creation_date": 1521639079, "answer_id": 49407720, "question_id": 49406720, "link": "https://stackoverflow.com/questions/49406720/select-a-file-based-on-expected-name/49407720#49407720", "title": "Select a File based on Expected Name", "body": "<p>A less powerful way to do this, without FileSystemObject, is to use <code>Dir</code>:\n</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function GetLatestFile(ByVal FolderName As String, ByVal FileName As String) As String\n    GetLatestFile = \"\" 'Default to blank\n\n    'Declare variables\n    Dim sTestFile As String, dTestFile As Date, dLatest As Date\n\n    If Right(FolderName, 1) &lt;&gt; \"\\\" Then FolderName = FolderName &amp; \"\\\" 'Add final slash if missing\n    If Len(FileName) = Len(Replace(FileName, \"*\", \"\")) Then FileName = FileName &amp; \"*\" 'Add wildcard if missing\n    dLatest = DateSerial(1900, 0, 0) 'Default to 0\n\n    sTestFile = Dir(FolderName &amp; sTestFile) 'First file that matches the filename, if any\n    While Len(sTestFile) &gt; 1 'Loop through all files until we run out\n        dTestFile = FileDateTime(FolderName &amp; sTestFile) 'Get Created/Modifed Date\n        If dTestFile &gt; dLatest Then 'If new file is newer\n            GetLatestFile = sTestFile\n            dLatest = dTestFile 'Store date\n        End If\n        sTestFile = Dir() 'Calling Dir without any arguments gets the next file to match the last filename given\n    Wend\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 106, "user_id": 8665787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rCMfm.jpg?s=128&g=1", "display_name": "HonnSolo", "link": "https://stackoverflow.com/users/8665787/honnsolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 49407052, "answer_count": 2, "score": -1, "last_activity_date": 1521639079, "creation_date": 1521636442, "last_edit_date": 1531164843, "question_id": 49406720, "link": "https://stackoverflow.com/questions/49406720/select-a-file-based-on-expected-name", "title": "Select a File based on Expected Name", "body": "<p>I am trying to open a file based on a name that is only partially complete in VBA. Here is an example:</p>\n\n<p>I want to pull a file with the name: \"MMM B2 06222018\"</p>\n\n<p>The file will always be located in \"C:\\Myfile\\\"</p>\n\n<p>However, these two files are saved in \"C:\\Myfile\\\":</p>\n\n<p>\"MMM B2 06222018 Updated\" - Updated at 10:00</p>\n\n<p>\"MMM B2 06222018\" - Updated at 9:00</p>\n\n<p>What I want is for the macro to pull the most recently updated file that has the name \"MMM B2 06222018\" within the file name, but that name may or maynot be the complete name of the file. In this case, the \"MMM B2 06222018 Updated\" is the file I want pulled because it includes all of the \"MMM B2 06222018\" name, AND it is the most recently saved file.</p>\n\n<pre><code>FileDateTime(file_path) 'I was thinking of using this to compare the file save times. \n'But I can only use this if I have a file name.\n</code></pre>\n\n<p>What is a good way of analyzing the partial file name?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1521740542, "post_id": 49405979, "comment_id": 85872208, "body": "I&#39;m glad you got a solution that works for you. It would be helpful (both for others who are also searching for a solution and for those looking for unsolved questions) if you would mark the solution as accepted (there should be a checkmark to the left which can be clicked). Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1521635619, "creation_date": 1521635619, "answer_id": 49406471, "question_id": 49405979, "link": "https://stackoverflow.com/questions/49405979/copy-and-paste-values-to-remove-formula/49406471#49406471", "title": "Copy and Paste Values to remove formula", "body": "<p>How about:</p>\n\n<pre><code>Sub fixat()\n    Dim rng As Range, r As Range\n    Set rng = Range(\"AK2:AQ500\").SpecialCells(xlCellTypeFormulas)\n    For Each r In rng\n        If r.Value &lt;&gt; \"\" Then\n            r.Value = r.Value\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9528422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c82f474087b00fc2971c3747a05ac99?s=128&d=identicon&r=PG&f=1", "display_name": "user9528422", "link": "https://stackoverflow.com/users/9528422/user9528422"}, "is_accepted": false, "score": 0, "last_activity_date": 1521643732, "creation_date": 1521643732, "answer_id": 49409464, "question_id": 49405979, "link": "https://stackoverflow.com/questions/49405979/copy-and-paste-values-to-remove-formula/49409464#49409464", "title": "Copy and Paste Values to remove formula", "body": "<p>Thank you for such a quick reply.</p>\n\n<p>That is very close to what I need.</p>\n\n<p>I tried it, and it has removed the \"blank\" formulas and kept the formulas in the populated cells.</p>\n\n<p>Just a little tweak and I think it'll be there.</p>\n\n<p>Thanks again.</p>\n"}], "owner": {"reputation": 1, "user_id": 9528422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c82f474087b00fc2971c3747a05ac99?s=128&d=identicon&r=PG&f=1", "display_name": "user9528422", "link": "https://stackoverflow.com/users/9528422/user9528422"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521643732, "creation_date": 1521634097, "last_edit_date": 1531164843, "question_id": 49405979, "link": "https://stackoverflow.com/questions/49405979/copy-and-paste-values-to-remove-formula", "title": "Copy and Paste Values to remove formula", "body": "<p>This is my first question on here and I'm not very experienced with vba.\nI have an Excel worksheet called Log with formulas in cells AK2:AQ500 that are capturing information.\nWhen the document is saved, I would like to convert any non-blank cells in that range to values, whilst leaving the formulas in the cells that appear blank.\nCan anybody give me some help?\nThanks.</p>\n"}, {"tags": ["excel", "variables", "import", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521635888, "post_id": 49405815, "comment_id": 85814074, "body": "This line <code>lollot = Replace(strFileToOpen, file path, &quot;&quot;)</code> won&#39;t even compile because of syntax error!"}, {"owner": {"reputation": 33, "user_id": 9501720, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211564324089924/picture?type=large", "display_name": "Johannes Juolahti", "link": "https://stackoverflow.com/users/9501720/johannes-juolahti"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521635940, "post_id": 49405815, "comment_id": 85814106, "body": "Yeah, it works, but I modified it to not show the actual folder i was working with..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521636729, "post_id": 49405815, "comment_id": 85814678, "body": "There is a <code>.Refresh BackgroundQuery:=False</code> missing before <code>End With</code>"}, {"owner": {"reputation": 33, "user_id": 9501720, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211564324089924/picture?type=large", "display_name": "Johannes Juolahti", "link": "https://stackoverflow.com/users/9501720/johannes-juolahti"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521636826, "post_id": 49405815, "comment_id": 85814733, "body": "Dropped it out because Excel was giving an error for it, could the solution be to add it back?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521637125, "post_id": 49405815, "comment_id": 85814942, "body": "Ask yourself &quot;<i>Can it be a solution to just delete any line that throws an error?</i>&quot; \u2026 &quot;No, never!&quot; That&#39;s not how we fix errors. Without <code>.Refresh</code> no refresh, therefore no data loaded! If there is an error then read that error understand it and fix it. I&#39;m sure the error didn&#39;t say delete that line. So I suggest you <a href=\"https://stackoverflow.com/posts/49405815/edit\">edit</a> your original question, show your original code, tell us which error you get and where."}, {"owner": {"reputation": 33, "user_id": 9501720, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211564324089924/picture?type=large", "display_name": "Johannes Juolahti", "link": "https://stackoverflow.com/users/9501720/johannes-juolahti"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521637697, "post_id": 49405815, "comment_id": 85815362, "body": "Haha, sorry xD, you&#39;re absolutely right. Edited the code a little bit. I also had .Commandtype = 0 and it gives an &quot;Invalid procedure call or argument&quot; in excel."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521637790, "post_id": 49405815, "comment_id": 85815444, "body": "yes I get that too, but that seems actually to be an Excel bug. So if you remove <code>.CommandType = 0</code> it should work if your filename is correct. Actually that is a bug from the macro recorder that puts the <code>.CommandType = 0</code> where it should not."}, {"owner": {"reputation": 33, "user_id": 9501720, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211564324089924/picture?type=large", "display_name": "Johannes Juolahti", "link": "https://stackoverflow.com/users/9501720/johannes-juolahti"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1521637954, "post_id": 49405815, "comment_id": 85815574, "body": "Okay now it&#39;s working, thanks a lot!! And sorry once again! :)"}], "owner": {"reputation": 33, "user_id": 9501720, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211564324089924/picture?type=large", "display_name": "Johannes Juolahti", "link": "https://stackoverflow.com/users/9501720/johannes-juolahti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521637590, "creation_date": 1521633589, "last_edit_date": 1531164843, "question_id": 49405815, "link": "https://stackoverflow.com/questions/49405815/importing-a-txt-file-to-excel-from-a-variable-text-name-vba", "title": "Importing a *.txt file to excel from a variable text name (VBA)", "body": "<p>Went through some threads to get some advise on importing a *.txt file to Excel but can't get the revised code to work:\n(Before this part of code application asks the user for the file path which <code>lollot</code> variable clears of the file path).</p>\n\n<pre><code>Dim lollot As String\n\nlollot = Replace(strFileToOpen, file path, \"\")\n\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; lollot, Destination:= _\n    Range(\"A1\"))\n    .Name = lollot\n    .FieldNames = True\n    .RowNumbers = False\n    .CommandType = 0\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 65001\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _\n    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 _\n    , 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, _\n    2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 _\n    )\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>So the code doesn't give any error messages when it's run, it just doesn't do anything.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "edited": false, "score": 2, "creation_date": 1521636755, "post_id": 49405790, "comment_id": 85814696, "body": "Please post the rowsource for Combo26"}, {"owner": {"reputation": 59, "user_id": 6897927, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a2a3f400b4b54cbf75ea3f847cdf2001?s=128&d=identicon&r=PG&f=1", "display_name": "gruelle", "link": "https://stackoverflow.com/users/6897927/gruelle"}, "reply_to_user": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "edited": false, "score": 0, "creation_date": 1521640141, "post_id": 49405790, "comment_id": 85817375, "body": "@DataWriter SELECT [StatusList].[ID], [StatusList].[Status] FROM StatusList;"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1521643155, "post_id": 49405790, "comment_id": 85819891, "body": "<a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">How to debug VBA code</a> -- put a break point in the sub and check <code>Combo26.Value</code> - it will be an ID, not the string you expect."}, {"owner": {"reputation": 59, "user_id": 6897927, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a2a3f400b4b54cbf75ea3f847cdf2001?s=128&d=identicon&r=PG&f=1", "display_name": "gruelle", "link": "https://stackoverflow.com/users/6897927/gruelle"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1522153126, "post_id": 49405790, "comment_id": 86029856, "body": "@Andre how can I check Combo26.Value, or Combo26.Column(0)? thx"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1522153293, "post_id": 49405790, "comment_id": 86029972, "body": "With <code>Debug.Print</code>."}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 8463442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/797d024f3af9bf3b60eb8d693985cc99?s=128&d=identicon&r=PG&f=1", "display_name": "dw013", "link": "https://stackoverflow.com/users/8463442/dw013"}, "is_accepted": false, "score": 1, "last_activity_date": 1521657095, "creation_date": 1521657095, "answer_id": 49414099, "question_id": 49405790, "link": "https://stackoverflow.com/questions/49405790/vba-enabling-text-and-combo-box-in-ms-access/49414099#49414099", "title": "VBA enabling text and combo box in MS Access", "body": "<p>If you are pulling two columns as your row source (as indicated in your comment above), it looks like the first one that is displayed is the ID. You should target the second column to do your comparison, e.g.,</p>\n\n<pre><code>If Combo26.Column(1) = \"Resolved\" Then\n  ...\n</code></pre>\n\n<p>That works for me! </p>\n\n<pre><code>Combo26.Column(0)\n</code></pre>\n\n<p>will give you the ID. </p>\n"}], "owner": {"reputation": 59, "user_id": 6897927, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a2a3f400b4b54cbf75ea3f847cdf2001?s=128&d=identicon&r=PG&f=1", "display_name": "gruelle", "link": "https://stackoverflow.com/users/6897927/gruelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521657095, "creation_date": 1521633528, "question_id": 49405790, "link": "https://stackoverflow.com/questions/49405790/vba-enabling-text-and-combo-box-in-ms-access", "title": "VBA enabling text and combo box in MS Access", "body": "<p>I'd like to make a text box (Text28 hereafter) and a combo box (combo43 hereafter) enabled when another combo box (Combo26) takes the value \"Resolved\"</p>\n\n<p>So this is the code, written in VBA, that should do that :</p>\n\n<pre><code>    Private Sub Combo26_AfterUpdate()\n\nIf Combo26.Value = \"Resolved\" Then\n    Me.Text28.Enabled = True\n    Me.Combo43.Enabled = True\nElse\n    Me.Text28.Enabled = False\n    Me.Combo43.Enabled = False\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunatly, nothing happens when I try it. Would you have a idea ?\nThx </p>\n"}, {"tags": ["vba", "object", "split", "range", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1522134995, "post_id": 49406177, "comment_id": 86017105, "body": "when setting Title Case on text that has ALL CAPS that it doesn&#39;t reduce upper case to lower case. But first applying lower case, then title case, does work. I think this is where problem lies, and that was only the main reason my older version of code was not working. anyway thanks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1522163083, "post_id": 49406177, "comment_id": 86037981, "body": "@IbneAshiq You&#39;re welcome. It does help when asking a question to provide the steps necessary to reproduce. Without the sample text I wouldn&#39;t have found that!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1522080090, "last_edit_date": 1522080090, "creation_date": 1521634627, "answer_id": 49406177, "question_id": 49405252, "link": "https://stackoverflow.com/questions/49405252/change-the-case-of-a-range-text-and-type-it/49406177#49406177", "title": "Change the case of a Range text and type it", "body": "<p>You can assign a case to a Range using the WdCharacterCase enumeration. For title case:</p>\n\n<pre><code>R.Case = wdTitleWord \n</code></pre>\n\n<p>Put into the context of your sample code, something like as follows. I did some tweaking:</p>\n\n<ul>\n<li>My version assumes you want to work with the paragraph where the selection currently is, which is why I commented out your first two lines</li>\n<li>In VBA you need to declare the data type of <em>every</em> variable, otherwise it's a Variant. So: <code>Dim R As Word.Range</code> </li>\n<li>VBA provides the <code>Split</code> function to divide up a string according to a delimiter. I use this to get the term to search, so that you can get the Range directly</li>\n<li>I found when setting Title Case on text that has ALL CAPS that it doesn't reduce upper case to lower case. But first applying lower case, then title case, does work.</li>\n</ul>\n\n<p>Sample code</p>\n\n<pre><code>Sub Range_into_Ranges()\n\n'    Selection.EndKey Unit:=wdLine\n'    Selection.MoveUp Unit:=wdParagraph, Count:=1, Extend:=wdExtend\n    Dim R As word.Range, F As word.Range\n    Dim sTerm As String, bFound As Boolean\n\n    Set R = Selection.Paragraphs(1).Range\n    R.MoveEnd wdCharacter, -1 'Trim off the paragraph mark\n    sTerm = R.Text\n    sTerm = Split(sTerm, \",\")(0)\n    Set F = R.Duplicate\n    With F.Find\n        .Text = sTerm\n        .Forward = True\n        .wrap = wdFindStop\n        bFound = .Execute\n    End With\n    If bFound Then\n        F.Case = wdLowerCase\n        F.Case = wdTitleWord\n    Else\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "accepted_answer_id": 49406177, "answer_count": 1, "score": 0, "last_activity_date": 1522080090, "creation_date": 1521632006, "last_edit_date": 1522051914, "question_id": 49405252, "link": "https://stackoverflow.com/questions/49405252/change-the-case-of-a-range-text-and-type-it", "title": "Change the case of a Range text and type it", "body": "<p>Possible scenario, let say we created a <code>Range Object</code> containing the following line:</p>\n\n<p>Speculative BUY, FV: EGP19.59</p>\n\n<p>Now I want to split the <code>Range Object</code> into two parts by \", \" as <code>delimiter</code> so that the given <code>Range</code> will change into two Ranges containing \"Speculative BUY\" and \", FV: EGP19.59\" (Two separate range).</p>\n\n<p>Now I need to change the case of only the first range containing \"Speculative BUY\" into \"Speculative Buy\" using:</p>\n\n<p><code>.Case = wdTitleWord</code></p>\n\n<p>Previously I am using <code>.Find</code> to change the Ranges in the following code (this is not complete code as it is only changing the Range R, not splitting it into two):</p>\n\n<pre><code>Sub Range_into_Ranges()\n\nselection.EndKey Unit:=wdLine\nselection.MoveUp Unit:=wdParagraph, COUNT:=1, Extend:=wdExtend\nDim R, F As Word.Range\nSet R = selection.Range\nSet F = R.Duplicate\n    With F.Find\n    .Text = \", \"\n    .Forward = True\n    .Wrap = wdFindStop\n    .Execute\n    End With\n    If F.Find.Found Then\n    R.SetRange Start:=R.Start, _\n    End:=F.Start\n    R.Case = wdTitleWord\n    Else\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> There may be other ways of producing the same results. you are free to advice me another simple code.</p>\n"}, {"tags": ["oracle", "excel", "erp", "hidden-characters", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521632070, "post_id": 49405168, "comment_id": 85811391, "body": "are your data always like 11301-21? I mean, it&#39;s always 5 digit number - 2 digit number?"}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521632358, "post_id": 49405168, "comment_id": 85811584, "body": "No. There are item codes of various lengths. But every item code is accompanied by a strange character. If you paste the item code in my question thread above and see its length in excel it may give 9 or 10 characters when it should be 8."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521632562, "post_id": 49405168, "comment_id": 85811707, "body": "Yes, I noticed that. Just asking to provide you a solution, because there is a way to extract only the numbers of this item code, getting the value <code>1130121</code>. Next step would be how to assemble again the numbers as item code again, with the same estructure. Are all your item codes like number - number? I mean, is there always a - in the item code and nothing else?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521633288, "post_id": 49405168, "comment_id": 85812204, "body": "Can you post several examples of item codes? Maybe we can try to fix something"}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1521633533, "post_id": 49405168, "comment_id": 85812378, "body": "\u202d12-92003-53\u202c \u202d12-..1051A607\u202c \u202d12-1074F045\u202c \u202d12-1070F089\u202c Hope it helps"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1521633636, "post_id": 49405729, "comment_id": 85812453, "body": "Can you please give me an example?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1521635157, "post_id": 49405729, "comment_id": 85813548, "body": "@UmarAhmad  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1521662528, "post_id": 49405729, "comment_id": 85832802, "body": "The space character is U+0020\u2014VBA doesn&#39;t use ASCII."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1521635126, "last_edit_date": 1521635126, "creation_date": 1521633395, "answer_id": 49405729, "question_id": 49405168, "link": "https://stackoverflow.com/questions/49405168/hidden-space-in-excel/49405729#49405729", "title": "hidden space in excel", "body": "<p>You have characters that <strong>look</strong> like a space character, but are not.  They are UniCode 8236 &amp; 8237.</p>\n\n<p>Just replace them with a space character <em>(ASCII 32)</em>.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Based on the string in your post, the following VBA macro will replace UniCode characters 8236 amd 8237 with simple space characters:</p>\n\n<pre><code>Sub Kleanup()\nDim N1 As Long, N2 As Long\nDim Bad1 As String, Bad2 As String\n\nN1 = 8237\nBad1 = ChrW(N1)\nN2 = 8236\nBad2 = ChrW(N2)\n\nCells.Replace what:=Bad1, replacement:=\" \", lookat:=xlPart\nCells.Replace what:=Bad2, replacement:=\" \", lookat:=xlPart\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1521635922, "post_id": 49406369, "comment_id": 85814098, "body": "Nice use of <i>Regex</i>"}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1521637457, "post_id": 49406369, "comment_id": 85815190, "body": "Excellent! You guys nailed it! Thank you very much. I hope this will answer the questions of many who tried standard formulas like TRIM, Clean etc. A big thanks to both of you. Peace :)"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1521662381, "post_id": 49406369, "comment_id": 85832713, "body": "The ThisCell parameter should be <code>ByVal</code>, not <code>ByRef</code>. <code>ByRef</code> is confusing because it anticipates setting ThisCell\u2014which you don&#39;t\u2014with the effect of resetting the caller&#39;s variable\u2014which is all that <code>ByRef</code> is for. Similarly for the txt parameter because in VBA <code>ByRef</code> is the default."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1521665424, "post_id": 49406369, "comment_id": 85834325, "body": "@TomBlodget Thx for the suggestions. Updated the code thanks to your help."}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1521709778, "post_id": 49406369, "comment_id": 85850007, "body": "Dears, I feel this VBA code is not working after an update in the code. I couldn&#39;t get a copy of the previous code yesterday. So please restore the previous version or make the current code work."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1521712678, "post_id": 49406369, "comment_id": 85851978, "body": "@UmarAhmad Posted the old one from yesterday."}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1521971923, "post_id": 49406369, "comment_id": 85951519, "body": "@FoxfireAndBurnsAndBurns Please,I got another issue: Item code:  WINHY\u2013HUJ-CONT#12RN991-01 doesn&#39;t support your formula. It gives me the result by eliminating the first (-). Could you please improve your code so that it supports all item codes and eliminates just the stubborn characters."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522052025, "post_id": 49406369, "comment_id": 85976164, "body": "What would be the desired output in that case? A string 25 chars long?"}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1522059746, "post_id": 49406369, "comment_id": 85980915, "body": "Yes please. The above item code however does not have hidden chars. But I have it in my file. I need the code to clean and keep the item code as it is, rather than to change its shape."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522060433, "post_id": 49406369, "comment_id": 85981363, "body": "Sorry, i don&#39;t understand what you mean. <i>The above item code however does not have hidden chars. But I have it in my file</i> Without the problematic code, I cannot fix anything."}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1522063364, "post_id": 49406369, "comment_id": 85983374, "body": "\u202dWIHTG\u2013XYH-CONT#16AR999-01\u202c please take this item code to work out. it has the problem. shows 27 chars instead of 25."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522063947, "post_id": 49406369, "comment_id": 85983765, "body": "It shows 26 for me, and 24 after applying formula. I get <code>WIHTGXYH-CONT#16AR999-01</code> after applying formula"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1522064091, "post_id": 49406369, "comment_id": 85983886, "body": "You mean you want to keep the <code>\u2013</code> ?"}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1522128253, "post_id": 49406369, "comment_id": 86013827, "body": "Yes. I want to keep the (-) please."}, {"owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "edited": false, "score": 0, "creation_date": 1522151017, "post_id": 49406369, "comment_id": 86028196, "body": "Perfect now! Thank you!"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 2, "last_activity_date": 1522141178, "last_edit_date": 1522141178, "creation_date": 1521635305, "answer_id": 49406369, "question_id": 49405168, "link": "https://stackoverflow.com/questions/49405168/hidden-space-in-excel/49406369#49406369", "title": "hidden space in excel", "body": "<p>Thanks to <a href=\"https://stackoverflow.com/users/2474656/garys-student\">Gary's Student</a>, because his answer inspired me.</p>\n\n<p>Also, I used <a href=\"https://stackoverflow.com/questions/37024107/excel-vba-remove-unicode-characters-in-a-string\">this answer</a> for this code.</p>\n\n<p>This function will clean every single char of your data, so it should work for you. You need 2 functions: 1 to clean the Unicode chars, and other one to clean your item codes_</p>\n\n<pre><code>        Public Function CLEAN_ITEM_CODE(ByRef ThisCell As Range) As String\n    If ThisCell.Count &gt; 1 Or ThisCell.Count &lt; 1 Then\n        CLEAN_ITEM_CODE = \"Only single cells allowed\"\n        Exit Function\n    End If\n\n\n    Dim ZZ As Byte\n\n    For ZZ = 1 To Len(ThisCell.Value) Step 1\n        CLEAN_ITEM_CODE = CLEAN_ITEM_CODE &amp; GetStrippedText(Mid(ThisCell.Value, ZZ, 1))\n    Next ZZ\n\n\n    End Function\n\n    Private Function GetStrippedText(txt As String) As String\nIf txt = \"\u2013\" Then\n    GetStrippedText = \"\u2013\"\nElse\n    Dim regEx As Object\n\n    Set regEx = CreateObject(\"vbscript.regexp\")\n    regEx.Pattern = \"[^\\u0000-\\u007F]\"\n    GetStrippedText = regEx.Replace(txt, \"\")\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>And this is what i get using it as formula in Excel. Note the difference in the Len of strings:</p>\n\n<p><a href=\"https://i.stack.imgur.com/b0f8r.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b0f8r.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 23, "user_id": 9527084, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-R99kikEH-Ag/AAAAAAAAAAI/AAAAAAAAADI/l8I8-DGqhEk/photo.jpg?sz=128", "display_name": "Umar Ahmad", "link": "https://stackoverflow.com/users/9527084/umar-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1926, "favorite_count": 1, "accepted_answer_id": 49406369, "answer_count": 2, "score": 0, "last_activity_date": 1522141178, "creation_date": 1521631759, "last_edit_date": 1531161705, "question_id": 49405168, "link": "https://stackoverflow.com/questions/49405168/hidden-space-in-excel", "title": "hidden space in excel", "body": "<p>I tried almost all the methods (CLEAN,TRIM,SUBSTITUTE) trying to remove the character hiding in the beginning and the end of a text. In my case, I downloaded the bill of material report from oracle ERP and found that the item codes are a victim of hidden characters. </p>\n\n<p>After so many findings, I was able to trace which character is hidden and found out that it's a question mark'?' (via VBA code in another thread) both at the front and the end. You can take this item code\u202d: \u202d11301-21\u202c</p>\n\n<p>If you paste the above into your excel and see its length =LEN(), you can understand my problem much better.</p>\n\n<p>I need a good solution for this problem. Therefore please help!</p>\n\n<p>Thank you very much in advance.</p>\n"}, {"tags": ["html", "excel", "web", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1521635069, "post_id": 49406194, "comment_id": 85813480, "body": "the button got this &#39;src=&quot;/cmh/cmh/image/button_search.gif&quot;&#39; so i thing it is tagx.src .. i tested it but nothing as result"}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "edited": false, "score": 0, "creation_date": 1521635360, "post_id": 49406194, "comment_id": 85813700, "body": "@POLOSTutorials is the condition evaluates to <code>true</code> and only the <code>click</code> doesn&#39;t work ? what exactly happening ? debug the code and check that <code>if tagx.src = &quot;&#47;cmh&#47;cmh&#47;image&#47;button_search.gif&quot;</code> evaluates to true. you can also check what is the actual value of <code>tagx.src</code>. Let me know."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1521635494, "post_id": 49406194, "comment_id": 85813795, "body": "the page is loaded but nothing happens the click doesn&#39;t work  :&#39;("}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1521635689, "post_id": 49406194, "comment_id": 85813932, "body": "Under the line of tagx.Click i put an msgbox to see if that part is working or not but nothing as result the msg doesn&#39;t display... the problem starts from here  For each tagx in Tags ...."}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "edited": false, "score": 0, "creation_date": 1521635971, "post_id": 49406194, "comment_id": 85814125, "body": "@POLOSTutorials can you check what items <code>tags</code> contain"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1521636076, "post_id": 49406194, "comment_id": 85814215, "body": "tags = ie.Document.GetElementsByTagname(&quot;input&quot;) thats what u mean ???  sorry i&#39;m a little bit newbish because there is no tags in the html code of that page"}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "edited": false, "score": 0, "creation_date": 1521636114, "post_id": 49406194, "comment_id": 85814244, "body": "@POLOSTutorials yes"}, {"owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "edited": false, "score": 0, "creation_date": 1521636132, "post_id": 49406194, "comment_id": 85814256, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/167260/discussion-between-alon-adler-and-polos-tutorials\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 3608, "user_id": 908624, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/RWEjG.jpg?s=128&g=1", "display_name": "Alon Adler", "link": "https://stackoverflow.com/users/908624/alon-adler"}, "is_accepted": true, "score": 0, "last_activity_date": 1521643760, "last_edit_date": 1521643760, "creation_date": 1521634679, "answer_id": 49406194, "question_id": 49404805, "link": "https://stackoverflow.com/questions/49404805/interaction-with-webpage-vba/49406194#49406194", "title": "Interaction With WebPage VBA", "body": "<p><code>GetElementsByTagname</code> mean search for an element by the type of an HTML element (such as, <code>div</code>, <code>p</code> or in your example - <code>input</code>).</p>\n\n<p>You can get all your inputs tags (elements), iterate them and identify the required input, based on it's (for example) <code>srx</code> attribute:</p>\n\n<pre><code>Set tags = ie.Document.GetElementsByTagname(\"Input\")\n\nFor Each tagx In tags\n    If tagx.src= \"/cmh/cmh/xxxxxx\" Then\n        tagx.Click\n    End If\nNext\n</code></pre>\n\n<p>In addition, the final <code>src</code> of the <code>input</code> might changed from the actual code, because you use a relative path. Check the actual <code>src</code> with a MsgBox:</p>\n\n<pre><code>For Each tagx In tags \n    MsgBox tagx.src\n</code></pre>\n\n<p>I assume it will be different, such as prefix of <code>http</code> and so on:</p>\n\n<pre><code>If tagx.src = \"http://xxxx \n   xxxx.eu.airbus.xxx:xxxx/cxxx/xxx/image/button_search.gif\" Then\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 0, "accepted_answer_id": 49406194, "answer_count": 1, "score": 0, "last_activity_date": 1521643760, "creation_date": 1521630723, "last_edit_date": 1531164843, "question_id": 49404805, "link": "https://stackoverflow.com/questions/49404805/interaction-with-webpage-vba", "title": "Interaction With WebPage VBA", "body": "<p>I'm creating a code that allows me to open a specific site and  enter value in element with the name <code>searchByTagName=searchByTRSMP</code> and then Type search to load the new window</p>\n\n<p>But the problem that button search doesn't have a TagName or IdName only this</p>\n\n<pre><code>&lt;td width=\"13%\" align=\"center\" rowSpan=\"1\" colSpan=\"1\"&gt;\n   &lt;input name=\"\" onclick=\"Javascript:document.forms[0].submit();return false;\" type=\"image\" srx=\"/cmh/cmh/xxxxxx\" border=\"0\"&gt;&lt;/input&gt;\n</code></pre>\n\n<p></p>\n\n<p>Anyone Can Light me on pressing that button with only those conditions</p>\n\n<p>this Mycode :</p>\n\n<pre><code>Sub ToComb()\n Dim ie  As Object\n Dim itm As IHTMLElement\n\n Set ie = CreateObject(\"InternetExplorer.Application\")\n ie.Visible = True\n ie.navigate \"http://XXXX- \n XXXX.eu.airbus.XXXXXp:XXXXX/cmh/consultation/preSearchTRSTDMAS.do? \n clearBackList=true&amp;CMH_NO_STORING_fromMenu=true\"\n  While ie.Busy Or ie.readyState &lt;&gt; 4: DoEvents: Wend\n\n  Set itm = ie.document.getElementsByName(\"searchByTRSMP\")(0)\n   If Not itm Is Nothing Then itm.Value = \"k20734\"\n   Set Doc = ie.document\n\n\n    Set tags = ie.document.getElementsByTagName(\"\")\n    For Each tagx In tags\n     If tagx.Value = \"Next\" Then\n     tagx.Click\n    Exit For\n   End If\n Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 3, "creation_date": 1521629968, "post_id": 49404422, "comment_id": 85809922, "body": "<code>Application.Run</code> will be looking for the module in the workbook creating the new workbook.  Try <code>application.run newwb.name &amp; &quot;!foo</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1521630245, "post_id": 49404582, "comment_id": 85810099, "body": "Thanks. You posted at the same time as me! If you add a close quote to your answer, I&#39;ll accept it."}, {"owner": {"reputation": 62259, "user_id": 447356, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/nQ80z.png?s=128&g=1", "display_name": "Shadow The Vaccinated Wizard", "link": "https://stackoverflow.com/users/447356/shadow-the-vaccinated-wizard"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 1, "creation_date": 1522661890, "post_id": 49404582, "comment_id": 86224084, "body": "@Chris quote has been added."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1522661871, "last_edit_date": 1522661871, "creation_date": 1521630109, "answer_id": 49404582, "question_id": 49404422, "link": "https://stackoverflow.com/questions/49404422/executing-vba-code-from-a-string-in-another-workbook/49404582#49404582", "title": "Executing VBA code from a string in another workbook", "body": "<p><code>Application.Run</code> will be looking for the module in the workbook creating the new workbook. Try (not fully tested) something along these lines:</p>\n\n<pre><code>application.run newwb.name &amp; \"!foo\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 0, "last_activity_date": 1521630170, "creation_date": 1521630170, "answer_id": 49404603, "question_id": 49404422, "link": "https://stackoverflow.com/questions/49404422/executing-vba-code-from-a-string-in-another-workbook/49404603#49404603", "title": "Executing VBA code from a string in another workbook", "body": "<p>Would you believe it - after 18 hours of scratching my head over this, I post a SO question and then within 5 minutes I realise the answer myself.</p>\n\n<p>The problem was with the syntax of Application.Run. Apparently, it can be used in the format [ModuleName].[ProcedureName] when running a procedure in the calling workbook; but to specify another workbook, the syntax should be [WorkbookName]![ProcedureName].</p>\n\n<p>So all I had to do was change the line to read:</p>\n\n<pre><code>Application.Run NewWB.Name &amp; \"!foo\"\n</code></pre>\n\n<p>I thought that instead of deleting my question I should just answer it :)</p>\n"}], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 49404582, "answer_count": 2, "score": 0, "last_activity_date": 1522661871, "creation_date": 1521629621, "last_edit_date": 1521642606, "question_id": 49404422, "link": "https://stackoverflow.com/questions/49404422/executing-vba-code-from-a-string-in-another-workbook", "title": "Executing VBA code from a string in another workbook", "body": "<p>I want to execute VBA code, where the code itself is built from a string at runtime</p>\n\n<p>I already found out how to do this via this existing SO answer:\n<a href=\"https://stackoverflow.com/questions/43216390/how-to-run-a-string-as-a-command-in-vba\">How to run a string as a command in VBA</a></p>\n\n<p>For ease of reference, the solution is as follows:</p>\n\n<pre><code>Sub Testing()\n    StringExecute \"MsgBox\" &amp; \"\"\"\" &amp; \"Job Done!\" &amp; \"\"\"\"\nEnd Sub\n\nSub StringExecute(s As String)\n    Dim vbComp As Object\n    Set vbComp = ThisWorkbook.VBProject.VBComponents.Add(1)\n    vbComp.CodeModule.AddFromString \"Sub foo()\" &amp; vbCrLf &amp; s &amp; vbCrLf &amp; \"End Sub\"\n    Application.Run vbComp.Name &amp; \".foo\"\n    ThisWorkbook.VBProject.VBComponents.Remove vbComp\nEnd Sub\n</code></pre>\n\n<p>In a nutshell, it creates a new module within the same workbook; writes a sub according to the specified string; executes the sub; and then removes the module - all within the same runtime process. This works well.</p>\n\n<p>However what if I want to perform the operation on any other workbook than ThisWorkbook? I'm trying the following modified code:</p>\n\n<pre><code>Option Explicit\nDim NewWB As Workbook\n\nSub Testing()\n    Set NewWB = Workbooks.Add\n    StringExecute \"MsgBox\" &amp; \"\"\"\" &amp; \"Job Done!\" &amp; \"\"\"\"\nEnd Sub\n\nSub StringExecute(s As String)\n    Dim vbComp As Object\n    Set vbComp = NewWB.VBProject.VBComponents.Add(1) ' Note the use of NewWB\n    vbComp.CodeModule.AddFromString \"Sub foo()\" &amp; vbCrLf &amp; s &amp; vbCrLf &amp; \"End Sub\"\n    Application.Run vbComp.Name &amp; \".foo\" ' &lt;-- Error on this line\n    NewWB.VBProject.VBComponents.Remove vbComp\nEnd Sub\n</code></pre>\n\n<p>As you can see, this code is identical but for the replacement of ThisWorkbook with NewWB. However it causes an error popup at the Application.Run line:</p>\n\n<blockquote>\n  <p><em>Run-time error '1004': Cannot run the macro 'Module1.foo'. The macro may not be available in this workbook or all macros may be disabled.</em></p>\n</blockquote>\n\n<p>Does anyone know why this wouldn't work with a new workbook? I already tried adding a reference to VBA Extensibility to the NewWB via code after creating it (NewWB.VBProject.References.AddFromGuid \"{0002E157-0000-0000-C000-000000000046}\", 5, 0) - however this did not help.</p>\n"}, {"tags": ["excel", "vba", "com"], "comments": [{"owner": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 0, "creation_date": 1521639741, "post_id": 49404163, "comment_id": 85817057, "body": "<code>UUID.Data4</code> should probably be of size 8."}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "reply_to_user": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 0, "creation_date": 1521640005, "post_id": 49404163, "comment_id": 85817259, "body": "Thanks - just tried, but getting the same error there"}, {"owner": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 0, "creation_date": 1521734644, "post_id": 49404163, "comment_id": 85868410, "body": "And <code>Data4</code> probably already is of size 8.  With no <code>Option Base</code>, <code>Data4(7) As Byte</code> is the same as <code>Data4(1 to 7) As Byte</code>.  Yet, for clarity and safety, I would declare it as either <code>Data4(0 to 7) As Byte</code> or <code>Data4(1 to 8) As Byte</code>.  Sorry I couldn&#39;t help you with E_INVALIDARG.  Can you tell if <code>wb</code> is not <code>Nothing</code>, if <code>ObjPtr(wb)</code> is not 0, if <code>VarPtr(iid)</code> is not 0, etc?  Also, you should use <code>LongPtr</code> for pointers, which makes a difference in case you&#39;re running the 64-bit version of Excel."}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "reply_to_user": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 0, "creation_date": 1521734946, "post_id": 49404163, "comment_id": 85868635, "body": "@acelent - thanks, I think both the inputs as well as structs are fine. I&#39;ve actually solved this now, instead of using an ADO Stream I am creating one via invoking CreateStreamOnHGlobal() from ole32.dll, and this works. I&#39;d still prefer to use the ADO Stream (I have to lodge quite a few invokes in my current way), but not sure what&#39;s wrong there. My suspicion is that CoMarshalInterface() expects a pointer to the COM Interface, which I believe would be a different one than the pointer to the ADO Stream implementing IStream - but might be wrong, not a COM expert unfortunately"}], "owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521635591, "creation_date": 1521628949, "last_edit_date": 1521635591, "question_id": 49404163, "link": "https://stackoverflow.com/questions/49404163/invoke-comarshalinterface-to-marshal-workbook-com-reference", "title": "Invoke CoMarshalInterface to marshal Workbook COM reference", "body": "<p>I'm looking for a smart way to send \"references\" to various COM objects - for example, references to an Excel Workbook, or later on a Range, a Worksheet etc. - to another process via VBA. I'm currently exploring the way suggested here: <a href=\"https://stackoverflow.com/questions/49379793/passing-a-reference-to-a-com-object-accross-processes-via-ipc/49394032#49394032\">Passing a reference to a COM object accross processes via IPC?</a> .</p>\n\n<p>In short, I'm trying to invoke CoMarshalInterface() to marshal the Workbook reference into a stream (later on, I would send the bytes from that stream to another process that would un-marshal it again).</p>\n\n<p>However, I can't seem to make it work; CoMarshalInterface() returns E_INVALIDARGS in below case. Would anybody know what's going wrong here?</p>\n\n<pre><code>Declare Function IIDFromString Lib \"ole32\" (ByVal lpsz As Long, ByRef lpiid As UUID) As Long\n\nDeclare Function CoMarshalInterface Lib \"ole32\" (_\n    ByRef pStream As Variant, _\n    riid As Variant, _\n    pUnknown As Variant, _\n    dwWestContext As Long, _\n    pvDestContextPtr As Long, _\n    mshflags As Long _\n) As Long\n\nPublic Type UUID 'GUID\n  Data1 As Long\n  Data2 As Integer\n  Data3 As Integer\n  Data4(7) As Byte\nEnd Type\n\nConst IID_WORKBOOK As String = \"{000208DA-0000-0000-C000-000000000046}\"\n\nConst MSHCTX_LOCAL As Long = 0\nConst MSHLFLAGS_TABLESTRONG = 1\n\nConst S_OK = &amp;H0\nConst E_INVALIDARG = &amp;H80070057\n\nPublic Sub test()\n    Dim iid As UUID\n    Call IIDFromString(StrPtr(IID_WORKBOOK), iid)\n\n    Dim oStream As Object\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1 ' Binary\n\n    Dim wb As IUnknown\n    Set wb = ThisWorkbook\n\n    Dim result As Long\n    result = CoMarshalInterface(oStream, VarPtr(iid), ObjPtr(wb), MSHCTX_LOCAL, 0, MSHLFLAGS_TABLESTRONG)\n\n    ' Result is E_INVALIDARG\n    Debug.Print \"result: 0x\" &amp; Hex(result)\n\n    oStream.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521629064, "post_id": 49404142, "comment_id": 85809354, "body": "Does <code>reg</code> have the brackets also?"}, {"owner": {"reputation": 1, "user_id": 9413907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60041f76a979b0ba6dfa4fcb52121340?s=128&d=identicon&r=PG&f=1", "display_name": "P Arora", "link": "https://stackoverflow.com/users/9413907/p-arora"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521630678, "post_id": 49404142, "comment_id": 85810386, "body": "Yes, reg shows it as it is as I have shown here. I have all these different strings in excel and reg picks up the one depending on the area chosen by user."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521630925, "post_id": 49404142, "comment_id": 85810559, "body": "I don&#39;t think you can change <code>(000)</code> to a numeric value as it has brackets.  Try <code>mid(range(&quot;a1&quot;).value,2,3)</code> or  <code>mid(strValue,2,3)</code> as <code>reg</code> not sure from your post where the value is coming from"}, {"owner": {"reputation": 1, "user_id": 9413907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60041f76a979b0ba6dfa4fcb52121340?s=128&d=identicon&r=PG&f=1", "display_name": "P Arora", "link": "https://stackoverflow.com/users/9413907/p-arora"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521631685, "post_id": 49404142, "comment_id": 85811114, "body": "Thanks for quick reply again Nathan. All these values have been hardcoded in excel in different cells. So, like another cell has values (100),(110),(120),(200),(210),(215),(220),(225),(300),(310),&zwnj;&#8203;(320),(600)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521631850, "post_id": 49404142, "comment_id": 85811243, "body": "So try something like <code>mid(range(&quot;a1&quot;).value,2,3)</code>  Show the VBA code where you are building this SQL also if you can."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521632239, "post_id": 49404142, "comment_id": 85811507, "body": "How are you populating reg, like <code>reg=range(&quot;a1&quot;).value</code> ???  Add the code to your post."}, {"owner": {"reputation": 1, "user_id": 9413907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60041f76a979b0ba6dfa4fcb52121340?s=128&d=identicon&r=PG&f=1", "display_name": "P Arora", "link": "https://stackoverflow.com/users/9413907/p-arora"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521632517, "post_id": 49404142, "comment_id": 85811687, "body": "Public reg As String;    If Sheets(&quot;Filename&quot;).Range(&quot;i3&quot;).Value = &quot;UK&quot; Then     reg = Sheets(&quot;Filename&quot;).Range(&quot;k1&quot;).Value     ElseIf Sheets(&quot;Filename&quot;).Range(&quot;i3&quot;).Value = &quot;Poland&quot; Then     reg = Sheets(&quot;Filename&quot;).Range(&quot;k2&quot;).Value                                              oCMD.Parameters.Append oCMD.CreateParameter(&quot;reg&quot;, adLongVarChar, adParamInput, 255, reg).            This is all in vba. Sorry, this window does not let me press enter for next line. Will show you the code for sql too."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521632775, "post_id": 49404142, "comment_id": 85811853, "body": "try like <code>reg=replace(replace(Sheets(&quot;Filename&quot;).Range(&quot;k1&quot;).Value,&quot;(&quot;&zwnj;&#8203;,vbnullstring),&quot;)&quot;,v&zwnj;&#8203;bnullstring)</code>  I cant see why it is not going into a VARCHAR(MAX) tho...."}, {"owner": {"reputation": 1, "user_id": 9413907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60041f76a979b0ba6dfa4fcb52121340?s=128&d=identicon&r=PG&f=1", "display_name": "P Arora", "link": "https://stackoverflow.com/users/9413907/p-arora"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521644097, "post_id": 49404142, "comment_id": 85820654, "body": "Tried this but didn&#39;t work. Same error. I have edited the query to include the sql too."}, {"owner": {"reputation": 1, "user_id": 9413907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60041f76a979b0ba6dfa4fcb52121340?s=128&d=identicon&r=PG&f=1", "display_name": "P Arora", "link": "https://stackoverflow.com/users/9413907/p-arora"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521718809, "post_id": 49404142, "comment_id": 85856456, "body": "I am new to this so don&#39;t know much about how this works. It did not let me type more messages here yesterday. I kept trying and after few hours it did let me. I wanted to thank Nathan for trying to help me out. Not sure if this message will go or not."}], "owner": {"reputation": 1, "user_id": 9413907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60041f76a979b0ba6dfa4fcb52121340?s=128&d=identicon&r=PG&f=1", "display_name": "P Arora", "link": "https://stackoverflow.com/users/9413907/p-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521638227, "creation_date": 1521628883, "last_edit_date": 1521638227, "question_id": 49404142, "link": "https://stackoverflow.com/questions/49404142/using-a-string-value-from-excel-vba-to-insert-values-in-temp-table-in-vba", "title": "Using a string value from excel vba to insert values in temp table in vba", "body": "<p>I have already spent hours trying to make this work but this is not working. I hope someone here can help as I know most of you guys are much more knowledgeable and experienced when it comes to issues like these.\n I have a query in sql that needs to pick up data from a variable value defined as string in excel vba. Please see the sql code below. 'reg' is a string variable in vba and the values it holds are like (400),(410),(420),(601). For different regions these values will be different. Depending on what the user chooses, I want the values to be entered in this temp table.</p>\n\n<p>I am using the following VBA</p>\n\n<pre><code>If Sheets(\"Filename\").Range(\"i3\").Value = \"UK\" Then \n      reg = Sheets(\"Filename\").Range(\"k1\").Value\nElseIf Sheets(\"Filename\").Range(\"i3\").Value = \"Poland\" Then \n     reg = Sheets(\"Filename\").Range(\"k2\").Value \n      oCMD.Parameters.Append oCMD.CreateParameter(\"reg\", adLongVarChar, adParamInput, 255, reg)\n</code></pre>\n\n<p><code>insert into @temp table values(@reg)</code></p>\n\n<p>As 'reg' is string in vba, I used @reg varchar(max) in sql. I have also tried to cast this to int trying it directly and also trying it through numeric but nothing has worked. Please see below.</p>\n\n<p><code>insert into @incWarehouses values(cast (cast (@reg as numeric(3,0)) as int))</code></p>\n\n<p>After using this, I get error message 'Error converting data type varchar to numeric'. </p>\n\n<p>Also, I am using it like this in sql</p>\n\n<p>@reg varchar(max)</p>\n\n<p>declare @incWarehouses table (warehouse int)</p>\n\n<p>insert into @incWarehouses values(cast (@reg as int))</p>\n\n<p>Can anyone please help. Any help will be appreciated.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "edited": false, "score": 0, "creation_date": 1521637250, "post_id": 49403958, "comment_id": 85815030, "body": "Machine system is a string and when i type in your code , i get an error saying expected: end of statement"}, {"owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "edited": false, "score": 0, "creation_date": 1521637636, "post_id": 49403958, "comment_id": 85815321, "body": "My mistake, The code works like a charm . Thank You very much"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1521628387, "creation_date": 1521628387, "answer_id": 49403958, "question_id": 49403476, "link": "https://stackoverflow.com/questions/49403476/access-vba-findfirst-with-dlookup-syntax-error/49403958#49403958", "title": "Access VBA Findfirst with Dlookup Syntax Error", "body": "<p>You need to account for spacing, use the <code>AND</code> keyword when checking multiple conditions, and use delimiters where needed (strings).</p>\n\n<p>If <code>MachineSystem</code> is a number:</p>\n\n<pre><code>rs.FindFirst \"[Machine ID]= \" &amp; ID &amp; \" AND [MachineSystem]=\" &amp; DLookup(\"[MachineSystem]\", \"tblMachineSystem\", \"[Machine System ID]=\" &amp; Me.listMachineSubSystem.Column(2, i))\n</code></pre>\n\n<p>If <code>MachineSystem</code> is a string:</p>\n\n<pre><code>rs.FindFirst \"[Machine ID]= \" &amp; ID &amp; \" AND [MachineSystem]= '\" &amp; DLookup(\"[MachineSystem]\", \"tblMachineSystem\", \"[Machine System ID]=\" &amp; Me.listMachineSubSystem.Column(2, i)) &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 49403958, "answer_count": 1, "score": 0, "last_activity_date": 1521628387, "creation_date": 1521627045, "last_edit_date": 1521628234, "question_id": 49403476, "link": "https://stackoverflow.com/questions/49403476/access-vba-findfirst-with-dlookup-syntax-error", "title": "Access VBA Findfirst with Dlookup Syntax Error", "body": "<p>I am getting an error <strong>Syntax Error(Missing Operator) in expression</strong> for this piece of code </p>\n\n<pre><code>For i = 0 To Me.listMachineSubSystem.ListCount - 1\n    rs.FindFirst \"[Machine ID]=\" &amp; ID &amp; \"[MachineSystem]=\" &amp; DLookup(\"[MachineSystem]\", \"tblMachineSystem\", \"[Machine System ID]=\" &amp; Me.listMachineSubSystem.Column(2, i))\n\n   rs1.AddNew\n   rs1![MachineSubsystem] = Me.listMachineSubSystem.Column(1, i)\n   rs1![Machine Sytem ID] = rs![Machine System ID]\n   rs1.Update\n Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521626939, "post_id": 49403369, "comment_id": 85807803, "body": "is your top left cell matching for source and destination when using autofill? It should I believe"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521626949, "post_id": 49403369, "comment_id": 85807817, "body": "Yes of course..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1521627170, "post_id": 49403369, "comment_id": 85807973, "body": "Over which range? You can&#39;t drag it in two directions at once."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1521627404, "post_id": 49403369, "comment_id": 85808138, "body": "Not sure what you are attempting here. You are setting <code>range3</code> to a range then setting it to a return value from <code>Application.Inputbox</code> which is a Boolean. Then you are attempting to set <code>AutoFill</code> to a Boolean value?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1521628062, "post_id": 49403369, "comment_id": 85808589, "body": "Just to correct myself, the return value from <code>Application.Inpubox</code> is not a Boolean, its and integer. But the question still stands"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1521628159, "post_id": 49403369, "comment_id": 85808662, "body": "@Zac - type 8 is a range?"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1521628213, "post_id": 49403369, "comment_id": 85808722, "body": "@Zac its a range"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1521628358, "post_id": 49403369, "comment_id": 85808826, "body": "My bad.. didn&#39;t see the <code>type:=8</code> at the end"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1521628570, "post_id": 49403369, "comment_id": 85808976, "body": "Maybe I am missing something but why you just don&#39;t copy formula to other cells?"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1521628678, "post_id": 49403369, "comment_id": 85809042, "body": "@TomJohnRiddle all of this is created from dynamic tables, that&#39;s why I am using macros"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521628722, "post_id": 49403369, "comment_id": 85809075, "body": "you can&#39;t fill across and down in one go"}, {"owner": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1521628818, "post_id": 49403369, "comment_id": 85809163, "body": "@Robin_Hcp right, but why just not copy formulas using macros?"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "reply_to_user": {"reputation": 747, "user_id": 5627791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ck0cK.png?s=128&g=1", "display_name": "TomJohnRiddle", "link": "https://stackoverflow.com/users/5627791/tomjohnriddle"}, "edited": false, "score": 0, "creation_date": 1521629018, "post_id": 49403369, "comment_id": 85809312, "body": "how? @TomJohnRiddle"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1521632886, "post_id": 49403369, "comment_id": 85811937, "body": "<code>Destination</code> has to be a 1-row or 1-column Range, with the original cell at the Start or End of the range"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629210, "post_id": 49404129, "comment_id": 85809457, "body": "is range2 a single cell?"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629265, "post_id": 49404129, "comment_id": 85809501, "body": "it&#39;s a variable range, in this case it would be equal B4:E7"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629298, "post_id": 49404129, "comment_id": 85809523, "body": "And are there different formulas in B4:E7?"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629354, "post_id": 49404129, "comment_id": 85809558, "body": "What I am trying to do is automatically drag down the formulas over a dynamic range, in this case the range is B4:E7 (but I do not want to focus on the range)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629404, "post_id": 49404129, "comment_id": 85809586, "body": "but are you trying to drag the formula for B4 over B4:E7?"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629431, "post_id": 49404129, "comment_id": 85809609, "body": "it&#39;s the same formula, but with different cells integrating it"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629592, "post_id": 49404129, "comment_id": 85809711, "body": "Can you include an example formula from B4 in the question (not as a picture) ?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629706, "post_id": 49404129, "comment_id": 85809775, "body": "1+1 as a formula, my method works so something else is going on."}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629716, "post_id": 49404129, "comment_id": 85809782, "body": "=IFERROR(SUMPRODUCT(--(INDIRECT($A$2&amp;&quot;[&quot;&amp;B$3&amp;&quot;]&quot;)=INDIRECT($&zwnj;&#8203;A$2&amp;&quot;[&quot;&amp;$A4&amp;&quot;]&quot;)),--&zwnj;&#8203;(INDIRECT($A$2&amp;&quot;[&quot;&amp;B&zwnj;&#8203;$3&amp;&quot;]&quot;)&lt;&gt;0),--(INDIR&zwnj;&#8203;ECT($A$2&amp;&quot;[&quot;&amp;$A4&amp;&quot;]&quot;&zwnj;&#8203;)&lt;&gt;0))/COUNTIFS(INDI&zwnj;&#8203;RECT($A$2&amp;&quot;[&quot;&amp;B$3&amp;&quot;]&zwnj;&#8203;&quot;),&quot;&lt;&gt;0&quot;,INDIRECT($A&zwnj;&#8203;$2&amp;&quot;[&quot;&amp;$A4&amp;&quot;]&quot;),&quot;&lt;&gt;0&zwnj;&#8203;&quot;),0)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521629820, "post_id": 49404129, "comment_id": 85809828, "body": "Still works with using .Formula; just shift relative cells with   range3.FormulaR1C1 = range2.FormulaR1C1 Are you actually getting an error message?"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521630268, "post_id": 49404129, "comment_id": 85810112, "body": "the same message error as above mentioned, even with range3.FormulaR1C1 = range2.FormulaR1C1"}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521633620, "post_id": 49404129, "comment_id": 85812440, "body": "it does not fill the formula over the cells"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521633695, "post_id": 49404129, "comment_id": 85812495, "body": "Do you have the b4 selected when running it? As in gif you can see it should fill."}, {"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1521633825, "post_id": 49404129, "comment_id": 85812583, "body": "got it.. Thanks a lot ! @QHarr"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1521630695, "last_edit_date": 1521630695, "creation_date": 1521628842, "answer_id": 49404129, "question_id": 49403369, "link": "https://stackoverflow.com/questions/49403369/dragging-a-formula-over-a-selected-range/49404129#49404129", "title": "Dragging a formula over a selected range", "body": "<p>Can you do this? Range 2 is single cell at present. Use FormulaR1C1 to keep relative references.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim range2 As Range\n    Dim range3 As Range\n\n    Set range2 = Application.Selection\n    Set range2 = Application.InputBox(\"Source Ranges:\", \"Text\", range2.Address, Type:=8)\n\n    Set range3 = Application.Selection\n    Set range3 = Application.InputBox(\"Source Ranges:\", \"Text\", range2.Address, Type:=8)\n\n    range3.Formula = range2.Formula\n\nEnd Sub\n</code></pre>\n\n<p>Example with FormulaR1C1</p>\n\n<p><a href=\"https://i.stack.imgur.com/730qW.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/730qW.gif\" alt=\"Example\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1521629853, "last_edit_date": 1521629853, "creation_date": 1521629694, "answer_id": 49404450, "question_id": 49403369, "link": "https://stackoverflow.com/questions/49403369/dragging-a-formula-over-a-selected-range/49404450#49404450", "title": "Dragging a formula over a selected range", "body": "<p>If you have corner cells <code>TopLeftCell</code> and <code>BottomRightCell</code> as the Corners for your range-to-fill, then you can fill the rectangle like this:<br>\n  </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With Range(TopLeftCell, BottomRightCell)\n    If .Columns.Count &gt; 1 Then .Rows(1).FillRight 'First fill horizontally\n    If .Rows.Count &gt; 1 Then .FillDown 'Then fill vertically\nEnd With\n</code></pre>\n\n<p>If you have <code>FormulaCell</code> and <code>OtherCorner</code> as your corner-cell ranges then you need to extend with checks as to whether  you fill Right/Left or Up/Down: (i.e work out which diagonals and which direction to fill)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With Range(FormulaCell, OtherCorner)\n    If .Columns.Count &gt; 1 Then 'More than 1 column, fill horizontal\n        If FormulaCell.Column &lt; OtherCorner.Column Then\n            Intersect(.Cells, FormulaCell.EntireRow).FillRight\n        Else\n            Intersect(.Cells, FormulaCell.EntireRow).FillLeft\n        End If\n    End If\n    If .Rows.Count &gt; 1 Then 'More than 1 row, fill vertical\n        If FormulaCell.Row &lt; OtherCorner.Row Then\n            .FillDown\n        Else\n            .FillUp\n        End If\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 49404129, "answer_count": 2, "score": 0, "last_activity_date": 1521635881, "creation_date": 1521626784, "last_edit_date": 1521635881, "question_id": 49403369, "link": "https://stackoverflow.com/questions/49403369/dragging-a-formula-over-a-selected-range", "title": "Dragging a formula over a selected range", "body": "<p>Looking for a way that could help me drag a formula over a range with an autofill sentence, depending on a previous selected range through an application.selection. </p>\n\n<p>I am stuck in the autofill statement as you can see below.</p>\n\n<p>Code:</p>\n\n<pre><code>xTitleId = \"KutoolsforExcel\"\n   Set range2 = Application.Selection\n   Set range2 = Application.InputBox(\"Source Ranges:\", xTitleId, range2.Address, Type:=8)\n\n    Set range3 = Application.Selection\n    Set range3 = Application.InputBox(\"Source Ranges:\", xTitleId, range2.Address, Type:=8)\n\n\n     range2.AutoFill Destination:=range3 'It returns \"run time error 1004 autofill method of range failed\n</code></pre>\n\n<p>Here is a background picture of what I want to do... </p>\n\n<p><a href=\"https://i.stack.imgur.com/nHWRZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nHWRZ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "join", "vba", "foreign-keys"], "comments": [{"owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "edited": false, "score": 0, "creation_date": 1521626698, "post_id": 49403324, "comment_id": 85807632, "body": "My Access is in chinese but i think you can figure it out."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1521628111, "creation_date": 1521628111, "answer_id": 49403853, "question_id": 49403324, "link": "https://stackoverflow.com/questions/49403324/how-to-change-join-type-when-creating-table-relations-access-vba/49403853#49403853", "title": "How to change join type when creating table relations, Access VBA", "body": "<p>If you want to specify such things, you need to use DAO, and not SQL.</p>\n\n<p>Sample code to create a relation that right joins Table1 to Table2 on a field named ID in both tables, without referential integrity:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim rel As New Relation\nDim db As DAO.Database\nSet db = CurrentDb()\nrel.Attributes = dbRelationDontEnforce + dbRelationRight\nrel.Name = \"MyRelation\"\nrel.Table = \"Table1\"\nrel.ForeignTable = \"Table2\"\nDim fld As DAO.Field\nSet fld = rel.CreateField(\"ID\")\nfld.Name = \"ID\"\nfld.ForeignName = \"ID\"\nrel.Fields.Append fld\ndb.Relations.Append rel\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 8310898, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sUVnc.jpg?s=128&g=1", "display_name": "davidzxc574", "link": "https://stackoverflow.com/users/8310898/davidzxc574"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 49403853, "answer_count": 1, "score": 1, "last_activity_date": 1521628129, "creation_date": 1521626666, "last_edit_date": 1521628129, "question_id": 49403324, "link": "https://stackoverflow.com/questions/49403324/how-to-change-join-type-when-creating-table-relations-access-vba", "title": "How to change join type when creating table relations, Access VBA", "body": "<p>I have created relations between tables in Access vba with codes <code>add constraint ...foreign key...references..</code>. But it does not do anything with the join type as the default join type remains inner join. </p>\n\n<p><a href=\"https://i.stack.imgur.com/khnWS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/khnWS.png\" alt=\"Table relations, join type\"></a></p>\n\n<p>How can I define join type in Access vba when creating relations between tables?</p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba", "row", "add"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1521625527, "post_id": 49402804, "comment_id": 85806789, "body": "read about <code>for next loops</code> <code>for each loops</code> <code>loops</code> in general <code>excel.range object</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521625820, "post_id": 49402804, "comment_id": 85806992, "body": "and start your loop at the second row"}], "answers": [{"tags": [], "owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "is_accepted": false, "score": 2, "last_activity_date": 1521625544, "creation_date": 1521625544, "answer_id": 49402901, "question_id": 49402804, "link": "https://stackoverflow.com/questions/49402804/add-a-value-to-column/49402901#49402901", "title": "Add a value to column", "body": "<p>Try this code :</p>\n\n<pre><code>        Sub test_loop()\n\n            lastRow = Cells(Rows.Count, 1).End(xlUp).Row\n            lastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\n                For i = 2 To lastRow\n                    For j = 1 To lastCol\n                        Cells(i, j).Value = Cells(i, j).Value + 3\n                    Next j\n                Next i\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4da3f05608c49c9c8ca424ee02ae342?s=128&d=identicon&r=PG&f=1", "display_name": "pyboy1995", "link": "https://stackoverflow.com/users/7585970/pyboy1995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1521635635, "creation_date": 1521625286, "last_edit_date": 1521635635, "question_id": 49402804, "link": "https://stackoverflow.com/questions/49402804/add-a-value-to-column", "title": "Add a value to column", "body": "<p>I'm really new in Excel VBA programming and I have got a question.</p>\n\n<p>I've got an Excel table that looks like this:</p>\n\n<pre><code>t   t1   t2 \n\n1    4    5  \n\n2    3    6\n\n3    5    8\n</code></pre>\n\n<p>How can I skip the first row with the header <code>t,t1,t2</code> and then add the number <strong>3</strong> to the values in every row?</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["vba", "excel", "xla"], "answers": [{"tags": [], "owner": {"reputation": 2159, "user_id": 2822719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GJ5Hr.jpg?s=128&g=1", "display_name": "Marcus Mangelsdorf", "link": "https://stackoverflow.com/users/2822719/marcus-mangelsdorf"}, "is_accepted": true, "score": 1, "last_activity_date": 1521623371, "creation_date": 1521623371, "answer_id": 49402129, "question_id": 49402128, "link": "https://stackoverflow.com/questions/49402128/calling-an-xla-add-in-method-function-sub-when-the-add-in-is-not-loaded/49402129#49402129", "title": "Calling an XLA add-in method (function/sub) when the add-in is not loaded", "body": "<p>Based on <a href=\"https://stackoverflow.com/a/375753/2822719\">e.James' answer</a> for calling an XLL add-in, I figured out the right format to use if the Add-in <strong>isn't already loaded</strong>. You can use <code>Application.Run</code> for calling methods inside an <strong>.xla</strong> Add-in the following way:</p>\n\n<p>If we assume that the path to our .xla file is <code>C:\\Program Files\\example.xla</code> and the method we want to call is <code>ExampleMethod</code> expecting one integer parameter, then the call would be as follows:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>' Method call without return value\nPrivate Sub XLAExample()\n    Application.Run \"'C:\\Program Files\\example.xla'!ExampleMethod\", 10\nEnd Sub\n\n' Method call with return value (check if you can declare correct type for return value!)\nPrivate Function XLAExample() As Variant\n    XLAExample = Application.Run(\"'C:\\Program Files\\example.xla'!ExampleMethod\", 10)\nEnd Sub\n</code></pre>\n\n<p>So you will need to construct a string of the form</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\"'&lt;ADDIN_PATH&gt;'!&lt;METHOD_NAME&gt;\"\n</code></pre>\n\n<p>for the call and then just append all needed parameters like</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Application.Run &lt;PATH_AND_METHOD&gt;, &lt;PARAMETER_1&gt;, &lt;PARAMETER_2&gt;, ...\n</code></pre>\n\n<p><br>\nUnfortunately, I found that <a href=\"https://stackoverflow.com/a/17468786/2822719\">CuberChase's answer</a> that declares the method directly like an API call doesn't work with my specific .xla file, maybe it would have needed to be loaded to work.</p>\n"}], "owner": {"reputation": 2159, "user_id": 2822719, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GJ5Hr.jpg?s=128&g=1", "display_name": "Marcus Mangelsdorf", "link": "https://stackoverflow.com/users/2822719/marcus-mangelsdorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 49402129, "answer_count": 1, "score": 0, "last_activity_date": 1521635669, "creation_date": 1521623371, "last_edit_date": 1521635669, "question_id": 49402128, "link": "https://stackoverflow.com/questions/49402128/calling-an-xla-add-in-method-function-sub-when-the-add-in-is-not-loaded", "title": "Calling an XLA add-in method (function/sub) when the add-in is not loaded", "body": "<p>I need to call a method that is provided by a third-party XL<strong>A</strong> add-in via my VBA code.  </p>\n\n<p>There are already <a href=\"https://stackoverflow.com/a/375753/2822719\">answers for doing this with a <em>loaded</em> XL<strong>L</strong> add-in</a>, but the intention is to call the method directly.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 5, "creation_date": 1521623375, "post_id": 49402104, "comment_id": 85805403, "body": "Add an example please, and what you&#39;ve tried? it sounds like the LEFT and RIGHT functions are all you need"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1521628992, "post_id": 49402104, "comment_id": 85809295, "body": "I cannot reproduce your problem. Please read Help for <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and edit your question with the example, to make it easier to help you."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9472082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236367cd7d68353e4f3d10a1bed2f77?s=128&d=identicon&r=PG&f=1", "display_name": "Tuccia ", "link": "https://stackoverflow.com/users/9472082/tuccia"}, "edited": false, "score": 0, "creation_date": 1521626442, "post_id": 49402288, "comment_id": 85807479, "body": "the question is:&quot; I have to keep every day a value situated in a DB. this value is the last of a string. The string is allocated in one cell.How could i use the right function to keep only the last value?"}], "tags": [], "owner": {"reputation": 21, "user_id": 9526750, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ciqEYiLNABE/AAAAAAAAAAI/AAAAAAAAADg/QMlxwn6EANM/photo.jpg?sz=128", "display_name": "Manuel", "link": "https://stackoverflow.com/users/9526750/manuel"}, "is_accepted": false, "score": 0, "last_activity_date": 1521623886, "creation_date": 1521623886, "answer_id": 49402288, "question_id": 49402104, "link": "https://stackoverflow.com/questions/49402104/left-and-right-functions/49402288#49402288", "title": "left and right functions", "body": "<p>If you are looking to concatenate the two values, use <code>=CONCATENATE(LEFT(A1,1),RIGHT(A1,1))</code> assuming the cell is A1. If you just need them individually, just select what you need from the expression. </p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9472082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236367cd7d68353e4f3d10a1bed2f77?s=128&d=identicon&r=PG&f=1", "display_name": "Tuccia ", "link": "https://stackoverflow.com/users/9472082/tuccia"}, "edited": false, "score": 0, "creation_date": 1521635802, "post_id": 49404109, "comment_id": 85814015, "body": "yes, thanks a lot... another question...do you know how to modify the settings of VBA in a way that they correspond to the settings of Windows? I have  a problem with the decimal separator because the settings are different...is there a function named &quot;local&quot; for example?"}, {"owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "reply_to_user": {"reputation": 3, "user_id": 9472082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236367cd7d68353e4f3d10a1bed2f77?s=128&d=identicon&r=PG&f=1", "display_name": "Tuccia ", "link": "https://stackoverflow.com/users/9472082/tuccia"}, "edited": false, "score": 0, "creation_date": 1521637180, "post_id": 49404109, "comment_id": 85814987, "body": "please can you mark the best answer using the tick to the left. I would advise you ask this question as another question rather than a comment, and check @Ron Rosenfeld comment on creating good questions."}], "tags": [], "owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1521628794, "creation_date": 1521628794, "answer_id": 49404109, "question_id": 49402104, "link": "https://stackoverflow.com/questions/49402104/left-and-right-functions/49404109#49404109", "title": "left and right functions", "body": "<p>Tuccia, the following take the very last character from cell A1 and pastes the value into B1:</p>\n\n<pre><code>Cells(1, 2).Value = Right(Range(\"A1\"), 1)\n</code></pre>\n\n<p>Is this what you are trying to do?</p>\n"}], "owner": {"reputation": 3, "user_id": 9472082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236367cd7d68353e4f3d10a1bed2f77?s=128&d=identicon&r=PG&f=1", "display_name": "Tuccia ", "link": "https://stackoverflow.com/users/9472082/tuccia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 49404109, "answer_count": 2, "score": -6, "last_activity_date": 1521635818, "creation_date": 1521623304, "last_edit_date": 1521635818, "question_id": 49402104, "link": "https://stackoverflow.com/questions/49402104/left-and-right-functions", "title": "left and right functions", "body": "<p>How can I use a VBA code for selecting a value that is for example the first or the last value of a series, if this series is located all in one Cell of Excel?</p>\n\n<p>Is there a code using the right or left application that can be implemented?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1521622330, "post_id": 49401113, "comment_id": 85804764, "body": "Why did you add <code>Cells(i,2).Select</code>?"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1521625081, "post_id": 49401113, "comment_id": 85806501, "body": "It was just for me to check if it select the right cell .. you can remove this line .."}, {"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1521640879, "post_id": 49401113, "comment_id": 85818009, "body": "Thank you, much appreciated!"}], "tags": [], "owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1578503301, "last_edit_date": 1578503301, "creation_date": 1521619856, "answer_id": 49401113, "question_id": 49401047, "link": "https://stackoverflow.com/questions/49401047/for-each-and-if-loop/49401113#49401113", "title": "For each and if loop", "body": "<p>(neededRange doesn't stock a range but just the last non empty row in column B)\ntry this code :</p>\n\n<pre><code>    Sub test_loop()\n\n    lastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n        For i = 1 To lastRow\n            If Cells(i, 2).Value = 1 Then\n            Cells(i, 2).Select\n               MsgBox \"Yes\"\n               Exit Sub\n            End If\n        Next i\n\n    End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1521640874, "post_id": 49401249, "comment_id": 85818005, "body": "Thank you, much appreciated!"}], "tags": [], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "is_accepted": false, "score": 3, "last_activity_date": 1521620408, "creation_date": 1521620408, "answer_id": 49401249, "question_id": 49401047, "link": "https://stackoverflow.com/questions/49401047/for-each-and-if-loop/49401249#49401249", "title": "For each and if loop", "body": "<p>Loop Column B and return Yes with row number, then save value of Column B to Column A </p>\n\n<pre><code>Sub test_loop()\n\nDim i As Long\n\n    For i = 1 To Cells(Rows.Count, \"B\").End(xlUp).Row\n\n        If Cells(i, \"B\").Value = 1 Then\n            MsgBox \"Yes! Appears at row \" &amp; i\n            Cells(i,\"A\").Value = Cells(i, \"B\").Value\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1521635363, "post_id": 49401734, "comment_id": 85813704, "body": "<code>cell.Offset(-1,0)</code> is one row above, not one column to the left, it need to be <code>cell.Offset(0, -1)</code>"}, {"owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "edited": false, "score": 0, "creation_date": 1521640870, "post_id": 49401734, "comment_id": 85818002, "body": "Thank you, much appreciated!"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1521636197, "last_edit_date": 1521636197, "creation_date": 1521622120, "answer_id": 49401734, "question_id": 49401047, "link": "https://stackoverflow.com/questions/49401047/for-each-and-if-loop/49401734#49401734", "title": "For each and if loop", "body": "<p>It's fine to use a <code>For Each</code> loop, but you need to construct a <code>Range</code> object to loop through first.</p>\n\n<pre><code>Option Explicit\n\nSub test_loop()\n    Dim neededRange As Range, cell As Range\n\n    'get the range to loop through\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Set neededRange = Range(.Cells(1, \"B\"), .Cells(.Rows.Count, \"B\").End(xlUp))\n    End With\n\n    For Each cell In neededRange\n        If cell.Value = 1 Then\n           cell.Offset(0,-1).Value = cell.Value 'put 1 into column A\n           'do something else\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<ul>\n<li>Try not to underscores in variable names. Underscores have a specific meaning elsewhere in VBA</li>\n<li>Don't forget to declare all variables -- I declared <code>cell</code> for you. If you add <code>Option Explicit</code> at the top of your code, you'll be reminded by the IDE</li>\n<li>Rather than just <code>Range(\"A1\")</code> try to <em>fully qualify</em> your ranges. I.e. <code>Workbooks(\"..\").Worksheets(\"..\").Range(\"A1\")</code>. I've done this above in the <code>With</code> statement</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1521635754, "last_edit_date": 1521635754, "creation_date": 1521635449, "answer_id": 49406412, "question_id": 49401047, "link": "https://stackoverflow.com/questions/49401047/for-each-and-if-loop/49406412#49406412", "title": "For each and if loop", "body": "<p>Accessing the worksheet object, such as <code>Value = ..something</code> takes the longest for the code to process. </p>\n\n<p>You can avoid that, by using a \"helper\" range, in the code below I'm using <code>CopyValRng</code>, and every time the cell in column B equals 1 (<code>cell.Value = 1</code>), I'm adding the cell on the left (column A) to that range, using <code>Application.Union</code>.</p>\n\n<p>At the end, I'm just changing the values in the entire range at once using <code>CopyValRng.Value = 1</code>.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub test_loop()\n\nDim Sht As Worksheet\nDim Needed_range As Range, cell As Range, CopyValRng As Range\nDim LastRow As Long\n\n' set the worksheet object, modify \"Sheet1\" to your sheet's name\nSet Sht = ThisWorkbook.Sheets(\"Sheet1\")\nWith Sht\n    ' get last row in column B\n    LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    ' set the range\n    Set Needed_range = .Range(\"B1:B\" &amp; LastRow)\n\n    ' loop through the Range\n    For Each cell In Needed_range\n        If cell.Value = 1 Then\n            If Not CopyValRng Is Nothing Then\n                Set CopyValRng = Application.Union(CopyValRng, cell.Offset(0, -1))\n            Else\n                Set CopyValRng = cell.Offset(0, -1)\n            End If\n        End If\n    Next cell    \nEnd With\n\n' make sure there's at least 1 cell in the range, then put 1's in all the cells in column A at once\nIf Not CopyValRng Is Nothing Then CopyValRng.Value = 1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 7081275, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/83fIU.jpg?s=128&g=1", "display_name": "Maverick", "link": "https://stackoverflow.com/users/7081275/maverick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 49401734, "answer_count": 4, "score": 2, "last_activity_date": 1578503301, "creation_date": 1521619593, "last_edit_date": 1521635647, "question_id": 49401047, "link": "https://stackoverflow.com/questions/49401047/for-each-and-if-loop", "title": "For each and if loop", "body": "<p>I am trying to write a loop which tests each cell in for the number 1, when one is present I want to store the value in the adjacent cell (column A) and transpose all of these in a separate sheet.</p>\n\n<p>However, VBA is not one of my strong points and I'm struggling with getting the first part to work, my code:</p>\n\n<pre><code>Sub test_loop()\n\nDim Needed_range As Long\nNeeded_range = Cells(Rows.Count, \"B\").End(xlUp).Row\n    For Each cell In Range(Needed_range)\n        If cell = 1 Then\n           MsgBox \"Yes\"\n           Exit Sub\n        End If\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>Sorry if this is really basic, I don't use VBA often and am going to need to take a refresher to finish this project! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1521622053, "post_id": 49401671, "comment_id": 85804574, "body": "Thanks - good idea in principle. Unfortunately in my case, it does need to be in array form - as this is about serialization/deserialization, I do need to recreate exactly the types that were previously serialized"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1521623817, "post_id": 49401671, "comment_id": 85805679, "body": "In that case you have to go the hard way and use a collection of <code>Case</code>-statements. I was working on an example, but @AcsErno was faster."}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1521628235, "post_id": 49401671, "comment_id": 85808738, "body": "Have replied below - thanks for your input as well! I will probably go down that route then!"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1521621934, "creation_date": 1521621934, "answer_id": 49401671, "question_id": 49400994, "link": "https://stackoverflow.com/questions/49400994/creating-and-fill-array-when-dimensions-unknown-at-compile-time/49401671#49401671", "title": "Creating and fill array when dimensions unknown at compile-time", "body": "<p>How about using a 'dictionary' instead of a multidimensional array. The key could be a concatenation of all indexes. </p>\n\n<p>Add a reference to the <code>Microsoft Scripting Runtime</code> or change this to late binding.</p>\n\n<pre><code>Option Explicit\n\nDim sample As New Scripting.Dictionary\n\nSub test()\n    Dim index(0 To 3) As Integer\n    index(0) = 3\n    index(1) = 1\n    index(2) = 1\n    index(3) = 0\n    Call SetArrayValue(sample, index, 12345)\n    Debug.Print GetArrayValue(sample, index)\nEnd Sub\n\nSub SetArrayValue(sample As Dictionary, index() As Integer, val As Variant)\n    Dim key As String\n    key = createIndexKey(index)\n    If sample.Exists(key) Then\n        sample(key) = val\n    Else\n        Call sample.Add(key, val)\n    End If\nEnd Sub\n\nFunction GetArrayValue(sample As Dictionary, index() As Integer) As Variant\n    Dim key As String\n    key = createIndexKey(index)\n    If sample.Exists(key) Then\n        GetArrayValue = sample(key)\n    Else\n        GetArrayValue = Null\n    End If\nEnd Function\n\nFunction createIndexKey(index() As Integer)\n    Dim i As Integer\n    createIndexKey = \"\"\n    For i = LBound(index) To UBound(index)\n        createIndexKey = IIf(createIndexKey = \"\", \"\", \":\") &amp; index(i)\n    Next i\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1521628192, "post_id": 49401901, "comment_id": 85808694, "body": "Thanks. Was hoping there might be some sneaky way e.g. by creating some SAFEARRAY and memcopy&#39;ing data into it; but that would get super tricky with Variant/String/etc. types as well. Anyways - will go down that route and just limit support to a reasonable number of dimensions! Thanks"}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1521735095, "post_id": 49401901, "comment_id": 85868739, "body": "Afterthought - I think I have solved this &quot;in principle&quot; for the general case; I can e.g. create a 1dimensional array, and then create a new SAFEARRAY header with the correct SAFEARRAYBOUND elements, and re-point the array to use this instead. But I have to look into memory management, I&#39;m not sure how VBA handles this and am afraid this might leak (e.g. nothing points to the old SAFEARRAY structure anymore - would it ever be released from memory then?)"}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 1, "last_activity_date": 1521622653, "creation_date": 1521622653, "answer_id": 49401901, "question_id": 49400994, "link": "https://stackoverflow.com/questions/49400994/creating-and-fill-array-when-dimensions-unknown-at-compile-time/49401901#49401901", "title": "Creating and fill array when dimensions unknown at compile-time", "body": "<p>There is no elegant solution. <code>Redim</code> can not accept variable number of argument. However, if you can limit \"arbitrary\", you can try something like this: </p>\n\n<pre><code>Sub DimTest()\n    Dim sample() As Integer\n    Dim dimensions(0 To 3) As Integer\n    Dim index(0 To 3) As Integer\n\n    dimensions(0) = 10\n    dimensions(1) = 20\n    dimensions(2) = 40\n    dimensions(3) = 70\n    index(0) = 1\n    index(1) = 2\n    index(2) = 4\n    index(3) = 7\n\n    sample = CreateArrayWithDimensions(dimensions)\n    SetArrayValue sample, index, 12345\nEnd Sub\n\nFunction CreateArrayWithDimensions(dimensions() As Integer) As Integer()\n    Dim b() As Integer\n\n    Select Case UBound(dimensions)\n        Case 1: ReDim b(dimensions(0))\n        Case 2: ReDim b(dimensions(0), dimensions(1))\n        Case 3: ReDim b(dimensions(0), dimensions(1), dimensions(2))\n        Case 4: ReDim b(dimensions(0), dimensions(1), dimensions(2), dimensions(3))\n        Case 5: ReDim b(dimensions(0), dimensions(1), dimensions(2), dimensions(3), dimensions(4))\n    End Select\n\n    CreateArrayWithDimensions = b\nEnd Function\n\nSub SetArrayValue(sample() As Integer, idx() As Integer, value As Integer)\n\n    Select Case UBound(idx)\n        Case 1: sample(idx(0)) = value\n        Case 2: sample(idx(0), idx(1)) = value\n        Case 3: sample(idx(0), idx(1), idx(2)) = value\n        Case 4: sample(idx(0), idx(1), idx(2), idx(3)) = value\n        Case 5: sample(idx(0), idx(1), idx(2), idx(3), idx(4)) = value\n    End Select\nEnd Sub\n</code></pre>\n\n<p>An alternative (and more flexible) solution is to use the good old 1 dimensional linear storage concept (just the way the system stores the arrays in fact), and calculate the real position of the actual entry. </p>\n"}], "owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521635856, "creation_date": 1521619420, "last_edit_date": 1521635856, "question_id": 49400994, "link": "https://stackoverflow.com/questions/49400994/creating-and-fill-array-when-dimensions-unknown-at-compile-time", "title": "Creating and fill array when dimensions unknown at compile-time", "body": "<p>I'm looking into binary serialization and deserialization via VBA.</p>\n\n<p>For this, I would need to be able to create and fill arrays of an arbitrary number of dimensions dynamically. For example, let's say you want to do something like</p>\n\n<pre><code>Dim sample(0 To 3, 0 To 4, 0 To 2, 0 To 2) As Integer\nsample(3,1,1,0) = 12345\n</code></pre>\n\n<p>so create and fill a 4-dimensional array. It's easy if you know the dimensions at compile time of course, but what if you don't?</p>\n\n<pre><code>Sub Deserialize()\n\n  ' Dynamic equiavalent of: Dim sample(0 To 3, 0 To 4, 0 To 2, 0 To 2) As Integer\n  Dim dimensions(0 To 3) As Integer\n  dimensions(0) = 3\n  dimensions(1) = 4\n  dimensions(2) = 2\n  dimensions(3) 2\n  Dim sample As Variant\n  sample = CreateArrayWithDimensions(dimensions)\n\n  ' Dynamic equivalent of sample(3,1,1,0) = 12345\n  Dim index(0 To 3) As Integer\n  index(0) = 3\n  index(1) = 1\n  index(2) = 1\n  index(3) = 0\n  Call SetArrayValue(sample, index, 12345)\nEnd Sub\n</code></pre>\n\n<p>Is this possible in any way? Or in other words, is there any way to implement the pseuod-functions CreateArrayWithDimensions and SetArrayValue ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["javascript", "json", "vba"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521621643, "post_id": 49400988, "comment_id": 85804364, "body": "this might help <a href=\"https://stackoverflow.com/questions/10311361/accessing-json-object-keys-having-spaces\" title=\"accessing json object keys having spaces\">stackoverflow.com/questions/10311361/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 9527136, "user_type": "registered", "profile_image": "https://graph.facebook.com/981279528689154/picture?type=large", "display_name": "Mat&#250;\u0161 Porub\u010dan", "link": "https://stackoverflow.com/users/9527136/mat%c3%ba%c5%a1-porub%c4%8dan"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1521625913, "post_id": 49400988, "comment_id": 85807070, "body": "I tried adding brackets - [&quot;Item 1&quot;] instead of &quot;Item 1&quot; but it doesn&#39;t seem to help"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521626218, "post_id": 49400988, "comment_id": 85807318, "body": "where is &quot;Item 1&quot; in the above? Not a chance at present I would  be able to reproduce this :-("}, {"owner": {"reputation": 21, "user_id": 9527136, "user_type": "registered", "profile_image": "https://graph.facebook.com/981279528689154/picture?type=large", "display_name": "Mat&#250;\u0161 Porub\u010dan", "link": "https://stackoverflow.com/users/9527136/mat%c3%ba%c5%a1-porub%c4%8dan"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521629898, "post_id": 49400988, "comment_id": 85809886, "body": "@QHarr It&#39;s fifth line from bottom of my code. JSON&#39;s structure looks like this: <a href=\"https://imgur.com/a/LKnZU\" rel=\"nofollow noreferrer\">https://imgur.com/a/LKnZU</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521629951, "post_id": 49400988, "comment_id": 85809911, "body": "my bad, can see it now"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1524604402, "post_id": 49400988, "comment_id": 87038179, "body": "What is the content of the <code>H.responsetext</code>? And what is the expected output? Please add it to the question by editing. Check <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1567281599, "post_id": 49400988, "comment_id": 101921500, "body": "You may use this <a href=\"https://github.com/omegastripes/VBA-JSON-parser\" rel=\"nofollow noreferrer\">VBA JSON parser</a>, it represents JSON content as a structure of native VBA arrays and Dictionary objects, so you may just get the value like <code>a = vJSON(&quot;0&quot;)(&quot;3&quot;)(&quot;buckets&quot;)(&quot;Item 1&quot;)(&quot;1&quot;)(&quot;value&quot;)</code>."}], "owner": {"reputation": 21, "user_id": 9527136, "user_type": "registered", "profile_image": "https://graph.facebook.com/981279528689154/picture?type=large", "display_name": "Mat&#250;\u0161 Porub\u010dan", "link": "https://stackoverflow.com/users/9527136/mat%c3%ba%c5%a1-porub%c4%8dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1524604933, "creation_date": 1521619387, "last_edit_date": 1524604933, "question_id": 49400988, "link": "https://stackoverflow.com/questions/49400988/parsing-json-with-keys-containing-spaces-using-vba-js", "title": "Parsing JSON with keys containing spaces using VBA/JS", "body": "<p>I managed to put together VBA code that parses specific JSON:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set S = CreateObject(\"ScriptControl\")\nS.Language = \"JScript\"\nS.AddCode \"function keys(O) { var k = new Array(); for (var x in O) { k.push(x); } return k; } \"\nSet JSON = S.Eval(\"(\" &amp; H.responsetext &amp; \")\")\n\nSet JSON = CallByName(JSON, \"responses\", VbGet)\nSet JSON = CallByName(JSON, \"0\", VbGet)\nSet JSON = CallByName(JSON, \"aggregations\", VbGet)\nSet JSON = CallByName(JSON, \"2\", VbGet)\nSet JSON = CallByName(JSON, \"buckets\", VbGet)\nSet Keys = S.Run(\"keys\", JSON)\n\nDim jsonWS As String, jsonAA As String, jsonTS As String\n\n  For Each Key In Keys\n    Set TableRow = CallByName(JSON, Key, VbGet)\n        jsonWS = CallByName(TableRow, \"key\", VbGet)\n    Set TableRow = CallByName(TableRow, \"3\", VbGet)\n    Set TableRow = CallByName(TableRow, \"buckets\", VbGet)\n    Set TableRow = CallByName(TableRow, \"Item 1\", VbGet)\n        jsonAA = CallByName(TableRow, \"key\", VbGet)\n    Set TableRow = CallByName(TableRow, \"1\", VbGet)\n        jsonTS = CallByName(TableRow, \"value_as_string\", VbGet)\n  Next Key\n</code></pre>\n\n<p>However I ran into a problem. When I run this code it stops at line referencing \"Item 1\" <code>Set TableRow = CallByName(TableRow, \"Item 1\", VbGet)</code> and throws below error:</p>\n\n<blockquote>\n  <p>\"Object doesn't support this property or method\"</p>\n</blockquote>\n\n<p>I guess there's a problem when working with names containing spaces.\nI've tried multiple brackets, quotes, it didn't work. I can't solve this problem as my javascript knowledge is non-existent.</p>\n\n<p>JSON structure looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hgR4L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hgR4L.png\" alt=\"JSON structure\"></a></p>\n"}, {"tags": ["vba", "shell"], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 7917654, "user_type": "registered", "profile_image": "https://graph.facebook.com/709814869202626/picture?type=large", "display_name": "ElfoDerElf", "link": "https://stackoverflow.com/users/7917654/elfoderelf"}, "edited": false, "score": 0, "creation_date": 1521621010, "post_id": 49400520, "comment_id": 85803994, "body": "you mean like this? (objShell.ShellExecute &quot;WScript.Arguments(0)&quot;, &quot;xyz.file&quot;, &quot;&quot;, &quot;open&quot;, 1)  but how does my script then know which .exe he should drag the file on?"}, {"owner": {"reputation": 401, "user_id": 8971873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94373f03041d94879e8dd6749d5aae45?s=128&d=identicon&r=PG&f=1", "display_name": "GrowingBrick", "link": "https://stackoverflow.com/users/8971873/growingbrick"}, "reply_to_user": {"reputation": 90, "user_id": 7917654, "user_type": "registered", "profile_image": "https://graph.facebook.com/709814869202626/picture?type=large", "display_name": "ElfoDerElf", "link": "https://stackoverflow.com/users/7917654/elfoderelf"}, "edited": false, "score": 0, "creation_date": 1521622274, "post_id": 49400520, "comment_id": 85804722, "body": "When you drag the exe file into the script the absolute path to the exe is passed as command-line argument to the script, so in the first index of the arguments there is the path to the exe to execute"}, {"owner": {"reputation": 90, "user_id": 7917654, "user_type": "registered", "profile_image": "https://graph.facebook.com/709814869202626/picture?type=large", "display_name": "ElfoDerElf", "link": "https://stackoverflow.com/users/7917654/elfoderelf"}, "edited": false, "score": 0, "creation_date": 1521624419, "post_id": 49400520, "comment_id": 85806094, "body": "yeah thats the point i want to &quot;simulate&quot; that drag and drop on the exe file by a script so i just double click the script and it automaticaly drag and drops a file onto the exe and starts it. and i cant figure out how to manage that"}, {"owner": {"reputation": 401, "user_id": 8971873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94373f03041d94879e8dd6749d5aae45?s=128&d=identicon&r=PG&f=1", "display_name": "GrowingBrick", "link": "https://stackoverflow.com/users/8971873/growingbrick"}, "reply_to_user": {"reputation": 90, "user_id": 7917654, "user_type": "registered", "profile_image": "https://graph.facebook.com/709814869202626/picture?type=large", "display_name": "ElfoDerElf", "link": "https://stackoverflow.com/users/7917654/elfoderelf"}, "edited": false, "score": 1, "creation_date": 1521624715, "post_id": 49400520, "comment_id": 85806264, "body": "Oh sorry, I&#39;ve misunderstood. So you have to ShellExecute on the target exe and pass as parameter the file you want to simulate the drag and drop with double-quotes ex: <code>chrome.exe &quot;page.html&quot;</code>"}], "tags": [], "owner": {"reputation": 401, "user_id": 8971873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94373f03041d94879e8dd6749d5aae45?s=128&d=identicon&r=PG&f=1", "display_name": "GrowingBrick", "link": "https://stackoverflow.com/users/8971873/growingbrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1521617361, "creation_date": 1521617361, "answer_id": 49400520, "question_id": 49400409, "link": "https://stackoverflow.com/questions/49400409/execute-exe-with-drag-and-drop-with-a-script/49400520#49400520", "title": "Execute .exe with drag and drop with a script", "body": "<p>ShellExecute is the correct way, however usually Windows when drag and drop into a script or executable sends the dropped file as command line argument. So instead xyz.exe it should be:</p>\n\n<pre><code>WScript.Arguments(0)\n</code></pre>\n"}], "owner": {"reputation": 90, "user_id": 7917654, "user_type": "registered", "profile_image": "https://graph.facebook.com/709814869202626/picture?type=large", "display_name": "ElfoDerElf", "link": "https://stackoverflow.com/users/7917654/elfoderelf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 49400520, "answer_count": 1, "score": 1, "last_activity_date": 1521617530, "creation_date": 1521616896, "last_edit_date": 1521617530, "question_id": 49400409, "link": "https://stackoverflow.com/questions/49400409/execute-exe-with-drag-and-drop-with-a-script", "title": "Execute .exe with drag and drop with a script", "body": "<p>is there a way to execute a .exe with dragging a file on it in a script?</p>\n\n<p>it should work the same way as i do it manually </p>\n\n<p>take file -> drop it on .exe -> exe should be started with this file</p>\n\n<p>Would prefer a VB Script</p>\n\n<p>that's what i tried so far:</p>\n\n<pre><code>objShell.ShellExecute \"xyz.exe\", \"xyz.file\", \"\", \"open\", 1\n</code></pre>\n\n<p>thanks for your help!</p>\n"}, {"tags": ["arrays", "vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1521616794, "post_id": 49400081, "comment_id": 85801820, "body": "UDF functions return data to the calling cell not others."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1521616873, "post_id": 49400081, "comment_id": 85801864, "body": "UDF cannot....&quot; Change another cell&#39;s value.&quot; <a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/170787/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1521617087, "post_id": 49400081, "comment_id": 85801954, "body": "As with any standard worksheet array formula, you can select the area beforehand then put the formula into the first cell and CSE. Excel formulas do not &#39;auto-expand&#39; like a <a href=\"https://stackoverflow.com/questions/tagged/google-sheets\">google-sheets</a> <i>arrayformula</i> does."}, {"owner": {"reputation": 13, "user_id": 7040600, "user_type": "registered", "profile_image": "https://graph.facebook.com/326515417712832/picture?type=large", "display_name": "Yomo Konpaku", "link": "https://stackoverflow.com/users/7040600/yomo-konpaku"}, "edited": false, "score": 0, "creation_date": 1521617794, "post_id": 49400081, "comment_id": 85802338, "body": "Thank you all for the help"}], "owner": {"reputation": 13, "user_id": 7040600, "user_type": "registered", "profile_image": "https://graph.facebook.com/326515417712832/picture?type=large", "display_name": "Yomo Konpaku", "link": "https://stackoverflow.com/users/7040600/yomo-konpaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1521622806, "answer_count": 0, "score": 0, "last_activity_date": 1521615604, "creation_date": 1521615604, "question_id": 49400081, "link": "https://stackoverflow.com/questions/49400081/passing-an-array-as-a-result-for-a-udf-in-excel-across-a-range-large-than-the-ce", "closed_reason": "Duplicate", "title": "Passing an array as a result for a UDF in Excel across a range large than the cell input", "body": "<p>I have written a UDF in VBA for Excel that basically returns the Reduced Row Echelon Form of a matrix. However, it is unsurprising that the result is a matrix, and I would like to have the result be displayed over a range lager than the cell which I have input the function. I have been searching around for how to solve this with a single call as opposed to returning per cell but I have not found any solutions.</p>\n\n<p>For context,</p>\n\n<pre><code>Public Function RREF(M As Range, TopLeft As Range) As String\n'Return the Gauss-Jordan Elimination of Matix M\nDim Matrix() As Variant 'Auto-dimensioned in the next step\nMatrix = M\n\n'Run the RREF on the matrix\nMatrix = ToRREF(Matrix) 'UDF not shown here as not required in facilitating the question\n\n'Return M via relative destination\nRREF = Matrix(Application.Caller.Row - TopLeft.Row + 1, \n    Application.Caller.Column - TopLeft.Column + 1)\nEnd Function\n</code></pre>\n\n<p>As you can see from the code, I evaluate the matrix M for as many times as there are mn elements in my matrix, which can be bad as my matrix grows larger.\nI have attempted to use a sub to write the result out, but the result fails to pass through.</p>\n\n<p>I would like to not have a sub to execute the result as I would prefer it works the same way a standard excel function does.</p>\n\n<p>Any suggestions is welcome. Thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1521615043, "post_id": 49399860, "comment_id": 85800946, "body": "on which lines do errors occur i.e. on which line does each occur?"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521615165, "post_id": 49399860, "comment_id": 85801009, "body": "Workbooks(afName).Worksheets(sName).Activate"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521615316, "post_id": 49399860, "comment_id": 85801081, "body": "And please use Option Explicit at the top of your code and declare all your variables"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521615425, "post_id": 49399860, "comment_id": 85801133, "body": "Yep thisFileName is Thisworkbook.Name. I now it&#39;s horrible."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521615474, "post_id": 49399860, "comment_id": 85801159, "body": "Not horrible just a little confusing and, for me, harder to debug; and you always want Option Explicit."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521616246, "post_id": 49399860, "comment_id": 85801523, "body": "What are values of afName and sName when the error occurs? Do they exist? And is the workbook activated first before the worksheet? Think that is required."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521616546, "post_id": 49399860, "comment_id": 85801688, "body": "Activate the workbook first then separate line Activate the sheet"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521616923, "post_id": 49399860, "comment_id": 85801886, "body": "Hm his print &quot;Out of Range&quot; add open file say  - &quot;1first_svod [Read-Only] [Compatibility Mode] - Excel&quot;. It is important?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521616994, "post_id": 49399860, "comment_id": 85801919, "body": "So it now errors on the worksheet activate line?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521617088, "post_id": 49399860, "comment_id": 85801956, "body": "If it errors on the workbook line, do you have the correct file extension?"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521617096, "post_id": 49399860, "comment_id": 85801963, "body": "No, when i try activate Workbooks - &quot;Workbooks(afName).Activate&quot;. afName = &quot;1first_svod&quot; and open file &quot;1first_svod&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521617115, "post_id": 49399860, "comment_id": 85801973, "body": "See comment above"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521617255, "post_id": 49399860, "comment_id": 85802053, "body": "It could well be using a different file extension e.g. for an earlier version of Excel e.g. xls"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521617857, "post_id": 49399860, "comment_id": 85802374, "body": "Sory for my english. Im try first activate workbook then sheet. But he does not give me this. I do not understand why he swears, like the names coincide."}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521618308, "post_id": 49399860, "comment_id": 85802591, "body": "I dont can change formatl all my files because many people in other city use Ms Office 2003."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521618439, "post_id": 49399860, "comment_id": 85802656, "body": "<a href=\"https://stackoverflow.com/questions/18193153/vba-run-time-error-9-subscript-out-of-range-trying-to-activate-another-workb\" title=\"vba run time error 9 subscript out of range trying to activate another workb\">stackoverflow.com/questions/18193153/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521619560, "post_id": 49399860, "comment_id": 85803267, "body": "To make sure i use &quot;Debug.Pring openBook.name&quot;.  And get the name &quot;1first_svod.xls&quot;. Then print next line code Workbooks(&quot;11first_svod.xls&quot;).Activate. But anyway get error &quot;Subscript out of range&quot;."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521619880, "post_id": 49399860, "comment_id": 85803437, "body": "Maybe someone more experienced can help. From the link I mentioned it said make sure the workbook is activated from the workbook containing the code (ThisWorkbook) as this is the more recent version. You appear, I think, to be doing that, though worth checking. You also have EnableEvents switched off so notification re file versions shouldn&#39;t be a problem. Sorry I am not sure how to advise further. @Jeeped?"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521620213, "post_id": 49399860, "comment_id": 85803610, "body": "Sorry for wasting your time."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521620269, "post_id": 49399860, "comment_id": 85803639, "body": "you didn&#39;t waste my time. I just don&#39;t have enough experience with this type of problem. Someone likely will. :-)"}, {"owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521620513, "post_id": 49399860, "comment_id": 85803764, "body": "I solved the problem =)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1521620556, "post_id": 49399860, "comment_id": 85803785, "body": "Excellent! Well done. Please post the solution as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1521620692, "creation_date": 1521620692, "answer_id": 49401321, "question_id": 49399860, "link": "https://stackoverflow.com/questions/49399860/vba-add-freezepanes-to-open-file/49401321#49401321", "title": "VBA add FreezePanes to open file", "body": "<p>Solution:<br>\nDont use   </p>\n\n<pre><code>Dim openApp As Excel.Application\nSet openApp = New Excel.Application\nDim openBook As Workbook\nSet openBook = openApp.Workbooks.Open(openWaN)\n</code></pre>\n\n<p>Need use   </p>\n\n<pre><code>Dim openBook As Workbook\nSet openBook = Workbooks.Open(openWaN)\nWorkbooks(openBook.Name).Activate\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9446872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BPKSu.jpg?s=128&g=1", "display_name": "Mikhail  Ivanov", "link": "https://stackoverflow.com/users/9446872/mikhail-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1521620692, "creation_date": 1521614664, "question_id": 49399860, "link": "https://stackoverflow.com/questions/49399860/vba-add-freezepanes-to-open-file", "title": "VBA add FreezePanes to open file", "body": "<p>I'm stuck. Try to add FreezePanes to all my excel files.\nI have 28 folders \"municipalities\" in each folder 16 files: 1first, 2second,...\nAll filese Excel 2003 formats, and are divided into two types - with a figure in the title and without. Each file has several pages.<br>\nIn parent directory i create file \"base\" in each two pages \"municipalities\" and \"FilesList\" and macro \"Sub AddTo Freeze()\"   </p>\n\n<pre><code>Sub addToFreeze()\n    x% = firstDataBaseString\n    Do While Application.Workbooks(thisFileName).Worksheets(\"municipalities\").Cells(x, 2) &lt;&gt; Empty\n        y% = firstDataBaseString\n        actMun$ = Application.Workbooks(thisFileName).Worksheets(\"municipalities\").Cells(x, 2)\n        Do While Application.Workbooks(thisFileName).Worksheets(\"FilesList\").Cells(y, 1) &lt;&gt; Empty\n            actFile$ = TrimFormats(Application.Workbooks(thisFileName).Worksheets(\"FilesList\").Cells(y, 1)) &amp; addedToMunicipal &amp; \".xls\"\n            openWaN$ = ThisWorkbook.Path &amp; Application.PathSeparator &amp; actMun &amp; Application.PathSeparator &amp; actFile\n            Dim fileHaveNum As Boolean\n            fileHaveNum = HasNumber(Application.Workbooks(thisFileName).Worksheets(\"FilesList\").Cells(y, 1))\n            If FileExists(openWaN) Then\n                Dim openApp As Excel.Application\n                Set openApp = New Excel.Application\n                openApp.DisplayAlerts = False\n                openApp.Visible = True\n                openApp.ScreenUpdating = False\n                Dim openBook As Workbook\n                Set openBook = openApp.Workbooks.Open(openWaN)\n                For Each ws In openBook.Worksheets\n                    ws.Unprotect Password:=\"P$n177\"\n                    afName$ = TrimFormats(actFile)\n                    sName$ = ws.Name\n                    Workbooks(afName).Worksheets(sName).Activate\n                    If fileHaveNum Then\n                        Range(\"G4:G4\").Select\n                        ActiveWindow.FreezePanes = True\n                    Else\n                        Range(\"G6:G6\").Select\n                        ActiveWindow.FreezePanes = True\n                    End If\n                    ws.Protect Password:=\"P$n177\"\n                Next\n                openBook.Close SaveChanges:=True\n                openApp.ScreenUpdating = True\n                openApp.Quit\n            End If\n            y = y + 1\n        Loop\n    x = x + 1\n    Loop\n\nEnd Sub   \n</code></pre>\n\n<p>Every tyme when i try run macro his say \"Subscript out of range\". Or add FreezePanese to my \"base\" file....</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1521616020, "creation_date": 1521616020, "answer_id": 49400198, "question_id": 49399438, "link": "https://stackoverflow.com/questions/49399438/macros-to-copy-formula-from-1-row-to-another-skipping-2-3-rows/49400198#49400198", "title": "Macros to copy formula from 1 row to another skipping 2-3 rows", "body": "<p>To count <code>6, 9, 12, 15</code> you can use a <code>For</code> loop with <code>Step 3</code></p>\n\n<pre><code>Option Explicit\n\nPublic Sub Step3Example()    \n    Dim i As Long\n    For i = 6 To 15 Step 3\n        Debug.Print i 'output: 6, 9, 12, 15\n    Next i    \nEnd Sub\n</code></pre>\n\n<p>And you can use <code>i</code> in your formula representing <code>6</code>, <code>9</code>, <code>12</code> and <code>15</code>:</p>\n\n<pre><code>.Range(\"R6:R\" &amp; LastRow).Formula = \"=if(E:E=0,0,Average(E\" &amp; i &amp; \":G\" &amp; i &amp; \"))\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9283113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef71f70d65feaafdfc88d488de5e11d?s=128&d=identicon&r=PG&f=1", "display_name": "shweta agnihotri", "link": "https://stackoverflow.com/users/9283113/shweta-agnihotri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 49400198, "answer_count": 1, "score": 0, "last_activity_date": 1521616020, "creation_date": 1521612875, "last_edit_date": 1531164843, "question_id": 49399438, "link": "https://stackoverflow.com/questions/49399438/macros-to-copy-formula-from-1-row-to-another-skipping-2-3-rows", "title": "Macros to copy formula from 1 row to another skipping 2-3 rows", "body": "<p>I have values in column E6, F6 to P6 from which I have quarterly average formula in row R6 to U6. In row 7 and 8 I have another data and again in row 9 I have data which I need to use average formula. Likewise, I have data which need to average out from row 6,9,12,15, respectively.Hence, could anyone please help me to writing macros formula leaving 2 rows every time </p>\n\n<p>below is the macros I wrote for </p>\n\n<pre><code>Dim LastRow As Long\n LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n.Range(\"R6:R\" &amp; LastRow).Formula = \"=if(E:E=0,0,Average(E6:G6))\"\n.Range(\"S6:S\" &amp; LastRow).Formula = \"=if(G:G=0,0,Average(H6:J6))\"\n.Range(\"T6:T\" &amp; LastRow).Formula = \"=if(J:J=0,0,Average(K6:M6))\"\n.Range(\"U6:U\" &amp; LastRow).Formula = \"=if(M:M=0,0,Average(N6:P6))\"\n.Range(\"V6:V\" &amp; LastRow).Formula = \"=if(R:R=0,0,Average(R6:U6))\"\n.Range(\"R6:V6\" &amp; LastRow).Copy\n.Range(\"R6:V6\" &amp; LastRow).PasteSpecial xlValues\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["vba", "path"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1521618297, "post_id": 49398476, "comment_id": 85802586, "body": "what is the error and is this a share drive? Assuming this is Windows"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1521624261, "post_id": 49398476, "comment_id": 85805984, "body": "Your code looks correct. Issue a <code>?dir(Path &amp; &quot;*.*&quot;)</code> in the immediate window after <code>Path = ...</code> to see if it returns anything."}, {"owner": {"reputation": 45, "user_id": 7420131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-VRKQCgi4liM/AAAAAAAAAAI/AAAAAAAAESI/IXES2D66lrk/photo.jpg?sz=128", "display_name": "EbayBill", "link": "https://stackoverflow.com/users/7420131/ebaybill"}, "edited": false, "score": 0, "creation_date": 1521648284, "post_id": 49398476, "comment_id": 85824081, "body": "QHarr- The error is the Path defaults to a previous Path and doesn&#39;t change when Fnumber changes. This is a shared network drive connected to my router. But it doesn&#39;t have to be if that is the problem.          AcsEmco-  I get nothing if I use the path as above.  If I comment out any of the parts of the Path including the last &amp;&quot;\\&quot;  I get:    Href link for listings.txt   which is a text file I use for my listings, but it is on my C:\\  drive...   I will change my code to use my local drive and will report back.  Thank you both for your time."}, {"owner": {"reputation": 45, "user_id": 7420131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-VRKQCgi4liM/AAAAAAAAAAI/AAAAAAAAESI/IXES2D66lrk/photo.jpg?sz=128", "display_name": "EbayBill", "link": "https://stackoverflow.com/users/7420131/ebaybill"}, "edited": false, "score": 0, "creation_date": 1521660994, "post_id": 49398476, "comment_id": 85831984, "body": "No change with using C:\\.  I did get a Run-time error 52: Bad file name or number,  in the immediate window ."}, {"owner": {"reputation": 45, "user_id": 7420131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-VRKQCgi4liM/AAAAAAAAAAI/AAAAAAAAESI/IXES2D66lrk/photo.jpg?sz=128", "display_name": "EbayBill", "link": "https://stackoverflow.com/users/7420131/ebaybill"}, "edited": false, "score": 0, "creation_date": 1521681640, "post_id": 49398476, "comment_id": 85839596, "body": "I finally got it to work.  I pointed my Fname to my Form!SKU1  instead of my Table [SKU].  Not sure why it works, but it does....  Thanks again QHarr and AcsErno (will save your code) for your time."}], "owner": {"reputation": 45, "user_id": 7420131, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-VRKQCgi4liM/AAAAAAAAAAI/AAAAAAAAESI/IXES2D66lrk/photo.jpg?sz=128", "display_name": "EbayBill", "link": "https://stackoverflow.com/users/7420131/ebaybill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 450, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521608259, "creation_date": 1521608259, "question_id": 49398476, "link": "https://stackoverflow.com/questions/49398476/ms-access-vba-initialfilename-path", "title": "MS Access vba .InitialFileName = Path &amp; &quot;\\&quot;", "body": "<pre><code>Path = \"Z:\\Ebay\\Suppliers Inventory\\\" &amp; Fnumber &amp; \"\\\" &amp; Fname &amp; \"\\\"\n</code></pre>\n\n<p>It works up to the last (&amp; \"\\\") then the Path will fail.  My SKU is (XXX-000001) not sure if the dash is the problem and would be a pain to fix at this late date.  </p>\n\n<pre><code> Dim objFSO As Object\n Dim objFile As Object\n Dim openDialog As FileDialog\n Dim Path As String\n Dim GetPath As String\n Dim Filename As String\n Dim GetFileName As String\n Dim Fname As String\n Dim Fnumber As String\nFnumber = Me.FolderNumber\nFname = [SKU]\nPath = \"Z:\\Ebay\\Suppliers Inventory\\\" &amp; Fnumber &amp; \"\\\" &amp; Fname &amp; \"\\\"\n\nSet openDialog = Application.FileDialog(msoFileDialogFilePicker)\nopenDialog.InitialFileName = Path\nopenDialog.AllowMultiSelect = True\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet openDialog = Application.FileDialog(msoFileDialogFilePicker)\nopenDialog.AllowMultiSelect = False\n        If openDialog.Show Then\n        GetFileName = openDialog.SelectedItems(1)\n    Else\n        GetFileName = \"\"\n    End If\nForms![Items to List].ImageGroup.Form.PicText = GetFileName\nMe.Image2 = GetFileName\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "com"], "comments": [{"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1521613528, "post_id": 49398365, "comment_id": 85800247, "body": "Your code seems ok. That could be related to the way threads work in your app (STA, etc..) But, you should contact the vendor."}, {"owner": {"reputation": 1634, "user_id": 3220424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a3c490767e71fbc3c6334dc5e3c756d?s=128&d=identicon&r=PG&f=1", "display_name": "Sasha", "link": "https://stackoverflow.com/users/3220424/sasha"}, "edited": false, "score": 0, "creation_date": 1521632738, "post_id": 49398365, "comment_id": 85811835, "body": "You could try run the module sub in a different thread, that may help :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 1634, "user_id": 3220424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a3c490767e71fbc3c6334dc5e3c756d?s=128&d=identicon&r=PG&f=1", "display_name": "Sasha", "link": "https://stackoverflow.com/users/3220424/sasha"}, "edited": false, "score": 0, "creation_date": 1521634536, "post_id": 49398365, "comment_id": 85813097, "body": "@Jaxi sorry i didn&#39;t understand very well do you mean seperate opening model process another thread ?"}, {"owner": {"reputation": 1634, "user_id": 3220424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a3c490767e71fbc3c6334dc5e3c756d?s=128&d=identicon&r=PG&f=1", "display_name": "Sasha", "link": "https://stackoverflow.com/users/3220424/sasha"}, "edited": false, "score": 0, "creation_date": 1521635359, "post_id": 49398365, "comment_id": 85813696, "body": "Run <code>Getconnect()</code> in a new thread is what i mean :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 1634, "user_id": 3220424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a3c490767e71fbc3c6334dc5e3c756d?s=128&d=identicon&r=PG&f=1", "display_name": "Sasha", "link": "https://stackoverflow.com/users/3220424/sasha"}, "edited": false, "score": 0, "creation_date": 1521657805, "post_id": 49398365, "comment_id": 85830132, "body": "@Jaxi i think you&#39;re right when i searched on internet about my problem can be solved by multithreading but i didn&#39;t succeeded. Could you please show me as an anser how can i apply your suggestion i can try and vote your answer."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "edited": false, "score": 0, "creation_date": 1521714915, "post_id": 49424168, "comment_id": 85853660, "body": "I tried with the below code using button to start program but it causes the same problem.  <code>Public Class Form1      Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click         Dim NewThread = New System.Threading.Thread(AddressOf Simpack.GetConnect)         NewThread.Start()     End Sub End Class</code>"}, {"owner": {"reputation": 1634, "user_id": 3220424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a3c490767e71fbc3c6334dc5e3c756d?s=128&d=identicon&r=PG&f=1", "display_name": "Sasha", "link": "https://stackoverflow.com/users/3220424/sasha"}, "edited": false, "score": 0, "creation_date": 1521799853, "post_id": 49424168, "comment_id": 85895840, "body": "There may be a problem with the COM interface then in that case"}], "tags": [], "owner": {"reputation": 1634, "user_id": 3220424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a3c490767e71fbc3c6334dc5e3c756d?s=128&d=identicon&r=PG&f=1", "display_name": "Sasha", "link": "https://stackoverflow.com/users/3220424/sasha"}, "is_accepted": false, "score": 0, "last_activity_date": 1521708693, "creation_date": 1521708693, "answer_id": 49424168, "question_id": 49398365, "link": "https://stackoverflow.com/questions/49398365/using-com-interface-in-vb-net/49424168#49424168", "title": "Using COM-Interface in VB.NET", "body": "<p>As requested, how to multithread this :) I'm not sure where your Main() is though so you'll have to replace your current <code>GetConnect()</code> call with the following:</p>\n\n<pre><code>Dim NewThread = New System.Threading.Thread(AddressOf GetConnect)\nNewThread.Start()\n</code></pre>\n\n<p>This should be able to run through fine :)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521708693, "creation_date": 1521607595, "question_id": 49398365, "link": "https://stackoverflow.com/questions/49398365/using-com-interface-in-vb-net", "title": "Using COM-Interface in VB.NET", "body": "<p>I was using VBA platform to connect 3rd part application named Simpack COM-Interface with below code;</p>\n\n<pre><code>Dim Srv As Object\nDim Mdl As Object\nDim modelname As String\n\nSub GetSimpackModel()\nmodelname = \"myModel.spck\"\nSet Srv = CreateObject(\"Simpack.Gui.2018x\")\nSet Mdl = Srv.Spck.openModel(modelname)\nEnd Sub\n</code></pre>\n\n<p>After that i have a chance to use Simpack's own classes in my project.</p>\n\n<p>In VB.NET i'm using below code</p>\n\n<pre><code>Option Explicit On\n\nImports simpackcomguiLib\n\nModule Module1\n\n    Dim Srv As SpckCOMApp                                    'Define SRV variable as SpckCOMApp\n    Dim Mdl As IScrModel                                           'Define Mdl variable as Model\n\n    Sub GetConnect()\n        Srv = New simpackcomguiLib.SpckCOMApp\n        Mdl = Srv.Spck.openModel(\"myModel.spck\")\n    End Sub\nEnd Module\n</code></pre>\n\n<p>This VB.NET code also works, i can open the program from VB.NET and access the Simpack's COM classes.</p>\n\n<p>But when i open the Simpack with VBA, Simpack GUI works properly but when i opened with VB, Simpack's GUI getting freeze.</p>\n\n<p>Do you think is there anything that i missed on COM-connection or am i using a wrong method?</p>\n\n<p>My main question about this topic is; i realized a COM-Class item under Visual Studio. I would like to know if somebody have experience where/when do you recommend to use this ComClass item ?</p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521608299, "post_id": 49398001, "comment_id": 85798325, "body": "With the code <code>List.Add Scn_Data(x, 1), x</code> do you want to keep the first x, the last x or does it matter at all?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1521608530, "post_id": 49398001, "comment_id": 85798404, "body": "The reason I ask is that there is a &#39;shorthand overwrite&#39; method of <code>List(Scn_Data(x, 1)) =  x</code> where it adds the key/item if it doesn&#39;t exist but overwrites the item with the new x if it does exist. No error control necessary nor desired."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1521609125, "post_id": 49398001, "comment_id": 85798542, "body": "it does not matter at all, Thanks @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521610030, "post_id": 49398001, "comment_id": 85798871, "body": "When you <code>Inv_Data = .Range(.Cells(1, 1), .Cells(Inv_LRow, 7)).Value2</code> , Inv_Data  is a v2-D array, e.g. Inv_Data(1 to inv_lrow, 1 to 7) but your subsequent loop only increments the default first rank, e.g. <code>For i = LBound(Inv_Data) To UBound(Inv_Data) Step 1</code> is the same as <code>For i = 1 To Inv_LRow</code> so you never look outside of the first rank, e.g. <code>.Range(.Cells(1, 1), .Cells(Inv_LRow, 1))</code>. I don&#39;t see why you are collecting 7 columns of values into the array."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521610931, "post_id": 49398825, "comment_id": 85799166, "body": "Maybe I misunderstood but @0m3r wasn&#39;t using the x, he was writing back from the the Inv_Data 2-D array if a dictionary match was found in the first rank."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1521611042, "post_id": 49398825, "comment_id": 85799202, "body": "@Jeeped I was re-reading his post too. But seeing the code, <code>x</code> will have its last value after the <code>For</code> statement  + 1 . And so the value will be written at the next empty row if that is the case at <code>SCAN_REPORT</code> sheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1521611218, "post_id": 49398825, "comment_id": 85799253, "body": "Yeah, I sometimes throw trash into the Item just so it doesn&#39;t throw an error when I only want a unique list of keys. I suspect @0m3r may be doing the same."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1521611327, "post_id": 49398825, "comment_id": 85799287, "body": "@Jeeped Ah I get it now, he just needs to add this line <code>x = x + 1</code> in his 2nd loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1521611594, "post_id": 49398825, "comment_id": 85799405, "body": "Ah ... I may have it better. How about <code>SCAN_REPORT.Cells(List.ITEM(Inv_Data(i, 1)), 1).Offset(0, 1).Value2 = Inv_Data(i, 2)</code>"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1521611741, "post_id": 49398825, "comment_id": 85799459, "body": "@Jeeped Haha I actually followed what you wrote in the comments and skipped the <code>Item</code> method and did the shortcut. But see my edit, maybe that is what he really want done. I&#39;ll wait for Om3r to come back. I may be wrong with my assumptions too."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521611890, "post_id": 49398825, "comment_id": 85799525, "body": "I added my latest insight to my post. tbh, I&#39;d much rather write dictionary code from scratch."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1521613176, "post_id": 49398825, "comment_id": 85800093, "body": "The edit example is not going work as <code>x</code> is the last row count, but the first example looks what I&#39;m trying to do- Thank you @L42"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1521613708, "post_id": 49398825, "comment_id": 85800323, "body": "@0m3r Thanks for confirmation. I deleted the edit :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1521616160, "post_id": 49398825, "comment_id": 85801482, "body": "@0m3r - It seems that if you contribute to the SO community. you get the SO community&#39;s help in any way possible. Thanks L42."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1521613683, "last_edit_date": 1521613683, "creation_date": 1521610244, "answer_id": 49398825, "question_id": 49398001, "link": "https://stackoverflow.com/questions/49398001/how-to-referece-dictionary-items-cell-address-correctly/49398825#49398825", "title": "How to referece dictionary items cell address correctly", "body": "<p>You don't have any use for <code>x</code> in your second loop. You need to retrieve the item (which is the row number you denoted as <code>x</code> when dumping values in the dictionary) associated with your <em>key</em>. Something like this might work:</p>\n\n<pre><code>SCAN_REPORT.Cells(List(Inv_Data(i, 1)), 1).Offset(0, 1).Value2 = Inv_Data(i, 2)\n</code></pre>\n\n<p>However, this will only mark or update the last occurrence of data in <code>SCAN_REPORT</code> if you go with what Jeeped suggested in his comment(the shortcut in item overwriting). In your current code though, you will only update the first occurrence.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1521612026, "post_id": 49398918, "comment_id": 85799592, "body": "If there is a type mismatch on <code>List.ITEM(Inv_Data(i, 1))</code> just use a <code>CLng(...)</code> wrapper."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1521613306, "post_id": 49398918, "comment_id": 85800139, "body": "Thank for the confirm @L42, I&#39;m trying to think ahead here as I&#39;m lazy and unwilling to build a complete test workbook."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1521614089, "last_edit_date": 1521614089, "creation_date": 1521610635, "answer_id": 49398918, "question_id": 49398001, "link": "https://stackoverflow.com/questions/49398001/how-to-referece-dictionary-items-cell-address-correctly/49398918#49398918", "title": "How to referece dictionary items cell address correctly", "body": "<p>I added a .CompareMode option and tightened up some code. HTHs.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Example()\n    Dim SCAN_REPORT As Worksheet\n    Set SCAN_REPORT = ActiveWorkbook.Worksheets(\"Scan Report\")\n\n    Dim List As New Scripting.Dictionary\n    List.comparemode = vbTextCompare      '&lt;~~ ADDED!\n\n    With SCAN_REPORT\n        Dim Scn_LRow As Long\n            Scn_LRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        Dim Scn_Data() As Variant\n            Scn_Data = .Range(.Cells(1, 1), .Cells(Scn_LRow, 1)).Value2\n\n        Dim x As Long\n        For x = LBound(Scn_Data) To UBound(Scn_Data) Step 1\n            'Debug.Print Scn_Data(x, 1)\n            List.Item(Scn_Data(x, 1)) = x\n            'Debug.Print Scn_Data(x, 1), x\n        Next\n\n        Dim INVENTORY_REPORT As Worksheet\n        Set INVENTORY_REPORT = ActiveWorkbook.Worksheets(\"WarehouseInventory\")\n\n        With INVENTORY_REPORT\n            Dim Inv_LRow As Long\n                Inv_LRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n            Dim Inv_Data() As Variant\n                Inv_Data = .Range(.Cells(1, 1), .Cells(Inv_LRow, 7)).Value2\n\n            Dim i As Long\n            For i = LBound(Inv_Data, 1) To UBound(Inv_Data, 1)\n                'DoEvents\n\n                If List.Exists(Inv_Data(i, 1)) Then\n                    .Cells(i, 1).Offset(0, 7).Value2 = \"LPN SCANNED\"\n                    'i think this next line correction should resolve things\n                    SCAN_REPORT.Cells(List.ITEM(Inv_Data(i, 1)), 1).Offset(0, 1).Value2 = Inv_Data(i, 2)\n                    'SCAN_REPORT.Cells(List.ITEM(Inv_Data(i, 1)), 1).Offset(0, 2).Value2 = Inv_Data(i, 3)\n                    'SCAN_REPORT.Cells(List.ITEM(Inv_Data(i, 1)), 1).Offset(0, 3).Value2 = Inv_Data(i, 4)\n                Else\n                    .Cells(i, 1).Offset(0, 7).Value = \"LPN NOT SCAN\"\n                End If\n\n            Next\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49398918, "answer_count": 2, "score": 2, "last_activity_date": 1521614089, "creation_date": 1521605154, "question_id": 49398001, "link": "https://stackoverflow.com/questions/49398001/how-to-referece-dictionary-items-cell-address-correctly", "title": "How to referece dictionary items cell address correctly", "body": "<p>How do I copy a value from <code>WarehouseInventory</code> Sheet to <code>Scan Report</code> Sheet if that value exists on <code>dictionary items</code>?</p>\n\n<p>I'm able to compare the values on both Sheets (columns) but having trouble referencing the dictionary items offset cell address.</p>\n\n<hr>\n\n<p><em>Example</em> </p>\n\n<pre><code>If List.Exists(Inv_Data(i, 1)) Then\n    .Cells(i, 1).Offset(0, 7).Value2 = \"LPN SCANNED\"\n     SCAN_REPORT.Cells(x, 1).Offset(0, 1).Value2 = Inv_Data(i, 2)\nElse\n    .Cells(i, 1).Offset(0, 7).Value = \"LPN NOT SCAN\"\nEnd If\n</code></pre>\n\n<hr>\n\n<p><em><code>SCAN_REPORT.Cells(x, 1)</code> is adding the value on the last row</em></p>\n\n<hr>\n\n<pre><code>Option Explicit\nPrivate Sub Example()\n    Dim SCAN_REPORT As Worksheet\n    Set SCAN_REPORT = ActiveWorkbook.Worksheets(\"Scan Report\")\n\n    Dim List As New Scripting.Dictionary\n\n    With SCAN_REPORT\n        Dim Scn_LRow As Long\n            Scn_LRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        Dim Scn_Data() As Variant\n            Scn_Data = .Range(.Cells(1, 1), .Cells(Scn_LRow, 1)).Value2\n\n        Dim x As Long\n        For x = LBound(Scn_Data) To UBound(Scn_Data) Step 1\n            DoEvents\n            Debug.Print Scn_Data(x, 1)\n            On Error Resume Next 'resume if dupe\n            List.Add Scn_Data(x, 1), x\n            On Error GoTo 0\n            Debug.Print Scn_Data(x, 1), x\n        Next\n\n        Dim INVENTORY_REPORT As Worksheet\n        Set INVENTORY_REPORT = ActiveWorkbook.Worksheets(\"WarehouseInventory\")\n\n        With INVENTORY_REPORT\n            Dim Inv_LRow As Long\n                Inv_LRow = INVENTORY_REPORT.Cells(.Rows.Count, 1).End(xlUp).Row\n\n            Dim Inv_Data() As Variant\n                Inv_Data = .Range(.Cells(1, 1), .Cells(Inv_LRow, 7)).Value2\n\n            Dim i As Long\n            For i = LBound(Inv_Data) To UBound(Inv_Data) Step 1\n                DoEvents\n\n                If List.Exists(Inv_Data(i, 1)) Then\n                     .Cells(i, 1).Offset(0, 7).Value2 = \"LPN SCANNED\"\n                    SCAN_REPORT.Cells(x, 1).Offset(0, 1).Value2 = Inv_Data(i, 2)\n'                    SCAN_REPORT.Cells(x, 1).Offset(0, 2).Value2 = Inv_Data(i, 3)\n'                    SCAN_REPORT.Cells(x, 1).Offset(0, 3).Value2 = Inv_Data(i, 4)\n                Else\n                    .Cells(i, 1).Offset(0, 7).Value = \"LPN NOT SCAN\"\n                End If\n\n            Next\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1521605776, "post_id": 49397997, "comment_id": 85797680, "body": "What does &quot;each number should at least be distributed once&quot; mean? Also, what does &quot;randomly distribute numbers from given range of numbers&quot; mean?"}, {"owner": {"reputation": 3, "user_id": 9495125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wl7OqCaMl7I/AAAAAAAAAAI/AAAAAAAAAAo/MJuxbtg4FHc/photo.jpg?sz=128", "display_name": "Lalith Banala", "link": "https://stackoverflow.com/users/9495125/lalith-banala"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1521607082, "post_id": 49397997, "comment_id": 85797998, "body": "suppose i want to distribute (1,1,1,2,3,3,4,5,5,5) in seven cells. So 1,2,3,4,5 should be distributed once atleast"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1521611579, "post_id": 49397997, "comment_id": 85799394, "body": "You&#39;re really not making sense. Changing your description from &quot;each number should at least be distributed once&quot; to &quot;1,2,3,4,5 should be distributed once at least&quot; is just a rewording. It doesn&#39;t explain what you&#39;re trying to do. Can you please explain, in clear detail, what you need?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521617936, "post_id": 49397997, "comment_id": 85802413, "body": "Quick and dirty: remove duplicates from <code>(1,1,1,2,3,3,4,5,5,5)</code> so you get <code>(1,2,3,4,5)</code> write them randomly into 5 desired cells and then pick and fill the last 2 of your 7 cells with random picks from <code>(1,1,1,2,3,3,4,5,5,5)</code>. But you will need to start writing code yourself, no one will do all the work for you."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521618839, "post_id": 49397997, "comment_id": 85802855, "body": "@P\u1d07\u029c - That won&#39;t produce a random arrangement - there would need to be a final random sort. Also, does the OP want to select the final two items from the remaining values or the original set? How should the distribution be formed. The OP hasn&#39;t clearly articulated."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1521620288, "post_id": 49397997, "comment_id": 85803648, "body": "@Enigmativity I know this is not a full solution, I would have had posted it as an answer instead then. But shuffle an array should not be a big deal (you find that several times easily on Google), so I just gave a hint how the &quot;<i>Each number at least once</i>&quot; (what I believe is the actual challenge here) could be solved. And yes the question cannot be answered completely because the OP is not clear about some things as you pointed out correctly. Therefore I only gave that hint so the OP has some idea to start and work with."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1521622147, "post_id": 49397997, "comment_id": 85804634, "body": "random is random - no conditions ... anything that has conditions cannot be random. If the OP provides a set of elements with a weight, a random placement still cannot guarantee that each element is occuring once ... the case that 100x 1 are picked is possible ... that&#39;s the thing about &quot;random&quot; ... if this is not wanted then the task has to be formulated more precisely, avoiding the term &quot;random&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 1, "creation_date": 1521625237, "post_id": 49397997, "comment_id": 85806612, "body": "@MikeD &quot;<i>random is random - no conditions ... anything that has conditions cannot be random</i>&quot; I cannot conclude with this, because if you say &quot;Random number between 1 and 10&quot; I would still consider that as random and it actually has a condition <code>1 \u2264 r \u2264 10</code>. So I think one part of the picking is still randomly picking (even if the total result is not random): Pick <code>n</code> numbers by condition <code>A</code> and then pick additional <code>k</code> numbers randomly, and shuffle them to randomize their position. So the picking is partly random and partly by condition, result is not random, but shuffled (random order)."}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1521642845, "post_id": 49397997, "comment_id": 85819624, "body": "@P\u1d07\u029c tend to agree ... then still the problem definition isn&#39;t crisp ... could be about &quot;random positioning&quot; then, but if we ask for &quot;random picking from the weighted set&quot; we cannot guarantee that each different element is picked at least once"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1521643355, "post_id": 49397997, "comment_id": 85820031, "body": "@MikeD But we can split the issue in 2 smaller issues to ensure that: \u2460 Pick all unique numbers once. \u2461 Pick the rest randomly. <a href=\"https://gist.github.com/pcr-coding/436b0099c0de123287dde94a9eb967e8#file-gistfile1-txt\" rel=\"nofollow noreferrer\">Here is an example</a> (all without laying numbers back to the picking pool)."}], "answers": [{"tags": [], "owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "is_accepted": true, "score": 0, "last_activity_date": 1521625365, "creation_date": 1521625365, "answer_id": 49402838, "question_id": 49397997, "link": "https://stackoverflow.com/questions/49397997/distribute-numbers-from-range-of-numbers/49402838#49402838", "title": "Distribute numbers from range of numbers", "body": "<p>If Peh is on the money then try this:</p>\n\n<pre><code>var numbers = new[] { 1, 1, 1, 2, 3, 3, 4, 5, 5, 5 };\nvar take = 7;\n\nvar lookup = numbers.ToLookup(x =&gt; x);\nvar random = new Random();\nvar result =\n    lookup\n        .SelectMany(x =&gt; x.Take(1))\n        .Concat(lookup.SelectMany(x =&gt; x.Skip(1)).OrderBy(x =&gt; random.Next()))\n        .Take(take)\n        .OrderBy(x =&gt; random.Next())\n        .ToArray();\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9495125, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wl7OqCaMl7I/AAAAAAAAAAI/AAAAAAAAAAo/MJuxbtg4FHc/photo.jpg?sz=128", "display_name": "Lalith Banala", "link": "https://stackoverflow.com/users/9495125/lalith-banala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1521627474, "accepted_answer_id": 49402838, "answer_count": 1, "score": -2, "last_activity_date": 1521625365, "creation_date": 1521605132, "last_edit_date": 1531161705, "question_id": 49397997, "link": "https://stackoverflow.com/questions/49397997/distribute-numbers-from-range-of-numbers", "closed_reason": "Needs more focus", "title": "Distribute numbers from range of numbers", "body": "<p>I need to randomly distribute numbers from given range of numbers.\nFor example - (1,1,1,2,3,3,4,5,5,5) needs to be distributed over a range using vba code .\nAnd each number should atleast be distributed once . </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1521608298, "post_id": 49397954, "comment_id": 85798324, "body": "Is <code>.I Inserted ...</code> an error in copying, or have you actually got that in your code?"}], "answers": [{"tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": true, "score": 0, "last_activity_date": 1521608663, "creation_date": 1521608663, "answer_id": 49398544, "question_id": 49397954, "link": "https://stackoverflow.com/questions/49397954/how-to-replace-an-inputbox-with-a-predifned-range-of-cells-in-excel-vba/49398544#49398544", "title": "How to replace an InputBox with a predifned range of cells in Excel VBA", "body": "<p>Where you have <code>Set WorkRng = ActiveSheet.Range(\"C4:I55\").Select</code> you should have just <code>Set WorkRng = ActiveSheet.Range(\"C4:I55\")</code>.\nIn the first code, you select the ranges (but don't do anything with the selection*). In my amended code, I assign <code>WorkRng</code> to the range that you want - equivalent to what you do with your <code>InputBox</code>.</p>\n\n<p>You also do not need <code>Set WorkRng = Application.Selection</code>. For starters, you are relying on the user having selected something before running the macro.</p>\n\n<p>(*) As a handy hint, should never <code>.Select</code> ranges etc. that you want to manipulate in VBA code because the user could quite easily change your selection on you. If you already know the range you want, just work with that object directly.</p>\n"}], "owner": {"reputation": 3, "user_id": 9526258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1820280691367272/picture?type=large", "display_name": "Felix Joe Jasper", "link": "https://stackoverflow.com/users/9526258/felix-joe-jasper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 49398544, "answer_count": 1, "score": 0, "last_activity_date": 1521608663, "creation_date": 1521604791, "question_id": 49397954, "link": "https://stackoverflow.com/questions/49397954/how-to-replace-an-inputbox-with-a-predifned-range-of-cells-in-excel-vba", "title": "How to replace an InputBox with a predifned range of cells in Excel VBA", "body": "<p>I have vba code snippet which I am trying to modify so that I can automatically color the text in each cell in a predefined range of cells. The code snippet I provides an \"InputBox\" for the user to enter the range, however, I want to replace this prompt in the code with a predefined range so the user is never prompted. Can you kindly point me in the right direction. This is the code I have been working with. Many thanks in advance.</p>\n\n<pre><code>Sub changeTextColor()\nDim rng As Range\nDim WorkRng As Range\nDim xRed As Byte\nDim xGreen As Byte\nDim xBlue As Byte\nOn Error Resume Next\n\nxTitleId = \"Prompt Box\"  'I commented this out prior to running\nSet WorkRng = Application.Selection\n\n.I Inserted this line of code and this is the line where I keep on getting errors\n'Set WorkRng = ActiveSheet.Range(\"C4:I55\").Select\n\n'I commented this out prior to running\nSet WorkRng = Application.InputBox(\"Range\", \"\", WorkRng.Address, Type:=8)\nFor Each rng In WorkRng\nxRed = Application.WorksheetFunction.RandBetween(0, 255)\nxGreen = Application.WorksheetFunction.RandBetween(0, 255)\nxBlue = Application.WorksheetFunction.RandBetween(0, 255)\nrng.Pattern = xlSolid\nrng.PatterColorIndex = xlAutomatic\nrng.Font.Color = VBA.RGB(xRed, xGreen, xBlue)\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 2, "creation_date": 1521613078, "post_id": 49397915, "comment_id": 85800042, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49163778/copying-range-including-formatting-when-pasting-in-outlook-email-body\">Copying range including formatting when pasting in Outlook email body</a>"}], "answers": [{"tags": [], "owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1521617986, "creation_date": 1521617986, "answer_id": 49400655, "question_id": 49397915, "link": "https://stackoverflow.com/questions/49397915/copying-a-certain-cell-range-and-pasting-in-outlook-mail-body/49400655#49400655", "title": "Copying a certain cell range and pasting in outlook mail body", "body": "<p>That's the only idea I had .. using a loop to add every cell value to the bodyMail ..</p>\n\n<pre><code>         xMailBody = \"\"\n        ' i represents the columns\n        For i = 1 To 2\n             xMailBody = xMailBody &amp; \" \" &amp; ActiveSheet.Cells(4, i).Value\n        Next i\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9350889, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/940af8d12807d63038b0a0f5ebfc284c?s=128&d=identicon&r=PG&f=1", "display_name": "D.Trump123", "link": "https://stackoverflow.com/users/9350889/d-trump123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 863, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521617986, "creation_date": 1521604539, "last_edit_date": 1531164843, "question_id": 49397915, "link": "https://stackoverflow.com/questions/49397915/copying-a-certain-cell-range-and-pasting-in-outlook-mail-body", "title": "Copying a certain cell range and pasting in outlook mail body", "body": "<p><strong>My Questions:</strong></p>\n\n<p>Is there any way to copy a cell range and paste it in the outlook mail body programatically? </p>\n\n<p>I have this code, but it doesn't seem to copy the cell range, but if you type in an individual cell (ex. A4), it's able to copy it. </p>\n\n<pre><code>Sub Email()\n   Dim xOutApp As Object\n   Dim xOutMail As Object\n   Dim xMailBody As String\n   Dim szTodayDate As String\n   szTodayDate = Format(Date, \"mm.dd.yyyy\")\n   On Error Resume Next\n   Set xOutApp = CreateObject(\"Outlook.Application\")\n   Set xOutMail = xOutApp.CreateItem(0)\n   xMailBody = ActiveSheet.Range(\"A4:B4\").Value\n              On Error Resume Next\n  With xOutMail\n    .To = \"tryemail@gmail.com\"\n    .CC = \"tryemail2@gmail.com\"\n    .BCC = \"\"\n    .Subject = \"Schedule for deal pursuit\" &amp; \" \" &amp; szTodayDate\n    .Body = xMailBody\n    .Display   'or use .Send\nEnd With\nOn Error GoTo 0\nSet xOutMail = Nothing\nSet xOutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1521838155, "post_id": 49397526, "comment_id": 85919155, "body": "What did you think of my answer?  Did it work, or was I wrong to assume you only needed the <code>Unprotect</code> command?"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5197684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HcXj1.jpg?s=128&g=1", "display_name": "Emman D.", "link": "https://stackoverflow.com/users/5197684/emman-d"}, "edited": false, "score": 0, "creation_date": 1522137675, "post_id": 49397996, "comment_id": 86018828, "body": "I tried this however the routine gives a run-time error 1004 even after using the &#39;On Error&#39; statement. I googled this behavior and found this post: <a href=\"https://stackoverflow.com/questions/21176638/vba-how-to-force-ignore-continue-past-1004-error\" title=\"vba how to force ignore continue past 1004 error\">stackoverflow.com/questions/21176638/&hellip;</a>"}, {"owner": {"reputation": 117, "user_id": 5197684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HcXj1.jpg?s=128&g=1", "display_name": "Emman D.", "link": "https://stackoverflow.com/users/5197684/emman-d"}, "edited": false, "score": 0, "creation_date": 1522138585, "post_id": 49397996, "comment_id": 86019433, "body": "Thanks also for teaching me the .Unprotect method. Will be updating my code to use this, however for a quick solution I just used the opening and closing methods."}], "tags": [], "owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "is_accepted": false, "score": 2, "last_activity_date": 1521605126, "creation_date": 1521605126, "answer_id": 49397996, "question_id": 49397526, "link": "https://stackoverflow.com/questions/49397526/excel-vba-to-open-a-workbook-by-testing-multiple-passwords/49397996#49397996", "title": "excel vba to open a workbook by testing multiple passwords", "body": "<p>Once the file has been opened once, you only need to <code>Unprotect</code> it.  This will save a lot of time, instead of constantly opening/closing workbooks.  </p>\n\n<p>Here's how I'd do it:</p>\n\n<pre><code>Public Sub CrackWorkbook()\n    Dim fn As String\n    fn = \"C:\\Temp\\test_password_is_456.xlsx\"\n\n    Dim wb As Workbook\n    Set wb = Workbooks.Open(fn)\n\n    Dim lst As Variant\n    lst = Array(\"123\", \"456\", \"789\")\n\n    Dim item As Variant\n    For Each item In lst\n        On Error GoTo did_not_work\n        Call wb.Unprotect(item)\n        Call wb.Save\n        Call wb.Close(False)\n        Exit Sub\ndid_not_work:\n        On Error GoTo 0\n    Next item\nEnd Sub\n</code></pre>\n\n<p>In other words, create an array of strings and do a <code>For Each</code> on them, and set some error-handling to deal with all the failed attempts.</p>\n\n<p>I know <code>GoTo</code> statements are a bit yucky, but that's the best way to handle errors in VBA (as far as I know).</p>\n"}, {"comments": [{"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 1, "creation_date": 1522196648, "post_id": 49507650, "comment_id": 86054442, "body": "I&#39;m glad you found your answer and I was able to (indirectly) help :)"}], "tags": [], "owner": {"reputation": 117, "user_id": 5197684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HcXj1.jpg?s=128&g=1", "display_name": "Emman D.", "link": "https://stackoverflow.com/users/5197684/emman-d"}, "is_accepted": true, "score": 1, "last_activity_date": 1522138428, "creation_date": 1522138428, "answer_id": 49507650, "question_id": 49397526, "link": "https://stackoverflow.com/questions/49397526/excel-vba-to-open-a-workbook-by-testing-multiple-passwords/49507650#49507650", "title": "excel vba to open a workbook by testing multiple passwords", "body": "<p>I tried @lebelinoz answer however the routine gives a 1004 error. I googled this behavior and found this post:\n<a href=\"https://stackoverflow.com/questions/21176638/vba-how-to-force-ignore-continue-past-1004-error/\" title=\"vba - how to force ignore/continue past 1004 error\">https://stackoverflow.com/questions/21176638/vba-how-to-force-ignore-continue-past-1004-error</a></p>\n\n<p>The code below works by using <code>On Error Resume Next</code>. I based this on @lebelinoz answer.</p>\n\n<pre><code>Public Sub CrackWorkbook()\nDim fn As String\nfn = \"C:\\Temp\\test_password_is_456.xlsx\"\n\nDim wb As Workbook\nDim item As Variant\nDim lst As Variant\n\nlst = Array(\"123\", \"456\", \"789\")\n\nFor Each item In lst\n    On Error Resume Next\n    Workbooks.Open Filename:=fn, Password:=item\nIf Err.Number &lt;&gt; 0 Then GoTo did_not_work:\n    Exit For\n\ndid_not_work:\n    Next item\nSet wb = Activeworkbook\nwb.SaveAs Filename:=fn, Password:=\"\"\nwb.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5197684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HcXj1.jpg?s=128&g=1", "display_name": "Emman D.", "link": "https://stackoverflow.com/users/5197684/emman-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 49507650, "answer_count": 2, "score": 0, "last_activity_date": 1522138428, "creation_date": 1521602142, "last_edit_date": 1521605020, "question_id": 49397526, "link": "https://stackoverflow.com/questions/49397526/excel-vba-to-open-a-workbook-by-testing-multiple-passwords", "title": "excel vba to open a workbook by testing multiple passwords", "body": "<p>I have password-protected .xls files in a directory. I would like to open each of these files and save them without the password.</p>\n\n<p>However, the files can be opened by using either of the sample passwords listed below. </p>\n\n<pre><code>pwd1 = \"123\"\npwd2 = \"456\"\npwd3 = \"789\"\n\n'Check if pwd1 opens\nApplication.Workbooks.Open(Filename:=fn, Password:=pwd1)\n\n'If fail then use pwd2\nApplication.Workbooks.Open(Filename:=fn, Password:=pwd2)\n\n'and so on..\n</code></pre>\n\n<p>How should I implement this?</p>\n"}, {"tags": ["vba", "ms-word", "formatting", "activex"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5266309, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/RHteE.png?s=128&g=1", "display_name": "Dan W", "link": "https://stackoverflow.com/users/5266309/dan-w"}, "edited": false, "score": 0, "creation_date": 1521678212, "post_id": 49404012, "comment_id": 85838885, "body": "Thanks Cindy. 1 was exactly what I needed. With 2 I found that you can modify the layout using Format Controls when you right-click the object in Developer Mode."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1521628545, "creation_date": 1521628545, "answer_id": 49404012, "question_id": 49397480, "link": "https://stackoverflow.com/questions/49397480/word-2010-activex-control-forms-formatting-issues/49404012#49404012", "title": "Word 2010 ActiveX control forms - formatting issues", "body": "<p>(1) Press Alt+F9 to toggle off display of field codes (and make sure you're not in Design Mode). </p>\n\n<p>(2) is impossible to be sure without having the document in front of me but... </p>\n\n<p>Printing problems are notorious with ActiveX controls, which were designed for use with UserForms, not for the document surface. Your best bet for stability would be to use a one-row, two-column table with the button on the left and the address on the right. </p>\n\n<p>Or use a MacroButton field code instead of an ActiveX control.</p>\n"}], "owner": {"reputation": 123, "user_id": 5266309, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/RHteE.png?s=128&g=1", "display_name": "Dan W", "link": "https://stackoverflow.com/users/5266309/dan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 49404012, "answer_count": 1, "score": 0, "last_activity_date": 1521628598, "creation_date": 1521601760, "last_edit_date": 1521628598, "question_id": 49397480, "link": "https://stackoverflow.com/questions/49397480/word-2010-activex-control-forms-formatting-issues", "title": "Word 2010 ActiveX control forms - formatting issues", "body": "<p>Hopefully a quick one</p>\n\n<p>I am creating a form in Word with a Save macro that uses an ActiveX Label as a button. The label works fine as a button but I am having 2 issues:</p>\n\n<ol>\n<li>when using the document in normal mode, the coding text in curly brackets for the label is still visible - see image</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/LC74g.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LC74g.gif\" alt=\"enter image description here\"></a></p>\n\n<p>How do I get rid of this?</p>\n\n<ol start=\"2\">\n<li>When printing the form, the button pushes the header text down a line:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/Q86uj.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q86uj.gif\" alt=\"enter image description here\"></a></p>\n\n<p>You can see in the first picture that there is no gap here.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["vba", "powerpoint", "readonly"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1521602189, "post_id": 49397473, "comment_id": 85796774, "body": "Do you know the password? If not then no you certainly can&#39;t do anything with it"}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1521639642, "post_id": 49397473, "comment_id": 85816972, "body": "Thanks for your response. Yes, it\u2019s my own password and PPT. Though I want to make it for people who don\u2019t and will not have the password. I want them to use the macros, but not unlock."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1521690031, "post_id": 49397473, "comment_id": 85841563, "body": "First see if your code works on a non read-only PPT without a password. Is the macro <i>inside</i> the read only pwd protected document, or is it external? ready/only and pwd protection is not serious protection. It&#39;s easy to crack"}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1521780483, "post_id": 49397473, "comment_id": 85886814, "body": "Yes the macro works otherwise. It&#39;s internal, as in it can be viewed within the developer tab VBA coding view-sheet. Is there a way of accomplishing what I&#39;m after by making the VBA code external??"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1521781743, "post_id": 49397473, "comment_id": 85887206, "body": "Yes you can make your code external. For example you can create a compiled VB6 app. You can create in in .Net (using COM Interop). You could do it in VBScript. You could put it in a seperate Excel file. Any language that can use COM objects. So is it the read only aspect or the password aspect that is causing the error? Narrow it down. You should understand that it is trivial to overcome Office password protection. It&#39;s not a real protection method."}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1521855389, "post_id": 49397473, "comment_id": 85923649, "body": "Good point. I know very little about hacking, but I see what you mean. Why go to all the trouble to lock it up when someone can just use a metaphorical bolt-cutter. I believe I can it\u2019s the Read-only aspect that is my problem."}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1521855447, "post_id": 49397473, "comment_id": 85923659, "body": "You said some things above that I don\u2019t quite understand. I\u2019m going to research them and try to apply. Thank you for your time ^_______^"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521639811, "post_id": 49403698, "comment_id": 85817106, "body": "Thank you for your answer. The problem is that I want others to use the PPT. To run it and use the macros therein and even save, but not unlock, not be able to open edit mode. Can a VBA Code be set for permission to run in a Read-only file? I don\u2019t know..."}, {"owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "reply_to_user": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521640362, "post_id": 49403698, "comment_id": 85817566, "body": "I&#39;m not aware of it being possible, others might be able to help. Of course if you elaborate on why it is so important to do it this way there may be an alternative. For example if you don&#39;t want people to know the password, you can use a macro to enter the password, do what you want it to do then lock it again after."}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521684981, "post_id": 49403698, "comment_id": 85840372, "body": "In short, it\u2019s a sort of educational game we will be selling (sort of). We have licensed much of the visual content inside, but if the ppt isn\u2019t locked we will be breaching our licensing contract (because others will be able to extract the content within)"}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521685202, "post_id": 49403698, "comment_id": 85840424, "body": "So is it possible to say... click on a button that runs a VBA macro with a password, and also locks it automatically afterward? The thing is, I won\u2019t be around when the players are using the ppt. So it all has to be automatic. Whatever the method, it can\u2019t rely on me being there to manually \u2018lock\u2019 it back up. The macros would have to alter the ppt on their own, within a ppt that can\u2019t be opened in edit mode (well...not legally opened in edit mode)"}, {"owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "reply_to_user": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521717787, "post_id": 49403698, "comment_id": 85855735, "body": "I see. Yes it is possible to do what you just described, though whether or not it would be a breach of your licensing contract, well I wouldn&#39;t like to comment. Ultimately to do what you are describing the password would have to be stored either within your macro or in a very hidden sheet for example."}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521780378, "post_id": 49403698, "comment_id": 85886785, "body": "So are you saying I could have the macro insert the password to unlock edit, and run the code, and then re-lock to read-only all in one click?  Like just clicking on an object during presentation?                            How can I accomplish this. That coding is unfamiliar to me..."}, {"owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "reply_to_user": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521795365, "post_id": 49403698, "comment_id": 85892967, "body": "You will have to do some <a href=\"https://www.mrexcel.com/forum/excel-questions/1015613-excel-vba-open-password-protected-power-point-presentation.html\" rel=\"nofollow noreferrer\">research</a>, it won&#39;t be a trivial task. Noone on stackoverflow will write it for you, you have to try yourself and ask when you get stuck."}, {"owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "edited": false, "score": 0, "creation_date": 1521855656, "post_id": 49403698, "comment_id": 85923695, "body": "I\u2019ve been investigating this problem for months and months. I\u2019m not so much looking for someone to write it for me (though that would be welcomed lol) as much as I am looking to see if someone would just say, \u201cDude that\u2019s not possible.\u201d However, for better or worse you\u2019ve rekindled my hope  ^_________^   I will research the methods you\u2019ve alluded to above. Thank you for your valuable time."}], "tags": [], "owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1521627683, "creation_date": 1521627683, "answer_id": 49403698, "question_id": 49397473, "link": "https://stackoverflow.com/questions/49397473/is-it-possible-to-run-a-vba-macro-in-a-read-only-protected-powerpoint/49403698#49403698", "title": "Is it possible to run a VBA macro in a READ-ONLY protected PowerPoint?", "body": "<p>Perhaps as a work around you could save a copy of the original read only presentation, run your macro on the new version and then save the new version as read only?</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 11158543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a367a87c8b9f0787eee934e8494312?s=128&d=identicon&r=PG&f=1", "display_name": "V.Hunon", "link": "https://stackoverflow.com/users/11158543/v-hunon"}, "is_accepted": false, "score": 0, "last_activity_date": 1574311601, "creation_date": 1574311601, "answer_id": 58967468, "question_id": 49397473, "link": "https://stackoverflow.com/questions/49397473/is-it-possible-to-run-a-vba-macro-in-a-read-only-protected-powerpoint/58967468#58967468", "title": "Is it possible to run a VBA macro in a READ-ONLY protected PowerPoint?", "body": "<p>Hello this might be too late but if I understand you correctly, you want that other users can read, execute macros but not able to read the code behind it. Saving should be okay.</p>\n\n<ol>\n<li>The macro that you used should be password protected. First go to the editor, select the macro and view the properties/protection and set up a password</li>\n<li>Then after you are done, close the file. Right Click on the file/properties and check readonly. Users will then have access to the macro, not being able to see what code is behind it and can save it.</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 9526136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BGtY9.jpg?s=128&g=1", "display_name": "Madpoet88", "link": "https://stackoverflow.com/users/9526136/madpoet88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2817, "favorite_count": 0, "accepted_answer_id": 49403698, "answer_count": 2, "score": 0, "last_activity_date": 1582096773, "creation_date": 1521601723, "last_edit_date": 1582096773, "question_id": 49397473, "link": "https://stackoverflow.com/questions/49397473/is-it-possible-to-run-a-vba-macro-in-a-read-only-protected-powerpoint", "title": "Is it possible to run a VBA macro in a READ-ONLY protected PowerPoint?", "body": "<p>My colleague and I have been on a six month quest for a VBA macro that can run in a Read-Only, password protected PowerPoint.</p>\n\n<p>Is it possible or will PowerPoint always block the VBA macro from running in the presentation, because of the read-only status?</p>\n\n<pre><code>Private Sub CheckBox1_Click()\nDim ppShp As Shape\nDim eff1 As Effect\nDim ani1 As AnimationBehavior\nWith ActivePresentation.Slides(1)\n    Set ppShp = .Shapes(\"Oval 4\")\n    Set eff1 = .TimeLine.MainSequence.AddEffect(Shape:=ppShp, effectId:=msoAnimEffectAppear)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I tried using <code>If ReadOnly = True Then</code> conditions.</p>\n\n<p>I want the user to use the macros and save, but not edit beyond that, or to open and 'look under the hood'.</p>\n\n<p>(It's all for an educational program)</p>\n\n<p>We get</p>\n\n<blockquote>\n  <p>Run-time error '-2147467259 (80004005)'<br>\n  Presentation (unknown member) : Invalid request.  Presentation cannot be modified.</p>\n</blockquote>\n"}, {"tags": ["vba", "pdf", "text-files"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521597578, "post_id": 49396929, "comment_id": 85795683, "body": "<b>First put <code>Option Explicit</code> at the top of your module</b> and then compile (F9) to make sure everything&#39;s properly declared."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521598308, "post_id": 49396929, "comment_id": 85795870, "body": "Also, is Reader opening visibly? Are you sure it&#39;s opening the correct file?  Confirm by putting a line <code>MsgBox fileName</code>  just before the line that&#39;s causing the error"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521598903, "post_id": 49396929, "comment_id": 85796020, "body": "I have inserted and the new code as below but it still show the same message."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521598954, "post_id": 49396929, "comment_id": 85796032, "body": "What does the <code>MsgBox</code> say when it pops up before the error occurs?  (I&#39;m trying to confirm that you&#39;re filename is correct in the variable.)"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521599100, "post_id": 49396929, "comment_id": 85796052, "body": "the msgbox works when i removed my files in the folder. so for the first part of the coding it works fine.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521599583, "post_id": 49396929, "comment_id": 85796179, "body": "what do you mean <code>the msgbox works</code>?  What does it display?  And what do you mean <code>when i removed my files in the folder</code>?  What files? Which folder?"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521599962, "post_id": 49396929, "comment_id": 85796267, "body": "for pdf files in .sfolder. Msgbox &quot;no files were found&quot; was displaying fine."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601297, "post_id": 49396929, "comment_id": 85796557, "body": "What?  I suggested (above) that you add a new line: <code>MsgBox fileName</code> <b>just before</b> the line that the error occurs on (<code>Set jsObj = AcroXPDDoc.GetJSObject</code>).  The Msgbox should pop up the name of a file.  <b>If there is no filename displayed then there is no PDF file to open, which is why you are getting the error.</b>  (You can&#39;t <b>convert &quot;no file&quot; to text</b>!)"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601537, "post_id": 49396929, "comment_id": 85796607, "body": "ok i did what u said and the <code>msgbox</code> shows.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601600, "post_id": 49396929, "comment_id": 85796627, "body": "Does it show a filename?? or is it blank??"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601705, "post_id": 49396929, "comment_id": 85796655, "body": "It&#39;s blank, right?  You said you&#39;re trying to <b><i><code>convert multiple pdf file in a folder </code></i></b>  but <i>it can&#39;t find a filename</i>"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601719, "post_id": 49396929, "comment_id": 85796662, "body": "my bad.. its showing blank. so i need to resolved this."}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601743, "post_id": 49396929, "comment_id": 85796669, "body": "i have files in the folder.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601772, "post_id": 49396929, "comment_id": 85796674, "body": "in which folder??\\"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601854, "post_id": 49396929, "comment_id": 85796693, "body": "inside .sfolder which are all pdf files.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521601899, "post_id": 49396929, "comment_id": 85796705, "body": "are the files listed in Column A of the worksheet right now?"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521602006, "post_id": 49396929, "comment_id": 85796727, "body": "Yes there are.. ok I have change <code>AcroXAVDoc.Open Filename, &quot;Acrobat&quot;</code> to <code>AcroXAVDoc.Open sFilename, &quot;Acrobat&quot;</code> and it shows the first file on column A.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1521602168, "post_id": 49396929, "comment_id": 85796768, "body": "I&#39;ll start an answer below"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "edited": false, "score": 0, "creation_date": 1521603500, "post_id": 49397574, "comment_id": 85797095, "body": "ashleedawg, appreciate your time explaining it in detail.. I have tried the part on converting the pdf to text and it works.. so how do I troubleshoot from here?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "edited": false, "score": 0, "creation_date": 1521604436, "post_id": 49397574, "comment_id": 85797319, "body": "see my answer.  now you trying listing the files (WITHOUT converting the PDF)"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "edited": false, "score": 0, "creation_date": 1521616514, "post_id": 49397574, "comment_id": 85801668, "body": "Greatly appreciate it! the 2 codes work great and i manage to list the file in another column! but how to I merge them to work? didn&#39;t manage to do it.."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1521605269, "last_edit_date": 1521605269, "creation_date": 1521602397, "answer_id": 49397574, "question_id": 49396929, "link": "https://stackoverflow.com/questions/49396929/vba-converting-multiple-pdf-in-folder-to-text-file/49397574#49397574", "title": "vba converting multiple pdf in folder to text file", "body": "<p>I think I'm starting to understand your problem and it has nothing to do with Adobe.  Your code to list the files is not working properly.  </p>\n\n<p>For one thing, you're combining 2 different methods of listing files.  (<code>Dir</code> and <code>FileSystemObject</code>s are not used together.</p>\n\n<p>Also why are you listing the files on the sheet and then getting the name from the sheet?</p>\n\n<p>I mistakenly assumed that you had followed the <a href=\"https://stackoverflow.com/help/mcve\">steps in the FAQ about postings example</a>.  A <strong>Minimal, Complete, and Verifiable example</strong>.  </p>\n\n<hr>\n\n<p>When you're having a problem with a section if your code, you need to <strong>Start Over From Scratch</strong>  </p>\n\n<blockquote>\n  <p>Create a new program, adding in only what is needed to see the problem. This can be faster for vast systems where you <em>think</em> you already know the source of the problem.</p>\n</blockquote>\n\n<p>So, first see if your code to convert the PDF works BY ITSELF:</p>\n\n<pre><code>Sub ONLYConvertPDF()\n\n    Dim AcroXApp As Acrobat.acroApp\n    Dim AcroXAVDoc As Acrobat.AcroAVDoc\n    Dim AcroXPDDoc As Acrobat.AcroPDDoc\n\n    Dim Filename As String, DFilename As String, jsObj As Object\n\n    Filename = \"C:\\users\\chanhc\\desktop\\test folder\\__ENTER_FILENAME__.PDF\"  '&lt;&lt;ENTER A FILEMNAME HERE\n    DFilename = \"C:\\users\\chanhc\\desktop\\test folder after\\TEST_OUTPUT_FILE.TXT\"\n    Set AcroXApp = CreateObject(\"AcroExch.App\")\n    AcroXApp.Show  \n    Set AcroXAVDoc = CreateObject(\"AcroExch.AVDoc\")\n    AcroXAVDoc.Open Filename, \"Acrobat\"\n    Set AcroXPDDoc = AcroXAVDoc.GetPDDoc\n    Set jsObj = AcroXPDDoc.GetJSObject\n    jsObj.SaveAs DFilename, \"com.adobe.acrobat.plain-text\"\n\n    AcroXAVDoc.Close False\n    AcroXApp.Hide\n    AcroXApp.Exit\n\nEnd Sub\n</code></pre>\n\n<p>Replace the string to give <code>FileName</code> the name of one existing file.  Run the code.  Does it work?  Did it convert the file?</p>\n\n<blockquote>\n  <p>Besides taking out all code that wasn't for converting the PDF, I also uncommented <code>AcroXApp.Show</code>...  You should <strong>never</strong> hide something you're troubleshooting!  Also, I'm not sure why you were using <code>Variant</code> for <code>String</code>s but I changed those too.</p>\n</blockquote>\n\n<hr>\n\n<p><strong>Once the above works fine by itself</strong> then we work on troubleshooting the next step: looping through the files one at a time.</p>\n\n<p>Instead of trying to explain what what wrong with that section of your code, I wrote you a simpler procedure to loop through the source folder, return all the filenames along with what the destination filename will be.</p>\n\n<p><strong>It doesn't convert anything, it just pretends to for now.</strong></p>\n\n<pre><code>Option Explicit\n\nSub TEST_ListFiles()\n\n    Const sPath = \"C:\\users\\chanhc\\desktop\\test folder\\\"\n    Const sExt = \".pdf\"\n    Const dPath = \"C:\\users\\chanhc\\desktop\\test folder after\\\"\n    Const dExt = \".txt\"\n\n    Dim sName As String, dName As String, fCount As Long\n\n    'loop through all files in source\n    sName = Dir(sPath &amp; \"*\" &amp; sExt)\n\n    Do While sName &lt;&gt; \"\"\n        fCount = fCount + 1\n\n        'we have sName. Now figure out dName\n        dName = Left(sName, InStrRev(sName, \".\") - 1) &amp; dExt\n\n        'This will be the spot where you convert the PDF's to text, but NOT UNTIL\n        'this code lists all the files properly, we can add it the other code to\n        'actually convert the PDF's (which we know is working since we tested is BY ITSELF.)\n\n        'For TESTING we will ONLY show the name is a msgbox:\n        MsgBox \"Converting PDF File #\" &amp; fCount &amp; \": \" &amp; vbLf &amp; _\n                sPath &amp; sName &amp; \" -&gt; \" &amp; dPath &amp; dName\n\n\n        'find the next file\n        sName = Dir\n    Loop\n\n    MsgBox \"Found \" &amp; fCount &amp; \" files.\"\nEnd Sub\n</code></pre>\n\n<p>Once that section functions properly by itself, you can add the two pieces of code together.</p>\n\n<hr>\n\n<p>Once the above procedure is properly listing the source and destination, we can <strong><em>think</em></strong> about putting them together.</p>\n\n<p>I <em>think</em>, that actually, in order to keep these nice, neat procedures separate, let's change the first one like this:</p>\n\n<p>It will be stand-alone, and take the parameters for sFile &amp; dFile, and we can call it each time we want to convert a file.</p>\n\n<pre><code>Sub ConvertOnePDF(sFile As String, dFile As String)\n\n    Dim AcroXApp As Acrobat.acroApp, AcroXAVDoc As Acrobat.AcroAVDoc\n    Dim AcroXPDDoc As Acrobat.AcroPDDoc, jsObj As Object\n\n    Set AcroXApp = CreateObject(\"AcroExch.App\")\n    'AcroXApp.Show\n    Set AcroXAVDoc = CreateObject(\"AcroExch.AVDoc\")\n    AcroXAVDoc.Open sFile, \"Acrobat\"\n    Set AcroXPDDoc = AcroXAVDoc.GetPDDoc\n    Set jsObj = AcroXPDDoc.GetJSObject\n    jsObj.SaveAs dFile, \"com.adobe.acrobat.plain-text\"\n\n    AcroXAVDoc.Close False\n    AcroXApp.Hide\n    AcroXApp.Exit\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Once you have the two procedures working , you can add this under the MsgBox in <code>Test_Listfiles</code>:</p>\n\n<pre><code>ConvertOnePDF sName, dName\n</code></pre>\n\n<p>and that should be it!</p>\n"}], "owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3695, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521605269, "creation_date": 1521597317, "last_edit_date": 1521599056, "question_id": 49396929, "link": "https://stackoverflow.com/questions/49396929/vba-converting-multiple-pdf-in-folder-to-text-file", "title": "vba converting multiple pdf in folder to text file", "body": "<p>I was trying to run a vba to convert multiple pdf file in a folder into txt file in another folder. however, I encountered the following error which I was not able to resolve. </p>\n\n<p>The error is at Set jsObj = AcroXPDDoc.GetJSObject which gave me a runtime error 91: \"Object variable or With block variable not set\"    </p>\n\n<p>Can anyone help?\nThanks.</p>\n\n<p>:Updated with new code</p>\n\n<pre><code>Option Explicit\n\nSub convertpdf5()\n\n Dim AcroXApp As Acrobat.acroApp\n Dim AcroXAVDoc As Acrobat.AcroAVDoc\n Dim AcroXPDDoc As Acrobat.AcroPDDoc\n Dim Filename As Variant\n Dim jsObj As Object\n Dim sfolder As String\n Dim dfolder As String\n Dim spath As String\n Dim dpath As String\n Dim SFilename As Variant\n Dim DFilename As Variant\n Dim objFolder As folder\n Dim objFile As file\n Dim NextRow As Long\n\nsfolder = \"C:\\users\\chanhc\\desktop\\test folder\\\"\nspath = sfolder &amp; \"*.pdf\"\nSFilename = Dir(spath)\n\ndfolder = \"C:\\users\\chanhc\\desktop\\test folder after\\\"\ndpath = dfolder &amp; \"*.txt\"\nDFilename = Dir(dpath)\n\n'Creating a FileSystemObject\nDim fso As New FileSystemObject\n'Specify the path of the folder\n'Create the object of this folder\nSet objFolder = fso.GetFolder(sfolder)\n'Check if the folder is empty or not\nIf objFolder.Files.count = 0 Then\n  MsgBox \"No files were found...\", vbExclamation\n  Exit Sub\n\nEnd If\n\nNextRow = ActiveSheet.Cells(Rows.count, \"A\").End(xlUp).Row + 1\n\nFor Each objFile In objFolder.Files\n\nCells(NextRow, 1).Value = sfolder &amp; objFile.Name\n\nNextRow = NextRow + 1\n\nNext objFile\n\nFor Each Filename In Sheet1.Range(\"a2:a4\")\n\n Set AcroXApp = CreateObject(\"AcroExch.App\")\n 'AcroXApp.Show\n Set AcroXAVDoc = CreateObject(\"AcroExch.AVDoc\")\n AcroXAVDoc.Open Filename, \"Acrobat\"\n Set AcroXPDDoc = AcroXAVDoc.GetPDDoc\n Set jsObj = AcroXPDDoc.GetJSObject\n jsObj.SaveAs DFilename, \"com.adobe.acrobat.plain-text\"\n\n\n AcroXAVDoc.Close False\n AcroXApp.Hide\n AcroXApp.Exit\n\nNext Filename\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1521594836, "post_id": 49396542, "comment_id": 85794993, "body": "SO is not a code demanding site. Basically you can have 2 buttons (1 for AddTask, 1 for Completed), have them dynamically moved via <code>Worksheet_SelectionChange</code> event, and possibly have &quot;Completed&quot; hidden if not Added to Task before, and hide &quot;AddTask&quot; if already added."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 9, "user_id": 9525790, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Farm", "link": "https://stackoverflow.com/users/9525790/john-farm"}, "edited": false, "score": 0, "creation_date": 1521606870, "post_id": 49396707, "comment_id": 85797941, "body": "@John which part is confusing?"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1521595400, "creation_date": 1521595400, "answer_id": 49396707, "question_id": 49396542, "link": "https://stackoverflow.com/questions/49396542/assign-macro-to-button-that-executes-the-macro-on-the-designated-row-of-where-th/49396707#49396707", "title": "Assign macro to button that executes the macro on the designated row of where the button is located.=", "body": "<p>You can use <code>Application.Caller</code> to determine what called a Sub.  In the case of a Form button it returns the name of the button as a string.  (Refer online help for full details).  Then use the ActiveSheet Buttons collection to retrieve the button, and TopLeftCell to get the location on the sheet.  Error handling is required to gracefully exit if the Sub is called from other sources.</p>\n\n<pre><code>Sub Complete()\n    Dim rng As Range\n\n    If TypeName(Application.Caller) &lt;&gt; \"String\" Then Exit Sub\n    On Error Resume Next\n        Set rng = ActiveSheet.Buttons(Application.Caller).TopLeftCell.EntireRow\n    On Error GoTo 0\n    If rng Is Nothing Then Exit Sub\n\n    ' rng now refers to the row that the clicked button is on\n    '... rest of your code\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9525790, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Farm", "link": "https://stackoverflow.com/users/9525790/john-farm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521595400, "creation_date": 1521594052, "question_id": 49396542, "link": "https://stackoverflow.com/questions/49396542/assign-macro-to-button-that-executes-the-macro-on-the-designated-row-of-where-th", "title": "Assign macro to button that executes the macro on the designated row of where the button is located.=", "body": "<p>I need help with VBA with a code where a button pressed executes the assigned macro, where the macro is assigned to execute where the button was pressed.</p>\n\n<p>Basically, I created a tracking workbook where I usually input a new \"task\" via macros, this adds a new row and a new button by the row.</p>\n\n<p>The problem I am having is that I want to use the same macro (once task is completed, it cuts and pastes into a \"history\" sheet) for the specific row a button is located.</p>\n\n<p>How can I do this? Is this actually possible? Below is the step by step of my thoughts</p>\n\n<ul>\n<li>Press \"AddTask\" button = creates a new row with data input from user with \"Completed\" button on the same row </li>\n<li>Tie the \"Completed\" button to the row that was added so when Macro \"Complete\" runs, it will only run specifically to the row of where the button was pushed.</li>\n</ul>\n\n<p>This will help because maybe I finish task# 53 (row 53) first before task# 41 (row 41), so I want to delete row 53.</p>\n\n<p>Macros and VBA is what I need.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521593421, "post_id": 49396218, "comment_id": 85794654, "body": "What formula? Try <code>If Intersect(Target, Range(&quot;A:D&quot;)) Is Nothing Then Exit Sub</code>, then another similar line but with <code>Range(&quot;F:V&quot;)</code>, etc."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9525722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b8bb56e34f24b56427b3326cfcde73?s=128&d=identicon&r=PG&f=1", "display_name": "sara", "link": "https://stackoverflow.com/users/9525722/sara"}, "edited": false, "score": 0, "creation_date": 1521596688, "post_id": 49396449, "comment_id": 85795463, "body": "OMG i cannot believe it was so easy. haha. thank you so much. you  are great"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 59, "user_id": 9525722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b8bb56e34f24b56427b3326cfcde73?s=128&d=identicon&r=PG&f=1", "display_name": "sara", "link": "https://stackoverflow.com/users/9525722/sara"}, "edited": false, "score": 0, "creation_date": 1521598891, "post_id": 49396449, "comment_id": 85796018, "body": "@sara Not a problem. Btw, <a href=\"https://stackoverflow.com/help/someone-answers\">this is how we say thank you in StackOverflow</a>."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1521593511, "creation_date": 1521593511, "answer_id": 49396449, "question_id": 49396218, "link": "https://stackoverflow.com/questions/49396218/beforedoubleclick-and-intersect/49396449#49396449", "title": "BeforeDoubleClick and Intersect", "body": "<p>You can either try to use <code>Union</code>. Something like:</p>\n\n<pre><code>Dim r As Range\nSet r = Union(Range(\"A6:D150\"),Range(\"F6:V150\"),Range(\"AA6:AC150\"))\n\nIf Intersect(Target, r) Is Nothing Then\n'rest of your code\n</code></pre>\n\n<p>or you can directly use non-contiguous range notation:</p>\n\n<pre><code>If Intersect(Target, Range(\"A6:D150,F6:V150,AA6:AC150\")) Is Nothing Then\n'rest of your code\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9525722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b8bb56e34f24b56427b3326cfcde73?s=128&d=identicon&r=PG&f=1", "display_name": "sara", "link": "https://stackoverflow.com/users/9525722/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1521807846, "creation_date": 1521591641, "last_edit_date": 1521807846, "question_id": 49396218, "link": "https://stackoverflow.com/questions/49396218/beforedoubleclick-and-intersect", "title": "BeforeDoubleClick and Intersect", "body": "<p>I'm losing my mind:</p>\n\n<p>I have this code in my Sheet 2, and its working great (see image for code):</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If Not Intersect(Target, Range(\"A5:D150\")) Is Nothing Then Cancel = True\nEnd Sub\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"A6:D150\")) Is Nothing Then Exit Sub\n    On Error GoTo ExitPoint\n    Application.EnableEvents = False\n    If Not IsDate(Target(1)) Then\n        Application.Undo\n        MsgBox \" You can't delete cell content :)\" _\n        , vbCritical, \"Sara\"\n    End If\nExitPoint:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Now I have an Excel sheet that is cells A:AC.</p>\n\n<p>I want the formula applied to <code>A:D</code>, skip <code>E</code>, applied to <code>F:V</code>, skip <code>W:Z</code>, applied to <code>AA:AC</code>.</p>\n\n<p>How can I implement these codes to multiple ranges? </p>\n\n<p>I have tried many options and failed. I really appreciate any help and feedback.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1521593804, "post_id": 49396183, "comment_id": 85794748, "body": "What not clear to me is if the content of a given line is in a single cell or multiple cells. For example, is &quot;The Power by Naomi Alderman&quot; a single cell or five? or a different number?"}, {"owner": {"reputation": 83, "user_id": 8853240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb54955c61e82450b9749323509ab718?s=128&d=identicon&r=PG&f=1", "display_name": "sam s", "link": "https://stackoverflow.com/users/8853240/sam-s"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1521594100, "post_id": 49396183, "comment_id": 85794816, "body": "Please see the screenshot. <a href=\"https://imgur.com/a/F0t2r\" rel=\"nofollow noreferrer\">imgur.com/a/F0t2r</a>"}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1521603108, "creation_date": 1521603108, "answer_id": 49397684, "question_id": 49396183, "link": "https://stackoverflow.com/questions/49396183/how-do-i-find-similar-duplicates-from-excel-columns/49397684#49397684", "title": "How do I find similar duplicates from excel columns?", "body": "<p>If the sequence of your data cannot be altered, I can't think of a way to do what you need, using just Excel functions (but considering the brilliant minds in this site, I can't be so sure). If however you can sort the data, then below formula might work.</p>\n\n<pre><code>=IF(COUNTIF(C$2:C2,C2 &amp; \"*\")&gt;1,\"Duplicate!\",\"Original\")\n</code></pre>\n\n<p>But after sorting your data in <em>descending order</em>.<br></p>\n\n<p><strong>Considerations:</strong></p>\n\n<ol>\n<li>Data should be sorted descending order</li>\n<li>The duplicates being tracked have the same starting word or phrase.</li>\n</ol>\n\n<p><strong>Result:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/HSewd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HSewd.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1521603548, "creation_date": 1521603548, "answer_id": 49397753, "question_id": 49396183, "link": "https://stackoverflow.com/questions/49396183/how-do-i-find-similar-duplicates-from-excel-columns/49397753#49397753", "title": "How do I find similar duplicates from excel columns?", "body": "<p>If you don't want to sort this should work. You can change the number 11 to identify the number of characters from the left you want to match.</p>\n\n<pre><code>=IF(COUNTIFS(C$2:C2, LEFT(C2,11)&amp; \"*\")&gt;1, \"Duplicate!\",\"Original\")\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8853240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb54955c61e82450b9749323509ab718?s=128&d=identicon&r=PG&f=1", "display_name": "sam s", "link": "https://stackoverflow.com/users/8853240/sam-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1521603548, "creation_date": 1521591331, "last_edit_date": 1531161705, "question_id": 49396183, "link": "https://stackoverflow.com/questions/49396183/how-do-i-find-similar-duplicates-from-excel-columns", "title": "How do I find similar duplicates from excel columns?", "body": "<p>My excel spreadsheet has the following datasets, but as can you see some are duplicates, while others have similar names. I want to find duplicates that are same and similar. The condition is that if they have three or more than three similar keywords, then they are also duplicate. I have the following excel function, but how do I expand it to find similar duplicates:</p>\n\n<pre><code>=IF(COUNTIF($C$2:C2,C2)&gt;1, \"Duplicate!\",\"Original\")\n</code></pre>\n\n<p>Spreadsheet:</p>\n\n<pre><code>The Power by Naomi Alderman\nGrant by Ron Chernow*********\nExit West by Mohsin Hamid\nJanesville: An American Story by Amy Goldstein\nExit West by Mohsin Hamid\nFive-Carat Soul by James McBride\nAnything Is Possible by Elizabeth Strout\nDying: A Memoir by Cory Taylor\nA Gentleman in Moscow by Amor Towles\nJanesville: An American Story by Amy Goldstein\nExit West by Mohsin Hamid\nFive-Carat Soul by James McBride\nJanesville: An  Story by Amy \nExit West by Mohsin Hamid\nFive-Carat Soul by James McBride\nEvicted: Poverty and Profit in the American City Matthew Desmond\nExit West by Mohsin Hamid\nAn American Story by Amy Goldstein\nPoverty and Profit American City Matthew \nGrant by Ron*********\nGrant by Ron Chernow\n</code></pre>\n\n<p>As you can see <strong><em>Grant by Ron Chernow</em></strong> has multiple exact same duplicates and there is another one that simply has <strong><em>Grant by Ron</em></strong> without <strong><em>Chernow</em></strong>. Please help.</p>\n\n<p>Here is the screenshot: <a href=\"https://imgur.com/a/F0t2r\" rel=\"nofollow noreferrer\">Link</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1521590343, "post_id": 49395950, "comment_id": 85793875, "body": "Should <code>.Font.Underline</code> be <code>xlUnderlineStyleSingle</code> or <code>xlUnderlineStyleNone</code>?"}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 0, "creation_date": 1521590656, "post_id": 49395950, "comment_id": 85793960, "body": "What do you mean by runnning automatically?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521590763, "post_id": 49395950, "comment_id": 85793990, "body": "Look at the helper sub key_in_phrase_helper <a href=\"https://stackoverflow.com/questions/32860792/count-and-highlight-keywords-within-phrases/32878493#32878493\">here</a>."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521590879, "post_id": 49395950, "comment_id": 85794029, "body": "You need to add Worksheet_Change event on <i>Input</i> worksheet and only call the Macro when target includes &quot;C2&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1521590994, "post_id": 49395950, "comment_id": 85794055, "body": "@PatricK - Actually, <i>&#39;which begins with data from Sheet &quot;Input,&quot; cell C2&#39;</i> suggests to me that this the result of a formula and may not be able to be done at all."}, {"owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521591018, "post_id": 49395950, "comment_id": 85794066, "body": "drec4s, so cell A10 will update when I change the value of Input!C2"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521591150, "post_id": 49395950, "comment_id": 85794103, "body": "You need a worksheet_change event sub for the Input worksheet, not the one with john smith."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521596428, "post_id": 49396213, "comment_id": 85795397, "body": "Thanks @PatricK. Definitely on the right track, and I would never gotten this close without your help. I&#39;m running into an error with the Worksheet_Calculate. First, to address a couple things, Sheet1 is Contract, and C2 is a formula, which is =IF(B4&gt;0,CONCATENATE(B2,&quot; &amp; &quot;,B4),B2)"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521597110, "post_id": 49396213, "comment_id": 85795568, "body": "What error you have for <code>Worksheet_Calculate</code> event? See updated code for C2&#39;s formula."}, {"owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521597686, "post_id": 49396213, "comment_id": 85795707, "body": "Well I had the first set of code in ThisWorkbook instead of a module, so I was receiving a &quot;Sub or function not defined&quot; error. Then I moved it to a module, and it killed my workbook. Excel has completely locked up and I can&#39;t seem to recover it yet."}, {"owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521597965, "post_id": 49396213, "comment_id": 85795766, "body": "I just had to disable macros, save as a regular workbook, then save again as a macro enabled workbook to strip that code, because the workbook wouldn&#39;t load."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521599390, "post_id": 49396213, "comment_id": 85796120, "body": "Make sure you place codes into correct location... screenshots added, Module1 code updated. Try comment out the <code>Worksheet_Calculate</code> first."}, {"owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521599645, "post_id": 49396213, "comment_id": 85796193, "body": "It looks like it&#39;s working, but when I change the values in the Input worksheet, the debugger pops up and highlights the &quot;Private Sub Worksheet_Change(ByVal Target As Range)&quot; in the Input sheet."}, {"owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521599776, "post_id": 49396213, "comment_id": 85796227, "body": "Actually I just caught your edit about commenting out the Worksheet_Calculate, and it looks like it&#39;s working perfectly"}, {"owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521599990, "post_id": 49396213, "comment_id": 85796274, "body": "Thank you for your time and help!"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "edited": false, "score": 0, "creation_date": 1521599996, "post_id": 49396213, "comment_id": 85796276, "body": "Excellent you got it to work. Remember if <code>Input!B2</code>, <code>Input!B4</code> has formula, add those range to the union part. Or if you don&#39;t want to track this range involvement, just have <code>Worksheet_Change</code> to call <code>Macro</code> without checking which cells in Input has changed."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 2, "last_activity_date": 1521599330, "last_edit_date": 1521599330, "creation_date": 1521591623, "answer_id": 49396213, "question_id": 49395950, "link": "https://stackoverflow.com/questions/49395950/excel-vba-to-underline-referenced-cell-data/49396213#49396213", "title": "Excel VBA to underline referenced cell data", "body": "<p>Try this in normal module (assuming the \"Contract\" is where your <code>A10</code> is)...</p>\n\n<pre><code>Option Explicit\n\nSub Macro()\n    Dim sTxt As String\n    Application.EnableEvents = False ' Added this\n    With Worksheets(\"Contract\").Range(\"A10\")\n        .Font.Underline = xlUnderlineStyleNone\n        sTxt = Range(\"Input!C2\").Text\n        If Len(sTxt) = 0 Then\n            .ClearContents\n        Else\n            .Value = sTxt &amp; \" is having trouble with this formula\"\n            .Characters(1, Len(sTxt)).Font.Underline = xlUnderlineStyleSingle\n        End If\n    End With\n    Application.EnableEvents = True ' Added this\nEnd Sub\n</code></pre>\n\n<p>Then in <strong>Input</strong> worksheet module (updated):</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim oRng As Range\n    Set oRng = Union(Range(\"B2\"), Range(\"B4\"), Range(\"C2\"))\n    If Not Intersect(Target, oRng) Is Nothing Then Macro\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong><br>\nIf the <code>Input!C2</code> contains formula, you need to <em>Union</em> other ranges involved in the <code>Intersect()</code> or it won't auto update on their changes.</p>\n\n<p>Alternatively, you can force auto update on the Worksheet calculation, add below to the <strong>Input</strong> worksheet module:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Macro ' Will not work if Worksheet calculation is Manual\nEnd Sub\n</code></pre>\n\n<p>Screenshots for where the code goes:<br>\n<a href=\"https://i.stack.imgur.com/kZkXV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kZkXV.png\" alt=\"Location of Code for Module1\"></a>\n<a href=\"https://i.stack.imgur.com/CEG1B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CEG1B.png\" alt=\"Location of Code for Input\"></a></p>\n"}], "owner": {"reputation": 65, "user_id": 9525644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d19b2c0972c34e4f000e3a5faa5b438?s=128&d=identicon&r=PG&f=1", "display_name": "mike437", "link": "https://stackoverflow.com/users/9525644/mike437"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2299, "favorite_count": 0, "accepted_answer_id": 49396213, "answer_count": 1, "score": 1, "last_activity_date": 1521599330, "creation_date": 1521589781, "question_id": 49395950, "link": "https://stackoverflow.com/questions/49395950/excel-vba-to-underline-referenced-cell-data", "title": "Excel VBA to underline referenced cell data", "body": "<p>I have a string of text in cell A10, which begins with data from Sheet \"Input,\" cell C2. I want the referenced data to be underlined. For example, if \"John Smith\" was in Input!C2, it should look like \"John Smith is having trouble with this formula\" with John Smith underlined. Below is the code I have, but it's not working -- it's underlining the entire string of text. Also, while I'm here, how can I get this to run automatically, rather than having to manually run the macro? Thanks in advance.</p>\n\n<pre><code>Sub Macro()\n\nWith Range(\"A10\")\n    .Value = Range(\"Input!C2\") &amp; \" is having trouble with this formula\"\n    .Characters(1, Len(Range(\"Input!C2\"))).Font.Underline = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1521590436, "post_id": 49395985, "comment_id": 85793901, "body": "There is the <a href=\"https://msdn.microsoft.com/en-us/library/aa262744%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">.Filter method</a> although official documentation is poor at best."}, {"owner": {"reputation": 3, "user_id": 5534406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FexJn.png?s=128&g=1", "display_name": "FORT", "link": "https://stackoverflow.com/users/5534406/fort"}, "edited": false, "score": 0, "creation_date": 1521592288, "post_id": 49395985, "comment_id": 85794408, "body": "Thanks for your help Ira."}], "tags": [], "owner": {"reputation": 26, "user_id": 8308937, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156449008146038/picture?type=large", "display_name": "Ira Casper", "link": "https://stackoverflow.com/users/8308937/ira-casper"}, "is_accepted": false, "score": 0, "last_activity_date": 1521590004, "creation_date": 1521590004, "answer_id": 49395985, "question_id": 49395889, "link": "https://stackoverflow.com/questions/49395889/how-do-i-check-if-the-contents-of-a-cell-is-a-value-in-an-array-vba-excel/49395985#49395985", "title": "How do I check if the contents of a cell is a value in an array - VBA Excel", "body": "<p>Arrays don't have a simple method to look through the entire group. You'll have to check each of them one at a time.\nReplace</p>\n\n<pre><code>If Sheet1.Cells(4, j) = Sat Then\n\n    Sheet1.Cells(i, j) = 0\nEnd If\n</code></pre>\n\n<p>With</p>\n\n<pre><code>For x = lbound(sat) To ubound(sat)\n    If Sheet1.Cells(4, j) = Sat(x) Then\n        Sheet1.Cells(i, j) = 0\n        Exit For\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 5534406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FexJn.png?s=128&g=1", "display_name": "FORT", "link": "https://stackoverflow.com/users/5534406/fort"}, "edited": false, "score": 0, "creation_date": 1521592446, "post_id": 49396047, "comment_id": 85794440, "body": "The added benefit is that you only need a single lower boundary and a single upper boundary of dates. No need to type in every Saturday."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1521590405, "creation_date": 1521590405, "answer_id": 49396047, "question_id": 49395889, "link": "https://stackoverflow.com/questions/49395889/how-do-i-check-if-the-contents-of-a-cell-is-a-value-in-an-array-vba-excel/49396047#49396047", "title": "How do I check if the contents of a cell is a value in an array - VBA Excel", "body": "<p>I don't know why this wouldn't work.</p>\n\n<pre><code>dim dt as long, i as long, j as long\n\nfor i=5 to 100\n    For j = 4 To 730\n        dt = Sheet1.Cells(4, j).value2\n        If weekday(dt) = 6 and dt &gt;= sat(lbound(sat)) and dt &lt;= sat(ubound(sat)) Then\n            Sheet1.Cells(i, j) = 0\n        end if\n    next j\nnext i\n</code></pre>\n\n<p>You could also try the <a href=\"https://msdn.microsoft.com/en-us/library/aa262744%28v=vs.60%29.aspx\" rel=\"nofollow noreferrer\">.Filter method</a> of an array.</p>\n"}], "owner": {"reputation": 3, "user_id": 5534406, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FexJn.png?s=128&g=1", "display_name": "FORT", "link": "https://stackoverflow.com/users/5534406/fort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521590405, "creation_date": 1521589425, "last_edit_date": 1531164843, "question_id": 49395889, "link": "https://stackoverflow.com/questions/49395889/how-do-i-check-if-the-contents-of-a-cell-is-a-value-in-an-array-vba-excel", "title": "How do I check if the contents of a cell is a value in an array - VBA Excel", "body": "<p>I am writing a small macro to do a simple task. I have made some progress so far, however I am stuck in trying to do an if statement to check if the contents of a cell equals a string in an array then it performs the next statement. Here is my code so far: </p>\n\n<pre><code>Public Sub Saturdays()\n\nDim i As Integer\nDim j As Integer\nDim Sat As Variant\n\nSat = Array(\"1/6/2018\", \"1/13/2018\", \"1/20/2018\", \"1/27/2018\", \"2/3/2018\", \"2/10/2018\", \"2/17/2018\", \"2/24/2018\", \"3/3/2018\", \"3/10/2018\", \"3/17/2018\", \"3/24/2018\", \"3/31/2018\", \"4/7/2018\", \"4/14/2018\", \"4/21/2018\", \"4/28/2018\", \"5/5/2018\", \"5/12/2018\", \"5/19/2018\", \"5/26/2018\", \"6/2/2018\", \"6/9/2018\", \"6/16/2018\", \"6/23/2018\", \"6/30/2018\", \"7/7/2018\", \"7/14/2018\", \"7/21/2018\", \"7/28/2018\", \"8/4/2018\", \"8/11/2018\", \"8/18/2018\", \"8/25/2018\", \"9/1/2018\", \"9/8/2018\", \"9/15/2018\", \"9/22/2018\", \"9/29/2018\", \"10/6/2018\", \"10/13/2018\", \"10/20/2018\", \"10/27/2018\", \"11/3/2018\", \"11/10/2018\", \"11/17/2018\", \"11/24/2018\", \"12/1/2018\", \"12/8/2018\", \"12/15/2018\", \"12/22/2018\", \"12/29/2018\")\n\n\nFor i = 5 To 100\n\n\nIf Sheet1.Cells(i, 1) &lt;&gt; \"\" Then\n\nFor j = 4 To 730\n\n    If Sheet1.Cells(4, j) = Sat Then\n\n        Sheet1.Cells(i, j) = 0\n\nEnd If\n\n\nNext j\n\nEnd If\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "excel", "html", "vba"], "comments": [{"owner": {"reputation": 123667, "user_id": 257182, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f2c683e7dc0c4d4bcc790f87eaa67301?s=128&d=identicon&r=PG", "display_name": "RobG", "link": "https://stackoverflow.com/users/257182/robg"}, "edited": false, "score": 1, "creation_date": 1521589171, "post_id": 49395814, "comment_id": 85793572, "body": "In javascript you could also use <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/removeAttribute\" rel=\"nofollow noreferrer\"><i>removeAttribute</i></a> or <code>element.disabled = false</code> (capitalisation matters). Dunno about VBA, it&#39;s a horrid language."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1525520179, "post_id": 49395814, "comment_id": 87394748, "body": "Is there an URL you can share for this?"}], "owner": {"reputation": 129, "user_id": 8519063, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10155669062546468/picture?type=large", "display_name": "Will", "link": "https://stackoverflow.com/users/8519063/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521588852, "creation_date": 1521588852, "question_id": 49395814, "link": "https://stackoverflow.com/questions/49395814/vba-how-to-remove-the-disabled-attribute-from-an-html-element", "title": "VBA: How to remove the &quot;Disabled&quot; attribute from an HTML element", "body": "<p>Working on a project with VBA that fills in a web form. I've got an Input element (an 'Add' button) selected with disabled attribute in it. </p>\n\n<pre><code>&lt;input id=\"ClickMe\" value=\"Add\" name=\"BigButton\" class=\"submit-this\" disabled=\"\"&gt;\n</code></pre>\n\n<p>Normally disabled is cleared when the user fills in the form; however since I'm interacting with the objects directly, I'm not triggering that action.\nMy understanding is that the only way I can 'click' this button is if I remove the disabled attribute itself (IE, Disabled=\"False\" would not work.)</p>\n\n<p>Additionally, I'm doing this through Excel 2010 on a 64-bit system. Which, I've read doesn't allow me to insert Javascript code as a workaround (ScriptControl library only supported on Excel 2010 32-bit).</p>\n\n<p>How do I remove an attribute from an HTML element using VBA? \nAlternatively- is there a way to still use Javascript in excel 2010? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9524241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0081401aa234df02f58faa90cde6f?s=128&d=identicon&r=PG&f=1", "display_name": "Melnemac32", "link": "https://stackoverflow.com/users/9524241/melnemac32"}, "edited": false, "score": 0, "creation_date": 1521591550, "post_id": 49395780, "comment_id": 85794215, "body": "Thanks for the help!  I appreciate you writing this up.  One problem, I am getting an error &quot;Run Time Error &#39;13&#39;  Type mismatch and the debugger brings me back to this section of the code:   copyArr(i) = ws1.Cells(i, &quot;A&quot;) + ws1.Cells(i, &quot;C&quot;) + ws1.Cells(i, &quot;D&quot;)"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 41, "user_id": 9524241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0081401aa234df02f58faa90cde6f?s=128&d=identicon&r=PG&f=1", "display_name": "Melnemac32", "link": "https://stackoverflow.com/users/9524241/melnemac32"}, "edited": false, "score": 0, "creation_date": 1521592471, "post_id": 49395780, "comment_id": 85794444, "body": "The point of that line is to combine the content of each cell to come up with your unique identifier, but not knowing what&#39;s in your cells, I&#39;m not sure what the problem might be. Try wrapping each with cstr() to ensure you are just adding strings. That is, the new line will be: CStr(ws1.Cells(i, &quot;A&quot;)) + CStr(ws1.Cells(i, &quot;C&quot;)) + CStr(ws1.Cells(i, &quot;D&quot;))"}, {"owner": {"reputation": 41, "user_id": 9524241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0081401aa234df02f58faa90cde6f?s=128&d=identicon&r=PG&f=1", "display_name": "Melnemac32", "link": "https://stackoverflow.com/users/9524241/melnemac32"}, "edited": false, "score": 0, "creation_date": 1521596312, "post_id": 49395780, "comment_id": 85795368, "body": "Hrmm... that update still bugged out.  I&#39;m trying to send you a screen shot of the data but it&#39;s not letting me paste it.  In column A, I have an order number (ex. DL59488) then column C, I have a quantity (ex. 13), and column D has a dimension (ex. 7 3/4 or 20 IN)"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 41, "user_id": 9524241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0081401aa234df02f58faa90cde6f?s=128&d=identicon&r=PG&f=1", "display_name": "Melnemac32", "link": "https://stackoverflow.com/users/9524241/melnemac32"}, "edited": false, "score": 0, "creation_date": 1521597758, "post_id": 49395780, "comment_id": 85795724, "body": "The 7 3/4 could be a problem for Excel since it may be converted to 7.75 etc... depending on the formatting. For that reason I suggest formatting the cells in that column as text. I&#39;ve added a small test sub to my original answer to troubleshoot the problem you describe. I also included an animated gif showing it running to confirm that it works fine for me."}, {"owner": {"reputation": 41, "user_id": 9524241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0081401aa234df02f58faa90cde6f?s=128&d=identicon&r=PG&f=1", "display_name": "Melnemac32", "link": "https://stackoverflow.com/users/9524241/melnemac32"}, "edited": false, "score": 0, "creation_date": 1521642831, "post_id": 49395780, "comment_id": 85819615, "body": "I&#39;m not sure why, but now it is pasting everything into column D of spreadsheet 2 instead of column A in the core cutter list spreadsheet."}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 41, "user_id": 9524241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0081401aa234df02f58faa90cde6f?s=128&d=identicon&r=PG&f=1", "display_name": "Melnemac32", "link": "https://stackoverflow.com/users/9524241/melnemac32"}, "edited": false, "score": 0, "creation_date": 1521644200, "post_id": 49395780, "comment_id": 85820750, "body": "Sorry it&#39;s causing you problems. As I&#39;m sure you understand, Stack Overflow isn&#39;t a code-writing service, but there is a lot of help and pointers here if you can break your problem into small pieces and provide specific examples (I see that paul bica has offered another approach). Hopefully I&#39;ve helped shed a little light..."}], "tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1521597649, "last_edit_date": 1521597649, "creation_date": 1521588627, "answer_id": 49395780, "question_id": 49395697, "link": "https://stackoverflow.com/questions/49395697/not-copying-over-duplicate-rows/49395780#49395780", "title": "Not copying over duplicate rows", "body": "<p>I'd suggesting adding a for..next loop prior to the existing one, and in that for..next loop make an array containing the unique identifier for each row (made from cells in A,C,D).  Then you can use that array to ensure no changes are made in the following for..next loop if a row already has been done.</p>\n\n<p>I threw the code below together quick and have no simple way to check it without your data, so it will require modification. But at least it gives you an idea. Let me know if you have questions.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyRows()\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws1r As Range, ws2r As Range\n    Dim ws1lr As Long, ws1lc As Long, ws2lr As Long, i As Long\n    Dim copyArr() As String, aCopy As Boolean, j As Long\n\n    Set ws1 = ThisWorkbook.Worksheets(\"2\")\n    Set ws2 = ThisWorkbook.Worksheets(\"Core_Cutter_List\")\n\n    ws1lr = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row        'last row in \"2\"\n    ws1lc = ws1.Cells(1, Columns.Count).End(xlToLeft).Column 'last col in \"2\"\n    ws2lr = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1    'last row in \"Core_Cutter\"\n\n    ReDim copyArr(1 To ws1lr) As String\n    For i = 1 To ws1lr\n      copyArr(i) = ws1.Cells(i, \"A\") + ws1.Cells(i, \"C\") + ws1.Cells(i, \"D\")\n    Next\n\n    For i = 1 To ws1lr\n      aCopy = False\n      For j = 1 To ws1lr\n        If i &lt;&gt; j And copyArr(i) = copyArr(j) Then\n          aCopy = True\n          Exit For\n        End If\n      Next j\n\n      If Not aCopy Then\n\n        If Len(ws1.Cells(i, \"A\")) &gt; 0 And Len(ws1.Cells(i, \"G\")) = 0 Then\n\n            Set ws1r = ws1.Range(ws1.Cells(i, 1), ws1.Cells(i, ws1lc))\n            Set ws2r = ws2.Range(ws2.Cells(ws2lr, 1), ws2.Cells(ws2lr, ws1lc))\n\n            ws2r.Value2 = ws1r.Value2\n            ws2lr = ws2lr + 1\n        End If\n\n      End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Here's a test sub to troubleshoot the code you're having trouble with. Because the value of 7 3/4 you mention in your comment could give trouble for Excel cells, I formatted the cells in column A as text.</p>\n\n<pre><code>Sub test()\nDim ws1 As Worksheet, s As String\nDim i As Integer, copyArr() As String\nSet ws1 = ActiveSheet\nReDim copyArr(1 To 3) As String\nFor i = 1 To 3\n  copyArr(i) = CStr(ws1.Cells(i, \"A\")) + CStr(ws1.Cells(i, \"C\")) + CStr(ws1.Cells(i, \"D\"))\n  ws1.Cells(i, \"D\") = copyArr(i)\nNext i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5nUi0.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5nUi0.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1521614561, "creation_date": 1521614561, "answer_id": 49399835, "question_id": 49395697, "link": "https://stackoverflow.com/questions/49395697/not-copying-over-duplicate-rows/49399835#49399835", "title": "Not copying over duplicate rows", "body": "<p>This approach is using a dictionary to capture records already present in \"Core_Cutter_List\"<br>\nIf a record already exists in the second sheet it will not copy it again from the first sheet (\"2\")</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyRows()\n    Const A = 1, C = 3, D = 4, IDK = \"|\"\n    Dim ws1 As Worksheet, ws2 As Worksheet, i As Long, j As Long, recordID As String\n    Dim ws1ur As Variant, ws2ur As Variant, ws1lc As Long, dic As Object\n\n    Set ws1 = ThisWorkbook.Worksheets(\"2\")\n    Set ws2 = ThisWorkbook.Worksheets(\"Core_Cutter_List\")\n\n    ws1ur = ws1.UsedRange           'all data in \"2\" (as array)\n    ws2ur = ws2.UsedRange           'all data in \"Core_Cutter\" (as array)\n    ws1lc = UBound(ws1ur, 2)        'last col in \"2\"\n    j = UBound(ws2ur, 1) + 1        'last row in \"Core_Cutter\"\n\n    Set dic = CreateObject(\"Scripting.Dictionary\")  'Capture IDs in ws2, cols A, C, &amp; D\n    For i = 1 To j - 1\n        dic(ws2ur(i, A) &amp; IDK &amp; ws2ur(i, C) &amp; IDK &amp; ws2ur(i, D)) = 0\n    Next i\n\n    For i = 1 To UBound(ws1ur, 1)   'last row in \"2\"\n\n        If Len(ws1ur(i, 1)) &gt; 0 And Len(ws1ur(i, 7)) = 0 Then\n\n            recordID = ws1ur(i, A) &amp; IDK &amp; ws1ur(i, C) &amp; IDK &amp; ws1ur(i, D)\n\n            If Not dic.Exists(recordID) Then  'check that the record in ws1 is not in ws2\n                dic(recordID) = 0             'add it to the dictionary\n                ws2.UsedRange.Rows(j).Value2 = ws1.UsedRange.Rows(i).Value2  'Copy rows\n                j = j + 1\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Test data in Worksheets(\"2\")</p>\n\n<p><a href=\"https://i.stack.imgur.com/wqoN9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wqoN9.png\" alt=\"Worksheets(&quot;2&quot;)\"></a></p>\n\n<p>Result - Worksheets(\"Core_Cutter_List\")</p>\n\n<p><a href=\"https://i.stack.imgur.com/8kYZa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8kYZa.png\" alt=\"Worksheets(&quot;Core_Cutter_List&quot;)\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 9524241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43c0081401aa234df02f58faa90cde6f?s=128&d=identicon&r=PG&f=1", "display_name": "Melnemac32", "link": "https://stackoverflow.com/users/9524241/melnemac32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521614561, "creation_date": 1521588017, "last_edit_date": 1521589106, "question_id": 49395697, "link": "https://stackoverflow.com/questions/49395697/not-copying-over-duplicate-rows", "title": "Not copying over duplicate rows", "body": "<p>I have a question on how to add onto to this code to not copy duplicate rows.  My columns A, C, and D  combined together would make an unique identifier, but I'd rather not have to add that \"helper\" column to my spreadsheet if possible.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyRows()\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws1r As Range, ws2r As Range\n    Dim ws1lr As Long, ws1lc As Long, ws2lr As Long, i As Long\n\n    Set ws1 = ThisWorkbook.Worksheets(\"2\")\n    Set ws2 = ThisWorkbook.Worksheets(\"Core_Cutter_List\")\n\n    ws1lr = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row        'last row in \"2\"\n    ws1lc = ws1.Cells(1, Columns.Count).End(xlToLeft).Column 'last col in \"2\"\n    ws2lr = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1    'last row in \"Core_Cutter\"\n\n    For i = 1 To ws1lr\n\n        If Len(ws1.Cells(i, \"A\")) &gt; 0 And Len(ws1.Cells(i, \"G\")) = 0 Then\n\n            Set ws1r = ws1.Range(ws1.Cells(i, 1), ws1.Cells(i, ws1lc))\n            Set ws2r = ws2.Range(ws2.Cells(ws2lr, 1), ws2.Cells(ws2lr, ws1lc))\n\n            ws2r.Value2 = ws1r.Value2\n            ws2lr = ws2lr + 1\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}]