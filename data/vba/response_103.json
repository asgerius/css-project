[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "edited": false, "score": 0, "creation_date": 1482971000, "post_id": 41371070, "comment_id": 69944947, "body": "Did you have a look at the SQL support for Excel in VBA via ADODB? That would probably be the cleanest solution."}, {"owner": {"reputation": 1, "user_id": 7286171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331551c5a0afd70a1e6253bbe492bf38?s=128&d=identicon&r=PG&f=1", "display_name": "Mouctar", "link": "https://stackoverflow.com/users/7286171/mouctar"}, "reply_to_user": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "edited": false, "score": 0, "creation_date": 1483007183, "post_id": 41371070, "comment_id": 69957237, "body": "Hi, no i have not. could you please post the link so that i can take a look at it. I am fairly new on VBA coding processing."}], "answers": [{"comments": [{"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "reply_to_user": {"reputation": 1, "user_id": 7286171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331551c5a0afd70a1e6253bbe492bf38?s=128&d=identicon&r=PG&f=1", "display_name": "Mouctar", "link": "https://stackoverflow.com/users/7286171/mouctar"}, "edited": false, "score": 0, "creation_date": 1483185297, "post_id": 41388880, "comment_id": 70019004, "body": "@Mouctar I agree. Using INDEX and MATCH can be slow given enough data. In this case you might want to have a look at the third approach. The SQL support uses more efficient join algorithms to match your data."}, {"owner": {"reputation": 1, "user_id": 7286171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331551c5a0afd70a1e6253bbe492bf38?s=128&d=identicon&r=PG&f=1", "display_name": "Mouctar", "link": "https://stackoverflow.com/users/7286171/mouctar"}, "edited": false, "score": 0, "creation_date": 1483185375, "post_id": 41388880, "comment_id": 70019014, "body": "Hello, thank you for your advise. However, i am currently using Index and Match to get the correct format and it takes me for ever to do them, as i have over 70 pension schemes and approx 7000 employees, so this option is good for small reports but not big reports. The second suggestion might be better option but i am struggling to even think where to start from, as i am fairly new on VBA coding. Final suggestion be might good too but it is first time i hear about it, so that would take me forever to understand, never mind writing code that would do the job."}, {"owner": {"reputation": 1, "user_id": 7286171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331551c5a0afd70a1e6253bbe492bf38?s=128&d=identicon&r=PG&f=1", "display_name": "Mouctar", "link": "https://stackoverflow.com/users/7286171/mouctar"}, "edited": false, "score": 0, "creation_date": 1483185951, "post_id": 41388880, "comment_id": 70019150, "body": "Any idea where i can find learning material about SQL, i am just want to make my life better at work, as it can be stressful as the deadline is short turn around. Please any help will be much appreciated"}, {"owner": {"reputation": 1, "user_id": 7286171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331551c5a0afd70a1e6253bbe492bf38?s=128&d=identicon&r=PG&f=1", "display_name": "Mouctar", "link": "https://stackoverflow.com/users/7286171/mouctar"}, "edited": false, "score": 0, "creation_date": 1483188620, "post_id": 41388880, "comment_id": 70019725, "body": "Hi, Please see below layout.  A B C D E F  Pers.No Name ID Number Pension Type Pensionable Pay Amount Net Amount 008835 Jack Wilson NE54315 Pens EE(Tal) 827.57 45.52 008835 Jack Wilson NE54315 Pens ER(Tal) 827.57 162.20  I need to a code that can do below example lay out. I am fairly new on VBA coding   A B C D E F G Pers.No Name ID Number Pensionable Pay Amount Pens EE(Tal) Pens ER(Tal) Total 008835 Jack Wilson NE54315 827.57 45.52 162.20 207.72 (45.52+162.20)  Thank you again for you help"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "reply_to_user": {"reputation": 1, "user_id": 7286171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331551c5a0afd70a1e6253bbe492bf38?s=128&d=identicon&r=PG&f=1", "display_name": "Mouctar", "link": "https://stackoverflow.com/users/7286171/mouctar"}, "edited": false, "score": 0, "creation_date": 1483188741, "post_id": 41388880, "comment_id": 70019751, "body": "@Moucart For some reason our estate on SQL you can look [here] (<a href=\"https://www.quora.com/How-do-I-learn-SQL\" rel=\"nofollow noreferrer\">quora.com/How-do-I-learn-SQL</a>)."}], "tags": [], "owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "is_accepted": false, "score": 1, "last_activity_date": 1483056091, "last_edit_date": 1495540805, "creation_date": 1483056091, "answer_id": 41388880, "question_id": 41371070, "link": "https://stackoverflow.com/questions/41371070/manipulate-data-base-on-criteria/41388880#41388880", "title": "Manipulate data base on Criteria", "body": "<p>From your problem description, I think I can decipher that you are using Excel.</p>\n\n<p>I see three basic approaches to solving your problem:</p>\n\n<p>The simplest approach is not to use VBA at all and instead use the workbook functions <a href=\"https://support.office.com/en-us/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd\" rel=\"nofollow noreferrer\">INDEX</a> and <a href=\"https://support.office.com/en-us/article/MATCH-function-e8dffd45-c762-47d6-bf89-533f4a37673a\" rel=\"nofollow noreferrer\">MATCH</a>. The latter returns the row or column where an exact match is found in the search range, which has to be one dimensional. (The exact match actually requires the search option 0.) The function <code>INDEX</code> returns the value at the given row and column in a range. Combining both, you get a more flexible verision of <code>VLOOKUP</code> and <code>HLOOKUP,</code> which you can use to find the values in the second table for a given employee. (<code>MATCH</code> returns an <code>N/A</code> error if no match is found.)</p>\n\n<p>The second approach is to use the Excel object model in VBA. You can search a range for a value using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Find</a> method of the range. This returns the cell where the match is found and <code>Nothing</code> in case there is no match. If the search result is not <code>Nothing</code>, you can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836836.aspx\" rel=\"nofollow noreferrer\">EntireRow</a> property to get the entire row and the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Cells</a> property to select cells in the row. </p>\n\n<p>Finally, you can use the support of SQL for Excel via ADODB. For a description how to do this, you can look at this <a href=\"https://technet.microsoft.com/en-us/library/ee692882.aspx\" rel=\"nofollow noreferrer\">Microsoft page</a> and this old <a href=\"https://stackoverflow.com/questions/12979605/how-to-retrieve-data-from-excel-with-adodb-connection-if-the-first-line-of-the-w\">question</a> on SO. Provided you know how to write SQL queries, this should enable you to solve your problem via SQL.  </p>\n"}], "owner": {"reputation": 1, "user_id": 7286171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331551c5a0afd70a1e6253bbe492bf38?s=128&d=identicon&r=PG&f=1", "display_name": "Mouctar", "link": "https://stackoverflow.com/users/7286171/mouctar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1483186710, "creation_date": 1482967202, "last_edit_date": 1531161705, "question_id": 41371070, "link": "https://stackoverflow.com/questions/41371070/manipulate-data-base-on-criteria", "title": "Manipulate data base on Criteria", "body": "<p>I am trying to create code that will help me achieve the correct format. All I want is to pull employee (EE) entire row and paste into a new sheet, and then second part (ER) value to match the same employee. </p>\n\n<p>In other words, if employee pay pension contributions for 100 (Pen EE (Tal)) and employer pay for 200 (Pen ERS (Tal)) on behalf of the same employee. Then, the worksheet should look like Column A= Pers No, Column B=Employee Name, Column C= ID Number, Column D=PenPay, Column E=Pens EE(Tal) and Column F=Pens ER(Tal) and G= Total (Pen EE +Pen ER values), as exactly in example tab.</p>\n\n<p>I hope this makes sense. I have tried several methods but no luck so far. Thank you all for your help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1482968049, "post_id": 41371049, "comment_id": 69944111, "body": "Have you stepped through and observed the value of <code>areNewCells</code> in the  Locals Window?"}, {"owner": {"reputation": 21, "user_id": 7351824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c793b3d57a9bf35756ad42d5782a392?s=128&d=identicon&r=PG&f=1", "display_name": "Rubikkon", "link": "https://stackoverflow.com/users/7351824/rubikkon"}, "reply_to_user": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1482968238, "post_id": 41371049, "comment_id": 69944171, "body": "Yes.  I have a breakpoint at the &quot;next&quot; statement right before the Loop Until.  As soon as I get to the &quot;next&quot; statement, the locals window clears."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1482969116, "post_id": 41371049, "comment_id": 69944416, "body": "Where does CurrentRange get defined ?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1482969540, "post_id": 41371049, "comment_id": 69944543, "body": "<code>CurrentRange = Union(CurrentRange, c.Offset(1))</code> doesn&#39;t actually do anything but doesn&#39;t generate an error either. You need to use <code>Set CurrentRange = Union(CurrentRange, c.Offset(1))</code> to actually change the cells in the range"}, {"owner": {"reputation": 21, "user_id": 7351824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c793b3d57a9bf35756ad42d5782a392?s=128&d=identicon&r=PG&f=1", "display_name": "Rubikkon", "link": "https://stackoverflow.com/users/7351824/rubikkon"}, "edited": false, "score": 0, "creation_date": 1482970157, "post_id": 41371049, "comment_id": 69944739, "body": "Thank you barrowc!  That fixed it!"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "edited": false, "score": 0, "creation_date": 1482970585, "post_id": 41371049, "comment_id": 69944852, "body": "Just as an explanation of barrowc&#39;s comment. Since you do not use the <code>Set</code> key word, the range <code>Union(CurrentRange, c.Offset(1))</code> does not  get assigned to <code>CurrentRange</code>. Instead the default property of <code>Union(CurrentRange, c.Offset(1))</code>  gets assigned to that of <code>CurrentRange</code>. For ranges, <code>Value</code> is the default property. (Well, technically that is not entirely true but outside <code>For Each</code> loops <code>Value</code> acts as the default property.)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1482972219, "post_id": 41371049, "comment_id": 69945193, "body": "@Rubikkon - See <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices#t=201612290042356593265\">&quot;Always Use Option Explicit&#39;</a>. Incorporating this principle will save you much troubleshooting in the future :)"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483093372, "post_id": 41376023, "comment_id": 69990821, "body": "@Rubikon, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1483001066, "creation_date": 1483001066, "answer_id": 41376023, "question_id": 41371049, "link": "https://stackoverflow.com/questions/41371049/procedure-level-variable-losing-value-in-do-until-loop/41376023#41376023", "title": "Procedure level variable losing value in do until loop?", "body": "<p>since you asked for <em>easier way</em>, you could consider the following code:</p>\n\n<pre><code>With CurrentRange\n    For Each c In Union(.Offset(, .Columns.count).Resize(.Rows.count + 1, 1), .Offset(.Rows.count).Resize(1)) '&lt;--| loop through wanted cells only\n        If c.Interior.ColorIndex = CurrentColor Then Set CurrentRange = Union(CurrentRange, c)\n    Next c\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7351824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c793b3d57a9bf35756ad42d5782a392?s=128&d=identicon&r=PG&f=1", "display_name": "Rubikkon", "link": "https://stackoverflow.com/users/7351824/rubikkon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483001066, "creation_date": 1482967067, "last_edit_date": 1531164843, "question_id": 41371049, "link": "https://stackoverflow.com/questions/41371049/procedure-level-variable-losing-value-in-do-until-loop", "title": "Procedure level variable losing value in do until loop?", "body": "<p>I am trying to write a loop that adds cells to a range based on a couple of conditions.  </p>\n\n<p>1) the cell is either to the right or down of a cell that is already in the range, </p>\n\n<p>2) the cell is the same color as a previously specified color.</p>\n\n<pre><code>Sub DefineContiguousRegion()\n\nDim c As Range\nDim areNewCells As Boolean\n\nDo\n    areNewCells = False\n    For Each c In CurrentRange\n        If (Intersect(CurrentRange, c.Offset(1)) Is Nothing) And c.Offset(1).Interior.ColorIndex = CurrentColor Then\n            areNewCells = True\n            CurrentRange = Union(CurrentRange, c.Offset(1))\n        End If\n        If (Intersect(CurrentRange, c.Offset(, 1)) Is Nothing) And c.Offset(, 1).Interior.ColorIndex = CurrentColor Then\n            areNewCells = True\n            CurrentRange = Union(CurrentRange, c.Offset(, 1))\n        End If\n    Next\nLoop Until areNewCells = False\n</code></pre>\n\n<p>The problem is that the variable areNewCells is being reset to out of context at the end of the For Each loop.  So the until condition is never fulfilled, even if the value is never set to true.</p>\n\n<p>Why is this happening?  How can I fix it?</p>\n\n<p>If someone can come up with an easier way of creating this range, that would be nice, but what I'm really looking for is a better understanding of variable scope/lifetime, as this is a learning project rather than a time sensitive work related one.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1482967118, "post_id": 41371046, "comment_id": 69943811, "body": "<code>rcell5 = Range(rcell9).Value</code>"}, {"owner": {"reputation": 9, "user_id": 6879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9f821a6c43125c1b70e30321d7326?s=128&d=identicon&r=PG&f=1", "display_name": "Kisheon", "link": "https://stackoverflow.com/users/6879759/kisheon"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483029992, "post_id": 41371046, "comment_id": 69969731, "body": "Thank you! This worked without having to adjust my code."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9f821a6c43125c1b70e30321d7326?s=128&d=identicon&r=PG&f=1", "display_name": "Kisheon", "link": "https://stackoverflow.com/users/6879759/kisheon"}, "edited": false, "score": 0, "creation_date": 1483025414, "post_id": 41371089, "comment_id": 69967234, "body": "Thanks. Yes. It is a part of a bigger code, but that&#39;s the last step I was missing. I just wanted to not have to put that cell reference in twice. I can share the entire code with you if you really want to see it. It is not absolutely efficient, but a lot better than I had before."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 6879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9f821a6c43125c1b70e30321d7326?s=128&d=identicon&r=PG&f=1", "display_name": "Kisheon", "link": "https://stackoverflow.com/users/6879759/kisheon"}, "edited": false, "score": 0, "creation_date": 1483027828, "post_id": 41371089, "comment_id": 69968546, "body": "@Kisheon - Did this work for you? If so, mind marking as the answer? Also, I recommend looking at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using <code>.Select</code>/<code>.Activate</code></a> which will help."}, {"owner": {"reputation": 9, "user_id": 6879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9f821a6c43125c1b70e30321d7326?s=128&d=identicon&r=PG&f=1", "display_name": "Kisheon", "link": "https://stackoverflow.com/users/6879759/kisheon"}, "edited": false, "score": 0, "creation_date": 1483030125, "post_id": 41371089, "comment_id": 69969795, "body": "The first comment from @Cominterm worked without having to adjust my code, because I need rcell9 as a string. I have cut out a few .Select and .Activate from my code, but I was unable to get around a few others."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1482992862, "last_edit_date": 1482992862, "creation_date": 1482967325, "answer_id": 41371089, "question_id": 41371046, "link": "https://stackoverflow.com/questions/41371046/obtain-cell-value-from-previous-reference/41371089#41371089", "title": "Obtain Cell Value from Previous Reference", "body": "<p>I suggest a few small tweaks:</p>\n\n<pre><code>Sub NoName2()\nDim rCell5 As String, rCell9 As Range\n' Dim monthDays As Long ' Why have this?\n\nSet rCell9 = Range(\"F2\")\nrCell5 = rCell9.Value\n\nEnd Sub\n</code></pre>\n\n<p>While the above should work for you, I've found myself thinking - what's your goal with the sub? The variable names aren't really helpful, and IMO a little confusing. You want a string to get its value from a cell, that's normal. However the naming convention makes the code a little confusing to read, even when it's so short.</p>\n\n<p>I suspect there's a bigger plan here, so just consider what that may be, and I suggest tweaking the variable names to be more in tune with that. </p>\n"}], "owner": {"reputation": 9, "user_id": 6879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9f821a6c43125c1b70e30321d7326?s=128&d=identicon&r=PG&f=1", "display_name": "Kisheon", "link": "https://stackoverflow.com/users/6879759/kisheon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 41371089, "answer_count": 1, "score": 0, "last_activity_date": 1482992862, "creation_date": 1482967058, "question_id": 41371046, "link": "https://stackoverflow.com/questions/41371046/obtain-cell-value-from-previous-reference", "title": "Obtain Cell Value from Previous Reference", "body": "<p>I have a small issue here. The I want to make only one cell reference edit in this macro, by changing the reference for rcell9-- in this case it is \"F2\". And I also want to avoid using .Activate. However I want rcell5 to be the value in the cell that rcell9 references. How can I program this differently?</p>\n\n<pre><code> Sub Noname()\n Dim rcell5 As String, rcell9 As String\n Dim MonthDays As Long\n rcell9 = (\"F2\")\n Range(rcell9).Activate\n rcell5 = ActiveCell.Value\n End Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "sql-update", "sql-insert"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1482968601, "post_id": 41371013, "comment_id": 69944265, "body": "Can you expand on why your form can&#39;t handle this natively?"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7351812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91776f3a214ca25387528c268eaf91d5?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cockerham", "link": "https://stackoverflow.com/users/7351812/travis-cockerham"}, "edited": false, "score": 0, "creation_date": 1483022126, "post_id": 41371419, "comment_id": 69965360, "body": "Thank you very much for your response! [State Region] is not a the primary key since multiple states can be in the same region of the country."}, {"owner": {"reputation": 17, "user_id": 7351812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91776f3a214ca25387528c268eaf91d5?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cockerham", "link": "https://stackoverflow.com/users/7351812/travis-cockerham"}, "edited": false, "score": 0, "creation_date": 1483022622, "post_id": 41371419, "comment_id": 69965640, "body": "I hit enter too early. Thank you very much for your response! [State Region] is not a the primary key since multiple states can be in the same region of the country.  The code is designed to look the table [Sonoco2016_xlsx] for states, look for a matching state abbreviation in [tblStates] and return the [StateRegion] for the corresponding state into the [O_StateRegion] field in [Sonoco2016_xlsx] table. The code will run after the user imports an excel file into Access as a table. In this case, the imported table is [Sonoco2016_xlsx]"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "reply_to_user": {"reputation": 17, "user_id": 7351812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91776f3a214ca25387528c268eaf91d5?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cockerham", "link": "https://stackoverflow.com/users/7351812/travis-cockerham"}, "edited": false, "score": 0, "creation_date": 1483022660, "post_id": 41371419, "comment_id": 69965662, "body": "Sorry, there was a small mistake in my answer that I  corrected right now. I meant <code>[StateAbbrev]</code> not <code>[StateRegion]</code>."}, {"owner": {"reputation": 17, "user_id": 7351812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91776f3a214ca25387528c268eaf91d5?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cockerham", "link": "https://stackoverflow.com/users/7351812/travis-cockerham"}, "edited": false, "score": 0, "creation_date": 1483023346, "post_id": 41371419, "comment_id": 69966035, "body": "Thank you M. Doerner! I went ahead and updated my code with your edits. I made it look like below and it ran great and put the appropriate states in the appropriate fields. Thanks again for the help!"}], "tags": [], "owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "is_accepted": true, "score": 0, "last_activity_date": 1483022472, "last_edit_date": 1483022472, "creation_date": 1482969768, "answer_id": 41371419, "question_id": 41371013, "link": "https://stackoverflow.com/questions/41371013/vba-sql-changing-code-from-insert-into-to-update-table/41371419#41371419", "title": "VBA SQL - Changing code from &#39;Insert Into&#39; to &#39;Update&#39; table", "body": "<p>The correct syntax for what you want to achieve is</p>\n\n<pre><code>UPDATE [Sonoco2016_xlsx] \n    INNER JOIN [tblStates]\n        ON [tblStates].[StateAbbrev] = [Sonoco2016_xlsx].[OriginState]\nSET [Sonoco2016_xlsx].[O_StateRegion]=[tblStates].[StateRegion];\n</code></pre>\n\n<p>which you would execute without using a recordset.</p>\n\n<p>Note, however, that this will only work if <code>[StateAbbrev]</code> has a unique index, e.g. if it is the primary key of <code>[tblStates]</code>. Otherwise, the update would be ambiguous.</p>\n\n<p>Moreover, it is not possible to use a subquery in the set statement like </p>\n\n<pre><code>SET [Sonoco2016_xlsx].[O_StateRegion]=(SELECT [StateRegion] \n                                       FROM = [tblStates] \n                                       WHERE [StateAbbrev] = rs![OriginState])\n</code></pre>\n\n<p>because subqueries are prohibited in <code>UPDATE</code> statements.</p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 7351812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91776f3a214ca25387528c268eaf91d5?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cockerham", "link": "https://stackoverflow.com/users/7351812/travis-cockerham"}, "is_accepted": false, "score": 0, "last_activity_date": 1483023579, "creation_date": 1483023579, "answer_id": 41382157, "question_id": 41371013, "link": "https://stackoverflow.com/questions/41371013/vba-sql-changing-code-from-insert-into-to-update-table/41382157#41382157", "title": "VBA SQL - Changing code from &#39;Insert Into&#39; to &#39;Update&#39; table", "body": "<p>Here is the answer that worked for me thanks to M Doerner!</p>\n\n<pre><code>Private Sub btnInsertRegions_Click()\n\nOn Error GoTo InsertRegions_Err\n\nDim db As Database\nDim rs As Recordset\nDim strSQL As String\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"Select [OriginState] from [Sonoco2016_xlsx];\")\n\nrs.MoveFirst\nWhile Not rs.EOF\n\n    strSQL = \"UPDATE [Sonoco2016_xlsx] INNER JOIN [tblStates]\"\n    strSQL = strSQL &amp; \" ON [tblStates].[StateAbbrev] = [Sonoco2016_xlsx].[OriginState]\"\n    strSQL = strSQL &amp; \" SET [Sonoco2016_xlsx].[O_StateRegion]=[tblStates].[StateRegion]\"\n\n\n    db.Execute (strSQL), dbFailOnError\n\nrs.MoveNext\nWend\nrs.Close\nSet rs = Nothing\nSet db = Nothing\n\nbtnInsertRegions_Exit:\n    Exit Sub\n\nInsertRegions_Err:\n    MsgBox Err.Description &amp; \" in btnInsertRegions\"\n    Resume btnInsertRegions_Exit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7351812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91776f3a214ca25387528c268eaf91d5?s=128&d=identicon&r=PG&f=1", "display_name": "Travis Cockerham", "link": "https://stackoverflow.com/users/7351812/travis-cockerham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 41371419, "answer_count": 2, "score": 0, "last_activity_date": 1483023579, "creation_date": 1482966837, "question_id": 41371013, "link": "https://stackoverflow.com/questions/41371013/vba-sql-changing-code-from-insert-into-to-update-table", "title": "VBA SQL - Changing code from &#39;Insert Into&#39; to &#39;Update&#39; table", "body": "<p>I have looked and looked for an answer and cannot translate the answers to my specific code. I have some code for an Access Database that works as an INSERT TO but I want it to UPDATE a table. I cannot get it to run after changing it to UPDATE.</p>\n\n<p>The following code works and what it does is add values that meet the criteria to the beginning of an existing table. But I want it to update the existing blank column \"O_StateRegion\" in a table called \"Sonoco2016_xlsx\". My efforts of switching INSERT INTO to UPDATE have failed. (See second example of code for my efforts)</p>\n\n<pre><code>Private Sub InsertStateRegion()\n\nOn Error GoTo InsertRegions_Err\n\nDim db As Database\nDim rs As Recordset\nDim strSQL As String\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"Select [OriginState] from [Sonoco2016_xlsx];\")\n\nrs.MoveFirst\nWhile Not rs.EOF\n\n    strSQL = \"UPDATE [Sonoco2016_xlsx] ([O_StateRegion])\"\n    strSQL = strSQL &amp; \" SELECT [StateRegion] FROM [tblStates]\"\n    strSQL = strSQL &amp; \" WHERE [tblStates].[StateAbbrev]='\" &amp; rs![OriginState] &amp; \"' \"\n\n    db.Execute (strSQL), dbFailOnError\n\nrs.MoveNext\nWend\nrs.Close\nSet rs = Nothing\nSet db = Nothing\n\nbtnInsertRegions_Exit:\n    Exit Sub\n\nInsertRegions_Err:\n    MsgBox Err.Description &amp; \" in btnInsertRegions\"\n    Resume btnInsertRegions_Exit\n\nEnd Sub\n</code></pre>\n\n<p>Below are my efforts to convert it to UPDATE</p>\n\n<pre><code>Private Sub btnInsertRegions_Click()\n\nOn Error GoTo InsertRegions_Err\n\nDim db As Database\nDim rs As Recordset\nDim strSQL As String\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"Select [OriginState] from [Sonoco2016_xlsx];\")\n\nrs.MoveFirst\nWhile Not rs.EOF\n\n    strSQL = \"UPDATE [Sonoco2016_xlsx] ([O_StateRegion])\"\n    strSQL = strSQL &amp; \" SET [Sonoco2016_xlsx].[O_StateRegion]=[tblStates].[StateRegion]\"\n    strSQL = strSQL &amp; \" WHERE [tblStates].[StateAbbrev] = '\" &amp; rs![OriginState] &amp; \"' \"\n\n    db.Execute (strSQL), dbFailOnError\n\nrs.MoveNext\nWend\nrs.Close\nSet rs = Nothing\nSet db = Nothing\n\nbtnInsertRegions_Exit:\n    Exit Sub\n\nInsertRegions_Err:\n    MsgBox Err.Description &amp; \" in btnInsertRegions\"\n    Resume btnInsertRegions_Exit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1482966397, "post_id": 41370841, "comment_id": 69943604, "body": "You&#39;d have to show the data, or use a more appropriate language like R - dplyr package. Do you know anything about VBA?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1482966848, "post_id": 41370841, "comment_id": 69943732, "body": "If you didn&#39;t need to move the data, but were willing to set a new set of 80 columns aside for the output (starting at column AA for instance), you could use a formula such as <code>=IF(IFERROR(MATCH(AA$1,$B2:$W2,0),0)=0,&quot;&quot;,AA$1)</code> in cell A2 and then copy it across the whole range (i.e. AA2:DB1000 or whatever)"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 4001735, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dayR9.jpg?s=128&g=1", "display_name": "scorpion", "link": "https://stackoverflow.com/users/4001735/scorpion"}, "is_accepted": false, "score": 0, "last_activity_date": 1483211177, "creation_date": 1483211177, "answer_id": 41411037, "question_id": 41370841, "link": "https://stackoverflow.com/questions/41370841/copy-data-to-column/41411037#41411037", "title": "Copy data to column", "body": "<p>You could use <code>countif</code> for occurrences of the numbers</p>\n\n<p><a href=\"https://i.stack.imgur.com/YqHc5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YqHc5.png\" alt=\"countif\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 7351744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4FAiTAteJIU/AAAAAAAAAAI/AAAAAAAAAKU/AM5Ox2dK2EA/photo.jpg?sz=128", "display_name": "Orkun GENC", "link": "https://stackoverflow.com/users/7351744/orkun-genc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1611356202, "creation_date": 1482965475, "last_edit_date": 1611356202, "question_id": 41370841, "link": "https://stackoverflow.com/questions/41370841/copy-data-to-column", "title": "Copy data to column", "body": "<p>I have a spreadsheet which contains 22 columns, each cell containing a number between 1 and 80.</p>\n<p>I would like to arrange it so that each column contains its own specific value.<br />\nThis means there will be 80 columns and, on each row, numbers will be shown under its own value.<br />\n<a href=\"https://i.stack.imgur.com/R54tF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R54tF.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Is there anyway to do it with copy/paste and filtering or does it need to be solved by VBA?</p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482964617, "post_id": 41370196, "comment_id": 69943048, "body": "very easy in VBA, very difficult if ever feasible without. I suggest you go on with VBA and we will be pleased to help you take it to a good end."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482967108, "post_id": 41370196, "comment_id": 69943809, "body": "Any particular reason you don&#39;t want a macro? A formula will be pretty tricky (well, maybe not considering the cleverness of some users here), but certainly VBA will be a much quicker solution.  Also, what have you tried so far?"}], "answers": [{"tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 1, "last_activity_date": 1482974920, "creation_date": 1482974920, "answer_id": 41372023, "question_id": 41370196, "link": "https://stackoverflow.com/questions/41370196/excel-combine-multiple-columns-into-one-if-data-exists/41372023#41372023", "title": "Excel - Combine Multiple Columns into One if Data Exists", "body": "<p>If you don't want to use Macros, you will at least need to use filter to avoid the blank rows (zeros rows in my solution).</p>\n\n<p>I have assumed your data lies in columns A, B and C</p>\n\n<p>In column D us the below formulae</p>\n\n<pre><code>=IF(MOD(ROW()+2,3)=0,INDEX(A:A,QUOTIENT(ROW()+2,3)),IF(MOD(ROW()+2,3)=1,INDEX(B:B,QUOTIENT(ROW()+2,3)),IF(MOD(ROW()+2,3)=2,INDEX(C:C,QUOTIENT(ROW()+2,3)),\"\")))\n</code></pre>\n\n<p>Drag the formula down as far as you can. the filter this column to remove zeros.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KGKR1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KGKR1.png\" alt=\"Screenshot\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "is_accepted": false, "score": 0, "last_activity_date": 1483004588, "creation_date": 1483004588, "answer_id": 41376994, "question_id": 41370196, "link": "https://stackoverflow.com/questions/41370196/excel-combine-multiple-columns-into-one-if-data-exists/41376994#41376994", "title": "Excel - Combine Multiple Columns into One if Data Exists", "body": "<p>If you don't want to use VBA macros I think that the best way to get it is to copy column B, the column C, then column D, ... one under each other, like this:</p>\n\n<pre><code>A\nC\nF\nG\nB\nD\n\nH\n\nE\n\nI\n</code></pre>\n\n<p>Then use the menu Data => Remove Duplicates to remove multiple spaces.</p>\n\n<p>If you change idea about using macros just search \"unpivot data Excel\" on Google and you'll find a plenty of solutions about it.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4424313, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3bcc040b6da2daf567acb3b1f9cfada?s=128&d=identicon&r=PG&f=1", "display_name": "vwalsh10", "link": "https://stackoverflow.com/users/4424313/vwalsh10"}, "edited": false, "score": 0, "creation_date": 1483111002, "post_id": 41382155, "comment_id": 69998750, "body": "updated &quot;Paste:=xlPasteAll&quot; to &quot;Paste:=xlPasteValues&quot; in the macro because there were formulas in the cells and I wanted values but both the regular formula and the macro worked. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7351900"}, "is_accepted": true, "score": 0, "last_activity_date": 1483023569, "creation_date": 1483023569, "answer_id": 41382155, "question_id": 41370196, "link": "https://stackoverflow.com/questions/41370196/excel-combine-multiple-columns-into-one-if-data-exists/41382155#41382155", "title": "Excel - Combine Multiple Columns into One if Data Exists", "body": "<p>I can think of a couple ways to do this.  Use the formula below.</p>\n\n<p>=INDEX(MyData,1+INT((ROW(A1)-1)/COLUMNS(MyData)),MOD(ROW(A1)-1+COLUMNS(MyData),COLUMNS(MyData))+1)</p>\n\n<p>This assumes 'MyData' is a named range.</p>\n\n<p>As an alternative, you could use a simple VBA script to do the job.</p>\n\n<pre><code>Sub ConvertRangeToColumn()\nDim Range1 As Range, Range2 As Range, Rng As Range\nDim rowIndex As Integer\nxTitleId = \"Title\"\nSet Range1 = Application.Selection\nSet Range1 = Application.InputBox(\"Source Ranges:\", xTitleId, Range1.Address, Type:=8)\nSet Range2 = Application.InputBox(\"Convert to (single cell):\", xTitleId, Type:=8)\nrowIndex = 0\nApplication.ScreenUpdating = False\nFor Each Rng In Range1.Rows\n    Rng.Copy\n    Range2.Offset(rowIndex, 0).PasteSpecial Paste:=xlPasteAll, Transpose:=True\n    rowIndex = rowIndex + Rng.Columns.Count\nNext\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4424313, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f3bcc040b6da2daf567acb3b1f9cfada?s=128&d=identicon&r=PG&f=1", "display_name": "vwalsh10", "link": "https://stackoverflow.com/users/4424313/vwalsh10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4053, "favorite_count": 0, "accepted_answer_id": 41382155, "answer_count": 3, "score": 0, "last_activity_date": 1483023569, "creation_date": 1482961780, "question_id": 41370196, "link": "https://stackoverflow.com/questions/41370196/excel-combine-multiple-columns-into-one-if-data-exists", "title": "Excel - Combine Multiple Columns into One if Data Exists", "body": "<p>I have multiple lists that are in separate columns in excel however some columns do not include data. What I need to do is combine these columns that do have data into one big column. </p>\n\n<pre><code>Row 1 | A B\nRow 2 | C D E\nRow 3 | F \nRow 4 | G H I\n</code></pre>\n\n<p>Should combine into:</p>\n\n<pre><code>A\nB\nC\nD\nE\nF\nG\nH \nI\n</code></pre>\n\n<p>With no blank rows in between. Would rather not use macros if possible.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-access", "multiple-columns"], "comments": [{"owner": {"reputation": 140, "user_id": 3828905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JzFtQ.jpg?s=128&g=1", "display_name": "Roie R", "link": "https://stackoverflow.com/users/3828905/roie-r"}, "edited": false, "score": 0, "creation_date": 1483865090, "post_id": 41369807, "comment_id": 70267216, "body": "Are your module and form in separate files? If not, your public function should be visible in form, you just call it by its name. If they are in separate files, you can reference the file containing the module in the form file then use the functions."}, {"owner": {"reputation": 104, "user_id": 6809754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4579e2cefd7d00c001e867f89e1259f?s=128&d=identicon&r=PG", "display_name": "Velid", "link": "https://stackoverflow.com/users/6809754/velid"}, "edited": false, "score": 0, "creation_date": 1483977938, "post_id": 41369807, "comment_id": 70309246, "body": "Can you add example text file you are trying to import?  I don&#39;t see where you use function &#39;ImportFile&#39;, nor I see why do you have functions instead of subs. (function should return a value, like True if completed). Where are those modules places?"}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 104, "user_id": 6809754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4579e2cefd7d00c001e867f89e1259f?s=128&d=identicon&r=PG", "display_name": "Velid", "link": "https://stackoverflow.com/users/6809754/velid"}, "edited": false, "score": 0, "creation_date": 1483996518, "post_id": 41369807, "comment_id": 70319475, "body": "@Velid I have added the full code. I will shortly provide an example of the text file. I am not trying to unzip the files, just grab the text files off a path on the local network and import them into my database."}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 104, "user_id": 6809754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4579e2cefd7d00c001e867f89e1259f?s=128&d=identicon&r=PG", "display_name": "Velid", "link": "https://stackoverflow.com/users/6809754/velid"}, "edited": false, "score": 0, "creation_date": 1483997604, "post_id": 41369807, "comment_id": 70320051, "body": "@Velid I added an example of the text file"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1484339466, "post_id": 41369807, "comment_id": 70485807, "body": "Are you still there?"}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1484340436, "post_id": 41369807, "comment_id": 70486235, "body": "@Andre yes still here, still trying to figure out how to import using VB"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1484388235, "post_id": 41369807, "comment_id": 70496561, "body": "Ok. If you can tell us <i>where</i> the problem is, we will probably be able to help. This is worth reading: <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debugging VBA Code</a>"}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1484673917, "post_id": 41369807, "comment_id": 70602431, "body": "@Andre Hi Andre, the problem I am having is automatically importing text files. I have a form where a user enters a date in a field and clicks import. Once import is clicked, I want it to fetch a file that has that date within the file name and import it into one table. I am able to do this manually using the import function."}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1484687095, "post_id": 41369807, "comment_id": 70609434, "body": "@Andre I have created a new post with different code and details as well to focus more on importing: <a href=\"http://stackoverflow.com/questions/41642240/importing-using-vb-not-manual-import\" title=\"importing using vb not manual import\">stackoverflow.com/questions/41642240/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 4, "last_activity_date": 1506029727, "last_edit_date": 1506029727, "creation_date": 1484002795, "answer_id": 41558415, "question_id": 41369807, "link": "https://stackoverflow.com/questions/41369807/importing-text-files-vb-access/41558415#41558415", "title": "Importing text files - Vb/Access", "body": "<p>If I understand it correctly, your problem lies here:</p>\n\n<pre><code>DoCmd.TransferText acImportFixed, \"COMPRPT_2016\", \"COMPRPT_CE\", filepath &amp; txtFile, False  '&lt;--does path go here?\n</code></pre>\n\n<p>But you have unzipped to <code>tempPath</code>, so that should be </p>\n\n<pre><code>DoCmd.TransferText acImportFixed, \"COMPRPT_2016\", \"COMPRPT_CE\", tempPath &amp; txtFile, False\n</code></pre>\n\n<p>Working with network files is generally slower than with local files, so I would make <code>tempPath</code> a local path.</p>\n\n<p>Edit: Note that to make <code>tempPath &amp; txtFile</code> work, <code>tempPath</code> must end with a <code>\\</code>:<br>\n<code>tempPath = \"C:\\XXXXXX\\XXXXX\\XXXXX\\XX\\\"</code></p>\n\n<hr>\n\n<p>Additional problems with your code:</p>\n\n<p>1 - First and foremost, use <code>Option Explicit</code>, see <a href=\"https://stackoverflow.com/a/38002045/3820271\">this question</a> for details. </p>\n\n<p>You have multiple undeclared or misspelled variables, e.g. <code>fFound</code>, and <code>oApp</code> vs. <code>app</code>.</p>\n\n<p>2 - This is an error just waiting to happen:</p>\n\n<pre><code>reportDate = Format(txtReportDate, \"YYMMDD\")\nreportGenDate = Format(textReportDate, \"YYYYMMDD\")\n</code></pre>\n\n<p>Name the second textbox <code>txtReportGenDate</code>, not <code>textReportDate</code>.</p>\n\n<p>3 - In <code>ImportAll()</code>, all this isn't needed, since you don't use the RecordCount:</p>\n\n<pre><code>rs.MoveLast \nrs.MoveFirst \nIf rs.RecordCount &gt; 0 Then\n</code></pre>\n\n<p>4 - This is wrong syntax:</p>\n\n<pre><code>DeleteContract (contract)\n</code></pre>\n\n<p>It works for a single argument, but will fail for subs with >1 parameters.</p>\n\n<p>Use</p>\n\n<pre><code>DeleteContract contract\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Call DeleteContract(contract)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>retVal = DeleteContract(contract)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 2, "last_activity_date": 1484062914, "last_edit_date": 1484062914, "creation_date": 1484062367, "answer_id": 41572474, "question_id": 41369807, "link": "https://stackoverflow.com/questions/41369807/importing-text-files-vb-access/41572474#41572474", "title": "Importing text files - Vb/Access", "body": "<blockquote>\n  <p>I am confused on how to merge a form and module to work together. How does the button on the form, call out this module for execution?</p>\n</blockquote>\n\n<p>Objects and procedures can be considered public or private. For example: -</p>\n\n<pre><code>Private Sub Test\n    Msgbox \"Hello World!\"\nEnd Sub\n</code></pre>\n\n<p>Is private, this means only its parent can call upon it. To elaborate on this, Lets create two modules <code>Module1</code> and <code>Module2</code> and place our <code>private sub Test</code> in <code>Module1</code>.</p>\n\n<p>Also in <code>Module1</code> we another private procedure: -</p>\n\n<pre><code>Private Sub Test2\n    Msgbox \"Back at ya\"\nEnd Sub\n</code></pre>\n\n<p><code>Module1</code> is the parent of <code>Test</code> and <code>Test2</code>, as they have the same parent they can run each other: -</p>\n\n<pre><code>Private Sub Test\n    Msgbox \"Hello World!\"\n    Test2 'This will run the Test2 procedure\nEnd Sub\n</code></pre>\n\n<p><code>Module2</code> can not run any of them because it has no view f them, its not involved.</p>\n\n<p>Now if we change <code>Test</code> to be public (<code>Public Sub Test</code>), <code>Module2</code> will be able to see it as it has been exposed.</p>\n\n<p>In <code>Module2</code> we have: -</p>\n\n<pre><code>Public Sub Test3\n    Module1.Test    'This will run as it is public\n    Module1.Test2   'This will fail as it is private\nEnd Sub\n</code></pre>\n\n<p>There is also this way too call them from Module two: -</p>\n\n<pre><code>Public Sub Test3\n    Test    'This will run as it is public\n    Test2   'This will fail as it is private\nEnd Sub\n</code></pre>\n\n<p>This is not explicit though and can cause error and confusion, you can have a procedure in <code>Module2</code> that is also called <code>Test</code>, how would you know which test <code>Test3</code> is running? To be safe you explicit write its location as <code>Module1.Test</code>.</p>\n"}], "owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2109, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1506029727, "creation_date": 1482959687, "last_edit_date": 1483997580, "question_id": 41369807, "link": "https://stackoverflow.com/questions/41369807/importing-text-files-vb-access", "title": "Importing text files - Vb/Access", "body": "<p>What I am trying to do is map my button (import button on my form) to import text files (the text file would actually be on a network drive). These text files are fixed columns. I am confused on how to merge a form and module to work together. How does the button on the form, call out this module for execution? Also, if there is a more efficient way to import these fixed text files, I would appreciate it.</p>\n\n<p>I currently have the following VBA code setup for my form (will be used to Import text files into my Access database):</p>\n\n<pre><code>Private Sub cmdImport_Click()\n\nOn Error GoTo Click_Err\n\n    reportDate = Format(txtReportDate, \"YYMMDD\")\n    reportGenDate = Format(textReportDate, \"YYYYMMDD\")\n    rDate = txtReportDate\n\n    If Nz(txtReportDate, \"\") = \"\" Then\n        MsgBox \"NOTICE! Please enter the Report Month you wish to Import.\"\n        Exit Sub\n    End If\n\n    DoCmd.Hourglass True\n    DoCmd.SetWarnings False\n\n    ImportAll\n\n    DoCmd.Hourglass False\n    DoCmd.SetWarnings True\n    MsgBox \"Finished Importing!\"\n    DoCmd.OpenQuery \"query_Files_Loaded_CE\", acViewNormal, acReadOnly\n\nclick_Exit:\n    DoCmd.Hourglass False\n    DoCmd.SetWarnings True\n    Exit Sub\n\nClick_Err:\n    DoCmd.Hourglass False\n    MsgBox \"Error Detected: \" &amp; Err.Number &amp; \" - \" &amp; Err.Description, vbCritical, \"Error\"\n    Resume click_Exit\nEnd Sub\n</code></pre>\n\n<p>For my module (please excuse the notes):</p>\n\n<pre><code>    Option Compare Database\nPublic reportDate As String\nPublic reportGenDate As String\nPublic rDate As Date\n\n    Public Function Import2010()\n    'Used to import a date range\n    Dim funcDate As Date '\n    funcDate = #2/1/2016#\n    reportDate = Format(funcDate, \"YYMM\")\n    rDate = funcDate\n\n    'Basically Do While is a loop so what your doing here as long as the value of the date does not EQUAL 3/1/2016\n    'excute the nexxt line of code other wise exit this loop\n    Do While funcDate &lt;&gt; #3/1/2016#\n        DoCmd.SetWarnings False\n        'ImportAll\n        ImportFile \"H3561\"\n        'Msg Box reportDate\n        funcDate = DateAdd(\"m\", 1, funcDate)\n        reportDate = Format(funcDate, \"YYMM\")\n        rDate = funcDate\n    Loop\n\n    DoCmd.SetWarnings True\n\nEnd Function\n\nPublic Function ImportAll() ' Import button on FrmIMport\n\n    'A recordset is a selection of records from a table or query.\n    'Dim is short for the word Dimension and it allows you to declare variable names and their type.\n    'When you read data from the database in VBA, the result will be in a recordset (with the exception of scalar data).\n    Dim rs As Recordset\n    Dim sql As String\n\n    'This code loops through the recordset of all contracts and import files, as in it looks for\n    'Specific value based off a specific condition.\n\n    sql = \"SELECT DISTINCT Contract FROM Contract_CE\"\n    Set rs = CurrentDb.OpenRecordset(sql)\n    rs.MoveLast 'This method is used to move to the last record in a Recordset object. It also makes the last record the current record.\n    rs.MoveFirst 'This method is used to move to the first record in a Recordset object. It also makes the first record the current record.\n    If rs.RecordCount &gt; 0 Then\n        Do While rs.EOF = False\n            ImportFile rs!contract\n            rs.MoveNext 'This method is used to move to the next record in a Recordset object. It also makes the \"next\" record the current record.\n        Loop\n    End If\n\nEnd Function\n\nPublic Function ImportFile(contract As String)\n\n    Dim filepath As String\n    Dim tempPath As String\n    Dim zipFile As String\n\n    'Set paths\n    filepath = \"\\\\XXXXX\\XXXXX\\XXXXX\\XXXXXXX\"\n   'tempPath = \n    tempPath = \"\\\\XXXXXX\\XXXXX\\XXXXX\\XX\"\n\n    'Find the file\n    zipFile = GetFile(filepath)\n\n    'check if file exists\n    If zipFile = \"\" Then\n        'DoCmd.Hourglass False\n        'MsgBox contract &amp; \" \" &amp; reportDate &amp; \" File could not be located.\"\n        'DoCmd.Hourglass True\n        LogFail (contract)\n        Exit Function\n    End If\n\n    'Clearing out existing Contract/ReportDate data from Table\n    DeleteContract (contract)\n\n    'Delete all files in temp folder\n    DeleteAllFiles (tempPath)\n\n    'UnzipFile txt to temp folder\n    UnZip filepath &amp; zipFile, tempPath\n\n    'Get txt file namee\n    txtFile = Replace(zipFile, \".zip\", \".txt\")\n\n    DoEvents\n    Sleep 10000 'wait for file to unzip\n\n    'The TransferText method is used to import/export text between the current Access database or Access project and a text file located\n    'externally to your database. You can also use this command to link to data in a text file. Additionally, can import from, export to, and link to a table in an HTML file.\n    'Importing txt file\n    'Depcreated - Alec Johnson - 5/12/2016 - Created new import spec\n    'DoCMD.TransferText acImportFixed, \"ImportSpec_COMPRPT\", tempPath &amp; txtfile, False\n    DoCmd.TransferText acImportFixed, \"COMPRPT_2016\", \"COMPRPT_CE\", filepath &amp; txtFile, False  '&lt;--does path go here?\n\n    'Update FileName\n    UpdateFileName (zipFile)\n\n    'Delete txt file from location\n    DeleteAllFiles (tempPath)\n\n    'Delete any Null records added to main table\n    DeleteNulls\n\n    'Log to table if successful\n    LogSuccess (contract)\n\nEnd Function\n\nPublic Function DeleteAllFiles(path As String)\n\n'Delete all files in this folder\nOn Error Resume Next\nKill path &amp; \"*.*\"\nEnd Function\n\nFunction UnZip(filename As String, destinationPath As String)\n'FileSystemObject also called as FSO, provides an easy object based model to access computer\u2019s file system.\n'You simply have to create an instance of FileSystemObject in VBA and then you can generate files, read files, delete files,\n'iterate though folders and do many other operations on your computer\u2019s file system.\n\n\n    'Unzip file (s) to destination\n    Dim app As Object\n    Dim zipFile As Variant, unzipTo As Variant\n\n    zipFile = filename\n    unzipTo = destinationPath\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    If Not FSO.FolderExists(unzipTo) Then\n        FSO.CreateFolder (unzipTo)\n    End If\n\n    'If you want to extract only file you can use this:\n    'oApp.Namespace(FileNameFolder).CopyHere _\n    'oApp.Namespace(Fname).items.items(\"test.txt\")\n\n    Set oApp = CreateObject(\"Shell.Application\")\n\n    oApp.Namespace(unzipTo).CopyHere oApp.Namespace(zipFile).Items\n\n    Set FSO = Nothing\n\nEnd Function\n\nPublic Function GetFile(filepath As String) As String\n\n    Dim fileNamePart As String\n    Dim fCheck\n\n    fileNamePart = \"COMPRPT_\" + reportDate\n    fCheck = \"\"\n    fFound = \"\"\n\n    Set oFolder = CreateObject(\"scripting.filesystemobject\").GetFolder(filepath)\n    For Each aFile In oFolder.Files\n        Set fCheck = aFile\n        If InStr(fCheck.Name, fileNamePart) Then\n            Set fFound = aFile\n            End If\n        Next\n\n        If fFound = \"\" Then\n            GetFile = \"\"\n        Else\n            GetFile = fFound.Name\n        End If\n\nEnd Function\n\nPublic Function DeleteContract(contract As String)\n\n    Dim sql As String\n    sql = \"Delete * FROM COMPRPT WHERE ContractNumber = '\" &amp; contract &amp; \"' AND ReportGenerationDate = '\" &amp; reportGenDate &amp; \"'\"\n    DoCmd.RunSQL sql\nEnd Function\n\nPublic Function LogSuccess(contract As String)\n\n    Dim sql As String\n    sql = \"INSERT INTO FilesLoaded (Contract, ReportDate, Loaded) VALUES ('\" &amp; contract &amp; \"', #\" &amp; rDate &amp; \"#, -1)\"\n    DoCmd.RunSQL sql\n\nEnd Function\n\n\nPublic Function DeleteNulls()\n\n    Dim sql As String\n    sql = \"DELETE * FROM COMPRPT WHERE ContractNumber Is Null\"\n    DoCmd.RunSQL sql\n\n\nEnd Function\n\nPublic Function lksjdlaskjd()\n\n    ImportFile \"H0351\", #4/1/2009#\nEnd Function\n</code></pre>\n\n<p>Here is an example of a text file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ltkzv.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ltkzv.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1482960097, "post_id": 41369724, "comment_id": 69941362, "body": "Does the number of columns change, or just the number of rows? Look into <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">this simple code</a> to determine the last row .."}], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1482961980, "creation_date": 1482961980, "answer_id": 41370227, "question_id": 41369724, "link": "https://stackoverflow.com/questions/41369724/creating-dynamic-range-in-pivot-table/41370227#41370227", "title": "Creating Dynamic Range in Pivot Table", "body": "<p>Change your range to a variable - like RNG\nThe calculate the range , how ever you plan to do it.  Last row, last column, last cell address, etc\nThen make the code soething like this</p>\n\n<pre><code>    Lastrow = ActiveSheet..Range(\"B\" &amp; Worksheets(\"All_Data\").Rows.Count).End(xlUp).Row\n    RNG = \"A1:\"G\" &amp; Lastrow\n    SrcData = ActiveSheet.Name &amp; \"!\" &amp; Range(RNG).Address(ReferenceStyle:=xlR1C1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1482992370, "creation_date": 1482992370, "answer_id": 41374185, "question_id": 41369724, "link": "https://stackoverflow.com/questions/41369724/creating-dynamic-range-in-pivot-table/41374185#41374185", "title": "Creating Dynamic Range in Pivot Table", "body": "<p><strong>Assumption</strong> - your Pivot Table's dynamic range is changing by the number of rows added (or distracted), while the number of columns stays constant.</p>\n\n<p>Instead of using <code>ActiveSheet</code>, try using referenced objects, like <code>Set SrcSht = Worksheets(\"Sheet1\")</code> and then use that variable.</p>\n\n<p>Try the code below (some of my other modifications are inside the code's notes).</p>\n\n<pre><code>Option Explicit\n\nSub Create_Pivot_DynamicRange()\n\nDim sht As Worksheet\nDim pvtCache As PivotCache\nDim pvt As PivotTable\nDim StartPvt As Range\nDim SrcData As String\nDim pf As PivotField\n\nDim SrcSht As Worksheet, LastRow As Long\n\n' modify \"Sheet1\" to your sheet's name\nSet SrcSht = Worksheets(\"Sheet1\")\n\nWith SrcSht\n    ' find last row with data in Column A (skip blank cells in the middle)\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    ' set source data to dynamic number of rows (string)\n    SrcData = .Name &amp; \"!\" &amp; .Range(\"A1:G\" &amp; LastRow).Address(ReferenceStyle:=xlR1C1)\nEnd With\n\nSet sht = Sheets.Add\n\n' set the start position directly to a Range (there's no need to use a String as a \"middle-man\")\nSet StartPvt = sht.Range(\"A1\")\n\nSet pvtCache = ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=SrcData)\n\nSet pvt = pvtCache.CreatePivotTable( _\n    TableDestination:=StartPvt, _\n    TableName:=\"PivotTable1\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7173975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90f95a75336687cf064b81ce7256e28b?s=128&d=identicon&r=PG&f=1", "display_name": "user7173975", "link": "https://stackoverflow.com/users/7173975/user7173975"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 41374185, "answer_count": 2, "score": 0, "last_activity_date": 1482992370, "creation_date": 1482959323, "question_id": 41369724, "link": "https://stackoverflow.com/questions/41369724/creating-dynamic-range-in-pivot-table", "title": "Creating Dynamic Range in Pivot Table", "body": "<p>I'm trying to change my fixed range (A1:G4193) to one that's dynamic due to the need for new data to be entered on a daily basis.  </p>\n\n<p>Here is my code: </p>\n\n<pre><code>Sub Create_Pivot()\n\nDim sht As Worksheet\nDim pvtCache As PivotCache\nDim pvt As PivotTable\nDim StartPvt As String\nDim SrcData As String\nDim pf As PivotField\n\nSrcData = ActiveSheet.Name &amp; \"!\" &amp; Range(\"A1:G4193\").Address(ReferenceStyle:=xlR1C1)\n\nSet sht = Sheets.Add\n\nStartPvt = sht.Name &amp; \"!\" &amp; sht.Range(\"A1\").Address(ReferenceStyle:=xlR1C1)\n\nSet pvtCache = ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=SrcData)\n\nSet pvt = pvtCache.CreatePivotTable( _\n    TableDestination:=StartPvt, _\n    TableName:=\"PivotTable1\")\n</code></pre>\n\n<p>I highly appreciate any help. Thanks!</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "userform"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482958721, "post_id": 41369387, "comment_id": 69940820, "body": "What is the value of <code>i</code>, and of <code>ActiveWorkbook.Sheets(i).Name</code> when it crashes?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482959534, "post_id": 41369387, "comment_id": 69941155, "body": "Difficult to diagnose, we don&#39;t have enough elements but clearly the problem is on that specific computer. I would try a fresh install."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482959751, "post_id": 41369387, "comment_id": 69941239, "body": "BTW, are you using ActiveX Controls on that form? (.OCX)"}, {"owner": {"reputation": 1583, "user_id": 3705492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/042dbbc966f6f20285761d42b09f7298?s=128&d=identicon&r=PG", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/3705492/jose-ramirez"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482965023, "post_id": 41369387, "comment_id": 69943198, "body": "@YowE3K I&#39;m not sure as I am not near her computer anymore but the list box didn&#39;t generate at all, so the error must&#39;ve occurred during the first loop."}, {"owner": {"reputation": 1583, "user_id": 3705492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/042dbbc966f6f20285761d42b09f7298?s=128&d=identicon&r=PG", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/3705492/jose-ramirez"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482965047, "post_id": 41369387, "comment_id": 69943210, "body": "@A.S.H No ActiveX controls at all; just the regular ones."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1482965723, "post_id": 41369387, "comment_id": 69943421, "body": "Oh BTW, why those parentheses in the statement? ^-^ I would not be much surprized if omitting them solves the error message."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1482966439, "post_id": 41369387, "comment_id": 69943620, "body": "Do you have <code>Option Base 1</code> but start the i with 0? Alternatively use <code>Dim oWS As Worksheet : For Each oWS In ActiveWorkbook.Worksheets : ExportForm.SheetListBox.AddItem oWS.Name : Next</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482966824, "post_id": 41369387, "comment_id": 69943727, "body": "Ok those parentheses work most of the time, but basically, they are a syntax error (and more precisely, they have some side effects). You should remove them and see what will happen."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482991435, "post_id": 41369387, "comment_id": 69949585, "body": "When you get to your computer, upload the rest of your relevant code"}, {"owner": {"reputation": 1583, "user_id": 3705492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/042dbbc966f6f20285761d42b09f7298?s=128&d=identicon&r=PG", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/3705492/jose-ramirez"}, "edited": false, "score": 0, "creation_date": 1483041455, "post_id": 41369387, "comment_id": 69975046, "body": "Added rest of the code; will check the removal of the parenthesis later on my coworkers computer."}], "owner": {"reputation": 1583, "user_id": 3705492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/042dbbc966f6f20285761d42b09f7298?s=128&d=identicon&r=PG", "display_name": "Jose Ramirez", "link": "https://stackoverflow.com/users/3705492/jose-ramirez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1483041417, "creation_date": 1482957505, "last_edit_date": 1531164843, "question_id": 41369387, "link": "https://stackoverflow.com/questions/41369387/class-does-not-support-aggregation-when-adding-items-to-a-list-box", "title": "Class does not support aggregation when adding items to a list box?", "body": "<p>I created an excel file in Excel 2010 (Windows 7) that generates a certain number of sheets depending on the input data. I also created a user form that lists all the sheets in a list box.</p>\n\n<p>It works perfect on my computer, all of it. I recently let my coworker use it who is also running Excel 2010 on Windows 7 but her Excel gives a system error when pressing the export button. Any subsequent tries I tried just makes Excel not respond at all and close itself out.</p>\n\n<p>This is the error they are getting:</p>\n\n<blockquote>\n  <p>System Error &amp;H80040110 (-2147221232). Class does not support aggregation (or class object is remote).</p>\n</blockquote>\n\n<p>It gives me the option to debug and it takes me to this line of code. ExportForm is the name of the user form, SheetListBox is the name of the list box. All it does is add each sheet to the list box.</p>\n\n<pre><code>ExportForm.SheetListBox.AddItem (ActiveWorkbook.Sheets(i).Name)\n</code></pre>\n\n<p>Like I said, it all works fine on my computer and my other coworkers computer who run the same Excel 2010 and Window 7, but only errors on 1 of my coworkers computer.</p>\n\n<p>As asked, here's the entire piece of code that relates to the PDF Export button that errors. This is the code that generates the list box in the user form.</p>\n\n<pre><code>Sub PDFExport()\n\n    'Prevents screen lag and faster code processing\n    Application.ScreenUpdating = False\n\n    Dim ws As Worksheet\n\n    'Increments the list if the BOL starts with the right name\n    Dim i As Integer\n    For i = 1 To ActiveWorkbook.Sheets.Count\n        Set ws = ActiveWorkbook.Sheets(i)\n        If InStr(ws.Name, \"Bol #\") Then\n            ExportForm.SheetListBox.AddItem (ActiveWorkbook.Sheets(i).Name)\n        End If\n    Next i\n\n    'Selects all the rows by default\n    For i = 0 To ExportForm.SheetListBox.ListCount - 1\n        ExportForm.SheetListBox.Selected(i) = True\n    Next i\n\n    'Position the window before it appears\n    ExportForm.StartUpPosition = 0\n    ExportForm.Top = Application.Top + 250\n    ExportForm.Left = Application.Left + Application.Width - ExportForm.Width - 400\n    ExportForm.Show\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482958508, "post_id": 41369304, "comment_id": 69940710, "body": "I have a sense of deja-vu.  I am sure I have seen that image before not long ago, but can&#39;t find the question it occurred in."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482958677, "post_id": 41369304, "comment_id": 69940804, "body": "@YowE3K I know what you are talking about it was a similar pic but the question wasn&#39;t answered."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482958932, "post_id": 41369304, "comment_id": 69940913, "body": "If you just wanted the contents of the &quot;department 60&quot; section of the source copied to a &quot;Department 60&quot; sheet, this wouldn&#39;t be all that difficult.  But the fact that it appears that there is no correlation between the department number and the destination sheet name is going to be problematic."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482958994, "post_id": 41369304, "comment_id": 69940938, "body": "Also, how does the file <b>start</b>?  And do you need the &quot;half&quot; lines copied to the destination sheets, or just the &quot;full&quot; lines, i.e. rows 136:141 for department 60?"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482972933, "post_id": 41369304, "comment_id": 69945361, "body": "@YowE3K yes there is no correlation between the department number and the designated sheet and the full and half line both need to be copied under department 60 but the difficulty part is that these departments come in various length some are only 5 line and others"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482973062, "post_id": 41369304, "comment_id": 69945387, "body": "can be lengthy as 100 lines. So the problem was how to make the macro stop when it finished with a department and then continue on with the next department without create 80 different macros for each department and copy everything in department"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482978917, "post_id": 41369304, "comment_id": 69946523, "body": "I can write you some code, that&#39;s quite simple, but it would be even easier if I knew how the data looks at the start of the file.  Is there any chance you could paste in a screenshot of the first 10 lines (or to the start of the second department if that is further down than row 10)?"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482979514, "post_id": 41369304, "comment_id": 69946652, "body": "Yeah absolutely I will in a few hours."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483024792, "post_id": 41369304, "comment_id": 69966866, "body": "@YowE3K Is there a way I chat with you privately?"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483025640, "post_id": 41369304, "comment_id": 69967362, "body": "@YowE3K There have some major changes, sorry if this makes it difficult."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1483030863, "post_id": 41369304, "comment_id": 69970193, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/131825/discussion-between-yowe3k-and-mtbthepro\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1483033971, "creation_date": 1483033971, "answer_id": 41384836, "question_id": 41369304, "link": "https://stackoverflow.com/questions/41369304/vba-copying-segments-of-data-onto-another-sheet/41384836#41384836", "title": "VBA: Copying Segments of data onto another sheet", "body": "<p>Based on our chat, I believe the following code will split your data into the sheets you have already set up:</p>\n\n<pre><code>Sub AllocateDepartmentData()\n    Dim prevRow As Long\n    Dim deptRow As Long\n    Dim deptNum As Variant\n    Dim destSheet As String\n    Dim destRow As Long\n    prevRow = 0\n    'Find the end of the first section\n    deptRow = Range(\"A:A\").Find(What:=\"Department\", LookIn:=xlValues, LookAt:=xlPart).Row\n    Do While deptRow &gt; prevRow\n        'Parse the cell containing the department number/name to get just the number\n        deptNum = Cells(deptRow, 1).Value\n        deptNum = Mid(deptNum, InStr(deptNum, \" \") + 1)\n        deptNum = CInt(Left(deptNum, InStr(deptNum &amp; \" \", \" \") - 1))\n        'Based on the department number, determine the destination sheet\n        Select Case deptNum\n            'One \"Case\" statement should be set for each destination sheet name\n            Case 1, 2, 60, 61, 63\n                destSheet = \"Amanda\"\n            'Add more \"Case\" statements for each sheet\n            Case 73, 74\n                destSheet = \"Shannon\"\n            'And finally catch any departments that haven't been allocated to a sheet\n            Case Else\n                MsgBox \"Department \" &amp; deptNum &amp; \" has not been allocated to anyone!\"\n                End\n        End Select\n        With Worksheets(destSheet)\n            'Work out which row to copy to\n            destRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n            'destRow will be 2 if the sheet was currently empty, so adjust to be 1 instead\n            If destRow = 2 Then destRow = 1\n            'Copy everything from the end of the previous section to the end of this section\n            Rows((prevRow + 1) &amp; \":\" &amp; deptRow).Copy Destination:=.Range(\"A\" &amp; destRow)\n        End With\n        'Set up for next section\n        prevRow = deptRow\n        deptRow = Range(\"A:A\").FindNext(Cells(deptRow, \"A\")).Row\n        'The loop will stop once the newly found \"Department\" is on a row before the last processed section\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 41384836, "answer_count": 1, "score": 1, "last_activity_date": 1483033971, "creation_date": 1482957105, "last_edit_date": 1483025520, "question_id": 41369304, "link": "https://stackoverflow.com/questions/41369304/vba-copying-segments-of-data-onto-another-sheet", "title": "VBA: Copying Segments of data onto another sheet", "body": "<p>First thing, I am a newbie with VBA please be gentle. My code is below the picture and this code has to read <code>Department #</code> and copy everything that comes under the <code>Department #</code> until the next <code>Department #</code> approaches and paste the copied data into an assigned sheet for that Departments.</p>\n\n<p>In this picture, <code>Department 73</code> starts in <em>(A1:H1)</em> ends at <em>(A30:H30)</em>. The next Department start at line 31 and ends at line 37. The thing is that there are 80 departments and each of them has its own sheet. This excel files comes formatted this way. Is it possible to write a macro that can locate Departments # by reading accounts and copies three lines above it and <strong>ONLY</strong> its own values which are under it until it reaches the next department members \nand paste those values into an assigned sheet. Like department 3, department 5.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TYDCR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TYDCR.png\" alt=\"enter image description here\"></a>\nThis code is just brainstorming, I don't exactly know how to code this...Please help if you have experience. </p>\n\n<pre><code>   Sub copyingdata()\n\n   Dim sec1 As Long\n\n   Dim Counter As Integer\n   Dim MyString As String\n\n   MyString = \"Department 63\"\n   For i = 1 To Len(MyString)\n\n   sec1 = WorksheetFunction.Match(\"Department 60\", .Columns(\"A\"), 0)\n   sec1.Resize(i).Select\n\n   Selection\n   Sheets(\"Sheet1\").Selection.Copy Destination:=Sheets(\"Amanda\").Range(\"A1\")\n   Sheets(\"Sheet1\").Selection.Copy\n   Sheets(\"Amanda\").Activate\n   Range(\"A1\").Select\n   ActiveSheet.Paste\n   Application.CutCopyMode = False\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482954783, "post_id": 41368765, "comment_id": 69939161, "body": "Not sure what you&#39;re after - N/A <b><i>is</i></b> an error."}, {"owner": {"reputation": 11, "user_id": 7351315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfc85bd77307622c40f2d56cede3a1e?s=128&d=identicon&r=PG&f=1", "display_name": "PacMan", "link": "https://stackoverflow.com/users/7351315/pacman"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1483073169, "post_id": 41368765, "comment_id": 69983620, "body": "N/A as in the string &quot;N/A&quot;, not the error..."}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 7327049, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DI45UPngpOs/AAAAAAAAAAI/AAAAAAAAAeU/D193Rb4gm8Y/photo.jpg?sz=128", "display_name": "mike morris", "link": "https://stackoverflow.com/users/7327049/mike-morris"}, "is_accepted": false, "score": 0, "last_activity_date": 1482955322, "last_edit_date": 1482955322, "creation_date": 1482954881, "answer_id": 41368842, "question_id": 41368765, "link": "https://stackoverflow.com/questions/41368765/vba-wrap-iferror-modification/41368842#41368842", "title": "VBA Wrap IFERROR Modification", "body": "<p>The answer lies in changing the value of End_String in the following code block:</p>\n\n<pre><code>'Determine How we want to modify formula\n  If Right(MyFormula, 3) = TestEnd1 And TestStart = \"=IFERROR(\" Then\n    Beg_String = \"\"\n    End_String = \"0)\" '=IFERROR([formula],0)\n    AlreadyIFERROR = True\n  ElseIf Right(MyFormula, 3) = \",0)\" And TestStart = \"=IFERROR(\" Then\n    RemoveIFERROR = True\n  Else\n    Beg_String = \"=IFERROR(\"\n    End_String = \",\" &amp; Chr(34) &amp; Chr(34) &amp; \")\" '=IFERROR([formula],\"\")\n    AlreadyIFERROR = False\n  End If\n</code></pre>\n\n<p>For example, instead the</p>\n\n<pre><code>&amp; Chr(34) &amp; Chr(34) &amp; \")\"\n</code></pre>\n\n<p>you could substitute:</p>\n\n<pre><code>&amp; \"NA())\"\n</code></pre>\n\n<p>Is that close to what you were looking for?</p>\n"}], "owner": {"reputation": 11, "user_id": 7351315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfc85bd77307622c40f2d56cede3a1e?s=128&d=identicon&r=PG&f=1", "display_name": "PacMan", "link": "https://stackoverflow.com/users/7351315/pacman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482955322, "creation_date": 1482954536, "question_id": 41368765, "link": "https://stackoverflow.com/questions/41368765/vba-wrap-iferror-modification", "title": "VBA Wrap IFERROR Modification", "body": "<p>I am very rusty with VBA and as such I expect this will be an easy modification for those who are more well versed with VBA. I want to modify the below formula to allow me to have my IFERROR function return either 0 , \"\" , or n/a in the event of an error. Currently the code I found online is perfect but does not return n/a. If someone knows how to quickly add a block of code that allows the third option to cycle through would appreciate it. The code is from www.TheSpreadsheetGuru.com</p>\n\n<pre><code>Sub WrapIfError_v2()\n\n'PURPOSE: Add an IFERROR() Function around all the selected cells' formulas. _\n          Also handles if IFERROR is already wrapped around formula.\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim rng As Range\nDim cell As Range\nDim AlreadyIFERROR As Boolean\nDim RemoveIFERROR As Boolean\nDim TestEnd1 As String\nDim TestEnd2 As String\nDim TestEnd3 As String\nDim TestStart As String\nDim MyFormula As String\nDim x As String\n\n'Determine if a single cell or range is selected\n  If Selection.Cells.Count = 1 Then\n    Set rng = Selection\n    If Not rng.HasFormula Then GoTo NoFormulas\n  Else\n    'Get Range of Cells that Only Contain Formulas\n      On Error GoTo NoFormulas\n        Set rng = Selection.SpecialCells(xlCellTypeFormulas)\n      On Error GoTo 0\n  End If\n\n'Get formula from First cell in Selected Range\n  MyFormula = rng(1, 1).Formula\n\n'Create Test Strings To Determine if IFERROR formula has already been added\n  TestEnd1 = Chr(34) &amp; Chr(34) &amp; \")\"\n  TestEnd2 = \",0)\"\n  TestStart = Left(MyFormula, 9)\n\n'Determine How we want to modify formula\n  If Right(MyFormula, 3) = TestEnd1 And TestStart = \"=IFERROR(\" Then\n    Beg_String = \"\"\n    End_String = \"0)\" '=IFERROR([formula],0)\n    AlreadyIFERROR = True\n  ElseIf Right(MyFormula, 3) = \",0)\" And TestStart = \"=IFERROR(\" Then\n    RemoveIFERROR = True\n  Else\n    Beg_String = \"=IFERROR(\"\n    End_String = \",\" &amp; Chr(34) &amp; Chr(34) &amp; \")\" '=IFERROR([formula],\"\")\n    AlreadyIFERROR = False\n  End If\n\n'Loop Through Each Cell in Range and modify formula\n  For Each cell In rng.Cells\n    x = cell.Formula\n\n    If RemoveIFERROR = True Then\n      cell = \"=\" &amp; Mid(x, 10, Len(x) - 12)\n    ElseIf AlreadyIFERROR = False Then\n      cell = Beg_String &amp; Right(x, Len(x) - 1) &amp; End_String\n    Else\n      cell = Left(x, Len(x) - 3) &amp; End_String\n    End If\n\n  Next cell\n\nExit Sub\n\n'Error Handler\nNoFormulas:\n  MsgBox \"There were no formulas found in your selection!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1482963658, "post_id": 41369571, "comment_id": 69942714, "body": "Thank you, this worked great. Solved my problem. Thank you very much, im new with VBA :)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1482958423, "creation_date": 1482958423, "answer_id": 41369571, "question_id": 41368627, "link": "https://stackoverflow.com/questions/41368627/vba-skip-blank-cells-from-processing-with-formulas-in-them/41369571#41369571", "title": "VBA: skip blank cells from processing (with formulas in them)", "body": "<p>This should work. It will loop through your range, and only add the cell address to your <code>rRenameList</code> when the length is greater than or equal to 1.</p>\n\n<pre><code>Sub Test()\n' Adapted from http://stackoverflow.com/a/8320884/4650297\n\n  Dim rng1 As Range, rRenameList As Range, cel As Range\n  With ActiveWorkbook.Sheets(\"Linkuire\")\n    Set rng1 = .Range(\"D2\", .Cells(.Rows.Count, \"D\").End(xlUp))\n  End With\n\n  For Each cel In rng1\n    If Len(cel) &gt;= 1 Then\n        If Not rRenameList Is Nothing Then\n            Set rRenameList = Union(rRenameList, cel)\n        Else\n        ' the first valid cell becomes rng2\n            Set rRenameList = cel\n        End If\n    End If\n  Next cel\n\nDebug.Print rRenameList.Address\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482963737, "post_id": 41369789, "comment_id": 69942750, "body": "Will that work for you? I tried something like that, and it still just grabs all cells with a formula...thus grabbing all cells, since OP has &quot;<code>=Concat(A1,B1)</code>&quot; in all the cells."}, {"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1482964094, "post_id": 41369789, "comment_id": 69942863, "body": "User3598756s solution did not work. Still got all the cells no matter if the formula resulted in something or &quot;&quot;. Bruce, your code worked tho just perfect :) I market it as an answer, thank you"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1482995269, "post_id": 41369789, "comment_id": 69951120, "body": "You both are right! I edited my answer with two different (working!) approaches"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 1, "creation_date": 1483024155, "post_id": 41369789, "comment_id": 69966500, "body": "@MisterA, did you try these two (alternative) codes? They are quite short and fast"}, {"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1484951628, "post_id": 41369789, "comment_id": 70738323, "body": "Thank you. Sorry for the late reply.After I solved this problem I jumped right to the next issue I had with my project but I saved your alternatives also for future ocasions :)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1482995227, "last_edit_date": 1482995227, "creation_date": 1482959612, "answer_id": 41369789, "question_id": 41368627, "link": "https://stackoverflow.com/questions/41368627/vba-skip-blank-cells-from-processing-with-formulas-in-them/41369789#41369789", "title": "VBA: skip blank cells from processing (with formulas in them)", "body": "<p>edited since <em>pure</em> <code>SpecialCells()</code> approach wouldn't work</p>\n\n<p>You could use following two approaches and avoid looping:</p>\n\n<ul>\n<li><p><code>AutoFilter()</code> and <code>SpecialCells()</code> approach:</p>\n\n<pre><code>With ActiveWorkbook.Sheets(\"Linkuire\")\n    With .Range(\"D1\", .Cells(.Rows.count, \"D\").End(xlUp))\n        .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\" '&lt;--| filter out blanks\n        If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then Set rRenameList = .Resize(.Rows.count - 1).Offset(1).SpecialCells(xlCellTypeVisible)\n    End With\n    .AutoFilterMode = False\nEnd With\n</code></pre></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><p>Formula and <code>SpecialCells()</code> approach</p>\n\n<pre><code>With ActiveWorkbook.Sheets(\"Linkuire\")\n    With .Range(\"D2\", .Cells(.Rows.count, \"D\").End(xlUp))\n        .Offset(, 1).FormulaR1C1 = \"=IF(RC[-1]=\"\"\"\", 1,\"\"\"\")\"\n        Set rRenameList = .Offset(, 1).SpecialCells(xlCellTypeFormulas, xlNumbers).Offset(, -1)\n        .Offset(, 1).ClearContents\n    End With\nEnd With\n</code></pre>\n\n<p>in this approach you're writing a formula in a \"helper\" column I chose to be the adjacent to the right. It can be adjusted to any other offset</p></li>\n</ul>\n"}], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1191, "favorite_count": 0, "accepted_answer_id": 41369571, "answer_count": 2, "score": 1, "last_activity_date": 1484951198, "creation_date": 1482953956, "last_edit_date": 1484951198, "question_id": 41368627, "link": "https://stackoverflow.com/questions/41368627/vba-skip-blank-cells-from-processing-with-formulas-in-them", "title": "VBA: skip blank cells from processing (with formulas in them)", "body": "<p><br>\nI have a vba code that copies a file multiple times and renames the output after a list of names in column D from sheet \"Linkuire\". <br>\nColumn D is full of concatenate formulas that bring data into cells till D1000.<Br>\nWhen the concatenate formulas return \"\" (as in nothing) i want the code to ignore that cell. </p>\n\n<pre><code> ' the range of cells that contain the rename list\nWith ActiveWorkbook.Sheets(\"Linkuire\")  \n Set rRenameList = .Range(\"D2\", .Cells(.Rows.Count, \"D\").End(xlUp))\nEnd With \n</code></pre>\n\n<p>Now it just takes into account all D2 to D1000 cells even if some are = \"\" </p>\n\n<p><strong>How can I make the code ignore all cells where the return of the concatenate is \"\" ?</strong> (I have the same problem with a vba code that converts a certain sheet into pdf - with data got from concatenate formulas. It converts all cells even if concatenate return \"\" and is blank)</p>\n\n<p>Thank you..</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482954018, "post_id": 41368619, "comment_id": 69938855, "body": "and what happens???"}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 2, "last_activity_date": 1482954522, "last_edit_date": 1482954522, "creation_date": 1482954234, "answer_id": 41368696, "question_id": 41368619, "link": "https://stackoverflow.com/questions/41368619/vba-unlock-cells-in-a-range-if-colorindex-0/41368696#41368696", "title": "VBA Unlock Cells in a Range if colorindex = 0", "body": "<p>Because, blank formats are <code>-4142</code> and not <code>0</code></p>\n\n<p>Change to this:</p>\n\n<pre><code>If cell.Interior.ColorIndex = -4142 Then cell.Locked = False\n</code></pre>\n\n<p>Robust way: </p>\n\n<pre><code>Sub macunlock()\n    Dim rng1 As Range\n    Set rng1 = Range(\"A1:C1\")\n    For Each cell In rng1\n        If cell.Interior.ColorIndex = XlColorIndex.xlColorIndexNone Then\n            cell.Locked = False\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 6645988, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/24c7b6ed36d5960555392b35203b0f2b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Dahms", "link": "https://stackoverflow.com/users/6645988/daniel-dahms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 41368696, "answer_count": 1, "score": 0, "last_activity_date": 1482954522, "creation_date": 1482953928, "last_edit_date": 1482954096, "question_id": 41368619, "link": "https://stackoverflow.com/questions/41368619/vba-unlock-cells-in-a-range-if-colorindex-0", "title": "VBA Unlock Cells in a Range if colorindex = 0", "body": "<p>I am trying to unlock cells in a given range if they do not have a background color. </p>\n\n<pre><code>Sub macunlock()\nDim rng1 As Range\nSet rng1 = Range(\"A1:C1\")\nFor Each cell In rng1\nIf cell.Interior.ColorIndex = 0 Then cell.Locked = False\nNext cell\nEnd Sub\n</code></pre>\n\n<p>However, the specified cells do not unlock. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482952489, "post_id": 41368253, "comment_id": 69938221, "body": "First, you should add the <code>.</code> before <code>Range(&quot;B6&quot;)</code>. Second, what error specifically are you getting? Perhaps do <code>For each nm in ThisWorkbook.Names</code>?"}, {"owner": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482963593, "post_id": 41368253, "comment_id": 69942691, "body": "Erorr message is &quot;The name you entered is not valid. Reasons for this can include...&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 39794, "user_id": 43452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5843f8e823d0272f51a7d3585669f11e?s=128&d=identicon&r=PG", "display_name": "Stobor", "link": "https://stackoverflow.com/users/43452/stobor"}, "is_accepted": false, "score": 0, "last_activity_date": 1482952575, "creation_date": 1482952575, "answer_id": 41368368, "question_id": 41368253, "link": "https://stackoverflow.com/questions/41368253/remove-all-named-ranges-assigned-to-different-workbook/41368368#41368368", "title": "Remove all named ranges assigned to different workbook", "body": "<p>I think your last <code>for</code> loop should be  <code>for nm in BookCopy.Names</code></p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "edited": false, "score": 0, "creation_date": 1482963734, "post_id": 41368369, "comment_id": 69942747, "body": "This didn&#39;t work unfortunately. No error message but all the names are still there. I actually had <code>Names</code> intialized in an earlier version but it didn&#39;t work, so I tried it the way I posted."}, {"owner": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "edited": false, "score": 0, "creation_date": 1482964107, "post_id": 41368369, "comment_id": 69942868, "body": "Upon further inspection, this did work - but most of the names are actually still assigned the original workbook, and it only removed ones that were scoped to the copied sheet. Any way to remove those other names, while leaving the ones in the original tool intact?"}, {"owner": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "edited": false, "score": 0, "creation_date": 1483118036, "post_id": 41368369, "comment_id": 70001951, "body": "OK, I solved it. I had to pay better attention to the <code>If</code> statement in John&#39;s code - it deletes any name that has the active sheet in its reference. I added a second condition and an <code>Or</code> operator to check for names that have <code>ThisWorkbook</code> (the original workbook, where the code is running) in its <code>RefersTo</code> and this got rid of all the names. Thanks for your help."}], "tags": [], "owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "is_accepted": true, "score": 3, "last_activity_date": 1482952576, "creation_date": 1482952576, "answer_id": 41368369, "question_id": 41368253, "link": "https://stackoverflow.com/questions/41368253/remove-all-named-ranges-assigned-to-different-workbook/41368369#41368369", "title": "Remove all named ranges assigned to different workbook", "body": "<p>You never initialize the <code>Names</code> variable, so it doesn't know what to loop through.</p>\n\n<p>Try this instead:</p>\n\n<p>Create the following Sub:</p>\n\n<pre><code>Sub RemoveNamesFromSheet()\n\nDim nm As Name\n\n   For Each nm In ActiveWorkbook.Names\n      If InStr(1, nm.RefersTo, ActiveSheet.Name) &gt; 1 Then\n         nm.Delete\n      End If\n   Next nm\n\nEnd Sub\n</code></pre>\n\n<p>Then simply replace your loop with <code>RemoveNamesFromSheet</code></p>\n\n<p>Hope that does the trick!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7769250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6672f8d6a5bfbf82425ec680c682c350?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/7769250/willem"}, "is_accepted": false, "score": 0, "last_activity_date": 1582532664, "creation_date": 1582532664, "answer_id": 60371908, "question_id": 41368253, "link": "https://stackoverflow.com/questions/41368253/remove-all-named-ranges-assigned-to-different-workbook/60371908#60371908", "title": "Remove all named ranges assigned to different workbook", "body": "<p>I got it working like this:</p>\n\n<pre><code>Sub RemoveNamesFromSheet()\n  Dim nm As Name\n  Application.Calculation = xlCalculateManual\n  For Each nm In ActiveWorkbook.Names\n    If InStr(nm, \"C:\\\") &gt; 1 Then\n      nm.Delete\n    End If\n  Next nm\n  Application.Calculation = xlCalculationAutomatic\n  Calculate\nEnd Sub\n</code></pre>\n\n<p>It checks the name for the occurrence of \"C:\\\" which is normally the name of another workbook, so all external references are removed. It assumes the workbooks referring to are closed.\nYou may also replace \"C:\\\" with the filename that you just copied from. Temporarily disabling automatic recalculation speeds up the process dramatically.</p>\n"}], "owner": {"reputation": 57, "user_id": 4765962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c28064455a21a3982bf1f72299a394c7?s=128&d=identicon&r=PG&f=1", "display_name": "partiallyfulltime", "link": "https://stackoverflow.com/users/4765962/partiallyfulltime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2831, "favorite_count": 0, "accepted_answer_id": 41368369, "answer_count": 3, "score": 0, "last_activity_date": 1582532664, "creation_date": 1482952034, "last_edit_date": 1531161705, "question_id": 41368253, "link": "https://stackoverflow.com/questions/41368253/remove-all-named-ranges-assigned-to-different-workbook", "title": "Remove all named ranges assigned to different workbook", "body": "<p>I have a \"Save Inputs\" macro in a tool I created which copies the main input sheet in order to save the values for later. The macro removes comments and other unnecessary parts of the original sheet. The tool itself has a bunch of range names, and these get copied along with the sheet. I am trying to delete all of them from the saved input sheet, but encountering an error.</p>\n\n<pre><code>Sub SaveProgramData()\n\nDim SheetCopy As Worksheet\nDim BookCopy As Workbook\nDim nm As Name\nSet Analyzer = ThisWorkbook.Worksheets(\"Program Dashboard\")\nAnalyzer.copy\n\nSet SheetCopy = ActiveWorkbook.Worksheets(1) 'only way to address copy of a sheet created in new wkbk (i think)\nSet BookCopy = SheetCopy.Parent\n\nWith SheetCopy\n'remove comments, buttons, data validation, do some formatting, etc.\nEnd With\n\n\nFor Each nm In BookCopy.Names\n    nm.Delete 'this results in a runtime error saying the name I entered is not valid\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>I'm confused because I'm not trying to enter a name, just delete them. I'm also open to another method of copying the sheet that won't keep the names.</p>\n\n<p>EDIT: See comment below, the problem is that most of the names were assigned to ranges in the original workbook. Solved by adding additional condition to <code>If</code> statement:</p>\n\n<pre><code>For Each nm In BookCopy.Names\n      If InStr(1, nm.RefersTo, SheetCopy.Name) &gt; 1 Or InStr(1, nm.RefersTo, ThisWorkbook.Name) &gt; 1 Then 'check for names scoped to copied sheet, or original workbook\n         nm.Delete\n      End If\nNext nm\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 304, "user_id": 1846469, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QUYcJ.jpg?s=128&g=1", "display_name": "DesignerMind", "link": "https://stackoverflow.com/users/1846469/designermind"}, "edited": false, "score": 0, "creation_date": 1483040470, "post_id": 41368396, "comment_id": 69974634, "body": "Interestingly I read your advice prior to the edit and setup something, but was running into the issue of <code>substring</code> being returned, if put in part of the cell&#39;s text value. I assume using the loop will help me achieve the same result I would get with using Match Exact Cell Contents in the Excel Find function check box? Also, how would you suggest I use <code>xlWS</code> for my <code>With</code> block? I achieve results by checking <code>xlCell A and B</code> were in fact <code>Nothing</code> and tweaking the <code>If</code> statement, but it is unstable in exact searching terms - I need an exact value match or else, say the value isn&#39;t present."}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "reply_to_user": {"reputation": 304, "user_id": 1846469, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QUYcJ.jpg?s=128&g=1", "display_name": "DesignerMind", "link": "https://stackoverflow.com/users/1846469/designermind"}, "edited": false, "score": 0, "creation_date": 1483054441, "post_id": 41368396, "comment_id": 69979681, "body": "@DesignerMind First of all, the comment about the <code>With</code> block was that it can be deleted without any consequence to what your code does and, hence, should be deleted. Second, if you use <code>Find</code> and check for <code>Nothing</code> there should be no loop. Third, I am not suggesting that you just change the condition in the <code>if</code> statement but that you use a loop with some logic to capture a successful match, e.g. some varable only set to a reasonable value on success, break out of the loop on success and then return the appropriate result."}, {"owner": {"reputation": 304, "user_id": 1846469, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QUYcJ.jpg?s=128&g=1", "display_name": "DesignerMind", "link": "https://stackoverflow.com/users/1846469/designermind"}, "edited": false, "score": 0, "creation_date": 1483507473, "post_id": 41368396, "comment_id": 70119545, "body": "Took a swing at this and I&#39;m getting an <code>hresult COM error</code> but don&#39;t understand why. I&#39;m using the following <code>For i = 0 To LastRow             If Range2Use_1.Cells(i, 1).text = Value2Find_1 Then                 MsgBox(&quot;You got it...&quot;)              Else                 MsgBox(&quot;not here..&quot;)             End If         Next</code> I think my problem is with the <code>.Cells</code> portion, but I&#39;m confused as to how to get it to search against my <code>xlCell_A</code>. I know I&#39;m getting an object with <code>.Cells()</code> method, but trying .<code>Value</code>, <code>.Text</code> on the end keeps producing error."}, {"owner": {"reputation": 304, "user_id": 1846469, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QUYcJ.jpg?s=128&g=1", "display_name": "DesignerMind", "link": "https://stackoverflow.com/users/1846469/designermind"}, "edited": false, "score": 0, "creation_date": 1483507830, "post_id": 41368396, "comment_id": 70119672, "body": "FYI, I even substituted <code>Value2Find_1</code> for <code>xlCell_A</code>, as I realize I was searching a string vs an object return, but <code>xlCell_A</code> still results in an error on the <code>Range2Find_1.Cells()</code>"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "reply_to_user": {"reputation": 304, "user_id": 1846469, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QUYcJ.jpg?s=128&g=1", "display_name": "DesignerMind", "link": "https://stackoverflow.com/users/1846469/designermind"}, "edited": false, "score": 0, "creation_date": 1483513659, "post_id": 41368396, "comment_id": 70121977, "body": "@DesingnerMind The rows in a range are 1 based. You cannot ask for <code>Cells(0,1)</code>. So your For loop cannot start with <code>i=0</code>. Moreover, using a loop to search for the values in the two columns, you do not need <code>xlCell_A</code> at all. Finally, you should use <code>Value</code> or better <code>Value2</code> to access the value in a cell since the <code>Text</code> property of the range object is very slow."}], "tags": [], "owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "is_accepted": false, "score": 1, "last_activity_date": 1482996938, "last_edit_date": 1482996938, "creation_date": 1482952685, "answer_id": 41368396, "question_id": 41367847, "link": "https://stackoverflow.com/questions/41367847/initialize-correct-value-to-avoid-object-variable-or-with-block-variable-not-set/41368396#41368396", "title": "Initialize Correct Value to Avoid Object variable or With block variable not set", "body": "<p>I think the problem with your code is that the <code>Find</code> method returns <code>Nothing</code> whenever no match is found, as stated in its <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">documentation</a>. Thus, <code>xlCell_A.Row</code> returns the error because the <code>Row</code> method cannot be called on <code>Nothing</code>.</p>\n\n<p>Actually, I see a number of further issues with your code: </p>\n\n<ol>\n<li>The interior of the for loop does not depend on the loop variable <code>i</code>. Hence, it does exactly the same thing in each interation.</li>\n<li>The variable <code>xlWS</code> of the With block is never used, which makes the With block unnessesary.</li>\n<li>The return values of the <code>Find</code> methods in the loop never gets assigned to anything. Because of this, they have no effect.</li>\n<li>The condition in the if statement always returns <code>False</code> since you never change the values of <code>Value2Find_1</code> and <code>Value2Find_2</code> and you initialized them to <code>txtMachNumber.Text</code> and <code>txtMachName.Text</code>, respectively.</li>\n</ol>\n\n<p>If you intend to evaluate whether the values <code>txtMachNumber.Text</code> and <code>txtMachName.Text</code> are present in the column A and B, respectively, you can just test whether <code>xlCell_A</code> and <code>xlCell_B</code> are <code>Nothing</code>.</p>\n\n<p>Since you want to find both on the same row, which using <code>Find</code> does not guarantee, it might be easier to use a loop as in your code but replace \n<code>txtMachNumber.Text</code> and <code>txtMachName.Text</code> with <code>Range2Use_1.Cells(i,1)</code> and <code>Range2Use_2.Cells(i,1)</code> in the if statement. (This compares the value in the ith row with the values to search for.) Obviously, you would have to exit the loop after finding a match, e.g. using the <code>break</code> statement.</p>\n"}], "owner": {"reputation": 304, "user_id": 1846469, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/QUYcJ.jpg?s=128&g=1", "display_name": "DesignerMind", "link": "https://stackoverflow.com/users/1846469/designermind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482996938, "creation_date": 1482950253, "last_edit_date": 1482951418, "question_id": 41367847, "link": "https://stackoverflow.com/questions/41367847/initialize-correct-value-to-avoid-object-variable-or-with-block-variable-not-set", "title": "Initialize Correct Value to Avoid Object variable or With block variable not set", "body": "<p>I have block of code where I'm using a <code>For... Next</code> loop to go through an Excel sheet, and tell me if values entered in the text boxes were found or not. I've modified it to work if the values match. Yet, I'm receiving the Object/With Block variable not set error, and it confusing me. I've created the following:</p>\n\n<pre><code>    Dim Value2Find_1 As String = txtMachNumber.Text                      'Serial number value.\n    Dim Value2Find_2 As String = txtMachName.Text                        'Machine name value.\n\n\n    Dim ReplaceWithValue1 As String = \"\"                                'Replaces the serial number value if found in the sheet.\n    Dim ReplaceWithValue2 As String = \"\"                                'Replaces the machine name value if found in the sheet.\n    Dim ReplaceWithValue3 As String = \"\"                                'Replacement for the date-time in the Date Column.\n\n    Dim Range2Use_1 = xlWS.Range(\"A1:A4000\")                            'Range to span the A Column.\n    Dim Range2Use_2 = xlWS.Range(\"B1:B4000\")                            'Range to span the B Column.\n    Dim Range2Use_3 = xlWS.Range(\"F1:F4000\")                            'Range to span the F Column.\n\n    Dim xlCell_A = Range2Use_1.Find(txtMachNumber.Text)                  'Looks up the searched serial value in A Column.\n    Dim xlCell_B = Range2Use_2.Find(txtMachName.Text)                    'Looks up the searched machine value in B Column.\n\n    Dim LastRow = xlWS.Range(\"A4000\").End(Excel.XlDirection.xlUp).Row + 1\n    Dim i As Integer\n\n\n    With xlWS\n        For i = 1 To LastRow\n            If Not (Value2Find_1 = txtMachNumber.Text And Value2Find_2 = txtMachName.Text) Then\n\n                MessageBox.Show(\"No value exists here...\")\n\n\n            Else\n                Range2Use_1.Find(What:=Value2Find_1, MatchCase:=True)\n                Range2Use_2.Find(What:=Value2Find_2, MatchCase:=True)\n\n\n                MsgBox(\"Found both values: \" &amp; Value2Find_1 &amp; \" and \" &amp; Value2Find_2 &amp; \" on row \" &amp; xlCell_A.Row)\n            End If\n\n            Exit Sub\n        Next\n\n\n    End With\n</code></pre>\n\n<p>If my textbox entries are not in the sheet, the errors returns on the following line of code:</p>\n\n<pre><code>MsgBox(\"Found both values: \" &amp; Value2Find_1 &amp; \" and \" &amp; Value2Find_2 &amp; \" on row \" &amp; xlCell_A.Row)\n</code></pre>\n\n<p>I've narrowed it down to have something to do with the variable that returns the row number of the located textbox entries - <code>xlCell_A</code>. This is where I'm stuck, however. What do I need to set this as in order to avoid the Object/With Block variable not set error? I am afraid I don't know what this is asking for. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 833, "user_id": 5002793, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-EcmwXD-5qGw/AAAAAAAAAAI/AAAAAAAACqQ/wLjCO2xNuug/photo.jpg?sz=128", "display_name": "Rehban Khatri", "link": "https://stackoverflow.com/users/5002793/rehban-khatri"}, "edited": false, "score": 0, "creation_date": 1482950008, "post_id": 41367723, "comment_id": 69937069, "body": "Have you tried `Application.WorksheetFunction.Text(yourdate, &quot;hh-MM&quot; )"}, {"owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "reply_to_user": {"reputation": 833, "user_id": 5002793, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-EcmwXD-5qGw/AAAAAAAAAAI/AAAAAAAACqQ/wLjCO2xNuug/photo.jpg?sz=128", "display_name": "Rehban Khatri", "link": "https://stackoverflow.com/users/5002793/rehban-khatri"}, "edited": false, "score": 0, "creation_date": 1482950513, "post_id": 41367723, "comment_id": 69937321, "body": "I didn&#39;t understand, you can see a picture of my formular, I added in my question."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482951346, "post_id": 41367723, "comment_id": 69937711, "body": "How&#39;s all this code related to the question?"}, {"owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482951695, "post_id": 41367723, "comment_id": 69937882, "body": "@A.S.H My problem is to put the value of the ComboBox5 and ComboBox6 in one Cell on Excel."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1482953308, "last_edit_date": 1482953308, "creation_date": 1482952973, "answer_id": 41368446, "question_id": 41367723, "link": "https://stackoverflow.com/questions/41367723/vba-excel-choose-the-hour-and-the-minute-from-a-list/41368446#41368446", "title": "VBA Excel : Choose the hour and the minute from a list", "body": "<pre><code>Sheets(\"Reservations\").Range(\"H\" &amp; i).Value = _\n    Format(TimeSerial(ComboBox5.Value, ComboBox6.Value, 0), \"hh:mm\")\nSheets(\"Reservations\").Range(\"I\" &amp; i).Value = _\n    Format(TimeSerial(ComboBox7.Value, ComboBox8.Value, 0), \"hh:mm\")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 41368446, "answer_count": 1, "score": 0, "last_activity_date": 1482953308, "creation_date": 1482949693, "last_edit_date": 1482950461, "question_id": 41367723, "link": "https://stackoverflow.com/questions/41367723/vba-excel-choose-the-hour-and-the-minute-from-a-list", "title": "VBA Excel : Choose the hour and the minute from a list", "body": "<p>I want to choose the hour and the minute from a list in my formular and display them in one cell on Excel (Column H)</p>\n\n<p>Hours : ComboBox5</p>\n\n<p>Minutes : ComboBox6</p>\n\n<p><a href=\"https://i.stack.imgur.com/sCarr.png\" rel=\"nofollow noreferrer\">Formular</a></p>\n\n<p>A part of my script :</p>\n\n<pre><code>    Sheets(\"Reservations\").Range(\"A\" &amp; i).Value = UserForm1.TextBox1.Value\n\n    Sheets(\"Reservations\").Range(\"B\" &amp; i).Value = UserForm1.TextBox2.Value\n\n    Sheets(\"Reservations\").Range(\"C\" &amp; i).Value = UserForm1.TextBox3.Value\n\n    Sheets(\"Reservations\").Range(\"D\" &amp; i).Value = UserForm1.TextBox4.Value\n\n    Sheets(\"Reservations\").Range(\"E\" &amp; i).Value = UserForm1.TextBox5.Value\n\n    Sheets(\"Reservations\").Range(\"F\" &amp; i).Value = UserForm1.ComboBox4.Value\n\n    Sheets(\"Reservations\").Range(\"G\" &amp; i).Value = DateSerial(UserForm1.ComboBox3.Value, UserForm1.ComboBox2.Value, UserForm1.ComboBox1.Value)\n\n    Sheets(\"Reservations\").Range(\"H\" &amp; i).Value = UserForm1.ComboBox5.Value\n\n    Sheets(\"Reservations\").Range(\"I\" &amp; i).Value = UserForm1.ComboBox7.Value\n\n    Sheets(\"Reservations\").Range(\"E\" &amp; i).NumberFormat = \"00 00 00 00 00\"\n\n    Sheets(\"Reservations\").Range(\"H\" &amp; i).NumberFormat = \"hh\\Hmm\"\n\n    Sheets(\"Reservations\").Range(\"I\" &amp; i).NumberFormat = \"hh\\Hmm\"\n\n    Sheets(\"Reservations\").Range(\"G\" &amp; i).NumberFormat = \"dd mmmm yyyy\"\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "shdocvw"], "answers": [{"comments": [{"owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 2, "creation_date": 1482949542, "post_id": 41367486, "comment_id": 69936855, "body": "Thanks for your reply! When I use your code, first it says that this code must be updated to a 64bit version... So, instead of <code>Private Declare Function ShowWindow Lib &quot;user32&quot; _</code> I must use <code>Private Declare PtrSafe Function ShowWindow Lib &quot;user32&quot; _</code>... Ok, first error fixed! So after fixing the error stated above, I get the following error: <code>Incompatible types</code> and then the debugger marks the following statement: <code>ShowWindow ie.hwnd</code> Do you know why?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 2, "creation_date": 1482949877, "post_id": 41367486, "comment_id": 69937011, "body": "dont have 64bit excel at my end, but try this link : <a href=\"http://www.jkp-ads.com/articles/apideclarations.asp\" rel=\"nofollow noreferrer\">jkp-ads.com/articles/apideclarations.asp</a>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 3, "creation_date": 1482950085, "post_id": 41367486, "comment_id": 69937107, "body": "@rfw - Change <code>ByVal hwnd as Long</code> to <code>ByVal hwnd as LongPtr</code>."}, {"owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 2, "creation_date": 1482950384, "post_id": 41367486, "comment_id": 69937255, "body": "Using the code posted by <code>cyboashu</code> and the tweak provided by <code>Comintern</code> my code worked perfectly!! Thanks for your time and effort, guys."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1604325153, "post_id": 41367486, "comment_id": 114305094, "body": "or You could just change <code>ShowWindow Clng(ie.hwnd)</code>"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 7, "last_activity_date": 1482948981, "last_edit_date": 1482948981, "creation_date": 1482948587, "answer_id": 41367486, "question_id": 41367209, "link": "https://stackoverflow.com/questions/41367209/how-can-i-maximize-an-ie-window-created-by-vba-with-shdocvw-internetexplorer-com/41367486#41367486", "title": "How can I maximize an IE window created by VBA with SHDocVw.InternetExplorer command?", "body": "<p>For Internet Control, there's no inherent <code>Window</code> property. You need to use WinAPI. </p>\n\n<p>This code will work : </p>\n\n<pre><code>'/ Win API declaration\nPrivate Declare Function ShowWindow Lib \"user32\" _\n         (ByVal hwnd As Long, ByVal nCmdSHow As Long) As Long\n        Const SW_SHOWMAXIMIZED = 3\n\nSub wpieautologin()\n\nDim ie As SHDocVw.InternetExplorer\n\nDim NOME_EMPRESA, CNPJ, CPF, COD_ACESSO As String\nDim Lookup_Range As Range\n\nSet ie = New SHDocVw.InternetExplorer\nie.Visible = False\n\nie.Navigate \"http://www8.receita.fazenda.gov.br/simplesnacional/controleacesso/autentica.aspx?id=6\"\n\n\n\n'// rest of your code....\n\n\n'/ Win API to maximize it.\n'/ Visible prop not required anymore\nShowWindow ie.hwnd, SW_SHOWMAXIMIZED\nEnd Sub\n</code></pre>\n\n<p>Check other window state at : <a href=\"http://www.techrepublic.com/blog/10-things/10-plus-of-my-favorite-windows-api-functions-to-use-in-office-applications/\" rel=\"noreferrer\">http://www.techrepublic.com/blog/10-things/10-plus-of-my-favorite-windows-api-functions-to-use-in-office-applications/</a></p>\n"}, {"comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 1, "creation_date": 1599274720, "post_id": 60970908, "comment_id": 112731779, "body": "This is by far better! I think I was here in the past and didn&#39;t get past reading the above function and decided it wasn&#39;t worth the effort. No to mention the comments Re: <code>x32&#47;x64</code> MSOffice issues which this shouldn&#39;t have. I like my macro&#39;s to be 100% portable."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 1, "creation_date": 1599338465, "post_id": 60970908, "comment_id": 112746224, "body": "Note: I used <code>SENDKEYS</code> to interact w/ IE via VBA. Upon testing <code>FullScreen</code> acted differently w/ my existing VBA Code, but <code>TheaterMode</code> worked as expected. They both look the same. Now that I know this, I would always use <code>TheaterMode</code>, but I could have of course adapted to <code>FullScreen</code>"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 1, "creation_date": 1599338879, "post_id": 60970908, "comment_id": 112746308, "body": "More Notes: After using this macro, when I opened IE for other reasons manually, it was still using <code>TheaterMode</code> so I added <code>TheaterMode = False</code> to the end before I unloaded IE."}], "tags": [], "owner": {"reputation": 144, "user_id": 13167342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0df7039f8be26a5252743c4433eae05?s=128&d=identicon&r=PG&f=1", "display_name": "UnknownQ", "link": "https://stackoverflow.com/users/13167342/unknownq"}, "is_accepted": true, "score": 8, "last_activity_date": 1585744146, "creation_date": 1585744146, "answer_id": 60970908, "question_id": 41367209, "link": "https://stackoverflow.com/questions/41367209/how-can-i-maximize-an-ie-window-created-by-vba-with-shdocvw-internetexplorer-com/60970908#60970908", "title": "How can I maximize an IE window created by VBA with SHDocVw.InternetExplorer command?", "body": "<p>This could be done like this as well.</p>\n\n<pre><code>ie.FullScreen = True\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ie.TheaterMode = True\n</code></pre>\n\n<p>Then you don't to declare a function.</p>\n"}], "owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18380, "favorite_count": 2, "accepted_answer_id": 60970908, "answer_count": 2, "score": 6, "last_activity_date": 1599274786, "creation_date": 1482947399, "question_id": 41367209, "link": "https://stackoverflow.com/questions/41367209/how-can-i-maximize-an-ie-window-created-by-vba-with-shdocvw-internetexplorer-com", "title": "How can I maximize an IE window created by VBA with SHDocVw.InternetExplorer command?", "body": "<p>As the title says, I'm trying to maximize an internet explorer window that was created using the following command:</p>\n\n<pre><code>Set ie = New SHDocVw.InternetExplorer\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<hr>\n\n<p>Here's the full code:</p>\n\n<pre><code>Sub wpieautologin()\nDim ie As SHDocVw.InternetExplorer\n\nDim NOME_EMPRESA, CNPJ, CPF, COD_ACESSO As String\nDim Lookup_Range As Range\n\nSet ie = New SHDocVw.InternetExplorer\nie.Visible = False\nie.Navigate \"http://www8.receita.fazenda.gov.br/simplesnacional/controleacesso/autentica.aspx?id=6\"\n\nNOME_EMPRESA = Range(\"B8\").Value\nSet Lookup_Range = Range(\"B12:E500\")\n\nCNPJ = Application.WorksheetFunction.VLookup(NOME_EMPRESA, Lookup_Range, 2, False)\nCPF = Application.WorksheetFunction.VLookup(NOME_EMPRESA, Lookup_Range, 3, False)\nCOD_ACESSO = Application.WorksheetFunction.VLookup(NOME_EMPRESA, Lookup_Range, 4, False)\n\nDo\nLoop Until ie.readystate = 4\nCall ie.Document.GetElementByID(\"ctl00_ContentPlaceHolder_txtCNPJ\").SetAttribute(\"value\", CNPJ)\nCall ie.Document.GetElementByID(\"ctl00_ContentPlaceHolder_txtCPFResponsavel\").SetAttribute(\"value\", CPF)\nCall ie.Document.GetElementByID(\"ctl00_ContentPlaceHolder_txtCodigoAcesso\").SetAttribute(\"value\", COD_ACESSO)\nie.Visible = True\n\n&gt;'What should I write here to maximize my IE Window? \n&gt;'Already tried a few solutions, but they works only when the IE is created by the command \n&gt;'Set ie = CreateObject(\"InternetExplorer.Application\")\n\n#INSERT COMMAND TO MAXIMIZE WINDOW HERE\n\nEnd Sub\n</code></pre>\n\n<p>So, how can I achieve this?</p>\n"}, {"tags": ["vba", "type-mismatch"], "comments": [{"owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "edited": false, "score": 2, "creation_date": 1482947499, "post_id": 41367204, "comment_id": 69935838, "body": "I think if <code>cell.value</code> is not a number, the comparison <code>&lt;0</code> will fail with that error. You can only compare numbers that way."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482947811, "post_id": 41367204, "comment_id": 69935997, "body": "It will also fail if <code>cell.Value</code> contains an error."}, {"owner": {"reputation": 28, "user_id": 620751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd1ada22c8bb27e335bcef113c0a5b3e?s=128&d=identicon&r=PG", "display_name": "Lizz Craighten", "link": "https://stackoverflow.com/users/620751/lizz-craighten"}, "edited": false, "score": 0, "creation_date": 1482947906, "post_id": 41367204, "comment_id": 69936046, "body": "How can I ensure that there are no errors? The value returned in the formula is a number."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1482948807, "post_id": 41367204, "comment_id": 69936506, "body": "<code>IsError</code> , <code>IsNumeric</code>"}], "owner": {"reputation": 28, "user_id": 620751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd1ada22c8bb27e335bcef113c0a5b3e?s=128&d=identicon&r=PG", "display_name": "Lizz Craighten", "link": "https://stackoverflow.com/users/620751/lizz-craighten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482947369, "creation_date": 1482947369, "question_id": 41367204, "link": "https://stackoverflow.com/questions/41367204/cell-value-error", "title": "Cell.Value Error", "body": "<p>I am trying to populate a column with values based off of formulas and then validate the data.</p>\n\n<p>My sub for the formulas works perfectly, but when I run the data validation on the same column I get a \"type error\".  When I run the validation sub on the column with values I typed in, it works perfectly.</p>\n\n<pre><code>Sub InsertFormulas()\n\nDim Lastrow As Long\nApplication.ScreenUpdating = False\n\nRange(\"AC1\").Value = \"Age\"\nRange(\"AD1\").Value = \"Experience\"\nRange(\"AE1\").Value = \"Day DOI\"\nRange(\"AF1\").Value = \"Month DOI\"\nRange(\"AG1\").Value = \"Year DOI\"\nRange(\"AH1\").Value = \"Lag Time\"\nRange(\"AI1\").Value = \"OOW Days\"\n\nLastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'Age Formula\nRange(\"AC2\").FormulaR1C1 = \"=(L2-D2)/365\"\nRange(\"AC2:AC\" &amp; Lastrow).Formula = \"=(L2-D2)/365\n\nEnd sub()\n</code></pre>\n\n<p>Then my data validation formula is this:</p>\n\n<pre><code>Sub ClearCells()\n\nDim Lastrow As Long\nDim cell As Range\n\nLastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor Each cell In Range(\"AC2:AC\" &amp; Lastrow)\nIf cell.Value &lt; 0 Then\ncell.ClearContents\nEnd If\nNext cell\n</code></pre>\n\n<p>But when I run the Clearcells() one I get \"Type Mismatch\" on the \"Cell.Value\" row.</p>\n\n<p>Please help!</p>\n"}, {"tags": ["r", "windows", "vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482947747, "post_id": 41367030, "comment_id": 69935961, "body": "what happens if you try to run the <b>R script</b> by replacing the last line with <code>shell.Run path, 1, True</code> ? does it work ?"}, {"owner": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482948210, "post_id": 41367030, "comment_id": 69936207, "body": "Unfortunately, no-- I get the same error."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482948733, "post_id": 41367030, "comment_id": 69936473, "body": "where is this file stored R RAM Cluster Script.R?"}], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 4900824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzKEr.jpg?s=128&g=1", "display_name": "PhilC", "link": "https://stackoverflow.com/users/4900824/philc"}, "reply_to_user": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482952378, "post_id": 41368197, "comment_id": 69938161, "body": "Change the r.exe to rscript.exe for batch arguments."}, {"owner": {"reputation": 697, "user_id": 4900824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzKEr.jpg?s=128&g=1", "display_name": "PhilC", "link": "https://stackoverflow.com/users/4900824/philc"}, "reply_to_user": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482956233, "post_id": 41368197, "comment_id": 69939785, "body": "Try adding the path to the R file &#39;c:\\YOUR DIR\\R RAM ...&#39; in your argument.  The error is due to rscript not finding the script."}, {"owner": {"reputation": 697, "user_id": 4900824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzKEr.jpg?s=128&g=1", "display_name": "PhilC", "link": "https://stackoverflow.com/users/4900824/philc"}, "reply_to_user": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482957023, "post_id": 41368197, "comment_id": 69940120, "body": "One more try?  c:/mypath  note change in slash direction"}, {"owner": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482964030, "post_id": 41368197, "comment_id": 69942845, "body": "To anyone reading, use this code that PhilC posted-- It works perfectly!  Note for 32-bit R users: use RScript.exe within folder i386"}], "tags": [], "owner": {"reputation": 697, "user_id": 4900824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qzKEr.jpg?s=128&g=1", "display_name": "PhilC", "link": "https://stackoverflow.com/users/4900824/philc"}, "is_accepted": true, "score": 1, "last_activity_date": 1482962850, "last_edit_date": 1482962850, "creation_date": 1482951792, "answer_id": 41368197, "question_id": 41367030, "link": "https://stackoverflow.com/questions/41367030/running-r-script-in-vba-wrong-directory/41368197#41368197", "title": "Running R script in VBA Wrong Directory", "body": "<p>Try this:</p>\n\n<pre><code>Sub test()\n Dim shell As Object\n Set shell = VBA.CreateObject(\"WScript.Shell\")\n Dim waitTillComplete As Boolean: waitTillComplete = True\n Dim style As Integer: style = 1\n Dim errorCode As Integer\n Dim path As String\n\n\n path = \"\"\"C:\\Program Files\\R\\R-3.3.1\\bin\\RScript.exe\"\"\" &amp; \"\"\"c:/temp/R RAM Cluster Script.R\"\"\"\n\n errorCode = shell.Run(path, style, waitTillComplete)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482954164, "post_id": 41368460, "comment_id": 69938913, "body": "This did help get around the directory problem, but because of the space between &#39;Program&#39; and &#39;Files&#39;, it is looking for an executable called <code>C:\\Program</code>"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482954501, "post_id": 41368460, "comment_id": 69939060, "body": "ah, i&#39;ll fix my answer then"}, {"owner": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482955217, "post_id": 41368460, "comment_id": 69939338, "body": "Now I have received an unexpected token error for PowerShell. It says:"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482955336, "post_id": 41368460, "comment_id": 69939395, "body": "thinking about it, it might be that it is not expecting there to be two strings. i&#39;ll edit again"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "edited": false, "score": 0, "creation_date": 1482955925, "post_id": 41368460, "comment_id": 69939646, "body": "actually i found the reason you may have a problem <a href=\"http://stackoverflow.com/questions/25246735/unexpected-token-errors-in-powershell\" title=\"unexpected token errors in powershell\">stackoverflow.com/questions/25246735/&hellip;</a>"}], "tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": false, "score": 0, "last_activity_date": 1482955394, "last_edit_date": 1482955394, "creation_date": 1482953055, "answer_id": 41368460, "question_id": 41367030, "link": "https://stackoverflow.com/questions/41367030/running-r-script-in-vba-wrong-directory/41368460#41368460", "title": "Running R script in VBA Wrong Directory", "body": "<p>I would suggest trying to use powershell as a wrapper for your script because it DOES support UNC paths. So, something like this should work:</p>\n\n<pre><code>path = \"Powershell.exe -executionpolicy bypass -Command &amp;{'C:\\Program Files\\R\\R-3.3.2\\bin\\i386\\R.exe \" &amp;  ThisWorkbook.Path &amp; \"\\R RAM Cluster Script.R'}\"\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 6509699, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0b7aca6f0f48d95d5b07ea9b75b62f6d?s=128&d=identicon&r=PG&f=1", "display_name": "reggie86", "link": "https://stackoverflow.com/users/6509699/reggie86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "accepted_answer_id": 41368197, "answer_count": 2, "score": 1, "last_activity_date": 1482962850, "creation_date": 1482946614, "last_edit_date": 1495540802, "question_id": 41367030, "link": "https://stackoverflow.com/questions/41367030/running-r-script-in-vba-wrong-directory", "title": "Running R script in VBA Wrong Directory", "body": "<p>I have a macro that edits an R script.\nThat R script is then supposed to be called by the following VBA:</p>\n\n<pre><code> Dim shell As Object\n Set shell = VBA.CreateObject(\"WScript.Shell\")\n Dim waitTillComplete As Boolean: waitTillComplete = True\n Dim style As Integer: style = 1\n Dim errorCode As Integer\n Dim path As String\n\n path = \"\"\"\" &amp; \"C:\\Program Files\\R\\R-3.3.2\\bin\\i386\\R.exe\" &amp; \"\"\" \"\"\" &amp; \"R RAM Cluster Script.R\" &amp; \"\"\"\"\n\n errorCode = shell.Run(path, style, waitTillComplete)\n</code></pre>\n\n<p>The above code was from <a href=\"https://stackoverflow.com/questions/11597626/running-r-scripts-from-vba\">this question</a>.</p>\n\n<p>When I execute the macro, however, the R Command Line gives me an error stating:</p>\n\n<pre><code> '\\\\dm\\home\\myaccount\\*Path of my original Excel File*'\n \"CMD.EXE was started with the above path as the current directory. \n  UNC Paths are not supported. Defaulting to Windows directory. \n  Argument 'R  RAM Cluster Script.R' Ignored\"\n</code></pre>\n\n<p>The script is stored in the folder that my Excel workbook is in.</p>\n\n<p>Can anyone help me out with finding my problem?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1482945887, "post_id": 41366558, "comment_id": 69935089, "body": "Have you tried ele.Value?"}, {"owner": {"reputation": 31, "user_id": 5088629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-_gG9g6dePqY/AAAAAAAAAAI/AAAAAAAAAWA/1Neyrt6Fq3M/photo.jpg?sz=128", "display_name": "StevenB", "link": "https://stackoverflow.com/users/5088629/stevenb"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1482946281, "post_id": 41366558, "comment_id": 69935294, "body": "Thank you very much Sorceri! This worked! Why did it work considering that the html code lists .value as &quot;&quot;? I believed value contained nothing accordingly. How is it grabbing anything from that empty string?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1482946652, "post_id": 41366558, "comment_id": 69935452, "body": "It is most likely being set via javascript"}, {"owner": {"reputation": 31, "user_id": 5088629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-_gG9g6dePqY/AAAAAAAAAAI/AAAAAAAAAWA/1Neyrt6Fq3M/photo.jpg?sz=128", "display_name": "StevenB", "link": "https://stackoverflow.com/users/5088629/stevenb"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1482946890, "post_id": 41366558, "comment_id": 69935554, "body": "Interesting, didn&#39;t realize that was a possibility. Thank you very much!"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5088629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-_gG9g6dePqY/AAAAAAAAAAI/AAAAAAAAAWA/1Neyrt6Fq3M/photo.jpg?sz=128", "display_name": "StevenB", "link": "https://stackoverflow.com/users/5088629/stevenb"}, "is_accepted": false, "score": 0, "last_activity_date": 1482946439, "creation_date": 1482946439, "answer_id": 41366991, "question_id": 41366558, "link": "https://stackoverflow.com/questions/41366558/vba-extract-date-time-from-unique-textbox-drop-down-calendar/41366991#41366991", "title": "VBA - Extract Date/Time from Unique TextBox/Drop Down Calendar", "body": "<p>Per Sorceri (thanks!),</p>\n\n<p>Even though the ele.Value string is listed as blank in the HTML, pulling the .value data correctly pulled in the date/time listed with one additional modification to the code (changing the ele.tagname). Here is the correct code.</p>\n\n<pre><code>            Set objinputs = aExplorer.document.getElementsByTagName(\"input\")\n        For Each ele In objinputs\n            If ele.Name Like \"estRange\" Then\n            cTestScrape4 = ele.Value\n            End If\n        Next\n        Do While aExplorer.Busy\n            Application.Wait DateAdd(\"s\", 10, Now)\n        Loop\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5088629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-_gG9g6dePqY/AAAAAAAAAAI/AAAAAAAAAWA/1Neyrt6Fq3M/photo.jpg?sz=128", "display_name": "StevenB", "link": "https://stackoverflow.com/users/5088629/stevenb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482946439, "creation_date": 1482944537, "last_edit_date": 1482945251, "question_id": 41366558, "link": "https://stackoverflow.com/questions/41366558/vba-extract-date-time-from-unique-textbox-drop-down-calendar", "title": "VBA - Extract Date/Time from Unique TextBox/Drop Down Calendar", "body": "<p>I'm using VBA to try to scrape a time/date from a website. The item I'm trying to extract it from is a text box that leads to a drop down calendar. Inside of the text box I can see and select the text I want to extract. Here is the HTML:</p>\n\n<pre><code>&lt;input type=\"text\" date-begin=\"ac.Start\" date-end=\"ac.Finish\" ng-model=\"Data.estRange\" ng-change=\"updateDuration()\" size=\"45\" style=\"display:inline;\" name=\"estRange\" id=\"estRange\" value=\"\" rangepicker=\"\" class=\"ng-isolate-scope ng-valid ng-dirty ng-valid-date-range\"&gt;\n</code></pre>\n\n<p>Inside of the text box it says, \"mm/dd/yyyy hh:mm PM - mm/dd/yyyy hh:mm PM\".</p>\n\n<p>When I try to grab the inner text nothing gets returned. Here is an example of the code I tried to use:</p>\n\n<pre><code>        Set objinputs = aExplorer.document.getElementsByTagName(\"input\")\n        For Each ele In objinputs\n            If ele.TagName Like \"date-end\" Then\n            cTestScrape = ele.innertext\n            End If\n        Next\n        Do While aExplorer.Busy\n            Application.Wait DateAdd(\"s\", 10, Now)\n        Loop\n</code></pre>\n\n<p>Any ideas on how to do this correctly? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1482943315, "post_id": 41366120, "comment_id": 69933835, "body": "AFAIK you can click in to the chart, then click again the legend, and select &quot;Series2&quot; only, then just press the <code>DELETE</code> key."}], "answers": [{"tags": [], "owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "is_accepted": true, "score": 2, "last_activity_date": 1482946028, "last_edit_date": 1482946028, "creation_date": 1482944886, "answer_id": 41366641, "question_id": 41366120, "link": "https://stackoverflow.com/questions/41366120/vba-edit-legend-names-from-excel-chart-using-vba/41366641#41366641", "title": "VBA: Edit legend names from excel chart using VBA", "body": "<p>If you really wanted to edit <em>Series2</em> in the legend you would change it the same manner you changed the name of Series1:</p>\n\n<pre><code>.SeriesCollection(2).Name = \"Unwanted series\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/as3SH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/as3SH.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Note</strong>: I had originally answered with the following:</p>\n\n<blockquote>\n  <p>The following line of code is adding your unwanted <em>Series2</em>:</p>\n\n<pre><code>.SeriesCollection.NewSeries\n</code></pre>\n  \n  <p>Simply remove it.</p>\n</blockquote>\n\n<p>But I see now that it was not entirely correct. Sometimes an additional one is created, sometimes not, depending on what has happened in the past on the sheet (I think I'm missing something obvious). I've been able to reproduce both behaviors. If you somehow end up with additional series', you could remove any superfluous ones with a call to:</p>\n\n<pre><code>.SeriesCollection(2).Delete\n</code></pre>\n\n<p>so long as you use the correct series number. You could include a test like this to see if an extra one has been made:</p>\n\n<pre><code>If .SeriesCollection.Count &gt; 1 then .SeriesCollection(2).Delete\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 6093740, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-kZ4KxtYeNSI/AAAAAAAAAAI/AAAAAAAAEfU/NPi4yRv8LU4/photo.jpg?sz=128", "display_name": "Alejandro Jim&#233;nez Rico", "link": "https://stackoverflow.com/users/6093740/alejandro-jim%c3%a9nez-rico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15197, "favorite_count": 0, "accepted_answer_id": 41366641, "answer_count": 1, "score": 1, "last_activity_date": 1482946028, "creation_date": 1482942844, "question_id": 41366120, "link": "https://stackoverflow.com/questions/41366120/vba-edit-legend-names-from-excel-chart-using-vba", "title": "VBA: Edit legend names from excel chart using VBA", "body": "<p>I have made a chart where I try to plot some specific data. For that purpose I made this code:</p>\n\n<pre><code>Sub plotsim()\nDim sh As Worksheet\nDim chrt As Chart\nworksh = Application.Sheets.Count\nSet sh = ActiveWorkbook.Worksheets(\"Simulation\")\nSet chrt = sh.Shapes.AddChart.Chart\nWith chrt\n    .ChartType = xlLine\n    .SeriesCollection.NewSeries\n    .SeriesCollection(1).Name = \"=\"\"Portfolio forecast\"\"\"\n    .SeriesCollection(1).XValues = Sheets(\"Simulation\").Range(\"A2:A\" &amp; fsize + 1)\n    .SeriesCollection(1).Values = Sheets(\"Simulation\").Range(Sheets(\"Simulation\").Cells(2, worksh + 1), Sheets(\"Simulation\").Cells(fsize + 1, worksh + 1))\nEnd With\nEnd Sub\n</code></pre>\n\n<p>But once I take a look at the chart, what I see is a legend with two different lines.\n<a href=\"https://i.stack.imgur.com/thre2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/thre2.png\" alt=\"\"></a></p>\n\n<p>How can I remove (or edit) the <em>Series2</em> title?</p>\n"}, {"tags": ["vba", "excel", "copy", "listobject"], "comments": [{"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482947273, "post_id": 41365982, "comment_id": 69935730, "body": "Presumably it works OK if you copy the sheets one at a time?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482947481, "post_id": 41365982, "comment_id": 69935833, "body": "@CharlesWilliams - Hmm. Didn&#39;t try that obvious test :) Will try and let you know."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482948172, "post_id": 41365982, "comment_id": 69936185, "body": "I cannot duplicate the problem using Excel 2013"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482948331, "post_id": 41365982, "comment_id": 69936263, "body": "I am on 2010 @CharlesWilliams. Perhaps the &quot;bug&quot; was fixed in 2013?"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482948616, "post_id": 41365982, "comment_id": 69936410, "body": "Works OK for me in XL2010"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482949254, "post_id": 41365982, "comment_id": 69936722, "body": "Note my test does not use tables mapped to an XML source - they are just ordinary tables."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482953110, "post_id": 41365982, "comment_id": 69938457, "body": "@CharlesWilliams - Did you copy into a workbook that had existing tables already?"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482956568, "post_id": 41365982, "comment_id": 69939931, "body": "Yes UQP workbook has a tAutoForms table"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482963879, "post_id": 41365982, "comment_id": 69942796, "body": "@CharlesWilliams - I tested for one sheet at a time and the behavior is to bring the Workbook name along with the table name .. so <code>MyWorkbook!tPremium</code>. It leaves it there after I change the link source, too. If I find and replace the the workbook name, it automatically transfers to the new workbook. This suggestion helped because replacing the workbook name has more scalability than the the table name. Overall, I have a feeling it&#39;s due to the XML mapping behind the table that is causing the issue since the XML mapping will not be coming with the transfer."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1482967012, "post_id": 41365982, "comment_id": 69943785, "body": "@CharlesWilliams - Lastly, thanks for giving it a test drive."}], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482948307, "creation_date": 1482942245, "last_edit_date": 1592644375, "question_id": 41365982, "link": "https://stackoverflow.com/questions/41365982/table-reference-in-formula-changes-when-worksheets-copied", "title": "Table Reference in Formula Changes When Worksheets Copied", "body": "<p>I have two sheets in &quot;Property&quot; Workbook that I am copying to &quot;UQP&quot; Workbook.</p>\n<blockquote>\n<p><strong>PropertyCoverage</strong> - Houses formula <code>=VLOOKUP(&quot;PF&quot;,tPremium,2,0)</code> among other text and simple SUM formula.</p>\n<p><strong>xmlProperty</strong> - Houses table <code>tPremium</code> (among other tables; all tables mapped to XML Source)</p>\n</blockquote>\n<p>When I copy these two sheets (simultaneously) into the UQP workbook the <code>tPremium</code> reference in the formula in the PropertyCoverage sheet automatically changes to <code>tAutoForms</code>, which is another table in the UQP workbook (that has nothing to do with the formula). UQP workbook has several other sheets and tables.</p>\n<p>I don't know why this changes automatically, but I think it has something to do with the fact that Excel cannot copy multiples sheets when at least one sheet contains a table.</p>\n<p>I have tried the solution below (referenced from <a href=\"https://blogs.office.com/2009/08/31/copying-worksheets-with-a-list-or-table/\" rel=\"nofollow noreferrer\">here</a>). However, the same issue happens. The issue does not happen if I copy to a new workbook. ... <em>Bear with ActiveWorkbook, etc, I only used this as test to see if it would work</em></p>\n<pre><code>Sub Copy_Worksheets()\n\n    Dim wbMaster As Workbook\n    Set wbMaster = Workbooks(&quot;UniversalQuoteProposal.xlsb&quot;)\n    Dim TheActiveWindow As Window\n    Dim TempWindow As Window\n    With ActiveWorkbook\n        Set TheActiveWindow = ActiveWindow\n        Set TempWindow = .NewWindow\n        .Sheets(Array(&quot;PropertyCoverage&quot;, &quot;xmlProperty&quot;)).Copy Before:=wbMaster.Worksheets(1)\n    End With\n    TempWindow.Close\n\nEnd Sub\n</code></pre>\n<p>Here is my original copy code:</p>\n<pre><code>Sub CopySheetsToMaster()\n\nDim wbMaster As Workbook\nSet wbMaster = Workbooks(&quot;UniversalQuoteProposal.xlsb&quot;)\n\nDim sSheetName As String\nsSheetName = Replace(ThisWorkbook.Name, &quot;.xlsb&quot;, &quot;&quot;)\n\nDim sSheets As Variant\nsSheets = Array(sSheetName &amp; &quot;Coverage&quot;, &quot;xml&quot; &amp; sSheetName)\n\n'*** =&gt; This is where tPremium gets automatically changed to tAutoForms\nThisWorkbook.Worksheets(sSheets).Copy Before:=wbMaster.Worksheets(1)\n\nwbMaster.ChangeLink ThisWorkbook.FullName, wbMaster.FullName, xlLinkTypeExcelLinks\n\nEnd Sub\n</code></pre>\n<p>Lastly, I can work around this by doing a Replace after the sheets are copied, but since this will scale out to a need to bring a possible 7-10 other workbooks with potential formula references to tables and such, I would rather find a cleaner solution if it exists.</p>\n<p>Lastly, I am using Excel 2010.</p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482943820, "post_id": 41365965, "comment_id": 69934102, "body": "shrinks horizontally??"}, {"owner": {"reputation": 13, "user_id": 7319264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e86b627d3250deb5ed56334bc2c74d?s=128&d=identicon&r=PG&f=1", "display_name": "blxck", "link": "https://stackoverflow.com/users/7319264/blxck"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482979766, "post_id": 41365965, "comment_id": 69946724, "body": "yes, it shrink horizontally"}, {"owner": {"reputation": 13, "user_id": 7319264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e86b627d3250deb5ed56334bc2c74d?s=128&d=identicon&r=PG&f=1", "display_name": "blxck", "link": "https://stackoverflow.com/users/7319264/blxck"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1483519954, "post_id": 41365965, "comment_id": 70124892, "body": "my bad, it shrink vertically"}], "owner": {"reputation": 13, "user_id": 7319264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e86b627d3250deb5ed56334bc2c74d?s=128&d=identicon&r=PG&f=1", "display_name": "blxck", "link": "https://stackoverflow.com/users/7319264/blxck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482942209, "creation_date": 1482942209, "last_edit_date": 1531164843, "question_id": 41365965, "link": "https://stackoverflow.com/questions/41365965/listbox-shrinking-while-clicking-command-button", "title": "listbox shrinking while clicking command button", "body": "<p>i have a problem where every time i click on the command button, my listbox on userform will shrink. my command button are suppose to filter data according to respective year inserted. the listbox returns all data filter but it keep on shrinking everytime i click command button. </p>\n\n<p>this is my code on command button; </p>\n\n<pre><code>   Private Sub CommandButton5_Click()\n\nDim a, o() As Variant, n As Long\nDim i As Long, c As Long\n\nMe.ListBox1.RowSource = vbNullString\nMe.ListBox1.Clear\nMe.ListBox1.ColumnCount = 27\nMe.ListBox1.ColumnWidths = \"30 pt;65 pt;65 pt;65 pt;65 pt;130 pt;130 pt;49.95 pt;30 pt;45 pt;35 pt;65 pt;65 pt;65 pt;80 pt;65 pt;49.95 pt;30 pt;30 pt;30 pt;30 pt;100 pt;59 pt;65 pt;65 pt;30 pt;65 pt\"\n\n\na = Range(\"C2:C\" &amp; Range(\"C\" &amp; Rows.Count).End(xlUp).Row).Resize(, 27).Value2\nReDim o(1 To 27, 1 To UBound(a, 1))\n\nFor i = 1 To UBound(a, 1)\nIf UCase(a(i, 11)) Like UCase(Me.TextBox1.Value) &amp; \"*\" Then\n    n = n + 1\n    For c = 1 To UBound(a, 2)\n        o(c, n) = a(i, c)\n    Next\nEnd If\nNext\n\n If n Then\n    ReDim Preserve o(1 To 27, 1 To n)\n    Me.ListBox1.List = Application.Transpose(o)\n End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "drop-down-menu"], "comments": [{"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1482972928, "post_id": 41365713, "comment_id": 69945358, "body": "What have you found via searching? I have found this (<a href=\"http://stackoverflow.com/questions/15191847/use-getelementbyid-on-htmlelement-instead-of-htmldocument\" title=\"use getelementbyid on htmlelement instead of htmldocument\">stackoverflow.com/questions/15191847/&hellip;</a>) within a minute for example. It may be an idea to look into whether JavaScript could be used."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1483003413, "post_id": 41365713, "comment_id": 69955022, "body": "I only found posts where the person try to select 1 value but not any discussing about how to select mulitple values in a html list coding from VBA. And I don&#39;t see the relation with the link you mentioned."}], "answers": [{"tags": [], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "is_accepted": true, "score": 1, "last_activity_date": 1483012232, "creation_date": 1483012232, "answer_id": 41379136, "question_id": 41365713, "link": "https://stackoverflow.com/questions/41365713/select-multiple-values-in-a-dropdown-listbox-on-html-via-vba/41379136#41379136", "title": "Select multiple values in a dropdown listbox on html via VBA", "body": "<p><strong>Solution :</strong> Ok I found a way to do it, pretty easy actually.</p>\n\n<pre><code>With objIE.document.getElementsByTagName(\"select\")(0)\n    .Children(23).Selected = True\n    .Children(56).Selected = True\n    .Children(98).Selected = True\nEnd With\n</code></pre>\n\n<p>This command will highlight (select) the 3 elements</p>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 1, "accepted_answer_id": 41379136, "answer_count": 1, "score": 1, "last_activity_date": 1483012232, "creation_date": 1482941288, "last_edit_date": 1483007903, "question_id": 41365713, "link": "https://stackoverflow.com/questions/41365713/select-multiple-values-in-a-dropdown-listbox-on-html-via-vba", "title": "Select multiple values in a dropdown listbox on html via VBA", "body": "<p><strong>Issue :</strong> Hey, I am trying, from VBA,to select multiple values in a dropdown list on a webpage.</p>\n\n<p>The HTML code of the select element is</p>\n\n<p><a href=\"https://i.stack.imgur.com/1IrSo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1IrSo.png\" alt=\"enter image description here\"></a></p>\n\n<p>I managed to select this element with <code>objIE.document.getElementsByTagName(\"select\")(0)</code> since it's the first element with the tagname \"select\" on the whole webpage.</p>\n\n<p>If I write <code>objIE.document.getElementsByTagName(\"select\")(0).Value= \"E31\"</code>, the value \"E31\" will be highlighted in the drop box, that's fine.</p>\n\n<p>But how can I select multiple values ?</p>\n\n<p>I tried <code>objIE.document.getElementsByTagName(\"select\")(0).Value= \"E31\" + \"E32\"</code> or  <code>objIE.document.getElementsByTagName(\"select\")(0).Value= \"E31\" &amp; \"E32\"</code> but it doesn't work...</p>\n\n<p>EDIT : Further attempts : I am currently trying to fix this issue using the SendKeys command where I click on one element of the list and then select other elements with SendKeys \"+{DOWN 4}\" which should select the 4 elements in the list under the initial one selected.</p>\n\n<pre><code>'objIE.document.getElementsByTagName(\"select\")(0).Children(8).Selected = True' If I activate this line it selects (= highlight) the 9th element of the list\n'objIE.document.getElementsByTagName(\"select\")(0).Children(8).Click'if I activate this line it clicks on the 9th element of the list but doesn't highlight it\nSendKeys \"+{DOWN 3}\"\n</code></pre>\n\n<p>Unfortunately this doesn't work yet. Moreover, I don't know if there is a way to send a key CTRL + MouseLeftClick somehow as mentioned in <a href=\"https://www.autoitscript.com/autoit3/docs/appendix/SendKeys.htm\" rel=\"nofollow noreferrer\">here</a> but for the command <em>Send</em> which is not valid in VBA.</p>\n\n<p>Any ideas ?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 918, "user_id": 7350570, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/316aab1147e0a6bb298b952a16bc6534?s=128&d=identicon&r=PG", "display_name": "Dylan Russell", "link": "https://stackoverflow.com/users/7350570/dylan-russell"}, "edited": false, "score": 0, "creation_date": 1482941260, "post_id": 41365668, "comment_id": 69932761, "body": "Also, I&#39;m certain my NewFoodEntry() is probably terribly inefficient and not coded in the cleanest way, but I&#39;m really just looking for advice on getting the hyperlink to work. Still, any advice on cleaning up my macro code will be appreciated! Thanks in advance."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482943242, "post_id": 41365668, "comment_id": 69933783, "body": "I can&#39;t replicate this - it works fine when I test your code. Try putting <code>Debug.Print Target.Range.Address</code> <i>outside</i> of the <code>If</code> statement to make sure that A, the event handler is firing, and B, that the value of <code>Target.Range.Address</code> is what you expect."}, {"owner": {"reputation": 918, "user_id": 7350570, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/316aab1147e0a6bb298b952a16bc6534?s=128&d=identicon&r=PG", "display_name": "Dylan Russell", "link": "https://stackoverflow.com/users/7350570/dylan-russell"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482943718, "post_id": 41365668, "comment_id": 69934062, "body": "I tried it and I still am getting nothing printed in the immediate window. I tried reopening the excel file but it still doesnt work. I click the hyperlink and nothing happens. No print. No macro if I change the code to Run(NewFoodEntry)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482943822, "post_id": 41365668, "comment_id": 69934105, "body": "That means your event handler isn&#39;t firing.  Try dropping <code>Application.EnableEvents = True</code> in a test sub and running it."}, {"owner": {"reputation": 918, "user_id": 7350570, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/316aab1147e0a6bb298b952a16bc6534?s=128&d=identicon&r=PG", "display_name": "Dylan Russell", "link": "https://stackoverflow.com/users/7350570/dylan-russell"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482951399, "post_id": 41365668, "comment_id": 69937734, "body": "Where exactly do you put that comment? I put it in the Worksheet_FollowHyperlink() sub and that didnt work. I also made a separate sub called TestSub() and tried it in there too. Still didn&#39;t do anything. Hyperlink still isnt printing to the immediate window."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482952355, "post_id": 41365668, "comment_id": 69938153, "body": "You can put it anywhere.  Running it just ensures that events aren&#39;t disabled.  If you put a breakpoint on <code>If Target.Range.Address = &quot;$A$37&quot; Then </code> do you hit it when you click on the hyperlink?"}, {"owner": {"reputation": 918, "user_id": 7350570, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/316aab1147e0a6bb298b952a16bc6534?s=128&d=identicon&r=PG", "display_name": "Dylan Russell", "link": "https://stackoverflow.com/users/7350570/dylan-russell"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482963713, "post_id": 41365668, "comment_id": 69942737, "body": "So i put a breakpoint where you instructed in the sheet1 code and clicked the hyperlink. Nothing happens. Not sure if im doing it correctly."}, {"owner": {"reputation": 918, "user_id": 7350570, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/316aab1147e0a6bb298b952a16bc6534?s=128&d=identicon&r=PG", "display_name": "Dylan Russell", "link": "https://stackoverflow.com/users/7350570/dylan-russell"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482964963, "post_id": 41365668, "comment_id": 69943177, "body": "Is there anyway I can just send you my excel document and you mess around to see if you encounter the same problem? It&#39;s like clicking the hyperlink creates absolutely no response."}, {"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1482973394, "post_id": 41365668, "comment_id": 69945446, "body": "@dylan russell You could upload it to mediafire, and state the URL to the file in your question"}], "owner": {"reputation": 918, "user_id": 7350570, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/316aab1147e0a6bb298b952a16bc6534?s=128&d=identicon&r=PG", "display_name": "Dylan Russell", "link": "https://stackoverflow.com/users/7350570/dylan-russell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1483398154, "creation_date": 1482941097, "last_edit_date": 1483398154, "question_id": 41365668, "link": "https://stackoverflow.com/questions/41365668/difficulty-linking-hyperlink-to-macro-in-excel-mac", "title": "Difficulty linking hyperlink to macro in excel mac", "body": "<p>I have looked up this problem so many times and it still doesnt seem to work for me. I am learning VBA and as a practice project am trying to make a nutritional tracker. I am trying to make a hyperlink that, when clicked, runs a macro to add a new food entry row. Here is my NewFoodEntry():</p>\n\n<pre><code>Sub NewFoodEntry()\n'\n' NewFoodEntry Macro\n' Insert new food entry row.\n'\n' Keyboard Shortcut: Option+Cmd+Shift+N\n'\n' Setting selection as input cell'\n    Dim myRange As Range\n    Set myRange = Selection\n\n' Select default food entry row'\n\n    Range(myRange.Offset(-1, 0), myRange.Offset(-1, 7)).Select\n    Selection.Copy\n\n'Insert default food entry row below myRange selection'\n    myRange.Insert Shift:=xlDown\n    myRange.Select\n    Application.CutCopyMode = False\n\n'Select correct Totals cell'\n    Dim totalsRange As Range\n    Set totalsRange = Sheets(\"Nutrition\").Range(\"D:D\").Find(\"Totals\", After:=myRange.Offset(0, 3), SearchOrder:=xlByRows, SearchDirection:=xlNext)\n    Debug.Print totalsRange.Address\n\n'Select correct Calories cell'\n\n    Dim caloriesRange As Range\n    Set caloriesRange = Sheets(\"Nutrition\").Range(\"E:E\").Find(\"Calories\", After:=totalsRange.Offset(0, 1), SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n\n    If caloriesRange Is Nothing Then\n        Debug.Print \"Calories still not found.\"\n\n    Else\n        Debug.Print caloriesRange.Address\n\n    End If\n\n'Select correct Protein cell'\n\n    Dim proteinRange As Range\n    Set proteinRange = Sheets(\"Nutrition\").Range(\"F:F\").Find(\"Protein\", After:=totalsRange.Offset(0, 2), SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n\n    If proteinRange Is Nothing Then\n        Debug.Print \"Protein still not found.\"\n\n    Else\n        Debug.Print proteinRange.Address\n\n    End If\n\n'Select correct Carbs cell'\n\n    Dim carbsRange As Range\n    Set carbsRange = Sheets(\"Nutrition\").Range(\"G:G\").Find(\"Carbs\", After:=totalsRange.Offset(0, 3), SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n\n    If carbsRange Is Nothing Then\n        Debug.Print \"Carbs still not found.\"\n\n    Else\n        Debug.Print carbsRange.Address\n\n    End If\n\n'Select correct Fat cell'\n\n    Dim fatRange As Range\n    Set fatRange = Sheets(\"Nutrition\").Range(\"H:H\").Find(\"Fat\", After:=totalsRange.Offset(0, 4), SearchOrder:=xlByRows, SearchDirection:=xlPrevious)\n\n    If fatRange Is Nothing Then\n        Debug.Print \"Fat still not found.\"\n\n    Else\n        Debug.Print fatRange.Address\n\n    End If\n\n    'Calculate Calories Total\n\n    totalsRange.Offset(0, 1).Formula = \"=SUM(\" &amp; caloriesRange.Offset(1, 0).Address &amp; \":\" &amp; totalsRange.Offset(-1, 1).Address &amp; \")\"\n\n    'Calculate Protein Total\n\n    totalsRange.Offset(0, 2).Formula = \"=SUM(\" &amp; proteinRange.Offset(1, 0).Address &amp; \":\" &amp; totalsRange.Offset(-1, 2).Address &amp; \")\"\n\n    'Calculate Carbs Total\n\n    totalsRange.Offset(0, 3).Formula = \"=SUM(\" &amp; carbsRange.Offset(1, 0).Address &amp; \":\" &amp; totalsRange.Offset(-1, 3).Address &amp; \")\"\n\n    'Calculate Fat Total\n\n    totalsRange.Offset(0, 4).Formula = \"=SUM(\" &amp; fatRange.Offset(1, 0).Address &amp; \":\" &amp; totalsRange.Offset(-1, 4).Address &amp; \")\"\n\n\nEnd Sub\n</code></pre>\n\n<p>That is under the \"module 1\" of my VBA editor.</p>\n\n<p>Now I also went to the proper sheet object (\"nutrition\") in my VBA editor and entered the code.</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If Target.Range.Address = \"$A$37\" Then \n        Debug.Print \"It worked\"\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I can't seem to get this code to work. Clicking the hyperlink doesn't print to the immediate window. Obviously, running the macro via the hyperlink doesnt work either. Here is a screenshot of my excel so you get an idea of what im trying to do.</p>\n\n<p><a href=\"https://i.stack.imgur.com/E65V4.png\" rel=\"nofollow noreferrer\">Excel Screenshot</a></p>\n\n<p>I should also add that this is the code I used to convert a cell text to a hyperlink:</p>\n\n<pre><code>Sub HyperActive()\n\n'Make a hyperlink\n\n    Dim nm As String\n\n    nm = ActiveSheet.Name &amp; \"!\"\n    For Each r In Selection\n        t = r.Text\n        addy = nm &amp; r.Address(0, 0)\n        ActiveSheet.Hyperlinks.Add Anchor:=r, Address:=\"\", SubAddress:= _\n            addy, TextToDisplay:=r.Text\n    Next r\nEnd Sub\n</code></pre>\n\n<p>EDIT:\nAfter much frustration, I have found that the Worksheet_FollowHyperlink does not work on Macs after Excel 2010. I do not know why or if this is actually true, so if anyone has anymore insight into this, let me know.</p>\n\n<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_mac/mac-excel-2011-hyperlinks-dont-work-as-buttons/41192768-45fd-47db-ad8c-f614fc83be5a\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_mac/mac-excel-2011-hyperlinks-dont-work-as-buttons/41192768-45fd-47db-ad8c-f614fc83be5a</a> </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482940324, "post_id": 41365418, "comment_id": 69932218, "body": "what is your neighbor cell in case of Cell &quot;B1&quot; ? is it A1 to A5 ? or C1 to C5 ?"}, {"owner": {"reputation": 447, "user_id": 7167717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9c5918261e279b685fa7162d67f8884d?s=128&d=identicon&r=PG&f=1", "display_name": "m aksem", "link": "https://stackoverflow.com/users/7167717/m-aksem"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482940593, "post_id": 41365418, "comment_id": 69932379, "body": "I&#39;m using B1 cell for X value and B2 cells formula bar for &quot;=uzd(1)&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1482940811, "creation_date": 1482940811, "answer_id": 41365579, "question_id": 41365418, "link": "https://stackoverflow.com/questions/41365418/my-for-loop-in-vba-is-returning-ref-instead-of-an-integer/41365579#41365579", "title": "My for loop in VBA is returning #REF instead of an integer", "body": "<p>Since you are sending a numeric reference to your function, you need to define `x As Integer (or 'Long' for higher values).</p>\n\n<p>Second, I had issues with <strong>uzd1</strong> (maybe it's a \"saved\" word in Excel), so I modified it to <strong>uzd</strong>.</p>\n\n<p>Third, since you want to get the sum as a result, define your function to return an <code>Integer</code> (or <code>Long</code> for higher values).</p>\n\n<p><strong>Code of modified UDF</strong></p>\n\n<pre><code>Function uzd(x As Integer) As Integer\n\n    Dim a As Integer, b As Integer\n\n    For a = 1 To 5\n        b = b + a * x\n    Next a\n    uzd = b\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 4, "last_activity_date": 1482940854, "creation_date": 1482940854, "answer_id": 41365594, "question_id": 41365418, "link": "https://stackoverflow.com/questions/41365418/my-for-loop-in-vba-is-returning-ref-instead-of-an-integer/41365594#41365594", "title": "My for loop in VBA is returning #REF instead of an integer", "body": "<p><code>uzd1</code> is a cell address and that's why you are getting a #Ref Error.</p>\n\n<p>Change the function name to something else such as <code>TestCalc</code>, it will work.</p>\n"}, {"comments": [{"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1482941119, "post_id": 41365609, "comment_id": 69932688, "body": "This should be a comment, not an answer."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1482941386, "post_id": 41365609, "comment_id": 69932835, "body": "Maybe you are right, on the other hand writing a function for multiplying x with the sum of the first 5 numbers made me thinking I should post this as an answer. It seems the gaussian sum formula is not known."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1482940892, "creation_date": 1482940892, "answer_id": 41365609, "question_id": 41365418, "link": "https://stackoverflow.com/questions/41365418/my-for-loop-in-vba-is-returning-ref-instead-of-an-integer/41365609#41365609", "title": "My for loop in VBA is returning #REF instead of an integer", "body": "<p>According to your loop you do nothing else than multiply x with the sum of 1 to 5, that is nothing else than 15*x. So, there is no need for a loop or a user defined function</p>\n"}], "owner": {"reputation": 447, "user_id": 7167717, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9c5918261e279b685fa7162d67f8884d?s=128&d=identicon&r=PG&f=1", "display_name": "m aksem", "link": "https://stackoverflow.com/users/7167717/m-aksem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1482942546, "accepted_answer_id": 41365594, "answer_count": 3, "score": 0, "last_activity_date": 1482941529, "creation_date": 1482940218, "last_edit_date": 1531164843, "question_id": 41365418, "link": "https://stackoverflow.com/questions/41365418/my-for-loop-in-vba-is-returning-ref-instead-of-an-integer", "closed_reason": "Duplicate", "title": "My for loop in VBA is returning #REF instead of an integer", "body": "<p>I need to take variable x from a cell and get the sum of <code>1*x+2*x...+5*x</code> in the neighbouring cell.\nMy attempt:</p>\n\n<pre><code>Public Function uzd1(x)\n    Dim a, c, b As Integer\n    b = 0\n    For a = 1 To 5\n        c = a * x\n        b = b + c\n    Next\n   uzd1 = b\nEnd Function\n</code></pre>\n\n<p>Then I type \"=uzd1(B1)\" in the answer cell, but I only get \"#REF!\" instead of summary I need.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2835, "user_id": 1677829, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ef99daa15343d01b8948d5fa57fae7f4?s=128&d=identicon&r=PG", "display_name": "Lunyx", "link": "https://stackoverflow.com/users/1677829/lunyx"}, "is_accepted": false, "score": 1, "last_activity_date": 1482939401, "last_edit_date": 1592644375, "creation_date": 1482939401, "answer_id": 41365185, "question_id": 41365126, "link": "https://stackoverflow.com/questions/41365126/modify-program-below-to-accept-both-letters-and-numbers/41365185#41365185", "title": "Modify program below to accept both letters and numbers", "body": "<p>Change <code>[0-9]*</code> to <code>[A-Za-z0-9]*</code>.</p>\n<p>For reference: <a href=\"https://msdn.microsoft.com/en-us/library/swf8kaxw.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/swf8kaxw.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n<blockquote>\n<p>Multiple Character Ranges</p>\n<p>To specify multiple ranges for the same character position, put them within the same brackets without delimiters. For example, [A\u2013CX\u2013Z] results in a match if the corresponding character position in string contains any character within either the range A\u2013C or the range X\u2013Z.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 7350417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4afe690b49c53f0be1618da64b63bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Mel", "link": "https://stackoverflow.com/users/7350417/mel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482939401, "creation_date": 1482939168, "last_edit_date": 1531164843, "question_id": 41365126, "link": "https://stackoverflow.com/questions/41365126/modify-program-below-to-accept-both-letters-and-numbers", "title": "Modify program below to accept both letters and numbers", "body": "<pre><code>Public Function CheckForNumChar(Text As String) As Boolean\n</code></pre>\n\n<p>Abstract: This Function checks a character for an NUMERIC character<br>\nInput Parameters: Char = Character to check<br>\nOutput Parameters: True if Numeric or False if Not Numeric   </p>\n\n<pre><code> Dim Length, prompt, Char As String\n    Dim response\n    Dim I As Integer\n\n    Length = Len(Text)  'Check length of string\n    For I = 1 To Length Step 1\n    CheckForNumChar = ((Mid(Text, I, Length) Like \"[0-9]*\")) 'Checks for number\n    `enter code here`If CheckForNumChar Then\n            Else 'Character is not Numeric\n    prompt = \"Only Numeric Characters Are Permitted In This Field\"    'MsgBox string\n                response = MsgBox(prompt, vbOKOnly + vbExclamation, \"Character \n\nCheck\")             'MsgBox\n            SendKeys \"{Bs}\", True       'Backspace\n            Exit Function\n    End If\nNext I\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "sql-update"], "comments": [{"owner": {"reputation": 300, "user_id": 3661126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iYDo.jpg?s=128&g=1", "display_name": "Nambu14", "link": "https://stackoverflow.com/users/3661126/nambu14"}, "edited": false, "score": 0, "creation_date": 1482939184, "post_id": 41364844, "comment_id": 69931580, "body": "can this help? <a href=\"http://stackoverflow.com/questions/20528709/how-can-i-update-multiple-tables-with-one-query-using-access-odbc\" title=\"how can i update multiple tables with one query using access odbc\">stackoverflow.com/questions/20528709/&hellip;</a>"}, {"owner": {"reputation": 300, "user_id": 3661126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iYDo.jpg?s=128&g=1", "display_name": "Nambu14", "link": "https://stackoverflow.com/users/3661126/nambu14"}, "edited": false, "score": 0, "creation_date": 1482939194, "post_id": 41364844, "comment_id": 69931586, "body": "Or this one! :) <a href=\"http://www.access-programmers.co.uk/forums/showthread.php?t=214306\" rel=\"nofollow noreferrer\">access-programmers.co.uk/forums/showthread.php?t=214306</a>"}, {"owner": {"reputation": 1, "user_id": 6465544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f0218ab721fc4fbdc37a30c2c6301e?s=128&d=identicon&r=PG&f=1", "display_name": "avl555", "link": "https://stackoverflow.com/users/6465544/avl555"}, "reply_to_user": {"reputation": 300, "user_id": 3661126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iYDo.jpg?s=128&g=1", "display_name": "Nambu14", "link": "https://stackoverflow.com/users/3661126/nambu14"}, "edited": false, "score": 0, "creation_date": 1482940388, "post_id": 41364844, "comment_id": 69932261, "body": "Thanks, I&#39;ll check those out right now and let you know how it goes"}, {"owner": {"reputation": 1, "user_id": 6465544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f0218ab721fc4fbdc37a30c2c6301e?s=128&d=identicon&r=PG&f=1", "display_name": "avl555", "link": "https://stackoverflow.com/users/6465544/avl555"}, "reply_to_user": {"reputation": 300, "user_id": 3661126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iYDo.jpg?s=128&g=1", "display_name": "Nambu14", "link": "https://stackoverflow.com/users/3661126/nambu14"}, "edited": false, "score": 0, "creation_date": 1482941118, "post_id": 41364844, "comment_id": 69932687, "body": "From reading the links, I think I&#39;ll try the one big Transaction option. Since I am not using multiple tables it seems like this would be the effective fix. I&#39;ll just begin a transaction, stuff all my update statements in, commit, and see what happens."}, {"owner": {"reputation": 1, "user_id": 6465544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f0218ab721fc4fbdc37a30c2c6301e?s=128&d=identicon&r=PG&f=1", "display_name": "avl555", "link": "https://stackoverflow.com/users/6465544/avl555"}, "reply_to_user": {"reputation": 300, "user_id": 3661126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0iYDo.jpg?s=128&g=1", "display_name": "Nambu14", "link": "https://stackoverflow.com/users/3661126/nambu14"}, "edited": false, "score": 0, "creation_date": 1482943653, "post_id": 41364844, "comment_id": 69934022, "body": "So far nothing has worked out for me yet @Nambu14, but thanks for the references; I will continue to see if  I can find a good solution."}], "owner": {"reputation": 1, "user_id": 6465544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60f0218ab721fc4fbdc37a30c2c6301e?s=128&d=identicon&r=PG&f=1", "display_name": "avl555", "link": "https://stackoverflow.com/users/6465544/avl555"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 687, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1513002666, "creation_date": 1482938167, "last_edit_date": 1513002666, "question_id": 41364844, "link": "https://stackoverflow.com/questions/41364844/how-to-update-multiple-tables-with-one-update-statement-in-microsoft-access-usi", "title": "How to update multiple tables with one Update statement in Microsoft Access (using VBA coding and SQL)", "body": "<p>Here is my setup: I have made a Parts Order Form the contains combo boxes labeled P1-P10 (part) with resource data taken from my table [Inventory C] showing OEM# (key) and Description. The other combo boxes, containing numbers, are named QO1-QO10 respectively (for quantities ordered). On selecting/typing an entry for the individual combo boxes the code that I have in a test button updates the record that matches the part # in the combo box (P1 for example) and the corresponding selected number from the number box (QO1 for example) and updates the [USED QTY] column of my table to add the selected number the corresponding part. </p>\n\n<pre><code>    Public Sub TestButton_Click()\n        Dim SQL As String\n        SQL= \"UPDATE [INVENTORY C]\" &amp; _\n             \"SET [QTY USED]=[QTY USED]-(QO1.Value)\" &amp; _\n             \"WHERE [OEM#] = P1.Value\"\n        DoCmd.RunSQL SQL\n        End\n    End Sub\n</code></pre>\n\n<p>This code runs fine, but I have more than  those two combo boxes. Currently I have to redo this same statement nine more times within the same code segment for them all to be updated with a click. During the test after clicking the Test Button, a message will alert you that you are changing a row on your table and to press OK to continue (good!) but it does it ten times (not so good... also there is an error if you press NO so held with an error handler would be appreciated). In the form I have it set up almost like an Excel worksheet, and my users will be using multiple boxes to input information; I will embed the code into a print function so that when they press print, it will also ask them to update all records entered ONE TIME (so that on click it asks: \"You are about to Update (10) records. Any changes...\"). <strong>How can I code this in VBA, using SQL to UPDATE MULTIPLE RECORDS in the SAME CODE SEGMENT</strong> Can I use a switch or case statement?? This help would be much appreciated.</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482936461, "post_id": 41364283, "comment_id": 69930020, "body": "Welcome to S.O! Have you tried anything? If so, please, provide the code. Take a look to the <a href=\"http://stackoverflow.com/tour\">tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>. Friendly reminder: StackOverflow is not a &quot;we code for you&quot; service provider. <a href=\"https://blog.udemy.com/excel-macros-tutorial/\" rel=\"nofollow noreferrer\">Introduction to VBA</a> or <a href=\"http://analysistabs.com/excel-vba/codes-examples-macros-how-tos-most-useful-basics-advanced/\" rel=\"nofollow noreferrer\">Mid-Advanced Tutorials</a> and my <a href=\"http://analystcave.com/excel-vba-tutorial/\" rel=\"nofollow noreferrer\">personal favorite</a>"}, {"owner": {"reputation": 15, "user_id": 7075519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85pFy.jpg?s=128&g=1", "display_name": "Brad Tostenson", "link": "https://stackoverflow.com/users/7075519/brad-tostenson"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482936713, "post_id": 41364283, "comment_id": 69930167, "body": "Dim ws As Worksheet Dim mnth As String, dte As String, mday As String  mday = Now() - Weekday(Now(), 3)  mnth = Month(mday) dte = Day(mday)  tabstr = mnth &amp; &quot; &quot; &amp; dte      For Each ws In Worksheets         If ws.Name = tabstr Then             ws.Select             Exit For         End If     Next"}, {"owner": {"reputation": 15, "user_id": 7075519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85pFy.jpg?s=128&g=1", "display_name": "Brad Tostenson", "link": "https://stackoverflow.com/users/7075519/brad-tostenson"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482936920, "post_id": 41364283, "comment_id": 69930288, "body": "I tried the above code but I think it is treating it like #&#39;s &quot;1 2&quot; and I need it to see it as &quot;jan 2&quot;"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1482937116, "post_id": 41364283, "comment_id": 69930418, "body": "You&#39;re using the wrong function: month() will return the &quot;#&quot; of it, for month as name use <a href=\"https://www.techonthenet.com/excel/formulas/monthname.php\" rel=\"nofollow noreferrer\">monthname</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1482937277, "post_id": 41364283, "comment_id": 69930518, "body": "<code>Format(Month(mday),&quot;mmm&quot;)</code> will also work"}, {"owner": {"reputation": 15, "user_id": 7075519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85pFy.jpg?s=128&g=1", "display_name": "Brad Tostenson", "link": "https://stackoverflow.com/users/7075519/brad-tostenson"}, "edited": false, "score": 0, "creation_date": 1482942344, "post_id": 41364283, "comment_id": 69933354, "body": "I get a Run-time error 13, Type mismatch on your suggestion from Sgdva. I get a compile error on your suggestion Scott"}, {"owner": {"reputation": 15, "user_id": 7075519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85pFy.jpg?s=128&g=1", "display_name": "Brad Tostenson", "link": "https://stackoverflow.com/users/7075519/brad-tostenson"}, "edited": false, "score": 0, "creation_date": 1482951380, "post_id": 41364283, "comment_id": 69937727, "body": "This works, very inelegant, need a little help to fix it.   Private Sub Workbook_Open() Dim ws As Worksheet Dim mnth As String, dte As String, mday As Date mday = Now() - Weekday(Now(), 3) - 7 mnth = MonthName(Month(mday), True) dte = Day(mday) tabstr = mnth &amp; &quot; &quot; &amp; dte For Each ws In Worksheets If ws.Name = tabstr Then ws.Select Exit For End If Next mday = Now() - Weekday(Now(), 3) mnth = MonthName(Month(mday), True) dte = Day(mday) tabstr = mnth &amp; &quot; &quot; &amp; dte For Each ws In Worksheets If ws.Name = tabstr Then ws.Select Exit For End If Next End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 7075519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85pFy.jpg?s=128&g=1", "display_name": "Brad Tostenson", "link": "https://stackoverflow.com/users/7075519/brad-tostenson"}, "is_accepted": true, "score": 0, "last_activity_date": 1483118808, "creation_date": 1483118808, "answer_id": 41400172, "question_id": 41364283, "link": "https://stackoverflow.com/questions/41364283/excel-2016-open-specific-sheet-based-on-current-date/41400172#41400172", "title": "Excel 2016 Open specific sheet based on current date", "body": "<pre><code>    Sub CalendarUpdate()\n    ' Created by Brad Tostenson 12/28/2016\n    ' Credit \"Johnny B\"\n    ' calendarUpdate Macro\n\n    ' The following code performs 2 basic operations;\n    ' OPERATION 1: Opens the Calendar Of Time Off workbook associated with this workbook, updates the information in it and closes it.\n' OPERATION 2: Sets the opening page to the current period of time for the Calendar Of Time Off workbook.\n\n' OPERATION 1\n' _________________________________________________________________________________\n' Turns off alerts so that the user does not receive any dialog boxes\n    Application.DisplayAlerts = False\n' Saves the TimeOff workbook\n    ActiveWorkbook.Save\n' Opens the Calendar workbook so that it can be updated with the new information\n    Workbooks.Open Filename:=\"S:\\Calendar Of Time Off.xltx\"\n\n' OPERATION 2\n' _________________________________________________________________________________\n' variable setup\nDim ws As Worksheet\nDim mnth As String, dte As String, mday As Date\n' OPERATION 2.1 (Previous week's Monday)\n' Finds todays date, from that it finds the previous week's Monday e.g. (if today is Thursday December 29, mday would = December 19)\n    mday = Now() - Weekday(Now(), 3) - 7\n\n' OPERATION 2.11 (a portion of this operation is duplicated in operation 2.2)\n' Based on the outcome of \"mday\" it gets the month information and then makes the three letter version = \"mnth\" e.g. (if mday = December 19, mnth = Dec)\n    mnth = MonthName(Month(mday), True)\n' Based on the outcome of \"mday\" it gets the day information and then makes that = \"dte\" e.g. (if mday = December 19, dte = 19)\n    dte = Day(mday)\n' Uses the information in \"mnth\" &amp; \"dte\" to create a value that will match the syntax used in the naming of the tabs e.g. (Dec 19)\n    tabstr = mnth &amp; \" \" &amp; dte\n' The following code uses the \"tabstr\" (Dec 19) information and will look for a match in the tab names and then opens the workbook to that tab\n    For Each ws In Worksheets\n        If ws.Name = tabstr Then\n            ws.Select\n            Exit For\n        End If\n\n    Next\n\n' OPERATION 2.2\n' Finds todays date, from that it finds the this week's Monday e.g.(if today is Thursday December 29, mday would = December 26)\n    mday = Now() - Weekday(Now(), 3)\n    mnth = MonthName(Month(mday), True)\n    dte = Day(mday)\n    tabstr = mnth &amp; \" \" &amp; dte\n    For Each ws In Worksheets\n        If ws.Name = tabstr Then\n            ws.Select\n            Exit For\n        End If\n    Next\n' _________________________________________________________________________________\n' OPERATION 1 (CONTINUED)\n' Saves the Calendar of Time Off Sheet as a template to avoid file open errors\n    ActiveWorkbook.SaveAs Filename:=\"S:\\Calendar Of Time Off\", FileFormat:=54\n    ActiveWorkbook.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7075519, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85pFy.jpg?s=128&g=1", "display_name": "Brad Tostenson", "link": "https://stackoverflow.com/users/7075519/brad-tostenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 0, "accepted_answer_id": 41400172, "answer_count": 1, "score": -1, "last_activity_date": 1483118808, "creation_date": 1482936155, "last_edit_date": 1482937614, "question_id": 41364283, "link": "https://stackoverflow.com/questions/41364283/excel-2016-open-specific-sheet-based-on-current-date", "title": "Excel 2016 Open specific sheet based on current date", "body": "<p>Excel 2016 Workbook with 26 sheets all named Jan 2, Jan 16, Jan 30, Feb 13 and so on. On each sheet cell B1 also has this same information, Jan 2, Jan 16, Jan 30, Feb 13 respectively. On each sheet is also more date information, worksheet Jan 2, B3 has the first date of that week (Jan 2) and then progresses for the two week period Jan 3, Jan 4 Jan 5 ending at M3 Jan 14 only skipping Sundays. I want to have the work book open to the worksheet that has the information about todays date in it. So when I open it on May 19th for instance the worksheet that it is opened to would be May 8. </p>\n\n<pre><code>Dim ws As Worksheet \nDim mnth As String, dte As String, mday As String \nmday = Now() - Weekday(Now(), 3) \nmnth = Month(mday) \ndte = Day(mday) tabstr = mnth &amp; \" \" &amp; dte \nFor Each ws In Worksheets \nIf ws.Name = tabstr Then ws.Select Exit For \nEnd If \nNext ws\n</code></pre>\n"}, {"tags": ["vba", "excel", "templates", "powerpoint"], "comments": [{"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1482935037, "post_id": 41363981, "comment_id": 69929275, "body": "Try msoTrue for ReadOnly?"}, {"owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 1, "creation_date": 1482940645, "post_id": 41363981, "comment_id": 69932407, "body": "Where exactly are you saving the presentation? Since you haven\u2019t provided a path (SaveAs), it is possible that the save is happening in a folder where you may not have write access."}, {"owner": {"reputation": 125, "user_id": 2562294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd6592c7879b47c09015b6b388b7288?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/2562294/robert"}, "reply_to_user": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1483025942, "post_id": 41363981, "comment_id": 69967544, "body": "@Jbjstam I&#39;ve tried that, but unfortunately that didn&#39;t make a difference"}, {"owner": {"reputation": 125, "user_id": 2562294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd6592c7879b47c09015b6b388b7288?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/2562294/robert"}, "reply_to_user": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "edited": false, "score": 0, "creation_date": 1483025971, "post_id": 41363981, "comment_id": 69967562, "body": "Thanks @ShyamPillai! Specifying the path along with the filename did work!"}], "owner": {"reputation": 125, "user_id": 2562294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd6592c7879b47c09015b6b388b7288?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/2562294/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 733, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482934944, "creation_date": 1482934944, "last_edit_date": 1531164843, "question_id": 41363981, "link": "https://stackoverflow.com/questions/41363981/vba-powerpoint-unable-to-save-presentation", "title": "VBA PowerPoint unable to save presentation", "body": "<p>I'm trying to pull together a marco that add data and charts from Excel into a powerpoint template and save it in a directory. The macro is being run from Excel. </p>\n\n<p>After running it, the following message appears:</p>\n\n<pre><code>Run-time error '-2147467259 (80004005)':\n\nPresentation (unknown member): PowerPoint was unable to open or save this document. Please ensure that you have access priviliges to read or write the document that is not encrypted.\n</code></pre>\n\n<p>Below is the VBA code:</p>\n\n<pre><code>Sub CreateMPP()\n\nDim DestinationTemplate As String\nDim PowerPointApp As PowerPoint.Application\nDim myTemplate As PowerPoint.Presentation\n\nDestinationTemplate = \"C:\\Users\\Me\\Documents\\MPP_Template.potx\"\nSet PowerPointApp = CreateObject(\"PowerPoint.Application\")\nPowerPointApp.Visible = True\n\nSet myTemplate = PowerPointApp.Presentations.Open(DestinationTemplate, ReadOnly:=msoFalse)\n\n'Other macro that pulls the data and charts, which works perfectly fine\nCall CreatePowerPointTest\n\nmyTemplate.SaveAs \"TestTest\", ppSaveAsPresentation\nmyTemplate.Close\n\nPowerPointApp.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "range", "cell"], "comments": [{"owner": {"reputation": 10027, "user_id": 385907, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5e249e45a1849e387e324787d08ef738?s=128&d=identicon&r=PG", "display_name": "barlop", "link": "https://stackoverflow.com/users/385907/barlop"}, "edited": false, "score": 0, "creation_date": 1504876914, "post_id": 41363555, "comment_id": 79197239, "body": "this may work for a simple case <a href=\"http://www.cpearson.com/excel/cells.htm\" rel=\"nofollow noreferrer\">cpearson.com/excel/cells.htm</a>  with case of set myrange=Range(&quot;A1:A10&quot;) and using stuff at that link re indexing a range , and using  myrange.Rows.Count"}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 2, "last_activity_date": 1482933941, "creation_date": 1482933941, "answer_id": 41363720, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/41363720#41363720", "title": "Find Last cell from Range VBA", "body": "<p>try the following</p>\n\n<pre><code>rngOrigin.End(xlDown).End(xlRight)\n</code></pre>\n\n<p>or you could use the <code>CurrentRegion</code> and count the rows and columns and use <code>Offset</code></p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 7074250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba41c9652ce14678e8dc629704e01e?s=128&d=identicon&r=PG&f=1", "display_name": "Fajka", "link": "https://stackoverflow.com/users/7074250/fajka"}, "edited": false, "score": 1, "creation_date": 1482938146, "post_id": 41364055, "comment_id": 69931015, "body": "I want to find last cell of Range which is Current Region, not whole Worksheet. If worksheet contain Data which are beyond Current Region I do not want to include them."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 61, "user_id": 7074250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba41c9652ce14678e8dc629704e01e?s=128&d=identicon&r=PG&f=1", "display_name": "Fajka", "link": "https://stackoverflow.com/users/7074250/fajka"}, "edited": false, "score": 0, "creation_date": 1482939126, "post_id": 41364055, "comment_id": 69931546, "body": "What is your defined range ?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1482935290, "creation_date": 1482935290, "answer_id": 41364055, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/41364055#41364055", "title": "Find Last cell from Range VBA", "body": "<p>In your case, since you want to find the cell to the most right and down in your <code>wksOrigin</code> (defined as Worksheet), you could use the <code>SpecialCells(xlCellTypeLastCell)</code> to get the last cell Row and Column.</p>\n\n<pre><code>i = wksOrigin.Cells.SpecialCells(xlCellTypeLastCell).Row ' &lt;-- get last row number\nj = wksOrigin.Cells.SpecialCells(xlCellTypeLastCell).Column ' &lt;-- get last column number\n</code></pre>\n\n<p>If you want to debug your result, you can add:</p>\n\n<pre><code>MsgBox \"Last row at \" &amp; i &amp; \", last column at \" &amp; j\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1482939789, "creation_date": 1482939789, "answer_id": 41365292, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/41365292#41365292", "title": "Find Last cell from Range VBA", "body": "<p>maybe you're after this:</p>\n\n<pre><code>'absolute indexes from cell A1\nWith rngOrigin\n    i = .Rows(.Rows.count).row\n    j = .Columns(.Columns.count).Column\nEnd With\n\n'relative indexes from rngOrigin upleftmost cell\nWith rngOrigin\n    i = .Rows(.Rows.count).row - .Rows(1).row + 1\n    j = .Columns(.Columns.count).Column - .Columns(1).Column + 1\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483024608, "post_id": 41382066, "comment_id": 69966764, "body": "then you should adopt my &quot;absolute&quot; code and both avoid repeating <code>rngOrigin</code> and use a (to me) more proper range specification"}], "tags": [], "owner": {"reputation": 61, "user_id": 7074250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba41c9652ce14678e8dc629704e01e?s=128&d=identicon&r=PG&f=1", "display_name": "Fajka", "link": "https://stackoverflow.com/users/7074250/fajka"}, "is_accepted": false, "score": 1, "last_activity_date": 1483023287, "creation_date": 1483023287, "answer_id": 41382066, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/41382066#41382066", "title": "Find Last cell from Range VBA", "body": "<p>I handled it in below code but your remarks were helpful. Thank you.</p>\n\n<pre><code>intLastRow = rngOrigin.Cells(1, 1).Row + rngOrigin.Rows.Count - 1\nintLastCol = rngOrigin.Cells(1, 1).Column + rngOrigin.Columns.Count - 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4970, "user_id": 305953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ncprD.jpg?s=128&g=1", "display_name": "Dez", "link": "https://stackoverflow.com/users/305953/dez"}, "edited": false, "score": 0, "creation_date": 1518424744, "post_id": 48740489, "comment_id": 84484319, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/18793890\">From Review</a>"}, {"owner": {"reputation": 1, "user_id": 6207043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a0ba4e8e1cb5c39b3ab57f7ea53189?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson Yang", "link": "https://stackoverflow.com/users/6207043/nelson-yang"}, "reply_to_user": {"reputation": 4970, "user_id": 305953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ncprD.jpg?s=128&g=1", "display_name": "Dez", "link": "https://stackoverflow.com/users/305953/dez"}, "edited": false, "score": 0, "creation_date": 1518425349, "post_id": 48740489, "comment_id": 84484626, "body": "@Dez: Thank you for the hint, I would do it when I have time."}, {"owner": {"reputation": 1, "user_id": 6207043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a0ba4e8e1cb5c39b3ab57f7ea53189?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson Yang", "link": "https://stackoverflow.com/users/6207043/nelson-yang"}, "edited": false, "score": 0, "creation_date": 1518464607, "post_id": 48740489, "comment_id": 84509318, "body": "@Like I had replied to Dez, I WOULD DO IT WHEN I HAVE TIME. I am working on UDF in excel that performs similar function, and I checked stack first but couldn&#39;t find any useful answer for my case. Eventually I got the solution from another website I linked in my answer. I have TESTED it and it WORKS FINE."}], "tags": [], "owner": {"reputation": 1, "user_id": 6207043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a0ba4e8e1cb5c39b3ab57f7ea53189?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson Yang", "link": "https://stackoverflow.com/users/6207043/nelson-yang"}, "is_accepted": false, "score": -1, "last_activity_date": 1564995700, "last_edit_date": 1564995700, "creation_date": 1518415935, "answer_id": 48740489, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/48740489#48740489", "title": "Find Last cell from Range VBA", "body": "<p>If you want the absolute last cell of a defined range, regardless of whether it has any content, here is a simple solution</p>\n\n<pre><code>Dim InputRng As Range    'define a range for the test'\nSet InputRng = Range(\"$F$3:$F$15\") \nMsgBox InputRng(1).Address &amp; \":\" &amp; InputRng(InputRng.Cells.Count).Address    'This would output the absolute address of defined range' \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vVAoz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vVAoz.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 10082797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2665885755f3adf5d9b55095e8d972?s=128&d=identicon&r=PG&f=1", "display_name": "DB user10082797", "link": "https://stackoverflow.com/users/10082797/db-user10082797"}, "is_accepted": false, "score": 0, "last_activity_date": 1531622984, "creation_date": 1531622984, "answer_id": 51344851, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/51344851#51344851", "title": "Find Last cell from Range VBA", "body": "<p>The answers given by others mostly work, but not if the region is a union of non-contiguous cells. Here is a version that works consistently for single and multi-area regions, contiguous and non-contiguous.</p>\n\n<pre><code>Function LastCellOfRange(rng As Excel.Range) As Excel.Range\n  Dim area As Excel.Range\n  Dim rowNum As Long\n  Dim maxRow As Long\n  Dim colNum As Long\n  Dim maxCol As Long\n  Dim areaIdx As Integer\n\n  Set LastCellOfRange = Nothing\n\n  maxRow = 0\n  maxCol = 0\n  For areaIdx = 1 To rng.Areas.Count\n    Set area = rng.Areas(areaIdx)\n    rowNum = area.Cells(area.Cells.Count).row\n    If (rowNum &gt; maxRow) Then\n      maxRow = rowNum\n    End If\n    colNum = area.Cells(area.Cells.Count).Column\n    If (colNum &gt; maxCol) Then\n      maxCol = colNum\n    End If\n  Next areaIdx\n\n  Set LastCellOfRange = rng.Worksheet.Cells(maxRow, maxCol)\n  Set area = Nothing\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 794, "user_id": 2610701, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49b1049f4dbb6fceb30d2230239b5c75?s=128&d=identicon&r=PG", "display_name": "Piotr L", "link": "https://stackoverflow.com/users/2610701/piotr-l"}, "edited": false, "score": 1, "creation_date": 1560847277, "post_id": 54385923, "comment_id": 99860086, "body": "Not the most elegant but certainly the shortest. Works for me!"}], "tags": [], "owner": {"reputation": 376, "user_id": 6499355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xiVMa.jpg?s=128&g=1", "display_name": "Jalal", "link": "https://stackoverflow.com/users/6499355/jalal"}, "is_accepted": false, "score": 3, "last_activity_date": 1548573498, "creation_date": 1548573498, "answer_id": 54385923, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/54385923#54385923", "title": "Find Last cell from Range VBA", "body": "<p>Perhaps this is what you want:</p>\n\n<pre><code>Dim rngLastCell As Range\nSet rngLastCell = rngOrigin(rngOrigin.Count)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 4897055, "user_type": "registered", "profile_image": "https://graph.facebook.com/871015412960574/picture?type=large", "display_name": "Shashiraju", "link": "https://stackoverflow.com/users/4897055/shashiraju"}, "is_accepted": false, "score": 0, "last_activity_date": 1580453856, "creation_date": 1580453856, "answer_id": 59999266, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba/59999266#59999266", "title": "Find Last cell from Range VBA", "body": "<p>Use this to code find the last cell in a given range</p>\n\n<pre><code>Sub GetLastCellFromRange()\n    Dim rng As Range\n\n    Set rng = Range(\"$C$10:$E$20\")\n\n    'Set rng = Range(Selection.Address) ' Use this line to select the range in worksheet\n\n    MsgBox \"Last Cell of given range is : \" &amp; rng.Cells(rng.Rows.Count, rng.Columns.Count).Address\nEnd Sub\n</code></pre>\n\n<p>I hope it will help you</p>\n"}], "owner": {"reputation": 61, "user_id": 7074250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba41c9652ce14678e8dc629704e01e?s=128&d=identicon&r=PG&f=1", "display_name": "Fajka", "link": "https://stackoverflow.com/users/7074250/fajka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22194, "favorite_count": 1, "answer_count": 8, "score": 3, "last_activity_date": 1580453856, "creation_date": 1482933317, "question_id": 41363555, "link": "https://stackoverflow.com/questions/41363555/find-last-cell-from-range-vba", "title": "Find Last cell from Range VBA", "body": "<p>How to find location of last cell from defined Range? Cell does not have to contain any data but must be most right and most down located cell from certain Range.</p>\n\n<pre><code>Set rngOrigin = wksOrigin.Cells(IntFirstRow, IntFirstColumn).CurrentRegion\n</code></pre>\n\n<p>I wish to receive</p>\n\n<pre><code>Cells(i,j)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1482931879, "post_id": 41363049, "comment_id": 69927458, "body": "Have you gone through <a href=\"http://stackoverflow.com/questions/20738373/can-i-make-this-macro-more-efficient-or-faster\">this question</a> on making macros faster?"}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 2, "creation_date": 1482933986, "post_id": 41363049, "comment_id": 69928653, "body": "You fill cell by cell, why not by block of cells? <code>Range(&quot;A&quot; &amp; TargetRow &amp; &quot;:E&quot; &amp; TargetRow).Value = Range(&quot;A&quot; &amp; SourceRow &amp; &quot;:E&quot; &amp; SourceRow).Value</code> and From G to AH. And you dont need to convert your rows to strings."}, {"owner": {"reputation": 3, "user_id": 7349776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68dbb8ab2ecf43e7dc2eb31e95711e?s=128&d=identicon&r=PG&f=1", "display_name": "riq sid", "link": "https://stackoverflow.com/users/7349776/riq-sid"}, "edited": false, "score": 0, "creation_date": 1483008656, "post_id": 41363049, "comment_id": 69958032, "body": "Thank you used the above part other VB"}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 0, "last_activity_date": 1482933847, "creation_date": 1482933847, "answer_id": 41363690, "question_id": 41363049, "link": "https://stackoverflow.com/questions/41363049/excel-vba-running-very-slow-looping/41363690#41363690", "title": "Excel VBA running very slow looping", "body": "<p>Difficult to run this code as you have not supplied test data but please pay attention to the code marked as #COPY THE BLOCK where you will find the magic line <code>rngDest.Value2 = rngSrc.Value2</code> which will definitely speed up you code.</p>\n\n<pre><code>Option Explicit\n\nSub ExpandData()\n\n    Dim SourceRow, TargetRow As Long\n    Dim LastDate, NextDate As Date\n    Dim DateDiff, FillDate As Integer\n    SourceRow = 4\n    TargetRow = 4\n\n    '* COPY THE BLOCK\n    Dim wsSheet1 As Excel.Worksheet, wsTest As Excel.Worksheet\n    Set wsSheet1 = Worksheets(\"Sheet1\")\n    Set wsTest = Worksheets(\"test\")\n\n    Dim rngSrc As Excel.Range\n    Set rngSrc = wsSheet1.Range(wsSheet1.Cells(1, TargetRow), wsSheet1.Cells(1, TargetRow + DateDiff - 1))\n\n    Dim rngDest As Excel.Range\n    Set rngDest = wsTest.Range(wsTest.Cells(1, SourceRow), wsTest.Cells(1, SourceRow + DateDiff - 1))\n\n    rngDest.Value2 = rngSrc.Value2\n    '* END OF COPY THE BLOCK\n\n\n    'Loop through source rows\n    Do While Worksheets(\"Sheet1\").Range(\"C\" &amp; CStr(SourceRow)).Value &lt;&gt; \"\"\n        LastDate = Worksheets(\"Sheet1\").Range(\"F\" &amp; CStr(SourceRow)).Value\n        ' Check for the last row of data and use todays date if last row\n        If Worksheets(\"Sheet1\").Range(\"F\" &amp; CStr(SourceRow + 1)).Value &lt;&gt; \"\" Then\n            NextDate = Worksheets(\"Sheet1\").Range(\"F\" &amp; CStr(SourceRow + 1)).Value\n        Else\n            NextDate = Date\n        End If\n        DateDiff = NextDate - LastDate\n        ' create a row in the target sheet for each date in between those in the source sheet\n\n        '* optimization of F column left as an exercise\n        For FillDate = 0 To DateDiff - 1\n            Worksheets(\"test\").Range(\"F\" &amp; CStr(TargetRow)).Value = LastDate + FillDate\n            TargetRow = TargetRow + 1\n        Next FillDate\n\n        SourceRow = SourceRow + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7349776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68dbb8ab2ecf43e7dc2eb31e95711e?s=128&d=identicon&r=PG&f=1", "display_name": "riq sid", "link": "https://stackoverflow.com/users/7349776/riq-sid"}, "edited": false, "score": 0, "creation_date": 1482949609, "post_id": 41365663, "comment_id": 69936887, "body": "Thank you very much - trying out people suggestion. When I tried the code out, I am getting subscript out of range error on the following line.                     (aResults(lResultIndex, k) = aData(i, k))"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 7349776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68dbb8ab2ecf43e7dc2eb31e95711e?s=128&d=identicon&r=PG&f=1", "display_name": "riq sid", "link": "https://stackoverflow.com/users/7349776/riq-sid"}, "edited": false, "score": 0, "creation_date": 1482949677, "post_id": 41365663, "comment_id": 69936919, "body": "@riqsid Then your data is not sorted, or it isn&#39;t laid out as described.  Please provide sample data"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1482941086, "creation_date": 1482941086, "answer_id": 41365663, "question_id": 41363049, "link": "https://stackoverflow.com/questions/41363049/excel-vba-running-very-slow-looping/41365663#41365663", "title": "Excel VBA running very slow looping", "body": "<p>Loading the data into an array, putting the results in another array, and then outputting the results to the sheet only once at the very end is always the fastest method:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim aData As Variant\n    Dim aResults() As Variant\n    Dim i As Long, j As Long, k As Long\n    Dim lResultIndex As Long\n    Dim dtNext As Date\n    Dim sDateFormat As String\n\n    Const lDateCol As Long = 6          'Column F\n    Const sStartCol As String = \"A\"\n    Const sFinalCol As String = \"AH\"\n    Const lStartRow As Long = 4\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(\"Sheet1\")\n    Set wsDest = wb.Sheets(\"test\")\n\n    With wsData.Range(sStartCol &amp; lStartRow &amp; \":\" &amp; sFinalCol &amp; wsData.Cells(wsData.Rows.Count, \"C\").End(xlUp).Row)\n        If .Row &lt; 4 Then Exit Sub   'No data\n        aData = .Value  'Load the source data into an array\n    End With\n\n    'Prepare the results array\n    ReDim aResults(1 To Date - aData(1, lDateCol) + 1, 1 To UBound(aData, 2))\n\n    'Loop through the data array\n    For i = 1 To UBound(aData, 1)\n        'Define the next date\n        If i = UBound(aData, 1) Then dtNext = Date Else dtNext = Int(aData(i + 1, lDateCol)) - 1\n\n        'For each date, add a line to the results array\n        For j = aData(i, lDateCol) To dtNext\n            lResultIndex = lResultIndex + 1\n            For k = 1 To UBound(aData, 2)\n                If k = lDateCol Then\n                    aResults(lResultIndex, k) = j\n                Else\n                    aResults(lResultIndex, k) = aData(i, k)\n                End If\n            Next k\n        Next j\n    Next i\n\n    'If there is existing data where the results would go, you'll need to clear that first\n    'To clear any existing data (if necessary) uncomment the following line:\n    'wsDest.Range(sStartCol &amp; lStartRow &amp; \":\" &amp; sFinalCol &amp; wsDest.Rows.Count).Clear\n\n    'Output the results array\n    wsDest.Range(sStartCol &amp; lStartRow).Resize(UBound(aResults, 1), UBound(aResults, 2)).Value = aResults\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7349776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb68dbb8ab2ecf43e7dc2eb31e95711e?s=128&d=identicon&r=PG&f=1", "display_name": "riq sid", "link": "https://stackoverflow.com/users/7349776/riq-sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1978, "favorite_count": 0, "accepted_answer_id": 41363690, "answer_count": 2, "score": 0, "last_activity_date": 1482941086, "creation_date": 1482931447, "last_edit_date": 1482933014, "question_id": 41363049, "link": "https://stackoverflow.com/questions/41363049/excel-vba-running-very-slow-looping", "title": "Excel VBA running very slow looping", "body": "<p>I have a small supplier price list which is effective data from x to y dates (in rows) with number of same products (in columns - quite a few). I am trying to copy the rows into another sheet but this time at a date level instead of range x/y that I need to export into a csv. Only limitation I have that I cannot change the format of price list.</p>\n\n<p>The vba code is working but its very slow although only I have a price list of 150 rows (sheet 1) that will translate into 6000 rows (in test), its taking hours to run the code. Could you advise how I could improve the performance? My vba skills are very basic and I have cobbled this together from other people code. </p>\n\n<pre><code>Sub ExpandData()\n\nDim SourceRow, TargetRow As Long\nDim LastDate, NextDate As Date\nDim DateDiff, FillDate As Integer\nSourceRow = 4\nTargetRow = 4\n\n'Loop through source rows\nDo While Worksheets(\"Sheet1\").Range(\"C\" &amp; CStr(SourceRow)).Value &lt;&gt; \"\"\n    LastDate = Worksheets(\"Sheet1\").Range(\"F\" &amp; CStr(SourceRow)).Value\n    ' Check for the last row of data and use todays date if last row\n    If Worksheets(\"Sheet1\").Range(\"F\" &amp; CStr(SourceRow + 1)).Value &lt;&gt; \"\" Then\n        NextDate = Worksheets(\"Sheet1\").Range(\"F\" &amp; CStr(SourceRow + 1)).Value\n    Else\n        NextDate = Date\n    End If\n    DateDiff = NextDate - LastDate\n    ' create a row in the target sheet for each date in between those in the source sheet\n    For FillDate = 0 To DateDiff - 1\n        Worksheets(\"test\").Range(\"A\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"A\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"B\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"B\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"C\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"C\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"D\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"D\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"E\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"E\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"F\" &amp; CStr(TargetRow)).Value = LastDate + FillDate\n        Worksheets(\"test\").Range(\"G\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"G\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"H\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"H\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"I\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"I\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"J\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"J\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"K\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"K\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"L\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"L\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"M\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"M\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"N\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"N\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"O\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"O\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"P\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"P\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"Q\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"Q\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"R\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"R\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"S\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"S\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"T\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"T\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"U\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"U\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"V\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"V\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"W\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"W\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"X\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"X\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"Y\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"Y\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"Z\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"Z\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AA\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AA\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AB\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AB\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AC\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AC\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AD\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AD\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AE\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AE\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AF\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AF\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AG\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AG\" &amp; CStr(SourceRow)).Value\n        Worksheets(\"test\").Range(\"AH\" &amp; CStr(TargetRow)).Value = Worksheets(\"Sheet1\").Range(\"AH\" &amp; CStr(SourceRow)).Value\n      TargetRow = TargetRow + 1\n    Next FillDate\n\n    SourceRow = SourceRow + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 4873, "user_id": 7057680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBS3e.jpg?s=128&g=1", "display_name": "T-Heron", "link": "https://stackoverflow.com/users/7057680/t-heron"}, "is_accepted": false, "score": 0, "last_activity_date": 1482932124, "creation_date": 1482932124, "answer_id": 41363242, "question_id": 41363047, "link": "https://stackoverflow.com/questions/41363047/how-to-edit-footer-for-macro-enables-word-document-in-2010/41363242#41363242", "title": "How to edit footer for macro-enables word document in 2010", "body": "<p>In Word, go to File > Options > Trust Center > Trust Center Settings > Macro Settings and select \"Disable all macros with notification\" and also select \"Trust access to the project VBA object model.\"  Also take a look at File > Options > Trust Center > Trusted Locations and add the location where your normal.dotm is stored.  Reference:  <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_word-mso_winother/macros-disabled-in-normaldotm-template/216db5cc-5e8b-45b8-a8dd-722c49b1b33e\" rel=\"nofollow noreferrer\">Macros disabled in Normal.dotm template</a></p>\n"}], "owner": {"reputation": 303, "user_id": 2742651, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/adf8b55d1e8cdac3dd597479a4e56248?s=128&d=identicon&r=PG&f=1", "display_name": "cool_taps", "link": "https://stackoverflow.com/users/2742651/cool-taps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482937952, "creation_date": 1482931446, "last_edit_date": 1482937952, "question_id": 41363047, "link": "https://stackoverflow.com/questions/41363047/how-to-edit-footer-for-macro-enables-word-document-in-2010", "title": "How to edit footer for macro-enables word document in 2010", "body": "<p>I was trying to edit footer in .dotm file. But it was giving me below error when document getting opened.</p>\n\n<p><a href=\"https://i.stack.imgur.com/gCR0o.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gCR0o.jpg\" alt=\"Macro error\"></a></p>\n\n<p>I want to update footer in document but wasn't able to do it.</p>\n\n<p>Can somebody help me how to edit footer in such case?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 1, "last_activity_date": 1482930358, "creation_date": 1482930358, "answer_id": 41362761, "question_id": 41362612, "link": "https://stackoverflow.com/questions/41362612/vba-paramarray-conditions-to-be-used-in-if-statement/41362761#41362761", "title": "VBA ParamArray &quot;conditions&quot; to be used in IF statement", "body": "<pre><code>sub pointless(byval IsAnd as boolean, paramarray conditions())\n  dim i as long\n\n  for i=lbound(conditions) to ubound(conditions)\n    if IsAnd then\n      if not conditions(i) then exit sub\n    else\n      if conditions(i) then exit for\n    end if\n  next\n\n  'random code\nend sub\n</code></pre>\n\n<p>But you should realise that the procedure will receive <em>results</em> of the comparisons passed to it, not the comparisons themselves. So there is no point really to have such procedure in the first place, you can just write directly in your code:</p>\n\n<pre><code>if x = y-1 and somethingToCompare &lt;&gt; anotherThing then\n  'random code\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1482933016, "creation_date": 1482933016, "answer_id": 41363470, "question_id": 41362612, "link": "https://stackoverflow.com/questions/41362612/vba-paramarray-conditions-to-be-used-in-if-statement/41363470#41363470", "title": "VBA ParamArray &quot;conditions&quot; to be used in IF statement", "body": "<p>Python (and some other languages) has useful functions <code>all()</code> and <code>any()</code> which take as input an array (or some other iterable) of Booleans and returns either True or False depending on whether or not some, all, or none of the passed Booleans are True. You could write VBA versions of these (using <code>Some()</code> instead of <code>Any()</code> since <code>Any</code> happens to be a somewhat obscure keyword in VBA):</p>\n\n<pre><code>Function All(ParamArray conditions()) As Boolean\n    Dim i As Long\n    For i = LBound(conditions) To UBound(conditions)\n        If Not conditions(i) Then\n            All = False\n            Exit Function\n        End If\n    Next i\n    All = True\nEnd Function\n\nFunction Some(ParamArray conditions()) As Boolean\n    Dim i As Long\n    For i = LBound(conditions) To UBound(conditions)\n        If conditions(i) Then\n            Some = True\n            Exit Function\n        End If\n    Next i\n    Some = False\nEnd Function\n</code></pre>\n\n<p>You could use these functions directly to conditionally call code. </p>\n\n<p>Arguably it might be more useful to change the above definitions to:</p>\n\n<pre><code>Function All(conditions As Variant) As Boolean\n    Dim i As Long\n    For i = LBound(conditions) To UBound(conditions)\n        If Not conditions(i) Then\n            All = False\n            Exit Function\n        End If\n    Next i\n    All = True\nEnd Function\n\nFunction Some(conditions As Variant) As Boolean\n    Dim i As Long\n    For i = LBound(conditions) To UBound(conditions)\n        If conditions(i) Then\n            Some = True\n            Exit Function\n        End If\n    Next i\n    Some = False\nEnd Function\n</code></pre>\n\n<p>Now you would need to use calls like <code>Some(Array(c1, c2, c3))</code> rather than <code>Some(c1,c2,c3)</code> if you had a literal list of conditions, but you would have the flexibility to pass in an entire array of conditions. Using this second definition you could write something like the following (which answers your original question):</p>\n\n<pre><code>Sub Sometimes(when As String, ParamArray conditions())\n    Dim run As Boolean\n    Dim cond As Variant\n\n    cond = conditions\n    run = IIf(when = \"All\", All(cond), Some(cond))\n    If run Then\n        Debug.Print \"Running random code\"\n    Else\n        Debug.Print \"Not running random code\"\n    End If        \nEnd Sub\n</code></pre>\n\n<p>Then, for example, <code>Sometimes \"Some\",True,True,False</code> results in <code>Running random code</code> being printed.</p>\n"}], "owner": {"reputation": 396, "user_id": 3428842, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/NlZgK.jpg?s=128&g=1", "display_name": "ndelucca", "link": "https://stackoverflow.com/users/3428842/ndelucca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "accepted_answer_id": 41363470, "answer_count": 2, "score": 2, "last_activity_date": 1482933016, "creation_date": 1482929807, "last_edit_date": 1531164843, "question_id": 41362612, "link": "https://stackoverflow.com/questions/41362612/vba-paramarray-conditions-to-be-used-in-if-statement", "title": "VBA ParamArray &quot;conditions&quot; to be used in IF statement", "body": "<p>I want to design a Function or Sub that accepts any number of boolean conditions and add them to an IF statement. The code i imagine goes like this:</p>\n\n<pre><code>Function comp (ParamArray list() As Variant)\n  If (list(0) = True) And (list(1) = true) ..... (list(last) = true) then\n'random code\n  End If\nEnd Function\n</code></pre>\n\n<p>where list() would be expresions like:</p>\n\n<pre><code>x = y-1,somethingToCompare &lt;&gt; anotherThing, etc...\n</code></pre>\n\n<p>It would be interesting if i could add the \"and\" as another argument, to be changed to \"or\" if i wished to. </p>\n\n<pre><code>Function comp (VyVal compare as Boolean, ParamArray list() As Variant)\n\ndim comparison as String???\n\n  If compare then \n    comparison = \"and\"\n  else\n    comparison = \"or\"\n  end if\n\n  If (list(0) = True) comparison (list(1) = true) ..... (list(last) = true) then\n\n    'random code\n\n  End If\nEnd Function\n</code></pre>\n\n<p>The final idea is to use that function like this:</p>\n\n<pre><code>Sub code ()\n\nif comp(True, condition1, condition2, ...) then\n'random code'\n\nEnd Sub\n</code></pre>\n\n<p>Avoid directly looking at that code i wrote lest it burn your eyes.</p>\n\n<p>Is something like this posible or should i get a lollipop?</p>\n\n<p>Maybe i'm looking at this in the wrong way, and there's an easier way of doing something similar or even better.</p>\n"}, {"tags": ["sql-server", "vba", "excel", "macros"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1482929588, "post_id": 41362250, "comment_id": 69926210, "body": "What is the difference between what you have and what you want?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1482928700, "post_id": 41362304, "comment_id": 69925754, "body": "I am new to VBA so don&#39;t know much about it. Can you please elaborate? Thanks."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1482928716, "post_id": 41362304, "comment_id": 69925762, "body": "@Mohit: what programming languages do you know if not VBA?"}, {"owner": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1482928854, "post_id": 41362304, "comment_id": 69925844, "body": "I am writing stored procedures in MSSQL."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 0, "last_activity_date": 1482931110, "last_edit_date": 1482931110, "creation_date": 1482928540, "answer_id": 41362304, "question_id": 41362250, "link": "https://stackoverflow.com/questions/41362250/need-a-vba-code-to-convert-excel-sheet-columns-into-tab-in-new-excel-sheet/41362304#41362304", "title": "Need a VBA code to convert Excel sheet columns into tab in new Excel sheet", "body": "<p>Use integer division and modulus, so for example taking the 1000th column</p>\n\n<pre><code>1000 \\ 254 = 3 \n\n1000 mod 254 = 238 \n</code></pre>\n\n<p>gives the 3rd sheet and the 238th column.</p>\n\n<p>So loop through from 1 to 3000 using <code>\\</code> and <code>mod</code>.</p>\n\n<p>You code is very non-standard and I cannot get my head around it, I suggest you start from my code, this is an illustrative example of breaking a block of data into separate sheets.  Copy the code into a new workbook then</p>\n\n<p>Run <code>CreateSheetAndPopulateWithBlockOfData</code> once only to create a block of data.\nRun <code>Test</code> to run the BreakBlockIntoChunks routine, you can experiment with the chunk size.</p>\n\n<pre><code>Option Explicit\n\nPrivate Const csSHEETNAME As String = \"Source\"\n\nSub TestCreateSheetAndPopualteWithBlockOfData()\n\n    Dim wsSource As Excel.Worksheet\n    Set wsSource = CreateSheetAndPopulateWithBlockOfData(ThisWorkbook, csSHEETNAME, 20, 100)\n\nEnd Sub\n\nSub Test()\n    Dim wsSource As Excel.Worksheet\n    Set wsSource = ThisWorkbook.Worksheets.Item(csSHEETNAME)\n\n\n    'Stop\n    Dim wbResults As Excel.Workbook\n    Set wbResults = Workbooks.Add\n    BreakBlockIntoChunks wsSource, 5, wbResults\nEnd Sub\n\nFunction BreakBlockIntoChunks(ByVal wsSource As Excel.Worksheet, ByVal lColumnChunkSize As Long, ByVal wbDestinationWorkbook As Excel.Workbook)\n\n    Dim rngDataBlock As Excel.Range\n    Set rngDataBlock = wsSource.Cells(1, 1).CurrentRegion\n\n    Dim lSourceColumnCount As Long\n    lSourceColumnCount = rngDataBlock.Columns.Count\n\n    Dim lSourceRowCount As Long\n    lSourceRowCount = rngDataBlock.Rows.Count\n\n    Dim lColumnLoop As Long\n    For lColumnLoop = 1 To lSourceColumnCount\n\n        Dim lCurrentSheet As Long\n        lCurrentSheet = ((lColumnLoop - 1) \\ lColumnChunkSize) + 1\n\n        Dim wsCurrentSheet As Excel.Worksheet\n\n        If lCurrentSheet &gt; wbDestinationWorkbook.Worksheets.Count Then Set wsCurrentSheet = wbDestinationWorkbook.Worksheets.Add\n\n        If wsCurrentSheet Is Nothing Then Set wsCurrentSheet = wbDestinationWorkbook.Worksheets.Item(lCurrentSheet) '* runs first loop\n\n\n        '**ADD your sheet naming logic here perhaps\n\n        Dim lCurrentColumn As Long\n        lCurrentColumn = ((lColumnLoop - 1) Mod lColumnChunkSize) + 1\n\n\n        Dim rngSource As Excel.Range\n        Set rngSource = wsSource.Range(wsSource.Cells(1, lColumnLoop), wsSource.Cells(lSourceRowCount, lColumnLoop))\n\n        Dim rngDestination As Excel.Range\n        Set rngDestination = wsCurrentSheet.Range(wsCurrentSheet.Cells(1, lCurrentColumn), wsCurrentSheet.Cells(lSourceRowCount, lCurrentColumn))\n\n        rngDestination.Value2 = rngSource.Value2 '* &lt;---Copies without using clipboard\n\n\n\n    Next lColumnLoop\n\n\n\nEnd Function\n\nFunction CreateSheetAndPopulateWithBlockOfData(ByVal wb As Excel.Workbook, ByVal sSheetName As String, ByVal lRowsDeep As Long, ByVal lColumnsWide As Long) As Excel.Worksheet\n\n    Dim ws As Excel.Worksheet\n    Set ws = wb.Worksheets.Add\n    ws.Name = sSheetName\n\n    Dim rngBlock As Excel.Range\n    Set rngBlock = ws.Range(ws.Cells(1, 1), ws.Cells(lRowsDeep, lColumnsWide))\n\n    rngBlock.Formula = \"=RANDBETWEEN(1,100000)\"\n    rngBlock.Value2 = rngBlock.Value2\n\n    Set CreateSheetAndPopulateWithBlockOfData = ws\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1482948608, "post_id": 41363709, "comment_id": 69936405, "body": "Yes! it is working fine but need some correction as ideally as we have 3000 columns so as one tab is containing 254 columns so it should create approx 12 tabs then it should stop but it is going to infinite loop and the conversion is going on. Thanks."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1482954079, "post_id": 41363709, "comment_id": 69938877, "body": "When I tested it worked correctly: it stopped after copying all columns into 254 columns tabs (but the last with fewer columns). You may step through your code and see what&#39;s going on and why colNum isn&#39;t getting below zero"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1483024651, "post_id": 41363709, "comment_id": 69966783, "body": "@MohitVijay did you get through it?"}, {"owner": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1483082119, "post_id": 41363709, "comment_id": 69986365, "body": "I tried it but it still going to loop and after 64 tabs it stops with error. My data file is having 2597 columns and ideally it should stop after 11 tabs but it is going to 64 tabs and then stops with an error."}, {"owner": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1483082565, "post_id": 41363709, "comment_id": 69986545, "body": "it is giving the following error.               Run-time error &#39;1004&#39;:               Application-defined or object-defined error.  On this line.         Worksheets.Add(After:=Worksheets(Worksheets.Count)).Range(&quot;A&zwnj;&#8203;1:IT1&quot;).Resize(.Rows&zwnj;&#8203;.Count).Value = .Columns(iCol + 1).Resize(, 254).Value"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "edited": false, "score": 0, "creation_date": 1483083646, "post_id": 41363709, "comment_id": 69986990, "body": "most probably it&#39;s hitting some memory limits. But since in my tests it works fine you should step through your code and see why it &quot;loops&quot; after the 12th tab. To <a href=\"http://www.cpearson.com/Excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">step through code</a> <i>&quot;put the cursor on the first line of code to be analyzed and press F8 or choose Step Into on the Debug menu. The next line of code to be executed will be displayed in yellow background with a black font. Note that the highlighted line of code has not yet been executed -- it is the next line to execute&quot;</i> At any time you can query variable in the Immediate Window"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1482933915, "creation_date": 1482933915, "answer_id": 41363709, "question_id": 41362250, "link": "https://stackoverflow.com/questions/41362250/need-a-vba-code-to-convert-excel-sheet-columns-into-tab-in-new-excel-sheet/41363709#41363709", "title": "Need a VBA code to convert Excel sheet columns into tab in new Excel sheet", "body": "<p>you could try this:</p>\n\n<pre><code>Sub SpliteIntoMultipleTab()\n    Dim colNum As Long, iCol As Long\n    With Worksheets(\"Sheet1\").UsedRange\n        colNum = .Columns.count\n        Do\n            Worksheets.Add(After:=Worksheets(Worksheets.count)).Range(\"A1:IT1\").Resize(.Rows.count).Value = .Columns(iCol + 1).Resize(, 254).Value\n            iCol = iCol + 254\n            colNum = colNum - 254\n        Loop While colNum &gt; 0\n    End With\nEnd Sub\n</code></pre>\n\n<p>which copies <em>values</em> only and speed up things considerably</p>\n"}], "owner": {"reputation": 39, "user_id": 7349773, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xLX---SSBMg/AAAAAAAAAAI/AAAAAAAAAIw/aLMjYm8qvO4/photo.jpg?sz=128", "display_name": "Mohit Vijay", "link": "https://stackoverflow.com/users/7349773/mohit-vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 41362304, "answer_count": 2, "score": 0, "last_activity_date": 1482933915, "creation_date": 1482928367, "last_edit_date": 1482929575, "question_id": 41362250, "link": "https://stackoverflow.com/questions/41362250/need-a-vba-code-to-convert-excel-sheet-columns-into-tab-in-new-excel-sheet", "title": "Need a VBA code to convert Excel sheet columns into tab in new Excel sheet", "body": "<p>I have an Excel sheet having 3000 columns and I need to convert this sheet in such a way that one tab will contain 254 columns only and remaining will go to the next tab. So I need a VBA code (Macro) which can perform the same.</p>\n\n<p>As of now I wrote the following code only which is creating 3000 tabs with one column in each, also it is going to infinite loop as I did not put any condition there for blank column.</p>\n\n<pre><code>Sub SpliteIntoMultipleTab()\n    '\n    ' createtemplates Macro\n    Dim WS As Worksheet\n    Dim SS As Worksheet\n    Dim TemplateName As String\n    Dim tempstr As String\n    '\n    Dim CurCol As String\n    Dim Template As String\n    Dim xColIndex As Integer\n    Dim xRowIndex As Integer\n    Dim WSCount As Integer\n    '==========================================================================\n    'Declarations\n    CurCol = 1\n    Template = \"Sheet1\"\n    '==========================================================================\n    Set SS = Worksheets(Template)\n    If WS Is Nothing Then\n\nStart:\n\n    With ActiveWorkbook\n        Set WS = .Sheets.Add(After:=ActiveSheet)\n        WSCount = Sheets.Add(After:=Sheets(Worksheets.Count))\n        On Error Resume Next\n        Set WS = Worksheets(\"temp\")\n        WS.Name = SS.Range(\"A1\").Value\n      End With\n    Else\n    End If\n\n    SS.Activate\n    xIndex = Application.ActiveCell.Column\n    xRowIndex = Application.ActiveSheet.Cells(Rows.Count, xIndex).End(xlUp).Row\n    Range(Cells(1, xIndex), Cells(xRowIndex, xIndex)).Select\n    Selection.Copy\n    WS.Select\n    WS.Range(\"A1\").Select\n    ActiveSheet.Paste\n    SS.Columns(1).EntireColumn.Delete\n    CurCol = CurCol + 1\n    GoTo Start\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482924752, "post_id": 41361130, "comment_id": 69923466, "body": "Getting Run time error the above code is not working"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482925386, "post_id": 41361130, "comment_id": 69923845, "body": "I added Sub and End Sub. Could you please specify the Run Time Error?"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482925476, "post_id": 41361130, "comment_id": 69923890, "body": "c.ClearContents"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482925653, "post_id": 41361130, "comment_id": 69923995, "body": "I am sorry but if you get an run time error then you usually an more specified error message"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482925751, "post_id": 41361130, "comment_id": 69924053, "body": "&quot;we cant do that to a merged cell&quot;"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482925861, "post_id": 41361130, "comment_id": 69924114, "body": "Ok, then use c.vallue = &quot;&quot; instead of c.ClearContens"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482927114, "post_id": 41361130, "comment_id": 69924862, "body": "Ok, I replaced the code withan excel built-in routine"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1482927650, "post_id": 41361130, "comment_id": 69925192, "body": "Looks good to me, if you have any issues it would most probably be due to preceding / leading spaces. I&#39;d just use wildcards to cover those scenarios: <code>What:=&quot;*0&quot;</code>, <code>What:=&quot;0*&quot;</code>, <code>What:=&quot;*0*&quot;</code>"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482981618, "post_id": 41361130, "comment_id": 69947119, "body": "Thanks the new code is working for me without error. But its not clearing formula cells, can you help me to add those function also"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1482998276, "post_id": 41361130, "comment_id": 69952401, "body": "Are you really sure you want to clear the formula cells? That means the formula will be deleted. Or do you just want not to see the 0 in this case?"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1482999382, "last_edit_date": 1482999382, "creation_date": 1482924469, "answer_id": 41361130, "question_id": 41361073, "link": "https://stackoverflow.com/questions/41361073/clear-zero-values-in-entire-workbook-either-its-in-formula-or-value/41361130#41361130", "title": "Clear Zero values in entire workbook (Either its in formula or value)", "body": "<p>Instead of Selection you could use <code>ActiveSheet.UsedRange</code> And if you need to do it for all sheets in a workbook you could do sth like that</p>\n\n<pre><code>Sub DelAllZeros()\n          Cells.Replace What:=\"0\", Replacement:=\"\", LookAt:=xlWhole, SearchOrder _\n            :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nEnd Sub\n\n\nSub DelFormulaZeros()\n\nDim rg As Range, sngCell As Range\nDim sh As Worksheet\nDim result As Long\n\n    For Each sh In Worksheets\n\n        On Error Resume Next\n        Set rg = sh.Cells.SpecialCells(xlCellTypeFormulas, 1)\n        result = Err.Number\n        On Error GoTo 0\n\n        If result = 0 Then\n            For Each sngCell In rg\n                If sngCell.Value = 0 Then\n                    sngCell.ClearContents\n                End If\n            Next\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1482987588, "post_id": 41373378, "comment_id": 69948380, "body": "I have changed the above code to consider formula cell also. But this is working only in active sheet not entire workbook can anybody help to apply this code to entire workbook"}], "tags": [], "owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "is_accepted": false, "score": 0, "last_activity_date": 1500397633, "last_edit_date": 1500397633, "creation_date": 1482987531, "answer_id": 41373378, "question_id": 41361073, "link": "https://stackoverflow.com/questions/41361073/clear-zero-values-in-entire-workbook-either-its-in-formula-or-value/41373378#41373378", "title": "Clear Zero values in entire workbook (Either its in formula or value)", "body": "<pre><code>Sub DelAllZeros()\n    Application.Calculation = xlCalculationManual\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n        On Error Resume Next\n\n        ws.Cells.Replace What:=\"0\", Replacement:=\"\", LookAt:=xlWhole, SearchOrder _\n        :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n        Set frange = ws.Cells.SpecialCells(xlCellTypeFormulas)\n        On Error GoTo 0\n        If Not frange Is Nothing Then\n            For Each c In frange\n                If c.Value = 0 Then\n                    c.Formula = ClearContents\n                End If\n            Next c\n        End If\n        Set frange = Nothing\n    Next ws\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1500397633, "creation_date": 1482924299, "last_edit_date": 1531164843, "question_id": 41361073, "link": "https://stackoverflow.com/questions/41361073/clear-zero-values-in-entire-workbook-either-its-in-formula-or-value", "title": "Clear Zero values in entire workbook (Either its in formula or value)", "body": "<p>I want to clear the contents if cell value is zero ((Either its in formula or value) The below code is working by selection of cells, but i want to do this for entire workbook please help me to change the code.</p>\n\n<pre><code>Sub DelZeros()\n  Dim c As Range\n\n  For Each c In Selection\n    If c.Value = 0 Then c.ClearContents\n  Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 6493950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKPkM.png?s=128&g=1", "display_name": "Diogo", "link": "https://stackoverflow.com/users/6493950/diogo"}, "is_accepted": true, "score": 3, "last_activity_date": 1482923034, "creation_date": 1482923034, "answer_id": 41360698, "question_id": 41360631, "link": "https://stackoverflow.com/questions/41360631/macro-causing-excel-sheet-to-show-segregated-lines-how-to-get-rid/41360698#41360698", "title": "macro causing excel sheet to show segregated lines? How to get rid?", "body": "<p>I think you should remove</p>\n\n<pre><code>ActiveSheet.DisplayPageBreaks = True\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 7231013, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/c660b465c5501da811e99c6eaf2e2dac?s=128&d=identicon&r=PG&f=1", "display_name": "Princess.Bell", "link": "https://stackoverflow.com/users/7231013/princess-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 41360698, "answer_count": 1, "score": 2, "last_activity_date": 1482923034, "creation_date": 1482922838, "question_id": 41360631, "link": "https://stackoverflow.com/questions/41360631/macro-causing-excel-sheet-to-show-segregated-lines-how-to-get-rid", "title": "macro causing excel sheet to show segregated lines? How to get rid?", "body": "<p>I am running this macro:</p>\n\n<pre><code>Sub Check()\nActiveSheet.EnableCalculation = False\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n\nIf Sheets(1).Range(\"A1\").Value = \"Enter Data\" Then\nSheets(2).Activate\nElse\nIf Sheets(1).Range(\"H10\").Value &lt;&gt; \"\" And Sheets(1).Range(\"I10\").Value &lt;&gt; \"\" And Sheets(1).Range(\"J10\").Value &lt;&gt; \"\" Then\nDim lastRow As Long\nDim sht1 As Worksheet\nDim sht2 As Worksheet\n\nSet sht1 = Sheets(2)\n\nIf sht1.Range(\"A1\").Value &lt;&gt; \"\" Then\n'insert column b formula\nlastRow = sht1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nsht1.Range(\"B2\").Formula = \"=MID(A2, 1, 12)\"\nsht1.Range(\"B2\").AutoFill Destination:=sht1.Range(\"B2:B\" &amp; lastRow)\n\n'insert column c formula\nsht1.Range(\"C2\").Formula = \"=--LEFT(B2,4)\"\nsht1.Range(\"C2\").AutoFill Destination:=sht1.Range(\"C2:C\" &amp; lastRow)\n\n'insert column d formula\nsht1.Range(\"D2\").Formula = \"=--RIGHT(MID(A2, 14, 7),LEN(MID(A2, 14, 7))-FIND(LEFT(SUBSTITUTE(MID(A2, 14, 7)&amp;\"\" \"\",\"\"0\"\",\"\"\"\"),1),MID(A2, 14, 7)&amp;\"\" \"\")+1)\"\nsht1.Range(\"D2\").AutoFill Destination:=sht1.Range(\"D2:D\" &amp; lastRow)\n\n'insert column E formula\nsht1.Range(\"E2\").Formula = \"=DATE(\"\"20\"\"&amp;MID(B2,9,2),MID(B2,7,2),MID(B2,5,2))\"\nsht1.Range(\"E2\").AutoFill Destination:=sht1.Range(\"E2:E\" &amp; lastRow)\n\n'insert column F formula\nsht1.Range(\"F2\").Formula = \"=IF(E2&lt;&gt;\"\"\"\",WEEKNUM(E2,21),\"\"\"\")\"\nsht1.Range(\"F2\").AutoFill Destination:=sht1.Range(\"F2:F\" &amp; lastRow)\n\n'insert column G formula\nsht1.Range(\"G2\").Formula = \"=SUBSTITUTE(TRIM(MID(A2, FIND(\"\"-\"\", A2, FIND(\"\"-\"\", A2)+9)+9,256)),\"\" \"\",\"\" / \"\")\"\nsht1.Range(\"G2\").AutoFill Destination:=sht1.Range(\"G2:G\" &amp; lastRow)\n\n\n\n\n    Else\n\n    MsgBox \"Please First Copy and Paste Estimated Receivings.\"\n    End If\n\n\n\nSet sht2 = Sheets(1)\nWith sht2\n\nIf Range(\"H10\").Value &lt;&gt; \"\" Then\n    lastRow = .Cells(.Rows.Count, 10).End(xlUp).Row\n\n    .Range(\"K10\").FormulaArray = \"=IFERROR(INDEX(Data!$G:$G,MATCH(1,(Home!$H10=Data!$C:$C)*(Home!$I10=Data!$D:$D)*(IF(Home!$J10&lt;55,Home!$J10,WEEKNUM(Home!$J10,21))=Data!$F:$F),0)),\"\"\"\")\"\n    If lastRow &lt;&gt; 10 Then\n.Range(\"K10\").AutoFill ActiveSheet.Range(\"K10:K\" &amp; lastRow)\nEnd If\n\n.Range(\"M10\").FormulaArray = \"=IFERROR(INDEX(Data!$B:$B,MATCH(1,(Home!$H10=Data!$C:$C)*(Home!$I10=Data!$D:$D)*(IF(Home!$J10&lt;55,Home!$J10,WEEKNUM(Home!$J10,21))=Data!$F:$F),0)),\"\"No Po Found\"\")\"\nIf lastRow &lt;&gt; 10 Then\n.Range(\"M10\").AutoFill ActiveSheet.Range(\"M10:M\" &amp; lastRow)\nEnd If\n.Range(\"L10\").FormulaArray = \"=IFERROR(INDEX(Data!$F:$F,MATCH(1,(Home!$H10=Data!$C:$C)*(Home!$I10=Data!$D:$D)*(IF(Home!$J10&lt;55,Home!$J10,WEEKNUM(Home!$J10,21))=Data!$F:$F),0)),\"\"\"\")\"\nIf lastRow &lt;&gt; 10 Then\n.Range(\"L10\").AutoFill ActiveSheet.Range(\"L10:L\" &amp; lastRow)\n End If\n    Else\n\n    MsgBox \"Please enter some data.\"\n    End If\nEnd With\nElse\nMsgBox \"At Least One Order Must Be Checked.\"\nEnd If\nEnd If\n\n\n\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\nApplication.EnableEvents = True\nActiveSheet.DisplayPageBreaks = True\nActiveSheet.EnableCalculation = True\n\nEnd Sub\n</code></pre>\n\n<p>For some reason, when the code has finished running, my excel sheet displays three segregated lines like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3mz6b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3mz6b.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why is this, and how can i remove them? I appreciate any help. Thanks</p>\n"}, {"tags": ["vba", "excel", "save-as"], "comments": [{"owner": {"reputation": 75, "user_id": 4001735, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dayR9.jpg?s=128&g=1", "display_name": "scorpion", "link": "https://stackoverflow.com/users/4001735/scorpion"}, "edited": false, "score": 0, "creation_date": 1482923402, "post_id": 41360227, "comment_id": 69922778, "body": "is <code>currentworkbook</code> a <code>CSV</code>? <a href=\"http://stackoverflow.com/questions/17173898/how-to-do-a-save-as-in-vba-code-saving-my-current-excel-workbook-with-datesta\" title=\"how to do a save as in vba code saving my current excel workbook with datesta\">stackoverflow.com/questions/17173898/&hellip;</a>"}, {"owner": {"reputation": 99, "user_id": 4227197, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100000228938275/picture?type=large", "display_name": "Kirsteen Ng", "link": "https://stackoverflow.com/users/4227197/kirsteen-ng"}, "reply_to_user": {"reputation": 75, "user_id": 4001735, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dayR9.jpg?s=128&g=1", "display_name": "scorpion", "link": "https://stackoverflow.com/users/4001735/scorpion"}, "edited": false, "score": 0, "creation_date": 1482925463, "post_id": 41360227, "comment_id": 69923883, "body": "No its not. its a .xlsx."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4227197, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100000228938275/picture?type=large", "display_name": "Kirsteen Ng", "link": "https://stackoverflow.com/users/4227197/kirsteen-ng"}, "edited": false, "score": 0, "creation_date": 1482924839, "post_id": 41360575, "comment_id": 69923510, "body": "No, still doesnt work, would it because I am using a Mac to run this?"}], "tags": [], "owner": {"reputation": 132, "user_id": 6493950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKPkM.png?s=128&g=1", "display_name": "Diogo", "link": "https://stackoverflow.com/users/6493950/diogo"}, "is_accepted": false, "score": 0, "last_activity_date": 1482922682, "creation_date": 1482922682, "answer_id": 41360575, "question_id": 41360227, "link": "https://stackoverflow.com/questions/41360227/vba-activeworkbook-saveas-runtime-error-1004/41360575#41360575", "title": "VBA ActiveWorkbook.Saveas runtime error 1004", "body": "<pre><code>ActiveWorkbook.SaveAs Filename:=savedirectory, FileFormat:=xlCSV, ConflictResolution:=xlLocalSessionChanges\n</code></pre>\n\n<p>Could you try this way? It worked for me.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 4227197, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100000228938275/picture?type=large", "display_name": "Kirsteen Ng", "link": "https://stackoverflow.com/users/4227197/kirsteen-ng"}, "edited": false, "score": 0, "creation_date": 1482925329, "post_id": 41360881, "comment_id": 69923802, "body": "Thanks! But it still doesnt work and give the same error. I am running this on a MacBook Air. Is it possible to be the cause?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 99, "user_id": 4227197, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100000228938275/picture?type=large", "display_name": "Kirsteen Ng", "link": "https://stackoverflow.com/users/4227197/kirsteen-ng"}, "edited": false, "score": 0, "creation_date": 1482926238, "post_id": 41360881, "comment_id": 69924342, "body": "It. Might be, but I have a PC, so I can&#39;t help u debug"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1482923971, "last_edit_date": 1482923971, "creation_date": 1482923610, "answer_id": 41360881, "question_id": 41360227, "link": "https://stackoverflow.com/questions/41360227/vba-activeworkbook-saveas-runtime-error-1004/41360881#41360881", "title": "VBA ActiveWorkbook.Saveas runtime error 1004", "body": "<p>Resolving your error line, just use:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=savedirectory, FileFormat:=xlCSV, ConflictResolution:=2\n</code></pre>\n\n<p>(<code>ConflictResolution = 2</code> , equals <code>xlLocalSessionChanges</code> , read here : <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194803.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff194803.aspx</a></p>\n\n<p>However, you could improve your code by not using <code>ws.Activate</code> , <code>ActiveWorkbook</code> and <code>csvworkbook = ActiveWorkbook.Name</code>. You could directly assign your <code>wscsv</code> (defined as workbook) to the new created workbook. See my code below how to reference all objects.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub AddNewWorkbook1(ws As Worksheet)\n\nMsgBox (\"adding new workbook for \" &amp; ws.Name)\n\nDim wscsv As Workbook\nDim savedirectory As String\nDim currentworkbook As String\nDim csvworkbook As String\n\ncurrentworkbook = ws.Name\nsavedirectory = \"Your Path\" &amp; \"\\\" &amp; ws.Name\n\nDim lrow As Long\nlrow = ws.Columns(\"A\").End(xlDown).Row\n\nSet wscsv = Workbooks.Add\nDisplayAlerts = False\n\nwscsv.SaveAs Filename:=savedirectory, FileFormat:=xlCSV, ConflictResolution:=2\ncsvworkbook = wscsv.Name\n\nMsgBox (\"Entering copying\")\n\n' do the rest of your copy &gt;&gt; paste \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4227197, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100000228938275/picture?type=large", "display_name": "Kirsteen Ng", "link": "https://stackoverflow.com/users/4227197/kirsteen-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2211, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1482923971, "creation_date": 1482921449, "last_edit_date": 1482923004, "question_id": 41360227, "link": "https://stackoverflow.com/questions/41360227/vba-activeworkbook-saveas-runtime-error-1004", "title": "VBA ActiveWorkbook.Saveas runtime error 1004", "body": "<p>I am new to VBA and trying to make a copy from ws to wscsv and save the latter as .csv file. The following is my sub routine.</p>\n\n<p>I am encountering:  </p>\n\n<blockquote>\n  <p>run-time error 1004: Application undefined</p>\n</blockquote>\n\n<p>at this line:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=savedirectory, FileFormat:=xlCSV, ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges  \n\ncsvworkbook = ActiveWorkbook.Name\n</code></pre>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>Sub AddNewWorkbook1(ws As Worksheet)\n\n  ws.Activate\n  MsgBox (\"adding new workbook for\" &amp; ws.Name)\n  Dim wscsv As Excel.Workbook\n  Dim savedirectory As String\n  Dim currentworkbook As String\n  Dim csvworkbook As String\n  currentworkbook = ws.Name\n\n  savedirectory = '/Users/Desktop/Magnum/' &amp; currentworkbook\n\n  Dim lrow As Long\n  lrow = Columns(\"A\").End(xlDown).Row\n\n  Workbooks.Add\n  DisplayAlerts = False\n  ActiveWorkbook.SaveAs (Filename:=savedirectory, FileFormat:=xlCSV, ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges)\n\n  csvworkbook = ActiveWorkbook.Name\n\n  Set wscsv = ActiveWorkbook\n  MsgBox (\"Entering copying\")\n\n  ws.Range(ws.Cells(2, 1), ws.Cells(lrow, 4)).Copy\n  wscsv.Sheets(1).Range(\"A1\").PasteSpecial xlPasteValues\n  ws.Range(ws.Cells(2, \"H\"), ws.Cells(lrow, \"H\")).Copy\n  wscsv.Sheets(1).Range(\"E1\").PasteSpecial xlPasteValues\n  ws.Range(ws.Cells(2, \"E\"), ws.Cells(lrow, \"E\")).Copy\n  wscsv.Sheets(1).Range(\"F1\").PasteSpecial xlPasteValues\n  ws.Range(ws.Cells(2, \"I\"), ws.Cells(lrow, \"I\")).Copy\n  wscsv.Sheets(1).Range(\"G1\").PasteSpecial xlPasteValues\n  lrow = wscsv.Sheets(1).Columns(\"A\").End(xlDown).Row\n  wscsv.Sheets(1).Range(wscsv.Sheets(1).Cells(2, 1),    wscsv.Sheets(1).Cells(lrow, 1)).NumberFormat = \"mm/dd/yyyy\"\n  wscsv.Sheets(1).Range(\"A1\").Value = \"Date\"\n  wscsv.Sheets(1).Range(\"B1\").Value = \"open\"\n  wscsv.Sheets(1).Range(\"C1\").Value = \"high\"\n  wscsv.Sheets(1).Range(\"D1\").Value = \"low\"\n  wscsv.Sheets(1).Range(\"E1\").Value = \"close\"\n  wscsv.Sheets(1).Range(\"F1\").Value = \"volume\"\n  wscsv.Sheets(1).Range(\"G1\").Value = \"cap\"\n  wscsv.Save\n  wscsv.Close\n\n  MsgBox (\"Copying complete\")\n\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6830592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206501149412866/picture?type=large", "display_name": "Ravi Adabala", "link": "https://stackoverflow.com/users/6830592/ravi-adabala"}, "edited": false, "score": 0, "creation_date": 1482925461, "post_id": 41360768, "comment_id": 69923881, "body": "Excellent!! Its working now. Thank you. Also I found other way by using run. I posted that code also and accepting this as answer"}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "reply_to_user": {"reputation": 73, "user_id": 6830592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206501149412866/picture?type=large", "display_name": "Ravi Adabala", "link": "https://stackoverflow.com/users/6830592/ravi-adabala"}, "edited": false, "score": 0, "creation_date": 1482926399, "post_id": 41360768, "comment_id": 69924429, "body": "@Ravi Adabala, Hey, cheers! I knew about your other way, but I just getting nervous when there&#39;s a work with multi-app projects thru <code>Run</code>."}], "tags": [], "owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "is_accepted": true, "score": 3, "last_activity_date": 1482930532, "last_edit_date": 1482930532, "creation_date": 1482923272, "answer_id": 41360768, "question_id": 41360216, "link": "https://stackoverflow.com/questions/41360216/not-able-to-execute-macro-from-vbs-file/41360768#41360768", "title": "Not able to execute macro from .vbs file", "body": "<p>You can try it without Run, you can call your functions explicitly from workbook and sheets objects!</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\xxx\\xxxx\\xxxx\\VB\\Data.xlsm\")\nSet Sheet1 = objWorkbook.Sheets(1)\nSheet1.Test \nobjExcel.ActiveWorkbook.Close\n\nobjExcel.Application.Quit\n\nWScript.Quit\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482932549, "post_id": 41361259, "comment_id": 69927834, "body": "you know you can run the MACRO without actually opening the <code>Workbook</code>, right? Which makes it faster"}], "tags": [], "owner": {"reputation": 73, "user_id": 6830592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206501149412866/picture?type=large", "display_name": "Ravi Adabala", "link": "https://stackoverflow.com/users/6830592/ravi-adabala"}, "is_accepted": false, "score": 1, "last_activity_date": 1482925782, "last_edit_date": 1482925782, "creation_date": 1482924914, "answer_id": 41361259, "question_id": 41360216, "link": "https://stackoverflow.com/questions/41360216/not-able-to-execute-macro-from-vbs-file/41361259#41361259", "title": "Not able to execute macro from .vbs file", "body": "<p>Thanks Guys, I found solution for the above problem. May be problem was, I am trying to run a macro without opening excel workbook, not sure though. Anyhow this is the working code. I am able to run macros from vbs now</p>\n\n<pre><code>Option Explicit\nDim xlApp, xlBook\n\nSet xlApp = CreateObject(\"Excel.Application\")\nset XlBook = xlApp.Workbooks.Open(\"C:\\xxx\\xxx\\xxx\\xxx\\Data.xlsm\")\nxlApp.Run \"Sheet1.Test\"\nxlBook.Close\nxlApp.Quit\nSet xlBook = Nothing\nset xlApp = Nothing\nWScript.Echo \"Finished\"\nWScript.Quit\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6830592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1206501149412866/picture?type=large", "display_name": "Ravi Adabala", "link": "https://stackoverflow.com/users/6830592/ravi-adabala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 0, "accepted_answer_id": 41360768, "answer_count": 2, "score": 2, "last_activity_date": 1482930532, "creation_date": 1482921406, "last_edit_date": 1531164843, "question_id": 41360216, "link": "https://stackoverflow.com/questions/41360216/not-able-to-execute-macro-from-vbs-file", "title": "Not able to execute macro from .vbs file", "body": "<p>I created a \"Test\" macro in Sheet1 of an excel sheet \"Data\" and trying to call it from vbs file</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\xxx\\xxxx\\xxxx\\VB\\Data.xlsm\")\n\nobjExcel.Application.Run \"C:\\xxx\\xxxx\\xxxx\\VB\\Data.xlsm!Sheet1.Test\" \nobjExcel.ActiveWorkbook.Close\n\nobjExcel.Application.Quit\n\nWScript.Quit\n</code></pre>\n\n<p>I am getting following error: The macro may not be available in this workbook or all macros may be disabled.\nCode: 800A03EC</p>\n\n<p>I changed macro security to \"Enable all macros\" and also checked \"Trust access to the VBA Project model\" under Developer Macro settings. But still no luck</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1482915956, "post_id": 41358588, "comment_id": 69918756, "body": "would you mind giving feedback to <a href=\"http://stackoverflow.com/questions/41355766/vba-excel-how-to-compare-content-of-a-cell-against-specific-strings\">this, related, previous question of yours</a>. thank you"}], "answers": [{"tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 0, "last_activity_date": 1482916328, "creation_date": 1482916328, "answer_id": 41358788, "question_id": 41358588, "link": "https://stackoverflow.com/questions/41358588/vba-excel-how-do-i-get-ouput-in-another-sheet/41358788#41358788", "title": "VBA EXCEL: how do i get ouput in another sheet", "body": "<pre><code>Sheets(\"Sheet2\").Activate\n\n'Writes header\nSheet2.Select\nRange(\"b2\").Value = \"Transient Licenses\"\nRange(\"c2\").Value = \"Steady Licenses\"\nRange(\"d2\").Value = \"Static Licenses\"\n</code></pre>\n\n<p>Avoid using <code>.Activate</code> and <code>.Select</code> wherever possible.</p>\n\n<p>Best way to reform what you have done and to include the values below is:</p>\n\n<pre><code>'Writes header\nWith Sheets(2)\n.Range(\"b2\").Value = \"Transient Licenses\"\n.Range(\"c2\").Value = \"Steady Licenses\"\n.Range(\"d2\").Value = \"Static Licenses\"\n.Columns(\"B:D\").ColumnWidth = 20\n.Range(\"b3\").Value = transientLicense\n.Range(\"c3\").Value = steadyLicense\n.Range(\"d3\").Value = staticLicense\nEnd With\n</code></pre>\n\n<p>As you can see, you can directly reference to value of a cell without having to select it and as you have a named Integer, you can just use that as a value directly. I hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 7226065, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/819fdbde530b9e5788cea7d0b337c690?s=128&d=identicon&r=PG&f=1", "display_name": "user007", "link": "https://stackoverflow.com/users/7226065/user007"}, "edited": false, "score": 0, "creation_date": 1482918635, "post_id": 41359001, "comment_id": 69920249, "body": "how to create new worksheet ? what if &quot;results&quot; sheet is not present beforehand in the workbook?  I want the output to create a new worksheet and then show output in that worksheet."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 149, "user_id": 7226065, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/819fdbde530b9e5788cea7d0b337c690?s=128&d=identicon&r=PG&f=1", "display_name": "user007", "link": "https://stackoverflow.com/users/7226065/user007"}, "edited": false, "score": 0, "creation_date": 1482918842, "post_id": 41359001, "comment_id": 69920360, "body": "see edited answer. ff this solved your question then you may want to mark answer as accepted, thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1482918836, "last_edit_date": 1482918836, "creation_date": 1482917032, "answer_id": 41359001, "question_id": 41358588, "link": "https://stackoverflow.com/questions/41358588/vba-excel-how-do-i-get-ouput-in-another-sheet/41359001#41359001", "title": "VBA EXCEL: how do i get ouput in another sheet", "body": "<p>say you want to write outputs to worksheet \"Results\":</p>\n\n<pre><code>    With Worksheets.Add\n        .Name = \"Results\"\n        .Columns(\"B:D\").ColumnWidth = 20\n        .Range(\"B2:D2\").Value = Array(\"Transient Licenses\", \"Steady Licenses\", \"Static Licenses\")\n        .Range(\"B3:D3\").Value = Array(transientLicense, steadyLicense, staticLicense)\n    End With\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 7226065, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/819fdbde530b9e5788cea7d0b337c690?s=128&d=identicon&r=PG&f=1", "display_name": "user007", "link": "https://stackoverflow.com/users/7226065/user007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 41359001, "answer_count": 2, "score": 1, "last_activity_date": 1482918836, "creation_date": 1482915618, "last_edit_date": 1482916281, "question_id": 41358588, "link": "https://stackoverflow.com/questions/41358588/vba-excel-how-do-i-get-ouput-in-another-sheet", "title": "VBA EXCEL: how do i get ouput in another sheet", "body": "<p>This is my code. I am counting the licenses and i need the total no of licenses of each type in another sheet.</p>\n\n<pre><code>Sub Button1_Click()\n\n    'Initialising no of licenses to 0\n\n    Dim transientLicense As Integer     \n    transientLicense = 0    \n    Dim steadyLicense As Integer    \n    steadyLicense = 0    \n    Dim staticLicense As Integer    \n    staticLicense = 0    \n\n    'checking conditions        \n\n    transientLicense = Sum(CountIfs(Channeltype, \"'=Radial Vibration' Or '=Acceleration' Or '=Acceleration2' Or '=Velocity' Or '=Velocity'\", Keyphasor, \"=Yes\", ActiveInactive, \"=Active\"))    \n\n    steadyLicense = Sum(CountIfs(Channeltype, \"'=Radial Vibration' Or '=Acceleration' Or '=Acceleration2' Or '=Velocity' Or '=Velocity'\", Keyphasor, \"=No\", ActiveInactive, \"=Active\"))    \n\n    staticLicense = Sum(CountIfs(Channeltype, \"'=Thrust Position' Or '=Temperature' Or '=Pressure'\", ActiveInactive, \"=Active\"))     \n\n    Application.ScreenUpdating = False    \n    Sheet2.Visible = xlSheetVisible    \n\n    ' changes the format of sheet 3 to text    \n    'Sheet2.Cells.NumberFormat = \"@\"    \n\n    Sheets(\"Sheet2\").Activate    \n\n    'Writes header\n    Sheet2.Select    \n    Range(\"b2\").Value = \"Transient Licenses\"    \n    Range(\"c2\").Value = \"Steady Licenses\"    \n    Range(\"d2\").Value = \"Static Licenses\"    \n\n    'writes new table in sheet 2    \n     Columns(\"B:B\").Select    \n        Selection.ColumnWidth = 20    \n        Columns(\"C:C\").Select    \n        Selection.ColumnWidth = 20    \n        Columns(\"D:D\").Select    \n        Selection.ColumnWidth = 20    \n\n\nEnd Sub\n</code></pre>\n\n<p>After clicking on the button, I want the ouput in sheet2.\nCan u please let me know how to get ouput in another worksheet.\nThank u so much in advance.\n:)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 2, "creation_date": 1482916976, "post_id": 41358225, "comment_id": 69919330, "body": "So what have you tried? And what is your particular problem?"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1482930204, "post_id": 41360145, "comment_id": 69926545, "body": "Using <code>Select</code> like this is cumbersome. Perhaps you could have an array of different cases and then determine the column based on the position of a string in the array?"}, {"owner": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1482931399, "post_id": 41360145, "comment_id": 69927221, "body": "@CallumDA  Do you mean like this? See my updated answer."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1482935884, "post_id": 41360145, "comment_id": 69929703, "body": "Yeah, that&#39;s a lot better"}], "tags": [], "owner": {"reputation": 176, "user_id": 6077540, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbc32e3fe52b45020414e6c7ab7b3bab?s=128&d=identicon&r=PG&f=1", "display_name": "Mick17", "link": "https://stackoverflow.com/users/6077540/mick17"}, "is_accepted": false, "score": 1, "last_activity_date": 1482931365, "last_edit_date": 1482931365, "creation_date": 1482921224, "answer_id": 41360145, "question_id": 41358225, "link": "https://stackoverflow.com/questions/41358225/loop-through-a-list-and-find-certain-values-vba/41360145#41360145", "title": "Loop through a list and find certain values VBA", "body": "<p>I hope I understanded the question. The following code may not be the cleanest but it works. I have assumed that start->stop always have the same count of steps and always in the same order.</p>\n\n<pre><code>Sub test2()\n\nApplication.ScreenUpdating = False\n\nFor i = 1 To 20000\n    For j = 1 To 9\n        nextfree = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n        If Sheets(\"sheet1\").Range(\"A\" &amp; i).Value = Sheets(\"sheet2\").Cells(1, j).Value Then\n            Sheets(\"sheet2\").Cells(nextfree, j).Value = Sheets(\"sheet1\").Range(\"C\" &amp; i).Value\n        End If\n    Next j\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5681777, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/86108a366d2a195ca8de9a57b3649f74?s=128&d=identicon&r=PG&f=1", "display_name": "anp", "link": "https://stackoverflow.com/users/5681777/anp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1137, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1482931365, "creation_date": 1482914122, "question_id": 41358225, "link": "https://stackoverflow.com/questions/41358225/loop-through-a-list-and-find-certain-values-vba", "title": "Loop through a list and find certain values VBA", "body": "<p>I have a long list of values that are getting longer each day. It contains data from a machine that assign values based on buttons pushed, values are -1, 0, 1, 2.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UqxHB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UqxHB.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Every time the machine is executing an operation, it assign a unique number to it. If the button \"test\" is pushed, it gives the value -1 and the unique number from the previous operation is assign to this \"test\". This is because the test does not count as an operation. Example number 331 in picture.</p>\n\n<p>I order to create a report from my data I want it on the format presented below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/U5Cfu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U5Cfu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I therefor need a VBA code that will be going through the entire list (about 2000 cells now) and move the values onto a new sheet.</p>\n\n<p>So far, I have tried to copy the area containing the values I need on to a new sheet and then use this formula to move each number.</p>\n\n<pre><code>Worksheets(\"Sheetname\").Cells(NewRow + 2, 2).Value = Range(\"button\").Value\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 898, "user_id": 4425957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faea4ee63cb1f9c3e30d3faac96f978b?s=128&d=identicon&r=PG&f=1", "display_name": "Porcupine911", "link": "https://stackoverflow.com/users/4425957/porcupine911"}, "edited": false, "score": 0, "creation_date": 1482936983, "post_id": 41358160, "comment_id": 69930336, "body": "Have you tried the <code>Chart.Location</code> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196573.aspx\" rel=\"nofollow noreferrer\">method</a>, as hinted to in your recorded macro?"}, {"owner": {"reputation": 35, "user_id": 7308936, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06e6fad5049a44131ca05a3ac650101?s=128&d=identicon&r=PG&f=1", "display_name": "Stella1234", "link": "https://stackoverflow.com/users/7308936/stella1234"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1482963176, "post_id": 41358160, "comment_id": 69942562, "body": "@vacip When I run the recorded macro, &#39;The specified dimension is not valid for the current chart type&#39; error comes up and highlights the 2nd line of code yellow. It pastes the chart picture in the new chart sheet, but not the second chart."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7354646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bc3caa16f9ffed3ca52a46a718988c4?s=128&d=identicon&r=PG", "display_name": "Almir", "link": "https://stackoverflow.com/users/7354646/almir"}, "is_accepted": false, "score": 0, "last_activity_date": 1483025664, "creation_date": 1483025664, "answer_id": 41382735, "question_id": 41358160, "link": "https://stackoverflow.com/questions/41358160/vba-code-to-combine-2-chart-sheets-into-one/41382735#41382735", "title": "VBA Code to combine 2 chart sheets into one", "body": "<p>Try to copy both graphs as separate objects to a separate sheet.\nGroup (combine) them into a single graph\nMove combined graph to desired sheet</p>\n"}], "owner": {"reputation": 35, "user_id": 7308936, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06e6fad5049a44131ca05a3ac650101?s=128&d=identicon&r=PG&f=1", "display_name": "Stella1234", "link": "https://stackoverflow.com/users/7308936/stella1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1021, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1483025664, "creation_date": 1482913820, "last_edit_date": 1482918057, "question_id": 41358160, "link": "https://stackoverflow.com/questions/41358160/vba-code-to-combine-2-chart-sheets-into-one", "title": "VBA Code to combine 2 chart sheets into one", "body": "<p>I currently have a macro that will plot two separate graphs in two different chart sheets. However, I am required to have them on the same chart sheet, with one directly under the other, for easy comparison purposes. </p>\n\n<p>I have tried recording a macro to move the graphs as an object in a new chart sheet that I have created, but the error comes up. </p>\n\n<p>Below is the recorded macro code:</p>\n\n<pre><code>Sheets(\"Graph 1\").Select\nActiveChart.Location Where:=xlLocationAsObject, Name:= _\n    \"Combined Graphs\"\nSheets(\"Graph 2\").Select\nActiveChart.Location Where:=xlLocationAsObject, Name:= _\n    \"Combined Graphs\"\nActiveChart.ChartArea.Select\nActiveSheet.ChartObjects(\"Chart 1\").Activate\nActiveChart.PlotArea.Select\n</code></pre>\n\n<p>I have also tried plotting both of them in the same sheet from the beginning, instead of trying to combine the two graphs after plotting them separately, but I am not sure how to implement this into my code that I have already - </p>\n\n<pre><code>Dim chtChart As Chart\nSet chtChart = Chart.Add\nWith chtChart\n.Name = \"Graph 1\"\n.ChartType = xlLine\n.SetSourceData Source:=DateRange, PlotBy:=xlColumns\n</code></pre>\n\n<p>Any help would be very much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1482916986, "post_id": 41357799, "comment_id": 69919333, "body": "And what precisely is the question or problem?"}, {"owner": {"reputation": 1, "user_id": 7348606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SOFtVlLl8f0/AAAAAAAAAAI/AAAAAAAAABY/x7IbQqC1AfM/photo.jpg?sz=128", "display_name": "mehdi parastar", "link": "https://stackoverflow.com/users/7348606/mehdi-parastar"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1482991060, "post_id": 41357799, "comment_id": 69949453, "body": "i dont kow how to the element in innerhtml elements:("}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1483003023, "post_id": 41357799, "comment_id": 69954780, "body": "It&#39;s only the 2 lines commented with error that is the issue? What is the intended result of those lines? Can you show example source code of the type of element you would use this on?"}, {"owner": {"reputation": 1, "user_id": 7348606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SOFtVlLl8f0/AAAAAAAAAAI/AAAAAAAAABY/x7IbQqC1AfM/photo.jpg?sz=128", "display_name": "mehdi parastar", "link": "https://stackoverflow.com/users/7348606/mehdi-parastar"}, "reply_to_user": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1487134187, "post_id": 41357799, "comment_id": 71640668, "body": "Finally i can solve by replacing:"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7348606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SOFtVlLl8f0/AAAAAAAAAAI/AAAAAAAAABY/x7IbQqC1AfM/photo.jpg?sz=128", "display_name": "mehdi parastar", "link": "https://stackoverflow.com/users/7348606/mehdi-parastar"}, "is_accepted": false, "score": 0, "last_activity_date": 1487134339, "creation_date": 1487134339, "answer_id": 42240982, "question_id": 41357799, "link": "https://stackoverflow.com/questions/41357799/getelement-by-nested-tag-name-in-vba/42240982#42240982", "title": "getElement by nested tag name in VBA", "body": "<pre><code>Function WebPageLinks2(internet, tagname As String, innerlinkcount)\n\nDim td As MSHTML.IHTMLElementCollection\nDim tr As MSHTML.IHTMLElementCollection\nDim trObj As MSHTML.HTMLGenericElement\nDim tdObj As MSHTML.HTMLGenericElement\nDim flag As Boolean\n\nflag = False\n\nSet tr = internet.document.getElementsByTagName(\"a\")\nFor Each trObj In tr\n    Set td = trObj.getElementsByClassName(\"graphimage\")\n    For Each tdObj In td\n        'do something with each td object'\n         If (InStr(CStr(tdObj.alt), \"Agg\") &lt;&gt; 0) Or (InStr(CStr(tdObj.alt), \"ether1\") &lt;&gt; 0) Or (InStr(CStr(tdObj.alt), \"Ether1\") &lt;&gt; 0) Then\n             Sheets(1).Cells(innerlinkcount, 7) = tdObj.src\n             Sheets(1).Cells(innerlinkcount, 6) = tdObj.alt\n             'Debug.Print tdObj.alt\n             'Debug.Print tdObj.src\n             flag = True\n             Call SaveGraphImageFromURLs(Sheets(5).Cells(17, 3).Value, Sheets(1).Cells(innerlinkcount, 7).Value, _\n             ToPathOfImages &amp; \"\\\" &amp; Sheets(1).Cells(innerlinkcount, 1).Value &amp; Sheets(1).Cells(innerlinkcount, 3).Value &amp; Sheets(1).Cells(innerlinkcount, 6).Value &amp; \".png\", _\n             Sheets(5).Cells(18, 3).Value, Sheets(5).Cells(19, 3).Value)\n             Sheets(1).Hyperlinks.Add Range(\"g\" &amp; innerlinkcount), hyperlinkAddress\n             Exit For\n        End If\n    Next\n    If InStr(trObj.href, \"xport\") And flag Then\n       Sheets(1).Cells(innerlinkcount, 5) = trObj.href\n       flag = False\n       Call SaveGraphImageFromURLs(Sheets(5).Cells(17, 3).Value, Sheets(1).Cells(innerlinkcount, 5).Value, _\n       Sheets(5).Cells(20, 3).Value &amp; Sheets(1).Cells(innerlinkcount, 1).Value &amp; Sheets(1).Cells(innerlinkcount, 3).Value &amp; Sheets(1).Cells(innerlinkcount, 6).Value &amp; \".csv\", _\n       Sheets(5).Cells(18, 3).Value, Sheets(5).Cells(19, 3).Value)\n       Call csvimport((Sheets(5).Cells(20, 3).Value))\n       Call tahlil(innerlinkcount)\n       Call move_files(CStr((Sheets(5).Cells(20, 3).Value)), CStr(ToPath))\n       'Debug.Print trObj.href\n       'Debug.Print \" \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\"\n       Exit For\n    End If\nNext\n\nroot = root + 1\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7348606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SOFtVlLl8f0/AAAAAAAAAAI/AAAAAAAAABY/x7IbQqC1AfM/photo.jpg?sz=128", "display_name": "mehdi parastar", "link": "https://stackoverflow.com/users/7348606/mehdi-parastar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1487134339, "creation_date": 1482911954, "last_edit_date": 1531164843, "question_id": 41357799, "link": "https://stackoverflow.com/questions/41357799/getelement-by-nested-tag-name-in-vba", "title": "getElement by nested tag name in VBA", "body": "<p>I want to get webpage link and nested tag's element:</p>\n\n<pre><code>&lt;a href='/cacti/graph.php?action=view&amp;amp;local_graph_id=279&amp;amp;rra_id=all'&gt;&lt;img class='graphimage' id='graph_279' src='/cacti/graph_image.php?local_graph_id=279&amp;amp;rra_id=0&amp;amp;view_type=tree&amp;amp;graph_start=1482822537&amp;amp;graph_end=1482908937' border='0' alt='ARD-Besat-MKT450G  - Bandwidth 16 Mb- ether3-Link to PTMP'&gt;&lt;/a&gt;\n</code></pre>\n\n<p>This is part of my source code.</p>\n\n<p>Finally I want:</p>\n\n<pre><code>cells(1,1).value=\"link address : /cacti/graph.php?action=view&amp;amp;local_graph_id=279&amp;amp;rra_id=all\"\n\ncells(1,2).value=\"image address: /cacti/graph_image.php?local_graph_id=279&amp;amp;rra_id=0&amp;amp;view_type=tree&amp;amp;graph_start=1482822537&amp;amp;graph_end=1482908937\"\n\ncells(1,3).value=\"image alt: ARD-Besat-MKT450G  - Bandwidth 16 Mb- ether3-Link to PTMP'\n</code></pre>\n\n<p>My function in VBA is:</p>\n\n<pre><code>Function WebPageLinks(internet, tagname As String)\nDim internetdata As HTMLDocument\nDim internetlink As Object\nDim internetinnerlink As Object\nSet internetdata = internet.document\nSet internetlink = internetdata.getElementsByTagName(tagname)\nFor Each internetinnerlink In internetlink\nSheets(\"Sheet1\").Select\nSheets(1).Cells(linkcount, 1) = internetinnerlink.href' true\nSheets(1).Cells(linkcount, 2) = internetinnerlink.innerhtml' true\nSheets(1).Cells(linkcount, 3) =internetinnerlink.src ' error\nSheets(1).Cells(linkcount, 4) = internetinnerlink.alt' error\nlinkcount = linkcount + 1\nNext internetinnerlink\nEnd Function`\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1482919800, "post_id": 41358046, "comment_id": 69920826, "body": "@ZdravkoLukic, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1483094495, "post_id": 41358046, "comment_id": 69991367, "body": "@ZdravkoLukic, it&#39;d be nice of you giving feedback to people trying at helping you. Thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 3, "last_activity_date": 1482913595, "last_edit_date": 1482913595, "creation_date": 1482913241, "answer_id": 41358046, "question_id": 41357662, "link": "https://stackoverflow.com/questions/41357662/vba-merge-cells-with-loop/41358046#41358046", "title": "VBA merge cells with loop", "body": "<p>maybe you're after this:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim i As Long\n\n    With ActiveSheet\n        For i = 5 To .Cells(Rows.count, 1).End(xlUp).row Step 2\n            With .Cells(i, 1).Resize(2)\n                .Merge\n                .HorizontalAlignment = xlCenterAcrossSelection\n                .VerticalAlignment = xlCenter\n            End With\n            With .Cells(i, 2).Resize(2)\n                .Merge\n                .HorizontalAlignment = xlCenterAcrossSelection\n                .VerticalAlignment = xlCenter\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>or its shorter option:</p>\n\n<pre><code>Sub main()\n    Dim i As Long\n\n    With ActiveSheet\n        For i = 5 To .Cells(Rows.count, 1).End(xlUp).row Step 2\n            With .Range(.Cells(i, 1).Resize(2).Address &amp; \",\" &amp; .Cells(i, 2).Resize(2).Address)\n                .Merge\n                .HorizontalAlignment = xlCenterAcrossSelection\n                .VerticalAlignment = xlCenter\n            End With\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6073627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-xL7h5J9xMoM/AAAAAAAAAAI/AAAAAAAABFA/XV2NitKCtCM/photo.jpg?sz=128", "display_name": "Zdravko Lukic", "link": "https://stackoverflow.com/users/6073627/zdravko-lukic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2276, "favorite_count": 1, "accepted_answer_id": 41358046, "answer_count": 1, "score": 2, "last_activity_date": 1482921578, "creation_date": 1482911369, "last_edit_date": 1531164843, "question_id": 41357662, "link": "https://stackoverflow.com/questions/41357662/vba-merge-cells-with-loop", "title": "VBA merge cells with loop", "body": "<p>I want to merge cells  two in columns A and B, for example like bellow, and so as long as I have records, below is my code but does not work and does not merge cells do not know what the problem. thanks</p>\n\n<pre><code>.Range(\"A5\", \"A6\").Merge\n.Range(\"A7\", \"A8\").Merge\n.Range(\"A9\", \"A10\").Merge\n\n.Range(\"B5\", \"B6\").Merge\n.Range(\"B7\", \"B8\").Merge\n.Range(\"B9\", \"B10\").Merge\n\n\nDim i As Integer\nDim j As Integer\nDim xlMerge As Range\nDim xlMergeJ As Range\n\nFor i = 5 To ActiveSheet.Cells(Rows.Count, 5).End(xlUp).Row Step 2\n\n        Set xlMerge = Range(Cells(i, 1), Cells(i + 1, 1))\n        With xlMerge\n            .Merge\n            .HorizontalAlignment = xlCenterAcrossSelection\n            .VerticalAlignment = xlCenter\n       End With\n    Next i\n\nFor j = 5 To ActiveSheet.Cells(Rows.Count, 5).End(xlUp).Row Step 2\n\n            Set xlMergeJ = Range(Cells(j, 2), Cells(j + 1, 1))\n            With xlMergeJ\n                .Merge\n                .HorizontalAlignment = xlCenterAcrossSelection\n                .VerticalAlignment = xlCenter\n           End With\n        Next j\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1482910084, "post_id": 41357274, "comment_id": 69916147, "body": "Your assertion is incorrect. <code>x = Worksheets(&quot;Details&quot;).Range(&quot;A1&quot;).End(xlDown)</code> implicitly calls the default member for the <code>Range</code> object, which is <code>_Default</code>, which <i>will</i> return the <i>value</i> of the cell."}], "tags": [], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "is_accepted": false, "score": 1, "last_activity_date": 1482910302, "last_edit_date": 1482910302, "creation_date": 1482909785, "answer_id": 41357274, "question_id": 41357201, "link": "https://stackoverflow.com/questions/41357201/runtime-error-1004-using-worksheets-in-excel-vba/41357274#41357274", "title": "runtime error &#39;1004&#39; using Worksheets in excel vba", "body": "<p>It's a very bad question but I guess the problem is that you don't assign a number x but a cell's value which is not an integer. If you change it as below, it might work.</p>\n\n<pre><code>x = Worksheets(\"Details\").Range(\"A1\").End(xlDown).row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1482910713, "creation_date": 1482910713, "answer_id": 41357504, "question_id": 41357201, "link": "https://stackoverflow.com/questions/41357201/runtime-error-1004-using-worksheets-in-excel-vba/41357504#41357504", "title": "runtime error &#39;1004&#39; using Worksheets in excel vba", "body": "<p>First, since you are trying to get the row number, was a <code>Long</code> type variable for <code>x</code> , and not <code>Variant</code>.</p>\n\n<p>Second, it depends what type of last row in column A you are trying to find:</p>\n\n<p><strong>Option 1</strong>: find last row without skipping blank cells in the middle.</p>\n\n<p><strong>Option 2</strong>: find last row with skipping blank cells in the middle.</p>\n\n<p>Both options are implemented in my code below, use the option you want.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\n    Dim x As Long\n\n    With Worksheets(\"Details\")\n        ' option 1 : will get you the last row with data in Column A (without skipping blank cells in the middle)\n        x = .Range(\"A1\").End(xlDown).Row\n\n        ' option 2 : will get you the last row with data in Column A (with skipping blank cells in the middle)\n        x = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        If OptionButton65 = True Then .Cells(x, 6) = \"5\"\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 0, "last_activity_date": 1482930697, "creation_date": 1482930697, "answer_id": 41362845, "question_id": 41357201, "link": "https://stackoverflow.com/questions/41357201/runtime-error-1004-using-worksheets-in-excel-vba/41362845#41362845", "title": "runtime error &#39;1004&#39; using Worksheets in excel vba", "body": "<p>Just to include another way of achieving this - you could have also used the <code>Range</code>, rather than it's <code>Row</code> property</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim x As Range\n    Set x = Worksheets(\"Details\").Range(\"F1\").End(xlDown)\n    If OptionButton65 = True Then x.Value = \"5\"\nEnd Sub\n</code></pre>\n\n<p>or simply:</p>\n\n<pre><code>Private Sub CommandButton2_Click()     \n    If OptionButton65 = True Then Worksheets(\"Details\").Range(\"F1\").End(xlDown).Value = \"5\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6568001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783b74d0dc405b1870c8965330612070?s=128&d=identicon&r=PG&f=1", "display_name": "n. a. nahin", "link": "https://stackoverflow.com/users/6568001/n-a-nahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1482930697, "creation_date": 1482909508, "last_edit_date": 1531164843, "question_id": 41357201, "link": "https://stackoverflow.com/questions/41357201/runtime-error-1004-using-worksheets-in-excel-vba", "title": "runtime error &#39;1004&#39; using Worksheets in excel vba", "body": "<p>Excel is throwing the error 1004. What am i doing wrong?</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim x As Variant\n    x = Worksheets(\"Details\").Range(\"A1\").End(xlDown)\n    If OptionButton65 = True Then Worksheets(\"Details\").Cells(x, 6) = \"5\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1482952353, "post_id": 41356116, "comment_id": 69938152, "body": "I cannot imagine a problem that would match this question that would not be answered near the beginning of an Excel VBA tutorial. With <code>Dim Rng As Range</code>, either of these: <code>Set Rng = Range(&quot;A1:AD50&quot;)</code> and <code>Set Rng = Range(Cells(1, 1), Cells(50, 30))</code> set Rng to the same range. <code>A1:AD50</code> is a string that can be created at runtime.  <code>1</code>, <code>1</code>, <code>50</code> and <code>30</code> could be replaced by variables."}, {"owner": {"reputation": 1, "user_id": 7345293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoA_mNTGQnY/AAAAAAAAAAI/AAAAAAAAA9I/hGYxFTQ_UJY/photo.jpg?sz=128", "display_name": "Karthikai Selvan", "link": "https://stackoverflow.com/users/7345293/karthikai-selvan"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1483014349, "post_id": 41356116, "comment_id": 69961133, "body": "Hi Tony,I am not clear with the code given, can we edit the same given code to select multiple columns if possible??"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7345293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoA_mNTGQnY/AAAAAAAAAAI/AAAAAAAAA9I/hGYxFTQ_UJY/photo.jpg?sz=128", "display_name": "Karthikai Selvan", "link": "https://stackoverflow.com/users/7345293/karthikai-selvan"}, "edited": false, "score": 0, "creation_date": 1483441618, "post_id": 41382526, "comment_id": 70090160, "body": "Hi Tony, this code works with the fixed number of cells. but the case is for a variable. it will  be very helpful if we know how to alter this for the variable"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 7345293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoA_mNTGQnY/AAAAAAAAAAI/AAAAAAAAA9I/hGYxFTQ_UJY/photo.jpg?sz=128", "display_name": "Karthikai Selvan", "link": "https://stackoverflow.com/users/7345293/karthikai-selvan"}, "edited": false, "score": 0, "creation_date": 1483444288, "post_id": 41382526, "comment_id": 70091703, "body": "@KarthikaiSelvan  I have added a new section to my answer. Does it help?"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1483444228, "last_edit_date": 1483444228, "creation_date": 1483024889, "answer_id": 41382526, "question_id": 41356116, "link": "https://stackoverflow.com/questions/41356116/assigning-variable-for-a-range-of-colums-and-using-it-in-range/41382526#41382526", "title": "Assigning variable for a range of colums and using it in range", "body": "<p>If I am unfamiliar with some VBA functionality, I create a little routine like the following and play with that functionality:</p>\n\n<pre><code>Option Explicit\nSub Demo()\n\n  Dim Rng As Range\n  Dim Rng1 As Range\n  Dim Rng2 As Range\n  Dim Rng3 As Range\n\n  With Worksheets(\"Sheet1\")\n\n    Set Rng1 = .Range(\"A1:D5\")\n    Set Rng2 = .Range(\"A6:D10\")\n\n    Set Rng = Union(Rng1, Rng2)\n\n    Debug.Print \"Rng1=\" &amp; Rng1.Address &amp; \" Rng2=\" &amp; Rng2.Address\n    Debug.Print \" Rng=\" &amp; Rng.Address\n\n    Debug.Print \"Notice that Union has combined the two ranges because they are contiguous\"\n    Debug.Print\n\n    Set Rng1 = .Range(\"A1:D5\")\n    Set Rng2 = .Range(\"F1:F6\")\n\n    Set Rng = Union(Rng1, Rng2)\n\n    Debug.Print \"Rng1=\" &amp; Rng1.Address &amp; \" Rng2=\" &amp; Rng2.Address\n    Debug.Print \" Rng=\" &amp; Rng.Address\n\n    Debug.Print \"Notice that Union could not combined these two ranges because they are not contiguous\"\n    Debug.Print\n\n    Set Rng1 = .Range(\"A1:D5\")\n    Set Rng2 = .Columns(\"B\")\n\n    Set Rng = Intersect(Rng1, Rng2)\n\n    Debug.Print \"Rng1=\" &amp; Rng1.Address &amp; \" Rng2=\" &amp; Rng2.Address\n    Debug.Print \" Rng=\" &amp; Rng.Address\n\n    Debug.Print \"Intersect gives the overlap between two ranges\"\n    Debug.Print\n\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>The above macro demonstrates some of the functionality offered by <code>Union</code> and <code>Intersect</code>.</p>\n\n<p>The key points you need to be aware of:</p>\n\n<ul>\n<li>A range can be the combination of many non-contiguous sub-ranges.</li>\n<li>Those sub-ranges must all be within a single worksheet.</li>\n<li>I cannot find a definitive maximum for the number of sub-ranges in a range. I have found web pages that give the limit as various values between 2,000 and 4,000. Another claims they have had no problem with move that 4,000 sub-ranges. I assume 2,000 sub-ranges is way above your needs so this is not an issue for you.</li>\n<li>Range.Address is a string with a limit of above 255 characters. More fully it will return as many complete sub-ranges as it can fit within 255 characters.     </li>\n</ul>\n\n<p>Try my macro then expand it to better match your requirement.</p>\n\n<p><strong>Extra section in response to request for more information</strong></p>\n\n<p>I assumed your concern was with the handling of non-contiguous columns.</p>\n\n<p>In my first comment, I said with <code>Dim Rng As Range</code>, the following would set Rng to the say range:</p>\n\n<pre><code>Set Rng = Range(\"A1:AD50\")\nSet Rng = Range(Cells(1, 1), Cells(50, 30))\n</code></pre>\n\n<p>Also that A1:AD50 is a string that can be created at runtime and 1, 1, 50 and 30 could be replaced by variables.</p>\n\n<p>You sometimes see statements like:</p>\n\n<pre><code>Set Rng = Range(\"A1:AD\" &amp; RowLast)\n</code></pre>\n\n<p>where <code>RowLast</code> has been set to the last used row by one of a number of techniques.</p>\n\n<p>I do not believe I have ever used a statement like the above because I prefer:</p>\n\n<pre><code>Set Rng = Range(TopLeftCell, BottomRightCell)\n</code></pre>\n\n<p>where <code>TopLeftCell</code> and <code>BottomRightCell</code> are of the format:</p>\n\n<pre><code>Cells(Row, Column)\n</code></pre>\n\n<p>In <code>Cells(Row, Column)</code>, <code>Row</code> must be an integer or an integer variable. <code>Column</code> can be a string (\"A\", \"B\", \"C\", etc.) or an integer (1, 2, 3, etc.) or a string variable or integer variable.  I generally find integer variables the most convenient because I can write:</p>\n\n<pre><code>For ColCrnt = 1 To 30 \n  Cells(RowCrnt, ColCrnt).Value = ??? \nNext\n</code></pre>\n\n<p>In the above I have written <code>Range</code> or <code>Cells</code> which reference the active worksheet. I almost never need to refer to the active worksheet because most macros work on a specific worksheet which should be referenced explicitly. Referencing the active worksheet means you must rely on the user have the correct worksheet active when they start the macro or you must use the slow <code>Worksheet.Activate</code> method.</p>\n\n<p>Better to write something like</p>\n\n<pre><code>With Worksheets(\"Data\") \n  RowLast = .Cells(.Rows.Count, \"A\").End(xlUp).Row       ' Last row with a value in column A  \n  ColLast = .Cells(1, .Columns.Count).End(xlToLeft).Row  ' Last column with a value in row 1  \n  Set Rng = .Range(.Cells(1, 1), .Cells(RowLast, ColLast))\nEnd With\n</code></pre>\n\n<p>Lastly I would add that you will find all this information near the beginning of any online Excel VBA tutorial.  An hour or two looking for a tutorial you like and then working through it will repay itself in time saved very quickly. </p>\n"}], "owner": {"reputation": 1, "user_id": 7345293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XoA_mNTGQnY/AAAAAAAAAAI/AAAAAAAAA9I/hGYxFTQ_UJY/photo.jpg?sz=128", "display_name": "Karthikai Selvan", "link": "https://stackoverflow.com/users/7345293/karthikai-selvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1483444228, "creation_date": 1482904293, "last_edit_date": 1531164843, "question_id": 41356116, "link": "https://stackoverflow.com/questions/41356116/assigning-variable-for-a-range-of-colums-and-using-it-in-range", "title": "Assigning variable for a range of colums and using it in range", "body": "<p><a href=\"https://stackoverflow.com/questions/19559652/assigning-variable-and-using-it-in-range/41343847#41343847\">In the given link, code is written for each column because the need is to drag only two columns. Can we select a range of cells to drag whereas i have 30 columns to drag. Will be very helpful if this could be possible. please someone help me</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1482911800, "post_id": 41356081, "comment_id": 69916964, "body": "show us your code and its issues to let you help you with"}], "answers": [{"tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 0, "last_activity_date": 1482905059, "creation_date": 1482905059, "answer_id": 41356258, "question_id": 41356081, "link": "https://stackoverflow.com/questions/41356081/copy-a-range-of-data-from-one-worksheet-paste-18-times-in-the-other-worksheet/41356258#41356258", "title": "Copy a range of data from one worksheet &amp; paste 18 times in the other worksheet", "body": "<p>you can try something like this. Ihave shown for only one column. you can repeat for other columns. Make sure to change the range <code>$A$1:$A$2</code> to your desired data range.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l7w9a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l7w9a.png\" alt=\"Spreadsheet screenshot\"></a></p>\n\n<pre><code>D1 = INDEX($A$1:$A$2,QUOTIENT(ROW()-ROW($D$1),18)+1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482905864, "post_id": 41356312, "comment_id": 69914428, "body": "I&#39;ve downvoted this answer, because of the number of SO questions that wouldn&#39;t need to be asked if only people stopped writing code that relies on <code>.Select</code> and <code>Selection</code> (and <code>.Activate</code>), and implicitly work against the <code>ActiveSheet</code>. You could simply do <code>ThisWorkbook.Worksheets(&quot;Inputs&quot;).Range(&quot;A6&quot;).Copy</code> instead, for example."}, {"owner": {"reputation": 30, "user_id": 3391546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a66c3fe41a1547156f7ca2b064cd5f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3391546", "link": "https://stackoverflow.com/users/3391546/user3391546"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482906206, "post_id": 41356312, "comment_id": 69914561, "body": "Thanks Mat&#39;s Mug.I agree with you and &#39;ll do that from next time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1482907093, "post_id": 41356312, "comment_id": 69914927, "body": "Feel free to <a href=\"https://stackoverflow.com/posts/41356312/edit\">edit</a> your answer, downvotes aren&#39;t immutable ;-)"}, {"owner": {"reputation": 30, "user_id": 3391546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a66c3fe41a1547156f7ca2b064cd5f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3391546", "link": "https://stackoverflow.com/users/3391546/user3391546"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1482908352, "post_id": 41356312, "comment_id": 69915425, "body": ":) Did.It is always good to meet people like you specially when trying to start participating in new community."}, {"owner": {"reputation": 1, "user_id": 5047665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9257e74b887842e43c0d0bdcf92def43?s=128&d=identicon&r=PG&f=1", "display_name": "Kalai Priya", "link": "https://stackoverflow.com/users/5047665/kalai-priya"}, "edited": false, "score": 0, "creation_date": 1482924797, "post_id": 41356312, "comment_id": 69923482, "body": "Hi, Thanks much for your answer! But this works only for first row data. I need to copy all the existing data present in Input sheet and paste it sequentially in locale_Data Sheet..   Please can you help ?"}, {"owner": {"reputation": 30, "user_id": 3391546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a66c3fe41a1547156f7ca2b064cd5f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3391546", "link": "https://stackoverflow.com/users/3391546/user3391546"}, "edited": false, "score": 0, "creation_date": 1482966327, "post_id": 41356312, "comment_id": 69943586, "body": "If you have multiple item in Column A and want to copy them all 18 times in sequentially you can do something like the one I posted in my second answer."}], "tags": [], "owner": {"reputation": 30, "user_id": 3391546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a66c3fe41a1547156f7ca2b064cd5f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3391546", "link": "https://stackoverflow.com/users/3391546/user3391546"}, "is_accepted": false, "score": 1, "last_activity_date": 1482966722, "last_edit_date": 1495540423, "creation_date": 1482905316, "answer_id": 41356312, "question_id": 41356081, "link": "https://stackoverflow.com/questions/41356081/copy-a-range-of-data-from-one-worksheet-paste-18-times-in-the-other-worksheet/41356312#41356312", "title": "Copy a range of data from one worksheet &amp; paste 18 times in the other worksheet", "body": "<p>If you have values in range say A6:A10 of Inputs worksheet and you would like to copy them in locale_Data worksheet 18 times starting at Row 6 you can do something like this. </p>\n\n<pre><code>Dim LastRow As Long\nDim i, startAt, totalRowsToCopy  As Integer\nDim sheet1 As Worksheet\nDim sheet2 As Worksheet\n\nSet sheet1 = ThisWorkbook.Worksheets(\"Inputs\")\nSet sheet2 = ThisWorkbook.Worksheets(\"locale_Data\")\nLastRow = sheet1.Cells(sheet1.Rows.Count, \"A\").End(xlUp).Row\n\nsheet1.Range(\"A6:A\" &amp; (LastRow)).Copy\nstartAt = 6\ntotalRowsToCopy = LastRow - startAt + 1\nFor i = 1 To 18\n  sheet2.Range(\"A\" &amp; startAt &amp; \":A\" &amp; (startAt + totalRowsToCopy - 1)).PasteSpecial\n  startAt = startAt + totalRowsToCopy\nNext i\n</code></pre>\n\n<p>(Edited after <a href=\"https://stackoverflow.com/users/1188513/mats-mug\">Mat's</a> suggestion)</p>\n\n<p>If you just want to copy value in Row 6 18 times in another worksheet you  can do something like this:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Inputs\").Range(\"A6\").Copy\nThisWorkbook.Worksheets(\"locale_Data\").Range(\"A6:A23\").PasteSpecial\n</code></pre>\n\n<p>You have to repeat this code for each cells. </p>\n\n<p>And if you want to change 18 to some other number you can always concatenate cell range like</p>\n\n<pre><code>Range(\"A6:A\" &amp; (6 + 18)).PasteSpecial\n</code></pre>\n\n<p>Let me know if this is not what you are looking for.</p>\n"}], "owner": {"reputation": 1, "user_id": 5047665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9257e74b887842e43c0d0bdcf92def43?s=128&d=identicon&r=PG&f=1", "display_name": "Kalai Priya", "link": "https://stackoverflow.com/users/5047665/kalai-priya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1482966722, "creation_date": 1482904112, "question_id": 41356081, "link": "https://stackoverflow.com/questions/41356081/copy-a-range-of-data-from-one-worksheet-paste-18-times-in-the-other-worksheet", "title": "Copy a range of data from one worksheet &amp; paste 18 times in the other worksheet", "body": "<p>Helloo,</p>\n\n<p>I need Copy a range of data from one worksheet &amp; paste 18 times of each data in the other worksheet.</p>\n\n<p>Eg.,\nI need to copy the data starting from Row 6 Column A,F,G from one sheet named \"Inputs\"\nAnd need to paste the data 18 times starting from Row 6 of Column A,C,D in other sheet named \"locale_Data\"</p>\n\n<p>So, the first data of input sheet should be pasted into Row (6:23) of sheet \"locale_Data\" &amp; follows the other data in a sequential manner.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["excel", "if-statement", "vba"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1483082590, "post_id": 41355766, "comment_id": 69986554, "body": "It&#39;s better if you don&#39;t start your question with the techno: tags are here for that; plus read the description of tags: don&#39;t use &quot;vba&quot; for excel-vba."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 7226065, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/819fdbde530b9e5788cea7d0b337c690?s=128&d=identicon&r=PG&f=1", "display_name": "user007", "link": "https://stackoverflow.com/users/7226065/user007"}, "edited": false, "score": 0, "creation_date": 1482905500, "post_id": 41356194, "comment_id": 69914281, "body": "how do i use it for an entire column? like if i want total of transientlicense in the end?"}, {"owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "edited": false, "score": 0, "creation_date": 1482905821, "post_id": 41356194, "comment_id": 69914414, "body": "you will use a for loop then. <code>for i = 1 to Range(&quot;AH5000&quot;).end(3).row</code>. Then if clauses and <code>Next</code>."}], "tags": [], "owner": {"reputation": 26, "user_id": 7333773, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2d5071fd71e805a4601225531b0d08f?s=128&d=identicon&r=PG", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/7333773/swapnil"}, "is_accepted": false, "score": -1, "last_activity_date": 1482904708, "creation_date": 1482904708, "answer_id": 41356194, "question_id": 41355766, "link": "https://stackoverflow.com/questions/41355766/how-to-compare-content-of-a-cell-against-specific-strings/41356194#41356194", "title": "How to compare content of a cell against specific strings", "body": "<p>You should try such way</p>\n\n<pre><code>Sub Demo()\n\nIf ((Range(\"AH1\").Value = \"radial vibration\") Or (Range(\"AH1\").Value = \"acceleration\") Or (Range(\"AH1\").Value = \"acceleration2\") Or (Range(\"AH1\").Value = \"velocity\") Or (Range(\"AH1\").Value = \"velocity2\") Or (Range(\"AH1\").Value = \"velocity2\")) And ((Range(\"W1\").Value = \"yes\")) And ((Range(\"D1\").Value = \"active\")) Then\n\n    transientLicense = transientLicense + 1\n\nEnd If\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1482917900, "last_edit_date": 1482917900, "creation_date": 1482908060, "answer_id": 41356855, "question_id": 41355766, "link": "https://stackoverflow.com/questions/41355766/how-to-compare-content-of-a-cell-against-specific-strings/41356855#41356855", "title": "How to compare content of a cell against specific strings", "body": "<p><strong>edit</strong> to add a <code>WorkSheetFunction.CountIF()</code> option</p>\n\n<p>you could go two ways:</p>\n\n<ul>\n<li><p><strong><code>AutoFilter()</code> option</strong></p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim transientLicense As Integer\n    Dim steadyLicense As Integer\n    Dim staticLicense As Integer\n    Dim arr1 As Variant, arr2 As Variant\n\n    arr1 = Array(\"radial vibration\", \"acceleration\", \"acceleration2\", \"velocity\", \"velocity2\") '&lt;--| set your first values list\n    arr2 = Array(\"axial vibration\", \"temperature\", \"pressure\") '&lt;--| set your 2nd values list\n    With Worksheets(\"Licenses\") '&lt;-| reference your relevant worksheet (change \"Licenses\" to your actual worksheet name)\n        With .Range(\"D1\", .Cells(.Rows.Count, \"AH\").End(xlUp)) '&lt;--| reference its columns D to AH range from row 1 down to column AH last not empty row\n            .AutoFilter Field:=1, Criteria1:=\"active\" '&lt;--| filter referenced cells on 1st column (\"D\") with \"active\"\n            .AutoFilter Field:=31, Criteria1:=arr1, Operator:=xlFilterValues '&lt;--| filter referenced cells on 31th column (\"AH\") with arr1 list\n            .AutoFilter Field:=20, Criteria1:=\"yes\" '&lt;--| filter referenced cells on 20th  column (\"W\") with \"yes\"\n            transientLicense = .Resize(, 1).SpecialCells(xlCellTypeVisible).Count - 1\n            .AutoFilter Field:=20, Criteria1:=\"no\" '&lt;--| filter referenced cells on 20th  column (\"W\") with \"no\"\n            steadyLicense = .Resize(, 1).SpecialCells(xlCellTypeVisible).Count - 1\n            .AutoFilter Field:=20 '&lt;--|remove filter on 20th columncolumn\n            .AutoFilter Field:=31, Criteria1:=arr2, Operator:=xlFilterValues '&lt;--| filter referenced cells on 31th  column (\"AH\") with arr2 list\n           staticLicense = .Resize(, 1).SpecialCells(xlCellTypeVisible).Count - 1\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n\n<p>the only requirement being row 1 must have headers</p></li>\n</ul>\n\n<hr>\n\n<ul>\n<li><p><strong><code>WorkSheetFunction.CountIF()</code> option</strong></p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim transientLicense As Integer\n    Dim steadyLicense As Integer\n    Dim staticLicense As Integer\n    Dim arr1 As Variant, arr2 As Variant, elem As Variant\n\n    arr1 = Array(\"radial vibration\", \"acceleration\", \"acceleration2\", \"velocity\", \"velocity2\") '&lt;--| set your first values list\n    arr2 = Array(\"axial vibration\", \"temperature\", \"pressure\") '&lt;--| set your 2nd values list\n    With Worksheets(\"Licenses\") '&lt;-| reference your relevant worksheet (change \"Licenses\" to your actual worksheet name)\n        With .Range(\"D1\", Cells(Rows.Count, \"AH\").End(xlUp)) '&lt;--| reference its columns D to AH range from row 1 down to column AH last not empty row\n            For Each elem In arr1 '&lt;--| loop through 1st array list\n                transientLicense = transientLicense + WorksheetFunction.CountIfs(.Columns(1), \"active\", .Columns(20), \"yes\", .Columns(31), elem) '&lt;-- update 'transientLicense' for every record matching: \"active\" in referenced range column 1(i.e. \"D\"), \"yes\" in referenced range column 20 (i.e. \"W\") and current list element in referenced range column 31 (i.e. \"AH\")\n                steadyLicense = steadyLicense + WorksheetFunction.CountIfs(.Columns(1), \"active\", .Columns(20), \"no\", .Columns(31), elem) '&lt;-- update 'steadyLicense' for every record matching: \"active\" in referenced range column 1(i.e. \"D\"), \"no\" in referenced range column 20 (i.e. \"W\") and current list element in referenced range column 31 (i.e. \"AH\")\n            Next elem\n            For Each elem In arr2 '&lt;--| loop through 2nd array list\n                staticLicense = staticLicense + WorksheetFunction.CountIfs(.Columns(1), \"active\", .Columns(31), elem) '&lt;-- update 'staticLicense' for every record matching: \"active\" in referenced range column 1(i.e. \"D\") and current list element in referenced range column 31 (i.e. \"AH\")\n            Next elem\n        End With\n    End With\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 149, "user_id": 7226065, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/819fdbde530b9e5788cea7d0b337c690?s=128&d=identicon&r=PG&f=1", "display_name": "user007", "link": "https://stackoverflow.com/users/7226065/user007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "accepted_answer_id": 41356855, "answer_count": 2, "score": -1, "last_activity_date": 1483082590, "creation_date": 1482902258, "last_edit_date": 1531164843, "question_id": 41355766, "link": "https://stackoverflow.com/questions/41355766/how-to-compare-content-of-a-cell-against-specific-strings", "title": "How to compare content of a cell against specific strings", "body": "<p>Initialising no of licenses to 0</p>\n\n<pre><code>dim transientLicense AS integer\ntransientLicense=0\ndim steadyLicense AS integer\nsteadyLicense=0\ndim staticLicense AS integer\nstaticLicense=0\n</code></pre>\n\n<p>Checking conditions</p>\n\n<pre><code>if( (value.cell(AH) =(\"radial vibration\" or \"acceleration\" or \"acceleration2\" or \"velocity\" or \"velocity2\")) &amp;&amp; (value.cell(W)=\"yes\") &amp;&amp; (value.cell(D)=\"active\") Then\n transientLicense++\n\nelse if( (value.cell(AH) =(\"radial vibration\" or \"acceleration\" or \"acceleration2\" or \"velocity\" or \"velocity2\")) &amp;&amp; (value.cell(W)=\"no\") &amp;&amp; (value.cell(D)=\"active\") Then\n steadyLicense++\n\nelse if((value.cell(AH)=(\"axial vibration\" or \"temperature\" or \"pressure\") &amp;&amp; (value.cell(D)=\"active\")) Then\n staticLicense++\n</code></pre>\n\n<p>how do I write this in proper vba syntax</p>\n"}, {"tags": ["vba", "excel", "ado"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1482901782, "post_id": 41355646, "comment_id": 69913057, "body": "In VBA, well designed loops are often the most efficient solution"}, {"owner": {"reputation": 49, "user_id": 7341375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d805e404325c951b0587bf0d445a1?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/7341375/damien"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1482902008, "post_id": 41355646, "comment_id": 69913143, "body": "@chrisneilsen the problem is i can not have 4 loops running together to match data, one from ADO variant, another from second worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1482902263, "post_id": 41355646, "comment_id": 69913239, "body": "<code>Filter()</code> See help."}, {"owner": {"reputation": 49, "user_id": 7341375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d805e404325c951b0587bf0d445a1?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/7341375/damien"}, "edited": false, "score": 0, "creation_date": 1482903326, "post_id": 41355646, "comment_id": 69913612, "body": "@Noodles In its description, it says, &quot;The function will throw an error if the sourcearray is either Null or multidimensional&quot;. In my case the array is multidimensional."}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 1, "creation_date": 1482910442, "post_id": 41355646, "comment_id": 69916335, "body": "how is this being generated, and what is the overall process here?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1483087756, "post_id": 41355646, "comment_id": 69988383, "body": "Have you tried the loops to see what the performance is (your array is not very large)? Why do you say you cannot have 4 loops running together?"}, {"owner": {"reputation": 49, "user_id": 7341375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d805e404325c951b0587bf0d445a1?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/7341375/damien"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1483329784, "post_id": 41355646, "comment_id": 70047806, "body": "@MacroMarc It is generated from an excel database where i have got 9 columns and 175 rows, using ADO and sql query. I am using getrows() method to get this variant. the problem is to access the entire row based on some columns by either finding or matching operation, if it does exist."}, {"owner": {"reputation": 49, "user_id": 7341375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d805e404325c951b0587bf0d445a1?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/7341375/damien"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1483329931, "post_id": 41355646, "comment_id": 70047826, "body": "@ChipsLetten I am not really sure but may be because of formatting the excel even takes time to open. array might not be large but the comparison of data (rows and columns) in two different workbooks shall have the need for 4 loops to iterate through each row and column.&#39;"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1483358992, "post_id": 41355646, "comment_id": 70058493, "body": "It is best for a question to show the code that is being used around the problem part. Then we can help to fill in code. Couldn&#39;t you just return the desired rows from a SQL subquery an transform into another recordset?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7341375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d805e404325c951b0587bf0d445a1?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/7341375/damien"}, "edited": false, "score": 0, "creation_date": 1483330185, "post_id": 41356227, "comment_id": 70047866, "body": "I don&#39;t want to search for a row by indexing! i need to take the data of the row by searching for particular columns in that row. Hope it makes it clear to you now."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1482904866, "creation_date": 1482904866, "answer_id": 41356227, "question_id": 41355646, "link": "https://stackoverflow.com/questions/41355646/is-there-any-direct-api-to-find-the-matching-items-for-the-same-index-in-a-varia/41356227#41356227", "title": "Is there any direct API to find the matching items for the same index in a variant of the order var(a,b)?", "body": "<p>It's not clear to me what you're trying to do exactly, but if you know the row-number in the array that you want the entire row from, then you can use the <code>Worksheet.Index</code> function.</p>\n\n<p>Here's an example using a dummy 2D array:</p>\n\n<pre><code>Sub test()\n\n  'Assign a 2D array\n  Dim my2DArray() As Variant\n  my2DArray() = [{1,2,3;4,5,6;7,8,9}]\n\n  Const DESIRED_ROW As Long = 2\n\n  'Use the Worksheet.Index function to extract an individual row\n  Dim myRow() As Variant\n  myRow = Application.WorksheetFunction.Index(my2DArray, DESIRED_ROW, 0)\n\n  Debug.Print Join(myRow, \",\") 'Prints 4,5,6\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 7341375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/900d805e404325c951b0587bf0d445a1?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/7341375/damien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482904866, "creation_date": 1482901506, "question_id": 41355646, "link": "https://stackoverflow.com/questions/41355646/is-there-any-direct-api-to-find-the-matching-items-for-the-same-index-in-a-varia", "title": "Is there any direct API to find the matching items for the same index in a variant of the order var(a,b)?", "body": "<p>I've got a variant let's say <strong>var(9,175)</strong> (obtained using ADO object for reading excel) where 9 represents the columns and 175 represents the rows, filled with some data. </p>\n\n<ol>\n<li>How can I retrieve entire row data (for each column value the row number will be same, obvious) based on 3 columns (for the same row) taken from other workbook. So, the matching keys will be these 3 column values from other workbook.</li>\n<li>I don't want to perform the looping operation, as it'll be time-consuming.</li>\n</ol>\n\n<p>Example: In variant <strong>var</strong> I've got some data at <strong>2nd</strong> row as:</p>\n\n<pre><code>#125    a    [68]    :1    [197]    :2    1    1645    123\n</code></pre>\n\n<p>From other workbook, I took the data as:</p>\n\n<pre><code>[68]    :1    [197]\n</code></pre>\n\n<p>Based on these 3 values,\nHow can I directly get the data of the 2nd row entirely based on some Find or Match commands?</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "transpose"], "answers": [{"tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": true, "score": 0, "last_activity_date": 1482897483, "creation_date": 1482897483, "answer_id": 41355139, "question_id": 41354981, "link": "https://stackoverflow.com/questions/41354981/transpose-columns-in-order-using-excel-vba/41355139#41355139", "title": "Transpose Columns in Order using Excel VBA", "body": "<p>you can achieve this by the below formula</p>\n\n<p><a href=\"https://i.stack.imgur.com/vN50r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vN50r.png\" alt=\"Screenshot\"></a></p>\n\n<pre><code>F1 = INDEX($A$1:$A$3,1+QUOTIENT(ROW()-ROW($F$1),3))\n\nG1 = VLOOKUP(F1,$A$1:$D$3,2+MOD(ROW()-ROW($F$1),3),FALSE)\n</code></pre>\n\n<p>So if you have 3000 lines of data, the formula should be dragged to 9000 rows.</p>\n"}], "owner": {"reputation": 7, "user_id": 4892842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-gGHQw4C-L9Y/AAAAAAAAAAI/AAAAAAAAABA/7vjUNkgPFXE/photo.jpg?sz=128", "display_name": "William Herrera", "link": "https://stackoverflow.com/users/4892842/william-herrera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41355139, "answer_count": 1, "score": -1, "last_activity_date": 1482897483, "creation_date": 1482895679, "question_id": 41354981, "link": "https://stackoverflow.com/questions/41354981/transpose-columns-in-order-using-excel-vba", "title": "Transpose Columns in Order using Excel VBA", "body": "<p>I have an extremely large amount of data needs to be transposed in order using the example on the image below. The left side of the image is how the information comes from the report, and the right side is what I need it to look like. </p>\n\n<p>I have tried to use the Transpose paste special but it results in 3000+ columns of information. I have also tried pivot tables but I get the information out of order.</p>\n\n<p>The three pieces of \"Info\" are per employee. As it stands now, the lines are vertically but in our end result we should have three rows per employee.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0MUmW.png\" rel=\"nofollow noreferrer\">Transpose Left Original Data Right Outcome Needed</a></p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 1, "creation_date": 1482894141, "post_id": 41354712, "comment_id": 69911442, "body": "shouldn&#39;t your sql statement be like <code>&quot; AND a.[Credited Office] = * &quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1482894132, "creation_date": 1482894132, "answer_id": 41354819, "question_id": 41354712, "link": "https://stackoverflow.com/questions/41354712/how-to-select-all-values-from-the-dropdown-or-select-only-individual-values-usin/41354819#41354819", "title": "How to select all values from the Dropdown or select only individual values using SQL query in VBA?", "body": "<p>If you want to send all items into the SQL then instead of e.g.:</p>\n\n<pre><code>AND a.[Credited Office] = '001 - Boston'\n</code></pre>\n\n<p>You need:</p>\n\n<pre><code>AND a.[Credited Office] IN ('001 - Boston', '002 - New York') 'etc\n</code></pre>\n\n<p>So if your input <code>E6</code> is empty the sample code is like below. Note the use of the <code>Transpose</code> function to convert a <code>Range</code> to an <code>Array</code> so you can use the <code>Join</code> function.</p>\n\n<pre><code>If IsEmpty(Range(\"e6\")) Then\n    Reg = \" IN ('\" &amp; Join(WorksheetFunction.Transpose(Range(\"H8:H19\").Value), \"','\") &amp; \"')\"\nEnd If\n</code></pre>\n\n<p>You will have to adapt your code a little setting the <code>CommandText</code> to deal with the new <code>AND</code> clause. Note that if your list in <code>H8:H19</code> is, in fact, every option that occurs in your <code>Credited Office</code> field then you can just drop the <code>AND</code> statement altogether as you don't require a filter.</p>\n"}], "owner": {"reputation": 45, "user_id": 6700516, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/868ae7b54c403815c05c068712f1bcc5?s=128&d=identicon&r=PG&f=1", "display_name": "Shasti", "link": "https://stackoverflow.com/users/6700516/shasti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 41354819, "answer_count": 1, "score": 1, "last_activity_date": 1484229498, "creation_date": 1482893333, "last_edit_date": 1484229498, "question_id": 41354712, "link": "https://stackoverflow.com/questions/41354712/how-to-select-all-values-from-the-dropdown-or-select-only-individual-values-usin", "title": "How to select all values from the Dropdown or select only individual values using SQL query in VBA?", "body": "<p>I am trying to pull the sql table to my excel worksheet based on the dates and location entered by the user.</p>\n\n<p>Cell E6 has a data validation dropdown list of locations such as blank space, followed by Boston, Chicago, Houston, New York and LA. The list is defined from values in <code>H8:H19</code>.</p>\n\n<p>The following code actually works fine for the <code>Else</code> part, where the results are filter based on the location selected by the user other than blank space. </p>\n\n<p>But when the cell <code>E6</code> is empty i.e. when no location is selected it should output the data for all the locations. Any suggestions or opinions on this regard would be much appreciated. </p>\n\n<pre><code>If IsEmpty(Range(\"E6\")) Then Reg = Range(\"H8:H19\").Value Else Reg = Range(\"E6\").Value\n</code></pre>\n\n<p>My SQL query code that pulls the data to Excel is as follows:</p>\n\n<pre><code>     objMyCmd.CommandText = \" SELECT a.[RDT_FileID],a.[Master Policy Number], a.[Work item /Submission no#],a.[Insured Name], a.[Credited Office],\" &amp; _\n                                \" a.[Credited Underwriter], a.[Product Line], a.[Product Line Subtype], a.[Current Status], a.[Effective Date], a.[Expiry Date],  a.[Premium in USD $] \" &amp; _\n                                \" FROM  DB1.dbo.View_Property_Rater_Of_Record a \" &amp; _\n                                \" WHERE a.[Master Policy Number] Is Not Null \" &amp; _\n                                \" AND a.[RDT_FileID] is null \" &amp; _\n                                \" AND a.[Product Line Subtype] &lt;&gt;  '0102-Marine' \" &amp; _\n                                \" AND a.[Effective Date] &gt;= \" &amp; PED(0) &amp; \" and a.[Effective Date] &lt;= \" &amp; PED(1) &amp; \" \" &amp; _\n                                \" AND a.[Current Status] ='Bound' \" &amp; _\n                                \" AND a.[Credited Office] = '\" &amp; Reg &amp; \"'\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mYT6A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mYT6A.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7347940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116d32946a9d02ff7a5cd652bc258251?s=128&d=identicon&r=PG&f=1", "display_name": "Anderson Pimentel", "link": "https://stackoverflow.com/users/7347940/anderson-pimentel"}, "edited": false, "score": 0, "creation_date": 1482894543, "post_id": 41354760, "comment_id": 69911510, "body": "Sorry, pressed entedr before finishing the last comment. Anyway, Out look didn&#39;t read that, the e-mail wasn&#39;t even created this time and I have the Outlook Object Library active."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 1, "creation_date": 1482917354, "post_id": 41354760, "comment_id": 69919536, "body": "You won&#39;t get a better answer I fear... Check what&#39;s inside sCC and where the error occurs"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 13, "user_id": 7347940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116d32946a9d02ff7a5cd652bc258251?s=128&d=identicon&r=PG&f=1", "display_name": "Anderson Pimentel", "link": "https://stackoverflow.com/users/7347940/anderson-pimentel"}, "edited": false, "score": 0, "creation_date": 1482934926, "post_id": 41354760, "comment_id": 69929218, "body": "@AndersonPimentel -  Also you can&#39;t use <code>MailEnvelope</code> with Outlook. If you send the mail through the Outlook object the syntax is different. Look at Ron de Bruin&#39;s stuff more carefully to see the difference in syntax."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 13, "user_id": 7347940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116d32946a9d02ff7a5cd652bc258251?s=128&d=identicon&r=PG&f=1", "display_name": "Anderson Pimentel", "link": "https://stackoverflow.com/users/7347940/anderson-pimentel"}, "edited": false, "score": 0, "creation_date": 1482954584, "post_id": 41354760, "comment_id": 69939088, "body": "@AndersonPimentel see if this <a href=\"http://stackoverflow.com/a/38303646/4539709\">stackoverflow.com/a/38303646/4539709</a>"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1482893718, "creation_date": 1482893718, "answer_id": 41354760, "question_id": 41354597, "link": "https://stackoverflow.com/questions/41354597/pass-cell-value-to-to-and-cc/41354760#41354760", "title": "Pass cell value to .To and .CC", "body": "<p>Try this:</p>\n\n<pre><code>.To = Range(\"K1\")\nFor each cel in Range(\"M1:M4\")\n    Dim sCC as String\n    sCC = sCC &amp; \";\" &amp; cel.Value2\nNext\n.CC = Mid(sCC,2) 'to cut off initial \";\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7347940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/116d32946a9d02ff7a5cd652bc258251?s=128&d=identicon&r=PG&f=1", "display_name": "Anderson Pimentel", "link": "https://stackoverflow.com/users/7347940/anderson-pimentel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "accepted_answer_id": 41354760, "answer_count": 1, "score": 1, "last_activity_date": 1547008369, "creation_date": 1482892291, "last_edit_date": 1547008369, "question_id": 41354597, "link": "https://stackoverflow.com/questions/41354597/pass-cell-value-to-to-and-cc", "title": "Pass cell value to .To and .CC", "body": "<p>I send a range of cells from a workbook to Outlook.</p>\n\n<p>I've tweaked just a little bit the following macro from Ron de Bruin <a href=\"http://www.rondebruin.nl/win/s1/outlook/bmail3.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s1/outlook/bmail3.htm</a>.</p>\n\n<p>It's like this now (just the part that I've edited):</p>\n\n<pre><code>With Sendrng\n\n    .Parent.Select\n    Set rng = ActiveCell\n    .Select\n    ActiveWorkbook.EnvelopeVisible = True\n\n    With .Parent.MailEnvelope\n\n        With .Item\n            .To = \"\"\n            .CC = \"\"\n            .Subject = \"XXX\"\n            '.Attachments.Add (\"C:\\test.txt\")\n            .Display\n            .Save\n            .Close olPromtForSave\n        End With\n\n    End With\n</code></pre>\n\n<p>I want to set .To = \"K1\" and .CC = \"M1:M4\". These are cells from the same active workbook. Tweaking a little bit with the cell.Value and for For Each cell In Columns(\"K\") from this link didn't work <a href=\"http://www.rondebruin.nl/win/s1/outlook/bmail5.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s1/outlook/bmail5.htm</a>.</p>\n"}, {"tags": ["vba", "excel", "datetime"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2301233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b218d052c273c3f79abedfda4ec1ad36?s=128&d=identicon&r=PG", "display_name": "user2301233", "link": "https://stackoverflow.com/users/2301233/user2301233"}, "edited": false, "score": 0, "creation_date": 1482899967, "post_id": 41354634, "comment_id": 69912572, "body": "Thanks! This is exactly what I was looking for. It looks like you can&#39;t specify d/m/y 12:59 as the date type but I can use string format and then parse it later on."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 0, "last_activity_date": 1482892615, "creation_date": 1482892615, "answer_id": 41354634, "question_id": 41354534, "link": "https://stackoverflow.com/questions/41354534/how-does-workbooks-open-in-vba-differ-from-opening-the-file-manually/41354634#41354634", "title": "How does workbooks.open in vba differ from opening the file manually?", "body": "<p>Assuming the <code>.clb</code> format is a text file, you need to use the <code>Workbooks.OpenText</code> method (instead of <code>Workbooks.Open</code>), and specify your preferences for the delimiters, date formats and other settings.</p>\n"}], "owner": {"reputation": 13, "user_id": 2301233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b218d052c273c3f79abedfda4ec1ad36?s=128&d=identicon&r=PG", "display_name": "user2301233", "link": "https://stackoverflow.com/users/2301233/user2301233"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 41354634, "answer_count": 1, "score": 1, "last_activity_date": 1482892615, "creation_date": 1482891748, "question_id": 41354534, "link": "https://stackoverflow.com/questions/41354534/how-does-workbooks-open-in-vba-differ-from-opening-the-file-manually", "title": "How does workbooks.open in vba differ from opening the file manually?", "body": "<p>I have a .clb file that can be opened with excel through windows explorer with no issues. When I try to open the same .clb file through VBA with workbooks.open the dates in the file get messed up.<br>\nFor example 11/05/16 becomes 5/11/16. I must point out that this is not a format change, the format stays the same (d/mm/yy) but the date goes from 11th Mar to 5th Nov.<br>\nI assume the issue has something to do with format confusion somewhere along the way because the dates that cannot be confused with US format like 18/06/16 for example get converted to string format for some reason.<br>\nThese issues do not occur when vba is not used to open the workbook and I have reduced my code down to a single line to make sure there are no unwanted interactions:<br>\n <code>Workbooks.Open Filename:=\"G:\\C_001S01.clb\"</code><br>\nand the issue still persists.<br>\nIs there some other function I can use to open the .clb in vba that will not mess with the dates? or a way to prevent workbooks.open from messing them up?</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1482891041, "post_id": 41354340, "comment_id": 69910814, "body": "When do you want it to be generated?  If it is generated as soon as the worksheet is created, you will end up with a lot of cells saying &quot;1 January 1900&quot;.  (Could you just put the formula <code>=C6+D6</code> into cell E6, etc, and allow the users to overtype the value as necessary, or is the intention that the users will update &quot;Start Date&quot; or &quot;Duration&quot; and you don&#39;t want &quot;Planned End Date&quot; to change from when those cells were originally populated?)"}, {"owner": {"reputation": 71, "user_id": 6952342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IlSkE.jpg?s=128&g=1", "display_name": "hotseetotsee", "link": "https://stackoverflow.com/users/6952342/hotseetotsee"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482891698, "post_id": 41354340, "comment_id": 69910955, "body": "I want the end date to generate each time the start date and duration cell are filled in and if it is possible, I do not want the user to overtype the value populated for the planned end date."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482891904, "post_id": 41354340, "comment_id": 69910996, "body": "So, just to be sure of what you are asking, if a user enters a date of 1 January 2017 into cell C10, and then enters a duration of 1000 into cell D10, you want cell E10 to be set to 28 September 2019.  And then, when the user realises that they only meant to put 100 (and not 1000) in cell D10, you want E10 to remain at 28 September 2019?"}, {"owner": {"reputation": 71, "user_id": 6952342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IlSkE.jpg?s=128&g=1", "display_name": "hotseetotsee", "link": "https://stackoverflow.com/users/6952342/hotseetotsee"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482892213, "post_id": 41354340, "comment_id": 69911056, "body": "I want it to be automate. The end date will auto generate after user input both start date and duration. I read about worksheet_change event. But I got error when I try using Private Sub Worksheet_Change(ByVal Target As Range). The end date will change if the user change the duration value. Thats what I tried to achieve"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1482892521, "post_id": 41354340, "comment_id": 69911113, "body": "If you want the end date to be updated to reflect the start date / duration from time to time, I think you want to just use a formula of <code>=IF(OR(C6=&quot;&quot;,D6=&quot;&quot;),&quot;&quot;,C6+D6)</code> in cell E6 and copy it down to all other cells in column E.  Your code as it currently stands (and as you are asking for) will set the value to a constant and then never change it once it is set (because you specifically say <code>If Cells(MyRow, &quot;E&quot;).Value = &quot;&quot; Then</code>) - which means errors will forever remain errors."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 7333773, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2d5071fd71e805a4601225531b0d08f?s=128&d=identicon&r=PG", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/7333773/swapnil"}, "is_accepted": false, "score": 0, "last_activity_date": 1482911115, "last_edit_date": 1482911115, "creation_date": 1482910766, "answer_id": 41357518, "question_id": 41354340, "link": "https://stackoverflow.com/questions/41354340/vba-auto-add-the-duration-to-start-date-to-generate-the-end-date/41357518#41357518", "title": "VBA Auto-add the duration to start date to generate the end date", "body": "<p>I consider your data is like as below</p>\n\n<pre><code>ID  Task Description    Start Date    Duration  Planned End Date\n1   subtask1            5-Dec-16           5    \n2   subtask2            22-Dec-16          6    \n3   subtask3            1-Dec-16           33   \n4   subtask4           21-Dec-16           12   \n5   subtask5           4-Jan-16            6\n</code></pre>\n\n<p>Put the below code in sheet module where you want perform the operation</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf (Target.Column = 3 Or Target.Column = 4) And Target.Row &gt;= 2 Then\n\n\n    If Cells(Target.Row, 3) = vbNullString Or Cells(Target.Row, 4) = vbNullString Then\n\n    Else\n        Cells(Target.Row, 5).Value = Cells(Target.Row, 3).Value + Cells(Target.Row, 4).Value\n    End If\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>It generate the output every time when you enter the data in column start date or Duration. </p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6952342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IlSkE.jpg?s=128&g=1", "display_name": "hotseetotsee", "link": "https://stackoverflow.com/users/6952342/hotseetotsee"}, "edited": false, "score": 0, "creation_date": 1482992701, "post_id": 41357542, "comment_id": 69950081, "body": "Thank you so much for this!! It works perfectly. Looking at your code, I now understand better on how to integrate the sub code with the worksheet_change event."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1482910843, "creation_date": 1482910843, "answer_id": 41357542, "question_id": 41354340, "link": "https://stackoverflow.com/questions/41354340/vba-auto-add-the-duration-to-start-date-to-generate-the-end-date/41357542#41357542", "title": "VBA Auto-add the duration to start date to generate the end date", "body": "<p>Although I recommend that you just use a formula in column E (e.g. E6 would have <code>=IF(OR(C6=\"\",D6=\"\"),\"\",C6+D6)</code>), the following <code>Worksheet_Change</code> event possibly does what you have asked for.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim c As Range\n    Dim o As Integer\n    Application.EnableEvents = False\n    'Don't do anything unless something changed in columns C or D\n    If Not Intersect(Target, Columns(\"C:D\")) Is Nothing Then\n        'Process all changed cells in columns C and D\n        For Each c In Intersect(Target, Columns(\"C:D\"))\n            With c\n                'Ensure that we are on row 6 or later, and\n                'column E is empty, and\n                'neither column C or column D is empty\n                If .Row &gt; 5 And _\n                   IsEmpty(Cells(.Row, \"E\").Value) And _\n                   Not (IsEmpty(Cells(.Row, \"C\").Value) Or IsEmpty(Cells(.Row, \"D\").Value)) Then\n                    'Ensure that column C contains a date, and\n                    'column D contains a numeric value\n                    If IsDate(Cells(.Row, \"C\").Value) And _\n                       IsNumeric(Cells(.Row, \"D\").Value) Then\n                        'Calculate planned end date\n                        Cells(.Row, \"E\").Value = CDate(Cells(.Row, \"C\").Value + Cells(.Row, \"D\").Value)\n                    End If\n                End If\n            End With\n        Next\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Note that a change to a cell in column C or D will <strong>not</strong> recalculate the value in column E unless you remove the bit that says <code>IsEmpty(Cells(.Row, \"E\").Value) And _</code>.  (But, if you do that, you may as well just use the formula I recommended.)</p>\n"}], "owner": {"reputation": 71, "user_id": 6952342, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IlSkE.jpg?s=128&g=1", "display_name": "hotseetotsee", "link": "https://stackoverflow.com/users/6952342/hotseetotsee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 41357542, "answer_count": 2, "score": 1, "last_activity_date": 1482911115, "creation_date": 1482889805, "question_id": 41354340, "link": "https://stackoverflow.com/questions/41354340/vba-auto-add-the-duration-to-start-date-to-generate-the-end-date", "title": "VBA Auto-add the duration to start date to generate the end date", "body": "<p>I am trying to generate my end date based on the start date and duration in the table. My table are as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/T82u0.png\" rel=\"nofollow noreferrer\">Table column for ID, Task Desc, Start Date, Duration, Planned End Date is A,B,C,D,E respectively</a></p>\n\n<p>I have tried to run the VBA code as follows but it will only generate the end date when I run the sub. How do I make it as auto-generate? The code are as follows:</p>\n\n<pre><code>Sub PlannedEndDate()\n\nDim userInputDate As Date\nDim duration As Integer\nDim endDate As Date\n\nDim MyRow As Long\n\n'Start at row 6\nMyRow = 6\n'Loop untill column A is empty (no task)\nWhile Cells(MyRow, \"A\").Value &lt;&gt; \"\"\n    'Only if not yet filled in.\n    If Cells(MyRow, \"E\").Value = \"\" Then\n        'Fetch info\n        userInputDate = Cells(MyRow, \"C\").Value\n        duration = Cells(MyRow, \"D\").Value\n        endDate = DateAdd(\"d\", duration, userInputDate)\n        'Put it back on the sheet\n        Cells(MyRow, \"E\").Value = endDate\n    End If\n    MyRow = MyRow + 1\nWend\nEnd Sub\n</code></pre>\n\n<p>Many thanks.</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482886206, "post_id": 41353952, "comment_id": 69909951, "body": "See if the problem goes away when you qualify which worksheets <code>Cells</code>, <code>Range</code>, <code>Rows</code>, etc refer to.  By default they refer to the active worksheet.  (And a <code>With Worksheets(&quot;x&quot;)</code> block does not make &quot;x&quot; the active sheet!  It&#39;s just a shortcut so that you can type <code>.</code> instead of <code>Worksheets(&quot;x&quot;).</code>)  And I don&#39;t think <code>Workbooks(&quot;Weekly Sales Dashboard&quot;).Worksheets(&quot;Roll_12&quot;).EntireRow</code> will be valid either - it&#39;s probably meant to be <code>Workbooks(&quot;Weekly Sales Dashboard&quot;).Worksheets(&quot;Roll_12&quot;).Rows(lngLoop).EntireRow</code> (which can be shortcutted to <code>.Rows(lngLoop).EntireRow</code>)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482887132, "post_id": 41353952, "comment_id": 69910103, "body": "Oh - just saw your display name - does that imply that &quot;Ian&quot; is your actual name?  That&#39;s an exceptionally good name!!  ;)"}, {"owner": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482948085, "post_id": 41353952, "comment_id": 69936147, "body": "haha thank you! i hate coming up with usernames... so many to keep track of.. i got the code to work thanks to Yow. appreciate the help!"}, {"owner": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482948253, "post_id": 41353952, "comment_id": 69936225, "body": "Since you all were so helpful on this, maybe you want to help on a real puzzler i have open on another thread for another sheet on this workbook...  @YowE3K            [link] <a href=\"http://stackoverflow.com/questions/41214271/look-up-match-then-multiply-across-tabs-and-replace-active-cell/41226789?noredirect=1#comment69833128_41226789\" title=\"look up match then multiply across tabs and replace active cell\">stackoverflow.com/questions/41214271/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "edited": false, "score": 0, "creation_date": 1482948032, "post_id": 41354030, "comment_id": 69936118, "body": "well i had to adjust the Destination:=ws2.Range(&quot;A:A&quot; &amp; ws2.Rows.Count). to just be &quot;A&quot; instead of &quot;A:A&quot; because i was getting an error. but it works now. will really put it to the test when i get Q1 wins rolling in. thanks!!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "edited": false, "score": 0, "creation_date": 1482950642, "post_id": 41354030, "comment_id": 69937376, "body": "@IFianTHENdisplayname - Oops - sorry - I missed that error.  Your correction is exactly correct, and I will update the answer to include it."}, {"owner": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "edited": false, "score": 0, "creation_date": 1482956058, "post_id": 41354030, "comment_id": 69939713, "body": "so i have two of these subs for different tabs. i have run them and they both work great. however, after running the last one, my workbook is sooooooo slow. its taking several minutes for me to select a cell. i know all this code on a single workbook bogs it down but i feel like it is still trying to run something in the background. can i clean it up somehow? Note: i did add <code>With ws2 .Rows(4 &amp; &quot;:&quot; &amp; .Rows.Count).Delete End With</code> because i wanted to delete the previous results and couldnt figure out how to paste multiple rows in a range overwriting what is already there"}, {"owner": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "edited": false, "score": 0, "creation_date": 1482956155, "post_id": 41354030, "comment_id": 69939755, "body": "another problem i have is when i adjusted it to another sheet but the exact same process the &quot;no wins this week&quot; shows up everytime even though the code is literally exactly the same. whats the troubleshoot for that? it works properly on the other sheet?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "edited": false, "score": 0, "creation_date": 1482956497, "post_id": 41354030, "comment_id": 69939906, "body": "@IFianTHENdisplayname - that edit will be attempting to delete about 1 million rows - change <code>.Rows(4 &amp; &quot;:&quot; &amp; .Rows.Count).Delete</code> to <code>.Range(&quot;A4:A&quot; &amp; .Cells(.Rows.Count,&quot;A&quot;).End(xlUp).Row).EntireRow.ClearConten&zwnj;&#8203;ts</code>.  (That will just clear the contents without deleting formats, etc, but should be fine for your purpose and will be faster.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "edited": false, "score": 0, "creation_date": 1482956865, "post_id": 41354030, "comment_id": 69940044, "body": "@IFianTHENdisplayname - as for why it doesn&#39;t work on a different sheet ... I&#39;m not sure.  Is it copying rows to the destination sheet, while still saying &quot;No wins&quot;?  If so, all I can suggest is that you step through the code in debug mode and see what it is doing.  (It must be clearing <code>WinFound</code> for some reason.)  If it isn&#39;t copying any rows, I suggest that one of the tests that you have isn&#39;t matching correctly, so step through until you get to a line that you think should match, then check the variables being used in the <code>If</code> statement to see if they are what you think they should be."}, {"owner": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "edited": false, "score": 0, "creation_date": 1482958603, "post_id": 41354030, "comment_id": 69940756, "body": "thanks for the tip! i imagine deleting 1m rows is draining. and i will re-check the no wins code. ill revert with any more issues i cannot figure out myself."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1482950674, "last_edit_date": 1482950674, "creation_date": 1482886615, "answer_id": 41354030, "question_id": 41353952, "link": "https://stackoverflow.com/questions/41353952/copy-whole-row-across-workbooks-based-on-multiple-criteria/41354030#41354030", "title": "Copy whole row across workbooks based on multiple criteria", "body": "<p>Try the following as a replacement for your \"Suggestion 1\":</p>\n\n<pre><code>Sub WinsUpdate()\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim lngLoop As Long\n    lngLoop = 1\n    Application.ScreenUpdating = False\n    Set wb1 = Workbooks(\"Weekly Sales Dashboard\")\n    Set wb2 = Workbooks(\"Monday Sales Meeting Data\")\n    Set ws1 = wb1.Sheets(\"Roll_12\")\n    Set ws2 = wb2.Sheets(\"Sales Weekly Wins\")\n    Set wk1 = ws2.Range(\"C2\")\n    With Workbooks(\"Weekly Sales Dashboard\").Worksheets(\"Roll_12\")\n        For lngLoop = 2 To .Cells(.Rows.Count, 5).End(xlUp).Row ' Changed to avoid looking at a million rows\n            If .Cells(lngLoop, 5).Value = \"USA - Chicago\" And _\n               .Cells(lngLoop, 9).Value = \"Closed/Won\" And _\n               .Cells(lngLoop, 18).Value = wk1 Then\n                .Rows(lngLoop).EntireRow.Copy Destination:=ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Offset(1)\n            Else\n                ws2.Range(\"F1\") = \"No wins this week\"\n            End If\n        Next lngLoop\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I am <strong>guessing</strong> that the <code>Cells</code>, etc, inside your <code>With</code> block were meant to refer to the worksheet named in the <code>With</code> block.  If that's not the case, you should correctly qualify them with the worksheet that they do refer to.</p>\n\n<hr>\n\n<p>Edit to stop \"No wins this week\" showing except when no rows satisfy criteria:</p>\n\n<pre><code>Sub WinsUpdate()\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim wb1 As Workbook, wb2 As Workbook\n    Dim lngLoop As Long\n    Dim WinFound as Boolean\n    lngLoop = 1\n    Application.ScreenUpdating = False\n    Set wb1 = Workbooks(\"Weekly Sales Dashboard\")\n    Set wb2 = Workbooks(\"Monday Sales Meeting Data\")\n    Set ws1 = wb1.Sheets(\"Roll_12\")\n    Set ws2 = wb2.Sheets(\"Sales Weekly Wins\")\n    Set wk1 = ws2.Range(\"C2\")\n    With ws1\n        WinFound = False\n        For lngLoop = 2 To .Cells(.Rows.Count, 5).End(xlUp).Row ' Changed to avoid looking at a million rows\n            If .Cells(lngLoop, 5).Value = \"USA - Chicago\" And _\n               .Cells(lngLoop, 9).Value = \"Closed/Won\" And _\n               .Cells(lngLoop, 18).Value = wk1 Then\n                .Rows(lngLoop).EntireRow.Copy Destination:=ws2.Range(\"A\" &amp; ws2.Rows.Count).End(xlUp).Offset(1)\n                WinFound = True\n            End If\n        Next lngLoop\n        If Not WinFound Then\n            ws2.Range(\"F1\") = \"No wins this week\"\n        End If\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7314356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c1bbc9da37237b7bdc9f36f4609848d?s=128&d=identicon&r=PG&f=1", "display_name": "IFianTHENdisplayname", "link": "https://stackoverflow.com/users/7314356/ifianthendisplayname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594205633, "creation_date": 1482885680, "last_edit_date": 1594205633, "question_id": 41353952, "link": "https://stackoverflow.com/questions/41353952/copy-whole-row-across-workbooks-based-on-multiple-criteria", "title": "Copy whole row across workbooks based on multiple criteria", "body": "<p>piecing together bits of code i found and i have two options that both give me errors. I know the answer is obvious but i can't seem to find it...</p>\n\n<p>Error always appears on the \"IF\" code line on debugger, usually on \"_Global\" mismatch or etc.</p>\n\n<p>Search for a match in a different workbook based on 3 criteria. if all three are a match then copy the whole row to the next available row in the current workbook.</p>\n\n<p>There could be zero matches or there could be many on a given run (that's why there is that \"no wins this week\"). also it would be nice when i run this that it writes over the saved results of last time. (i can deal with that later).</p>\n\n<p>\"wk1\" is a forumla in a cell that give the week number based on =today()-14 </p>\n\n<p>my headers for columns on destination worksheet are on row 3. data to check in other workbook starts on row 2. Data to check is column A:AN, row2 to end ('000s).</p>\n\n<p>Suggestion 1, lngLoop:</p>\n\n<pre><code>Sub WinsUpdate()\nDim ws1 As Worksheet, ws2 As Worksheet\nDim wb1 As Workbook, wb2 As Workbook\nDim lngLoop As Long\n    lngLoop = 1\nApplication.ScreenUpdating = False\nSet wb1 = Workbooks(\"Weekly Sales Dashboard\")\nSet wb2 = Workbooks(\"Monday Sales Meeting Data\")\nSet ws1 = wb1.Sheets(\"Roll_12\")\nSet ws2 = wb2.Sheets(\"Sales Weekly Wins\")\nSet wk1 = ws2.Range(\"C2\")\nWith Workbooks(\"Weekly Sales Dashboard\").Worksheets(\"Roll_12\")\n    For lngLoop = 1 To Rows.Count\n    If Cells(lngLoop, 5).Value = \"USA - Chicago\" And Cells(lngLoop, 9).Value = \"Closed/Won\" And Cells(lngLoop, 18).Value = wk1 Then\n        .EntireRow.Copy Destination:=ws2.Range(\"A:A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        Else: ws2.Range(\"F1\") = \"No wins this week\"\n    End If\n    Next lngLoop\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Suggestion 2:</p>\n\n<pre><code>Sub WinsUpdate()\nDim ws1 As Worksheet, ws2 As Worksheet\nDim wb1 As Workbook, wb2 As Workbook\nApplication.ScreenUpdating = False\nSet wb1 = Workbooks(\"Weekly Sales Dashboard\")\nSet wb2 = Workbooks(\"Monday Sales Meeting Data\")\nSet ws1 = wb1.Sheets(\"Roll_12\")\nSet ws2 = wb2.Sheets(\"Sales Weekly Wins\")\nSet wk1 = ws2.Range(\"C2\")\nWith Workbooks(\"Weekly Sales Dashboard\").Worksheets(\"Roll_12\")\n    If Range(\"E:E\").Value = \"USA - Chicago\" And Range(\"L:L\").Value = \"Closed/Won\" And Range(\"R:R\").Value = wk1 Then\n        .EntireRow.Copy Destination:=ws2.Range(\"A:A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        Else: ws2.Range(\"F1\") = \"No wins this week\"\n    End If\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1482885375, "post_id": 41353904, "comment_id": 69909788, "body": "Use <code>CallByName</code> or <code>Application.Run</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 583, "user_id": 732256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XlWXG.jpg?s=128&g=1", "display_name": "Kar.ma", "link": "https://stackoverflow.com/users/732256/kar-ma"}, "edited": false, "score": 0, "creation_date": 1590775207, "post_id": 41353996, "comment_id": 109818906, "body": "Thanks for pointing me to the right direction. I just needed to change <code>Call mySub(myParameter)</code> into <code>Application.Run &quot;mySub&quot;, myParameter</code>"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1482886228, "creation_date": 1482886228, "answer_id": 41353996, "question_id": 41353904, "link": "https://stackoverflow.com/questions/41353904/i-would-like-to-prevent-excel-vba-for-checking-for-the-existence-of-a-procedure/41353996#41353996", "title": "I would like to prevent Excel VBA for checking for the existence of a procedure", "body": "<p>Try this:</p>\n\n<pre><code> Set vbcomp = ThisWorkbook.VBProject.VBComponents.Import(\"C:\\somefile.bas\")\n Application.Run vbcomp.Name &amp; \".\" &amp; \"sub_which_only_exists_after_the_above_import\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7347556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599587a578002766a5cdbe40576eb6bd?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/7347556/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 41353996, "answer_count": 1, "score": 0, "last_activity_date": 1482888328, "creation_date": 1482885245, "last_edit_date": 1531164843, "question_id": 41353904, "link": "https://stackoverflow.com/questions/41353904/i-would-like-to-prevent-excel-vba-for-checking-for-the-existence-of-a-procedure", "title": "I would like to prevent Excel VBA for checking for the existence of a procedure", "body": "<p>Is it possible to prevent Excel VBA from checking for the existence of procedures before running.</p>\n\n<p>I would like to run a programme like this:</p>\n\n<pre><code>VBProj.VBComponents.Import \"C:\\somefile.bas\"  \nCall sub_which_only_exists_after_the_above_import()\n</code></pre>\n\n<p>But I get the following:<br>\n\"Compile Error<br>\n Sub or function not defined\"\nand the \"Call\" line is highlighted.</p>\n\n<p>I've searched google but not found anything helpful.</p>\n\n<p>Thanks in advance for your help.\nCheers\nGeoff.</p>\n"}, {"tags": ["vba", "excel", "email", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7347637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54424626e59990302c63947dbe9297de?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Sousa", "link": "https://stackoverflow.com/users/7347637/igor-sousa"}, "edited": false, "score": 0, "creation_date": 1482889082, "post_id": 41353949, "comment_id": 69910456, "body": "Thanks for the quick reply! Regarding the checkboxes the code worked perfectly (many thanks), but I do not know why Excel is ignoring the semicolon. The result in Outlook&#39;s &quot;To&quot; field looks like this:  <code>email1@example.comemail2@example.comemail4@example.com</code>  The emails are not being separated by semicolons."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 13, "user_id": 7347637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54424626e59990302c63947dbe9297de?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Sousa", "link": "https://stackoverflow.com/users/7347637/igor-sousa"}, "edited": false, "score": 0, "creation_date": 1482889303, "post_id": 41353949, "comment_id": 69910496, "body": "@IgorSousa Ahh - Maybe the <code>outlookMail</code> object automatically trims off any trailing <code>;</code>.   I&#39;ll edit the code to use a temporary variable."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1482889382, "last_edit_date": 1482889382, "creation_date": 1482885644, "answer_id": 41353949, "question_id": 41353901, "link": "https://stackoverflow.com/questions/41353901/excel-vba-verify-if-the-checkboxes-are-selected-and-concatenate-respective-tex/41353949#41353949", "title": "Excel VBA - Verify if the checkboxes are selected and concatenate respective textboxes&#39;s values", "body": "<p>Change</p>\n\n<pre><code>.To = \"\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Dim TempTo As String\nTempTo = \"\"\nIf CkboxEmail1 Then TempTo = TempTo &amp; TxtEmail1.value &amp; \";\"\nIf CkboxEmail2 Then TempTo = TempTo &amp; TxtEmail2.value &amp; \";\"\nIf CkboxEmail3 Then TempTo = TempTo &amp; TxtEmail3.value &amp; \";\"\nIf CkboxEmail4 Then TempTo = TempTo &amp; TxtEmail4.value &amp; \";\"\nIf CkboxEmail5 Then TempTo = TempTo &amp; TxtEmail5.value &amp; \";\"\n</code></pre>\n\n<p>And probably add one extra bit of code after that, to prevent issues where no CkBox is checked:</p>\n\n<pre><code>If Len(TempTo) = 0 Then\n    MsgBox \"No email addresses selected\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>And finally:</p>\n\n<pre><code>.To = TempTo\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7347637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54424626e59990302c63947dbe9297de?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Sousa", "link": "https://stackoverflow.com/users/7347637/igor-sousa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 41353949, "answer_count": 1, "score": 1, "last_activity_date": 1482889382, "creation_date": 1482885228, "question_id": 41353901, "link": "https://stackoverflow.com/questions/41353901/excel-vba-verify-if-the-checkboxes-are-selected-and-concatenate-respective-tex", "title": "Excel VBA - Verify if the checkboxes are selected and concatenate respective textboxes&#39;s values", "body": "<p>I am a beginner in Excel VBA and would like some help, please.</p>\n\n<p>In a customer registration userform I have a \"contacts\" section, which will be reserved to receive up to 5 contact emails for the customer that is being registered. In this userform I have the following objects:</p>\n\n<ul>\n<li>5 text boxes (<code>txtEmail1</code>, <code>txtEmail2</code>, <code>txtEmail3</code>, ...)</li>\n<li>5 checkboxes (<code>ckboxEmail1</code>, <code>ckboxEmail2</code>, <code>ckboxEmail3</code>, ...)</li>\n<li>1 commandbutton (<code>bSendEmail</code>)</li>\n</ul>\n\n<p>The emails will be typed in the text boxes and the button will be used to open Outlook Application with the emails already in the \"To\" field. The checkboxes will be used to define which emails will be included in the \"To\" field.</p>\n\n<p>Here comes my doubt. How can I verify which checkboxes are checked, to use (concatenate) only their emails from text boxes?</p>\n\n<p>Practical Example 1:</p>\n\n<pre><code>TxtEmail1.value = email1@example.com\nTxtEmail2.value = email2@example.com\nTxtEmail3.value = empty\nTxtEMail4.value = email4@example.com\nTxtEMail5.value = empty\n\nCkboxEmail1.value = true\nCkboxEmail2.value = true\nCkboxEmail3.value = false\nCkboxEmail4.value = true\nCkboxEmail5.value = false\n</code></pre>\n\n<p>When I do press the button, the following array must be passed to the \".To\" property:</p>\n\n<pre><code>.To = \"email1@example.com;email2@example.com;email4@example.com\"\n</code></pre>\n\n<p>Practical example 2:</p>\n\n<pre><code>TxtEmail1.value = email1@example.com\nTxtEmail2.value = email2@example.com\nTxtEmail3.value = empty\nTxtEMail4.value = email4@example.com\nTxtEMail5.value = empty\n\nCkboxEmail1.value = false\nCkboxEmail2.value = false\nCkboxEmail3.value = false\nCkboxEmail4.value = true\nCkboxEmail5.value = false\n</code></pre>\n\n<p>When I do press the button, only the 4th email will be passed to the \".To\" property, because only its checkbox is true:</p>\n\n<pre><code>.To = \"email4@example.com\"\n</code></pre>\n\n<p>Bellow is the code I'm using to open Outlook Application in the bSendEmail Click event.</p>\n\n<pre><code>Private Sub bSendEmail_Click()\n\nDim outlookApp       As Object\nDim outlookMail      As Object\n\nOn Error GoTo error_outlook\nSet outlookApp = CreateObject(\"Outlook.Application\")\nSet outlookMail = outlookApp.CreateItem(0)\nOn Error GoTo 0\n\nOn Error Resume Next\nWith outlookMail\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"\"\n    .Body = \"\"\n    .Importance = 2\n    .Display\nEnd With\nOn Error GoTo 0\n\nSet outlookMail = Nothing\nSet outlookApp = Nothing\n\nExit Sub\n\nerror_outlook:\n\n    MsgBox(\"some message here...\", vbOKOnly + vbExclamation, \"ERROR - Outlook\")\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance and sorry about the bad English, is not my native language.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1482888865, "post_id": 41353857, "comment_id": 69910407, "body": "Everything you need to know about pivot tables and VBA (or pretty close to it). <a href=\"https://www.thespreadsheetguru.com/blog/2014/9/27/vba-guide-excel-pivot-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/9/27/&hellip;</a>"}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "reply_to_user": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1482888952, "post_id": 41353857, "comment_id": 69910434, "body": "Found that. OK, now I know I&#39;m on the right track."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482947570, "post_id": 41353857, "comment_id": 69935876, "body": "@monty327 did you find a solution for your question ? or do you need assistance ?"}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 0, "creation_date": 1482957222, "post_id": 41353857, "comment_id": 69940203, "body": "I&#39;m creating a loop that will generate the .PivotItem statements that I need for the entire record set. But I wouldn&#39;t mind additional suggestions."}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 0, "creation_date": 1482969605, "post_id": 41353857, "comment_id": 69944565, "body": "I added how I have attempted to address this problem.  Each &#39;slide&#39; will have randomly different Pivot items selected so it means that the entire list needs to be addressed each time.  I created a VisibleList function that produces the entire list (100 items) even though only 1 or 2 items are selected."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484053432, "post_id": 41353857, "comment_id": 70343098, "body": "@monty327 have you tried my code in my answer below ? any feedbacks ?"}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 0, "creation_date": 1484061475, "post_id": 41353857, "comment_id": 70348922, "body": "Yes. I had to put this on hold. Your answer has given me a partial idea to the present solution.  But I wanted to post exactly what I did. I will do that before marking it &quot;answered&quot;. Thank you."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484199974, "post_id": 41353857, "comment_id": 70413816, "body": "@monty327 that&#39;s not correct, you took my answer, and instread of marking my answer as &quot;ANSWER&quot; , you copied the code, added other code line to your code (that were not part of your  post), and then posted it as your answer (not giving the credit to mine) - not entirely fair, right ?"}, {"owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "edited": false, "score": 1, "creation_date": 1484201340, "post_id": 41353857, "comment_id": 70414321, "body": "You are correct because my question does not say what I wanted to do.  You DID give the answer how to filter a Pivot table. Thank you for your answer."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1484201754, "post_id": 41353857, "comment_id": 70414454, "body": "@monty327 thanks for accepting :)"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1483025374, "creation_date": 1483025374, "answer_id": 41382662, "question_id": 41353857, "link": "https://stackoverflow.com/questions/41353857/writing-vba-to-filter-pivot-table-items-in-excel/41382662#41382662", "title": "Writing VBA to filter pivot table items in Excel", "body": "<p>Not sure this is what you mean, but give the code below a shot:</p>\n\n<pre><code>Option Explicit\n\nSub FilterPivotItems()\n\nDim PvtTbl As PivotTable\nDim PvtFld  As PivotField\nDim PvtItm  As PivotItem\n\n' set Pivot Table\nSet PvtTbl = ActiveSheet.PivotTables(\"PivotTable1\")\n\n' set Pivot Field to \"COB_TITLE\"\nSet PvtFld = PvtTbl.PivotFields(\"COB_TITLE\")\n\n' loop through all Pivot Items in \"COB_TITLE\" Pivot Field\nFor Each PvtItm In PvtFld.PivotItems\n\n    ' check what is the Pivot item Name\n    Select Case PvtItm.Name\n        Case \"CMD GRP\", \"G1\", \"G2\"  ' &lt;-- visible Filter Items list\n            PvtItm.Visible = True\n\n        Case Else\n            PvtItm.Visible = False\n\n    End Select\nNext PvtItm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4114914, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/34266fce4775945c2311e4cc9e78d214?s=128&d=identicon&r=PG&f=1", "display_name": "plateriot", "link": "https://stackoverflow.com/users/4114914/plateriot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 41382662, "answer_count": 1, "score": 1, "last_activity_date": 1484180156, "creation_date": 1482884807, "last_edit_date": 1531164843, "question_id": 41353857, "link": "https://stackoverflow.com/questions/41353857/writing-vba-to-filter-pivot-table-items-in-excel", "title": "Writing VBA to filter pivot table items in Excel", "body": "<p>If I write VBA to automatically filter a pivot table in Excel, it seems that I have to specify each record to be either visible=True or visible=false.  Isn't there a way to only specify what I want checked?</p>\n\n<p>For example:</p>\n\n<pre><code> With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"COB_TITLE\")\n\n        .PivotItems(\"CMD GRP\").Visible = True\n        .PivotItems(\"G1\").Visible = True\n        .PivotItems(\"G2\").Visible = True\n\n\n    End With\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"COB_TITLE\")\n\n        .PivotItems(\"CMD GRP\").Visible = True\n        .PivotItems(\"G1\").Visible = True\n        .PivotItems(\"G2\").Visible = True\n        .PivotItems(\"G3/G5/G3 FIRES/REE/G7/HAST/G9\").Visible = False\n        .PivotItems(\"G4\").Visible = False\n        .PivotItems(\"G6\").Visible = False\n        .PivotItems(\"G8\").Visible = False\n    .PivotItems(\"DIV ENG\").Visible = False\n\n    End With\n</code></pre>\n\n<p>I was certain I had recorded a macro at one time that had only what I selected.</p>\n\n<ul>\n<li>Continued..</li>\n</ul>\n\n<p>So I wrote this string <code>function VisibleList(strSLIDE)</code> that produces a list like this:</p>\n\n<pre><code>.PivotItems(\"HHBN\").Visible = False\n.PivotItems(\"CMD GRP\").Visible = False\n.PivotItems(\"G1\").Visible = True\n.PivotItems(\"G2\").Visible = True\n.PivotItems(\"G3/G5/G3 FIRES/REE/G7/HAST/G9\").Visible = True\n.PivotItems(\"DIV ARTY\").Visible = False\n.PivotItems(\"G3 FIRES\").Visible = False\n.PivotItems(\"G4\").Visible = True\n</code></pre>\n\n<p>I was hoping I could embed it like this: </p>\n\n<pre><code>strPivotItems = VisibleList(\"DIV STAFF\")\n\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"COB_TITLE\")\n         strPivotItems\n    End With \n</code></pre>\n\n<p>I was assuming I could do this like I embed SQL.  Is there a way to generate this for VBA?    </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 4, "creation_date": 1482883559, "post_id": 41353583, "comment_id": 69909449, "body": "You have a typo - <code>&quot;JournalEntryTranscations9&quot;</code>, not <code>&quot;JournalEntryTransactions9&quot;</code>."}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482942719, "post_id": 41353583, "comment_id": 69933554, "body": "Thank you! I&#39;ve fixed it, but it&#39;s still angry at me"}], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1482943238, "post_id": 41359017, "comment_id": 69933782, "body": "So, the only difference I could find was fixing the typos for JournalEntryTranscations9. I fixed all of the typos, but I&#39;m still getting the same error, at the same location"}], "tags": [], "owner": {"reputation": 26, "user_id": 7333773, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2d5071fd71e805a4601225531b0d08f?s=128&d=identicon&r=PG", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/7333773/swapnil"}, "is_accepted": false, "score": 0, "last_activity_date": 1482917084, "creation_date": 1482917084, "answer_id": 41359017, "question_id": 41353583, "link": "https://stackoverflow.com/questions/41353583/trouble-figuring-out-a-run-time-error-9/41359017#41359017", "title": "Trouble figuring out a run-time error 9", "body": "<p>Try the below code</p>\n\n<pre><code>Sub summarize()\n\nDim sh As Worksheet\n'Using sh for explicit summary worksheet for simplicity, doesn't have to reslect constantly\nDim summarySheet As Worksheet\n'Defines the summarysheet as a worksheet\nDim summaryExists As Boolean\n'Checks for truthiness\n\n\nDim summarysheet9 As Worksheet\n\nDim SummaryExists9 As Boolean\n\n\n\nDim n As Integer\nn = ActiveWorkbook.Sheets.Count\n'How many sheets are in the workbook?\n\nDim procMe()\nReDim procMe(n)\n'Defining how many sheets we'll actually use\n\nDim ii As Integer\n\nreportDate = WorksheetFunction.EoMonth(Date, -1)\n'We should be doing month closings in the next month. This finds the last day of the prior month, when month closings are booked\n\nRefDescription = Format(reportDate, \"MMMM\") &amp; \"close\"\n'The batch description entry\n\nDim headers() As Variant\nheaders = Array(\"Reference\", \"Reference Desc\", \"Type\", \"Reversal Date\", _\n  \"Close Date\", \"Project\", \"Job#\", \"Cost Code\", \"Account\", _\n  \"Variance Code\", \"Amount\", \"Transaction Date\", \"Detail Description\")\n'The headers for the summary sheet\n\nii = 0\n\nREFCOL = 1\nDESCCOL = 2\nTYPECOL = 3\nREVCOL = 4\nCLOSECOL = 5\nPROJCOL = 6\nJOBCOL = 7\nCCCOL = 8\nACCCOL = 9\nVARCOL = 10\nAMTCOL = 11\nDATECOL = 12\nDDESCCOL = 13\n\n'Defines the location of each column, and what goes in each column\n\nsummaryExists = False\n'Setting it to false initially, so that if it isn't found, we call it false. Just incase VBA decides to call it true by default.\n\nSummaryExists9 = False\n\n\nFor Each sh In ActiveWorkbook.Sheets\n\n  If sh.Name = \"JournalEntryTransactions\" Then\n    summaryExists = True\n    'If we find a sheet called JournalEntryTransactions, then we're good to go.\n  End If\n\n\n  If sh.Name = \"JournalEntryTransacations9\" Then\n  SummaryExists9 = True\n  'Same as above, but for 900\n  End If\n\n\n  If sh.Name = \"Payroll\" Then\n    sh.Activate\n    ii = ii + 1\n    procMe(ii) = \"Payroll\"\n  End If\n  'If we find a payroll sheet, we like it\n\n  If Val(sh.Name) &gt; 0 Then\n    ii = ii + 1\n    procMe(ii) = sh.Name\n    'If the name of the sheet is an integer, we like it\n\n  Else\n    'Debug.Print \"I don't know what to do with \" &amp; sh.Name\n    'Debugging when it wasn't working too well\n\n  End If\n\nNext sh\n\nReDim Preserve procMe(ii)\n\nIf Not summaryExists Then\n  Set summarySheet = ActiveWorkbook.Sheets.Add\n  summarySheet.Name = \"JournalEntryTransactions\"\n  'If we don't have a summary sheet, add it in\n\nElse\n  Set summarySheet = ActiveWorkbook.Sheets(\"JournalEntryTransactions\")\n  summarySheet.Range(\"A1\", summarySheet.Cells.SpecialCells(xlCellTypeLastCell)).Clear\nEnd If\n'If we already have a summary sheet, we're clearing it out\n\nIf Not SummaryExists9 Then\n  Set summarysheet9 = ActiveWorkbook.Sheets.Add\n  summarysheet9.Name = \"JournalEntryTransactions9\"\n  'If we don't have a summary sheet, add it in\n\nElse\n  Set summarysheet9 = ActiveWorkbook.Sheets(\"JournalEntryTransacations9\")\n  summarySheet.Range(\"A1\", summarySheet.Cells.SpecialCells(xlCellTypeLastCell)).Clear\nEnd If\n'If we already have a summary sheet, we're clearing it out\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482917084, "creation_date": 1482882259, "last_edit_date": 1531164843, "question_id": 41353583, "link": "https://stackoverflow.com/questions/41353583/trouble-figuring-out-a-run-time-error-9", "title": "Trouble figuring out a run-time error 9", "body": "<pre><code>Sub summarize()\nDim sh As Worksheet\n'Using sh for explicit summary worksheet for simplicity, doesn't have to reslect constantly\nDim summarySheet As Worksheet\n'Defines the summarysheet as a worksheet\nDim summaryExists As Boolean\n'Checks for truthiness\n\n\nDim summarysheet9 As Worksheet\n\nDim SummaryExists9 As Boolean\n\n\n\nDim n As Integer\nn = ActiveWorkbook.Sheets.Count\n'How many sheets are in the workbook?\n\nDim procMe()\nReDim procMe(n)\n'Defining how many sheets we'll actually use\n\nDim ii As Integer\n\nreportDate = WorksheetFunction.EoMonth(Date, -1)\n'We should be doing month closings in the next month. This finds the last day of the prior month, when month closings are booked\n\nRefDescription = Format(reportDate, \"MMMM\") &amp; \" close\"\n'The batch description entry\n\nDim headers() As Variant\nheaders = Array(\"Reference\", \"Reference Desc\", \"Type\", \"Reversal Date\", _\n  \"Close Date\", \"Project\", \"Job#\", \"Cost Code\", \"Account\", _\n  \"Variance Code\", \"Amount\", \"Transaction Date\", \"Detail Description\")\n'The headers for the summary sheet\n\nii = 0\n\nREFCOL = 1\nDESCCOL = 2\nTYPECOL = 3\nREVCOL = 4\nCLOSECOL = 5\nPROJCOL = 6\nJOBCOL = 7\nCCCOL = 8\nACCCOL = 9\nVARCOL = 10\nAMTCOL = 11\nDATECOL = 12\nDDESCCOL = 13\n\n'Defines the location of each column, and what goes in each column\n\nsummaryExists = False\n'Setting it to false initially, so that if it isn't found, we call it false. Just incase VBA decides to call it true by default.\n\nSummaryExists9 = False\n\n\nFor Each sh In ActiveWorkbook.Sheets\n\n  If sh.Name = \"JournalEntryTransactions\" Then\n    summaryExists = True\n    'If we find a sheet called JournalEntryTransactions, then we're good to go.\n  End If\n\n\n  If sh.Name = \"JournalEntryTranscations9\" Then\n  SummaryExists9 = True\n  'Same as above, but for 900\n  End If\n\n\n  If sh.Name = \"Payroll\" Then\n    sh.Activate\n    ii = ii + 1\n    procMe(ii) = \"Payroll\"\n  End If\n  'If we find a payroll sheet, we like it\n\n  If Val(sh.Name) &gt; 0 Then\n    ii = ii + 1\n    procMe(ii) = sh.Name\n    'If the name of the sheet is an integer, we like it\n\n  Else\n    'Debug.Print \"I don't know what to do with \" &amp; sh.Name\n    'Debugging when it wasn't working too well\n\n  End If\n\nNext sh\n\nReDim Preserve procMe(ii)\n\nIf Not summaryExists Then\n  Set summarySheet = ActiveWorkbook.Sheets.Add\n  summarySheet.Name = \"JournalEntryTransactions\"\n  'If we don't have a summary sheet, add it in\n\nElse\n  Set summarySheet = ActiveWorkbook.Sheets(\"JournalEntryTransactions\")\n  summarySheet.Range(\"A1\", summarySheet.Cells.SpecialCells(xlCellTypeLastCell)).Clear\nEnd If\n'If we already have a summary sheet, we're clearing it out\n\nIf Not SummaryExists9 Then\n  Set summarysheet9 = ActiveWorkbook.Sheets.Add\n  summarysheet9.Name = \"JournalEntryTransactions9\"\n  'If we don't have a summary sheet, add it in\n\nElse\n  **Set summarysheet9 = ActiveWorkbook.Sheets(\"JournalEntryTransactions9\")**\n  summarySheet.Range(\"A1\", summarySheet.Cells.SpecialCells(xlCellTypeLastCell)).Clear\nEnd If\n'If we already have a summary sheet, we're clearing it out\n</code></pre>\n\n<p>Near the end, <strong>Set summarysheet9 = ActiveWorkbook.Sheets(\"JournalEntryTransactions9\")</strong> is causing a run-time error 9. For the life of me, I can't find what I'm missing. </p>\n\n<p>What I'm trying to do is, if we have a summary sheet(9) already generated, it clears out everything in the sheet (9).</p>\n\n<p>The \"regular\" sheet works (the bit of code above) - just sheet 9 doesn't work. It generates fine when I don't have a sheet, it's just getting angry about clearing it out. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482881780, "post_id": 41353261, "comment_id": 69909074, "body": "<i>&quot;If I do a countif or sumif pointing to A1 without a space and * before or after, it will include the values for the &quot;ham sandwich&quot; &quot;</i> ? I dont get this part. Are you saying that counting the occurrences of <i>&quot;sand&quot;</i> will include the occurrences of <i>&quot;ham sandwich&quot;</i> ??"}, {"owner": {"reputation": 1, "user_id": 7332504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-w7W4pYp0RiY/AAAAAAAAAAI/AAAAAAAAAGE/K02F_k9zTpc/photo.jpg?sz=128", "display_name": "Sam Ervin", "link": "https://stackoverflow.com/users/7332504/sam-ervin"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482942159, "post_id": 41353261, "comment_id": 69933245, "body": "Yes- I was trying to figure out how to exclude instances where the word occurs as part of a longer word."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "is_accepted": false, "score": 0, "last_activity_date": 1482883319, "creation_date": 1482883319, "answer_id": 41353710, "question_id": 41353261, "link": "https://stackoverflow.com/questions/41353261/how-do-i-use-countif-sumif-with-concatenate-for-a-word-occuring-in-various-posit/41353710#41353710", "title": "How do I use countif/sumif with concatenate for a word occuring in various positions of a query?", "body": "<p>As for a simple solution something like this works and won't count the ham sandwich. </p>\n\n<pre><code>=COUNTIF(A1:A5;A1)+COUNTIF(A1:A5;\"* \"&amp;A1&amp;\" *\")+COUNTIF(A1:A5;\"* \"&amp;A1)+COUNTIF(A1:A5;A1&amp;\" *\")\n</code></pre>\n\n<p>Where A1 is the string that is counted in this case \"sand\".</p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 2128399, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qyzEY.png?s=128&g=1", "display_name": "orson", "link": "https://stackoverflow.com/users/2128399/orson"}, "is_accepted": false, "score": 0, "last_activity_date": 1482883768, "creation_date": 1482883768, "answer_id": 41353754, "question_id": 41353261, "link": "https://stackoverflow.com/questions/41353261/how-do-i-use-countif-sumif-with-concatenate-for-a-word-occuring-in-various-posit/41353754#41353754", "title": "How do I use countif/sumif with concatenate for a word occuring in various positions of a query?", "body": "<p>...<code>+ COUNTIF(range,\"sand\")</code></p>\n\n<p>Note that if you've tried this and it isn't working you may have \"sand \" where you think you have \"sand\"</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1482885297, "creation_date": 1482885297, "answer_id": 41353911, "question_id": 41353261, "link": "https://stackoverflow.com/questions/41353261/how-do-i-use-countif-sumif-with-concatenate-for-a-word-occuring-in-various-posit/41353911#41353911", "title": "How do I use countif/sumif with concatenate for a word occuring in various positions of a query?", "body": "<p>You can use a Regular Expression with word boundary tokens.  A word boundary token detects the boundary between a word character and a non-word character (or the beginning or end of the string or line).  In VBA regular expressions, a word character is in the class [A-Za-z0-9_].</p>\n\n<p>Something like the following will return a Boolean indicating the presence or absence of SearchWord in SearchString:</p>\n\n<hr>\n\n<pre><code>Option Explicit\nFunction regexFind(SearchWord As String, SearchString As String) As Boolean\n    Dim RE As Object\n\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Global = False\n    .Pattern = \"\\b\" &amp; SearchWord &amp; \"\\b\"\n    .ignorecase = True\n    regexFind = .test(SearchString)\nEnd With\n\nEnd Function\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 1, "user_id": 7332504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-w7W4pYp0RiY/AAAAAAAAAAI/AAAAAAAAAGE/K02F_k9zTpc/photo.jpg?sz=128", "display_name": "Sam Ervin", "link": "https://stackoverflow.com/users/7332504/sam-ervin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1482885297, "creation_date": 1482879651, "question_id": 41353261, "link": "https://stackoverflow.com/questions/41353261/how-do-i-use-countif-sumif-with-concatenate-for-a-word-occuring-in-various-posit", "title": "How do I use countif/sumif with concatenate for a word occuring in various positions of a query?", "body": "<p>I'm using Excel and VBA. I have a list of search queries and a list of words that appear in the search queries. I'm trying to find a way to get the count of queries that a particular word appears in, as well as sum the cost and revenue of the queries that a particular word appears in. I'm using countif and sumif with a nested concatenate formula. I'm trying to figure out how to include all instances in which the word can appear in the search query--either alone, at the beginning, middle, or end--but also want to exclude instances where the word occurs as part of a longer word. Here's an example:</p>\n\n<p>Let's say the word is \"sand\" and these are the search queries:</p>\n\n<p>\"sand\"</p>\n\n<p>\"sand for sale\"</p>\n\n<p>\"where to buy sand for sale\"</p>\n\n<p>\"buy bulk sand\"</p>\n\n<p>\"ham sandwiches\"</p>\n\n<p>Each search query has an associated cost and revenue. I can use the concatenate function to capture queries containing \"sand\" by including each of the following: (if the word \"sand\" is in cell A1)</p>\n\n<p>\"<strong>sand</strong> for sale\" concatenate(A1,\" \",\"*\")</p>\n\n<p>\"where to buy <strong>sand</strong> for sale\" concatenate(\"*\",\" \",A1,\" \",\" *\")</p>\n\n<p>\"buy bulk <strong>sand</strong>\" concatenate(\"*\",\" \",A1)</p>\n\n<p>If I do a countif or sumif pointing to A1 without a space and * before or after, it will include the values for the \"ham sandwich\" search query. How then do I include search queries that are comprised solely of the word, without a space before or after?</p>\n"}, {"tags": ["ms-access", "vba", "report", "ms-access-2013"], "comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1482878319, "post_id": 41352914, "comment_id": 69908063, "body": "The <code>Return</code> statement is for use with <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251648.aspx\" rel=\"nofollow noreferrer\"><code>GoSub</code></a>, you probably mean to use <code>Exit Function</code>."}, {"owner": {"reputation": 429, "user_id": 5998303, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1b9db1f407a07b2aee7410dfb0b76a9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Mormon", "link": "https://stackoverflow.com/users/5998303/michael-mormon"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1482879904, "post_id": 41352914, "comment_id": 69908497, "body": "@ThunderFrame - good catch on that syntax mistake."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 2088706, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AxgKc.jpg?s=128&g=1", "display_name": "Whitekn3", "link": "https://stackoverflow.com/users/2088706/whitekn3"}, "is_accepted": false, "score": 0, "last_activity_date": 1482894095, "creation_date": 1482894095, "answer_id": 41354814, "question_id": 41352914, "link": "https://stackoverflow.com/questions/41352914/access-vba-to-pass-parameter-to-report-based-on-query/41354814#41354814", "title": "Access VBA to Pass Parameter To Report Based On Query", "body": "<p>Is the User_ID field a text field that holds a number?  If so, you need to add single quotes to the filter.  ... \"User_ID='\" &amp; userId &amp; \"'\".  If it's not text, are you getting too many records or not enough? Is there another filter being applied when the report loads, or in the underlying report record source that is causing the filter to not work as expected? </p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1482921483, "creation_date": 1482921483, "answer_id": 41360236, "question_id": 41352914, "link": "https://stackoverflow.com/questions/41352914/access-vba-to-pass-parameter-to-report-based-on-query/41360236#41360236", "title": "Access VBA to Pass Parameter To Report Based On Query", "body": "<p>If \"twice\" means once for the inputbox and once for the report, then <code>\"User_ID=\"</code> in your where condition is either misspelled or excluded from the query you use as source for the report.</p>\n"}], "owner": {"reputation": 429, "user_id": 5998303, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1b9db1f407a07b2aee7410dfb0b76a9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Mormon", "link": "https://stackoverflow.com/users/5998303/michael-mormon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 715, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594640756, "creation_date": 1482877387, "last_edit_date": 1594640756, "question_id": 41352914, "link": "https://stackoverflow.com/questions/41352914/access-vba-to-pass-parameter-to-report-based-on-query", "title": "Access VBA to Pass Parameter To Report Based On Query", "body": "<p>I am close on having syntax accurate, just one big problem!<br>\n<br>The User ID that I am capturing from the input box, is not being passed into the report, so I have to input the user id twice<br></p>\n\n<p>What needs to be altered in order to achieve this?</p>\n\n<pre><code>Public Function userProd() As Integer\nDim userID As String, saveloc As String, filename As String, reportname As String\n\n'Report Name\nreportname = \"rpt_UserProduction\"\n\n'Setting Save location\nsaveloc = \"C:\\Test\\\"\n\n'Setting filename\nfilename = \"userProd \"\n\n'Getting User ID To Process\nuserID = InputBox(\"Enter User ID:\", \"VBA InputBox Function\")\n\n'Putting together full save location\nsaveloc = saveloc + filename + userID + \".pdf\"\n\nIf userID = \"\" Then\n    'Do Nothing and Stop Processing\n    Exit Function\nElse\n    If IsNumeric(userID) Then\n        'Preview Report\n        DoCmd.OpenReport reportname, acViewPreview, , \"User_ID=\" &amp; userID\n\n        'Save As PDF\n        DoCmd.OutputTo acOutputReport, reportname, acFormatPDF, saveloc, True\n\n        'Close Report\n        DoCmd.Close acReport, reportname\n    End If\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7125, "user_id": 3975309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r5v7W.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/3975309/mikkel"}, "edited": false, "score": 0, "creation_date": 1482877848, "post_id": 41352665, "comment_id": 69907907, "body": "Welcome to Stack Overflow. What you are trying to do is always going to be problematic, as you can&#39;t rely on an email subject being &#39;safe&#39; - for example, what if it contains a back-slash character, or a quote?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1482885030, "post_id": 41352665, "comment_id": 69909715, "body": "Yes you can, can you show more off your code or complete code please..."}], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1483110596, "post_id": 41352846, "comment_id": 69998570, "body": "Just before MkDir create a staticNow = Now. Replace Now in your code with staticNow."}], "tags": [], "owner": {"reputation": 1, "user_id": 7347458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e891ca1d6b9326723c238d6c502294f?s=128&d=identicon&r=PG&f=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/7347458/mehdi"}, "is_accepted": false, "score": 0, "last_activity_date": 1482876901, "creation_date": 1482876901, "answer_id": 41352846, "question_id": 41352665, "link": "https://stackoverflow.com/questions/41352665/how-to-define-a-string-as-a-directory-in-vba/41352846#41352846", "title": "how to define a string as a directory in vba", "body": "<p>Thanks to all, I found a way. if there is any better way please give me your comment, I'd appreciate it.</p>\n\n<pre><code>On Error Resume Next\nMkDir \"C:\\Users\\mwx391225\\Desktop\\Email\" &amp; Format(Now, \"dd-mmm-yy h-mm\")\nOn Error GoTo 0\n\nsPath = \"C:\\Users\\mwx391225\\Desktop\\Email\" &amp; Format(Now, \"dd-mmm-yy h-mm\") &amp; \"\\\"\nDebug.Print sPath &amp; sName\noMail.SaveAs sPath &amp; sName, olMSG\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7347458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e891ca1d6b9326723c238d6c502294f?s=128&d=identicon&r=PG&f=1", "display_name": "Mehdi", "link": "https://stackoverflow.com/users/7347458/mehdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593327669, "creation_date": 1482875758, "last_edit_date": 1593327669, "question_id": 41352665, "link": "https://stackoverflow.com/questions/41352665/how-to-define-a-string-as-a-directory-in-vba", "title": "how to define a string as a directory in vba", "body": "<p>I need to set a directory, but I need it to be variable.\nin below example, I want to Create a Folder with the name of my Email subject. And then set the path to the created folder.<br>\nwith below script it does not save my emails to folder i created. Would you please help?</p>\n\n<pre><code>N1 = oMail.Subject\nOn Error Resume Next\nMkDir \"C:\\Users\\meti\\Desktop\\E\" &amp; N1\nOn Error GoTo 0\n\nsPath = \"C:\\Users\\meti\\Desktop\\E\" &amp; N1\nDebug.Print sPath &amp; sName\noMail.SaveAs sPath &amp; sName, olMSG\n</code></pre>\n"}, {"tags": ["vba", "excel", "directory", "filenames"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5569985"}, "edited": false, "score": 1, "creation_date": 1482875204, "post_id": 41352550, "comment_id": 69907054, "body": "Beautiful; I&#39;ll be accepting this an my answer after the time restraint has passed. Thanks"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1482874955, "creation_date": 1482874955, "answer_id": 41352550, "question_id": 41352510, "link": "https://stackoverflow.com/questions/41352510/find-full-filename-given-only-partial-filename/41352550#41352550", "title": "Find full filename given only partial filename", "body": "<pre><code>   myFolder = \"C:\\SO\"\n   myPrefix = \"David\"\n   myFileName = Dir(myFolder &amp; \"\\\" &amp; myPrefix &amp; \"*\")\n   Debug.Print myFileName\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5569985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 41352550, "answer_count": 1, "score": 0, "last_activity_date": 1482874955, "creation_date": 1482874664, "last_edit_date": 1531164843, "question_id": 41352510, "link": "https://stackoverflow.com/questions/41352510/find-full-filename-given-only-partial-filename", "title": "Find full filename given only partial filename", "body": "<p>I know the directory in which a file is located.</p>\n\n<p>I know that this file will always begin with a word - let's say \"David\"</p>\n\n<p>I know that there is only one file in this directory whose name begin's with \"David\"</p>\n\n<p>How can I find the entire file's name? </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "blob"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482876327, "post_id": 41352422, "comment_id": 69907412, "body": "Your block write is incorrect - you need to loop for <code>NumBlocks</code> <b><i>then</i></b> write the remaining block of size <code>LeftOver</code>.  Right now you&#39;re over-reading each chunk."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 3, "creation_date": 1482881077, "post_id": 41352422, "comment_id": 69908878, "body": "You can also avoid a lot of the gory details by using an <code>ADODB.Stream</code> object to write the binary data to a file."}, {"owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "reply_to_user": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1483553443, "post_id": 41352422, "comment_id": 70146782, "body": "@GordThompson I am able to get a file to save to a disk that is readable (I can display the picture in a bound object frame) if I put it back in a table via the ADODB.Stream method you suggested. The problem I am still having is that the file that is saved to the disk is unusable to any normal picture viewing utilities. Is there something I need to do to the ADODB.Stream like add a header or something to make the file readable? The pictures are screen captures taken with the snipping tool and pasted into a bound object frame in Access (though it wouldn&#39;t hurt to be able to use other formats)."}], "owner": {"reputation": 501, "user_id": 3570438, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/PSwi1.png?s=128&g=1", "display_name": "110SidedHexagon", "link": "https://stackoverflow.com/users/3570438/110sidedhexagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3215, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1597820619, "creation_date": 1482874052, "last_edit_date": 1483746896, "question_id": 41352422, "link": "https://stackoverflow.com/questions/41352422/how-to-save-an-access-ole-object-blob-image-to-disk-using-vba", "title": "How to save an Access OLE Object (BLOB) image to disk using VBA", "body": "<p>So I seem to be able to save BLOB files from Access okay using the code below (which I found while searching how to export a BLOB). But it doesn't seem to be saving a valid .png file. When I try to open the file from disk I get the error \"Windows Photo Viewer can't open this picture because the file is appears to be damaged, corrupted, or is too large. I know it's not too large because it's only 1.19MB. Is there a special way you have to write the BLOB file to disk that makes it readable or is there something else that I'm missing? </p>\n\n<p>-EDIT-</p>\n\n<p>Taking Gord's advice, I have got the code below using an ADODB.Stream. Unfortunately, I'm still running into the same problem where the file this writes to does not open in windows picture viewer. I'm wondering if this is because of the file extension I am giving it, but I've tried writing to a .JPG file (the default snipping tool save option which is where I expect the pictures to be input from) as well as .png (the file type I want) and .gif. Any ideas would be helpful as to how to solve this problem.</p>\n\n<pre><code>Public Sub TestBlobStream()\n\nDim mStream As New ADODB.Stream\nDim rs As RecordSet\n\nSet rs = dbLocal.OpenRecordset(\"BlobTest\")\nSet mStream = New ADODB.Stream\n\nmStream.Type = adTypeBinary\nmStream.Open\nmStream.Write rs(\"testBlob\")\nmStream.SetEOS\nmStream.SaveToFile \"D:\\Target\\TestPic.png\", adSaveCreateOverWrite\nmStream.Close\n\nEnd Sub\n</code></pre>\n\n<p>-END EDIT-</p>\n\n<p>Code referenced in original part of question:</p>\n\n<p>Public Sub TestBlob()\n    Dim rs As RecordSet</p>\n\n<pre><code>Set rs = dbLocal.OpenRecordset(\"BlobTest\")\n\nDBug WriteBLOB(rs, \"testBlob\", \"D:\\Target\\TestPic.png\")\n\nSet rs = Nothing\n\nEnd Sub\n\nFunction WriteBLOB(T As DAO.RecordSet, sField As String, Destination As String)\n\nDim NumBlocks As Long, DestFile As Long, i As Long\nDim FileLength As Long, LeftOver As Long\nDim FileData As String\nDim RetVal As Variant\n\n' Get the size of the field.\nFileLength = T(sField).FieldSize()\nIf FileLength = 0 Then\n    WriteBLOB = 0\n    Exit Function\nEnd If\n\n' Calculate number of blocks to write and leftover bytes.\nNumBlocks = FileLength \\ BlockSize\nLeftOver = FileLength Mod BlockSize\n\n' Remove any existing destination file.\nDestFile = FreeFile\nOpen Destination For Output As DestFile\nClose DestFile\n\n' Open the destination file.\nOpen Destination For Binary As DestFile\n\n' SysCmd is used to manipulate the status bar meter.\nRetVal = SysCmd(acSysCmdInitMeter, _\n\"Writing BLOB\", FileLength / 1000)\n\n' Write the leftover data to the output file.\nFileData = T(sField).GetChunk(0, LeftOver)\nPut DestFile, , FileData\n\n' Update the status bar meter.\nRetVal = SysCmd(acSysCmdUpdateMeter, LeftOver / 1000)\n\n' Write the remaining blocks of data to the output file.\nFor i = 1 To NumBlocks\n    ' Reads a chunk and writes it to output file.\n    FileData = T(sField).GetChunk((i - 1) * BlockSize + LeftOver, BlockSize)\n    Put DestFile, , FileData\n\n    RetVal = SysCmd(acSysCmdUpdateMeter, _\n    ((i - 1) * BlockSize + LeftOver) / 1000)\nNext i\n\n' Terminates function\nRetVal = SysCmd(acSysCmdRemoveMeter)\nClose DestFile\nWriteBLOB = FileLength\nExit Function\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "ole", "visio"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482877384, "post_id": 41352276, "comment_id": 69907748, "body": "could you get a reference to the workbook object without <code>Activating</code> or <code>Editing</code> the embedded OLE object anyway?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1482877700, "post_id": 41352276, "comment_id": 69907854, "body": "What code do you have so far?"}, {"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "edited": false, "score": 0, "creation_date": 1482933659, "post_id": 41352276, "comment_id": 69928475, "body": "I can easily get a reference to the workbook, but I want to get a reference to the worksheet that&#39;s displayed when not editing the OLE object.  There&#39;s nothing obvious for that, that I can see (ActiveSheet is Nothing for the workbook object unless the OLE object is being edited)."}], "answers": [{"comments": [{"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "edited": false, "score": 0, "creation_date": 1483044912, "post_id": 41379961, "comment_id": 69976413, "body": "The question is &#39;what is the name of the sheet being displayed&#39;.  I know how to get a specific sheet.  The question is asking how to find out what sheet is being displayed by the OLE object."}, {"owner": {"reputation": 902, "user_id": 4434393, "user_type": "registered", "profile_image": "https://graph.facebook.com/1733148059/picture?type=large", "display_name": "Carlos E. Ferro", "link": "https://stackoverflow.com/users/4434393/carlos-e-ferro"}, "reply_to_user": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "edited": false, "score": 0, "creation_date": 1483196974, "post_id": 41379961, "comment_id": 70021771, "body": "Sorry, I misunderstood the question. The answer to that is &quot;There is no name, because there is no sheet being displayed, otherwise that would be the ActiveSheet&quot;"}, {"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "edited": false, "score": 0, "creation_date": 1483538900, "post_id": 41379961, "comment_id": 70137036, "body": "I understand that the Excel object is not actively rendering to the screen, and that OLE is showing me a graphic from the last time the sheet was rendered.  I&#39;m really looking to see if there&#39;s a property on the Workbook object or the OLE object that would tell me the name of the sheet that was rendered for display."}], "tags": [], "owner": {"reputation": 902, "user_id": 4434393, "user_type": "registered", "profile_image": "https://graph.facebook.com/1733148059/picture?type=large", "display_name": "Carlos E. Ferro", "link": "https://stackoverflow.com/users/4434393/carlos-e-ferro"}, "is_accepted": false, "score": -1, "last_activity_date": 1483015336, "creation_date": 1483015336, "answer_id": 41379961, "question_id": 41352276, "link": "https://stackoverflow.com/questions/41352276/how-to-get-activesheet-in-ole-embedded-excel-object/41379961#41379961", "title": "How to get ActiveSheet in OLE-embedded Excel object", "body": "<p>You don't need the ActiveSheet, which actually is nothing if you are not editing. You can iterate through Bk.Worksheets, from 1 to Worksheets.Count, to find one with a specific name.</p>\n\n<p>Also, the index can be a name, so this should work:</p>\n\n<pre><code>Set Sheet = Bk.Worksheets(\"MySpecificSheet\")\n</code></pre>\n"}], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 999, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1486674249, "creation_date": 1482873079, "last_edit_date": 1486674249, "question_id": 41352276, "link": "https://stackoverflow.com/questions/41352276/how-to-get-activesheet-in-ole-embedded-excel-object", "title": "How to get ActiveSheet in OLE-embedded Excel object", "body": "<p>I am looking around at embedding Excel workbooks in Visio and doing read/write operations on the embedded data.  Doing paste-special with Excel data seems to embed the whole workbook, not just the selected/copied data.</p>\n\n<p>I'm able to get a reference to the Excel Workbook object embedded on the Visio page, but I'm not able to tell what sheet is active and being displayed in Visio.  It seems that I can only tell what the active sheet is when the sheet is being edited.  When it's just there on the page the Workbook object returns Nothing for the ActiveSheet and the workbook has no Windows.  It makes sense it'd have no windows, but doesn't make so much sense that there is no active sheet.</p>\n\n<p>Is there a way to find out what the 'active' sheet is in an Excel OLE object?  Or should any code I write work under the assumption that everything is in sheet 1?  I would probably be adding any embedded workbooks programmatically, so it wouldn't be too big a stretch to limit each book to one sheet, but I just want to make sure there's not some property I'm overlooking that will tell me what I want.</p>\n\n<p>This code will find an Excel OLE object on the page and sets cells A1 and B1 in sheet 1 of the workbook:</p>\n\n<pre><code>Dim CheckShp As Visio.Shape\nDim CheckObj As OLEObject\nFor Each CheckObj In ActivePage.OLEObjects\n    If CheckObj.ProgID Like \"Excel.Sheet.*\" Then\n        Dim Sheet As Excel.Worksheet\n        Dim Bk As Excel.Workbook\n        Set Bk = CheckObj.Object\n        Set Sheet = Bk.Worksheets(1)\n\n        Sheet.Cells(1, 1) = \"HELLO\"\n        Sheet.Cells(1, 2) = \"WORLD\"\n\n    End If\nNext CheckObj\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1482871951, "post_id": 41351956, "comment_id": 69905864, "body": "Here&#39;s how you set the column G value: <code>Sheets(&quot;Reservations&quot;).Range(&quot;G&quot; &amp; i).Value = DateSerial(UserForm1.ComboBox3.Value, UserForm1.ComboBox2.Value, UserForm1.ComboBox1.Value)</code> and then it will be formatted correctly based on your NumberFormat later in your code."}, {"owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1482873326, "post_id": 41351956, "comment_id": 69906397, "body": "Thanks you very much, it&#39;s working !!"}, {"owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1482947643, "post_id": 41351956, "comment_id": 69935915, "body": "@tigeravatar Do you have any idea to do the same think, but this time for time time o&#39;clock."}], "owner": {"reputation": 15, "user_id": 7323077, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307073882665337/picture?type=large", "display_name": "Ihab Benamer", "link": "https://stackoverflow.com/users/7323077/ihab-benamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482946586, "creation_date": 1482871280, "question_id": 41351956, "link": "https://stackoverflow.com/questions/41351956/vba-put-the-value-of-three-combobox-in-one-excel-cell", "title": "VBA : Put the value of three ComboBox in one Excel cell", "body": "<p>I'm trying to create a formular, and I have a problem.\nI want to put the value of ComboBox1(Days), ComboBox2(Mounths) and ComboBox3(Years) in one Excel cell (Cell G)</p>\n\n<p>This is a part of my script : </p>\n\n<pre><code>f MsgBox(\"Confirmez-vous l\u2019insertion de ce nouveau contact ?\", vbYesNo, \"Demande de confirmation d\u2019ajout\") = vbYes Then\n\n    i = WorksheetFunction.CountA(Range(\"A:A\")) + 1 'Pour placer le nouvel enregistrement \u00e0 la premi\u00e8re ligne de tableau non vide\n\n    MsgBox i\n\n    Sheets(\"Reservations\").Range(\"A\" &amp; i).Value = UserForm1.TextBox1.Value\n\n    Sheets(\"Reservations\").Range(\"B\" &amp; i).Value = UserForm1.TextBox2.Value\n\n    Sheets(\"Reservations\").Range(\"C\" &amp; i).Value = UserForm1.TextBox3.Value\n\n    Sheets(\"Reservations\").Range(\"D\" &amp; i).Value = UserForm1.TextBox4.Value\n\n    Sheets(\"Reservations\").Range(\"E\" &amp; i).Value = UserForm1.TextBox5.Value\n\n    Sheets(\"Reservations\").Range(\"F\" &amp; i).Value = UserForm1.ComboBox4.Value\n\n    Sheets(\"Reservations\").Range(\"G\" &amp; i).Value = UserForm1.ComboBox1.Value\n\n    Sheets(\"Reservations\").Range(\"H\" &amp; i).Value = UserForm1.ComboBox5.Value\n\n    Sheets(\"Reservations\").Range(\"I\" &amp; i).Value = UserForm1.ComboBox7.Value\n\n    Sheets(\"Reservations\").Range(\"E\" &amp; i).NumberFormat = \"00 00 00 00 00\"\n\n    Sheets(\"Reservations\").Range(\"H\" &amp; i).NumberFormat = \"00\"\n\n    Sheets(\"Reservations\").Range(\"G\" &amp; i).NumberFormat = \"dd mmmm yyyy\"\n\n\n\nEnd If \nEnd Sub\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 1515, "user_id": 4114782, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a7a894ffea3afedf3f70c7cc54fa7518?s=128&d=identicon&r=PG&f=1", "display_name": "Duston", "link": "https://stackoverflow.com/users/4114782/duston"}, "edited": false, "score": 2, "creation_date": 1482871533, "post_id": 41351912, "comment_id": 69905709, "body": "What does your code look like?  I don&#39;t see Microsoft Word 14.0 Object Library in your list either."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1482871663, "post_id": 41351912, "comment_id": 69905761, "body": "4th in your selection is <code>Microsoft Office 14.0 Object Library</code>, but you probably want <code>Microsoft Word 14.0 Object Library</code>"}, {"owner": {"reputation": 1515, "user_id": 4114782, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a7a894ffea3afedf3f70c7cc54fa7518?s=128&d=identicon&r=PG&f=1", "display_name": "Duston", "link": "https://stackoverflow.com/users/4114782/duston"}, "edited": false, "score": 1, "creation_date": 1482871694, "post_id": 41351912, "comment_id": 69905772, "body": "No, the 4th selection is Microsoft Office which may or may not include Word.  Given that there are explicit Excel and Access libraries, there may be an explicit Word library."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1482872280, "post_id": 41351912, "comment_id": 69906006, "body": "ok, i found it thank you pointing out my mistake, but now it&#39;s giving me a Subscript out of range error where I am trying to define tbl."}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1482875541, "post_id": 41351912, "comment_id": 69907174, "body": "@YowE3K, due to the <code>Option Base 1</code> line at the top, the <code>LBound</code> will actually be 1. @sc1324, that <code>Set tbl...</code> line assumes the &quot;TableA1&quot; Table is on the first Worksheet in the Workbook, the &quot;TableA2&quot; Table is on the second Worksheet, etc. The error you are receiving indicates that the way your Workbook is structured does not conform to that assumption. If so, it may help if you <a href=\"http://stackoverflow.com/posts/41351912/edit\">edit</a> your question, and specify the name of the Worksheet on which each Table is located."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1482875653, "post_id": 41351912, "comment_id": 69907210, "body": "@mjh - thanks - I missed the <code>Option Base 1</code>"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1482877983, "post_id": 41351912, "comment_id": 69907959, "body": "If you cannot Get the Word Application object, create it! <code>If WordApp Is Nothing Then Set WordApp = CreateObject(&quot;Word.Application&quot;)</code>. Also it is better to Define the WordApp as an Object, this kills the error you have (you don&#39;t need to reference it in VBE on the machine you are running it)."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1482937355, "post_id": 41351912, "comment_id": 69930565, "body": "@MJH, i updated my sheets so tableA1 is in sheet1 position and so on but it is still giving me the same error. TableA1 is in sheetname Table A-1 Summary, TableA2 is in sheetname Table A-2 Agency Class and so on... I was not sure if there is a simpler way to give locations of each table and then have a copy and paste formula and insert them on the word?"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1482937640, "post_id": 41351912, "comment_id": 69930723, "body": "@PatricK, how exactly can I do that? which part of the codes should I modify so this will work? Thank you,"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1482938032, "post_id": 41351912, "comment_id": 69930954, "body": "Please ensure your Workbook has no hidden Worksheets (which would alter the Worksheet &quot;numbers&quot;). If it does not, then please <a href=\"http://stackoverflow.com/posts/41351912/edit\">edit</a> your question, and include a screenshot of the first Worksheet in the Workbook. Before taking the screenshot, click a cell in the Table, then click the &quot;Design&quot; tab on the Ribbon. Ensure that the screenshot shows both the &quot;Table Name&quot; (the left-most item on that Ribbon tab), and the Worksheet tab (which should be the left-most tab). Also, you should always tag such questions with your Excel version."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1482938891, "post_id": 41351912, "comment_id": 69931430, "body": "@MJH, hi, i am not sure if my question is clear but please advise."}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1482943668, "post_id": 41351912, "comment_id": 69934031, "body": "You didn&#39;t actually do what I requested, but never mind that.  See my answer instead."}], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483036852, "post_id": 41366312, "comment_id": 69973006, "body": "Hi, I modified the codes and change each bookmark, sheetname and tablename to be the same, TableA1, TableA2...and i also finish  .Add for each of my table but when I run it, it&#39;s giving me an error at sheet.ListObjects(tableName).Range.Copy this line, not sure why. I only have 10 sheets in my workbook, no hidden tabs."}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483050996, "post_id": 41366312, "comment_id": 69978655, "body": "What is the error? If it is &quot;Subscript out of range&quot; again, then it is likely you have an incorrect Table name in one or more of the <code>.Add</code> lines. In that case, as a test you might try running the procedure with all but one of the <code>.Add</code> lines commented. Otherwise, I&#39;ll need to know the exact error message."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483106761, "post_id": 41366312, "comment_id": 69996826, "body": "I get the same error, Subscript out of range, and please see above, i finish off your codes you provided and they are in the same order as my worksheets. So my worksheet name, table name and my bookmark name are the same. My word doc&#39;s name is a.docx and my excel&#39;s name is b.xlsm."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483108356, "post_id": 41366312, "comment_id": 69997522, "body": "I also tried to just do 1 table at a time, and even if that&#39;s the case, I am still getting the same error."}], "tags": [], "owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "is_accepted": false, "score": 0, "last_activity_date": 1483117461, "last_edit_date": 1483117461, "creation_date": 1482943634, "answer_id": 41366312, "question_id": 41351912, "link": "https://stackoverflow.com/questions/41351912/subscript-out-of-range-error-vba/41366312#41366312", "title": "Subscript out of range error - vba", "body": "<p>The code I had originally provided was based on your original model, in which the corresponding Worksheet, Table, and Bookmark in each set had a different name.</p>\n\n<p>Now that you have ensured that the names of the objects in each set are identical (which is a better model), try the following procedure. The only difference is that the <code>Scripting.Dictionary</code> has been eliminated, and the Worksheet name is being used to provide both the name of the Table and the name of the Bookmark (since all three values match now).</p>\n\n<p>As before, this one has also been tested in Excel/Word 2016, and is functioning as expected:</p>\n\n<pre><code>Public Sub ExcelTablesToWord_Modified2()\n\n    Dim WordApp As Word.Application\n    Dim myDoc As Word.Document\n    Dim sheet As Excel.Worksheet\n\n    'Optimize Code\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    'Set Variable Equal To Destination Word Document\n    On Error GoTo WordDocNotFound\n      Set WordApp = GetObject(class:=\"Word.Application\")\n      WordApp.Visible = True\n      Set myDoc = WordApp.Documents(\"a.docx\")\n    On Error GoTo 0\n\n    'Loop Through Worksheets, and Copy/Paste Multiple Excel Tables\n    For Each sheet In ActiveWorkbook.Worksheets\n\n        'Copy Table Range from Excel\n        sheet.ListObjects(sheet.Name).Range.Copy\n\n        'Paste Table into MS Word (using inserted Bookmarks -&gt; ctrl+shift+F5)\n        myDoc.Bookmarks(sheet.Name).Range.PasteExcelTable _\n            LinkedToExcel:=False, _\n            WordFormatting:=False, _\n            RTF:=False\n\n        'Autofit the most-recently-pasted Table so it fits inside Word Document\n        myDoc.Tables(myDoc.Tables.Count).AutoFitBehavior (wdAutoFitWindow)\n\n    Next sheet\n\n    'Completion Message\n    MsgBox \"Copy/Pasting Complete!\", vbInformation\n    GoTo EndRoutine\n\n    'ERROR HANDLER\nWordDocNotFound:\n    MsgBox \"Microsoft Word file 'b' is not currently open, aborting.\", 16\n\n    'Put Stuff Back The Way It Was Found\nEndRoutine:\n    'Optimize Code\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n    'Clear The Clipboard\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p><br>\nIf you still receive the same error, then perhaps the Workbook is corrupted. In that case, try doing the following:</p>\n\n<ol>\n<li>Create a new Workbook with one Worksheet</li>\n<li>Rename the Worksheet so that its name matches the name of one of the Bookmarks in the Word document</li>\n<li><strong>Manually</strong> add a single, small, \"testing-only\" Table to the Worksheet (do not copy/paste one from the original Workbook)</li>\n<li>Ensure that the Table's name is the same as the Worksheet's name</li>\n<li>Copy/paste the above procedure into a new Module in that Workbook</li>\n<li>Save the new Workbook</li>\n<li>Ensure your Word document is open, and run the procedure</li>\n</ol>\n\n<p>If that works, then you might consider recreating your entire original Workbook in the new Workbook. When doing so, if your datasets are large enough that you <strong>must</strong> copy/paste from the Original Workbook, use \"Paste Special\" with \"Values Only\" instead of just a normal Paste. Then, re-create any missing formatting manually. That way, it will be less likely that any corruption in the original Workbook will be transferred to the new one.</p>\n"}, {"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483036823, "post_id": 41370912, "comment_id": 69972996, "body": "Hi, it looks like the codes went through and did the copy and paste but i dont see it anywhere in my word document."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1483059385, "post_id": 41370912, "comment_id": 69980801, "body": "Did you step through the PasteExcelTable part? My test Excel file and Word Doc works fine when there are existing bookmarks from <code>bookmark1</code> to <code>bookmark4</code>. Put a break on <code>x = x + 1</code> and see if the Word Doc still has those bookmarks."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1482966012, "creation_date": 1482966012, "answer_id": 41370912, "question_id": 41351912, "link": "https://stackoverflow.com/questions/41351912/subscript-out-of-range-error-vba/41370912#41370912", "title": "Subscript out of range error - vba", "body": "<p>Below will copy the first Table in every worksheet and paste into Word doc, regardless of the Table Name. The bookmark names in the Word doc assumed to be simply start at 1 with prefix \"bookmark\".</p>\n\n<p>If specific Table names are really required, then create a Collection for the names, and loop through each Table in each Worksheet, if that table name is in the Collection then proceed to copy.</p>\n\n<pre><code>Option Base 1 'Force arrays to start at 1 instead of 0\n\nSub ExcelTablesToWord()\n\n    Dim oWS As Worksheet\n    Dim tbl As Excel.Range\n    Dim WordApp As Object ' Word.Application\n    Dim myDoc As Object ' Word.Document\n    Dim x As Long ' Integer\n\n\n    'Optimize Code\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    'Set Variable Equal To Destination Word Document\n    On Error Resume Next\n    Set WordApp = GetObject(, \"Word.Application\")\n    If WordApp Is Nothing Then Set WordApp = CreateObject(\"Word.Application\")\n    If WordApp Is Nothing Then GoTo WordDocNotFound\n    WordApp.Visible = True\n    Set myDoc = WordApp.Documents(\"a.docx\")\n    If myDoc Is Nothing Then Set myDoc = WordApp.Documents.Open(\"a.docx\")\n    If myDoc Is Nothing Then GoTo WordDocNotFound\n\n    'Loop Through and Copy/Paste Multiple Excel Tables\n    x = 1 ' For x = LBound(TableArray) To UBound(TableArray)\n    For Each oWS In ThisWorkbook.Worksheets\n\n        'Copy Table Range from Excel\n        'Set tbl = ThisWorkbook.Worksheets(x).ListObjects(TableArray(x)).Range\n        Set tbl = oWS.ListObjects(1).Range\n        If Not tbl Is Nothing Then\n            tbl.Copy\n\n            'Paste Table into MS Word (using inserted Bookmarks -&gt; ctrl+shift+F5)\n            myDoc.Bookmarks(\"bookmark\" &amp; x).Range.PasteExcelTable LinkedToExcel:=False, WordFormatting:=False, RTF:=False\n\n            'Autofit Table so it fits inside Word Document\n            myDoc.Tables(x).AutoFitBehavior 2 ' (wdAutoFitWindow)\n\n            x = x + 1\n        End If\n    Next\n    On Error GoTo 0\n\n    'Completion Message\n    MsgBox \"Copy/Pasting Complete!\", vbInformation\n    GoTo EndRoutine\n\n    'ERROR HANDLER\nWordDocNotFound:\n    MsgBox \"Microsoft Word file 'b' is not currently open, aborting.\", 16\n\n    'Put Stuff Back The Way It Was Found\nEndRoutine:\n    'Optimize Code\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n    'Clear The Clipboard\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 664, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1483117461, "creation_date": 1482871061, "last_edit_date": 1483107206, "question_id": 41351912, "link": "https://stackoverflow.com/questions/41351912/subscript-out-of-range-error-vba", "title": "Subscript out of range error - vba", "body": "<p>I am trying to copy and paste multiple tables from excel to word but it's giving me Subscript out of range error when I am trying to define tbl. I found the codes online and is trying to modify the codes to suit my needs.</p>\n\n<pre><code>Sub ExcelTablesToWord_Modified()\n\n    Dim WordApp As Word.Application\n    Dim myDoc As Word.Document\n    Dim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n    Dim sheet As Excel.Worksheet\n    Dim tableName As String\n\n    With dict\n        .Add \"TableA1\", \"TableA1\"\n        .Add \"TableA2\", \"TableA2\"\n        .Add \"TableB1\", \"TableB1\"\n        .Add \"TableB2\", \"TableB2\"\n        .Add \"TableC\", \"TableC\"\n        .Add \"TableD\", \"TableD\"\n        .Add \"TableE1\", \"TableE1\"\n        .Add \"TableE2\", \"TableE2\"\n        .Add \"TableF1\", \"TableF1\"\n        .Add \"TableF2\", \"TableF2\"\n        'TODO: add the remaining WorksheetName/TableName combinations\n    End With\n\n    'Optimize Code\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    'Set Variable Equal To Destination Word Document\n    On Error GoTo WordDocNotFound\n      Set WordApp = GetObject(class:=\"Word.Application\")\n      WordApp.Visible = True\n      Set myDoc = WordApp.Documents(\"a.docx\")\n    On Error GoTo 0\n\n    'Loop Through Worksheets, and Copy/Paste Multiple Excel Tables\n    For Each sheet In ActiveWorkbook.Worksheets\n        tableName = dict(sheet.Name)\n\n        'Copy Table Range from Excel\n        sheet.ListObjects(tableName).Range.Copy\n\n        'Paste Table into MS Word (using inserted Bookmarks -&gt; ctrl+shift+F5)\n        myDoc.Bookmarks(tableName).Range.PasteExcelTable _\n            LinkedToExcel:=False, _\n            WordFormatting:=False, _\n            RTF:=False\n\n        'Autofit the most-recently-pasted Table so it fits inside Word Document\n        myDoc.Tables(myDoc.Tables.Count).AutoFitBehavior (wdAutoFitWindow)\n\n    Next sheet\n\n    'Completion Message\n    MsgBox \"Copy/Pasting Complete!\", vbInformation\n    GoTo EndRoutine\n\n    'ERROR HANDLER\nWordDocNotFound:\n    MsgBox \"Microsoft Word file 'b' is not currently open, aborting.\", 16\n\n    'Put Stuff Back The Way It Was Found\nEndRoutine:\n    'Optimize Code\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n\n    'Clear The Clipboard\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oMSXz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oMSXz.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/rlciR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rlciR.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/besB1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/besB1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql-server", "excel", "tsql", "vba"], "comments": [{"owner": {"reputation": 7147, "user_id": 5464747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f60df21c4da5e9dbe92aff62b4ded3b2?s=128&d=identicon&r=PG", "display_name": "dfundako", "link": "https://stackoverflow.com/users/5464747/dfundako"}, "edited": false, "score": 1, "creation_date": 1482870481, "post_id": 41351774, "comment_id": 69905275, "body": "If it&#39;s in excel, the work is done for you. Just format it in excel and copy/paste it into ssms."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482870504, "post_id": 41351774, "comment_id": 69905287, "body": "By values, do you mean records or fields?"}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482870728, "post_id": 41351774, "comment_id": 69905382, "body": "@Comintern I guess i mean fields. I would be inserting each individual cell as a value."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "reply_to_user": {"reputation": 7147, "user_id": 5464747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f60df21c4da5e9dbe92aff62b4ded3b2?s=128&d=identicon&r=PG", "display_name": "dfundako", "link": "https://stackoverflow.com/users/5464747/dfundako"}, "edited": false, "score": 1, "creation_date": 1482870839, "post_id": 41351774, "comment_id": 69905429, "body": "@dfundako I know that I can just copy and paste that, However this is going to be part of a program that runs whenever someone wants to update a table. So this would be automating that process,"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482870844, "post_id": 41351774, "comment_id": 69905435, "body": "This is actually fairly easy if you parameterize your query - can you edit your code into the question?"}, {"owner": {"reputation": 7147, "user_id": 5464747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f60df21c4da5e9dbe92aff62b4ded3b2?s=128&d=identicon&r=PG", "display_name": "dfundako", "link": "https://stackoverflow.com/users/5464747/dfundako"}, "edited": false, "score": 3, "creation_date": 1482870878, "post_id": 41351774, "comment_id": 69905449, "body": "@SteveG Probably would be easiest through a SSIS package."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7242586, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6c1678c1753c1ce5e9bc332cec50994c?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7242586/jake"}, "edited": false, "score": 0, "creation_date": 1482873068, "post_id": 41352196, "comment_id": 69906318, "body": "Well, now that you&#39;ve posted VBA code, this is mostly meaningless. I would suggest doing a parameterized query or concatenating the cells as strings in each row of the spreadsheet, adding comma delimiters between each cell read, and placing each row into an array."}, {"owner": {"reputation": 181, "user_id": 7242586, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6c1678c1753c1ce5e9bc332cec50994c?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7242586/jake"}, "edited": false, "score": 0, "creation_date": 1482873184, "post_id": 41352196, "comment_id": 69906349, "body": "I would then iterate through the string array and execute the INSERT INTO statement for each string in the array. However, be mindful that this can lead you open to SQL injection if the dynamic query isn&#39;t parameterized."}], "tags": [], "owner": {"reputation": 181, "user_id": 7242586, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6c1678c1753c1ce5e9bc332cec50994c?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7242586/jake"}, "is_accepted": false, "score": 2, "last_activity_date": 1482872543, "creation_date": 1482872543, "answer_id": 41352196, "question_id": 41351774, "link": "https://stackoverflow.com/questions/41351774/loop-to-insert-multiple-values-into-sql-server/41352196#41352196", "title": "Loop to insert multiple values into SQL Server", "body": "<p>Don't know if the excel spreadsheet has special formatting, but if its in a CSV format, you can use SQL Server Import and Export Wizard to do this. Here's how:</p>\n\n<ol>\n<li>In SQL Server Management Studio, login to your database server.</li>\n<li>Right click the database you want to import data into and select <strong>Task -> Import Data</strong>\n<a href=\"https://i.stack.imgur.com/a3q5X.png\" rel=\"nofollow noreferrer\">Import Data Image</a></li>\n<li>On the <em>Choose Data Source</em> screen, choose Microsoft Excel from the <em>Data Source</em> drop down. Enter the file path to the excel spreadsheet in <em>Excel file path</em>. Select the appropriate Excel version in <em>Excel version</em>. If the first row in the spreadsheet contains the database column names, check the <em>First row has column names</em>. If it's just data, uncheck it.\n<a href=\"https://i.stack.imgur.com/4Qpn0.png\" rel=\"nofollow noreferrer\">Choose Data Source Image</a></li>\n<li>Click <strong>Next</strong> and choose <strong>Microsoft OLE DB Provider for SQL Server</strong> in the <em>Destination</em> drop down. Select your sql server name in <em>Server name</em> drop down. Choose <em>Authentication</em> option. Click <strong>Refresh</strong>, then choose the database you want to insert the Excel data into.</li>\n<li>On the <em>Specify Table Copy or Query</em> window, select <strong>Copy data from one or more table or views</strong>. Click <strong>Next</strong>.</li>\n<li>Select the check box next to <strong>Sheet1$</strong> in the <em>Source</em> column. Click in the <em>Destination</em> column and select the table you want to import the Excel data into. Clicking the <strong>Preview</strong> button will show the query and how the data will look in the new table. Click <strong>Next</strong>.</li>\n<li>The mapping should be good on the <em>Review Data Type Mapping</em> page. This window allows you to setup options on what SQL should do in regards to converting. Defaults should be fine. Click <strong>Next</strong>.</li>\n<li>Click <strong>Next</strong>. The import should run immediately.</li>\n<li>Review the summary page and click <strong>Finish</strong>.</li>\n<li>The import will perform several operations. Green check marks indicate that the operation was successful. Read circles with X's indicate failure. If you get a failure, post an image of it here with your data and the hyperlinked message from the <em>Message</em> column.</li>\n</ol>\n\n<p>If you want, you can check out the <strong>bulk insert</strong> command as well on MSDN. I don't have enough rep to post more images. I'll finish it later when I have enough.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1482875059, "post_id": 41352324, "comment_id": 69907006, "body": "This seems to make things a lot easier and i will have to try to use this method in other projects I have worked on. However I am getting an error."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1482875167, "post_id": 41352324, "comment_id": 69907043, "body": "The error says: Parameter object is improperly defined. Inconsistent or incomplete information was provided."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1482875379, "post_id": 41352324, "comment_id": 69907113, "body": "@SteveG - I&#39;m not surprised at all, this isn&#39;t really complete code (just an illustration of the concept) - you also need to supply the parameter type and the specify that it&#39;s an input value.  See <a href=\"http://stackoverflow.com/documentation/vba/3578/working-with-ado/12354/creating-parameterized-commands\">Documentation</a> for a more detailed sample of how to build a parameter."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1482938832, "post_id": 41352324, "comment_id": 69931405, "body": "For param1 - param121 would I need to create parameters for each one?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1482939080, "post_id": 41352324, "comment_id": 69931518, "body": "@SteveG - Yep. I usually automate building insert commands by reading the table schema and using that to build both the sql and parameters.  There&#39;s an <a href=\"http://stackoverflow.com/a/39135358/4088852\">example of reading the schema here</a>."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1482939819, "post_id": 41352324, "comment_id": 69931954, "body": "Okay perfect that makes things way easier. Thanks again!"}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483109600, "post_id": 41352324, "comment_id": 69998138, "body": "Hello again, How would you handle NULL values in a numeric field? I know that SQL Server would accept it however the Createparameters method does not allow it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483110100, "post_id": 41352324, "comment_id": 69998363, "body": "@SteveG - It&#39;s been a while since I inserted nulls, but IIR you have to set the parameter <code>.Attributes</code> to <code>adParamNullable</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483110387, "post_id": 41352324, "comment_id": 69998475, "body": "@SteveG - If you&#39;re building parameters using <code>OpenSchema</code> the field to check for that attribute is <code>.Fields(&quot;IS_NULLABLE&quot;)</code>."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483117049, "post_id": 41352324, "comment_id": 70001478, "body": "I updated my code because I believe I am doing it correctly after doing some research. But I am still getting the error thrown."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483117616, "post_id": 41352324, "comment_id": 70001756, "body": "@SteveG - Ah, I thought you were using <code>OpenSchema</code> to get parameter information.  <code>getType</code> needs to be the <i>database</i> type, not the cell type - it&#39;s also an enum, not a string. You can get all of this information by just <a href=\"http://stackoverflow.com/a/39135358/4088852\">querying the schema</a>."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483119249, "post_id": 41352324, "comment_id": 70002502, "body": "What do you mean when you say enum? I created a method getType which gives a type like this: adInteger , based on what the type in the db is."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483119342, "post_id": 41352324, "comment_id": 70002543, "body": "I was also having a lot of trouble trying to query the schema so I just worked around it. I&#39;m not the best programmer so my getType method is very impractical but it is just hard-coding the type based on the type in the db."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483119927, "post_id": 41352324, "comment_id": 70002795, "body": "@SteveG - I&#39;m guessing the <code>Size</code> parameter is where you&#39;re hitting issues. Unless everything is <code>VARCHAR(1000)</code>, it has to match the database field size if you specify it. Whether or not it&#39;s <i>required</i> is dependent on the driver you&#39;re using and the backend."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483124341, "post_id": 41352324, "comment_id": 70004771, "body": "I fixed that part of the code making sure to have the correct size parameter. However I still get an error thrown saying: &quot;Application uses a value of the wrong type for the current operation.&quot; It throws it on a Null value."}, {"owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "edited": false, "score": 0, "creation_date": 1483124506, "post_id": 41352324, "comment_id": 70004837, "body": "It seems to throw it on items that have are supposed to have a integer value but instead have a null. Is it possible that I am not changing the attribute to allow null values correctly?"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 4, "last_activity_date": 1482873395, "creation_date": 1482873395, "answer_id": 41352324, "question_id": 41351774, "link": "https://stackoverflow.com/questions/41351774/loop-to-insert-multiple-values-into-sql-server/41352324#41352324", "title": "Loop to insert multiple values into SQL Server", "body": "<p>I would generally agree that using an SSIS package would be the best way to approach this, but if you want to do it through code, it's not difficult with a parameterized query in ADODB:</p>\n\n<p>Use the <code>?</code> placeholder for parameters when you're building your INSERT statement, and add parameters to an <code>ADODB.Command</code> object:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim comm As ADODB.Command\nSet comm = New ADODB.Command\nDim param As ADODB.Parameter\n\nSQLStr = \"Insert Into [db] Values(\"\nFor i = 1 To 121\n    SQLStr = SQLStr &amp; \"?,\"\n    Set param = New ADODB.Parameter\n    param.Name = \"Param\" &amp; i\n    comm.Parameters.Append param\nNext i\nSQLStr = Left(SQLStr, Len(SQLStr) - 1) &amp; \");\"\n</code></pre>\n\n<p>When you're done, you'll have a matched set of parameters and placeholders.\nThen open your connection (or do it before this, it really doesn't make much difference) and set up the command:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>comm.ActiveConnection = Cn\ncomm.CommandText = SQLStr\ncomm.CommandType = adCmdText\n</code></pre>\n\n<p>Finally, loop through your rows for each record, loop through the values and assign them to parameters, and execute for each row:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>lastrow = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\nFor x = 2 To lastrow\n    For i = 1 To 121\n        comm.Parameters.Item(\"Param\" &amp; i).Value = Cells(x, i).Value\n    Next\n    comm.Execute\nNext x\n</code></pre>\n\n<p>Note that ADODB Commands are optimized to be looped over - the backend treats this more like a batch insert, so there isn't really much point in trying to build a gigantic insert will all the records in it at once.</p>\n"}], "owner": {"reputation": 59, "user_id": 7241634, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/decb3c4ee047c65e37074fb42519ee68?s=128&d=identicon&r=PG&f=1", "display_name": "SteveG", "link": "https://stackoverflow.com/users/7241634/steveg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "accepted_answer_id": 41352324, "answer_count": 2, "score": 0, "last_activity_date": 1501241682, "creation_date": 1482870321, "last_edit_date": 1531161705, "question_id": 41351774, "link": "https://stackoverflow.com/questions/41351774/loop-to-insert-multiple-values-into-sql-server", "title": "Loop to insert multiple values into SQL Server", "body": "<p>I am trying to insert a lot of values into SQL Server in one SQL insert statement. So for example.. </p>\n\n<pre><code>Insert Into someDataBase\nValues(value1, value2, value3,..., value120, value121)\n</code></pre>\n\n<p>All these values will be in the correct order on a sheet in Excel. I already created a loop to go through all the 121 values but I can't think of a loop for the inserting the values without writing each value individually. </p>\n\n<p>Can anyone help me out? </p>\n\n<p>My code looks like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub AddRows()\n' In VBE you need to go Tools References and check Microsoft Active X Data Objects 2.x library\n\nDim Cn As ADODB.Connection\nDim Server_Name As String\nDim Database_Name As String\nDim User_ID As String\nDim Password As String\nDim SQLStr As String\n\n\nDim comm As ADODB.Command\nSet comm = New ADODB.Command\nDim param As ADODB.Parameter\nDim getType As String\n\nSQLStr = \"Insert Into [DB] Values(\"\nFor i = 1 To 121\n    'Get type\n    getType = CellType(i, Cells(2, i))\n    SQLStr = SQLStr &amp; \"?,\"\n    Set param = New ADODB.Parameter\n    param.Name = \"Param\" &amp; i\n    Set param = comm.CreateParameter(\"param\" &amp; i, getType, adParamInput, 1000)\n    param.Attributes = adParamNullable\n    Debug.Print (param.Type)\n    comm.Parameters.Append param\nNext i\nSQLStr = Left(SQLStr, Len(SQLStr) - 1) &amp; \");\"\n\nSet Cn = New ADODB.Connection\nCn.CommandTimeout = 0\nCn.Open \"Driver={SQL Server};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; _\n\";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\ncomm.ActiveConnection = Cn\ncomm.CommandText = SQLStr\ncomm.CommandType = adCmdText\n\n\nDim test As String\nlastrow = Sheet1.Cells(Sheet1.Rows.Count, \"A\").End(xlUp).Row\n'For x = 2 To lastrow\n    For i = 1 To 121\n        Debug.Print (Cells(2, i).Value)\n        comm.Parameters.Item(\"Param\" &amp; i).Value = Cells(2, i).Value\n    Next\n    comm.Execute\n'Next x\n\nCn.Close\nSet Cn = Nothing\n</code></pre>\n\n<p>End Sub</p>\n\n<p>This is a portion of my CellType Function:</p>\n\n<pre><code>Private Function CellType(Num) As MultipleValues\nApplication.Volatile\nCellType.CellNum = 50\nSelect Case True\n    Case Num = 1\n        CellType.CellType = adInteger\n    Case Num = 2\n        CellType.CellType = adInteger\n    Case Num = 3\n        CellType.CellType = adVarWChar\n        CellType.CellNum = 255\n    Case Num = 4\n        CellType.CellType = adCurrency\n    Case Num = 5\n        CellType.CellType = adVarWChar\n        CellType.CellNum = 255\n</code></pre>\n\n<p>The values for the first 5 values are: 0,   null,   6071/1, 44.5,   Biltmore Fleur De Lis Collection Authentic Wrought Iron</p>\n\n<p>It breaks on the second value which is a null but should be an integer.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1482870648, "post_id": 41351770, "comment_id": 69905355, "body": "<code>Column</code> should be <code>Columns</code>, and you haven&#39;t declared <code>c</code> or assigned it a value.  But you won&#39;t be able to compare an entire column to your strings anyway.  And if you are trying to just compare the values for a single row for a single column (i.e. a single cell) then that cell&#39;s <code>Value</code> can&#39;t be equal to both <code>Mystring</code> <b>and</b> <code>MystringII</code> at the same time."}], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1483112559, "post_id": 41352399, "comment_id": 69999410, "body": "The issue I was having involved hidden sheets, so <code>If WS.Visible = xlSheetVisible Then</code> was added and then it worked"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1483112675, "post_id": 41352399, "comment_id": 69999459, "body": "But is it possible to resize it so it deletes <code>row1</code> and everything between <code>row1</code> and <code>row2</code>. I tried <code>.Rows(row1).Resize(row2).Delete</code> it didn&#39;t work."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1483114396, "post_id": 41352399, "comment_id": 70000266, "body": "Or to make it simpler, after <code>row1</code> is deleted then everything below <code>row2</code> can be deleted."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1483120804, "post_id": 41352399, "comment_id": 70003202, "body": "Nvm figured it out, it had to be placed after the then."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1483165446, "post_id": 41352399, "comment_id": 70014996, "body": "A.S.H - I was helping MTBthePRO with another problem, and then we started looking at this one (and <b>finally</b> [thanks to what is probably a bug in google sheets] discovered some veryhidden worksheets) but also noticed problems with the error handling in your code.  The first hidden sheet was handled successfully but, because<code>Err.Clear</code> clears error information but does not exit out of &quot;error handling&quot; mode, once we hit the second of the hidden sheets the code crashed out.  If you are happy for me to do so, I will edit your answer to include what I believe is correct error handling code."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1483181567, "post_id": 41352399, "comment_id": 70018159, "body": "@YowE3K Basically <code>On Error Resume Next</code> with checking the <code>Err.Number</code> afterwards should do, in the original version I tried to make it shorter but true if failed on the second loop if the error occurs again. I edited and this version should work as I tested it, If the problem is not solved plz tell me."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1483207736, "post_id": 41352399, "comment_id": 70024612, "body": "Yeah - that should be OK - but <code>Err.Clear</code> is superfluous because the error information will automatically be cleared once the next <code>On Error</code> statement is executed (next time through the loop) or an <code>Exit Sub</code> occurs (implicitly at the end of the code).  And, apart from now checking <code>Err.Number</code>, the error information isn&#39;t actually being used in the code, so there&#39;s probably no point in clearing it anyway."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1483181399, "last_edit_date": 1483181399, "creation_date": 1482873923, "answer_id": 41352399, "question_id": 41351770, "link": "https://stackoverflow.com/questions/41351770/vba-delete-one-row-if-values-match/41352399#41352399", "title": "VBA: Delete one row if values match", "body": "<p>I suppose that when both strings exist in column \"C\", you want to compare if columns \"A\" and \"B\" are equal in both rows. You can use the following code and easily adapt it if more columns need to be compared on the matched rows:</p>\n\n<pre><code>Sub Delete_DuplicateTotalNet()\n\n    Dim WS As Worksheet, row1 As Long, row2 As Long\n    For Each WS In Sheets\n        With WS\n            On Error Resume Next\n            row1 = WorksheetFunction.Match(\"Total Net\", .Columns(\"C\"), 0)\n            row2 = WorksheetFunction.Match(\"Program Operating Net\", .Columns(\"C\"), 0)\n            If Err.Number &lt;&gt; 0 Then GoTo NextWS\n            If .Range(\"A\" &amp; row1).Value = .Range(\"A\" &amp; row2).Value And _\n               .Range(\"B\" &amp; row1).Value = .Range(\"B\" &amp; row2).Value Then\n               .Rows(row1).Delete\n            End If\n        End With\nNextWS:\n     Err.Clear\n     Next WS\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "is_accepted": false, "score": 0, "last_activity_date": 1483112914, "last_edit_date": 1483112914, "creation_date": 1482944720, "answer_id": 41366596, "question_id": 41351770, "link": "https://stackoverflow.com/questions/41351770/vba-delete-one-row-if-values-match/41366596#41366596", "title": "VBA: Delete one row if values match", "body": "<p>This is what it looks like but causes a runtime error</p>\n\n<pre><code>    Sub Delete_DuplicateTotalNet()\n\n        Dim WS As Worksheet, row1 As Long, row2 As Long, rng As Long\nFor Each WS In Sheets\nOn Error GoTo NextWS\n\nWith WS\n     If WS.Visible = xlSheetVisible Then\n\n    row1 = WorksheetFunction.Match(\"Total Net\", .Columns(3), 0)\n    row2 = WorksheetFunction.Match(\"Program Operating Net\", .Columns(3), 0)\n    If .Range(\"D\" &amp; row1).Value = .Range(\"D\" &amp; row2).Value And _\n    .Range(\"E\" &amp; row1).Value = .Range(\"E\" &amp; row2).Value And _\n    .Range(\"F\" &amp; row1).Value = .Range(\"F\" &amp; row2).Value And _\n    .Range(\"G\" &amp; row1).Value = .Range(\"G\" &amp; row2).Value And _\n    .Range(\"H\" &amp; row1).Value = .Range(\"H\" &amp; row2).Value And _\n    .Range(\"I\" &amp; row1).Value = .Range(\"I\" &amp; row2).Value And _\n    .Range(\"J\" &amp; row1).Value = .Range(\"J\" &amp; row2).Value And _\n    .Range(\"K\" &amp; row1).Value = .Range(\"K\" &amp; row2).Value Then\n    .Rows(row1).Delete\n    End If\n   End If\n   End With\n   NextWS:\n  Err.Clear\n  Next WS\n\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "accepted_answer_id": 41352399, "answer_count": 2, "score": 0, "last_activity_date": 1483181399, "creation_date": 1482870317, "last_edit_date": 1483113207, "question_id": 41351770, "link": "https://stackoverflow.com/questions/41351770/vba-delete-one-row-if-values-match", "title": "VBA: Delete one row if values match", "body": "<p>I am trying to create a macro that looks for <strong>\"Total net</strong>\" and <strong>\"Program Operation net\"</strong> in column C. Once located, the macro compares the rows of these two cells and of their values match then row of <strong>\"Total Net\"</strong> get deleted.</p>\n\n<p>This is my code so far...</p>\n\n<pre><code>Sub DeletingEmptyPages()\nDim WS As Worksheet\nFor Each WS In Sheets\n\nDim Mystring As String\nDim MystringII As String\n\nMystringII = \"Total Net\"\nMystring = \"Program Operating Net\"\n\n\n  Dim n As Long\n  Dim nlast As Long\n  Dim rw As Range\n  Set rw = ActiveWorkbook.ActiveSheet.UsedRange.Rows\n  nlast = rw.count\n  For n = nlast To 9 Step -1\n      If (Column(c).Value = MystringII And Column(c).Value = Mystring) Then\n      rw.Rows(n).Delete\n\n      End If\n      Next n\n      Next WS\n      End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1482872524, "post_id": 41351697, "comment_id": 69906096, "body": "The first thing you need to do is to <b>group</b> these controls. Take a look here for more information on how to group controls: <a href=\"https://support.office.com/en-us/article/Group-copy-move-or-align-controls-on-a-worksheet-6d81c21a-2cb5-4d54-8062-ee5ec72b1bd3\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7347195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4f4840d3ec42de82b19726192841dd?s=128&d=identicon&r=PG&f=1", "display_name": "ThatsEarElephant", "link": "https://stackoverflow.com/users/7347195/thatsearelephant"}, "edited": false, "score": 0, "creation_date": 1482876147, "post_id": 41352328, "comment_id": 69907355, "body": "Oh my!  Thank you so much!  I&#39;ve been everywhere.  You are the first and only to both understand my problem and help me out!"}, {"owner": {"reputation": 1, "user_id": 7347195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4f4840d3ec42de82b19726192841dd?s=128&d=identicon&r=PG&f=1", "display_name": "ThatsEarElephant", "link": "https://stackoverflow.com/users/7347195/thatsearelephant"}, "edited": false, "score": 0, "creation_date": 1482877677, "post_id": 41352328, "comment_id": 69907844, "body": "I am concerned I did something wrong.  I&#39;ve shared this file with my co-workers.  I had them enable macros on the file they received.  My coworkers cannot get their toggle buttons to work on the copy they received."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1482909818, "last_edit_date": 1482909818, "creation_date": 1482873424, "answer_id": 41352328, "question_id": 41351697, "link": "https://stackoverflow.com/questions/41351697/group-400-togglebuttons-in-excel-and-assign-just-1-vba-code/41352328#41352328", "title": "Group 400 ToggleButtons in Excel and assign just 1 VBA code", "body": "<p>My suggestion would be to create a class module, name it clsToggle </p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents TGButton As ToggleButton\n\nPrivate Sub TGButton_Click()\n    With TGButton\n        If .Caption = \"G\" Then\n            .Caption = \"Y\"\n        Else\n            .Caption = \"G\"\n        End If\n        If .Value = True Then\n            .BackColor = vbGreen\n        Else\n            .BackColor = vbYellow\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Then add in a normal module the following code</p>\n\n<pre><code>Option Explicit\n\nDim TBTs() As New clsToggle\n\nSub Init_ToggleButtons()\n\nDim obj As OLEObject\nDim TGCount As Integer\n    TGCount = 0\n\n    For Each obj In ActiveSheet.OLEObjects\n        If TypeOf obj.Object Is ToggleButton Then\n            TGCount = TGCount + 1\n            ReDim Preserve TBTs(1 To TGCount)\n            Set TBTs(TGCount).TGButton = obj.Object\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Run the Sub Init_ToggelButtons and all the Togglebuttons will react to the click event defined in the class module.\nAnd of course remove your code you may already have defined for your togglebuttons.</p>\n\n<p>Edit: You need to run Init_ToggelButtons every time you open the workbook. So it's best to add the following sub in the module</p>\n\n<pre><code>Sub Auto_open()\n    Init_ToggleButtons\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7347195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4f4840d3ec42de82b19726192841dd?s=128&d=identicon&r=PG&f=1", "display_name": "ThatsEarElephant", "link": "https://stackoverflow.com/users/7347195/thatsearelephant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482909818, "creation_date": 1482869950, "last_edit_date": 1531164843, "question_id": 41351697, "link": "https://stackoverflow.com/questions/41351697/group-400-togglebuttons-in-excel-and-assign-just-1-vba-code", "title": "Group 400 ToggleButtons in Excel and assign just 1 VBA code", "body": "<p>Here's what I need:\nI have a Toggle Button.  I wrote a small VBA Code in Sheet1 to make this button turn green and show caption \"G\" when pressed, or turn yellow and show caption \"Y\" when depressed.  Works great. </p>\n\n<p>But I have 400 of them on Sheet1 I need to apply this code to.  I don't know how to use UserForm, I can't figure out macros, and manually entering the code was both tedious and corrupted all my ComboBox entries.</p>\n\n<pre><code>Sub ToggleButton1_Click()\n    If ToggleButton1.Caption = \u201cG\u201d Then\n        ToggleButton1.Caption = \"Y\"\n    Else\n        ToggleButton1.Caption = \"G\"\n    End if\n    If ToggleButton1.Value = True Then\n        ToggleButton1.BackColor = vbGreen\n    Else\n        ToggleButton1.BackColor = vbYellow\n    End If\nEnd Sub\n</code></pre>\n\n<p>I know the code I've just entered looks sloppy at best (I don't even know how to use the format for the forum).  But any pointers would be appreciated.  </p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2003"], "answers": [{"tags": [], "owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "is_accepted": false, "score": 0, "last_activity_date": 1488826327, "creation_date": 1488826327, "answer_id": 42633334, "question_id": 41351565, "link": "https://stackoverflow.com/questions/41351565/view-info-of-custom-menu/42633334#42633334", "title": "View Info Of Custom Menu", "body": "<p>This might need some tweaking, depending on the structure of the menu. but once you get a handle of how this works, you should be able to make changes to it if needed.</p>\n\n<p>First, you need to find out the name of the Custom menu. if you know that already, then skip this step. Else grab the name(s) returned from this:</p>\n\n<pre><code> Dim x As Integer\n For x = 1 To CommandBars.Count\n    If CommandBars(x).BuiltIn = False Then\n      Debug.Print x, CommandBars(x).Name, CommandBars(x).BuiltIn\n   End If\n Next x\n</code></pre>\n\n<p>Then, pass the name of the Custom Menu to this procedure. like i said, depending on the way the menu is setup, this may or may not return everything in it, that is where you may need to customize it:</p>\n\n<pre><code>Private Sub ReadMenuControls(ByVal strCmdBar As String)\n\nOn Error GoTo errhandler\n\nDim x, y As Integer\n\nDim SubMenu As Object\n\n With CommandBars(strCmdBar)\n  Debug.Print \"Control Count Main: \", .Controls.Count\n\n      For x = 1 To .Controls.Count\n            With .Controls(x)\n            Debug.Print x &amp; \" &lt;== \" &amp; .Caption &amp; \" ==&gt;\"\n                    If .Type = 1 Then 'Command Button\n\n                         Debug.Print \"Button\", x, .Caption, .Type, .ID, .FaceId, .Style, .onaction\n\n                    Else 'If .Type = 10 Then  'Menu\n\n                        Set SubMenu = CommandBars(strCmdBar).Controls(x)\n\n                        For y = 1 To SubMenu.Controls.Count\n                              With .Controls(y)\n                                 Debug.Print \"  * Button\", y, .Caption, .Type, .ID, .FaceId, .Style, .onaction\n                              End With\n                        Next\n                   End If\n            End With\n      Next\n\n End With\n\nExit Sub\n\nerrhandler:\n If Err.Number &lt;&gt; 438 Then\n  Debug.Print \"ReadMenuControls\", Err.Number, Err.description\n End If\n Resume Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593956524, "creation_date": 1482869287, "last_edit_date": 1593956524, "question_id": 41351565, "link": "https://stackoverflow.com/questions/41351565/view-info-of-custom-menu", "title": "View Info Of Custom Menu", "body": "<p>In Access 2003, there was a custom menu created.  How can I use VBA to view the details of the menu?</p>\n\n<p>I.E. get a print out of what each option does?  (the name, &amp; query it runs)\nIf the custom menu has an option to \"Run Daily\" and what that does is runs query titled qry_dly</p>\n\n<p>Then I would ideally like to see the VBA output like so\nRun Daily --> qry_dly</p>\n"}, {"tags": ["facebook", "vba", "url", "get", "web-crawler"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1482869418, "post_id": 41351549, "comment_id": 69904807, "body": "<code>I don&#39;t think there&#39;s nothing wrong with what I&#39;m asking</code> - there&#39;s no harm in asking. But scraping ethically does require a few extra considerations. Ensure you check the <code>robots.txt</code> file so you do not scrape files that the server owner does not wish you to. If you scrape more than one page from the same server, put a couple of seconds delay between each one. Declare your User Agent honestly and put a contact page in there for your robot, so server operators can get in touch with you if they wish."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1482869550, "post_id": 41351549, "comment_id": 69904878, "body": "Personally, I would not do this in VBA, since the libraries to do it are not likely to be available in that language. Do it in a modern language with a flourishing ecosystem: PHP, Node, Python, Ruby, Java, etc. Then get that system to output data into something your Excel spreadsheet can easily consume in a small amount of code. Related point: don&#39;t build an application inside office applications - they are often unmaintainable."}, {"owner": {"reputation": 5, "user_id": 7347170, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210050660696624/picture?type=large", "display_name": "Victor Dias", "link": "https://stackoverflow.com/users/7347170/victor-dias"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1482869906, "post_id": 41351549, "comment_id": 69905027, "body": "Thanks a lot Halfer, for the edits and for the replies. Although I do have knowledge on Java, It&#39;s just that I was already using VBA for filtering and changing the hundreds of thousands of data in Excel. I didn&#39;t think I&#39;d need to mix languages, but it&#39;s no big deal, really. Would it be advisable to use Facebook APIs (if there are any that would help in this matter)."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1482870340, "post_id": 41351549, "comment_id": 69905209, "body": "Oh right, apologies, I didn&#39;t see the URLs are all Facebook - I got distracted by the <code>web-crawler</code> tag. That&#39;s a different matter - in that case I believe you <i>must</i> use the API. I haven&#39;t used it myself, but I hear that Facebook consider it a violation of their terms of use to scrape their content manually. Whilst I do not have a lot of sympathy with Facebook Megacorp, some of that will be motivated by wanting to protect people&#39;s private data (I appreciate that does not apply to your use case)."}, {"owner": {"reputation": 4782, "user_id": 101130, "user_type": "registered", "profile_image": "https://graph.facebook.com/690267162/picture?type=large", "display_name": "WizKid", "link": "https://stackoverflow.com/users/101130/wizkid"}, "edited": false, "score": 0, "creation_date": 1482890370, "post_id": 41351549, "comment_id": 69910679, "body": "Scraping Facebook is not allowed according our Scraping policy. I assume you read it?"}, {"owner": {"reputation": 5, "user_id": 7347170, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210050660696624/picture?type=large", "display_name": "Victor Dias", "link": "https://stackoverflow.com/users/7347170/victor-dias"}, "edited": false, "score": 0, "creation_date": 1483364919, "post_id": 41351549, "comment_id": 70061553, "body": "Thanks for being such a prick. Did you even bother reading my OP? Basically I need to know whether the page exists or not, and if so get the telephone or e-mail from the Store. It&#39;s a freaking STORE, which would love to have their addresses/telephones available to as many people as possible. It&#39;s completely not like I wish to get people photos or the such. there&#39;s nothing on robots.txt that disallows this so, if you can&#39;t collaborate, then don&#39;t come with &quot;I assume you read it?&quot; talk.  Just because you&#39;re an admin/frequent poster doesn&#39;t entitle you to mistreat one genuinely asking for help."}], "owner": {"reputation": 5, "user_id": 7347170, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210050660696624/picture?type=large", "display_name": "Victor Dias", "link": "https://stackoverflow.com/users/7347170/victor-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482869282, "creation_date": 1482869227, "last_edit_date": 1482869282, "question_id": 41351549, "link": "https://stackoverflow.com/questions/41351549/crawling-facebook-store-pages", "title": "Crawling facebook store pages", "body": "<p>I need to check automatically thousands of possible websites, using VBA, if possible. Let me give you an example:</p>\n\n<p>Say, I have these 2 columns in Excel:</p>\n\n<pre><code>x -  A  -                        B                     - \n1 - ID1 - https://www.facebook.com/pg/ID1/about/\n2 - ID2 - https://www.facebook.com/pg/ID2/about/\n3 - ID3 - https://www.facebook.com/pg/ID3/about/\n4 - ID4 - https://www.facebook.com/pg/ID4/about/\n</code></pre>\n\n<p>ID1~ID4 are basically POSSIBLE Facebook store web pages, like this one, for example:\n<a href=\"https://www.facebook.com/pg/universoimportadosoficial/about/\" rel=\"nofollow noreferrer\">https://www.facebook.com/pg/universoimportadosoficial/about/</a></p>\n\n<p>What I need is</p>\n\n<p>a) Check if the FB page exists, i.e. not returning this: <a href=\"https://www.facebook.com/pg/asdsdsadadasdasad/about/\" rel=\"nofollow noreferrer\">https://www.facebook.com/pg/asdsdsadadasdasad/about/</a></p>\n\n<p>b) If it exists, using code try to extract some information from the store, such as opening hours, address, telephone and/or e-mail.</p>\n\n<p>I don't think there's nothing wrong with what I'm asking, since all this information is readily available, since those pages are actually public.</p>\n"}, {"tags": ["excel", "variables", "scope", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1482866994, "post_id": 41351016, "comment_id": 69903820, "body": "What kind of &quot;placeholder&quot; are you talking about?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482867227, "post_id": 41351016, "comment_id": 69903921, "body": "Do you mean something similar to <code>string.Format(&quot;{0}{1}&quot;, foo, bar)</code> in .NET?"}, {"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482867343, "post_id": 41351016, "comment_id": 69903958, "body": "@Comintern I don&#39;t know what you mean. By placeholder, I meant instead of running <code>Call convert(speedmph, speedkph, speedfts)</code> I use <code>Call convert(speedmph, 0, speedfts)</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482867543, "post_id": 41351016, "comment_id": 69904047, "body": "I have no idea what you mean.  In that context, <code>0</code> is a number, not a variable. If you need to pass the value back by reference, <code>speedkph</code> <b><i>is</i></b> the &quot;placeholder&quot;."}, {"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1482868053, "post_id": 41351016, "comment_id": 69904245, "body": "Ok I took out the word placeholder. Sorry for the confusion."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1482868727, "post_id": 41351016, "comment_id": 69904531, "body": "<code>speedkph</code> you <code>Dim</code>med in <code>problem1</code> is not the same <code>speedkph</code> you declared in <code>convert</code>. They are completely unrelated and VB has no way to know that the value <code>convert</code> put into its <code>speedkph</code> argument must be saved into the <code>speedkph</code> variable. To understand that better, give your <code>Dim</code>med variables completely different names but keep <code>Sub convert(speedmph, speedkph, speedfts)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "edited": false, "score": 0, "creation_date": 1483036020, "post_id": 41351485, "comment_id": 69972659, "body": "Thanks for the detailed response."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 4, "last_activity_date": 1506029764, "last_edit_date": 1506029764, "creation_date": 1482868917, "answer_id": 41351485, "question_id": 41351016, "link": "https://stackoverflow.com/questions/41351016/variable-scope-how-vba-decides-when-to-override-variables/41351485#41351485", "title": "Variable Scope: How VBA Decides When to Override Variables", "body": "<p>Regarding scope, the parameters for a <code>Function</code> or <code>Sub</code> only have scope within the <code>Function</code> or <code>Sub</code> that they are declared in.  The same thing holds true for variables declared with the keyword <code>Dim</code> (or <code>ReDim</code> for arrays).  For <em>undeclared</em> variables, the scope is the next highest scope if a matching identifier exists (module level private variables, then global variables). If no identifier with a greater scope exists, it is implicitly declared as a <code>Variant</code> in <em>local</em> scope.  So, in this line...</p>\n\n<blockquote>\n<pre><code>Sub convert(speedmph, speedkph, speedfts)\n</code></pre>\n</blockquote>\n\n<p>...the parameters <code>speedmph</code>, <code>speedkph</code>, and <code>speedfts</code> are all local to <code>Sub convert</code> (and are implicitly <code>Variant</code> because there aren't <code>As</code> statements), and in this line...</p>\n\n<blockquote>\n<pre><code>Dim speedmph As Double, speedkph As Double, speedfts As Double\n</code></pre>\n</blockquote>\n\n<p>...the parameters <code>speedmph</code>, <code>speedkph</code>, and <code>speedfts</code> are all local to <code>Sub problem1()</code>.</p>\n\n<hr>\n\n<p>That out of the way, let's address <strong><em>why</em></strong> your <code>MsgBox</code> shows anything at all.  The default method of passing parameters is <code>ByRef</code>, so if you were to actually specify all of the implicit parts of your <code>Sub</code> declaration, it would look like this:</p>\n\n<pre><code>Public Sub convert(ByRef speedmph As Variant, ByRef speedkph As Variant, _\n                   ByRef speedfts As Variant)\n</code></pre>\n\n<p>When you call it like this...</p>\n\n<blockquote>\n<pre><code>Call convert(speedmph, speedkph, speedfts)\n</code></pre>\n</blockquote>\n\n<p>...you pass it <strong><em>references</em></strong> to the local variables <code>speedmph</code>, <code>speedkph</code>, <code>speedfts</code> you declared in <code>Sub problem1()</code>.  The <code>Sub convert</code> assigns values to those references, but each procedure only holds it's own <strong><em>copy</em></strong> of the reference in local scope.  The identifiers are completely irrelevant at this point.  In fact, this works exactly the same as your sample code (only the identifiers have been changed):</p>\n\n<pre><code>Sub problem1()\n    Dim speedmph As Double, speedkph As Double, speedfts As Double\n\n    speedmph = Val(InputBox(\"Enter a speed (mph)\"))\n    Call convert(speedmph, speedkph, speedfts)\n    MsgBox \"The speed is \" &amp; speedkph &amp; \" km/hr and \" &amp; speedfts &amp; \"ft/s.\"\n\nEnd Sub\n\nSub convert(foo, bar, baz)\n    bar = foo * 1.609\n    baz = foo * 1.467\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Now to answer your specific question, the reason you can't use a \"placeholder\" value of <code>0</code> is that <code>0</code> isn't a variable - it's a literal. When it's passed to <code>Sub convert</code>, the only place the reference exists is as a variable on the call stack - <code>Sub problem1()</code> doesn't hold a reference to it, so there's no way for <code>Sub problem1()</code> to tell <em>what</em> <code>Sub convert</code> does with it.  The stack variable is destroyed when <code>Sub convert</code> returns and the call stack unwinds. Basically, passing a literal to a <code>ByRef</code> parameter is functionally equivalent to passing it <code>ByVal</code>.</p>\n"}], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "accepted_answer_id": 41351485, "answer_count": 1, "score": 0, "last_activity_date": 1506029764, "creation_date": 1482866682, "last_edit_date": 1531164843, "question_id": 41351016, "link": "https://stackoverflow.com/questions/41351016/variable-scope-how-vba-decides-when-to-override-variables", "title": "Variable Scope: How VBA Decides When to Override Variables", "body": "<p>I have the following VBA code. </p>\n\n<pre><code>Option Explicit\n\nSub problem1()\n    Dim speedmph As Double, speedkph As Double, speedfts As Double\n\n    speedmph = Val(InputBox(\"Enter a speed (mph)\"))\n    Call convert(speedmph, speedkph, speedfts)\n    MsgBox \"The speed is \" &amp; speedkph &amp; \" km/hr and \" &amp; speedfts &amp; \"ft/s.\"\n\nEnd Sub\n\nSub convert(speedmph, speedkph, speedfts)\n    speedkph = speedmph * 1.609\n    speedfts = speedmph * 1.467\nEnd Sub\n</code></pre>\n\n<p>I've noticed that when I called the convert procedure as it is shown above, it worked.\nBut if I tried to insert a value for speedkph (e.g.  0),  the <code>convert</code> \nprocedure does not override that  and MsgBox prints out 0 for speedkph.</p>\n\n<p>Why doesn't  <code>convert</code> override the <code>0</code> even though it forces\nthe variable to change in its function definition?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482877939, "post_id": 41350885, "comment_id": 69907940, "body": "if you have a working <code>.bat</code>, simply lauch it from VBA: <code>Shell myScript.bat</code>"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1482878170, "post_id": 41350885, "comment_id": 69908024, "body": "Why copy&amp;rename? Why <i>not</i> <code>copy &quot;1.pdf&quot; &quot;ABC\\John.pdf&quot;</code> (Does it have to be &quot;ABC\\\\&quot; because of the need to <i>escape</i>?)"}, {"owner": {"reputation": 2114, "user_id": 165164, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GCuan.jpg?s=128&g=1", "display_name": "Anne Gunn", "link": "https://stackoverflow.com/users/165164/anne-gunn"}, "edited": false, "score": 0, "creation_date": 1482878426, "post_id": 41350885, "comment_id": 69908096, "body": "Can you show the VBA code that copies the one file at a time? That&#39;s what you need help with, so a copy of it will help your potential helpers."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1482877929, "post_id": 41352003, "comment_id": 69907937, "body": "Only one mention, when i try to activate:     With ActiveWorkbook.Sheets(&quot;Linkuire&quot;)         Set rRenameList = .Range(&quot;C2&quot;, .Cells(.Rows.Count, &quot;C&quot;).End(xlUp))         If .Row &lt; 2 Then Exit Sub   &#39;No data     End With &lt;BR&gt; it says: Run time error 438, Object doesn&#39;t support this property or method"}, {"owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "edited": false, "score": 0, "creation_date": 1482879569, "post_id": 41352003, "comment_id": 69908390, "body": "I think it was because of the formulas. Even if the cell was &quot;&quot; (empty) it has formulas running in it. I only need to take into account cells that have value (ignoring the cells with formulas that have no output - ex. &quot; &quot; )"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1482871479, "creation_date": 1482871479, "answer_id": 41352003, "question_id": 41350885, "link": "https://stackoverflow.com/questions/41350885/vba-multiply-a-file-copy-and-rename-all-after-list/41352003#41352003", "title": "VBA: Multiply a file (copy) and rename all after list", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub CopyFileForEachName()\n\n    Dim rRenameList As Range\n    Dim rNameCell As Range\n    Dim sFileToCopyPath As String\n    Dim sFolderPath As String\n    Dim sFileName As String\n    Dim sExt As String\n    Dim sNewSubFolder As String\n    Dim sCopyErr As String\n    Dim sResultsMsg As String\n    Dim lSuccessfulCopies As Long\n    Dim i As Long\n\n    'These are invalid characters for the subfolder name (the double quote \"\" will be evaluated as a single double quote\")\n    Const sInvalidChar As String = \"\\/:*?\"\"&lt;&gt;|\"\n\n    If Len(ActiveWorkbook.Path) &gt; 0 Then ChDir ThisWorkbook.Path        'Start in same folder as the active workbook\n    sFileToCopyPath = Application.GetOpenFilename(\"All Files, *.*\")     'Prompt user to select file to copy\n    If sFileToCopyPath = \"False\" Then Exit Sub  'Pressed cancel\n\n    sFolderPath = Left(sFileToCopyPath, InStrRev(sFileToCopyPath, Application.PathSeparator))   'Extract the folder path\n    sExt = Mid(sFileToCopyPath, InStrRev(sFileToCopyPath, \".\"))                                 'Extract the extension\n\n    'Prompt user to select the range of cells that contain the rename list\n    'Pressing cancel will cause an error, resume next will suppress the error and GoTo 0 will remove the On Error condition\n    On Error Resume Next\n    Set rRenameList = Application.InputBox(\"Select the cells that contain the rename list.\", \"Rename Cells Selection\", Selection.Address, Type:=8)\n    On Error GoTo 0\n    If rRenameList Is Nothing Then Exit Sub 'Pressed cancel\n\n    'If the list of rename cells is ALWAYS in the same location, you can comment out the above code, and uncomment the following:\n    'With ActiveWorkbook.Sheets(\"Sheet1\")\n    '    Set rRenameList = .Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp))\n    '    If .Row &lt; 2 Then Exit Sub   'No data\n    'End With\n\n    'Prompt user to enter the destination subfolder name\n    'Change the Default parameter to provide a desired default subfolder name\n    sNewSubFolder = InputBox(Prompt:=\"Please enter the name of the subfolder that will store the copied and renamed files.\" &amp; Chr(10) &amp; _\n                                     \"Note that if the subfolder doesn't already exist, it will be created.\", _\n                             Title:=\"Destination Subfolder\", _\n                             Default:=\"ABC\")\n    If Len(Trim(sNewSubFolder)) = 0 Then Exit Sub   'Pressed cancel\n\n    'Verify valid subfolder name\n    For i = 1 To Len(sInvalidChar)\n        sNewSubFolder = Replace(sNewSubFolder, Mid(sInvalidChar, i, 1), \" \")\n    Next i\n    sNewSubFolder = WorksheetFunction.Trim(sNewSubFolder)\n    If Right(sNewSubFolder, Len(Application.PathSeparator)) &lt;&gt; Application.PathSeparator Then sNewSubFolder = sNewSubFolder &amp; Application.PathSeparator\n\n    'Attempt to create the subfolder\n    Err.Clear\n    On Error Resume Next\n    MkDir sFolderPath &amp; sNewSubFolder\n    On Error GoTo 0\n    If Err.Number &lt;&gt; 0 Then\n        'Failed to create the subfolder\n        'Check if the folder already exists\n        If Len(Dir(sFolderPath &amp; sNewSubFolder, vbDirectory)) = 0 Then\n            'Subfolder does NOT exist, the provided subfolder name must be invalid\n            MsgBox \"Unable to create subfolder named [\" &amp; Replace(sNewSubFolder, Application.PathSeparator, \"\") &amp; \"] because it is an invalid name.\" &amp; Chr(10) &amp; \"Exiting macro.\"\n            Exit Sub\n        Else\n            'Subfolder already exists, got error due to duplicate name\n            Err.Clear\n        End If\n    End If\n\n    'Loop through each cell and rename the file\n    For Each rNameCell In rRenameList.Cells\n        'Make sure to use the extension of the file being copied\n        If Right(rNameCell.Text, Len(sExt)) = sExt Then\n            sFileName = Replace(rNameCell.Text, sExt, \"\")\n        Else\n            sFileName = rNameCell.Text\n        End If\n\n        'Attempt to copy and rename the file to the destination subfolder\n        Err.Clear\n        On Error Resume Next\n        FileCopy sFileToCopyPath, sFolderPath &amp; sNewSubFolder &amp; sFileName &amp; sExt\n        On Error GoTo 0\n\n        'Record successes and failures\n        If Err.Number &lt;&gt; 0 Then\n            sCopyErr = sCopyErr &amp; Chr(10) &amp; sFileName &amp; sExt\n        Else\n            lSuccessfulCopies = lSuccessfulCopies + 1\n        End If\n    Next rNameCell\n\n    'Build results message\n    sResultsMsg = \"Successfully copied [\" &amp; sFileToCopyPath &amp; \"] \" &amp; lSuccessfulCopies &amp; \" times into subfolder [\" &amp; sNewSubFolder &amp; \"]\"\n    If Len(sCopyErr) &gt; 0 Then\n        sResultsMsg = sResultsMsg &amp; Chr(10) &amp; Chr(10) &amp; \"Failed to copy with the following names: \" &amp; Chr(10) &amp; sCopyErr\n    End If\n\n    'Display results message\n    MsgBox sResultsMsg\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2120, "favorite_count": 0, "accepted_answer_id": 41352003, "answer_count": 1, "score": -1, "last_activity_date": 1482871479, "creation_date": 1482865976, "last_edit_date": 1482867021, "question_id": 41350885, "link": "https://stackoverflow.com/questions/41350885/vba-multiply-a-file-copy-and-rename-all-after-list", "title": "VBA: Multiply a file (copy) and rename all after list", "body": "<p>I had a .bat file that worked but I need this in VBA now.</p>\n\n<p>I tried different approches but only managed to do this with one file at a time. So I keep starting over and over.</p>\n\n<p><strong>So:</strong></p>\n\n<ol>\n<li>I have a file (named 1.pdf)</li>\n<li>I have on a excel on Sheet1 (starting with A2) a list of file names</li>\n</ol>\n\n<p>I need VBA to create a folder named ABC (where-ever the Excel macro is located) and multiply 1.pdf as many times as needed and rename the copies with every name in the excel list.</p>\n\n<p><strong>Example:</strong> </p>\n\n<p>(i have in the same folder as the macro 1.pdf) and in Excel: </p>\n\n<p>A1</p>\n\n<ul>\n<li>John.pdf </li>\n<li>Dog.pdf </li>\n<li>Triangle.pdf</li>\n</ul>\n\n<p>After execution this would result in 1.pdf copied and renamed with all of those 3 names uploaded into folder :ABC</p>\n\n<p>In command prompt woud look like:</p>\n\n<pre><code>if not exist \"ABC\\\" mkdir %cd%\\ABC\\\ncopy \"1.pdf\" \"ABC\"\nren \"ABC\\1.pdf\" \"John.pdf\"\ncopy \"1.pdf\" \"ABC\"\nren \"ABC\\1.pdf\" \"Dog.pdf\"\ncopy \"1.pdf\" \"ABC\"\nren \"ABC\\1.pdf\" \"Triangle.pdf\"\n</code></pre>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1482866696, "post_id": 41350704, "comment_id": 69903700, "body": "You could use a <code>SUMIF</code> formula for this."}], "answers": [{"comments": [{"owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1482868113, "post_id": 41351086, "comment_id": 69904264, "body": "why the double --?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "edited": false, "score": 0, "creation_date": 1482870944, "post_id": 41351086, "comment_id": 69905483, "body": "@softwareisfun  To remind me that the expression is an array of <b>1</b> and <b>0</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1482867024, "creation_date": 1482867024, "answer_id": 41351086, "question_id": 41350704, "link": "https://stackoverflow.com/questions/41350704/how-to-add-data-based-on-dates/41351086#41351086", "title": "How to add data based on dates?", "body": "<p>Enter 10/1/2016 in <strong>C1</strong> and <code>=C1+1</code> in <strong>C2</strong> and copy down.</p>\n\n<p>Then in <strong>D1</strong> enter:</p>\n\n<pre><code>=SUMPRODUCT(--(A:A=C1)*(B:B))\n</code></pre>\n\n<p>and copy down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DfjPh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DfjPh.png\" alt=\"enter image description here\"></a></p>\n\n<p>If processing is too slow use something like:</p>\n\n<pre><code>=SUMPRODUCT(--($A$1:$A$10000=C1)*($B$1:$B$10000))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1482868856, "creation_date": 1482868856, "answer_id": 41351471, "question_id": 41350704, "link": "https://stackoverflow.com/questions/41350704/how-to-add-data-based-on-dates/41351471#41351471", "title": "How to add data based on dates?", "body": "<h2>SUMIFS</h2>\n\n<p>Formula in E2 is: <code>=SUMIFS($B:$B;$A:$A;D2)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/0Xghb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Xghb.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5967, "user_id": 399508, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/030ea300bdf13a1dc0f0a20db6a9205d?s=128&d=identicon&r=PG", "display_name": "software is fun", "link": "https://stackoverflow.com/users/399508/software-is-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 41351086, "answer_count": 2, "score": 0, "last_activity_date": 1482868856, "creation_date": 1482865209, "last_edit_date": 1531161705, "question_id": 41350704, "link": "https://stackoverflow.com/questions/41350704/how-to-add-data-based-on-dates", "title": "How to add data based on dates?", "body": "<pre><code>10/3/2016   -27\n10/3/2016   -2.13\n10/3/2016   -12.82\n10/3/2016   -7.25\n10/3/2016   -4.5\n10/3/2016   -19.23\n10/3/2016   -1.93\n10/3/2016   -10.7\n10/3/2016   -63.08\n10/3/2016   -12.82\n10/3/2016   -10.6\n10/3/2016   -14.72\n10/3/2016   -14.96\n10/4/2016   -152.5\n10/4/2016   -6.73\n10/4/2016   -12.99\n10/4/2016   -4.8\n10/4/2016   -16.76\n10/4/2016   -8.54\n10/4/2016   -7\n10/4/2016   27\n10/5/2016   93.67\n10/6/2016   -8.07\n10/7/2016   0.01\n10/7/2016   -565.27\n10/7/2016   -16.25\n10/7/2016   1690.7\n</code></pre>\n\n<p>I have a calendar spreadsheet and I want each date to hold the SUM of all the values for the above.</p>\n\n<p>For example</p>\n\n<pre><code>10/1/2016 - $0 (because no data is present)\n10/2/2016 - $0\n10/3/2016 - (Sum of all dates that are 10/3)\n</code></pre>\n\n<p>I do not know the number of transactions that appear. So there could be 0 or 30.</p>\n\n<p>I am using Excel 2016 (64-bit) on Windows 10 (64-bit) </p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "edited": false, "score": 0, "creation_date": 1482870541, "post_id": 41350898, "comment_id": 69905306, "body": "@Cornintern, my end requirement will have the idMatches and idMisMatches tabs. The mismatches tab will only have the key. The idMatches tab will have a compiled list of all the matches from SSB to both EDM and BB sheets, and associated data. To clarify, the key is a CUSIP. The associated data is an ISIN and SEDOL. In EDM, these are columns G&amp;H. In BB, they are columns D &amp; E. Could a dictionary add multiple values? IE key = CUSIP, defined as ISIN, SEDOL?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "edited": false, "score": 0, "creation_date": 1482870708, "post_id": 41350898, "comment_id": 69905377, "body": "@Swolerosis - Sure, there are a couple ways to do this.  The example above is actually storing the row numbers where you can retrieve them, but if you don&#39;t really care about that you can create a simple user <code>Type</code> with <code>Isin</code> and <code>Sedol</code> members and then store that as the value."}, {"owner": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "edited": false, "score": 0, "creation_date": 1482871970, "post_id": 41350898, "comment_id": 69905870, "body": "@Cornintern, how does a Type work? I would guess something along the lines of <code>SSBIds.Add SSB.Cells(i, 1).Value2, Type</code> but i&#39;m not sure exactly what that means."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "edited": false, "score": 0, "creation_date": 1482872158, "post_id": 41350898, "comment_id": 69905945, "body": "@Swolerosis - See <a href=\"https://msdn.microsoft.com/en-us/library/aa262341(v=vs.60).aspx\" rel=\"nofollow noreferrer\">this MSDN page</a>. It&#39;s for VB6, but it&#39;s the same in VBA (and the Office VBA documentation for it sucks)."}, {"owner": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "edited": false, "score": 0, "creation_date": 1482875280, "post_id": 41350898, "comment_id": 69907082, "body": "@Cornintern I added in the type and applied it through the code, but I&#39;m not even past the type section before I get an error."}, {"owner": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "edited": false, "score": 0, "creation_date": 1482875459, "post_id": 41350898, "comment_id": 69907145, "body": "@Cornintern, &quot;Invalid Inside Procedure&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "edited": false, "score": 0, "creation_date": 1482875516, "post_id": 41350898, "comment_id": 69907160, "body": "@Swolerosis - It needs to be outside the procedure.  ;-)  Put it at the top of the module right after <code>Option Explicit</code>."}, {"owner": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482876220, "post_id": 41350898, "comment_id": 69907377, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/131631/discussion-between-swolerosis-and-comintern\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 5, "last_activity_date": 1482866063, "creation_date": 1482866063, "answer_id": 41350898, "question_id": 41350521, "link": "https://stackoverflow.com/questions/41350521/building-and-comparing-arrays/41350898#41350898", "title": "Building and comparing arrays", "body": "<p>Arrays aren't the best containers to be using here.  Dictionaries have an <code>.Exists</code> method that uses a much faster hash lookup than a simple iteration that compares every value.</p>\n\n<p>Not only that, repeatedly calling <code>Redim Preserve</code> is <em>incredibly</em> inefficient compared to adding items to a <code>Dictionary</code>.  Every time you increase the array dimension, the <em>entire data set</em> gets copied to a newly allocated area of memory and the data pointer for the array gets updated to point to it.</p>\n\n<p>Example using Dictionaries (you'll need to add a reference to Microsoft Scripting Runtime):</p>\n\n<pre><code>Dim SSBIds As New Scripting.Dictionary\nFor i = 2 To endSSB\n    'Add an ID\\row number pair\n    SSBIds.Add SSB.Cells(i, 1).Value2, i\nNext i\n\nDim EDMIds As New Scripting.Dictionary\nFor i = 2 To endEDM\n    EDMIds.Add EDM.Cells(i, 9).Value2, i\nNext i\n\nDim IdMatches As New Scripting.Dictionary\nDim IdMisMatches As New Scripting.Dictionary\nDim key As Variant\nFor Each key In SSBIds\n    'If it's in the other dictionary...\n    If EDMIds.Exists(key) Then\n        '...add the row to the matches...\n        IdMatches.Add key, EDMIds(key)\n    Else\n        '...otherwise add the row to the mismatches.\n        IdMisMatches.Add key, EDMIds(key)\n    End If\nNext\n\ni = 1\nFor Each key In IdMatches.Keys\n    Identifiers.Cells(i, 4) = key\n    i = i + 1\nNext\n\ni = 1\nFor Each key In IdMisMatches.Keys\n    NoIdentifiers.Cells(i, 4) = key\n    i = i + 1\nNext\n</code></pre>\n\n<p>Note that this assumes that your key columns have unique values.  If they <em>don't</em>, you can either test for the presence of the key before adding a value (this matches your code's behavior of only taking the first match), or you can create a <code>Collection</code> of values to store in the <code>Dictionary</code> for each key, or something else entirely depending on your requirement.</p>\n"}], "owner": {"reputation": 83, "user_id": 1143721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0a685a7617f7f0b4e7878b17884d2ae4?s=128&d=identicon&r=PG", "display_name": "Swolerosis", "link": "https://stackoverflow.com/users/1143721/swolerosis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 41350898, "answer_count": 1, "score": 2, "last_activity_date": 1482875140, "creation_date": 1482864210, "last_edit_date": 1482875140, "question_id": 41350521, "link": "https://stackoverflow.com/questions/41350521/building-and-comparing-arrays", "title": "Building and comparing arrays", "body": "<p>I have the below code I'm trying to get to work. This is my first time dealing with arrays in VBA. Here's the plain english version of what I'm going for:</p>\n\n<ol>\n<li>Load SSBarray with column A from worksheet SSB.</li>\n<li>Load EDMarray with Column I from worksheet EDM.</li>\n<li>Compare the above arrays and sort into two new arrays IDarray and noIDarray based on a possible match.</li>\n<li>Output the new arrays into their respective worksheets.</li>\n</ol>\n\n<p>Step 4 is temporary to just make sure the code is even working. The entire project is compiling all the data from 3 sheets into these two lists. Worksheet 1 has Data point A only, Worksheet 2  may or may not have Data point A, B, and/or C, and Worksheet 3 may or may not have Data point A, B, and/or C. The code I have is my start to check for all of the data point A's in worksheet 1 are in worksheet 2. Run time is also a factor. I'll take any and all the help I can get at this point. Thanks.</p>\n\n<pre><code>'Build Arrays\nDim i As Long, j As Long\nDim SSBarray\nDim EDMarray\nDim IDarray\nDim noIDarray\nDim YCounter As Long\nDim NCounter As Long\nDim inArray As Boolean\nendSSB = SSB.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nendEDM = EDM.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nBBlast = BB.Range(\"A\" &amp; BB.Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\nReDim SSBarray(1 To endSSB)\nReDim EDMarray(1 To endEDM)\n\nFor i = 2 To endSSB\n    SSBarray(i) = SSB.Cells(i, 1).Value2\nNext i\n\nFor i = 2 To endEDM\n    EDMarray = EDM.Cells(i, 9).Value2\nNext i\n\nFor i = 2 To endSSB\n    inArray = False\n    For j = 2 To endEDM\n        If SSBarray(i) = EDMarray(j) Then\n            inArray = True\n            YCounter = YCounter + 1\n            ReDim Preserve IDarray(1 To YCounter)\n            IDarray(YCounter) = SSBarray(i)\n            Exit For\n        End If\n    Next j\n    If inArray = False Then\n        NCounter = NCounter + 1\n        ReDim Preserve noIDarray(1 To NCounter)\n        noIDarray(NCounter) = SSBarray(i)\n    End If\nNext i\n\nFor i = 1 To UBound(IDarray)\n    Identifiers.Cells(i, 4) = IDarray(i)\nNext i\n\nFor i = 1 To UBound(noIDarray)\n    NoIdentifiers.Cells(i, 4) = noIDarray(i)\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Revised Code:</p>\n\n<pre><code>'Sort and Compile Data\nDim i As Long\n\nendSSB = SSB.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nendEDM = EDM.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nBBlast = BB.Range(\"A\" &amp; BB.Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n\nPublic Type otherIDs\n    SEDOL As Variant\n    ISIN As Variant\nEnd Type\n\nDim SSBIds As New Scripting.Dictionary\nDim IDs As otherIDs\nFor i = 2 To endSSB\n    'Add an ID\\row number pair\n    SSBIds.Add SSB.Cells(i, 1).Value2\nNext i\n\nDim EDMIds As New Scripting.Dictionary\nFor i = 2 To endEDM\n    IDs.SEDOL = EDM.Cells(i, 8).Value2\n    IDs.ISIN = EDM.Cells(i, 7).Value2\n    EDMIds.Add EDM.Cells(i, 9).Value2, IDs.SEDOL, IDs.ISIN\nNext i\n\nDim IdMatches As New Scripting.Dictionary\nDim IdMisMatches As New Scripting.Dictionary\nDim key As Variant\nFor Each key In SSBIds\n    'If it's in the other dictionary...\n    If EDMIds.Exists(key) Then\n        '...add the row to the matches...\n        IdMatches.Add key, EDMIds(key)\n    Else\n        '...otherwise add the row to the mismatches.\n        IdMisMatches.Add key, EDMIds(key)\n    End If\nNext\n\ni = 1\nFor Each key In IdMatches.Keys\n    Identifiers.Cells(i, 4) = key\n    Identifiers.Cells(i, 5) = IdMatches.IDs.SEDOL\n    Identifier.Cells(i, 6) = IdMatches.IDs.ISIN\n    i = i + 1\nNext\n\ni = 1\nFor Each key In IdMisMatches.Keys\n    NoIdentifiers.Cells(i, 4) = key\n    i = i + 1\nNext\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5539668, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/10153320474949372/picture?type=large", "display_name": "Noah Xu", "link": "https://stackoverflow.com/users/5539668/noah-xu"}, "edited": false, "score": 0, "creation_date": 1482867925, "post_id": 41350710, "comment_id": 69904192, "body": "Thank you very much. This indeed helps. On the other hand, let&#39;s say I have entered incorrect information for twice, then whatever I have entered in the third time will close the app with If try &lt; 3 Then  validpswd = False If cID = &quot;sa&quot; And cPswd = &quot;XEL&quot; Then validpswd = True MsgBox &quot;Successful&quot; Else MsgBox &quot;Try again&quot; try = try + 1 End If  Else MsgBox (&quot;Too many tries&quot;) DoCmd.Close acForm, &quot;Login Test&quot;, acSaveYes End If"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 147, "user_id": 5539668, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/10153320474949372/picture?type=large", "display_name": "Noah Xu", "link": "https://stackoverflow.com/users/5539668/noah-xu"}, "edited": false, "score": 1, "creation_date": 1482871797, "post_id": 41350710, "comment_id": 69905807, "body": "Added a thing that catches that problem."}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 2, "creation_date": 1482876064, "post_id": 41350710, "comment_id": 69907327, "body": "Try moving the test for correct username/password before the check for number of tries. Pseudo code:  If {Username/Password Correct} Then {Success code} ElseIf Tries &gt;= 2 Then {Failed code} Else {Try again code; includes Tries = Tries + 1} End If"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1482876071, "post_id": 41350710, "comment_id": 69907331, "body": "Uh, your initial <code>If Tries &gt; 2 Then</code> will prevent the sub from ever doing anything, won&#39;t it?"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 1, "creation_date": 1482876324, "post_id": 41350710, "comment_id": 69907410, "body": "ah that dyslexia, gets me every time, i&#39;ll fix it"}], "tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": false, "score": 1, "last_activity_date": 1482876434, "last_edit_date": 1482876434, "creation_date": 1482865230, "answer_id": 41350710, "question_id": 41350431, "link": "https://stackoverflow.com/questions/41350431/access-vba-login-application/41350710#41350710", "title": "Access VBA login application", "body": "<p>What I see wrong is you are having them type in the username/password then click a button. That button then checks to see if the username/password matches the predefined values three times in a row. That is a problem because the user wouldn't be able to actually try three times.</p>\n\n<p>To fix it, you create a Module/Form level variable and initialize it in the form load to 0. then you check in the button click if that variable is greater than 2. If it is, then you run your close procedure. If it isnt, then it checks your username and password to see if they are correct, if they aren't then it increments the Module level variable by 1. Example below.</p>\n\n<p>EDIT: added a check since it doesn't quite catch it after the 3rd try. Feels a bit ugly, but it works.</p>\n\n<p>EDIT2: Dyslexia moment, fixed the greater then, less then signs for the if statements and the associated values</p>\n\n<pre><code>Dim Tries as Long\n\nPrivate Sub Form_Load()\nTries = 0\n\nEnd Sub\n\nPrivate Sub Command6_Click()\nIf Tries &lt; 3 Then\n    cID = Text0.Text\n    cPswd = Text4.Text\n    validpswd = False\n    If cID = \"sa\" And cPswd = \"XEL\" Then\n        validpswd = True\n        MsgBox \"Successful\"\n    Else\n        Tries = Tries + 1\n        If Tries &gt; 2 Then\n            MsgBox (\"byebye\")\n            DoCmd.Close acForm, \"Used Car Sales\", acSaveYes\n        else\n        MsgBox \"Try again\"\n        end if\n    End If\n    'MsgBox (\"byebye\")\n    'DoCmd.Close acForm, \"Used Car Sales\", acSaveYes\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 5539668, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/10153320474949372/picture?type=large", "display_name": "Noah Xu", "link": "https://stackoverflow.com/users/5539668/noah-xu"}, "is_accepted": false, "score": 0, "last_activity_date": 1483035467, "creation_date": 1483035467, "answer_id": 41385133, "question_id": 41350431, "link": "https://stackoverflow.com/questions/41350431/access-vba-login-application/41385133#41385133", "title": "Access VBA login application", "body": "<p>Thanks all. This is what I did eventually. I am sure there is other better way to do this and please comment to let me know as well</p>\n\n<pre><code>If try &lt; 3 Then\n\n\nIf cID &lt;&gt; \"sa\" Or cPswd &lt;&gt; \"XEL\" Then\ntry = try + 1\nMsgBox \"Try again\"\nElse\nMsgBox \"Successful\"\ntry = 0\nEnd If\n\nIf try = 3 Then\nMsgBox (\"Too many tries\")\nDoCmd.Close acForm, \"Login Test\", acSaveYes\nEnd If\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5539668, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/10153320474949372/picture?type=large", "display_name": "Noah Xu", "link": "https://stackoverflow.com/users/5539668/noah-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1594640752, "creation_date": 1482863823, "last_edit_date": 1594640752, "question_id": 41350431, "link": "https://stackoverflow.com/questions/41350431/access-vba-login-application", "title": "Access VBA login application", "body": "<p>I am writing this little login validation application as a step of my VBA learning process. The application should check whether the login name is \"sa\" and the password is \"XEL\". The application should allow the user to enter the username and password for a maximum of three times. If in the all of the three attempts, a wrong usename and password is entered, the application should display an error and close. And blow is my code:</p>\n\n<pre><code>Private Sub Command6_Click()\nMe.Text0.SetFocus\ncID = Text0.Text\nMe.Text4.SetFocus\ncPswd = Text4.Text\n\nFor i = 1 To 3\nvalidpswd = False\nIf cID = \"sa\" And cPswd = \"XEL\" Then\nvalidpswd = True\nMsgBox \"Successful\"\nExit For\nElse\nMsgBox \"Try again\"\nExit For\nEnd If\nNext i\n'MsgBox (\"byebye\")\n'DoCmd.Close acForm, \"Used Car Sales\", acSaveYes\n\nEnd Sub\n</code></pre>\n\n<p>Now it does the checking/validating part. But it doesn't do the three times max limitation, I am kind of confused as how to put the last message box code and close command into the whole code blocks. Any helps are appreciated.</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 45, "user_id": 6700516, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/868ae7b54c403815c05c068712f1bcc5?s=128&d=identicon&r=PG&f=1", "display_name": "Shasti", "link": "https://stackoverflow.com/users/6700516/shasti"}, "edited": false, "score": 0, "creation_date": 1482950421, "post_id": 41350194, "comment_id": 69937271, "body": "Sorry I missed the part about needing to preserve the filters.  See here for code to do that: <a href=\"http://stackoverflow.com/questions/9489126/in-excel-vba-how-do-i-save-restore-a-user-defined-filter\" title=\"in excel vba how do i save restore a user defined filter\">stackoverflow.com/questions/9489126/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1482862712, "creation_date": 1482862712, "answer_id": 41350194, "question_id": 41350046, "link": "https://stackoverflow.com/questions/41350046/replace-existing-data-with-a-new-data/41350194#41350194", "title": "Replace existing data with a New data", "body": "<p>Something like</p>\n\n<pre><code> Worksheets(\"Results\").Range(\"A1\").CurrentRegion.Clearcontents\n</code></pre>\n\n<p>before adding the new data should do it</p>\n"}], "owner": {"reputation": 45, "user_id": 6700516, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/868ae7b54c403815c05c068712f1bcc5?s=128&d=identicon&r=PG&f=1", "display_name": "Shasti", "link": "https://stackoverflow.com/users/6700516/shasti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 41350194, "answer_count": 1, "score": 0, "last_activity_date": 1500252217, "creation_date": 1482862015, "last_edit_date": 1500252217, "question_id": 41350046, "link": "https://stackoverflow.com/questions/41350046/replace-existing-data-with-a-new-data", "title": "Replace existing data with a New data", "body": "<p>I am pulling data from a SQL table to a worksheet called \"Results\". The output gets pulled from a SQL table based on the specific date range given by the user in the main worksheet.</p>\n\n<p>I am unable to delete the old records. Currently I manually delete the worksheet and create a new sheet \"Results\" and then run the macro. I am looking for an automated process where the results update every time a macro is called. It should replace the old data and show the results only based on the current filters.</p>\n\n<pre><code>   'Open Recordset'\n        Set objMyRecordset.Source = objMyCmd\n        objMyRecordset.Open\n        For iCols = 0 To objMyRecordset.Fields.Count - 1\n        Worksheets(\"Results\").Cells(1, iCols + 1).Value = objMyRecordset.Fields(iCols).Name\n        Next\n\n        'Copy Data to Excel'\n        Worksheets(\"Results\").Range(\"A2\").CopyFromRecordset objMyRecordset\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros", "excel-2013"], "comments": [{"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1482862713, "post_id": 41350032, "comment_id": 69902015, "body": "Shouldn&#39;t your array use i=0 to iterate? As in the arrVenderoes will be (0 to 6) by default not (1 to 7). You can check this in the Local windows in the editor."}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1482863239, "post_id": 41350032, "comment_id": 69902282, "body": "It might be an idea to replace the i=1 and the i iteration with something like For i = LBound(arrVendedores) To UBound(arrVendedores), that way if you change the array you are safe. Then you can set the array earlier using the table you mentioned."}, {"owner": {"reputation": 1, "user_id": 7346848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb5a252b650a43eb1552386850543b7?s=128&d=identicon&r=PG&f=1", "display_name": "Chiar15", "link": "https://stackoverflow.com/users/7346848/chiar15"}, "reply_to_user": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1482864031, "post_id": 41350032, "comment_id": 69902619, "body": "I&#39;ve tried to use i+1 inside arrVendedores but fail, and.... i should use another variable like ii = i then use ii+1 inside arrVendedores"}, {"owner": {"reputation": 1, "user_id": 7346848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb5a252b650a43eb1552386850543b7?s=128&d=identicon&r=PG&f=1", "display_name": "Chiar15", "link": "https://stackoverflow.com/users/7346848/chiar15"}, "reply_to_user": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1482864105, "post_id": 41350032, "comment_id": 69902636, "body": "I take notice now about that."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7346848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb5a252b650a43eb1552386850543b7?s=128&d=identicon&r=PG&f=1", "display_name": "Chiar15", "link": "https://stackoverflow.com/users/7346848/chiar15"}, "edited": false, "score": 0, "creation_date": 1482948558, "post_id": 41353947, "comment_id": 69936374, "body": "Thank you Captain i use your comments to rebuild my macro"}], "tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": false, "score": 0, "last_activity_date": 1482885634, "creation_date": 1482885634, "answer_id": 41353947, "question_id": 41350032, "link": "https://stackoverflow.com/questions/41350032/export-excel-sheet-to-pdf-using-macros-and-values-of-another-table/41353947#41353947", "title": "Export Excel sheet to PDF using Macros and values of another table", "body": "<p>I found it hard to edit your code without seeing some of the inputs, but I got this to flow though with some dummy data.</p>\n\n<pre><code>    Sub MAKEPDF()\n    Dim dvCell As Range\n    Dim inputRange As Range\n    Dim c As Range\n    Dim i As Long\n\n    Application.ScreenUpdating = False\n     'Which cell has data validation\n    Set dvCell = Sheets(\"NUEVA LISTA\").Range(\"A3\")\n'You assigned the value of this cell later on but didn't use it so I removed the value assignment below.\n     'Determine where validation comes from\n    Set inputRange = Evaluate(dvCell.Validation.Formula1)\n\n    arrVendedores = Array(\"Name1\", \"Name2\", \"Name3\", \"Name4\", \"Name5\", \"Name6\", \"Name7\")\n    'you might want to assign this in code, not sure if it is the sheet names but I assumed it is if not and just filenames to use.\n\n    For i = LBound(arrVendedores) To UBound(arrVendedores)\n    'this allows an array of any size to be iterated over with having to change the code.\n            ChDir \"D:\\Google Drive\\Lista de Precios\\temp\\\" &amp; arrVendedores(i)\n\n            Worksheets(arrVendedores(i)).ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"(\" &amp; Format(Range(\"A4\"), \"yyyy-mm-dd\") &amp; \") Lista de precios.pdf\"\n    'you had activeworksheet here but it didn't seem to be changing, so if I assume the array is sheet names this will export those sheet else you will need to change to suit.\n            'Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n    Next\n\n    Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7346848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb5a252b650a43eb1552386850543b7?s=128&d=identicon&r=PG&f=1", "display_name": "Chiar15", "link": "https://stackoverflow.com/users/7346848/chiar15"}, "is_accepted": false, "score": 0, "last_activity_date": 1482948516, "creation_date": 1482948516, "answer_id": 41367462, "question_id": 41350032, "link": "https://stackoverflow.com/questions/41350032/export-excel-sheet-to-pdf-using-macros-and-values-of-another-table/41367462#41367462", "title": "Export Excel sheet to PDF using Macros and values of another table", "body": "<p>Thank you Captain, based on your answer i made a new macro as following</p>\n\n<pre><code>Sub MakePDF4()\n\nDim myTable As ListObject\nDim myArray As Variant\nDim x As Long\nDim vendedorDatos As Range\nDim vendedorCampoDatos As Range\n\n\n\n  Set myTable = Sheets(\"VENDEDORES\").ListObjects(\"Table1\")\n\n\n  myArray = myTable.DataBodyRange\n\n\n  For x = LBound(myArray) To UBound(myArray)\n\n        Application.ScreenUpdating = False\n\n        Set vendedorCampoDatos = (Sheets(\"NUEVA LISTA\").Range(\"A3\"))\n        vendedorCampoDatos = myArray(x, 2)\n\n        'ChDir \"D:\\Google Drive\\Lista de Precios\\temp\\\" &amp; myArray(x, 1)\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"D:\\Google Drive\\Lista de Precios\\temp\\\" &amp; myArray(x, 1) &amp; \"\\(\" &amp; Format(Range(\"A4\"), \"yyyy-mm-dd\") &amp; \") Lista de precios.pdf\"\n\n                'Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n  Next x\n\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>It work as expected. I have some issue with setting ChDir with the array at the end but works when is setting in filename.</p>\n\n<p>All data is in a unique file (may be i mispelled or confuse some words at explaining). One worksheet is the price list and a second worksheet contains the table with [@Name] and [@ContactInfo] of salesmen.</p>\n\n<p>I use [@Name] to determinate in which directory i will save the PDF file and [@ContactInfo] to change in the worksheet of price list a unique field between salesmen</p>\n"}], "owner": {"reputation": 1, "user_id": 7346848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bb5a252b650a43eb1552386850543b7?s=128&d=identicon&r=PG&f=1", "display_name": "Chiar15", "link": "https://stackoverflow.com/users/7346848/chiar15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482948516, "creation_date": 1482861971, "question_id": 41350032, "link": "https://stackoverflow.com/questions/41350032/export-excel-sheet-to-pdf-using-macros-and-values-of-another-table", "title": "Export Excel sheet to PDF using Macros and values of another table", "body": "<p>I'm new in Excel Macros and have no experience with VB or any language.</p>\n\n<p>I have a sheet with a Price List, in this we have a field with a dropdown list with Contact Info (mail and cellphone) of our Salesman.</p>\n\n<p>A second sheet contain a table with Name and ContactInfo.</p>\n\n<p>Today, i use the dropdown to choose the salesman and export to pdf to specific directory.</p>\n\n<p>I'm looking to export to PDF using a Macro doing these things. I've tried some macros without success. I want to use the name @Name to save in directory and @ContactInfo to replace in a specific field of pricelist.</p>\n\n<p>What i have:</p>\n\n<pre><code>Sub MAKEPDF()\nDim dvCell As Range\nDim inputRange As Range\nDim c As Range\nDim i As Long\n\n\n 'Which cell has data validation\nSet dvCell = Sheets(\"NUEVA LISTA\").Range(\"A3\")\n 'Determine where validation comes from\nSet inputRange = Evaluate(dvCell.Validation.Formula1)\n\narrVendedores = Array(\"Name1\", \"Name2\", \"Name3\", \"Name4\", \"Name5\", \"Name6\", \"Name7\")\n\ni = 1\n 'Begin our loop\nApplication.ScreenUpdating = False\nFor Each c In inputRange\n    dvCell = c.Value\n\n        ChDir \"D:\\Google Drive\\Lista de Precios\\temp\\\" &amp; arrVendedores(i)\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"(\" &amp; Format(Range(\"A4\"), \"yyyy-mm-dd\") &amp; \") Lista de precios.pdf\"\n\n        'Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n    i = i + 1\nNext c\nApplication.ScreenUpdating = True\nEnd Sub \n</code></pre>\n\n<p>This save in PDF perfectly but that array don't work as expected causing error 9 (index) and is better use current data from Table1@Name.</p>\n\n<p>Can anyone help me to goal this?</p>\n\n<p>Thanks and sorry for my bad english.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 0, "creation_date": 1482862493, "post_id": 41350075, "comment_id": 69901924, "body": "I was about to suggest a global variable or similar to test the table refresh against but this is much more elegant. I would do this and use a button or the like,"}, {"owner": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "edited": false, "score": 0, "creation_date": 1482863506, "post_id": 41350075, "comment_id": 69902412, "body": "@branislav You mean something like I did on Edit 1? Because I tried that and it&#39;s not working. BTW, didn&#39;t know about that shortcut. Thx"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1482864037, "post_id": 41350075, "comment_id": 69902621, "body": "No, that is not exactly my point. The <i>Date update</i> will still be in the <code>Worksheet_Change</code> event, no change there. The point is, that you will not just Refresh the table using some standard Refresh method (e.g. right click &gt; refresh), but you will encapsulate this inside another sub, with disabled events. What is happening: When you refresh the table manualy, excel triggers the worksheet change event and runs the event code. To prevent this, we use <code>EnableEvents = False</code>. When you refresh the table after such line, no events will trigger, thus no dates will be updated."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "edited": false, "score": 0, "creation_date": 1482866119, "post_id": 41350075, "comment_id": 69903485, "body": "@Vin&#237;ciusAffonso, I have added some diagram to better explain the problem. May it help."}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1482865985, "last_edit_date": 1482865985, "creation_date": 1482862151, "answer_id": 41350075, "question_id": 41349862, "link": "https://stackoverflow.com/questions/41349862/vba-code-to-autoupdate-cell-with-current-date-when-cell-changed-not-working/41350075#41350075", "title": "VBA code to autoupdate cell with current date, when cell changed, not working", "body": "<h2>Disable events, then refresh table</h2>\n\n<p>You can write a Sub, which you will use for refreshing the table. Before refresh you will disable excel events. Like so:  </p>\n\n<pre><code>Sub RefreshOracleTable\n    Application.EnableEvents = False\n    'the refresh itself code something like\n    Thisworkbook.Sheets(\"wsTables\").ListObjects(\"OracleTable\").QueryTable.Refresh BackgroundQuery:=False\n    Application.EnableEvents = TRUE\nEnd Sub\n</code></pre>\n\n<h2>Manual entry of a Date with Keyboard shortcut</h2>\n\n<p>Consider using a Keyboard shortcut to manualy enter the current date. <code>CTRL</code> + <code>;</code></p>\n\n<h2>Explanation of current situation and proposed solution</h2>\n\n<p><a href=\"https://i.stack.imgur.com/THKg8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/THKg8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 85, "user_id": 5731975, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-M1XUPWv2f0s/AAAAAAAAAAI/AAAAAAAAA1Q/M3o2LtKBCgU/photo.jpg?sz=128", "display_name": "Vin&#237;cius Affonso", "link": "https://stackoverflow.com/users/5731975/vin%c3%adcius-affonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 41350075, "answer_count": 1, "score": 1, "last_activity_date": 1482944342, "creation_date": 1482861236, "last_edit_date": 1482944342, "question_id": 41349862, "link": "https://stackoverflow.com/questions/41349862/vba-code-to-autoupdate-cell-with-current-date-when-cell-changed-not-working", "title": "VBA code to autoupdate cell with current date, when cell changed, not working", "body": "<p>I have a sheet where I daily change the stats of some rows and I have to know when the stats changed. To make my life easier, I found on the internet this VBA code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Intersect(Target, Range(\"R1:R2000\")) Is Nothing Then Exit Sub\n    Target.Offset(0, 1) = Date\n\nEnd Sub\n</code></pre>\n\n<p>The code works wonderfully. Everytime I change de stats on column R, it update the date on column S. </p>\n\n<p>The problem is that I change this stat in a table linked to an outside source (Oracle Database) and if I try to refresh the table, it change the entire content of the table to different dates. What I have to do now is, everytime I have to refresh the table, I just comment the entire VBA Code.</p>\n\n<p>Is there anything I can change on the code so it doesn't update when I refresh the table?</p>\n\n<p>Edit 1:</p>\n\n<pre><code>Sub RefreshOracleTable()\n    Application.EnableEvents = False\n\n\n    If Intersect(Target, Range(\"R1:R200000\")) Is Nothing Then Exit Sub\n    Target.Offset(0, 1) = Date\n\n    ThisWorkbook.Sheets(\"wsTables\").ListObjects(\"OracleTable\").QueryTable.Refresh BackgroundQuery:=Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1126, "user_id": 5527199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnkLm.jpg?s=128&g=1", "display_name": "Luke Kot-Zaniewski", "link": "https://stackoverflow.com/users/5527199/luke-kot-zaniewski"}, "edited": false, "score": 0, "creation_date": 1482861494, "post_id": 41349812, "comment_id": 69901479, "body": "Your biggest problem is that you need to decrement <code>fila</code> by 1 each time a row is deleted otherwise you will skip rows. I would also put a breakpoint on the start of your outer loop and see what is in the <code>Sheets</code> collection to determine the count."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7346847, "user_type": "registered", "profile_image": "https://graph.facebook.com/417636495293313/picture?type=large", "display_name": "Frapu", "link": "https://stackoverflow.com/users/7346847/frapu"}, "edited": false, "score": 0, "creation_date": 1482927971, "post_id": 41350234, "comment_id": 69925380, "body": "Love you! Thanks!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7346847, "user_type": "registered", "profile_image": "https://graph.facebook.com/417636495293313/picture?type=large", "display_name": "Frapu", "link": "https://stackoverflow.com/users/7346847/frapu"}, "edited": false, "score": 0, "creation_date": 1482932013, "post_id": 41350234, "comment_id": 69927534, "body": "@Frapu  you&#39;re welcome, please mark as answer, by clicking the V next to my answer"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1482862896, "creation_date": 1482862896, "answer_id": 41350234, "question_id": 41349812, "link": "https://stackoverflow.com/questions/41349812/how-to-delete-empty-rows-in-all-sheets/41350234#41350234", "title": "How to delete empty rows in all Sheets", "body": "<p>Always remember to loop backward when deleting objects (in your case rows), so use <code>For i = 10 to 1 Step -1</code>.</p>\n\n<p>Also, try to avoid using <code>Select</code> and <code>Activate</code>, instead you could directly reference the <code>Worksheet</code> or <code>Range</code>. In this case use directly the <code>ws</code> defined as <code>Worksheet</code>, to see if <code>If ws.Cells(fila, 4).Value = \"\"</code></p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim I As Integer, fila As Long\nDim ws As Worksheet\n\n' loop through all worksheets\nFor Each ws In ThisWorkbook.Worksheets\n    ' loop backwards when deleting objects\n    For fila = 10 To 1 Step -1\n        If ws.Cells(fila, 4).Value = \"\" Then ws.Rows(fila).Delete\n    Next fila\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 9745215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qr8M9355hsU/AAAAAAAAAAI/AAAAAAAAAAg/h55K8wcWg1o/photo.jpg?sz=128", "display_name": "MYPE", "link": "https://stackoverflow.com/users/9745215/mype"}, "is_accepted": false, "score": 0, "last_activity_date": 1535548942, "creation_date": 1535548942, "answer_id": 52078524, "question_id": 41349812, "link": "https://stackoverflow.com/questions/41349812/how-to-delete-empty-rows-in-all-sheets/52078524#52078524", "title": "How to delete empty rows in all Sheets", "body": "<p>Maybe this solution will help you : \nIt will clean all worksheets in your workbook and delete empty rows.\nIn the end, msg box will tell you the percentage of rows that were deleted for each sheet.\nBest regards,</p>\n\n<pre><code>Sub Clean()\nDim Sht As Worksheet, DCell As Range, Calc As Long, Rien As String, Avant As Double, plage As Range\nOn Error Resume Next\nCalc = Application.Calculation ' ---- m\u00e9morisation de l'\u00e9tat de\nrecalcul\n'------------------------------------------------------------\nMsgBox \"Pour le classeur actif : \" _\n&amp; Chr(10) &amp; ActiveWorkbook.FullName _\n&amp; Chr(10) &amp; \"dans chaque feuille de calcul\" _\n&amp; Chr(10) &amp; \"recherche la zone contenant des donn\u00e9es,\" _\n&amp; Chr(10) &amp; \"r\u00e9initialise la derni\u00e8re cellule utilis\u00e9e\" _\n&amp; Chr(10) &amp; \"et optimise la taille du fichier Excel\", _\nvbInformation, _\n\"d'apr\u00e8s LL par &lt;a href=\"mailto:GeeDee@m6net.fr\"&gt;GeeDee@m6net.fr&lt;/a&gt;\"\n'-------------------------------------------------------------\nMsgBox \"Taille initiale de ce classeur en octets\" _\n&amp; Chr(10) &amp; FileLen(ActiveWorkbook.FullName), _\nvbInformation, ActiveWorkbook.FullName\n'------------------------------------------------------------\nWith Application\n.Calculation = xlCalculationManual\n.StatusBar = \"Nettoyage en cours...\"\n.EnableCancelKey = xlErrorHandler\n.ScreenUpdating = True\nEnd With\n'-------------------- le traitement\nFor Each Sht In Worksheets\nAvant = Sht.UsedRange.Cells.Count\nApplication.StatusBar = Sht.Name &amp; \"-\" &amp; Sht.UsedRange.Address\n'-------------------Traitement de la zone trouv\u00e9e\nIf Sht.UsedRange.Address &lt;&gt; \"$A$1\" Or Not IsEmpty(Sht.[A1]) Then\nSet DCell = Sht.Cells.Find(\"*\", , , , xlByRows, xlPrevious)(2)\n'----------------Suppression des lignes inutilis\u00e9es\nIf Not DCell Is Nothing Then\nSht.Range(DCell, Sht.Cells([A:A].Count, 1)).EntireRow.Delete\nSet DCell = Nothing\nSet DCell = Sht.Cells.Find(\"*\", , , , xlByColumns, xlPrevious)(, 2)\n'----------------Suppression des colonnes inutilis\u00e9es\nIf Not DCell Is Nothing Then Sht.Range(DCell, Sht.[IV1]).EntireColumn.Delete\nEnd If\nRien = Sht.UsedRange.Address\nEnd If\nActiveWorkbook.Save\n'---------------------Message pour la feuille trait\u00e9e\nMsgBox \"Nom de la feuille de calcul :\" _\n&amp; Chr(10) &amp; Sht.Name _\n&amp; Chr(10) &amp; Format(Sht.UsedRange.Cells.Count / Avant, \"0.00%\") &amp; \" de la taille initiale\", _\nvbInformation, ActiveWorkbook.FullName\nNext Sht\n'--------------------Message fin de traitement\nMsgBox \"Taille optimis\u00e9e de ce classeur en octets \" &amp; Chr(10) &amp; FileLen(ActiveWorkbook.FullName), _\nvbInformation, _\nActiveWorkbook.FullNameActive\n'--------------------\nApplication.StatusBar = False\nApplication.Calculation = Calc\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7346847, "user_type": "registered", "profile_image": "https://graph.facebook.com/417636495293313/picture?type=large", "display_name": "Frapu", "link": "https://stackoverflow.com/users/7346847/frapu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1995, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544549700, "creation_date": 1482861027, "last_edit_date": 1544549700, "question_id": 41349812, "link": "https://stackoverflow.com/questions/41349812/how-to-delete-empty-rows-in-all-sheets", "title": "How to delete empty rows in all Sheets", "body": "<p>I am trying to delete empty rows in every sheet using this code in Excel 2010:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim I As Integer\n\n'For all sheets...\n\nFor I = 1 To Sheets.Count\n\n    'select corresponding sheet\n\n    Sheets(I).Select\n\n    Sheets(I).Activate\n\n    'write delete code\n\n    For fila = 1 To 10\n\n        If Cells(fila, 4).Value = \"\" Then\n\n            Rows(fila).Delete\n\n        End If\n\n    Next fila\n\n    'Go to next sheet\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This code only deletes rows on my first active sheet.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1482876258, "post_id": 41349206, "comment_id": 69907391, "body": "Define <i>not working</i>, please. <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debugging VBA Code</a>"}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1482877090, "post_id": 41349206, "comment_id": 69907661, "body": "Pending clarification of <i>not working</i> as requested by @Andre, in the meantime I would suggest that if you&#39;re checking the value of Frame2 then this code should possibly be in the Frame2_AfterUpdate event code rather than Okvir17_AfterUpdate."}, {"owner": {"reputation": 25, "user_id": 6819162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8321c55a2798f41a2ae727027117571?s=128&d=identicon&r=PG&f=1", "display_name": "i_n", "link": "https://stackoverflow.com/users/6819162/i-n"}, "edited": false, "score": 0, "creation_date": 1482877281, "post_id": 41349206, "comment_id": 69907714, "body": "Yes, it should be Frame2, I changed that and now I am getting this when I open form and select any option."}, {"owner": {"reputation": 25, "user_id": 6819162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8321c55a2798f41a2ae727027117571?s=128&d=identicon&r=PG&f=1", "display_name": "i_n", "link": "https://stackoverflow.com/users/6819162/i-n"}, "edited": false, "score": 0, "creation_date": 1482877395, "post_id": 41349206, "comment_id": 69907752, "body": "<a href=\"https://i.imgur.com/JGHd5YZ.png\" rel=\"nofollow noreferrer\">i.imgur.com/JGHd5YZ.png</a>. As I mentioned in some comment below I think problem is that &quot;Status predmeta&quot; is not from &quot;Vlasnik&quot; table, because when I change condition to anything regarding &quot;Vlasnik&quot; table it&#39;s working."}, {"owner": {"reputation": 25, "user_id": 6819162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8321c55a2798f41a2ae727027117571?s=128&d=identicon&r=PG&f=1", "display_name": "i_n", "link": "https://stackoverflow.com/users/6819162/i-n"}, "edited": false, "score": 0, "creation_date": 1482916580, "post_id": 41349206, "comment_id": 69919115, "body": "When I changed condition to -&gt; &amp; &quot;WHERE Vlasnik.[Naziv tvrtke] = &#39;AMD&#39; &quot; it was filtering listbox correctly so problem is checking field from another table which is connected to &quot;Vlasnik&quot; table."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 6819162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8321c55a2798f41a2ae727027117571?s=128&d=identicon&r=PG&f=1", "display_name": "i_n", "link": "https://stackoverflow.com/users/6819162/i-n"}, "is_accepted": true, "score": 0, "last_activity_date": 1482934316, "creation_date": 1482934316, "answer_id": 41363824, "question_id": 41349206, "link": "https://stackoverflow.com/questions/41349206/change-source-of-listbox-when-different-option-in-option-group-checked/41363824#41363824", "title": "Change source of listbox when different option in option group checked", "body": "<p>Solved it, I had to make INNER JOIN. Final code :</p>\n\n<pre><code>Private Sub Frame2_Click()\n\nIf Frame2 = 1 Then 'Nije zapo\u010deto\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail, Narud\u017eba.[Status predmeta] \" _\n            &amp; \"FROM Vlasnik INNER JOIN Narud\u017eba ON Vlasnik.ID_VU = Narud\u017eba.ID_VU \" _\n            &amp; \"WHERE Narud\u017eba.[Status predmeta] = 'Nije zapo\u010deto' \" _\n\n\n\nElseIf Frame2 = 2 Then 'U procesu\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail, Narud\u017eba.[Status predmeta] \" _\n            &amp; \"FROM Vlasnik INNER JOIN Narud\u017eba ON Vlasnik.ID_VU = Narud\u017eba.ID_VU \" _\n            &amp; \"WHERE Narud\u017eba.[Status predmeta] = 'U procesu' \" _\n\n\n\nElseIf Frame2 = 3 Then 'Na \u010dekanju\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail, Narud\u017eba.[Status predmeta] \" _\n            &amp; \"FROM Vlasnik INNER JOIN Narud\u017eba ON Vlasnik.ID_VU = Narud\u017eba.ID_VU \" _\n            &amp; \"WHERE Narud\u017eba.[Status predmeta] = 'Na \u010dekanju' \" _\n\n\n\nElseIf Frame2 = 4 Then 'Fakturirati\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail, Narud\u017eba.[Status predmeta] \" _\n            &amp; \"FROM Vlasnik INNER JOIN Narud\u017eba ON Vlasnik.ID_VU = Narud\u017eba.ID_VU \" _\n            &amp; \"WHERE Narud\u017eba.[Status predmeta] = 'Fakturirati' \" _\n\n\n\nElseIf Frame2 = 5 Then 'Zavr\u0161eno\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail, Narud\u017eba.[Status predmeta] \" _\n            &amp; \"FROM Vlasnik INNER JOIN Narud\u017eba ON Vlasnik.ID_VU = Narud\u017eba.ID_VU \" _\n            &amp; \"WHERE Narud\u017eba.[Status predmeta] = 'Zavr\u0161eno' \" _\n\n\n\n\n\n\nEnd If\n\n\nList2.RowSource = strRowsource1\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6819162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8321c55a2798f41a2ae727027117571?s=128&d=identicon&r=PG&f=1", "display_name": "i_n", "link": "https://stackoverflow.com/users/6819162/i-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 41363824, "answer_count": 1, "score": 0, "last_activity_date": 1482934316, "creation_date": 1482858302, "last_edit_date": 1482861040, "question_id": 41349206, "link": "https://stackoverflow.com/questions/41349206/change-source-of-listbox-when-different-option-in-option-group-checked", "title": "Change source of listbox when different option in option group checked", "body": "<p>Relationship between tables : <a href=\"https://i.imgur.com/Pni922e.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/Pni922e.png</a> I have 4 tables, left table is \"Owner\" and info about the owner, the middle-left table is \"Order\" and it contains info about order, middle-right table connects \"Order\" table and \"About air conditioner\" table.\nSo I made form that looks like this: <a href=\"https://i.imgur.com/qOFf67w.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/qOFf67w.png</a>\nI want when \"Nije zapo\u010deto\" in option group is marked to show only owners who have \"Status predmeta\"[in Narud\u017eba table]=\"Nije zapo\u010deto\". So when \"U procesu\" option group would be marked I want to show only owners that have \"U procesu\" in \"Status predmeta\" field. </p>\n\n<p>I wrote some code but it is not working.</p>\n\n<pre><code>Private Sub Okvir17_AfterUpdate()\n\nIf Frame2 = 1 Then 'Nije zapo\u010deto\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail \" _\n            &amp; \"FROM Vlasnik \" _\n            &amp; \"WHERE [Status predmeta] = 'Nije zapo\u010deto' \" _\n\nIf Frame2 = 2 Then 'U procesu\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail, \" _\n            &amp; \"FROM Vlasnik \" _\n            &amp; \"WHERE [Status predmeta] = 'U procesu' \" _\n\nIf Frame2 = 3 Then 'Na \u010dekanju\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail \" _\n            &amp; \"FROM Vlasnik \" _\n            &amp; \"WHERE [Status predmeta] = 'Na \u010dekanju' \" _\n\nIf Frame2 = 4 Then 'Fakturirati\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail \" _\n            &amp; \"FROM Vlasnik \" _\n            &amp; \"WHERE [Status predmeta] = 'Fakturirati' \" _\n\n\nIf Frame2 = 5 Then 'Zavr\u0161eno\nstrRowsource1 = \"SELECT Vlasnik.ID_VU, Vlasnik.[Naziv tvrtke], Vlasnik.[Ime korisnika], Vlasnik.[Prezime korisnika], Vlasnik.[Adresa korisnika], Vlasnik.Telefon, Vlasnik.Mail \" _\n            &amp; \"FROM Vlasnik \" _\n            &amp; \"WHERE [Status predmeta] = 'Zavr\u0161eno' \" _\n\n\nEnd If\n\nList2.RowSource = strRowsource1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482858104, "post_id": 41349105, "comment_id": 69899935, "body": "You&#39;re missing the drive at the beginning of the Path <code>Path = &quot;C:&#47;Use..</code>"}, {"owner": {"reputation": 2539, "user_id": 4677278, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1cb766e72045dedd3adaf4353479fa26?s=128&d=identicon&r=PG&f=1", "display_name": "ytk", "link": "https://stackoverflow.com/users/4677278/ytk"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 1, "creation_date": 1482858530, "post_id": 41349105, "comment_id": 69900138, "body": "@Sgdva since I&#39;m running on a mac, it doesn&#39;t have drives like <code>C:</code> and <code>D:</code>. I found this thread: <a href=\"http://stackoverflow.com/questions/16631503/path-working-on-pc-but-not-mac\" title=\"path working on pc but not mac\">stackoverflow.com/questions/16631503/&hellip;</a>, which might be the problem."}], "owner": {"reputation": 2539, "user_id": 4677278, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1cb766e72045dedd3adaf4353479fa26?s=128&d=identicon&r=PG&f=1", "display_name": "ytk", "link": "https://stackoverflow.com/users/4677278/ytk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2357, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593586374, "creation_date": 1482857838, "last_edit_date": 1593586374, "question_id": 41349105, "link": "https://stackoverflow.com/questions/41349105/opening-file-on-mac-generates-run-time-error-53-file-not-found", "title": "Opening file on Mac generates Run-time error &#39;53&#39;: File not found", "body": "<p>I have Excel files generated using openxlsx library in R.</p>\n\n<p>Since they contain formulas, each needs to be opened and saved before I can parse them to read data.</p>\n\n<p>I created a macro to open, save, and close the Excel files.</p>\n\n<pre><code>Sub Macro1()\nPath = \"/Users/ytk/Desktop/2016-11-30/\"\nFilename = Dir(Path &amp; \"*.xlsx\")\nDo While Filename &lt;&gt; \"\"\n    Workbooks.Open Filename:=Path &amp; Filename\n    Workbooks(Filename).Close SaveChanges:=True\nLoop\nEnd Sub\n</code></pre>\n\n<p>I get:  </p>\n\n<blockquote>\n  <p>Run-time error '53':<br>\n  File not found</p>\n</blockquote>\n\n<p>That is the correct filepath. I'm running this on a Mac, Excel 2016.</p>\n\n<p>Edit: I found <a href=\"https://stackoverflow.com/questions/16631503/path-working-on-pc-but-not-mac\">this thread</a>, and changed the path separator to <code>:</code> instead of <code>/</code>:</p>\n\n<pre><code>Path = \"Users:ytk:Desktop:2016-11-30:\"\n</code></pre>\n\n<p>and I get the same error.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1025, "user_id": 2026740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe3644e242eeabe917840ddd85204d1?s=128&d=identicon&r=PG", "display_name": "Daniel Corzo", "link": "https://stackoverflow.com/users/2026740/daniel-corzo"}, "edited": false, "score": 0, "creation_date": 1482856973, "post_id": 41348634, "comment_id": 69899403, "body": "Hello and welcome to StackOverflow. Please take some time to read the help page, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. And more importantly, please read <a href=\"http://meta.stackexchange.com/q/156810/204922\">the Stack Overflow question checklist</a>. You might also want to learn about <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Examples</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7346579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DoygUPl2okI/AAAAAAAAAAI/AAAAAAAAAIo/i6lz2z_C8OQ/photo.jpg?sz=128", "display_name": "Jay Noerper", "link": "https://stackoverflow.com/users/7346579/jay-noerper"}, "edited": false, "score": 0, "creation_date": 1482864336, "post_id": 41348835, "comment_id": 69902725, "body": "I&#39;m actually using Index and Match within the document, already. I&#39;m creating a generator and I&#39;m using the VBA to create the worksheets from templates based off of two factors: type (DI, DO, AI, AO) and count (32, 16, 8, etc.)"}, {"owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "reply_to_user": {"reputation": 1, "user_id": 7346579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DoygUPl2okI/AAAAAAAAAAI/AAAAAAAAAIo/i6lz2z_C8OQ/photo.jpg?sz=128", "display_name": "Jay Noerper", "link": "https://stackoverflow.com/users/7346579/jay-noerper"}, "edited": false, "score": 0, "creation_date": 1482994096, "post_id": 41348835, "comment_id": 69950669, "body": "Does the <code>Find</code> method then do what you need or do you just need the <code>Formula</code> property to insert the formulas programmatically?"}], "tags": [], "owner": {"reputation": 652, "user_id": 5536802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9b9b8552d6dce5be435a0ce83015bb?s=128&d=identicon&r=PG&f=1", "display_name": "M.Doerner", "link": "https://stackoverflow.com/users/5536802/m-doerner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482856659, "creation_date": 1482856659, "answer_id": 41348835, "question_id": 41348634, "link": "https://stackoverflow.com/questions/41348634/matching-cells-value-to-row-then-directing-to-value-in-a-column-of-the-row/41348835#41348835", "title": "Matching Cell&#39;s Value to Row then directing to value in a column of the Row", "body": "<p>If you just need this in a worbook function take a look at <code>INDEX</code> and <code>MATCH</code>. The first returns the what is at the specified row and column in the specified range and the latter returns the row or column in the specified range matching the value to search for. (The search option 0 is required to search for exact matches.)</p>\n\n<p>If you want to do the same in VBA, you can use the <code>Find</code> method of the range object. It returns the cell where the match is found and <code>Nothing</code> if there is no match. On this range you can use <code>EntireRow</code> and then select whatever column you want via the <code>Cells</code> property.</p>\n"}], "owner": {"reputation": 1, "user_id": 7346579, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DoygUPl2okI/AAAAAAAAAAI/AAAAAAAAAIo/i6lz2z_C8OQ/photo.jpg?sz=128", "display_name": "Jay Noerper", "link": "https://stackoverflow.com/users/7346579/jay-noerper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482863593, "creation_date": 1482855813, "last_edit_date": 1482863593, "question_id": 41348634, "link": "https://stackoverflow.com/questions/41348634/matching-cells-value-to-row-then-directing-to-value-in-a-column-of-the-row", "title": "Matching Cell&#39;s Value to Row then directing to value in a column of the Row", "body": "<p>I need code to match a cell to a row number on a separate sheet, then to find the value on that row to a separate column. </p>\n\n<p>For example (This isn't code but rather what I need verbatim):</p>\n\n<pre><code>For Each cell In rng 'Separate worksheet\nMatch value on worksheet(\"IO Table\").Range(\"A:A\") then find row\nMatch row.column(\"J\") value = \"DI\" Then\n</code></pre>\n"}, {"tags": ["xml", "vba", "visual-studio"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 6788055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dddce7721ed011680328cac9f9cf0f9b?s=128&d=identicon&r=PG&f=1", "display_name": "Dillon_Su", "link": "https://stackoverflow.com/users/6788055/dillon-su"}, "is_accepted": true, "score": 0, "last_activity_date": 1482857490, "last_edit_date": 1482857490, "creation_date": 1482856557, "answer_id": 41348806, "question_id": 41348447, "link": "https://stackoverflow.com/questions/41348447/how-to-create-xml-file-using-visual-basic/41348806#41348806", "title": "how to create XML file using visual basic", "body": "<p>I have done this before.  You are going to need to print the XML line by line.  Use FileSystemObject to create a blank .xml file.  Then Open the .xml as an output. Next build your .xml string and print it to the output.</p>\n\n<pre><code>    Dim fs as Object\n    Dim strWriteFileName , strWriteLine as string\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    strWriteFileName = Forms!MAIN.OutputFile.value &amp; \".xml\"\n\n    Open strWriteFileName For Output As #1\n         strWriteLine = \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\"?&gt;\"\n         Print #1, strWriteLine\n         strWriteLine = \"&lt;Root Name=\"\"scenario\"\"&gt;\"\n         Print #1, strWriteLine\n         strWriteLine = \"&lt;Entries&gt;\"\n         Print #1, strWriteLine\n         'Depending on XML schema here may be a good place for a Loop'\n         strWriteLine = \"&lt;Entry Name=\"\"firstname\"\" Value=\"\"gedaan\"\" /&gt;\"\n         Print #1, strWriteLine\n         strWriteLine = \"&lt;Entry Name=\"\"lastname\"\" Value=\"\"salame\"\" /&gt;\"\n         Print #1, strWriteLine\n         strWriteLine = \"&lt;Entry Name=\"\"job\"\" Value=\"\"Engineer\"\" /&gt;\"\n         Print #1, strWriteLine\n         'And here may be a good place to end the loop'\n         strWriteLine = \"&lt;/Entries&gt;\"\n         Print #1, strWriteLine\n         strWriteLine = \"&lt;/Root&gt;\"\n         Print #1, strWriteLine\n   Close #1\n   set fs = Nothing\n</code></pre>\n\n<p>That will print what you have above.  If you need to add multiple entries simply throw a loop in to print more names.  I also used a form called MAIN and a textbox called OutputFile so feel free to replace those with whatever you need.</p>\n"}], "owner": {"reputation": 31, "user_id": 7346473, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/40b3cf5b0f4f340089252cd71286abf4?s=128&d=identicon&r=PG&f=1", "display_name": "Gedaan", "link": "https://stackoverflow.com/users/7346473/gedaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 1, "accepted_answer_id": 41348806, "answer_count": 1, "score": 0, "last_activity_date": 1482857490, "creation_date": 1482855025, "last_edit_date": 1482855509, "question_id": 41348447, "link": "https://stackoverflow.com/questions/41348447/how-to-create-xml-file-using-visual-basic", "title": "how to create XML file using visual basic", "body": "<p>i have a question , i want to create an xml file with visual basic in visual studio .</p>\n\n<p>xml file should be like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Root Name=\"scenario\"&gt;\n  &lt;Entries&gt;\n    &lt;Entry Name=\"firstname\" Value=\"gedaan\" /&gt;\n    &lt;Entry Name=\"lastname\" Value=\"salame\" /&gt;\n    &lt;Entry Name=\"job\" Value=\"Engineer\" /&gt;\n  &lt;/Entries&gt;\n&lt;/Root&gt;\n</code></pre>\n\n<p>i searched alot , but found nothing helpful because the xml that i want is little different , there is no somthing like this : <code>&lt;FirstName&gt;gedaan&lt;/FirstName&gt;</code> ,its just <code>&lt;Entry Name=\"FirstName\" Value=\"gedaan\" /&gt;</code></p>\n\n<p>please help \nthanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482855136, "post_id": 41348429, "comment_id": 69898557, "body": "use <code>CountA</code> instead"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482855321, "post_id": 41348429, "comment_id": 69898639, "body": "@ShaiRado I did, CountA deletes all sheets"}, {"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1482855896, "post_id": 41348429, "comment_id": 69898908, "body": "Have you tried IsEmpty instead?  You could combine it with a Replace for &quot;-&quot;."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1482859782, "post_id": 41348429, "comment_id": 69900696, "body": "@Liss Can you demonstrate what you mean by that."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1482860292, "post_id": 41348429, "comment_id": 69900913, "body": "Your range is <b>456</b> cells............are some of them <b>completely empty</b> or do they contain formulas that can <b>return Empty</b>??"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1482860741, "post_id": 41348429, "comment_id": 69901098, "body": "@Gary&#39;sStudent my range is 440 cells, within this range there are cells that are completely empty and some have numbers but all of the worksheets have 72 cells which have &quot;-----------&quot;"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1482861854, "post_id": 41348429, "comment_id": 69901635, "body": "I found the solution."}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "is_accepted": false, "score": 0, "last_activity_date": 1482861760, "creation_date": 1482861760, "answer_id": 41349979, "question_id": 41348429, "link": "https://stackoverflow.com/questions/41348429/deleting-worksheets-if-range-is-blank/41349979#41349979", "title": "Deleting Worksheets if range is blank", "body": "<p>A slightly different way of approaching the same issue. You could add in a do whole loop to stop if it find something as it will speed up the process slightly but the range is so small I don't think it will be an issue.</p>\n\n<pre><code>Sub DeletingEmptyPages()\n\nDim i As Long\nDim strTestRange As String\nDim bDeleteSheet As Boolean\n\nstrTestRange = \"D14:K70\"\n\nFor Each ws In ThisWorkbook.Worksheets\n    bDeleteSheet = True\n    For Each c In ws.Range(strTestRange)\n        If Not (c.Value = \"\" Or c.Value = \"-\") Then bDeleteSheet = False\n    Next c\n\n    If bDeleteSheet Then\n        If Sheets.Count &gt; 1 Then\n            Application.DisplayAlerts = False\n            ws.Delete\n            Application.DisplayAlerts = True\n        Else\n            MsgBox \"Only 1 sheet left\"\n            Exit Sub\n        End If\n    End If\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "is_accepted": true, "score": 0, "last_activity_date": 1482865908, "creation_date": 1482865908, "answer_id": 41350871, "question_id": 41348429, "link": "https://stackoverflow.com/questions/41348429/deleting-worksheets-if-range-is-blank/41350871#41350871", "title": "Deleting Worksheets if range is blank", "body": "<pre><code>Sub DeletingEmptyPages()\n\nDim i As Long\n\nFor i = Sheets.count To 1 Step -1\n    If WorksheetFunction.CountA(Sheets(i).Range(\"D14:K25, D27:K27, D29:K31, D34:K34, D36:K52, D55:K55, D57:K57, D59:K66, D68:K68, D70:K70 \"), \"\") &gt;= 368 Then\n        If Sheets.count &gt; 1 Then\n            Application.DisplayAlerts = False\n            Sheets(i).Delete\n            Application.DisplayAlerts = True\n        Else\n            MsgBox \"Only 1 sheet left\"\n            Exit Sub\n        End If\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 41350871, "answer_count": 2, "score": 0, "last_activity_date": 1482865908, "creation_date": 1482854974, "last_edit_date": 1482855488, "question_id": 41348429, "link": "https://stackoverflow.com/questions/41348429/deleting-worksheets-if-range-is-blank", "title": "Deleting Worksheets if range is blank", "body": "<p>I made a code that would delete Worksheets if range <strong>\"D14:K70\"</strong> is empty throughout the workbook but I do not know how to ignore \"-----------\" which are in the worksheet range <strong>72x</strong> and empty spaces are <strong>368x</strong>. Also I am having an issue at <strong>Sheets(i).Delete</strong></p>\n\n<pre><code>Sub DeletingEmptyPages()\n\nDim i As Long\n\nFor i = Sheets.count To 1 Step -1\n    If WorksheetFunction.CountIf(Sheets(i).Range(\"D14:K70\"), \"\") &gt;= 368 Then\n        If Sheets.count &gt; 1 Then\n            Application.DisplayAlerts = False\n            Sheets(i).Delete\n            Application.DisplayAlerts = True\n        Else\n            MsgBox \"Only 1 sheet left\"\n            Exit Sub\n        End If\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "if-statement", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482854717, "post_id": 41348306, "comment_id": 69898363, "body": "if you are defining <code>Form_customer_test </code> somewhere, then the <code>If</code> should be <code>If Form_customer_test &gt;= 10 And inumber &lt;= 20 Then</code> . But I think you meant <code>If inumber &gt;= 10 And inumber &lt;= 20 Then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5539668, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/10153320474949372/picture?type=large", "display_name": "Noah Xu", "link": "https://stackoverflow.com/users/5539668/noah-xu"}, "edited": false, "score": 0, "creation_date": 1482855555, "post_id": 41348478, "comment_id": 69898755, "body": "Thanks for pointing it out. I am sorry, that was a typo, I actually had it as inumber instead of form_customer_test. I don&#39;t know how that got into it. Thanks"}], "tags": [], "owner": {"reputation": 176, "user_id": 7327049, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DI45UPngpOs/AAAAAAAAAAI/AAAAAAAAAeU/D193Rb4gm8Y/photo.jpg?sz=128", "display_name": "mike morris", "link": "https://stackoverflow.com/users/7327049/mike-morris"}, "is_accepted": false, "score": 1, "last_activity_date": 1482855131, "creation_date": 1482855131, "answer_id": 41348478, "question_id": 41348306, "link": "https://stackoverflow.com/questions/41348306/if-statement-not-working-in-vba/41348478#41348478", "title": "IF statement not working in VBA", "body": "<pre><code>If Form_customer_test &gt;= 10 &amp; inumber &lt;= 20 Then\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>If inumber &gt;= 10 &amp; inumber &lt;= 20 Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 5539668, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/10153320474949372/picture?type=large", "display_name": "Noah Xu", "link": "https://stackoverflow.com/users/5539668/noah-xu"}, "edited": false, "score": 0, "creation_date": 1482855656, "post_id": 41348559, "comment_id": 69898801, "body": "Thank you very much! That was it! Thanks, it works now. :)"}], "tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": true, "score": 1, "last_activity_date": 1482855480, "creation_date": 1482855480, "answer_id": 41348559, "question_id": 41348306, "link": "https://stackoverflow.com/questions/41348306/if-statement-not-working-in-vba/41348559#41348559", "title": "IF statement not working in VBA", "body": "<p>Try below. <code>&amp;</code> is for string concatenation in VB. <code>And</code> should be used in VB</p>\n\n<pre><code>Private Sub Command0_Click()\n    Me.Text3.SetFocus\n    inumber = Val(Text3.Text)\n    If inumber &gt;= 10 And inumber &lt;= 20 Then\n        MsgBox (\"The number you entered is: \") &amp; inumber\n    Else\n        Text3.Text = \"\"\n        MsgBox (\"Please try again\")\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 6752926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64ee9e556f2c66366edcb8a329f1b168?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/6752926/marco"}, "is_accepted": false, "score": 1, "last_activity_date": 1483110047, "creation_date": 1483110047, "answer_id": 41398267, "question_id": 41348306, "link": "https://stackoverflow.com/questions/41348306/if-statement-not-working-in-vba/41398267#41398267", "title": "IF statement not working in VBA", "body": "<p>Confirm: use \"And\" or \"Or\" for logical operators</p>\n"}], "owner": {"reputation": 147, "user_id": 5539668, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/10153320474949372/picture?type=large", "display_name": "Noah Xu", "link": "https://stackoverflow.com/users/5539668/noah-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 41348559, "answer_count": 3, "score": 0, "last_activity_date": 1594654425, "creation_date": 1482854492, "last_edit_date": 1594654425, "question_id": 41348306, "link": "https://stackoverflow.com/questions/41348306/if-statement-not-working-in-vba", "title": "IF statement not working in VBA", "body": "<p>I am self-learning VBA and trying to write a little program does the following</p>\n\n<p>1.asks users to enter a number between 10 to 20 in a textbox<br>\n2. When a button is clicked, the code will check the number entered in the textbox.If it is between 10 and 20, then a message will be displayed. If the number entered is not between 10 and 20 then the user will be invited to try a gain, and whatever was entered in the textbox will be erased. </p>\n\n<pre><code>Private Sub Command0_Click()\nMe.Text3.SetFocus\ninumber = Val(Text3.Text)\nIf inumber &gt;= 10 &amp; inumber &lt;= 20 Then\nMsgBox (\"The number you entered is: \") &amp; inumber\nElse\nText3.Text = \"\"\nMsgBox (\"Please try again\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>However, I don't think the else part of my codes is working. If I enter 5, it will display 5 instead of the message box. Could anyone please let me know if I have missed anything at all.</p>\n\n<p>Thanks in advance. Happy Holidays.</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1482856149, "post_id": 41348182, "comment_id": 69899034, "body": "I think you&#39;re looking for a CASE statement in your SQL. Otherwise, you want the variable&#39;s entered in the statement to populate in your WHERE."}, {"owner": {"reputation": 45, "user_id": 6700516, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/868ae7b54c403815c05c068712f1bcc5?s=128&d=identicon&r=PG&f=1", "display_name": "Shasti", "link": "https://stackoverflow.com/users/6700516/shasti"}, "reply_to_user": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1482856555, "post_id": 41348182, "comment_id": 69899216, "body": "I tried the If-else, but not sure how to try the case statement."}, {"owner": {"reputation": 1223, "user_id": 2366842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db1f21d133e897903c931feb815012b?s=128&d=identicon&r=PG", "display_name": "user2366842", "link": "https://stackoverflow.com/users/2366842/user2366842"}, "edited": false, "score": 0, "creation_date": 1482856845, "post_id": 41348182, "comment_id": 69899349, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/ms181765.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms181765.aspx</a> some information on a case statement in SQL."}], "owner": {"reputation": 45, "user_id": 6700516, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/868ae7b54c403815c05c068712f1bcc5?s=128&d=identicon&r=PG&f=1", "display_name": "Shasti", "link": "https://stackoverflow.com/users/6700516/shasti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482856642, "creation_date": 1482853935, "last_edit_date": 1482856642, "question_id": 41348182, "link": "https://stackoverflow.com/questions/41348182/using-if-else-in-sql-and-vba", "title": "Using IF - ELSE in SQL and VBA", "body": "<p>I am trying to use IF-ELSE statement in SQL and execute the query in vba. The code below returns the table in excel based on hardcoded filter. But what do I need to, If in case, I need just the results for a specific date range( for example, say for a month) and for a particular location. The location is called as Credited Office in the code. Any help would be much appreciated. </p>\n\n<p>Thanks in advance ! </p>\n\n<pre><code> objMyCmd.CommandText = \" SELECT a.[RDT_FileID],a.[Master Policy Number], a.[Work item /Submission no#],a.[Insured Name], a.[Credited Office],\" &amp; _\n                                \" a.[Credited Underwriter], a.[Product Line], a.[Product Line Subtype], a.[Current Status], a.[Effective Date], a.[Expiry Date],  a.[Premium in USD $] \" &amp; _\n                                \" FROM  DB1[![enter image description here][1]][1].dbo.View_Property_Rater_Of_Record a \" &amp; _\n                                \" WHERE a.[Master Policy Number] Is Not Null \" &amp; _\n                                \" AND a.[RDT_FileID] is null \" &amp; _\n                                \" AND a.[Product Line Subtype] &lt;&gt;  '0102-Marine' \" &amp; _\n                                \" AND a.[Effective Date] &gt;= '2014-04-01' \" &amp; _\n                                \" AND a.[Current Status] ='Bound' \"\n\n        objMyCmd.CommandType = adCmdText\n        objMyCmd.Execute\n</code></pre>\n\n<p>This is the code, that I tried to search the results for the specific dates  </p>\n\n<pre><code>  'Capture the filters that determin the range of the data that reports are based on\n\nSheets(\"Main\").Activate\n\nIf IsEmpty(Range(\"C10\")) Then PED(0) = 42461 Else PED(0) = Range(\"C10\").Value     'Lower bound of Effective Dates, defaults to 4/1/2014\nIf IsEmpty(Range(\"D10\")) Then PED(1) = 407703 Else PED(1) = Range(\"D10\").Value    'Upper bound of Effective Dates, defaults to 4/1/3014\nIf Range(\"D4\") = \"\" Then Reg = \"All Regions\" Else Reg = Range(\"D4\").Value          'Office, defaults to \"All Regions\"\n\n ' Step 8 - Create #TmpFileFltr incorporating all the data filters to #TmpFile\nSql = \"Select * \" _\n    &amp; \"into #TmpFileFltr \" _\n    &amp; \"from #TmpFile \" _\n    &amp; \"where    EffectiveDate &gt;= \" &amp; PED(0) &amp; \" and EffectiveDate &lt;= \" &amp; PED(1) &amp; \" \"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1482853920, "post_id": 41348126, "comment_id": 69897999, "body": "Looks like you need array with sheet names, not with sheets by itself."}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "reply_to_user": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1482854101, "post_id": 41348126, "comment_id": 69898078, "body": "I attempted to modify the code with wb1.sheets(...).name but it only prints out the last element of the array &#39;wb3&#39;."}], "answers": [{"tags": [], "owner": {"reputation": 712, "user_id": 3957090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q5vNk.png?s=128&g=1", "display_name": "DrMarbuse", "link": "https://stackoverflow.com/users/3957090/drmarbuse"}, "is_accepted": false, "score": 0, "last_activity_date": 1522137778, "creation_date": 1522137778, "answer_id": 49507442, "question_id": 41348126, "link": "https://stackoverflow.com/questions/41348126/printing-an-array-of-worksheets-in-excel/49507442#49507442", "title": "Printing an array of worksheets in Excel", "body": "<p>As written in the Office <a href=\"https://msdn.microsoft.com/vba/excel-vba/articles/sheets-object-excel\" rel=\"nofollow noreferrer\">VBA Reference</a>, the <code>Sheets</code>-Object refers to</p>\n\n<blockquote>\n  <p>A collection of all the sheets in the specified or active workbook.</p>\n</blockquote>\n\n<p>Therefore it will not be possible to print sheets from different workbooks together in one print task. Moreover, the syntax ist <code>Sheets(Index)</code> so therefore the <code>index</code> or the <code>name</code> of the sheet has to be passed.</p>\n\n<pre><code>Sub testPrint()\n    Dim wb1 As Workbook\n    Dim wb2 As Workbook\n\n    Dim s(1) As Worksheet\n\n    Dim mySheet As Variant\n\n    '\n    ' collect sheets from different workbooks\n    '\n    Set wb1 = Workbooks(\"wm1.xlsm\")\n    Set wb2 = Workbooks(\"wm2.xlsm\")\n\n    Set s(0) = wb1.Sheets(1)\n    Set s(1) = wb2.Sheets(1)\n\n    '\n    ' print or print preview sheets after each other\n    '\n    For Each mySheet In s\n        mySheet.PrintPreview\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>If You want to print multiple sheets from one workbook in a single print task, You may <code>select</code> them and then print all selected ones.</p>\n"}], "owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1522137778, "creation_date": 1482853693, "last_edit_date": 1482868321, "question_id": 41348126, "link": "https://stackoverflow.com/questions/41348126/printing-an-array-of-worksheets-in-excel", "title": "Printing an array of worksheets in Excel", "body": "<p>The below code attempts to print worksheets across multiple workbooks.</p>\n\n<pre><code>Dim wb1, wb2, wb3 as workbook\n\nset wb1 = workbooks.open(......)\n\nset wb2 = workbooks.open(......)\n\nset wb3 = workbooks.open(......)\n\nSheets(Array(wb1.Sheets(...),wb2.Sheets(...),wb3.Sheets(...))).PrintOut\n</code></pre>\n\n<p>There's a TypeMismatch error in my runs on the last line. What am I Mismatching?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482852622, "post_id": 41347848, "comment_id": 69897449, "body": "Are you intending to set <code>d</code> and <code>f</code> to the same values?"}, {"owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482854868, "post_id": 41347848, "comment_id": 69898425, "body": "no, i edited the question, they are different values, but the problem shold in the range statement,,"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1482857127, "post_id": 41347848, "comment_id": 69899464, "body": "Use <code>Range().Offset()</code> to pick a cell using row/column variables"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1482857289, "post_id": 41347848, "comment_id": 69899558, "body": "Follow the suggestions on my answer in <a href=\"http://stackoverflow.com/questions/41347692/vba-relative-cell-reference-in-loop\" title=\"vba relative cell reference in loop\">stackoverflow.com/questions/41347692/&hellip;</a>"}, {"owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "edited": false, "score": 0, "creation_date": 1482868400, "post_id": 41347848, "comment_id": 69904373, "body": "Still confused.. let us say for example, if e is a varible, I can use Range(&quot;C7:C&quot; &amp; e), how can write a range with a varible to replace 7, but it will not generate range failed message.."}, {"owner": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "edited": false, "score": 0, "creation_date": 1482879585, "post_id": 41347848, "comment_id": 69908392, "body": "@WorstSQLNoob do you want something like the last row/column number?"}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 2128399, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qyzEY.png?s=128&g=1", "display_name": "orson", "link": "https://stackoverflow.com/users/2128399/orson"}, "is_accepted": true, "score": 0, "last_activity_date": 1482878463, "creation_date": 1482878463, "answer_id": 41353088, "question_id": 41347848, "link": "https://stackoverflow.com/questions/41347848/how-to-use-a-varible-to-tell-which-range-to-use-in-vba/41353088#41353088", "title": "how to use a varible to tell which range to use in VBA", "body": "<p>I can't reproduce your error, there is nothing wrong with your AutoFill line.</p>\n\n<p>I suspect you are mis-calling the ranges when you set your variables.</p>\n\n<p>I cannot find an excel reference for <code>Templete</code></p>\n"}], "owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 41353088, "answer_count": 1, "score": 1, "last_activity_date": 1482878463, "creation_date": 1482852434, "last_edit_date": 1482854827, "question_id": 41347848, "link": "https://stackoverflow.com/questions/41347848/how-to-use-a-varible-to-tell-which-range-to-use-in-vba", "title": "how to use a varible to tell which range to use in VBA", "body": "<p>This is a part of my code, in fact, I just want to use two variables to control the range I want to use, but it keeps give my range failed error, I think there may some wrong on where I write the range statement here, so anyone know how to fix it?</p>\n\n<pre><code>Dim d As Long, f As Long\nd= Templete.Worksheets(\"Telogis Data\").Range(\"b2\").End(xlDown).Row\nf = Templete.Worksheets(\"Telogis Data\").Range(\"a2\").End(xlDown).Row\nTemplete.Worksheets(\"Telogis Data\").Range(\"J\" &amp; d, \"L\" &amp; d).AutoFill Destination:=Range(\"J\" &amp; d, \"L\" &amp; f), Type:=xlFillDefault\n</code></pre>\n\n<p>Thx\nPudge</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1482852009, "post_id": 41347692, "comment_id": 69897143, "body": "you need to trap errors in case you will not have a successful <code>Match</code>"}, {"owner": {"reputation": 1, "user_id": 7346298, "user_type": "registered", "profile_image": "https://graph.facebook.com/346298379086343/picture?type=large", "display_name": "L&#225;szl&#243; Anga", "link": "https://stackoverflow.com/users/7346298/l%c3%a1szl%c3%b3-anga"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482852409, "post_id": 41347692, "comment_id": 69897344, "body": "Thanks for the help. The 2 sheets are identical and it is only created for testing purposes, which means that all values can be found on both sheets. Do I need to trap errors in this case as well?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482852520, "post_id": 41347692, "comment_id": 69897400, "body": "not really, just if you have some logic error somewhere in your code. In my code I trap it anyway, in case I have an extra space at the end of the text, or some other fault I might have done"}, {"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1482852535, "post_id": 41347692, "comment_id": 69897412, "body": "Why are doing Cells.Value instead of just Cells = ?  You&#39;re getting the error because the match is failing though."}, {"owner": {"reputation": 1, "user_id": 7346298, "user_type": "registered", "profile_image": "https://graph.facebook.com/346298379086343/picture?type=large", "display_name": "L&#225;szl&#243; Anga", "link": "https://stackoverflow.com/users/7346298/l%c3%a1szl%c3%b3-anga"}, "edited": false, "score": 0, "creation_date": 1482853542, "post_id": 41347692, "comment_id": 69897824, "body": "Thanks for the help. I have removed the .value and still getting the same error msg."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1482854742, "post_id": 41347692, "comment_id": 69898379, "body": "To act on multiple cells use <code>Range(&quot;B2&quot;).Resize(ActSor, ActOsz)</code> syntax"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7346298, "user_type": "registered", "profile_image": "https://graph.facebook.com/346298379086343/picture?type=large", "display_name": "L&#225;szl&#243; Anga", "link": "https://stackoverflow.com/users/7346298/l%c3%a1szl%c3%b3-anga"}, "edited": false, "score": 0, "creation_date": 1482852911, "post_id": 41347936, "comment_id": 69897563, "body": "Thanks for the help. Nope, still the same err msg."}], "tags": [], "owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "is_accepted": false, "score": 1, "last_activity_date": 1482852802, "creation_date": 1482852802, "answer_id": 41347936, "question_id": 41347692, "link": "https://stackoverflow.com/questions/41347692/vba-relative-cell-reference-in-loop/41347936#41347936", "title": "VBA: relative cell reference in loop", "body": "<pre><code>Set Rg = ws2.Range(\"B2\", Cells(ActSor, ActOsz))\n</code></pre>\n\n<p>this is forbidden. Correct syntax: </p>\n\n<pre><code>Set Rg = Range( ws2.Range(\"B2\"), ws2.Cells(ActSor, ActOsz))\n</code></pre>\n\n<p>Does that help?</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7346298, "user_type": "registered", "profile_image": "https://graph.facebook.com/346298379086343/picture?type=large", "display_name": "L&#225;szl&#243; Anga", "link": "https://stackoverflow.com/users/7346298/l%c3%a1szl%c3%b3-anga"}, "edited": false, "score": 0, "creation_date": 1482855864, "post_id": 41348486, "comment_id": 69898895, "body": "Thanks for the help @Ja72 The users can modify the original sheet - can add more columns - that is why I would not like to use the offset or the resize bacause that way I would need to modify the code each time. Is it possible to write a loop code that uses vloopup or index&amp;match - I know that errror trapping is still missing - where it checked the value in column A and then brings back the values of the column, and if there are 10 columns it brings back the 10th column value and if there are 100, then the 100th?"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 1, "user_id": 7346298, "user_type": "registered", "profile_image": "https://graph.facebook.com/346298379086343/picture?type=large", "display_name": "L&#225;szl&#243; Anga", "link": "https://stackoverflow.com/users/7346298/l%c3%a1szl%c3%b3-anga"}, "edited": false, "score": 0, "creation_date": 1482856064, "post_id": 41348486, "comment_id": 69898989, "body": "The way to deal with this it to use <a href=\"https://support.office.com/en-us/article/Define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64\" rel=\"nofollow noreferrer\">Named Ranges</a> such that you never reference absolute locations, but always relative. I will edit my answer."}, {"owner": {"reputation": 1, "user_id": 7346298, "user_type": "registered", "profile_image": "https://graph.facebook.com/346298379086343/picture?type=large", "display_name": "L&#225;szl&#243; Anga", "link": "https://stackoverflow.com/users/7346298/l%c3%a1szl%c3%b3-anga"}, "edited": false, "score": 0, "creation_date": 1482858802, "post_id": 41348486, "comment_id": 69900261, "body": "I will see if I can resolve it this way. Thanks for the tip."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1482856163, "last_edit_date": 1482856163, "creation_date": 1482855174, "answer_id": 41348486, "question_id": 41347692, "link": "https://stackoverflow.com/questions/41347692/vba-relative-cell-reference-in-loop/41348486#41348486", "title": "VBA: relative cell reference in loop", "body": "<p>Any time you use a <code>Range()</code> object there is an implicit <code>ActiveSheet.Range()</code> command used. IF the sheet you want to pull values from is not active the <code>Range()</code> command will give the wrong results.</p>\n\n<p>My suggestions:</p>\n\n<ol>\n<li>Qualify all <code>Range()</code> functions with the appropriate worksheet object, like <code>ws1.Range()</code>. </li>\n<li>Pick the top left cell in a table with a range, and then extend to the table using the <code>Resize()</code> command. For example to pick cell <code>A2</code> and the next 100 rows and 20 columns, use <code>ws1.Range(\"A2\").Resize(100,20)</code>.</li>\n<li>Instead of using <code>Cells()</code> which also have an implicit active worksheet use an existing range and use the <code>Offset()</code> command. To pick the <em>i</em>-th row of a table with 20 columns starting from cell <code>A2</code> use <code>Range(\"A2\").Offset(i-1,0).Resize(1,20)</code></li>\n<li>Use <a href=\"https://support.office.com/en-us/article/Define-and-use-names-in-formulas-4d0f13ac-53b7-422e-afd2-abd7ff379c64\" rel=\"nofollow noreferrer\">named ranges</a> to pick cell references because they move with the cells. For example <code>Range(\"AccountsTable\").Offset(i-1,0).Resize(1,20)</code></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 7346298, "user_type": "registered", "profile_image": "https://graph.facebook.com/346298379086343/picture?type=large", "display_name": "L&#225;szl&#243; Anga", "link": "https://stackoverflow.com/users/7346298/l%c3%a1szl%c3%b3-anga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482856163, "creation_date": 1482851773, "last_edit_date": 1531164843, "question_id": 41347692, "link": "https://stackoverflow.com/questions/41347692/vba-relative-cell-reference-in-loop", "title": "VBA: relative cell reference in loop", "body": "<p>I am trying to use relative reference in a loop. My aim is to use index and match combined to find values independent of how many rows and columns are present in the file. This is what I have created so far, but it does not work. The data is the the same stored on two different sheets.</p>\n\n<pre><code> Error msg: Run-time error '1004':\n</code></pre>\n\n<p>Unable to get the Match Property of the <code>WorksheetFunction</code> class</p>\n\n<ol>\n<li><p>Sub testing()</p>\n\n<pre><code>Dim ActSor As Long, ActOsz As Long\n\nActSor = ActiveSheet.UsedRange.Rows.Count \nActOsz = ActiveSheet.UsedRange.Columns.Count\n\nDim ws1 As Worksheet, ws2 As Worksheet\n\nSet ws1 = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\n\nDim Rg As Range\n\nSet Rg = ws2.Range(\"B2\", Cells(ActSor, ActOsz))\n\nDim RgActOsz As Long\n\nRgActOsz = Rg.Columns.Count\n\nDim i As Long , sor As Long\n\nFor i = 2 To RgActOsz\n   For sor = 2 To ActSor\n      Cells(sor, i).Value = Application.WorksheetFunction.Index(ws1.Columns(i),\n      Application.WorksheetFunction.Match(Cells(sor, 1), Rg.Columns(1), 0))\n   Next sor\nNext i\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}, {"tags": ["excel", "vba", "shift"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1482851794, "post_id": 41347012, "comment_id": 69897045, "body": "The reason Excel doesn&#39;t &quot;shift right&quot; is because deleting leaves a &quot;hole&quot; that needs to be filled.  <code>xlToRight</code> would leave a <i>bigger</i> &quot;hole&quot;. Just copy everything to the right and clear the cell contents instead."}, {"owner": {"reputation": 15, "user_id": 7285739, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c-p0NSoU86o/AAAAAAAAAAI/AAAAAAAAA0Q/W8n-QfFNyLg/photo.jpg?sz=128", "display_name": "Patrick Muller marsu211", "link": "https://stackoverflow.com/users/7285739/patrick-muller-marsu211"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482853043, "post_id": 41347012, "comment_id": 69897616, "body": "Ok, thank you for the clarification. I am about to write the code to do that."}], "answers": [{"tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1482929006, "last_edit_date": 1482929006, "creation_date": 1482926924, "answer_id": 41361854, "question_id": 41347012, "link": "https://stackoverflow.com/questions/41347012/shift-cells-right-when-deleting-a-cell-in-vba/41361854#41361854", "title": "shift cells right when deleting a cell in vba", "body": "<p>I agree with the comments it shouldn't be massively complicated but I think it is worth an answer. This preserves any formatting of the shifted cells (the ones to the left of the range) but clears the format and contents of the deleted cells.</p>\n\n<pre><code>Sub DelRight()\n\nDim firstColumn, lastColumn, firstRow, lastRow, nRows, nCols, colsToShift As Long\nDim sheet As Worksheet\nDim rangeToCopy, rangeToReplace, rangeToDelete As Range\n\nSet sheet = ActiveSheet\n\nfirstColumn = Selection.Column\nnCols = Selection.Columns.Count\nnRows = Selection.Rows.Count\nlastColumn = firstColumn + nCols - 1\ncolsToShift = firstColumn - 1\nfirstRow = Selection.Row\nlastRow = firstRow + nRows - 1\n\n' Shift cells to left of the range to the right hand end of the range\nWith sheet\n    If firstColumn &gt; 1 Then\n        Set rangeToCopy = .Range(.Cells(firstRow, 1), .Cells(lastRow, colsToShift))\n        Set rangeToReplace = .Range(.Cells(firstRow, lastColumn - colsToShift + 1), .Cells(lastRow, lastColumn))\n        rangeToCopy.Copy destination:=rangeToReplace\n    End If\n\n    ' Delete cells to the left of the shifted cells\n    Set rangeToDelete = .Range(.Cells(firstRow, 1), .Cells(lastRow, lastColumn - colsToShift))\n    rangeToDelete.ClearContents\n    rangeToDelete.ClearFormats\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 6045211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/201898e9f9a272cf5a1746a2dc722001?s=128&d=identicon&r=PG&f=1", "display_name": "Caio", "link": "https://stackoverflow.com/users/6045211/caio"}, "is_accepted": true, "score": 0, "last_activity_date": 1549457852, "creation_date": 1549457852, "answer_id": 54554198, "question_id": 41347012, "link": "https://stackoverflow.com/questions/41347012/shift-cells-right-when-deleting-a-cell-in-vba/54554198#54554198", "title": "shift cells right when deleting a cell in vba", "body": "<p>I prefer this simple aproach:</p>\n\n<pre><code>Sub DELETE_MOVE_TO_RIGHT()\n\nDim firstcolumn As Integer\nDim lastcolumn As Integer\n\nDim firstrow As Integer\nDim lastrow As Long\n\nDim i As Integer\nDim j As Integer\n\nDim nrows As Long\nDim ncols As Integer\n\nncols = Selection.Columns.Count\nnrows = Selection.Rows.Count\nfirstcolumn = Selection.Column\nlastcolumn = firstcolumn + ncols - 1\nfirstrow = Selection.Row\nlastrow = firstrow + nrows - 1\n\n    Range(Cells(firstrow, firstcolumn), Cells(lastrow, lastcolumn)).SpecialCells(xlCellTypeBlanks).Delete Shift:=xlToLeft\n\n    For j = lastcolumn To firstcolumn + 1 Step -1\n        Range(Cells(firstrow, firstcolumn), Cells(lastrow, firstcolumn)).Cut\n        Range(Cells(firstrow, j + 1), Cells(lastrow, j + 1)).Insert Shift:=xlToRight\n    Next j\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7285739, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c-p0NSoU86o/AAAAAAAAAAI/AAAAAAAAA0Q/W8n-QfFNyLg/photo.jpg?sz=128", "display_name": "Patrick Muller marsu211", "link": "https://stackoverflow.com/users/7285739/patrick-muller-marsu211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1686, "favorite_count": 0, "accepted_answer_id": 54554198, "answer_count": 2, "score": 1, "last_activity_date": 1549457852, "creation_date": 1482848993, "last_edit_date": 1483106251, "question_id": 41347012, "link": "https://stackoverflow.com/questions/41347012/shift-cells-right-when-deleting-a-cell-in-vba", "title": "shift cells right when deleting a cell in vba", "body": "<p>I need to shift cells to the right after I have deleted content.\nThis option is not given by excel, I get only 4 choices:\n- Shift cells left\n- Shift cells up\n- Entire row\n- Entire column</p>\n\n<p>At the end I wish to end-up with something lke this in my VBA code:</p>\n\n<pre><code>Selection.Delete Shift:=xlToRight\n</code></pre>\n\n<p>I changed from</p>\n\n<pre><code>Selection.Delete Shift:=xlToLeft\n</code></pre>\n\n<p>Thank you in advance for any help on this\nBrgds\nPatrick</p>\n\n<p>I finally ended up with this and it works amzingly fine:</p>\n\n<pre><code>Sub ShiftRight()\n Selection.End(xlToRight).Select\n numcol = ActiveCell.Column\n numcol2 = numcol\n numcol = (numcol - lngColNumber) + 5\n strcolletter = Split(Cells(1, numcol - 1).Address, \"$\")(1)\n strcolletter2 = Split(Cells(1, numcol2).Address, \"$\")(1)\n Range(Myrange).Select\n Selection.Cut Destination:=Columns(strcolletter &amp; \":\" &amp; strcolletter2)\nEnd Sub\n</code></pre>\n\n<p>I needed the use of variables which are defined at top level, because the ranges I need to move to the right will never have the same number of columns.</p>\n\n<p>I hope this will help others in future too.\nThx to all for your replies</p>\n"}, {"tags": ["excel", "office-communicator", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482849638, "post_id": 41346622, "comment_id": 69896025, "body": "Welcome to S.O! Have you tried anything? If so, please, provide the code. Take a look to the <a href=\"http://stackoverflow.com/tour\">tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>. Friendly reminder: StackOverflow is not a &quot;we code for you&quot; service provider. <a href=\"https://blog.udemy.com/excel-macros-tutorial/\" rel=\"nofollow noreferrer\">Introduction to VBA</a> or <a href=\"http://analysistabs.com/excel-vba/codes-examples-macros-how-tos-most-useful-basics-advanced/\" rel=\"nofollow noreferrer\">Mid-Advanced Tutorials</a> and my <a href=\"http://analystcave.com/excel-vba-tutorial/\" rel=\"nofollow noreferrer\">personal favorite</a>"}, {"owner": {"reputation": 9, "user_id": 7346123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/358985c347b96f633f11bbc7c35101e8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/7346123/rohan"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1482995982, "post_id": 41346622, "comment_id": 69951451, "body": "Yes, I have tries too many codes but none of them is for the time duration. they just provide me the current status of each user in my contact list."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 7346123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/358985c347b96f633f11bbc7c35101e8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/7346123/rohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1483003537, "creation_date": 1483003537, "answer_id": 41376686, "question_id": 41346622, "link": "https://stackoverflow.com/questions/41346622/how-to-get-lync-away-time-of-a-user/41376686#41376686", "title": "How to get LYNC away time of a user", "body": "<p>I have done it.... \nbelow is the code that I used and it is working fine.\nI made some changes to it to serve my purpose.</p>\n\n<pre><code>'This Macro is working fine\nPublic Sub macro10()\nLyncContactsStatus\nEnd Sub\n\nFunction LyncContactsStatus() As Variant\nDim appLync As CommunicatorAPI.Messenger\n\nDim LyncDirectory As CommunicatorAPI.IMessengerContacts\n\nDim LyncContact As CommunicatorAPI.IMessengerContact\n\nDim arrContacts() As Variant\n\nDim lngLoopCount As Long\n\nSet appLync = CreateObject(\"Communicator.UIAutomation\")\n    appLync.AutoSignin\nSet LyncDirectory = appLync.MyContacts\n\nReDim arrContacts(LyncDirectory.Count - 1, 1)\n\nFor lngLoopCount = 0 To LyncDirectory.Count - 1\n    Set LyncContact = LyncDirectory.Item(lngLoopCount)\n    arrContacts(lngLoopCount, 0) = LyncContact.FriendlyName\n    arrContacts(lngLoopCount, 1) = LyncStatus(LyncContact.Status)\nActiveCell.Value = LyncContact.FriendlyName\nActiveCell.Offset(0, 1).Value = LyncContact.Status\nIf LyncContact.Status = MISTATUS_AWAY Then\nIf ActiveCell.Offset(0, 3).Value = \"\" Then\nActiveCell.Offset(0, 3).Value = Now\nEnd If\nEnd If\nIf LyncContact.Status = MISTATUS_ONLINE Then\nIf ActiveCell.Offset(0, 3).Value &lt;&gt; \"\" Then\nActiveCell.Offset(0, 4).Value = Now\nSheet1.Range(ActiveCell, ActiveCell.Offset(0, 4)).Select\nSelection.Copy\nDim i\ni = 1\nDo\ni = i + 1\nIf Sheet2.Cells(i, 1).Value = \"\" Then\nSheet2.Activate\nCells(i, 1).Select\n\n'Sheet2.Activate\nSheet2.Paste\ni = i + 1\nSheet1.Activate\nEnd If\nLoop Until Sheet2.Cells(i, 1).Value = \"\"\nActiveCell.Offset(0, 3) = \"\"\nActiveCell.Offset(0, 4) = \"\"\nEnd If\nEnd If\nActiveCell.Offset(1, 0).Activate\n\n\nNext lngLoopCount\n\nLyncContactsStatus = arrContacts\n\nSet appLync = Nothing\nCells(1, 1).Activate\nApplication.OnTime Now + TimeValue(\"00:00:30\"), \"Macro10\"\n\nEnd Function\n\n\n\nFunction LyncStatus(IntStatus As Integer) As String\n\nSelect Case IntStatus\n    Case 1      'MISTATUS_OFFLINE\n        LyncStatus = \"Offline\"\n    Case 2      'MISTATUS_ONLINE\n        LyncStatus = \"Online\"\n    Case 6      'MISTATUS_INVISIBLE\n        LyncStatus = \"Invisible\"\n    Case 10     'MISTATUS_BUSY\n        LyncStatus = \"Busy\"\n    Case 14     'MISTATUS_BE_RIGHT_BACK\n        LyncStatus = \"Be Right Back\"\n    Case 18     'MISTATUS_IDLE\n        LyncStatus = \"Idle\"\n    Case 34     'MISTATUS_AWAY\n        LyncStatus = \"Away\"\n    Case 50     'MISTATUS_ON_THE_PHONE\n        LyncStatus = \"On the Phone\"\n    Case 66     'MISTATUS_OUT_TO_LUNCH\n        LyncStatus = \"Out to Lunch\"\n    Case 82     'MISTATUS_IN_A_MEETING\n        LyncStatus = \"In a meeting\"\n    Case 98     'MISTATUS_OUT_OF_OFFICE\n        LyncStatus = \"Out of office\"\n    Case 114    'MISTATUS_OUT_OF_OFFICE\n        LyncStatus = \"Do not disturb\"\n    Case 130    'MISTATUS_IN_A_CONFERENCE\n        LyncStatus = \"In a conference\"\n    Case Else\n        LyncStatus = \"Unknown\"\nEnd Select\nEnd Function\n</code></pre>\n\n<p>This Code will record breaks for your contacts in Sheet 2.</p>\n\n<p>For any assistance please mail me at \"Rohan.shona@gmail.com\"</p>\n"}], "owner": {"reputation": 9, "user_id": 7346123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/358985c347b96f633f11bbc7c35101e8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohan", "link": "https://stackoverflow.com/users/7346123/rohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2158, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1527570348, "creation_date": 1482847357, "last_edit_date": 1531164843, "question_id": 41346622, "link": "https://stackoverflow.com/questions/41346622/how-to-get-lync-away-time-of-a-user", "title": "How to get LYNC away time of a user", "body": "<p>I am working on a tool that will capture the utilization of team members. I am trying to get the break time of users in excel. Please suggest me a vba code that will start a timer in excel when the user is away on LYNC and stop the timer once he/she is online.\nthat's how I will be able to get the away time of users and the rest will be utilization. :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482846963, "post_id": 41346491, "comment_id": 69894707, "body": "really ? seriously ? please find the time to give feedback to previous question you posted here (and you took a large portion of the code from)  , Link : <a href=\"http://stackoverflow.com/questions/41342459/if-condition-in-for-loop\" title=\"if condition in for loop\">stackoverflow.com/questions/41342459/if-condition-in-for-loo&zwnj;&#8203;p</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1482847236, "post_id": 41346491, "comment_id": 69894838, "body": "You seem to be confused about the meaning of <code>FormulaR1C1</code> -- such formulas don&#39;t refer to cells using things like <code>A1</code>, instead they use things like <code>R[1]C[1]</code>."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1482847819, "post_id": 41346491, "comment_id": 69895109, "body": "FYI, a better approach to <code>Range(&quot;Y&quot; &amp; i)</code> is <code>Range(&quot;Y2&quot;).Offset(i-1,0)</code> with <code>i=1..51</code>. It makes it much easier to change the top left cell value <code>Y2</code>  later. Also you are not doing string math to find the ranges. Additionally to act on multiple cells use <code>Range(&quot;Y2&quot;).Resize(51,1)</code> for example."}, {"owner": {"reputation": 17, "user_id": 7345188, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/38ac4fafdae799eb0408c44eed2dce82?s=128&d=identicon&r=PG&f=1", "display_name": "vaasusk", "link": "https://stackoverflow.com/users/7345188/vaasusk"}, "edited": false, "score": 0, "creation_date": 1482847914, "post_id": 41346491, "comment_id": 69895152, "body": "My function (PlaceRegularOrder(....)) should be place in Y2, Y3..... Y52. Values to be taken from &quot;A&quot;, &quot;B&quot;, &quot;W&quot; and &quot;Q&quot; using loop. Please let me know how can I do that."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1482868381, "creation_date": 1482868381, "answer_id": 41351375, "question_id": 41346491, "link": "https://stackoverflow.com/questions/41346491/passing-cell-values-in-user-defined-function-in-range/41351375#41351375", "title": "Passing cell values in user defined function in range", "body": "<p>Your current code is trying to create a string to be passed to the <code>FormulaR1C1</code> property.  You are making three mistakes:</p>\n\n<ol>\n<li><p>You are not using double double-quotation marks when trying to store a double-quotation mark within the string.  (You seem to have done it in some places, but not others.)</p></li>\n<li><p>You are expecting that Excel itself will be able to make sense of things like <code>Range(\"A2\")</code>.</p></li>\n<li><p>You are not using R1C1 notation for cells.</p></li>\n</ol>\n\n<p>Your code needs to be:</p>\n\n<pre><code>Sub PlaceOrd()\n    Dim i As Long\n    For i = 2 To 52\n        Cells(i, \"Y\").FormulaR1C1 = _\n        \"=PlaceRegularOrder(RC1, RC2, \"\"BUY\"\", \"\"SL\"\", RC23, \"\"MIS\"\", RC17, RC17)\"\n    Next i\nEnd Sub\n</code></pre>\n\n<p>That can then be simplified to be:</p>\n\n<pre><code>Sub PlaceOrd()\n    Range(\"Y2:Y52\").FormulaR1C1 = _\n        \"=PlaceRegularOrder(RC1, RC2, \"\"BUY\"\", \"\"SL\"\", RC23, \"\"MIS\"\", RC17, RC17)\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7345188, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/38ac4fafdae799eb0408c44eed2dce82?s=128&d=identicon&r=PG&f=1", "display_name": "vaasusk", "link": "https://stackoverflow.com/users/7345188/vaasusk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482868381, "creation_date": 1482846847, "last_edit_date": 1531164843, "question_id": 41346491, "link": "https://stackoverflow.com/questions/41346491/passing-cell-values-in-user-defined-function-in-range", "title": "Passing cell values in user defined function in range", "body": "<pre><code>Sub PlaceOrd()\n    Dim i As Long\n    For i = 2 To 52\n        Range(\"Y\" &amp; i).FormulaR1C1 = _\n            \"=PlaceRegularOrder(Range(\"A\" &amp; i), Range(\"B\" &amp; i), \"\"BUY\"\", \"\"SL\"\", Range(\"W\" &amp; i), \"\"MIS\"\", Range(\"Q\" &amp; i), Range(\"Q\" &amp; i))\"\n    Next i\nEnd Sub\n</code></pre>\n\n<p>The above code throws an Error \"Expected:End of Statement\". Please tell me how can I handle this. In the above code \"A\", \"B\", \"W\" and \"Q\" are columns. But If I  represent \"A\" as \"\"A\"\" then the code is showing no error but A B W and Q are taken as text. How to rectify this</p>\n\n<p>My function (PlaceRegularOrder(....)) should be place in Y2, Y3..... Y52 using loop. Some Values to be taken from \"A\", \"B\", \"W\" and \"Q\". Please let me know how can I do that</p>\n"}, {"tags": ["html", "excel", "vba", "svg", "explorer"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1482852989, "post_id": 41346137, "comment_id": 69897594, "body": "may be try innerhtml and then string parsing."}, {"owner": {"reputation": 11, "user_id": 7345869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab2b888cc5f6dec7760ad17829ad46f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jaggernaught", "link": "https://stackoverflow.com/users/7345869/jaggernaught"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1483024659, "post_id": 41346137, "comment_id": 69966789, "body": "innerhtml gives me svg code, not &lt;use.....&gt; part. this is what I got using innerhtml: &lt;svg xmlns=&quot;<a href=\"http://www.w3.org/2000/svg\" rel=\"nofollow noreferrer\">w3.org/2000/svg</a>&quot; role=&quot;presentation&quot; viewBox=&quot;0 0 40 40&quot;&gt;&lt;path fill=&quot;#ff8900&quot; d=&quot;M 20 0 C 8.953 0 0 8.955 0  -5.683 -5.18 Z&quot; /&gt;&lt;circle fill=&quot;#ff8900&quot; cx=&quot;20&quot; cy=&quot;28.801&quot; r=&quot;1.6&quot; /&gt;&lt;/svg&gt; which would be usefull if I only could paste this graphic into excel"}], "answers": [{"comments": [{"owner": {"reputation": 10601, "user_id": 6106791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c6445.jpg?s=128&g=1", "display_name": "baduker", "link": "https://stackoverflow.com/users/6106791/baduker"}, "edited": false, "score": 3, "creation_date": 1523118009, "post_id": 49709085, "comment_id": 86432246, "body": "Any answer that gets the asker going in the right direction is helpful, but do try to mention any limitations, assumptions or simplifications in your answer. Brevity is acceptable, but fuller explanations are better."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 2, "creation_date": 1523120102, "post_id": 49709085, "comment_id": 86432937, "body": "Add a bit explanation in your answer else it will be closed."}], "tags": [], "owner": {"reputation": 1, "user_id": 9612135, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ix1HTnlgvjo/AAAAAAAAAAI/AAAAAAAAADY/Qq6Kc5abBdc/photo.jpg?sz=128", "display_name": "\u6cf0\u5b8f\u5353", "link": "https://stackoverflow.com/users/9612135/%e6%b3%b0%e5%ae%8f%e5%8d%93"}, "is_accepted": false, "score": 0, "last_activity_date": 1532502504, "last_edit_date": 1532502504, "creation_date": 1523115912, "answer_id": 49709085, "question_id": 41346137, "link": "https://stackoverflow.com/questions/41346137/how-to-copy-attribute-of-svg-graphic-from-html-to-excel/49709085#49709085", "title": "How to copy attribute of svg graphic (from html to excel)", "body": "<p><strong>Please try this:</strong></p>\n\n<pre><code>Cells(i, 3).Value = elements(1).Children(0).Children(0).getAttribute(\"xlink:href\")\n</code></pre>\n\n<p>Explain:</p>\n\n<ol>\n<li><p>Because elements are set as <code>doc.getElementsByTagName(\"td\")</code> and the tagname \"use\" is under two level, add <code>Children(0).Children(0).</code> or <code>firstElementChild.firstElementChild</code> to get <code>href</code>.</p></li>\n<li><p><code>elements(1).Children(0).Children(0).href</code> gets nothing, instead, take <code>.getAttribute(\"xlink:href\")</code> to replace <code>.href</code>.</p></li>\n</ol>\n\n<p>Or another solution would be:</p>\n\n<pre><code>Set elements = doc.getElementsByClassName(\"results-status\")\n\nCells(i, 3).Value = elements(0).firstElementChild.firstElementChild.getAttribute(\"xlink:href\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/soA0b.png\" rel=\"nofollow noreferrer\">Attached screenshot of working code and tested</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7345869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab2b888cc5f6dec7760ad17829ad46f4?s=128&d=identicon&r=PG&f=1", "display_name": "Jaggernaught", "link": "https://stackoverflow.com/users/7345869/jaggernaught"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1532502504, "creation_date": 1482845423, "last_edit_date": 1483025200, "question_id": 41346137, "link": "https://stackoverflow.com/questions/41346137/how-to-copy-attribute-of-svg-graphic-from-html-to-excel", "title": "How to copy attribute of svg graphic (from html to excel)", "body": "<p>I have created a macro that finds people from the website online base (using their pin numbers) and I want to copy some information about them to excel (like their name, status etc.). \nThe search reasult is a table that contains text and objects (svg) and I have the problem with copying objects to excel.\nThe search result looks like that:</p>\n\n<pre><code>&lt;td data-label=\"Full name\"&gt;Name&lt;/td&gt;\n&lt;td data-label=\"Status\" class=\"results-status\"&gt;\n    &lt;svg role=\"presentation\"&gt;&lt;use xlink:href=\"/static/img/sprite.svg#status-caution\"&gt;&lt;/use&gt;&lt;/svg&gt;\n&lt;/td&gt;\n&lt;td data-label=\"Location\"&gt;UK&lt;/td&gt;\n&lt;td data-label=\"Details\"&gt;&lt;/td&gt;\n</code></pre>\n\n<p>So I wrote this:</p>\n\n<pre><code>Set elements = doc.getElementsByTagName(\"td\")\n            Cells(i, 1).Value = elements(0).innerText\n            Cells(i, 3).Value = elements(1).innerText\n            Cells(i, 4).Value = elements(2).innerText\n            Cells(i, 5).Value = elements(3).innerText\n</code></pre>\n\n<p>And unfortunately I don't get anything from elements(1). I guess it doesn't work because this is an object not a text.</p>\n\n<p>I have to get status information from the 2nd row (/static/img/sprite.svg#<strong>status-caution</strong>) and I don't have any idea how to do this. I also tried<code>img = elements(1).getAttribute()</code> but msgbox(img) showed only this: [native code]</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1482846087, "post_id": 41346077, "comment_id": 69894304, "body": "I would recommend to do not use tables with multi-valued columns, they cause more problems than benefits"}, {"owner": {"reputation": 104, "user_id": 6809754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4579e2cefd7d00c001e867f89e1259f?s=128&d=identicon&r=PG", "display_name": "Velid", "link": "https://stackoverflow.com/users/6809754/velid"}, "edited": false, "score": 0, "creation_date": 1482849539, "post_id": 41346077, "comment_id": 69895980, "body": "I agree, create table where you will store optional subjects - you can easy insert new value once subject is selected, or remove from table for each student."}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 0, "last_activity_date": 1482858741, "creation_date": 1482858741, "answer_id": 41349309, "question_id": 41346077, "link": "https://stackoverflow.com/questions/41346077/update-a-multi-valued-column-through-checkbox-values/41349309#41349309", "title": "Update a multi-valued column through checkbox values", "body": "<p>Create a new table with 2 fields; Student ID and Subject.  Write all subjects into that table.  When you need to return them, either use a subform (linked on StudentID) or create a pivot table if necessary.</p>\n\n<p>Multi-Value columns are not optimal, they create a lot of problems.  If you absolutely <strong>must</strong> use one, then you need to parse the data when you extract it.  When you first write it, you need to write a statement like;</p>\n\n<pre><code>MyStr = \"\" \nIf Me.Checkbox1 = True then\n  MyStr = MyStr &amp; \"SomeValue, \"\nEndIf\nIf Me.Checkbox2 = True then\n  MyStr = MyStr &amp; \"SomeValue2, \"\nEndIf\nIf Me.Checkbox3 = True then\n  MyStr = MyStr &amp; \"SomeValue3, \"\nEndIf\nIf Me.Checkbox4 = True then\n  MyStr = \"SomeValue4, \"\nEndIf  \n\nIf Len(MyStr) &gt; 2 Then\n  MyStr = Left(MyStr, Len(MyStr) - 2)\nEndIF\n</code></pre>\n\n<p>What this does is continually append the values you assign to the checkboxes, and then removes the last 2 characters (which should be \", \") so you have a complete string.  Then you write MyStr to your Subject field.  </p>\n\n<p>When you go to read this info, you'll need to parse it out into an array and work backwards, determining which checkbox should be marked based on the values in your array.</p>\n"}], "owner": {"reputation": 1, "user_id": 7345968, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8FjVQgDNkZA/AAAAAAAAAAI/AAAAAAAAAB0/6DkuQUU-baU/photo.jpg?sz=128", "display_name": "Arunika Sangwan", "link": "https://stackoverflow.com/users/7345968/arunika-sangwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482858741, "creation_date": 1482845231, "question_id": 41346077, "link": "https://stackoverflow.com/questions/41346077/update-a-multi-valued-column-through-checkbox-values", "title": "Update a multi-valued column through checkbox values", "body": "<p>I have recently started using Access with VBA. </p>\n\n<p>Problem Statement : There are 4 optional subjects say Maths,Economics,Computer Science,Home Science. A column called 'Subject' for each student stores the optional subjects(the number of subjects varies with each student).</p>\n\n<p>What I did : I made a multi-valued field in the table called 'Subject' using the lookup wizard in design view. In the form view, I have these 4 checkboxes listed to select and submit . When I try writing an update statement for field 'Subject' using the checkbox values it gives me an error.</p>\n\n<p>Is there some other way to solve this problem or can I correct the method I have used?</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["excel", "vba", "recursion"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482844477, "post_id": 41345805, "comment_id": 69893536, "body": "try writing a VBScript"}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482845293, "post_id": 41345805, "comment_id": 69893944, "body": "@ShaiRado you say that VBScript is better because it&#39;s more fast?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482845342, "post_id": 41345805, "comment_id": 69893959, "body": "yes, but not only, it&#39;s more suitable for tasks involving multiple folders and files."}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1482845580, "post_id": 41345805, "comment_id": 69894070, "body": "@ShaiRado well I&#39;m not so familiar with VBscript.. is that something complex to do?"}], "answers": [{"comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "reply_to_user": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482852076, "post_id": 41346575, "comment_id": 69897169, "body": "Which line is this?"}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482852157, "post_id": 41346575, "comment_id": 69897216, "body": "when running following code i revived : run-time error &#39;1004&#39;: Sorry, we couldn&#39;t find. Is It possible it was moved, renamed or deleted? and actually when I&#39;m in debugging mode i see MyPath and MyFile is both empty on sub Dowork in line: &quot; Set wb = Workbooks.Open(Filename:=MyPath &amp; MyFile)&quot;"}, {"owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "edited": false, "score": 0, "creation_date": 1482852545, "post_id": 41346575, "comment_id": 69897417, "body": "when I&#39;m thinking about it : how could it works if it&#39;s on other method, i mean for example :&#39;MyPath&#39; defined in &#39;ProcessFiles&#39; so it won&#39;t be defined in &#39;Dowork&#39; method..."}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 2, "last_activity_date": 1482852819, "last_edit_date": 1482852819, "creation_date": 1482847208, "answer_id": 41346575, "question_id": 41345805, "link": "https://stackoverflow.com/questions/41345805/run-excel-macro-code-recursively-on-all-files-inside-of-a-folder-and-subfolders/41346575#41346575", "title": "Run excel macro code recursively on all files inside of a folder and subfolders", "body": "<p>As far as I know, VBA can't edit closet workbook. If you want to do work for every workbook in every subfolder, subfolder of subfolder etc. you can use the following code. I added condition, that it have to be <code>.xlsx</code> file, you can change it on <code>.xls</code>, <code>.xlsb</code> or whatever you want. </p>\n\n<pre><code>Sub ProcessFiles()\nDim objFolder As Object\nDim objFile As Object\nDim objFSO As Object\nDim MyPath As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\n    Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With FldrPicker\n        .Title = \"Select A Target Folder\"\n        .AllowMultiSelect = False\n        If .Show &lt;&gt; -1 Then GoTo EmptyEnd\n        MyPath = .SelectedItems(1)\n    End With\n\n    Application.ScreenUpdating = False\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Call GetAllFiles(MyPath, objFSO)\n    Call GetAllFolders(MyPath, objFSO)\n    Application.ScreenUpdating = True\n\n    MsgBox \"Complete.\"\n\nEmptyEnd:\nEnd Sub\n\nSub GetAllFiles(ByVal strPath As String, ByRef objFSO As Object)\nDim objFolder As Object\nDim objFile As Object\n\n    Set objFolder = objFSO.GetFolder(strPath)\n    For Each objFile In objFolder.Files\n            DoWork objFile.Path\n    Next objFile\nEnd Sub\n\nSub GetAllFolders(ByVal strFolder As String, ByRef objFSO As Object)\nDim objFolder As Object\nDim objSubFolder As Object\n\n    Set objFolder = objFSO.GetFolder(strFolder)\n    For Each objSubFolder In objFolder.subfolders\n        Call GetAllFiles(objSubFolder.Path, objFSO)\n        Call GetAllFolders(objSubFolder.Path, objFSO)\n    Next objSubFolder\nEnd Sub\n\nSub DoWork(strFile As String)\nDim wb As Workbook\n    If Right(strFile, 4) = \"xlsx\" Then\n        Set wb = Workbooks.Open(Filename:=strFile)\n        With wb\n            'Do your work here\n            ......\n            .Close True\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 2, "last_activity_date": 1482915047, "creation_date": 1482915047, "answer_id": 41358451, "question_id": 41345805, "link": "https://stackoverflow.com/questions/41345805/run-excel-macro-code-recursively-on-all-files-inside-of-a-folder-and-subfolders/41358451#41358451", "title": "Run excel macro code recursively on all files inside of a folder and subfolders", "body": "<p>If I get this right you need a function which collects all xl files in a directory and subdirs. This function will do that:</p>\n\n<pre><code>Public Function RecursiveDir(colFiles As Collection, _\n                             strFolder As String, _\n                             strFileSpec As String, _\n                             bIncludeSubfolders As Boolean)\n\n    Dim strTemp As String\n    Dim colFolders As New Collection\n    Dim vFolderName As Variant\n\n    'Add files in strFolder matching strFileSpec to colFiles\n    strFolder = TrailingSlash(strFolder)\n    strTemp = Dir(strFolder &amp; strFileSpec)\n    Do While strTemp &lt;&gt; vbNullString\n        colFiles.Add strFolder &amp; strTemp\n        strTemp = Dir\n    Loop\n\n    If bIncludeSubfolders Then\n        'Fill colFolders with list of subdirectories of strFolder\n        strTemp = Dir(strFolder, vbDirectory)\n        Do While strTemp &lt;&gt; vbNullString\n            If (strTemp &lt;&gt; \".\") And (strTemp &lt;&gt; \"..\") Then\n                If (GetAttr(strFolder &amp; strTemp) And vbDirectory) &lt;&gt; 0 Then\n                    colFolders.Add strTemp\n                End If\n            End If\n            strTemp = Dir\n        Loop\n\n        'Call RecursiveDir for each subfolder in colFolders\n        For Each vFolderName In colFolders\n            Call RecursiveDir(colFiles, strFolder &amp; vFolderName, strFileSpec, True)\n        Next vFolderName\n    End If\n\nEnd Function\n\n\nPublic Function TrailingSlash(strFolder As String) As String\n    If Len(strFolder) &gt; 0 Then\n        If Right(strFolder, 1) = \"\\\" Then\n            TrailingSlash = strFolder\n        Else\n            TrailingSlash = strFolder &amp; \"\\\"\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>And this shows how to use it</p>\n\n<pre><code>Sub TesterFiles()\n\nDim colFiles As New Collection\n\n    RecursiveDir colFiles, \"Your Dir goes here...\", \"*.XLS*\", True\n\n    Dim vFile As Variant\n    For Each vFile In colFiles\n        ' Do sth with the file\n        Debug.Print vFile\n    Next vFile\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1484607604, "last_edit_date": 1484607604, "creation_date": 1484606912, "answer_id": 41686279, "question_id": 41345805, "link": "https://stackoverflow.com/questions/41345805/run-excel-macro-code-recursively-on-all-files-inside-of-a-folder-and-subfolders/41686279#41686279", "title": "Run excel macro code recursively on all files inside of a folder and subfolders", "body": "<p>Nice one Storax!  I would use the script that Storax posted, and modify it just a tad.</p>\n\n<pre><code>i = 1\nDim vFile As Variant\nFor Each vFile In colFiles\n    ' Do sth with the file\n    Range(\"A\" &amp; i).Value = vFile\n    i = i + 1\nNext vFile\n</code></pre>\n\n<p>I think it's just easier to work with a list.  Anyway, once you have the file structure, you can run through those elements in the array you just created.  Use the script below to do that.</p>\n\n<pre><code>Sub LoopThroughRange()\n\nDim rng As Range, cell As Range\nSet rng = Range(\"A1:A13\")\n\nFor Each cell In rng\n\n        'For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(cell)\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n\n                'Change cell value(s) in one worksheet in mybook\n                On Error Resume Next\n                With mybook.Worksheets(1)\n                    If .ProtectContents = False Then\n                        .Range(\"A1\").Value = \"My New Header\"\n                    Else\n                        ErrorYes = True\n                    End If\n                End With\n\n\n                If Err.Number &gt; 0 Then\n                    ErrorYes = True\n                    Err.Clear\n                    'Close mybook without saving\n                    mybook.Close savechanges:=False\n                Else\n                    'Save and close mybook\n                    mybook.Close savechanges:=True\n                End If\n                On Error GoTo 0\n            Else\n                'Not possible to open the workbook\n                ErrorYes = True\n            End If\n\n        'Next Fnum\n\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>The idea comes straight from here.</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win010.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s3/win010.htm</a></p>\n\n<p><strong>Pay attention to this part:\n'Change cell value(s) in one worksheet in mybook\nThat's where you want to put specific your code to do exactly what you want to do.</strong></p>\n\n<p>I just modified my OP.  It's a lot easier, and a little different, than I initially made it out to be.  I've adjusted the script accordingly.</p>\n"}], "owner": {"reputation": 169, "user_id": 7150666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4bdbe3a8c7b7a9e9ec16859ac97c0f9?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/7150666/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2316, "favorite_count": 0, "closed_date": 1593375602, "accepted_answer_id": 41346575, "answer_count": 3, "score": 1, "last_activity_date": 1560136609, "creation_date": 1482844092, "last_edit_date": 1560136609, "question_id": 41345805, "link": "https://stackoverflow.com/questions/41345805/run-excel-macro-code-recursively-on-all-files-inside-of-a-folder-and-subfolders", "closed_reason": "Duplicate", "title": "Run excel macro code recursively on all files inside of a folder and subfolders", "body": "<p>I have a folder where I have many sub-folders and inside of them more than 1000 Excel files.</p>\n\n<p>I want to run a specific macro (that changes a workbook) on all these files.</p>\n\n<p>Already saw the following answer.</p>\n\n<pre><code>Sub ProcessFiles()\n    Dim Filename, Pathname As String\n    Dim wb As Workbook\n\n    Pathname = ActiveWorkbook.Path &amp; \"\\C:\\...\\EXCL\\\"\n    Filename = Dir(Pathname &amp; \"*.xlsx\")\n    Do While Filename &lt;&gt; \"\"\n        Set wb = Workbooks.Open(Pathname &amp; Filename)\n        DoWork wb\n        wb.Close SaveChanges:=True\n        Filename = Dir()\n    Loop\nEnd Sub\n\nSub DoWork(wb As Workbook)\n    With wb\n        'Do your work here\n        ......\n    End With\nEnd Sub\n</code></pre>\n\n<p>There are two problems:<br>\n1. this will be extremely slow. Is there a faster way?<br>\n2. this will only run on the files in the matching folder and not the files in all sub-folders. Is there way to do that for files in sub-folders as well?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1482845828, "post_id": 41346068, "comment_id": 69894169, "body": "The goal is to delete certain characters while maintaining per-character formatting in the cell. Assigning <code>Value</code> will certainly <a href=\"http://stackoverflow.com/a/11331709/11683\">not work</a>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1482846551, "post_id": 41346068, "comment_id": 69894509, "body": "You clever to get the goal! Anyhow if you&#39;re right (as you&#39;re likely to be) then OP can take the &quot;replace&quot; option"}, {"owner": {"reputation": 1087, "user_id": 5040920, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f363d7f6d982a1c35d76cc0644fbcbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Zastrow", "link": "https://stackoverflow.com/users/5040920/joshua-zastrow"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1484024618, "post_id": 41346068, "comment_id": 70327551, "body": "To clarify, per character formatting is what I&#39;m after as @Gserg mentioned. Deleting a character in a 255+ character string actually generates a &quot;1004&quot; Application error, and unfortunately it looks like the per character formatting is not maintained after a Replace or Mid function runs."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1482845179, "creation_date": 1482845179, "answer_id": 41346068, "question_id": 41345789, "link": "https://stackoverflow.com/questions/41345789/excel-vba-range-characters-delete-on-255-character-string/41346068#41346068", "title": "Excel VBA: Range.Characters.Delete on 255 character string", "body": "<p>not sure what's your actual goal</p>\n\n<p>you could either</p>\n\n<ul>\n<li><p>use <code>Replace()</code> method after your formatting:</p>\n\n<pre><code>With Range(\"A1\")\n    Replace what:=\"1 |\",replacement:=\" |\", LookAT:=xlPart\n    Replace what:=\"0 |\",replacement:=\" |\", LookAT:=xlPart\nEnd With\n</code></pre></li>\n<li><p>Use <code>Mid()</code> function:</p>\n\n<pre><code>With Range(\"A1\")\n    .Value = Mid(.Value, Start:=1, Length:=17) &amp; Mid(.Value, Start:=18) '&lt;--| \"deletes\" character in position 18\nEnd With\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 1087, "user_id": 5040920, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f363d7f6d982a1c35d76cc0644fbcbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Zastrow", "link": "https://stackoverflow.com/users/5040920/joshua-zastrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 567, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484023506, "creation_date": 1482844025, "last_edit_date": 1484023506, "question_id": 41345789, "link": "https://stackoverflow.com/questions/41345789/excel-vba-range-characters-delete-on-255-character-string", "title": "Excel VBA: Range.Characters.Delete on 255 character string", "body": "<p>Any way to delete characters from a 255+ character string in a given cell, while maintaining formatting?</p>\n\n<p>example:</p>\n\n<pre><code>Range(\"A1\").value = \"Lathe-CNC-Primary1 | Inspection-In Process1 | OV - Heat Treat0 | Deburring1 | Lathe-CNC-Primary0 | Honing0 | Lathe-CNC-Primary0 | Deburring1 | Inspection-In Process1 | OV - F.P.I0 | Inspection-In Process1 | OV - Nitride0 | Inspection-In Process1 | Grinding Thru Feed1 | Inspection-In Process0 | 0V - Coating0 | Inspection-Final0\"\n\n\n\nRange(\"A1\").Characters(Start:=1, Length:=17).font.bold = True\nRange(\"A1\").Characters(Start:=17, Length:=1).delete 'Does Nothing\n</code></pre>\n\n<p>I am using the 1's and 0's in this string (comes from a SQL statement) to format the word it's attached to, then deleting the 1 or 0.</p>\n\n<p>desired result for the string in Range(\"A1\"):</p>\n\n<blockquote>\n  <p><strong>Lathe-CNC-Primary</strong> | Inspection-In Process1 | OV - Heat Treat0 | Deburring1 | Lathe-CNC-Primary0 | Honing0 | Lathe-CNC-Primary0 | Deburring1 | Inspection-In Process1 | OV - F.P.I0 | Inspection-In Process1 | OV - Nitride0 | Inspection-In Process1 | Grinding Thru Feed1 | Inspection-In Process0 | 0V - Coating0 | Inspection-Final0</p>\n</blockquote>\n\n<p>Thanks,\nJosh</p>\n"}, {"tags": ["vba", "ms-access", "dollar-sign"], "comments": [{"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1482843119, "post_id": 41345143, "comment_id": 69892970, "body": "So you say it works and then ask whether it exists? How could it work without existing? It seems your question is more &quot;why is it not documented&quot;, and then it is more a question for Microsoft to answer. But why bother? These <code>$</code> functions are a relic from the past, and there is no viable argument any more not to use the dollar-less functions nowadays."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 1, "creation_date": 1482855972, "post_id": 41345143, "comment_id": 69898951, "body": "@trincot - That&#39;s actually incorrect - <i>some</i> of the <code>$</code> return a strongly typed <code>String</code> instead of a <code>Variant</code>.  If you&#39;re assigning the return value to a <code>String</code>, using the variation without a <code>$</code> creates an implicit cast."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 2015798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792650bee796394666900988e4deca6?s=128&d=identicon&r=PG", "display_name": "darekk", "link": "https://stackoverflow.com/users/2015798/darekk"}, "edited": false, "score": 0, "creation_date": 1482845127, "post_id": 41345798, "comment_id": 69893874, "body": "But what is the reason, that this function is not listed in documentation. Inconsistent behavior in those mentioned above drivers ?"}, {"owner": {"reputation": 71, "user_id": 2015798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792650bee796394666900988e4deca6?s=128&d=identicon&r=PG", "display_name": "darekk", "link": "https://stackoverflow.com/users/2015798/darekk"}, "edited": false, "score": 0, "creation_date": 1482846043, "post_id": 41345798, "comment_id": 69894272, "body": "It worked in SQL in Access 2002 (10) if I remember correctly, but didn&#39;t work any more in some of newer Access runtime."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "reply_to_user": {"reputation": 71, "user_id": 2015798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792650bee796394666900988e4deca6?s=128&d=identicon&r=PG", "display_name": "darekk", "link": "https://stackoverflow.com/users/2015798/darekk"}, "edited": false, "score": 0, "creation_date": 1482847687, "post_id": 41345798, "comment_id": 69895047, "body": "@darekk - I&#39;m not in a position to say why <code>Replace$</code> does not appear in the list on the page you cited; it may just be an unintended omission. As for runtime behavior, I&#39;d be very surprised if the newer Access runtimes failed to support a valid VBA function."}, {"owner": {"reputation": 71, "user_id": 2015798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792650bee796394666900988e4deca6?s=128&d=identicon&r=PG", "display_name": "darekk", "link": "https://stackoverflow.com/users/2015798/darekk"}, "edited": false, "score": 0, "creation_date": 1482851468, "post_id": 41345798, "comment_id": 69896902, "body": "Regarding SQL in Runtime - it was not Replace$(), but Len$() in Runtime 2010 (but not Access 2002): 3085 - Undefined function &#39;Len$&#39; in expression.. But such function makes no sense. Trim$() was returning object once in SQL (--&gt; Data Type Mismatch in Criteria Expression), but I don&#39;t remember circumstances, maybe that was my mistake."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482857322, "post_id": 41345798, "comment_id": 69899574, "body": "Why would <b><i>any</i></b> SQL provider call the VBA string functions? I can&#39;t imagine that the ACE driver is using vbe7.dll to process the <b>SQL function</b> <code>REPLACE</code>. <a href=\"https://en.wikipedia.org/wiki/Microsoft_Jet_Database_Engine#History\" rel=\"nofollow noreferrer\">Jet might be a different story</a>, but older versions had <i>massive</i> security holes because of it.  IIR, the subsequent versions closed them."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1482863960, "post_id": 41345798, "comment_id": 69902589, "body": "@Comintern - I don&#39;t really know if running queries via ACE ODBC/OLEDB causes the Access Database Engine to call the <i>actual VBA code</i> for <code>Replace</code>, but the <code>Replace</code> function that is invoked in that context does support all of the &quot;extra&quot; parameters that the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264409.aspx\" rel=\"nofollow noreferrer\">VBA Replace</a> function supports, namely <code>start</code>, <code>count</code>, and <code>compare</code>."}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": false, "score": 4, "last_activity_date": 1482844061, "creation_date": 1482844061, "answer_id": 41345798, "question_id": 41345143, "link": "https://stackoverflow.com/questions/41345143/does-replace-function-exist-in-microsoft-access/41345798#41345798", "title": "Does Replace$() function exist in Microsoft Access?", "body": "<p>The answer to your question depends on what you mean by \"... exist[s] in Access\". If we open an Immediate window in Access' VBA development environment and run</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>?Replace$(\"I like tofu!\", \"tofu\", \"bacon\")\n</code></pre>\n\n<p>we get</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>I like bacon!\n</code></pre>\n\n<p>so clearly the <code>Replace$</code> function does \"exist\" in Access itself. However, if we try to use <code>Replace$</code> in a query against an Access database from an external application (e.g., VBScript, .NET, ...) we'll get</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Undefined function 'Replace$' in expression.\n</code></pre>\n\n<p>Adding to the confusion is the fact that the older \"Jet\" ODBC/OLEDB drivers did not support the <code>Replace</code> function (without the dollar sign) but the newer \"ACE\" ODBC/OLEDB drivers do. (Neither flavour supports <code>Replace$</code>.) So a query like</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>SELECT Replace([Name], 'Gordon ', 'Gord ') AS newName FROM ...\n</code></pre>\n\n<p>will work if we use the ODBC driver</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Driver={Microsoft Access Driver (*.mdb, .accdb)}\n</code></pre>\n\n<p>but not if we use </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Driver={Microsoft Access Driver (*.mdb)}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 2015798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792650bee796394666900988e4deca6?s=128&d=identicon&r=PG", "display_name": "darekk", "link": "https://stackoverflow.com/users/2015798/darekk"}, "edited": false, "score": 0, "creation_date": 1482861858, "post_id": 41348849, "comment_id": 69901636, "body": "So Replace$ is treated as an alternative name of Replace and there is no such function like Replace$ in the background, internally ? Because Replace$ triggers the same operations as Replace ? I suspected something like this."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 71, "user_id": 2015798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792650bee796394666900988e4deca6?s=128&d=identicon&r=PG", "display_name": "darekk", "link": "https://stackoverflow.com/users/2015798/darekk"}, "edited": false, "score": 1, "creation_date": 1482862686, "post_id": 41348849, "comment_id": 69902001, "body": "@darekk - Pretty much.  The <code>$</code> syntax implementation in VBA is for all intents and purposes a hack.  I suspect that this is a legacy of some very old compatibility requirements that pre-date VB&#39;s inclusion into Office. I envision it goes something like 1.) check to see if the identifier has <code>$</code>. 2.) check to see if the function has a <code>Variant</code> returning implementation. 3.) If so, redirect to the appropriate function, if not, call the function itself."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 3, "last_activity_date": 1506029802, "last_edit_date": 1506029802, "creation_date": 1482856705, "answer_id": 41348849, "question_id": 41345143, "link": "https://stackoverflow.com/questions/41345143/does-replace-function-exist-in-microsoft-access/41348849#41348849", "title": "Does Replace$() function exist in Microsoft Access?", "body": "<p>The functions in the <code>VBA.Strings</code> module are \"special\" in how they are handled internally by VBA.  For most of them, there are actually 2 versions in the type library - a version that returns a <code>String</code> (ends with <code>$</code>), and a version that returns a <code>Variant</code>.  Internally these are declared as a pair of functions - for example, <code>Right</code> (from the vbe7.dll TypeLib):</p>\n\n<blockquote>\n<pre><code>[entry(618), helpcontext(0x000f6ea5)]\nBSTR _stdcall _B_str_Right(\n                [in] BSTR String, \n                [in] long Length);\n\n[entry(619), helpcontext(0x000f656e)]\nVARIANT _stdcall _B_var_Right(\n                [in] VARIANT* String, \n                [in] long Length);\n</code></pre>\n</blockquote>\n\n<p>The compiler apparently treats the <code>$</code> similarly to a \"type hint\" internally, because (using the example above), there actually <strong><em>isn't</em></strong> a function <code>Left$</code> defined in the TypeLib.  In fact, there isn't a function declared as <code>VBA.Strings.Right</code> either. These live in a special restricted interface named <code>_HiddenInterface</code>:</p>\n\n<blockquote>\n<pre><code>[\n  odl,\n  uuid(1E196B20-1F3C-1069-996B-00DD010EF676)\n]\ninterface _HiddenInterface {\n    ...\n    [restricted, helpcontext(0x000f6d7c)]\n    void _stdcall Right();\n    ...\n};\n</code></pre>\n</blockquote>\n\n<p>Note that <code>Right$</code> <em>doesn't</em> appear in the in the <code>_HiddenInterface</code>, nor do any of the other string returning functions.  The VBA compiler uses the \"function type hint\" to forward the function call to either <code>_B_str_Right</code> or <code>_B_var_Right</code>.</p>\n\n<p>By now you're probably wonder what this has to do with your question. The answer is that <code>Replace</code> actually <strong><em>doesn't</em></strong> have two different internal representations.  It always returns a string, doesn't exist on the <code>_HiddenInterface</code>, and lives directly in the <code>VBA.Strings</code> module:</p>\n\n<blockquote>\n<pre><code>[entry(712), helpstring(\"Find and replace a substring within a string\"), helpcontext(0x000f6522)]\nBSTR _stdcall Replace(\n                [in] BSTR Expression, \n                [in] BSTR Find, \n                [in] BSTR Replace, \n                [in, optional, defaultvalue(1)] long Start, \n                [in, optional, defaultvalue(-1)] long Count, \n                [in, optional, defaultvalue(0),\n  custom(270D72B0-FFB8-11CF-A4BD-00A0C90F26EE, 1)\n\n] VbCompareMethod Compare);\n</code></pre>\n</blockquote>\n\n<p>Basically, there is no <code>Replace$</code> function at all. VBA is treating the <code>$</code> as a type hint for the <em>return value</em> (which is always a <code>String</code> anyway). As far as the ODBC and OLE drivers are concerned, I would imagine (TBH I really haven't looked into it much) that they are restricted to the names that are exposed by the TypeLib and are <em>not</em> interpreted by the VBA runtime as forwards to different functions.  They simply don't exist if you're doing <code>IDispatch</code> lookups on vbe7.dll.</p>\n"}], "owner": {"reputation": 71, "user_id": 2015798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c792650bee796394666900988e4deca6?s=128&d=identicon&r=PG", "display_name": "darekk", "link": "https://stackoverflow.com/users/2015798/darekk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506029802, "creation_date": 1482841397, "question_id": 41345143, "link": "https://stackoverflow.com/questions/41345143/does-replace-function-exist-in-microsoft-access", "title": "Does Replace$() function exist in Microsoft Access?", "body": "<p>It works, but is not listed here:<br />\n<a href=\"https://msdn.microsoft.com/en-us/library/office/gg278535.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/gg278535.aspx</a><br />\n... > Office shared > Office VBA language reference > Visual Basic conceptual topics<br />\nReturning Strings from Functions<br />\n<br />\nand in the VBA editor:<br />\n(View) - Object Browser - VBA - Strings<br />\n<br />\nThis function is discussed in many forums, so people use it.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1482843591, "post_id": 41345128, "comment_id": 69893161, "body": "Please don&#39;t ask a second question in an edit. If you have another question -- post another question."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6073627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-xL7h5J9xMoM/AAAAAAAAAAI/AAAAAAAABFA/XV2NitKCtCM/photo.jpg?sz=128", "display_name": "Zdravko Lukic", "link": "https://stackoverflow.com/users/6073627/zdravko-lukic"}, "edited": false, "score": 0, "creation_date": 1482843933, "post_id": 41345653, "comment_id": 69893321, "body": "Mint works perfectly thanks and if you can send me a solution and to merge cells I would appreciate it :)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 65, "user_id": 6073627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-xL7h5J9xMoM/AAAAAAAAAAI/AAAAAAAABFA/XV2NitKCtCM/photo.jpg?sz=128", "display_name": "Zdravko Lukic", "link": "https://stackoverflow.com/users/6073627/zdravko-lukic"}, "edited": false, "score": 0, "creation_date": 1482844651, "post_id": 41345653, "comment_id": 69893627, "body": "@ZdravkoLukic That really is a separate question and it should be posted as such. If you do so, you need to clarify the meaning of the ellipsis (<code>...</code>). To try to solve it yourself: note that  (assuming you are using a <code>With</code> construct that gives meaning to <code>.Range</code>) you can have the statement <code>.Range(.Cells(i,1),.Cells(i+1,1)).Merge</code> in a for-loop with step size 2."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1482843429, "creation_date": 1482843429, "answer_id": 41345653, "question_id": 41345128, "link": "https://stackoverflow.com/questions/41345128/how-to-set-range-values-in-a-loop-with-alternating-values/41345653#41345653", "title": "How to set Range values in a loop with alternating values", "body": "<p>Here is a loop-free approach:</p>\n\n<pre><code>Sub test()\n    Dim s As String\n    s = Trim(Application.WorksheetFunction.Rept(\"O U \", 17))\n    Range(\"E4:AL4\").Value = Split(s)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1484606115, "creation_date": 1484606115, "answer_id": 41686115, "question_id": 41345128, "link": "https://stackoverflow.com/questions/41345128/how-to-set-range-values-in-a-loop-with-alternating-values/41686115#41686115", "title": "How to set Range values in a loop with alternating values", "body": "<p>You can't record loops with the Macro Recorder, but I think you should try that and check out the code.  You will learn a lot from that.  Well, maybe that's how you got what you got.  Anyway, I found the Macro Recorder to be helpful when I was first learning VBA.  </p>\n\n<pre><code>Sub Macro1()\n  Range(\"A1:D1\").Merge (True)\n  Range(\"A2:D2\").Merge (True)\n  Range(\"A3:D3\").Merge (True)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6073627, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-xL7h5J9xMoM/AAAAAAAAAAI/AAAAAAAABFA/XV2NitKCtCM/photo.jpg?sz=128", "display_name": "Zdravko Lukic", "link": "https://stackoverflow.com/users/6073627/zdravko-lukic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 41345653, "answer_count": 2, "score": 0, "last_activity_date": 1593956841, "creation_date": 1482841334, "last_edit_date": 1593956841, "question_id": 41345128, "link": "https://stackoverflow.com/questions/41345128/how-to-set-range-values-in-a-loop-with-alternating-values", "title": "How to set Range values in a loop with alternating values", "body": "<p>I assume this can be written differently with a loop but I do not know how. I do not know the best Access VBA. Can anyone suggest something?</p>\n\n<pre><code>.Range(\"E4\").Value = \"O\"\n.Range(\"F4\").Value = \"U\"\n.Range(\"G4\").Value = \"O\"\n.Range(\"H4\").Value = \"U\"\n.Range(\"I4\").Value = \"O\"\n.Range(\"J4\").Value = \"U\"\n.Range(\"K4\").Value = \"O\"\n.Range(\"L4\").Value = \"U\"\n.Range(\"M4\").Value = \"O\"\n.Range(\"N4\").Value = \"U\"\n.Range(\"O4\").Value = \"O\"\n.Range(\"P4\").Value = \"U\"\n.Range(\"Q4\").Value = \"O\"\n.Range(\"R4\").Value = \"U\"\n.Range(\"S4\").Value = \"O\"\n.Range(\"T4\").Value = \"U\"\n.Range(\"U4\").Value = \"O\"\n.Range(\"V4\").Value = \"U\"\n.Range(\"W4\").Value = \"O\"\n.Range(\"X4\").Value = \"U\"\n.Range(\"Y4\").Value = \"O\"\n.Range(\"Z4\").Value = \"U\"\n.Range(\"AA4\").Value = \"O\"\n.Range(\"AB4\").Value = \"U\"\n.Range(\"AC4\").Value = \"O\"\n.Range(\"AD4\").Value = \"U\"\n.Range(\"AE4\").Value = \"O\"\n.Range(\"AF4\").Value = \"U\"\n.Range(\"AG4\").Value = \"O\"\n.Range(\"AH4\").Value = \"U\"\n.Range(\"AI4\").Value = \"O\"\n.Range(\"AJ4\").Value = \"U\"\n.Range(\"AK4\").Value = \"O\"\n.Range(\"AL4\").Value = \"U\"\n</code></pre>\n\n<p>Also now and this please help</p>\n\n<pre><code>.Range(\"A5\", \"A6\").Merge\n.Range(\"A7\", \"A8\").Merge\n.Range(\"A9\", \"A10\").Merge...\n\n.Range(\"B5\", \"B6\").Merge\n.Range(\"B7\", \"B8\").Merge\n.Range(\"B9\", \"B10\").Merge....\n</code></pre>\n"}]