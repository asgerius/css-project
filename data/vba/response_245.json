[{"tags": ["javascript", "excel", "vba", "typescript", "office-js"], "answers": [{"comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568851078, "post_id": 58001967, "comment_id": 102409691, "body": "Thanks, I guess I missed that update from the original question. It would be nice if there was an event that doesn&#39;t involve selection. I&#39;ll wait a little to see if there is a better alternative, otherwise I&#39;ll mark this as the answer."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1568850574, "last_edit_date": 1568850574, "creation_date": 1568850178, "answer_id": 58001967, "question_id": 58001786, "link": "https://stackoverflow.com/questions/58001786/can-office-js-trigger-a-vba-workbook-or-worksheet-event-procedure/58001967#58001967", "title": "Can Office-JS trigger a VBA Workbook or Worksheet Event Procedure?", "body": "<p>The <code>change</code> event does not run but the <code>selectionchange</code> event does, so you could use that to trigger your code: populate a specific cell and then select it</p>\n\n<pre><code>sheet.getRange(\"A999\").values = 'Hello from Office-JS';\nsheet.getRange(\"A999\").select();\n</code></pre>\n\n<p>Sheet module:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address(False, False) = \"A999\" Then\n        MsgBox Target.Value\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: on review, the OP for the original question already worked most of this out...</p>\n"}, {"tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1568865900, "last_edit_date": 1568865900, "creation_date": 1568852814, "answer_id": 58002206, "question_id": 58001786, "link": "https://stackoverflow.com/questions/58001786/can-office-js-trigger-a-vba-workbook-or-worksheet-event-procedure/58002206#58002206", "title": "Can Office-JS trigger a VBA Workbook or Worksheet Event Procedure?", "body": "<p>After some more testing, I managed to find that the <code>Workbook_NewSheet</code> event procedure of the workbook object gets triggered by creating a new worksheet with Office-Js:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>var sheets = context.workbook.worksheets;\nvar sheet = sheets.add(\"NewSheet\");\nsheet.getRange(\"A1\").values = \"Hello from Office-JS\";\n</code></pre>\n\n<p>So, it would be possible to have the following code in the <code>ThisWorkbook</code> Module to display the Message box in that context:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n    If Sh.Name = \"NewSheet\" Then\n        If Sh.Range(\"$A$1\").Value2 &lt;&gt; vbNullString Then\n            MsgBox Sh.Range(\"$A$1\").Value2\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>The nice thing here is that even if the Office-JS code writes to the sheet after creating it, the event in VBA only gets to run after the JavaScript code has finished meaning that the value in cell A1 will be changed in time for when the VBA code runs.</p>\n"}], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 58002206, "answer_count": 2, "score": 1, "last_activity_date": 1568865900, "creation_date": 1568848268, "last_edit_date": 1568849301, "question_id": 58001786, "link": "https://stackoverflow.com/questions/58001786/can-office-js-trigger-a-vba-workbook-or-worksheet-event-procedure", "title": "Can Office-JS trigger a VBA Workbook or Worksheet Event Procedure?", "body": "<p>I'm trying to see if there is a way to do something in Office-JS that would trigger an event procedure to run in Excel VBA, but it looks like VBA events are disabled during the execution of the JavaScript code.</p>\n\n<p>Let's say for example that I have a workbook with a worksheet named \"Sheet1\" and in that sheet module I have the following code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$A$1\" And Target.Value2 &lt;&gt; vbNullString Then\n        MsgBox Target.Value2\n    End If\nEnd Sub\n</code></pre>\n\n<p>What I'm expecting is that if I change the content of cell A1, the new content will be displayed in a message box, but if I run the following snippet in <a href=\"https://www.microsoft.com/en-us/garage/profiles/script-lab/\" rel=\"nofollow noreferrer\">Script Lab</a> (based of the blank snippet), the event does not get triggered even though cell A1 gets edited successfully:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$(\"#run\").click(() =&gt; tryCatch(run));\n\nasync function run() {\n  await Excel.run(async (context) =&gt; {\n\n    const sheet = context.workbook.worksheets.getItem(\"Sheet1\");\n    sheet.getRange(\"A1\").values = 'Hello from Office-JS';\n\n    await context.sync();\n  });\n}\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch(callback) {\n  try {\n    await callback();\n  } catch (error) {\n    // Note: In a production add-in, you'd want to notify the user through your add-in's UI.\n    console.error(error);\n  }\n}\n</code></pre>\n\n<p>So my question would be: Is there a way to set things up so that the JavaScript code can trigger the Worksheet_Change event and if not, is there another worksheet or workbook event that can be triggered?</p>\n\n<p><strong>A bit of context</strong>:\nI was trying to find a solution to <a href=\"https://stackoverflow.com/questions/57999868/is-there-is-a-way-to-write-macro-to-worksheet#57999868\">this question</a> and thought that a good workaround would be to write VBA code to a cell with Office-JS and then use the Worksheet_Change event procedure to execute the VBA code written in that cell.</p>\n\n<p>Unfortunately, that didn't work so far, but I think it's worth asking this more specific question as solving this would be the last stepping stone in order to allow VBA code to be executed from Office-JS (which would be pretty nice).</p>\n"}, {"tags": ["excel", "vba", "sumifs"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1568844311, "post_id": 58001291, "comment_id": 102408258, "body": "when you edit the formula are you using Ctrl-Shift-Enter instead of Enter or Tab?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 12086704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5IfADSIKUVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoe3SzAqWPP2Dhxsf2K_q0_6Npww/photo.jpg?sz=128", "display_name": "Mathias Eriksen", "link": "https://stackoverflow.com/users/12086704/mathias-eriksen"}, "edited": false, "score": 0, "creation_date": 1568912614, "post_id": 58001338, "comment_id": 102435440, "body": "It worked. However, you are writting that when it is not in lockstep the max with OR are two arrays. But what is lockstep and could I add one or two more arrays, such as year?  =SUM(SUMIFS($D$2:$D$2000;$B$2:$B$2000;_ {&quot;Odense&quot;;&quot;&#197;rhus&quot;};$C$2:$C$2000;TRANSPOSE({2;3});_ $E$2:$E$2000;ABS(I16);$F$2:$F$2000;{&quot;2018&quot;;&quot;2019&quot;}))"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 45, "user_id": 12086704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5IfADSIKUVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoe3SzAqWPP2Dhxsf2K_q0_6Npww/photo.jpg?sz=128", "display_name": "Mathias Eriksen", "link": "https://stackoverflow.com/users/12086704/mathias-eriksen"}, "edited": false, "score": 0, "creation_date": 1568919690, "post_id": 58001338, "comment_id": 102438480, "body": "Lockstep means it does: <code>(D=&quot;Odense&quot; and C=2 and F=2018) OR (D=&quot;O&#197;rhusdense&quot; and C=3 and F=2019)</code> not  <code>(D=&quot;Odense or D=&quot;O&#197;rhusdense) And (C=2 or C = 3) And (F=2018 or F = 2019)</code>  which is why you will get a different sum when changing the order."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1568844571, "creation_date": 1568844571, "answer_id": 58001338, "question_id": 58001291, "link": "https://stackoverflow.com/questions/58001291/does-the-places-of-input-matter-sumifs/58001338#58001338", "title": "Does the places of input matter? (SUMIFS)", "body": "<p>when using two arrays in SUMIFS if both arrays are vertical or both horizontal then it will matter as it will only do two and compare one to one stepping through each array the same.</p>\n\n<p>If you want to do OR on both arrays then one must be Vertical and the other Horizontal:</p>\n\n<pre><code>SUM(SUMIFS($D$2:$D$2000;$B$2:$B$2000;{\"\u00c5rhus\";\"Odense\"};$C$2:$C$2000;TRANSPOSE({2;3});$E$2:$E$2000;ABS(I16)))\n</code></pre>\n\n<p>Also note that when not in lockstep the max on the OR type is two arrays.</p>\n"}], "owner": {"reputation": 45, "user_id": 12086704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5IfADSIKUVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoe3SzAqWPP2Dhxsf2K_q0_6Npww/photo.jpg?sz=128", "display_name": "Mathias Eriksen", "link": "https://stackoverflow.com/users/12086704/mathias-eriksen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58001338, "answer_count": 1, "score": 0, "last_activity_date": 1568844571, "creation_date": 1568844237, "last_edit_date": 1568844276, "question_id": 58001291, "link": "https://stackoverflow.com/questions/58001291/does-the-places-of-input-matter-sumifs", "title": "Does the places of input matter? (SUMIFS)", "body": "<p>I have a question about Excel &amp; VBA\u2019s function SUMIFS(). I have two codes, but I changed the input-places from one to another (\u00c5rhus &amp; Odense, but 2 and 3 could also be used):</p>\n\n<p>I need to find the correct sum when these criterias are used. I have tried to google and tried to understand SUMIFS. I tried to simulataing another dataset, with the same amount of variables and changes the different input locations. However, when comparing the 4 difference input places I get the same result</p>\n\n<p>Code 1)</p>\n\n<pre><code>SUM(SUMIFS($D$2:$D$2000;$B$2:$B$2000;{\"Odense\";\"\u00c5rhus\"};_\n\n$C$2:$C$2000;{2;3};$E$2:$E$2000;ABS(I16)))\n</code></pre>\n\n<p>Code 2)</p>\n\n<pre><code>SUM(SUMIFS($D$2:$D$2000;$B$2:$B$2000;{\"\u00c5rhus\";\"Odense\"};_\n\n$C$2:$C$2000;{2;3};$E$2:$E$2000;ABS(I16)))\n</code></pre>\n\n<p>Code 1 gives 152832 and Code 2 gives 135751. So I hope that anyone can explain to me why this happen. Or maybe that there is something wrong with the data that is being used.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 4, "creation_date": 1568840630, "post_id": 58000667, "comment_id": 102407170, "body": "Move the <code>Exit Sub</code> before the <code>Errorhandler:</code> line."}], "answers": [{"comments": [{"owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "edited": false, "score": 1, "creation_date": 1568842011, "post_id": 58000808, "comment_id": 102407648, "body": "Thanks for the explanation. I didn&#39;t realize the specifics of using labels in this way. It works fine now."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 2, "last_activity_date": 1568841270, "creation_date": 1568841270, "answer_id": 58000808, "question_id": 58000667, "link": "https://stackoverflow.com/questions/58000667/why-does-error-handler-trigger-with-no-error/58000808#58000808", "title": "Why does error handler trigger with no error?", "body": "<p>In your code, <code>Errorhandler</code> is merely a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/glossary/vbe-glossary#line-label\" rel=\"nofollow noreferrer\">line label</a>, with the <code>On Error</code> statement redirecting evaluation to this label in the event of an error.</p>\n\n<p>As such, consider that VBA does not distinguish between the line label used for the purpose of an error handler, or any other line label used in conjunction with any other <code>GoTo</code> statement, or a line label which is not referenced at all.</p>\n\n<p>In the absence of an error, your code is equivalent to:</p>\n\n<pre><code>Private Sub cmdOpenPDF_Click()\n    Application.FollowHyperlink \"E:\\groups\\folder\\folder2\\\" &amp; Dir(\"E:\\groups\\folder\\folder2\\*\" &amp; Me.txtInvNum &amp; \"*\")\n\nErrorhandler:\n    MsgBox \"Unable to locate the file. I'm sorry this has happened.\", vbOKOnly\n    Exit Sub\nEnd Sub\n</code></pre>\n\n<p>Here, VBA will dutifully execute the <code>FollowHyperlink</code> method, followed by the <code>MsgBox</code> function, and then finally the <code>Exit Sub</code> statement.</p>\n\n<p>To avoid the error handler being evaluated every time, a typical implementation of an error handler will include an additional label signifying a clean exit prior to the error handler label, e.g.:</p>\n\n<pre><code>Private Sub cmdOpenPDF_Click()\n    On Error GoTo Errorhandler\n    Application.FollowHyperlink \"E:\\groups\\folder\\folder2\\\" &amp; Dir(\"E:\\groups\\folder\\folder2\\*\" &amp; Me.txtInvNum &amp; \"*\")\n\nExitSub:\n    Exit Sub\n\nErrorhandler:\n    MsgBox \"Unable to locate the file. I'm sorry this has happened.\", vbOKOnly\n    Resume ExitSub\nEnd Sub\n</code></pre>\n\n<p>This means that in normal circumstances, the <code>Exit Sub</code> statement will be reached before evaluation of the code following the <code>Errorhandler</code> label.</p>\n"}], "owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "accepted_answer_id": 58000808, "answer_count": 1, "score": 1, "last_activity_date": 1594449274, "creation_date": 1568840463, "last_edit_date": 1594449274, "question_id": 58000667, "link": "https://stackoverflow.com/questions/58000667/why-does-error-handler-trigger-with-no-error", "title": "Why does error handler trigger with no error?", "body": "<p>I am running one line of code to open a PDF when a button is clicked. I put an error handler on there in case the file doesn't exist. The problem is that the code works and the file is opened but the error handler still runs. </p>\n\n<p>When I disable the error handling code it runs fine and VB doesn't generate an error. I even tried using <code>Err.Description</code> for the message box and it just pops up with nothing displayed. Here is my code:</p>\n\n<pre><code>Private Sub cmdOpenPDF_Click()\n\nOn Error GoTo Errorhandler\n Application.FollowHyperlink \"E:\\groups\\folder\\folder2\\\" &amp; Dir(\"E:\\groups\\folder\\folder2\\*\" &amp; Me.txtInvNum &amp; \"*\")\n\nErrorhandler:\n        MsgBox \"Unable to locate the file. I'm sorry this has happened.\", vbOKOnly\n  Exit Sub\n\n\nEnd Sub\n</code></pre>\n\n<p>Since the PDF opens with no problem I would expect there to be no error. It's also really puzzling that there is no error when run without the error handler. Does anyone know why it's doing this?</p>\n"}, {"tags": ["vba", "properties", "userform"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1568839842, "post_id": 58000541, "comment_id": 102406901, "body": "Get rid of <code>Set</code> in <code>Property Let counter()</code>."}, {"owner": {"reputation": 45, "user_id": 10582249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OPcyr.png?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/10582249/patrick"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1568839858, "post_id": 58000541, "comment_id": 102406912, "body": "I think i get it... the moment <code>_initialize</code> is to early, the <code>.counter</code> isn&#39;t set at this time and in the <code>Property Let counter()</code> I don&#39;t have to <code>Set miCounter = c</code>, that&#39;s the cause of the dropped error.  With <code>_activate</code> it works. I&#39;ll try tomorow in the office with my live-program, this was just a short reconstruction."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1568841729, "last_edit_date": 1568841729, "creation_date": 1568840465, "answer_id": 58000668, "question_id": 58000541, "link": "https://stackoverflow.com/questions/58000541/vba-problem-with-passing-arguments-to-userform/58000668#58000668", "title": "VBA: Problem with passing arguments to userform", "body": "<blockquote>\n<pre><code>Property Let counter(c As Integer)\n    Set miCounter = c\nEnd Property\n</code></pre>\n</blockquote>\n\n<p>An <em>object is required</em>, only because of the <code>Set</code> keyword. This isn't a reference assignment, it's a value assignment.</p>\n\n<p>View it like this:</p>\n\n<pre><code>Property Let counter(c As Integer)\n    Let miCounter = c\nEnd Property\n</code></pre>\n\n<p>Just don't actually type up the <code>Let</code> keyword (it <em>would</em> work though), <a href=\"http://rubberduckvba.com/Inspections/Details/ObsoleteLetStatement\" rel=\"nofollow noreferrer\">it's obsolete</a> :)</p>\n\n<p>Also note that the implicit modifier for <code>Property Let/Set</code> procedure argument, is always <code>Byval</code> - this is different than anything else in VBA, where thr implicit modifier is <code>ByRef</code>; consider making the <code>ByVal</code> modifier explicit.</p>\n\n<hr>\n\n<blockquote>\n<pre><code>Private Sub userform_initialize()\n    Dim i As Integer\n    For i = 1 To counter           'miCounter don't work as well\n        Debug.Print i\n    Next i\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p>That loop will never iterate anything, because the <code>Initialize</code> handler runs here:</p>\n\n<blockquote>\n<pre><code>With New usr_mainInput\n</code></pre>\n</blockquote>\n\n<p>I mean, it runs when the <code>New usr_mainInput</code> instruction returns, <em>but before the object reference is given to the <code>With</code> block</em> (note that this is true for any class, not just forms) - that's well before the <code>.counter = 3</code> assignment! Rule of thumb, you want to <em>initialize</em> instance state in that handler, not consume it.</p>\n\n<p>Consider using the <code>Activate</code> handler instead. That one will run immediately after the <code>.Show</code> call.</p>\n"}], "owner": {"reputation": 45, "user_id": 10582249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OPcyr.png?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/10582249/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "accepted_answer_id": 58000668, "answer_count": 1, "score": 1, "last_activity_date": 1568843852, "creation_date": 1568839665, "last_edit_date": 1568843852, "question_id": 58000541, "link": "https://stackoverflow.com/questions/58000541/vba-problem-with-passing-arguments-to-userform", "title": "VBA: Problem with passing arguments to userform", "body": "<p>I have searched and tried for 6 hours now but I can't solve the problem.</p>\n\n<p>My idea:\nI want to show a userform in Excel-VBA with some radiobuttons, one listelement and one textfield. \nI want to pass some arguments to the userform to work with it because I don't want to calculate inside the userform-code (which works)\nI don't want to declare global variables as well.</p>\n\n<p>I tried the following which worked:</p>\n\n<ul>\n<li><p>calculate directly in the userform</p></li>\n<li><p>global variables</p></li>\n</ul>\n\n<p>This hasn't worked:</p>\n\n<ul>\n<li><p>declared userform as variable and worked with the variable</p></li>\n<li><p>every possible combination of <code>[Public|Private|Friend] Property Let (ByRef|ByVal)</code></p></li>\n<li><p><code>Property Set</code> doesn't work in any case</p></li>\n</ul>\n\n<p>The code from my main (module)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub main()\n    With New usr_mainInput\n        .counter = 3\n        .Show\n    End With\nEnd Sub\n</code></pre>\n\n<p>My code in the userform</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate miCounter As Integer\n\nProperty Get counter() As Integer\n    counter = miCounter\nEnd Property\nProperty Let counter(c As Integer)\n    Set miCounter = c\nEnd Property\n\nPrivate Sub userform_initialize()\n    Dim i As Integer\n    For i = 1 To counter           'miCounter don't work as well\n        Debug.Print i\n    Next i\nEnd Sub\n\nPrivate Sub btn_ok_Click()\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>Object variable or With block variable not set</p>\n\n<p>If it comes to the <code>Property Let counter()</code> it drops a compile error: </p>\n\n<blockquote>\n  <p>Object required (Error 424)</p>\n</blockquote>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1568839595, "post_id": 58000515, "comment_id": 102406812, "body": "The <code>str = some text here &lt;a href=&quot;&#47;instrument&#47;2014&#47;36.pdf&quot; target=&quot;_blank&quot; title=&quot;2014&#47;36 - 01&#47;07&#47;2014&quot; class=&quot;changed-by&quot;&gt;1&lt;&#47;a&gt; some text here</code> is not valid syntax."}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 0, "last_activity_date": 1568850293, "creation_date": 1568850293, "answer_id": 58001979, "question_id": 58000515, "link": "https://stackoverflow.com/questions/58000515/how-can-i-adapt-a-regex-pattern-for-vba/58001979#58001979", "title": "How can I adapt a regex pattern for VBA", "body": "<p>If you are going to use the <code>Replace</code> function, I think you need some output parameters, replacing what you find with <code>\"\"</code> will always return <code>\"\"</code>.  This is what I came up with, I'm not sure if the Regex is any better then yours really, but it works in VBA.  The main difference is the first and last group that I added to extract the all the text.</p>\n\n<pre><code>Dim RegEx As New RegExp\nDim Value As String\n\nRegEx.IgnoreCase = True\nRegEx.Pattern = \"(.*?)&lt;a\\b(?:\"\"[^\"\"]*?\"\"|'[^']*?'|[^&gt;]*?)+&gt;([^&lt;]*?)&lt;\\/a\\b.*?&gt;(.*)\"\nValue = \"some text here &lt;a href=\"\"/instrument/2014/36.pdf\"\" target=\"\"_blank\"\" title=\"\"2014/36 - 01/07/2014\"\" class=\"\"changed-by\"\"&gt;1&lt;/a&gt; some text here\"\nDebug.Print RegEx.Replace(Value, \"$1$2$3\")\n</code></pre>\n\n<p>The other option is that you just use the <code>Execute</code> function and pull the text out of the respective groups.</p>\n\n<pre><code>Dim Col As MatchCollection\nDim i As Long\nSet Col = RegEx.Execute(Value)\nWith Col\n    For i = 0 To .Count - 1\n        With .Item(i)\n            Debug.Print .SubMatches(0) &amp; .SubMatches(1) &amp; .SubMatches(2)\n        End With\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4575201, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Jomp17vlxO0/AAAAAAAAAAI/AAAAAAAAQwo/PPyL2eC2rOY/photo.jpg?sz=128", "display_name": "Stewart Lancaster", "link": "https://stackoverflow.com/users/4575201/stewart-lancaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1568898221, "creation_date": 1568839521, "last_edit_date": 1568898221, "question_id": 58000515, "link": "https://stackoverflow.com/questions/58000515/how-can-i-adapt-a-regex-pattern-for-vba", "title": "How can I adapt a regex pattern for VBA", "body": "<p>I am trying to remove a specific string of text using regex and have the following which works on regex101.com however i understand that VBA has some nuances when using regex and the pattern i have doesn't seem to work at all.</p>\n\n<p>the pattern which i validated is in the code below, If possible i would also like to combine it with the below (designed to remove html tags)\n\"\\&lt;.*?>\" this does work but i currently run a separate regex.replace function to remove this.</p>\n\n<pre><code>Dim regEx As Object , str As String\nSet regEx = CreateObject(\"VBScript.RegExp\")\n\nWith regEx\n  '.Pattern = \"&lt;a\\b([^&gt;\"\"']|\"\"[^\"\"]*\"\"|'[^']*')+class=\"\"changed-by\"\"&gt;.*?&lt;\\/a&gt;\"\n'.pattern = \"\\&lt;.*?\\&gt;\" ' this is the second pattern i use to remove html tages which works\n  .Global = True 'If False, would replace only first\n  .IgnoreCase = False\n  .MultiLine = False\nEnd With\n\nstr = some text here &lt;a href=\"/instrument/2014/36.pdf\" target=\"_blank\" title=\"2014/36 - 01/07/2014\" class=\"changed-by\"&gt;1&lt;/a&gt; some text here\nDebug.Print regEx.Replace(str, \"\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1568842963, "post_id": 58000475, "comment_id": 102407902, "body": "<a href=\"https://stackoverflow.com/questions/6647151/excel-vba-loop-through-range-and-set-formula-in-each-cell\">This might help</a>"}, {"owner": {"reputation": 1, "user_id": 12087164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921f281e071c0a1fb80db1b356bc25af?s=128&d=identicon&r=PG&f=1", "display_name": "hassettk", "link": "https://stackoverflow.com/users/12087164/hassettk"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1569437413, "post_id": 58000475, "comment_id": 102600612, "body": "Thank you!  I will try to incorporate this."}], "owner": {"reputation": 1, "user_id": 12087164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921f281e071c0a1fb80db1b356bc25af?s=128&d=identicon&r=PG&f=1", "display_name": "hassettk", "link": "https://stackoverflow.com/users/12087164/hassettk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568874784, "creation_date": 1568839351, "last_edit_date": 1568874784, "question_id": 58000475, "link": "https://stackoverflow.com/questions/58000475/loop-a-macro-through-each-column", "title": "Loop a Macro through each Column", "body": "<p>I am attempting to create a macro that will perform a process on each column, up to a specific column \"X\".</p>\n\n<p>Below is a macro I recorded and then some additional code I tried to paste in to get the desired result.</p>\n\n<pre><code>Sub ColumnFill2()\n   Range(Selection, Selection.End(xlDown)).Select\n   Selection.SpecialCells(xlCellTypeVisible).Select\n   Selection.FormulaR1C1 = \"=IF(INDIRECT(ADDRESS(ROW()-1,COLUMN()))=0,\"\"\"\",INDIRECT(ADDRESS(ROW()-1,COLUMN())))\"\n\n   Dim lngCol As Long\n   Dim X As Long\n   lngCol = ActiveCell.Column + 1\n\n   For X = 1 To 57\n      Cells(X + 1, lngCol) = X\n   Next X\nEnd Sub\n</code></pre>\n\n<p>I'm looking to have each column formatted with the included formula on each empty row (the spreadsheet is subtotaled).  Currently, it works on column 1 but then something is off.  I believe it's the starting point on the next column, which should be in Row 2 each time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1568838862, "post_id": 58000284, "comment_id": 102406554, "body": "<code>Areas</code> shouldn&#39;t be a <code>String</code>. for starters."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568839251, "post_id": 58000284, "comment_id": 102406684, "body": "Declare the <code>Areas</code> array <code>As Range</code>, and <code>Set</code> its items; the <code>For Each</code> loop will work then, and each element will be a full-fledged <code>Range</code> object."}, {"owner": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568839820, "post_id": 58000284, "comment_id": 102406893, "body": "@MathieuGuindon Ok so I made some edits to my original post. Does that look a little more accurate to what I&#39;m trying to do?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568839985, "post_id": 58000284, "comment_id": 102406952, "body": "Probably - but I doubt you&#39;re still getting that error on <code>For Each</code> though. That said you&#39;re not iterating cells, you&#39;re iterating <i>ranges</i> of cells - you&#39;ll need to nest that loop in order to iterate each cell in each range, because <code>cell.Value</code> is a 2D variant array now - that makes <code>If cell.Value = CVErr(xlErrName) Then</code> illegal."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568840131, "post_id": 58000284, "comment_id": 102407002, "body": "Also, shouldn&#39;t it be <code>xlErrRef</code> rather than <code>xlErrName</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "edited": false, "score": 0, "creation_date": 1568917094, "post_id": 58000679, "comment_id": 102437355, "body": "The first code would receive an error after then first loop but the second code worked B.E.A.utifully"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1568840527, "creation_date": 1568840527, "answer_id": 58000679, "question_id": 58000284, "link": "https://stackoverflow.com/questions/58000284/replace-ref-over-within-several-ranges/58000679#58000679", "title": "Replace #Ref over within several Ranges", "body": "<p>As an alternative to <code>Find</code>, consider <code>SpecialCells</code></p>\n\n<p>To remove <em>only</em> <code>#REF</code> errors</p>\n\n<pre><code>Sub Demo1()\n    Dim rng As Range\n    Dim rErr As Range\n    Dim cl As Range\n\n    With ActiveSheet 'or specify a specific sheet\n        Set rng = .Range(\"C5:Z7,C10:Z14,C27:Z27,C33:Z45,C52:Z55,C58:Z61,C63:Z66,C68:Z72,C74:Z78,C80:Z84,C86:Z90,C92:Z96,C102:Z112\")\n    End With\n\n    On Error Resume Next\n    Set rErr = rng.SpecialCells(xlCellTypeFormulas, xlErrors)\n    On Error GoTo 0\n\n    If Not rErr Is Nothing Then\n        For Each cl In rErr.Cells\n            If cl.Value = CVErr(xlErrRef) Then\n                cl.Offset(0, 1) = 0\n            End If\n        Next\n    End If\nEnd Sub\n\n</code></pre>\n\n<p>To remove <em>All</em> errors:</p>\n\n<pre><code>Sub Demo2()\n    Dim rng As Range\n    Dim rErr As Range\n\n    With ActiveSheet 'or specify a specific sheet\n        Set rng = .Range(\"C5:Z7,C10:Z14,C27:Z27,C33:Z45,C52:Z55,C58:Z61,C63:Z66,C68:Z72,C74:Z78,C80:Z84,C86:Z90,C92:Z96,C102:Z112\")\n    End With\n\n    On Error Resume Next\n    Set rErr = rng.SpecialCells(xlCellTypeFormulas, xlErrors)\n    On Error GoTo 0\n\n    If Not rErr Is Nothing Then\n        rErr = 0\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ea5f8905726ff1d134eeaa9406c999?s=128&d=identicon&r=PG&f=1", "display_name": "signup4stuffmatt", "link": "https://stackoverflow.com/users/12020403/signup4stuffmatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58000679, "answer_count": 1, "score": 0, "last_activity_date": 1568840527, "creation_date": 1568838336, "last_edit_date": 1568839773, "question_id": 58000284, "link": "https://stackoverflow.com/questions/58000284/replace-ref-over-within-several-ranges", "title": "Replace #Ref over within several Ranges", "body": "<p>New to coding so sorry if I'm completely ignoring contexts as I'm still trying to learn them. </p>\n\n<p>I have cells that are trying to pull data from several Pivot Tables in another worksheet. If it is unable to pull any information from the pivot tables, it will return #REF. The Macro is supposed to search through in each cell within several ranges to search for the #REF and replace it with a 0. The reason its several ranges instead of the entire worksheet is that some of the equations are trying to add values from a table and since some of those values are #REF, the sum also ends up being #REF. I need to keep those equations there so once the #REF's are replaced, they would get the sum. </p>\n\n<pre><code>    Dim Areas(13) As Range\n    Set Areas(1) = Range(\"C5:Z7\")\n    Set Areas(2) = Range(\"C10:Z14\")\n    Set Areas(3) = Range(\"C27:Z27\")\n    Set Areas(4) = Range(\"C33:Z45\")\n    Set Areas(5) = Range(\"C52:Z55\")\n    Set Areas(6) = Range(\"C58:Z61\")\n    Set Areas(7) = Range(\"C63:Z66\")\n    Set Areas(8) = Range(\"C68:Z72\")\n    Set Areas(9) = Range(\"C74:Z78\")\n    Set Areas(10) = Range(\"C80:Z84\")\n    Set Areas(11) = Range(\"C86:Z90\")\n    Set Areas(12) = Range(\"C92:Z96\")\n    Set Areas(13) = Range(\"C102:Z112\")\n\n    For R = 1 To 13\n        For Each cell In Areas(R)            'Error: For Each may only iterate over a collection object \n            If cell.Value = CVErr(xlErrName) Then\n                .Replace What:=\"#REF!\", Replacement:=\"0\", LookAt:=xlPart, _\n                SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n                ReplaceFormat:=False\n            Else\n        Next\n</code></pre>\n\n<p>I made a bunch of notes after my code to try to work off of based on other StackOverflow questions which I listed below. I figured they worked will form a single range but I'm working with several. <strong>If none of what I did makes sense then disregard the below and help me start over. (Please?)</strong> Let me know if you need any more information.</p>\n\n<pre><code>    If IsError(cell.Value) Then\n'    If cell.Value = CVErr(xlErrName) Then\n'        ...\n'    End If\n'End If\n\n'Dim nm As Name\n'    For Each nm In ActiveWorkbook.Names\n'        If InStr(nm.Value, \"#REF!\") &gt; 0 Then\n'            nm.Delete\n'    End If\n    'Next nm\n\n'    ActiveCell.Replace What:=\"#REF!\", Replacement:=\"0\", LookAt:=xlPart, _\n'        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n'        ReplaceFormat:=False\n\n'With Range(\"B11:AP55\").SpecialCells(xlCellTypeFormulas)\n'    .Formula = Replace(.Formula, \"#REF\", \"Master\", , , vbTextCompare)\n'End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568838381, "post_id": 58000266, "comment_id": 102406384, "body": "Are you trying to get the last row, or the populated rows? You can use <code>CountA</code> for the latter."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568838443, "post_id": 58000266, "comment_id": 102406406, "body": "Is an unpopulated row one with nothing in it, as opposed to having any blanks?"}, {"owner": {"reputation": 3, "user_id": 12087097, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mADlJtwBQyyPFy1B6BRypxqO4ZKhA7BWcY3WyP9tQ=k-s128", "display_name": "Daume", "link": "https://stackoverflow.com/users/12087097/daume"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568838506, "post_id": 58000266, "comment_id": 102406428, "body": "@BigBen the amount of populated rows"}, {"owner": {"reputation": 3, "user_id": 12087097, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mADlJtwBQyyPFy1B6BRypxqO4ZKhA7BWcY3WyP9tQ=k-s128", "display_name": "Daume", "link": "https://stackoverflow.com/users/12087097/daume"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568838545, "post_id": 58000266, "comment_id": 102406438, "body": "@SJR Yes one without any type of data/value in it"}, {"owner": {"reputation": 3, "user_id": 12087097, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mADlJtwBQyyPFy1B6BRypxqO4ZKhA7BWcY3WyP9tQ=k-s128", "display_name": "Daume", "link": "https://stackoverflow.com/users/12087097/daume"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568838659, "post_id": 58000266, "comment_id": 102406484, "body": "@BigBen I tried the CountA but its says this object doesnt support property or method"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12087097, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mADlJtwBQyyPFy1B6BRypxqO4ZKhA7BWcY3WyP9tQ=k-s128", "display_name": "Daume", "link": "https://stackoverflow.com/users/12087097/daume"}, "edited": false, "score": 0, "creation_date": 1568839283, "post_id": 58000358, "comment_id": 102406698, "body": "That actually worked!!! Thanks a lot I&#39;ve been going at this for half of the week. I tried using .DataBodyRange directly in the UsedRows with ListRows instead of the actual column. Did you use the Application Object to call on CountA?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568839330, "post_id": 58000358, "comment_id": 102406720, "body": "What also works: <code>Debug.Print Application.CountA(Sheets(&quot;Sheet1&quot;).Range(&quot;Table1[Column 1]&quot;))</code>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568839375, "post_id": 58000358, "comment_id": 102406741, "body": "You can use <code>Application</code> or <code>Application.WorksheetFunction</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1568839460, "post_id": 58000358, "comment_id": 102406765, "body": "@JvdV yes, I personally avoid table references inside <code>Range</code> but yeah, same idea."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1568838729, "creation_date": 1568838729, "answer_id": 58000358, "question_id": 58000266, "link": "https://stackoverflow.com/questions/58000266/counting-excel-table-rows-that-are-populated-with-data-on-vba/58000358#58000358", "title": "Counting Excel Table Rows that are populated with data on VBA", "body": "<p>Sounds like you can use <code>CountA</code>, like this perhaps:</p>\n\n<pre><code>Dim myColumn As ListColumn\nSet myColumn = Sheets(\"Sheet1\").ListObjects(\"Table1\").ListColumns(\"Column 1\")\n\nDim UsedRows As Long\nUsedRows = Application.CountA(myColumn.DataBodyRange)\nDebug.Print UsedRows\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1568838894, "creation_date": 1568838894, "answer_id": 58000398, "question_id": 58000266, "link": "https://stackoverflow.com/questions/58000266/counting-excel-table-rows-that-are-populated-with-data-on-vba/58000398#58000398", "title": "Counting Excel Table Rows that are populated with data on VBA", "body": "<p><strong>If you don't have blank cells in other rows.</strong> The 3 doesn't need to be hard-coded, this is just the number of columns in your table.</p>\n\n<pre><code>Sub x()\n\nDim r As Range\n\nSet r = ActiveSheet.ListObjects(1).DataBodyRange\n\nWith WorksheetFunction\n    MsgBox .CountBlank(r) / 3                  'empty rows\n    MsgBox (r.Rows.Count - .CountBlank(r) / 3) 'non-empty rows\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12087097, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mADlJtwBQyyPFy1B6BRypxqO4ZKhA7BWcY3WyP9tQ=k-s128", "display_name": "Daume", "link": "https://stackoverflow.com/users/12087097/daume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 58000358, "answer_count": 2, "score": 0, "last_activity_date": 1568838894, "creation_date": 1568838255, "last_edit_date": 1568838400, "question_id": 58000266, "link": "https://stackoverflow.com/questions/58000266/counting-excel-table-rows-that-are-populated-with-data-on-vba", "title": "Counting Excel Table Rows that are populated with data on VBA", "body": "<p>So im currently working a table in excel that I have named Table1 with three columns (Column 1, Column 2 and Column 3). Ive been trying to count the used rows or populated rows inside the table using VBA but have had no luck.</p>\n\n<p>Example 1:</p>\n\n<pre><code>UsedRows= Sheets (\"Sheet1\").ListObjects.(\"Table1[#Column 1]\").UsedRange.ListRows.Count\n</code></pre>\n\n<p>Example 2 (This One Returns only all available rows)</p>\n\n<pre><code>UsedRows= Sheets (\"Sheet1\").ListObjects.(\"Table1[#Column 1]\").ListRows.Count\n</code></pre>\n\n<p>I either want the populated or unpolulated row amount. Either of the two will work just fine. Remember this is a Table so End(xlUp) and End(xlDown) work a little bit different. Ive tried those too but I still get either the total rows available or the cells that are modified which is way more than what I have available. </p>\n\n<p>Thanks for the help in adavanced whoever posts. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1568839032, "post_id": 57999950, "comment_id": 102406609, "body": "Based on the information you provided, you shouldn&#39;t need any VBA at all; you can use Excel&#39;s data filtering capabilities, and copy and paste the filtered results. Therefore, I think your question isn&#39;t really a good fit for StackOverflow, which is about programming questions; and it&#39;s unclear why your question is a programming question."}, {"owner": {"reputation": 1833, "user_id": 1062727, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b5b9976710eed726413233e9fef7f43e?s=128&d=identicon&r=PG", "display_name": "Paulo Buchsbaum", "link": "https://stackoverflow.com/users/1062727/paulo-buchsbaum"}, "edited": false, "score": 0, "creation_date": 1568851345, "post_id": 57999950, "comment_id": 102409722, "body": "Yes, but it&#39;s nice to automate the task if it is repeated as a periodic routine."}], "answers": [{"tags": [], "owner": {"reputation": 1833, "user_id": 1062727, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b5b9976710eed726413233e9fef7f43e?s=128&d=identicon&r=PG", "display_name": "Paulo Buchsbaum", "link": "https://stackoverflow.com/users/1062727/paulo-buchsbaum"}, "is_accepted": true, "score": 1, "last_activity_date": 1568894254, "last_edit_date": 1568894254, "creation_date": 1568840366, "answer_id": 58000653, "question_id": 57999950, "link": "https://stackoverflow.com/questions/57999950/copy-row-if-cell-is-empty/58000653#58000653", "title": "Copy row if cell is empty", "body": "<p>Suppose you have the following structure starting from <code>A1</code> (worksheet <code>Orig</code>)</p>\n\n<p><a href=\"https://i.stack.imgur.com/TPevm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TPevm.png\" alt=\"Origin\"></a></p>\n\n<p>The following generic commented code solve the problem:</p>\n\n<pre><code>Sub CopyInv()\n Dim O As Worksheet \n Dim D As Worksheet\n Set O = Worksheets(\"Orig\") \n Set D = Worksheets(\"Dest\")\n Dim CF As Integer ' Last column\n Dim LD As Long ' Last line in destination\n Dim LO As Long ' Last line filled\n Dim LOF As Long ' Last line in origin\n' Final table colunm in source\n CF = O.Cells(1, 1).End(xlToRight).Column\n' Last line with data in destination (emulate ^Up)\n LD = D.Cells(Cells.Rows.Count, 1).End(xlUp).Row\n Range(D.Cells(1, 1), D.Cells(LD, CF - 1)).Clear\n O.Select\n' Sort by 3rd column\n O.Cells(1, 3).Sort key1:=O.Cells(1, 3), \n                Order1:=xlAscending, Header:=xlYes \n Cells(1, 1).Select\n' Last filled data in \"paid\" column\n LO = O.Cells(1, 3).End(xlDown).Row + 1\n' Last line in origin\n LOF = O.Cells(Cells.Rows.Count, 1).End(xlUp).Row\n  ' Copy header in destination\n Range(O.Cells(1, 1), O.Cells(1, 2)).Copy (D.Cells(1, 1))  \n If LOF &gt;= LO Then   ' Copy in destination\n   Range(O.Cells(LO, 1), O.Cells(LOF, 2)).Copy (D.Cells(2, 1)) \n End If\n D.Select\n Cells(1, 1).Select\nEnd Sub\n</code></pre>\n\n<p>The result in destination (worksheet <code>Dest</code>) starting from <code>A1</code> is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1g0oR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1g0oR.png\" alt=\"Destination\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 12087005, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cSgEyEWnJec/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcQqeWhvwCMHNjG538vgHzaBBB5DA/photo.jpg?sz=128", "display_name": "Rudolfs Alsbergs", "link": "https://stackoverflow.com/users/12087005/rudolfs-alsbergs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 58000653, "answer_count": 1, "score": 1, "last_activity_date": 1607113856, "creation_date": 1568836698, "last_edit_date": 1607113856, "question_id": 57999950, "link": "https://stackoverflow.com/questions/57999950/copy-row-if-cell-is-empty", "title": "Copy row if cell is empty", "body": "<p>I have a raw datasheet in the first tab with Invoice numbers and a cell next to it stating if they have (quarter number and year)/ haven't been paid (empty cell).</p>\n<p>I want to copy the unpaid invoice numbers (or even better the whole row) to second sheet.</p>\n<p>Because there are couple thousand rows, I can't use an if statement and then sort and delete the rows that have been paid.</p>\n<p>Is there a way to show only the wanted information?</p>\n"}, {"tags": ["excel", "vba", "office-js", "worksheet", "javascript-api-for-office"], "comments": [{"owner": {"reputation": 473, "user_id": 11618797, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mtLsenvRC1Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reB7oFAKDsDEnnQ80ZQ1XOOAU7kwA/mo/photo.jpg?sz=128", "display_name": "Sachin Yadav", "link": "https://stackoverflow.com/users/11618797/sachin-yadav"}, "edited": false, "score": 0, "creation_date": 1568836485, "post_id": 57999868, "comment_id": 102405668, "body": "Didn&#39;t actually understood exactly the question but I think you are looking for this <a href=\"https://www.excel-easy.com/vba/create-a-macro.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/create-a-macro.html</a>"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1568836595, "post_id": 57999868, "comment_id": 102405711, "body": "I&#39;m confused -- do you want to write the actual macro in VBA, or using the <a href=\"https://docs.microsoft.com/en-us/office/dev/add-ins/reference/javascript-api-for-office\" rel=\"nofollow noreferrer\">Javascript API for Office</a>?"}, {"owner": {"reputation": 63, "user_id": 9908821, "user_type": "registered", "profile_image": "https://graph.facebook.com/2103138296622749/picture?type=large", "display_name": "Arenukvern", "link": "https://stackoverflow.com/users/9908821/arenukvern"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1568839699, "post_id": 57999868, "comment_id": 102406845, "body": "@ZevSpitz I updated my question, please see Update 1 paragraph"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568840125, "post_id": 57999868, "comment_id": 102407000, "body": "As far as I know, it&#39;s not possible to access the VBProject that contains the VBA code from the Excel Javascript API, but there could be a workaround.  Are you allowed to have some other VBA code (not the macro you want to run) already sitting inside the workbook before running your code from the JS API?"}, {"owner": {"reputation": 63, "user_id": 9908821, "user_type": "registered", "profile_image": "https://graph.facebook.com/2103138296622749/picture?type=large", "display_name": "Arenukvern", "link": "https://stackoverflow.com/users/9908821/arenukvern"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568840390, "post_id": 57999868, "comment_id": 102407087, "body": "@DecimalTurn Yes, its allowed."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1568842261, "post_id": 57999868, "comment_id": 102407705, "body": "So now the question is, why do you need JS at all? Why not do this purely using VBA? (As a side note, when editing your question, you don&#39;t need to present the history of your question -- you don&#39;t need a section <b>Update 1</b>, <b>Update 2</b> etc. -- because StackOverflow automatically keeps track of any edits you made. Instead, you should strive to make your question as clear as possible.)"}, {"owner": {"reputation": 63, "user_id": 9908821, "user_type": "registered", "profile_image": "https://graph.facebook.com/2103138296622749/picture?type=large", "display_name": "Arenukvern", "link": "https://stackoverflow.com/users/9908821/arenukvern"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1568844311, "post_id": 57999868, "comment_id": 102408259, "body": "@ZevSpitz currently I already have a VBA project for similar tasks, but as a project grow and evolve - some features here, some features here, I saw that addins - is the best solution to resolve key problems - its easier to maintain, manage, develop, push updates, install, and it just look better - because an addin is just one simple website - but certainly, as I wrote before, it lucks some functions. Updates - noted, thank you for your advise"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568848593, "post_id": 57999868, "comment_id": 102409196, "body": "I think there is a possible workaround using an event procedure, but I ran into problems when trying to trigger a VBA event from Office-JS, so I asked this more <a href=\"https://stackoverflow.com/questions/58001786/can-office-js-trigger-a-vba-workbook-or-worksheet-event-procedure\">specific question</a>. If that question has an answer, I should be able to provide a complete answer to your question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1568850646, "post_id": 57999868, "comment_id": 102409622, "body": "Put the content into a specific cell, and then select it via the js API - your VBA SelectionChange event handler can monitor for that selection and then do whatever it needs to with the cell content.  This kind of sucks though, and it&#39;s likley to lead to a mess.  You could more easily make a self-updating VBA add-in"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9908821, "user_type": "registered", "profile_image": "https://graph.facebook.com/2103138296622749/picture?type=large", "display_name": "Arenukvern", "link": "https://stackoverflow.com/users/9908821/arenukvern"}, "edited": false, "score": 0, "creation_date": 1568957733, "post_id": 58002240, "comment_id": 102447369, "body": "thank you very much for your help! I used your workaround to make complete solution and pick it in this question."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1584744940, "last_edit_date": 1584744940, "creation_date": 1568853209, "answer_id": 58002240, "question_id": 57999868, "link": "https://stackoverflow.com/questions/57999868/is-there-is-a-way-to-insert-macro-to-worksheet-from-excel-addin/58002240#58002240", "title": "Is there is a way to insert macro to worksheet from Excel Addin?", "body": "<h3>Potential Workaround</h3>\n\n<p>As a disclaimer, this method could introduce some vulnerability in the Excel file you are using, so you have to be careful with this by using unique names for your macro, module and sheet name to make sure no add-in will run VBA code without your consent.</p>\n\n<p>The idea would be to create a new worksheet and write the code of your macro into a cell inside that worksheet (Let's say cell A1). Then, there would be a VBA Event procedure already present in the <code>ThisWorkbook</code> module that will do the heavy lifting to make your macro run.</p>\n\n<p>Assuming that the <code>Trust access to the VBA project object model</code> was enabled and that you've added the <code>Microsoft Visual Basic for Applications Extensibility 5.3</code> Library to your workbook, you could have the following VBA event procedure inside <code>ThisWorkbook</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n    If Sh.Name = \"NewSheet\" Then\n        If Sh.Range(\"$A$1\") &lt;&gt; vbNullString Then\n\n            Const ModuleName As String = \"MacroJs\"\n            Const MacroName As String = \"YourMacroName\"\n            Const SheetName As String = \"NewSheet\"\n\n            Dim ws As Worksheet\n            Set ws = ThisWorkbook.Sheets(SheetName)\n\n            Dim rng As Range\n            Set rng = ws.Range(\"A1\")\n\n            'Export the content of the cell to a .bas file\n            Open ThisWorkbook.Path &amp; \"\\\" &amp; ModuleName &amp; \".bas\" For Output As #1\n            Print #1, \"Attribute VB_Name = \"\"\" &amp; ModuleName &amp; \"\"\" \" &amp; vbNewLine &amp; ws.Range(\"A1\").Value2\n            Close #1\n\n            'Declare VBProject Object\n            Dim vbaProject As VBProject\n            Set vbaProject = ThisWorkbook.VBProject\n\n            'Delete pre-existing module with the same name\n            On Error Resume Next\n            ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(ModuleName)\n            On Error GoTo 0\n\n            'Load the code as a new Module\n            vbaProject.VBComponents.Import ThisWorkbook.Path &amp; \"\\\" &amp; ModuleName &amp; \".bas\"\n            Dim vbaModule As VBIDE.VBComponent\n            Set vbaModule = vbaProject.VBComponents(ModuleName)\n\n            'Run the code\n            Application.Run ModuleName &amp; \".\" &amp; MacroName\n\n            'Cleanup\n            ThisWorkbook.VBProject.VBComponents.Remove vbaModule 'Optional\n            Application.DisplayAlerts = False\n                ws.Delete\n            Application.DisplayAlerts = True\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>This procedure would be triggered by the creation of a sheet by your Office-JS code.</p>\n\n<p>Note that I would also advise to add some error handling to make sure that the cleanup section will run in case there is a run-time error while running the code.</p>\n\n<p>And then your JavaScript code would look like this:</p>\n\n<pre><code>var sheets = context.workbook.worksheets;\nvar sheet = sheets.add(\"NewSheet\");\nsheet.getRange(\"A1\").values = 'sub YourMacroName() \\n Msgbox \"Test\" \\n End sub';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 5239952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/apFx6.jpg?s=128&g=1", "display_name": "Keyur Patel - MSFT", "link": "https://stackoverflow.com/users/5239952/keyur-patel-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1568866195, "creation_date": 1568866195, "answer_id": 58003608, "question_id": 57999868, "link": "https://stackoverflow.com/questions/57999868/is-there-is-a-way-to-insert-macro-to-worksheet-from-excel-addin/58003608#58003608", "title": "Is there is a way to insert macro to worksheet from Excel Addin?", "body": "<p>Hi this capability does not existing the Office.js API today. I would post a require on the Office Add-ins User Voice site at: <a href=\"https://officespdev.uservoice.com\" rel=\"nofollow noreferrer\">https://officespdev.uservoice.com</a>.  thank you.</p>\n"}], "owner": {"reputation": 63, "user_id": 9908821, "user_type": "registered", "profile_image": "https://graph.facebook.com/2103138296622749/picture?type=large", "display_name": "Arenukvern", "link": "https://stackoverflow.com/users/9908821/arenukvern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 791, "favorite_count": 1, "accepted_answer_id": 58002240, "answer_count": 2, "score": 5, "last_activity_date": 1584744940, "creation_date": 1568836269, "last_edit_date": 1569061202, "question_id": 57999868, "link": "https://stackoverflow.com/questions/57999868/is-there-is-a-way-to-insert-macro-to-worksheet-from-excel-addin", "title": "Is there is a way to insert macro to worksheet from Excel Addin?", "body": "<p>I searched documentation <a href=\"https://docs.microsoft.com/en-us/office/dev/add-ins/reference/javascript-api-for-office\" rel=\"nofollow noreferrer\">Office Excel API</a>, but cannot find any mentions at all, how it can be implemented.</p>\n\n<p>The Problem:</p>\n\n<p>Luck of API functionality or some sort of bugs can be solved easily by VBA macros. </p>\n\n<p>But, for doing that, we have only two possibilities:</p>\n\n<ol>\n<li><p>Insert macro manually into sheet, which will catch some event on sheet, and JS from addin will trigger that event (this solution came from very old forum (if I will find the link, I will insert it here)).</p></li>\n<li><p>Insert macro by JS code to sheet (context.workbook.worksheet?) during addin runtime, and even it cannot be executed by addin, but in this case the end user do not need to manage macro at all - we can make process of macro running more smooth with the same logic (JS inserts macro into sheet, change some value in sheet and then it triggers some macro, and after that (for example after some timeout in JS or just by another event in JS we can easily delete the whole sheet with this macro)).</p></li>\n</ol>\n\n<p>So the question is, is it possible somehow make something similar to solution 2 using the Excel API? \n(some sort of function to insert/delete VBA code from addin)</p>\n\n<p>I will appreciate any help!</p>\n\n<p><strong>Example to clarify problem</strong></p>\n\n<p>I'm using the JavaScript API, but unfortunately the API doesn't cover full functionally (I hope yet) which is already existed in VBA. Let me explain it on a simple example: </p>\n\n<p>Imagine a task:</p>\n\n<ol>\n<li><p>We need to copy some information from sheet 1 in workbook 1</p></li>\n<li><p>then we need to create a book and just put the values in new workbook 2 </p></li>\n<li><p>then we need to suggest to user where it(new workbook 2) needs to be saved.  </p></li>\n<li><p>then we need save and close workbook 2.</p></li>\n</ol>\n\n<p>VBA resolves the problem easily, but in case JS API - there is no full solution of this problem (without third-party applications).</p>\n\n<p>You can compare API JS and VBA by follwoing links below: </p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/dev/add-ins/excel/excel-add-ins-workbooks\" rel=\"nofollow noreferrer\">Workbooks JS API</a> </p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook\" rel=\"nofollow noreferrer\">Workbooks VBA API</a> </p>\n\n<p>So what I want to do - is to write actual VBA macro in JavaScript and insert this VBA macro into sheet to make the macro executable.</p>\n\n<p><strong>How to make macro executable from some value change on sheet?</strong></p>\n\n<p>I found out that, if you call <code>select</code> method directly applying to cell and catch selection change using <code>Worksheet_SelectionChange</code> in VBA - it perfectly worked.</p>\n\n<p>Unfortunately direct set values to cell doesn't trigger VBA <code>Worksheet_change</code> </p>\n\n<p><strong>Why am I using JS API</strong></p>\n\n<p>Currently I already have a VBA project for similar tasks, but as the project grow and evolve - some features here, some features here, I saw that addins - is the best solution to resolve key problems - its easier to maintain, manage, develop, push updates, install, and it just look better - because an addin is just one simple website</p>\n\n<p><strong>Update 2019/09/20 - Possible Workaround</strong></p>\n\n<p>First of all, great thanks to @DecimalTurn, who made this workaround possible. See <a href=\"https://stackoverflow.com/a/58002240/9908821\">his original answer below</a></p>\n\n<p>I a little bit modify it and added additional JS script and VBA script to make this solution complete. So:</p>\n\n<ol>\n<li>The following VBA macros needs to be inserted BEFORE you will make any actions from JS to <code>ThisWorkbook</code> module:</li>\n</ol>\n\n<p>1.1. VBA macro which will handle all VBA code which we will transfer</p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n    On Error GoTo endline\n    Const SheetName As String = \"_WorksheetSheetWorker\"\n\n    CheckIfVBAAccessIsOn\n\n    If InStr(1, Sh.name, SheetName, vbBinaryCompare) &gt;= 0 Then\n        If Sh.Range(\"$A$1\") &lt;&gt; vbNullString Then\n\n            Const ModuleName As String = \"m_TempMacroJS\"\n\n            Dim ws As Worksheet\n            Set ws = ThisWorkbook.Sheets(SheetName)\n            'We will take MacroName from sheet which we added from JS\n            Dim MacroName As String\n            MacroName = ws.Range(\"A2\").Value2\n\n            Dim rng As Range\n            Set rng = ws.Range(\"A1\")\n            Dim pathToMacroBas As String\n\n            'Export the content of the cell to a .bas file\n            pathToMacroBas = ThisWorkbook.path &amp; \"\\\" &amp; ModuleName &amp; \".bas\"\n            Open pathToMacroBas For Output As #1\n            Print #1, \"Attribute VB_Name = \"\"\" &amp; ModuleName &amp; \"\"\" \" &amp; vbNewLine &amp; ws.Range(\"A1\").Value2\n            Close #1\n\n            'Declare VBProject Object\n            Dim vbaProject As VBProject\n            Set vbaProject = ThisWorkbook.VBProject\n\n            'Delete pre-existing module with the same name\n            On Error Resume Next\n            ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(ModuleName)\n                On Error GoTo 0\n\n                'Load the code as a new Module\n                vbaProject.VBComponents.Import ThisWorkbook.path &amp; \"\\\" &amp; ModuleName &amp; \".bas\"\n                Dim vbaModule As VBIDE.VBComponent\n                Set vbaModule = vbaProject.VBComponents(ModuleName)\n\n                'Run the code and transfer working sheet to macro\n                'You can use this worksheet to transfer values to macro as JSON\n                Application.Run ModuleName &amp; \".\" &amp; MacroName, ws\n\n                'Cleanup\n                ThisWorkbook.VBProject.VBComponents.Remove vbaModule \n                'Optional\n                Kill pathToMacroBas\n                Application.DisplayAlerts = False\n                ws.Delete\n                Application.DisplayAlerts = True\n            End If\n        End If\n        Exit Sub\n      endline:\n      End Sub\n</code></pre>\n\n<p>1.2 VBA macro which will programmatic way enable <code>Trust access to the VBA project object model</code>. Please note: You will still need also enable <code>Microsoft Visual Basic for Applications Extensibility 5.3</code></p>\n\n<p>I found the solution on link <a href=\"https://blogs.msdn.microsoft.com/cristib/2012/02/29/vba-how-to-programmatically-enable-access-to-the-vba-object-model-using-macros/\" rel=\"nofollow noreferrer\">here</a> and a little modify it - the macro creates VBScript and enable <code>Trust access to the VBA project object model</code> directly in register. The problem which I cannot handle yet - is the delay. The time of delay is needed to save and close existed workbook.</p>\n\n<pre><code>Sub CheckIfVBAAccessIsOn()\n\n    '[HKEY_LOCAL_MACHINE/Software/Microsoft/Office/10.0/Excel/Security]\n    '\"AccessVBOM\"=dword:00000001\n\n    Dim strRegPath As String\n    strRegPath = \"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\" &amp; Application.Version &amp; \"\\Excel\\Security\\AccessVBOM\"\n\n    If TestIfKeyExists(strRegPath) = False Then\n      MsgBox \"A change has been introduced into your registry configuration. All changes will be saved. Please reopen book.\"\n      WriteVBS\n      ThisWorkbook.Save\n      Application.Quit\n    End If\n\n  End Sub\n\n  Function TestIfKeyExists(ByVal path As String)\n    Dim WshShell As Object\n    Set WshShell = CreateObject(\"WScript.Shell\")\n    On Error Resume Next\n    Dim RegValue As Boolean\n    RegValue = WshShell.RegRead(path)\n    If RegValue = True Then\n      TestIfKeyExists = True\n    Else\n      TestIfKeyExists = False\n    End If\n    On Error GoTo 0\n  End Function\n\n  Sub WriteVBS()\n    Dim objFile         As Object\n    Dim objFSO          As Object\n    Dim codePath        As String\n    codePath = Me.path &amp; \"\\reg_setting.vbs\"\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFile = objFSO.OpenTextFile(codePath, 2, True)\n\n    objFile.WriteLine (\" On Error Resume Next\")\n    objFile.WriteLine (\"\")\n    objFile.WriteLine (\"Dim WshShell\")\n    objFile.WriteLine (\"Set WshShell = CreateObject(\"\"WScript.Shell\"\")\")\n    objFile.WriteLine (\"\")\n    objFile.WriteLine (\"MsgBox \"\"Please wait until Excel will closes! Click OK to complete the setup process.\"\"\")\n    objFile.WriteLine (\"\")\n    objFile.WriteLine (\"Dim strRegPath\")\n    objFile.WriteLine (\"Dim Application_Version\")\n    objFile.WriteLine (\"Application_Version = \"\"\" &amp; Application.Version &amp; \"\"\"\")\n    objFile.WriteLine (\"strRegPath = \"\"HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\\"\" &amp; Application_Version &amp; \"\"\\Excel\\Security\\AccessVBOM\"\"\")\n    objFile.WriteLine (\"WScript.echo strRegPath\")\n    objFile.WriteLine (\"WshShell.RegWrite strRegPath, 1, \"\"REG_DWORD\"\"\")\n    objFile.WriteLine (\"\")\n    objFile.WriteLine (\"If Err.Code &lt;&gt; o Then\")\n    objFile.WriteLine (\"   MsgBox \"\"Error\"\" &amp; Chr(13) &amp; Chr(10) &amp; Err.Source &amp; Chr(13) &amp; Chr(10) &amp; Err.Message\")\n    objFile.WriteLine (\"End If\")\n    objFile.WriteLine (\"\")\n    objFile.WriteLine (\"WScript.Quit\")\n\n    objFile.Close\n    Set objFile = Nothing\n    Set objFSO = Nothing\n\n    'run the VBscript code\n    ' &gt; The macro will fail to execute the VB script if you use a\n    '   [codepath] which contains blanks!\n    '\n    ' &gt; To fix this issue, we add a pair of double quotes (\" \") around\n    '   [codepath];\n    Shell \"cscript \" &amp; Chr(34) &amp; codePath &amp; Chr(34), vbNormalFocus\n\n  End Sub\n</code></pre>\n\n<ol start=\"2\">\n<li>Second part I wrote based on @DecimalTurn suggestion to create sheet in JS and then catch this event from VBA and wrapped up whole code in one JS instance:</li>\n</ol>\n\n<pre><code>    const VBAWorker = function(){\n      /* This is a name of tempurary sheet to execute macro */\n      this._executedMacroName = \"JSSubRunner\"\n      /* This is the name of sheet worker*/\n      this._WorksheetSheetWorkerName = \"_WorksheetSheetWorker\"\n      /* These options can be applied to already existed sheet*/\n      this._worksheetExistenceDecisionOptions = {\n        replaceSheet : \"replaceSheet\",\n        findNewAvailableName : \"findNewAvailableName\"\n      }\n    }\n\n\n    /**\n     * Function to run macro using sheet worker\n     * @param {String} VBAMacro is a code which will be executed\n     * @param {String} transferredValues (optional) are a values which we need \n     * to place into executable macro\n     * @param {String} worksheetDesicion (optional) is a desicion which we will if the worker worksheet exists\n     * default = \"replaceSheet\", possible = \"findNewAvailableName\"\n     */\n    VBAWorker.prototype.run= async function(VBAMacro, transferredValues = \"\", worksheetDesicion = \"replaceSheet\"){\n      const defaultWorksheetName = this._WorksheetSheetWorkerName\n      let worksheetName = defaultWorksheetName\n      const preparedVBAMacro = this._changeMacroName(VBAMacro) \n      await Excel.run(async (context) =&gt; {\n        /* First we need to check out existence of sheet worker*/\n        let sheets = context.workbook.worksheets;\n        sheets.load(\"items/name\");\n\n        await context.sync()\n        /**\n         *  In this case we will deside what to do \n         *  if we will find sheet with the same name\n         * */ \n        const isSheetExists = this._checkWorksheetExistence(sheets)\n        const decisionOptions = this._worksheetExistenceDecisionOptions\n        if (isSheetExists){\n          switch (worksheetDesicion){\n            case decisionOptions.replaceSheet:\n              let sheetToReplace = sheets.getItem(worksheetName)\n              sheetToReplace.delete()\n              await context.sync()\n            break;\n            case decisionOptions.findNewAvailableName:\n              worksheetName = this._changeNameOfWorkerWorksheet(sheets) \n            break;\n          }\n        } else {\n          /* we will keep worksheetName as default */\n        }\n\n        let sheet = sheets.add(worksheetName);\n        let macroExeCell = sheet.getCell(0,0)\n        let macroNameCell = sheet.getCell(1,0)\n        let macroValuesCell = sheet.getCell(0,1)\n        macroExeCell.values = preparedVBAMacro\n        macroNameCell.values = this._executedMacroName\n        let preparedValues = []\n        const limit = 32700 \n        const lengthOfString = transferredValues.length\n        // console.log(transferredValues.length)\n        // console.log(transferredValues.length / limit)\n          if (lengthOfString &gt; limit) {\n            try {\n              let done = false\n\n              /* during cell lenght limit we will slice string to many*/\n              let lastStep = false\n              let current = limit\n              let oldcurrent = 0\n\n              do {\n                let end = current\n                let start = oldcurrent\n                /* Check that the next simbol not equals to \"=\" */\n                if(transferredValues.slice(end, end + 1) == \"=\"){\n                  current += 1\n                  end = current\n                }\n\n                if (lengthOfString &lt; start ){\n                  start = lengthOfString\n                }  \n                if (lengthOfString &lt; end){\n                  end = lengthOfString\n                  lastStep = true\n                }\n\n                preparedValues.push(transferredValues.slice(start, end))\n\n                if (lastStep){\n                  done = true\n                } else {\n                  oldcurrent = current\n                  current += limit\n                }\n              } while (done == false)\n              /* Write values to sheet*/\n              await preparedValues.forEach(async (el, i)=&gt;{\n                macroValuesCell = sheet.getCell(0 + i,1)\n                macroValuesCell.values = [[el]]\n              })\n            } catch (error) {\n              console.log(error)\n            }\n          } else {\n            /* If string.length is less then limit we just put it directly to one cell*/\n            macroValuesCell.values = [[transferredValues]]\n          }\n        return await context.sync();\n      });\n    }\n\n    /**\n     * Function to search available name of sheet and return it\n     * @param {Array} sheets - worksheet items with \n     * returns suggestedName (string)\n     */\n    VBAWorker.prototype._changeNameOfWorkerWorksheet = function(sheets){\n      try {\n        let suggestCounter = 0\n        let suggestedName; \n        let suggestedNameIsFree = false;\n        let worksheetName = this._WorksheetSheetWorkerName\n        do {\n          suggestedName = worksheetName + suggestCounter \n          suggestCounter = suggestCounter +1\n          suggestedNameIsFree = !this._checkWorksheetExistence(sheets)\n        } while (suggestedNameIsFree = false);\n        return suggestedName\n\n      } catch (error) {\n        console.log(error)\n      }\n    }\n\n    /**\n     * Function to check worksheet name existence\n     * @param {Array} sheets - worksheet items with names\n     * returns true or false\n     */\n    VBAWorker.prototype._checkWorksheetExistence = function(sheets){\n      let isSheetExists = false\n      sheets.items.forEach(el=&gt;{\n        if(el.name == this._WorksheetSheetWorkerName){\n          isSheetExists = true\n          return;\n        }\n      }) \n      return isSheetExists\n    }\n\n    /**\n     * Function to change name of running macro\n     * @param {String} VBAMacro is a string that contains executed macro\n     * The name of running sub will be changed to \"_JSSubRunner\"\n     */\n    VBAWorker.prototype._changeMacroName =function(VBAMacro){\n      const regex = /(Sub\\s+)(.*)([(])/i\n      const renamedVBAMacro = VBAMacro.replace(regex, `Sub ${this._executedMacroName} (`)\n      return renamedVBAMacro\n    }\n\n    export default VBAWorker\n</code></pre>\n\n<p><em>How it can be used?</em></p>\n\n<p>You can used it as simple instance calling the VBAWorker that way:</p>\n\n<pre><code>  const VBAWorkerInst = new VBAWorker()\n  await VBAWorkerInst.run(\n    \"your VBA code goes here\",\n    \"your values in string (JSON for example) goes here\",\n    \"optional option:) - a name of decision what we need to do, if sheet already existed\"\n  )\n</code></pre>\n\n<p>Your macro can have any name, because this VBAWorker will take care of it and will change that name to unify it.</p>\n\n<p><em>Please note:</em> because Excel is asynchronous we need to wait until all promises will resolved! So the code above must be wrapped in asynchronous function or you can catch the promise callback.</p>\n\n<p>I'm not tested yet, but I think it's possible to run more than one macro, and we can use the same strategy as for values to write more usefull code.</p>\n\n<p>So that's all in this moment:) Really hope that with time there will be simpler solution..</p>\n"}, {"tags": ["excel", "vba", "powerquery"], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 1, "last_activity_date": 1568915393, "creation_date": 1568915393, "answer_id": 58016490, "question_id": 57999564, "link": "https://stackoverflow.com/questions/57999564/change-data-source-of-power-query-using-vb-script/58016490#58016490", "title": "Change Data Source of Power Query using VB Script", "body": "<p>I think you're missing a closing <code>)</code> in the first line of your M code. The Advanced Editor shows an error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/piTso.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/piTso.png\" alt=\"Error message\"></a></p>\n\n<p>I can't test if that fixes your issue or not. However, I would recommend not manipulating your query's formula in VBA (as you can't be sure the result is syntactically valid in M).</p>\n\n<p>Based on your VBA code, your query is in the same workbook as the ranges/cells being used to make the query's formula \"dynamic\". If you turn those ranges/cells (e.g. cell <code>A1</code>) into named ranges, you can then use <code>Excel.CurrentWorkbook</code> in Power Query to read the values in those named ranges.</p>\n\n<p>This means you don't need to push those cells' values to Power Query. Instead, Power Query can read them for itself -- and your query is still \"dynamic\".</p>\n\n<hr>\n\n<p>Minor detail. Your M code contains <code>Table.FromList</code>, followed by <code>Table.ExpandRecordColumn</code>. It's possible both of those steps could be replaced by <code>Table.FromRecords</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 11384516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb61db5079dfa3fa22c85dc1dd3ae29?s=128&d=identicon&r=PG&f=1", "display_name": "asr", "link": "https://stackoverflow.com/users/11384516/asr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568915393, "creation_date": 1568834692, "last_edit_date": 1568877550, "question_id": 57999564, "link": "https://stackoverflow.com/questions/57999564/change-data-source-of-power-query-using-vb-script", "title": "Change Data Source of Power Query using VB Script", "body": "<p>The following vba code works when line 4 replaced with</p>\n\n<p>... Source = Json.Document(Web.Contents(\"\"<a href=\"https://pidynaapst02.com/e/78df7c69-3512-4946-8d3c-f1c0e451fe80/api/v1/problem/feed?relativeTime=month\" rel=\"nofollow noreferrer\">https://pidynaapst02.com/e/78df7c69-3512-4946-8d3c-f1c0e451fe80/api/v1/problem/feed?relativeTime=month</a>\"\")),\" &amp; Chr(13) &amp; ...</p>\n\n<p>However, in order to do it automatically, I want to replace url by a variable, as shown below:</p>\n\n<p>... Source = Json.Document(Web.Contents(\"\"\" &amp; VA &amp; \"\"\")),\" &amp; Chr(13) &amp; ... </p>\n\n<p>This is the complete vb code:</p>\n\n<pre><code>`                                                                                                 \nSub Macro2()                                                                                      \nVA = Sheets(1).Range(\"A1\").Value\nActiveWorkbook.Queries.Add Name:= _\n    \"Table 0\", Formula:= _\n    \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Json.Document(Web.Contents(\"\"\" &amp; VA &amp; \"\"\"),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    result = Source[result],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    problems = result[problems],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Converted to Table\"\" = Table.FromList(problems, Splitter.SplitByNothing(), null, null, ExtraValues.\" &amp; _\n    \"Error),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Expanded Column1\"\" = Table.ExpandRecordColumn(#\"\"Converted to Table\"\", \"\"Column1\"\", {\"\"id\"\", \"\"startTime\"\", \"\"endTime\"\", \"\"displayName\"\", \"\"impactLevel\"\", \"\"status\"\", \"\"severityLevel\"\", \"\"commentCount\"\", \"\"tagsOfAffectedEntities\"\", \"\"rankedImpacts\"\", \"\"affectedCounts\"\", \"\"recoveredCounts\"\", \"\"hasRootCause\"\"}, {\"\"Column1.id\"\", \"\"Column1.startTime\"\", \" &amp; _\n    \"\"\"Column1.endTime\"\", \"\"Column1.displayName\"\", \"\"Column1.impactLevel\"\", \"\"Column1.status\"\", \"\"Column1.severityLevel\"\", \"\"Column1.commentCount\"\", \"\"Column1.tagsOfAffectedEntities\"\", \"\"Column1.rankedImpacts\"\", \"\"Column1.affectedCounts\"\", \"\"Column1.recoveredCounts\"\", \"\"Column1.hasRootCause\"\"}),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Expanded Column1.tagsOfAffectedEntities\"\" = Table.ExpandListColumn(#\" &amp; _\n    \"\"\"Expanded Column1\"\", \"\"Column1.tagsOfAffectedEntities\"\"),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Expanded Column1.tagsOfAffectedEntities1\"\" = Table.ExpandRecordColumn(#\"\"Expanded Column1.tagsOfAffectedEntities\"\", \"\"Column1.tagsOfAffectedEntities\"\", {\"\"context\"\", \"\"key\"\", \"\"value\"\"}, {\"\"Column1.tagsOfAffectedEntities.context\"\", \"\"Column1.tagsOfAffectedEntities.key\"\", \"\"Column1.tagsOfAffectedEntit\" &amp; _\n    \"ies.value\"\"})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Expanded Column1.tagsOfAffectedEntities1\"\"\"Sheets.Add After:=ActiveSheet\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:=Array( _\n    \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"Table 0\"\"\" _\n    , \"ended Properties=\"\"\"\"\"), Destination:=Range(\"$A$1\")).QueryTable\n    .CommandType = xlCmdSql\n    .CommandText = Array( _\n    \"SELECT * FROM [Table 0]\")\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = False\n    .ListObject.DisplayName = \"Table_0\"\n    .Refresh BackgroundQuery:=False\nEnd WithSelection.ListObject.QueryTable.Refresh BackgroundQuery:=False                            \nEnd Sub`\n</code></pre>\n\n<p>It is giving error \"Intialization of the data source failed. Check the database server or contact you database administrator. Make sure the external database is available, and then try the operation again. If you see this message again, create a new data source to connect to the database.\"</p>\n\n<p>Hopefully somebody could help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1568834313, "post_id": 57999390, "comment_id": 102404833, "body": "Create a composite dictionary key by concatenating the name and the date with (eg) <code>|</code> and then split the key when populating to the sheet"}, {"owner": {"reputation": 29, "user_id": 8509714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfca5f898149f17e5e38e5f9447f5892?s=128&d=identicon&r=PG&f=1", "display_name": "anishmbait", "link": "https://stackoverflow.com/users/8509714/anishmbait"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1568951532, "post_id": 57999390, "comment_id": 102446073, "body": "Thanks for the suggestion. I was able to do this by concatenating both &quot;date&quot; and &quot;selection&quot;, and then further crack them into pieces using the delimiter and instr function for an end result."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1568954297, "post_id": 57999390, "comment_id": 102446556, "body": "Good to hear you worked it out."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8509714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfca5f898149f17e5e38e5f9447f5892?s=128&d=identicon&r=PG&f=1", "display_name": "anishmbait", "link": "https://stackoverflow.com/users/8509714/anishmbait"}, "edited": false, "score": 0, "creation_date": 1568951672, "post_id": 58000737, "comment_id": 102446095, "body": "Sorry, my project was prepared basis VBA only hence the pivot and power query wasn&#39;t the first option to achieve this. Appreciate your help in this."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1568840887, "creation_date": 1568840887, "answer_id": 58000737, "question_id": 57999390, "link": "https://stackoverflow.com/questions/57999390/remove-duplicates-and-get-the-count-based-on-2-sub-criteria-in-vba/58000737#58000737", "title": "Remove duplicates and get the count based on 2 sub criteria in VBA", "body": "<p>Another approach would be to use Power Query, available in Excel 2010+.</p>\n\n<p>Just select to do Group By \\ Selection &amp; Date \\ Count rows</p>\n\n<p><a href=\"https://i.stack.imgur.com/qJ6OR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qJ6OR.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>M-Code</strong></p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Date\", type date}}),\n    #\"Grouped Rows\" = Table.Group(#\"Changed Type\", {\"Selection\", \"Date\"}, {{\"Count\", each Table.RowCount(_), type number}})\nin\n    #\"Grouped Rows\"\n</code></pre>\n\n<p><strong>Source Data</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/CTnEK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CTnEK.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Results</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/csjNz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/csjNz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 29, "user_id": 8509714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfca5f898149f17e5e38e5f9447f5892?s=128&d=identicon&r=PG&f=1", "display_name": "anishmbait", "link": "https://stackoverflow.com/users/8509714/anishmbait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 58000737, "answer_count": 1, "score": 0, "last_activity_date": 1568840887, "creation_date": 1568833803, "last_edit_date": 1568833891, "question_id": 57999390, "link": "https://stackoverflow.com/questions/57999390/remove-duplicates-and-get-the-count-based-on-2-sub-criteria-in-vba", "title": "Remove duplicates and get the count based on 2 sub criteria in VBA", "body": "<p>I appreciate if you can take a look at the below code and help me further as I'm stuck badly. below code helps me get the unique list of names from the Selection and their respective count. This code uses the \"Scripting.Dictionary\". However there is 1 more additional header, that is the \"Date\"; so the desired output would be based on the Date as well as showing in the picture. I have tried everything I could, but failed.</p>\n\n<p>My Current Output based on the code</p>\n\n<p><a href=\"https://i.stack.imgur.com/zofes.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zofes.png\" alt=\"My Current Output based on the code\"></a></p>\n\n<pre><code>    Sub vbacodechecker()\n\nDim d As Object, rng As Range, tmp As String\nSet d = CreateObject(\"Scripting.dictionary\")\n\n    For Each rng In Selection\n        tmp = Trim(rng.Value)\n            If Len(tmp) &gt; 0 Then d(tmp) = d(tmp) + 1\n    Next rng\n\nRange(\"B1\").Select\n\n    For Each k In d.keys\n        ActiveCell.Offset(i + 1, 1).Value = k\n        ActiveCell.Offset(i + 1, 2).Value = d(k)\n\n    i = i + 1\n    Next k\nEnd Sub\n</code></pre>\n\n<p>Desired Output, names unique date wise</p>\n\n<p>[<img src=\"https://i.stack.imgur.com/1Fwrz.png\" alt=\"Desired Output, names unique date wise\"><a href=\"https://i.stack.imgur.com/1Fwrz.png\" rel=\"nofollow noreferrer\">2</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568833939, "post_id": 57999378, "comment_id": 102404683, "body": "Because it&#39;s <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivotfilters.add\" rel=\"nofollow noreferrer\"><code>PivotFilters.Add</code></a> or <code>.Add2</code> and <code>ExtDue</code> is a <code>PivotField</code>."}, {"owner": {"reputation": 29, "user_id": 11908211, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jzS5s4t0LVw/AAAAAAAAAAI/AAAAAAAAADg/r51ornc-2Iw/photo.jpg?sz=128", "display_name": "KN1GHTS", "link": "https://stackoverflow.com/users/11908211/kn1ghts"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568834199, "post_id": 57999378, "comment_id": 102404799, "body": "that did it, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1568834403, "creation_date": 1568834403, "answer_id": 57999504, "question_id": 57999378, "link": "https://stackoverflow.com/questions/57999378/vba-updating-dates-in-pivot-tables/57999504#57999504", "title": "VBA Updating Dates in Pivot Tables", "body": "<p><code>ExtDue</code> is a <code>PivotField</code>. The error message is straightfoward: there is no <code>Add</code> or <code>Add2</code> method for a <code>PivotField</code>. You're looking for <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivotfilters.add\" rel=\"nofollow noreferrer\"><code>PivotFilters.Add</code></a> or the similar <code>.Add2</code>.</p>\n\n<pre><code>ExtDue.PivotFilters.Add2 Type:=xlDateBetween, Value1:=StartDate, Value2:=EndDate\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11908211, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jzS5s4t0LVw/AAAAAAAAAAI/AAAAAAAAADg/r51ornc-2Iw/photo.jpg?sz=128", "display_name": "KN1GHTS", "link": "https://stackoverflow.com/users/11908211/kn1ghts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 57999504, "answer_count": 1, "score": 0, "last_activity_date": 1568834403, "creation_date": 1568833705, "question_id": 57999378, "link": "https://stackoverflow.com/questions/57999378/vba-updating-dates-in-pivot-tables", "title": "VBA Updating Dates in Pivot Tables", "body": "<p>I currently have a workbook with raw data that is converted to pivot tables for analysis. This data needs to be truncated down to specific date ranges. I am attempting to semi-automate the update as some sheets are hidden but keep getting an error</p>\n\n<hr>\n\n<pre><code>Dim PVTCombo As Worksheet, PVTFull As Worksheet, PVTOnly As Worksheet\nDim ExtDue As PivotField, Table1 As PivotTable\nDim StartDate As String, EndDate As String\n\nSet PVTCombo = ThisWorkbook.Sheets(\"PVT - Combined\")\nSet Table1 = PVTCombo.PivotTables(\"PivotTable1\")\nSet ExtDue = Table1.PivotFields(\"External Due\")\n\nStartDate = InputBox(\"Please input start date mm/dd/yyyy\", \"Start Date\")\nEndDate = InputBox(\"Please input end date mm/dd/yyyy\", \"End Date\")\n\nExtDue.ClearAllFilters\nExtDue.Add2 Type:=xlDateBetween, Value1:=StartDate, Value2:=EndDate\n\nThisWorkbook.RefreshAll\nCalculate\n</code></pre>\n\n<hr>\n\n<p>I receive the following error for line 10\n\"Object doesn't support this property or method\"</p>\n\n<p>I have tried <strong><em>.Add</em></strong> , <strong><em>.Add2</em></strong> , and using <strong><em>FilterType</em></strong> vs <strong><em>Type</em></strong>\nI have also tried hard-coding Value1 and Value2 instead of the input variables</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 4, "creation_date": 1568833339, "post_id": 57999277, "comment_id": 102404426, "body": "Please <a href=\"https://stackoverflow.com/posts/57999277/edit\">edit your question</a> to include your code as text"}, {"owner": {"reputation": 1, "user_id": 12086825, "user_type": "registered", "profile_image": "https://graph.facebook.com/931574243844239/picture?type=large", "display_name": "Jodie Daniels", "link": "https://stackoverflow.com/users/12086825/jodie-daniels"}, "edited": false, "score": 0, "creation_date": 1568834521, "post_id": 57999277, "comment_id": 102404907, "body": "Edited the question"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568834741, "post_id": 57999277, "comment_id": 102404992, "body": "You probably should get rid of the <code>exitHandler</code> and <code>Application.EnableEvents = True</code>, and then the duplicate <code>Application.EnableEvents = True</code> (2nd from the end)."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 3, "creation_date": 1568834848, "post_id": 57999277, "comment_id": 102405025, "body": "<code>On Error Resume Next</code> Is almost never a good thing to have in your code."}, {"owner": {"reputation": 1, "user_id": 12086825, "user_type": "registered", "profile_image": "https://graph.facebook.com/931574243844239/picture?type=large", "display_name": "Jodie Daniels", "link": "https://stackoverflow.com/users/12086825/jodie-daniels"}, "edited": false, "score": 0, "creation_date": 1568835124, "post_id": 57999277, "comment_id": 102405139, "body": "Hi this has not worked and has also caused the 1st VBA to no longer work"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 2, "creation_date": 1568835488, "post_id": 57999277, "comment_id": 102405268, "body": "@JodieDaniels Your code won&#39;t even run in its current state. The only reason it was working was because you had <code>On Error Resume Next</code> which does nothing but mask the issue, so it worked for the first chunk but just threw up errors, which it then ignored, until it hit the end sub."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1568835727, "post_id": 57999277, "comment_id": 102405366, "body": "You cannot use <code>application.undo</code> in the middle of a sub. It needs to be the first line. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.undo\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.application.un&zwnj;&#8203;do</a>."}, {"owner": {"reputation": 1, "user_id": 12086825, "user_type": "registered", "profile_image": "https://graph.facebook.com/931574243844239/picture?type=large", "display_name": "Jodie Daniels", "link": "https://stackoverflow.com/users/12086825/jodie-daniels"}, "edited": false, "score": 0, "creation_date": 1568837100, "post_id": 57999277, "comment_id": 102405896, "body": "Thank you for clarifying, I am completely new to this and i simply used a tutorial which supplied the code, would anyone be able to assist in writing the correct code?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568908612, "post_id": 57999277, "comment_id": 102433678, "body": "Possibly, though I&#39;m not entirely sure what you are trying to do in the second half."}], "owner": {"reputation": 1, "user_id": 12086825, "user_type": "registered", "profile_image": "https://graph.facebook.com/931574243844239/picture?type=large", "display_name": "Jodie Daniels", "link": "https://stackoverflow.com/users/12086825/jodie-daniels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568834496, "creation_date": 1568833281, "last_edit_date": 1568834496, "question_id": 57999277, "link": "https://stackoverflow.com/questions/57999277/why-is-my-second-vba-on-my-sheet-not-working", "title": "Why is my second VBA on my sheet not working", "body": "<p>I have a VBA for another reason already in my sheet, however i want a VBA on the same sheet that now allows me to select multiple options on a drop down, please tell me why this does not work? I simply want column 20 to be the area that the 2nd VBA works on</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\nIf Target.Column = 1 Then\n  If Target.Validation.Type = 3 Then\n   Application.EnableEvents = False\n   Target.Offset(0, 1).ClearContents\n  End If\nEnd If\n\nexitHandler:\n  Application.EnableEvents = True\n\nDim Newvalue As String\n\nOn Error GoTo Exitsub\nIf Target.Column = 20 Then\n    If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n    GoTo Exitsub\n    Else: If Target.Value = \"\" Then GoTo Exitsub Else\n        Application.EnableEvents = False\n        Newvalue = Target.Value\n        Application.Undo\n        Oldvalue = Target.Value\n        If Oldvalue = \"\" Then\n            Target.Value = Newvalue\n        Else\n            Target.Value = Oldvalue &amp; \", \" &amp; Newvalue\n        End If\n    End If\nEnd If\nApplication.EnableEvents = True\nExitsub:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "criteria", "sumifs"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568834323, "post_id": 57998995, "comment_id": 102404837, "body": "The result should be captured into a <code>Variant</code> to prevent a <i>type mismatch</i> upon assignment of <code>D</code> if any of the values involved is a worksheet error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568834585, "post_id": 57998995, "comment_id": 102404927, "body": "@MathieuGuindon added."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1568835113, "last_edit_date": 1568835113, "creation_date": 1568831915, "answer_id": 57998995, "question_id": 57998910, "link": "https://stackoverflow.com/questions/57998910/vba-using-sumifs-with-more-criteria/57998995#57998995", "title": "VBA using SUMIFS with more criteria", "body": "<p>These will need to be late bound so use <code>Application.</code> instead of <code>WorksheetFormula</code>:</p>\n\n<p>As per <a href=\"https://stackoverflow.com/questions/57998910/vba-using-sumifs-with-more-criteria/57998995?noredirect=1#comment102404837_57998995\">@MathieuGuindon</a>:</p>\n\n<blockquote>\n  <p>The result should be captured into a Variant to prevent a type mismatch upon assignment of D if any of the values involved is a worksheet error.</p>\n</blockquote>\n\n<pre><code>Dim D As Variant\n\nD = Application.Sum(Application.SumIfs(Range(\"D2:D2000\"), _\nRange(\"A2:A2000\"), Array(\"\u00c5rhus\", \"K\u00f8benhavn\")))\nIf IsNumeric(D) Then MsgBox D\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 12086704, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5IfADSIKUVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reoe3SzAqWPP2Dhxsf2K_q0_6Npww/photo.jpg?sz=128", "display_name": "Mathias Eriksen", "link": "https://stackoverflow.com/users/12086704/mathias-eriksen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 57998995, "answer_count": 1, "score": 1, "last_activity_date": 1568835113, "creation_date": 1568831525, "last_edit_date": 1568831545, "question_id": 57998910, "link": "https://stackoverflow.com/questions/57998910/vba-using-sumifs-with-more-criteria", "title": "VBA using SUMIFS with more criteria", "body": "<p>I have a problem with using the SUMIFS in VBA. The thing is I need to use SUMIFS to sum 1+ cities in my dataset.</p>\n\n<p>I have tried to google and use STackoverflow and found 2 anwers where I tried both, but none of them workd. One of them was:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42931598/vba-sumifs-with-or\">VBA - SumIfs with Or</a></p>\n\n<pre><code>Dim D As Double\n\nD = WorksheetFunction.Sum(WorksheetFunction.SumIfs(Range(\"D2:D2000\"), _\nRange(\"A2:A2000\"), Array(\"\u00c5rhus\", \"K\u00f8benhavn\")))\nMsgBox D\n</code></pre>\n\n<p>I expect a numeriacal result, but I get the result \"Run-time error '13': Type mismatch\"</p>\n"}, {"tags": ["excel", "vba", "selenium", "webdriver", "bots"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1568831327, "post_id": 57998811, "comment_id": 102403579, "body": "it sounds like you are asking how to get a handle on a non automated browser session with selenium - I don&#39;t think you can. I assume you tried the inbuilt .Refresh method?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568831636, "post_id": 57998811, "comment_id": 102403705, "body": "So you are trying to bypass a &quot;prove you are not a bot&quot; system so that you can use a bot? That&#39;s not possible. That&#39;s why those systems are implemented, to prevent people from creating automated systems like you are trying to do."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1568833255, "post_id": 57998811, "comment_id": 102404380, "body": "Use a REST API if there&#39;s one. What you&#39;re doing is very likely against the ToS of the website you&#39;re hitting, and can get you IP-banned."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1568840253, "post_id": 57999013, "comment_id": 102407042, "body": "Not sure that is correct syntax for vba where (not tested) I think you may just be able to do driver.refresh.... also, you can connect to an existing session if that session was launched with selenium (basic)"}], "tags": [], "owner": {"reputation": 2178, "user_id": 1387701, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f5209b17c9efa573f90ab04d476c0936?s=128&d=identicon&r=PG", "display_name": "DMart", "link": "https://stackoverflow.com/users/1387701/dmart"}, "is_accepted": false, "score": 0, "last_activity_date": 1568832015, "creation_date": 1568832015, "answer_id": 57999013, "question_id": 57998811, "link": "https://stackoverflow.com/questions/57998811/vba-selenium-refresh-the-page-to-prove-you-are-not-a-bot/57999013#57999013", "title": "VBA Selenium - Refresh the page to prove you are not a bot", "body": "<p>This will refresh the page:</p>\n\n<pre><code>obj.Navigate().Refresh()\n</code></pre>\n\n<p>But that said, i'm not sure if a refresh will accomplish what you think it will.</p>\n\n<blockquote>\n  <p>I have the feeling that if I open and interact with the website\n  through an existing open browser, the website will not recognize me as\n  a bot.</p>\n</blockquote>\n\n<p>Selenium doesn't \"reuse\" a browser session that you already have open on your computer.</p>\n\n<p>I think you'd have to interact with the OS itself to control the browser.</p>\n"}], "owner": {"reputation": 1, "user_id": 12066640, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aqCRpSAO340/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewdR8kW06sPViQZj4io26gZYFsaQ/photo.jpg?sz=128", "display_name": "Nas", "link": "https://stackoverflow.com/users/12066640/nas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 830, "favorite_count": 0, "closed_date": 1568837540, "answer_count": 1, "score": -1, "last_activity_date": 1568837640, "creation_date": 1568831084, "last_edit_date": 1568831505, "question_id": 57998811, "link": "https://stackoverflow.com/questions/57998811/vba-selenium-refresh-the-page-to-prove-you-are-not-a-bot", "closed_reason": "Duplicate", "title": "VBA Selenium - Refresh the page to prove you are not a bot", "body": "<p>I want my program in VBA to login on a website with chrome webdriver (with selenium) and perform some actions. Unfortunately the website asks me to prove I'm not a bot by refreshing the webpage after login. The problem is that even when I do so manually on the webdriver (to test), it doesn't work and the website won't let me move forward.</p>\n\n<p>I have the feeling that if I open and interact with the website through an existing open browser, the website will not recognize me as a bot. But i cannot manage to do it. I am open to any other solution.</p>\n\n<p>This is how my code starts:</p>\n\n<pre><code>Sub testchrome()\n   Dim obj As New WebDriver\n   Dim Keys As New Keys\n\n   obj.Start \"chrome\"\n   obj.Get \"https://freebitcoin.io\"\nEnd Sub\n</code></pre>\n\n<p>And then I just perform my business (login etc.).</p>\n\n<p>I would be so grateful if you have any idea not to be detected as a bot or manage to pass this verification step. Thank you very much for your help.</p>\n"}, {"tags": ["python", "excel", "vba", "win32com"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1568833203, "post_id": 57998382, "comment_id": 102404348, "body": "Have you tried something like <code>xl = win32com.client.GetObject(&quot;Name_Of_Workbook&quot;) </code> This should let you get the open instance of the workbook in question. <a href=\"https://stackoverflow.com/questions/2876755/get-name-of-active-excel-workbook-from-python\" title=\"get name of active excel workbook from python\">stackoverflow.com/questions/2876755/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12097193, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d2dab7e4b54e8f039e3b30eb3d4bb702?s=128&d=identicon&r=PG", "display_name": "qwcbn", "link": "https://stackoverflow.com/users/12097193/qwcbn"}, "is_accepted": false, "score": -1, "last_activity_date": 1569010572, "last_edit_date": 1569010572, "creation_date": 1569007013, "answer_id": 58034046, "question_id": 57998382, "link": "https://stackoverflow.com/questions/57998382/call-vba-function-from-python-in-already-open-excel-file/58034046#58034046", "title": "call vba function from python in already open excel file", "body": "<pre class=\"lang-py prettyprint-override\"><code>xl.Application.Run(r\"'DAILY PL ESTIMATE W NRPD RV2 v6_YK_v2.xlsm'!Module2.CopySummaryData\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4504466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dbc567003db30e777b1fd5c5b87c2d8?s=128&d=identicon&r=PG&f=1", "display_name": "Urvashi Biyani", "link": "https://stackoverflow.com/users/4504466/urvashi-biyani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1569010572, "creation_date": 1568829329, "last_edit_date": 1568829373, "question_id": 57998382, "link": "https://stackoverflow.com/questions/57998382/call-vba-function-from-python-in-already-open-excel-file", "title": "call vba function from python in already open excel file", "body": "<p>I am trying to run vba macro from Python but the excel file which has macro is already open. So I want to not open it again as another instance.</p>\n\n<p>I have tried win32com code - however it reopens another instance of the same file and makes changes in that instance and ask me to save as second excel file. But i want to call macro in already open file. and after calling that macro leave the excel file open. \nthis is the path where File is located - its a private shared drive </p>\n\n<p>\\nplofnp0001a\\gtonnnfs10912400\\CPM Other\\PL Estimate\\PL Estimate Sheets\\DAILY PL ESTIMATE W NRPD RV2 v6_YK_v2.xlsm</p>\n\n<pre><code>folder_xlfile = '\\\\\\\\nplofnp0001a\\gtonnnfs10912400\\CPM Other\\PL Estimate\\PL Estimate Sheets'\nxlfile = '\\\\DAILY PL ESTIMATE W NRPD RV2 v6_YK_v2.xlsm'\n\nFilename=folder_xlfile + xlfile\n\nimport win32com.client\n\nxl=win32com.client.DispatchEx(\"Excel.Application\")\n#wb = xl.Workbooks.Open(Filename)\nxl.Application.Run(Filename + \"!Module2.CopySummaryData\")\n#xl.Application.Quit()\ndel xl\n</code></pre>\n\n<p>Expected Result - run vba function in already open excelfile.</p>\n\n<p>Actual Result - just keeps running without error message. I guess code hangs.</p>\n"}, {"tags": ["excel", "vba", "excel-charts"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1568828267, "post_id": 57998115, "comment_id": 102402354, "body": "<code>AxisTitle</code> doesn&#39;t have an <code>Axes</code> property.  Try commenting out that <code>With</code>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1568828393, "creation_date": 1568828393, "answer_id": 57998158, "question_id": 57998115, "link": "https://stackoverflow.com/questions/57998115/excel-macro-code-to-change-the-axis-title-and-its-font-size-font-type/57998158#57998158", "title": "Excel macro code to change the axis title and its font size, font type", "body": "<p>You want something more like this:</p>\n\n<pre><code>With .Axes(xlCategory)\n    .HasTitle = True\n    .AxisTitle.Text = \"Position(nm)\"  'X-axis title\n    .TickLabels.Font.Size = 10 'X-axis coordinate number size\n    .AxisTitle.Font.Size = 14  'X-axis title word font size\n    .TickMarkSpacing = 3\n    .TickLabelSpacing = 5\n    '....\n    '....\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 4740702, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40d55fd0ed031bd42979c5a06cabcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "together", "link": "https://stackoverflow.com/users/4740702/together"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568874866, "creation_date": 1568828201, "last_edit_date": 1568874866, "question_id": 57998115, "link": "https://stackoverflow.com/questions/57998115/excel-macro-code-to-change-the-axis-title-and-its-font-size-font-type", "title": "Excel macro code to change the axis title and its font size, font type", "body": "<p>TRY TO USE Excel macro code to change the axis title and its font size, font type </p>\n\n<p>get wrong message: \"object does not support this property or method\" need expert give me suggestions or solution, thanks !</p>\n\n<pre><code>.Axes(xlCategory).HasTitle = True\n\n With .Axes(xlCategory).AxisTitle\n\n.Axes(xlCategory).AxisTitle.Text = \"Position(nm)\"  'X-axis title\n\n.Axes(xlCategory).TickLabels.Font.Size = 10 'X-axis coordinate number size\n\n.Axes(xlCategory).AxisTitle.Font.Size = 14  'X-axis title word font size\n\n.Axes(xlCategory).TickMarkSpacing = 3\n\n.Axes(xlCategory).TickLabelSpacing = 5\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "edited": false, "score": 1, "creation_date": 1568828304, "post_id": 57998068, "comment_id": 102402363, "body": "Thank you, that fixed my issue. It&#39;s returning the results I expected now and confirms the code is working."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 2, "last_activity_date": 1568827975, "creation_date": 1568827975, "answer_id": 57998068, "question_id": 57997897, "link": "https://stackoverflow.com/questions/57997897/why-is-this-loop-returning-duplicate-results/57998068#57998068", "title": "Why is this loop returning duplicate results?", "body": "<p>The <code>Debug.Print</code> expression is <strong>outside</strong> of the <code>If</code> statement, therefore, it will print a value for <em>every</em> iteration of the <code>Do</code> loop, always printing the last value held by <code>TestStr</code>.</p>\n\n<p>I would suggest changing the content of the loop to:</p>\n\n<pre><code>Do Until strFile = \"\"\n    If IsNull(DLookup(\"[Invoice#]\", \"qry_InvPDFList\", \"[Invoice#] = '\" &amp; Mid(strFile, 12, 6) &amp; \"'\")) Then\n        TestStr = strPath &amp; strFile\n        Debug.Print TestStr\n    End If\n    strFile = Dir\nLoop\n</code></pre>\n\n<hr>\n\n<p>You also have <code>EndSub</code> instead of <code>End Sub</code>.</p>\n"}], "owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57998068, "answer_count": 1, "score": 0, "last_activity_date": 1594449308, "creation_date": 1568827162, "last_edit_date": 1594449308, "question_id": 57997897, "link": "https://stackoverflow.com/questions/57997897/why-is-this-loop-returning-duplicate-results", "title": "Why is this loop returning duplicate results?", "body": "<p>I am creating some code to loop through the files in a folder and delete the ones that aren't in a query based on the invoice number in the filename. It's based on the code I found <a href=\"http://codevba.com/office/loop_files_in_folder.htm#.XYJFJeRYaUk\" rel=\"nofollow noreferrer\">here</a>. The problem is that when I use Debug.Print to see the results it's returning several duplicates and doesn't return all of the files that are not in the query.</p>\n\n<pre><code>Sub DeleteInvoices()\n\nDim strFile As String\nDim strPath As String\nDim TestStr As String\n\n    strPath = \"E:\\groups\\folder\\folder2\\\"\n    strFile = Dir(\"E:\\groups\\folder\\folder2\\*\")\n    Do While Len(strFile) &gt; 0\n    If IsNull(DLookup(\"[qry_InvPDFList]![Invoice#]\", \"qry_InvPDFList\", \"[qry_InvPDFList]![Invoice#] = \" &amp; QUOTE &amp; Mid(strFile, 12, 6) &amp; QUOTE)) Then\n            TestStr = strPath &amp; strFile\n            End If\n            Debug.Print TestStr\n            strFile = Dir\n\n         Loop\n EndSub\n</code></pre>\n\n<p>I am expecting it to return 50+ unique filenames without duplicates. </p>\n\n<p>Why is this code returning duplicates?</p>\n"}, {"tags": ["vba", "ms-access", "lookup", "recordset"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568826552, "post_id": 57997442, "comment_id": 102401715, "body": "What have you tried so far?"}, {"owner": {"reputation": 1, "user_id": 12086310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158811728752589/picture?type=large", "display_name": "Aaron Anderson", "link": "https://stackoverflow.com/users/12086310/aaron-anderson"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568828057, "post_id": 57997442, "comment_id": 102402279, "body": "Private Sub OpenRecordset()  Dim i As Integer Dim db As Database Dim rs As Recordset          Set db = CurrentDb     Set rs = db.OpenRecordset(&quot;tblimport&quot;)          Do Until Cusip Is Null                Loop"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1568828251, "post_id": 57997442, "comment_id": 102402346, "body": "What is <code>cusip</code>?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568828511, "post_id": 57997442, "comment_id": 102402434, "body": "That&#39;s not really an attempt... It&#39;s a bunch of declarations and a loop that won&#39;t work. <a href=\"https://stackoverflow.com/questions/5864160/code-to-loop-through-all-records-in-ms-access\" title=\"code to loop through all records in ms access\">stackoverflow.com/questions/5864160/&hellip;</a> This will get you started."}, {"owner": {"reputation": 1, "user_id": 12086310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158811728752589/picture?type=large", "display_name": "Aaron Anderson", "link": "https://stackoverflow.com/users/12086310/aaron-anderson"}, "edited": false, "score": 0, "creation_date": 1568828635, "post_id": 57997442, "comment_id": 102402492, "body": "Am new to VBA. But what am trying to do is import a table. Then upload to SharePoint. However, I only need about 5 fields from the table and then I need to add another column called Processor that pulls in based on the user doing the upload. I was able to create the VBA to import the table. I know how to append to the SharePoint list table. I have 2 issues 1. table pulls in a bunch of blank records that I don&#39;t need.  2. I need an additional column added based on User who is doing the upload."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12086310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158811728752589/picture?type=large", "display_name": "Aaron Anderson", "link": "https://stackoverflow.com/users/12086310/aaron-anderson"}, "edited": false, "score": 0, "creation_date": 1568829242, "post_id": 57998199, "comment_id": 102402725, "body": "The data within the loop I want to create a table that I can append to a linked sharepoint list table. Here is the query I have to append the tables. I will need to add the new column once I am able to create it.  INSERT INTO [CMO Tracking LOCAL] ( [Receive Date], [Product Type], Cusip, [Redemption Date], [Publication Date], [Total Amount Called] ) SELECT Date(), [CDO/SFS], Cusip, [RED# DATE], [PUB# DATE], [PRINCIPAL PAYMENT] FROM tblimport WHERE cusip is not null and cusip &lt;&gt; &quot;&quot;;"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1568828563, "creation_date": 1568828563, "answer_id": 57998199, "question_id": 57997442, "link": "https://stackoverflow.com/questions/57997442/how-to-iterate-through-a-recordset-and-do-a-lookup/57998199#57998199", "title": "How to iterate through a recordset and do a lookup", "body": "<p>You can iterate over a recordset which already includes the actual name by opening a recordset for a SQL statement such as:</p>\n\n<pre><code>select * from tblImport inner join tblUser on tblImport.UserID = tblUser.ID\n</code></pre>\n\n<p>The code might look something like:</p>\n\n<pre><code>Sub MySub()\n    Dim dbs As DAO.Database\n    Dim rst As DAO.Recordset\n    Dim flg As Boolean\n\n    Set dbs = CurrentDb\n    Set rst = dbs.OpenRecordset(\"select * from tblImport inner join tblUser on tblImport.UserID = tblUser.ID\")\n\n    With rst\n        If Not .EOF Then\n            .MoveFirst\n            Do Until .EOF Or flg ' No short-circuit evaluation in VBA\n                flg = IsNull(!Cusip)\n                .MoveNext\n            Loop\n        End If\n        .Close\n    End With\n    Set rst = Nothing\n    Set dbs = Nothing\nEnd Sub\n</code></pre>\n\n<p>You'll need to change the field &amp; table names to suit your data.</p>\n\n<p>You haven't stated what you actually want to do with the data within the loop.</p>\n"}], "owner": {"reputation": 1, "user_id": 12086310, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158811728752589/picture?type=large", "display_name": "Aaron Anderson", "link": "https://stackoverflow.com/users/12086310/aaron-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594449320, "creation_date": 1568825254, "last_edit_date": 1594449320, "question_id": 57997442, "link": "https://stackoverflow.com/questions/57997442/how-to-iterate-through-a-recordset-and-do-a-lookup", "title": "How to iterate through a recordset and do a lookup", "body": "<p>I need to iterate through a record set but when it gets to a user name field I want to do a lookup to a user ID table to pull in the actual name. Then end loop when cusip column is null?</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "edited": false, "score": 0, "creation_date": 1568825671, "post_id": 57997312, "comment_id": 102401396, "body": "Hello thank you for the reply! This seems like a possible route to explore. How would I specify the target cells based on the column header name?"}], "tags": [], "owner": {"reputation": 358, "user_id": 8968380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210519382481880/picture?type=large", "display_name": "Courtney Foster", "link": "https://stackoverflow.com/users/8968380/courtney-foster"}, "is_accepted": true, "score": 0, "last_activity_date": 1568824761, "creation_date": 1568824761, "answer_id": 57997312, "question_id": 57997016, "link": "https://stackoverflow.com/questions/57997016/excel-vba-match-header-name-on-different-workbook-and-copy-column-to-master-work/57997312#57997312", "title": "Excel VBA Match Header Name on Different Workbook and Copy Column to Master Workbook", "body": "<p>Personally, I would avoid using the copy method altogether.  It's ridiculously slow because it will copy formatting as well.  If you don't need the formatting copied, then I'd just equate the cells directly:</p>\n\n<p>TargetSheet.cell.value = SourceSheet.cell.value</p>\n\n<p>This is typically much faster than using the .copy method.</p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 57997312, "answer_count": 1, "score": 0, "last_activity_date": 1568872426, "creation_date": 1568823513, "last_edit_date": 1568872426, "question_id": 57997016, "link": "https://stackoverflow.com/questions/57997016/excel-vba-match-header-name-on-different-workbook-and-copy-column-to-master-work", "title": "Excel VBA Match Header Name on Different Workbook and Copy Column to Master Workbook", "body": "<p>I would like to run a macro that finds columns based on the header strings in a Source Workbook, copies the visible rows below the header, and pastes into a different Master workbook in a specified column location.</p>\n\n<p>There are about 5 specific columns I need to copy data from, for example \"Part Name\", \"Part Number\", \"Vendor\", ect. I need to use string values because where I am pasting the values on the master workbook has different headers. \"Part Number\" on the source workbook might translate to \"Part #\" on the Master workbook.</p>\n\n<p>I have tried the code below, and it works but it is very slow, and this is just for 1 column.</p>\n\n<p>Any ideas how to clean up this code and make it run more smoothly and quickly?</p>\n\n<p>Thanks! </p>\n\n<p>I have tried calling an Optimize function that turns of screen updating, automatic calculations, ect. </p>\n\n<pre><code>Sub Import()\n\nCall Optimize\n\nDim source As String Dim dest As String\n\n'Clears the Table Call CleanTheTable\n\nsource = Worksheets(\"Set-Up\").Range(\"B11\") '&lt;=== Source workbook based on cell value\n\ndest = Worksheets(\"Set-Up\").Range(\"B8\") '&lt;=== Destination workbook based on cell value\n\n'------------ Header Value to Look Up -------------     \n\nWorkbooks(source).Worksheets(\"Source Sheet\").Range(\"Table1[Value to Look Up]\").SpecialCells(xlCellTypeVisible).Copy _     Destination:=Workbooks(dest).Worksheets(\"INPUTS1\").Range(\"A2\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sftp"], "comments": [{"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 1, "creation_date": 1568833634, "post_id": 57996920, "comment_id": 102404549, "body": "See <a href=\"https://stackoverflow.com/q/35292681/850848\">PSCP file from Windows to Linux using private/public keys</a>."}, {"owner": {"reputation": 99, "user_id": 2871793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/866bc573a5ab685ebc1aa111bc3e5d98?s=128&d=identicon&r=PG&f=1", "display_name": "darossi", "link": "https://stackoverflow.com/users/2871793/darossi"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 1, "creation_date": 1568890165, "post_id": 57996920, "comment_id": 102422848, "body": "Thanks - that was a great help. Problems solved!"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1568980647, "post_id": 57996920, "comment_id": 102458077, "body": "Do not forget to upvote the question and answers that have helped you."}], "owner": {"reputation": 99, "user_id": 2871793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/866bc573a5ab685ebc1aa111bc3e5d98?s=128&d=identicon&r=PG&f=1", "display_name": "darossi", "link": "https://stackoverflow.com/users/2871793/darossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 1, "closed_date": 1568890311, "answer_count": 0, "score": 0, "last_activity_date": 1568823141, "creation_date": 1568823141, "question_id": 57996920, "link": "https://stackoverflow.com/questions/57996920/connect-to-sftp-directory-using-excel-vba-and-ppk-key-file", "closed_reason": "Duplicate", "title": "Connect to SFTP directory using Excel, VBA and .ppk key file?", "body": "<p>I'm trying to connect to an SFTP directory using VBA within Excel.  I would like to drop off and retrieve files from the directory. Currently I do this by dragging/dropping with Filezilla, but I'd like to see if I can achieve this using VBA so that users do not have to exit Excel and can send/retrieve files to/from the remote directory without having to leave Excel and go to Filezilla.</p>\n\n<p>I tried using some VBA with putty's PCSP.exe tool but had no joy. I tried to adapt the code below that I found elsewhere.</p>\n\n<pre><code>Public Sub SftpPut()\n    Const cstrSftp As String = \"\"\"U:\\putty\\pscp.exe\"\"\"\n    Dim strCommand As String\n    Dim pUser As String\n    Dim pPass As String\n    Dim pHost As String\n    Dim pFile As String\n    Dim pRemotePath As String\n\n    pUser = \"---\"\n    pPass = \"---\"\n    pHost = \"---\"\n    pFile = \"C:\\Access\\sample.txt\"\n    pRemotePath = \"/home\"\n\n    strCommand = cstrSftp &amp; \" -sftp -l \" &amp; pUser &amp; \" -pw \" &amp; pPass &amp; _\n        \" \" &amp; pFile &amp; \" \" &amp; pHost &amp; \":\" &amp; pRemotePath\n    Debug.Print strCommand\n    Shell strCommand, 1 ' vbNormalFocus '\nEnd Sub\n</code></pre>\n\n<p>When using Filezilla, I login with a User ID and a .ppk Key File, I can't see how to use the Key File with the above.</p>\n\n<p>Can anybody assist? Many Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1568821938, "post_id": 57996610, "comment_id": 102399748, "body": "This question may be better suited to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8886662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41bbd49c8b592e9594890304f9e8b63?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Coelho", "link": "https://stackoverflow.com/users/8886662/carlos-coelho"}, "edited": false, "score": 0, "creation_date": 1569507658, "post_id": 57997438, "comment_id": 102626714, "body": "Hello PeterT, thank you very much. I am learning VBA by myself from scratch and i found very usefull the link you shared. Thanks! Right now the code is returning another column than the one i want. I&#39;m trying to understand what is wrong. I found that the array has the last column (4) of the sheet steparea.  I&#39;m digging in to it to understand. Thanks a lot for sharing the link :)"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1568825247, "creation_date": 1568825247, "answer_id": 57997438, "question_id": 57996610, "link": "https://stackoverflow.com/questions/57996610/optimization-of-select-case-long-time-iteration-for-150k-lines-of-data/57997438#57997438", "title": "Optimization of Select Case - long time iteration for 150k+ lines of data", "body": "<p>Your key to speeding this up will be to use <a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">memory-based arrays</a>.</p>\n\n<pre><code>Option Explicit\n\nSub xx()\n    Dim mvinmvouWS As Worksheet\n    Set mvinmvouWS = ThisWorkbook.Sheets(\"MVIN_MVOU\")\n\n    '--- move all the data into a memory-based array\n    Dim lastRow As Long\n    Dim stepArea As Variant\n    Dim stepAreaRange As Range\n    Dim stepAreaWS As Worksheet\n    Set stepAreaWS = ThisWorkbook.Sheets(\"StepArea\")\n    lastRow = stepAreaWS.Cells(stepAreaWS.Rows.Count, 3).End(xlUp).Row\n    Set stepAreaRange = stepAreaWS.Range(\"C1\").Resize(lastRow, 2)\n    stepArea = stepAreaRange.Value\n\n    '--- move all the data into a memory-based array\n    Dim dataRange As Range\n    Dim data As Variant\n    lastRow = mvinmvouWS.Cells(mvinmvouWS.Rows.Count, 1).End(xlUp).Row\n    Set dataRange = mvinmvouWS.Range(\"A2\").Resize(lastRow, 13)\n    data = dataRange.Value\n    data(1, 13) = \"Process Layer\"\n\n    Dim i As Long\n    For i = LBound(data, 1) To UBound(data, 1)\n        Dim index As Long\n        index = FindInArray(stepArea, data(i, 6))\n        If index &lt;&gt; -1 Then\n            data(i, 13) = stepArea(index, 2)\n        End If\n    Next i\n\n    '--- now put the results back to the worksheet\n    dataRange.Value = data\n\nEnd Sub\n\nPrivate Function FindInArray(ByRef inArray As Variant, ByVal findWhat As Variant) As Long\n    Dim i As Long\n    FindInArray = -1\n    For i = LBound(inArray, 1) To UBound(inArray, 1)\n        If inArray(i, 1) = findWhat Then\n            FindInArray = i\n            Exit For\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8886662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41bbd49c8b592e9594890304f9e8b63?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Coelho", "link": "https://stackoverflow.com/users/8886662/carlos-coelho"}, "is_accepted": false, "score": 0, "last_activity_date": 1569513025, "creation_date": 1569513025, "answer_id": 58120507, "question_id": 57996610, "link": "https://stackoverflow.com/questions/57996610/optimization-of-select-case-long-time-iteration-for-150k-lines-of-data/58120507#58120507", "title": "Optimization of Select Case - long time iteration for 150k+ lines of data", "body": "<p>Ok, now it's working as i want it. Just changed a range and the place i want it to search in array.\nThank you a lot :)</p>\n\n<pre><code>Sub cola_process_layer_MVINMVOU()\n\nDim mvinmvouWS As Worksheet\nSet mvinmvouWS = ThisWorkbook.Sheets(\"MVIN_MVOU\")\nDim stepAreaWS As Worksheet\nSet stepAreaWS = ThisWorkbook.Sheets(\"StepArea\")\n\n'--- move all the data into a memory-based array\nDim lastRow As Long\nDim stepArea As Variant\nDim stepAreaRange As Range\n\nDim dataRange As Range\nDim data As Variant\n\nlastRow = stepAreaWS.Cells(stepAreaWS.Rows.Count, 2).End(xlUp).Row\nSet stepAreaRange = stepAreaWS.Range(\"A1\").Resize(lastRow, 4)\nstepArea = stepAreaRange.Value\n\n'--- move all the data into a memory-based array\n\nlastRow = mvinmvouWS.Cells(mvinmvouWS.Rows.Count, 1).End(xlUp).Row\nSet dataRange = mvinmvouWS.Range(\"A1\").Resize(lastRow, 13)\ndata = dataRange.Value\ndata(1, 13) = \"Process Layer\"\n\nDim i As Long\nFor i = LBound(data, 1) To UBound(data, 1)\n    Dim index As Long\n    index = FindInArray(stepArea, data(i, 12))\n    If index &lt;&gt; -1 Then\n        data(i, 13) = stepArea(index, 2)\n    End If\nNext i\n\n'--- now put the results back to the worksheet\ndataRange.Value = data\n\n\nEnd Sub\n\nPrivate Function FindInArray(ByRef inArray As Variant, ByVal findWhat As Variant) As Long\n    Dim i As Long\n    FindInArray = -1\n    For i = LBound(inArray, 1) To UBound(inArray, 1)\n        If inArray(i, 1) = findWhat Then\n            FindInArray = i\n            Exit For\n        End If\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8886662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41bbd49c8b592e9594890304f9e8b63?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Coelho", "link": "https://stackoverflow.com/users/8886662/carlos-coelho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57997438, "answer_count": 2, "score": 1, "last_activity_date": 1569513025, "creation_date": 1568821832, "last_edit_date": 1568874896, "question_id": 57996610, "link": "https://stackoverflow.com/questions/57996610/optimization-of-select-case-long-time-iteration-for-150k-lines-of-data", "title": "Optimization of Select Case - long time iteration for 150k+ lines of data", "body": "<p>I am doing some macros to automate some tasks and analyze data.\nOne of the things i noticed testing my programme was the time it takes to process all the data. I know that i have a large quantity of data but i wanted to know if there's something i can do with my code to increase the performance of my programme.\nRight now i have 150k+ lines of data and this process take ages. Is there something i can do with my code?</p>\n\n<pre><code>Option Explicit\n\nSub x() \n\n    Dim lin_ori As Variant\n\n    lin_ori = 2\n\n    Sheets(\"MVIN_MVOU\").Cells(1, 13) = \"Process Layer\"\n\n\n    Do While Sheets(\"MVIN_MVOU\").Cells(lin_ori, 1) &lt;&gt; \"\"\n\n         fnd = Application.Match(Worksheets(\"MVIN_MVOU\").Cells(lin_ori, 6), Worksheets(\"StepArea\").Columns(3), 0)\n\n       If Not IsError(fnd) Then      'a match was found\n\n            Sheets(\"MVIN_MVOU\").Cells(lin_ori, 13) = Sheets(\"StepArea\").Cells(fnd, 2)\n\n        End If\n\n    lin_ori = lin_ori + 1\n\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1568831222, "last_edit_date": 1568831222, "creation_date": 1568830562, "answer_id": 57998666, "question_id": 57996526, "link": "https://stackoverflow.com/questions/57996526/how-to-extract-url-using-vba-from-a-section-tag/57998666#57998666", "title": "How to extract URL using VBA from a section tag?", "body": "<p>Would help to see the actual code in addition to your description of it.</p>\n\n<p>You could start with attribute selectors to target elements with those attribute=value pairs and grab child a tags</p>\n\n<pre><code>Dim i As Long\nWith ie.document.querySelectorAll(\"[data-spec-code=PROROC] a, [data-spec-code=KROROC] a\")\n    For i = 0 To .Length - 1\n        Debug.Print .Item(i).href\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10068233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2838f44521ac02721092c344ac0bad1?s=128&d=identicon&r=PG&f=1", "display_name": "srn", "link": "https://stackoverflow.com/users/10068233/srn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57998666, "answer_count": 1, "score": 0, "last_activity_date": 1568831222, "creation_date": 1568821516, "last_edit_date": 1568830770, "question_id": 57996526, "link": "https://stackoverflow.com/questions/57996526/how-to-extract-url-using-vba-from-a-section-tag", "title": "How to extract URL using VBA from a section tag?", "body": "<p>I am looking for away to extract a specific type of URLs from HTML such as below:\nThe unique identifier here is the value under data-spec-code such as PROROC &amp; KROROC.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;section data-spec-code=\"PROROC\" only-child=\"\"&gt;\r\n    &lt;div class=\"test-class\"&gt;\r\n        &lt;div only-child=\"\" class=\" col-sm-4 col-md-3 col-lg-3 show-top-border hidden-xs tech-spec-title-container stack-0\"&gt;\r\n            &lt;div class=\"test-class-title\"&gt;\r\n                &lt;h5 class=\"top-offset-10 bottom-offset-0 force-bold-font\"&gt;&lt;span&gt;Data &lt;/span&gt;&lt;/h5&gt;\r\n\r\n            &lt;/div&gt;\r\n        &lt;/div&gt;\r\n        &lt;div only-child=\"\" class=\" col-sm-4 col-md-3 col-lg-3 show-top-border hidden-xs tech-spec-title-container stack-1\"&gt;\r\n            &lt;div class=\"test-class-title\"&gt;\r\n                &lt;!----&gt;&lt;em&gt;&amp;nbsp;&lt;span class=\"hidden\"&gt;Data &lt;/span&gt;&lt;/em&gt;\r\n          &lt;/div&gt;\r\n        &lt;/div&gt;\r\n        &lt;div only-child=\"\" class=\" col-sm-4 col-md-3 col-lg-3 show-top-border hidden-xs tech-spec-title-container stack-2\"&gt;\r\n            &lt;div class=\"test-class-title\"&gt;\r\n                &lt;!----&gt;&lt;em&gt;&amp;nbsp;&lt;span class=\"hidden\"&gt;Data &lt;/span&gt;&lt;/em&gt;\r\n                &lt;!----&gt;&lt;small class=\"help-me-choose-link helpmechoosestyle\"&gt;&lt;a href=\"//www.url-i-want-to-extract.com\" target=\"_blank\"&gt;URL 1&lt;/a&gt;&lt;/small&gt;&lt;/div&gt;\r\n        &lt;/div&gt;\r\n    &lt;/div&gt;\r\n&lt;/section&gt;\r\n&lt;section data-spec-code=\"KROROC\" only-child=\"\"&gt;\r\n    &lt;div class=\"test-class\"&gt;\r\n        &lt;div only-child=\"\" class=\" col-sm-4 col-md-3 col-lg-3 show-top-border hidden-xs tech-spec-title-container stack-0\"&gt;\r\n            &lt;div class=\"test-class-title\"&gt;\r\n                &lt;h5 class=\"top-offset-10 bottom-offset-0 force-bold-font\"&gt;&lt;span&gt;Data 2&lt;/span&gt;&lt;/h5&gt;\r\n            &lt;/div&gt;\r\n        &lt;/div&gt;\r\n        &lt;div only-child=\"\" class=\" col-sm-4 col-md-3 col-lg-3 show-top-border hidden-xs tech-spec-title-container stack-1\"&gt;\r\n            &lt;div class=\"test-class-title\"&gt;\r\n                &lt;!----&gt;&lt;em&gt;&amp;nbsp;&lt;span class=\"hidden\"&gt;Data 2&lt;/span&gt;&lt;/em&gt;\r\n            &lt;/div&gt;\r\n        &lt;/div&gt;\r\n        &lt;div only-child=\"\" class=\" col-sm-4 col-md-3 col-lg-3 show-top-border hidden-xs tech-spec-title-container stack-2\"&gt;\r\n            &lt;div class=\"test-class-title\"&gt;\r\n                &lt;!----&gt;&lt;em&gt;&amp;nbsp;&lt;span class=\"hidden\"&gt;Data 2&lt;/span&gt;&lt;/em&gt;\r\n                &lt;!----&gt;&lt;small class=\"help-me-choose-link helpmechoosestyle\"&gt;&lt;a href=\"//www.2nd-url-i-want-to-extract.com\" target=\"_blank\"&gt;URL 2&lt;/a&gt;&lt;/small&gt;&lt;/div&gt;\r\n        &lt;/div&gt;\r\n    &lt;/div&gt;\r\n&lt;/section&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have done a code based on research from stackoverflow and google but i could only extract all the links from the page or with getElementsBy. </p>\n\n<p>I wasn't able to use those options since the hyperlink is nested in another tag and the page has too many hyperlinks. I also tried querySelector but failed.</p>\n\n<p>I hope i could get some advice/guidance from you all on how to achieve this.</p>\n\n<p>Below is my expected result:</p>\n\n<p>PROROC www.url-i-want-to-extract.com</p>\n\n<p>KROROC www.2nd-url-i-want-to-extract.com</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3522, "user_id": 4964791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aVT1l.jpg?s=128&g=1", "display_name": "RamblinRose", "link": "https://stackoverflow.com/users/4964791/ramblinrose"}, "edited": false, "score": 0, "creation_date": 1568821669, "post_id": 57996509, "comment_id": 102399588, "body": "Break your code into smaller subroutines. <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/procedure-too-large\" rel=\"nofollow noreferrer\">See this</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 6, "creation_date": 1568821690, "post_id": 57996509, "comment_id": 102399605, "body": "You need to DRY out your code (DRY = <a href=\"https://en.wikipedia.org/wiki/Don&#39;t_repeat_yourself\" rel=\"nofollow noreferrer\">Don&#39;t Repeat Yourself</a>). There is no reason to have large number of lines which essentially do the same thing but to different cells. Why not use loops? Your sentence &quot;its a really large template and therefore I have massive amount of lines&quot; doesn&#39;t really make sense. Small code can operate on large spreadsheets."}, {"owner": {"reputation": 29, "user_id": 12074970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2a720444802b6f55c995e761a88d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/12074970/christian"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1568822108, "post_id": 57996509, "comment_id": 102399852, "body": "@JohnColeman I am new to VBA but Loop sounds very good. Can you give an example with my code of how it would look like?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568823137, "post_id": 57996509, "comment_id": 102400355, "body": "Rule of thumb: if your procedure has more than a dozen lines, it&#39;s very likely doing too many things."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568826853, "post_id": 57996509, "comment_id": 102401836, "body": "@MathieuGuindon - oops, I&#39;d have to re-write several of mine."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 4, "last_activity_date": 1568824671, "last_edit_date": 1568824671, "creation_date": 1568823267, "answer_id": 57996957, "question_id": 57996509, "link": "https://stackoverflow.com/questions/57996509/procedure-too-large-vba/57996957#57996957", "title": "Procedure too large VBA", "body": "<p>A couple of things you can do in your code:</p>\n\n<p>1) Use the fact that formulas can be set for ranges and not just individual cells:</p>\n\n<p>The four lines</p>\n\n<pre><code>CurrentSheet.Range(\"A8\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\nCurrentSheet.Range(\"A9\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\nCurrentSheet.Range(\"A10\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\nCurrentSheet.Range(\"A11\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\n</code></pre>\n\n<p>is equivalent to the single line:</p>\n\n<pre><code>CurrentSheet.Range(\"A8:A11\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\n</code></pre>\n\n<p>2) Use a loop. I don't quite see the logic of what you are doing, but something along the lines of the following might work:</p>\n\n<pre><code>Dim i As Long\nFor i = 8 To 128 Step 6\n    CurrentSheet.Range(CurrentSheet.Cells(i,1),CurrentSheet.Cells(i+5,1)).FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(???, 3).Address(True, True, xlR1C1, True)\nNext i\n</code></pre>\n\n<p>Where the step size and <code>???</code> is computed from your index according to the logic of your problem. Such loops can be tricky to set up just right, but are definitely worth it.</p>\n"}], "owner": {"reputation": 29, "user_id": 12074970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2a720444802b6f55c995e761a88d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/12074970/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57996957, "answer_count": 1, "score": 0, "last_activity_date": 1568824671, "creation_date": 1568821433, "last_edit_date": 1568821663, "question_id": 57996509, "link": "https://stackoverflow.com/questions/57996509/procedure-too-large-vba", "title": "Procedure too large VBA", "body": "<p>I finally finished my first code which is supposed to extract information from a selected document into a template. its a really large template and therefore I have massive amount of lines. I really hoped you could help me!</p>\n\n<pre><code>  Sub Test2()\n    ' Test2 Macro\n\n    Dim FileName As String\n    FileName = \"\"\n\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .Title = \"Select File\"\n        .Filters.Add \"Excel File\", \"*.xls?\"\n        .AllowMultiSelect = False\n\n        If .Show Then\n            FileName = .SelectedItems(1)\n        End If\n    End With\n    If Len(FileName) &lt; 4 Then Exit Sub 'No file selected\n\n    Dim TempWorkbook As Workbook, CurrentSheet As Worksheet\n    Set CurrentSheet = ActiveSheet 'Store the ActiveSheet, it will change\n    Set TempWorkbook = Workbooks.Open(FileName, ReadOnly:=True)\n\n    CurrentSheet.Range(\"A8\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\n    CurrentSheet.Range(\"A9\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\n    CurrentSheet.Range(\"A10\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\n    CurrentSheet.Range(\"A11\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(16, 3).Address(True, True, xlR1C1, True)\n\n\n   CurrentSheet.Range(\"A134\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(214, 3).Address(True, True, xlR1C1, True)\n    CurrentSheet.Range(\"A135\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(214, 3).Address(True, True, xlR1C1, True)\n    CurrentSheet.Range(\"A136\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(214, 3).Address(True, True, xlR1C1, True)\n    CurrentSheet.Range(\"A137\").FormulaR1C1 = \"=\" &amp; TempWorkbook.Worksheets(\"FINAL FORM\").Cells(214, 3).Address(True, True, xlR1C1, True)\n\n    TempWorkbook.Close SaveChanges:=False\n    Set TempWorkbook = Nothing\n    Set CurrentSheet = Nothing\n\n    End Sub\n</code></pre>\n\n<p>The above is the first and last section of the code. Ive been trying to split it up in multiple procedures, but that did not go well. I hoped someone could help with splitting it up?</p>\n\n<p>Best regards\nChristian</p>\n"}, {"tags": ["excel", "vba", "random", "range", "simulation"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1568820198, "post_id": 57996161, "comment_id": 102398726, "body": "<code>Range.Formula</code> needs a formula like you would input in Excel cells, take out the <code>.Formula</code> from your ranges and it will work allright."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568821833, "post_id": 57996161, "comment_id": 102399696, "body": "Watch out for <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit ActiveSheet references</a> - these unqualified <code>Range</code>, <code>Cells</code>, and <code>Columns</code> calls should be done against <code>oWS</code>."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 12085908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9e810d6530c245491387fc3f124035?s=128&d=identicon&r=PG&f=1", "display_name": "said", "link": "https://stackoverflow.com/users/12085908/said"}, "edited": false, "score": 1, "creation_date": 1568822296, "post_id": 57996596, "comment_id": 102399944, "body": "@said <code>Rnd</code> is a VBA function. Try Excel&#39;s <code>RAND</code> instead."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 1, "last_activity_date": 1568823055, "last_edit_date": 1568823055, "creation_date": 1568821794, "answer_id": 57996596, "question_id": 57996161, "link": "https://stackoverflow.com/questions/57996161/getting-error-message-from-range-formula-function/57996596#57996596", "title": "Getting error message from range.formula function", "body": "<p>Try</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Range(Cells(1, 1), Cells(iSize, 1)).Formula = \"=NormInv(Rand(), \" &amp; pMean &amp; \" , \" &amp; pSD &amp; \")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1568822240, "creation_date": 1568822240, "answer_id": 57996714, "question_id": 57996161, "link": "https://stackoverflow.com/questions/57996161/getting-error-message-from-range-formula-function/57996714#57996714", "title": "Getting error message from range.formula function", "body": "<p>If you type <code>=Application.WorksheetFunction.NormInv(Rnd(), 10, 0.2)</code> in a worksheet cell, you'll get the exact same <code>#NAME?</code> error, because Excel doesn't know about any <code>Application.WorksheetFunction.NormInv</code> function.</p>\n\n<p>Excel isn't VBA, VBA isn't Excel - VBA is <em>hosted</em> in Excel, and your VBA project <em>references</em> Excel's type library, which defines things like <code>Application</code>, <code>Range</code>, and <code>WorksheetFunction.NormInv</code>.</p>\n\n<p>When writing to <code>Range.Formula</code>, you want that value to be exactly what you would type in Excel's formula bar.</p>\n\n<p>Also you'll want to properly qualify these <code>Range</code> and <code>Cells</code> calls:</p>\n\n<pre><code>With oWS\n    .Range(.Cells(1, 1), .Cells(iSize, 1)).Formula = \"...\"\nEnd With\n</code></pre>\n\n<p>Where <code>\"...\"</code> looks exactly like it does in <a href=\"https://stackoverflow.com/a/57996596/1188513\">PaichengWu's answer</a>, except you want to use Excel's <code>RAND</code> function instead of VBA's <code>Rnd</code> function.</p>\n"}], "owner": {"reputation": 11, "user_id": 12085908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9e810d6530c245491387fc3f124035?s=128&d=identicon&r=PG&f=1", "display_name": "said", "link": "https://stackoverflow.com/users/12085908/said"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1568823055, "creation_date": 1568820142, "last_edit_date": 1568822655, "question_id": 57996161, "link": "https://stackoverflow.com/questions/57996161/getting-error-message-from-range-formula-function", "title": "Getting error message from range.formula function", "body": "<p>I have tried to run this sub for generating a random sample, but when I try to fix the formula I get only an error message in the cells \" Name\", in state of gettings the values.\nCan someone help?</p>\n\n<p>This is the code, thanks:</p>\n\n<pre><code>Option Explicit\n\nSub Simulation()\n\n    Dim iSize As Integer, pMean As Double, pSD As Double, iBins As String\n\n    iBins = 15\n    iSize = InputBox(\"New sheet: The size of your sample:\", , 100)\n    pMean = InputBox(\"New sheet: The mean of yoursample:\", , 10)\n    pSD = InputBox(\"New sheet: The SD of your sample:\", , 0.2)\n\n    Set oWS = Worksheets.Add(, ActiveSheet)\n\n    Range(Cells(1, 1), Cells(iSize, 1)).Formula = \"=Application.WorksheetFunction.NormInv(Rnd(), \" &amp; pMean &amp; \" , \" &amp; pSD &amp; \")\"\n    Range(Cells(1, 1), Cells(iSize, 1)).Formula = Range(Cells(1, 1), Cells(iSize, 1)).Value\n\n    Range(\"E1\") = Application.WorksheetFunction.Average(Columns(1))\nend sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1568819671, "post_id": 57996000, "comment_id": 102398433, "body": "Can you add some sample data or a screenshot to your question?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 4, "creation_date": 1568819955, "post_id": 57996000, "comment_id": 102398583, "body": "please see <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and don&#39;t forget to read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">I downvoted because no attempt was made</a>. Also check out the <a href=\"https://stackoverflow.com/tour\">tour</a>, and more good information at <a href=\"https://stackoverflow.com/help/on-topic\">&quot;help center&quot;.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12085826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8697f37fab0c0cb4b6d29e800dfd4f?s=128&d=identicon&r=PG&f=1", "display_name": "AngieV", "link": "https://stackoverflow.com/users/12085826/angiev"}, "edited": false, "score": 0, "creation_date": 1568821802, "post_id": 57996553, "comment_id": 102399673, "body": "Great this helped! Thank you very much."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1568821640, "creation_date": 1568821640, "answer_id": 57996553, "question_id": 57996000, "link": "https://stackoverflow.com/questions/57996000/sequence-of-numbers-based-on-start-and-end-value-of-2-cells/57996553#57996553", "title": "Sequence of numbers based on start and end value of 2 cells", "body": "<p>You can use these formulas</p>\n\n<p>D13: <code>=Q7</code></p>\n\n<p>E13: <code>=IFERROR(IF(D13+1&gt;$S$7,\"\",D13+1),\"\")</code></p>\n\n<p>Then copy E13 to the right as far as you need.</p>\n\n<p><a href=\"https://i.stack.imgur.com/c1uip.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c1uip.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 12085826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8697f37fab0c0cb4b6d29e800dfd4f?s=128&d=identicon&r=PG&f=1", "display_name": "AngieV", "link": "https://stackoverflow.com/users/12085826/angiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1568829394, "accepted_answer_id": 57996553, "answer_count": 1, "score": -6, "last_activity_date": 1568821640, "creation_date": 1568819596, "last_edit_date": 1592644375, "question_id": 57996000, "link": "https://stackoverflow.com/questions/57996000/sequence-of-numbers-based-on-start-and-end-value-of-2-cells", "closed_reason": "Needs details or clarity", "title": "Sequence of numbers based on start and end value of 2 cells", "body": "<p>I have a number range in two cell (Q7 start) and (S7 end). I am needing help in creating a formula  or macros to auto populate the sequence of the numbers inputted in columns D13:S16.</p>\n<p>Thank you in advance for your help.</p>\n<p><a href=\"https://i.stack.imgur.com/9RUev.jpg\" rel=\"nofollow noreferrer\">Sequence</a>\n<a href=\"https://i.stack.imgur.com/DQfUb.png\" rel=\"nofollow noreferrer\">Range</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1568819548, "post_id": 57995931, "comment_id": 102398377, "body": "What doesn&#39;t really work about it? Can you describe the problem in more detail?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 2, "creation_date": 1568819593, "post_id": 57995931, "comment_id": 102398397, "body": "I&#39;m not certain there is a reliable way to do what you are trying to do. There is <code>codename</code> and <code>index</code> neither of which are going to be in an order based on creation date or time."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 3, "creation_date": 1568819980, "post_id": 57995931, "comment_id": 102398601, "body": "Furthermore the names of the sheets (and codename) are not guaranteed to increment.  I can open a new workbook, create two extra tabs (<code>sheet2</code> and <code>sheet3</code>), delete <code>sheet1</code>, add a new sheet <code>sheet4</code> save and reopen the workbook, add a new sheet <code>sheet1</code> and now <code>sheet1</code> was last added and appears 3rd in the index of 4 sheets. Both it&#39;s codename and index have no discernable ordering."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1568820446, "post_id": 57995931, "comment_id": 102398874, "body": "Reserve a portion of your workbook to store sheet <code>CodeName</code> upon the <code>Workbook_NewSheet</code> event."}, {"owner": {"reputation": 135, "user_id": 10213700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E_JJgijFD7Q/AAAAAAAAAAI/AAAAAAAAAzs/LKcYefYQloQ/photo.jpg?sz=128", "display_name": "Dirk", "link": "https://stackoverflow.com/users/10213700/dirk"}, "edited": false, "score": 0, "creation_date": 1568820829, "post_id": 57995931, "comment_id": 102399104, "body": "It does not provide the correct answer."}, {"owner": {"reputation": 135, "user_id": 10213700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E_JJgijFD7Q/AAAAAAAAAAI/AAAAAAAAAzs/LKcYefYQloQ/photo.jpg?sz=128", "display_name": "Dirk", "link": "https://stackoverflow.com/users/10213700/dirk"}, "edited": false, "score": 0, "creation_date": 1568820953, "post_id": 57995931, "comment_id": 102399188, "body": "Ok, thank you for your answers."}], "answers": [{"comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 3, "creation_date": 1568820405, "post_id": 57996159, "comment_id": 102398840, "body": "Furthemore on the <code>codename</code> issue is that a workbook, once closed and reopened will start back at the lowest available codename number which is why we never see <code>Sheet512381</code> in a heavily used workbook."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1568820135, "creation_date": 1568820135, "answer_id": 57996159, "question_id": 57995931, "link": "https://stackoverflow.com/questions/57995931/vba-get-name-of-last-added-sheet/57996159#57996159", "title": "VBA - Get name of last added sheet", "body": "<p>You can't <strong>reliably</strong> know what sheet was last added, because a sheet can be <em>inserted</em> before or after any existing sheet in a workbook, see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.sheets.add\" rel=\"nofollow noreferrer\"><code>Sheets.Add</code> documentation</a>.</p>\n\n<p>Unless you're the one adding it. In which case, all you need to do is capture the <code>Worksheet</code> object returned by the <code>Add</code> method:</p>\n\n<pre><code>Dim newSheet As Worksheet\nSet newSheet = wb.Worksheets.Add\n\nDebug.Print newSheet.Name\n</code></pre>\n\n<p>Extracting the digits from the <code>CodeName</code> isn't going to be reliable either - especially if you assume that every sheet's code name begins with 5 letters. On a German machine, the <code>CodeName</code> of what we see as <code>Sheet1</code> would be <code>Tabelle1</code> - but then again the role of that digit is strictly to ensure uniqueness of the names of the <code>VBComponent</code> items in the VBA project, and none of it says it has anything to do with any sort of ordering.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568820440, "post_id": 57996184, "comment_id": 102398868, "body": "While iterating <code>Worksheets</code> when you mean to iterate <i>worksheets</i> is excellent advice, in this particular case it makes no difference, since a chart sheet has a <code>CodeName</code> too."}, {"owner": {"reputation": 135, "user_id": 10213700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E_JJgijFD7Q/AAAAAAAAAAI/AAAAAAAAAzs/LKcYefYQloQ/photo.jpg?sz=128", "display_name": "Dirk", "link": "https://stackoverflow.com/users/10213700/dirk"}, "edited": false, "score": 0, "creation_date": 1568821133, "post_id": 57996184, "comment_id": 102399286, "body": "This doesn&#39;t work neither. However, thank you for your proposal."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1568820252, "creation_date": 1568820252, "answer_id": 57996184, "question_id": 57995931, "link": "https://stackoverflow.com/questions/57995931/vba-get-name-of-last-added-sheet/57996184#57996184", "title": "VBA - Get name of last added sheet", "body": "<p><code>Sheets</code> could be a <code>Chart</code> or a <code>Worksheet</code>.\nYou could try use <code>Worksheets</code> instead of <code>Sheets</code> in your code.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>sub test()\nDim lastAddedSheet As Worksheet\nDim oneSheet As Worksheet\nWith ThisWorkbook\n    Set lastAddedSheet = .WorkSheets(1)\n    For Each oneSheet In .WorkSheets\n        If Val(Mid(oneSheet.CodeName, 6)) &gt; Val(Mid(lastAddedSheet.CodeName, 6)) Then\n            Set lastAddedSheet = oneSheet\n        End If\n    Next oneSheet\nEnd With\nMsgBox lastAddedSheet.Name &amp; \" was last added.\"\nEnd Sub\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1568829366, "post_id": 57996579, "comment_id": 102402773, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/199646/discussion-between-jvdv-and-mathieu-guindon\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1568843780, "last_edit_date": 1568843780, "creation_date": 1568821723, "answer_id": 57996579, "question_id": 57995931, "link": "https://stackoverflow.com/questions/57995931/vba-get-name-of-last-added-sheet/57996579#57996579", "title": "VBA - Get name of last added sheet", "body": "<p>As per @MathieuGuindon his answer, I can't think of any \"simple\" way to safely return the name of the latest added sheet. However if you willing to sacrifice some designated space in your project to store <code>CodeNames</code> you could try to utilize the <code>Workbook_NewSheet</code> event.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LyB9I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LyB9I.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n\nDim lr As Long\nWith Sheets(\"Blad1\")\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    .Cells(lr, 1) = ActiveSheet.CodeName\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Obviously you need to optimize this to add names when adding sheets during runtime. In this simplified example I manually added the existing sheet \"Blad1\", and upon adding new sheets, the list grew.</p>\n\n<p>When deleting you can utilize the <code>SheetBeforeDelete</code> event, like so:</p>\n\n<pre><code>Private Sub Workbook_SheetBeforeDelete(ByVal Sh As Object)\n\nDim ws As Object\nDim lr As Long, x As Long\nDim rng1 As Range, rng2 As Range, cl As Range\nWith Sheets(\"Blad1\")\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    Set rng1 = .Range(\"A2:A\" &amp; lr)\n    For Each ws In ActiveWindow.SelectedSheets\n        For Each cl In rng1\n            If cl = ws.CodeName Then\n                If Not rng2 Is Nothing Then\n                    Set rng2 = Union(rng2, cl)\n                Else\n                    Set rng2 = cl\n                End If\n            End If\n        Next cl\n    Next ws\nEnd With\n\nIf Not rng2 Is Nothing Then\n    rng2.Delete\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9uVtM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9uVtM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now to get the latest added sheet we can refer to the last cell in our designated range:</p>\n\n<pre><code>Sub LastAdded()\n\nDim lr As Long\nWith ThisWorkbook.Sheets(\"Blad1\")\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Debug.Print \"Last added sheet is codenamed: \" &amp; .Cells(lr, 1)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>My take on it is that it would be safest to use the <code>CodeName</code> since they are least likely to get changed and are unique. We can also safely keep using our <code>rng</code> variable since there will always be at least one worksheet in your project (and that might just be the designated one if you protect it). Working in this project will now keep track of latest added worksheet.</p>\n"}], "owner": {"reputation": 135, "user_id": 10213700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E_JJgijFD7Q/AAAAAAAAAAI/AAAAAAAAAzs/LKcYefYQloQ/photo.jpg?sz=128", "display_name": "Dirk", "link": "https://stackoverflow.com/users/10213700/dirk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1568843780, "creation_date": 1568819411, "last_edit_date": 1568819556, "question_id": 57995931, "link": "https://stackoverflow.com/questions/57995931/vba-get-name-of-last-added-sheet", "title": "VBA - Get name of last added sheet", "body": "<p>I am looking for a code to get the name of the last added sheet to Excel.</p>\n\n<p>I have tried this...</p>\n\n<pre><code>Sub test()\nDim lastAddedSheet As Worksheet\nDim oneSheet As Worksheet\nWith ThisWorkbook\n    Set lastAddedSheet = .Sheets(1)\n    For Each oneSheet In .Sheets\n        If Val(Mid(oneSheet.CodeName, 6)) &gt; Val(Mid(lastAddedSheet.CodeName, 6)) Then\n            Set lastAddedSheet = oneSheet\n        End If\n    Next oneSheet\nEnd With\nMsgBox lastAddedSheet.Name &amp; \" was last added.\"\nEnd Sub\n</code></pre>\n\n<p>But it does not really work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1568818941, "post_id": 57995765, "comment_id": 102398032, "body": "You are trying to copy all the worksheets from the <code>wb</code> but you are referencing always the <code>ActiveSheet</code> when you should call it <code>wb.Sheets(i).Copy</code>."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 11661025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15be80d8fc2e5b2de208c8ba5809574?s=128&d=identicon&r=PG&f=1", "display_name": "Lukec", "link": "https://stackoverflow.com/users/11661025/lukec"}, "edited": false, "score": 0, "creation_date": 1568819789, "post_id": 57995878, "comment_id": 102398498, "body": "brilliant, Thank you!"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 2, "last_activity_date": 1568819190, "creation_date": 1568819190, "answer_id": 57995878, "question_id": 57995765, "link": "https://stackoverflow.com/questions/57995765/increase-number-by-1-in-loop-when-naming-new-sheet-with-vba/57995878#57995878", "title": "Increase number by 1 in loop when naming new sheet with vba", "body": "<p>If I understood your logic, this should do the trick:</p>\n\n<pre><code>Option Explicit\nSub find()\n\n    Dim ws As Worksheet\n    Dim wb As Workbook\n    Dim Masterwb As Workbook\n    Set Masterwb = Workbooks(\"Dual Sub.xlsm\")\n\n    Dim strPath As String\n    Dim strFile As String\n    strPath = \"P:\\SD\\SUPPORT\\File Load\\\"\n    strFile = Dir(strPath &amp; \"*.xls\")\n\n    Dim i As Long\n    i = i + 1\n    Do While strFile &lt;&gt; \"\"\n        Set wb = Workbooks.Open(Filename:=strPath &amp; strFile)\n        For Each ws In wb.Worksheets 'better to loop like this (you loop trhough every item in the workbooks.worksheets collection)\n            ws.Copy After:=Masterwb.Sheets(Masterwb.Sheets.Count) 'copy the worksheet on the new workbook to the last index on the master workbook\n            Masterwb.Sheets(Masterwb.Sheets.Count).Name = i 'name the last sheet on the master workbook the value of i starting from 1\n            i = i + 1\n        Next ws\n        strFile = Dir 'This moves the value of strFile to the next file.\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11661025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15be80d8fc2e5b2de208c8ba5809574?s=128&d=identicon&r=PG&f=1", "display_name": "Lukec", "link": "https://stackoverflow.com/users/11661025/lukec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 57995878, "answer_count": 1, "score": 0, "last_activity_date": 1568819190, "creation_date": 1568818806, "question_id": 57995765, "link": "https://stackoverflow.com/questions/57995765/increase-number-by-1-in-loop-when-naming-new-sheet-with-vba", "title": "Increase number by 1 in loop when naming new sheet with vba", "body": "<p>I've got a loop that will take contents from 3 worksheets in a folder, and paste them onto a different workbook. I'd like to name them all a number. 1, 2, and 3 in the new workbook for use later while manipulating data. </p>\n\n<p>I've tried naming a variable but I can't figure out how to have it increase by 1 each time. </p>\n\n<pre><code>Sub find()\n\n\nDim iIndex As Integer\nDim ws As Excel.Worksheet\nDim wb      As Workbook\nDim strPath As String\nDim strFile As String\nDim i As Integer\ni = 1\n\nstrPath = \"P:\\SD\\SUPPORT\\File Load\\\"\nstrFile = Dir(strPath &amp; \"*.xls\")\n\nDo While strFile &lt;&gt; \"\"\nSet wb = Workbooks.Open(Filename:=strPath &amp; strFile)\n\n For iIndex = 1 To wb.Worksheets.Count\n    Set ws = wb.Worksheets(iIndex)\n\n'Copy each worksheet into dual sub workbook\nActiveSheet.Copy After:=Workbooks(\"Dual Sub.xlsm\").Sheets(4)\nActiveSheet.Name = i + 1\n\nNext iIndex\n\nstrFile = Dir 'This moves the value of strFile to the next file.\nLoop\n\n\nEnd Sub\n</code></pre>\n\n<p>With this code it just names the first sheet '2', and gives an error that it cannot name multiple sheets the same thing. I'd like for each sheet to be named as 1, 2, and 3.</p>\n"}, {"tags": ["vba", "hpc", "supercomputers"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1568818698, "post_id": 57995581, "comment_id": 102397908, "body": "Why would someone want to do that? Sort of like flying paper airplanes in wind tunnels. In any event -- it is off-topic to ask to recommends/find software libraries."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1568819424, "post_id": 57995581, "comment_id": 102398297, "body": "I&#39;m developing an algorithm for automatic trading and want to test my algorithm on big historical data (1 million of rows) trying many different variations (values of variables) for finding the most performing one.  I already have the VBA functions, I just need to execute many times (the more, the better) changing their argument values, like in my simplified example."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1568820259, "post_id": 57995581, "comment_id": 102398757, "body": "@6diegodiego9 That is reasonable enough, but VBA itself is a single-threaded interpreted language from the late 1990s. It is wonderful for adding functionality to spreadsheets, but doesn&#39;t really scale well. You could treat your VBA code as a protototype but then rewrite it in a compiled language. VBA =&gt; VB.Net is typically a straightforward (but not quite mechanical) translation. With VB.Net Excel InterOp, the resulting code could still interact with Excel smoothly."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1568821995, "post_id": 57995581, "comment_id": 102399786, "body": "@John the Microsoft HPC Pack that is the official Microsoft software for using Excel/VBA powered by supercomputers: <a href=\"https://docs.microsoft.com/en-us/powershell/high-performance-computing/hpcpack-excel-vba\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/powershell/high-performance-computi&zwnj;&#8203;ng/&hellip;</a>   but it requires the ability to install new apps on my PC (which I don&#39;t have) and time to learn it.  I don&#39;t think that I need all that complexity for my task..."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1568823517, "post_id": 57995581, "comment_id": 102400491, "body": "If it is for work -- why not talk to your manager? Unless he/she is a Dilbert-style pointy-haired boss, why wouldn&#39;t they want their employees using tools which are adequate for the job? Also, the learning curve might not be as large as you fear. At a quick glance of the documentation, it doesn&#39;t seem that bad. The tutorial that goes with it seems easy enough to follow."}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "is_accepted": true, "score": 0, "last_activity_date": 1570286864, "creation_date": 1570286864, "answer_id": 58249395, "question_id": 57995581, "link": "https://stackoverflow.com/questions/57995581/excel-vba-script-powered-by-supercomputers/58249395#58249395", "title": "Excel VBA script powered by supercomputers?", "body": "<p>Af far as I know, there's no such a software/service available</p>\n"}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 58249395, "answer_count": 1, "score": -1, "last_activity_date": 1570286864, "creation_date": 1568818187, "question_id": 57995581, "link": "https://stackoverflow.com/questions/57995581/excel-vba-script-powered-by-supercomputers", "title": "Excel VBA script powered by supercomputers?", "body": "<p>Is there a software/service/hardware available to run <strong>simple VBA scripts</strong> on a supercomputer (a <strong>remote cluster of CPUs</strong>)?<br>\nI mean without installing the complex official HPC Excel extensions and spending time learning it...\n<br></p>\n\n<p>I mean something as <strong>easy to use</strong> as this:<br></p>\n\n<pre><code>Sub test()\n   SupercomputerLib.upload(ThisWorkbook)\n   ArrayOfResults = SupercomputerLib.Execute(\"complexFunc(100)\", _\n                                             \"complexFunc(200)\", _\n                                             \"complexFunc(300)\", _\n                                             \"complexFunc(400)\", _\n                                             \"complexFunc(500)\", _\n                                             \"complexFunc(600)\", _\n                                             \"complexFunc(700)\", _\n                                             \"complexFunc(800)\", _\n                                             \"complexFunc(900)\", _\n                                             \"complexFunc(1000)\")\n   'ArrayResult will be generated in 1 day of parallel calculus\nEnd sub\n\nFunction complexFunc(someNumber as integer) as long\n   *complex calculus that takes 1 day on a single CPU*\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 6497, "user_id": 1621233, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b0580386fa55f32b6cacbeda37464d72?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1621233/joe"}, "edited": false, "score": 0, "creation_date": 1569251831, "post_id": 58035330, "comment_id": 102527233, "body": "Thanks.  I had already tried deleting that property but got an error: The property <a href=\"http://schemas.microsoft.com/mapi/proptag/0x301C0040\" rel=\"nofollow noreferrer\">schemas.microsoft.com/mapi/proptag/0x301C0040</a> does not support this operation.  As a workaround, I was able to change the archive date to 100 years in the future.  I&#39;d like to be able to remove it completely, however."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 6497, "user_id": 1621233, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b0580386fa55f32b6cacbeda37464d72?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1621233/joe"}, "edited": false, "score": 0, "creation_date": 1569252090, "post_id": 58035330, "comment_id": 102527365, "body": "Yes, MailItem.PropertyAccessor can refuse to let you modify some properties is considers &quot;important&quot;. You should be able to delete / modify these properties using Redemption."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1569014519, "creation_date": 1569014519, "answer_id": 58035330, "question_id": 57995518, "link": "https://stackoverflow.com/questions/57995518/remove-retention-policy-from-outlook-email-with-vba/58035330#58035330", "title": "Remove retention policy from Outlook email with VBA", "body": "<p>You can try to remove the <code>PR_RETENTION_DATE</code> MAPI property (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x301C0040</code>) using <code>MailItem.PropertyAccessor.DeleteProperty</code>.</p>\n\n<p>Read more about retention properties at <a href=\"https://blogs.technet.microsoft.com/anya/2014/11/19/understanding-of-managed-folder-assistant-with-retention-policies/\" rel=\"nofollow noreferrer\">https://blogs.technet.microsoft.com/anya/2014/11/19/understanding-of-managed-folder-assistant-with-retention-policies/</a> and take a look at the messages with <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow noreferrer\">OutlookSpy</a> (click IMessage button).</p>\n"}], "owner": {"reputation": 6497, "user_id": 1621233, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b0580386fa55f32b6cacbeda37464d72?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1621233/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1585875323, "creation_date": 1568817995, "last_edit_date": 1585875323, "question_id": 57995518, "link": "https://stackoverflow.com/questions/57995518/remove-retention-policy-from-outlook-email-with-vba", "title": "Remove retention policy from Outlook email with VBA", "body": "<p>If I move a mail item from a folder with a retention policy to a folder without a retention policy, the mail item will still have the policy from the original folder.  I can manually open the email and set the policy to \"Use folder policy\", but I'm trying to do this with VBA.</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/27011942/how-to-assign-a-retention-tag-to-a-mail-item-in-outlook-vba/27101522\">this</a> answer which describes how to apply a policy; I tried using this logic but was unsuccessful -- since the target folder does not have a retention policy, there is nothing to copy to the child item.  I tried removing the retention properties but got an error.</p>\n\n<p>How can I remove a retention policy from a mail item with VBA?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1568818249, "post_id": 57995444, "comment_id": 102397618, "body": "Wlecome to SO. You can benefit from reading <a href=\"https://stackoverflow.com/a/10717999/9199828\">How to avoid Select</a> to optimize your code."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8787100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/312a1dd0448035973809e29f33943d9c?s=128&d=identicon&r=PG&f=1", "display_name": "shevchenko2020", "link": "https://stackoverflow.com/users/8787100/shevchenko2020"}, "edited": false, "score": 0, "creation_date": 1568909307, "post_id": 57996518, "comment_id": 102433992, "body": "Thank you will try this as well."}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": -1, "last_activity_date": 1568841016, "last_edit_date": 1568841016, "creation_date": 1568821486, "answer_id": 57996518, "question_id": 57995444, "link": "https://stackoverflow.com/questions/57995444/macro-to-copy-and-paste-transpose-data-from-column-to-row-scalable/57996518#57996518", "title": "Macro to copy and paste (transpose) data from column to row - Scalable", "body": "<p>Before</p>\n\n<p><a href=\"https://i.stack.imgur.com/4E7iZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4E7iZ.png\" alt=\"enter image description here\"></a>\nWell, you are not really transposing, but I would use this method.  I start at 2 to leave the first in place, then basically move the next one over and delete all the empty spaces at the end.</p>\n\n<pre><code>Sub MakeTwoColumns()\n\n    Dim x As Long\n\n    For x = 2 To 500 Step 2\n        Cells(x, 6) = Cells(x, 5)\n        Cells(x, 5).ClearContents\n    Next x\n\n    Columns(5).SpecialCells(xlCellTypeBlanks).Delete\n    Columns(6).SpecialCells(xlCellTypeBlanks).Delete\nEnd Sub\n</code></pre>\n\n<p>After<br>\n<a href=\"https://i.stack.imgur.com/NXTOc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NXTOc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1568842343, "creation_date": 1568842343, "answer_id": 58000984, "question_id": 57995444, "link": "https://stackoverflow.com/questions/57995444/macro-to-copy-and-paste-transpose-data-from-column-to-row-scalable/58000984#58000984", "title": "Macro to copy and paste (transpose) data from column to row - Scalable", "body": "<p>Here's an alternative to Copy/Paste - using Variant Arrays.  This will be <em>much</em> faster for large data sets.</p>\n\n<pre><code>Sub Demo()\n    Dim rng As Range\n    Dim Src As Variant\n    Dim Dst As Variant\n    Dim GroupSize As Long\n    Dim Groups As Long\n    Dim iRow As Long\n    Dim iCol As Long\n    Dim iDst As Long\n    Dim SrcStartRow As Long\n    Dim SrcColumn As Long\n    Dim DstStartRow As Long\n    Dim DstColumn As Long\n\n    ' Set up Parameters\n    GroupSize = 2\n    SrcStartRow = 2\n    SrcColumn = 8 'H\n    DstStartRow = 1\n    DstColumn = 9 'I\n\n    With ActiveSheet 'or specify a specific sheet\n        ' Get Reference to source data\n        Set rng = .Range(.Cells(SrcStartRow, SrcColumn), .Cells(.Rows.Count, SrcColumn).End(xlUp))\n        ' Account for possibility there is uneven amount of data\n        Groups = Application.RoundUp(rng.Rows.Count / GroupSize, 0)\n        If rng.Rows.Count &lt;&gt; Groups * GroupSize Then\n            Set rng = rng.Resize(Groups * GroupSize, 1)\n        End If\n\n\n        'Copy data to Variant Array\n        Src = rng.Value2\n\n        'Size the Destination Array\n        ReDim Dst(1 To UBound(Src, 1) / GroupSize, 1 To GroupSize)\n\n        'Loop the Source data and split into Destination Array\n        iDst = 0\n        For iRow = 1 To UBound(Src, 1) Step GroupSize\n            iDst = iDst + 1\n            For iCol = 1 To GroupSize\n                Dst(iDst, iCol) = Src(iRow + iCol - 1, 1)\n            Next\n        Next\n\n        ' Move result to sheet\n        .Cells(DstStartRow, DstColumn).Resize(UBound(Dst, 1), UBound(Dst, 2)).Value = Dst\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8787100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/312a1dd0448035973809e29f33943d9c?s=128&d=identicon&r=PG&f=1", "display_name": "shevchenko2020", "link": "https://stackoverflow.com/users/8787100/shevchenko2020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1568842558, "creation_date": 1568817742, "last_edit_date": 1568842558, "question_id": 57995444, "link": "https://stackoverflow.com/questions/57995444/macro-to-copy-and-paste-transpose-data-from-column-to-row-scalable", "title": "Macro to copy and paste (transpose) data from column to row - Scalable", "body": "<p>I am looking to create a macro which would allow me to copy and paste data from one column and then transpose that data over 2 columns in the right order</p>\n\n<p>I have recorded a macro while doing the process manually</p>\n\n<pre><code>    Range(\"G3\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Range(\"G2:G7\").Select          '   (The column range I want to copy)\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Range(\"I1\").Select                '    (Row where the range of G2:G7) is now transposed)\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\n\n    Range(\"H2:H7\").Select          '   (The second column range I want to copy)\n    Application.CutCopyMode = False\n    Selection.Copy\n\n    Range(\"I2\").Select                '   (Second Row where the range of H2:H7) is now transposed)\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\n\n    Range(\"H8:H13\").Select        '   (The third column range I want to copy)\n    Application.CutCopyMode = FalseSelection.Copy\n\n    Range(\"I3\").Select' ( Third Row where the range of H8:H13) is now transposed)\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\n</code></pre>\n\n<p>The problem is that this code only works up to certain number of rows <em>(up till H13 for example)</em>, but if I want to this repeat this process up to row H600 (range of H600:H605) and pasting to I31 for example without copying and pasting this code hundreds of times, is there a way I can do this?</p>\n\n<p><strong>This is what I mean by example</strong> </p>\n\n<pre><code>Column H\nStar\nGreenwood\nTiton\nHumford\n</code></pre>\n\n<p><strong><em>converted to</em></strong></p>\n\n<pre><code>Column I      |    Column J**  \nStar          |    Greenwood\ntiton         |    Humford\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568817446, "post_id": 57995238, "comment_id": 102397064, "body": "The rangetoHTML method by Ron de Bruin does indeed not work too well with the current formatting as the data gets delivered using an unformatted array. To get around this you can reapply the formatting in the temp file with something like <code>Range(&quot;A:D&quot;).font.bold = true</code>, you put that in after <code>.Cells(1).PasteSpecial xlPasteFormats, , False, False</code>."}, {"owner": {"reputation": 11, "user_id": 12085668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e064b504df0150bd7c32c05c5fa97f77?s=128&d=identicon&r=PG&f=1", "display_name": "Danny C", "link": "https://stackoverflow.com/users/12085668/danny-c"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568817538, "post_id": 57995238, "comment_id": 102397129, "body": "Is there a way to open up the temp wb so I know which row to specifically re-apply the bold?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568817977, "post_id": 57995238, "comment_id": 102397456, "body": "<a href=\"https://www.thespreadsheetguru.com/blog/2014/4/8/debugging-vba-code-adding-breakpoints\" rel=\"nofollow noreferrer\">Insert a breakpoint</a> at the end of the <code>&#39;Copy the range and create a new workbook to past the data in</code> block, and it will halt just after creating the temp file."}, {"owner": {"reputation": 11, "user_id": 12085668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e064b504df0150bd7c32c05c5fa97f77?s=128&d=identicon&r=PG&f=1", "display_name": "Danny C", "link": "https://stackoverflow.com/users/12085668/danny-c"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568819242, "post_id": 57995238, "comment_id": 102398188, "body": "Forgot i had the screenupdating block set to false before. I figured it out. Thanks for your help"}], "owner": {"reputation": 11, "user_id": 12085668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e064b504df0150bd7c32c05c5fa97f77?s=128&d=identicon&r=PG&f=1", "display_name": "Danny C", "link": "https://stackoverflow.com/users/12085668/danny-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568817116, "creation_date": 1568817116, "question_id": 57995238, "link": "https://stackoverflow.com/questions/57995238/vba-keeping-text-format-when-using-rangetohtml", "title": "VBA - Keeping Text Format when using RangeToHTML", "body": "<p>I am copying a selected range to put into the body of an Outlook email using RangetoHTML(rng). My range is a table with headers, but when pasted onto the email window using .Display, the table headers are unbolded. I've tried all of the xlPasteSpecials already, but none of them work.</p>\n\n<pre><code>Function RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\nDim fso As Object\nDim ts As Object\nDim TempFile As String\nDim TempWB As Workbook\n\nTempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n'Copy the range and create a new workbook to past the data in\nrng.Copy\nSet TempWB = Workbooks.Add(1)\nWith TempWB.Sheets(1)\n    .Cells(1).PasteSpecial Paste:=8\n    .Cells(1).PasteSpecial xlPasteValues, , False, False\n    .Cells(1).PasteSpecial xlPasteFormats, , False, False\n    .Cells(1).Select\n    Application.CutCopyMode = False\n    On Error Resume Next\n    .DrawingObjects.Visible = True\n    .DrawingObjects.Delete\n    On Error GoTo 0\nEnd With\n\n'Publish the sheet to a htm file\nWith TempWB.PublishObjects.Add( _\n     SourceType:=xlSourceRange, _\n     Filename:=TempFile, _\n     Sheet:=TempWB.Sheets(1).Name, _\n     Source:=TempWB.Sheets(1).UsedRange.Address, _\n     HtmlType:=xlHtmlStatic)\n    .Publish (True)\nEnd With\n\n'Read all data from the htm file into RangetoHTML\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nSet ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\nRangetoHTML = ts.readall\nts.Close\nRangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                      \"align=left x:publishsource=\")\n\n'Close TempWB\nTempWB.Close savechanges:=False\n\n'Delete the htm file we used in this function\nKill TempFile\n\nSet ts = Nothing\nSet fso = Nothing\nSet TempWB = Nothing\n</code></pre>\n\n<p>End Function</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1568817289, "post_id": 57995150, "comment_id": 102396961, "body": "Try using <code>.TextFrame.TextRange.</code> instead of just <code>.TextFrame.</code>. It would be helpfult ot know what error message you are getting"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 4740702, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40d55fd0ed031bd42979c5a06cabcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "together", "link": "https://stackoverflow.com/users/4740702/together"}, "edited": false, "score": 0, "creation_date": 1568830072, "post_id": 57995346, "comment_id": 102403053, "body": "works now, how to change the foreground color and background color?"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1568818301, "last_edit_date": 1568818301, "creation_date": 1568817434, "answer_id": 57995346, "question_id": 57995150, "link": "https://stackoverflow.com/questions/57995150/the-code-to-change-font-names-size-for-textbox-in-excel-macro/57995346#57995346", "title": "the code to change font names, size for textbox in Excel macro", "body": "<p>Whereas <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.characters.text\" rel=\"nofollow noreferrer\"><code>.Text</code></a> is a valid property of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.characters\" rel=\"nofollow noreferrer\"><code>.Characters</code></a> object, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.characters.font\" rel=\"nofollow noreferrer\"><code>.Font</code></a> is not a sub-property of it of some sort. It is a property to the object on it's own. Therefor the following worked for me:</p>\n\n<pre><code>Sub Tst()\n\nDim myDocument As Worksheet: Set myDocument = ThisWorkbook.Sheets(\"Sheet1\")\nDim tx As Shape\n\nSet tx = myDocument.Shapes.AddTextbox(msoTextOrientationHorizontal, 382, 266, 122, 20)\nWith tx.TextFrame.Characters\n    .Text = mydocument.Cells(6, 8)\n    .Font.Name = \"Tahoma\"\n    .Font.Size = 10\n    .Font.Bold = msoTrue\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 4740702, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40d55fd0ed031bd42979c5a06cabcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "together", "link": "https://stackoverflow.com/users/4740702/together"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 57995346, "answer_count": 1, "score": 1, "last_activity_date": 1568818301, "creation_date": 1568816873, "last_edit_date": 1568817271, "question_id": 57995150, "link": "https://stackoverflow.com/questions/57995150/the-code-to-change-font-names-size-for-textbox-in-excel-macro", "title": "the code to change font names, size for textbox in Excel macro", "body": "<p>try to find the code to change font names, size for textbox in Excel macro, all my codes from \" .font.name= to End with\" shows wrong in VBA, any suggestions? thanks</p>\n\n<pre><code>Set myDocument = Worksheets(1)\n\n  Set tx_ = myDocument.Shapes.AddTextbox(msoTextOrientationHorizontal, 382, 266, 122, 20)\n\ntx_.TextFrame.Characters.Text = ThisWorkbook.Sheets(1).Cells(6, 8)\n\n  With tx_.TextFrame.Characters.Text\n\n  .Font.Name = \"Tahoma\"\n\n  .Font.Size = 10\n\n  .Font.Bold = msoTrue\n\n  End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1568816817, "post_id": 57995088, "comment_id": 102396686, "body": "So using conditional formatting is not an option for you?"}, {"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1568817207, "post_id": 57995088, "comment_id": 102396910, "body": "I am not so good at Excel formulas, please suggest me how to use formula?"}], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 1, "last_activity_date": 1568817442, "creation_date": 1568817442, "answer_id": 57995347, "question_id": 57995088, "link": "https://stackoverflow.com/questions/57995088/highlight-intersection-cell-of-row-and-column-based-on-text-matching-using-vba/57995347#57995347", "title": "Highlight intersection cell of row and column based on Text matching using VBA", "body": "<p>I fixed some errors I found:</p>\n\n<pre><code>Sub cellintersection()\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet\nSet ws = ActiveSheet\n\nDim cols As Range, rws As Range\nDim lastRow As Integer: lastRow = ws.UsedRange.Rows.Count\nDim lastColumn As Integer: lastColumn = ws.UsedRange.Columns.Count\n\nFor Each cols In ws.Range(ws.Cells(2, 1), ws.Cells(2, lastColumn))\n    If cols.Value &lt;&gt; vbNullString Then\n        For Each rws In ws.Range(\"A1:A\" &amp; lastRow)\n            If rws.Value = cols.Value Then ws.Cells(rws.Row, cols.Column).Interior.Color = 5296210\n        Next\n    End If\nNext\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>When starting the first For...Each Loop you are looking through row 1, which does not have any values in it. Your headers are in row 2. Also some of your If statements were unneccesarily complicated, for example</p>\n\n<pre><code>If (Not (cols.Value = vbNullString)) Then\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>If cols.Value &lt;&gt; vbNullString Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "edited": false, "score": 0, "creation_date": 1568818400, "post_id": 57995541, "comment_id": 102397712, "body": "Great! It worked perfect,was not thinking this way. Thank you."}, {"owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "edited": false, "score": 0, "creation_date": 1568873873, "post_id": 57995541, "comment_id": 102414439, "body": "A small issue, using conditional formatting when I Change the text in cells A4 from A11 to A22 the cell C4  is not getting highlighted."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "edited": false, "score": 0, "creation_date": 1568877088, "post_id": 57995541, "comment_id": 102415940, "body": "@Sant, it works perfectly on my end. Are you sure you have used the right formula?"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 3, "last_activity_date": 1568818407, "last_edit_date": 1568818407, "creation_date": 1568818082, "answer_id": 57995541, "question_id": 57995088, "link": "https://stackoverflow.com/questions/57995088/highlight-intersection-cell-of-row-and-column-based-on-text-matching-using-vba/57995541#57995541", "title": "Highlight intersection cell of row and column based on Text matching using VBA", "body": "<p>So with conditional formatting as per my comment:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ruc4o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ruc4o.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>Select range <code>B4:D6</code></li>\n<li><p>Start > Conditional Formatting > New Rule > Formula:</p>\n\n<pre><code>=B$2=$A4\n</code></pre></li>\n<li><p>Choose your fill color and confirm</p></li>\n</ul>\n\n<p>Notice, filling cells through VBA is static while conditional formatting is dynamic and will change according to changes made to your data.</p>\n"}], "owner": {"reputation": 101, "user_id": 10206926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1abcb91b73a358b0458351b1b4fe0c8e?s=128&d=identicon&r=PG&f=1", "display_name": "sant", "link": "https://stackoverflow.com/users/10206926/sant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 57995347, "answer_count": 2, "score": 0, "last_activity_date": 1568818407, "creation_date": 1568816703, "last_edit_date": 1568818099, "question_id": 57995088, "link": "https://stackoverflow.com/questions/57995088/highlight-intersection-cell-of-row-and-column-based-on-text-matching-using-vba", "title": "Highlight intersection cell of row and column based on Text matching using VBA", "body": "<p>I am trying to use VBA by which when the text in a column header is the same as the text in a row the intersection cell of the row and the column gets highlighted with some Color.</p>\n\n<p>Example: I tried with below Code but not giving the required output</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>Sub cellintersection()\nApplication.EnableEvents = False\n    Application.ScreenUpdating = False\n\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n\n    Dim cols As Range, rws As Range\n    Dim lastRow As Integer: lastRow = ws.UsedRange.Rows.Count\n    Dim lastColumn As Integer: lastColumn = ws.UsedRange.Columns.Count\n\n    For Each cols In ws.Range(ws.Cells(1, 1), ws.Cells(1, lastColumn))\n        If (Not (cols.Value = vbNullString)) Then\n            For Each rws In ws.Range(\"A1:A\" &amp; lastRow)\n                If (rws.Value = cols.Value) Then ws.Cells(rws.Row, cols.Column).Interior.Color = 5296210\n            Next\n        End If\n    Next\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Required Output: The cells with green by matching the text with blue.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yUgUQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yUgUQ.jpg\" alt=\"Output\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1568815966, "post_id": 57994807, "comment_id": 102396142, "body": "<code>str1 = &quot;M&quot;</code> and <code>str2 = &quot;A&quot;</code>. Strings are enclosed in quotes. Add <code>Option Explicit</code> to the very top of the module."}, {"owner": {"reputation": 67, "user_id": 11900863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00645daaad6b4b2b6a092f58536f0895?s=128&d=identicon&r=PG&f=1", "display_name": "TheLinkedOne", "link": "https://stackoverflow.com/users/11900863/thelinkedone"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568816685, "post_id": 57994807, "comment_id": 102396592, "body": "Thank you very much! Had a long day and didn&#39;t see that mistake."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1568816651, "creation_date": 1568816651, "answer_id": 57995074, "question_id": 57994807, "link": "https://stackoverflow.com/questions/57994807/copy-color-over-multiple-worksheets-multiple-times/57995074#57995074", "title": "Copy Color over multiple Worksheets multiple times", "body": "<p>First and most important step: add <code>Option Explicit</code> to the top of the module. Or even better, go to <em>Tools</em> > <em>Options</em> and check <em>Require Variable Declaration</em> and it will be added automatically for you going forward.</p>\n\n<p>Second, add quotes around <code>String</code>s.</p>\n\n<pre><code>str1 = \"M\"\n\nstr2 = \"A\"\n</code></pre>\n\n<p>As is, <code>M</code> and <code>A</code> are undeclared variables and not the <code>String</code>s you want.</p>\n\n<p>So <code>field1</code> and <code>field2</code> are really only <code>num1</code> and <code>num2</code>, and <code>2</code> and <code>5</code> are not valid <code>Range</code> references.</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 11900863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00645daaad6b4b2b6a092f58536f0895?s=128&d=identicon&r=PG&f=1", "display_name": "TheLinkedOne", "link": "https://stackoverflow.com/users/11900863/thelinkedone"}, "edited": false, "score": 0, "creation_date": 1568818423, "post_id": 57995320, "comment_id": 102397736, "body": "Thank you for your response and helpfull tips! Range() acctually works with the column and range together, I dont know why, maybe its because it&#39;s in Excel? Well it works, and I&#39;m surely going to use some tips like the declaration and the Explicit Option!"}], "tags": [], "owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "is_accepted": false, "score": 0, "last_activity_date": 1568818481, "last_edit_date": 1568818481, "creation_date": 1568817392, "answer_id": 57995320, "question_id": 57994807, "link": "https://stackoverflow.com/questions/57994807/copy-color-over-multiple-worksheets-multiple-times/57995320#57995320", "title": "Copy Color over multiple Worksheets multiple times", "body": "<p>I wrote this from my phone so i couldn't check it, but the only part i'm not sure of is if the sh2.Cells actually works, if it doesn't, you should use the sh2.Range you used (i've given instructions on how to use Range() in my code)</p>\n\n<p>I've wrote you a lot of comments that are meant to help :)</p>\n\n<pre><code>Option Explicit\n'Option Explicit is pretty much necessary in your VBA code\n\nSub VLANColor()\n    ' You can use the \":\" to declare and instanciate on the same line, making it easier to read imo, but its just my opinion\n    Dim sh1 As Worksheet : Set sh1 = ActiveWorkbook.Sheets(\"\u00dcbersicht\")\n    Dim sh2 As Worksheet : Set sh2 = ActiveWorkbook.Sheets(\"Ports\")\n\n    ' You need to declare the i variable for your incoming For\n    Dim i As Integer\n    Dim str1 As String : str1 = \"M\"\n    Dim str2 As String : str2 = \"A\"\n    Dim num1 As Integer : num1 = 2\n    Dim num2 As Integer : num2 = 5\n    Dim field1 As String ' The default value of a String is \"\" (which is equal to the VBA constant vbNullString)\n    Dim field2 As String ' The default value of a String is \"\" (which is equal to the VBA constant vbNullString)\n\n    'This will help me in the for loop, you'll understand how\n    Dim intColumnA As Integer : intColumnA = 1\n    Dim intColumnM As Integer : intColumnM = 13\n\n    For i = 1 To 5 ' Consider : For i = 1 To num2\n        ' For future use : CStr() converts a numerical to a String\n        'field1 = str1 &amp; CStr(num1) \n        'field2 = str2 &amp; CStr(num2)\n        ' but we wont need it anymore\n\n        'sh2.Range(field1).Interior.Color = sh1.Range(field2).Interior.Color\n        ' Range() cannot be used like that, but you can do as follows\n\n        ' Using Cells(column, row) returns a range representing 1 cell\n        ' or you can use Range(Cells(column, row), Cells(column, row)) to have multiple cells\n        sh2.Cells(intColumnA, num1).Interior.Color  = sh1.Cells(intColumnM, num2).Interior.Color\n\n        num1 = num1 + 1\n        num2 = num2 + 1\n    'Consider : \"Next\" alone, explicitly say \"Next i\" isnt necessary here, but it would become a necessity if you would like to do, for example, \"Next i *2\"\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 11900863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00645daaad6b4b2b6a092f58536f0895?s=128&d=identicon&r=PG&f=1", "display_name": "TheLinkedOne", "link": "https://stackoverflow.com/users/11900863/thelinkedone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57995074, "answer_count": 2, "score": 0, "last_activity_date": 1568818481, "creation_date": 1568815910, "question_id": 57994807, "link": "https://stackoverflow.com/questions/57994807/copy-color-over-multiple-worksheets-multiple-times", "title": "Copy Color over multiple Worksheets multiple times", "body": "<p>I want to copy a row of Different colors from one Worksheet to another.</p>\n\n<p>Im new to VBA with a Powershell background so I migth have overseen something.</p>\n\n<p>Heres the Code that i've tried, but each time I try to use it I get the \"run-time Error 1004\". The thing is the Ranges work, I tried them without the For-Loop, it worked so both the Worksheets are active and the ranges work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub VLANColor()\n\n    Dim sh1 As Worksheet\n    Dim sh2 As Worksheet\n\n    Set sh1 = ActiveWorkbook.Sheets(\"\u00dcbersicht\")\n    Set sh2 = ActiveWorkbook.Sheets(\"Ports\")\n\n    Dim str1 As String\n    Dim str2 As String\n    Dim num1 As Integer\n    Dim num2 As Integer\n    Dim field1 As String\n    Dim field2 As String\n\n    str1 = M\n    num1 = 2\n    field1 = \"\"\n\n    str2 = A\n    num2 = 5\n    field2 = \"\"\n\n\n    For i = 1 To 5\n\n        field1 = str1 &amp; num1\n        field2 = str2 &amp; num2\n\n        sh2.Range(field1).Interior.Color = sh1.Range(field2).Interior.Color\n\n        num1 = num1 + 1\n        num2 = num2 + 1\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1568816074, "post_id": 57994767, "comment_id": 102396197, "body": "If you mean the <i>values</i>, you can&#39;t output an array using <code>Debug.Print</code> without looping, and since you have multiple areas, or multiple items, you&#39;ll need to loop through those too."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1568816136, "post_id": 57994767, "comment_id": 102396231, "body": "@M.Schalk This doesn&#39;t work ^^"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1568816180, "post_id": 57994767, "comment_id": 102396271, "body": "@Rory the debug.print is inside a <code>For Each</code> , should I add a loop into it ?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568817160, "post_id": 57994767, "comment_id": 102396882, "body": "you want the values? I&#39;m not sure what you mean by items, If the dictionary item is a range the default is the value of that range, just leave the .address part off."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568817332, "post_id": 57994767, "comment_id": 102396990, "body": "@Warcupine Yes I want the value, if i delete the .address I still have error code 13"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568817432, "post_id": 57994767, "comment_id": 102397052, "body": "Each dictionary item is a single cell, or multiple?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1568817731, "post_id": 57994767, "comment_id": 102397276, "body": "@Warcupine Each dictionnary item are multiple cells"}], "answers": [{"comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568818331, "post_id": 57995530, "comment_id": 102397674, "body": "is there a way to not display those data as my screenshot ?   Example : KeyName : Item1 , Item2, Item 3 <b>|</b> KeyName1: Item, item ,item <b>|</b> And so on  Your code actually do : KeyName Item <b>|</b> KeyName Item1 <b>|</b> keyName Item2 <b>|</b> KeyName1 Item <b>|</b> ...."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568818427, "post_id": 57995530, "comment_id": 102397739, "body": "You could concatenate the values together, unfortunately I am not aware of a way to get VBA to print an entire array without iterating through it and printing each separately."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568818492, "post_id": 57995530, "comment_id": 102397777, "body": "I will try to join them into a var and the use modulo : each time mod 3 = 0 I got my full string"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568818695, "post_id": 57995530, "comment_id": 102397906, "body": "@Dorian I just edited in a way to combine them into a string."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568818744, "post_id": 57995530, "comment_id": 102397939, "body": "@Warcupine I did it on my Own I will suggest you what I did then accept your answer. Thanks for your time !"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568818772, "post_id": 57995530, "comment_id": 102397952, "body": "@BigBen Do you know of a better way to do that then have three nested loops? That seems like it might take a while with a lot of data."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568818895, "post_id": 57995530, "comment_id": 102398008, "body": "Read it all into an array maybe."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568818930, "post_id": 57995530, "comment_id": 102398026, "body": "@BigBen I think you can&#39;t see my edit suggestion where I added my code"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568819114, "post_id": 57995530, "comment_id": 102398116, "body": "@Dorian Works as long as you don&#39;t need something other than 3 values in any one item."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568819154, "post_id": 57995530, "comment_id": 102398139, "body": "@Warcupine Yep but I need always 3 value as 1 item this is why i used modulo"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568819176, "post_id": 57995530, "comment_id": 102398151, "body": "Thanks you both for your kind help"}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 0, "last_activity_date": 1568818940, "last_edit_date": 1568818940, "creation_date": 1568818023, "answer_id": 57995530, "question_id": 57994767, "link": "https://stackoverflow.com/questions/57994767/return-dictionary-items-vba/57995530#57995530", "title": "return dictionary items vba", "body": "<p>So this will print each cell value in a range stored in a dictionary.</p>\n\n<pre><code>for each key in dict.keys\n    printstr = \"\"\n    for each icell in activesheet.range(dict(key).address)\n         if printstr = \"\" then\n             printstr =  key &amp; \" \" &amp; icell\n         else\n             printstr = printstr &amp; \" \" &amp; icell\n         end if\n    next\n    debug.print printstr\nnext\n</code></pre>\n\n<p>Change activesheet to a explicit reference, especially if you are using multiple sheets in your code otherwise there is a chance it will pull the value of the wrong address.</p>\n\n<p>key to get the range, icell to get the individual cell.</p>\n\n<p><strong>OP 's Solution</strong></p>\n\n<pre><code>For Each varKey In dict.Keys\n\n   For Each icell In ActiveSheet.Range(dict(varKey).Address)\n    cpt = cpt + 1\n    Dim MyString As String\n\n    MyString = MyString &amp; \" \" &amp; icell\n    If cpt Mod 3 = 0 Then\n    Debug.Print varKey, MyString\n    MyString = \"\"\n\n    End If\n\n    Next\n\n Next varKey\n</code></pre>\n"}], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 57995530, "answer_count": 1, "score": 0, "last_activity_date": 1568818940, "creation_date": 1568815812, "question_id": 57994767, "link": "https://stackoverflow.com/questions/57994767/return-dictionary-items-vba", "title": "return dictionary items vba", "body": "<p>The following line of code returns : <code>Address</code></p>\n\n<pre><code>debug.print dict.Item(varKey).Address\n</code></pre>\n\n<p>To display value I was thinking that : </p>\n\n<p><code>debug.print dict.Items</code> would have work but I am getting the following issue : </p>\n\n<blockquote>\n  <p>Error code 13 : typemismatch</p>\n</blockquote>\n\n<p>Below is the loop I am using to display the <code>Address</code> of the cells which have the same key : </p>\n\n<pre><code>For Each varKey In dict.Keys\n\n        Debug.Print varKey &amp; \": \" &amp; dict.Item(varKey).Address ' remove in production\n\nNext varKey\n</code></pre>\n\n<p>The data displayed using debugger are just below : </p>\n\n<p><a href=\"https://i.stack.imgur.com/AlqVZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AlqVZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>My Question is what is the way to diplay <code>Items</code> and not address ?</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568815800, "post_id": 57994751, "comment_id": 102396048, "body": "What line throws that error?"}, {"owner": {"reputation": 1, "user_id": 12085422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MuWfSdcCZVc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPtqSO2r9pIkDarHPZY_gkafXR_g/photo.jpg?sz=128", "display_name": "ad6492", "link": "https://stackoverflow.com/users/12085422/ad6492"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568816244, "post_id": 57994751, "comment_id": 102396311, "body": "the line Sheets(shtNameLog).Cells(RecordNmbr, 2).Value =          DateValue(Format(.txtDateRaised.Value, &quot;DD/MM/YYYY&quot;)) in sub saverecord. It does not pass through the rownumber that&#39;s been picked up when searched."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568816449, "post_id": 57994751, "comment_id": 102396450, "body": "All variables declared <code>As Integer</code> should be declared <code>As Long</code>. Then, what is the value of <code>RecordNmbr</code> when that fails? I&#39;m assuming it&#39;s probably 0."}, {"owner": {"reputation": 1, "user_id": 12085422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MuWfSdcCZVc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPtqSO2r9pIkDarHPZY_gkafXR_g/photo.jpg?sz=128", "display_name": "ad6492", "link": "https://stackoverflow.com/users/12085422/ad6492"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568816586, "post_id": 57994751, "comment_id": 102396537, "body": "Hi BigBen, I&#39;ve changed the variables as you&#39;ve suggested. Also when it fails the value of &#39;RecordNmbr&#39; is <b>0</b>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568816773, "post_id": 57994751, "comment_id": 102396653, "body": "And that will fail, because Excel doesn&#39;t have a row 0. The <code>Public</code> variable setup could be / is problematic."}, {"owner": {"reputation": 1, "user_id": 12085422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MuWfSdcCZVc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPtqSO2r9pIkDarHPZY_gkafXR_g/photo.jpg?sz=128", "display_name": "ad6492", "link": "https://stackoverflow.com/users/12085422/ad6492"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568817063, "post_id": 57994751, "comment_id": 102396822, "body": "In which case, what variable would you suggest to overcome this? Dim?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568822561, "post_id": 57994751, "comment_id": 102400083, "body": "It&#39;s not as simple as declaring a new variable. You&#39;d need to refactor the existing code to some other schema than <code>Public</code> variables."}, {"owner": {"reputation": 1, "user_id": 12085422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MuWfSdcCZVc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPtqSO2r9pIkDarHPZY_gkafXR_g/photo.jpg?sz=128", "display_name": "ad6492", "link": "https://stackoverflow.com/users/12085422/ad6492"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568903374, "post_id": 57994751, "comment_id": 102430751, "body": "How would you go about doing this? Apologies - I am a beginner level with VBA..."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568911864, "post_id": 57994751, "comment_id": 102435120, "body": "It&#39;s kind of a broad topic, but <a href=\"https://stackoverflow.com/a/46772922/9245853\">this answer</a> is a start."}], "owner": {"reputation": 1, "user_id": 12085422, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MuWfSdcCZVc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPtqSO2r9pIkDarHPZY_gkafXR_g/photo.jpg?sz=128", "display_name": "ad6492", "link": "https://stackoverflow.com/users/12085422/ad6492"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568880271, "creation_date": 1568815774, "last_edit_date": 1568880271, "question_id": 57994751, "link": "https://stackoverflow.com/questions/57994751/excel-userform-to-search-and-update-existing-records", "title": "Excel UserForm to Search and Update Existing records", "body": "<p>I have this Excel Userform which allows you to Add, View Next/Previous &amp; First/Last records and also Search records within the Userform.</p>\n\n<p>I am having issues saving records after searching and updating a specific record. </p>\n\n<p>The UserForm has the following VBA code below.</p>\n\n<pre><code>    Private Sub btnClose_Click()\n        Me.Hide\n    End Sub\n\n    Private Sub btnFirst_Click()\n        FirstRecord\n    End Sub\n\n\n    Private Sub btnLast_Click()\n        Last Record\n    End Sub\n\n\n    Private Sub btnNew_Click()\n        NewRecord\n    End Sub\n\n\n    Private Sub btnNext_Click()\n        NextRecord\n    End Sub\n\n    Private Sub btnPrevious_Click()\n        PreviousRecord\n    End Sub\n\n    Private Sub btnSaveRecord_Click()\n        SaveRecord (RowNumber)\n    End Sub\n\n\n    'Private Sub cmdUpdateRec_Click()\n    '    EditRecord (RowNumber)\n    'End Sub\n\n    Private Sub SearchMemberID_Click()\n        SearchMemID\n    End Sub\n\n    Private Sub SearchMember_Click()\n        SearchMem\n    End Sub\n\n\n    Private Sub userform_initialize()\n\n     Dim strShtNameMenu As String\n\n     strShtNameMenu = \"Menu Options\"\n\n     Me.CBxCompUpheld.List = Sheets(strShtNameMenu).Range(\"Complaint_Upheld\").Value\n     Me.CBxIssueResolved.List = Sheets(strShtNameMenu).Range(\"Issue_Resolved\").Value\n     Me.CBxMemberSatisfied.List = Sheets(strShtNameMenu).Range(\"Member_Satisfied\").Value\n     Me.CBxCompAgainst.List = Sheets(strShtNameMenu).Range(\"Complaint_Against\").Value\n     Me.CBxDept.List = Sheets(strShtNameMenu).Range(\"Department\").Value\n     'Me.CBxOwner.List = Sheets(strShtNameMenu).Range(\"Owner\").Value\n     Me.CBxMember.List = Sheets(strShtNameMenu).Range(\"Member\").Value\n\n     ShowRecord (3)\n\n    End Sub\n</code></pre>\n\n<p>These CommandButtons are calling macros from a module which is below.</p>\n\n<pre><code>    Public shtNameLog As String\n    Public shtNameMenu As String\n    Public frmNameComplaints As String\n    Public RowNumber As Integer 'current row\n    'Dim RowNumber As Long\n    Public intLastRow As Integer 'last row\n    Public RecordRefNmbr As Integer\n    Dim strSrch As String\n\n    '''' First Record ''''\n\n    Sub FirstRecord()\n    Dim RecordRefNmbr\n    RecordRefNmbr = 3\n    ShowRecord (RecordRefNmbr)\n    End Sub\n\n    '''' Last Record ''''\n\n    Sub LastRecord()\n    Dim RecordRefNmbr\n    Sheets(\"Log\").Select\n    RecordRefNmbr = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    ShowRecord (RecordRefNmbr)\n    End Sub\n\n    '''' New Record ''''\n\n    Sub NewRecord()\n    Sheets(\"Log\").Select\n    intLastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    ShowRecord (intLastRow + 1)\n    End Sub\n\n    '''' Next Record ''''\n\n    Sub NextRecord()\n    Sheet1.Select\n    intLastRow = Sheet1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    If RowNumber = intLastRow Then\n       MsgBox \"This is the last complaint record.\", vbOKOnly, \"Last Record reached\"\n    Else\n       ShowRecord (RowNumber + 1)\n    End If\n    End Sub\n\n    '''' Previous Record ''''\n\n    Sub PreviousRecord()\n    If RowNumber = 3 Then\n        ShowRecord (RowNumber)\n        MsgBox \"This is the first complaint record.\", vbOKOnly, \"First Record reached\"\n    Else\n        ShowRecord (RowNumber - 1)\n    End If\n    End Sub\n\n    '''' Membership ID Search ''''\n\n    Sub SearchMemID()\n\n    Dim TBrow As Long\n    Dim BV As String ', strSrch As String\n    Dim RecordNmbr              As Integer\n    Dim strFormName             As String\n    '    Dim txtDateRaised           As Date 'String\n    '    Dim txtMemberID             As String\n    '    Dim txtName                 As String\n    '    Dim txtCompAgainst          As String\n    '    Dim txtCompCategory         As String\n    '    Dim txtDept                 As String\n    '    Dim txtInitialAdvisor       As String\n    '    Dim txtOwner                As String\n    '    Dim txtBriefDesc            As String\n    '    Dim txtFindings             As String\n    '    Dim txtOutcome              As String\n    '    Dim txtActions              As String\n    '    Dim txtComplaintUpheld      As String\n    '    Dim txtFollowUpDate         As Date 'String\n    '    Dim txtIssueResolved        As String\n    '    Dim txtMemberSatisfied      As String\n    '    Dim txtDateClosed           As Date 'String\n\n    shtNameLog = \"Log\"\n    strFormName = \"frmNameComplaints\"\n    'RecordNmbr = RecordRefNmbr\n    'RecordRefNmbr = RecordNmbr\n    RowNumber = RecordNmbr\n\n    strSrch = ComplaintsLog.TextBox2.Value\n    Set TB = Sheets(shtNameLog).Range(\"D:D\").Find(what:=strSrch, lookat:=xlPart)\n\n    If Not TB Is Nothing Then\n\n    RecordNmbr = TB.Row\n\n    With ComplaintsLog\n\n    .txtDateRaised.Value = Sheets(shtNameLog).Cells(RecordNmbr, 2).Value\n    .CBxMember.Value = Sheets(shtNameLog).Cells(RecordNmbr, 3).Value\n    .txtMemberID.Value = Sheets(shtNameLog).Cells(RecordNmbr, 4).Value\n    .txtName.Value = Sheets(shtNameLog).Cells(RecordNmbr, 5).Value\n    .CBxCompAgainst.Value = Sheets(shtNameLog).Cells(RecordNmbr, 6).Value\n    .txtCompCategory.Value = Sheets(shtNameLog).Cells(RecordNmbr, 7).Value\n    .CBxDept.Value = Sheets(shtNameLog).Cells(RecordNmbr, 8).Value\n    .txtInitialAdvisor.Value = Sheets(shtNameLog).Cells(RecordNmbr, 11).Value\n    .txtOwner.Value = Sheets(shtNameLog).Cells(RecordNmbr, 12).Value\n    .txtBriefDesc.Value = Sheets(shtNameLog).Cells(RecordNmbr, 9).Value\n    .txtFindings.Value = Sheets(shtNameLog).Cells(RecordNmbr, 10).Value\n    .txtOutcome.Value = Sheets(shtNameLog).Cells(RecordNmbr, 16).Value\n    .txtActions.Value = Sheets(shtNameLog).Cells(RecordNmbr, 17).Value\n    .CBxCompUpheld.Value = Sheets(shtNameLog).Cells(RecordNmbr, 13).Value\n    .txtFollowUpDate.Value = Sheets(shtNameLog).Cells(RecordNmbr, 14).Value\n    .CBxIssueResolved.Value = Sheets(shtNameLog).Cells(RecordNmbr, 15).Value\n    .CBxMemberSatisfied.Value = Sheets(shtNameLog).Cells(RecordNmbr, 18).Value\n    .txtDateClosed.Value = Sheets(shtNameLog).Cells(RecordNmbr, 19).Value\n\n    End With\n\n      Else\n    MsgBox \"Error, Value Not Found!\"\n    End\n    End If\n\n     BV = Cells(RecordNmbr, 2).Value\n\n    End Sub\n\n    '''' Customer/ Member Search ''''\n\n    Sub SearchMem()\n\n    'Dim TB As Range\n    Dim TBrow As Long\n    Dim BV As String ', strSrch As String\n    Dim strFormName             As String\n    '    Dim txtDateRaised           As Date 'String\n    '    Dim txtMemberID             As String\n    '    Dim txtName                 As String\n    '    Dim txtCompAgainst          As String\n    '    Dim txtCompCategory         As String\n    '    Dim txtDept                 As String\n    '    Dim txtInitialAdvisor       As String\n    '    Dim txtOwner                As String\n    '    Dim txtBriefDesc            As String\n    '    Dim txtFindings             As String\n    '    Dim txtOutcome              As String\n    '    Dim txtActions              As String\n    '    Dim txtComplaintUpheld      As String\n    '    Dim txtFollowUpDate         As Date 'String\n    '    Dim txtIssueResolved        As String\n    '    Dim txtMemberSatisfied      As String\n    '    Dim txtDateClosed           As Date 'String\n    Dim RecordNmbr As Integer\n\n    shtNameLog = \"Log\"\n    strFormName = \"frmNameComplaints\"\n    RecordNmbr = RecordRefNmbr\n    RowNumber = RecordNmbr\n\n    strSrch = ComplaintsLog.TextBox1.Value\n    Set TB = Sheets(shtNameLog).Range(\"E:E\").Find(what:=strSrch, lookat:=xlPart)\n\n    If Not TB Is Nothing Then\n\n    RecordNmbr = TB.Row\n\n    With ComplaintsLog\n\n    .txtDateRaised.Value = Sheets(shtNameLog).Cells(RecordNmbr, 2).Value\n    .CBxMember.Value = Sheets(shtNameLog).Cells(RecordNmbr, 3).Value\n    .txtMemberID.Value = Sheets(shtNameLog).Cells(RecordNmbr, 4).Value\n    .txtName.Value = Sheets(shtNameLog).Cells(RecordNmbr, 5).Value\n    .CBxCompAgainst.Value = Sheets(shtNameLog).Cells(RecordNmbr, 6).Value\n    .txtCompCategory.Value = Sheets(shtNameLog).Cells(RecordNmbr, 7).Value\n    .CBxDept.Value = Sheets(shtNameLog).Cells(RecordNmbr, 8).Value\n    .txtInitialAdvisor.Value = Sheets(shtNameLog).Cells(RecordNmbr, 11).Value\n    .txtOwner.Value = Sheets(shtNameLog).Cells(RecordNmbr, 12).Value\n    .txtBriefDesc.Value = Sheets(shtNameLog).Cells(RecordNmbr, 9).Value\n    .txtFindings.Value = Sheets(shtNameLog).Cells(RecordNmbr, 10).Value\n    .txtOutcome.Value = Sheets(shtNameLog).Cells(RecordNmbr, 16).Value\n    .txtActions.Value = Sheets(shtNameLog).Cells(RecordNmbr, 17).Value\n    .CBxCompUpheld.Value = Sheets(shtNameLog).Cells(RecordNmbr, 13).Value\n    .txtFollowUpDate.Value = Sheets(shtNameLog).Cells(RecordNmbr, 14).Value\n    .CBxIssueResolved.Value = Sheets(shtNameLog).Cells(RecordNmbr, 15).Value\n    .CBxMemberSatisfied.Value = Sheets(shtNameLog).Cells(RecordNmbr, 18).Value\n    .txtDateClosed.Value = Sheets(shtNameLog).Cells(RecordNmbr, 19).Value\n\n    End With\n\n    Else\n       MsgBox \"Error, Value Not Found!\"\n    End\n    End If\n\n    BV = Cells(RecordNmbr, 2).Value\n\n    End Sub\n\n    '''' Show Record ''''\n\n    Sub ShowRecord(RecordRefNmbr)\n\n    Dim RecordNmbr              As Integer\n    Dim strFormName             As String\n    Dim txtDateRaised           As Date 'String\n    Dim txtMemberID             As String\n    Dim txtName                 As String\n    Dim txtCompAgainst          As String\n    Dim txtCompCategory         As String\n    Dim txtDept                 As String\n    Dim txtInitialAdvisor       As String\n    Dim txtOwner                As String\n    Dim txtBriefDesc            As String\n    Dim txtFindings             As String\n    Dim txtOutcome              As String\n    Dim txtActions              As String\n    Dim txtComplaintUpheld      As String\n    Dim txtFollowUpDate         As Date 'String\n    Dim txtIssueResolved        As String\n    Dim txtMemberSatisfied      As String\n    Dim txtDateClosed           As Date 'String\n\n    shtNameLog = \"Log\"\n    strFormName = \"frmNameComplaints\"\n    RecordNmbr = RecordRefNmbr\n    RowNumber = RecordNmbr\n    With ComplaintsLog\n\n        .txtDateRaised.Value = Sheets(shtNameLog).Cells(RecordNmbr, 2).Value\n        .CBxMember.Value = Sheets(shtNameLog).Cells(RecordNmbr, 3).Value\n        .txtMemberID.Value = Sheets(shtNameLog).Cells(RecordNmbr, 4).Value\n        .txtName.Value = Sheets(shtNameLog).Cells(RecordNmbr, 5).Value\n        .CBxCompAgainst.Value = Sheets(shtNameLog).Cells(RecordNmbr, 6).Value\n        .txtCompCategory.Value = Sheets(shtNameLog).Cells(RecordNmbr, 7).Value\n        .CBxDept.Value = Sheets(shtNameLog).Cells(RecordNmbr, 8).Value\n        .txtInitialAdvisor.Value = Sheets(shtNameLog).Cells(RecordNmbr, 11).Value\n        .txtOwner.Value = Sheets(shtNameLog).Cells(RecordNmbr, 12).Value\n        .txtBriefDesc.Value = Sheets(shtNameLog).Cells(RecordNmbr, 9).Value\n        .txtFindings.Value = Sheets(shtNameLog).Cells(RecordNmbr, 10).Value\n        .txtOutcome.Value = Sheets(shtNameLog).Cells(RecordNmbr, 16).Value\n        .txtActions.Value = Sheets(shtNameLog).Cells(RecordNmbr, 17).Value\n        .CBxCompUpheld.Value = Sheets(shtNameLog).Cells(RecordNmbr, 13).Value\n        .txtFollowUpDate.Value = Sheets(shtNameLog).Cells(RecordNmbr, 14).Value\n        .CBxIssueResolved.Value = Sheets(shtNameLog).Cells(RecordNmbr, 15).Value\n        .CBxMemberSatisfied.Value = Sheets(shtNameLog).Cells(RecordNmbr, 18).Value\n        .txtDateClosed.Value = Sheets(shtNameLog).Cells(RecordNmbr, 19).Value\n\n    End With\n    End Sub\n\n    '''' Save Record ''''\n\n    Sub SaveRecord(RecordRefNmbr)\n    '\n    'Dim TBrow As Long\n    'Dim BV As String, strSrch As String\n    'Dim txtDateRaised           As Date 'String\n    'Dim txtMemberID             As String\n    'Dim txtName                 As String\n    'Dim txtCompAgainst          As String\n    'Dim txtCompCategory         As String\n    'Dim txtDept                 As String\n    'Dim txtInitialAdvisor       As String\n    'Dim txtOwner                As String\n    'Dim txtBriefDesc            As String\n    'Dim txtFindings             As String\n    'Dim txtOutcome              As String\n    'Dim txtActions              As String\n    'Dim txtComplaintUpheld      As String\n    'Dim txtFollowUpDate         As Date 'String\n    'Dim txtIssueResolved        As String\n    'Dim txtMemberSatisfied      As String\n    'Dim txtDateClosed           As Date 'String\n    Dim shtNameLog As String\n    Dim strFormName As String\n    Dim RecordNmbr As Integer\n    Dim RowNumber As String\n\n    shtNameLog = \"Log\"\n    strFormName = \"frmNameComplaints\"\n    RecordNmbr = RecordRefNmbr\n    'RowNumber = RecordNmbr\n    'RowNumber = RecordRefNmbr\n\n    With ComplaintsLog\n        If Not IsDate(.txtDateRaised.Value) Then\n            MsgBox \"Date Raised must be entered in format 'DD/MM/YYYY' \"\n    Else\n    Sheets(shtNameLog).Cells(RecordNmbr, 2).Value = DateValue(Format(.txtDateRaised.Value,            \n    \"DD/MM/YYYY\"))\n        End If\n        Sheets(shtNameLog).Cells(RecordNmbr, 3).Value = .CBxMember.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 4).Value = .txtMemberID.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 5).Value = .txtName.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 6).Value = .CBxCompAgainst.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 7).Value = .txtCompCategory.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 8).Value = .CBxDept.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 11).Value = .txtInitialAdvisor.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 12).Value = .txtOwner.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 9).Value = Replace(.txtBriefDesc.Value, Chr(10), \" \")\n        Sheets(shtNameLog).Cells(RecordNmbr, 10).Value = Replace(.txtFindings.Value, Chr(10), \" \")\n        Sheets(shtNameLog).Cells(RecordNmbr, 16).Value = Replace(.txtOutcome.Value, Chr(10), \" \")\n        Sheets(shtNameLog).Cells(RecordNmbr, 17).Value = Replace(.txtActions.Value, Chr(10), \" \")\n        Sheets(shtNameLog).Cells(RecordNmbr, 13).Value = .CBxCompUpheld.Value\n        If .txtFollowUpDate.Value = \"\" Then\n            Else\n                If Not IsDate(.txtFollowUpDate.Value) Then\n            MsgBox \"Follow Up Date must be entered in format 'DD/MM/YYYY' \"\n            Else\n                Sheets(shtNameLog).Cells(RecordNmbr, 14).Value = \n    DateValue(Format(.txtFollowUpDate.Value, \"DD/MM/YYYY\"))\n                End If\n        End If\n        Sheets(shtNameLog).Cells(RecordNmbr, 15).Value = .CBxIssueResolved.Value\n        Sheets(shtNameLog).Cells(RecordNmbr, 18).Value = .CBxMemberSatisfied.Value\n        If .txtDateClosed.Value = \"\" Then\n            Else\n                If Not IsDate(.txtDateClosed.Text) Then\n                    MsgBox \"Date Closed must be entered in format 'DD/MM/YYYY' \"\n            Else\n                Sheets(shtNameLog).Cells(RecordNmbr, 19).Value = \n     DateValue(Format(.txtDateClosed.Value, \"DD/MM/YYYY\"))\n                End If\n        End If\n    End With\n        MsgBox \"Record Saved\"\n    End Sub\n</code></pre>\n\n<p>With the current coding, when I attempt to update a record which I've searched for, it errors with the message</p>\n\n<blockquote>\n  <p>'run-time error 1004 Application-defined or object-defined error'.</p>\n</blockquote>\n\n<p>on the line</p>\n\n<pre><code>Sheets(shtNameLog).Cells(RecordNmbr, 2).Value = DateValue(Format(.txtDateRaised.Value, \"DD/MM/YYYY\"))\n</code></pre>\n\n<p>I did inherit this file/code, so and I am a beginner at VBA so any help would be useful. If there is a different/simpler approach that I can take I am open to suggestions. </p>\n\n<p><a href=\"https://i.stack.imgur.com/YljeM.png\" rel=\"nofollow noreferrer\">Click on this link to see what the userform looks like</a></p>\n"}, {"tags": ["excel", "xml", "vba", "xslt"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 11494405, "user_type": "registered", "profile_image": "https://graph.facebook.com/986605461545965/picture?type=large", "display_name": "Michi Ariovist", "link": "https://stackoverflow.com/users/11494405/michi-ariovist"}, "edited": false, "score": 0, "creation_date": 1568930215, "post_id": 58017305, "comment_id": 102442140, "body": "I&#39;ll try it on monday and give a feedback on how it worked out for me. Thank you a lot!"}], "tags": [], "owner": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "is_accepted": true, "score": 2, "last_activity_date": 1568918913, "creation_date": 1568918913, "answer_id": 58017305, "question_id": 57994607, "link": "https://stackoverflow.com/questions/57994607/how-to-change-this-vba-xslt-based-code-so-the-output-is-written-in-a-single-xml/58017305#58017305", "title": "How to change this VBA/XSLT-based code so the output is written in a single XML-File", "body": "<p>I wrote a VBA class module <code>SheetWrapper</code>:</p>\n\n<pre><code>Private mySheet As Object\n\nSub Init(sheet)\n    Set mySheet = sheet\nEnd Sub\n\nPublic Property Get Cell(rowIndex, cellIndex)\n    Cell = CStr(mySheet.Cells(rowIndex, cellIndex).Value)\nEnd Property\n</code></pre>\n\n<p>Then it is possible to use</p>\n\n<pre><code>Sub Param_XSLT_Process()\n    Dim xmlDoc As New MSXML2.DOMDocument60\n\n    Dim xslDoc As New MSXML2.FreeThreadedDOMDocument60\n\n    Dim xslTemp As New MSXML2.XSLTemplate60\n\n    Dim xslProc As MSXML2.IXSLProcessor\n\n    Dim resultDoc As New MSXML2.DOMDocument60\n\n    Dim worksheet As Object\n    Set worksheet = ActiveWorkbook.Worksheets(1)\n\n    Dim myWrapper As SheetWrapper\n    Set myWrapper = New SheetWrapper\n\n    myWrapper.Init worksheet\n\n\n    ' LOAD XML AND XSL FILES\n    xmlDoc.async = False\n    xmlDoc.Load \"C:\\SomePath\\template.xml\"\n\n    xslDoc.async = False\n    xslDoc.SetProperty \"AllowDocumentFunction\", True\n    xslDoc.Load \"C:\\SomePath\\sheet.xsl\"\n\n    ' INITIALIZE NEEDED OBJECTS\n    Set xslTemp.stylesheet = xslDoc\n    Set xslProc = xslTemp.createProcessor()\n\n    xslProc.addObject myWrapper, \"http://example.com/excel\"\n\n    xslProc.addParameter \"first-row-index\", 2, \"\"\n    xslProc.addParameter \"last-row-index\", ActiveWorkbook.Worksheets(1).UsedRange.Rows.Count, \"\"\n\n\n    xslProc.input = xmlDoc\n\n    xslProc.output = resultDoc\n\n    xslProc.transform\n\n    resultDoc.Save \"C:\\SomePath\\transformation-result.xml\"\nEnd Sub\n</code></pre>\n\n<p>together with the XSLT:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" version=\"1.0\"\n    xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\"\n    xmlns:excel=\"http://example.com/excel\"\n    exclude-result-prefixes=\"msxsl excel\"&gt;\n\n    &lt;xsl:param name=\"sheet\"/&gt;\n\n    &lt;xsl:param name=\"first-row-index\"/&gt;\n    &lt;xsl:param name=\"last-row-index\"/&gt;\n\n    &lt;xsl:template match=\"@* | node()\"&gt;\n        &lt;xsl:copy&gt;\n            &lt;xsl:apply-templates select=\"@* | node()\"/&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;\n\n    &lt;xsl:output indent=\"yes\"/&gt;\n\n    &lt;xsl:template match=\"AreaCodes\"&gt;\n        &lt;xsl:copy&gt;\n            &lt;xsl:call-template name=\"make-areas\"&gt;\n                &lt;xsl:with-param name=\"area\" select=\"Area\"/&gt;\n                &lt;xsl:with-param name=\"index\" select=\"$first-row-index\"/&gt;\n                &lt;xsl:with-param name=\"last\" select=\"$last-row-index\"/&gt;\n            &lt;/xsl:call-template&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;\n\n    &lt;xsl:template name=\"make-areas\"&gt;\n        &lt;xsl:param name=\"area\"/&gt;\n        &lt;xsl:param name=\"index\"/&gt;\n        &lt;xsl:param name=\"last\"/&gt;\n        &lt;xsl:apply-templates select=\"$area\"&gt;\n            &lt;xsl:with-param name=\"row-index\" select=\"$index\"/&gt;\n        &lt;/xsl:apply-templates&gt;\n        &lt;xsl:if test=\"$index &amp;lt; $last\"&gt;\n            &lt;xsl:call-template name=\"make-areas\"&gt;\n                &lt;xsl:with-param name=\"area\" select=\"$area\"/&gt;\n                &lt;xsl:with-param name=\"index\" select=\"$index + 1\"/&gt;\n                &lt;xsl:with-param name=\"last\" select=\"$last\"/&gt;\n            &lt;/xsl:call-template&gt;            \n        &lt;/xsl:if&gt;\n    &lt;/xsl:template&gt;\n\n    &lt;xsl:template match=\"Area\"&gt;\n        &lt;xsl:param name=\"row-index\"/&gt;\n        &lt;xsl:copy&gt;\n            &lt;xsl:apply-templates&gt;\n                &lt;xsl:with-param name=\"row-index\" select=\"$row-index\"/&gt;\n            &lt;/xsl:apply-templates&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;\n\n    &lt;xsl:template match=\"Area/Name\"&gt;\n        &lt;xsl:param name=\"row-index\"/&gt;\n        &lt;xsl:copy&gt;\n            &lt;xsl:value-of select=\"excel:get-Cell($row-index, 1)\"/&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;\n\n    &lt;xsl:template match=\"Area/Facility_Area\"&gt;\n        &lt;xsl:param name=\"row-index\"/&gt;\n        &lt;xsl:copy&gt;\n            &lt;xsl:value-of select=\"excel:get-Cell($row-index, 2)\"/&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;    \n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>I had hoped to be able to pass the Excel sheet object directly to XSLT to read out its cells but somehow MSXML didn't grok that.</p>\n"}], "owner": {"reputation": 51, "user_id": 11494405, "user_type": "registered", "profile_image": "https://graph.facebook.com/986605461545965/picture?type=large", "display_name": "Michi Ariovist", "link": "https://stackoverflow.com/users/11494405/michi-ariovist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 58017305, "answer_count": 1, "score": 1, "last_activity_date": 1568918913, "creation_date": 1568815362, "last_edit_date": 1568815518, "question_id": 57994607, "link": "https://stackoverflow.com/questions/57994607/how-to-change-this-vba-xslt-based-code-so-the-output-is-written-in-a-single-xml", "title": "How to change this VBA/XSLT-based code so the output is written in a single XML-File", "body": "<p>I got the following code as a result of a previous question. </p>\n\n<p>The meaning of the code was to iterate through an excelsheet and automatically fill XML-tags with cell contents. The Output was a XML-File for every ROW in this excelsheet.</p>\n\n<p>Now I have a very similar case and I know, that it can't be a lot to change to get it done. I want my code NOT to create a new XML-File for every row, but to fill everything in the same XML-File. </p>\n\n<p>I want to automatically fill in the content of this excel-table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XgiQo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XgiQo.png\" alt=\"excelfile\"></a></p>\n\n<p>into an XML-Template that initially looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Codes&gt;\n&lt;AreaCodes&gt;\n&lt;Area&gt;\n&lt;Name&gt;&lt;/Name&gt;\n&lt;Desc/&gt;\n&lt;Facility_Area&gt;&lt;/Facility_Area&gt;\n&lt;/Area&gt;\n&lt;/AreaCodes&gt;\n&lt;/Codes&gt;\n</code></pre>\n\n<p>The column FACILITY has to be moved in the Facility_Area-Tag.</p>\n\n<p>The column AREA has to be moved in the Name-Tag.</p>\n\n<p>All the nested tags inside of Area should be repeated.</p>\n\n<p>For my Excel-Example the output should look like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Codes&gt;\n&lt;AreaCodes&gt;\n&lt;Area&gt;\n&lt;Name&gt;RA 001&lt;/Name&gt;\n&lt;Desc/&gt;\n&lt;Facility_Area&gt;ZUF&lt;/Facility_Area&gt;\n&lt;/Area&gt;\n&lt;Area&gt;\n&lt;Name&gt;RA 002&lt;/Name&gt;\n&lt;Desc/&gt;\n&lt;Facility_Area&gt;ZUF&lt;/Facility_Area&gt;\n&lt;/Area&gt;\n&lt;Area&gt;\n&lt;Name&gt;RA 003&lt;/Name&gt;\n&lt;Desc/&gt;\n&lt;Facility_Area&gt;ZUF&lt;/Facility_Area&gt;\n&lt;/Area&gt;\n&lt;Area&gt;\n&lt;Name&gt;RA 004&lt;/Name&gt;\n&lt;Desc/&gt;\n&lt;Facility_Area&gt;ZUF&lt;/Facility_Area&gt;\n&lt;/Area&gt;\n...\n&lt;/AreaCodes&gt;\n&lt;/Codes&gt;\n</code></pre>\n\n<p>all in one file.</p>\n\n<p>This is the XSLT-Template I have atm:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" version=\"1.0\"&gt;\n    &lt;xsl:output method=\"xml\" indent=\"yes\" /&gt;\n\n    &lt;xsl:param name=\"facility\" /&gt;\n    &lt;xsl:param name=\"area\" /&gt;\n\n\n    &lt;!-- IDENTITY TRANSFORM --&gt;\n    &lt;xsl:template match=\"@*|node()\"&gt;\n        &lt;xsl:copy&gt;\n          &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n        &lt;/xsl:copy&gt;\n    &lt;/xsl:template&gt;\n\n    &lt;!-- Templates --&gt;\n\n\n&lt;xsl:template match=\"Codes/AreaCodes/Area/Name\"&gt;\n    &lt;xsl:copy&gt;\n        &lt;xsl:value-of select=\"$area\"/&gt;\n    &lt;/xsl:copy&gt;\n&lt;/xsl:template&gt;\n\n&lt;xsl:template match=\"Codes/AreaCodes/Area/Facility_Area\"&gt;\n    &lt;xsl:copy&gt;\n        &lt;xsl:value-of select=\"$facility\"/&gt;\n    &lt;/xsl:copy&gt;\n&lt;/xsl:template&gt;\n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>and last but not least the VBA-Code in which everything comes together:</p>\n\n<pre><code>    Sub Param_XSLT_Process()\n\n...\n\n        ' LOAD XML AND XSL FILES\n       xmldoc.async = False\n        xmldoc.Load \"Path\\To\\Vorlage_AREA.xml\"\n\n        xslDoc.async = False\n        xslDoc.setProperty \"AllowDocumentFunction\", True\n        xslDoc.Load \"Path\\To\\XSL_SHEET.xsl\"\n\n        ' INITIALIZE NEEDED OBJECTS\n       Set xslTemp.stylesheet = xslDoc\n        Set xslProc = xslTemp.createProcessor()\n\n        xslProc.input = xmldoc\n\n        ' ITERATE THROUGH EACH ROW, TRANSFORM, SAVE XML OUTPUT\n       With ActiveWorkbook.Worksheets(1)\n           lLastRow = .UsedRange.Rows.Count\n\n           For lRow = 2 To lLastRow\n               xslProc.addParameter \"area\", CStr(.Cells(lRow, 2).Value)    ' ADD PARAMETER(S)\n              xslProc.addParameter \"facility\", CStr(.Cells(lRow, 1).Value)\n\n               xslProc.transform                                            ' TRANSFORM XML\n               newDoc.LoadXML xslProc.output                                ' LOAD RESULT TREE\n               newDoc.Save \"Path\\To\\Output_\" &amp; lRow - 1 &amp; \".xml\"         ' SAVE OUTPUT TO FILE\n          Next lRow\n        End With\n...\n    End Sub\n</code></pre>\n\n<p>Right now, everything is dropped in a separate XML-File.</p>\n\n<p>Could anyone tell me, what i have to change? I know that, for my VBA-Code, I should move those save-commands outside of the loop, but that doesn't work.</p>\n\n<p>Sorry for struggling with English and thank you all for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "edited": false, "score": 1, "creation_date": 1568815453, "post_id": 57994562, "comment_id": 102395840, "body": "Is the data being shown in one cell when you load the CSV file back in Excel? If you open the CSV file in a text editor, does the data look good?"}, {"owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "reply_to_user": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "edited": false, "score": 0, "creation_date": 1568817135, "post_id": 57994562, "comment_id": 102396869, "body": "If I open file in Notepad for example it drops &quot;,&quot; after each cell that is not correct I guess. As you can see from screenshot it drops &quot;,&quot; after each cell value also... 1,2,3,4,5,6. There are no &quot;,&quot; in original Excel (screenshot #1)."}], "answers": [{"tags": [], "owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "is_accepted": true, "score": 1, "last_activity_date": 1568819144, "last_edit_date": 1568819144, "creation_date": 1568817726, "answer_id": 57995440, "question_id": 57994562, "link": "https://stackoverflow.com/questions/57994562/excel-drops-all-the-data-to-one-cell-after-saving-to-csv/57995440#57995440", "title": "Excel drops all the data to one cell after saving to CSV", "body": "<p>To properly import CSV data in Excel, use the \"From Text\" wizard under the \"Data\" tab. It will let you specify a delimiter (\",\" in your case).</p>\n\n<p>Your data seems to be exporting to CSV properly, the added commas are there to separate the cells (hence the name Comma Separated Values).</p>\n\n<p><a href=\"https://www.hesa.ac.uk/support/user-guides/import-csv\" rel=\"nofollow noreferrer\">Importing *.csv formatted data into Excel</a></p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57995440, "answer_count": 1, "score": 1, "last_activity_date": 1568819144, "creation_date": 1568815228, "last_edit_date": 1568815721, "question_id": 57994562, "link": "https://stackoverflow.com/questions/57994562/excel-drops-all-the-data-to-one-cell-after-saving-to-csv", "title": "Excel drops all the data to one cell after saving to CSV", "body": "<p>I have code that copies range <code>Range(\"A100:AC101\")</code>. There are no merged cell or anything else. There is a value in each cell.</p>\n\n<p>Can somebody tell me why after saving to CSV Excel drops all the data to two cells:</p>\n\n<ul>\n<li>A100:AC100 are in A1  </li>\n<li>A101:AC101 are in B1</li>\n</ul>\n\n<p>Data before code operation in Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zlLZa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zlLZa.png\" alt=\"enter image description here\"></a></p>\n\n<p>Data in saved CSV file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tHmWY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tHmWY.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried to comment out:</p>\n\n<pre><code>ActiveSheet.SaveAs Environ$(\"USERPROFILE\") &amp; \"\\Desktop\\\" &amp; \"file1.csv\", FileFormat:=xlCSV, CreateBackup:=False\n\nActiveWorkbook.Close\n</code></pre>\n\n<p>and data seems to be copied correct - each value in own cell. Then after saving to CSV things start to go wrong...</p>\n\n<p>Here is my code:   </p>\n\n<pre><code>Sub ExportRangeToCsv()\n\nApplication.ScreenUpdating = False\n\nThisWorkbook.Sheets(\"Templates\").Range(\"A100:AC101\").Copy\n\nApplication.DisplayAlerts = False 'avoid from \"save prompt window\"\n\nWorkbooks.Add\n\nActiveSheet.Paste\n\nActiveSheet.SaveAs Environ$(\"USERPROFILE\") &amp; \"\\Desktop\\\" &amp; \"file1.csv\", FileFormat:=xlCSV, CreateBackup:=False\n\nActiveWorkbook.Close\n\nApplication.DisplayAlerts = True 'set to default\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "format", "excel-charts", "pivot-chart"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568815251, "post_id": 57994544, "comment_id": 102395709, "body": "If you comment out those instances of <code>On Error Resume Next</code>, do you get an error? If so, what is the message and what line throws it?"}, {"owner": {"reputation": 37, "user_id": 12041350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50f53f555b2b611aa26afed17b6c77d?s=128&d=identicon&r=PG&f=1", "display_name": "SSGrace", "link": "https://stackoverflow.com/users/12041350/ssgrace"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568815369, "post_id": 57994544, "comment_id": 102395783, "body": "Hello,  @BigBen, i don&#39;t get any error when I comment out those instances."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1568815439, "post_id": 57994544, "comment_id": 102395831, "body": "@SSGrace The way you used <code>On Error Resume Next</code> is the worst practice (it hides all error massages but the errors still occur, and you will never notice if something fails in your code). Never use it alone. For further information you might benefit of reading <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>"}, {"owner": {"reputation": 37, "user_id": 12041350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50f53f555b2b611aa26afed17b6c77d?s=128&d=identicon&r=PG&f=1", "display_name": "SSGrace", "link": "https://stackoverflow.com/users/12041350/ssgrace"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568815623, "post_id": 57994544, "comment_id": 102395936, "body": "Hi, @P\u1d07\u029c, I didn&#39;t know, but I&#39;ll watch it from now on, thanks for the info!"}, {"owner": {"reputation": 37, "user_id": 12041350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50f53f555b2b611aa26afed17b6c77d?s=128&d=identicon&r=PG&f=1", "display_name": "SSGrace", "link": "https://stackoverflow.com/users/12041350/ssgrace"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568878397, "post_id": 57994544, "comment_id": 102416626, "body": "Besides the on-error-resume-next, do you have other suggestions, @P\u1d07\u029c?"}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 12041350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50f53f555b2b611aa26afed17b6c77d?s=128&d=identicon&r=PG&f=1", "display_name": "SSGrace", "link": "https://stackoverflow.com/users/12041350/ssgrace"}, "is_accepted": true, "score": 1, "last_activity_date": 1568892113, "creation_date": 1568892113, "answer_id": 58009867, "question_id": 57994544, "link": "https://stackoverflow.com/questions/57994544/pivot-chart-formats/58009867#58009867", "title": "Pivot chart formats", "body": "<p>SOLVED: I just needed to add a ActiveChart.SeriesCollection(srs_name).Format.Line.Visible = True line.</p>\n\n<p>This is how it got:</p>\n\n<pre><code>Dim srs_name As String   \nDim srs As Integer\n\nActiveSheet.ChartObjects(\"Diagramm 7\").Activate\n\n         'formatting Shipped Qty series\nsrs_name = \"Shipped qty\"\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlColumnStacked\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(255, 192, 0)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(255, 192, 0)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nEnd If\n\n         'formatting Order series\nsrs_name = \"Order\"\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlColumnStacked\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(91, 155, 213)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nEnd If\n\n        'formatting Sales series\nsrs_name = \"Sales\"\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlLine\n    ActiveChart.SeriesCollection(srs_name).Format.Line.Visible = True\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(165, 165, 165)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(165, 165, 165)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nEnd If\n\n       'formatting Transport series\nsrs_name = \"Transport\"\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlColumnStacked\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(237, 125, 49)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(237, 125, 49)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nElse\nEnd If\n\n       'formatting a 5th series, if needed\nsrs = ActiveSheet.ChartObjects(\"Diagramm 7\").Chart.SeriesCollection.Count\nIf srs &gt; 4 Then\n    ActiveChart.SeriesCollection(5).ChartType = xlArea\n    ActiveChart.SeriesCollection(5).Format.Fill.ForeColor.RGB = RGB(222, 235, 247)\n    ActiveChart.SeriesCollection(5).Format.Line.ForeColor.RGB = RGB(222, 235, 247)\n    ActiveChart.SeriesCollection(5).AxisGroup = 1\nEnd If\n\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1568895058, "last_edit_date": 1568895058, "creation_date": 1568894686, "answer_id": 58010632, "question_id": 57994544, "link": "https://stackoverflow.com/questions/57994544/pivot-chart-formats/58010632#58010632", "title": "Pivot chart formats", "body": "<p>I think <code>If Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then</code> will throw an exeption if the series name does not exist. Instead I recommend a function for this to test if <code>SeriesExists</code>.</p>\n\n<p>Also I recommend not to use <code>Activate</code> and <code>ActiveChart</code> (see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>). Instead specify the chart by its name.</p>\n\n<p>Note that you don't need to count the number of series to test if there is a 5\u1d57\u02b0 one. You can just use <code>SeriesExists(MyChart, 5)</code> to test this.</p>\n\n<p>I recommend something like the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FormatCharts()\n    Dim ws As Worksheet\n    Set ws = ActiveSheet 'better something like ThisWorkbook.Worksheets(\"Tabelle 1\")\n\n    Dim MyChart As Chart\n    Set MyChart = ws.ChartObjects(\"Diagramm 7\").Chart\n\n    Dim srs_name As String\n\n    'formatting Shipped Qty series\n    srs_name = \"Shipped qty\"\n    If SeriesExists(MyChart, srs_name) Then\n        With MyChart.SeriesCollection(srs_name)\n            .ChartType = xlColumnStacked\n            .Format.Fill.ForeColor.RGB = RGB(255, 192, 0)\n            .Format.Line.ForeColor.RGB = RGB(255, 192, 0)\n            .AxisGroup = 1\n        End With\n    End If\n\n   'formatting Order series\n    srs_name = \"Order\"\n    If SeriesExists(MyChart, srs_name) Then\n        With MyChart.SeriesCollection(srs_name)\n            .ChartType = xlColumnStacked\n            .Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n            .Format.Line.ForeColor.RGB = RGB(91, 155, 213)\n            .AxisGroup = 1\n        End With\n    End If\n\n    'formatting Sales series\n    srs_name = \"Sales\"\n    If SeriesExists(MyChart, srs_name) Then\n        With MyChart.SeriesCollection(srs_name)\n            .ChartType = xlLine\n            .Format.Line.Visible = True\n            .Format.Fill.ForeColor.RGB = RGB(165, 165, 165)\n            .Format.Line.ForeColor.RGB = RGB(165, 165, 165)\n            .AxisGroup = 1\n        End With\n    End If\n\n    'formatting Transport series\n    srs_name = \"Transport\"\n    If SeriesExists(MyChart, srs_name) Then\n        With MyChart.SeriesCollection(srs_name)\n            .ChartType = xlColumnStacked\n            .Format.Fill.ForeColor.RGB = RGB(237, 125, 49)\n            .Format.Line.ForeColor.RGB = RGB(237, 125, 49)\n            .AxisGroup = 1\n        End With\n    End If\n\n    'formatting a 5th series, if needed\n     If SeriesExists(MyChart, 5) Then \n        With MyChart.SeriesCollection(5)\n            .ChartType = xlArea\n            .Format.Fill.ForeColor.RGB = RGB(222, 235, 247)\n            .Format.Line.ForeColor.RGB = RGB(222, 235, 247)\n            .AxisGroup = 1\n        End With\n    End If\nEnd Sub\n\nPrivate Function SeriesExists(InChart As Chart, SeriesName As Variant) As Boolean\n    Dim TestSeries As Series\n    On Error Resume Next\n    Set TestSeries = InChart.SeriesCollection(SeriesName)\n    On Error GoTo 0\n    SeriesExists = Not TestSeries Is Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12041350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50f53f555b2b611aa26afed17b6c77d?s=128&d=identicon&r=PG&f=1", "display_name": "SSGrace", "link": "https://stackoverflow.com/users/12041350/ssgrace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58009867, "answer_count": 2, "score": 1, "last_activity_date": 1568895058, "creation_date": 1568815184, "last_edit_date": 1568815563, "question_id": 57994544, "link": "https://stackoverflow.com/questions/57994544/pivot-chart-formats", "title": "Pivot chart formats", "body": "<p>very VBA-knowledgeable people,</p>\n\n<p>I have a pivot chart going on, and I wrote a sub to format the series representation. This chart contains four series and is connected to a slicer. </p>\n\n<p>The problem is that the formats aren't working for some of the slicer's buttons, because one of the series formats disappear. This series format should be a grey line; the data points are there, but the line and fill color are absent.</p>\n\n<p>I already debuged the thing and used the watch to check what's going on, but everything's fine and running as it should. When I F8 the macro, after the series that isn't working, I try using the mouse to force the color on the graph line and it works.</p>\n\n<p>Do you have any suggestion of where should I look for the problema? Does this also happen to your pivot charts?</p>\n\n<p>I wrote this code:</p>\n\n<pre><code>Dim srs_name As String   \nDim srs As Integer\n\n\nActiveSheet.ChartObjects(\"Diagramm 7\").Activate\n\n         'formatting Shipped Qty series\nsrs_name = \"Shipped qty\"\nOn Error Resume Next\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlColumnStacked\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(255, 192, 0)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(255, 192, 0)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nEnd If\n\n         'formatting Order series\nsrs_name = \"Order\"\nOn Error Resume Next\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlColumnStacked\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(91, 155, 213)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nEnd If\n\n        'formatting Sales series\nsrs_name = \"Sales\"\nOn Error Resume Next\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlLine\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(165, 165, 165)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(165, 165, 165)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nEnd If\n\n       'formatting Transport series\nsrs_name = \"Transport\"\nOn Error Resume Next\nIf Not ActiveChart.SeriesCollection(srs_name) Is Nothing Then\n    ActiveChart.SeriesCollection(srs_name).ChartType = xlColumnStacked\n    ActiveChart.SeriesCollection(srs_name).Format.Fill.ForeColor.RGB = RGB(237, 125, 49)\n    ActiveChart.SeriesCollection(srs_name).Format.Line.ForeColor.RGB = RGB(237, 125, 49)\n    ActiveChart.SeriesCollection(srs_name).AxisGroup = 1\nElse\nEnd If\n\n       'formatting a 5th series, if needed\nsrs = ActiveSheet.ChartObjects(\"Diagramm 7\").Chart.SeriesCollection.Count\nIf srs &gt; 4 Then\n    ActiveChart.SeriesCollection(5).ChartType = xlArea\n    ActiveChart.SeriesCollection(5).Format.Fill.ForeColor.RGB = RGB(222, 235, 247)\n    ActiveChart.SeriesCollection(5).Format.Line.ForeColor.RGB = RGB(222, 235, 247)\n    ActiveChart.SeriesCollection(5).AxisGroup = 1\nEnd If\n\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1568814806, "creation_date": 1568814806, "answer_id": 57994400, "question_id": 57994183, "link": "https://stackoverflow.com/questions/57994183/how-do-i-skip-a-newly-created-folder-while-looping-through-sub-folders/57994400#57994400", "title": "How do I skip a newly created folder while looping through sub folders?", "body": "<p>In DrillDown you should add the check you mentioned where you loop through the SubFolders:</p>\n\n<pre><code>For Each fld In fldStart.SubFolders\n    If InStr(1, fld.Name, \"Original DWGs \") = 0 Then ListFolders fld, Mask\nNext\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12015166, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA-X35VMqjwHTtfHQbvZgZV_uBK39e_hLr2iminNg=k-s128", "display_name": "danny smith", "link": "https://stackoverflow.com/users/12015166/danny-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1569225050, "creation_date": 1568814153, "last_edit_date": 1569225050, "question_id": 57994183, "link": "https://stackoverflow.com/questions/57994183/how-do-i-skip-a-newly-created-folder-while-looping-through-sub-folders", "title": "How do I skip a newly created folder while looping through sub folders?", "body": "<p>I've cobbled together lots of code from various previous posts (thanks to all of you!) and I almost have a working solution.\nWhat I would like to happen is:</p>\n\n<ul>\n<li>user chooses a folder</li>\n<li>a new folder is created inside that folder and some .dwg files moved to it</li>\n<li>the code then drills down to the next folder and does the same.</li>\n</ul>\n\n<p>My problem is that the code is drilling down into the newly created folder and creating and endless cycle. Is there a way to skip the folder that i have just created? The folder is always named \"Original DWGs DD-mm-yy\" so I was thinking about adding </p>\n\n<pre><code>If InStr(FromPath, \"original\") = 0 Then\nExit Sub\nEnd If\n</code></pre>\n\n<p>But I don't think \"exit sub\" is the right thing to do inside the fso loop?</p>\n\n<pre><code>Option Explicit\nDim sFolder As String\n\nSub CommandButton1_Click()\n\n    ' Open the select folder prompt\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        If .Show = -1 Then ' if OK is pressed\n            sFolder = .SelectedItems(1)\n        End If\n    End With\n\n    If sFolder &lt;&gt; \"\" Then ' if a file was chosen\n   Debug.Print sFolder\n    End If\n\nDrillDown\n\nEnd Sub\n\nSub DrillDown()\n    Dim FSO As Object 'FileSystemObject\n    Dim fldStart As Object 'Folder\n    Dim fld As Object 'Folder\n    Dim fl As Object 'File\n    Dim Mask As String\n\n    Set FSO = CreateObject(\"scripting.FileSystemObject\") ' late binding\n\n    Set fldStart = FSO.GetFolder(sFolder) ' &lt;-- use your FileDialog code here\n\n    Mask = \"*.dwg\"\n       For Each fld In fldStart.SubFolders\n        ListFolders fld, Mask\n    Next\nEnd Sub\n\n\nSub ListFolders(fldStart As Object, Mask As String)\n    Dim fld As Object 'Folder\n    Dim FromPath As String\n\n    For Each fld In fldStart.SubFolders\n        Debug.Print fld.Path &amp; \"\\\"\n\n'move all specified files from FromPath to ToPath.\n'Note: It will create the folder ToPath for you\n    Dim FSO As Object\n    Dim ToPath As String\n    Dim FileExt As String\n    Dim FNames As String\n    Dim diaFolder As FileDialog\n    Dim selected As Boolean\n    Dim FldCheck As String\n\n    FromPath = fld.Path &amp; \"\\\"\n\n    ToPath = FromPath &amp; \"Original DWGs \" &amp; Format(Date, \"dd-mm-yy\")  '&lt;&lt; Change only the destination folder\n\nDebug.Print ToPath\n\n    FileExt = \"*.dwg\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        MsgBox \"No .dwg files in \" &amp; FromPath\n       'Exit Sub\n       GoTo Err\n         End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n\nIf FSO.FolderExists(ToPath) = False Then\n        FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n\nErr:\n    FileExt = \"*.err\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        'MsgBox \"No .err files in \" &amp; FromPath\n        'Exit Sub\n        GoTo Bak\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\nIf FSO.FolderExists(ToPath) = False Then\n   FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n\n\n    '---\nBak:\n    FileExt = \"*.bak\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        'MsgBox \"No .bak files in \" &amp; FromPath\n        'Exit Sub\n        GoTo Log\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\nIf FSO.FolderExists(ToPath) = False Then\n   FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n\n    '---\nLog:\n    FileExt = \"*.log\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        'MsgBox \"No .log files in \" &amp; FromPath\n        Exit Sub\n        End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\nIf FSO.FolderExists(ToPath) = False Then\n   FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n\n    Set diaFolder = Nothing\n\n        ListFolders fld, Mask\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I've added the code as suggested. However now it loops through and creates 6 \"original DWG\" each inside the previous one, and moves the files into the 5th level. Then I get a path not found error?</p>\n\n<p>File path after the code has run:\nC:\\Users\\d.holpin\\Desktop\\Matts Data\\New folder\\E2000 Circuit Drawings\\85100004 ELECTRICAL CIRCUIT**ARCHIVE**\\Original DWGs 23-09-19\\Original DWGs 23-09-19\\Original DWGs 23-09-19\\Original DWGs 23-09-19**Original DWGs 23-09-19**\\Original DWGs 23-09-19</p>\n\n<p>Files have been moved from Archive to the second to last Original DWGs (highlighted in bold)</p>\n\n<p>Code as it stands is:</p>\n\n<pre><code>Option Explicit\nDim sFolder As String\n\nSub CommandButton1_Click()\n\n    ' Open the select folder prompt\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        If .Show = -1 Then ' if OK is pressed\n            sFolder = .SelectedItems(1)\n        End If\n    End With\n\n    If sFolder &lt;&gt; \"\" Then ' if a file was chosen\n   Debug.Print sFolder\n    End If\n\nDrillDown\n\nEnd Sub\n\nSub DrillDown()\n    Dim FSO As Object 'FileSystemObject\n    Dim fldStart As Object 'Folder\n    Dim fld As Object 'Folder\n    Dim fl As Object 'File\n    Dim Mask As String\n    Dim test As String\n\n    Set FSO = CreateObject(\"scripting.FileSystemObject\") ' late binding\n\n    Set fldStart = FSO.GetFolder(sFolder) ' &lt;-- use your FileDialog code here\n\n    Mask = \"*.dwg\"\n\n    For Each fld In fldStart.SubFolders\n    test = InStr(1, fld.Name, \"Original DWGs \")\n    Debug.Print test\n    If InStr(1, fld.Name, \"Original DWGs \") = 0 Then ListFolders fld, Mask\n\n    Next\n\n       'For Each fld In fldStart.SubFolders\n        'ListFolders fld, Mask\n    'Next\nEnd Sub\n\n\nSub ListFolders(fldStart As Object, Mask As String)\n    Dim fld As Object 'Folder\n    Dim FromPath As String\n\n    For Each fld In fldStart.SubFolders '2nd tme around it jump from here to the end if listfolders?\n\n     Debug.Print fld.Path &amp; \"\\\"\n\n'move all specified files from FromPath to ToPath.\n'Note: It will create the folder ToPath for you\n    Dim FSO As Object\n    Dim ToPath As String\n    Dim FileExt As String\n    Dim FNames As String\n    Dim diaFolder As FileDialog\n    Dim selected As Boolean\n    Dim FldCheck As String\nFromPath = \"\"\n    FromPath = fld.Path &amp; \"\\\"\n\n    ToPath = FromPath &amp; \"Original DWGs \" &amp; Format(Date, \"dd-mm-yy\")  '&lt;&lt; Change only the destination folder\n\nDebug.Print ToPath\n\n    FileExt = \"*.dwg\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        'MsgBox \"No .dwg files in \" &amp; FromPath\n       'Exit Sub\n       GoTo Err\n         End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n\nIf FSO.FolderExists(ToPath) = False Then\n        FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n\nErr:\n    FileExt = \"*.err\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        'MsgBox \"No .err files in \" &amp; FromPath\n        'Exit Sub\n        GoTo Bak\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\nIf FSO.FolderExists(ToPath) = False Then\n   FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n\n\n    '---\nBak:\n    FileExt = \"*.bak\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        'MsgBox \"No .bak files in \" &amp; FromPath\n        'Exit Sub\n        GoTo Log\n    End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\nIf FSO.FolderExists(ToPath) = False Then\n   FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\n\n    '---\nLog:\n    FileExt = \"*.log\"   '&lt;&lt; Change\n\n    If Right(FromPath, 1) &lt;&gt; \"\\\" Then\n        FromPath = FromPath &amp; \"\\\"\n    End If\n\n    FNames = Dir(FromPath &amp; FileExt)\n    If Len(FNames) = 0 Then\n        'MsgBox \"No .log files in \" &amp; FromPath\n        'Exit Sub\n        GoTo FIN\n        End If\n\n    Set FSO = CreateObject(\"scripting.filesystemobject\")\n\nIf FSO.FolderExists(ToPath) = False Then\n   FSO.CreateFolder (ToPath)\nEnd If\n\n    FSO.MoveFile Source:=FromPath &amp; FileExt, Destination:=ToPath\nFIN:\n    Set diaFolder = Nothing\n    FromPath = \"\"\n\n    ToPath = \"\"\n\n        ListFolders fld, Mask\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 373, "user_id": 12046360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BVtTb.jpg?s=128&g=1", "display_name": "Plato77", "link": "https://stackoverflow.com/users/12046360/plato77"}, "edited": false, "score": 0, "creation_date": 1568814309, "post_id": 57994159, "comment_id": 102395087, "body": "What have you tried to do so far?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568814615, "post_id": 57994159, "comment_id": 102395286, "body": "Vba would me something amongst the lines of: <code>Cell.Formula = &quot;=&quot; &amp; External_link_1.value &amp; &quot;*&quot; &amp; External_link_2.value &amp; &quot;+ 175&quot;</code>"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568815215, "post_id": 57994159, "comment_id": 102395694, "body": "<a href=\"https://excelribbon.tips.net/T007566_Replacing_Links_with_Values.html\" rel=\"nofollow noreferrer\">This might be of use for you</a>, an extensive article with three different methods to achieve what you are trying here, with tutorials and explanations for each."}, {"owner": {"reputation": 1, "user_id": 12085418, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102787738502103/picture?type=large", "display_name": "Akhil Kapur", "link": "https://stackoverflow.com/users/12085418/akhil-kapur"}, "edited": false, "score": 0, "creation_date": 1568816276, "post_id": 57994159, "comment_id": 102396334, "body": "Unfortunately those methods evaluate the whole formula and give the value, i am looking to keep the structure of the formula replaced with values. Also I won&#39;t know what the external link is in each spreadsheet in order to define a find and replace."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1568898250, "post_id": 57994159, "comment_id": 102427499, "body": "Give some more details. How do want to replace external values (through some VBA code or else) and how &amp; when to restore to original formula."}], "owner": {"reputation": 1, "user_id": 12085418, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102787738502103/picture?type=large", "display_name": "Akhil Kapur", "link": "https://stackoverflow.com/users/12085418/akhil-kapur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568815090, "creation_date": 1568814080, "last_edit_date": 1568815090, "question_id": 57994159, "link": "https://stackoverflow.com/questions/57994159/in-excel-can-someone-help-me-with-a-macro-that-can-change-external-links-to-val", "title": "In Excel, can someone help me with a macro that can change external links to values but maintain the formulas used with the links", "body": "<p>So lets say the formula is = external link1 * external link2 + 175\nI want it to change the formula to = 5 * 6 + 175</p>\n\n<p>Assuming the value of external link1 is 5 and the value of externallink2 is 6.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "python-3.x", "vba"], "comments": [{"owner": {"reputation": 373, "user_id": 12046360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BVtTb.jpg?s=128&g=1", "display_name": "Plato77", "link": "https://stackoverflow.com/users/12046360/plato77"}, "edited": false, "score": 0, "creation_date": 1568814519, "post_id": 57993793, "comment_id": 102395222, "body": "When you view them in the developer screen, are your macros stored in a sheet, in ThisWorkbook or on your profile?  What are your macro security settings set to?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1568819439, "post_id": 57993793, "comment_id": 102398305, "body": "Your code doesn&#39;t open <code>Macro.xlsm</code> --- how do you know it&#39;s open?"}, {"owner": {"reputation": 11, "user_id": 12080582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vSLySYqezWA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reiNERTHyWj_Z8IZoSMLoak4AbEdg/photo.jpg?sz=128", "display_name": "Mohit", "link": "https://stackoverflow.com/users/12080582/mohit"}, "reply_to_user": {"reputation": 373, "user_id": 12046360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BVtTb.jpg?s=128&g=1", "display_name": "Plato77", "link": "https://stackoverflow.com/users/12046360/plato77"}, "edited": false, "score": 0, "creation_date": 1568827033, "post_id": 57993793, "comment_id": 102401899, "body": "@Plato77 Macros are stored in the workbook itself. Macros are enabled."}], "owner": {"reputation": 11, "user_id": 12080582, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vSLySYqezWA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reiNERTHyWj_Z8IZoSMLoak4AbEdg/photo.jpg?sz=128", "display_name": "Mohit", "link": "https://stackoverflow.com/users/12080582/mohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568987882, "creation_date": 1568812878, "last_edit_date": 1568987882, "question_id": 57993793, "link": "https://stackoverflow.com/questions/57993793/code-executes-sometimes-and-gives-error-for-the-other-times", "title": "Code executes sometimes and gives error for the other times", "body": "<p>I am trying to automate a process in excel.  I have called two macros from Python.  The code executes successfully sometimes and sometimes gives an error.  I have saved the macros and the python file in the same location.</p>\n\n<pre><code>import os,os.path\nimport win32com.client\nPath = 'xyz'\nif os.path.exists(r'D:\\Code\\ABC.xlsx'):\n    xl = win32com.client.Dispatch(\"Excel.Application\")\n    xl.Workbooks.Open(os.path.abspath('D:\\Code\\ABC.xlsx'))\n    xl.Application.Run(Macro.xlsm!Module1.Macro1, Path)\n    xl.Application.Run(Macro.xlsm!Module2.Macro2)\n    xl.Application.ActiveWorkbook.Save()\n    del xl\n</code></pre>\n\n<p>The error that it gives at times is:</p>\n\n<blockquote>\n  <p>(-2147352567, 'Exception occured.',(0,''Microsoft Excel','Cannot run\n  macro 'D:\\Code\\Macro.xlsm!Module1.Macro1'. The macro may not be\n  available in this workbook or all macros may be disabled',\n  'xlmain11.chm, 0, -2146827284'), None)</p>\n</blockquote>\n\n<p>I am getting a new error, which is constant:\n//winp-oaf-118/FldrRedir_3$/Data/Macro.xlsm' cannot be found.Check your spelling, or try a different path.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 3, "creation_date": 1568812666, "post_id": 57993665, "comment_id": 102394095, "body": "Use the function day(), it returns just the day of the month"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568812673, "post_id": 57993665, "comment_id": 102394099, "body": "Do you mean the first or second <i>work</i> day?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1568812699, "post_id": 57993665, "comment_id": 102394119, "body": "<i>How do I find if it&#39;s the first or second day of the month?</i> Well, <code>If Day(date)=1 Then msgbox &quot;It&#39;s 1st&quot; </code>"}, {"owner": {"reputation": 43, "user_id": 11200950, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4tvARF8C4U8/AAAAAAAAAAI/AAAAAAAAE-4/-1luT0F6bHs/photo.jpg?sz=128", "display_name": "Mohd Reza", "link": "https://stackoverflow.com/users/11200950/mohd-reza"}, "edited": false, "score": 0, "creation_date": 1568875300, "post_id": 57993665, "comment_id": 102415047, "body": "Thank you all for your kind answers, sticking with simplicity, Foxfire&#39;s code looks like what I want, I tried modifying it like so but it&#39;s not working <code>If Day(Date) = 1 Or 2 Or 3 Then </code>"}, {"owner": {"reputation": 43, "user_id": 11200950, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4tvARF8C4U8/AAAAAAAAAAI/AAAAAAAAE-4/-1luT0F6bHs/photo.jpg?sz=128", "display_name": "Mohd Reza", "link": "https://stackoverflow.com/users/11200950/mohd-reza"}, "edited": false, "score": 0, "creation_date": 1568875682, "post_id": 57993665, "comment_id": 102415216, "body": "scratch that, this one worked great ... <code>If Day(Date) = 1 Or Day(Date) = 2 Or Day(Date) = 3 Then </code>"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1568816250, "last_edit_date": 1568816250, "creation_date": 1568812677, "answer_id": 57993724, "question_id": 57993665, "link": "https://stackoverflow.com/questions/57993665/how-to-find-if-its-the-first-or-second-day-of-the-month/57993724#57993724", "title": "How to find if it&#39;s the first or second day of the month?", "body": "<p>Here's a function to test if a date (or if unspecified, today) is within the first X <strong>working</strong> days:</p>\n\n<pre><code>Function date_is_in_X_days(firstXdays As Integer, Optional dt As Date) As Boolean\n\n    If dt = 0 Then dt = Date\n\n    date_is_in_X_days = False\n\n    With WorksheetFunction\n        For t = 1 To firstXdays\n            If dt = .WorkDay(.EoMonth(dt, -1), t) Then\n                date_is_in_X_days = True\n                Exit For\n            End If\n        Next\n    End With\n\nEnd Function\n</code></pre>\n\n<p>To test this:</p>\n\n<pre><code>Sub test_function()\n    If date_is_in_X_days(3) Then MsgBox \"1st, 2nd or 3rd day of month\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1568819606, "creation_date": 1568819606, "answer_id": 57996004, "question_id": 57993665, "link": "https://stackoverflow.com/questions/57993665/how-to-find-if-its-the-first-or-second-day-of-the-month/57996004#57996004", "title": "How to find if it&#39;s the first or second day of the month?", "body": "<p>Another way using <code>DAY</code> as @Warcupine suggested.  </p>\n\n<pre><code>Public Function date_is_in_X_days(DayNumber As Long, Optional DateValue As Date) As Boolean\n\n    If DateValue = 0 Then DateValue = Date\n\n    date_is_in_X_days = Day(DateValue) &lt; DayNumber 'Compare the two values which returns TRUE or FALSE\n\nEnd Function\n</code></pre>\n\n<p>This can then be used as:</p>\n\n<pre><code>Public Sub Test()\n\n    Debug.Print date_is_in_X_days(4) 'False if today is &gt;= 4th.\n    Debug.Print date_is_in_X_days(2, DateValue(\"3-Sep-19\")) 'False as 3rd is later than 2nd.\n    Debug.Print date_is_in_X_days(4, DateValue(\"3-Sep-19\")) 'True as 3rd is earlier than 4th.\n\nEnd Sub  \n</code></pre>\n\n<p>or as a worksheet formula where A1 contains a date:  </p>\n\n<pre><code>=date_is_in_X_days(5,$A$1)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11200950, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4tvARF8C4U8/AAAAAAAAAAI/AAAAAAAAE-4/-1luT0F6bHs/photo.jpg?sz=128", "display_name": "Mohd Reza", "link": "https://stackoverflow.com/users/11200950/mohd-reza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1568819606, "creation_date": 1568812468, "question_id": 57993665, "link": "https://stackoverflow.com/questions/57993665/how-to-find-if-its-the-first-or-second-day-of-the-month", "title": "How to find if it&#39;s the first or second day of the month?", "body": "<p>How do I find if it's the first or second day of the month?</p>\n\n<p>I'm just trying to see if it's the 1st, 2nd or less than the 5th day of the month to do something.</p>\n\n<pre><code>\nIf Date = Application.WorkDay(DateSerial(Year(Date), Month(Date), 0), 1) Or _\n   Date = Application.WorkDay(DateSerial(Year(Date), Month(Date), 0), 2) Or _\n   Date = Application.WorkDay(DateSerial(Year(Date), Month(Date), 0), 3) Then\n\n    MsgBox \"1st, 2nd or 3rd day of month\"\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanking you all in advance</p>\n"}, {"tags": ["excel", "vba", "paste"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1568811288, "post_id": 57993280, "comment_id": 102393301, "body": "Are you looking for <code>Worksheets(&quot;sheet1&quot;).Range(&quot;A1:A13&quot;).Value = Worksheets(&quot;sheet1&quot;).Range(&quot;E1:E13&quot;).Value</code>?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568811732, "post_id": 57993280, "comment_id": 102393553, "body": "Do you mean by <code>FillLeft</code> : <code>xlToLeft</code>"}], "owner": {"reputation": 1, "user_id": 12080643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1d1c8a026e8b3393931f8b2fe284bd2?s=128&d=identicon&r=PG&f=1", "display_name": "nicconos", "link": "https://stackoverflow.com/users/12080643/nicconos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568811217, "creation_date": 1568811102, "last_edit_date": 1568811217, "question_id": 57993280, "link": "https://stackoverflow.com/questions/57993280/how-to-fillleft-and-copying-values-only", "title": "How to FillLeft and copying values only", "body": "<p>I would like to <code>FillLeft</code> and only paste values but I'm not sure how to write it!</p>\n\n<p>I assume I should use <code>xlPasteValues</code> but I'm not clear where to write it in below code</p>\n\n<pre><code>Worksheets(\"sheet1\").Columns(\"B:D\").Hidden = True\nWorksheets(\"sheet1\").Range(\"A1:E13\").FillLeft\n</code></pre>\n\n<p>I would like the contents of Column E to be pasted as Values in Column A</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1568811045, "post_id": 57993207, "comment_id": 102393163, "body": "Because listbox array is 0 based, so you have to add 1 to the row number to match excel 1 based rows. So, <code>Rows(i+1).EntireRow.Delete</code> will work. No need to select and delete in 2 lines"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1568812230, "post_id": 57993207, "comment_id": 102393842, "body": "Also, try to avoid <code>Range(&quot;A65356&quot;).End(xlUp).Row</code> as it&#39;s a bit 2003ish. Nowadays we use variants of <code>.Cells(.Rows.Count, 1).End(xlUp).Row</code> combined with a <code>With Worksheets(&quot;sheetname&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568811830, "post_id": 57993373, "comment_id": 102393617, "body": "Did you see <a href=\"https://stackoverflow.com/questions/57993207/deleting-a-row-from-a-listbox-userform#comment102393163_57993207\">this comment</a>? <code>Rows(i)</code> will not work when <code>i</code> = 0. Also, when deleting rows, you want to start from the end and work up. Also - don&#39;t modify <code>i</code> within the loop."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568811896, "post_id": 57993373, "comment_id": 102393650, "body": "Note that changing it to <code>For i = 1</code> doesn&#39;t work either, because the listbox array is 0-based so now you&#39;re skipping the first element."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568811944, "post_id": 57993373, "comment_id": 102393684, "body": "@BigBen I agree with <code>i = 0</code> but you can also delete rows starting at the top to the bot of the sheet, just need to set i = i - 1 each time you delete a row"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568811972, "post_id": 57993373, "comment_id": 102393697, "body": "Modifying <code>i</code> within the loop is a <i>bad</i> practice. Don&#39;t. Loop backwards with <code>Step -1</code>. And your latest edit is still problematic. Or only delete once, as the other posted answer proposes."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1568812134, "post_id": 57993373, "comment_id": 102393795, "body": "@BigBen for the array the OP just got to add <code>Option Base 1 </code> at the top of his code"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568812339, "post_id": 57993373, "comment_id": 102393912, "body": "@BigBen I edited my answer do you approve this Idea?"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 1, "last_activity_date": 1569501729, "last_edit_date": 1569501729, "creation_date": 1568811441, "answer_id": 57993373, "question_id": 57993207, "link": "https://stackoverflow.com/questions/57993207/deleting-a-row-from-a-listbox-userform/57993373#57993373", "title": "deleting a row from a listbox Userform", "body": "<p>I would suggest you this :</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim i As Integer\n\nFor i = 1 To Range(\"A65356\").End(xlUp).Row - 1\n    If lstDisplay.Selected(i) Then\n        Rows(i).Delete\n        i = i - 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Also <strong>Note</strong> that <code>Rows(i).Delete</code> is exactly the same as <code>Rows(i).Select Selection.Delete</code> Excepted that <code>Select</code> should be avoided as much as possible</p>\n\n<p>As said <a href=\"https://stackoverflow.com/users/9245853/bigben\">@BigBen</a> :</p>\n\n<p>You can use the \"Option Base 1\" declaration at the top of a code module to change the default lower bound to 1 instead of 0.\nFor exemple : </p>\n\n<pre><code>Option Base 1 \n\nDim arValues(10) As String       'contains 10 items (not 11)  \n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/fr-fr/office/vba/language/reference/user-interface-help/option-base-statement\" rel=\"nofollow noreferrer\">Option Base Doc Here</a></p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1568814091, "last_edit_date": 1568814091, "creation_date": 1568812121, "answer_id": 57993569, "question_id": 57993207, "link": "https://stackoverflow.com/questions/57993207/deleting-a-row-from-a-listbox-userform/57993569#57993569", "title": "deleting a row from a listbox Userform", "body": "<p>I'll have to test this myself, but I guess something along the lines of:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nDim i As Long, rng As Range\nWith Me.lstDisplay\n    For i = 0 To .ListCount - 1\n        If .Selected(i) Then\n            If Not rng Is Nothing Then\n                Set rng = Union(rng, Sheets(\"Sheet1\").Rows(i + 1))\n            Else\n                Set rng = Sheets(\"Sheet1\").Rows(i + 1)\n            End If\n        End If\n    Next i\nEnd With\n\nrng.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>That way you'll only have to perform deleting rows once.</p>\n\n<p>Btw, I anticipated a multiselect listbox. If it's not a multiselect it would simplify the code as there is no need to loop the listbox.</p>\n"}], "owner": {"reputation": 43, "user_id": 11363473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b17693398516c94c815d616d965047?s=128&d=identicon&r=PG&f=1", "display_name": "TenEM", "link": "https://stackoverflow.com/users/11363473/tenem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2028, "favorite_count": 0, "accepted_answer_id": 57993569, "answer_count": 2, "score": 1, "last_activity_date": 1569501729, "creation_date": 1568810861, "last_edit_date": 1568811178, "question_id": 57993207, "link": "https://stackoverflow.com/questions/57993207/deleting-a-row-from-a-listbox-userform", "title": "deleting a row from a listbox Userform", "body": "<p>I have a listbox that shows up the rows of an excel sheet i need to add a delete button to delete the selected row. i tried this</p>\n\n<pre><code>Private Sub CommandButton3_Click()\nDim i As Integer\n\nFor i = 0 To Range(\"A65356\").End(xlUp).Row - 1\n    If lstDisplay.Selected(i) Then\n        Rows(i).Select\n        Selection.Delete\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>but when i try to delete for example the the row 10 it's the 9 that gets deleted it always delets the line before the one selected</p>\n\n<p>any fix ??? </p>\n\n<p>Thanks everyone</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1568810950, "post_id": 57993183, "comment_id": 102393100, "body": "<code>Crosstab 2</code> (with a space) is no valid name for a range. Can you please clarify?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1568811019, "post_id": 57993183, "comment_id": 102393145, "body": "<code>If Instr(Range(&quot;&lt;range name or address&gt;&quot;).Cells(3,2).Value, &quot;G fund&quot;) &gt; 0 Then</code>"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 1, "creation_date": 1568814408, "post_id": 57993183, "comment_id": 102395151, "body": "It may help you to review how Events work - see e.g. <a href=\"https://www.wiseowl.co.uk/blog/s194/event-handling-vba.htm\" rel=\"nofollow noreferrer\">wiseowl.co.uk/blog/s194/event-handling-vba.htm</a> or Google &quot;Excel VBA events&quot;"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1568970222, "post_id": 57993183, "comment_id": 102452688, "body": "@aucuparia it is a very helpful site, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568970865, "post_id": 57993266, "comment_id": 102453041, "body": "I think I made it not concrete enough in the original question but it is in line with what you said above. &quot;checking a value in a particular position inside a named range in the sheet&quot;. To be specific, in sheet 1 I have crosstab 1. In sheet 2 I have crosstab 2 and in sheet 3, I have crosstab3. And in all the crosstabs, if the word G fund exist, it should trigger HideFG macro. (If not, the Hide F macro.) And the location of the word is the same for all the crosstabs."}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568970955, "post_id": 57993266, "comment_id": 102453096, "body": "In this case, should I make 3 replicates of the code you suggested above? (by only changing &quot;crosstab2&quot; part into &quot;crosstab1&quot; &quot;crosstab3&quot;..)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 1, "creation_date": 1568970967, "post_id": 57993266, "comment_id": 102453104, "body": "@MooChangPark, but would you still need to trigger the macro on a particular worksheet under the worksheet_change event?"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568971313, "post_id": 57993266, "comment_id": 102453272, "body": "Yes because I have 7 worksheets in total and the macros are only related to sheet 1, 2 and 3 all with different named ranges. (crosstab1, crosstab2, crossstab3 )"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 1, "creation_date": 1568971613, "post_id": 57993266, "comment_id": 102453429, "body": "@MooChangPark, the point I&#39;m trying to make: Do you only want to trigger running the macro from one specific worksheet? Or from these three only? Then sure, replicating it three times is an option :)"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568972197, "post_id": 57993266, "comment_id": 102453768, "body": "oh I see your point, okay so I want to set it for specific sheet. So it runs the macro as I work on the sheet. Also, I want to set a Workbook_Open() macro so that it checks sheet 1, 2, 3 as the excel opens. :)"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568972272, "post_id": 57993266, "comment_id": 102453812, "body": "so it the first case, I can replicate the above code into each sheet. I am interested in the second case (Workbook_Open)!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 1, "creation_date": 1568973226, "post_id": 57993266, "comment_id": 102454345, "body": "I&#39;ll update the answer with how you could do that. @MooChangPark"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568979642, "post_id": 57993266, "comment_id": 102457549, "body": "I tried the script (instead of HideFG and Hide F macro I spelled it out) and it says error message &quot;object Required&quot; and highlight the line &quot;ws.ChartObjects(&quot;F&quot;).Visible = False&quot;...."}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568979674, "post_id": 57993266, "comment_id": 102457569, "body": "I added my script above :)"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568979755, "post_id": 57993266, "comment_id": 102457612, "body": "Is it possible that the problem is occuring because I changed the sheet name? I changed them to Budget, HR, Finance and tried."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 1, "creation_date": 1568980918, "post_id": 57993266, "comment_id": 102458228, "body": "@moochangPark, notice I did not set a ws object, but simply iterate through the array. Instead of <code>ws</code> use  <code>Sheets(wshts(x - 1))</code>"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568982837, "post_id": 57993266, "comment_id": 102459212, "body": "It now works perfect. I am always grateful for your help :)  I hope I was smart as you excel genius! Have a great day"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 1, "creation_date": 1568982908, "post_id": 57993266, "comment_id": 102459260, "body": "@MooChangPark, glad it helped, don&#39;t forget to upvote answers if they are helpfull to."}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1571241303, "post_id": 57993266, "comment_id": 103177369, "body": "Hello I know its been a while but the Workbook_open macro is having some trouble and it is not running as expected. And I am having a lot of trouble figuring out the reason.... I changed the crosstab name from crosstab 1 crosstab 2 crosstab 3 to crosstab 5 crosstab 7 and crosstab 9.. Is this the reason why?...?"}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1571241553, "post_id": 57993266, "comment_id": 103177489, "body": "or maybe... a problem with the IF condition <code>If Sheets(wshts(x - 1)).Range(rngs(x - 1))</code> ..?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 1, "creation_date": 1571306848, "post_id": 57993266, "comment_id": 103200808, "body": "@MooChangPark, as long as your references are correct, the macro should be fine. Make sure the worksheet names you have in the macro are present in the workbook."}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1571321888, "post_id": 57993266, "comment_id": 103209882, "body": "thanks for coming back. I checked and you are right:) Thanks again"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 4, "last_activity_date": 1568981232, "last_edit_date": 1568981232, "creation_date": 1568811044, "answer_id": 57993266, "question_id": 57993183, "link": "https://stackoverflow.com/questions/57993183/setting-if-condition-to-trigger-macros-in-excel-vba/57993266#57993266", "title": "Setting IF condition to trigger macros in excel vba", "body": "<p>I guess something along these lines:</p>\n\n<pre><code>If ws.Range(\"Crosstab2\").Cells(3, 2) = \"G fund\" Then\n    HidFG\nElse\n    HideF\nEnd If\n</code></pre>\n\n<hr>\n\n<p>You mentioned you need to run this only for three particular worksheets, e.g: \"Sheet1\", \"Sheet2\", \"Sheet3\". Copy the above code to these three sheets would work when you adapt the referenced named range.</p>\n\n<hr>\n\n<p>If this is something you need to run on the <code>Workbook_open()</code> event, you have multiple options, but since I'd say calling <code>Worksheet_Change</code> might not be the best option, maybe try:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim wshts As Variant: wshts = Array(\"Sheet1\", \"Sheet2\", \"Sheet3\")\nDim rngs As Variant: rngs = Array(\"crosstab1\", \"crosstab2\", \"crosstab3\")\n\nFor x = 1 To 3\n    If Sheets(wshts(x - 1)).Range(rngs(x - 1)).Cells(3, 2) = \"G fund\" Then\n        HideFG\n    Else\n        HideF\n    End If\nNext x\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim wshts As Variant: wshts = Array(\"Budget\", \"HR\", \"Finance\")\nDim rngs As Variant: rngs = Array(\"crosstab1\", \"crosstab2\", \"crosstab3\")\n\nFor x = 1 To 3\n    If Sheets(wshts(x - 1)).Range(rngs(x - 1)).Cells(3, 2) = \"G fund\" Then\n        Sheets(wshts(x - 1)).ChartObjects(\"F\").Visible = True\n        Sheets(wshts(x - 1)).ChartObjects(\"FG\").Visible = False\n    Else\n        Sheets(wshts(x - 1)).ChartObjects(\"F\").Visible = False\n        Sheets(wshts(x - 1)).ChartObjects(\"FG\").Visible = True\n    End If\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568811151, "post_id": 57993270, "comment_id": 102393230, "body": "Instead of <code>ws</code> you should use <code>Me</code> which automatically points to the worksheet the event and <code>Target</code> is in. So you don&#39;t need to declare <code>ws</code> at all."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568812636, "post_id": 57993270, "comment_id": 102394075, "body": "@P\u1d07\u029c, what makes you think <code>ws</code> would be the same as the one that triggered the event? Not meant to disrespect your comment, just curious because imho the named range could well be a different tab."}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "edited": false, "score": 0, "creation_date": 1568812739, "post_id": 57993270, "comment_id": 102394151, "body": "Thanks for the help, so do I write &quot;cross tab 2&quot; in the Target? Where should I put the named range &quot;crosstab 2&quot;?"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 1, "creation_date": 1568814112, "post_id": 57993270, "comment_id": 102394973, "body": "You don&#39;t put it &quot;in the Target&quot;, since Target is the cell that was changed. If you want to change the cell that is looked at by the macro you need to change Me.Cells(3, 2) to whatever you need."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1568814401, "post_id": 57993270, "comment_id": 102395142, "body": "@JvdV Just because you cannot intersect <code>Target</code> with a range in another sheet it must be the same sheet <code>Target</code> is in :) So if <code>Intersect</code> is used it is necessary to ensure that <code>Me</code> and <code>ws</code> is the same, so you can use <code>Me</code>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1568814546, "post_id": 57993270, "comment_id": 102395241, "body": "@P\u1d07\u029c, right. True that, but besides that, what I meant is: OP&#39;s named range is probably on another sheet and not on the sheet that triggered the event. Therefor I don&#39;t see the point of <code>Intersect</code> either since all OP wants to check (imo) is a value in a particular position inside a named range on another sheet. Difference of interpretation I guess :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1568814804, "post_id": 57993270, "comment_id": 102395433, "body": "@JvdV Yes, that is another possible interpretation of the original question. That&#39;s why I posted it below this answer, to make at least this version consistent and solid. What you describe would be different answer (like the one you posted). \u2022 Anyway the OP left too much space for misinterpretation I think."}, {"owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568970361, "post_id": 57993270, "comment_id": 102452759, "body": "@P\u1d07\u029c Thanks for the help! excel geniuses :)"}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 2, "last_activity_date": 1568811203, "last_edit_date": 1568811203, "creation_date": 1568811062, "answer_id": 57993270, "question_id": 57993183, "link": "https://stackoverflow.com/questions/57993183/setting-if-condition-to-trigger-macros-in-excel-vba/57993270#57993270", "title": "Setting IF condition to trigger macros in excel vba", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Me.Cells(3, 2)) Is Nothing Then\n    If Me.Cells(3, 2).Value = \"G fund\" Then\n        HideFG\n    Else\n        HideF\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Try this code. To explain: Target is the range that has been changed (which triggered the <code>Worksheet_Change</code> event). Intersect checks if your specified Range is part of the changed range. If this is the case, then you just have to check if your specified cell's value is equal to your specified input.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 2, "last_activity_date": 1568815096, "last_edit_date": 1568815096, "creation_date": 1568813742, "answer_id": 57994063, "question_id": 57993183, "link": "https://stackoverflow.com/questions/57993183/setting-if-condition-to-trigger-macros-in-excel-vba/57994063#57994063", "title": "Setting IF condition to trigger macros in excel vba", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rng As Range\n\n    Set rng = Me.Range(\"Crosstab_2\")\n\n    If Not Intersect(Target, rng.Cells(3, 2)) Is Nothing And rng.Cells(3, 2).Value = \"G fund\" Then\n\n        'Code\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 12042134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2538694236190596/picture?type=large", "display_name": "MooChang Park", "link": "https://stackoverflow.com/users/12042134/moochang-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 57993266, "answer_count": 3, "score": 2, "last_activity_date": 1568981232, "creation_date": 1568810770, "last_edit_date": 1568811065, "question_id": 57993183, "link": "https://stackoverflow.com/questions/57993183/setting-if-condition-to-trigger-macros-in-excel-vba", "title": "Setting IF condition to trigger macros in excel vba", "body": "<p>I am trying to set a condition to trigger macros in excel vba. I defined a named range as \"Crosstab 2\" and I want to set the IF condition so that if there is the word \"G fund\" in the  second column third row within the Crosstab 2, it triggers the macros. It is so difficult for me and I am lost..... what must I write after IF in the code to make this work?</p>\n\n<p>The code so far</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim ws As Worksheet: Set ws = Sheets(\"Budget- Listening\")\n    If  Then\n        HideFG\n    Else\n        HideF\n    End If\nEnd Sub\n</code></pre>\n\n<p>Thank you for reading!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 1, "creation_date": 1568810083, "post_id": 57992893, "comment_id": 102392636, "body": "@HanaVarsy, Welcome to SO, I would suggest you to avoid <code>Select</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1568810253, "post_id": 57992893, "comment_id": 102392736, "body": "Read and apply <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> to your code. If your issue is still there, please <a href=\"https://stackoverflow.com/posts/57992893/edit\">edit</a> your question and udpate the code to the new code (without select)."}, {"owner": {"reputation": 3, "user_id": 10142559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFbHFUc-4jI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pdB3GHYUr7WoKcNuYpQATuK2d4NA/mo/photo.jpg?sz=128", "display_name": "Hanna Varsy", "link": "https://stackoverflow.com/users/10142559/hanna-varsy"}, "edited": false, "score": 0, "creation_date": 1568824626, "post_id": 57992893, "comment_id": 102400983, "body": "Thanks !! You just saved my life :)"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568828885, "post_id": 57992893, "comment_id": 102402592, "body": "@HannaVarsy May I ask you to accept <a href=\"https://stackoverflow.com/a/57993018/11167163\">this answer</a> . Please look <a href=\"https://meta.stackexchange.com/a/5235\">Here to see how to accept</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1568810365, "post_id": 57993018, "comment_id": 102392799, "body": "Note that <code>If (ThisWorkbook.Sheets(&quot;SALES&quot;).AutoFilterMode And ThisWorkbook.Sheets(&quot;SALES&quot;).FilterMode) Or ThisWorkbook.Sheets(&quot;SALES&quot;).FilterMode Then</code> is the same as <code>If  ThisWorkbook.Sheets(&quot;SALES&quot;).FilterMode Then</code>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1568810398, "post_id": 57993018, "comment_id": 102392817, "body": "FWIW, you can do the copy paste in one go to avoid filling the clipboard (and the use of <code>CutCopyMode</code>). Resizing <code>A19</code> would be an alternative."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1568810896, "post_id": 57993018, "comment_id": 102393071, "body": "@P\u1d07\u029c and jvdV I edited the code thanks to your suggestion"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 2, "last_activity_date": 1568810863, "last_edit_date": 1568810863, "creation_date": 1568810256, "answer_id": 57993018, "question_id": 57992893, "link": "https://stackoverflow.com/questions/57992893/copy-and-paste-data-in-a-new-sheet-after-clearing-the-filter-in-another-sheet-in/57993018#57993018", "title": "Copy and paste data in a new sheet after clearing the filter in another sheet in VBA", "body": "<p>You might try this code and tell me if your issue is solved, i think that <code>select</code> was the issue.</p>\n\n<p>Also please note that <code>Thisworkbook</code> appoint the workbook where the macro is coded</p>\n\n<pre><code>Sub Reset1_button()\n\nApplication.ScreenUpdating = False\nDim LastRow As Long\nDim LRow As Long\n\nLastRow = WorksheetFunction.Max(ThisWorkbook.Sheets(\"SALES\").Cells(Rows.Count, \"A\").End(xlUp).Row, 2)\nLastRow = LastRow + 1\nLRow = WorksheetFunction.Max(ThisWorkbook.Sheets(\"ONE_ALLIANZ_REPORT\").Cells(Rows.Count, \"A\").End(xlUp).Row, 18)\nLRow = LRow + 1\n\nRange(\"A19:AQ\" &amp; LRow).Clear\n\nIf ThisWorkbook.Sheets(\"SALES\").FilterMode Then\n   ThisWorkbook.Sheets(\"SALES\").ShowAllData\nEnd If\n\n\n ThisWorkbook.Sheets(\"SALES\").Range(\"A3:AQ\" &amp; LastRow).Copy Destination:=ThisWorkbook.Sheets(\"ONE_ALLIANZ_REPORT\").Range(\"A19\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10142559, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFbHFUc-4jI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pdB3GHYUr7WoKcNuYpQATuK2d4NA/mo/photo.jpg?sz=128", "display_name": "Hanna Varsy", "link": "https://stackoverflow.com/users/10142559/hanna-varsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57993018, "answer_count": 1, "score": 0, "last_activity_date": 1568810863, "creation_date": 1568809860, "question_id": 57992893, "link": "https://stackoverflow.com/questions/57992893/copy-and-paste-data-in-a-new-sheet-after-clearing-the-filter-in-another-sheet-in", "title": "Copy and paste data in a new sheet after clearing the filter in another sheet in VBA", "body": "<p>The new sheet <strong>did not</strong> display the whole data after I click \"All\" button <strong>once</strong> to display all the data in new sheet after clearing the filter. However, it only shows the whole data when I click \"All\" button <strong>twice</strong>.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Reset1_button()\n\nApplication.ScreenUpdating = False\nDim LastRow As Long\nDim LRow As Long\n\nLastRow = WorksheetFunction.Max(Sheets(\"SALES\").Cells(Rows.Count, \"A\").End(xlUp).Row, 2)\nLastRow = LastRow + 1\nLRow = WorksheetFunction.Max(Sheets(\"ONE_ALLIANZ_REPORT\").Cells(Rows.Count, \"A\").End(xlUp).Row, 18)\nLRow = LRow + 1\n\nRange(\"A19:AQ\" &amp; LRow).Clear\nSheets(\"SALES\").Select\n\nIf (ActiveSheet.AutoFilterMode And ActiveSheet.FilterMode) Or ActiveSheet.FilterMode Then\n  ActiveSheet.ShowAllData\nEnd If\n\nSheets(\"SALES\").Select\nActiveSheet.Range(\"A3:AQ\" &amp; LastRow).Copy\nSheets(\"ONE_ALLIANZ_REPORT\").Select\nActiveSheet.Range(\"A19\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nActiveCell.Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2007", "powerquery"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568809511, "post_id": 57992452, "comment_id": 102392301, "body": "<a href=\"https://support.office.com/en-us/article/power-query-overview-and-learning-ed614c81-4b00-4291-bd3a-55d80767f81d\" rel=\"nofollow noreferrer\">Power Query</a> is only available in 2010 and later. I&#39;m not sure what is the best option to do what you want in 2007."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1568809601, "post_id": 57992452, "comment_id": 102392359, "body": "If users don&#39;t need to be able to refresh the data, could you have a &quot;template&quot; in Excel 365 where you can refresh the data before saving as 2007-compatible (minus Power Query) for distribution?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1568809762, "post_id": 57992452, "comment_id": 102392458, "body": "Although, looking at your code -- I think it may be possible to &quot;translate&quot; completely into SQL (if from a SQL database). Have you tried looking at the &quot;Native Query&quot; in PQ? (Right click steps, select &quot;View Native Query&quot; -- may or may not be possible depending on prior query steps)"}, {"owner": {"reputation": 27, "user_id": 7937346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y8jTkrDu2XI/AAAAAAAAAAI/AAAAAAAABKY/_Z5EHLdClgs/photo.jpg?sz=128", "display_name": "Duntik", "link": "https://stackoverflow.com/users/7937346/duntik"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568810003, "post_id": 57992452, "comment_id": 102392604, "body": "@BigBen Thanks, yes I know. But I have to do this on Excel 2007. So I need to find other option"}, {"owner": {"reputation": 27, "user_id": 7937346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y8jTkrDu2XI/AAAAAAAAAAI/AAAAAAAABKY/_Z5EHLdClgs/photo.jpg?sz=128", "display_name": "Duntik", "link": "https://stackoverflow.com/users/7937346/duntik"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1568810275, "post_id": 57992452, "comment_id": 102392751, "body": "@Mistella Thanks, native Query is \u2018greyed\u2019 out on last most important step. I will try to use transparent in sql. But this looks complicated. Any other ideas?"}], "owner": {"reputation": 27, "user_id": 7937346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y8jTkrDu2XI/AAAAAAAAAAI/AAAAAAAABKY/_Z5EHLdClgs/photo.jpg?sz=128", "display_name": "Duntik", "link": "https://stackoverflow.com/users/7937346/duntik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1095, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568809397, "creation_date": 1568808499, "last_edit_date": 1568809397, "question_id": 57992452, "link": "https://stackoverflow.com/questions/57992452/how-i-can-use-this-power-query-code-inside-excel-2007", "title": "How I can use this Power Query code inside Excel 2007?", "body": "<p>I have a spreadsheet created in excel office 365. I need to create the same file but inside Excel 2007, because some of the functionality I do in Power Query, I'm not sure how to get that to live. </p>\n\n<p>I use data from DB, so everything should be dynamical. \nThere is how this work on the last Excel -</p>\n\n<ol>\n<li>ProcedureId - this is a user ID</li>\n<li>TokenValue - this is question ID</li>\n<li>HtmlValue - this is answer ID or answer</li>\n</ol>\n\n<p>So, I have 3 columns </p>\n\n<p><a href=\"https://i.stack.imgur.com/BGE9d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BGE9d.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then I change structure with fx in Power Query to </p>\n\n<pre><code>           Question1  Question2  Question3    \nUser 1     Answer1    Answer2    Answer3\n</code></pre>\n\n<p>I used </p>\n\n<pre><code>= Table.Pivot(#\"Removed Other Columns\", List.Distinct(#\"Removed Other Columns\"[TokenValue]), \"TokenValue\", \"HtmlValue\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xxeVq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xxeVq.png\" alt=\"enter image description here\"></a></p>\n\n<p>How I can change structure like that with dynamical data in Excel 2007? If VBA, can you help me to translate this line? </p>\n\n<p><a href=\"https://i.stack.imgur.com/GlGL4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GlGL4.png\" alt=\"enter image description here\"></a></p>\n\n<p>My Power Query code </p>\n\n<pre><code>let\n    Source = Sql.Databases(\"server\"),\n    chinurseportaldatabase = Source{[Name=\"name\"]}[Data],\n    dbo_ProcedureStepsDetails = chinurseportaldatabase{[Schema=\"dbo\",Item=\"ProcedureStepsDetails\"]}[Data],\n    #\"Filtered Rows\" = Table.SelectRows(dbo_ProcedureStepsDetails, each [ProcedureId] &gt; 373),\n    #\"Removed Other Columns\" = Table.SelectColumns(#\"Filtered Rows\",{\"ProcedureId\", \"TokenValue\", \"HtmlValue\"}),\n    #\"Pivoted Column\" = Table.Pivot(#\"Removed Other Columns\", List.Distinct(#\"Removed Other Columns\"[TokenValue]), \"TokenValue\", \"HtmlValue\")\nin\n    #\"Pivoted Column\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "radio-button", "groupbox"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1568808922, "post_id": 57992169, "comment_id": 102391962, "body": "Start by sharing the code?"}, {"owner": {"reputation": 63, "user_id": 12084770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002a830dc201cd61eade03cea8a80119?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/12084770/lukas"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568814618, "post_id": 57992169, "comment_id": 102395288, "body": "Thank you, I have now added a Code, which reproduces my problem."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 12084770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002a830dc201cd61eade03cea8a80119?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/12084770/lukas"}, "edited": false, "score": 0, "creation_date": 1568818543, "post_id": 57995457, "comment_id": 102397808, "body": "I have tested both, both do work. For my current project i have several GroupBoxes adjacent to each other, so increasing the size of all does not work without disturbing the design. The second solution however allows not to use GroupBoxes at all, which is perfect! Thank you"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 63, "user_id": 12084770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002a830dc201cd61eade03cea8a80119?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/12084770/lukas"}, "edited": false, "score": 0, "creation_date": 1568818812, "post_id": 57995457, "comment_id": 102397968, "body": "I have updated the code. Instead of hardcoding the shape names in the array, I have made it dynamic :)"}, {"owner": {"reputation": 63, "user_id": 12084770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002a830dc201cd61eade03cea8a80119?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/12084770/lukas"}, "edited": false, "score": 0, "creation_date": 1568820107, "post_id": 57995457, "comment_id": 102398670, "body": "Ah wait, if I want to have two oft those boxes with some Radio-buttons, and I want to group them separately, they group together."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 63, "user_id": 12084770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002a830dc201cd61eade03cea8a80119?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/12084770/lukas"}, "edited": false, "score": 0, "creation_date": 1568820335, "post_id": 57995457, "comment_id": 102398809, "body": "Yes you group them separately using separate loops"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1568818773, "last_edit_date": 1568818773, "creation_date": 1568817780, "answer_id": 57995457, "question_id": 57992169, "link": "https://stackoverflow.com/questions/57992169/vba-excel-radiobutton-does-not-work-properly-until-i-delete-another-radiobutton/57995457#57995457", "title": "VBA Excel RadioButton does not work properly until i delete another RadioButton and undo", "body": "<p>You are experiencing the issue because of the line</p>\n\n<pre><code>ActiveSheet.GroupBoxes.Add(Range(xx).Left, Range(xx).Top, _\nRange(xx).Width * 3, Range(xx).Height * 2).Select\n</code></pre>\n\n<p>If you change it to</p>\n\n<pre><code>ActiveSheet.GroupBoxes.Add(Range(xx).Left, Range(xx).Top, _\nRange(xx).Width * 3.5, Range(xx).Height * 2.5).Select\n</code></pre>\n\n<p>It will work. Seems like Excel is getting confused whether the object is inside the group or not. Better to include extra margins around the option buttons.</p>\n\n<p>By the way, avoid using <code>.Select</code>. Work with object directly as shown in the example below.</p>\n\n<hr>\n\n<h2>Alternative</h2>\n\n<p>If you want there is one more way to achieve what you want. This method doesn't use a <code>GroupBox</code>. It groups the controls together. See this example</p>\n\n<pre><code>Sub Sample()\n    Dim shp As Variant\n    Dim ShpGroup As Variant\n    Dim ws As Worksheet\n    Dim startcell As Variant\n    Dim i As Long, j As Long, k As Long\n    Dim CellAddr As String\n    Dim Shapenames As String\n    Dim ShpAr(1 To 6) As Variant\n\n    Set ws = Sheet1\n\n    For Each shp In ws.Shapes\n        shp.Delete\n    Next shp\n\n    k = 1\n\n    For i = 1 To 2\n        For j = 1 To 3\n            CellAddr = Cells(i, j).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n            Set shp = ws.OptionButtons.Add(Range(CellAddr).Left, Range(CellAddr).Top, Range(CellAddr).Width, 4)\n\n            With shp\n                .Name = \"Button \" &amp; k\n                .ShapeRange.ScaleHeight 0.65, msoFalse\n                .Characters.Text = \"Button \" &amp; k\n                .LinkedCell = \"A11\"\n                .Display3DShading = True\n            End With\n\n            '~~&gt; Store the shape name in an array\n            ShpAr(k) = \"Button \" &amp; k\n            k = k + 1\n        Next j\n    Next i\n\n    Set ShpGroup = ws.Shapes.Range(ShpAr).Group\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 12084770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002a830dc201cd61eade03cea8a80119?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/12084770/lukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 57995457, "answer_count": 1, "score": 1, "last_activity_date": 1568818773, "creation_date": 1568807622, "last_edit_date": 1568814557, "question_id": 57992169, "link": "https://stackoverflow.com/questions/57992169/vba-excel-radiobutton-does-not-work-properly-until-i-delete-another-radiobutton", "title": "VBA Excel RadioButton does not work properly until i delete another RadioButton and undo", "body": "<p>I am currently working on Option-buttons in VBA. I want to add a Group-box, in which there are 6 Option-buttons (all connected to a fixed cell somewhere). Only at max one of those Option-buttons shall be able to be active. </p>\n\n<p>It should look like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/6aiRg.png\" alt=\"It should look like this.\"></p>\n\n<p>I want to create this with a VBA macro. The problem is, that when I create this, Button-1 and Button-6 are connected. If I select one, I select both. All other Radio-buttons are not like this, and can be clicked separately.</p>\n\n<p>Additionally, if I manually delete one of those Radio-buttons, and click Ctrl+Y, everything works just fine.. then all 6 buttons can be selected separately.</p>\n\n<p>Do you have any idea what I could do, such I do not have to first delete one button and undo this to make this work properly?</p>\n\n<p><em>Edit: Code added</em></p>\n\n<pre><code>Sub ButtonsInABox()\n    ActiveSheet.GroupBoxes.Delete\n    ActiveSheet.OptionButtons.Delete\nstartcell = Array(1, 1)\n\n        Add_GroupBox Array(startcell(0), startcell(1))\n            Add_RadioButton Array(startcell(0), startcell(1)), \"Button-1\", \"A11\"\n            Add_RadioButton Array(startcell(0), startcell(1) + 1), \"Button-2\", \"A11\"\n            Add_RadioButton Array(startcell(0), startcell(1) + 2), \"Button-3\", \"A11\"\n            Add_RadioButton Array(startcell(0) + 1, startcell(1)), \"Button-4\", \"A11\"\n            Add_RadioButton Array(startcell(0) + 1, startcell(1) + 1), \"Button-5\", \"A11\"\n            Add_RadioButton Array(startcell(0) + 1, startcell(1) + 2), \"Button-6\", \"A11\"\n\nEnd Sub\n\n\nSub Add_RadioButton(startcell, ButtonName, corresponding_cell)\n   a = startcell(0)\n   b = startcell(1)\n   xx = Cells(a, b).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n\n   ActiveSheet.OptionButtons.Add(Range(xx).Left, Range(xx).Top, Range(xx).Width * 1, 4).Select\n   With Selection\n    .ShapeRange.ScaleHeight 0.65, msoFalse\n    .Characters.Text = ButtonName\n    .LinkedCell = corresponding_cell\n    .Display3DShading = True\n    End With\n\nEnd Sub\n\n\nSub Add_GroupBox(startcell)\n    a = startcell(0)\n    b = startcell(1)\n    xx = Cells(a, b).Address(RowAbsolute:=False, ColumnAbsolute:=False)\n\n\n    ActiveSheet.GroupBoxes.Add(Range(xx).Left, Range(xx).Top, Range(xx).Width * 3, Range(xx).Height * 2).Select\n\n    Selection.Characters.Text = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1568807680, "post_id": 57991954, "comment_id": 102391260, "body": "Not a Mac user... But can&#39;t you fn-lock? Or change the iTunes shortcut?"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1568808573, "post_id": 57991954, "comment_id": 102391758, "body": "As far as I know, &quot;no&quot;.  That&#39;s the point of my question."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568809982, "post_id": 57991954, "comment_id": 102392587, "body": "I can check it when I get back home but I hope you are aware that in the new macbook pro there are no fuctions keys. it has been replaced with a touch panel. To access the function keys temporarily, one has to press the fn key and then the relevant key. So even if you managed to set F8, you will still have to use two keys (2 hands) :D"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568810190, "post_id": 57991954, "comment_id": 102392703, "body": "Unless you set them permanently as show <a href=\"https://www.imore.com/how-make-function-keys-default-touch-bar-display\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1568832765, "post_id": 57991954, "comment_id": 102404162, "body": "I&#39;m using an external (mac) keyboard purchased in 2019 on a MacBook pro without a touch panel. I&#39;m aware of the FN key (as shown in my post) and even have special software (Palua) to make switching FN modes easier. Just want an answer if you have one -- thanks"}], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1187, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1581926770, "creation_date": 1568806887, "last_edit_date": 1581926770, "question_id": 57991954, "link": "https://stackoverflow.com/questions/57991954/assign-f8-to-debug-step-into-shortcut-in-mac-vbe", "title": "Assign F8 to Debug Step Into shortcut in Mac VBE", "body": "<p>Like <a href=\"https://stackoverflow.com/questions/38690874/pycharm-step-over-shortcut-on-mac\">this post</a> and <a href=\"https://stackoverflow.com/questions/39685723/using-shortcuts-in-mac-for-debugging\">this post</a> I too would like to use the <code>F8</code> key to step through code when dubugging Excel VBA projects on the Mac (this is done in Windows without problem). But <code>F8</code> is assigned to iTunes, and the shortcut <code>cmd-shift-I</code> is awkward, requiring 2 hands. </p>\n\n<p>I can re-assign it using the System Settings (as shown in the image below) but even though it looks like it's been reassigned, the <code>F8</code> key still doesn't work to step through code (but <code>cmd-shift-I</code> still works). </p>\n\n<p><a href=\"https://i.stack.imgur.com/NCN37.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NCN37.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Gjlbn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gjlbn.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The other posts 'solutions' to this problem do not work for me. (Namely, using the function key FN-F8 or checking the \"Use F1,F2,etc. keys as standard function keys\" within Settings.)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568805965, "post_id": 57991612, "comment_id": 102390355, "body": "Please <a href=\"https://stackoverflow.com/posts/57991612/edit\">edit</a> your question and add the code you used. Tell which errors you get and where (or tell what your code does vs. what you expect it to do). Reading <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might help to give a good example in your question."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568805998, "post_id": 57991612, "comment_id": 102390371, "body": "Possible to see the code for your <code>Listbox_Change</code> or <code>Listbox_Click</code> event?"}, {"owner": {"reputation": 11, "user_id": 10367423, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gwQ-YZMMSlA/AAAAAAAAAAI/AAAAAAAASDA/RCmS0EsrHD8/photo.jpg?sz=128", "display_name": "Sanjyot Salgar Patkar", "link": "https://stackoverflow.com/users/10367423/sanjyot-salgar-patkar"}, "edited": false, "score": 0, "creation_date": 1568806906, "post_id": 57991612, "comment_id": 102390876, "body": "Private Sub vTB_Edit_ActionOwner_Change() UserForm2.vLB_Edit_ActionOwner.Visible = True Call EmailId Me.vLB_ScheduleDate.Visible = True Me.vTB_ScheduleDate.Visible = True End Sub  Private Sub vLB_Edit_ActionOwner_Click() UserForm2.vLB_Edit_ActionOwner.Visible = False UserForm2.vTB_Edit_ActionOwner.Text = UserForm2.vLB_Edit_ActionOwner.ListIndex End Sub"}], "owner": {"reputation": 11, "user_id": 10367423, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gwQ-YZMMSlA/AAAAAAAAAAI/AAAAAAAASDA/RCmS0EsrHD8/photo.jpg?sz=128", "display_name": "Sanjyot Salgar Patkar", "link": "https://stackoverflow.com/users/10367423/sanjyot-salgar-patkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568807131, "creation_date": 1568805711, "last_edit_date": 1568807131, "question_id": 57991612, "link": "https://stackoverflow.com/questions/57991612/listbox-selection-in-vba-not-taking-place-properly", "title": "Listbox selection in VBA not taking place properly", "body": "<p>I am writing a vba code to populate the listbox selection in a textbox and the selection of listbox entry should get populated in an excel\nListbox is a 2 column listbox having name and email id. when users mouse clicks and entry in a listbox the second column having email id should be copied in an excel sheet and the first column with the name should appear in the text box\nProblem i am facing is that when i click on the listbox, textbox gets populated correctly with first column value but the excel does not get populated with corresponding email id. The reason being mouse click on the row in the listbox is not making the row turn blue i.e.it is not getting highlighted as a result listbox.listindex>-1 does not get satisfied. \nCan anybody please help when the mouse click on listbox does not highlight the selected row?</p>\n\n<pre><code>Sub EmailId()\nDim i As Integer\nDim j As Integer\nDim str As String\n\n'UserForm2.vCB_ActionOwner.ColumnCount = 2\n'UserForm2.vCB_ActionOwner.ColumnWidths = \"1 in, 1.5 in\"\n\nUserForm2.vLB_Edit_ActionOwner.ColumnCount = 2\nUserForm2.vLB_Edit_ActionOwner.ColumnWidths = \"1 in, 1.5 in\"\n\nUserForm2.vCB_RevisedActionOwner.ColumnCount = 2\nUserForm2.vCB_RevisedActionOwner.ColumnWidths = \"1 in, 1.5 in\"\n\nstr = UserForm2.vTB_Edit_ActionOwner.Text\nUserForm2.vLB_Edit_ActionOwner.Clear\n\nWith UserForm2\nFor i = 1 To TotalRows_EmailId\nIf InStr(1, varArray_EmailId(i, 1), str, vbTextCompare) Then\n.vLB_Edit_ActionOwner.AddItem\n.vLB_Edit_ActionOwner.List(.vLB_Edit_ActionOwner.ListCount - 1, 0) = varArray_EmailId(i, 1)\n.vLB_Edit_ActionOwner.List(.vLB_Edit_ActionOwner.ListCount - 1, 1) = varArray_EmailId(i, 4)\n\nEnd If\nNext i\n\nPrivate Sub vTB_Edit_ActionOwner_Change()\nUserForm2.vLB_Edit_ActionOwner.Visible = True\nCall EmailId\nMe.vLB_ScheduleDate.Visible = True\nMe.vTB_ScheduleDate.Visible = True\nEnd Sub\n\nPrivate Sub vLB_Edit_ActionOwner_Click()\nUserForm2.vLB_Edit_ActionOwner.Visible = False\nUserForm2.vTB_Edit_ActionOwner.Text = UserForm2.vLB_Edit_ActionOwner.ListIndex\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1568805706, "post_id": 57991530, "comment_id": 102390188, "body": "Which row? What is exactly the idea? Try with 2-3 more sentences."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1568805771, "post_id": 57991530, "comment_id": 102390234, "body": "Did you meant to include something like <code>If Not IsEmpty.... Then</code>? Show some sample data if possible to visualize exactly what you are trying."}, {"owner": {"reputation": 3, "user_id": 11508373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9deff0fded218eb1719cd915287a01e2?s=128&d=identicon&r=PG&f=1", "display_name": "Somashekar", "link": "https://stackoverflow.com/users/11508373/somashekar"}, "edited": false, "score": 0, "creation_date": 1568805869, "post_id": 57991530, "comment_id": 102390293, "body": "I have a table in which there are around 8 colums containing dates (ex start date, end date etc). Now for each row, some of the columns are blank. I have to find the max date in each row."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11508373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9deff0fded218eb1719cd915287a01e2?s=128&d=identicon&r=PG&f=1", "display_name": "Somashekar", "link": "https://stackoverflow.com/users/11508373/somashekar"}, "edited": false, "score": 0, "creation_date": 1568807319, "post_id": 57991672, "comment_id": 102391087, "body": "I tried this and  I am getting Type mismatch 13 error: Value: #12:00:00 AM#"}], "tags": [], "owner": {"reputation": 89, "user_id": 12074269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCWDe7GtB539PwklIwdstIZCrU46F1_fsEzQZ-_w=k-s128", "display_name": "Angad Gupta", "link": "https://stackoverflow.com/users/12074269/angad-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1568806241, "last_edit_date": 1568806241, "creation_date": 1568805910, "answer_id": 57991672, "question_id": 57991530, "link": "https://stackoverflow.com/questions/57991530/excel-vba-max-date-in-the-row-including-blank-cells/57991672#57991672", "title": "Excel VBA: Max Date in the row including blank cells", "body": "<p>Hello refer the below code for cell A1 to AA1 contains the date with blank cell also </p>\n\n<pre><code>Sub maxdaterow()\nMax_date = Application.WorksheetFunction.Max(Range(\"A1:AA1\"))\nMsgBox Max_date\nEnd Sub\n</code></pre>\n\n<p>below code to find the maximum date in column A, which also contains the blank cells</p>\n\n<pre><code>Sub maxdate()\nMax_date = Application.WorksheetFunction.Max(Columns(\"A\"))\nMsgBox Max_date\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11508373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9deff0fded218eb1719cd915287a01e2?s=128&d=identicon&r=PG&f=1", "display_name": "Somashekar", "link": "https://stackoverflow.com/users/11508373/somashekar"}, "edited": false, "score": 0, "creation_date": 1568810515, "post_id": 57992129, "comment_id": 102392876, "body": "No, I am getting type mismatch error: For the blank cell &quot;&quot;, its showing type mismatch and giving the value #12:00:00#"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 0, "last_activity_date": 1568812014, "last_edit_date": 1568812014, "creation_date": 1568807492, "answer_id": 57992129, "question_id": 57991530, "link": "https://stackoverflow.com/questions/57991530/excel-vba-max-date-in-the-row-including-blank-cells/57992129#57992129", "title": "Excel VBA: Max Date in the row including blank cells", "body": "<p>I would suggest you do this : </p>\n\n<pre><code>sub tryme()\n\nFor i = 1 To 50\n    Max_date = Application.WorksheetFunction.Max(Rows(i))\n    if isempty(Max_date) = False then\n    MsgBox cDate(\"The most recent date for row : \" &amp; i &amp; \"is : \" &amp; Max_date)\n    end if\nNext\nend sub\n</code></pre>\n\n<p>Where <code>i</code> is your row number; you will have to set your number of rows, or find it with <code>.Count</code></p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1568808479, "creation_date": 1568808479, "answer_id": 57992446, "question_id": 57991530, "link": "https://stackoverflow.com/questions/57991530/excel-vba-max-date-in-the-row-including-blank-cells/57992446#57992446", "title": "Excel VBA: Max Date in the row including blank cells", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim i As Long, y As Long\n    Dim dDate As Date\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n\n        'Loop rows 1-10\n        For i = 1 To 10\n            'Set a default date\n            dDate = \"1/1/1900\"\n            'Loop columns from 1-8\n            For y = 1 To 8\n                If .Cells(i, y).Value &lt;&gt; \"\" And .Cells(i, y).Value &gt; dDate Then\n                    dDate = .Cells(i, y).Value\n                End If\n            Next y\n\n            Debug.Print \"Max date for row \" &amp; i &amp; \" is date \" &amp; dDate\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11508373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9deff0fded218eb1719cd915287a01e2?s=128&d=identicon&r=PG&f=1", "display_name": "Somashekar", "link": "https://stackoverflow.com/users/11508373/somashekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 57992129, "answer_count": 3, "score": 0, "last_activity_date": 1568812014, "creation_date": 1568805422, "last_edit_date": 1568806147, "question_id": 57991530, "link": "https://stackoverflow.com/questions/57991530/excel-vba-max-date-in-the-row-including-blank-cells", "title": "Excel VBA: Max Date in the row including blank cells", "body": "<p>Excel VBA: Code to find Max date in a row which includes blank cells</p>\n\n<pre><code>Dim s As Date\n\ns = WorksheetFunction.Max((If IsNotEmpty (CDate(Range(\"A\" &amp; x + 1).Value), CDate(Range(\"B\" &amp; x + 2).Value), CDate(Range(\"C\" &amp; x + 1).Value)))\nMsgBox s\n</code></pre>\n\n<p>I have a table in which there are around 8 colums containing dates (ex start date, end date etc). Now for each row, some of the columns are blank. I have to find the max date in each row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dEcPP.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "xml", "vba"], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 11947879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab56cc4fa8064e1d1c03ae0631561ac?s=128&d=identicon&r=PG&f=1", "display_name": "joebody&#39;s business", "link": "https://stackoverflow.com/users/11947879/joebodys-business"}, "is_accepted": true, "score": 0, "last_activity_date": 1568805213, "creation_date": 1568805213, "answer_id": 57991459, "question_id": 57990429, "link": "https://stackoverflow.com/questions/57990429/vba-how-to-deal-with-an-empty-array-from-reading-an-xml-file/57991459#57991459", "title": "VBA: How to deal with an empty array from reading an XML file", "body": "<p>I've fixed it now, here's what I came up with, hope this helps someone one day:                 </p>\n\n<pre><code>oXMLFile.Load (XMLFileName)\nSet numNode = oXMLFile.getElementsByTagName(\"data29\")\nSet titleNode = oXMLFile.getElementsByTagName(\"data25\")\nSet firstNode = oXMLFile.getElementsByTagName(\"data26\")\nSet lastNode = oXMLFile.getElementsByTagName(\"data27\")\n\nOn Error GoTo didntfindit\n\nDim numStr As String\nDim titleStr As String\nDim firstStr As String\nDim lastStr As String\n\nnumStr = numNode(0).Text\ntitleStr = titleNode(0).Text\nfirstStr = firstNode(0).Text\nlastStr = lastNode(0).Text\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11947879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab56cc4fa8064e1d1c03ae0631561ac?s=128&d=identicon&r=PG&f=1", "display_name": "joebody&#39;s business", "link": "https://stackoverflow.com/users/11947879/joebodys-business"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 57991459, "answer_count": 1, "score": 0, "last_activity_date": 1568805213, "creation_date": 1568801858, "question_id": 57990429, "link": "https://stackoverflow.com/questions/57990429/vba-how-to-deal-with-an-empty-array-from-reading-an-xml-file", "title": "VBA: How to deal with an empty array from reading an XML file", "body": "<p>I'm reading an XML file in VBA and then using that to extract some information to create another Output XML file. I only need to generate amn output file when the fields in the initial XML file are filled in.</p>\n\n<p>Currently when it gets to an empty tag it fails. I've tried some of the empty array solutions I've found on here but they don't seem to work. Is my code that bad??</p>\n\n<pre><code>Private Sub gDialer()\n    For i = 7 To 30000\n        If Sheets(\"Latest Report\").Cells(i, \"AL\").Value = \"Active - G to sign\" Then\n            If Sheets(\"Latest Report\").Cells(i, \"AJ\").Value &lt;&gt; \"\" Then\n                GenerateReadXML \"Z:\\AReports\\A\\Reports\\readXML\\gRead\" &amp; i &amp; \".xml\", Sheets(\"Latest Report\").Cells(i, \"AJ\").Value\n                sendXML \"readXML\\gRead\" &amp; i &amp; \".xml\", \"gRead\" &amp; i &amp; \"response\", \"Read\"\n\n                Set oXMLFile = CreateObject(\"Microsoft.XMLDOM\")\n                XMLFileName = \"Z:\\AReports\\A\\Reports\\fActivities\\results\\gRead\" &amp; i &amp; \"response.xml\"\n                'MsgBox XMLFileName\n                oXMLFile.Load (XMLFileName)\n                Set Numnode = oXMLFile.SelectNodes(\"/result/data29/text()\")\n                Set titleNode = oXMLFile.SelectNodes(\"/result/data25/text()\")\n                Set firstNode = oXMLFile.SelectNodes(\"/result/data26/text()\")\n                Set lastNode = oXMLFile.SelectNodes(\"/result/data27/text()\")\n\n                On Error GoTo didntfindit\n                Dim numStr As String\n                Dim titleStr As String\n                Dim firstStr As String\n                Dim lastStr As String\n\n                '### here's where it fails ###\n\n                numStr = Numnode(0).NodeValue\n                titleStr = titleNode(0).NodeValue\n                firstStr = firstNode(0).NodeValue\n                lastStr = lastNode(0).NodeValue\n\n                GenerateDialerXML \"Z:\\AReports\\A\\Reports\\dialerXML\\dialer\" &amp; i &amp; \".xml\", Numnode(0).NodeValue, titleNode(0).NodeValue, firstNode(0).NodeValue, lastNode(0).NodeValue, Sheets(\"Latest Report\").Cells(i, \"AJ\").Value, 87\n                sendDialerXML \"dialer\" &amp; i &amp; \".xml\", sendHandshake, \"gDResponse\"\ndidntfindit:\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>When it fails, it's because the XML is like this:</p>\n\n<pre><code>&lt;data24&gt;something&lt;/data24&gt;\n&lt;/data25&gt;\n&lt;/data26&gt;\n&lt;/data27&gt;\n&lt;data28&gt;something else&lt;/data28&gt;\n&lt;/data29&gt;\n</code></pre>\n\n<p>It works fine when there are values, but I can't figure out the next step.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568822072, "post_id": 57990288, "comment_id": 102399827, "body": "It seems like you need to call procedureWithInputparamters inside the PseudoMacro."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1568823952, "post_id": 57990288, "comment_id": 102400678, "body": "I realize that you won&#39;t be able to pass your local variable that way but VBA needs to stop running for a brief instant in order to let the OS or the Excel Application complete want you want it to do. In the example you gave, VBA doesn&#39;t stop before running the <code>procedureWithInputparamters</code> and that&#39;s why it doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568840392, "post_id": 57997775, "comment_id": 102407088, "body": "Thanks for the explanation, I figured as much. In both examples, the first procedure ends after the second one. So something must force the code to get executed in the first example (or in your words, control is given back to the OS / VBA stops running). Do you know exactly why this is the case - what exactly goes on &quot;internally&quot;?"}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568840435, "post_id": 57997775, "comment_id": 102407100, "body": "I wonder if it&#39;s the fact that there is additional code after the Application.OnTime and before the <code>end</code>-command of the first procedure in the second example. It should be simple enough to test it."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568841687, "post_id": 57997775, "comment_id": 102407550, "body": "I&#39;m not sure of exactly what goes on internally or under the hood, but my guess is that the fact that your VBA code is accessing the clipboard could prevent other applications or processes to access it until the complete VBA stack is executed in order to avoid conflicts."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1568908101, "last_edit_date": 1568908101, "creation_date": 1568826647, "answer_id": 57997775, "question_id": 57990288, "link": "https://stackoverflow.com/questions/57990288/vba-using-application-ontime-to-force-code-execution/57997775#57997775", "title": "VBA: Using `Application.Ontime` to force code execution", "body": "<p>As discussed in your <a href=\"https://stackoverflow.com/questions/57856882/force-method-getfromclipboard-to-finish-before-executing-next-command-in-vba\">previous question</a>, <code>Application.OnTime</code> is used to schedule a procedure to run in the future, so we can use it at our advantage to let the OS or Excel update something that can't be updated while VBA is running.</p>\n\n<p>Note that it's the fact that our second procedure runs after the OS/Excel has regained control that make sure this works. You can see it visually in the diagram below where the red section is when VBA is not running:\n<a href=\"https://i.stack.imgur.com/DdhiI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DdhiI.png\" alt=\"enter image description here\"></a></p>\n\n<p>In your example, you call <code>procedureWithInputparamters</code> (your second procedure) from the first macro which means there is no interruption of VBA before that second macro runs. This means the OS can't update even if you ran a <code>Application.OnTime</code> command. </p>\n\n<p><a href=\"https://i.stack.imgur.com/7Wop9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Wop9.png\" alt=\"enter image description here\"></a>\n<sub>*Image not to scale</sub></p>\n\n<p>That's because it's not the fact that you ran <code>Application.OnTime</code> that matters, what matters is that VBA stops running for a brief instant before your second procedure runs. Which doesn't happen in that second case using the <code>PseudoMacro</code>.</p>\n\n<h3> An alternative solution </h3>\n\n<p>If you need to pass arguments to the procedure you are calling with <code>Application.OnTime</code>, it seems like <a href=\"https://stackoverflow.com/questions/31439866/multiple-variable-arguments-to-application-ontime\">this question</a> has the answer you're looking for.</p>\n\n<p>As suggested by Holger Leichsenring's answer, you can pass a string as the argument of the function by adding an apostrophes at the beginning and the end of the value you pass; having a space after the name of your procedure; and surrounding your string argument by quotation marks ( Chr$(34) ).</p>\n\n<p>E.g.</p>\n\n<pre><code>Application.OnTime Now + TimeSerial(0, 0, 1), \"'procedureWithInputparamters \" &amp; Chr$(34) &amp; inputVariable &amp; Chr$(34) &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 57997775, "answer_count": 1, "score": 2, "last_activity_date": 1568908101, "creation_date": 1568801411, "last_edit_date": 1568839334, "question_id": 57990288, "link": "https://stackoverflow.com/questions/57990288/vba-using-application-ontime-to-force-code-execution", "title": "VBA: Using `Application.Ontime` to force code execution", "body": "<p>This is a followup on this <a href=\"https://stackoverflow.com/questions/57856882/force-method-getfromclipboard-to-finish-before-executing-next-command-in-vba/57863649?noredirect=1#comment102374960_57863649\">question/answer/comment</a>...</p>\n\n<p>I'm trying to force code execution of my first procedure (a procedure without input variables) by using Application.Ontime to start a second procedure (a procedure with input variables). Since Application.Ontime can only \"call\" a macro/procedure which doesn't allow for input variables I must use a global variable to pass on the input parameter to the second macro/procedure called by Application.Ontime (see the frist, working example). It works but I rather don't work with a global variable.</p>\n\n<p>I thought I'm smart and I use a \"pseudo-macro in-between\" which only exists to forces the code from the first procedure to get executed before the second procedure starts. But it doesn't work: the code execution isn't completed by the time the second procedure gets started. Is the problem that I use an empty pseudo-macro? I tried different commands in the pseudo macro, but it didn't make any differences. Any ideas? (see second, not working example)</p>\n\n<p>Frist example, which works (code gets executed before the macro):</p>\n\n<pre><code>Public gloInputVariable as Variant\n\nSub procedureWithoutInputparameters\n\n    'Do something in this procedure\n     inputVariable = \"something\"\n\n    'force code execution\n        'workaround with global variable instead of inputparameter (macros don't have input parameters)\n        gloInputVariable = \"something\"\n        'start the next procedure as a macro (basicaly a procedure without input paramters)\n        Application.OnTime Now + TimeSerial(0, 0, 1), \"WorkaroundMacroInsteadOfProcedureWithInputParameters\"\n\n    End Sub\n\nSub WorkaroundMacroInsteadOfProcedureWithInputParameters()\n    'get the input parameter through a global variable\n    variable1 = gloInputVariable\n    'do something\n    End Sub\n</code></pre>\n\n<p>Second example, which doesn't work (code from the first procedure is not completely executed before the second procedure starts):</p>\n\n<pre><code>Sub procedureWithoutInputparameters\n\n    'Do something in this procedure\n     inputVariable = \"something\"\n\n    'force code execution through pseudomacro (this doesn't work)\n        'force execution through macro\n        Application.Ontime Now + TimeSerial(0, 0, 1), \"Pseudomacro\"\n        'run next second procedure procedure\n        procedureWithInputparamters (inputVariable)\n\n    End Sub\n\nSub PseudoMacro()\n    'do nothing, pseudo-macro is only here to force code execution before starting the second procedure with input parameters\n    End Sub\n\nSub procedureWithInputparamters(strSomeInputString as String)\n    'get the input parameter \"directly\"\n    variable1 = strSomeInputString \n    'do something        \n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "save", "size"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568802601, "post_id": 57990192, "comment_id": 102388475, "body": "It is not clear for me, which book is increasing its size? I am trying to replicate your problem and the book keeps always the same size."}, {"owner": {"reputation": 19, "user_id": 5506899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208008101579293/picture?type=large", "display_name": "Riccardo Crevatin", "link": "https://stackoverflow.com/users/5506899/riccardo-crevatin"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568809555, "post_id": 57990192, "comment_id": 102392327, "body": "The template T (wbTEM in the code). I open, I save it as &quot;A&quot; (which closes the template T and leaves open a file &quot;A&quot;). Then overwrite &quot;A&quot;, save it as &quot;B&quot; (which closes &quot;A&quot; and leaves open a file &quot;B&quot; 200 Kb bigger) and so on."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568810021, "post_id": 57990192, "comment_id": 102392614, "body": "@RiccardoCrevatin Do you add stuff in your sheets ?"}, {"owner": {"reputation": 19, "user_id": 5506899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208008101579293/picture?type=large", "display_name": "Riccardo Crevatin", "link": "https://stackoverflow.com/users/5506899/riccardo-crevatin"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568810861, "post_id": 57990192, "comment_id": 102393051, "body": "@Dorian, I overwrite the 16 sheets with the new numbers, in those 3x1300 ranges. In the code, &quot;arrTotals&quot; is the array of the numbers I need, &quot;wbTem&quot; is the template. (I deleted the part in which I calculate the exact worksheet number &quot;wsN&quot; and workbook number &quot;wbN&quot;). No other thing than basically replacing those numbers."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568810940, "post_id": 57990192, "comment_id": 102393097, "body": "@RiccardoCrevatin May I Ask you to check if the old value are deleted and replaced by the new ones ?"}, {"owner": {"reputation": 19, "user_id": 5506899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208008101579293/picture?type=large", "display_name": "Riccardo Crevatin", "link": "https://stackoverflow.com/users/5506899/riccardo-crevatin"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1568814035, "post_id": 57990192, "comment_id": 102394924, "body": "@Dorian, you were right, I had an error in the formula assigning the value in the cell: I was not replacing them, but adding them aside (beyond the screen actually, so I didn&#39;t notice it at first). The problem was therefore that I was adding an increasingly high amount of columns in my workseet. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 0, "last_activity_date": 1568815721, "last_edit_date": 1568815721, "creation_date": 1568814101, "answer_id": 57994166, "question_id": 57990192, "link": "https://stackoverflow.com/questions/57990192/excel-vba-macro-looping-save-as-increases-file-size/57994166#57994166", "title": "Excel VBA macro looping &quot;Save As&quot; increases file size?", "body": "<p>The issue is that the Excel file where you add data is not cleaned as expected. So the number of rows of your file increase.  </p>\n"}], "owner": {"reputation": 19, "user_id": 5506899, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208008101579293/picture?type=large", "display_name": "Riccardo Crevatin", "link": "https://stackoverflow.com/users/5506899/riccardo-crevatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "closed_date": 1569502441, "accepted_answer_id": 57994166, "answer_count": 1, "score": 0, "last_activity_date": 1568815721, "creation_date": 1568801158, "question_id": 57990192, "link": "https://stackoverflow.com/questions/57990192/excel-vba-macro-looping-save-as-increases-file-size", "closed_reason": "Not suitable for this site", "title": "Excel VBA macro looping &quot;Save As&quot; increases file size?", "body": "<p>I am working with 3 separate Excel files.\nOne (File D.xlsx) has the data, that I'll store into an array.\nOne (File M.xlsm) has the macro, which performs some calculation on the data.\nOne (File T.xlsx) is a template of 16 sheets -3 cols x 1300 rows each- where a final array is inserted cell by cell (no Range assignment, if it matters).</p>\n\n<p>Once I am done populating the template, I \"Save As\" and then overwrite it with the next series of data, then \"Save As\", and so on. The problem is that it adds 200 Kb each run, and I need to have 150 of those final files, meaning that the last will be 30 Mb bigger than the template, without having anything different in terms of content.</p>\n\n<p>I already tried:\nTo save it without specifying the extension in the filename - no change.\nTo save it as binary - same problem just in smaller scale (+10 kb per run).\nTo disable autorecovery for the workbook - no change.\nTo disable/enable updating, status bar, events, etc - no change.\nTo only insert the values &lt;> 0 - no change.</p>\n\n<pre><code>For q = 1 To UBound(arrTotals, 2) Step 3\n   For n = 1 To UBound(arrTotals, 1)\n        wbTEM.Worksheets(wsN).Cells(n, q).Value = arrTotals(n, q)\n        wbTEM.Worksheets(wsN).Cells(n, q + 1).Value = arrTotals(n, q + 1)\n        wbTEM.Worksheets(wsN).Cells(n, q + 2).Value = arrTotals(n, q + 2)\n   Next n\n   If (q + 2) Mod 48 = 0 Then\n        wbTEM.SaveAs FileName:=pathx &amp; arrNames(wbN) &amp; \".xlsb\", FileFormat:=50\n   End If\nNext q\n</code></pre>\n\n<p>The array of results is an array of Doubles, but we're not talking of astronomical data and anyway the values are more or less the same, so I would expect to have all the files the same size, not consistently increasing their size.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "edited": false, "score": 0, "creation_date": 1568804880, "post_id": 57990325, "comment_id": 102389709, "body": "Thank you Gustav.. It&#39;s working now and just to make sure, i also added a Dlookup as my default value in my 2 fields"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1568801525, "creation_date": 1568801525, "answer_id": 57990325, "question_id": 57989895, "link": "https://stackoverflow.com/questions/57989895/how-can-i-reflect-copy-changes-from-one-form-to-another-in-ms-access/57990325#57990325", "title": "How can i reflect/copy changes from one form to another in MS Access", "body": "<p>You could <em>refresh</em> or <em>requery</em> the other form in the <em>AfterUpdate</em> event of form \"GSAP Accounts\":</p>\n\n<pre><code>Forms!Failures.Refresh  \n'or:\n' Forms!Failures.Requery\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 1, "accepted_answer_id": 57990325, "answer_count": 1, "score": 0, "last_activity_date": 1594449341, "creation_date": 1568800231, "last_edit_date": 1594449341, "question_id": 57989895, "link": "https://stackoverflow.com/questions/57989895/how-can-i-reflect-copy-changes-from-one-form-to-another-in-ms-access", "title": "How can i reflect/copy changes from one form to another in MS Access", "body": "<p>I have a Main Form named \"GSAPAccounts\" referred to a query with the same name and another form (not a subform) named \"Failures\" referred to query also named as failures.</p>\n\n<p>I have a condition in my GSAPAccounts where, when a condition is met, Failures (form) will pop out. In my Failure forms I have 2 fields to be populated \"General Reason\" and \"Comments\" (which is also in my GSAPAccounts Form) and a command button to close the form, and I also have included the \"ID\" as the common field between the 2 forms.</p>\n\n<p>My question now is: Is it possible that when I make changes in my \"Failures\" form to reflect it in my \"GSAP Accounts\" form?</p>\n\n<p>I am quite new to MS Access, and what I've done so far is just the code below. When I make changes in the Failures form, it is not updating in my other form.\nI already tried everything that I can find in Google but nothing is working for me.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If IsNull(Me.General_Reason) Or IsNull(Me.Comments) Then\n    MsgBox \"Provide M15 Failure Reason\"   \nElse\n    DoCmd.Save\n    DoCmd.Close               \nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "string-formatting", "string-concatenation", "superscript"], "comments": [{"owner": {"reputation": 29641, "user_id": 10871073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ddBW9.png?s=128&g=1", "display_name": "Adrian Mole", "link": "https://stackoverflow.com/users/10871073/adrian-mole"}, "edited": false, "score": 0, "creation_date": 1568799487, "post_id": 57989545, "comment_id": 102386720, "body": "It may be helpful to show an example of what your output is currently, even if it&#39;s not what you want. That may help in error diagnosis."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1568801128, "post_id": 57989545, "comment_id": 102387660, "body": "I have never seen the use of &gt;&gt;&gt;&gt; in VBA code like that. What&#39;s the purpose?"}], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 1, "last_activity_date": 1568800973, "creation_date": 1568800973, "answer_id": 57990124, "question_id": 57989545, "link": "https://stackoverflow.com/questions/57989545/concatenation-of-2-strings-and-superscript/57990124#57990124", "title": "Concatenation of 2 strings and superscript", "body": "<p>You are missing a Set line 6:</p>\n\n<pre><code>Set C = Range(\"C1\")\n</code></pre>\n\n<p>This is actually what you want to suberscript the last character of a string in C1 on the active sheet:</p>\n\n<pre><code>ActiveSheet.Range(\"C1\").Characters(Start:=Len(Range(\"C1\").Value), _\nLength:=1).Font.Superscript = True\n</code></pre>\n\n<p>The way you wrote it it should superscript the entire text, not just the 1.</p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1568801073, "creation_date": 1568801073, "answer_id": 57990161, "question_id": 57989545, "link": "https://stackoverflow.com/questions/57989545/concatenation-of-2-strings-and-superscript/57990161#57990161", "title": "Concatenation of 2 strings and superscript", "body": "<p>You could try the following (assuming you have more rows than just cells A1 &amp; B1):</p>\n\n<p><strong><em>Sample data:</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/UqzbQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UqzbQ.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>Code:</em></strong></p>\n\n<pre><code>Sub SuperScriptTxt()\n\nDim rng As Range, cl As Range, lr As Long\nWith ThisWorkbook.Sheets(\"Sheet1\") 'Change accordingly\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set rng = .Range(\"C2:C\" &amp; lr)\n    For Each cl In rng\n        cl.Value = cl.Offset(, -2) &amp; cl.Offset(, -1) 'Leave out this line, if concatenated values are actually already in place.\n        cl.Characters(Len(cl.Offset(, -2)) + 1, Len(cl.Offset(, -1))).Font.SuperScript = True\n    Next cl\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>Result:</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/JEVJx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JEVJx.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 1, "last_activity_date": 1568801142, "creation_date": 1568801142, "answer_id": 57990188, "question_id": 57989545, "link": "https://stackoverflow.com/questions/57989545/concatenation-of-2-strings-and-superscript/57990188#57990188", "title": "Concatenation of 2 strings and superscript", "body": "<p>Try this one</p>\n\n<pre><code>Sub exposantmiseenforme()\n\nDim l As Integer\n\nl = Len(Range(\"B1\"))\nWorksheets(\"Sheet1\").Range(\"C1\").Characters(l + 1, 1).Font.Superscript = True\n\nEnd Sub\n</code></pre>\n\n<p>Hope it helps. (I am supposing that that cell is already formulated)</p>\n"}], "owner": {"reputation": 1, "user_id": 12084145, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-P04LU3_3XTA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7hPKKibUwuZLX8UuaYmZgJxiI9w/photo.jpg?sz=128", "display_name": "Oumayma El Jahrani", "link": "https://stackoverflow.com/users/12084145/oumayma-el-jahrani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1568802592, "creation_date": 1568799162, "last_edit_date": 1568802592, "question_id": 57989545, "link": "https://stackoverflow.com/questions/57989545/concatenation-of-2-strings-and-superscript", "title": "Concatenation of 2 strings and superscript", "body": "<p>My issue is that i have 3 cells A1 , B1 and C1  ; A1 contains a number, B1 a string and C1 contains the concatenation of B1 and A1 . Let's say A1 contains the value 1 and B1 the value \"Test\" ; I want C1 to Contain Test1 but with 1 as a superscript . Here's the code i've written but that isn't working : </p>\n\n<pre><code>Sub exposantmiseenforme()\n\n    Dim i As Integer\n    Dim C As Range\n    Dim l As Integer\n\n    l = Len(Range(\"B1\"))\n    C = Range(\"C1\")\n\n    With C.Characters(Start:=l, Length:=l + 1).Font\n        .Name = \"Calibri\"\n        .FontStyle = \"Normal\"\n        .Size = 11\n        .Strikethrough = False\n        .Superscript = True\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontMinor\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Thank's in advance for your help ! </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1568798214, "post_id": 57988983, "comment_id": 102385944, "body": "That won&#39;t affect how it works (the error is because your lookup value isn&#39;t found); it just means you have (or had) used the word <code>vlookup</code> as the name of something in your code."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1568798248, "post_id": 57988983, "comment_id": 102385961, "body": "Are you sure there should be a match? The error is thrown when Vlookup is unable to find one."}, {"owner": {"reputation": 19, "user_id": 7691339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036c22bb02cf6647f3ea0f066de11997?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth Kalia", "link": "https://stackoverflow.com/users/7691339/siddharth-kalia"}, "edited": false, "score": 0, "creation_date": 1568799749, "post_id": 57988983, "comment_id": 102386885, "body": "Thankyou,my apologies for the typo in the code. This snippet worked but the error still exists in the other snippet which I am adding the question itself."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1568802156, "post_id": 57988983, "comment_id": 102388203, "body": "You should specify in which worksheet these <code>Range</code> and <code>Cells</code> objects are <code>Range(Cells(1, 1), Cells(lastrow2, lastcol2))</code>!"}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1568798531, "creation_date": 1568798531, "answer_id": 57989337, "question_id": 57988983, "link": "https://stackoverflow.com/questions/57988983/vba-changing-vlookup-to-vlookup/57989337#57989337", "title": "Vba changing .Vlookup to .vlookup", "body": "<p>The way it behaves indicates that you have declared a variable with name of <code>vlookup</code> and now it tries to correct whenever you type <code>VLookup</code>.</p>\n\n<p>I suggest you use <code>Option Explicit</code> (just type it at the top of your code file).</p>\n"}, {"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 1, "last_activity_date": 1568798766, "creation_date": 1568798766, "answer_id": 57989411, "question_id": 57988983, "link": "https://stackoverflow.com/questions/57988983/vba-changing-vlookup-to-vlookup/57989411#57989411", "title": "Vba changing .Vlookup to .vlookup", "body": "<p>You are searching in range <code>ThisWorkbook.Sheets(\"Constraints Data\").Range(Cells(1, 1), Cells(3, 2))</code></p>\n\n<p>That range is 3 rows 2 columns.</p>\n\n<p>But in your VLOOKUP, in third argument, you type <code>3</code> to retrieve the value in the third column.</p>\n\n<p>And there is not third column. That causes the error.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 2, "last_activity_date": 1568799185, "last_edit_date": 1568799185, "creation_date": 1568798809, "answer_id": 57989424, "question_id": 57988983, "link": "https://stackoverflow.com/questions/57988983/vba-changing-vlookup-to-vlookup/57989424#57989424", "title": "Vba changing .Vlookup to .vlookup", "body": "<p>You are trying to get the 3rd column of the range BUT your range has only 2 columns.</p>\n\n<p>You have to options:</p>\n\n<ol>\n<li>If the range you look has 2 columns - Change <code>3, False)</code> to <code>2, False)</code></li>\n<li>If the range you look has 3 columns - Change <code>wsB.Cells(3, 2))</code> to <code>wsB.Cells(3, 3))</code></li>\n</ol>\n\n<p>I try to simplify the code:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim wsA As Worksheet, wsB As Worksheet\n\n\n    With ThisWorkbook\n        Set wsA = .Sheets(\"Sheet5\")\n        Set wsB = .Sheets(\"Constraints Data\")\n    End With\n\n    wsA.Cells(2, 2) = Application.WorksheetFunction.VLookup(wsA.Cells(2, 1), wsB.Range(wsB.Cells(1, 1), wsB.Cells(3, 2)), 3, False)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7691339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036c22bb02cf6647f3ea0f066de11997?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth Kalia", "link": "https://stackoverflow.com/users/7691339/siddharth-kalia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1568802017, "creation_date": 1568797498, "last_edit_date": 1568802017, "question_id": 57988983, "link": "https://stackoverflow.com/questions/57988983/vba-changing-vlookup-to-vlookup", "title": "Vba changing .Vlookup to .vlookup", "body": "<p>I am trying to <code>vlookup</code> some data from one sheet to the other.\nWhenever I try <code>Vlookup</code> using VBA: the result is <code>Application.WorksheetFunction.vlookup</code>\ninstead of\n<code>Application.WorksheetFunction.VLookup</code></p>\n\n<p>This is happening only in this project. Even if I try creating a new module, it doesn't help.\nI tried in a new project and it works perfectly fine there.</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Sheet5\").Cells(2, 2) = Application.WorksheetFunction _\n    .vlookup(ThisWorkbook.Sheets(\"Sheet5\").Cells(2, 1), _\n    ThisWorkbook.Sheets(\"Constraints Data\").Range(Cells(1, 1), Cells(3, 2)), 3, False)\n</code></pre>\n\n<p>EDIT: this snippet worked as the column was out of range. However, the error persists in the following snippet</p>\n\n<pre><code>Set wb = ThisWorkbook.Sheets(\"DAH DATA\")\nSet sh = ThisWorkbook.Sheets(\"Constraints Data\")\n\nlastrow2 = wb.Cells(Rows.count, 1).End(xlUp).row\nlastcol2 = wb.Cells(2, Columns.count).End(xlToLeft).Column\nwb.Activate\nSet rng1 = Range(Cells(1, 1), Cells(lastrow2, lastcol2))\n\nsh.Cells(132, 22).Value = Application.WorksheetFunction.vlookup _\n(\"7/30/2019\", rng1, 2, 0)\n</code></pre>\n\n<p>As a result of this I get </p>\n\n<blockquote>\n  <p>Error 1004: Unable to get VLookup property of Worksheet function\n  class.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1568798435, "post_id": 57988810, "comment_id": 102386075, "body": "Check Conditiona Formatting rules. There is an option to show icons/symbols that does exactly what you want"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12083753, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x42bOxwfCx8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rel08hvm3ZMxpEjlHYKl6R7IMRiPw/photo.jpg?sz=128", "display_name": "Ali Sami", "link": "https://stackoverflow.com/users/12083753/ali-sami"}, "edited": false, "score": 0, "creation_date": 1568808450, "post_id": 57989706, "comment_id": 102391687, "body": "it is very good..... Thank you Mr. Angad Gupta,. kindly , can me do it this, to cell by cell? or, there is method to do all cells ?"}], "tags": [], "owner": {"reputation": 89, "user_id": 12074269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCWDe7GtB539PwklIwdstIZCrU46F1_fsEzQZ-_w=k-s128", "display_name": "Angad Gupta", "link": "https://stackoverflow.com/users/12074269/angad-gupta"}, "is_accepted": true, "score": 0, "last_activity_date": 1568799644, "creation_date": 1568799644, "answer_id": 57989706, "question_id": 57988810, "link": "https://stackoverflow.com/questions/57988810/arrow-direction-in-cell-campared-with-another-cell-in-excel/57989706#57989706", "title": "arrow direction in cell campared with another cell in excel", "body": "<p>This can be resolved with conditional formatting technique, to apply the same please follow the following steps</p>\n\n<ol>\n<li>1.Select cell G4 and click on the conditional formatting menu (available on home tab)\n\n<ol start=\"2\">\n<li>Select New rule option..</li>\n<li>Select first option \"Format all cell based on their value\"</li>\n<li>Change format style to icon sets</li>\n<li>Select icon style as arrow</li>\n<li>change the icon (Green upward arrow for max &amp; red downward arrow for min)\n7.Select value type from percent to the formula in both place</li>\n<li>Select the B3 in both formula box </li>\n<li>click ok</li>\n</ol></li>\n</ol>\n\n<p>based on the cell value the arrows will change\nrefer the attached example\n<a href=\"https://i.stack.imgur.com/knU6s.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}], "owner": {"reputation": 1, "user_id": 12083753, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-x42bOxwfCx8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rel08hvm3ZMxpEjlHYKl6R7IMRiPw/photo.jpg?sz=128", "display_name": "Ali Sami", "link": "https://stackoverflow.com/users/12083753/ali-sami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "closed_date": 1568813863, "accepted_answer_id": 57989706, "answer_count": 1, "score": -5, "last_activity_date": 1568870134, "creation_date": 1568796924, "last_edit_date": 1568870134, "question_id": 57988810, "link": "https://stackoverflow.com/questions/57988810/arrow-direction-in-cell-campared-with-another-cell-in-excel", "closed_reason": "Needs more focus", "title": "arrow direction in cell campared with another cell in excel", "body": "<p>I want compare data in A,B,C,D and E columns in 2019 with A,B,C,D and E columns in 2018 in same row where be following:</p>\n\n<ol>\n<li>if cell B4 in 2019 greater than cell G4 in 2018 that will appearance arrow direction to up in cell G4</li>\n<li>if cell B4 in 2019 less than cell G4 in 2018 that will appearance arrow direction to down in cell G4</li>\n<li>if cell B4 in 2019 equal to cell G4 in 2018 that will appearance horizontal line in cell G4. </li>\n</ol>\n\n<p>For example: This image shows the results that I want.\n<a href=\"https://i.stack.imgur.com/c7Ap7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c7Ap7.jpg\" alt=\"example results\"></a></p>\n"}, {"tags": ["python", "excel", "python-3.x", "vba", "openpyxl"], "comments": [{"owner": {"reputation": 13209, "user_id": 7414759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b272ce66c7c245c6cbe9a830691daddc?s=128&d=identicon&r=PG&f=1", "display_name": "stovfl", "link": "https://stackoverflow.com/users/7414759/stovfl"}, "edited": false, "score": 0, "creation_date": 1568816437, "post_id": 57988794, "comment_id": 102396438, "body": "<a href=\"https://stackoverflow.com/posts/57988794/edit\">Edit</a> your question and show the <code>openpyxl</code> version and tell if you have verified Excel can read the <code>.xlsx</code> file."}, {"owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "reply_to_user": {"reputation": 13209, "user_id": 7414759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b272ce66c7c245c6cbe9a830691daddc?s=128&d=identicon&r=PG&f=1", "display_name": "stovfl", "link": "https://stackoverflow.com/users/7414759/stovfl"}, "edited": false, "score": 0, "creation_date": 1568878529, "post_id": 57988794, "comment_id": 102416722, "body": "@stovfl the openpyxl version is 2.5.3 and i can open other .xlsx files. i only have a problem with this particular file and my best guess is because it has so many tabs but i need somebody to confirm that or point me in the right direction please?"}, {"owner": {"reputation": 13209, "user_id": 7414759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b272ce66c7c245c6cbe9a830691daddc?s=128&d=identicon&r=PG&f=1", "display_name": "stovfl", "link": "https://stackoverflow.com/users/7414759/stovfl"}, "edited": false, "score": 1, "creation_date": 1568880694, "post_id": 57988794, "comment_id": 102417750, "body": "My request was <b>not</b>, <b><i>&quot;can open other .xlsx files&quot;</i></b>, i asked: <b>Can you open this <code>.xlsx</code> in question with Excel</b>? Your <code>openpyxl</code> version is outdated, update to the current <a href=\"https://openpyxl.readthedocs.io/en/stable/\" rel=\"nofollow noreferrer\">Version:2.6.2</a>"}, {"owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "reply_to_user": {"reputation": 13209, "user_id": 7414759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b272ce66c7c245c6cbe9a830691daddc?s=128&d=identicon&r=PG&f=1", "display_name": "stovfl", "link": "https://stackoverflow.com/users/7414759/stovfl"}, "edited": false, "score": 0, "creation_date": 1568887806, "post_id": 57988794, "comment_id": 102421546, "body": "@stovfl yes, i can open the .xlsx file with excel. and i have moved all the tabs to a different workbook and the file opens in openpyxl, the issue is that i need the original file to open. version has been updated with the same result."}, {"owner": {"reputation": 13209, "user_id": 7414759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b272ce66c7c245c6cbe9a830691daddc?s=128&d=identicon&r=PG&f=1", "display_name": "stovfl", "link": "https://stackoverflow.com/users/7414759/stovfl"}, "edited": false, "score": 0, "creation_date": 1568888130, "post_id": 57988794, "comment_id": 102421740, "body": "If you think it&#39;s a bug in <code>openpyxl</code>, file a issue to <a href=\"http://bitbucket.org/openpyxl/openpyxl/issues\" rel=\"nofollow noreferrer\">openpyxl/issues</a>"}], "answers": [{"tags": [], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "is_accepted": true, "score": 0, "last_activity_date": 1568889559, "creation_date": 1568889559, "answer_id": 58009174, "question_id": 57988794, "link": "https://stackoverflow.com/questions/57988794/openpyxl-library-stopiteration-error-when-opening-xlsx-file/58009174#58009174", "title": "openpyxl library StopIteration error when opening xlsx file", "body": "<p>The issue was not with openpyxl or the python environment. the issue was with the way the original workbook had been saved. although it was saved as a .xlsx document but it was not an excel workbook, it was a Strict Open XML Spreadsheet .xlsx\nso at first glance it was assumed that this file will open with no issues.\nonce the file was changed to an excel Workbook .xlsx then the file loaded with no issues.</p>\n\n<p>I hope this post helps people that have committed the same mistake i have!</p>\n"}], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 58009174, "answer_count": 1, "score": 0, "last_activity_date": 1568889559, "creation_date": 1568796871, "last_edit_date": 1568889505, "question_id": 57988794, "link": "https://stackoverflow.com/questions/57988794/openpyxl-library-stopiteration-error-when-opening-xlsx-file", "title": "openpyxl library StopIteration error when opening xlsx file", "body": "<p>I am trying to open a excel file that is 1.5mb, it has 25 sheets and no more than 1000 rows per sheet. there is nothign special about the file. it is not read-only as well.\nI need to perform some automation tasks to the file but when i try to import it onto my Jupyther environment i get the following error:</p>\n\n<pre><code>---------------------------------------------------------------------------\nStopIteration                             Traceback (most recent call last)\n&lt;ipython-input-20-4584f4eff7cc&gt; in &lt;module&gt;()\n----&gt; 1 eppm = oxl.load_workbook('DCB EPPM Demand Extract 2.xlsx')\n\n~/anaconda3/envs/python3/lib/python3.6/site- \npackages/openpyxl/reader/excel.py in load_workbook(filename, read_only, \nkeep_vba, data_only, guess_types, keep_links)\n222 \n223     apply_stylesheet(archive, wb) # bind styles to workbook\n--&gt; 224     pivot_caches = parser.pivot_caches\n225 \n226     # get worksheets\n\n~/anaconda3/envs/python3/lib/python3.6/site- \npackages/openpyxl/packaging/workbook.py in pivot_caches(self)\n123         d = {}\n124         for c in self.caches:\n--&gt; 125             cache = get_rel(self.archive, self.rels, id=c.id, \ncls=CacheDefinition)\n126             records = get_rel(self.archive, cache.deps, cache.id, \nRecordList)\n127             cache.records = records\n\n~/anaconda3/envs/python3/lib/python3.6/site- \npackages/openpyxl/packaging/relationship.py in get_rel(archive, deps, id, \ncls)\n151         rel = deps[id]\n152     else:\n--&gt; 153         rel = next(deps.find(cls.rel_type))\n154 \n155     path = rel.target\n\nStopIteration: \n</code></pre>\n\n<p>I cannot share the file because it contains company information and I cannot create dummy data to recreate the file because the Python error does not seem to indicate where the error is occuring.\nI have looked for a similar error on SO but the StopIteration error normally happens when people are working with loops.\nany help will be highly appreciated!</p>\n"}, {"tags": ["excel", "vba", "timestamp", "datestamp"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1568796402, "post_id": 57988600, "comment_id": 102384884, "body": "I assume the output is in a cell. If this is the case simply set the value of the cell with the value of the time stamp so it does not update with the <code>Now</code> logic. You can then set a trigger for when you want to define it to update."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568796834, "post_id": 57988600, "comment_id": 102385120, "body": "<code>If Len(Trim(rng.Value)) = 0 Then rng.Value = Format(Now, &quot;dd&#47;mm&#47;yyyy HH:mm&quot;)</code> Insert the time stamp only if the cell where you want to put the timestamp is empty."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1568796842, "post_id": 57988600, "comment_id": 102385125, "body": "Your code checks if <code>Reference</code> <b>is not</b> empty. If true, then it will calculate <code>Datestamp1</code>. If false, it will empty variable <code>Datestamp1</code>. IS that right? Shouldn&#39;t it be <code>If Reference.Value = &quot;&quot;</code>?"}, {"owner": {"reputation": 11, "user_id": 11823405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d466f29b16103c953f13d2912d3cb8?s=128&d=identicon&r=PG&f=1", "display_name": "rwc14", "link": "https://stackoverflow.com/users/11823405/rwc14"}, "edited": false, "score": 0, "creation_date": 1568797500, "post_id": 57988600, "comment_id": 102385499, "body": "Sorry if I wasn&#39;t clear: forgot to add that I have =Datstamp1(S2) in the T column so that if anything is entered in the S cells then a time stamp appears in T."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568806292, "post_id": 57988600, "comment_id": 102390540, "body": "Then do not handle it using formulas. Use Worksheet_Change Event"}], "owner": {"reputation": 11, "user_id": 11823405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5d466f29b16103c953f13d2912d3cb8?s=128&d=identicon&r=PG&f=1", "display_name": "rwc14", "link": "https://stackoverflow.com/users/11823405/rwc14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568817658, "creation_date": 1568796249, "last_edit_date": 1568817658, "question_id": 57988600, "link": "https://stackoverflow.com/questions/57988600/static-date-and-time-stamp-vba", "title": "Static date and time stamp VBA", "body": "<p>I have the following code in a module for a date and time stamp but when I open the spreadsheet each day, the spreadsheet is restamping and putting the present date and time from today instead of yesterday.  Does anyone know if I'm missing something in the code to stop the spreadsheet from doing this as I need to retain the stamps from when they happened?  Thanks in advance.</p>\n\n<pre><code>    If Reference.Value &lt;&gt; \"\" Then\n        Datestamp1 = Format(Now, \"dd/mm/yyyy HH:mm\")\n    Else\n        Datestamp1 = \"\"\n    End If\n\n    Application.EnableEvents = False\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1568796946, "post_id": 57988569, "comment_id": 102385182, "body": "This would be better suited to <a href=\"https://codereview.stackexchange.com/\">Code Review</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1568800972, "creation_date": 1568800972, "answer_id": 57990122, "question_id": 57988569, "link": "https://stackoverflow.com/questions/57988569/how-can-i-increase-the-performance-between-access-and-excel-with-this-vba-code/57990122#57990122", "title": "How can i increase the performance between Access and Excel with this VBA Code?", "body": "<p>You could start by hiding Excel as screen updating takes a lot of resources:</p>\n\n<pre><code>objExcel.Visible = False\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 12023644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/516bca35ef7bd7a7cbf13d6e87427aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Frederic", "link": "https://stackoverflow.com/users/12023644/frederic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594449357, "creation_date": 1568796159, "last_edit_date": 1594449357, "question_id": 57988569, "link": "https://stackoverflow.com/questions/57988569/how-can-i-increase-the-performance-between-access-and-excel-with-this-vba-code", "title": "How can i increase the performance between Access and Excel with this VBA Code?", "body": "<p>i want to increase the performance of this code:</p>\n\n<pre><code>Dim...\n...\n...\n...\n...\n\n\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\n\nSet wb = objExcel.Workbooks.Open(\"C:\\Dateipfad\\Dateiname.xlsx\", True)\nSet rs = db.OpenRecordset(\"Select DataPointVID from My_ValidReport\", dbOpenSnapshot)\n\nDo Until rs.EOF = True\n    For Each ws In wb.Worksheets\n        Set ValidMeldeposition = ws.UsedRange.Cells.Find(What:=rs!DataPointVID)\n        If Not (ValidMeldeposition Is Nothing) Then ValidMeldeposition.Interior.ColorIndex = 43\n    Next ws\n    rs.MoveNext\nLoop\n\nj = 0\nDo While Dir(Dokumentenpfad) &lt;&gt; \"\"\n    j = j + 1\n    Dokumentenpfad = CurrentProject.Path &amp; \"\\Dateiname\" &amp; Format(Date, \" dd.mm.yyyy\") &amp; \" (\" &amp; j &amp; \")\" &amp; \".xlsx\"\nLoop\n\nNeuerReport = Dokumentenpfad\n\nwb.SaveCopyAs (NeuerReport)\nMsgBox \"Your file was saved here: \" &amp; vbCrLf &amp; \"'\" &amp; NeuerReport &amp; \"'\"\nobjExcel.Visible = True\n\nSet objWorkbook = Nothing\nSet objExcel = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The problem is that the Excelfile contains over 70 Worksheets and every Sheet includes ID's which are checked by the code and also by the Access-Query which includes the ID's</p>\n\n<p>Best regards</p>\n\n<p>Frederic</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1568796345, "post_id": 57988556, "comment_id": 102384849, "body": "Can&#39;t see it in the documentation but fairly sure MATCH only works on single rows/columns. You could use <code>Find</code> instead."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1568796604, "post_id": 57988556, "comment_id": 102384992, "body": "Match returns the position inside the array of whatever it matches with as a number, but this only works in a single direction. If there is more dimensions to the range it couldn&#39;t output a single match number like &quot;Match no. 4&quot; but had to say &quot;Match no. row 1 col 3&quot; which is simply not what Match is designed for. As @SJR recommended, use <code>FIND</code> instead."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568796723, "post_id": 57988556, "comment_id": 102385066, "body": "Hadn&#39;t noticed that you stated this in your question and were asking why. Pass on that. I suppose the banal answer is that is how Microsoft programmed it."}], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568799335, "post_id": 57988662, "comment_id": 102386636, "body": "Find() not an option (see question&#39;s comments) but thanks anyway."}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568880266, "post_id": 57988662, "comment_id": 102417557, "body": "I found out it actually does return a (range) address (which can be seen as a position, but essentially I don&#39;t think what it is), plz see my comment under Plutian&#39;s answer."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 1, "last_activity_date": 1568796457, "creation_date": 1568796457, "answer_id": 57988662, "question_id": 57988556, "link": "https://stackoverflow.com/questions/57988556/vba-excel-why-does-the-match-method-not-work-for-all-types-of-ranges/57988662#57988662", "title": "VBA/Excel: why does the match() method not work for all &quot;types&quot; of ranges", "body": "<p>Match looks through a one-dimensional array and returns the matching value's position (not a range, address, etc.). Match only returns a number indicating the position. For what you're trying to do <code>Find</code> should do the trick.</p>\n"}, {"comments": [{"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568881581, "post_id": 57990338, "comment_id": 102418177, "body": "Actually, I found out this is not the reason (at least not as I understand it). The method returns the address of the (first) cell, which you can use like this: <code>searchRange.Cells(searchResult)</code> - which is essentially an array (analog to the syntax of an array: array1D(i), array2D(i,j)). This essentially makes it impossible to return a result for a two-dimensional range/array, making it impossible to use a two-dimensional range/array. Keeping this explanation in mind the reference from Microsoft makes much more sense."}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568881592, "post_id": 57990338, "comment_id": 102418186, "body": "PS. I will delete the question if it stays on a negative score, but feel free to make a suggestion how I could improve it (or you can upvote it as well, if you like)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568883382, "post_id": 57990338, "comment_id": 102419136, "body": "Hi @Albin, you&#39;re not wrong, but not quite correct either. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match\" rel=\"nofollow noreferrer\">As per the documentation</a> the <code>Match</code> function returns a double, <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/double-data-type\" rel=\"nofollow noreferrer\">which can only be a number, not address</a> but since you call it within your <code>searchrange</code> it will pick the number within that range and returns the right result. You are correct that it couldn&#39;t return an address in a two dimensional array, as a double data type can only be one single number."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568883542, "post_id": 57990338, "comment_id": 102419217, "body": "Also your question was probably downvoted as you asked for an explanation, not a solution to a problem. Those types of questions are tricky on stackoverflow as people would encourage you to do your own research instead of using stackoverflow as a teacher. But since the documentation is vague at best, this is still a valid question. I would leave the question here for anyone who would stumble across the same issue in the future looking for a clear explanation. I did give you an upvote though ;)"}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568883863, "post_id": 57990338, "comment_id": 102419402, "body": "thanks, but isn&#39;t an address essentially a number (at least in case of an array)?!"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568884333, "post_id": 57990338, "comment_id": 102419656, "body": "In the case of a one dimensional array, yes. But an address in excel would by definition have two bits of data, the column <code>A</code> and the row <code>1</code>. as so: <code>A1</code>. The <code>double</code> data type can only return one of these values, and therefore only works for searching in one direction. Simplified: If I told you to look at cell 32 in excel, you could look at row 32, or column AF (the 32nd column), either would be valid, but the cells are miles apart, so more complete info is needed."}, {"owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "edited": false, "score": 0, "creation_date": 1568885103, "post_id": 57990338, "comment_id": 102420054, "body": "That&#39;s what I mean, (according to the reference) match() doesn&#39;t actually search through a range, but goes through an array and returns an 8bit result, which <i>is</i> the address of a (one dimensional) array and not just &quot;a number&quot;?! Sort of an implicit definition of the searchRange/Array by the result. (A range, by definition, seems to be a one dimensional or a two dimensional array)?! I don&#39;t think it actually searches through one direction, I think it causes the error because of a type mismatch (1D and 2D array) (otherwise it would could find it in certain cases, which it doesn&#39;t)."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 3, "last_activity_date": 1568802125, "last_edit_date": 1568802125, "creation_date": 1568801564, "answer_id": 57990338, "question_id": 57988556, "link": "https://stackoverflow.com/questions/57988556/vba-excel-why-does-the-match-method-not-work-for-all-types-of-ranges/57990338#57990338", "title": "VBA/Excel: why does the match() method not work for all &quot;types&quot; of ranges", "body": "<p>The way <code>MATCH</code> is designed is to return the number of the match in one specified direction. By default, it counts the array in one direction, and returns which count the match occurs.\nIf there were more dimensions to the array, it couldn't return a single number as a match, since it would need to specify which row and column in the array the match was found, rather than just which cell matched.\nExample data:</p>\n\n<pre><code>a   b   c   d   e\nf   g   h   i   j\n</code></pre>\n\n<p>If you want to find value i, it would return 4 when searching the row, or 2 when searching the column. When searching the range, it would need to return both 4 and 2 simultaneously, which is not what it is designed to do.</p>\n\n<p>In this case, it would be better to use the <code>Find</code> formula for this, as this would return a range object (direct reference to a cell) from which either the cell content or its address can be derived.</p>\n\n<p><em>Edit:</em> One could argue that it could return either 8 or 9, if it continued counting your range either per column or row. However this would complicate the formula exponentially and make much more room for unexpected results. I would assume the design team decided to make it as easy to use as possible so most base excel users can use the formula without any advanced logic knowledge.</p>\n"}], "owner": {"reputation": 587, "user_id": 2089396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QENPW.png?s=128&g=1", "display_name": "Albin", "link": "https://stackoverflow.com/users/2089396/albin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57990338, "answer_count": 2, "score": -1, "last_activity_date": 1568883793, "creation_date": 1568796134, "last_edit_date": 1568883793, "question_id": 57988556, "link": "https://stackoverflow.com/questions/57988556/vba-excel-why-does-the-match-method-not-work-for-all-types-of-ranges", "title": "VBA/Excel: why does the match() method not work for all &quot;types&quot; of ranges", "body": "<p>Playing around with the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match\" rel=\"nofollow noreferrer\">match()</a> method I found out that match() only works for search ranges referencing single rows and columns (e.g. <code>B1:B5</code> or <code>A2:F2</code>) (one dimensional ranges) not for a range like (<code>A1:E5</code>) (two dimensional range). </p>\n\n<p>Why is that? As far as I understand both \"types\" of ranges are essentially arrays/array-references (which is the only thing required by <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match\" rel=\"nofollow noreferrer\">Microsoft's reference</a>). Is it my understanding or does the match() method work funky? </p>\n\n<p>I tried to research this issue myself, but there is nothing pointing to that issue in the reference (as SJR points out correctly).</p>\n\n<p>Here's the code where I get an error as a result. Using e.g. <code>B1:B5</code> works fine. The value I'm looking for is in cell <code>B2</code>.</p>\n\n<pre><code>'Set Search Range\n    Dim rngSearchRange As Range\n    Set rngSearchRange = ThisWorkbook.Worksheets(1).Range(\"A1:E5\")\n\n'Set Search Term  \n    Dim searchTerm As String\n    searchTerm = \"test\"\n\n'Set Compare Type\n    Dim compareType As Integer\n    compareType = 0\n\n'Execute Search\n    Dim found As Variant\n    found = Application.Match(searchTerm, rngSearchRange, compareType)\n</code></pre>\n\n<p>Note: This is a followup question on <a href=\"https://stackoverflow.com/questions/57960956/\">this question</a>. Using find() is not an option at least not in a general case since find() depends on the presentation of the value.</p>\n"}, {"tags": ["r", "vba", "shell"], "comments": [{"owner": {"reputation": 1163, "user_id": 2567027, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/96c4bf5a6c56e1a4b81c45af355b1e2e?s=128&d=identicon&r=PG", "display_name": "hjw", "link": "https://stackoverflow.com/users/2567027/hjw"}, "edited": false, "score": 0, "creation_date": 1568797188, "post_id": 57988380, "comment_id": 102385307, "body": "modify your path variable to path = path &amp; &quot; &amp; pause&quot;.  this will keep the cmd prompt open and you will be able to see any error msges from your r code"}, {"owner": {"reputation": 6216, "user_id": 10782538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd4ea4a840201c7d7ea5a86c46e558c?s=128&d=identicon&r=PG", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10782538/oliver"}, "edited": false, "score": 0, "creation_date": 1568797579, "post_id": 57988380, "comment_id": 102385545, "body": "Also make sure to double quote the path to your R file, as it has multiple spaces."}, {"owner": {"reputation": 61017, "user_id": 269476, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/eEnA3.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/269476/james"}, "edited": false, "score": 0, "creation_date": 1568798615, "post_id": 57988380, "comment_id": 102386187, "body": "Why not just use a batch file?"}], "answers": [{"tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 0, "last_activity_date": 1568801212, "creation_date": 1568801212, "answer_id": 57990213, "question_id": 57988380, "link": "https://stackoverflow.com/questions/57988380/vba-as-front-end-of-r/57990213#57990213", "title": "VBA as front end of R", "body": "<p>The main problem is that you didn't put any double quotes <code>\"\"</code> on your argument that contains several spaces.</p>\n\n<p>I tested this code on my Excel and it works (with different paths of course):</p>\n\n<pre><code>Sub R_Click()\n   'runs an external R code through Shell\n   Dim shell As Object\n   Set shell = VBA.CreateObject(\"WScript.Shell\")\n   Dim waitTillComplete As Boolean: waitTillComplete = True\n   Dim style As Integer: style = 1\n   Dim errorCode As Integer\n   Dim rCommand As String\n   rCommand = \"\"\"C:\\Users\\syed-salman\\Documents\\R\\R-3.6.1\\bin\\x64\\RScript.exe\"\" \"\"C:\\02. Custom Request\\1. Hospitality Survey -2019\\Project\\R Codes\\Custom Project - MERCER\\Final_Hotel Survey.R\"\" &amp;&amp; pause\"\n   errorCode = shell.Run(rCommand, style, waitTillComplete)\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong>: I added <code>&amp;&amp; pause</code> at the end of the command to show the result, but you can delete it and it will work.</p>\n</blockquote>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 31, "user_id": 10203732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xV4cv8DpkaU/AAAAAAAAAAI/AAAAAAAACN8/yNZuCYBqNhU/photo.jpg?sz=128", "display_name": "SYED SALMAN", "link": "https://stackoverflow.com/users/10203732/syed-salman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568801277, "creation_date": 1568795549, "last_edit_date": 1568801277, "question_id": 57988380, "link": "https://stackoverflow.com/questions/57988380/vba-as-front-end-of-r", "title": "VBA as front end of R", "body": "<p>I am want to automate my report which I crated regularly. I want to use R as backend tool. I am trying to run above below VBA code to run my R script but I am not getting any final output file written. Can anybody help or suggest where I am making mistake. I have limited knowledge of VBA codes</p>\n\n<pre><code>Sub R_Click()\n   'runs an external R code through Shell\n   Dim shell As Object\n   Set shell = VBA.CreateObject(\"WScript.Shell\")\n   Dim waitTillComplete As Boolean: waitTillComplete = True\n   Dim style As Integer: style = 1\n   Dim errorCode As Integer\n   Dim path As String\n   path = \"\"\"C:\\Users\\syed-salman\\Documents\\R\\R-3.6.1\\bin\\x64\\RScript\"\"\" &amp; \" \" &amp; \"C:\\02. Custom Request\\1. Hospitality Survey -2019\\Project\\R Codes\\Custom Project - MERCER\\Final_Hotel Survey.R\"\n   errorCode = shell.Run(path, style, waitTillComplete)\nEnd Sub\n</code></pre>\n\n<p>I want to use R for backend calculation and generate for me without opening the R</p>\n\n<pre><code>rm(list=ls())\n\nlist.of.packages &lt;- c(\"dplyr\",\"readxl\", \"stringr\")\nnew.packages &lt;- list.of.packages[!(list.of.packages %in% installed.packages()[,\"Package\"])]\nif(length(new.packages)&gt;0 ) install.packages(new.packages)\n\nlibrary(readxl)\n# library(rJava)\n# library(xlsx)   # Download Java https://www.java.com/en/download/manual.jsp\nlibrary(dplyr)\nlibrary(stringr)\n\nWorkingDir &lt;- getwd()\nFolder &lt;- read_xlsx(\"settings.xlsx\", sheet = \"Folder_Name\")\nFOLDER &lt;- paste(Folder$ACTIVITY[1], \"_\", Folder$Year[1], sep = \"\")\ndir.create(as.character(paste(FOLDER,\"\", sep=\"\")))\nyear &lt;- paste(Folder$Year[1], sep = \"\")\n\n\nmod &lt;- read_xlsx(\"ID_Mod_FLAG.xlsx\") # updated the file name the bracket\n\nmod_flag &lt;- mod\n\n#Rename the columns\n#colnames(mod_flag)[colnames(mod_flag)=='PNAME_POS_TYPE'] &lt;- \"Type_Position\"\n#colnames(mod_flag)[colnames(mod_flag)=='PROPERTY_PROP_CITY'] &lt;- \"City\"\n#colnames(mod_flag)[colnames(mod_flag)=='OBJECTID'] &lt;- \"OBJECTID\"\n\nmod_flag &lt;- mod_flag %&gt;% \n    mutate(All = 'H',\n           KP = ifelse(PNAME_POS_TYPE == 'Key Position', \"KP\", \"\"),\n           AP = 'AP',\n           # FLAG_AP = ifelse(PNAME_POS_TYPE == 'Target Position', \"AP\", \"\"),\n           City_Code = substr(PROPERTY_PROP_CITY, 1, 1))\n\n\n\nmod_flag &lt;-  mod_flag %&gt;% mutate(\n    FLAG01 = ifelse(PNAME_POS_TYPE == 'Key Position', paste(All,KP, \";\", sep = \"\"), \"\"), #mod_all_key_flag\n    FLAG02 = paste(All, AP, \";\", sep = \"\"), #mod_all_tar_flag\n    FLAG03 = ifelse(PNAME_POS_TYPE == 'Key Position', paste(City_Code, KP, \";\", sep = \"\"), \"\"), #mod_kp_city\n    FLAG04 = paste(City_Code, AP, \";\", sep = \"\"), #mod_ap_city\n)\n\nix &lt;- grep(\"*FLAG\", names(mod_flag))\nPaste &lt;- function(x) paste(na.omit(x), collapse = \"\")\n# Final_file &lt;- data.frame(OBJECTID = mod_flag$OBJEC, MOD_FLAG = apply(mod_flag[ix], 1, Paste))\n\n\nFinal_file &lt;- mod_flag %&gt;% \n    mutate(MOD_FLAG = apply(mod_flag[ix], 1, Paste))\n\ndrop &lt;- c(\"All\", \"KP\", \"AP\", \"City_Code\", \"FLAG01\", \"FLAG02\", \"FLAG03\", \"FLAG04\")\n\nFinal_file &lt;- Final_file[, -which(names(mod_flag) %in% drop)]\n\nd &lt;-format(Sys.time(), \"_%a %d-%m-%Y %I%M%S\")\nfilename &lt;- paste(d, \".csv\", sep = \"\")\n\nsetwd(file.path(WorkingDir, as.character(paste(FOLDER,\"\", sep=\"\"))))\n\n\nlapply(split(Final_file, Final_file$PROPERTY_PROP_CTRY),\n       function(x)write.csv(x, file = paste(x$PROPERTY_PROP_CTRY[1], filename ), row.names = FALSE))\n\n\nwrite.csv(Final_file, \"Final_METADATA.csv\", row.names = FALSE)\n\nsetwd(WorkingDir)\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1568795594, "post_id": 57988338, "comment_id": 102384411, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6973287/adding-items-in-a-listbox-with-multiple-columns\">Adding items in a Listbox with multiple columns</a>"}, {"owner": {"reputation": 89, "user_id": 10749681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d42b9a076b87a5fb6c301536a952dc?s=128&d=identicon&r=PG&f=1", "display_name": "timetravelprimer", "link": "https://stackoverflow.com/users/10749681/timetravelprimer"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1568795908, "post_id": 57988338, "comment_id": 102384570, "body": "I don&#39;t think so. I don&#39;t want to add items to listbox. I simply want to change display value."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568795958, "post_id": 57988338, "comment_id": 102384608, "body": "It doesnt work like that. you need 2 columns, and then you set the width of one column to zero to hide it. See the <code>ColumnWidths</code> property? try setting it to `0px; 100px&quot;"}], "owner": {"reputation": 89, "user_id": 10749681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d42b9a076b87a5fb6c301536a952dc?s=128&d=identicon&r=PG&f=1", "display_name": "timetravelprimer", "link": "https://stackoverflow.com/users/10749681/timetravelprimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568795642, "creation_date": 1568795436, "last_edit_date": 1568795642, "question_id": 57988338, "link": "https://stackoverflow.com/questions/57988338/how-to-change-display-value-in-listbox-rowsource", "title": "How to change display value in ListBox? RowSource", "body": "<p>As a source of data for my ListBox, I have specifed named range (RowSource - Dimension). However, instead of actual values in a ListBox, I want to have custom display values.</p>\n\n<p><img src=\"https://i.imgur.com/f7JBh1g.png\" alt=\"example\"></p>\n\n<p>I trying to change Value in Appearance tab but I get an error \"Could not set the Value property. Invalid property value\"</p>\n\n<p>How can I make \"60\" be displayed as \"High\"?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 3, "creation_date": 1568795313, "post_id": 57988270, "comment_id": 102384248, "body": "<code>LastRow </code> and <code>emptyRow </code> need to be declared as <code>Long</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1568795313, "post_id": 57988270, "comment_id": 102384249, "body": "Do your variables ever get larger than 32,767? if so, use <code>Long</code> instead of <code>Integer</code>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1568795464, "post_id": 57988270, "comment_id": 102384330, "body": "Welcome to SO. Best way to get the last row used in a column is: <code>LastRow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1568795840, "post_id": 57988270, "comment_id": 102384539, "body": "What does &quot;crashing&quot; mean? Does it show an error message (then include the message in your question) or does it just force close Excel (then it is not an issue in your code but an error/bug in Excel itself) \u2022 Update your Excel to the most recent version."}, {"owner": {"reputation": 1, "user_id": 12061390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7R-Ve--LJHk6Xhk3MqO49xTjuZCfh5lP_Eocf=k-s128", "display_name": "Taylor Jansen", "link": "https://stackoverflow.com/users/12061390/taylor-jansen"}, "edited": false, "score": 0, "creation_date": 1568868170, "post_id": 57988270, "comment_id": 102412616, "body": "Crashing means that the excel application stops responding and reboots"}, {"owner": {"reputation": 1, "user_id": 12061390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7R-Ve--LJHk6Xhk3MqO49xTjuZCfh5lP_Eocf=k-s128", "display_name": "Taylor Jansen", "link": "https://stackoverflow.com/users/12061390/taylor-jansen"}, "edited": false, "score": 0, "creation_date": 1568881059, "post_id": 57988270, "comment_id": 102417919, "body": "It is still crashing after amend to <code>LastRow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code>"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568882118, "post_id": 57988270, "comment_id": 102418439, "body": "Regarding the &quot;loop between this 2 subs&quot;: I can&#39;t see how these subs call each other. In theory, an indirect method is possible (through event handlers), if so, please indicate it."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568882280, "post_id": 57988270, "comment_id": 102418523, "body": "If Excel crashes, please Compile the project before running any part of it. In VB Editor go to the Debug menu, and choose Compile. See if there is any compilation error anywhere in your code. If so, fix it. After that see if it still crashes."}, {"owner": {"reputation": 1, "user_id": 12061390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7R-Ve--LJHk6Xhk3MqO49xTjuZCfh5lP_Eocf=k-s128", "display_name": "Taylor Jansen", "link": "https://stackoverflow.com/users/12061390/taylor-jansen"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568883607, "post_id": 57988270, "comment_id": 102419253, "body": "@z32a7ul As in the first Sub one line <code>Me.CB_No=LastRow</code>, will it trigger the Sub CB_NO_Change()? And no error found in debug too."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568884522, "post_id": 57988270, "comment_id": 102419760, "body": "@TaylorJansen It can trigger if CB_No is a CommandButton and CB_NO_Change its event handler. But I see no link in the other direction."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568884548, "post_id": 57988270, "comment_id": 102419773, "body": "What version of Excel do you use? Is it updated?"}, {"owner": {"reputation": 1, "user_id": 12061390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7R-Ve--LJHk6Xhk3MqO49xTjuZCfh5lP_Eocf=k-s128", "display_name": "Taylor Jansen", "link": "https://stackoverflow.com/users/12061390/taylor-jansen"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568886941, "post_id": 57988270, "comment_id": 102421072, "body": "@z32a7ul It is Office 365 version 1908"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568890618, "post_id": 57988270, "comment_id": 102423091, "body": "I think the next step should be to replace unqualified references. <code>Range(&quot;$A:$A&quot;)</code> refers to the ActiveSheet. Try to replace them with something like <code>Me.Range(&quot;$A:$A&quot;)</code> or <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Range(&quot;$A:$A&quot;)</code>. The same applies to <code>Cells</code>."}, {"owner": {"reputation": 1, "user_id": 12061390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7R-Ve--LJHk6Xhk3MqO49xTjuZCfh5lP_Eocf=k-s128", "display_name": "Taylor Jansen", "link": "https://stackoverflow.com/users/12061390/taylor-jansen"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1569310857, "post_id": 57988270, "comment_id": 102545545, "body": "@z32a7ul I did what you suggested. Not helping :(  Still the same &quot;Run Time Error -2147417848 (80010108)&quot;  Any idea?"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1569360774, "post_id": 57988270, "comment_id": 102570141, "body": "@TaylorJansen What do you mean by &quot;Still the same&quot;? Until this you wrote that the symptom is &quot;the excel application stops responding and reboots&quot;. Getting an error message is something different. Please describe on which line you get it. If it comes up as a dialog box, then click Debug, then in the Immediate Window write <code>? Err.Number, Err.Description, Err.Source, Err.LastDllError</code>, hit Enter, and tell us what you got."}], "answers": [{"comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568900447, "post_id": 57988719, "comment_id": 102428927, "body": "Declaring it as Integer cannot cause it crash."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568903027, "post_id": 57988719, "comment_id": 102430537, "body": "@z32a7ul Integer admits values between -32,768 to 32,767. If last used row is 40.000, you can&#39;t save that value into an Integer variable, causing Excel to crash, with an overflow error."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568925057, "post_id": 57988719, "comment_id": 102440643, "body": "No it, does not crash. Try to run the following: <code>Public Sub DoesItCrash(): Dim intTest As Integer: intTest = 32767: intTest = intTest + 1: End Sub</code> It will show a dialog box: Run-time error 6: Overflow. And you can click Debug or End. The OP wrote that Excel crashed (gave a detailed description of the symptom )which is very commendable): &quot;does not respond and automatically reboots&quot;). That&#39;s different."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1568970552, "post_id": 57988719, "comment_id": 102452854, "body": "@z32a7ul OP posted <i>Crashing means that the excel application stops responding and reboots</i> a day ago. My answer is 2 days ago. Original question was not so detailed at all. Anyways, I see your point in what you mean by crashing."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 2, "last_activity_date": 1568796607, "creation_date": 1568796607, "answer_id": 57988719, "question_id": 57988270, "link": "https://stackoverflow.com/questions/57988270/my-excel-keep-on-crashing-when-i-perform-the-code/57988719#57988719", "title": "My excel keep on crashing when I perform the code", "body": "<p>Looking at your code, it looks like you are trying to get the row number of the last row in column A, so you can get the row number of the first empty row adding +1 to <code>LastRow</code>.</p>\n\n<p>You are using <code>CountA</code>, a function that just counts non-empty cells in a range.</p>\n\n<blockquote>\n  <p><strong><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.counta\" rel=\"nofollow noreferrer\">WorksheetFunction.CountA method (Excel)</a></strong></p>\n</blockquote>\n\n<p>This will work <strong>only</strong> if all your data is continuous. But if your data is like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SwAzV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SwAzV.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can see this with an easy code applied to data in the image:</p>\n\n<pre><code>Sub test()\n\nDim LastRowWithCountA As Long\nDim LastRowNormal As Long\n\nLastRowWithCountA = Application.WorksheetFunction.CountA(Range(\"A:A\"))\nLastRowNormal = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nDebug.Print \"COUNTA: \" &amp; LastRowWithCountA &amp; \" VS \" &amp; \"NORMAL:\" &amp; LastRowNormal\n\nEnd Sub\n</code></pre>\n\n<p>It will return <code>COUNTA: 15 VS NORMAL:19</code>.</p>\n\n<p>So the best option to get the last non empty row in a column is <code>Range(\"A\" &amp; Rows.Count).End(xlUp).Row</code></p>\n\n<p>About your error, replace<code>Integers</code> with <code>Long</code>. Integers got a lower limit. I recommend you to read all data types admited.</p>\n\n<blockquote>\n  <p><strong><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/data-type-summary\" rel=\"nofollow noreferrer\">Data type summary</a></strong></p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 12061390, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC7R-Ve--LJHk6Xhk3MqO49xTjuZCfh5lP_Eocf=k-s128", "display_name": "Taylor Jansen", "link": "https://stackoverflow.com/users/12061390/taylor-jansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568881971, "creation_date": 1568795231, "last_edit_date": 1568881971, "question_id": 57988270, "link": "https://stackoverflow.com/questions/57988270/my-excel-keep-on-crashing-when-i-perform-the-code", "title": "My excel keep on crashing when I perform the code", "body": "<p>I have a Sub NewRecord() to create new record and a Sub CB_No_Change() to recall existing record by number to be displayed on the user form. For Sub NewRecord(), I write the code so that some default values are put into the excel sheet in the next empty row then this new record is recalled by Sub CB_No_Change() to be displayed on the user form and can be edited. The Sub CB_No_Change() is working fine on its own, but the Sub NewRecord() usually crashes when being run (the excel application does not respond and automatically reboots). I suspect there may be a loop between this 2 subs? Any ideas?</p>\n\n<pre><code>Private Sub NewRecord()\n\n    Dim LastRow As Integer\n\n    Dim emptyRow As Integer\n\n    LastRow = WorksheetFunction.CountA(Range(\"$A:$A\"))\n\n    emptyRow = LastRow + 1\n\n    Cells(emptyRow, 1) = \"xxx\"\n    Cells(emptyRow, 2) = \"xxx\"\n    Cells(emptyRow, 3) = \"xxx\"\n    Cells(emptyRow, 4) = \"xxx\"\n    Cells(emptyRow, 5) = \"xxx\"\n    Cells(emptyRow, 6) = \"xxx\"\n    Cells(emptyRow, 7) = \"xxx\"\n    Cells(emptyRow, 8) = \"xxx\"\n    Cells(emptyRow, 9) = \"xxx\"\n    Cells(emptyRow, 10) = \"xxx\"\n    Cells(emptyRow, 11) = \"xxx\"\n    Cells(emptyRow, 12) = \"xxx\"\n    Cells(emptyRow, 13) = \"xxx\"\n    Cells(emptyRow, 14) = \"xxx\"\n    Cells(emptyRow, 15) = \"xxx\"\n    Cells(emptyRow, 16) = \"xxx\"\n    Cells(emptyRow, 17) = \"xxx\"\n\n    Me.CB_No = LastRow\n    Me.TB_RecdDate.SetFocus\nEnd sub\n\nPrivate Sub CB_No_Change()\n\n    Dim FindNo As String\n    Dim r As Integer\n    Dim TrgtNo As Range\n\n    If Me.CB_No &lt;&gt; \"\" Then\n        FindNo = Me.CB_No.Value\n        Set TrgtNo = Worksheets(\"One\").Range(\"$A:$A\").Find(FindNo, SearchOrder:=xlRows, SearchDirection:=xlPrevious, Lookat:=xlWhole)\n        If Not TrgtNo Is Nothing Then\n            r = Worksheets(\"One\").Range(\"$A:$A\").Find(FindNo, SearchOrder:=xlRows, SearchDirection:=xlPrevious, Lookat:=xlWhole).Row\n\n            CB = Cells(r, 1)\n            TB = Cells(r, 2)\n            Me.TB = Format(Me.TB, \"yyyy-mm-dd\")\n            TB = Cells(r, 3)\n            Me.TB = Format(Me.TB, \"yyyy-mm-dd\")\n            TB = Cells(r, 4)\n            TB = Cells(r, 5)\n            TB = Cells(r, 6)\n            TB = Cells(r, 7)\n            CB = Cells(r, 8)\n            CB = Cells(r, 9)\n            CB = Cells(r, 10)\n            TB = Cells(r, 11)\n            TB = Cells(r, 12)\n            TB = Cells(r, 13)\n            CB = Cells(r, 14)\n            CB = Cells(r, 15)\n            CB = Cells(r, 16)\n            TB = Cells(r, 17)\n        Else\n            Exit Sub\n        End If\n    Else\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568795184, "post_id": 57988232, "comment_id": 102384186, "body": "Look up the <code>Split()</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12083838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCvfidiNdNUHy_LSyQEfaW-aE-YpKTOF2bvzQnnKg=k-s128", "display_name": "Andrei Moza", "link": "https://stackoverflow.com/users/12083838/andrei-moza"}, "edited": false, "score": 0, "creation_date": 1568809219, "post_id": 57988292, "comment_id": 102392138, "body": "How can I put each output in a variable?  i want to put the day in - Dim day as String"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 0, "last_activity_date": 1568809401, "last_edit_date": 1568809401, "creation_date": 1568795282, "answer_id": 57988292, "question_id": 57988232, "link": "https://stackoverflow.com/questions/57988232/excel-convert-data-to-string/57988292#57988292", "title": "Excel convert data to string", "body": "<p>You can do as below assuming that your date is in A1 : </p>\n\n<pre><code>Sub test()\n\n\n    Range(\"B1\").Value = Day(CDate(Range(\"A1\")))\n    Range(\"C1\").Value = Month(CDate(Range(\"A1\")))\n    Range(\"D1\").Value = Year(CDate(Range(\"A1\")))\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>BEFORE</strong>\n  :<br>\n<a href=\"https://i.stack.imgur.com/Z8exj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z8exj.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>OUTPUT AFTER :</strong><a href=\"https://i.stack.imgur.com/DEaoH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DEaoH.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>Sub test()\n\nDim DateDay As String\nDim DateMonth As string\nDim DateYear As String\n\nDateDay = Day(CDate(Range(\"A1\")))\nDateMonth = Month(CDate(Range(\"A1\")))\nDateYear = Year(CDate(Range(\"A1\")))\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1568795462, "creation_date": 1568795462, "answer_id": 57988350, "question_id": 57988232, "link": "https://stackoverflow.com/questions/57988232/excel-convert-data-to-string/57988350#57988350", "title": "Excel convert data to string", "body": "<p>An example in VBA that does this would be the following (Assumption: the original date is in cell A1):</p>\n\n<pre><code>ActiveSheet.Cells(1, 2).Value = Split(ActiveSheet.Cells(1, 1).Value, \"-\")(1)\nActiveSheet.Cells(1, 3).Value = Split(ActiveSheet.Cells(1, 1).Value, \"-\")(0)\n</code></pre>\n\n<p>What this does is it splits the initial date (\"July-2019\") into different strings spearated by the delimiter (in this case \"-\"). If you need to do this for an entire column of dates you will need to wrap this in a For- or While-Loop.</p>\n"}, {"tags": [], "owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1568795466, "creation_date": 1568795466, "answer_id": 57988351, "question_id": 57988232, "link": "https://stackoverflow.com/questions/57988232/excel-convert-data-to-string/57988351#57988351", "title": "Excel convert data to string", "body": "<p>Just use the Code below, the Variable will be an Array containing the 2 strings.</p>\n\n<pre><code>StringtoSplit = Worksheets(\"Sheet1\").Cells(1, 1).Value\n\nSeperatedValuesArray = Split(StringtoSplit, \"-\")\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12083838, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCvfidiNdNUHy_LSyQEfaW-aE-YpKTOF2bvzQnnKg=k-s128", "display_name": "Andrei Moza", "link": "https://stackoverflow.com/users/12083838/andrei-moza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57988292, "answer_count": 3, "score": -1, "last_activity_date": 1568809401, "creation_date": 1568795119, "question_id": 57988232, "link": "https://stackoverflow.com/questions/57988232/excel-convert-data-to-string", "title": "Excel convert data to string", "body": "<p>i'm learning how to create a Macro in EXCEL VBA, and I want to convert a data, for example <strong>July-2019</strong> which is located in a certain cell, into a two cells, first cell <strong>2019</strong>, second cell <strong>July</strong>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568793126, "post_id": 57987644, "comment_id": 102383154, "body": "Please note that you haven&#39;t actually asked a question. If your code doesn&#39;t work please describe any errors and where they occur."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 2, "creation_date": 1568794713, "post_id": 57987644, "comment_id": 102383949, "body": "You&#39;re missing some dots at line <code>if .Cells(11+y,</code> hence these <code>Cells(</code> refer to <code>Activesheet</code> instead of MUOR."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568796155, "post_id": 57987644, "comment_id": 102384734, "body": "Check how your code works... On the first loop (y=11, z=10) you are trying to match Cells(22,4) &amp; Cells(20,16) against arr(2,9). Cell 22,4 is blank..."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1568797792, "post_id": 57987644, "comment_id": 102385690, "body": "&#191;Can you post/upload a data sample somwhere? Replying your data takes too long and"}, {"owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568798807, "post_id": 57987644, "comment_id": 102386305, "body": "@DavidGarc&#237;aBodego thanks for pointing out. I have amended that part. However, the data is still duplicating. Can I set a condition that is if <code>Cells(z, 18)</code> has value in it, VBA just skip that z and loop to the next z?"}, {"owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1568798948, "post_id": 57987644, "comment_id": 102386405, "body": "@FoxfireAndBurnsAndBurns I have uploaded a link in my question above. Or you can click this <a href=\"https://drive.google.com/file/d/1K8dEOPTxfXSZ-DynJiwikoaHF53EgP8l/view?usp=sharing\" rel=\"nofollow noreferrer\">link</a> Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "edited": false, "score": 0, "creation_date": 1568857403, "post_id": 57997899, "comment_id": 102410760, "body": "Thanks mate! I run my file with your code, it is working but I noticed when there is more than one Batch No in a day, it did not read the second Batch No correctly.I have uploaded the screenshot <a href=\"https://drive.google.com/open?id=1CQsC0DoPYcgksuj6VAaDJMZwfbHzVSxz\" rel=\"nofollow noreferrer\">here</a>. The code did not capture the data highlighted.   Anyway, it was one big step forward to achieve my expected result, thanks again!"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "edited": false, "score": 0, "creation_date": 1568875351, "post_id": 57997899, "comment_id": 102415071, "body": "@GanCy, My logic for determining <code>n</code> was wrong. Have edited code, if you want to try again."}, {"owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "edited": false, "score": 0, "creation_date": 1568944492, "post_id": 57997899, "comment_id": 102444822, "body": "it&#39;s working now, thanks mate! (Probably need some time for me to understand the code though...)"}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 1, "last_activity_date": 1568875212, "last_edit_date": 1568875212, "creation_date": 1568827172, "answer_id": 57997899, "question_id": 57987644, "link": "https://stackoverflow.com/questions/57987644/how-to-use-vba-to-copy-data-from-one-sheet-to-another-if-it-fulfill-three-differ/57997899#57997899", "title": "How to use VBA to copy data from one sheet to another if it fulfill three different conditions?", "body": "<p>I think code below should give expected output, but not totally sure, since the workbook uploaded/shared seems to differ from the screenshots in the question.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub LinkData()\n\n    Dim arrayFromFPSheet() As Variant\n    arrayFromFPSheet = GetSourceArray()\n\n    Dim MUOR As Worksheet\n    Set MUOR = ThisWorkbook.Worksheets(\"MUOR\")\n\n    Dim rangesToLoopThrough As Range\n    Set rangesToLoopThrough = GetDestinationAreas(MUOR)\n\n    With MUOR\n        Dim area As Range\n        For Each area In rangesToLoopThrough.Areas\n            Debug.Assert area.Rows.CountLarge &gt; 1 And area.Rows.CountLarge &lt; 20\n\n            Dim areaFirstRowIndex As Long\n            areaFirstRowIndex = area.Rows(1).Row\n\n            Dim areaLastRowIndex As Long\n            areaLastRowIndex = area.Rows(area.Rows.Count).Row\n\n            Dim readRowIndex As Long\n            For readRowIndex = areaFirstRowIndex To areaLastRowIndex\n                If Not IsCellEmpty(.Cells(readRowIndex, \"D\")) Then\n\n                    Dim batchNumber As String\n                    batchNumber = CStr(.Cells(readRowIndex, \"D\"))\n\n                    Dim writeRowIndex As Long\n                    For writeRowIndex = areaFirstRowIndex To areaLastRowIndex\n                        If IsCellEmpty(.Cells(writeRowIndex, \"R\")) And IsCellEmpty(.Cells(writeRowIndex, \"S\")) And IsCellEmpty(.Cells(writeRowIndex, \"T\")) Then\n\n                            Dim Grade As String\n                            Grade = CStr(.Cells(writeRowIndex, \"P\"))\n\n                            Dim batchNumberAndGrade As String\n                            batchNumberAndGrade = batchNumber &amp; Grade\n\n                            Dim n As Variant\n                            n = Application.CountIfs(.Range(\"P\" &amp; areaFirstRowIndex, \"P\" &amp; writeRowIndex), Grade, .Range(\"R\" &amp; areaFirstRowIndex, \"R\" &amp; writeRowIndex), batchNumber) + 1\n                            Debug.Assert IsNumeric(n)\n\n                            Dim sourceRowIndex As Long\n                            sourceRowIndex = GetRowIndexOfNthMatch(n, arrayFromFPSheet, batchNumberAndGrade, 9)\n\n                            If sourceRowIndex &gt; 0 Then\n                                .Cells(writeRowIndex, \"R\") = arrayFromFPSheet(sourceRowIndex, 5)\n                                .Cells(writeRowIndex, \"S\") = arrayFromFPSheet(sourceRowIndex, 8)\n                                .Cells(writeRowIndex, \"T\") = arrayFromFPSheet(sourceRowIndex, 7)\n                            End If\n                        End If\n                    Next writeRowIndex\n                End If\n            Next readRowIndex\n        Next area\n    End With\nEnd Sub\n\nPrivate Function GetDestinationAreas(ByVal someSheet As Worksheet) As Range\n    ' Crudely clusters/groups destination sheet into areas (which\n    ' should be date-specific, although this function will not check/verify\n    ' output).\n    Const START_ROW_INDEX As Long = 10\n\n    Dim outputRange As Range\n    Set outputRange = someSheet.Range(\"C\" &amp; START_ROW_INDEX, \"C\" &amp; someSheet.Rows.Count)\n\n    On Error Resume Next\n    Set outputRange = outputRange.SpecialCells(xlCellTypeConstants) ' Will raise error if no constants found.\n    On Error GoTo 0\n    Debug.Assert Not (outputRange Is Nothing)\n\n    Set GetDestinationAreas = outputRange\nEnd Function\n\nPrivate Function GetSourceArray() As Variant\n    With ThisWorkbook.Worksheets(\"FP\")\n        Dim lastRow As Long\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        Dim outputArray() As Variant\n        outputArray = .Range(\"A1:I\" &amp; lastRow).Value\n    End With\n    GetSourceArray = outputArray\nEnd Function\n\nPrivate Function IsCellEmpty(ByVal someCell As Range) As Boolean\n    ' https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/isempty-function\n    ' \"IsEmpty only returns meaningful information for variants.\"\n    ' So using below function instead.\n    IsCellEmpty = Len(CStr(someCell.Value)) = 0\nEnd Function\n\nPrivate Function GetRowIndexOfNthMatch(ByVal n As Long, ByRef someArray() As Variant, ByVal someText As String, ByVal targetColumn As Long) As Long\n    ' Returns a 1-based row index of the nth occurrence of text value\n    ' in target column of array or 0 if unsuccessful.\n    Debug.Assert n &gt; 0\n\n    Dim rowIndex As Long\n    For rowIndex = LBound(someArray, 1) To UBound(someArray, 1)\n        If someArray(rowIndex, targetColumn) = someText Then\n            Dim matchCount As Long\n            matchCount = matchCount + 1\n\n            If matchCount = n Then\n                GetRowIndexOfNthMatch = rowIndex\n                Exit Function\n            End If\n        End If\n    Next rowIndex\nEnd Function\n</code></pre>\n\n<p>Thanks for all the information you provided in the question. It makes it easier to answer.</p>\n"}], "owner": {"reputation": 25, "user_id": 12036684, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDUUr_lCfHiCihPdgpdgSDeKhPKc1EbhWSsa0xjFw=k-s128", "display_name": "Gan Cy", "link": "https://stackoverflow.com/users/12036684/gan-cy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 57997899, "answer_count": 1, "score": 2, "last_activity_date": 1568875212, "creation_date": 1568793050, "last_edit_date": 1568798540, "question_id": 57987644, "link": "https://stackoverflow.com/questions/57987644/how-to-use-vba-to-copy-data-from-one-sheet-to-another-if-it-fulfill-three-differ", "title": "How to use VBA to copy data from one sheet to another if it fulfill three different conditions?", "body": "<p>I wanted to copy data that fulfil a few criteria from one sheet to another using VBA.</p>\n\n<p><strong>My goal:</strong>\nCopy Cell in column E, F and G in Sheet FP to column R, S and T in Sheet MUOR if it meets my conditions.</p>\n\n<p><strong>My conditions:</strong> </p>\n\n<p>(1) Cell in Column D &amp; Cell in Column P (in Sheet MUOR) must meet the condition in Column I of Sheet FP.</p>\n\n<p>(2) If Cell in Column D is empty, skip to next Cell in Column D.</p>\n\n<p>(3) Column R, S or T must be empty before pasting it. If not empty, move to the next cell that meets the condition. (Do not replace or duplicate the data)</p>\n\n<p><strong>Other information:</strong>  Max <em>Batch No (Column D)</em> per day is 3; </p>\n\n<p><strong>Issue Facing:</strong>\nMy current VBA code doesn't recognise my conditions. It totally ignored my Day 1 data, and it duplicated all the Day 2 data.</p>\n\n<p>Please refer to the attached images.</p>\n\n<p>Sheet MUOR\n<a href=\"https://i.stack.imgur.com/EwQK8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EwQK8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet FP\n<a href=\"https://i.stack.imgur.com/5CAM8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5CAM8.png\" alt=\"enter image description here\"></a></p>\n\n<p>My expected Result\n<a href=\"https://i.stack.imgur.com/crqSZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/crqSZ.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://drive.google.com/file/d/1K8dEOPTxfXSZ-DynJiwikoaHF53EgP8l/view?usp=sharing\" rel=\"nofollow noreferrer\"><strong>Sample Data here</strong></a></p>\n\n<p>My current code as below:</p>\n\n<pre><code>Sub LinkData()\n\nDim y As Long\nDim x As Long\nDim z As Long\nDim lr As Long\nDim arr As Variant\nDim FP As Worksheet\nDim MUOR As Worksheet\n\nSet FP = ThisWorkbook.Sheets(\"FP\")\nSet MUOR = ThisWorkbook.Sheets(\"MUOR\")\n\nWith FP\n   lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    arr = .Range(\"A1:I\" &amp; lr).Value\nEnd With\n\nWith MUOR\n    For y = 11 To 363\n    For z = y - 1 To y + 8\n    For x = LBound(arr) To UBound(arr)\n\n    If Cells(11 + y, 4) &lt;&gt; \"\" And Cells(11 + y, 4) &amp; Cells(10 + z, 16) = arr(x, 9) And IsEmpty(Cells(10 + z, 18)) Then\n            .Cells(10 + z, 18) = arr(x, 5)\n            .Cells(10 + z, 19) = arr(x, 8)\n            .Cells(10 + z, 20) = arr(x, 7)\n            Else\n            End If\n    Next x\n    Next z\n    Next y\n\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Any VBA expert please help me. </p>\n\n<p>Much appreciated!</p>\n"}, {"tags": ["excel", "vba", "loops", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12083603, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBZKRS-WNRueGIEV9nBcnx6XzyOKB_KnyEABG6slw=k-s128", "display_name": "Skepie", "link": "https://stackoverflow.com/users/12083603/skepie"}, "edited": false, "score": 1, "creation_date": 1568802927, "post_id": 57987506, "comment_id": 102388661, "body": "Thank you very much for this answer! Exactly what I was looking for. I did not think that after row 4, it would fill according the matching row."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1568792509, "creation_date": 1568792509, "answer_id": 57987506, "question_id": 57987441, "link": "https://stackoverflow.com/questions/57987441/how-to-fill-a-column-of-formulas-with-variables-rows-in-vba/57987506#57987506", "title": "How to fill a column of formulas with variables rows in VBA", "body": "<ul>\n<li><p>Remove the colon after \"H\" (H3 instead of H:3 is correct syntax)</p></li>\n<li><p>In VBA, formulae use comma not semi-colon, whatever your local\nsettings (or use <code>FormulaLocal</code>)</p></li>\n<li>You can avoid the loop</li>\n</ul>\n\n<hr>\n\n<pre><code>Sheets(1).Range(\"H3:H\" &amp; lastrow).Formula = \"=SUM(C3,E3,G3)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12083603, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBZKRS-WNRueGIEV9nBcnx6XzyOKB_KnyEABG6slw=k-s128", "display_name": "Skepie", "link": "https://stackoverflow.com/users/12083603/skepie"}, "edited": false, "score": 0, "creation_date": 1568803023, "post_id": 57987761, "comment_id": 102388701, "body": "Thanks for the answer. If I&#39;m understanding correctly, .filldown would be the equivalent of the double-click on the bottom right square in the cell?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 3, "user_id": 12083603, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBZKRS-WNRueGIEV9nBcnx6XzyOKB_KnyEABG6slw=k-s128", "display_name": "Skepie", "link": "https://stackoverflow.com/users/12083603/skepie"}, "edited": false, "score": 0, "creation_date": 1568803147, "post_id": 57987761, "comment_id": 102388768, "body": "@Skepie Sure it does and i guess it is the proper way to do what you need"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1568794202, "last_edit_date": 1568794202, "creation_date": 1568793473, "answer_id": 57987761, "question_id": 57987441, "link": "https://stackoverflow.com/questions/57987441/how-to-fill-a-column-of-formulas-with-variables-rows-in-vba/57987761#57987761", "title": "How to fill a column of formulas with variables rows in VBA", "body": "<p>You might use <code>.FillDown</code> which will do what you need and avoid <code>loop</code> which can take more time and use more CPU   </p>\n\n<pre><code>Range(\"H3\").Value=\"=SUM(C3,E3,G3)\"\nRange(\"H3:H\" &amp; lastrow).FillDown\n</code></pre>\n\n<p>Output <strong>Before</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/UXVqd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UXVqd.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>AFTER</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/JDhIa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JDhIa.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 12083603, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBZKRS-WNRueGIEV9nBcnx6XzyOKB_KnyEABG6slw=k-s128", "display_name": "Skepie", "link": "https://stackoverflow.com/users/12083603/skepie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 57987506, "answer_count": 2, "score": 0, "last_activity_date": 1568794202, "creation_date": 1568792260, "last_edit_date": 1568792526, "question_id": 57987441, "link": "https://stackoverflow.com/questions/57987441/how-to-fill-a-column-of-formulas-with-variables-rows-in-vba", "title": "How to fill a column of formulas with variables rows in VBA", "body": "<p>I'm looking to fill a specific column with a formula with variable rows, using a for loop. I'm always getting a range global failure problem. If anyone could help me out, that'd be great, thanks!</p>\n\n<pre><code>For i = 3 To lastrow\n    With Sheets(1)\n        .Range(\"H:\" &amp; i).Formula = \"=SUM(C\" &amp; i &amp; \";E\" &amp; i &amp; \";G\" &amp; i &amp;\")\"\n    End With\nNext i\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer", "automation", "modal-dialog"], "answers": [{"tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 0, "last_activity_date": 1568807541, "creation_date": 1568807541, "answer_id": 57992147, "question_id": 57987238, "link": "https://stackoverflow.com/questions/57987238/how-to-intercept-and-manipulate-a-internet-explorer-showmodaldialog-with-vba/57992147#57992147", "title": "How to intercept and manipulate a Internet Explorer showModalDialog with VBA", "body": "<p>As far as I know, we can't handle the popup modal (find the HTML elements and fill data) using VBA script. As an alternative workaround, I suggest you could try to use <a href=\"https://www.seleniumhq.org/download/\" rel=\"nofollow noreferrer\">Selenium IE WebDriver</a>, by using it, we could not only find the web page elements and fill data, but also using the Switch To method to switch to the popup window, then using the FindElementById method to find the HTML elements and fill data.</p>\n\n<p>Here are some related tutorials about how to use selenium webdriver, you could check it:</p>\n\n<p><a href=\"https://testguild.com/selenium-ie-visual-studio-c/\" rel=\"nofollow noreferrer\">Selenium 2.0 WebDriver with Visual Studio, C#, &amp; IE \u2013 Getting Started</a></p>\n\n<p><a href=\"https://csharp.hotexamples.com/examples/OpenQA.Selenium.IE/InternetExplorerDriver/-/php-internetexplorerdriver-class-examples.html\" rel=\"nofollow noreferrer\">C# (CSharp) OpenQA.Selenium.IE InternetExplorerDriver Examples</a></p>\n\n<p><a href=\"https://www.toolsqa.com/selenium-webdriver/c-sharp/how-to-handle-multiple-browsers-in-selenium-csharp/\" rel=\"nofollow noreferrer\">How to Handle Multiple Browsers in Selenium CSharp</a></p>\n"}], "owner": {"reputation": 35, "user_id": 7462273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8720eb94fc7171c2ce7d67caa58cd9c5?s=128&d=identicon&r=PG&f=1", "display_name": "kabarto", "link": "https://stackoverflow.com/users/7462273/kabarto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568807541, "creation_date": 1568791545, "last_edit_date": 1568792231, "question_id": 57987238, "link": "https://stackoverflow.com/questions/57987238/how-to-intercept-and-manipulate-a-internet-explorer-showmodaldialog-with-vba", "title": "How to intercept and manipulate a Internet Explorer showModalDialog with VBA", "body": "<p>VBA is able to fill the data fields on the main page. By clicking (with VBA) on a button <em>Modify</em> the dialog is opened in a new window and it halts the execution of the VBA. Fields in the dialog page required to be adjusted (with VBA). The VBA resumes only after I manually close the dialog. </p>\n\n<p><a href=\"https://i.stack.imgur.com/EPC4w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EPC4w.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 2, "creation_date": 1568791762, "post_id": 57987225, "comment_id": 102382421, "body": "Your question is not quite clear. Can you provide some more information on what your data looks like and what you&#39;re trying to achieve?"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1568792197, "post_id": 57987225, "comment_id": 102382654, "body": "sorry for not clear, i have two sheets one is invoice and second is sheet4, in invoice sheet where serial no 0000 (c9). I want when ever i click next button my serial no should change from 0000 to 0721 and then again i click next button then it should change to 0730 and go on like that hope i clear now something"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1568792474, "post_id": 57987225, "comment_id": 102382809, "body": "and other sheet name is sheet4 and its range start from b3 to b535"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1568793381, "post_id": 57987225, "comment_id": 102383271, "body": "What have you tried so far and where are you stuck?"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568793842, "post_id": 57987225, "comment_id": 102383495, "body": "I tried so many time and different code but i am to much confuse and i don&#39;t know what to do so i just recorded macro"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 2, "creation_date": 1568793906, "post_id": 57987225, "comment_id": 102383528, "body": "Don&#180;t add code in a comment. Just edit you question and include whatever you try."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568796921, "post_id": 57987865, "comment_id": 102385166, "body": "thanks alot for the help i tried this code but nothing changed and i don&#39;t need match"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568800137, "post_id": 57987865, "comment_id": 102387096, "body": "Nothing changes?  Please, could you exactly explain what is not working? I duplicate your samples and it work on my computer..."}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568801053, "post_id": 57987865, "comment_id": 102387620, "body": "i mean it didn&#39;t change anything in any cell"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568802117, "post_id": 57987865, "comment_id": 102388185, "body": "Already fixed... I placed cell I3 instead of C9... (3,9) &lt;&gt; (9,3)...je je je"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568802324, "post_id": 57987865, "comment_id": 102388309, "body": "cool thanks for the help i already got what i need and later i will try your"}], "tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1568802066, "last_edit_date": 1568802066, "creation_date": 1568793836, "answer_id": 57987865, "question_id": 57987225, "link": "https://stackoverflow.com/questions/57987225/i-need-vba-code-for-showing-next-entry-in-other-sheet-cell/57987865#57987865", "title": "I need vba code for showing next entry in other sheet cell", "body": "<p>Try this code for your button.</p>\n\n<pre><code>Dim Serial, i as Long\n\nSerial = Worksheets(\"invoice\").Cells(9, 3).Value\n\nFor i= 3 to Worksheets(\"sheet4\").UsedRange.SpecialCells(xlCellTypeLastCell).Row\n    If Worksheets(\"sheet4\").Cells(i, 2).Value = Serial Then\n        Serial= i\n        i= Worksheets(\"sheet4\").UsedRange.SpecialCells(xlCellTypeLastCell).Row\n    End If\nNext\n\nIf Serial= Worksheets(\"invoice\").Cells(9, 3).Value Then\n    MsgBox \"There is no more serial numbers\"\nElse\n    Worksheets(\"invoice\").Cells(9, 3).Value = Worksheets(\"sheet4\").Cells(Serial + 1, 2).Value\nEnd If\n</code></pre>\n\n<p>If there is no match, it will show you a MsgBox saying <code>\"There is no more serial numbers\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568797210, "post_id": 57988016, "comment_id": 102385319, "body": "yes you are right i want this exact . i tried your code and i got error expected end sub"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568797781, "post_id": 57988016, "comment_id": 102385683, "body": "i write end sub again for end if but now its not working i mean no error and nothing changed"}, {"owner": {"reputation": 89, "user_id": 12074269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCWDe7GtB539PwklIwdstIZCrU46F1_fsEzQZ-_w=k-s128", "display_name": "Angad Gupta", "link": "https://stackoverflow.com/users/12074269/angad-gupta"}, "reply_to_user": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568798104, "post_id": 57988016, "comment_id": 102385865, "body": "@Shaharyaroffice its working for me.. please try to copy from Dim to end sub"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568798783, "post_id": 57988016, "comment_id": 102386289, "body": "thanks alot for this help , its working now but i have one more issue like its just showing next entry it doesn&#39;t matter from where i started serial if i want to again show from start  its not showing me 0721 to 0730 its just adding +1 and right now its showing 0751 serial"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568798907, "post_id": 57988016, "comment_id": 102386379, "body": "can you write code for previous button same as previous row - 1"}, {"owner": {"reputation": 89, "user_id": 12074269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCWDe7GtB539PwklIwdstIZCrU46F1_fsEzQZ-_w=k-s128", "display_name": "Angad Gupta", "link": "https://stackoverflow.com/users/12074269/angad-gupta"}, "reply_to_user": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568799753, "post_id": 57988016, "comment_id": 102386890, "body": "@Shaharyaroffice for previous just reverse the code"}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568801013, "post_id": 57988016, "comment_id": 102387599, "body": "i tried but its not working i don&#39;t know exactly what to do so please if you can it will be great help me thanks in advance"}, {"owner": {"reputation": 89, "user_id": 12074269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCWDe7GtB539PwklIwdstIZCrU46F1_fsEzQZ-_w=k-s128", "display_name": "Angad Gupta", "link": "https://stackoverflow.com/users/12074269/angad-gupta"}, "reply_to_user": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568801915, "post_id": 57988016, "comment_id": 102388085, "body": "@Shaharyaroffice code provided please check"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568802422, "post_id": 57988016, "comment_id": 102388360, "body": "Angad, your code is ok, but it is not checking which value you have on C9 cell, it is just beginning from the first one and Shaharyar office needs to go to the next whatever serial is there."}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568802891, "post_id": 57988016, "comment_id": 102388636, "body": "David exactly sir that&#39;s what i need"}], "tags": [], "owner": {"reputation": 89, "user_id": 12074269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCWDe7GtB539PwklIwdstIZCrU46F1_fsEzQZ-_w=k-s128", "display_name": "Angad Gupta", "link": "https://stackoverflow.com/users/12074269/angad-gupta"}, "is_accepted": true, "score": 0, "last_activity_date": 1568794302, "creation_date": 1568794302, "answer_id": 57988016, "question_id": 57987225, "link": "https://stackoverflow.com/questions/57987225/i-need-vba-code-for-showing-next-entry-in-other-sheet-cell/57988016#57988016", "title": "I need vba code for showing next entry in other sheet cell", "body": "<p>With this above conversation in understood that you need some excel VBA code for the NEXT button by pressing you would like to show the next entry of Sheet4(b3:b535) at the sheet invoice c9 cell</p>\n\n<pre><code>Dim previousRow As Long\nSub nextrow()\n\n    If previousRow = 0 Then\n        previousRow = 1 '&lt;--starts at row 1\n    Else\n        previousRow = previousRow + 1 '&lt;--increases of 1 each click\n    End If\n    Sheets(\"invoice\").Cells(9, 3) = Sheets(\"Sheet4\").Cells(previousRow, 2)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1568802518, "post_id": 57990440, "comment_id": 102388416, "body": "Angad, your code is ok, but it is not checking which value you have on C9 cell, it is just beginning from the first one and Shaharyar office needs to go to the next whatever serial is there."}, {"owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "edited": false, "score": 0, "creation_date": 1568802528, "post_id": 57990440, "comment_id": 102388423, "body": "it can&#39;t be previous from current invoice no which is in c9? its started previous from b535"}], "tags": [], "owner": {"reputation": 89, "user_id": 12074269, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDCWDe7GtB539PwklIwdstIZCrU46F1_fsEzQZ-_w=k-s128", "display_name": "Angad Gupta", "link": "https://stackoverflow.com/users/12074269/angad-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1568801882, "creation_date": 1568801882, "answer_id": 57990440, "question_id": 57987225, "link": "https://stackoverflow.com/questions/57987225/i-need-vba-code-for-showing-next-entry-in-other-sheet-cell/57990440#57990440", "title": "I need vba code for showing next entry in other sheet cell", "body": "<p>Here is the code for the previous row</p>\n\n<pre><code>Dim previousrow As Long\nSub previousrow1()\n    If previousrow = 0 Then\n        previousrow = 535 '&lt;--starts at row 1\n    Else\n        previousrow = previousrow - 1 '&lt;--increases of 1 each click\n    End If\n    Sheets(\"invoice\").Cells(9, 3) = Sheets(\"Sheet4\").Cells(previousrow, 2)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12083471, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-deO2bx-dMbM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfBOQoOJpS6mJA_eJFXQEtatQKFOg/photo.jpg?sz=128", "display_name": "Shaharyar office", "link": "https://stackoverflow.com/users/12083471/shaharyar-office"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1568803747, "accepted_answer_id": 57988016, "answer_count": 3, "score": -5, "last_activity_date": 1568804570, "creation_date": 1568791491, "last_edit_date": 1568804570, "question_id": 57987225, "link": "https://stackoverflow.com/questions/57987225/i-need-vba-code-for-showing-next-entry-in-other-sheet-cell", "closed_reason": "Needs details or clarity", "title": "I need vba code for showing next entry in other sheet cell", "body": "<p><a href=\"https://i.stack.imgur.com/h1z6j.jpg\" rel=\"nofollow noreferrer\">enter image description here</a><a href=\"https://i.stack.imgur.com/5dmCz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5dmCz.jpg\" alt=\"https://i.stack.imgur.com/5dmCz.jpg\"></a></p>\n\n<p>I want when ever i click next button it should show in next to serial cell and next cell down as per given in different sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/4qkbh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4qkbh.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568790859, "post_id": 57986969, "comment_id": 102381942, "body": "Can you not protect the sheet?"}, {"owner": {"reputation": 3, "user_id": 11169323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a128be52883196b274e03824cf297096?s=128&d=identicon&r=PG&f=1", "display_name": "Rickybiomed", "link": "https://stackoverflow.com/users/11169323/rickybiomed"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568794875, "post_id": 57986969, "comment_id": 102384026, "body": "Thanks for your response SJR. I can certainly protect the sheet, but I don&#39;t want to restrict the user&#39;s ability to change the row heights to suit their needs. It will make the form less user-friendly."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11169323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a128be52883196b274e03824cf297096?s=128&d=identicon&r=PG&f=1", "display_name": "Rickybiomed", "link": "https://stackoverflow.com/users/11169323/rickybiomed"}, "edited": false, "score": 0, "creation_date": 1568797020, "post_id": 57987379, "comment_id": 102385222, "body": "Thank you for your comment FunThomas!  Your proposed solution works, but it&#39;s not perfect. The movement of the checkbox is clumsy and doesn&#39;t always follow the change in the cell dimension perfectly. Is there no way to automatically move and centre the checkbox as soon as the cell dimensions are changed?"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1568792049, "creation_date": 1568792049, "answer_id": 57987379, "question_id": 57986969, "link": "https://stackoverflow.com/questions/57986969/is-there-a-way-to-dynamically-change-the-size-and-position-of-a-checkbox-when-ch/57987379#57987379", "title": "Is there a way to dynamically change the size and position of a checkbox when changes to a row height or column width are made?", "body": "<p>To keep the alignment of any <code>shape</code> to the cell they are placed in, set their <code>Placement</code>-property to <code>xlMove</code> - in that case they stay within the cell even if they are resized. No need to handle any resize-event. In Excel, you set this property by right clicking on the control, select <code>\"Format Control\"</code>, <code>\"Properties\"</code> and select <code>\"Move but not size\"</code>. But you can do this also using VBA.</p>\n\n<p>This code will set the property for all shapes of the active sheet:</p>\n\n<pre><code>Dim sh as Shape\nFor Each sh In activeSheet.Shapes\n    sh.Placement = xlMove\nNext sh\n</code></pre>\n\n<p>or just for the checkboxes you have</p>\n\n<pre><code>Dim sBox As CheckBox\nFor Each sBox In ws.CheckBoxes\n    sBox.Placement = xlMove\nNext sBox\n</code></pre>\n\n<p>If you create the Controls via code, you should simply set the property directly when you create them. </p>\n"}], "owner": {"reputation": 3, "user_id": 11169323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a128be52883196b274e03824cf297096?s=128&d=identicon&r=PG&f=1", "display_name": "Rickybiomed", "link": "https://stackoverflow.com/users/11169323/rickybiomed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568809527, "creation_date": 1568790579, "question_id": 57986969, "link": "https://stackoverflow.com/questions/57986969/is-there-a-way-to-dynamically-change-the-size-and-position-of-a-checkbox-when-ch", "title": "Is there a way to dynamically change the size and position of a checkbox when changes to a row height or column width are made?", "body": "<p>I have a worksheet that I'm using to record participant enrollment. I use a set of checkboxes and a ComboBox to allow the user to select a program and to select the relevant testing rounds. The ComboBox and Checkboxes are created using a Button click event, which ensures that the position and height of each component perfectly align with the cell which it is found within. </p>\n\n<p>The issue is that the user may choose to change columns widths and row heights to fit data into specific cells (this is especially true with the \"Additional Comments\" column. These changes will throw off the alignment of the checkboxes and ComboBoxes with their respective cells. </p>\n\n<p>I have tried utilising the Worksheet.Change event, but that function only throws an interrupt when the contents of the cells are changed. Other properties, such as the row height and column width, are not monitored. The user will have to manually move and resize the ComboBox and the CheckBoxes when such changes occur, which is tedious and reduces the quality of the Worksheet's presentation.  </p>\n\n<p>With an interrupt on change of row height, one can use the following VBA code:</p>\n\n<pre><code>private sub Row_Height_Change(ByVal Target As Range)\n   'Special interrupt function\n\n   Dim Row_Counter As Integer\n   'Declare a row counter variable to store the row number\n\n   Dim Row_Counter As Integer \n   'Declare a column counter variable to store the column number\n\n   Row_Counter = 'Retrieve information from the interrupt\n   Column_Counter = 'We know which column the CheckBox is found in\n\n   Dim CheckBoxName As String\n\n   CheckBoxName = \"CB Test Round \" &amp; CStr(Row_Counter)\n   'Name CheckBoxes in \"Create Participant\" macro using their position\n\n   Column_Letter = Split(Cells(Row_Counter, Column_Counter).Address, \"$\")(1)\n\n   Set ws = ActiveSheet\n   Set TestRound1_CheckBox = ws.CheckBoxes(CheckBoxName)\n   'Set the checkbox in question\n   Set Cell_1 = ws.Cells(CStr(Row_Counter), Column_Letter) \n   'Find the cell where the checkbox is located\n\n   With TestRound1_CheckBox\n       .Left = Cell_1.Left + (Cell_1.Width / 2)\n       .Top = Cell_1.Top + (Cell_1.Height / 2)\n       .Right = ...\n\n   End With\n</code></pre>\n\n<p>The issue is that I can't find such an interrupt. Any assistance is greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "dynamic", "subtraction"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568788535, "post_id": 57986397, "comment_id": 102380906, "body": "What&#39;s wrong with your code? Your example doesn&#39;t look very helpful - why is everything zero?"}, {"owner": {"reputation": 11, "user_id": 8112695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54cef8b2fb4c66355b56d9ae7986e4aa?s=128&d=identicon&r=PG&f=1", "display_name": "jake94", "link": "https://stackoverflow.com/users/8112695/jake94"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568788870, "post_id": 57986397, "comment_id": 102381039, "body": "The code displayed is just there as an FYI. The issue i&#39;m having is displaying the subtraction result of the first two columns in the third column, once someone inputs data into the first column. Hours Budgeted will always be zero until the user inputs the data. The Variance column is where i need the formula (hence why it&#39;s 0)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568789015, "post_id": 57986397, "comment_id": 102381102, "body": "if you want things to happen when a user enters data you need to investigate worksheet events, probably the change event in this case."}], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 0, "last_activity_date": 1568789251, "creation_date": 1568789251, "answer_id": 57986605, "question_id": 57986397, "link": "https://stackoverflow.com/questions/57986397/vba-macro-to-subtract-one-variable-number-dynamic-from-a-fixed-number/57986605#57986605", "title": "VBA macro to subtract one variable number (dynamic) from a fixed number", "body": "<p>The following code should do the trick, just add it after the code you posted.</p>\n\n<pre><code>For i = 2 To O\n    Cells(i, \"D\").FormulaR1C1 = \"=RC[-1]-RC[-2]\"\nNext i\n</code></pre>\n\n<p>FormulaR1C1 lets you insert cells references that are relative to the cell you're putting the formula into, so R[2]C[3] would insert a reference to a cell three rows down and three columns to the right.</p>\n"}], "owner": {"reputation": 11, "user_id": 8112695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54cef8b2fb4c66355b56d9ae7986e4aa?s=128&d=identicon&r=PG&f=1", "display_name": "jake94", "link": "https://stackoverflow.com/users/8112695/jake94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "accepted_answer_id": 57986605, "answer_count": 1, "score": 0, "last_activity_date": 1568790169, "creation_date": 1568788297, "last_edit_date": 1568788591, "question_id": 57986397, "link": "https://stackoverflow.com/questions/57986397/vba-macro-to-subtract-one-variable-number-dynamic-from-a-fixed-number", "title": "VBA macro to subtract one variable number (dynamic) from a fixed number", "body": "<p>I am after a dynamic macro that subtracts numbers in C2 onwards from B2 onwards and puts them in D2 onwards.\nNumbers in C2 onwards are fixed, although the user will put numbers in B2 onwards. The length of Column C (Hours Charged) changes dependent on the sheet that has been imported. The code is as follows:</p>\n\n<pre><code>Dim O As Long\nO = Cells(Rows.Count, \"C\").End(xlUp).Row\nCells(O + 1, \"C\").Formula = \"=SUM(C2:C\" &amp; O &amp; \")\"\nCells(O + 1, \"C\").Interior.Color = RGB(208, 247, 197)\nCells(O + 1, \"C\").Font.Bold = True\n</code></pre>\n\n<p>The sheet looks something like this (the first column is B, the last is D):</p>\n\n<pre><code>Hours Budgeted | Hours Charged | Variance\n       0       |     85        |  0\n       0       |     31        |  0\n       0       |     20        |  0\n       0       |     100       |  0\n       0       |     75        |  0\n</code></pre>\n\n<p>To summarise, when a user inputs a value in the Hours Budgeted (B) column, i want it to automatically subtract from the Hours Charged (C) column and display in the Variance (D) column.\nThe reason why this can't just be a '=C2-B2' is because I have a macro inputting all this data, as well as a separate macro that 'Resets' the sheet (removing all data and formulas).</p>\n\n<p>Thanks all,\nJake.</p>\n"}, {"tags": ["excel", "vba", "dynamic", "insert", "autofill"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568792328, "post_id": 57986394, "comment_id": 102382727, "body": "Hi Walter, I&#39;m having some issues to determine what the problem is. As far as I can see the code runs as expected. Can you perhaps post your current and expected outputs?"}, {"owner": {"reputation": 81, "user_id": 12083178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-j5Mb1gffpwQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBEo9gz0R6Dl8LamhQ96TBq_4o5A/photo.jpg?sz=128", "display_name": "Walter Kloosterboer", "link": "https://stackoverflow.com/users/12083178/walter-kloosterboer"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568793217, "post_id": 57986394, "comment_id": 102383200, "body": "Hi Plutian, I found my own problem and then realised it isn&#39;t visible in this post. The code has a reference to a cell on a different page. It first added rows on the default page, than it made the reference to the cell.  After that it adds rows on the other page, thereby shifting the cell reference down.  Excuses for the therefor &quot;bad&quot; question..."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568793879, "post_id": 57986394, "comment_id": 102383517, "body": "No problem, it&#39;s always encouraged to answer your own question as it shows you&#39;ve learned something. But as I understand your added rows messed with the cell reference within the same range, which would then shift. Always be careful with named ranges when adding cells in between because problems like this arise. I recommend always adding after the used range instead if possible."}, {"owner": {"reputation": 81, "user_id": 12083178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-j5Mb1gffpwQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBEo9gz0R6Dl8LamhQ96TBq_4o5A/photo.jpg?sz=128", "display_name": "Walter Kloosterboer", "link": "https://stackoverflow.com/users/12083178/walter-kloosterboer"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568794430, "post_id": 57986394, "comment_id": 102383807, "body": "Thanks for the feedback, however the range is added after the used range so that wasn&#39;t the problem. I use multiple sheets over which the rows are added.  What i did was in the first sheet add rows and reference to the second sheet. So it was still correct. But then the code added new rows on the second sheet, thereby shifting the referenced cells down  I will put the original code in the next comment"}, {"owner": {"reputation": 81, "user_id": 12083178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-j5Mb1gffpwQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBEo9gz0R6Dl8LamhQ96TBq_4o5A/photo.jpg?sz=128", "display_name": "Walter Kloosterboer", "link": "https://stackoverflow.com/users/12083178/walter-kloosterboer"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1568794731, "post_id": 57986394, "comment_id": 102383961, "body": "worksheet_uitsplitsing.Rows(&quot;17&quot; &amp; &quot;:&quot; &amp; add_lines_p2).Insert Shift:=xlDown,      CopyOrigin:=xlFormatFromRightOrAbove      Set formula_source_p2 = worksheet_uitsplitsing.Rows(&quot;14:15&quot;)     Set formula_destination_p2 = worksheet_uitsplitsing.Rows(&quot;14&quot; &amp; &quot;:&quot; &amp;      add_lines_p2)     formula_source_p2.AutoFill formula_destination_p2       Excel.Worksheets(&quot;Materiaal&quot;).Rows(&quot;17&quot; &amp; &quot;:&quot; &amp; add_lines_p2).Insert      Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrAbove  So the reference was made before the rows on the other sheet were added"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 12083178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-j5Mb1gffpwQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBEo9gz0R6Dl8LamhQ96TBq_4o5A/photo.jpg?sz=128", "display_name": "Walter Kloosterboer", "link": "https://stackoverflow.com/users/12083178/walter-kloosterboer"}, "is_accepted": false, "score": 0, "last_activity_date": 1568793361, "creation_date": 1568793361, "answer_id": 57987734, "question_id": 57986394, "link": "https://stackoverflow.com/questions/57986394/when-trying-to-use-autofill-via-vba-after-inserting-rows-the-formulas-copied-ar/57987734#57987734", "title": "When trying to use autofill via vba after inserting rows, the formulas copied are incorrect", "body": "<p>I found my own problem and then realised it isn't visible in this post.\nThe code has a reference to a cell on a different page. It first added rows on the default page, than it made the reference to the cell.</p>\n\n<p>After that it adds rows on the other page, thereby shifting the cell reference down.</p>\n\n<p>Excuses for the therefor \"bad\" question...</p>\n"}], "owner": {"reputation": 81, "user_id": 12083178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-j5Mb1gffpwQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBEo9gz0R6Dl8LamhQ96TBq_4o5A/photo.jpg?sz=128", "display_name": "Walter Kloosterboer", "link": "https://stackoverflow.com/users/12083178/walter-kloosterboer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568793361, "creation_date": 1568788294, "question_id": 57986394, "link": "https://stackoverflow.com/questions/57986394/when-trying-to-use-autofill-via-vba-after-inserting-rows-the-formulas-copied-ar", "title": "When trying to use autofill via vba after inserting rows, the formulas copied are incorrect", "body": "<p>I have an dynamic range that counts an x amount of constructions in a different document. It then adds this amount of rows (-3 for the default present rows). After the rows are added, the formulas from the first 3 rows are autofilled to match the range.</p>\n\n<p>The formula in the 1st row is\n     \"=Materiaal!V14\"\nThe formula in the 2nd row is \n    \"=Materiaal!V15\"\nThe formula in the 3rd row is \n    \"=Materiaal!V16\"</p>\n\n<p>However, after the rows are added it skips an amount of cells\nThe formula in the 4th row is \n    \"=Materiaal!V26\"\nThis should have been \n    \"=Materiaal!V27\"</p>\n\n<p>I tried to change where the new formulas, to make sure it start in the first row again, but that also won't work</p>\n\n<pre><code>Dim add_lines_p2 As Integer, formula_source_p2 As Range, \nformula_destination_p2 As Range\nadd_lines_p2 = production_numbers_count - 3\nadd_lines_p2 = add_lines_p2 + 16\n\n\n'now the command to add the new lines + adding the right formulas\n worksheet_uitsplitsing.Rows(\"17\" &amp; \":\" &amp; add_lines_p2).Insert \n Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrAbove\n\nSet formula_source_p2 = worksheet_uitsplitsing.Rows(\"14:15\")\nSet formula_destination_p2 = worksheet_uitsplitsing.Rows(\"14\" &amp; \":\" &amp; \nadd_lines_p2)\nformula_source_p2.AutoFill formula_destination_p2\n</code></pre>\n\n<p>I expected the rows to count up from row 14, but after the default 3 rows, it skips a certain amount of cells.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568788374, "post_id": 57986325, "comment_id": 102380827, "body": "Attempt 2 will certainly not work because <code>Find</code> returns a range object, not an integer (use Long anyway)."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1568788684, "post_id": 57986325, "comment_id": 102380970, "body": "Could you supply some sample data? I just tried your combination of formats and it worked just fine. Also, have you tried a simple MATCH function in the worksheet (without using VBA) to see where the problem lies?"}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568789438, "post_id": 57986325, "comment_id": 102381291, "body": "@SJR - would it work if I Dim iTestCurrentDateCol as Range then find the value of iTestCurrentDateCol?"}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1568789470, "post_id": 57986325, "comment_id": 102381303, "body": "@M.Schalk: Using Match function in the worksheet works correctly for me (returns: 21)  Assume vCurrentDate = 18/09/2019 Assume F6:AJ6 have text values of Sunday, Monday, Tuesday, etc....corresponding to 01/09/2019, 02/09/2019, 03/09/2019, etc"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568789618, "post_id": 57986325, "comment_id": 102381375, "body": "Yes, that&#39;s the way to do it, check that Find returns something and if so use the column property of a range. Dates can be tricky, eg <a href=\"https://stackoverflow.com/questions/45639660/excel-vba-range-find-date-that-is-a-formula\" title=\"excel vba range find date that is a formula\">stackoverflow.com/questions/45639660/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1568796456, "post_id": 57986325, "comment_id": 102384911, "body": "@M.Schalk - Figured out how to do it with .Match - just need to do .Match (CDbl(vCurrentDate),rRng,0) and it works"}, {"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568796518, "post_id": 57986325, "comment_id": 102384944, "body": "@SJR if I do set iTestCurrentDateCol = rRng.Find(CDbl(vCurrentDate), LookIn:=xlValues), itestCurrentDateCol is &quot;Nothing&quot; whereas using the .Match works"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568796779, "post_id": 57986325, "comment_id": 102385089, "body": "I would start by specifying all <code>Find</code> parameters as they are often not as you expect."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "edited": false, "score": 0, "creation_date": 1568796362, "post_id": 57988340, "comment_id": 102384864, "body": "Thanks for the code! I did something like this but still doesn&#39;t work for me, even if I use set Adress = rRng.Find(CDbl(vCurrentDate),lookin:=xlvalues)  If  Adress Is Nothing Then     MsgBox &quot;Nothing&quot; Else     Int = Adress.value     Msgbox Int End If  Msgbox shows up as &quot;Nothing&quot; even though I&#39;ve found the date using .Match works"}], "tags": [], "owner": {"reputation": 5, "user_id": 11857564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eeb8b245412e67d6504c2cae281dc67?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSITT", "link": "https://stackoverflow.com/users/11857564/pandasitt"}, "is_accepted": false, "score": 0, "last_activity_date": 1568795788, "last_edit_date": 1568795788, "creation_date": 1568795438, "answer_id": 57988340, "question_id": 57986325, "link": "https://stackoverflow.com/questions/57986325/how-to-use-range-find-or-match-function-in-vba-for-row-of-dates-not-formatted-as/57988340#57988340", "title": "How to use Range.find or Match function in VBA for row of dates not formatted as dates?", "body": "<p>It should work like this:</p>\n\n<pre><code>Dim SomeValue As String: SomeValue = \"\"\nDim Adress As Range\nDim Int As Variant\n\nSet Adress = Sheets(1).Range(\"A:A\").Find(SomeValue)\nInt = Adress.Value\n</code></pre>\n\n<p>vCurrentDate might still be a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "is_accepted": true, "score": 0, "last_activity_date": 1568811943, "creation_date": 1568811943, "answer_id": 57993499, "question_id": 57986325, "link": "https://stackoverflow.com/questions/57986325/how-to-use-range-find-or-match-function-in-vba-for-row-of-dates-not-formatted-as/57993499#57993499", "title": "How to use Range.find or Match function in VBA for row of dates not formatted as dates?", "body": "<p>With help from the comments, here's the answer to my own question for my own question for attempt 1 if anyone is curious:</p>\n\n<pre><code>iTestCurrentDateCol = Application.Match(CDbl(vCurrentDate), rRng, 0)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12014262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a0393b311c70b9dbaba79b45e87b2a?s=128&d=identicon&r=PG&f=1", "display_name": "newtovba", "link": "https://stackoverflow.com/users/12014262/newtovba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57993499, "answer_count": 2, "score": 0, "last_activity_date": 1568811943, "creation_date": 1568788066, "question_id": 57986325, "link": "https://stackoverflow.com/questions/57986325/how-to-use-range-find-or-match-function-in-vba-for-row-of-dates-not-formatted-as", "title": "How to use Range.find or Match function in VBA for row of dates not formatted as dates?", "body": "<p><strong>I need to find the column value in the range that matches a user-inputted date.</strong></p>\n\n<p>I have a range where one of the rows has dates of the month that are purposefully not formatted as dates.</p>\n\n<p>I tried using the .find method and application.match but both are not working for me (even though it's guaranteed that the user inputted date is within the range).</p>\n\n<p>Below are the relevant portions of code:</p>\n\n<pre><code>Dim vCurrentDate As Variant\nDim iCurrentDateCol As Integer\nDim rRng As Range\n\n'Sheet8.Range(\"s1\") is formatted as yyyy/mm/dd\nvCurrentDate = Sheet8.Range(\"s1\")\n\n'HolidaySchedule is for C$5:$AJ$90\n'The row with dates has dates formatted as \"Monday\", \"Tuesday\", etc\"\nSet rRng = Sheet3.Range(\"HolidaySchedule\")\n</code></pre>\n\n<blockquote>\n  <p>ATTEMPT 1: Using Application.Match (Similarly tried with Worksheetfunction)\n  Result: Run-time error '424' Object required</p>\n</blockquote>\n\n<pre><code>'I have tried vCurrentDate, vCurrentDate.value, vCurrentDate.Value2\niTestCurrentDateCol = Application.Match(vCurrentDate.Value2, rRng, 0)\n</code></pre>\n\n<blockquote>\n  <p>ATTEMPT 2: Using .Find</p>\n</blockquote>\n\n<pre><code>iTestCurrentDateCol = rRng.Find(vCurrentDate.Value2, LookIn:=xlValues)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568788619, "post_id": 57986284, "comment_id": 102380942, "body": "And your question is ...?"}, {"owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568790596, "post_id": 57986284, "comment_id": 102381821, "body": "The above code is not working :( It is giving a run time error 1004"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1568790984, "post_id": 57987006, "comment_id": 102381997, "body": "Still it is throwing the same error.. I even tried replacing active sheets with wsData"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1568791192, "post_id": 57987006, "comment_id": 102382110, "body": "I think your problem might lie here:         OpenWb.Worksheets(&quot;Data&quot;).Range(&quot;A1&quot;).Select         You do not need the Select statement, just delete it.  Also, these two lines make no sense: Set wsData = OpenWb.Worksheets(&quot;Data&quot;).   Set wsData = ActiveSheet.   You should the one that you don&#39;t need."}, {"owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1568791343, "post_id": 57987006, "comment_id": 102382204, "body": "After that.. I am getting an error &quot;The worksheet data for a table needs to be on the same sheet as the table.&quot;"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1568791414, "post_id": 57987006, "comment_id": 102382237, "body": "Please edit the question and post the code you&#39;re using now, otherwise I&#39;m not sure I understand what&#39;s happening."}, {"owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "edited": false, "score": 0, "creation_date": 1568822704, "post_id": 57987006, "comment_id": 102400152, "body": "Hi.. I believe I have provided the required information in the question... And also provided the solution as my answer.... Can some one up vote the question please"}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 1, "last_activity_date": 1568790716, "creation_date": 1568790716, "answer_id": 57987006, "question_id": 57986284, "link": "https://stackoverflow.com/questions/57986284/conversion-of-raw-data-to-table-in-an-excel-using-vba/57987006#57987006", "title": "Conversion of raw data to table in an excel using vba", "body": "<p>When creating the table you need to have the entire range of data as an input, instead of just the upper left cell (A1). Try this:</p>\n\n<pre><code>ActiveSheet.ListObjects.Add(xlSrcRange, _\nRange(\"A1\", Range(\"A1\").End(xlToRight).End(xlDown)), , xlYes).Name _\n    = \"Table1\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1568793342, "creation_date": 1568793342, "answer_id": 57987720, "question_id": 57986284, "link": "https://stackoverflow.com/questions/57986284/conversion-of-raw-data-to-table-in-an-excel-using-vba/57987720#57987720", "title": "Conversion of raw data to table in an excel using vba", "body": "<p>Thanks for the support...\nThe below code will work to convert a dynamic range of data to a table </p>\n\n<pre><code>Sub converttbl()\n\n    Dim OpenWb As Workbook\n    Set OpenWb = Workbooks.Open(\"C:\\Users\\user\\Desktop\\data.xlsb\")\n    Dim wsData As Worksheet\n    Set wsData = OpenWb.Worksheets(\"Data\")\nOpenWb.Worksheets(\"Data\").Range(\"A1\").Select\nActiveSheet.ListObjects.Add(xlSrcRange, Selection.CurrentRegion, , xlYes).Name = _\n    \"MyTable\"\nMsgBox \"Execution completed\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8053053, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r9neI9-xnkE/AAAAAAAAAAI/AAAAAAAABFM/7j7K2MSTx0Q/photo.jpg?sz=128", "display_name": "srawan kallakuri", "link": "https://stackoverflow.com/users/8053053/srawan-kallakuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1568793342, "creation_date": 1568787893, "last_edit_date": 1568792510, "question_id": 57986284, "link": "https://stackoverflow.com/questions/57986284/conversion-of-raw-data-to-table-in-an-excel-using-vba", "title": "Conversion of raw data to table in an excel using vba", "body": "<p>I want to convert my data into table format in excel using vba\nThe code execution has to be done from different sheet by invoking the source file\nAnd the range has to be dynamic</p>\n\n<p>Here is the code that I have tried</p>\n\n<pre><code>    Sub converttbl()\n\n    Dim OpenWb As Workbook\n    Set OpenWb = Workbooks.Open(\"C:\\Users\\user\\Desktop\\data.xlsb\")\n    Dim wsData As Worksheet\n    Set wsData = OpenWb.Worksheets(\"Data\")\n      Set wsData = ActiveSheet\n\nActiveSheet.Range(\"A1\").Select\n\nApplication.CutCopyMode = False\nActiveSheet.ListObjects.Add(xlSrcRange, _\nRange(\"A1\", Range(\"A1\").End(xlToRight).End(xlDown)), , xlYes).Name _\n    = \"Table1\"\n\nMsgBox \"Execution completed\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1568787631, "post_id": 57986104, "comment_id": 102380520, "body": "Keep in mind that text boxes on a form contain string values that look like numbers, not actual numbers. You would want to do something like converting them to integers (into a new variable) using a <code>Int(x)</code> function or something along those lines before comparing them."}, {"owner": {"reputation": 69, "user_id": 10128353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Vp7d.gif?s=128&g=1", "display_name": "marubindesu", "link": "https://stackoverflow.com/users/10128353/marubindesu"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568787989, "post_id": 57986104, "comment_id": 102380674, "body": "@braX Thank you! I did it, my variables was set to variant and i thought that it will be okay to set them to variant so that overflow will be avoided."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1568788073, "post_id": 57986104, "comment_id": 102380711, "body": "@VinIsLearning Variant is (almost) never a good solution. Only use it if there is no other option. I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i> and declare all variables properly."}, {"owner": {"reputation": 69, "user_id": 10128353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Vp7d.gif?s=128&g=1", "display_name": "marubindesu", "link": "https://stackoverflow.com/users/10128353/marubindesu"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568788526, "post_id": 57986104, "comment_id": 102380901, "body": "@P\u1d07\u029c Thank you for the information especially the Option Explicit and  I should be careful when using &quot;Variant&quot;. Thank you"}], "owner": {"reputation": 69, "user_id": 10128353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Vp7d.gif?s=128&g=1", "display_name": "marubindesu", "link": "https://stackoverflow.com/users/10128353/marubindesu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568787876, "creation_date": 1568787090, "last_edit_date": 1568787876, "question_id": 57986104, "link": "https://stackoverflow.com/questions/57986104/problem-with-comparing-negative-numbers-in-vba", "title": "Problem with comparing negative numbers in vba", "body": "<p>I'm still new at VBA and I'm sure that this is a simple problem, but I'm comparing negative numbers who is lesser for example if I inputed textboxMIN to -7 and textboxMAX to -1 the result will be -1 will be less than -7. I don't know how to solve it because for me the condition is correct but the result isn't. Please take a look if there is a problem with my code</p>\n\n<pre><code>   '/************PROCESS***************/\n    For t_int_iteratorI = 0 To txt_NumOperands.Value - 1\n        MultiPage1.Pages.Add\n        MultiPage1.Pages(t_int_iteratorI).Caption = \"Variable\" &amp; t_int_iteratorI + 1\n\n        Call sub_LabelPerPage\n      Set p_var_SetTxtBox = frm_RangeForm.MultiPage1.Pages(t_int_iteratorI).Controls.Add(\"Forms.TextBox.1\", \"MinBox\")\n        With p_var_SetTxtBox\n            .Top = 50\n            .Left = 100\n        End With\n\n     Set p_var_SetTxtBox = frm_RangeForm.MultiPage1.Pages(t_int_iteratorI).Controls.Add(\"Forms.TextBox.1\", \"MaxBox\")\n        With p_var_SetTxtBox\n            .Top = 50\n            .Left = 300\n        End With\n    Next t_int_iteratorI     \n\n               p_var_MaxValue = frm_RangeForm.MultiPage1.Pages(t_int_iteratorI).maxbox.Value\n               p_var_MinValue = frm_RangeForm.MultiPage1.Pages(t_int_iteratorI).MinBox.Value\n\n                 If p_var_MinValue &gt; p_var_MaxValue Then\n                   MsgBox \"MIN value should be lesser than MAX value.\"\n                   Exit Sub\n                 End If\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568786452, "post_id": 57985915, "comment_id": 102380107, "body": "Not possible, and in fact, dangerous if it was possible..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568787629, "post_id": 57985915, "comment_id": 102380519, "body": "See <a href=\"https://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\">How do I download a file using VBA (without Internet Explorer)</a>. This might work if you can get the direct link to the file you want to download (or might fail if a login or something similar is required)."}, {"owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "edited": false, "score": 0, "creation_date": 1568787689, "post_id": 57985915, "comment_id": 102380542, "body": "Login/Password in involved."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1568787783, "post_id": 57985915, "comment_id": 102380592, "body": "@HusnainIqbal depending on the kind of authentication that is required it might still work. See the solution in the link. Otherwise see the first comment."}], "answers": [{"tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 0, "last_activity_date": 1568800328, "creation_date": 1568800328, "answer_id": 57989926, "question_id": 57985915, "link": "https://stackoverflow.com/questions/57985915/get-rid-of-save-open-dialogue-box/57989926#57989926", "title": "Get rid of Save/Open dialogue box", "body": "<p>As far as I know, we can't disable the download prompt, but we could use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/sendkeys-statement\" rel=\"nofollow noreferrer\">Application.SendKeys</a> method to send the keystrokes of the shortcut keys (Alt + S) to click the save button in IE11.</p>\n\n<p>Code as below:</p>\n\n<pre><code>Sub downloadfile()\n\n    Dim IE As Object, Data As Object\n    Dim ticket As String\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    With IE\n        .Visible = True\n        .navigate (\"&lt;the website url&gt;\")\n\n        While IE.ReadyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n        Set Data = IE.Document.getElementsbyTagName(\"input\")\n\n        'Trigger the download button to download the file\n        IE.Document.getElementbyId(\"btnDowloadReport\").Click\n\n        'wait the download prompt appear\n        Application.Wait (Now + TimeValue(\"00:00:03\"))\n\n        '\n        Application.SendKeys \"%{s}\"\n\n    'Waiting for the site to load.\n    'loadingSite\n    End With\n    Set IE = Nothing\nEnd Sub\n</code></pre>\n\n<p>The web page content:</p>\n\n<pre><code>&lt;a id=\"btnDowloadReport\" href=\"https://research.google.com/pubs/archive/44678.pdf\" download&gt;Download&lt;/a&gt;\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11803714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uoVpc.jpg?s=128&g=1", "display_name": "Husnain Iqbal", "link": "https://stackoverflow.com/users/11803714/husnain-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568800328, "creation_date": 1568786122, "last_edit_date": 1568787503, "question_id": 57985915, "link": "https://stackoverflow.com/questions/57985915/get-rid-of-save-open-dialogue-box", "title": "Get rid of Save/Open dialogue box", "body": "<p>How to disable the message of IE asking open or save download file. </p>\n\n<p>I just want to download it directly. no question asked. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568786068, "post_id": 57985892, "comment_id": 102379965, "body": "For starters, <code>Rows.Count</code> should be fully qualified like: <code>w2.ActiveSheet.Rows.Count</code> or it will refer to the active sheet instead of the one you want. The same goes for your <code>Rows(r)</code> and <code>Cells()</code> - they are not qualified just by including them in a <code>With</code>"}, {"owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1568787797, "post_id": 57985892, "comment_id": 102380596, "body": "thanks , this was just a small snippet of my code , id select the the correct sheet . my main issue is trying to not delete the month values if they are less than 12 if one of the matches has a 12 ."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1568787800, "post_id": 57985892, "comment_id": 102380597, "body": "Maybe use COUNTIFS?"}, {"owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "edited": false, "score": 0, "creation_date": 1568801494, "post_id": 57985892, "comment_id": 102387870, "body": "could you please let me know how I could use countifs to solve this issue"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "edited": false, "score": 0, "creation_date": 1568793426, "post_id": 57987008, "comment_id": 102383294, "body": "Range F is the only Column that has the month values. I need to find a way if Column B company name and Column E year is matched. Then if there are more than one instance of this match due to multiple month numbers being added, so say we have comp1 year 2019 , then we have 3 rows with this matched criteria . with column F , months 3 , 9 , 12. . As one of those matched months is 12 , I need to keep all the rows. If comp2 2019 had 3 rows of data , with months 3 , 6 , 9. Then these would need to be deleted as none of those months equal 12."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "edited": false, "score": 0, "creation_date": 1568795057, "post_id": 57987008, "comment_id": 102384111, "body": "please upload an image with the initial data and the desirable outcome."}, {"owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "edited": false, "score": 0, "creation_date": 1568897583, "post_id": 57987008, "comment_id": 102427063, "body": "I have added a link to the table at the top of the post. In this example , All the data should be kept for company AA , as there is an instance of 12 in one of the rows. All company BB rows deleted"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1568790726, "creation_date": 1568790726, "answer_id": 57987008, "question_id": 57985892, "link": "https://stackoverflow.com/questions/57985892/delete-rows-based-on-match-column-b-e-and-then-column-f-if-12-or-a-row-contain/57987008#57987008", "title": "Delete rows based on match column B E and then Column F if = 12 or a row contains 12", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub Delete()\n\n    Dim LastRow As Long, i As Long\n\n    'Change sheet name if needed\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        'Find the last row of Column A\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = LastRow To 2 Step -1\n\n            If .Range(\"F\" &amp; i).Value &lt;&gt; 12 And (.Range(\"B\" &amp; i).Value &lt;&gt; 12 And .Range(\"E\" &amp; i).Value &lt;&gt; 12) Then\n                .Rows(i).EntireRow.Delete\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11873213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20335c1d60b1e010577b0d62844102df?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/11873213/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568897440, "creation_date": 1568785977, "last_edit_date": 1568897440, "question_id": 57985892, "link": "https://stackoverflow.com/questions/57985892/delete-rows-based-on-match-column-b-e-and-then-column-f-if-12-or-a-row-contain", "title": "Delete rows based on match column B E and then Column F if = 12 or a row contains 12", "body": "<p><a href=\"https://i.stack.imgur.com/093UI.jpg\" rel=\"nofollow noreferrer\">link to table</a>I am trying to find a solution to remove rows of data from a workbook based on multiple criteria\nColumn B is company name\nColumn E is year\nColumn F is months.\nThe complex part is that there some instances where Column B and E are matched more than once , as there are different month values which can be 3 , 6 , 9 , 12. I need to find a way to delete all rows which does not have a monthly value of 12. but I need to keep the rows with monthly values less than 12 , if one of the matched rows from B and E has a value of 12</p>\n\n<p>At present I just have this code , but I could only get it to work to remove all months not equal to 12. there is also an addition check , on column  8 , if that = 0 then delete row</p>\n\n<pre><code>lr = w2.ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).row\nWith w2.ActiveSheet\n  Dim r As Long\n  Dim LastRow As Long\n  For r = lr To 2 Step -1\n    If Cells(r, 8) = 0 Or Cells(r, 6) &lt;&gt; 12 Then\n      Rows(r).Delete\n    End If\n  Next r\nEnd With\n</code></pre>\n\n<p>I want to be able have a table of contents left that has any zero data in column 8 removed and only have monthly data that contains 12 or if multiple month values less than 12 , but one of matches equals 12 then keep all those months</p>\n"}, {"tags": ["excel", "vba", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7344474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-nkxvj_4mwlc/AAAAAAAAAAI/AAAAAAAAABU/VhyQplvmBNE/photo.jpg?sz=128", "display_name": "Kelvs", "link": "https://stackoverflow.com/users/7344474/kelvs"}, "edited": false, "score": 0, "creation_date": 1568788105, "post_id": 57986277, "comment_id": 102380728, "body": "Works like a charm! Now I&#39;ll just set it up so that every time I add new data, it will first locate the last row before adding. Thank you!"}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": true, "score": 1, "last_activity_date": 1568787866, "creation_date": 1568787866, "answer_id": 57986277, "question_id": 57985751, "link": "https://stackoverflow.com/questions/57985751/add-multi-selected-items-in-listbox-with-multi-column-to-an-excel-worksheet/57986277#57986277", "title": "Add multi selected items in listbox with multi column to an Excel worksheet", "body": "<p>Try change to code below:\nActiveCell.Offset(0, 3).Value = Me.ListBox1.List(intItem , 0)\nActiveCell.Offset(0, 4).Value = Me.ListBox1.List(intItem, 1)</p>\n"}], "owner": {"reputation": 55, "user_id": 7344474, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-nkxvj_4mwlc/AAAAAAAAAAI/AAAAAAAAABU/VhyQplvmBNE/photo.jpg?sz=128", "display_name": "Kelvs", "link": "https://stackoverflow.com/users/7344474/kelvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 57986277, "answer_count": 1, "score": 0, "last_activity_date": 1568787866, "creation_date": 1568785144, "question_id": 57985751, "link": "https://stackoverflow.com/questions/57985751/add-multi-selected-items-in-listbox-with-multi-column-to-an-excel-worksheet", "title": "Add multi selected items in listbox with multi column to an Excel worksheet", "body": "<p>I am trying to add all selected items from a multi column listbox on a userform, to  my Excel worksheet. These are the codes I'm currently using:</p>\n\n<pre><code>Dim lrow As Range\nDim wst As Worksheet\nDim lo As ListObject\nDim lr As ListRow\n\nApplication.ScreenUpdating = False\n\nDim xRow As Integer, intItem As Integer\n\nSet wst = Sheets(\"TRAININGS PROFILE\")\nwst.Activate\nwst.Range(\"B4\").Select\n\nFor intItem = 0 To listbox1.ListCount - 1\nIf listbox1.Selected(intItem) = True Then\n\nSet lo = wst.ListObjects(1)\nSet lr = lo.ListRows.Add\n\nActiveCell.Offset(0, 3).Value = Me.ListBox1.List(Me.ListBox1.ListIndex, 0)\nActiveCell.Offset(0, 4).Value = Me.ListBox1.List(Me.ListBox1.ListIndex, 1)\nActiveCell.Offset(1, 0).Select\nEnd If\nNext intItem\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>This code works but the problem is it is only saving the last selected item from my listbox, it does not loop through each selected item. Please help.</p>\n"}, {"tags": ["excel", "vba", "runtime"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 1, "creation_date": 1568784896, "post_id": 57985698, "comment_id": 102379599, "body": "You need to set that named range, You only declared that, but not set."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568784964, "post_id": 57985698, "comment_id": 102379617, "body": "You <code>Dim ChargeSuper as Range</code> but you never <code>Set</code> it to any value."}], "owner": {"reputation": 1, "user_id": 12082969, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4cQLOlyIsYo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcC5ABwj5H_E7Toh8j0hImbGT9H1A/photo.jpg?sz=128", "display_name": "user12082969", "link": "https://stackoverflow.com/users/12082969/user12082969"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568784887, "creation_date": 1568784780, "last_edit_date": 1568784887, "question_id": 57985698, "link": "https://stackoverflow.com/questions/57985698/how-to-use-a-loop-on-a-named-range", "title": "How to use a loop on a named range", "body": "<p>I am getting a </p>\n\n<blockquote>\n  <p>Run-time error '424'</p>\n</blockquote>\n\n<p>with my For . . . Next loop.</p>\n\n<p>I have created a time sheet for my work where I only need to enter start and finish times. Then, depending on the day of the week it calculates which hours are worked as Monday to Friday (MF), Saturday-Sunday (SS) or a public holiday (PH). There is a column at the start with a check box for each employee to indicate if they worked as a supervisor or not. (This is important to set pay rates and also charge rates when invoicing. Supervisors are charged a flat rate for every day except public holidays.) The check boxes are linked to the cell underneath them to show true/false depending on whether checked or not.</p>\n\n<p>I am trying to total up the type of hours worked on each day of the week. The column with the check boxes in is a named range (ChargeSuper) on the worksheet. What I need to do for each employee is see if the checkbox is true or false and then add up the times for all employees on each day of the week. But I am getting a runtime error at the start of the loop.</p>\n\n<p>This is what I have written so far:</p>\n\n<pre><code>Dim ChargeSuper As Range\n    Dim MyCell As Range\n\n'\n    Dim SupHrs As Single\n    Dim SupPH As Single\n    Dim StdMF As Single\n    Dim StdSS As Single\n    Dim StdPH As Single\n'\n    For i = 1 To 7\n' Set hours to 0\n    SupHrs = 0\n    SupPH = 0\n    StdMF = 0\n    StdSS = 0\n    StdPH = 0\n    r = 2 + i\n'\n    For Each MyCell In ChargeSuper\n        If MyCell = False Then\n            StdMF = StdMF + MyCell.Offset(r, 1).Value\n            StdSS = StdSS + MyCell.Offset(r, 2).Value\n            StdPH = StdPH + MyCell.Offset(r, 3).Value\n        Else\n            SupHrs = SupHrs + MyCell.Offset(r, 1).Value\n            SupHrs = SupHrs + MyCell.Offset(r, 2).Value\n            SupPH = SupPH + MyCell.Offset(r, 3).Value\n        End If\n    Next MyCell\n</code></pre>\n\n<p>The error occurs at the line \"For Each MyCell in ChargeSuper\". What I want is for it to check each cell with the check box. If it is not checked (False) then add the hours as standard staff. If it is checked then add them as a supervisor.</p>\n\n<p>I have not written VBA for a long time, but this is above what I knew back then too. Any input would be appreciated.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1568791585, "post_id": 57987144, "comment_id": 102382346, "body": "Delete the Stop line later. It is there so you can observe changes on page."}, {"owner": {"reputation": 39, "user_id": 8496600, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840868575927847/picture?type=large", "display_name": "Samriddh Tuteja", "link": "https://stackoverflow.com/users/8496600/samriddh-tuteja"}, "edited": false, "score": 0, "creation_date": 1568801225, "post_id": 57987144, "comment_id": 102387705, "body": "I haven&#39;t worked with query selector yet and If possible could you please tell how we would copy the data using the same"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39, "user_id": 8496600, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840868575927847/picture?type=large", "display_name": "Samriddh Tuteja", "link": "https://stackoverflow.com/users/8496600/samriddh-tuteja"}, "edited": false, "score": 1, "creation_date": 1568815191, "post_id": 57987144, "comment_id": 102395680, "body": "hi, what do you mean by copy the data please?"}, {"owner": {"reputation": 39, "user_id": 8496600, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840868575927847/picture?type=large", "display_name": "Samriddh Tuteja", "link": "https://stackoverflow.com/users/8496600/samriddh-tuteja"}, "edited": false, "score": 0, "creation_date": 1568818192, "post_id": 57987144, "comment_id": 102397580, "body": "I mean when i run your solution the page shows some of the results. And i want to copy the results and paste in the excel sheet"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39, "user_id": 8496600, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840868575927847/picture?type=large", "display_name": "Samriddh Tuteja", "link": "https://stackoverflow.com/users/8496600/samriddh-tuteja"}, "edited": false, "score": 1, "creation_date": 1568834473, "post_id": 57987144, "comment_id": 102404894, "body": "ok... if you open a new question and include your attempt I will have a look. For understanding querySelector you simply place the css selector within the &quot;&quot; i.e. querySelector(&quot;css selector&quot;)  or  querySelectorAll(&quot;css selector&quot;) . To understand pattern matching see: <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors</a>"}, {"owner": {"reputation": 39, "user_id": 8496600, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840868575927847/picture?type=large", "display_name": "Samriddh Tuteja", "link": "https://stackoverflow.com/users/8496600/samriddh-tuteja"}, "edited": false, "score": 0, "creation_date": 1569217489, "post_id": 57987144, "comment_id": 102509868, "body": "Hey , Can you check it now ? &lt; <a href=\"https://stackoverflow.com/questions/58055951/is-there-a-way-to-download-a-row-of-a-table-or-an-entire-table-itself-on-a-webpa\" title=\"is there a way to download a row of a table or an entire table itself on a webpa\">stackoverflow.com/questions/58055951/&hellip;</a> &gt;"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1568791210, "creation_date": 1568791210, "answer_id": 57987144, "question_id": 57985610, "link": "https://stackoverflow.com/questions/57985610/is-there-a-way-to-click-a-td-element-where-both-id-and-name-is-present-using-v/57987144#57987144", "title": "Is there a way to click a &lt;td&gt; element where both id and name is present using vba ( it is a search button)", "body": "<p>4 of things</p>\n\n<ol>\n<li>Use ids throughout as faster</li>\n<li>Use a condition based wait after first click (in this case I wait for the parent <code>li</code> class name to change indicating the tab of interest is now active)</li>\n<li>To click on the next element of interest you need to navigate the parent iframe</li>\n<li>Modern browsers (:laughs in the face of IE!) are optimized for <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">css selectors</a> so use those with <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector\" rel=\"nofollow noreferrer\">querySelector</a>)</li>\n</ol>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub PerformClicks()\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate \"https://portal.3gpp.org/#/55931-tdocs\"\n\n        While .Busy Or .readyState &lt;&gt; 4: DoEvents: Wend\n\n        With .document.querySelector(\"#ui-id-2\") 'use id as faster\n            .Click\n            Do\n            Loop Until InStr(.ParentNode.className, \"ui-tabs-active\") &gt; 0 'Loop until tab becomes active\n        End With\n        'handle iframe\n        .document.querySelector(\"#dnn_ctr559_View_ctl00_ctl01_ctr596_ETSIFrame_htmModule\").contentDocument.querySelector(\"#btnSearch\").Click\n        Stop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8496600, "user_type": "registered", "profile_image": "https://graph.facebook.com/1840868575927847/picture?type=large", "display_name": "Samriddh Tuteja", "link": "https://stackoverflow.com/users/8496600/samriddh-tuteja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 57987144, "answer_count": 1, "score": 1, "last_activity_date": 1568791210, "creation_date": 1568784332, "last_edit_date": 1568787461, "question_id": 57985610, "link": "https://stackoverflow.com/questions/57985610/is-there-a-way-to-click-a-td-element-where-both-id-and-name-is-present-using-v", "title": "Is there a way to click a &lt;td&gt; element where both id and name is present using vba ( it is a search button)", "body": "<p>I am trying to click a button through VBA. Inspect element shows this:                                               </p>\n\n<pre><code>    &lt;/td&gt;\n&lt;input name=\"btnSearch\" id=\"btnSearch\" style=\"width: 150px;\" type=\"submit\" value=\"Search\"&gt; \n</code></pre>\n\n<p>I have tried the below code. I am able to click the element <code>tdocs</code> but not able to click on the click <code>btnSearch</code> .</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Dim i As Integer\n    Dim IE As New SHDocVw.InternetExplorer\n    Dim HTMLDoc As MSHTML.HTMLDocument\n    Dim HTMLInput As MSHTML.IHTMLElement\n    Dim HTMLAs As MSHTML.IHTMLElementCollection\n    Dim HTMLA As MSHTML.IHTMLElement\n    Dim SearchButton As Object\n    Dim tdocs As Object\n    Dim elements As Object\n    Dim element As Object          \n\n    IE.Visible = True\n    IE.navigate \"https://portal.3gpp.org/#55931-tdocs\"\n\n    Do While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    Loop\n\n    Set HTMLDoc = IE.Document\n    Set tdocs = HTMLDoc.getElementsByName(\"lt-55931-tdocs\")\n    tdocs(0).Click\n\n    Application.Wait (Now + TimeValue(\"0:00:03\"))'03sec\n\n    Set elements = IE.Document.getElementsByTagName(\"input\")\n    For Each element In elements\n        On Error Resume Next \n        If element.ID = \"btnSearch\" Then\n            element.Click\n            Exit For\n        End If\n    Next element\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1568783268, "post_id": 57985403, "comment_id": 102379147, "body": "For starters, <code>Rows.Count</code> should be a qualified reference: <code>purchfcst.Rows.Count</code> or it just refers to the active worksheet instead of the one you are assuming it refers to."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1568783431, "post_id": 57985403, "comment_id": 102379182, "body": "Then make sure <code>datalastrow</code> does not equal zero, and remove the <code>On Error Resume Next</code> and set a break point at the first line, and step thru it line by line, checking the values of your variables as you go."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1568783632, "post_id": 57985403, "comment_id": 102379235, "body": "You have a period where there should be a comma <code>VLookup(cofws.Range(&quot;A&quot; &amp; x).Value, datarng, 2, False)</code>"}, {"owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "edited": false, "score": 0, "creation_date": 1568783636, "post_id": 57985403, "comment_id": 102379237, "body": "how do i check the datalastrow does not equal zero?"}, {"owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "edited": false, "score": 0, "creation_date": 1568783791, "post_id": 57985403, "comment_id": 102379283, "body": "hi tim, even with the comma i still get the same error"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1568784560, "post_id": 57985403, "comment_id": 102379501, "body": "You did not declared the value of &#39;datalastrow&#39; anywhere, that is the main problem."}, {"owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "edited": false, "score": 0, "creation_date": 1568786205, "post_id": 57985403, "comment_id": 102380016, "body": "sorry i&#39;m new to vba, how would i declare the value of the datalastrow?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1568787738, "post_id": 57985403, "comment_id": 102380565, "body": "You need to assign it a value as you have done for <code>purchlastrow</code> etc."}], "owner": {"reputation": 1, "user_id": 6403591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fb851288cf522a8610b074d5e7c87c?s=128&d=identicon&r=PG&f=1", "display_name": "C MIN", "link": "https://stackoverflow.com/users/6403591/c-min"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568796222, "creation_date": 1568783103, "last_edit_date": 1568796222, "question_id": 57985403, "link": "https://stackoverflow.com/questions/57985403/runtime-error-1004-method-range-of-object-worksheet-failed", "title": "runtime error 1004. method range of object worksheet failed", "body": "<p>I'm getting a </p>\n\n<blockquote>\n  <p>run-time error '1004': method 'range'of object'_worksheet'failed</p>\n</blockquote>\n\n<p>I'm assuming it is the line where it is </p>\n\n<pre><code>Set datarng = purchfcst.Range(\"A2:Q\" &amp; datalastrow)\n</code></pre>\n\n<p>I'm unsure as what the error as I can't see an error with this</p>\n\n<pre><code>Sub updatepacksizecostandorders()\n\nDim cofws As Worksheet, purchfcst As Worksheet\nDim coflastrow As Long, purchlastrow As Long\nDim datarng As Range\n\n\nSet cofws = ThisWorkbook.Worksheets(\"COF Replen\")\nSet purchfcst = ThisWorkbook.Worksheets(\"purchase forecast\")\n\ncoflastrow = cofws.Range(\"G\" &amp; Rows.Count).End(xlUp).Row\npurchlastrow = purchfcst.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nSet datarng = purchfcst.Range(\"A2:Q\" &amp; datalastrow)\n\nFor x = 2 To coflastrow\n    On Error Resume Next\n    cofws.Range(\"G\" &amp; x).Value = Application.WorksheetFunction.VLookup(cofws.Range(\"A\" &amp; x).Value.datarng, 2, False)\n\n\nNext x\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1568784911, "post_id": 57985184, "comment_id": 102379602, "body": "What do you mean by &#39;crashing&#39; - is there an error message? Step debug."}, {"owner": {"reputation": 1, "user_id": 12082777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0541588b235cd4204854fb6ac5be87d?s=128&d=identicon&r=PG&f=1", "display_name": "VishalG", "link": "https://stackoverflow.com/users/12082777/vishalg"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568891011, "post_id": 57985184, "comment_id": 102423276, "body": "The error I get is Run-time error &#39;3421&#39;. Data type conversion error. I have found that the last row in the second sheet is partly empty with only its first cell having a value (blank)"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568923416, "post_id": 57985184, "comment_id": 102440013, "body": "You should edit question to include that info."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568923981, "post_id": 57985184, "comment_id": 102440240, "body": "I am confused. First cell has what kind of value? Code already tests for empty string and should terminate when encountered."}, {"owner": {"reputation": 1, "user_id": 12082777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0541588b235cd4204854fb6ac5be87d?s=128&d=identicon&r=PG&f=1", "display_name": "VishalG", "link": "https://stackoverflow.com/users/12082777/vishalg"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568969731, "post_id": 57985184, "comment_id": 102452460, "body": "52\t315.44\t282.62\t4311\t1680 53\t305.68\t272.86\t4311\t1680 59\t291.8\t260.48\t4311\t1600 60\t296.71\t265.39\t4311\t1600 (blank)"}, {"owner": {"reputation": 1, "user_id": 12082777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0541588b235cd4204854fb6ac5be87d?s=128&d=identicon&r=PG&f=1", "display_name": "VishalG", "link": "https://stackoverflow.com/users/12082777/vishalg"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568969819, "post_id": 57985184, "comment_id": 102452514, "body": "I just tried to paste part of the excel data and it has not formatted correctly here, sorry. Maybe copy my previous comment to an excel sheet"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568972096, "post_id": 57985184, "comment_id": 102453702, "body": "Edit your question to show data there, not in comment."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1568974355, "post_id": 57985184, "comment_id": 102454971, "body": "I tested loop reading values from Excel. It terminates when empty cell is encountered."}], "owner": {"reputation": 1, "user_id": 12082777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0541588b235cd4204854fb6ac5be87d?s=128&d=identicon&r=PG&f=1", "display_name": "VishalG", "link": "https://stackoverflow.com/users/12082777/vishalg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568781578, "creation_date": 1568781535, "last_edit_date": 1568781578, "question_id": 57985184, "link": "https://stackoverflow.com/questions/57985184/vba-excel-to-access-with-certain-criteria", "title": "vba excel to access with certain criteria", "body": "<p>I would like to create an access vba that imports excel data. Given that I am just starting out in vba programming I am only able to piece various codes together to make the final code. I have researched this a bit but haven't found anything that works for me. I will do my best to explain the conditions I have.</p>\n\n<p>The access database should contain the vba code. It does have a couple of tables each have primary keys generated by access. The table names contain spaces so I have \"01 Cutlist\", \"04 Panel_Data\" and \"08 Pallets\". I need the data imported from two different workbooks meaning the first two tables get their data from one workbook while the last one will get its data from another. The data in excel are placed in the same order as the access table except for the primary key. Excel does not have a primary key column. The excel data starts at cell A7, A10 and A5 respectively. Another issue is that the column headers in excel do not always match the access table headers</p>\n\n<p>I have had some success using the code from <a href=\"http://www.accessmvp.com/KDSnell/EXCEL_Import.htm\" rel=\"nofollow noreferrer\">http://www.accessmvp.com/KDSnell/EXCEL_Import.htm</a>. But my code keeps crashing. Following is the code I have so far</p>\n\n<pre><code>Sub E2A()\nDim xlx As Object, xlw As Object\nDim blnEXCEL As Boolean\nblnEXCEL = False\n\nOn Error Resume Next\nSet xlx = GetObject(, \"Excel.Application\")\nIf Err.Number &lt;&gt; 0 Then\n      Set xlx = CreateObject(\"Excel.Application\")\n      blnEXCEL = True\nEnd If\nErr.Clear\nOn Error GoTo 0\n\nxTab = \"Step 1 - Cutlist\"\naTab = \"01 Cutlist\"\nsCell = \"A7\"\noFile = \"_cutlist.xlsx\"\na = E2A_Loop(xlx, xlw, xTab, aTab, sCell, oFile)\n\nxTab = \"Step 4 - Panel Mass\"\naTab = \"04 Panel_Data\"\nsCell = \"A10\"\noFile = \"_cutlist.xlsx\"\na = E2A_Loop(xlx, xlw, xTab, aTab, sCell, oFile)\nIf blnEXCEL = True Then xlx.Quit\nSet xlx = Nothing\nEnd Sub\n\nFunction E2A_Loop(xlx, xlw, xTab, aTab, sCell, oFile)\nDim lngColumn As Long\nDim xls As Object, xlc As Object\nDim dbs As DAO.Database\nDim rst As DAO.Recordset\nDim blnEXCEL As Boolean\nblnEXCEL = False\n\nxlx.Application.ScreenUpdating = False\nxlx.Visible = False\nSet dbs = CurrentDb()\nSet xlw = xlx.Workbooks.Open(CurrentProject.Path &amp; \"\\\" &amp; Left(Application.CurrentProject.Name, 6) &amp; oFile, , True) ' opens in read-only mode\nSet xls = xlw.Worksheets(xTab)\nSet xlc = xls.Range(sCell) ' this is the first cell that contains data\n\n'Delete all records\nstrSQL = \"Delete * From [\" &amp; aTab &amp; \"]\"\ndbs.Execute (strSQL)\n\nSet rst = dbs.OpenRecordset(aTab, dbOpenDynaset, dbAppendOnly)\n\n' write data to the recordset\nDo While xlc.Value &lt;&gt; \"\"\n      rst.AddNew\n            For lngColumn = 0 To rst.Fields.Count - 2\n                rst.Fields(lngColumn + 1).Value = xlc.Offset(0, lngColumn).Value\n            Next lngColumn\n      rst.Update\n      Set xlc = xlc.Offset(1, 0)\nLoop\n\nrst.Close\nSet rst = Nothing\n\ndbs.Close\nSet dbs = Nothing\n\n' Close the EXCEL file without saving the file, and clean up the EXCEL objects\nSet xlc = Nothing\nSet xls = Nothing\nxlw.Close False\nSet xlw = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 1, "creation_date": 1568790086, "post_id": 57984608, "comment_id": 102381582, "body": "Your code works well."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1568791705, "post_id": 57984608, "comment_id": 102382404, "body": "Cannot reproduce so VTC as off topic"}], "owner": {"reputation": 125, "user_id": 11364115, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ud5UbI0w26E/AAAAAAAAAAI/AAAAAAAABWg/dUMVCKOXSQ4/photo.jpg?sz=128", "display_name": "Eduardo Gonzalez", "link": "https://stackoverflow.com/users/11364115/eduardo-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568786335, "creation_date": 1568776941, "last_edit_date": 1568786335, "question_id": 57984608, "link": "https://stackoverflow.com/questions/57984608/vba-excel-problems-with-the-current-date", "title": "Vba Excel, Problems with the current date", "body": "<p>I am searching for the date at the time of opening my document, in which I sent the document by mail, but days later I printed a date that does not match the current one. And it prints the date on which I send this document</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>Sub GetCurrentDate()\n    Dim S$\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"http://www.fechadehoy.com/venezuela\", False\n        .send\n        S = .responseText\n    End With\n\n    With CreateObject(\"htmlfile\")\n        .body.innerHTML = S\n        ConjuntoB = .getElementById(\"fecha\").innerText\n    End With\nEnd Sub\n</code></pre>\n\n<p>Is there any way this does not happen? And daily can I extract the date from the web?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1568768997, "post_id": 57983732, "comment_id": 102376355, "body": "You are comparing a <code>String</code> value (from <code>InputBox</code>) to an actual <code>Date</code> value - that does not work - you have to convert the string to a date value."}, {"owner": {"reputation": 21, "user_id": 11827982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c017e22cc0c56ae77b7f8ea29aeb068f?s=128&d=identicon&r=PG&f=1", "display_name": "QuickAccount", "link": "https://stackoverflow.com/users/11827982/quickaccount"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1568770362, "post_id": 57983732, "comment_id": 102376611, "body": "Really ? Because when I have just  <code>Do Until IsDate(DateOfJob) DateOfJob = InputBox(&quot;What is the date the work is to be carried out on ? DD&#47;MM&#47;YYYY&quot;) Loop  </code> It works fine."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568771636, "post_id": 57983732, "comment_id": 102376833, "body": "Don&#39;t you mean to loop <i>while</i> the input is a date?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1568771946, "post_id": 57983732, "comment_id": 102376887, "body": "<code>IsDate</code> evaluates a <code>String</code> to see if it can be converted to a date, it doesnt mean that it is a date variable. use <code>CDate()</code> to actually convert it to a date."}, {"owner": {"reputation": 21, "user_id": 11827982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c017e22cc0c56ae77b7f8ea29aeb068f?s=128&d=identicon&r=PG&f=1", "display_name": "QuickAccount", "link": "https://stackoverflow.com/users/11827982/quickaccount"}, "edited": false, "score": 0, "creation_date": 1568772137, "post_id": 57983732, "comment_id": 102376915, "body": "No, I do mean <code>Do Until</code>.  This creates the loop will continue until that the value of <code>DateOfJob</code> (which is given by the <code>InputBox</code>) is a recognised date format."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1568774947, "creation_date": 1568774947, "answer_id": 57984376, "question_id": 57983732, "link": "https://stackoverflow.com/questions/57983732/how-to-fix-loop-error-when-using-nestled-if/57984376#57984376", "title": "How to fix Loop Error, when using nestled If", "body": "<p>The length of the input string makes no difference: either you're looking at a date, or you're not: you want the rest of your code to work with the <code>Date</code> value, not the <code>String</code> representation that the user provided.</p>\n\n<p>See if this works for you:</p>\n\n<pre><code>Public Function GetValidDate() As Variant '/Date\n\n    Dim isValid As Boolean\n    Do While Not isValid\n\n        Dim userInput As Variant\n        userInput = VBA.InputBox(...)\n\n        ' if user cancelled the prompt; we better not prompt again:\n        If VarType(userInput) = vbBoolean Then \n            'if we don't assign the result, we yield a Variant/Empty:\n            Exit Function\n        End If\n\n        If IsDate(userInput) Then\n            Dim dateValue As Date\n            dateValue = CDate(userInput) '&lt;~ we know it's valid at this point\n            isValid = dateValue &gt; VBA.DateTime.Date\n        End If\n\n    Loop\n\n    GetValidDate = dateValue\n\nEnd Function\n</code></pre>\n\n<p>Use:</p>\n\n<pre><code>'NOTE: As Date would be a *type mismatch* error if GetValidDate is Variant/Empty.\nDim jobStartDate As Variant \njobStartDate = GetValidDate\nIf Not IsDate(jobStartDate) Then Exit Sub\n</code></pre>\n\n<p>Don't trap the user into a loop they can't get out of without providing a valid input value - an <code>InputBox</code> has a <kbd>Cancel</kbd> button, and the user will expect it to <em>cancel</em> the operation: don't deny them that ability - gracefully handle it instead.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11827982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c017e22cc0c56ae77b7f8ea29aeb068f?s=128&d=identicon&r=PG&f=1", "display_name": "QuickAccount", "link": "https://stackoverflow.com/users/11827982/quickaccount"}, "is_accepted": false, "score": 0, "last_activity_date": 1568778470, "creation_date": 1568778470, "answer_id": 57984826, "question_id": 57983732, "link": "https://stackoverflow.com/questions/57983732/how-to-fix-loop-error-when-using-nestled-if/57984826#57984826", "title": "How to fix Loop Error, when using nestled If", "body": "<p>Thanks for everyone's input.</p>\n\n<p>I went with Mathieu Guindon solution in the end, and just modified it slightly.\nNice little bit of code he wrote :)</p>\n\n<pre><code>Do While Not isValid\n  Dim userInput As Variant\n    userInput = VBA.InputBox(\"What is the date the work is to be carried out on ? DD/MM/YYYY\")\n    ' if user cancelled the prompt; we better not prompt again:\n    If VarType(userInput) = vbBoolean Then\n      'if we don't assign the result, we yield a Variant/Empty:\n      End\n    End If\n\n    If IsDate(userInput) Then\n      Dim dateValue As Date\n      dateValue = CDate(userInput) '&lt;~ we know it's valid at this point\n      isValid = dateValue &gt; VBA.DateTime.Date\n    End If\n  DateOfJob = dateValue\nLoop\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11827982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c017e22cc0c56ae77b7f8ea29aeb068f?s=128&d=identicon&r=PG&f=1", "display_name": "QuickAccount", "link": "https://stackoverflow.com/users/11827982/quickaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 57984376, "answer_count": 2, "score": 0, "last_activity_date": 1568778470, "creation_date": 1568768858, "question_id": 57983732, "link": "https://stackoverflow.com/questions/57983732/how-to-fix-loop-error-when-using-nestled-if", "title": "How to fix Loop Error, when using nestled If", "body": "<p>I have written a piece of code, that is meant to check if the value entered is a date or not. That part works fine, but when I added what I thought would have been some validation (such as length of the string entered and if the date was before or today) it becomes an infinite loop that I can not escape.</p>\n\n<p>I have tried the code with out the loop, and it behaves as expected, however when I combine the two the infinite loop returns.</p>\n\n<pre><code>'Checks if the value entered is in a 10 digit date format, after today\nDo Until IsDate(DateOfJob)\n  DateOfJob = InputBox(\"What is the date the work is to be carried out on ? DD/MM/YYYY\")\n    If Len(DateOfJob) &lt;&gt; 10 Then\n     DateOfJob = \"NotEnoughCharacters\"\n    ElseIf DateOfJob &lt;= Date Then\n     DateOfJob = \"Today\"\n    End If\nLoop\n</code></pre>\n\n<p>I would have expected that the code would have entered the loop, collected the value DateOfJob, then run the test to see if it was</p>\n\n<ol>\n<li>Exactly 10 characters long</li>\n<li>Before or today's date</li>\n</ol>\n\n<p>At any point, if it did not pass those two tests, the DateOfJob would be give a text value, which would cause the final IsDate test to fail.</p>\n\n<p>However, I feel it is being passed text regardless of what is entered, and therefor failing the test completely.</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568769235, "post_id": 57983437, "comment_id": 102376403, "body": "Can you <a href=\"https://stackoverflow.com/posts/57983437/edit\">edit</a> your question with the exact VBA you&#39;re using?"}, {"owner": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568772263, "post_id": 57983437, "comment_id": 102376930, "body": "Hi BigBen, do the photos help?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "edited": false, "score": 0, "creation_date": 1568772236, "post_id": 57983837, "comment_id": 102376925, "body": "Thanks chris neilsen, does the photos help? Would it be the same code? I tried entering what you provided but it didnt seem to work"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "edited": false, "score": 0, "creation_date": 1568776435, "post_id": 57983837, "comment_id": 102377681, "body": "@kays23 <i>it didnt seem to work</i> is of no use as an error description.  <i>What</i> didn&#39;t work? _What actually happened?  If you select cell <code>D12</code> and run the macro, you will get exactly the result in your image."}, {"owner": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "edited": false, "score": 0, "creation_date": 1568783500, "post_id": 57983837, "comment_id": 102379200, "body": "I copied and pasted your VBA code and changed the active cell to ActiveCell.Select. This resulted in a run error and &#39;object required&#39; message with &#39;Set rFormula = ActiveCell&#39; line highlited. Whats the solution for this? Thanks for your help"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "edited": false, "score": 0, "creation_date": 1568792783, "post_id": 57983837, "comment_id": 102382965, "body": "@key23 <i>whats the solution</i>? Don&#39;t do that - copy the code as is. Adding <code>.Select</code>  is not required, and obviously harmful"}, {"owner": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "edited": false, "score": 0, "creation_date": 1568935767, "post_id": 57983837, "comment_id": 102443287, "body": "chris neilsen thank you so much mate! Really Appreciate it."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "edited": false, "score": 0, "creation_date": 1568936027, "post_id": 57983837, "comment_id": 102443329, "body": "@kays23 Glad to help.  Since you are new, I suggest you read <a href=\"https://stackoverflow.com/help/no-one-answers\">this</a>"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1568770160, "creation_date": 1568770160, "answer_id": 57983837, "question_id": 57983437, "link": "https://stackoverflow.com/questions/57983437/making-the-criteria-in-a-sumif-function-relative-to-the-active-cell/57983837#57983837", "title": "Making the criteria in a SUMIF function relative to the active cell", "body": "<p>Declare and set <code>Range</code> variables to the various ranges you require, then build the formula from those variables <code>.Address</code> properties.  Use the various parameters of <code>Address</code> to set the required Absolute/Relative addressing and External references</p>\n\n<pre><code>Sub EnterSum()\n    Dim rCritera As Range\n    Dim rCriteriaRange As Range\n    Dim rSum As Range\n    Dim rFormula As Range\n\n\n    Set rCriteriaRange = ActiveSheet.Columns(3)\n    Set rCritera = ActiveCell.Offset(-1, -1)\n    Set rSum = ActiveCell.EntireColumn\n\n    Set rFormula = ActiveCell 'Q doesn't specify this cell, so adjust as needed\n\n    rFormula.Formula = \"=SumIf(\" &amp; rCriteriaRange.Address(1, 1) &amp; \",\" &amp; rCritera.Address(1, 1) &amp; \",\" &amp; rSum.Address(0, 0) &amp; \")\"\n\nEnd Sub\n</code></pre>\n\n<p>Example: if ActiveCell is <code>D5</code>  then result is <code>=SUMIF($C:$C,$C$4,D:D)</code>  </p>\n"}], "owner": {"reputation": 13, "user_id": 12082222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29bddcd912add84d4608524028573d73?s=128&d=identicon&r=PG&f=1", "display_name": "kays23", "link": "https://stackoverflow.com/users/12082222/kays23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568772176, "creation_date": 1568765724, "last_edit_date": 1568772176, "question_id": 57983437, "link": "https://stackoverflow.com/questions/57983437/making-the-criteria-in-a-sumif-function-relative-to-the-active-cell", "title": "Making the criteria in a SUMIF function relative to the active cell", "body": "<p><a href=\"https://i.stack.imgur.com/2nz4g.png\" rel=\"nofollow noreferrer\">Here is a simplified version of my data</a>    </p>\n\n<p><a href=\"https://i.stack.imgur.com/Qan6N.png\" rel=\"nofollow noreferrer\">Here is the formula I am entering</a></p>\n\n<p>In D22 I need to enter the same SUMIF formula but the criteria is `ActiveCell.Offset(-1, -1)'. How can I create this macro? I have close to 570 rows and data similar and need to condense the dates into just one.</p>\n\n<p>Thanks</p>\n\n<p>I expect the macro to be able to input the sumif formula referencing the range as column $C, the criteria as <code>$ActiveCell.Offset$(-1,-1)</code> and the sum range as the column of the active cell so D but not locked as the sum range will change.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568776882, "post_id": 57983266, "comment_id": 102377763, "body": "Two ways I can think of <b>[1.]</b> Search the entire document and after <code>If .Find.Found Then</code> check if the page number of the selection (<code>Selection.Information(wdActiveEndPageNumber)</code>) is <code>&gt;=5</code> <b>[2.]</b> Select the word range from page 5 till the end of document and search that. For example see <a href=\"https://stackoverflow.com/questions/31697918/word-vba-select-whole-document-minus-first-page\">THIS</a> on how to select the range of specific pages"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568777185, "post_id": 57983266, "comment_id": 102377817, "body": "Third way <b>[3.]</b> Open word document. Delete text from page 1 to page 4. Search text in the entire document. Close word document <code>without</code> saving."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568785255, "post_id": 57983266, "comment_id": 102379712, "body": "Tried option 1 and 3, please see above in the code what I&#39;ve tried"}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568786100, "post_id": 57983266, "comment_id": 102379979, "body": "Here seems to be the issue With wdDoc.StoryRanges(wdMainTextStory) as it is targeting everything and I tried to delete the 5th page, got type mismatch, and I selected WORD 16, from Excel in Tools&gt;References would really appreciate if someone could help out a bit"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568791210, "post_id": 57983266, "comment_id": 102382117, "body": "Ok let me give you an example of option 1. Gimme 15-20 mins"}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1568791377, "post_id": 57983266, "comment_id": 102382219, "body": "Cool ! Sure, thank you ! Would really appreciate if you could do it on the above code."}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568798581, "post_id": 57987743, "comment_id": 102386165, "body": "Thanks a lot ! That&#39;s great, now the problem is that I  have to readjust it a bit, please have a look above at the edited code that I have provided. The Excel VBA has to search for a keyword in the Word Document starting from page  5 onwards until the end of the Word Document. Once the specific keyword is found, it should target the 1st encountered table and copy some cells from it back to Excel."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568804186, "post_id": 57987743, "comment_id": 102389335, "body": "<code>Once the specific keyword is found, it should target the 1st encountered table and copy some cells from it back to Excel.</code> This warrants a new question. Feel free to ask a new question and post the link here."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568806081, "post_id": 57987743, "comment_id": 102390417, "body": "Cheers, really much appreciated ! Below is the link <a href=\"https://stackoverflow.com/questions/57991687/search-in-word-doc-from-page-5-onwards-find-specific-word-and-copy-from-the-1st\" title=\"search in word doc from page 5 onwards find specific word and copy from the 1st\">stackoverflow.com/questions/57991687/&hellip;</a>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1568793377, "creation_date": 1568793377, "answer_id": 57987743, "question_id": 57983266, "link": "https://stackoverflow.com/questions/57983266/vba-search-within-page-range-in-word/57987743#57987743", "title": "VBA Search within page range in Word", "body": "<p>In the comments above, I mentioned 3 ways to achieve what you want. I am sure there are other ways as well to skin a cat. </p>\n\n<p>Here is an example (<strong>Option 1</strong>) on how to search for a text from page <code>5</code> onwards. I have commented the code. Still if you do not understand then feel free to leave a comment and if I can reply, I will.</p>\n\n<pre><code>Option Explicit\n\nConst wdMainTextStory As Integer = 1\nConst wdActiveEndPageNumber As Integer = 3\nConst wdStory As Integer = 6\nConst wdFindContinue As Integer = 1\n\nSub Sample()\n    Dim oWordApp As Object, oWordDoc As Object\n    Dim pgNo As Long\n    Dim FlName As String\n    Dim SearchText As String\n    Dim IopenedWord As Boolean\n\n    '~~&gt; Establish an Word application object\n    On Error Resume Next\n    Set oWordApp = GetObject(, \"Word.Application\")\n\n    If Err.Number &lt;&gt; 0 Then\n        Set oWordApp = CreateObject(\"Word.Application\")\n        IopenedWord = True\n    End If\n    Err.Clear\n    On Error GoTo 0\n\n    oWordApp.Visible = True\n\n    '~~&gt; Sample File\n    FlName = \"C:\\Users\\routs\\Desktop\\Sample.Docm\"\n\n    Set oWordDoc = oWordApp.Documents.Open(FlName)\n\n    '~~&gt; Search Text. Change as applicable\n    SearchText = \"Siddharth\"\n\n    '~~&gt; Move to the begining of the document\n    oWordDoc.Bookmarks(\"\\StartOfDoc\").Select\n\n    oWordApp.Selection.Find.ClearFormatting\n\n    With oWordApp.Selection.Find\n        .Text = SearchText\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n\n        '~~&gt; Loop and find the search text\n        Do While oWordApp.Selection.Find.Execute = True\n            '~~&gt; Get the page number\n            pgNo = oWordApp.Selection.Information(wdActiveEndPageNumber)\n            '~~&gt; Check if the page number is &gt;= 5\n            If pgNo &gt;= 5 Then\n                Debug.Print \"Search text found in page \" &amp; pgNo\n            End If\n        Loop\n    End With\n\n    oWordDoc.Close (False)\n\n    If IopenedWord = True Then oWordApp.Quit\nEnd Sub\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/eqKAm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eqKAm.png\" alt=\"enter image description here\"></a></p>\n\n<p>And if I change</p>\n\n<pre><code>If pgNo &gt;= 5 Then\n    Debug.Print \"Search text found in page \" &amp; pgNo\nEnd If\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Debug.Print \"Search text found in page \" &amp; pgNo\n</code></pre>\n\n<p>Then I get this</p>\n\n<p><a href=\"https://i.stack.imgur.com/iYIdq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iYIdq.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "accepted_answer_id": 57987743, "answer_count": 1, "score": 1, "last_activity_date": 1582095984, "creation_date": 1568763993, "last_edit_date": 1582095984, "question_id": 57983266, "link": "https://stackoverflow.com/questions/57983266/vba-search-within-page-range-in-word", "title": "VBA Search within page range in Word", "body": "<p>I am trying to make the Excel VBA search in a Word Document from page 5 onwards and once it finds the specific keyword it should target just the 1st encountered table and get some cells from the Word Table back to Excel as the code below will display. I am trying to introduce your Option1 in it but at the moment I can't. Any idea why?   </p>\n\n<pre><code> Option Explicit\n\n    Sub Testt()\n\n            Dim ws As Worksheet\n            Dim Selection As Object\n            Dim objWord As Word.Application\n            Dim i As Integer\n            Dim strValue As String\n            Dim wdDoc As Word.Document\n            Dim wdFileName As Variant\n            Dim TableNo As Integer 'table number in Word\n            Dim myTableRange As Word.Range ' formerly variable 'a'\n            Dim oWordApp As Object, oWordDoc As Object\n        Dim pgNo As Long\n        Dim FlName As String\n        Dim SearchText As String\n        Dim IopenedWord As Boolean\n\n\n        Const wdMainTextStory As Integer = 1\n    Const wdActiveEndPageNumber As Integer = 3\n    Const wdStory As Integer = 6\n    Const wdFindContinue As Integer = 1\n\n\n\n\n\n\n\n            Set objWord = New Word.Application\n            Set wdDoc = objWord.Documents.Open(\"C:\\Users\\Nigel\\Desktop\\Testt.docx\")\n\n\n            objWord.Visible = True\n\n\n    With wdDoc.StoryRanges(wdMainTextStory)\n                With .Find\n                    .Forward = True\n                    .ClearFormatting\n                    .MatchWholeWord = True\n                    .MatchCase = True\n                    .Wrap = wdFindContinue\n                    .Text = \"Test\"\n                    .Execute\n\n\n                    Do While objWord.Selection.Find.Execute = True\n                '~~&gt; Get the page number\n                pgNo = objWord.Selection.Information(wdActiveEndPageNumber)\n                '~~&gt; Check if the page number is &gt;= 5\n                If pgNo &gt;= 5 Then\n                    Debug.Print \"Search text found in page \" &amp; pgNo\n                End If\n            Loop\n\n\n\n                End With\n\n\n                If .Find.Found Then\n\n\n                    MsgBox \"Found\"\n                Else\n                    MsgBox \"Not found\"\n                    Exit Sub\n\n\n      End If\n\n                Set myTableRange = .Duplicate.Next(unit:=wdTable)\n\n\n        Dim rowNb As Long\n        Dim ColNb As Long\n        Dim x As Long\n        Dim y As Long\n        x = 8\n        y = 1\n\n        With myTableRange.Tables(1)\n            For rowNb = 1 To 1 '\n                For ColNb = 2 To 2\n\n\n                    Cells(x, y) = WorksheetFunction.Clean(.Cell(rowNb, ColNb).Range.Text)\n\n                    y = y + 1\n                Next ColNb\n\n                y = 1\n                x = x + 1\n            Next rowNb\n        End With\n\n        x = x + 2\n     End With\n\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1568757105, "post_id": 57982396, "comment_id": 102374058, "body": "Use a <code>For</code> loop, step 9."}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 0, "last_activity_date": 1568757203, "creation_date": 1568757203, "answer_id": 57982528, "question_id": 57982396, "link": "https://stackoverflow.com/questions/57982396/excel-vba-to-create-email-when-date-is-entered-into-column-every-9th-row/57982528#57982528", "title": "Excel VBA to create email when date is entered into column every 9th row", "body": "<p>After <code>targetRow = Target.Row</code> run a check to see if it is a 9th row. This can be performed using the Mod function to get the remainder of targetRow divided by 9 (after subtracting 13 of course since you're starting from row 13). Something like</p>\n\n<pre><code>Dim bIsNinthRow as Boolean\nDim ModResult as Long\nbIsNinthRow = False\nModResult = (targetRow - 13) Mod 9\nIf ModResult = 0 Then bIsNinthRow = True\nIf bIsNinthRow Then Call Mail_small_Text_Outlook(targetRow, offsetRow)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12081909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0feaec324db72f17823d105bf88f3217?s=128&d=identicon&r=PG&f=1", "display_name": "trichter90", "link": "https://stackoverflow.com/users/12081909/trichter90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57982528, "answer_count": 1, "score": 0, "last_activity_date": 1568784257, "creation_date": 1568756272, "last_edit_date": 1568784257, "question_id": 57982396, "link": "https://stackoverflow.com/questions/57982396/excel-vba-to-create-email-when-date-is-entered-into-column-every-9th-row", "title": "Excel VBA to create email when date is entered into column every 9th row", "body": "<p>I'm fairly new to VBA, but hoping someone may be able to assist me. \nI've got things working the way I'd like. However, it appears to be running on all rows in column K for K13:K5000. How can I make this code only run for every 9th row after K13?</p>\n\n<p>Here's what I've got working thus far. </p>\n\n<pre><code>Dim xRg As Range\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    On Error Resume Next\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If Not Intersect(Target, Range(\"K13:K5000\")) Is Nothing Then\n            If IsDate(Target.Value) And Target.Value &gt; 0 Then\n               targetRow = Target.Row\n               offsetRow = Target.Offset(9, 0).Row\n               Call Mail_small_Text_Outlook(targetRow, offsetRow)\n            End If\n    End If\n\nEnd Sub\nSub Mail_small_Text_Outlook(targetRow, offsetRow)\n    Dim xOutApp As Object\n    Dim xOutMail As Object\n    Dim xMailBody As String\n    Set xOutApp = CreateObject(\"Outlook.Application\")\n    Set xOutMail = xOutApp.CreateItem(0)\n    xMailBody = \"Hello\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"This client is now Committed &amp; Complete and ready for your attention\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"Renew As Is?\" &amp; vbNewLine &amp; _\n              \"Adding Changing Groups?\"\n\n\n    On Error Resume Next\n    With xOutMail\n        .To = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Committed &amp; Complete\"\n        .Body = xMailBody\n        .Display   \n    End With\n    On Error GoTo 0\n    Set xOutMail = Nothing\n    Set xOutApp = Nothing\nEnd Sub\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1568755003, "post_id": 57982141, "comment_id": 102373443, "body": "<i>Is it possible to copy all highlighted cells in column A and paste those values onto column B?</i> - Yes, it is."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1568815871, "post_id": 57982434, "comment_id": 102396089, "body": "Hmmmm... I ran it, but it&#39;s not pasting to column B. Any thoughts?"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "reply_to_user": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1568816270, "post_id": 57982434, "comment_id": 102396328, "body": "<code>rng.Offset(i, 1).PasteSpecial xlPasteAll</code> should paste it to column B, but it won&#39;t start at the top of the column. Rather, it will paste the value in column B, in the same row, <code>i</code>,  in which the colored cell was found."}, {"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1568816812, "post_id": 57982434, "comment_id": 102396682, "body": "Is it possible to paste on the top of the column B? When I filter column B, there are no values and this could be due to the number of records, 160k."}, {"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1568821154, "post_id": 57982434, "comment_id": 102399292, "body": "Hmmmm... it works on my smaller dataset &lt; 10, but for my 160k dataset it doesn&#39;t work. Wonder what it could be."}, {"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 1, "creation_date": 1568822125, "post_id": 57982434, "comment_id": 102399864, "body": "So, I highlighted a cell further down on my 160k dataset and the formula works great! I think it&#39;s just the sheer number of records on the file that is causing the issue."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "reply_to_user": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1568829380, "post_id": 57982434, "comment_id": 102402781, "body": "@MSauce try it now. I added <code>application.screenupdating = false</code>. I tested on 160k rows of data, it took about 10 seconds, but it gave me the expected result."}, {"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1568841536, "post_id": 57982434, "comment_id": 102407491, "body": "So, I think I found the issue. Conditionally formatted cells, aren&#39;t treated the same as cells that are highlighted. I tested this by highlighting a cell at row 140k, and your code pasted as intended. I updated the If statement to ....(i, 1).DisplayFormat.Interior.Color = vbYellow.... but it freezes on me :(."}], "tags": [], "owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "is_accepted": false, "score": 2, "last_activity_date": 1568829163, "last_edit_date": 1568829163, "creation_date": 1568756520, "answer_id": 57982434, "question_id": 57982141, "link": "https://stackoverflow.com/questions/57982141/paste-highlighted-cells-to-other-column/57982434#57982434", "title": "Paste Highlighted Cells to Other Column", "body": "<p>You can use a <code>For</code>..<code>Next</code> with an <code>If</code> statement to find the cells that are highlighted. Here, <code>i</code> iterates through cells and if the cell is highlighted, it's pasted into the next column with <code>rng.offset(n,1)</code>. <code>n = n + 1</code> pastes the highlighted value to the next empty row in column B, rather than pasting the value into the same cell repeatedly. Also, <code>application.screenupdating = False</code> makes it more efficient. \nTry This:</p>\n\n<pre><code>Sub copyhighlight()\n\n    Dim rng As Range\n    Set rng = Range(\"A1\", Range(\"A1\").End(xlUp))\n    Dim lastrow As Long\n    lastrow = Range(\"A1\").CurrentRegion.Rows.Count\n\n    Dim i As Long\n    Dim n As Long\n\n    Application.ScreenUpdating = False\n\n    n = 0\n\n    For i = 1 To lastrow\n        If rng.Cells(i, 1).Interior.Color = vbYellow Then\n            rng(i, 1).Copy\n            rng.Offset(n, 1).PasteSpecial xlPasteAll\n            n = n + 1\n        End If\n    Next i\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1568829163, "creation_date": 1568754809, "question_id": 57982141, "link": "https://stackoverflow.com/questions/57982141/paste-highlighted-cells-to-other-column", "title": "Paste Highlighted Cells to Other Column", "body": "<p>I have a conditional format that highlights all duplicate values on column A and would like all highlighted values to be pasted on column B. The issue is, there are 160k rows for the column, and am unable to find what cells are highlighted due to the sheer number of rows. Is it possible to copy all highlighted cells in column A and paste those values onto column B? I attempted to sort by filter color, but the limit is 10,000 rows so if row 10,001 is highlighted, it will not be displayed. </p>\n\n<pre><code>A                B\nabc1           abc1\nabc2           abc1\nabc1              \ntest3                \nabc3\n</code></pre>\n\n<p>I am using this highlight color, not sure what value it is in VBA. <a href=\"https://i.stack.imgur.com/yxlWg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yxlWg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568752366, "post_id": 57981556, "comment_id": 102372471, "body": "The <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/name-statement\" rel=\"nofollow noreferrer\"><code>Name</code> statement</a> actually has the side effect of physically renaming/moving a file on disk -- I doubt it&#39;s redundant."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568752448, "post_id": 57981556, "comment_id": 102372504, "body": "Even though the filepath on either side of the <code>As</code> is identical?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568752499, "post_id": 57981556, "comment_id": 102372517, "body": "Oh, the <code>&quot;C:\\Import TXT files\\&quot;</code> string literal is redundant / should be referring to <code>strFolderPath</code> - but the instruction itself is side-effecting. Wait, what? :facepalm: missed the forest for the tree, sorry"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568753026, "post_id": 57981556, "comment_id": 102372736, "body": "No worries Mathieu - I&#39;ve reworded my answer slightly."}, {"owner": {"reputation": 33, "user_id": 10054520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2b27bbbd317802385e3dcd6f22a6a6?s=128&d=identicon&r=PG&f=1", "display_name": "MyNameHere", "link": "https://stackoverflow.com/users/10054520/mynamehere"}, "edited": false, "score": 0, "creation_date": 1568755442, "post_id": 57981556, "comment_id": 102373587, "body": "That worked MUCH better.  It was still locking up when it was importing but it actually completed everything this time."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 33, "user_id": 10054520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2b27bbbd317802385e3dcd6f22a6a6?s=128&d=identicon&r=PG&f=1", "display_name": "MyNameHere", "link": "https://stackoverflow.com/users/10054520/mynamehere"}, "edited": false, "score": 0, "creation_date": 1568756393, "post_id": 57981556, "comment_id": 102373854, "body": "@MyNameHere Are the text files particularly large?"}, {"owner": {"reputation": 33, "user_id": 10054520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2b27bbbd317802385e3dcd6f22a6a6?s=128&d=identicon&r=PG&f=1", "display_name": "MyNameHere", "link": "https://stackoverflow.com/users/10054520/mynamehere"}, "edited": false, "score": 0, "creation_date": 1568758030, "post_id": 57981556, "comment_id": 102374348, "body": "@LeeMac They&#39;re not large in the sense of disk size, but they each have 800-1500 rows."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 33, "user_id": 10054520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2b27bbbd317802385e3dcd6f22a6a6?s=128&d=identicon&r=PG&f=1", "display_name": "MyNameHere", "link": "https://stackoverflow.com/users/10054520/mynamehere"}, "edited": false, "score": 0, "creation_date": 1568758572, "post_id": 57981556, "comment_id": 102374486, "body": "@MyNameHere If there are many files, perhaps add <code>DoEvents</code> after the <code>DoCmd</code> line as this will momentarily pass control back to the OS and should avoid the &quot;not responding&quot; warning you receive if the OS does not receive feedback from the application in 5 seconds."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1568752981, "last_edit_date": 1568752981, "creation_date": 1568751670, "answer_id": 57981556, "question_id": 57981479, "link": "https://stackoverflow.com/questions/57981479/access-code-is-causing-program-to-lock-up-and-not-responding/57981556#57981556", "title": "Access code is causing program to lock up and not responding?", "body": "<p>After a cursory review of your code, I see no reason why it would cause MS Access to lock up, which would typically be caused by code executing a loop which never met a terminating condition (however, a <code>For Each</code> loop is iterating over a fixed set of data and will therefore always terminate).</p>\n\n<p>I would note that the following line is redundant:</p>\n\n<pre><code>Name strFolderPath &amp; objF1.Name As \"C:\\Import TXT files\\\" &amp; objF1.Name\n</code></pre>\n\n<p>Since earlier in the code you define <code>strFolderPath</code> as:</p>\n\n<pre><code>strFolderPath = \"C:\\Import TXT files\\\"\n</code></pre>\n\n<p>Hence, you are renaming the file to itself.</p>\n\n<p>The code is also na\u00efvely testing the last three characters of the filename, which may not necessarily yield an extension if you were to encounter a file without an extension.</p>\n\n<hr>\n\n<p>The code could be written without using the FSO and without the <code>if</code> statement altogether, as VBA offers the <a href=\"https://support.office.com/en-us/article/dir-function-1a1a4275-f92f-4ae4-8b87-41e4513bba2e\" rel=\"nofollow noreferrer\"><code>Dir</code></a> function as standard to iterate over files of a particular type in a directory, e.g.:</p>\n\n<pre><code>Sub test()\n    Dim strDir As String: strDir = \"C:\\Import TXT files\"\n    Dim strTxt As String: strTxt = Dir(strDir &amp; \"\\*.txt\")\n\n    Do Until strTxt = vbNullString\n        DoCmd.TransferText acImportDelim, \"TextImportSpecs\", \"tblImportedFiles\", strDir &amp; \"\\\" &amp; strTxt, False\n        strTxt = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10054520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2b27bbbd317802385e3dcd6f22a6a6?s=128&d=identicon&r=PG&f=1", "display_name": "MyNameHere", "link": "https://stackoverflow.com/users/10054520/mynamehere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 57981556, "answer_count": 1, "score": 0, "last_activity_date": 1594449330, "creation_date": 1568751318, "last_edit_date": 1594449330, "question_id": 57981479, "link": "https://stackoverflow.com/questions/57981479/access-code-is-causing-program-to-lock-up-and-not-responding", "title": "Access code is causing program to lock up and not responding?", "body": "<p>I copied this code from a differen website to try and help me import multiple text files at once.  I changed filepaths, text specs, and the table to what I need.  Now every time I try to run this is locks up and doesn't respond.</p>\n\n<p>Is there an issue with having too many text files or too much data?  How come its causing my program to lock up?</p>\n\n<pre><code>Public Sub WorkedAlertsImport()\nOn Error GoTo bImportFiles_Click_Err\n\nDim objFS As Object, objFolder As Object\nDim objFiles As Object, objF1 As Object\nDim strFolderPath As String\n\nstrFolderPath = \"C:\\Import TXT files\\\"\nSet objFS = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFS.GetFolder(strFolderPath)\nSet objFiles = objFolder.files\n\nFor Each objF1 In objFiles\n    If Right(objF1.Name, 3) = \"txt\" Then\n        DoCmd.TransferText acImportDelim, \"TextImportSpecs\", \"tblImportedFiles\", strFolderPath &amp; objF1.Name, False\n        Name strFolderPath &amp; objF1.Name As \"C:\\Import TXT files\\\" &amp; objF1.Name 'Move the files to the archive folder\n    End If\nNext\n\nSet objF1 = Nothing\nSet objFiles = Nothing\nSet objFolder = Nothing\nSet objFS = Nothing\n\nbImportFiles_Click_Exit:\nExit Sub\n\nbImportFiles_Click_Err:\nMsgBox Err.Number &amp; \" \" &amp; Err.Description\nResume bImportFiles_Click_Exit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1568764068, "post_id": 57981409, "comment_id": 102375560, "body": "Strange that the pivot cache update didn&#39;t solve this.  Out of curiosity, does adding <code>ThisWorkbook.RefreshAll</code> to the end of your macro have any effect?"}, {"owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "reply_to_user": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1568819376, "post_id": 57981409, "comment_id": 102398268, "body": "@ChrisB I tried this - it resulted in the same &quot;applied filter&quot; but no actual data filtering within the table."}], "answers": [{"tags": [], "owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "is_accepted": true, "score": 0, "last_activity_date": 1570469717, "creation_date": 1570469717, "answer_id": 58274528, "question_id": 57981409, "link": "https://stackoverflow.com/questions/57981409/pivot-table-label-filter-is-applied-but-data-does-not-actually-filter/58274528#58274528", "title": "Pivot Table Label Filter Is Applied But Data Does Not Actually Filter", "body": "<p>I was never able to implement a solution that worked by addressing the Pivot Table or Label Filters as originally intended.  My workaround was to avoid the pivot table itself and hide rows based on the criteria I outlined in my original questions (between -10 and 10 to be hidden).  This may not work for others, and is certainly not the cleanest solution, but for my needs, the code below works:    </p>\n\n<pre><code>Sub Filter_Summary_Pivot()\nApplication.ScreenUpdating = False\n\n    Worksheets(\"Summary\").PivotTables(\"Pivot1\").PivotFields(\"Sales\"). _\n    ClearAllFilters\n\n Worksheets(\"Summary\").PivotTables(\"Pivot1\").PivotSelect _\n    \"Sales[All]\", xlLabelOnly, True\n\n'workaround to pivot filters not actioning data - hides rows based on \"isbetween\" logic of values in Sales Column\n\nDim lastrow As Long\nlastrow = Worksheets(\"Summary\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nBeginRow = 5\n  EndRow = lastrow\n  ChkCol = 6\n\nFor RowCnt = BeginRow To EndRow\n    If Worksheets(\"Summary\").Cells(RowCnt, ChkCol).Value &gt; -10 And Worksheets(\"Summary\").Cells(RowCnt, ChkCol).Value &lt; 10 Then\n        Worksheets(\"Summary\").Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n    End If\nNext RowCnt\n\n'secondary \"filter\" to remove \"(Blank)\" values in Sales column of pivot\n\nBeginRow = 5\n  EndRow = lastrow\n  ChkCol = 6\n\nFor RowCnt = BeginRow To EndRow\n    If Worksheets(\"Summary\").Cells(RowCnt, ChkCol).Value = \"(blank)\" Then\n        Worksheets(\"Summary\").Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n    End If\nNext RowCnt\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "accepted_answer_id": 58274528, "answer_count": 1, "score": 2, "last_activity_date": 1570469717, "creation_date": 1568750993, "last_edit_date": 1568823177, "question_id": 57981409, "link": "https://stackoverflow.com/questions/57981409/pivot-table-label-filter-is-applied-but-data-does-not-actually-filter", "title": "Pivot Table Label Filter Is Applied But Data Does Not Actually Filter", "body": "<p>I have a pivot table to which I am attempting to add a label filter to (on a single column) via VBA.</p>\n\n<p>My current code is:</p>\n\n<pre><code>Sub Filter__Pivot()\n\nApplication.ScreenUpdating = False\n\n Worksheets(\"Summary\").PivotTables(\"Pivot1\").PivotFields(\"Sales\"). _\n    ClearAllFilters\n\n Worksheets(\"Summary\").PivotTables(\"Pivot1\").PivotSelect _\n    \"Sales[All]\", xlLabelOnly, True\n\n\n Worksheets(\"Summary\").PivotTables(\"Pivot1\").PivotFields(\"Sales\"). _\n    PivotFilters.Add2 Type:=xlCaptionIsNotBetween, Value1:=\"-10\", Value2:= _\n    \"10\"\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The code runs without error and the pivot has the appearance of the filter being applied.  By this I mean there is the typical filter icon on the column of the pivot I desired.  Clicking on this header icon shows that a label filter has been applied and when I click to the filter itself: Filter in header --> Label Filters --> Not Between ......I see the -10 and 10 in the value fields.  The issue is that the actual data in the pivot table does not reflect the filter - it has not been applied (ie. Values between -10 and 10 are still visible).</p>\n\n<p>I tried macro recording and my syntax matches.  I also tried using <code>Worksheets(\"Summary\").PivotTables(\"Pivot1\").PivotCache.Refresh</code> after the filter is placed but this did not help.</p>\n\n<p>The odd bit, is that if I apply the filter via VBA and then click through as described above, when I click \"Okay\" at the point I see the -10 and 10 on the Not Between filter, the filter then activates and the data in the pivot reflects the filter.</p>\n\n<p>In essence, my filter is being placed onto the pivot table, but it is not \"actioning\" and the pivot table data does not reflect the filter that appears to be active on it.</p>\n\n<p>Thanks all!</p>\n\n<p>UPDATE:</p>\n\n<p>I have created the code below:</p>\n\n<pre><code> With Worksheets(\"Summary\").PivotTables(\"Pivot1\").PivotFields(\"Sales\")\n    For i = 1 To .PivotItems.count\n        If i &gt; -10 And i &lt; 10 Then\n            .PivotItems(i).Visible = False\n        Else\n            .PivotItems(i).Visible = True\n        End If\n    Next i\nEnd With\n</code></pre>\n\n<p>This is not evaluating and filtering based on the values in the Sales Column of my pivot, but it does actually move / filter the data within the table.  Is there a way to perhaps adapt this methodology and loop or work through each pivot line and change the <code>.Visibility</code> based on the value in the Sales Column?</p>\n\n<p>This would be a workaround to using filters entirely, but might achieve what I need.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1568748959, "post_id": 57980875, "comment_id": 102371081, "body": "You can create a counter on your file naming convention."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "edited": false, "score": 0, "creation_date": 1568752931, "post_id": 57980992, "comment_id": 102372702, "body": "When I add these lines, it doesn\u2019t print the attachment at all"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "edited": false, "score": 0, "creation_date": 1568753184, "post_id": 57980992, "comment_id": 102372806, "body": "did you verify that the files are saving under the expected names? Start from the top up. You gotta give me details to get any help. Many things happen before anything should print so start at the top and see where things stop working"}, {"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "edited": false, "score": 0, "creation_date": 1568753880, "post_id": 57980992, "comment_id": 102373049, "body": "How do you see it step by step? F8 seems to be not working in outlook"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 2, "last_activity_date": 1568749318, "last_edit_date": 1568749318, "creation_date": 1568749066, "answer_id": 57980992, "question_id": 57980875, "link": "https://stackoverflow.com/questions/57980875/my-macro-prints-invoices-automatically-but-when-multiple-attachments-are-named-t/57980992#57980992", "title": "My macro prints invoices automatically but when multiple attachments are named the same, it prints only the first one multiple times", "body": "<p>As you stated, created a naming convention to force unique file names among the attachments. This is done here with variable <code>i</code></p>\n\n<pre><code>Dim oAtt As Attachment\nDim i as Long: i = 1\n\nFor Each oAtt In Item.Attachments\n    FileName = oAtt.FileName\n    FullFile = cTmpFld &amp; \"\\\" &amp; FileName &amp; i  '&lt;-- add unique identifier\n    oAtt.SaveAsFile (FullFile)\n\n    '.... More stuff\n\n    i = i + 1  '&lt;-- increment to next unique identifier\nNext oAtt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1568967984, "last_edit_date": 1568967984, "creation_date": 1568967476, "answer_id": 58024492, "question_id": 57980875, "link": "https://stackoverflow.com/questions/57980875/my-macro-prints-invoices-automatically-but-when-multiple-attachments-are-named-t/58024492#58024492", "title": "My macro prints invoices automatically but when multiple attachments are named the same, it prints only the first one multiple times", "body": "<p><em>Try changing the following line</em></p>\n\n<blockquote>\n<pre><code>FileName = oAtt.FileName\n</code></pre>\n</blockquote>\n\n<p><em>To</em> </p>\n\n<blockquote>\n<pre><code>FileName = oAtt.FileName &amp; Format(Now, \" yyyymmddhhmmssms\")\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586078484, "creation_date": 1568748575, "last_edit_date": 1586078484, "question_id": 57980875, "link": "https://stackoverflow.com/questions/57980875/my-macro-prints-invoices-automatically-but-when-multiple-attachments-are-named-t", "title": "My macro prints invoices automatically but when multiple attachments are named the same, it prints only the first one multiple times", "body": "<pre><code>Sub LSPrint(Item As Outlook.MailItem)\n    On Error Resume Next\n    Dim oFS As FileSystemObject\n    Dim sTempFolder As String\n    Set oFS = New FileSystemObject\n\n    sTempFolder = oFS.GetSpecialFolder(TemporaryFolder)\n\n\n    cTmpFld = sTempFolder &amp; \"\\OETMP\" &amp; Format(Now, \"yyyymmddhhmmss\")\n    MkDir (cTmpFld)\n\n\n    Dim oAtt As Attachment\n    For Each oAtt In Item.Attachments\n    FileName = oAtt.FileName\n    FullFile = cTmpFld &amp; \"\\\" &amp; FileName\n\n    oAtt.SaveAsFile (FullFile)\n\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objFolder = objShell.NameSpace(0)\n    Set objFolderItem = objFolder.ParseName(FullFile)\n    objFolderItem.InvokeVerbEx (\"print\")\n\n    Next oAtt\n\n    If Not oFS Is Nothing Then Set oFS = Nothing\n    If Not objFolder Is Nothing Then Set objFolder = Nothing\n    If Not objFolderItem Is Nothing Then Set objFolderItem = Nothing\n    If Not objShell Is Nothing Then Set objShell = Nothing\n    OError:\n        If Err &lt;&gt; 0 Then\n            MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n            Err.Clear\n        End If\n        Exit Sub\nEnd Sub\n</code></pre>\n\n<p>How do I fix this code so that it will print off multiple attachments if they are named the same. </p>\n\n<p>Possibly renaming the files and then printing those ones off.</p>\n"}, {"tags": ["html", "css", "excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568749016, "post_id": 57980783, "comment_id": 102371113, "body": "Have you tried removing the extraneous whitespace, i.e. <code>border=5px</code>? And/or specifying the border styling in the inline style?"}, {"owner": {"reputation": 23, "user_id": 9971068, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gF_gjYsDhBY/AAAAAAAAAAI/AAAAAAAAAE0/IabFy1zAUqM/photo.jpg?sz=128", "display_name": "abishek sai", "link": "https://stackoverflow.com/users/9971068/abishek-sai"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568751575, "post_id": 57980783, "comment_id": 102372164, "body": "No..that didn&#39;t work either."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1568751660, "post_id": 57980783, "comment_id": 102372194, "body": "<a href=\"https://stackoverflow.com/q/16033521/1188513\">Related</a> (if not dupe)"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1568753600, "creation_date": 1568753600, "answer_id": 57981924, "question_id": 57980783, "link": "https://stackoverflow.com/questions/57980783/add-a-table-with-borders-to-email/57981924#57981924", "title": "Add a table with borders to email", "body": "<p>Try adding an important style sheet to the <code>TD</code> elements like this (before the code)</p>\n\n<pre><code>&lt;style&gt; td {border:2px black solid !important} &lt;/style&gt;\n</code></pre>\n\n<p>if you want the border just around the entire <code>TABLE</code> then use this instead</p>\n\n<pre><code>&lt;style&gt; table {border:2px black solid !important} &lt;/style&gt;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9971068, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gF_gjYsDhBY/AAAAAAAAAAI/AAAAAAAAAE0/IabFy1zAUqM/photo.jpg?sz=128", "display_name": "abishek sai", "link": "https://stackoverflow.com/users/9971068/abishek-sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571959428, "creation_date": 1568748146, "last_edit_date": 1571959428, "question_id": 57980783, "link": "https://stackoverflow.com/questions/57980783/add-a-table-with-borders-to-email", "title": "Add a table with borders to email", "body": "<p>I've been using an email macro and one way to add body of the email is HTMLbody.</p>\n\n<p>I want to add a table to the body of email.</p>\n\n<pre><code>&lt;table style=\"width:100%\" border = 5px&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Firstname&lt;/th&gt;\n    &lt;th&gt;Lastname&lt;/th&gt; \n    &lt;th&gt;Age&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Jill&lt;/td&gt;\n    &lt;td&gt;Smith&lt;/td&gt;\n    &lt;td&gt;50&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;Eve&lt;/td&gt;\n    &lt;td&gt;Jackson&lt;/td&gt;\n    &lt;td&gt;94&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n    &lt;td&gt;John&lt;/td&gt;\n    &lt;td&gt;Doe&lt;/td&gt;\n    &lt;td&gt;80&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Once I send, I get email without table borders.</p>\n"}, {"tags": ["python", "excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 27334, "user_id": 7758804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBA7j.jpg?s=128&g=1", "display_name": "Trenton McKinney", "link": "https://stackoverflow.com/users/7758804/trenton-mckinney"}, "edited": false, "score": 3, "creation_date": 1568748316, "post_id": 57980544, "comment_id": 102370803, "body": "Use record macro, in excel, to determine the appropriate vba.  <code>ActiveSheet.PivotTables(&quot;PivotTable1&quot;).DisplayFieldCaptions = False</code>.  Also, the following project of mine, may be useful.  It&#39;s using win32.com for pivot tables in Excel. <a href=\"https://github.com/trenton3983/Excel_Automation_with_Python/tree/master/Pivot_Tables_and_Table\" rel=\"nofollow noreferrer\">Create Pivot Tables and a Regular Table with Python Automation of Excel</a>"}, {"owner": {"reputation": 91, "user_id": 9860852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99d1e963bc19726c3017d064c283876?s=128&d=identicon&r=PG&f=1", "display_name": "jello195", "link": "https://stackoverflow.com/users/9860852/jello195"}, "reply_to_user": {"reputation": 27334, "user_id": 7758804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBA7j.jpg?s=128&g=1", "display_name": "Trenton McKinney", "link": "https://stackoverflow.com/users/7758804/trenton-mckinney"}, "edited": false, "score": 1, "creation_date": 1568750266, "post_id": 57980544, "comment_id": 102371659, "body": "Thanks. It worked :D. Also, I&#39;m surely gonna take a look at your project."}, {"owner": {"reputation": 27334, "user_id": 7758804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UBA7j.jpg?s=128&g=1", "display_name": "Trenton McKinney", "link": "https://stackoverflow.com/users/7758804/trenton-mckinney"}, "edited": false, "score": 0, "creation_date": 1568750423, "post_id": 57980544, "comment_id": 102371720, "body": "The project is specific to my data,  but the Excel file of dummy data, is there in the project, so you can run it."}], "owner": {"reputation": 91, "user_id": 9860852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c99d1e963bc19726c3017d064c283876?s=128&d=identicon&r=PG&f=1", "display_name": "jello195", "link": "https://stackoverflow.com/users/9860852/jello195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1568746959, "creation_date": 1568746959, "question_id": 57980544, "link": "https://stackoverflow.com/questions/57980544/hide-excels-pivot-table-field-headers", "title": "Hide excel&#39;s pivot table field headers", "body": "<p>I am trying to work on pivot table in excel with python (using win32com.client). So far things worked fine but I've been not been able to hide the <strong><em>field headers</em></strong> from a given pivot table (like when you use the button in my screenshot).</p>\n\n<p><a href=\"https://i.stack.imgur.com/WxAnu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WxAnu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know how to do this whether in VBA or directly in python?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568746950, "post_id": 57980491, "comment_id": 102370249, "body": "You really should <code>Dim a</code>."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747009, "post_id": 57980491, "comment_id": 102370268, "body": "Thank you, I thought of that using Option Explicit, but As what should a be Dim? Dim a As ...? I&#39;m assigning the 1st table found after the keyword in that a"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747094, "post_id": 57980491, "comment_id": 102370303, "body": "<code>Range.Next</code> returns <code>Range</code> (which is a Word Range) so if you&#39;re late-binding it should be <code>As Object</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747193, "post_id": 57980491, "comment_id": 102370350, "body": "But there&#39;s no <code>.Cell</code> - there&#39;s <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.range.cells\" rel=\"nofollow noreferrer\"><code>Cells</code></a>. And I don&#39;t think you index them like that, but could be wrong."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747301, "post_id": 57980491, "comment_id": 102370383, "body": "Cheers ! I declared Dim a As Object , now I&#39;m getting a different error. Runtime error 91 &quot;Object variable or With block not set&quot; on this line     a = objWord.Selection.Range.Next(Unit:=TableNo, Count:=1).Select"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747368, "post_id": 57980491, "comment_id": 102370420, "body": "I&#39;m not an expert in word, but try <code>Set a = objWord.Selection.Range.Next(Unit:=TableNo, Count:=1)</code>."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747371, "post_id": 57980491, "comment_id": 102370422, "body": "Regarding the .Cell commentary. I tried that without grabbing the 1st table after the keyword such as inputting the table by number and it worked with .Cell"}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747438, "post_id": 57980491, "comment_id": 102370459, "body": "Added &quot;Set a = objWord.Selection.Range.Next(Unit:=TableNo, Count:=1)&quot; yields runtime error 462 remote server machine not found"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747457, "post_id": 57980491, "comment_id": 102370465, "body": "Ah my bad completely, see I&#39;m no expert in Word, it&#39;s <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.table.cell\" rel=\"nofollow noreferrer\"><code>Table.Cell</code></a>. So <code>a</code> might not be a <code>Range</code> after all. Sorry for misleading."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1568747592, "post_id": 57980491, "comment_id": 102370515, "body": "Right, I tried assigning a as the 1st table that was found right after the keyword and then copy specific cells from the Word table back to Excel, no problem"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1568747804, "post_id": 57980491, "comment_id": 102370605, "body": "Your code contains many logical error and misunderstandings of how to do things in word.  Always always, always put Option explicit as the first line of each module.  If you are able, install the wonderful Rubberduck addin, and look at the code inspections.  Use intellisense by using early binding.  You clearly have word installed on your machine so instead of create object just set a reference to word vial Tools.References. then tick the box for Microsoft Word 16.0  Then you will get intellisense for word objects."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568747937, "post_id": 57980491, "comment_id": 102370650, "body": "Hi I added the Word 16.0 from Tools References and I considered the Explicit Option but still has errors"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1568747963, "post_id": 57980491, "comment_id": 102370659, "body": "This line &#39;If objWord.Selection.Find.Text &gt; 0 Then&#39; tests if the string &#39;Test&#39; is &gt;0.  !!!!"}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568748029, "post_id": 57980491, "comment_id": 102370687, "body": "use = True then?"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1568748050, "post_id": 57980491, "comment_id": 102370692, "body": "Now you need to deal with the erros one by one.  If you get stuck put the cursor on a keyword and press F1.  This will bring up the Microsoft help page for that keyword.  This works for the Office object models as well as VBA keywords."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568748116, "post_id": 57980491, "comment_id": 102370715, "body": "I tried but I got stuck here, I got confused"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1568748209, "post_id": 57980491, "comment_id": 102370757, "body": "Well for a start put the cursor on the word &#39;find&#39; and press f1.  Then when you understand how the Word VBA Find object works you will understand why the above line cannot be resolved by wildly guessing the answer."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568748416, "post_id": 57980491, "comment_id": 102370855, "body": "Yes, I looked but I don&#39;t get what&#39;s wrong, it sort of finds my keyword, if I delete it says it didn&#39;t find. I tried this  If objWord.Selection.Find.Text = True Then and it just says it doesen&#39;t find despite the string being there. I tried my best, I&#39;m at the beginning but I really got confused now"}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1568748798, "post_id": 57980491, "comment_id": 102371020, "body": "Well, if you have no .execute command in your code you are not searching for a word, you are just checking a  property of the text you defined as your search text."}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568749599, "post_id": 57980491, "comment_id": 102371372, "body": "Updated the above code, now it basically opens the Word it finds the keyword highlights it, but shows &quot;Not found&quot;. Tried something like: With objWord.Selection.Find .Forward = True .ClearFormatting .MatchWholeWord = True .MatchCase = False .Wrap = wdFindContinue .Execute FindText:=&quot;Test&quot; End With If objWord.Selection.Find.Execute = True Then MsgBox (&quot;Found&quot;) Else MsgBox (&quot;Not found&quot;) End If"}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568750079, "post_id": 57980491, "comment_id": 102371577, "body": "Sorry, my username is Nigel, I subcopied from other user by mistake, can you edit the comment please, so it can be easier? Cheers !"}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568751413, "post_id": 57980491, "comment_id": 102372101, "body": "I updated the code accordingly, unfortunately despite highlighting the found keyword it will show &quot;Not found&quot;. Would you be kind to edit on the above code, please? I would be more than grateful"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568757512, "post_id": 57981540, "comment_id": 102374184, "body": "Thank you ! How can I make the search range for the specific keyword start say from the 5th page of the Word Document, until the End of it. Thinking of replacing the following With wdDoc.StoryRanges(wdMainTextStory)"}, {"owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "edited": false, "score": 0, "creation_date": 1568757918, "post_id": 57981540, "comment_id": 102374312, "body": "with something like this: Set DocRange = ActiveDocument.Range(0, 0) Set DocRange = DocRange.GoTo(What:=wdGoToPage, Which:=wdGoToAbsolute, Count:=5) Set DocRange = DocRange.GoTo(What:=wdGoToBookmark, Name:=&quot;\\page&quot;) DocRange.End = ActiveDocument.Range.End"}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 0, "last_activity_date": 1568751565, "creation_date": 1568751565, "answer_id": 57981540, "question_id": 57980491, "link": "https://stackoverflow.com/questions/57980491/how-should-i-fix-run-time-error-424-object-required-in-excel-vba/57981540#57981540", "title": "How should I fix run time error 424 object required in Excel VBA?", "body": "<p>To avoid an infinite sequence of comments try the code below as a guide to where you should be going.  There may still be issues to fix to get to the logic you were thinking of, rather than my interpretation of it.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n        Dim ws As Worksheet\n        Dim objWord As Word.Application\n        Dim i As Integer\n        Dim strValue As String\n        Dim wdDoc As Word.Document\n        Dim wdFileName As Variant\n        Dim TableNo As Integer 'table number in Word\n        Dim myTableRange As Word.Range ' formerly variable 'a'\n\n        Set objWord = New Word.Application\n        Set wdDoc = objWord.Documents.Open(\"C:\\Users\\Nigel\\Desktop\\Testt.docx\")\n\n        objWord.Activate\n        objWord.Visible = True\n\n        ' The use of selection here is incorrect because the cursor\n        '(selection point) will just be at the start of the document\n        ' so we actuially need to tell word a range to use\n        ' we also need to use the document and not the application\n        With wdDoc.StoryRanges(wdMainTextStory)\n\n            With .Find\n                .Forward = True\n                .ClearFormatting\n                .MatchWholeWord = True\n                .MatchCase = True\n                .Wrap = wdFindContinue\n                .Text = \"Test\"\n                .Execute\n\n            End With\n\n            If .Find.Found Then\n                MsgBox \"Found\"\n            Else\n                MsgBox \"Not found\"\n                Exit Sub\n            End If\n\n            ' duplicate just makes a copy of the current found range\n            Set myTableRange = .Duplicate.Next(unit:=wdTable)\n        End With\n\n    Dim rowNb As Long\n    Dim ColNb As Long\n    Dim x As Long\n    Dim y As Long\n    x = 1\n    y = 1\n\n    With myTableRange.Tables(1)\n        For rowNb = 1 To 1 '\n            For ColNb = 2 To 2\n                ' its not clear where you are referring to word or excel cells.\n                ' you will need to change the qualifications for the cell parts as appropriate\n                .Cell(x, y).Range.Text = WorksheetFunction.Clean(myTableRange.Tables(1).Cell(rowNb, ColNb).Range.Text)\n                ' the line below will be executed but its value will never be used\n                y = y + 1\n            Next ColNb\n            ' these two lines will be executed but thier values will never be used\n            y = 1\n            x = x + 1\n        Next rowNb\n    End With\n    ' the line below will be executed but its value will never be used\n    x = x + 2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 12074868, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q0nbcLGHl_I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdEudgkrxKW4MVCgz6U2nGzDdy6RA/photo.jpg?sz=128", "display_name": "Nytro", "link": "https://stackoverflow.com/users/12074868/nytro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 57981540, "answer_count": 1, "score": 1, "last_activity_date": 1582095995, "creation_date": 1568746774, "last_edit_date": 1582095995, "question_id": 57980491, "link": "https://stackoverflow.com/questions/57980491/how-should-i-fix-run-time-error-424-object-required-in-excel-vba", "title": "How should I fix run time error 424 object required in Excel VBA?", "body": "<p>I wrote a VBA in Excel to find a specific word in Microsoft Word and get parts of the table right below that keyword back to Excel however it gives a Runtime error 424 \"object required\", your help would be much appreciated. Thank you !</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n        Dim ws As Worksheet\n        Dim objWord As Object\n        Dim i As Integer\n        Dim strValue As String\n        Dim wdDoc As Word.Document\n        Dim wdFileName As Variant\n        Dim TableNo As Integer 'table number in Word\n        Set objWord = CreateObject(\"Word.Application\")\n\n        objWord.Visible = True\n        Set wdDoc = objWord.Documents.Open(\"C:\\Users\\Nigel\\Desktop\\Testt.docx\")\n        objWord.Activate\n\n\n        With objWord.Selection.Find\n        .Forward = True\n        .ClearFormatting\n        .MatchWholeWord = True\n        .MatchCase = True\n        .Wrap = wdFindContinue\n        .Execute FindText:=\"Test\"\n        End With\n        If objWord.Selection.Find.Execute = True Then\n        MsgBox (\"Found\")\n        Else\n        MsgBox (\"Not found\")\n         End If\n\n\n\n    TableNo = objWord.Selection.Tables.Count\n    Dim a As Object\n       Set a = objWord.Selection.Range.Next(Unit:=TableNo, Count:=1)\n\n\n\n\n    Dim x As Long, y As Long\n    x = 1: y = 1\n    With a\n    For rowNb = 1 To 1\n    For colNb = 2 To 2\n    Cells(x, y) = WorksheetFunction.Clean(.Cell(rowNb, colNb).Range.Text)\n    y = y + 1\n    Next colNb\n    y = 1\n    x = x + 1\n    Next rowNb\n    End With\n    x = x + 2\n\n\n\n\n\n\n\n\n    End Sub\n\n</code></pre>\n\n<p>Object required Runtime error 424 on this line:</p>\n\n<pre><code>Cells(x, y) = WorksheetFunction.Clean(.Cell(rowNb, colNb).Range.Text)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1568748289, "post_id": 57980790, "comment_id": 102370792, "body": "This doesn&#39;t extract any substring like the question is asking"}, {"owner": {"reputation": 9, "user_id": 9499980, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u041c\u0438\u0445\u0430\u0438\u043b \u041f\u043e\u043f\u043e\u0432", "link": "https://stackoverflow.com/users/9499980/%d0%9c%d0%b8%d1%85%d0%b0%d0%b8%d0%bb-%d0%9f%d0%be%d0%bf%d0%be%d0%b2"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1568750433, "post_id": 57980790, "comment_id": 102371726, "body": "Question was: &quot;VBA find text string in a cell and paste it in another cell&quot;"}], "tags": [], "owner": {"reputation": 9, "user_id": 9499980, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u041c\u0438\u0445\u0430\u0438\u043b \u041f\u043e\u043f\u043e\u0432", "link": "https://stackoverflow.com/users/9499980/%d0%9c%d0%b8%d1%85%d0%b0%d0%b8%d0%bb-%d0%9f%d0%be%d0%bf%d0%be%d0%b2"}, "is_accepted": false, "score": -1, "last_activity_date": 1568748182, "creation_date": 1568748182, "answer_id": 57980790, "question_id": 57980408, "link": "https://stackoverflow.com/questions/57980408/vba-find-text-string-in-a-cell-and-paste-it-in-another-cell/57980790#57980790", "title": "VBA find text string in a cell and paste it in another cell", "body": "<pre><code>Sub Find_Paste( _\n        s As String, _\n        cell As Range, _\n        column_Offset As Long)\n    With cell\n        If InStr(.Value, s) &gt; 0 Then .Offset(0, column_Offset) = s\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 2, "last_activity_date": 1568748206, "creation_date": 1568748206, "answer_id": 57980796, "question_id": 57980408, "link": "https://stackoverflow.com/questions/57980408/vba-find-text-string-in-a-cell-and-paste-it-in-another-cell/57980796#57980796", "title": "VBA find text string in a cell and paste it in another cell", "body": "<p>Assuming your data starts in cell <code>N2</code> and there is only one bracket in your Strings and all dates are 7 characters in length you could use the following formula in <code>O2</code> to get what you want</p>\n\n<pre><code>=MID(N2,FIND(\"(\",N2)+1,7)\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UNrMj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UNrMj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 4925197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84bb043f4bfac4b468a50a629769edd6?s=128&d=identicon&r=PG&f=1", "display_name": "mcaulifww", "link": "https://stackoverflow.com/users/4925197/mcaulifww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1568756204, "answer_count": 2, "score": -4, "last_activity_date": 1568748206, "creation_date": 1568746417, "last_edit_date": 1568746721, "question_id": 57980408, "link": "https://stackoverflow.com/questions/57980408/vba-find-text-string-in-a-cell-and-paste-it-in-another-cell", "closed_reason": "Needs more focus", "title": "VBA find text string in a cell and paste it in another cell", "body": "<p>I have a report with text strings with a general date. I'm trying to grab these dates and put them in a cell next to them. How can I do this?</p>\n\n<p>Example:</p>\n\n<pre><code>Column N\nblah blah blah (Q4 2019)\nblah blah (Q3 2019) - Blah\n</code></pre>\n\n<pre><code>Column O\nQ4 2019\nQ3 2019\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1568746477, "post_id": 57980325, "comment_id": 102370080, "body": "Watch out for <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit ActiveSheet references</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1568746591, "post_id": 57980325, "comment_id": 102370123, "body": "You&#39;re giving <code>Range</code> two arguments; first has whatever value <code>arr(1, 4)</code> has, second has whatever value <code>arr(5, 4)</code> has. This isn&#39;t equivalent to <code>Range(&quot;D1:D5&quot;)</code> at all. You mean to give it a <i>slice</i> of the <code>arr</code> array -- but you&#39;re not slicing it :)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12078796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa8414085e6123a492d0e4dedf9e92e?s=128&d=identicon&r=PG&f=1", "display_name": "Royville", "link": "https://stackoverflow.com/users/12078796/royville"}, "edited": false, "score": 0, "creation_date": 1568794575, "post_id": 57980833, "comment_id": 102383892, "body": "This solution worked great, the only thing I changed was to make it Rank the highest value as 1 by changing &#39;Application.Evaluate&#39; line to:-       &#39;arr(y, 5) = **(Uy + 1) - **Application.Evaluate(&quot;SumProduct(--({&quot; &amp; Join(t, &quot;,&quot;) &amp; &quot;} &lt;= &quot; &amp; arr(y, 4) &amp; &quot;))&quot;)&#39;.  The Uy variable would contain the upper bound value of y."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1568750763, "last_edit_date": 1568750763, "creation_date": 1568748407, "answer_id": 57980833, "question_id": 57980325, "link": "https://stackoverflow.com/questions/57980325/how-can-i-rank-a-column-of-numbers-in-a-2d-array-using-only-vba-code/57980833#57980833", "title": "How can I Rank a Column of Numbers in a 2D array using only vba code", "body": "<p>Range expects two ranges not items in an array.  But also Rank does not like arrays it wants a range reference.  </p>\n\n<p>First we want a one dimensional array of the 4th column:</p>\n\n<pre><code>    Dim t As Variant\n    t = Application.Transpose(Application.Index(arr, 0, 4))\n</code></pre>\n\n<p>this will create a one dimensional array out of the 4th column</p>\n\n<p>We then use that in SUMPRODUCT</p>\n\n<pre><code>arr(y, 5) = Application.Evaluate(\"SumProduct(--({\" &amp; Join(t, \",\") &amp; \"} &lt;= \" &amp; arr(y, 4) &amp; \"))\")\n</code></pre>\n\n<p>I also changed the output to just once to the worksheet to save some time.</p>\n\n<pre><code>Sub RankArray()\n\n    Dim arr()\n    ReDim arr(1 To 5, 1 To 5)\n\n    Dim y As Long\n    For y = 1 To 5\n        Dim x As Long\n        For x = 1 To 3\n            arr(y, x) = Int((99 * Rnd) + 1)\n        Next x\n        arr(y, 4) = arr(y, 1) + arr(y, 2) + arr(y, 3)\n    Next y\n\n    Dim t As Variant\n    t = Application.Transpose(Application.Index(arr, 0, 4))\n\n    For y = 1 To 5\n        arr(y, 5) = Application.Evaluate(\"SumProduct(--({\" &amp; Join(t, \",\") &amp; \"} &lt;= \" &amp; arr(y, 4) &amp; \"))\")\n    Next y\n\n    Sheet1.Range(\"A1\").Resize(UBound(arr, 1), UBound(arr, 2)).Value = arr\n\nEnd Sub\n</code></pre>\n\n<p>One note:</p>\n\n<p>This will not work if the array has more than 45-50 rows as <code>Evaluate</code> has a 255 character limit.</p>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1568782691, "creation_date": 1568782691, "answer_id": 57985349, "question_id": 57980325, "link": "https://stackoverflow.com/questions/57980325/how-can-i-rank-a-column-of-numbers-in-a-2d-array-using-only-vba-code/57985349#57985349", "title": "How can I Rank a Column of Numbers in a 2D array using only vba code", "body": "<p>If you didn't want to use the <code>WorksheetFunction.Rank</code> function, it would be fairly simple to write your own ranking routine. A reasonably fast routine would look something like below:</p>\n\n<pre><code>Private Sub RankArray(ByRef rArr() As Variant, refIndex As Long, rankIndex As Long)\n    Dim i As Long\n    Dim uniques As Collection\n    Dim vrp As cValueRankPair, unique As cValueRankPair\n\n\n    Set uniques = New Collection\n    For i = LBound(rArr, 1) To UBound(rArr, 1)\n        'Check if value already exists.\n        Set vrp = Nothing: On Error Resume Next\n        Set vrp = uniques(CStr(rArr(i, refIndex))): On Error GoTo 0\n\n        If vrp Is Nothing Then\n\n            'It's a new value, so add it in ascending order.\n            For Each unique In uniques\n                If rArr(i, refIndex) &lt; unique.Value Then\n                    Set vrp = New cValueRankPair\n                    vrp.Value = rArr(i, refIndex)\n                    uniques.Add vrp, CStr(vrp.Value), Before:=CStr(unique.Value)\n                    Exit For\n                End If\n            Next\n\n            'If it wasn't already added, then add it as last item.\n            If vrp Is Nothing Then\n                Set vrp = New cValueRankPair\n                vrp.Value = rArr(i, refIndex)\n                uniques.Add vrp, CStr(vrp.Value)\n            End If\n        End If\n\n        'Increment the count for this value.\n        vrp.Count = vrp.Count + 1\n    Next\n\n    'Set the rank values.\n    i = 1\n    For Each unique In uniques\n        unique.Rank = i\n        i = i + unique.Count\n    Next\n\n    'Populate the array.\n    For i = LBound(rArr, 1) To UBound(rArr, 1)\n        'We don't really need this check.\n        Set vrp = Nothing: On Error Resume Next\n        Set vrp = uniques(CStr(rArr(i, refIndex))): On Error GoTo 0\n\n        'Write the rank to array.\n        If Not vrp Is Nothing Then\n            rArr(i, rankIndex) = vrp.Rank\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>You'll note that for simplicity I've added a class called <em>cValueRankPair</em>:</p>\n\n<pre><code>Option Explicit\n\nPublic Value As Variant\nPublic Rank As Long\nPublic Count As Long\n</code></pre>\n\n<p>You'd just call the routine like so:</p>\n\n<pre><code>RankArray arr, 4, 5\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12078796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa8414085e6123a492d0e4dedf9e92e?s=128&d=identicon&r=PG&f=1", "display_name": "Royville", "link": "https://stackoverflow.com/users/12078796/royville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 57980833, "answer_count": 2, "score": 1, "last_activity_date": 1568782691, "creation_date": 1568746068, "last_edit_date": 1592644375, "question_id": 57980325, "link": "https://stackoverflow.com/questions/57980325/how-can-i-rank-a-column-of-numbers-in-a-2d-array-using-only-vba-code", "title": "How can I Rank a Column of Numbers in a 2D array using only vba code", "body": "<p>I have a 2D array of numbers, 5 columns and 5 rows. The 4th column holds the result of calculations on cols 1 to 3 and I want the 5th column to be the RANK of the 4th column. I want to do this in the array only and not use the sheet.</p>\n<p>Notice I'm only using the sheet for clarity of working whilst getting it to work.</p>\n<p>I want to use only code because it will be working with a large number of calculations, and writing /reading from sheet will be too slow.</p>\n<pre><code>Sub RankArray()\n\nDim arr()\nReDim arr(1 To 5, 1 To 5)\n\nFor y = 1 To 5\n    For x = 1 To 3\n        arr(y, x) = Int((99 * Rnd) + 1)\n        Sheet1.Cells(y, x) = arr(y, x)\n    Next x\n    arr(y, 4) = arr(y, 1) + arr(y, 2) + arr(y, 3)\n    Sheet1.Cells(y, 4) = arr(y, 4)\nNext y\n\nFor y = 1 To 5\n    'arr(y, 5) = WorksheetFunction.Rank(arr(y, 4), Range(&quot;D1:D5&quot;))    \n    arr(y, 5) = WorksheetFunction.Rank(arr(y, 4), Range(arr(1, 4), arr(5, 4)))\n    Sheet1.Cells(y, 5) = arr(y, 5)\nNext y\n\nEnd Sub\n</code></pre>\n<p>The program runs until it gets to the 'Rank' line in the second loop - which then gives:-</p>\n<blockquote>\n<p>&quot;Runtime error 1004</p>\n<p>&quot;Application-defined or object-defined error&quot;</p>\n</blockquote>\n<p>The commented out line works - but this uses data from the sheet which is not what I want.</p>\n<p>So what is the problem? Why won't Rank work in this case?</p>\n<p>I'm using Excel 2007.</p>\n"}]