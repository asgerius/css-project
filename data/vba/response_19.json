[{"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1432164547, "post_id": 30362019, "comment_id": 48815626, "body": "When debugging, does the line <code>Vector = returnArray</code> give you what you&#39;re expecting, i.e. <code>Vector</code> is an array of values?"}, {"owner": {"reputation": 6440, "user_id": 4002530, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Hrwjk.jpg?s=128&g=1", "display_name": "tospig", "link": "https://stackoverflow.com/users/4002530/tospig"}, "edited": false, "score": 0, "creation_date": 1432164579, "post_id": 30362019, "comment_id": 48815633, "body": "Can you add the code you&#39;re using to write the array to the sheet?"}, {"owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "edited": false, "score": 0, "creation_date": 1432164622, "post_id": 30362019, "comment_id": 48815646, "body": "It looks like your issue at the moment is that you&#39;re mostly using a 1D array. Also what is the range &quot;values&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1432164756, "creation_date": 1432164756, "answer_id": 30362095, "question_id": 30362019, "link": "https://stackoverflow.com/questions/30362019/vba-trying-to-return-an-array-but-only-getting-the-first-value/30362095#30362095", "title": "VBA: trying to return an array but only getting the first value", "body": "<p>Use a <strong>2-dimensional</strong> array:</p>\n\n<pre><code>Public Function Vector(values As Range) As Variant\n\n    Dim arraySize As Integer, i As Integer\n    arraySize = values.Rows.Count\n    Dim returnArray() As Variant\n    ReDim returnArray(1 To arraySize, 1 To 1)\n\n    For i = 1 To arraySize\n        returnArray(i, 1) = values(i, 1) - 1\n    Next i\n\n    Vector = returnArray\n\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/hguvu.png\" alt=\"enter image description here\"></p>\n\n<p><strong>NOTE:</strong></p>\n\n<p>When entering the array formula in the worksheet, hi-light cells <strong>B1</strong> through <strong>B5</strong>, then click in the Formula Bar and then enter the formula with  <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd></p>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1432165210, "creation_date": 1432165210, "answer_id": 30362161, "question_id": 30362019, "link": "https://stackoverflow.com/questions/30362019/vba-trying-to-return-an-array-but-only-getting-the-first-value/30362161#30362161", "title": "VBA: trying to return an array but only getting the first value", "body": "<pre><code>Public Function Vector(values As Range) As Variant\n\n    Dim r As Long, c As Long, returnArray As Variant\n\n    returnArray = values.Value\n\n    For r = 1 To ubound(returnArray, 1)\n    For c = 1 To ubound(returnArray, 2)\n        returnArray(r, c) = returnArray(r, c) - 1\n    Next c\n    Next r\n\n    Vector = returnArray\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4922381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e851af6b086622c07e74b00d1fb7de8?s=128&d=identicon&r=PG&f=1", "display_name": "sparta", "link": "https://stackoverflow.com/users/4922381/sparta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "accepted_answer_id": 30362095, "answer_count": 2, "score": 2, "last_activity_date": 1432175347, "creation_date": 1432164217, "last_edit_date": 1432175347, "question_id": 30362019, "link": "https://stackoverflow.com/questions/30362019/vba-trying-to-return-an-array-but-only-getting-the-first-value", "title": "VBA: trying to return an array but only getting the first value", "body": "<p>I think this question has been asked a thousand times but after hours of searching I still can't find any help. So I need to use a vector of numbers as an input, do a calculation to all of those numbers and then return the results as a vector with a same dimension as the input vector. So lets say that I want to take some numbers and then subtract all of them by one and so my Excel sheet should look like this</p>\n\n<pre><code>    A   B\n1   6   5\n2   7   6\n3   8   7\n4   9   8 \n5   10  9\n</code></pre>\n\n<p>where column A is the input vector and B should be the output. But my output is only a column of zeros. Debugging also tells that the right numbers are there in the output vector but I can only print the first value which then goes to all cells. At the moment my code looks like this</p>\n\n<pre><code>Public Function Vector(values As Range) As Variant\n\n    Dim arraySize As Integer, i As Integer\n    arraySize = values.rows.Count\n    Dim returnArray() As Variant\n    ReDim returnArray(arraySize)\n\n    For i = 1 To arraySize\n        returnArray(i - 1) = values(i, 1) - 1\n    Next i\n\n    Vector = returnArray\n\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1432238020, "post_id": 30363953, "comment_id": 48855363, "body": "I tried ur code but keep getting runtime error 9 ,out of range on line --- With ExcelApp.Workbooks(Right$(X1, Len(X1) - InStrRev(X1, &quot;\\&quot;)))"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1432178325, "creation_date": 1432178325, "answer_id": 30363953, "question_id": 30362004, "link": "https://stackoverflow.com/questions/30362004/vba-access-check-if-excel-file-is-open/30363953#30363953", "title": "vba access - Check if excel file is open", "body": "<p>tested in Outlook</p>\n\n<pre><code>Sub Test()\n\nDim ExcelApp As Object\nDim X, X1\n\nX = Array(\"c:\\test\\Test_Sheet1.xlsb\", \"c:\\test\\Test_Sheet2.xlsb\")\n\nFor Each X1 In X\n    On Error Resume Next\n    Set ExcelApp = GetObject(X1).Application\n    On Error GoTo 0\n\n    If Not ExcelApp Is Nothing Then\n        With ExcelApp.Workbooks(Right$(X1, Len(X1) - InStrRev(X1, \"\\\")))\n            .RefreshAll\n            .Save\n            .Close\n    End With\n    Set ExcelApp = Nothing\n    End If\n\nNext X1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1967, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432178325, "creation_date": 1432164115, "question_id": 30362004, "link": "https://stackoverflow.com/questions/30362004/vba-access-check-if-excel-file-is-open", "title": "vba access - Check if excel file is open", "body": "<p>Using VBA Access, I'm trying to edit the below code. So that it first checks if an excel file is open , if already open wait till file is closed then resume code? this needs to be done for each file 1,2,3.</p>\n\n<ol>\n<li>Check if excel file is open </li>\n<li>If open wait(Pause) till closed then resume code (Refresh table ,save, close) </li>\n<li><p>Repeat process for the next file.</p>\n\n<pre><code>  Function RefreshExcelTables()\n\n  Dim ExcelApp As Object\n\n  Set ExcelApp = CreateObject(\"Excel.Application\")\n\n  ExcelApp.workbooks.Open \"c:\\test\\Test_Sheet1.xlsb\"\n  ExcelApp.ActiveWorkbook.refreshall\n  ExcelApp.ActiveWorkbook.Save\n  ExcelApp.ActiveWindow.Close\n\n\n  ExcelApp.workbooks.Open \"c:\\test\\Test_Sheet2.xlsb\"\n  ExcelApp.ActiveWorkbook.refreshall\n  ExcelApp.ActiveWorkbook.Save\n  ExcelApp.ActiveWindow.Close\n\n\n  ExcelApp.workbooks.Open \"c:\\test\\Test_Sheet3.xlsb\"\n  ExcelApp.ActiveWorkbook.refreshall\n  ExcelApp.ActiveWorkbook.Save\n  ExcelApp.ActiveWindow.Close\n\n\n  Set ExcelApp = Nothing\n\n\n  End Function\n</code></pre></li>\n</ol>\n"}, {"tags": ["vba", "visual-studio-2013"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432167840, "post_id": 30361767, "comment_id": 48816473, "body": "try <code>ActiveDocument.BuiltInDocumentProperties(wdProperty).Value</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432187914, "post_id": 30361767, "comment_id": 48822229, "body": "<code>wdPropertyComments</code> is a constant from the Word object library, so try <code>Word.WdBuiltInProperty.wdPropertyComments</code>.  Or you can substitute the constant&#39;s value (5)"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1432168068, "creation_date": 1432168068, "answer_id": 30362577, "question_id": 30361767, "link": "https://stackoverflow.com/questions/30361767/why-i-cannot-access-wdpropertycomments-in-visual-studio/30362577#30362577", "title": "Why I cannot access wdPropertyComments in VIsual Studio?", "body": "<p>Based on my understanding, the <code>ActiveDocument.BuiltInDocumentProperties</code> returns a DocumentProperties</p>\n\n<p>More detail about this property <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff196862.aspx\" rel=\"nofollow\">link:</a></p>\n\n<p><code>ActiveDocument.BuiltInDocumentProperties(wdPropertyWords)</code></p>\n"}], "owner": {"reputation": 61, "user_id": 4921788, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/343694629151120/picture?type=large", "display_name": "Lam Lai", "link": "https://stackoverflow.com/users/4921788/lam-lai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432168068, "creation_date": 1432162684, "question_id": 30361767, "link": "https://stackoverflow.com/questions/30361767/why-i-cannot-access-wdpropertycomments-in-visual-studio", "title": "Why I cannot access wdPropertyComments in VIsual Studio?", "body": "<p>I paste the following code to visual studio 2013, but it alerts me that wdPropertyComments is not declared</p>\n\n<p>I do the similar thing in VBA in Microsoft Word and it works, why that happen?</p>\n\n<p>By the way , in VBA in MS word, we can use activedocument, but how to use activedocument inside visual studio?</p>\n\n<pre><code>Public Class ThisAddIn\n    ' ReadOnly Property ActiveDocument As Document\n    Public Sub Application_DocumentBeforeSave(ByVal Doc As Word.Document, ByRef SaveAsUI As Boolean, _\n            ByRef Cancel As Boolean) Handles Application.DocumentBeforeSave\n        If SaveAsUI = True Then\n            Dim intResponse As Integer\n            intResponse = MsgBox(\"Do you want to generate Jats XML file?\", vbYesNo)\n            If intResponse = vbYes Then\n                ' Doc.BuiltInDocumentProperties()\n                MsgBox(Doc.BuiltInDocumentProperties(wdPropertyComments))\n                ' Call createXmlfile()\n            End If\n        End If\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432160809, "post_id": 30361416, "comment_id": 48814486, "body": "Please qualify the Cells Object correctly. They may be referring to the wrong sheet. Use something like <code>If Wb.Sheets(&quot;Something&quot;).Cells(i, &quot;E&quot;).Value = &quot;Angle&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432161739, "post_id": 30361416, "comment_id": 48814758, "body": "I think the With statement takes care of that, no? You did help me realize I forgot a dot (&quot;.&quot;) in front of Cells. After correcting that the data is now being pasted into ALL columns. Somehow the macro isn&#39;t distinguishing between &quot;Vertical&quot; and &quot;Angle&quot;. It&#39;s taking all the data and pasting it twice. I think you&#39;re right about not qualifying the Cells object correctly."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1432161959, "post_id": 30361416, "comment_id": 48814820, "body": "Don&#39;t you need to increment <code>NextRow</code> inside your loop?  Unless there&#39;s only one set of data per file..."}, {"owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "edited": false, "score": 0, "creation_date": 1432162592, "post_id": 30361416, "comment_id": 48815017, "body": "I&#39;m not sure if I need it. I think I do. So the Copy Workbook is constantly being updated throughout the day. It&#39;s usually always open on a computer downstairs and users record data into it. The macro is linked to a Command Button in the Paste Workbook. When I press the button the macro runs. I&#39;m worried that without &#39;NextRow&#39; I might paste over previous data."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432162743, "post_id": 30361758, "comment_id": 48815056, "body": "Was just about to post a similar solution with Select Case but I used <code>LCase(.Cells(i, &quot;E&quot;).Value)</code> to avoid case sensitivity."}, {"owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "edited": false, "score": 0, "creation_date": 1432163218, "post_id": 30361758, "comment_id": 48815201, "body": "Sweet Case statement Tim. I&#39;ve changed my code but before I run it, what does the    NextRow = NextRow + 1 do?"}, {"owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "edited": false, "score": 0, "creation_date": 1432163970, "post_id": 30361758, "comment_id": 48815431, "body": "I tried it out and it works, but their are gaps in the columns where the data gets pasted. For example, column E in the Copy workbook has &quot;Angle&quot; in rows 3 - 10 and &quot;Vertical&quot;  in rows 11 - 17. In the Paste workbook the &quot;Angle&quot; data is in the correct column in rows 3 - 10 however the &quot;Vertical&quot; column is blank until row 11. This might be an issue with &quot;NextRow&quot; but I&#39;m not sure how to fix it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432164539, "post_id": 30361758, "comment_id": 48815624, "body": "My bad - it&#39;s not clear when to move to the next &quot;destination&quot; row: if there is only one &quot;set&quot; is data to be copied from the input file then you don&#39;t need to increment NextRow at all.  Otherwise you&#39;d need to explain a bit more exactly how the data on the ACP sheet looks.  Also note you originally set NextRow based on column A, but when your code adds a row ColA is not populated, so if you run it again it may populate a row which already has data."}, {"owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "edited": false, "score": 0, "creation_date": 1432165641, "post_id": 30361758, "comment_id": 48815941, "body": "Both workbooks have a sheet called &quot;ACP&quot; which is confusing I know, but on the Copy workbook all the data I want is in columns K &amp; L. In the Paste workbook I want to paste the data in columns D &amp; E (for Vertical), I &amp; J (for Angle), and N &amp; O (for everything else). I tried running the macro without &quot;NextRow = NextRow + 1&quot; and all data was pasted over so there was only one entry in columns D &amp; E and I &amp; J. Although there were no gaps and the data was correctly placed. Also idk how to make code blocks in comments, so sorry for that."}, {"owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "edited": false, "score": 0, "creation_date": 1432171187, "post_id": 30361758, "comment_id": 48817362, "body": "I figured it out! I needed a NextRow for all 3 data types (vertical, angle, and n/a). I don&#39;t know how to post the working code through a comment. I&#39;d like to so people can see it."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1432162612, "creation_date": 1432162612, "answer_id": 30361758, "question_id": 30361416, "link": "https://stackoverflow.com/questions/30361416/excel-vba-2010-if-then-elseif-statement-not-recognizing-string-variables/30361758#30361758", "title": "Excel VBA 2010 - If-Then-ElseIf statement not recognizing string variables", "body": "<pre><code>Option Explicit\n\nSub GetData()\n\nDim wsPasteTo As Worksheet, wbDATA As Workbook\nDim NextRow As Long, LastRow As Long, i As Long\nDim val, col \n\n    Set wsPasteTo = ThisWorkbook.Sheets(\"ACP\")\n    NextRow = wsPasteTo.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 2\n\n    Set wbDATA = Workbooks.Open( _\n          \"\\\\cmicro.com\\Shares\\Amb\\Amb-Probes\\DataLogs\\\" &amp; _\n         \"CQS-03-033-2012 Coax Shelf Cut Log R2.6.xlsm\", ReadOnly:=True)\n\n    Application.ScreenUpdating = False\n\n    With wbDATA.Sheets(\"ACP\")\n\n        LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 2 To LastRow\n\n            val = .Cells(i, \"E\").Value\n            Select Case val\n                Case \"Angle\": col = \"I\"\n                Case \"Vertical\": col = \"D\"\n                Case Else: col = \"N\"\n            End Select\n\n            wsPasteTo.Cells(NextRow, col).Resize(1,2).Value = _\n                                .Cells(i, \"K\").Resize(1, 2).Value\n\n            NextRow = NextRow + 1 'or whatever....\n\n        Next i\n\n    End With\n\nApplication.ScreenUpdating = True\nwbDATA.Close False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1432171390, "creation_date": 1432171390, "answer_id": 30363012, "question_id": 30361416, "link": "https://stackoverflow.com/questions/30361416/excel-vba-2010-if-then-elseif-statement-not-recognizing-string-variables/30363012#30363012", "title": "Excel VBA 2010 - If-Then-ElseIf statement not recognizing string variables", "body": "<p>Here is the working code:</p>\n\n<pre><code>Option Explicit\n\nSub GetData()\n\nDim wsPasteTo As Worksheet, wbDATA As Workbook\nDim NextRow As Long, LastRow As Long, i As Long\nDim val, col\n\nSet wsPasteTo = ThisWorkbook.Sheets(\"ACP\")\n\nSet wbDATA = Workbooks.Open(\"\\\\cmicro.com\\Shares\\Amb\\Amb-Probes\\DataLogs\\CQS-03-033-2012 Coax Shelf Cut Log R2.6.xlsm\", ReadOnly:=True)\nApplication.ScreenUpdating = False\n\n    With wbDATA.Sheets(\"ACP\")\n\n        LastRow = .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 2 To LastRow\n\n            val = .Cells(i, \"E\").Value\n            Select Case val\n                Case \"Angle\": col = \"I\"\n                    NextRow = wsPasteTo.Range(\"I\" &amp; Rows.Count).End(xlUp).Row + 1\n                Case \"Vertical\": col = \"D\"\n                    NextRow = wsPasteTo.Range(\"D\" &amp; Rows.Count).End(xlUp).Row + 1\n                Case Else: col = \"N\"\n                    NextRow = wsPasteTo.Range(\"N\" &amp; Rows.Count).End(xlUp).Row + 1\n            End Select\n\n            wsPasteTo.Cells(NextRow, col).Resize(1, 2).Value = .Cells(i, \"K\").Resize(1, 2).Value\n\n        Next i\n\n    End With\n\nApplication.ScreenUpdating = True\nwbDATA.Close False\n\nEnd Sub\n</code></pre>\n\n<p>I forgot that the 'NextRow' for each type of data would be unique.</p>\n\n<p>Thanks for your help Tim.</p>\n"}], "owner": {"reputation": 11, "user_id": 4921650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8447f8529386396f42e9295be63e3c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ryan", "link": "https://stackoverflow.com/users/4921650/nicholas-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1786, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1432204167, "creation_date": 1432160637, "last_edit_date": 1432204167, "question_id": 30361416, "link": "https://stackoverflow.com/questions/30361416/excel-vba-2010-if-then-elseif-statement-not-recognizing-string-variables", "title": "Excel VBA 2010 - If-Then-ElseIf statement not recognizing string variables", "body": "<p>I have an Excel VBA macro with an <code>If-Then-ElseIf</code> statement that is within a <code>For-Next</code> loop. I'll show the code before describing the issue. I post the entire code just in case I'm wrong about thinking the problem lies within the If statement.</p>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\n\nSub GetData()\n\n    Dim wsPasteTo As Worksheet, wbDATA As Workbook\n    Dim NextRow As Long, LastRow As Long, i As Long\n\n    Set wsPasteTo = ThisWorkbook.Sheets(\"ACP\")\n    NextRow = wsPasteTo.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 2\n\n    Set wbDATA = Workbooks.Open(\"\\\\cmicro.com\\Shares\\Amb\\Amb-Probes\\DataLogs\\CQS-03-033-2012 Coax Shelf Cut Log R2.6.xlsm\", ReadOnly:=True)\n    Application.ScreenUpdating = False\n\n    With wbDATA.Sheets(\"ACP\")\n\n        LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        For i = 2 To LastRow\n\n            If Cells(i, \"E\") = \"Angle\" Then\n                .Range(\"K2:L\" &amp; LastRow).Copy\n                wsPasteTo.Range(\"I\" &amp; NextRow).PasteSpecial xlPasteValues\n\n            ElseIf Cells(i, \"E\") = \"Vertical\" Then\n                .Range(\"K2:L\" &amp; LastRow).Copy\n                wsPasteTo.Range(\"D\" &amp; NextRow).PasteSpecial xlPasteValues\n\n            Else\n                .Range(\"K2:L\" &amp; LastRow).Copy\n                wsPasteTo.Range(\"N\" &amp; NextRow).PasteSpecial xlPasteValues\n\n            End If\n\n        Next i\n\n    End With\n\n    Application.ScreenUpdating = True\n    wbDATA.Close False\n\nEnd Sub\n</code></pre>\n\n<p>This macro copies data from another Excel workbook (let's call it the Copy Workbook) based on what's in column E of the Copy Workbook. Column E has 3 options for the user to choose: \"Angle\", \"Vertical\", and \"n/a\". I used data validation so the user must chose one of those 3 options from a drop down in all column E cells. Based on that, the macro pastes data into columns in a separate workbook, let's call it the Paste Workbook.</p>\n\n<p>This code doesn't have errors, however all the data is being pasted into the wrong place in the Paste Workbook.</p>\n\n<p>I think the problem is with the lines of code:</p>\n\n<pre><code>If Cells(i, \"E\") = \"Angle\" Then\n</code></pre>\n\n<p>and</p>\n\n<pre><code>ElseIf Cells(i, \"E\") = \"Vertical\" Then\n</code></pre>\n\n<p>because when I'm in debug mode, these lines are skipped as though the string variables \"Vertical\" and \"Angle\" aren't there in column \"E\". That's why all the data is going into one place.</p>\n\n<p>I can't figure what is wrong with the code. I checked out column E in the Copy Workbook and there are no spelling/capitalization issues. Maybe a Case statement would be better for what I'm doing, but I'm not savvy with VBA and I don't know how to do that. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1432163458, "creation_date": 1432163458, "answer_id": 30361884, "question_id": 30361410, "link": "https://stackoverflow.com/questions/30361410/macro-to-insert-user-defined-number-of-columns/30361884#30361884", "title": "macro to insert user defined number of columns", "body": "<p>Certainly, see code below with comments (with modification to the insert line)</p>\n\n<p><em>Assuming you are asking user for the number of columns to insert.</em></p>\n\n<p>see <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251811(v=office.15).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg251811(v=office.15).aspx</a></p>\n\n<pre><code>Sub Wsh_AddColumnsFromUserInput()\n\nDim j As Integer, k As Integer\nDim bCols As Byte\n\nbCols = InputBox(\"How many columns do want to insert?\", \"Some tittle here\")\nRem Set min &amp; max\nIf bCols &lt; 1 Then bCols = 1\nIf bCols &gt; 7 Then bCols = 7\n\n'j is the last column\nj = ActiveSheet.Range(\"D3\").End(xlToRight).Column\n\nFor k = j To 5 Step -1\n    ActiveSheet.Columns(k).Resize(, bCols).EntireColumn.Insert\nNext k\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3214725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66299c5e690345a3ddacefc4f2c60b80?s=128&d=identicon&r=PG&f=1", "display_name": "user3214725", "link": "https://stackoverflow.com/users/3214725/user3214725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 30361884, "answer_count": 1, "score": 0, "last_activity_date": 1432163458, "creation_date": 1432160610, "last_edit_date": 1531161705, "question_id": 30361410, "link": "https://stackoverflow.com/questions/30361410/macro-to-insert-user-defined-number-of-columns", "title": "macro to insert user defined number of columns", "body": "<p>i have the following code which will add 7 columns every time a run it after every column that contains data from cell D3. is there a way to add a message box that will ask for the amount of lines that we want to add?</p>\n\n<pre><code>dim j As Integer, k As Integer\nj = Range(\"D3\").End(xlToRight).Column\n'j is the last column\nFor k = j To 5 Step -1\nRange(Cells(1, k), Cells(3, k + 6)).EntireColumn.Insert\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": true, "score": 2, "last_activity_date": 1432159007, "creation_date": 1432159007, "answer_id": 30361086, "question_id": 30361042, "link": "https://stackoverflow.com/questions/30361042/getting-the-next-row-while-trying-to-delete-a-range-of-rows-using-vba-what-is-w/30361086#30361086", "title": "Getting the next row while trying to delete a range of rows using vba. What is wrong", "body": "<p>When deleting rows, it's a good idea to work backwards.  Try this:  </p>\n\n<pre><code>Sub Keeptop3()\nDim lastrow As Integer\nlastrow = ActiveSheet.UsedRange.Rows.Count\nFor i = lastrow to 4 Step -1\n    Rows(i).Delete\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1432163712, "post_id": 30361120, "comment_id": 48815352, "body": "I would love to understand why the point down? This can only be considered not useful due to lack of knowledge."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1432170221, "post_id": 30361120, "comment_id": 48817115, "body": "There are two reasons I downvoted: 1) It doesn&#39;t solve the poster&#39;s problem, which is that their code skips rows when it deletes them. TMH8885&#39;s answer solves the problem by looping backwards. 2) As discussed around the internet, your method of finding the last row is problematic. Two better methods are to use something list <code>Range(&quot;A&quot; &amp; Activesheet.Rows.Count).End(XlUp).Row</code> or the <code>Find</code> function. See this question: <a href=\"http://stackoverflow.com/q/71180/293078\">stackoverflow.com/q/71180/293078</a>"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1432178718, "post_id": 30361120, "comment_id": 48819179, "body": "Doug Glancy Thanks for your response: On 1: I would tend to agree. Mentioned that because the method originally used (also in TMH8885 answer) for finding the last row is inaccurate. Probably should had use a comment instead (but I just got that privilege today, not familiar with it). On 2: I have to disagree. Almost everything I read about being a problem (as you mentioned) comes out of misunderstanding of the fact that UsedRange is a range and not always starts from row 1, thus counting rows is inaccurate."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1432179012, "post_id": 30361120, "comment_id": 48819264, "body": "As per other two methods you mentioned Range(&quot;A&quot; &amp; Activesheet.Rows.Count).End(XlUp).Row  Gives the last row not empty in column A (provided that the last row of column A is empty) not in the worksheet i.e. if the last cell with data in column A is A15 and in column E is E21. What about if the reference column is E but there is data in cell A22. Errors within the input data are not identified concurrently. I have done some research, in addition to what is in internet, as such if you are interested on the topic let&#39;s talk over the chat. Once again thanks for letting me know your reasons."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1432185000, "post_id": 30361120, "comment_id": 48821127, "body": "Thanks for the response.The problem with using the <code>UsedRange</code> is that sometimes it contains a lot of blanks at the bottom due to cells having been cleared and the workbook not yet saved. Your point about the last cell in A not necessarily equating to the last row can be true, of course, which is when you can use the Find method that I mentioned. Your suggestion of xlTypeLastCell was certainly an improvement over the original and I wouldn&#39;t have downvoted your post just for that. It was because the answer didn&#39;t address the problem."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": -1, "last_activity_date": 1432159170, "creation_date": 1432159170, "answer_id": 30361120, "question_id": 30361042, "link": "https://stackoverflow.com/questions/30361042/getting-the-next-row-while-trying-to-delete-a-range-of-rows-using-vba-what-is-w/30361120#30361120", "title": "Getting the next row while trying to delete a range of rows using vba. What is wrong", "body": "<p>replace this:</p>\n\n<pre><code>lastrow = ActiveSheet.UsedRange.Rows.Count\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>lastrow = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1432209683, "creation_date": 1432209683, "answer_id": 30373146, "question_id": 30361042, "link": "https://stackoverflow.com/questions/30361042/getting-the-next-row-while-trying-to-delete-a-range-of-rows-using-vba-what-is-w/30373146#30373146", "title": "Getting the next row while trying to delete a range of rows using vba. What is wrong", "body": "<p>If just want to keep the first 3 rows, <em>(deleting all other regardless of their contents)</em>. Then just delete the range that goes from the 4th row to the last row, verifying that the last row is higher than 3. There is not need, <em>if this is the case</em>, to go one by one.</p>\n\n<p>See code below <em>(notice change of DataType for LastRow variable)</em></p>\n\n<pre><code>Sub Keeptop3()\nDim lastrow As Long\n    With ActiveSheet\n        lastrow = .UsedRange.SpecialCells(xlLastCell).Row\n        If lastrow &gt; 3 Then .Rows(\"4:\" &amp; lastrow).Delete\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 30361086, "answer_count": 3, "score": 0, "last_activity_date": 1432209683, "creation_date": 1432158795, "last_edit_date": 1432158947, "question_id": 30361042, "link": "https://stackoverflow.com/questions/30361042/getting-the-next-row-while-trying-to-delete-a-range-of-rows-using-vba-what-is-w", "title": "Getting the next row while trying to delete a range of rows using vba. What is wrong", "body": "<pre><code>Sub Keeptop3()\n  Dim lastrow As Integer\n  lastrow = ActiveSheet.UsedRange.Rows.Count\n  For i = 4 To lastrow\n    Rows(i).Delete\n  Next i\nEnd Sub\n</code></pre>\n\n<p>I have used the lastrow to find the count of rows. I need only the top 3 rows. I am getting them plus the 5th row. </p>\n\n<p>When I make it i=4, I get the top 2 rows and the 4th row. </p>\n\n<p>What is wrong with my code?</p>\n"}, {"tags": ["vba", "excel", "range", "cells"], "comments": [{"owner": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "edited": false, "score": 0, "creation_date": 1432157890, "post_id": 30360825, "comment_id": 48813390, "body": "Hardcoding   <code>Set SourceRange = WorkBk.Worksheets(1).Range(Cells(FindRow + 2, FindCol), Cells(LastRow, FindCol)) </code>  to   <code>Set SourceRange = WorkBk.Worksheets(1).Range(&quot;K14:K&quot; &amp; Last Row) </code>  works though. But that&#39;s not what I want."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432158415, "post_id": 30360825, "comment_id": 48813591, "body": "Error 1004 sometimes means that you&#39;ve got too large a number for rows or columns. Have you checked the value of the variables <code>FindRow</code>, <code>FindCol</code> etc?   When you use the Cells method it is always a good idea to fully reference it with a workbook and a worksheet."}, {"owner": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432161436, "post_id": 30360825, "comment_id": 48814670, "body": "They are both 0. I tried to fully reference them by  <code>Set SourceRange = WorkBk.Worksheets(1).Range(WorkBk.Worksheets(1).Cells(FindRo&zwnj;&#8203;w + 2, FindCol), WorkBk.Worksheets(1).Cells(LastRow, FindCol)) </code>  No luck"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432162261, "post_id": 30360825, "comment_id": 48814915, "body": "Sounds like the Find isn&#39;t finding the text. Does the text exist? Try changing this line <code>With Range(Cells(1, ColCount), Cells(LastRow, ColCount)) </code> to be fully referenced. Is this <code>ActiveSheet</code> or is it <code>WorkBk.Worksheets(1)</code>? Also, why are you looping <code>For ColCount = 1 To LastCol</code>? You could just use the Find method on the whole range. Something like <code>WorkBk.Worksheets(1).Range(&quot;A1&quot;).CurrentRegion.Find...</code>"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432162328, "post_id": 30360825, "comment_id": 48814941, "body": "Also, this <code>Set rFind = .Find(What:=&quot;Tx Throughput [kbps]&quot;, LookIn:=xlValues, LookAt:=xlWhole) </code> expects to find a cell that only contains the text &quot;Tx Throughput [kbps]&quot; and nothing else."}, {"owner": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432163589, "post_id": 30360825, "comment_id": 48815312, "body": "Hi I modified the code as you suggested like so:         <code>With Range(WorkBk.Worksheets(1).Cells(1, ColCount), WorkBk.Worksheets(1).Cells(LastRow, ColCount))             Set rFind = WorkBk.Worksheets(1).Range(&quot;A1&quot;).CurrentRegion.Find(What:=&quot;T&zwnj;&#8203;x Throughput [kbps]&quot;, LookIn:=xlValues, LookAt:=xlWhole)             If Not rFind Is Nothing Then                 FindRow = rFind.Row                 FindCol = rFind.Column             End If         End With</code>  But get a 1004 error on line         <code>With Range(WorkBk.Worksheets(1).Cells(1, ColCount), WorkBk.Worksheets(1).Cells(LastRow, ColCount))</code>"}, {"owner": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432163672, "post_id": 30360825, "comment_id": 48815335, "body": "The text definitely exists as I copied it directly from the file. I redid it multiple times to make sure. This code worked on another module but just doesn&#39;t now on the userform. (Thanks so much for your help)"}, {"owner": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432165349, "post_id": 30360825, "comment_id": 48815852, "body": "Wow! Thanks so much! I used the CurrentRegion method and it worked"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "edited": false, "score": 0, "creation_date": 1432161256, "post_id": 30360919, "comment_id": 48814616, "body": "I tried this without luck. I believe the error is in FindRow and FindCol because they are both assigned 0 when the error occurs. They shouldn&#39;t be 0 since the text exists in the sheet. I&#39;m not sure why though..."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "edited": false, "score": 0, "creation_date": 1432215413, "post_id": 30360919, "comment_id": 48840406, "body": "Based on your code, I would guess it&#39;s because it&#39;s not finding the string you specified: &quot;Tx Throughput [kbps]&quot;"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 4, "last_activity_date": 1432158220, "creation_date": 1432158220, "answer_id": 30360919, "question_id": 30360825, "link": "https://stackoverflow.com/questions/30360825/error-1004-when-using-range-cell/30360919#30360919", "title": "Error 1004 When using Range Cell", "body": "<p>I believe you need to reference your worksheet when using Cells:  </p>\n\n<pre><code>Set SourceRange = WorkBk.Worksheets(1).Range(WorkBk.Worksheets(1).Cells(FindRow + 2, FindCol), WorkBk.Worksheets(1).Cells(LastRow, FindCol))  \n</code></pre>\n\n<p>It will help a lot if you create a variable for this worksheet, will make it much easier to read and modify.</p>\n"}], "owner": {"reputation": 71, "user_id": 4922305, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/763576823762331/picture?type=large", "display_name": "Lalaluye", "link": "https://stackoverflow.com/users/4922305/lalaluye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1728, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432161276, "creation_date": 1432157758, "last_edit_date": 1432161276, "question_id": 30360825, "link": "https://stackoverflow.com/questions/30360825/error-1004-when-using-range-cell", "title": "Error 1004 When using Range Cell", "body": "<p>I am facing run time errors 1004 with this piece of code. It is strange because this code worked in another module, but when I placed this in a userform sheet, it doesn't work.               </p>\n\n<p>I found the issue occurring on this line when using breakpoints            </p>\n\n<pre><code>Set SourceRange = WorkBk.Worksheets(1).Range(Cells(FindRow + 2, FindCol), Cells(LastRow, FindCol)) \n</code></pre>\n\n<p>I have researched and tried everything such as </p>\n\n<pre><code>Set SourceRange = WorkBk.Worksheets(1).Range(Cells(FindRow + 2, FindCol)).Resize(LastRow)\n\nSet SourceRange = WorkBk.Worksheets(1).Range(Cells(FindRow + 2, FindCol)).Resize(LastRow, LastCol) \nWith WorkBk.Worksheets(1) \n.Range(.Cells(FindRow + 2, FindCol), .Cells(FindRow + 2, FindCol)) \nEnd With\n</code></pre>\n\n<p>And none seemed to work. Again this code worked before on another module. I don't know why it's not working when I put in under the command button sub for userform. </p>\n\n<p>Please help</p>\n\n<p>Full Code:</p>\n\n<pre><code>Dim FileName As String \nDim SummarySheet As Worksheet \nDim WorkBk As Workbook \nDim FolderPath As String \nDim LastRow As Long \nDim LastCol As Long \nDim NRow As Long \nDim NCol As Long \nDim SourceRange As Range \nDim DestRange As Range \n\n\n' Create a new workbook and set a variable to the first sheet.\nSet SummarySheet = Workbooks.Add(xlWBATWorksheet).Worksheets(1) \n\n' Set Worksheet Name\nActiveSheet.Name = \"BTS1 DL_HARQ\" \n\n' Call Dir the first time, pointing it to all Excel files in the folder path.\nFileName = Dir(FolderPath &amp; \"*BTS1_PHYMAC(DL_HARQ).csv*\") \n\n' Initialize column to 1\nNCol = 1 \n\n\n' Loop until Dir returns an empty string.\nDo While FileName &lt;&gt; \"\" \n\n' NRow keeps track of where to insert new rows in the destination workbook.\nNRow = 1 \n\n' Open a workbook in the folder\nSet WorkBk = Workbooks.Open(FolderPath &amp; FileName) \n\n' Set the cell in row 1 to be the file name.\nSummarySheet.Cells(1, NCol) = FileName \n\n'Find the last row to be copied\nLastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row \n\n'Find the last row to be copied\nLastCol = ActiveSheet.Cells(13, Columns.Count).End(xlToLeft).Column \n\n' Set the source range to be K14 to last row\n' Modify this range for your workbooks.\n' It can span multiple rows.\n' Set SourceRange = WorkBk.Worksheets(1).Range(\"K14:K\" &amp; Lastrow)\n\nDim rFind As Range \nDim ColCount As Long \nDim FindRow As Long \nDim FindCol As Long \n\nFor ColCount = 1 To LastCol \nWith Range(Cells(1, ColCount), Cells(LastRow, ColCount)) \nSet rFind = .Find(What:=\"Tx Throughput [kbps]\", LookIn:=xlValues, LookAt:=xlWhole) \nIf Not rFind Is Nothing Then \nFindRow = rFind.Row \nFindCol = rFind.Column \nEnd If \nEnd With \nNext ColCount \n\nSet SourceRange = WorkBk.Worksheets(1).Range(Cells(FindRow + 2, FindCol), Cells(LastRow, FindCol)) \n\n' Set the destination range to start at row 2 and\n' be the same size as the source range.\nSet DestRange = SummarySheet.Cells(NRow + 1, NCol) \nSet DestRange = DestRange.Resize(SourceRange.Rows.Count, _ \nSourceRange.Columns.Count) \n\n' Copy over the values from the source to the destination.\nDestRange.Value = SourceRange.Value \n\n' Increase NRow so that we know where to copy data next.\nNRow = NRow + DestRange.Rows.Count \n\n' Close the source workbook without saving changes.\nWorkBk.Close savechanges:=False \n\n' Use Dir to get the next file name.\nFileName = Dir() \n\n' Increase NCol to copy the next file on the next column\nNCol = NCol + 1 \nLoop \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1432157366, "post_id": 30360654, "comment_id": 48813164, "body": "<code>update yourtable set m_id=1</code>, and change <code>yourtable</code> in a loop once you get a list of all the table names."}], "answers": [{"tags": [], "owner": {"reputation": 6511, "user_id": 4765200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb1ac82079e2f813975cfa1aad1e234?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Pressler", "link": "https://stackoverflow.com/users/4765200/brian-pressler"}, "is_accepted": false, "score": 0, "last_activity_date": 1432160626, "creation_date": 1432160626, "answer_id": 30361413, "question_id": 30360654, "link": "https://stackoverflow.com/questions/30360654/change-all-values-in-a-field-in-a-ms-access-database-to-a-constant/30361413#30361413", "title": "Change all values in a field in a MS Access database to a constant", "body": "<p>You can loop through each table and run an update statement with docmd.ExecuteSQL.  Like this:</p>\n\n<pre><code>Option Explicit\nOption Compare Database\n\nSub ClearAllFields()\nDim db As DAO.Database\nDim tdf As DAO.TableDef\nDim fdf As DAO.Field\nSet db = CurrentDb\n\nDoCmd.SetWarnings False\nFor Each tdf In db.TableDefs\n    If Not (tdf.Name Like \"MSys*\" Or tdf.Name Like \"~*\") Then\n        For Each fdf In tdf.Fields\n            If fdf.Name = \"M_ID\" Then DoCmd.RunSQL \"update \" + tdf.Name + \" set M_ID = 1\"\n        Next\n    End If\nNext\nSet tdf = Nothing\nSet db = Nothing\nDoCmd.SetWarnings True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4811671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625c4134cad5f22462d1aac5dbb77efe?s=128&d=identicon&r=PG&f=1", "display_name": "amamdouh", "link": "https://stackoverflow.com/users/4811671/amamdouh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611573614, "creation_date": 1432157046, "question_id": 30360654, "link": "https://stackoverflow.com/questions/30360654/change-all-values-in-a-field-in-a-ms-access-database-to-a-constant", "title": "Change all values in a field in a MS Access database to a constant", "body": "<p>I have a MS Access database with 100 tables, each has a field named \"M_ID\"\nI want all the values in the field named \"M_ID\" in each table to be set to a constant, for example \"1\"\nhow can I do that using VBA?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432157665, "post_id": 30360646, "comment_id": 48813300, "body": "Which bit is not working? The VBA help says:  Before calling Rnd, use the Randomize statement without an argument to initialize the random-number generator with a seed based on the system timer.  To produce random integers in a given range, use this formula:  Int((upperbound - lowerbound + 1) * Rnd + lowerbound)    Here, upperbound is the highest number in the range, and lowerbound is the lowest number in the range.  As your Associates array is from 0 to 6, then shouldn&#39;t you be using Int(7 * Rnd() + 0)"}, {"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432157904, "post_id": 30360646, "comment_id": 48813391, "body": "I&#39;d probably try generating the random number first, assign it to a variable, and then pass the variable into <code>Associates()</code>. That way you&#39;ll be able to see what number is actually being generated"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432161173, "post_id": 30360646, "comment_id": 48814589, "body": "@kaybee99 by pass the variable do you mean add it to the array?  so, Associates(7) = (Associates(Int(Rnd() * 7) + 1))?"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432161186, "post_id": 30360646, "comment_id": 48814594, "body": "@ChipsLetten maybe that&#39;s all it is, I will try this"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432161808, "post_id": 30360646, "comment_id": 48814778, "body": "kaybee99 means store the value in an integer, e.g. <code>randomNum = Int(Rnd() * 7) + 1</code> and then use <code>Associates(randomNum)</code> because then you can use <code>Debug.Print randomNum</code> to see what number the code produced."}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432162075, "post_id": 30360646, "comment_id": 48814854, "body": "@ChipsLetten I see, i will try that.  for the record, and I&#39;m sorry I didn&#39;t state this before, but right now it always assigns to Bobby (2052)"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432162626, "post_id": 30360646, "comment_id": 48815027, "body": "Has the <code>AudTellerID </code> field been set to NULL by some other process?"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432162773, "post_id": 30360646, "comment_id": 48815064, "body": "@ChipsLetten no, they start out unassigned (ID is null) and this is the process to assign them.  I might not need that criteria in there, but I have it in there right now, just in case"}, {"owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "reply_to_user": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432236513, "post_id": 30360646, "comment_id": 48854526, "body": "It looks like what @kaybee99 suggested is working.  I also changed it to <code>Int(Rnd() * 7) + 0</code> as per @ChipsLetten &#39;s suggestion and I can&#39;t tell right now if that helped or did nothing, but it didn&#39;t hurt.  I&#39;ll keep testing.  Let me know if I should convert this to an answer so I can give points to whoever.  and a big thanks to both of you!"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1432192671, "creation_date": 1432192671, "answer_id": 30367002, "question_id": 30360646, "link": "https://stackoverflow.com/questions/30360646/access-vba-random-function-not-working/30367002#30367002", "title": "Access vba random function not working", "body": "<p>The trick is to use a negative seed that changes constantly.</p>\n\n<p>So add a time dependant seed to Rnd which changes for every unique id like in this sample select query:</p>\n\n<pre><code> SELECT \n   Table1.ID, \n   Table1.SomeField, \n   Table1.AnotherField, \n   Rnd(-Timer()*[ID]) AS RandomIndex \n FROM \n   Table1\n ORDER BY \n   Rnd(-Timer()*[ID]);\n</code></pre>\n\n<p>In your code, the expression could be something like this:</p>\n\n<pre><code>.. \" &amp; (Associates(Int(Rnd(-Timer()*\" &amp; [ID] &amp; \") * 7) + 1)) &amp; \" ..\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": true, "score": 1, "last_activity_date": 1432241789, "creation_date": 1432241789, "answer_id": 30384166, "question_id": 30360646, "link": "https://stackoverflow.com/questions/30360646/access-vba-random-function-not-working/30384166#30384166", "title": "Access vba random function not working", "body": "<p>As per my comment, try generating the random number first, assign it to a variable, and then pass the variable into <code>Associates()</code>. </p>\n\n<pre><code>Dim rndInt as Integer\n\nrndInt = Int(Rnd() * 7) + 1\n\nAssociates(rndInt)\n</code></pre>\n\n<p>Then as @Chips said, you can use</p>\n\n<pre><code>Debug.print rndInt \n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Msgbox rndInt \n</code></pre>\n\n<p>to check its value</p>\n\n<p>That way you'll be able to see what number is actually being generated</p>\n"}], "owner": {"reputation": 233, "user_id": 4142236, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d5582582d59d46fe1a96c88dfe4d8004?s=128&d=identicon&r=PG&f=1", "display_name": "msim", "link": "https://stackoverflow.com/users/4142236/msim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 30384166, "answer_count": 2, "score": 1, "last_activity_date": 1432660559, "creation_date": 1432157016, "last_edit_date": 1432660559, "question_id": 30360646, "link": "https://stackoverflow.com/questions/30360646/access-vba-random-function-not-working", "title": "Access vba random function not working", "body": "<p>I have a sub that is supposed to take a number of assignments (this number changes daily) and assign them to 7 associates.  There are some conditions to this:</p>\n\n<p>If the # of assignment is less than 7, it assigns all of them to a random associate.\nIf the # is divisible by 7, it assigns an equal number to each.\nIf it is not divisible by 7, it assigns equally and then gives the remainder to a random associate.</p>\n\n<p>The problem is the random part.  I really don't understand how random works in vba, or at least it seems like it should be super easy, but it's not (maybe).  But I have this written and it's not working.  <code>(Associates(Int(Rnd() * 7) + 1))</code>.  Here is my relevant code:</p>\n\n<p>Earlier in the sub I create an array of the associates and I use some dcounts to get the total assignments for that day:</p>\n\n<pre><code>Dim Associates(6) As Integer\n    Associates(0) = 4687 'Anita\n    Associates(1) = 4247 'Alberto\n    Associates(2) = 2167 'Jeff\n    Associates(3) = 4334 'Lisa\n    Associates(4) = 4441 'Carrie\n    Associates(5) = 2052 'Bobby\n    Associates(6) = 4657 'Simona\n'\nDim Person As Variant\n'\nTotalPop = DCount(\"LNo\", \"qry_PT_Assign\")\nFractionPop = Int(TotalPop / 7)\nLeftPop = TotalPop - (FractionPop * 7)\n'\n</code></pre>\n\n<p>and then I try to actually assign them. </p>\n\n<pre><code>        'Assign to Associates\n        If TotalPop &lt; 7 Then\n            DoCmd.RunSQL \"UPDATE tbl_Assignments SET AudTellerID = \" &amp; (Associates(Int(Rnd() * 7) + 1)) &amp; \" WHERE AudTellerID IS NULL\"\n        ElseIf LeftPop = 0 Then\n            For Each Person In Associates\n                DoCmd.RunSQL \"UPDATE tbl_Assignments SET AudTellerID = \" &amp; Person &amp; \" WHERE LNo IN (SELECT TOP \" &amp; FractionPop &amp; \" LNo FROM tbl_Assignments WHERE AudTellerID Is Null)\"\n            Next\n        Else\n            For Each Person In Associates\n                DoCmd.RunSQL \"UPDATE tbl_Assignments SET AudTellerID = \" &amp; Person &amp; \" WHERE LNo IN (SELECT TOP \" &amp; FractionPop &amp; \" LNo FROM tbl_Assignments WHERE AudTellerID Is Null)\"\n            Next\n            DoCmd.RunSQL \"UPDATE tbl_Assignments SET AudTellerID = \" &amp; (Associates(Int(Rnd() * 7) + 1)) &amp; \" WHERE AudTellerID IS NULL\"\n        End If\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1432193023, "creation_date": 1432193023, "answer_id": 30367126, "question_id": 30360528, "link": "https://stackoverflow.com/questions/30360528/is-there-a-way-to-raise-the-forms-on-save-event/30367126#30367126", "title": "Is there a way to raise the form&#39;s on save event?", "body": "<p>What you are looking for is the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822421.aspx\" rel=\"nofollow\">BeforeUpdate</a> event.<br>\nIt occurs when the user intends to save a record by any means.<br>\nIf intending to give them feedback of successful update use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822097.aspx\" rel=\"nofollow\">AfterUpdate</a> even.</p>\n"}], "owner": {"reputation": 471, "user_id": 4616423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a46559e4c3f1704e0ba1ddfa70cc88?s=128&d=identicon&r=PG&f=1", "display_name": "rgo", "link": "https://stackoverflow.com/users/4616423/rgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 610, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644577, "creation_date": 1432156636, "last_edit_date": 1594644577, "question_id": 30360528, "link": "https://stackoverflow.com/questions/30360528/is-there-a-way-to-raise-the-forms-on-save-event", "title": "Is there a way to raise the form&#39;s on save event?", "body": "<p>Is there a way in VBA to detect when a user either clicks the pencil to save changes to a record, or presses the Save (Floppy disk) icon? </p>\n\n<p>I am looking for ways to detect the event so I can confirm the save was accepted. I am using Access 2013 as the front-end to a SharePoint list and occasionally have users form save event fail. Sometimes they will be notified via the updated record conflicts dialog, but I want to programmatically confirm the change if possible. </p>\n\n<p>Alternatively, I want to disable all save menus and icons in favor of using a button on the form.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["java", "c#", "excel", "web-services", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4922327, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d3e2f5b44b89fbe8c9ba9aaa2fdac438?s=128&d=identicon&r=PG", "display_name": "user4922327", "link": "https://stackoverflow.com/users/4922327/user4922327"}, "is_accepted": false, "score": 0, "last_activity_date": 1432158259, "creation_date": 1432158259, "answer_id": 30360929, "question_id": 30360526, "link": "https://stackoverflow.com/questions/30360526/use-c-or-vba-to-call-jersey-jax-rs-rest-webservice/30360929#30360929", "title": "Use C# or VBA to call Jersey JAX-RS REST Webservice", "body": "<p>That is the beauty of web services, they SHOULD be language agnostic. Basically you are just calling a url to return you some xml/json data which c# can handle.</p>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 4802180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b35ad7d8d14882e4b3b02c5cc28c298f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4802180/chris"}, "is_accepted": true, "score": 0, "last_activity_date": 1432161494, "creation_date": 1432161494, "answer_id": 30361553, "question_id": 30360526, "link": "https://stackoverflow.com/questions/30360526/use-c-or-vba-to-call-jersey-jax-rs-rest-webservice/30361553#30361553", "title": "Use C# or VBA to call Jersey JAX-RS REST Webservice", "body": "<p>Anything that can build an HTTP request matching the input expected for your Jersey REST service will work. JAX-WS and JAX-RS services are going to be exposed as agnostic access points for anything which can send an XML/JMS or HTTP request. You can confirm this by simply opening the endpoint in your web browser and trying to submit some GET requests that way.</p>\n"}], "owner": {"reputation": 137, "user_id": 4317315, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8Vatq.jpg?s=128&g=1", "display_name": "He Zhang", "link": "https://stackoverflow.com/users/4317315/he-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 30361553, "answer_count": 2, "score": 0, "last_activity_date": 1432161494, "creation_date": 1432156634, "question_id": 30360526, "link": "https://stackoverflow.com/questions/30360526/use-c-or-vba-to-call-jersey-jax-rs-rest-webservice", "title": "Use C# or VBA to call Jersey JAX-RS REST Webservice", "body": "<p>I have a Jersey REST webservice and it works fine with java client. Now I'm wondering is it possible to use C# or VBA to call this webservice? Sorry I am new to C#/VBA. I am trying to create a add-in for excel. As far as I know I can use these two to create add-in. So my questions are:</p>\n\n<ol>\n<li>What's the best way to create add-in in excel for getting/uploading data? Is Java possible? Or should I use C#?</li>\n<li>If I use C#, is it possible to call java webservice in C#? I want to upload data via this webservice.</li>\n</ol>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "edited": false, "score": 0, "creation_date": 1432156623, "post_id": 30360483, "comment_id": 48812788, "body": "Where would you like to put the result string?"}], "answers": [{"tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": false, "score": 2, "last_activity_date": 1432821622, "last_edit_date": 1432821622, "creation_date": 1432156760, "answer_id": 30360573, "question_id": 30360483, "link": "https://stackoverflow.com/questions/30360483/concatenation-in-vba/30360573#30360573", "title": "Concatenation in VBA", "body": "<pre><code>Dim oRng As Range\nDim cel As Range\nDim concStr as String\n\nSet oRng = Range(\"A1:A100\")\nconcStr = vbNullString\n\nFor Each cel in oRng\n\n    concStr = concStr &amp; cel.value\n\nNext cel\n\n''Do stuff with concStr\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1432157192, "creation_date": 1432157192, "answer_id": 30360689, "question_id": 30360483, "link": "https://stackoverflow.com/questions/30360483/concatenation-in-vba/30360689#30360689", "title": "Concatenation in VBA", "body": "<p>The <code>CONCATENATE</code> function doesn't work on a range but on separate cells, i.e. <code>CONCATENATE('Reference Sheet'!A1,'Reference Sheet'!A2,'Reference Sheet'!A3)</code>. If you always have 100 cells then you could use a loop:</p>\n\n<pre><code>Dim x As Integer\nDim formulaString As String\n\nformulaString= \"=CONCATENATE(\"\nFor x = 1 To 100\n    formulaString= formulaString &amp; \"'Reference Sheet'!A\" &amp; x &amp; \",\"\nNext x\n' Remove last comma\nformulaString= Left(formulaString, Len(formulaString) - 1)\n' Add closing bracket\nformulaString= formulaString&amp; \")\"\nSheets(\"Current\").Cells(1,1).Formula = formulaString\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1432158649, "creation_date": 1432158649, "answer_id": 30361013, "question_id": 30360483, "link": "https://stackoverflow.com/questions/30360483/concatenation-in-vba/30361013#30361013", "title": "Concatenation in VBA", "body": "<p>Work with arrays, first create an array to hold the input value <code>\"A1:A100\"</code>.\nThen convert all <em>numbers</em> to <em>strings</em> within the array and join the array to obtain the resulting string and enter it in the required cell.</p>\n\n<p>For this code using worksheets named <em>\"Source\"</em> and \"Target\" <em>(modify as required)</em></p>\n\n<p>Pls check comments in the code and see</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg264098.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg264098.aspx</a></p>\n\n<pre><code>Sub Rng_ConcatenateValues()\nDim aArySrc As Variant, vArySrc As Variant, sAryTrg As String\nDim l As Long\n\n    With ActiveWorkbook\n        Rem Set Input Array\n        aArySrc = WorksheetFunction.Transpose(.Worksheets(\"Source\").Range(\"A1:A100\"))\n        Rem Convert values to string\n        For l = LBound(aArySrc) To UBound(aArySrc)\n            aArySrc(l) = CStr(aArySrc(l))\n        Next\n        Rem Join Array Values\n        sAryTrg = Join(aArySrc, Chr(133))\n        Rem Post Resulting Concatenation\n        .Worksheets(\"Target\").Cells(1).Value = sAryTrg\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1432215813, "post_id": 30362423, "comment_id": 48840698, "body": "Thank you that works, is it possible to add a space between every cell value as this results in to continuous cell values?"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1432215956, "post_id": 30362423, "comment_id": 48840815, "body": "@meesha replace vbnullstring with chr(32)"}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1432216085, "post_id": 30362423, "comment_id": 48840920, "body": "Thank you for your help."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 3, "last_activity_date": 1432166953, "creation_date": 1432166953, "answer_id": 30362423, "question_id": 30360483, "link": "https://stackoverflow.com/questions/30360483/concatenation-in-vba/30362423#30362423", "title": "Concatenation in VBA", "body": "<p>Its a one-liner:</p>\n\n<pre><code>MsgBox Join(Application.Transpose(Range(\"A1:A100\")), vbNullString)\n</code></pre>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 30362423, "answer_count": 4, "score": 1, "last_activity_date": 1432821622, "creation_date": 1432156455, "question_id": 30360483, "link": "https://stackoverflow.com/questions/30360483/concatenation-in-vba", "title": "Concatenation in VBA", "body": "<p>I am trying to concatenate numbers in cells A1:A100 in to a single string. How do I do that referencing another sheet.Code is as follows </p>\n\n<pre><code>Sheets(\"Current\").Cells(1,1).Formula = \"=CONCATENATE('Reference Sheet'!A1:A100)\"\n</code></pre>\n\n<p>But I am not getting anything. Please help</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1432168473, "post_id": 30362551, "comment_id": 48816626, "body": "Note: I re-wrote the section that builds the new file name because I thought that might be a source of the problem, however I am less certain of that now."}, {"owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 0, "creation_date": 1432247961, "post_id": 30362551, "comment_id": 48860283, "body": "Hi Rachel, and thanks for taking the time to work on this! I put your code to the test using a file named &quot;B\u03b1ckup T\u03b5ster \u03a9.xlsm&quot;. Your code is able to confirm that the file exists, which is a step further than mine. It bugs up at the Kill command, and the debugger shows the variable as &quot;Backup Tester O.xlsm&quot;. Is there an alternative to Kill to delete a file?"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "reply_to_user": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 0, "creation_date": 1432256880, "post_id": 30362551, "comment_id": 48862830, "body": "I updated the code to use the <code>fs.Delete</code> command instead of the <code>Kill</code> command. <code>Kill</code> probably had the same issues as <code>Dir</code>, so this should work for you."}, {"owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "edited": false, "score": 0, "creation_date": 1432312394, "post_id": 30362551, "comment_id": 48891172, "body": "Thanks Rachel! This will be great! Also I really like your way of building the new file name; it&#39;s so simple and efficient! If I weren&#39;t such a new member I&#39;d up-arrow you."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1432256820, "last_edit_date": 1432256820, "creation_date": 1432167896, "answer_id": 30362551, "question_id": 30360423, "link": "https://stackoverflow.com/questions/30360423/activeworkbook-saveas-filename-using-special-characters/30362551#30362551", "title": "ActiveWorkbook.SaveAS filename:= using special characters", "body": "<p>The problem lies in the Dir() function as it converts the special characters to ANSI before checking for the file and thus fails for these cases. Use the FileSystemObject object instead:</p>\n\n<pre><code>Sub Backup()\n\nOn Error GoTo BackupError\n\n    Dim OriginalFile As String\n    OriginalFile = ActiveWorkbook.FullName\n\n    ' get back up file name\n    Dim BackupFile As String\n    Dim pos As Integer\n    pos = InStrRev(OriginalFile, \".\")\n    BackupFile = Mid$(OriginalFile, 1, pos - 1) &amp; \" (Back-Up).\" &amp; Mid$(OriginalFile, pos + 1)\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n'Step 5(A): If there is no backup file, create one using the same file name as the one you're working with and throw a \" (Back-up)\" on it.\n    Dim BUYoN As VbMsgBoxResult\n    Dim BULast As String\n    Dim fs As Object\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    With fs\n        If Not .FileExists(BackupFile) Then\n\n            ActiveWorkbook.SaveAs Filename:=BackupFile\n            ActiveWorkbook.Close\n            Workbooks.Open Filename:=OriginalFile\n            BUYoN = vbNo\n            BULast = Date &amp; \", \" &amp; Time\n            MsgBox \"A Backup has been created!\"\n\n        Else\n            BUYoN = MsgBox(\"This will restore the \" &amp; BULast &amp; \" backup and undo all changes made to this project. Continue?\" _\n                , vbYesNo, \"Revert to Backup?\")\n\n        End If\n    End With\n\n\n'Step 5(B): If a backup has been created, restore it over the current workbook and delete the backup.\n    If BUYoN = vbYes Then\n        ActiveWorkbook.Close\n        Workbooks.Open Filename:=BackupFile\n        ActiveWorkbook.SaveAs Filename:=OriginalFile\n        'Kill (BackupFile)\n        fs.Delete BackupFile\n        Dim BUCheck As String\n        BUCheck = \"Dead\"\n\n    End If\n\n'Step 6: Put things back to the way you found them, you're done!\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\n    Exit Sub\n\n\nOn Error GoTo 0\n\nBackupError:\n    MsgBox \"Attempt to Backup or Restore was unsuccessful\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "is_accepted": true, "score": 0, "last_activity_date": 1432252251, "creation_date": 1432252251, "answer_id": 30386253, "question_id": 30360423, "link": "https://stackoverflow.com/questions/30360423/activeworkbook-saveas-filename-using-special-characters/30386253#30386253", "title": "ActiveWorkbook.SaveAS filename:= using special characters", "body": "<p>I know we're not supposed to offer opinions, but it is my opinion that Rachel is a genius! I didn't know about the FileSystemObject, but that ended up being the key. Not only was it able to search for and recognized the file with special characters, but it appears it can delete it too. Incorporating that into the code makes it run flawlessly with or without special characters:</p>\n\n<pre><code>Public BULast As String\n\nSub Backup()\n\n'This macro imitates videogame save-states. It will save a backup that can replace the\n'current workbook later if you've made an irreversible mistake.\n\n'Step 1: Agree to run away if things go wrong (establish an error handler)\n    On Error GoTo BackupError\n\n'Step 2: Create some variables\n    Dim OriginalFile As String\n    Dim BUDir As String\n    Dim BUXAr() As String\n    Dim BUExt As String\n    Dim BUNam As String\n    Dim BackupFile As String\n    Dim BUfs As Object\n\n'Step 3: Define those variables\n    OriginalFile = ActiveWorkbook.FullName\n    BUDir = ActiveWorkbook.Path\n    BUXAr = Split(ActiveWorkbook.FullName, \".\")\n    BUExt = BUXAr(UBound(BUXAr))\n    BUNam = Replace(ActiveWorkbook.Name, \".\" &amp; BUExt, \"\") &amp; \" (Back-Up)\"\n    BackupFile = BUDir &amp; \"\\\" &amp; BUNam &amp; \".\" &amp; BUExt\n    Set BUfs = CreateObject(\"Scripting.FileSystemObject\")\n\n\n'Step 4: Hide the truth\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n'Step 5(A): If there is no backup file, create one using the same file name as the one\n'you're working with and throw a \" (Back-up)\" on it.\n\n    With BUfs\n        If Not .FileExists(BackupFile) Then\n\n            ActiveWorkbook.Save\n            ActiveWorkbook.SaveAs filename:=BackupFile\n\n            ActiveWorkbook.Close\n\n            Workbooks.Open filename:=OriginalFile\n\n            BUYoN = vbNo\n\n            BULast = Date &amp; \", \" &amp; Time\n\n            MsgBox \"A Backup has been created!\"\n\n        Else\n\n            BUYoN = MsgBox(\"This will restore the \" &amp; BULast &amp; \" backup and undo all changes made to this project. Continue?\" _\n                , vbYesNo, \"Revert to Backup?\")\n\n        End If\n    End With\n\n'Step 5(B): If a backup has been created, restore it over the current workbook and\n'delete the backup.\n    If BUYoN = vbYes Then\n\n        ActiveWorkbook.Close\n\n        Workbooks.Open filename:=BackupFile\n\n        ActiveWorkbook.SaveAs filename:=OriginalFile\n\n        BUfs.DeleteFile BackupFile, True\n\n    End If\n\n'Step 6: Put things back to the way you found them, you're done!\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\n    Exit Sub\n\n\n'Step 1 (Continued): If nothing went wrong, stop worrying about it, if something did,\n'say it didn't work and go away.\n\nOn Error GoTo 0\n\nBackupError:\n\n    MsgBox \"Attempt to Backup or Restore was unsuccessful\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4802546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yc137KHhOUg/AAAAAAAAAAI/AAAAAAAAAMs/Lqi5eRCP_sA/photo.jpg?sz=128", "display_name": "an\u0259\u02c8nim\u0259d\u0113", "link": "https://stackoverflow.com/users/4802546/an%c9%99%cb%88nim%c9%99d%c4%93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2089, "favorite_count": 0, "accepted_answer_id": 30386253, "answer_count": 2, "score": 1, "last_activity_date": 1432256820, "creation_date": 1432156252, "last_edit_date": 1432248519, "question_id": 30360423, "link": "https://stackoverflow.com/questions/30360423/activeworkbook-saveas-filename-using-special-characters", "title": "ActiveWorkbook.SaveAS filename:= using special characters", "body": "<p>Admittedly I'm bad at knowing the lingo, so while I <em>think</em> I researched this thoroughly, there may be the perfect answer somewhere. Here's my dilemma, I'm developing this Excel VBA macro to backup and restore the Worksheet (basically giving me infinite Undos to the point I specify and short-cutting around saving and reopening):</p>\n\n<pre><code>Public BULast As String\n\nSub Backup()\n\n'This macro imitates videogame save-states. It will save a backup that can replace to current workbook later if you've made an irreversible mistake.\n\n'Step 1: Agree to run away if things go wrong (establish an error handler)\nOn Error GoTo BackupError\n\n'Step 2: Create some variables\n    Dim OriginalFile As String\n    Dim BUDir As String\n    Dim BUXAr() As String\n    Dim BUExt As String\n    Dim BUNam As String\n    Dim BackupFile As String\n\n'Step 3: Define those variables\n    OriginalFile = ActiveWorkbook.FullName\n    BUDir = ActiveWorkbook.Path\n    BUXAr = Split(ActiveWorkbook.FullName, \".\")\n    BUExt = BUXAr(UBound(BUXAr))\n    BUNam = Replace(ActiveWorkbook.Name, \".\" &amp; BUExt, \"\") &amp; \" (Back-Up)\"\n    BackupFile = BUDir &amp; \"\\\" &amp; BUNam &amp; \".\" &amp; BUExt\n\n'Step 4: Hide the truth\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n'Step 5(A): If there is no backup file, create one using the same file name as the one you're working with and throw a \" (Back-up)\" on it.\n    If Dir(BackupFile) = \"\" Then\n\n        ActiveWorkbook.SaveAs filename:=BackupFile\n\n        ActiveWorkbook.Close\n\n        Workbooks.Open filename:=OriginalFile\n\n        BUYoN = vbNo\n\n        BULast = Date &amp; \", \" &amp; Time\n\n        MsgBox \"A Backup has been created!\"\n\n    Else\n\n        BUYoN = MsgBox(\"This will restore the \" &amp; BULast &amp; \" backup and undo all changes made to this project. Continue?\" _\n            , vbYesNo, \"Revert to Backup?\")\n\n    End If\n\n'Step 5(B): If a backup has been created, restore it over the current workbook and delete the backup.\n    If BUYoN = vbYes Then\n\n        ActiveWorkbook.Close\n\n        Workbooks.Open filename:=BackupFile\n\n        ActiveWorkbook.SaveAs filename:=OriginalFile\n\n        Kill (BackupFile)\n\n        BUCheck = \"Dead\"\n\n    End If\n\n'Step 6: Put things back to the way you found them, you're done!\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\n    Exit Sub\n\n'Step 1 (Continued): If nothing went wrong, stop worrying about it, if something did, say it didn't work and go away.\n\nOn Error GoTo 0\n\nBackupError:\n\n    MsgBox \"Attempt to Backup or Restore was unsuccessful\"\n\nEnd Sub\n</code></pre>\n\n<p>Normally it works as expected, but just yesterday it started not working and after playing around with it I realized it's because I was trying it on a file that has an \u03a9 symbol in the file name.</p>\n\n<p>The basic process is to look in the current directory for the active workbook's file name, but with (Back-up) tacked at the end. It will either create one, or replace the open one with what it finds. When done on an \u03a9 file however, it substitutes that character with an O. When ran again, it apparently <em>searches</em> the the \u03a9 correctly because it can't find any (even with the O-substitute file right there in plain sight).</p>\n\n<p>I know the easiest solution would be to just make sure people keep their file names to what you can see on a keyboard, but that doesn't work for me; I'm almost religious about putting the adaptability in the <em>code</em> rather than the user. So with that long-winded back story, here's my specific question:</p>\n\n<p><strong>Is there a SaveAs function or practical workaround in VBA that can handle special characters within the specified file name?</strong></p>\n"}, {"tags": ["vb.net", "vba", "excel"], "comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1432156411, "post_id": 30360386, "comment_id": 48812689, "body": "Why is there no output for group B?  And are you looking for distinct values?  The question is a bit confusing."}, {"owner": {"reputation": 89, "user_id": 2123244, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b6001c0c37d1d125d7d7c16c133f7a28?s=128&d=identicon&r=PG", "display_name": "user2123244", "link": "https://stackoverflow.com/users/2123244/user2123244"}, "reply_to_user": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1432157082, "post_id": 30360386, "comment_id": 48813036, "body": "Both values in group B are bigger than 2 - so do nothing. Not looking for distinct values, looking for values than are smaller than 2, and how many (for each group)"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2123244, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b6001c0c37d1d125d7d7c16c133f7a28?s=128&d=identicon&r=PG", "display_name": "user2123244", "link": "https://stackoverflow.com/users/2123244/user2123244"}, "edited": false, "score": 0, "creation_date": 1432194273, "post_id": 30360887, "comment_id": 48825781, "body": "Hey this doesn&#39;t seem to work so maybe I applied it badly. Why does First start from 3? I&#39;m assuming LastRow is a constant LastRow, where is the changing of LastRow happening? Seems like it is in the right direction though"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 1, "last_activity_date": 1432158015, "creation_date": 1432158015, "answer_id": 30360887, "question_id": 30360386, "link": "https://stackoverflow.com/questions/30360386/excel-macro-by-group/30360887#30360887", "title": "Excel macro by group", "body": "<p>Making some assumptions (that your column numbers were the same as in the example and that there is always a blank row between groups, here's a snippet to start with:  </p>\n\n<pre><code>Sub Test2()\nDim LastRow As Integer, First As Integer, Last As Integer\nLastRow = ActiveSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious, After:=[A1]).Row + 1\nFirst = 3\nFor i = 3 To LastRow\n    If Cells(i, 1).Value = \"\" Then\n        Last = i - 1\n        Cells(First - 1, 3).Value = Summ(First, Last)\n        First = i + 1\n    End If\nNext i\nEnd Sub\nPrivate Function Summ(First As Integer, Last As Integer)\nDim Count As Integer, Total As Integer\nFor t = First To Last\n    Total = Total + 1\n    If Cells(t, 2).Value &lt; 2 Then Count = Count + 1\nNext t\nSumm = Count / Total\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 4924116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-a_1R4GfOyoU/AAAAAAAAAAI/AAAAAAAAAP4/KYvDo45pYQg/photo.jpg?sz=128", "display_name": "Pedro F Pardo", "link": "https://stackoverflow.com/users/4924116/pedro-f-pardo"}, "is_accepted": true, "score": 1, "last_activity_date": 1432202165, "creation_date": 1432202165, "answer_id": 30370383, "question_id": 30360386, "link": "https://stackoverflow.com/questions/30360386/excel-macro-by-group/30370383#30370383", "title": "Excel macro by group", "body": "<pre><code>Sub calculatebygroups()\n    last_row = Cells.SpecialCells(xlCellTypeLastCell).Row\n    group_counter = 0\n    value_counter = 0\n    row_to_write = 0\n    For n = 1 To last_row + 1\n        If Range(\"A\" &amp; n).Value = \"\" Then\n            If row_to_write &lt;&gt; 0 And value_counter &lt;&gt; 0 Then\n                Range(\"C\" &amp; row_to_write).Value = \"'\" &amp; value_counter &amp; \"/\" &amp; group_counter\n            End If\n            row_to_write = n\n            group_counter = 0\n            value_counter = 0\n        Else\n            group_counter = group_counter + 1\n            If Range(\"B\" &amp; n).Value &lt; 2 Then\n                value_counter = value_counter + 1\n            End If\n        End If\n    Next n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 2123244, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b6001c0c37d1d125d7d7c16c133f7a28?s=128&d=identicon&r=PG", "display_name": "user2123244", "link": "https://stackoverflow.com/users/2123244/user2123244"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 30370383, "answer_count": 2, "score": -1, "last_activity_date": 1432202165, "creation_date": 1432156107, "last_edit_date": 1432161285, "question_id": 30360386, "link": "https://stackoverflow.com/questions/30360386/excel-macro-by-group", "title": "Excel macro by group", "body": "<p>The table example   </p>\n\n<pre><code>  column1     | column2 |  column3\n    --------------------------------------------\n              |         |\n      A       |     1   |  \n      A       |     2   |  \n      A       |     3   |\n              |         | \n      B       |     4   |  \n      B       |     4   |\n              |         | \n      C       |     1   |  \n      C       |     1   |  \n      C       |     5   |  \n</code></pre>\n\n<p>As you can see, they are grouped in the first column, second column is some value.\nI have no knowledge of VB and I haven't been able to figure it out myself for over an hour.</p>\n\n<p>What I want to do:</p>\n\n<p>For each group: </p>\n\n<p>count how many values are less than 2.</p>\n\n<p>If there is 1 or more such values, set column3 in the blank row above the group to <code>(numbers of values under 2 in group / total number of values in group)</code> </p>\n\n<p>If there are none, do nothing.</p>\n\n<p>Output of above table would be:</p>\n\n<pre><code>  column1     | column2 |  column3\n    --------------------------------------------\n              |         |   1/3\n      A       |     1   |  \n      A       |     2   |  \n      A       |     3   |\n              |         | \n      B       |     4   |  \n      B       |     4   |\n              |         |   2/3\n      C       |     1   |  \n      C       |     1   |  \n      C       |     5   |  \n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4922195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5a1094af3d6a83cef42e92e3c4c73a?s=128&d=identicon&r=PG&f=1", "display_name": "mike212", "link": "https://stackoverflow.com/users/4922195/mike212"}, "edited": false, "score": 0, "creation_date": 1432166574, "post_id": 30361931, "comment_id": 48816164, "body": "I see what you did there but it doesn&#39;t get me to where I want to be.  I have arrays of Day, Fees, and Total that I will populate as they are cacluated.  There will also be X versions of these arrays (VersionAry).  Then within each VersionAry will be the cDailyData class that holds individual dictionaries of fees, total and date.  Basically many versions will exist, each version with unique lists of fees, total and date."}, {"owner": {"reputation": 45, "user_id": 4922195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5a1094af3d6a83cef42e92e3c4c73a?s=128&d=identicon&r=PG&f=1", "display_name": "mike212", "link": "https://stackoverflow.com/users/4922195/mike212"}, "edited": false, "score": 0, "creation_date": 1432166614, "post_id": 30361931, "comment_id": 48816173, "body": "So the heirarchy would look like this...  VersionAry(1 to 3)  --&gt; cDailyData class --&gt; dictionary.fees, dictionary.total, dictionary.date  What confuses me is that the I would think that       VersionAry(1).dictFees.Add 1, 10  wouldn&#39;t also show up in VersionAry(2), but that seems to be what is happening."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 45, "user_id": 4922195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5a1094af3d6a83cef42e92e3c4c73a?s=128&d=identicon&r=PG&f=1", "display_name": "mike212", "link": "https://stackoverflow.com/users/4922195/mike212"}, "edited": false, "score": 0, "creation_date": 1432170191, "post_id": 30361931, "comment_id": 48817102, "body": "@mike212 - It&#39;s showing up in all of the array elements because it&#39;s the same object. You only instantiate one copy of cDailyData, then point 3 array elements at the same thing. If you need a Dictionary of Day/Fee/Total in each array element, I&#39;d recommend using an array of Dictionaries and filling them with class implementation above."}, {"owner": {"reputation": 45, "user_id": 4922195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5a1094af3d6a83cef42e92e3c4c73a?s=128&d=identicon&r=PG&f=1", "display_name": "mike212", "link": "https://stackoverflow.com/users/4922195/mike212"}, "edited": false, "score": 0, "creation_date": 1432299246, "post_id": 30361931, "comment_id": 48882205, "body": "Thank you.  This led me to the answer."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1432163736, "creation_date": 1432163736, "answer_id": 30361931, "question_id": 30360330, "link": "https://stackoverflow.com/questions/30360330/vba-filling-array-with-a-class-of-dictionaries/30361931#30361931", "title": "VBA - filling array with a class of dictionaries", "body": "<p>You're adding the same object into the array multiple times. The Dictionaries already hold your index, so you can just access them directly.  The Class would be a lot more useful if you gave them properties for Date, Fees, and Total, then stored multiple instances of <em>cDailyData</em> in a dictionary or an array.  The class should probably look more like this:</p>\n\n<pre><code>'Class Module named: cDailyData\nOption Explicit\n\nPrivate m_date As Long\nPrivate m_fees As Long\nPrivate m_total As Long\n\nPublic Property Let Day(in_value As Long)\n    m_date = in_value\nEnd Property\n\nPublic Property Get Day() As Long\n    Day = m_date\nEnd Property\n\nPublic Property Let Total(in_value As Long)\n    m_total = in_value\nEnd Property\n\nPublic Property Get Total() As Long\n    Total = m_total\nEnd Property\n\nPublic Property Let Fees(in_value As Long)\n    m_fees = in_value\nEnd Property\n\nPublic Property Get Fees() As Long\n    Fees = m_fees\nEnd Property\n</code></pre>\n\n<p>If your keys are non-sequential and unique, a Dictionary would be appropriate and the Module would look like this:</p>\n\n<pre><code>Sub ModuleCode2()\n\n    Dim VersionDict As New Dictionary\n    Dim result As New cDailyData\n\n    result.Day = 201501\n    result.Fees = 100\n    result.Total = 1000\n\n    VersionDict.Add 1, result\n\n    Set result = New cDailyData\n    result.Day = 201501\n    result.Fees = 200\n    result.Total = 2000\n\n    VersionDict.Add 2, result\n\n    Dim key As Variant\n    For Each key In VersionDict.Keys\n        Debug.Print VersionDict(key).Fees\n    Next key\n\nEnd Sub\n</code></pre>\n\n<p>If you don't really care what the key is and just need an array of cDailyData, that would look more like this:</p>\n\n<pre><code>Sub ModuleCode2a()\n    Dim VersionAry() As cDailyData\n    ReDim VersionAry(1 To 3)\n\n    Dim i As Integer\n    For i = 1 To 3\n        Set VersionAry(i) = New cDailyData\n    Next i\n\n    VersionAry(1).Day = 201501\n    VersionAry(1).Fees = 100\n    VersionAry(1).Total = 1000\n\n    VersionAry(2).Day = 201501\n    VersionAry(2).Fees = 200\n    VersionAry(2).Total = 2000\n\n    For i = 1 To 3\n        Debug.Print VersionAry(i).Fees\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 4922195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5a1094af3d6a83cef42e92e3c4c73a?s=128&d=identicon&r=PG&f=1", "display_name": "mike212", "link": "https://stackoverflow.com/users/4922195/mike212"}, "is_accepted": false, "score": 0, "last_activity_date": 1432299446, "creation_date": 1432299446, "answer_id": 30397341, "question_id": 30360330, "link": "https://stackoverflow.com/questions/30360330/vba-filling-array-with-a-class-of-dictionaries/30397341#30397341", "title": "VBA - filling array with a class of dictionaries", "body": "<p>I changed the code to create a new class each time and that seems to work</p>\n\n<pre><code>For i = 1 To 3\n    Set clsDailyResults = New cDailyData\n    clsDailyResults.Init\n    Set VersionAry(i) = clsDailyResults\nNext i\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>Set clsDailyResults = New cDailyData\nclsDailyResults.Init\n\nFor i = 1 To 3\n    Set VersionAry(i) = clsDailyResults\nNext i\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4922195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5a1094af3d6a83cef42e92e3c4c73a?s=128&d=identicon&r=PG&f=1", "display_name": "mike212", "link": "https://stackoverflow.com/users/4922195/mike212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432299446, "creation_date": 1432155838, "question_id": 30360330, "link": "https://stackoverflow.com/questions/30360330/vba-filling-array-with-a-class-of-dictionaries", "title": "VBA - filling array with a class of dictionaries", "body": "<p>I have created a class of dictionary objects.  I then initialize the class and put three blank copies into an array.   I then go ahead and fill in some of the dictionary values within the array.  The behavior isn't what I expected.</p>\n\n<p>After running the code I expected the array to fill in such that \n VersionAry(1) holds one item in each dictionary, VersionAry(2) holds one item in each dictionary, and VersionAry(3) remains empty.</p>\n\n<p>Instead each array element holds the identical two items.  </p>\n\n<p>It seems like this line:</p>\n\n<pre><code>VersionAry(1).dictDate.Add 1, 201501\n</code></pre>\n\n<p>actually adds 1, 201501 to the dictDate dictionary in VersionAry(1), VersionAry(2), and VersionAry(3) instead of just to VersionAry(1) which is my goal.   </p>\n\n<p>class code:</p>\n\n<pre><code>'Class Module named: cDailyData\n\nPublic dictDate As Object\nPublic dictTotal As Object\nPublic dictFees As Object\n\nPublic Sub Init()\n    Set dictDate = CreateObject(\"Scripting.Dictionary\")\n    Set dictTotal = CreateObject(\"Scripting.Dictionary\")\n    Set dictFees = CreateObject(\"Scripting.Dictionary\")\nEnd Sub\n</code></pre>\n\n<p>module code:</p>\n\n<pre><code>'Module Code\nSub ModuleCode2()\nDim clsDailyResults As cDailyData\n\nDim VersionAry() As Variant\nReDim VersionAry(1 To 3)\n\nSet clsDailyResults = New cDailyData\nclsDailyResults.Init\n\nFor i = 1 To 3\n    Set VersionAry(i) = clsDailyResults\nNext i\n\nVersionAry(1).dictDate.Add 1, 201501\nVersionAry(1).dictFees.Add 1, 100\nVersionAry(1).dictTotal.Add 1, 1000\n\nVersionAry(2).dictDate.Add 2, 201501\nVersionAry(2).dictFees.Add 2, 200\nVersionAry(2).dictTotal.Add 2, 2000\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1432153213, "post_id": 30359585, "comment_id": 48810884, "body": "<code>Data|Text To Columns|Fixed Width</code> on Column IMAGELIST?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1432153237, "post_id": 30359585, "comment_id": 48810901, "body": "Can we assume that the length of IMAGELIST will always be divisible by 8?"}, {"owner": {"reputation": 3, "user_id": 4900085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5c3051313478bfa9f359639afb1b5e?s=128&d=identicon&r=PG&f=1", "display_name": "tinytim", "link": "https://stackoverflow.com/users/4900085/tinytim"}, "edited": false, "score": 0, "creation_date": 1432153286, "post_id": 30359585, "comment_id": 48810929, "body": "yes always a 8 characters"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1432153543, "post_id": 30359585, "comment_id": 48811090, "body": "Welcome to SO! Reading <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> will help you get an answer sooner. Remember, this isn&#39;t a code-writing service, so post what you&#39;ve got &amp; we can help you fix it. If you don&#39;t know where to start, try using the Macro Recorder."}, {"owner": {"reputation": 3, "user_id": 4900085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5c3051313478bfa9f359639afb1b5e?s=128&d=identicon&r=PG&f=1", "display_name": "tinytim", "link": "https://stackoverflow.com/users/4900085/tinytim"}, "edited": false, "score": 0, "creation_date": 1432153556, "post_id": 30359585, "comment_id": 48811098, "body": "Siddharth Rout -   Data|Text To Columns|Fixed Width  does split it but would it not be a lot harder to achieve the end results from multiple columns rather then from the original one cell?"}, {"owner": {"reputation": 3, "user_id": 4900085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5c3051313478bfa9f359639afb1b5e?s=128&d=identicon&r=PG&f=1", "display_name": "tinytim", "link": "https://stackoverflow.com/users/4900085/tinytim"}, "edited": false, "score": 0, "creation_date": 1432153806, "post_id": 30359585, "comment_id": 48811240, "body": "I can fully respect that. Its just that my attempts at this are so far off that i am not sure what there is to build on."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432154448, "post_id": 30359585, "comment_id": 48811626, "body": "A simple loop and <code>Mid</code> will get the characters out.  You can then drop them into a column and pull the other text over.  I suspect an outer loop for each original item can drive this and get the other info.  Here is the inner loop.  <code>ActiveCell</code> would be whatever range is used for each cell in <code>IMAGELIST</code>.  <code>For i = 1 To Len(ActiveCell) Step 8 : img_item = Mid(ActiveCell, i, 8) : Next</code>"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1432154455, "post_id": 30359585, "comment_id": 48811630, "body": "And are the columns shown in your second example the only ones that you need copied into Sheet2?"}, {"owner": {"reputation": 344, "user_id": 4475014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yx5fq.jpg?s=128&g=1", "display_name": "Engineer Toast", "link": "https://stackoverflow.com/users/4475014/engineer-toast"}, "edited": false, "score": 1, "creation_date": 1432924223, "post_id": 30359585, "comment_id": 49146909, "body": "If your data comes from access like the <a href=\"http://superuser.com/q/921311/348859\">possible duplicate</a> posted over on SuperUser, then there&#39;s an easy <a href=\"http://superuser.com/a/921325/348859\">solution in Access</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4900085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5c3051313478bfa9f359639afb1b5e?s=128&d=identicon&r=PG&f=1", "display_name": "tinytim", "link": "https://stackoverflow.com/users/4900085/tinytim"}, "edited": false, "score": 0, "creation_date": 1432155677, "post_id": 30360052, "comment_id": 48812284, "body": "Sorry for the slow response. Bummer still at work. I will have to wait till later tonight to work on getting the loop to get the other fields.Thank you so much for starting me down the right path. I was lost."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 3, "user_id": 4900085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5c3051313478bfa9f359639afb1b5e?s=128&d=identicon&r=PG&f=1", "display_name": "tinytim", "link": "https://stackoverflow.com/users/4900085/tinytim"}, "edited": false, "score": 0, "creation_date": 1432155867, "post_id": 30360052, "comment_id": 48812398, "body": "Happy to help.  Let me know if you run into any roadblocks getting the other columns in.  Should be a pretty simple For loop."}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 0, "last_activity_date": 1432154733, "creation_date": 1432154733, "answer_id": 30360052, "question_id": 30359585, "link": "https://stackoverflow.com/questions/30359585/how-to-split-a-cell/30360052#30360052", "title": "How to split a cell", "body": "<p>Here's a code snippet for you to get started with (assuming you're copying from Sheet1 to Sheet2):  </p>\n\n<pre><code>Sub Test2()\nDim wsSheet As Worksheet\nSet wsSheet = ActiveWorkbook.Worksheets(\"Sheet1\")\nDim LastRow As Integer, RowsToCopy As Integer, Counter As Integer, Step As Integer, ILCol As Integer\nILCol = 4\nCounter = 2\nLastRow = wsSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious, After:=[A1]).Row\nFor i = 2 To LastRow\n    RowsToCopy = Len(wsSheet.Cells(i, ILCol)) / 8\n    Step = 1\n    For t = 1 To RowsToCopy\n        ActiveWorkbook.Sheets(\"Sheet2\").Cells(Counter, 4).Value = CStr(Mid(wsSheet.Cells(i, ILCol).Value, Step, 8))\n        Step = Step + 8\n        Counter = Counter + 1\n    Next t\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Just change the ILCol = 4 to whatever column the IMAGELIST column is in.  You'll still have to write in a loop to copy over the other columns, then format the new column as \"00000000\", but this should be a good start.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4900085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5c3051313478bfa9f359639afb1b5e?s=128&d=identicon&r=PG&f=1", "display_name": "tinytim", "link": "https://stackoverflow.com/users/4900085/tinytim"}, "edited": false, "score": 0, "creation_date": 1432212913, "post_id": 30360572, "comment_id": 48838558, "body": "Thank you both and SO! Wish I would have ask for some guidance earlier. Embarrassing but I have been working on this for more then a few weeks. But now I can study what you guys achieved in no time and find out where I was going wrong. Thanks again you rock!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1432156757, "creation_date": 1432156757, "answer_id": 30360572, "question_id": 30359585, "link": "https://stackoverflow.com/questions/30359585/how-to-split-a-cell/30360572#30360572", "title": "How to split a cell", "body": "<p>With <strong>IDNUM</strong> in A1 (as per the sample image), run through this code.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/6t2ko.png\" alt=\"IMAGESET split\"></p>\n\n<pre><code>Sub split_img_set()\n    Dim rw As Long, lr As Long, v As Long, vi As Long, vVALs As Variant\n\n    With ActiveSheet   '&lt;-set this worksheet reference properly!!\n        lr = .Cells(Rows.Count, 2).End(xlUp).Row\n        .Cells(lr + 3, 2).Resize(1, 4) = Array(.Cells(1, 2).Value, .Cells(1, 3).Value, .Cells(1, 3).Value, \"IMAGES\")\n        For rw = 2 To lr\n            vVALs = .Cells(rw, 2).Resize(1, 6).Value\n            vi = Len(vVALs(1, UBound(vVALs, 2)))\n            For v = 1 To vi Step 8\n                .Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Resize(1, 3) = Array(vVALs(1, 1), vVALs(1, 2), vVALs(1, 3))\n                .Cells(Rows.Count, 2).End(xlUp).Offset(0, 3).NumberFormat = \"@\"\n                .Cells(Rows.Count, 2).End(xlUp).Offset(0, 3) = Mid(vVALs(1, UBound(vVALs, 2)), v, 8)\n            Next v\n        Next rw\n    End With\nEnd Sub\n</code></pre>\n\n<p>The results will be created under the existing values. There may have been a posting error but the first two sample IMAGELIST values were <em>not</em> directly divisible by <em>8</em>, being <em>255</em> characters in length.</p>\n"}], "owner": {"reputation": 3, "user_id": 4900085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5c3051313478bfa9f359639afb1b5e?s=128&d=identicon&r=PG&f=1", "display_name": "tinytim", "link": "https://stackoverflow.com/users/4900085/tinytim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1433043859, "answer_count": 2, "score": 0, "last_activity_date": 1432297217, "creation_date": 1432153071, "last_edit_date": 1432297217, "question_id": 30359585, "link": "https://stackoverflow.com/questions/30359585/how-to-split-a-cell", "closed_reason": "Needs more focus", "title": "How to split a cell", "body": "<p>I was wondering if there is a way to split the cells in imagelist into 8 characters segments putting each 8 characters on sheet2 and include field1, field2, field3 for each line?</p>\n\n<pre><code>IDNUM   FIELD1  FIELD2  FIELD3  CONVSTATUS  DUPEID  IMAGELIST\n7   Person1 07/20/1982  20321   4   0   000001370000013900000140000001410000014200000143000001440000014500000146000001470000014800000149000001500000015100000152000001530000015400000155000001560000015700000158000001590000016000000161000001620000016300000164000001650000016600000167000001680000016\n8   Person2 08/20/1984  240761  4   1   000002030000020400000205000002060000020700000208000002090000021000000212000002160000021700000218000002190000022000000221000002220000022300000224000002250000022600000227000002280000022900000230000002310000023200000233000002340000023500000236000002370000023\n9   Person3 09/13/1986  240762  4   1   00000403000004040000040500000406000004070000040800000409000004100000041200000416\n\u200b\n</code></pre>\n\n<p>This is what I am hoping to archive in the end. (shortened due to imagelist can very greatly in size) </p>\n\n<pre><code>Person1 07/20/1982  20321   00000137\nPerson1 07/20/1983  20322   00000139\nPerson1 07/20/1984  20323   00000140\nPerson2 08/20/1984  240761  00000203\nPerson2 08/20/1984  240761  00000204\nPerson2 08/20/1984  240761  00000205\nPerson3 09/13/1986  240762  00000403\nPerson3 09/13/1986  240762  00000404\nPerson3 09/13/1986  240762  00000405\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 3, "creation_date": 1432152121, "post_id": 30359210, "comment_id": 48810316, "body": "The newly created book1 (or whatever Excel calls it) should become the <code>ActiveWorkBook</code>, which you can assign to a variable and then just use the variable name to refer back to it when you want to switch back and forth."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1432152506, "post_id": 30359210, "comment_id": 48810533, "body": "@JoeMalpass: That is a valid answer. Why not post it as an answer with a small code sample? :)"}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1432152875, "post_id": 30359210, "comment_id": 48810714, "body": "@SiddharthRout ... I&#39;m just feeling lazy today. Someone else can have the points :)"}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1432153367, "post_id": 30359210, "comment_id": 48810976, "body": "Now I feel guilty. Answer below. Hahaha."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1432153440, "post_id": 30359210, "comment_id": 48811030, "body": "@JoeMalpass: It&#39;s too late now. Don&#39;t you think ;)?"}, {"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 0, "creation_date": 1432153818, "post_id": 30359210, "comment_id": 48811248, "body": "Maybe so, but I feel better."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 4440388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8097f6c1f9fb532a67c4e7d44f54f43e?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Becker", "link": "https://stackoverflow.com/users/4440388/jim-becker"}, "edited": false, "score": 0, "creation_date": 1432178318, "post_id": 30359414, "comment_id": 48819094, "body": "No need to create a new workbook. Worksheets.Copy without an argument will create the new workbook by default."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 141, "user_id": 4440388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8097f6c1f9fb532a67c4e7d44f54f43e?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Becker", "link": "https://stackoverflow.com/users/4440388/jim-becker"}, "edited": false, "score": 0, "creation_date": 1432187351, "post_id": 30359414, "comment_id": 48822015, "body": "@Jim Becker but OP wants a reference to the new workbook and this is best method to get that"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 5, "last_activity_date": 1432152551, "creation_date": 1432152551, "answer_id": 30359414, "question_id": 30359210, "link": "https://stackoverflow.com/questions/30359210/reference-excel-workbook-made-by-worksheet-copy-method/30359414#30359414", "title": "Reference Excel Workbook made by Worksheet.copy Method", "body": "<p>You can tell the worksheet <code>Copy</code> method to place the sheet Before/After a sheet in another workbook. So create a new workbook and then copy your sheet to before the first sheet in the new workbook.</p>\n\n<pre><code>Dim newBook As Workbook\n\nSet newBook = Workbooks.Add\n\nWorkbooks(\"source_book.xlsx\").Worksheets(\"sheet_name\").Copy Before:=newBook.Worksheets(1)\n</code></pre>\n\n<p>You've then got a valid workbook reference to the book that holds the copy of the sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "is_accepted": false, "score": 0, "last_activity_date": 1432153208, "creation_date": 1432153208, "answer_id": 30359629, "question_id": 30359210, "link": "https://stackoverflow.com/questions/30359210/reference-excel-workbook-made-by-worksheet-copy-method/30359629#30359629", "title": "Reference Excel Workbook made by Worksheet.copy Method", "body": "<p>Oh alright then.</p>\n\n<pre><code>Dim origBook As Workbook, newBook As Workbook\nSet origBook = Workbooks.ActiveWorkBook\n\nyourcode..yourcode..yourcode.Copy\n\nSet newBook = Workbooks.ActiveWorkBook\n</code></pre>\n\n<p>Something like that.</p>\n"}], "owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 30359414, "answer_count": 2, "score": 1, "last_activity_date": 1432204063, "creation_date": 1432151736, "last_edit_date": 1432204063, "question_id": 30359210, "link": "https://stackoverflow.com/questions/30359210/reference-excel-workbook-made-by-worksheet-copy-method", "title": "Reference Excel Workbook made by Worksheet.copy Method", "body": "<p>I am trying to write a macro to copy worksheets into a new Workbooks using the <code>.Copy</code><a href=\"https://msdn.microsoft.com/en-us/library/office/ff837784.aspx\" rel=\"nofollow\">(MSDN)</a> method and then save and email these newly created files out. </p>\n\n<p>To do this I will need a reference to the newly created worksheet in my macro. I haven't found a way to do it directly with the copy and am hesitant to always look for <code>Book1.xlsx</code>.</p>\n\n<p>Is there a way to grab the most recently opened workbook or easily compare before and after collections of workbooks?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432150214, "post_id": 30358446, "comment_id": 48809219, "body": "It worked to find the workbook, but it has &quot;.xls&quot; at then end which wont let it get inputted as a variable into With Workbooks(variable)....."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432150276, "post_id": 30358446, "comment_id": 48809249, "body": "Notice the line <code>Set GetWB = wb</code> in the function and then the use of  <code>With wb.Sheets(...</code> ;)"}, {"owner": {"reputation": 3168, "user_id": 108685, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/21b3e4a8f708842d4ebd1f2018cdad22?s=128&d=identicon&r=PG", "display_name": "waqasahmed", "link": "https://stackoverflow.com/users/108685/waqasahmed"}, "edited": false, "score": 0, "creation_date": 1462749984, "post_id": 30358446, "comment_id": 61753809, "body": "You may also wish to use <code>LEFT</code> if that is more appropriate for you. so something like this: <code>If LEFT(wb.Name, 10) = &quot;MyWorkBook&quot; Then</code> instead of the <code>like</code>."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 4, "last_activity_date": 1432149605, "last_edit_date": 1432149605, "creation_date": 1432149156, "answer_id": 30358446, "question_id": 30358293, "link": "https://stackoverflow.com/questions/30358293/vba-recognizing-workbook-by-partial-name/30358446#30358446", "title": "VBA recognizing workbook by partial name", "body": "<p>Yes you can use the <code>LIKE</code> Operator with a wildcard \"*\". Here is an example. I am assuming that the workbook is open.</p>\n\n<pre><code>Sub Sample()\n    Dim wb As Workbook\n    Dim wbName As String\n\n    '~~&gt; \"MyWorkbook2015\"\n    wbName = \"MyWorkbook\"\n\n    For Each wb In Application.Workbooks\n        If wb.Name Like wbName &amp; \"*\" Then\n            Debug.Print wb.Name\n\n            With wb.Sheets(\"My_Sheet_Name_That_Does_Not_Change\")\n                '~~&gt; Do something\n            End With\n        End If\n    Next wb\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here is a way where you can use it as a function</p>\n\n<pre><code>Dim wbName As String\n\nSub Sample()\n    '~~&gt; \"MyWorkbook2015\"\n    wbName = \"MyWorkbook\"\n\n    If Not GetWB Is Nothing Then\n        Debug.Print GetWB.Name\n        With GetWB.Sheets(\"My_Sheet_Name_That_Does_Not_Change\")\n            '~~&gt; Do something\n        End With\n    Else\n        MsgBox \"No workbook with that name found\"\n    End If\nEnd Sub\n\nFunction GetWB() As Workbook\n    Dim wb As Workbook\n\n    For Each wb In Application.Workbooks\n        If wb.Name Like wbName &amp; \"*\" Then\n            Set GetWB = wb\n            Exit Function\n        End If\n    Next wb\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "is_accepted": false, "score": 1, "last_activity_date": 1432174982, "creation_date": 1432174982, "answer_id": 30363507, "question_id": 30358293, "link": "https://stackoverflow.com/questions/30358293/vba-recognizing-workbook-by-partial-name/30363507#30363507", "title": "VBA recognizing workbook by partial name", "body": "<p>A slightly more reliable alternative to doing a partial match on Workbook.Name is to do an equivalency match on WorkBook.CodeName.  The default CodeName for a Workbook is \"ThisWorkbook\", but you can change that by selecting the \"ThisWorkbook\" code page in the Project Explorer window and then open the Properties Window (Key: F4) and change the Name property for the code page.</p>\n\n<p>Then following the example that Siddharth has shown but redefining then \"GetWB\" function like this:</p>\n\n<pre><code>Function GetWB() As Excel.Workbook\n    Const wbCodeName As String = \"MySecretWorkbookName\"   ' change to the CodeName you choose\n\n    Dim wb As Workbook\n    For Each wb In Application.Workbooks\n        If wb.CodeName = wbCodeName Then\n            Set FindWorkbook = wb\n            Exit For\n        End If\n    Next wb\nEnd Function\n</code></pre>\n\n<p>Note that changing the CodeName allows you to use the new CodeName in places where you would have used \"ThisWorkbook\", but you can still use \"ThisWorkbook\" as well.</p>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15213, "favorite_count": 3, "accepted_answer_id": 30358446, "answer_count": 2, "score": 3, "last_activity_date": 1432174982, "creation_date": 1432148656, "question_id": 30358293, "link": "https://stackoverflow.com/questions/30358293/vba-recognizing-workbook-by-partial-name", "title": "VBA recognizing workbook by partial name", "body": "<p>Is there a way to specify a workbook for a sheet without having the full name?\nFor example, If the workbook name is MyWorbook2015 and the 2015 may change to 2016 in the future, I need to to recognize the workbook based on MyWorkbook, and ignore the 2015.  Something similar to this:</p>\n\n<pre><code>With Workbooks(\"MyWorkbook2015\").Sheets(\"My_Sheet_Name_That_Does_Not_Change\")\n     'do something\nEnd With\n</code></pre>\n\n<p>In the code sample above, I need it to recognize the work book regardless of the date?  Is this possible? If it is, how would I go about doing that?</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1432149277, "post_id": 30358260, "comment_id": 48808673, "body": "You&#39;ve got a few issues here.  I think you can clear up the block if without end if error by changing your <code>Else If</code> to <code>ElseIf</code>.  I don&#39;t know if that&#39;s the logic you want though.  Also you can&#39;t compare a range of more than one cell (<code>Range(&quot;A2:A400&quot;)</code>) to a single value though.  You&#39;ll end up with a Type Mismatch error."}], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1432150061, "last_edit_date": 1432150061, "creation_date": 1432149563, "answer_id": 30358566, "question_id": 30358260, "link": "https://stackoverflow.com/questions/30358260/fixing-the-block-if-without-end-if-error/30358566#30358566", "title": "Fixing the Block If without End If error", "body": "<p>You can either nest a new <code>If ... End If</code> inside an <code>Else</code> clause or use the <code>ElseIf</code> version (there is no space). For the former, your code would need to be:</p>\n\n<pre><code>If Range(\"A2:A400\") = \"Company A\" Then \n    Range(\"F2:F400\") = \"Private Company\" \nElse \n    If Range(\"A2:A400\") = \"Company B\" Then \n        Range(\"F2:F400\") = \"Private Company\" \n    Else \n        If Range(\"A2:A400\") = \"Company C\" Then \n            Range(\"F2:F400\") = \"Private Company\" \n        Else \n            If Range(\"A2:A400\") = \"Company D\" Then \n                Range(\"F2:F400\") = \"Warrant\" \n            Else \n                If Range(\"A2:A400\") = \"Company E\" Then \n                    Range(\"F2:F400\") = \"Warrant\" \n                Else \n                    If Range(\"A2:A400\") = \"Company F\" Then \n                        Range(\"F2:F400\") = \"Warrant\" \n                    End If\n                End If\n            End If\n        End If\n    End If\nEnd If\n</code></pre>\n\n<p>Indentation added for ease of readability.</p>\n\n<p>Also you'll need to test every cell within the range \"A2:A400\" separately. Like:</p>\n\n<pre><code>For Each cell In Range(\"A2:A400\")\n    If cell.Value = \"\" Then\n    Else\n        ...\n    End If\nNext cell\n</code></pre>\n\n<p>A simpler method might be to create a lookup table of company names and whether private or warrant and then a VLOOKUP function in the spreadsheet.</p>\n"}, {"tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 0, "last_activity_date": 1432152578, "creation_date": 1432152578, "answer_id": 30359426, "question_id": 30358260, "link": "https://stackoverflow.com/questions/30358260/fixing-the-block-if-without-end-if-error/30359426#30359426", "title": "Fixing the Block If without End If error", "body": "<p>In VBA, <code>Else If</code> is nested conditions, where <code>ElseIf</code> is cascading:</p>\n\n<p>Try this:</p>\n\n<pre><code>If Range(\"A2:A400\") = \"Company A\" Then\n    Range(\"F2:F400\") = \"Private Company\"\nElseIf Range(\"A2:A400\") = \"Company B\" Then\n    Range(\"F2:F400\") = \"Private Company\"\nElseIf Range(\"A2:A400\") = \"Company C\" Then\n    Range(\"F2:F400\") = \"Private Company\"\nElseIf Range(\"A2:A400\") = \"Company D\" Then\n    Range(\"F2:F400\") = \"Warrant\"\nElseIf Range(\"A2:A400\") = \"Company E\" Then\n    Range(\"F2:F400\") = \"Warrant\"\nElseIf Range(\"A2:A400\") = \"Company F\" Then\n    Range(\"F2:F400\") = \"Warrant\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1432154750, "post_id": 30359514, "comment_id": 48811779, "body": "screw me for no comments"}, {"owner": {"reputation": 187, "user_id": 3966995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97f8739a6838028dd7417d098da60c?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Talada", "link": "https://stackoverflow.com/users/3966995/robert-talada"}, "edited": false, "score": 0, "creation_date": 1571409776, "post_id": 30359514, "comment_id": 103243888, "body": "No comments on Stack Overflow can be considered a good thing sometimes lol"}], "tags": [], "owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "is_accepted": false, "score": 0, "last_activity_date": 1432154790, "last_edit_date": 1432154790, "creation_date": 1432152843, "answer_id": 30359514, "question_id": 30358260, "link": "https://stackoverflow.com/questions/30358260/fixing-the-block-if-without-end-if-error/30359514#30359514", "title": "Fixing the Block If without End If error", "body": "<p>i also wanted to add that you can use (this is just ChipsLetten extended a bit so you can see how it works)</p>\n\n<pre><code>Sub ColumnLoop()\n\n    Dim rng As Range\n    Set rng = Range(\"A2:A400\")\n            For Each cell In rng\n                Debug.Print cell.Address\n                    If (cell.Value = \"Company A\" Or cell.Value = \"Company B\" Or cell.Value = \"Company B\") Then\n                       cell.Offset(0, 5).Value = \"Private\"\n                        Debug.Print cell.Address\n                    Else\n                        cell.Offset(0, 5).Value = \"Warrant\"\n                         Debug.Print cell.Address\n                    End If\n                Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4921821, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EH0Rf8umXwU/AAAAAAAAAAI/AAAAAAAAAEI/ZdiFsdJF4f8/photo.jpg?sz=128", "display_name": "kris", "link": "https://stackoverflow.com/users/4921821/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4286, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1432374160, "creation_date": 1432148557, "last_edit_date": 1531164843, "question_id": 30358260, "link": "https://stackoverflow.com/questions/30358260/fixing-the-block-if-without-end-if-error", "title": "Fixing the Block If without End If error", "body": "<p>I am just getting started with Macros and VB but have some experience with Excel formulas. My problem is my excel formulas are becoming very long and complicated and I thought VB could help me. </p>\n\n<p>I have a lot of financial data that I would like to categorize in a column. My first step is to categorize particular companies as either a private company or a warrant. I get a 'block if without end if' error with the below code. I have tried various things but no luck. </p>\n\n<pre><code>    Range(\"F2:F400\") = \"Private Company\"\nElse If Range(\"A2:A400\") = \"Company B\" Then\n    Range(\"F2:F400\") = \"Private Company\"\nElse If Range(\"A2:A400\") = \"Company C\" Then\n    Range(\"F2:F400\") = \"Private Company\"\nElse If Range(\"A2:A400\") = \"Company D\" Then\n    Range(\"F2:F400\") = \"Warrant\"\nElse If Range(\"A2:A400\") = \"Company E\" Then\n    Range(\"F2:F400\") = \"Warrant\"\nElse If Range(\"A2:A400\") = \"Company F\" Then\n    Range(\"F2:F400\") = \"Warrant\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 1, "creation_date": 1432148475, "post_id": 30358208, "comment_id": 48808206, "body": "What do you mean by not working? You get an error?"}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1432148565, "post_id": 30358208, "comment_id": 48808272, "body": "Does your actual code use a different sheet than <code>ActiveSheet</code>?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432150034, "post_id": 30358208, "comment_id": 48809125, "body": "If your <code>ActiveSheet</code> is a chart, it will fail (but so will the first line also).  Can&#39;t imagine any other reason.  Most people get messed up here using <code>Cells</code> without a sheet qualifier to access cells on another sheet.  You&#39;re using the <code>ActiveSheet</code> so that issue is removed."}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432150115, "post_id": 30358208, "comment_id": 48809165, "body": "@Byron Unless its a simplification to post the question, and there is another worksheet involved."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432151790, "post_id": 30358208, "comment_id": 48810111, "body": "This has been asked and answered so many times before in Stackoverflow. <a href=\"http://stackoverflow.com/questions/21678304/method-cells-of-object-global-failed-vba\">Here</a> is one such quesiton."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432151850, "post_id": 30358208, "comment_id": 48810156, "body": "Another <a href=\"http://stackoverflow.com/questions/18962890/2-ways-for-clearcontents-on-vba-excel-but-1-work-fine-why\">one</a> Question is different but addresses the same issue"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1432162293, "last_edit_date": 1432162293, "creation_date": 1432151425, "answer_id": 30359120, "question_id": 30358208, "link": "https://stackoverflow.com/questions/30358208/activesheet-rangecellsx-y-cellsw-z-select-not-working/30359120#30359120", "title": "ActiveSheet.Range(Cells(x,y), Cells(w, z)).Select not working", "body": "<p>I suspect your code is in the worksheet code module of a different sheet, so the unqualified <code>Cells</code> calls refer to <em>that</em> sheet, not the active one. You should <strong>always</strong> qualify <strong>all</strong> <code>Range</code> or <code>Cells</code> calls with a <code>Worksheet</code> object:</p>\n\n<pre><code>ActiveSheet.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(3, 4)).Select\n</code></pre>\n\n<p>This also works avoiding the need to repeat several times the target worksheet: \n(see <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/EN-US/library/office/gg264723.aspx</a>)</p>\n\n<pre><code>With ActiveSheet\n    .Range(.Cells(1, 1), .Cells(3, 4)).Select\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4188220, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/EFYeU.png?s=128&g=1", "display_name": "oitathi", "link": "https://stackoverflow.com/users/4188220/oitathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48071, "favorite_count": 2, "accepted_answer_id": 30359120, "answer_count": 1, "score": 0, "last_activity_date": 1432162293, "creation_date": 1432148350, "last_edit_date": 1432152399, "question_id": 30358208, "link": "https://stackoverflow.com/questions/30358208/activesheet-rangecellsx-y-cellsw-z-select-not-working", "title": "ActiveSheet.Range(Cells(x,y), Cells(w, z)).Select not working", "body": "<p>Could anyone tell me why when I refer to a particular range it works fine:</p>\n\n<pre><code>ActiveSheet.Range(\"A1:D3\").Select\n</code></pre>\n\n<p>but</p>\n\n<pre><code>ActiveSheet.Range(Cells(1, 1), Cells(3, 4)).Select\n</code></pre>\n\n<p>not working?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432148234, "post_id": 30358123, "comment_id": 48808059, "body": "Why not show something (or ANYTHING) that you have already tried?"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 2, "creation_date": 1432148332, "post_id": 30358123, "comment_id": 48808116, "body": "Why use VBA for this over a formula?"}, {"owner": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432151266, "post_id": 30358123, "comment_id": 48809784, "body": "I have already written some VB scripts to change the format and delete some columns, wanted to add to it, to get all things done at a single go"}], "answers": [{"comments": [{"owner": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432151172, "post_id": 30358896, "comment_id": 48809721, "body": "I want only those to be calculated which have values in RC[-12] greater than 0 and sort the table according to the final value in the ratio column"}], "tags": [], "owner": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "is_accepted": false, "score": 0, "last_activity_date": 1432154080, "last_edit_date": 1432154080, "creation_date": 1432150638, "answer_id": 30358896, "question_id": 30358123, "link": "https://stackoverflow.com/questions/30358123/how-do-i-write-vba-script-to-calculate-the-ratio-between-2-columns-in-a-spreadsh/30358896#30358896", "title": "How do i write VBA script to calculate the ratio between 2 columns in a spreadsheet and put it on a 3rd one?", "body": "<p>This is what I did. </p>\n\n<pre><code>Sub Engagement_Ratio()\n\n    Range(\"Z1\").Select\n    ActiveCell.FormulaR1C1 = \"Engaged User Rate\"\n    Range(\"Z2\").Select\n    ActiveCell.FormulaR1C1 = \"=(RC[-12]/RC[-15])\"\n    Range(\"Z2\").Select\n    Selection.AutoFill Destination:=Range(\"Z2:Z154\")\n    Range(\"Z2:Z154\").Select\n    ActiveWindow.SmallScroll Down:=-27\n\nEnd Sub\n</code></pre>\n\n<p>How do I make the range of cells dynamic? so that it does it only for the range of cells that have values. How do I put something like a count on it.</p>\n"}, {"comments": [{"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432154840, "post_id": 30359366, "comment_id": 48811825, "body": "Was it able to also solve the problem of putting in the correct ratios?"}, {"owner": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432155031, "post_id": 30359366, "comment_id": 48811949, "body": "Sorry for the wrong post. It did not sort the columns or calculate the values on the engaged user rate column(Z) :("}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432155206, "post_id": 30359366, "comment_id": 48812043, "body": "Is it putting any numbers into column Z?  Is there something in column A all the way down to the bottom of your data?"}, {"owner": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432155738, "post_id": 30359366, "comment_id": 48812311, "body": "The code you posted is not giving anything in Column Z. The code I posted did but Z154 is a random hard coded value, I wanted to make it dynamic using count of rows from column A"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432155998, "post_id": 30359366, "comment_id": 48812477, "body": "This code is able to adjust to any number of rows, as long as A is your determining column.  Are the two columns that you&#39;re wanting to perform calculations on N and K?  So column Z should equal N / K ?"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "reply_to_user": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "edited": false, "score": 0, "creation_date": 1432156657, "post_id": 30359366, "comment_id": 48812811, "body": "Great!  Would you like to go ahead and accept this answer as a solution?"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 0, "last_activity_date": 1432152322, "creation_date": 1432152322, "answer_id": 30359366, "question_id": 30358123, "link": "https://stackoverflow.com/questions/30358123/how-do-i-write-vba-script-to-calculate-the-ratio-between-2-columns-in-a-spreadsh/30359366#30359366", "title": "How do i write VBA script to calculate the ratio between 2 columns in a spreadsheet and put it on a 3rd one?", "body": "<p>Assuming that column A is populated to the bottom of your data:</p>\n\n<pre><code>Sub Test2()\n\nDim LastRow As Integer\nLastRow = ActiveSheet.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious, After:=[A1]).Row\nRange(\"Z1\").Value = \"Engaged User Rate\"\nFor i = 2 To LastRow\n    If Cells(i, 14).Value &gt; 0 Then Cells(i, 26).Value = Cells(i, 14).Value / Cells(i, 11).Value\nNext i\nActiveSheet.sort.SortFields.Clear\nActiveSheet.sort.SortFields.Add Key:=Range(\"Z2:Z\" + CStr(LastRow)) _\n    , SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal 'sort by sort code\nWith ActiveSheet.sort\n    .SetRange Range(\"A1:Z\" + CStr(LastRow))\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 452, "user_id": 4740706, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/eV6C7.jpg?s=128&g=1", "display_name": "RB17", "link": "https://stackoverflow.com/users/4740706/rb17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1068, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1432154145, "creation_date": 1432148058, "last_edit_date": 1432154145, "question_id": 30358123, "link": "https://stackoverflow.com/questions/30358123/how-do-i-write-vba-script-to-calculate-the-ratio-between-2-columns-in-a-spreadsh", "title": "How do i write VBA script to calculate the ratio between 2 columns in a spreadsheet and put it on a 3rd one?", "body": "<p>I am trying to calculate the ratio between the values in 2 columns and put it to a 3rd column of my spreadsheet. </p>\n\n<p>I am unable to figure out how do I write it over a loop in a macro and what function to use there.</p>\n\n<p>I have values in columns A and B. I am trying to pull the ratio of the 2 columns in the column C, it should contain A/B.</p>\n\n<p>This is what I did. </p>\n\n<pre><code>Sub Engagement_Ratio()\n\n    Range(\"Z1\").Select\n    ActiveCell.FormulaR1C1 = \"Engaged User Rate\"\n    Range(\"Z2\").Select\n    ActiveCell.FormulaR1C1 = \"=(RC[-12]/RC[-15])\"\n    Range(\"Z2\").Select\n    Selection.AutoFill Destination:=Range(\"Z2:Z154\")\n    Range(\"Z2:Z154\").Select\n    ActiveWindow.SmallScroll Down:=-27\n\nEnd Sub\n</code></pre>\n\n<p>How do I make the range of cells dynamic? so that it does it only for the range of cells that have values. How do I put something like a count on it.</p>\n"}, {"tags": ["ms-access", "listbox", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1432147990, "post_id": 30358055, "comment_id": 48807910, "body": "I&#39;ve also tried Forms(&quot;formname&quot;).Controls(&quot;listboxname&quot;).multiselect=2"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1432148351, "post_id": 30358055, "comment_id": 48808130, "body": "The easiest way is in the Form Designer. Right-click the ListBox, choose <i>Properties</i>; in the Properties Sheet, click the <i>Other</i> tab and set <i>MultiSelect</i> to either <i>Simple</i> or <i>Extended</i>."}], "answers": [{"comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1432150485, "post_id": 30358246, "comment_id": 48809360, "body": "Thanks, do you you understand how to access the info from the multiselect listbox in vba? <a href=\"https://support.microsoft.com/en-us/kb/121356\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/121356</a> This seems overly complicated, but it does in the end what I want. Any ideas how to do this?"}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 1, "creation_date": 1432153477, "post_id": 30358246, "comment_id": 48811049, "body": "Wow, that is an old link! (Access 2.0) See newly added code samples in answer above."}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 6, "last_activity_date": 1432153442, "last_edit_date": 1432153442, "creation_date": 1432148516, "answer_id": 30358246, "question_id": 30358055, "link": "https://stackoverflow.com/questions/30358055/multiselect-listbox-issues/30358246#30358246", "title": "MultiSelect Listbox issues", "body": "<p>From Microsoft Office Help on property <code>MultiSelect</code>:</p>\n\n<blockquote>\n  <p>This property can be set only in form Design view.</p>\n</blockquote>\n\n<p>Set this property in Form Design, and don't try to change it in code.</p>\n\n<p><strong>Some examples of working with MultiSelect:</strong></p>\n\n<pre><code>' Retrieve all selected values\nPublic Function ListBoxGetMultiSelect(ByVal rListBox As Access.ListBox) As String\n    Dim v As Variant\n    Dim vList As Variant\n    vList = \"\"\n    With rListBox\n        For Each v In .ItemsSelected\n            vList = vList &amp; .Column(0, v) &amp; vbCrLf\n        Next\n    End With\n    ListBoxGetMultiSelect = vList\nEnd Function\n\n' clear all selected values\nPublic Sub ListBoxClearSelection(ByVal rListBox As Access.ListBox)\n    Dim v As Variant\n    With rListBox\n        For Each v In .ItemsSelected\n            .Selected(v) = False\n        Next\n        .Value = Null\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14333540, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhpGrkwAF-GAHBWssPLX-WDPPLaOckpDTWMJobSBQ=k-s128", "display_name": "Marco Tombesi", "link": "https://stackoverflow.com/users/14333540/marco-tombesi"}, "is_accepted": false, "score": 0, "last_activity_date": 1600945274, "creation_date": 1600945274, "answer_id": 64045086, "question_id": 30358055, "link": "https://stackoverflow.com/questions/30358055/multiselect-listbox-issues/64045086#64045086", "title": "MultiSelect Listbox issues", "body": "<p>I've found a way to set Multiselect Property via Vba Code:</p>\n<pre><code>DoCmd.SetWarnings = False\n    DoCmd.OpenForm myformname, acDesign\n    Forms(myformname).SetFocus\n    Forms(myformname).Controls(List3).MultiSelect = 0\n    DoCmd.Close acForm, myformname\nDoCmd.SetWarnings = True\n</code></pre>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 0, "accepted_answer_id": 30358246, "answer_count": 2, "score": 2, "last_activity_date": 1600945274, "creation_date": 1432147835, "question_id": 30358055, "link": "https://stackoverflow.com/questions/30358055/multiselect-listbox-issues", "title": "MultiSelect Listbox issues", "body": "<p>I am having an issue making a listbox into a multiselect listbox. I understand that the code to make a listbox multiselect is:</p>\n\n<pre><code>[forms]![formname]![listboxname].multiselect=2\n</code></pre>\n\n<p>However when I run this in Private Sub Form_Load() I get run-time error '2448' You can't assign a value to this object.</p>\n\n<p>I guess I don't understand how to make a listbox multiselect, but I am pretty sure I understand how to use the multiselect listbox in VBA. </p>\n\n<p>Any help on how to use the above code to actually change the listbox to multiselect would be appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1432145914, "post_id": 30357422, "comment_id": 48806739, "body": "Do you have more than one workbook open when you run this code?"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1432146015, "post_id": 30357422, "comment_id": 48806796, "body": "Only the workbook it is in and the hidden workbook in which the macros are automatically stored."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1432146133, "post_id": 30357422, "comment_id": 48806862, "body": "Can you please put <code>MsgBox ThisWorkbook.Path &amp; vbNewLine &amp; ThisWorkbook.Name</code> just above the <code>With Sheets(&quot;Data_Sheet&quot;)</code> and verify if the macro is running from the correct workbook?"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1432146257, "post_id": 30357422, "comment_id": 48806936, "body": "You probably have to take a few actions to debug (find the source of error and fix it): 1) Use breakpoints and execute step by step, 2) Find the line that produces the error, 3) etc."}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "reply_to_user": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1432146351, "post_id": 30357422, "comment_id": 48806978, "body": "I am currently doing that @sancho.s"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432146403, "post_id": 30357422, "comment_id": 48807002, "body": "Leading/trailing spaces or a rogue zero-length space is my guess. Try with <code>lookat:=xlPart</code> to see if a partial match can be reached."}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1432146454, "post_id": 30357422, "comment_id": 48807032, "body": "@MatteoNNZ I tried as you said and it appears it is using the personal workbook right now.  How would I go about fixing that?"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432146616, "post_id": 30357422, "comment_id": 48807140, "body": "@Jeeped Do you mean while using my find method?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432146844, "post_id": 30357422, "comment_id": 48807247, "body": "If the issue may be something as simple as a trailing space character then change <code>lookat:=xlWhole</code> to <code>lookat:=xlPart</code>. If it works on a partial match then you have rogue characters somewhere. Examine the values in the worksheet closely for length, etc."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1432147092, "post_id": 30357422, "comment_id": 48807389, "body": "@MatteoNNZ - <code>ThisWorkbook</code> is going to return the workbook with the code in it regardless of what workbook/worksheet the code is acting on. Better to use <code>Sheets(&quot;Data_Sheet&quot;).parent.name</code>. If there was no <b>Sheets(&quot;Data_Sheet&quot;)</b> then the error would be the same but the debug would point to the With statement."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 1, "creation_date": 1432147289, "post_id": 30357422, "comment_id": 48807514, "body": "@Jeeped is right, actually we should see it with ActiveWorkbook. But Sheets(&quot;Data_sheet&quot;) should be where the debug is pointing. It&#39;s not explicitly said, but that is the only point in which the error can be prompted. Otherwise, he would rather have a Object not set error (if there&#39;s not a full match)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1432147417, "post_id": 30357422, "comment_id": 48807586, "body": "@MatteoNNZ - You&#39;re right of course. I just went back and confirmed the subtext of each error 9 message."}], "answers": [{"comments": [{"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432147749, "post_id": 30357715, "comment_id": 48807772, "body": "Both of the workbooks appear as ThisWorkbook.  Where would I find their exact name or should I rename them? The file is not in PERSONAL.XLSB"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432147912, "post_id": 30357715, "comment_id": 48807858, "body": "@Paradox does your workbook have a name (I mean, did you &quot;Save it as&quot;... something)? Or is a newly created one?"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 4, "last_activity_date": 1432147056, "last_edit_date": 1432147056, "creation_date": 1432146682, "answer_id": 30357715, "question_id": 30357422, "link": "https://stackoverflow.com/questions/30357422/vba-run-time-error-9-with-sheet/30357715#30357715", "title": "VBA Run-time error 9 With Sheet", "body": "<p>As from comments, the macro is running from the <code>PERSONAL.XSLB</code> workbook so it's trying to finding the <code>Sheets(\"Data_sheet\")</code> in it, and clearly not finding because it is into another workbook --> <code>Subscript out of range</code>.</p>\n\n<p>To fix, <em>always</em> use full references of the <code>Object</code> you work with: </p>\n\n<pre><code>With Workbooks(\"myWorkbook.xlsm\").Sheets(\"Data_sheet\") '&lt;-- explicitly saying in which workbook it must look for the sheet\n\nEnd With\n</code></pre>\n\n<p>Alternatively, remember that:</p>\n\n<ul>\n<li><code>ThisWorkbook</code> references the workbook the code runs from. In your case, it would reference the <code>PERSONAL.XLSB</code>;</li>\n<li><code>ActiveWorkbook</code> references the currently active workbook. Very risky to use (usually, you should know which workbook you want to target). But there might be some cases in which you want the code to intentionally running on the active workbook (see the example of an add-in: the code runs from the add-in, but you want the add-in to run on the workbook from which is used). </li>\n</ul>\n\n<p><strong>WARNING:</strong></p>\n\n<p>A common error is <em>not</em> to use any reference, like in your case: </p>\n\n<pre><code>With Sheets(\"Data_Sheet\") '&lt;-- of which workbook? \n</code></pre>\n\n<p>In that case, VBA answers the question itself with <code>ActiveWorkbook</code>, which is the default object. Only if you <em>explicitely</em> want to run from the <code>ActiveWorkbook</code> you should leave it like that; otherwise, <em>always</em> reference the object to avoid any bug related to this. </p>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3447, "favorite_count": 0, "accepted_answer_id": 30357715, "answer_count": 1, "score": 0, "last_activity_date": 1432147056, "creation_date": 1432145793, "question_id": 30357422, "link": "https://stackoverflow.com/questions/30357422/vba-run-time-error-9-with-sheet", "title": "VBA Run-time error 9 With Sheet", "body": "<p>So here I have VBA code that is a part of my function, yet whenever I run it, I get the following error:</p>\n\n<pre><code>Run-Time error '9': Subscript out of range\n</code></pre>\n\n<p>The actual worksheet exists.  In the vba editor on the side panel, it appears as Sheet2(Data_Sheet).  In the details in that panel, it shows <em>(Name)</em> as being <em>Sheet 11</em> and  <em>Name</em> as being <em>Data_Sheet</em>.  Dos anybody know a possible source of this error?   My code is below:</p>\n\n<pre><code>With Sheets(\"Data_Sheet\")\n\n        'this searches just row 1\n        Set header_cell_1 = .Rows(1).Find(What:=\"One\", lookat:=xlWhole, MatchCase:=False, searchformat:=False)\n        Set header_cell_2 = .Rows(1).Find(What:=\"Two\", lookat:=xlWhole, MatchCase:=False, searchformat:=False)\n        Set header_cell_3 = .Rows(1).Find(What:=\"Three\", lookat:=xlWhole, MatchCase:=False, searchformat:=False)\n        Set header_cell_4 = .Rows(1).Find(What:=\"Four\", lookat:=xlWhole, MatchCase:=False, searchformat:=False)\n        Set header_cell_5 = .Rows(1).Find(What:=\"Five\", lookat:=xlWhole, MatchCase:=False, searchformat:=False)\n        Set header_cell_6 = .Rows(1).Find(What:=\"Six\", lookat:=xlWhole, MatchCase:=False, searchformat:=False)\n        Set header_cell_7 = .Rows(1).Find(What:=\"Seven\", lookat:=xlWhole, MatchCase:=False, searchformat:=False)\n\n        col_1 = header_cell_1.Column\n        col_2 = header_cell_2.Column\n        col_3 = header_cell_3.Column\n        col_4 = header_cell_4.Column\n        col_5 = header_cell_5.Column\n        col_6 = header_cell_6.Column\n        col_7 = header_cell_7.Column\n\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432150490, "post_id": 30357315, "comment_id": 48809364, "body": "I can show you how to insert actual word/folder icons but wouldn&#39;t a simple way would be to show it as text in the next column? or as a matter of fact color the next cell?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432215855, "post_id": 30357315, "comment_id": 48840730, "body": "No, as space is very limited. I am doing an interactive map of a heavy work process, and the file names appear under the process in which they will be used. Processes follow each other like a path (they are buttons leading elsewhere). I&#39;d like to have the icon next to the document name (which is a hyperlink, by the way) so users will know what they open."}], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1432215669, "post_id": 30359054, "comment_id": 48840600, "body": "I think that would work very well for my computer, but I am designing a program that will be used by 20+ people, will they all need to have the picture saved at that exact path? If so, that would be problematic. That&#39;s why I wanted to use a FaceID, but if there is a way to work around it, I would appreciate to know how! Thanks!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1432236116, "post_id": 30359054, "comment_id": 48854305, "body": "Yes there is a workaround :) See <a href=\"http://stackoverflow.com/questions/10782394/pop-up-the-excel-statusbar/10787496#10787496\">THIS</a>. I have also given a link for the sample file. See how I am using the picture from the excel sheet and reinserting it."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1432151199, "creation_date": 1432151199, "answer_id": 30359054, "question_id": 30357315, "link": "https://stackoverflow.com/questions/30357315/insert-picture-icon-in-or-over-a-cell/30359054#30359054", "title": "Insert picture/icon in or over a cell", "body": "<p>Further to my comments, Here is how you can insert pictures and position them in say Column B. I would still say that typing \"Word\" or \"Folder\" in Column B and then coloring the cell would be much simpler :)</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim picWord As String\n    Dim picFolder As String\n    Dim Shp As Shape\n    Dim i As Long\n\n    picWord = \"C:\\Users\\Siddharth\\Desktop\\Word.Jpg\"\n    picFolder = \"C:\\Users\\Siddharth\\Desktop\\folder.Jpg\"\n\n    Set ws = ThisWorkbook.Sheets(\"Feuil1\")\n\n    With ws\n        For i = 1 To 5\n            If .Range(\"A\" &amp; i) = \"1\" Then\n                With .Pictures.Insert(picWord)\n                    With .ShapeRange\n                        .LockAspectRatio = msoTrue\n                        .Width = ws.Range(\"B\" &amp; i).Width\n                        .Height = ws.Range(\"B\" &amp; i).Height\n                    End With\n                    .Left = ws.Range(\"B\" &amp; i).Left\n                    .Top = ws.Range(\"B\" &amp; i).Top\n                    .Placement = 1\n                    .PrintObject = True\n                End With\n            ElseIf .Range(\"A\" &amp; i) = \"2\" Then\n                With .Pictures.Insert(picFolder)\n                    With .ShapeRange\n                        .LockAspectRatio = msoTrue\n                        .Width = ws.Range(\"B\" &amp; i).Width\n                        .Height = ws.Range(\"B\" &amp; i).Height\n                    End With\n                    .Left = ws.Range(\"B\" &amp; i).Left\n                    .Top = ws.Range(\"B\" &amp; i).Top\n                    .Placement = 1\n                    .PrintObject = True\n                End With\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>I used the following pictures. You can download these or use whatever you like.</p>\n\n<p><img src=\"https://i.stack.imgur.com/W1Vfq.jpg\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/WipeI.jpg\" alt=\"enter image description here\"></p>\n\n<p>When you run the above code, you will get this kind of output</p>\n\n<p><img src=\"https://i.stack.imgur.com/I5wwk.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2553, "favorite_count": 0, "accepted_answer_id": 30359054, "answer_count": 1, "score": 1, "last_activity_date": 1432151199, "creation_date": 1432145432, "question_id": 30357315, "link": "https://stackoverflow.com/questions/30357315/insert-picture-icon-in-or-over-a-cell", "title": "Insert picture/icon in or over a cell", "body": "<p>I hope I make this clear:</p>\n\n<p>I have a loop that copies some hyperlinks in specific cells (they come from a document list with the file path, document name, etc stored in another sheet).</p>\n\n<p>I would like to have an icon next to the hyperlink that indicates if it will open a word document, a folder, etc. In the document list, I can put an indicator in the column next to the hyperlink (1 for word doc, 2 for folder, etc) so that depending on the case, the right icon gets sent next to the right type of document hyperlink.</p>\n\n<p>I have managed to do it by simply inserting shapes (blue rectangle for word doc, green for folder) but I'd like to have a more descriptive symbol (like a specific FaceID maybe?). Here is my code (dumbed down for simplicity):</p>\n\n<pre><code>Sub Icons()\nDim i As Integer\nDim sh As Object\n'Only loops through A1:A5 for simplicity\n'Looks at the associated indicator located in the previous sheet\n'Assigns a shape depending if it is 1 or 2\nFor i = 1 To 5\n    If Feuil1.Range(\"A\" &amp; i) = \"1\" Then\n        Set sh = Feuil2.Shapes.AddShape(msoShapeRectangle, Range(\"A\"&amp; i).Left, Range(\"A\" &amp; i).Top, 15, 15)\n    sh.Name = \"WordDocIcon\" &amp; i\n    sh.Fill.ForeColor.RGB = RGB(0, 220, 220)\nEnd If\n\nIf Feuil1Range(\"A\" &amp; i) = \"2\" Then\n        'It is easy to do when inserting a given msoShape, but I want something else!\n    Set sh = Feuil2.Shapes.AddShape(msoShapeRectangle, Range(\"A\" &amp; i).Left, Range(\"A\" &amp; i).Top, 15, 15)\n    sh.Name = \"FolderIcon\" &amp; i\n    sh.Fill.ForeColor.RGB = RGB(100, 100, 0)\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 94, "user_id": 2444791, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/279d6eebc5391f30e5d35b334f617c4c?s=128&d=identicon&r=PG", "display_name": "user2444791", "link": "https://stackoverflow.com/users/2444791/user2444791"}, "is_accepted": false, "score": 0, "last_activity_date": 1445428681, "creation_date": 1445428681, "answer_id": 33258705, "question_id": 30357153, "link": "https://stackoverflow.com/questions/30357153/how-to-click-on-open-save-save-as-cancel-button-on-ie-11-using-vba/33258705#33258705", "title": "How to click on Open/save/save as/cancel button on IE 11 using vba", "body": "<p>You can use Alt+N to focus on the Notification Bar.\nAnd then send {tab} key to navigate to the specific button.</p>\n\n<p>With VBA, you may use <strong>Autohotkey.dll or AutoItX3.dll</strong> to send these hotkey combinations.</p>\n"}], "owner": {"reputation": 162, "user_id": 3775661, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100006220543615/picture?type=large", "display_name": "Ben2014", "link": "https://stackoverflow.com/users/3775661/ben2014"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 933, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1445428681, "creation_date": 1432144917, "question_id": 30357153, "link": "https://stackoverflow.com/questions/30357153/how-to-click-on-open-save-save-as-cancel-button-on-ie-11-using-vba", "title": "How to click on Open/save/save as/cancel button on IE 11 using vba", "body": "<p>I would like to click on open when a file download dialog appear in IE 11. I found this code <a href=\"http://www.siddharthrout.com/2011/10/23/vbavb-netvb6click-opensavecancel-button-on-ie-download-window/\" rel=\"nofollow noreferrer\">http://www.siddharthrout.com/2011/10/23/vbavb-netvb6click-opensavecancel-button-on-ie-download-window/</a></p>\n\n<p>But this code does not work with IE11. I have also attached the IE11 download dialog box here too. Anyone has any idea, please, help.</p>\n\n<p><img src=\"https://i.stack.imgur.com/wQ2Nf.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["perl", "excel", "batch-file", "multiple-languages", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432144961, "post_id": 30356878, "comment_id": 48806166, "body": "I have not worked with perl but a short google search directed me to <a href=\"http://www.codeproject.com/Articles/15698/How-to-execute-a-Perl-script-from-VBA\" rel=\"nofollow noreferrer\">This</a> Not sure if this is what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 0, "last_activity_date": 1432150141, "last_edit_date": 1432150141, "creation_date": 1432149586, "answer_id": 30358571, "question_id": 30356878, "link": "https://stackoverflow.com/questions/30356878/passing-excel-vba-variables-to-perl/30358571#30358571", "title": "Passing Excel VBA variables to Perl?", "body": "<p>You can't pass <em>variables</em> to/between <em>scripts</em>, but you can pass <em>values</em> to/between <em>processes</em>.</p>\n\n<p>The number of ways of doing this is nearly infinite. The most common way to pass values from one process to another is through command-line arguments. <a href=\"http://www.codeproject.com/Articles/15698/How-to-execute-a-Perl-script-from-VBA\" rel=\"nofollow\">This</a> shows how to execute another program (such as a batch file) from VBA.</p>\n\n<p>What follows is an example of such a batch file passing arguments to a Perl script, which in turn prints them.</p>\n\n<pre><code>&gt;type a.bat\n@echo off\necho Start of batch file\nperl a.pl %*\necho End of batch file\n</code></pre>\n\n<p>&#x20;</p>\n\n<pre><code>&gt;type a.pl\nuse strict;\nuse warnings;\nuse feature qw( say );\nsay 'Start of Perl script';\nsay for 0+@ARGV, @ARGV;\nsay 'End of Perl script';\n</code></pre>\n\n<p>&#x20;</p>\n\n<pre><code>&gt;a.bat abc \"123 456\" def\nStart of batch file\nStart of Perl script\n3\nabc\n123 456\ndef\nEnd of Perl script\nEnd of batch file\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4171678, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b0af73068b64798e4a3ef4844be138fc?s=128&d=identicon&r=PG&f=1", "display_name": "excelSU", "link": "https://stackoverflow.com/users/4171678/excelsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 1, "accepted_answer_id": 30358571, "answer_count": 1, "score": -1, "last_activity_date": 1432150141, "creation_date": 1432144079, "last_edit_date": 1531161705, "question_id": 30356878, "link": "https://stackoverflow.com/questions/30356878/passing-excel-vba-variables-to-perl", "title": "Passing Excel VBA variables to Perl?", "body": "<p>Is it possible to pass variables to a perl script from excel without using Batch as a gateway (VBA -> Batch -> Perl), if not possible how can I send batch variables to Perl?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 357, "user_id": 873317, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3c60302ff7b1754aa4fa9d7c394169a4?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/873317/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1432246571, "creation_date": 1432246571, "answer_id": 30385270, "question_id": 30356772, "link": "https://stackoverflow.com/questions/30356772/updating-word-form-field/30385270#30385270", "title": "Updating Word Form Field", "body": "<p>The problem was that Content Controls and ActiveX buttons are not altogether compatible.  Also, the programmer I had inherited the form from was using a simple field calculation based on the table in the document instead of VBA.  I was able to come up with a better solution.  I used the sub:</p>\n\n<pre><code>Private Sub Document_ContentControlOnExit(ByVal thisControl As ContentControl, Cancel As Boolean)    \nEnd Sub\n</code></pre>\n\n<p>to execute code onExit from the controls.  This function executes on ALL Content Controls as the user exits the Content Control.  Another tool I developed was the following function which will find the index of the control with the given title:  </p>\n\n<pre><code>'Function to get control index given the control title\n'PARAMETER Control Title as String\n'RETURN Control Index as Integer\nPublic Function GetControlIndex(ccTitle As String) As Integer\n    'Function Variable Declaration\n    Dim objCC As ContentControl\n\n    'look at each ContentControl\n    For i = 1 To ActiveDocument.ContentControls.count\n        Set objCC = ActiveDocument.ContentControls.Item(i)\n        With objCC\n            If .Title = ccTitle Then\n                GetControlIndex = i\n            End If\n        End With\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 357, "user_id": 873317, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3c60302ff7b1754aa4fa9d7c394169a4?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/873317/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432246571, "creation_date": 1432143737, "last_edit_date": 1432148773, "question_id": 30356772, "link": "https://stackoverflow.com/questions/30356772/updating-word-form-field", "title": "Updating Word Form Field", "body": "<p>I have a Word form that I am working on.  </p>\n\n<p>It has one field that is supposed to be calculated from other fields.  </p>\n\n<p>In the prior iteration, you could click the cell in the table and hit F9 and the field would update.  </p>\n\n<p>I have since added some other buttons and VBA and now you can no longer click the cell when \"Restrict Editing\" is on.  </p>\n\n<p>I have tried a button tied to VBA that will update all fields, but when you click that button, you cannot edit any of the fields.  </p>\n\n<p>How can I update this field, and still be able to manually update my other fields?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4686991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c51f75fbeaf62974ab9ea6e8851ae667?s=128&d=identicon&r=PG&f=1", "display_name": "Gablet", "link": "https://stackoverflow.com/users/4686991/gablet"}, "edited": false, "score": 0, "creation_date": 1432155811, "post_id": 30358673, "comment_id": 48812360, "body": "I tried that but it doesn&#39;t seem to address the issue (this may be a problem I have to deal with later so thanks anyway). When I try to run it again the message &#39;Microsoft Access Can&#39;t find the field &#39;Completed&#39; referred to in your expression.&#39; and it highlights this line - If Me.Controls(sName).Value = &quot;Completed&quot; Then. It looks like it cannot read the &#39;Completed&#39; selection in the combobox but I am not sure how to change it"}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": false, "score": 0, "last_activity_date": 1432149915, "creation_date": 1432149915, "answer_id": 30358673, "question_id": 30356386, "link": "https://stackoverflow.com/questions/30356386/combobox-function-that-will-change-properties-of-a-similar-named-textbox/30358673#30358673", "title": "Combobox function that will change properties of a similar named textbox", "body": "<p>I think your problem is with the line: </p>\n\n<pre><code>IDnumber = Split(sName, \"C\")\n</code></pre>\n\n<p>For example, when I run this code in Access:</p>\n\n<pre><code>Dim s As String\ns = Split(\"abc\", \"b\")   ' can't assign array to plain string\n</code></pre>\n\n<p>I get <code>Error 13: Type Mismatch</code>. This is because you can't assign an array to a simple string variable.</p>\n\n<p>The fix? Dimension your string as an array:</p>\n\n<pre><code>Dim s() As String\ns = Split(\"abc\", \"b\")\nDebug.Print s(0)        ' works\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4686991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c51f75fbeaf62974ab9ea6e8851ae667?s=128&d=identicon&r=PG&f=1", "display_name": "Gablet", "link": "https://stackoverflow.com/users/4686991/gablet"}, "is_accepted": false, "score": 0, "last_activity_date": 1432157885, "creation_date": 1432157885, "answer_id": 30360861, "question_id": 30356386, "link": "https://stackoverflow.com/questions/30356386/combobox-function-that-will-change-properties-of-a-similar-named-textbox/30360861#30360861", "title": "Combobox function that will change properties of a similar named textbox", "body": "<p>I worked it out. When I referred to the function as =chkclick([SC1]) in the properties window it was giving me the output \"completed\" instead of the name. I changed the function in the properties window to =chkclick(\"SC1\") and this then referred to the control name and the rest of it I could work out with Kismerts answer</p>\n"}], "owner": {"reputation": 21, "user_id": 4686991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c51f75fbeaf62974ab9ea6e8851ae667?s=128&d=identicon&r=PG&f=1", "display_name": "Gablet", "link": "https://stackoverflow.com/users/4686991/gablet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594644581, "creation_date": 1432142542, "last_edit_date": 1594644581, "question_id": 30356386, "link": "https://stackoverflow.com/questions/30356386/combobox-function-that-will-change-properties-of-a-similar-named-textbox", "title": "Combobox function that will change properties of a similar named textbox", "body": "<p>I have a combobox with two options as an output, one is \"Completed\" the other is \"N/A\". When one of these options is selected I want a text box to output a message and and change the font in the textbox. I have named the combobox SC1 and the the textbox ID1 as I will use the function to change multiple textboxes throughout my form. </p>\n\n<p>I am currently using a function in the Afterupdate property of the Combobox (SC1) and refer to the function this way: =chkclick([SC1]) </p>\n\n<p>This should run the following function with sName referring to SC1 (Combobox) - </p>\n\n<pre><code> Private Function chkClick(sName As String)\n      Dim IDnumber As String\n      Me.Controls(sName).SetFocus\n        If Me.Controls(sName).Value = \"Completed\" Then\n            IDnumber = Split(sName, \"C\") \n            Form.Controls(\"ID\" &amp; IDnumber).Value = (\"Completed by \" &amp; (Environ$(\"Username\")))\n            Form.Controls(\"ID\" &amp; IDnumber).ForeColor = 10\n            Form.Controls(\"ID\" &amp; IDnumber).Controls(0).Visible = True\n\n        ElseIf Me.Controls(sName).Value = \"Not Applicable\" Then\n            Form.Controls(\"ID\" &amp; IDnumber).Value = (\"Not completed, please leave comments when saving\")\n            Form.Controls(\"ID\" &amp; IDnumber).ForeColor = 10\n            Form.Controls(\"ID\" &amp; IDnumber).Controls(0).Visible = True\n        End If\n    End Function\n</code></pre>\n\n<p>But instead I get the following error message - \"The expression After Update you entered as the event property setting produced the following error: Microsoft Access Can't find the field 'Completed' referred to in your expression.' </p>\n\n<p>I've tried lots of different ways of writing it but I'm at a loss. Any help is greatly appreciated.</p>\n"}, {"tags": ["ms-access", "vba", "text-files", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 868, "user_id": 1321707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e64dedac8fa02cae04b5c29e520925d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1321707/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1432144602, "creation_date": 1432144602, "answer_id": 30357053, "question_id": 30356373, "link": "https://stackoverflow.com/questions/30356373/using-ms-access-to-import-multiple-text-files/30357053#30357053", "title": "Using MS Access to import multiple text files", "body": "<p>I am under the impression that you need to break the process in three steps</p>\n\n<p>1st code that imports text to a table \n<a href=\"http://www.datawright.com.au/access_resources/access_import_text_files.htm\" rel=\"nofollow\">http://www.datawright.com.au/access_resources/access_import_text_files.htm</a></p>\n\n<p>Every text gets imported to a temp tables...\nThen you examine the table fields</p>\n\n<p>2nd code that creates tables\n<a href=\"http://www.access-programmers.co.uk/forums/showthread.php?t=213261\" rel=\"nofollow\">http://www.access-programmers.co.uk/forums/showthread.php?t=213261</a></p>\n\n<p>3rd erase contents of temp table and proceed with the next text...or  when you import them you could add info in the temp table...like text name and process them afterwards in a batch</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 3708815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNRNB.jpg?s=128&g=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/3708815/joel"}, "edited": false, "score": 0, "creation_date": 1432310512, "post_id": 30375602, "comment_id": 48889995, "body": "I put this in a module, and couldn&#39;t get this to run - so I added the private sub and end sub to the code. (I don&#39;t really know VBA). Anyway it&#39;s giving me run time error 91 Object variable or With block variable not set. When I debug, it doesn&#39;t like that 2nd line that starts with FSO."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 31, "user_id": 3708815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNRNB.jpg?s=128&g=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/3708815/joel"}, "edited": false, "score": 0, "creation_date": 1432431035, "post_id": 30375602, "comment_id": 48924234, "body": "See update, those objects must be <code>Set</code>. And yes drop the code behind a command button of a form (which is a Private Sub) or put code in a module as a Sub or Function, then call it with some type of event trigger."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 6, "last_activity_date": 1432430851, "last_edit_date": 1432430851, "creation_date": 1432215929, "answer_id": 30375602, "question_id": 30356373, "link": "https://stackoverflow.com/questions/30356373/using-ms-access-to-import-multiple-text-files/30375602#30375602", "title": "Using MS Access to import multiple text files", "body": "<p>Consider a For/Loop VBA using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835958.aspx\" rel=\"noreferrer\">DoCmd.TransferText</a> command that iterates through all text files in a folder directory and imports them with suffix to denote 1-600.</p>\n\n<pre><code>Dim FSO as Object, objFolder As Object, objFile as Object\n\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = FSO.GetFolder(\"C:\\Path\\To\\TextFiles\")\n\ni = 1\nFor each objFile in objFolder.Files\n  If Right(objFile.Name, 3) = \"txt\" Then\n    DoCmd.TransferText acImportDelim, , \"File_\" &amp; i, objFolder &amp; \"\\\" &amp; objFile.Name, True\n  End if\n  i = i + 1\nNext objFile\n\nSet objFile = Nothing\nSet objFolder = Nothing\nSet FSO = Nothing\n</code></pre>\n\n<p>In the empty argument in TransferText you can use a pre-defined specification object which you create during one manual import of the text file. This allows you to name fields, define data types, etc. of the imported text file.</p>\n\n<p>Finally, if all files are structured the same, consider again importing into one table and use queries by relevant fields to break up in the 600 groupings if needed. To use one table, simply replace the <code>\"File_\" &amp; i</code> argument above with a table string name: <code>\"dataFiles\"</code>. You save on table namespaces, storage from less database objects, and overall helps in better organization as well as the relational model.</p>\n"}], "owner": {"reputation": 31, "user_id": 3708815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNRNB.jpg?s=128&g=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/3708815/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10935, "favorite_count": 0, "accepted_answer_id": 30375602, "answer_count": 2, "score": 0, "last_activity_date": 1432430851, "creation_date": 1432142491, "last_edit_date": 1432149778, "question_id": 30356373, "link": "https://stackoverflow.com/questions/30356373/using-ms-access-to-import-multiple-text-files", "title": "Using MS Access to import multiple text files", "body": "<p>I have about 600 text files with headers, and I don't really feel like importing them one by one manually into MS Access. </p>\n\n<p>I don't want to append the text files into one Access table. If I have 600 text files, I want the result to be 600 Access tables. </p>\n\n<p>I've searched high and low for this, the closest I've come is some code that would take my text files and append them into one access table. I don't want that. </p>\n"}, {"tags": ["vba", "outlook", "oft"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1432154806, "creation_date": 1432154806, "answer_id": 30360080, "question_id": 30356289, "link": "https://stackoverflow.com/questions/30356289/editing-oft-with-vba-code/30360080#30360080", "title": "Editing OFT with VBA code", "body": "<p>Make sure that you set up a well-formed HTML markup. For example:</p>\n\n<pre><code>With oMail \n  'Set body format to HTML \n  .BodyFormat = olFormatHTML \n  .HTMLBody = \"&lt;HTML&gt;&lt;BODY&gt;Enter the message text here. &lt;/BODY&gt;&lt;/HTML&gt;\" \n  .Display \nEnd With \n</code></pre>\n\n<p>Calling the Replace method you may replace some HTML tags as well.</p>\n"}, {"tags": [], "owner": {"reputation": 526, "user_id": 1828277, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f604c63316904e30c7db0beeb20f873b?s=128&d=identicon&r=PG", "display_name": "Glen", "link": "https://stackoverflow.com/users/1828277/glen"}, "is_accepted": false, "score": 1, "last_activity_date": 1536373843, "last_edit_date": 1536373843, "creation_date": 1536372403, "answer_id": 52231372, "question_id": 30356289, "link": "https://stackoverflow.com/questions/30356289/editing-oft-with-vba-code/52231372#52231372", "title": "Editing OFT with VBA code", "body": "<p>Obvious thing to me, not that I am outlook vba expert, but if is purely a html issue as the person above me has said but failed to spell out - your <em>strFind</em> includes the html tags '>' and '&lt;' so why haven't you added them in your <em>strNew</em>. If I am to assume rather that was just typo on your behalf and your actual code is replace <code>\"Code:\"</code> with <code>\"Code: \" + Cells(4, 3)</code> then I would be asking myself what is in Cells(4, 3) is it html encoded i.e. the common mistakes people make are does the text contain tags (e.g. '>' or '&lt;') or ampersand ('&amp;') then you need to change it with a replace function e.g. <code>Replace(Cells(4, 3), \"&amp;\", \"&amp;amp;\")</code> or find a predefined function that encodes it for you. In your case I am guessing being French perhaps you text contains uni-code characters like letters with accents and graves etc. that will also need to be encoded.</p>\n"}], "owner": {"reputation": 1, "user_id": 4921533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6b04e5b79ba3504ce4f73d42175dc1d?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/4921533/sylvain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592992169, "creation_date": 1432142235, "last_edit_date": 1592992169, "question_id": 30356289, "link": "https://stackoverflow.com/questions/30356289/editing-oft-with-vba-code", "title": "Editing OFT with VBA code", "body": "<p>I'm trying to edit an OFT with vba code                         </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\ntemplate = \"T:\\Coordination des interventions\\Coordination des changements\\Communications\\Interruption de service planifi\u00e9e - Environnements applicatifs Oracle - Copie.oft\"\n\nstrNew = InputBox(\"Jour de la semaine\")\n\nstrFind = \"%&gt;JourSemaine&lt;%\"\n\n\nDim oApp As Object, oMail As Object\n\nSet oApp = CreateObject(\"Outlook.Application\")\nSet oMail = oApp.CreateItemFromTemplate(template)\n\nWith oMail\n    'strFind = \"Code:\"\n    'strNew = \"Code:\" &amp; Cells(4, 3) ' for example\n    .HTMLBody = Replace(oMail.HTMLBody, strFind, strNew)\n\n    .Display\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This is where I got an error 287 (my systeme is in french)</p>\n\n<pre><code>    .HTMLBody = Replace(oMail.HTMLBody, strFind, strNew)\n</code></pre>\n\n<p>Anybody have clue?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1432143700, "creation_date": 1432143700, "answer_id": 30356754, "question_id": 30356278, "link": "https://stackoverflow.com/questions/30356278/macro-in-excel-with-changeable-path/30356754#30356754", "title": "Macro in Excel with changeable path", "body": "<blockquote>\n  <p>I always keep both files in the Folder called \\AHT_tenure</p>\n</blockquote>\n\n<p>Try this</p>\n\n<pre><code>A.OpenCurrentDatabase ThisWorkbook.Path &amp; \"\\AHT_Tenure.accdb\"\n</code></pre>\n\n<p><strong>Explanation</strong>: <code>ThisWorkbook.Path</code> will give you <code>\"C:\\Users\\gustavo.chi\\Documents\\AHT_tenure\"</code> or the path of whatever location that excel file is.</p>\n"}], "owner": {"reputation": 85, "user_id": 4793927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-htfTTycgtcY/AAAAAAAAAAI/AAAAAAAADRE/AWfETYPt0yA/photo.jpg?sz=128", "display_name": "ChiHam", "link": "https://stackoverflow.com/users/4793927/chiham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 30356754, "answer_count": 1, "score": 0, "last_activity_date": 1432143700, "creation_date": 1432142195, "last_edit_date": 1531161705, "question_id": 30356278, "link": "https://stackoverflow.com/questions/30356278/macro-in-excel-with-changeable-path", "title": "Macro in Excel with changeable path", "body": "<p>I have 2 files my Access DB <strong>AHT_Tenure.accdb</strong> and my Excel file with a Macro to run a query on the <em>.accdb</em>. The macro is the following:</p>\n\n<pre><code>Sub AHT_Tenure()\nDim A As Object\nApplication.DisplayAlerts = False\nSet A = CreateObject(\"Access.Application\")\nA.Visible = False\nA.OpenCurrentDatabase (\"C:\\Users\\gustavo.chi\\Documents\\AHT_tenure\\AHT_Tenure.accdb\")\nWith A.CurrentDB.QueryDefs(\"Q_AHT_Tenure_combine\")\n   .Execute\n   MsgBox .RecordsAffected\nEnd With\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>As you can see the path is <strong>C:\\Users\\gustavo.chi\\Documents\\AHT_tenure\\AHT_Tenure.accdb</strong> I always keep both files in the Folder called <strong>\\AHT_tenure</strong> How do I edit the macro so I can move the path of the folder and the macro will still work? I want to have the folder with the files in a USB.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 4, "creation_date": 1432142422, "post_id": 30356255, "comment_id": 48804717, "body": "<b>Help us to help you.</b> Post your code."}, {"owner": {"reputation": 86654, "user_id": 102441, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/cf1b41a0f134b54597bf8a618be7880f?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/102441/eric"}, "edited": false, "score": 3, "creation_date": 1432143160, "post_id": 30356255, "comment_id": 48805094, "body": "Never produce a 1-array? Can you add an N/A to the end?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1432144761, "post_id": 30356255, "comment_id": 48806058, "body": "What does <i>&#39;doing a Ctrl+Shift+Enter&#39;</i> have to do with VBA? It sounds like you need to wrap <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow noreferrer\">IFERROR</a> around an array formula."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1432144434, "last_edit_date": 1432144434, "creation_date": 1432143424, "answer_id": 30356656, "question_id": 30356255, "link": "https://stackoverflow.com/questions/30356255/displaying-a-single-element-array-via-ctrlshiftenter/30356656#30356656", "title": "Displaying a Single Element Array (via Ctrl+Shift+Enter)", "body": "<p>In this example, the <strong>1-element array</strong> is <em>ary()</em>:</p>\n\n<pre><code>Public Function WhatEver()\n   Dim ary(1 To 1) As String\n   Dim bry As Variant, rN As Long\n\n   rN = Application.Caller.Rows.Count\n   ReDim bry(1 To rN, 1 To 1)\n\n   ary(1) = \"Whatever\"\n   bry(1, 1) = ary(1)\n\n   For i = 2 To rN\n      bry(i, 1) = \"#N/A\"\n   Next i\n   WhatEver = bry\nEnd Function\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/BTKSS.png\" alt=\"enter image description here\"></p>\n\n<p><em>Based on Eric's suggestion.</em></p>\n"}], "owner": {"reputation": 1, "user_id": 4921528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a74e717dc8365251fd5653412f450a2?s=128&d=identicon&r=PG&f=1", "display_name": "SeekingVBAHelp", "link": "https://stackoverflow.com/users/4921528/seekingvbahelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1432146177, "creation_date": 1432142093, "last_edit_date": 1432146177, "question_id": 30356255, "link": "https://stackoverflow.com/questions/30356255/displaying-a-single-element-array-via-ctrlshiftenter", "title": "Displaying a Single Element Array (via Ctrl+Shift+Enter)", "body": "<p>I have a function that returns an array of results which I display by doing <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd> in Excel.  </p>\n\n<p>If I have multiple values (say 3), that are expanded into a range of length 10, it will display the 3 values followed by <code>#N/A</code> for the remaining 7.</p>\n\n<p>If I have only one value in the array, it will display the same value across the entire range.  </p>\n\n<p>How do I get Excel to have the same behavior with only one element?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4921487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A2cllYgVx4Y/AAAAAAAAAAI/AAAAAAAAATE/751m-ZwX4qI/photo.jpg?sz=128", "display_name": "jmarcsisin", "link": "https://stackoverflow.com/users/4921487/jmarcsisin"}, "edited": false, "score": 0, "creation_date": 1432143086, "post_id": 30356338, "comment_id": 48805051, "body": "Couple of questions/comments.  It looks like I had to use the number 2 as opposed to 1 in the last qualifier to get the additional blank row.  When I rerun the macro a second time, it is showing four tables, though ideally it would only show 3 (one new table each button click).  Do you know how I would solve this or what is causing this issue?  Thank you so much for your help! Truly appreciate the quick response"}, {"owner": {"reputation": 1, "user_id": 4921487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A2cllYgVx4Y/AAAAAAAAAAI/AAAAAAAAATE/751m-ZwX4qI/photo.jpg?sz=128", "display_name": "jmarcsisin", "link": "https://stackoverflow.com/users/4921487/jmarcsisin"}, "edited": false, "score": 0, "creation_date": 1432143671, "post_id": 30356338, "comment_id": 48805390, "body": "The first time I use the macro it copies the rows in range D4:D18.  Now I have two tables (exactly what I want).  The second time I click the macro button, I end up with 4 tables (I would like 3).  Let me know if that doesn&#39;t make sense"}], "tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 0, "last_activity_date": 1432142397, "creation_date": 1432142397, "answer_id": 30356338, "question_id": 30356159, "link": "https://stackoverflow.com/questions/30356159/vba-101-insert-rows-after-last-row-in-worksheet/30356338#30356338", "title": "VBA 101 =&gt; Insert Rows after Last Row in Worksheet", "body": "<p>This will work for you</p>\n\n<pre><code>Sub SpecialCopy()\n    Dim lastRow As Long: lastRow = Cells(Cells.Rows.Count, 4).End(xlUp).Row\n    Range(\"D4:D\" &amp; lastRow).Copy Destination:=Range(\"D\" &amp; lastRow + 1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4921487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A2cllYgVx4Y/AAAAAAAAAAI/AAAAAAAAATE/751m-ZwX4qI/photo.jpg?sz=128", "display_name": "jmarcsisin", "link": "https://stackoverflow.com/users/4921487/jmarcsisin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2232, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432663972, "creation_date": 1432141764, "last_edit_date": 1432663972, "question_id": 30356159, "link": "https://stackoverflow.com/questions/30356159/vba-101-insert-rows-after-last-row-in-worksheet", "title": "VBA 101 =&gt; Insert Rows after Last Row in Worksheet", "body": "<p>I will preface this by saying that I am an extreme beginner with Visual Basic.  I took classes five or six years ago in college, and have since determined that I no longer know how to write code or did not pay enough attention in class.</p>\n\n<p>Issue: I have a \"table\" that begins in D4.  I put table in quotation marks because it is more just a data set and I did not go through the process of actually inserted a table from the data ribbon.  I would like to take this table (the example has four incumbents) and copy this in the next available row in column D below this table, though I would prefer to include a blank row for aesthetics.  Please see below for a before and after of my \"vision\".  Any help would be greatly appreciated.</p>\n\n<p>Edit: Noticed I cannot paste images as a rookie, so if you need additional detail please reach out to me and I can provide you with the images.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432142627, "post_id": 30356126, "comment_id": 48804826, "body": "What type of data are you copying?  Numbers or formulas?  You can use a version of <code>.SpecialCells()</code> to get only non-blank cells.  Use <code>xlCellTypeFormulas</code> or <code>xlCellTypeConstants</code> depending on what you have.  You can also <code>Union</code> those together if you have both types of data.  You would use <code>SpecialCells</code> on the range before copying: <code>ShM.Range(...).SpecialCells(...).Copy</code>."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432142719, "post_id": 30356126, "comment_id": 48804871, "body": "This is also related to <a href=\"http://stackoverflow.com/questions/19822225/copy-non-blank-cells-from-range-to-range\">this one which loops through checking &lt;&gt;&quot;&quot;</a> and <a href=\"http://stackoverflow.com/questions/18625468/use-vba-to-copy-all-visible-and-non-empty-cells-in-a-range\">this which uses SpecialCells</a>"}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432142805, "post_id": 30356126, "comment_id": 48804922, "body": "} else if (vSym == &quot;FEYE&quot;) {      addBand( 35.25, PS_SOLID, 1, Color.RGB(0,255,0), 80001 );     addBand( 43, PS_SOLID, 1, Color.RGB(255,59,56), 90002 );"}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432142824, "post_id": 30356126, "comment_id": 48804930, "body": "that&#39;s what it is copying tons of those lines haha"}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432143343, "post_id": 30356126, "comment_id": 48805199, "body": "I saw that post the other day, I just don&#39;t know how to merge the two VBA&#39;s I guess."}], "answers": [{"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432143041, "post_id": 30356416, "comment_id": 48805028, "body": "There is nothing inherently wrong with this, but deleting the <code>EntireRow</code> just to avoid blanks is a bit overkill and not appropriate if the other worksheet has data already.  I would <code>Delete</code> only the <code>Cell</code> if you really want to use this approach.  Less collateral damage."}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432143150, "post_id": 30356416, "comment_id": 48805089, "body": "Not working, Fixed the syntax error with *Application.ScreenUpdating = 0. Then it gives me an error with Sh.Activate: Sh.Cells(z, 1).PasteSpecial xlPasteValues"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432143471, "post_id": 30356416, "comment_id": 48805275, "body": "Not sure if your current code would work either.  You are using <code>z</code> without setting its value.  By default it will have a value <code>z=0</code> which is not a valid row number to give to <code>Cells</code>."}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1432146767, "post_id": 30356416, "comment_id": 48807218, "body": "I know that deleting the entire row seems like overkill, but from the code (copying row by row) and the current workaround (filtering) it seems that this is essentially what&#39;s desired.  It looks like z was just a counter to track the number of rows that have already been copied.  I don&#39;t know how it was working as OP states with the beginning &quot;This VBA works.&quot;  Is there some code missing?  You may have to add in a line after your paste of: z = z +1 to work.  As well as setting z = 1 to initialize."}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432222695, "post_id": 30356416, "comment_id": 48846135, "body": "The code I originally posted does work, and have been using it many times . I just want the blanks gone lol"}, {"owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "edited": false, "score": 0, "creation_date": 1432222996, "post_id": 30356416, "comment_id": 48846349, "body": "Did you add the increment z line I mentioned in the last comment?  As well as the initializing of z?"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 0, "last_activity_date": 1432152823, "last_edit_date": 1432152823, "creation_date": 1432142632, "answer_id": 30356416, "question_id": 30356126, "link": "https://stackoverflow.com/questions/30356126/vba-copies-columns-including-all-blank-cells/30356416#30356416", "title": "VBA copies Columns including all blank cells", "body": "<p>There's a few ways to do this, but one of the simplest is to copy the data over then delete those blanks:</p>\n\n<pre><code>Sub merge()\n    Dim Sh As Worksheet, ShM As Worksheet, i&amp;, z&amp; *Application.ScreenUpdating = 0\n    z = 1\n    Set Sh = Worksheets.Add(, Sheets(Sheets.Count))\n    Sh.Name = \"consolidated\"\n    For Each ShM In ThisWorkbook.Worksheets\n        If ShM.Name &lt;&gt; Sh.Name Then\n            i = ShM.Cells(Rows.Count, 45).End(xlUp).Row\n            ShM.Activate: ShM.Range(Cells(1, 45), Cells(i, 45)).Copy\n            Sh.Activate: Sh.Cells(z, 1).PasteSpecial xlPasteValues\n            z = z + 1\n        End If\n        For i = Sh.Cells(Rows.Count,45).End(xlUp).Row to 1 Step -1\n            If Sh.Cells(i,45).Value = \"\" Then Sh.Cells(i,45).EntireRow.Delete\n        Next i\n    Next ShM\n    Application.ScreenUpdating = 1\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432199041, "post_id": 30359995, "comment_id": 48828716, "body": "This didn&#39;t work. It did the same as the above VBA i first listed. It still left those extra blanks at the bottom. I do not know why. They do have a formula in them but the blanks aren&#39;t being used at all."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432208326, "post_id": 30359995, "comment_id": 48835131, "body": "HI Trosky6708, please let know what did not worked, the code above was tested, I&#39;m interested to know why you are not getting the expected results. What are you getting?."}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432222151, "post_id": 30359995, "comment_id": 48845747, "body": "There&#39;s nothing really funky about the sheets I am using it on. Description of file: File size Corner to Corner A:2000 - AS:2000 there are a few blank columns in there for spacers. Each sheet is identical except for the #&#39;s I input. It is only using one array to filter non blank cells for I2000:k2000 that gets output to M2000:O2000. Columns 45 only contain data up until row 500, but they auto update so the number varies, which leaves an extra 1500 cells. Your script pastes the correct data but does not eliminate these extra 1500+ cells. All cells in column 45 contain formula =X584&amp;&quot; &quot;&amp;AL584&amp;&quot;&quot;"}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432222410, "post_id": 30359995, "comment_id": 48845937, "body": "The formula in column 45 =X584&amp;&quot; &quot;&amp;AL584&amp;&quot;&quot; which extends down to row 2000 displays a bunch lines that look like this: &quot;  addBand( 35.75, PS_SOLID, 1, Color.RGB(0,255,0), 80001 );&quot; AND like I said currently they only go to row 500 but they autoupdate so the number of rows used will increase over time. So tomorrow there could be &quot;  addBand( 35.75, PS_SOLID, 1, Color.RGB(0,255,0), 80001 );&quot; 600 of these lines in column 45. That&#39;s why I have the formula extending down to the 2000th row."}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432223038, "post_id": 30359995, "comment_id": 48846382, "body": "I am getting the correct data, but it leaves the extra 1500+ blanks from each worksheet. Then it pastes the next data from the next worksheet along with it&#39;s extra 1500 blanks."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432224403, "post_id": 30359995, "comment_id": 48847272, "body": "Trosky6708 thanks for your feed back, it seems to be something specific with the data in your worksheet, (i.e. formatting, etc) can you place your worksheet somewhere in the internet so I can give a look and provide a full solution. Thanks"}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432225368, "post_id": 30359995, "comment_id": 48847831, "body": "Yes one moment google drives or something &amp; post the link as quick as possible"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432227043, "post_id": 30359995, "comment_id": 48848872, "body": "Actually it worked, was able to download your file. Let me look into it and will come back to you. Cheers."}, {"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432227580, "post_id": 30359995, "comment_id": 48849196, "body": "For this excel file make sure the Selected Column to copy is 44 u&#39;ll see what happens. It works with column 5 but not 44"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432227805, "post_id": 30359995, "comment_id": 48849335, "body": "Thanks. I was about to tell that column 45 is blank"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432231885, "post_id": 30359995, "comment_id": 48851797, "body": "The problem was that some cells have the Value <i>&quot; &quot; (blank spaces)</i> which I did not expected. Nevertheless the code is adjusted to take care of that, just change this line <code>If vCllVal &lt;&gt; Empty Then</code> with this <code>If WorksheetFunction.Trim(vCllVal) &lt;&gt; Empty Then</code> Remember that its required to have the following at the top of the module <code>Option Explicit</code> and <code>Option Base 1</code> <i>Seems that it was a good idea to have the column to copy as a constant.</i> Cheers..."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1432231765, "last_edit_date": 1432231765, "creation_date": 1432154502, "answer_id": 30359995, "question_id": 30356126, "link": "https://stackoverflow.com/questions/30356126/vba-copies-columns-including-all-blank-cells/30359995#30359995", "title": "VBA copies Columns including all blank cells", "body": "<p>The code below uses <em>arrays</em> in order to obtain the original values and to eliminate <em>blank values</em> (from blank cells or as result of a formula). It also enters the resulting data in column <strong>A</strong> in the <em>consolidated</em> Wsh, leaving a blank row between worksheets data to ensure no overlap of takes place, and a two blank rows of separation when a worksheet only has <em>blank values</em>. Also using a constant to identify the targeted column <em>(column 5 in this sample, just changed as required)</em></p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub Wsh_MergeColDataFromAllOterWorksheets()\nConst kCol As Byte = 5\nDim Sh As Worksheet, ShM As Worksheet, i As Long, z As Long\nDim aAryInput As Variant, vAryOutput() As Variant\nDim vCllVal As Variant\nDim l As Long\n\n    Rem Add New Worksheet\n    Application.ScreenUpdating = 0\n    Set Sh = Worksheets.Add(After:=Sheets(Sheets.Count))\n\n    Rem Delete Consolidate Wsh if present\n    Application.DisplayAlerts = 0\n    On Error Resume Next\n    Worksheets(\"consolidated\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = 0\n\n    Rem Add New Worksheet\n    Sh.Name = \"consolidated\"\n\n    z = 1\n    For Each ShM In ThisWorkbook.Worksheets\n        With ShM\n            If .Name &lt;&gt; Sh.Name Then\n\n                Rem Get Last Row\n                i = .UsedRange.SpecialCells(xlCellTypeLastCell).Row\n\n                Rem Set Input Array\n                aAryInput = Empty\n                aAryInput = .Range(.Cells(1, kCol), .Cells(i, kCol))\n\n                Rem Initiate &amp; Size Output Array\n                Erase vAryOutput\n                ReDim Preserve vAryOutput(i)\n\n                Rem Get Non Blank Cells Value\n                l = 0\n                For Each vCllVal In aAryInput\n                    If WorksheetFunction.Trim(vCllVal) &lt;&gt; Empty Then\n                        l = 1 + l\n                        vAryOutput(l) = vCllVal\n                End If: Next\n\n            If l &lt;&gt; 0 Then\n                Rem Erase Blank Values in Output Array\n                ReDim Preserve vAryOutput(l)\n                vAryOutput = WorksheetFunction.Transpose(vAryOutput)\n\n                Rem Set NonBlank Values in Wsh \"consolidated\" (Column 1)\n                Sh.Cells(z, 1).Resize(l).Value = vAryOutput\n            End If\n\n            Rem Set Next Row\n            z = 1 + z + l\n\n    End If: End With: Next ShM\n    Application.ScreenUpdating = 1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2222, "favorite_count": 0, "accepted_answer_id": 30359995, "answer_count": 2, "score": 0, "last_activity_date": 1449435182, "creation_date": 1432141665, "last_edit_date": 1449435182, "question_id": 30356126, "link": "https://stackoverflow.com/questions/30356126/vba-copies-columns-including-all-blank-cells", "title": "VBA copies Columns including all blank cells", "body": "<p>This VBA works. It makes a new worksheet, and then copies every and all cells in column(45) including the blank ones. How do I get it to not copy the blank/cells or the ones that contain no value? I know once the everything is consolidated into the new worksheet I can use the filter function for blanks but I want to skip that step.</p>\n\n<pre><code>Sub merge()\n    Dim Sh As Worksheet, ShM As Worksheet, i&amp;, z&amp;\n    Application.ScreenUpdating = 0\n    Set Sh = Worksheets.Add(, Sheets(Sheets.Count))\n    Sh.Name = \"consolidated\"\n    For Each ShM In ThisWorkbook.Worksheets\n        If ShM.Name &lt;&gt; Sh.Name Then\n            i = ShM.Cells(Rows.Count, 45).End(xlUp).Row\n            ShM.Activate: ShM.Range(Cells(1, 45), Cells(i, 45)).Copy\n            Sh.Activate: Sh.Cells(z, 1).PasteSpecial xlPasteValues\n        End If\n    Next ShM\n    Application.ScreenUpdating = 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "matrix", "multidimensional-array", "out-of-memory"], "comments": [{"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 1, "creation_date": 1432140205, "post_id": 30355399, "comment_id": 48803456, "body": "Did you try to define it as a class?"}, {"owner": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "reply_to_user": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 0, "creation_date": 1432149717, "post_id": 30355399, "comment_id": 48808915, "body": "no it is in VBA so i dint use class..i am able to create matrix of size 150*150.it doesnt allow more than that"}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1432154103, "post_id": 30355399, "comment_id": 48811428, "body": "Do you really expect to populate more than a fraction of the cells in such a huge structure? If not, you might consider implementing a <i>sparse matrix</i>. Might think of a class representing an entry with a virtual column and row number,  with methods to &quot;iterate&quot; over rows or columns."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "edited": false, "score": 0, "creation_date": 1432207375, "post_id": 30358981, "comment_id": 48834462, "body": "Thnak you so much for the help i hope the issue is resolved.it was a very good idea"}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 2, "last_activity_date": 1432150952, "creation_date": 1432150952, "answer_id": 30358981, "question_id": 30355399, "link": "https://stackoverflow.com/questions/30355399/create-a-large-matrix-as-a-typedef-in-vba/30358981#30358981", "title": "Create a large matrix as a typedef in VBA", "body": "<p>From here <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278742.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/gg278742.aspx</a></p>\n\n<blockquote>\n  <p>The size of a user-defined type exceeds 64K.</p>\n  \n  <p>Reduce the size of the user-defined type. Generally the size of a user-defined type equals the sum of the sizes specified for its elements. On some platforms there may be padding between the elements to keep them aligned on word boundaries. If you nest one user-defined type in another, the size of the nested type must be included in the size of the new type.</p>\n</blockquote>\n\n<p>Doubles are 8 bytes. 360,000 doubles is 2.9 million bytes (~2,800 kb). That's why you can't have a data structure of Doubles that's 600 square. You also can't have 150 square unless you change the data type to something smaller than a Double.</p>\n\n<p>I'm not sure what you're trying to accomplish with this, so the best advice I can give you is to create a class and maintain the array in there.  Create a class and name the module CTest. In it, put this code</p>\n\n<pre><code>Private mdContents(1 To 600, 1 To 600) As Double\n\nPublic Property Let Contents(ByVal lOne As Long, ByVal lTwo As Long, ByVal dValue As Double)\n    mdContents(lOne, lTwo) = dValue\nEnd Property\n\nPublic Property Get Contents(ByVal lOne As Long, ByVal lTwo As Long) As Double\n    Contents = mdContents(lOne, lTwo)\nEnd Property\n</code></pre>\n\n<p>Now, in a standard module, you can create however many copies of this class that you need.</p>\n\n<pre><code>Public Sub Test()\n\n    Dim clsOne As CTest\n    Dim clsTwo As CTest\n\n    Set clsOne = New CTest\n    clsOne.Contents(1, 1) = 2 ^ 2\n\n    Set clsTwo = New CTest\n    clsTwo.Contents(10, 10) = 2 ^ 3\n\n    Debug.Print clsOne.Contents(1, 1), clsTwo.Contents(10, 10)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4921340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea183f7ca7214eee7b0193096602e70?s=128&d=identicon&r=PG&f=1", "display_name": "ashvn", "link": "https://stackoverflow.com/users/4921340/ashvn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432152390, "creation_date": 1432139263, "last_edit_date": 1432152390, "question_id": 30355399, "link": "https://stackoverflow.com/questions/30355399/create-a-large-matrix-as-a-typedef-in-vba", "title": "Create a large matrix as a typedef in VBA", "body": "<p>I am trying to create a 600*600 Matrix as user-defined type and later use this type for other Matrices. The Problem is it's throwing an error stating that the variable size of \"content\" cannot be more than 64kb. </p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Type Matrixtype\n  Contents(1to600,1 to600) As double\nEnd Type\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010", "excel-2007"], "comments": [{"owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "edited": false, "score": 1, "creation_date": 1432139347, "post_id": 30355267, "comment_id": 48802869, "body": "Are you sure you are using correct type of variable in subroutine where you call the function ? The problem is probably in the DataSet which you pass to the function from outside"}, {"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 1, "creation_date": 1432139382, "post_id": 30355267, "comment_id": 48802893, "body": "Are you sure your collection isn&#39;t empty? What does <code>Dataset.Count return</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "edited": false, "score": 1, "creation_date": 1432139414, "post_id": 30355267, "comment_id": 48802907, "body": "Agree with @KKowalczyk. What are you passing into the function that you hope to return a count from?"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432139768, "post_id": 30355267, "comment_id": 48803190, "body": "Thanks!  I just realized that I though i was passing in a collection, but it was actually empty."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1432142006, "post_id": 30355267, "comment_id": 48804509, "body": "Can you add that as an answer to the question and mark it?  Helps the rest of us who are looking for questions that need attention."}], "answers": [{"tags": [], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "is_accepted": true, "score": 0, "last_activity_date": 1432145109, "creation_date": 1432145109, "answer_id": 30357220, "question_id": 30355267, "link": "https://stackoverflow.com/questions/30355267/object-required-error-424-when-iterating-over-collection/30357220#30357220", "title": "Object required error &#39;424&#39; when iterating over Collection", "body": "<p>The error was actually outside of the function, when the function is called.  Instead of passing in a collection for DataSet, it passes in nothing.  </p>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 779, "favorite_count": 0, "accepted_answer_id": 30357220, "answer_count": 1, "score": 0, "last_activity_date": 1432297296, "creation_date": 1432138892, "last_edit_date": 1432297296, "question_id": 30355267, "link": "https://stackoverflow.com/questions/30355267/object-required-error-424-when-iterating-over-collection", "title": "Object required error &#39;424&#39; when iterating over Collection", "body": "<p>When I run my function, I get the following error:</p>\n\n<pre><code>Run-Time error '424':  Object Required\n</code></pre>\n\n<p>And it highlights the following line of code:</p>\n\n<pre><code>For Each n In DataSet\n</code></pre>\n\n<p>Here is my full code:</p>\n\n<pre><code>'==============================|Find_Occurrences FUNCTION|=============================='\n' Given a collection and a search value, return the number of occurrences of the search\n' value in the collection, as an Integer.  If it does not exist, return the integer 0\nFunction Find_Occurrences(DataSet As Collection, What As Variant) As Integer\n\n    Dim Count As Integer\n    Count = 0\n    Dim n As Variant\n    For Each n In DataSet ''''''''''''''''''Object required error'''''''''''''''''\n        'MsgBox (TypeName(What))\n        If (TypeName(n) = TypeName(What)) And (n = What) Then\n            Count = Count + 1\n        End If\n    Next n\n    Find_Occurrences = Count\n\nEnd Function\n</code></pre>\n\n<p>Does anybody know what could be causing this, whether in my code or outside of my code?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432138827, "post_id": 30355152, "comment_id": 48802586, "body": "Maybe add a sample value for <code>Directory</code> - will that be a full path to an Excel file?"}], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1432139172, "creation_date": 1432139172, "answer_id": 30355367, "question_id": 30355152, "link": "https://stackoverflow.com/questions/30355152/variable-reference-directory-in-code/30355367#30355367", "title": "Variable Reference directory in code", "body": "<p>You can make user choose a file from a dialog box by</p>\n\n<pre><code>range(\"X1\").value = application.getopenfilename\ndim MyDir as string\nMyDir = range(\"X1\").value ' and use MyDir variable in code from now on\n</code></pre>\n\n<p>Hope that was what you were looking for, cheers</p>\n"}, {"tags": [], "owner": {"reputation": 283, "user_id": 4801586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PJcwl.png?s=128&g=1", "display_name": "314UnreadEmails", "link": "https://stackoverflow.com/users/4801586/314unreademails"}, "is_accepted": false, "score": 1, "last_activity_date": 1432140908, "creation_date": 1432140908, "answer_id": 30355918, "question_id": 30355152, "link": "https://stackoverflow.com/questions/30355152/variable-reference-directory-in-code/30355918#30355918", "title": "Variable Reference directory in code", "body": "<p>It looks like you're trying to reference a separate sheet in the same workbook. If that's the case then you can try:<br>\n<code>Range(\"A1\").FormulaR1C1 = \"'\" &amp; Range(\"X1\").Value &amp; \"'!RC...\"</code></p>\n\n<p>However, this works very similarly to the <code>=INDIRECT()</code> worksheet function which may be a better solution especially if this is a static formula. To use this, in cell A1 enter:<br>\n<code>=INDIRECT(\"'\" &amp; X1 &amp; \"'!RC...\")</code></p>\n\n<p>You can read more about the INDIRECT function <a href=\"https://support.microsoft.com/en-us/kb/151323\" rel=\"nofollow\">here.</a></p>\n"}], "owner": {"reputation": 57, "user_id": 4719065, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MpjFC.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/4719065/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 30355367, "answer_count": 2, "score": 0, "last_activity_date": 1432297346, "creation_date": 1432138549, "last_edit_date": 1432297346, "question_id": 30355152, "link": "https://stackoverflow.com/questions/30355152/variable-reference-directory-in-code", "title": "Variable Reference directory in code", "body": "<p>I would like to have a user be able to type in the directory of another spreadsheet into a cell, then use that in my macro. In code like:</p>\n\n<pre><code>Range(\"X1\") = Directory\n\nRange(\"A1\").FormulaR1C1 = 'Directory'!RC)\n</code></pre>\n\n<p>When Range(\"X1\") is where the user types in the Directory of the desired reference file</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432142120, "post_id": 30355120, "comment_id": 48804561, "body": "Couldn&#39;t you find the <i>PartNumber</i> column by its name and without user intervention?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432143803, "post_id": 30355120, "comment_id": 48805477, "body": "Are you trying to put one value (e.g. <code>Range(&quot;B2&quot;).Offset(-1, 1).Value</code>) into a column of cells or do you want a row-by-row value transfer offset by -1 rows?"}, {"owner": {"reputation": 211, "user_id": 1833998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a14f9a95f162e29f907e9465d2a0146?s=128&d=identicon&r=PG", "display_name": "bolilloBorracho", "link": "https://stackoverflow.com/users/1833998/bolilloborracho"}, "edited": false, "score": 0, "creation_date": 1432147254, "post_id": 30355120, "comment_id": 48807491, "body": "the partNumber field is not always the first column and it is not always named partNumber"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 3, "last_activity_date": 1432139357, "creation_date": 1432139357, "answer_id": 30355437, "question_id": 30355120, "link": "https://stackoverflow.com/questions/30355120/use-range-object-as-part-of-a-loop/30355437#30355437", "title": "use range object as part of a loop", "body": "<p>Something like:</p>\n\n<pre><code>Dim LastRow As Long\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\nRange(\"B2:B\" &amp; LastRow).Value = Range(\"B2\").Offset(-1, 1).Value\nRange(\"D2:D\" &amp; LastRow).Value = Range(\"D2\").Offset(-1, 1).Value\nRange(\"F2:F\" &amp; LastRow).Value = Range(\"F2\").Offset(-1, 1).Value\nRange(\"H2:H\" &amp; LastRow).Value = Range(\"H2\").Offset(-1, 1).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1432141724, "last_edit_date": 1432141724, "creation_date": 1432141237, "answer_id": 30356005, "question_id": 30355120, "link": "https://stackoverflow.com/questions/30355120/use-range-object-as-part-of-a-loop/30356005#30356005", "title": "use range object as part of a loop", "body": "<p>Although this answer won't be applied to your situation, I feel like this could help answer some questions you have in there. </p>\n\n<p>When specifying a range, you can separate the column (letter) and row (number) and use your own variables.\nIn a for loop, this could look like</p>\n\n<pre><code>for i = 1 to 100\n     Range(\"A\" &amp; i).Value = Range(\"A\"&amp;i).Offset(, 1).Value\nnext\n</code></pre>\n\n<p>You can also determine the number of the row of the selected cell using:</p>\n\n<pre><code>dim RowNb as long\nRowNb = (ActiveCell.Row)\n</code></pre>\n\n<p>This also applies to columns, and can be used in a loop like I mentionned at the start. </p>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 3, "last_activity_date": 1432141802, "creation_date": 1432141802, "answer_id": 30356169, "question_id": 30355120, "link": "https://stackoverflow.com/questions/30355120/use-range-object-as-part-of-a-loop/30356169#30356169", "title": "use range object as part of a loop", "body": "<p>Assuming the you are running code in the Worksheet added here:</p>\n\n<pre><code>'copy the worksheet and rename it before editing\nSheets(1).Copy After:=Sheets(1)\nActiveSheet.Name = MySheetName\n</code></pre>\n\n<p>Also not sure what is the purpose of this code, nevertheless using it for the sample</p>\n\n<pre><code>Range(\"B2:B10000\").Value = Range(\"B2\").Offset(-1, 1).Value\n</code></pre>\n\n<p>Try this:</p>\n\n<pre><code>Dim lLastRow As Long\nlLastRow = wbk.Worksheets(MySheetName).UsedRange.SpecialCells(xlLastCell).Row\n\nRem This updates only columns B, D, F &amp; H - adjust as needed\nFor colx = 2 To 8 Step 2\n    With wbk.Worksheets(MySheetName)\n        Rem Creates Range as Range(Cells(rIni,cIini), Cells(rEnd,cEnd))\n        rem Corresponding code for \"Range(\"B2:B10000\").Value = Range(\"B2\").Offset(-1, 1).Value\" (see comment above)\n        Range(.Cells(2, colx), .Cells(lLastRow, colx)) = .Cells(2, colx).Offset(-1, 1).Value\nEnd With: Next\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1432147640, "last_edit_date": 1432147640, "creation_date": 1432144325, "answer_id": 30356972, "question_id": 30355120, "link": "https://stackoverflow.com/questions/30355120/use-range-object-as-part-of-a-loop/30356972#30356972", "title": "use range object as part of a loop", "body": "<p>The one thing that was conspicuous by its absence in your description was any mention of the nature of the data in the worksheet. You mentioned <code>A1</code> briefly but your range value assignments started at row 2 so it may be inferred that row 1 contains column header labels.</p>\n\n<pre><code>Sub prepareWorkbook()\n    Dim wbk As Workbook, wks As Worksheet\n    Dim colx As Long\n    Dim lc As Long, lr As Long\n    Dim MySheetName As String\n\n    Set wbk = ThisWorkbook    'no idea what this does\n    Set wks = wbk.ActiveSheet 'no idea what this does\n    MySheetName = \"Import\"\n\n    'no idea what this does or what sht is\n    'LastRow = sht.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\n    'copy the worksheet and rename it before editing\n    Sheets(1).Copy After:=Sheets(1)\n\n    With Sheets(2)\n        .Name = MySheetName\n\n        If CBool(Application.CountIf(.Rows(1), \"PartNumber\")) Then\n            colx = Application.Match(\"PartNumber\", .Rows(1), 0)\n        Else\n            colx = .Range(Application.InputBox(\"Enter Letter of Id column\") &amp; 1).Column\n        End If\n        If .Columns(colx).Column &gt; 1 Then\n            'cut Id column from current location and insert it at column index 1\n            .Columns(colx).Cut\n            .Columns(1).Insert Shift:=xlToRight\n        End If\n\n        'quickest way to trim trailing spaces is with Text-to-Columns, Fixed Width\n        With .Columns(1)\n            .TextToColumns Destination:=.Cells(1), DataType:=xlFixedWidth, FieldInfo:=Array(0, 1)\n        End With\n\n        ' insert column every other column (working backwards toward A1)\n        For lc = .Cells(1, Columns.Count).End(xlToLeft).Column To 2 Step -1\n            .Columns(lc).Insert Shift:=xlToRight\n        Next lc\n\n        For lc = (.Cells(1, Columns.Count).End(xlToLeft).Column - 1) To 2 Step -2\n            'let's put the row-by-row value in instead of a single value into all cells\n            lr = .Cells(Rows.Count, lc + 1).End(xlUp).Row\n            With .Cells(2, lc).Resize(lr - 1, 1)\n                .Cells = .Offset(-1, 1).Value\n                .EntireColumn.AutoFit\n            End With\n        Next lc\n\n    End With\n\n    Set wbk = Nothing\n    Set wks = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Explanations as comments in code.</p>\n"}], "owner": {"reputation": 211, "user_id": 1833998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a14f9a95f162e29f907e9465d2a0146?s=128&d=identicon&r=PG", "display_name": "bolilloBorracho", "link": "https://stackoverflow.com/users/1833998/bolilloborracho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 30356169, "answer_count": 4, "score": 1, "last_activity_date": 1432147640, "creation_date": 1432138450, "last_edit_date": 1531161705, "question_id": 30355120, "link": "https://stackoverflow.com/questions/30355120/use-range-object-as-part-of-a-loop", "title": "use range object as part of a loop", "body": "<p>I pasted the entire macro below but this is the important part. </p>\n\n<pre><code>Range(\"B2:B10000\").Value = Range(\"B2\").Offset(-1, 1).Value    \nRange(\"D2:D10000\").Value = Range(\"D2\").Offset(-1, 1).Value    \nRange(\"F2:F10000\").Value = Range(\"F2\").Offset(-1, 1).Value    \nRange(\"H2:H10000\").Value = Range(\"H2\").Offset(-1, 1).Value\n</code></pre>\n\n<p>It works as is except it is creating unnecessary data because I don't know how to use variable names in a range object. My ranges are currently hard coded such as (\"A1:A1000\"), when I would like it to be something like (\"A1:A &amp; LastRow). </p>\n\n<p>Also I have to explicitly call out column names to copy because the range won't accept a variable name like (\"currentColumn &amp; 1:currentColumn &amp; LastRow).</p>\n\n<p>Is there a way to use a varible name as part of a range object so we can use them in loops?</p>\n\n<pre><code>Sub prepareWorkbook()\n\nDim wbk As Workbook\nSet wbk = ThisWorkbook\nDim wks As Worksheet\nSet wks = wbk.ActiveSheet\nDim colx As Long\nDim ColumnCount As Long\nDim MySheetName As String\nMySheetName = \"Import\"\nLastRow = sht.Cells.Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\n\n'copy the worksheet and rename it before editing\nSheets(1).Copy After:=Sheets(1)\nActiveSheet.Name = MySheetName\n\n'identify the Id column and move it to 1st column\nDim answer As Variant\nDim IdColumn As Range\nanswer = Application.InputBox(\"Enter Letter of Id column\")\n\nIf Columns(answer).Column = 1 Then\nElse\n    'cut Id column from current location and insert it at column index 1\n    Columns(answer).Select\n    Selection.Cut\n    Columns(\"A:A\").Select\n    Selection.Insert Shift:=xlToRight\nEnd If\n\n'trim the PartNumber column of any trailing spaces\nDim c As Range\nFor Each c In Range(\"A1:A10000\")\n    c.Value = Application.Trim(Replace(c.Value, Chr(160), Chr(32)))\nNext\n\n' insert column every other column\n' Loop through number of columns.\nColumnCount = Application.WorksheetFunction.CountA(Rows(1)) * 2\n\n'step 2 means skip every other\nFor colx = 2 To ColumnCount Step 2\n    Columns(colx).Insert Shift:=xlToRight\nNext\n\nRange(\"B2:B10000\").Value = Range(\"B2\").Offset(-1, 1).Value    \nRange(\"D2:D10000\").Value = Range(\"D2\").Offset(-1, 1).Value    \nRange(\"F2:F10000\").Value = Range(\"F2\").Offset(-1, 1).Value    \nRange(\"H2:H10000\").Value = Range(\"H2\").Offset(-1, 1).Value\n\nwks.Cells.EntireColumn.AutoFit\nMsgBox (\"Done\")\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "if-statement", "range", "vba"], "comments": [{"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432137532, "post_id": 30354615, "comment_id": 48801717, "body": "What is stopping you from looping through the tables? Seems like a much more straight forward approach"}, {"owner": {"reputation": 105, "user_id": 4905139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5641a1e4f75756001d653b371018b?s=128&d=identicon&r=PG&f=1", "display_name": "Ettelaiv", "link": "https://stackoverflow.com/users/4905139/ettelaiv"}, "reply_to_user": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432137865, "post_id": 30354615, "comment_id": 48801946, "body": "To check for my 3 criteria or to set my ranges ? Either way I&#39;m not sure how I would do that for 3 criteria in 3 columns (I&#39;m just starting on VBA)"}, {"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432138411, "post_id": 30354615, "comment_id": 48802332, "body": "Do you have one criteria in each column? Are you looking for the row number that matches each criteria in its respective column?"}, {"owner": {"reputation": 105, "user_id": 4905139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5641a1e4f75756001d653b371018b?s=128&d=identicon&r=PG&f=1", "display_name": "Ettelaiv", "link": "https://stackoverflow.com/users/4905139/ettelaiv"}, "reply_to_user": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432139223, "post_id": 30354615, "comment_id": 48802801, "body": "I have one criteria per column (in the three first columns). So I&#39;m trying to find the row in which the 3 criteria are met, that way I can access the correspondent cells in column 4 and column 5"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4905139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5641a1e4f75756001d653b371018b?s=128&d=identicon&r=PG&f=1", "display_name": "Ettelaiv", "link": "https://stackoverflow.com/users/4905139/ettelaiv"}, "edited": false, "score": 0, "creation_date": 1432141208, "post_id": 30355643, "comment_id": 48804062, "body": "Thanks a lot for your answer. When I run this, it tells me &quot;wrong number of arguments or invalid property assignment&quot; at the line &quot;rRow.row = matchedRow&quot; ?"}], "tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": true, "score": 1, "last_activity_date": 1432140044, "creation_date": 1432140044, "answer_id": 30355643, "question_id": 30354615, "link": "https://stackoverflow.com/questions/30354615/syntax-in-excel-vba-how-to-refer-to-column-of-a-table-as-a-range-in-the-if-f/30355643#30355643", "title": "Syntax in Excel VBA: how to refer to column of a table as a range in the &quot;=IF&quot; function", "body": "<pre><code>Dim rng1 As Range\nDim rRow as Range\nDim matchedRow as Integer\nSet rng1 = Worksheets(\"Sheet6\").Range(\"A7:A15\")\n\n    for each rRow in rng1\n\n        if Range(\"A\" &amp; rRow.row).Value2 = \"Criteria1\" and Range(\"B\" &amp; rRow.row).Value2 = \"Criteria2\" and Range(\"C\" &amp; rRow.row).Value2 = \"Criteria3\" then\n            rRow.row = matchedRow\n            ''Do stuff with matchedRow\n        end if\n\n    next rRow\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 1, "creation_date": 1432148219, "post_id": 30357695, "comment_id": 48808050, "body": "You can use <code>Range.column</code> to  return the column number. Then use <code>Cells(rowNum, colNum)</code> instead of <code>range</code>"}, {"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432153765, "post_id": 30357695, "comment_id": 48811212, "body": "No problem :) If my answer has helped you, you can mark it as correct by clicking the tick adjacent to it"}], "tags": [], "owner": {"reputation": 105, "user_id": 4905139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5641a1e4f75756001d653b371018b?s=128&d=identicon&r=PG&f=1", "display_name": "Ettelaiv", "link": "https://stackoverflow.com/users/4905139/ettelaiv"}, "is_accepted": false, "score": 0, "last_activity_date": 1432146620, "creation_date": 1432146620, "answer_id": 30357695, "question_id": 30354615, "link": "https://stackoverflow.com/questions/30354615/syntax-in-excel-vba-how-to-refer-to-column-of-a-table-as-a-range-in-the-if-f/30357695#30357695", "title": "Syntax in Excel VBA: how to refer to column of a table as a range in the &quot;=IF&quot; function", "body": "<p>Thank you so much kaybee99, the following code worked great for me:</p>\n\n<pre><code>    Dim Rng As Range\n    Set Rng = Application.Range(Table[Column1])\n    Dim rRow As Range\n    Dim matchedRow As Integer\n\n    For Each rRow In BTUHRng\n        If Worksheets(MySheet).Range(\"A\" &amp; rRow.Row).Value2 = Number1 And Worksheets(MySheet).Range(\"B\" &amp; rRow.Row).Value2 = \"Text\" And Worksheets(MySheet).Range(\"C\" &amp; rRow.Row).Value2 &gt; Number2 Then\n            matchedRow = rRow.Row\n            Range(\"E1\").Value = matchedRow\n            Exit For\n        End If\n    Next rRow\n</code></pre>\n\n<p>I added an \"Exit For\" because I am only interested in the first value that meets these criteria. </p>\n\n<p>Quick question: is it possible to replace \"A\", \"B\" and \"C\" by using a reference to the table column ? Something like Table[Column1].Column which would mean \"A\" ? THanks!</p>\n"}], "owner": {"reputation": 105, "user_id": 4905139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5641a1e4f75756001d653b371018b?s=128&d=identicon&r=PG&f=1", "display_name": "Ettelaiv", "link": "https://stackoverflow.com/users/4905139/ettelaiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "accepted_answer_id": 30355643, "answer_count": 2, "score": 1, "last_activity_date": 1432146620, "creation_date": 1432137119, "last_edit_date": 1531164843, "question_id": 30354615, "link": "https://stackoverflow.com/questions/30354615/syntax-in-excel-vba-how-to-refer-to-column-of-a-table-as-a-range-in-the-if-f", "title": "Syntax in Excel VBA: how to refer to column of a table as a range in the &quot;=IF&quot; function", "body": "<p>I'm trying to find the row of a cell (in a table) which meets 3 criteria. Thanks to <a href=\"https://stackoverflow.com/questions/20764851/vba-excel-find-based-on-multiple-search-criteria-without-looping\">another post</a>  I have come up with this working code:</p>\n\n<pre><code>x = Filter(Application.Transpose(Application.Evaluate(\"=IF((Sheet6!A6:A15=\"\"joseph\"\")*(Sheet6!B6:B15&gt;date(2001,1,1))*Sheet6!C6:C15=\"\"grenade\"\"),ROW(Sheet6!A6:A15),\"\"x\"\")\")), \"x\", False)*\n</code></pre>\n\n<p>I would now like to use named ranges in this code instead of \"Sheet6!A6:A15). When I try this I keep getting an error \"<strong>Type mismatch</strong>\".\nI have tried to set different ranges such as:</p>\n\n<pre><code>1) Dim rng1 As Range\n   Set rng1 = Worksheets(\"Sheet6\").Range(\"A7:A15\")\n   x = Filter(Application.Transpose(Application.Evaluate(\"=IF((rng1=\"\"joseph\"\")*(Sheet6!B6:B15&gt;date(2001,1,1))*Sheet6!C6:C15=\"\"grenade\"\"),ROW(rng1),\"\"x\"\")\")), \"x\", False)*\n\n2) Dim rng2 As Range\n   Set rng2 = Worksheets(\"Sheet6\").Range(\"TestTable10[Column1]\")\n   x = Filter(Application.Transpose(Application.Evaluate(\"=IF((rng2 =\"\"joseph\"\")*(Sheet6!B6:B15&gt;date(2001,1,1))*Sheet6!C6:C15=\"\"grenade\"\"),ROW(rng2 ),\"\"x\"\")\")), \"x\", False)*\n\n3) Dim rng3 As Range\n   Set rng3 = Worksheets(\"Sheet6\").ListObjects(\"TestTable10\").ListColumns(1).Range\n   x = Filter(Application.Transpose(Application.Evaluate(\"=IF((rng3 =\"\"joseph\"\")*(Sheet6!B6:B15&gt;date(2001,1,1))*Sheet6!C6:C15=\"\"grenade\"\"),ROW(rng3 ),\"\"x\"\")\")), \"x\", False)*\n</code></pre>\n\n<p>I have also tried by doing the same for the ranges B6:b15 and C6:C15 but no matter what I do, I keep getting an error \"<strong>Type Mismatch</strong>\"</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1432137969, "post_id": 30354613, "comment_id": 48802011, "body": "Just to clarify: do you want your exported data to just export to a new Excel document. Or do you want your exported data to be inserted as a new sheet within an existing workbook?"}, {"owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1432141297, "post_id": 30354613, "comment_id": 48804109, "body": "Yes, a new sheet within an existing workbook"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1432141759, "post_id": 30354613, "comment_id": 48804372, "body": "Which answer worked for you?"}], "answers": [{"tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": false, "score": 1, "last_activity_date": 1432137920, "creation_date": 1432137920, "answer_id": 30354908, "question_id": 30354613, "link": "https://stackoverflow.com/questions/30354613/how-would-i-convert-a-ms-acess-query-to-a-sheet-in-ms-excel/30354908#30354908", "title": "How would I convert a MS-Acess Query to a sheet in MS-Excel", "body": "<p>The command you're looking for is TransferSpreadsheet.</p>\n\n<pre><code>    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, \"YourQuery\", \"FilePath.xlsx\", True\n</code></pre>\n\n<p>The variables are saying that you want an export, Excel 2000 format (you can change to acSpreadsheetTypeExcel12 if you want 2010 instead), choosing your query, where to save, and the True indicates that your export has field names.</p>\n"}, {"comments": [{"owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "edited": false, "score": 0, "creation_date": 1432146621, "post_id": 30355424, "comment_id": 48807143, "body": "Thank you very much for proving your functions. The only question I have is that (regardless of sheet name) it overrides the last sheet instead of creating a new one. Any quick way for me to fix this?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "edited": false, "score": 0, "creation_date": 1432204616, "post_id": 30355424, "comment_id": 48832532, "body": "Have updated the first procedure (3 times at the bottom of the original post) to answer your questions."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1432204539, "last_edit_date": 1432204539, "creation_date": 1432139326, "answer_id": 30355424, "question_id": 30354613, "link": "https://stackoverflow.com/questions/30354613/how-would-i-convert-a-ms-acess-query-to-a-sheet-in-ms-excel/30355424#30355424", "title": "How would I convert a MS-Acess Query to a sheet in MS-Excel", "body": "<p>A bit of a long winded answer - and TransferSpreadsheet will probably work for you.</p>\n\n<p>I've written three procedures below - the first ties the second and third together, the second creates an instance of Excel to put the data into, the third exports the query (or recordset) as requested.</p>\n\n<p>So first the procedure to tie it all together:</p>\n\n<pre><code>Public Sub ExportMyQuery()\n\n    Dim oXLApp As Object             'Reference to Excel Application.\n    Dim oXLWrkBk As Object           'Reference to workbook.\n    Dim oXLWrkSht As Object          'Reference to worksheet.\n    Dim colHeadings As Collection\n\n    'Edit - leave these out and it will use the database field names.\n    Set colHeadings = New Collection\n    colHeadings.Add \"MyField1\"\n    colHeadings.Add \"MyField2\"\n    colHeadings.Add \"MyField3\"\n    colHeadings.Add \"MyField4\"\n    colHeadings.Add \"MyField5\"\n    colHeadings.Add \"MyField6\"\n\n    Set oXLApp = CreateXL\n    Set oXLWrkBk = oXLApp.WorkBooks.Add(-4167) 'xlWBATWorksheet - Workbook with 1 worksheet.\n    Set oXLWrkSht = oXLWrkBk.WorkSheets(1)\n\n    'This is the function you're after.  It's not perfect yet (check TO DO comments in the function):\n    If QueryExportToXL(oXLWrkSht, \"qry_MyQuery\", , \"Sheet1\", oXLWrkSht.cells(2, 1), , colHeadings) = True Then\n        MsgBox \"Successful\"\n    Else\n        MsgBox \"Failed\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Next, create an instance of Excel (no need to set references to Excel first):</p>\n\n<pre><code>'----------------------------------------------------------------------------------\n' Procedure : CreateXL\n' Author    : Darren Bartrup-Cook\n' Date      : 02/10/2014\n' Purpose   : Creates an instance of Excel and passes the reference back.\n'-----------------------------------------------------------------------------------\nPublic Function CreateXL(Optional bVisible As Boolean = True) As Object\n\n    Dim oTmpXL As Object\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Defer error trapping in case Excel is not running. '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    On Error Resume Next\n    Set oTmpXL = GetObject(, \"Excel.Application\")\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'If an error occurs then create an instance of Excel. '\n    'Reinstate error handling.                            '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        On Error GoTo ERROR_HANDLER\n        Set oTmpXL = CreateObject(\"Excel.Application\")\n    End If\n\n    oTmpXL.Visible = bVisible\n    Set CreateXL = oTmpXL\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure CreateXL.\"\n            Err.Clear\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>Finally, export the query - or recordset - and rename the headings if you want.</p>\n\n<pre><code>'----------------------------------------------------------------------------------\n' Procedure : QueryExportToXL\n' Author    : Darren Bartrup-Cook\n' Date      : 26/08/2014\n' Purpose   : Exports a named query or recordset to Excel.\n'-----------------------------------------------------------------------------------\nPublic Function QueryExportToXL(wrkSht As Object, Optional sQueryName As String, _\n                                                  Optional rst As DAO.Recordset, _\n                                                  Optional SheetName As String, _\n                                                  Optional rStartCell As Object, _\n                                                  Optional AutoFitCols As Boolean = True, _\n                                                  Optional colHeadings As Collection) As Boolean\n\n    Dim db As DAO.Database\n    Dim prm As DAO.Parameter\n    Dim qdf As DAO.QueryDef\n    Dim fld As DAO.Field\n    Dim oXLCell As Object\n    Dim vHeading As Variant\n\n    On Error GoTo ERROR_HANDLER\n\n    If sQueryName &lt;&gt; \"\" And rst Is Nothing Then\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        'Open the query recordset.                               '\n        'Any parameters in the query need to be evaluated first. '\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        Set db = CurrentDb\n        Set qdf = db.QueryDefs(sQueryName)\n        For Each prm In qdf.Parameters\n            prm.Value = Eval(prm.Name)\n        Next prm\n        Set rst = qdf.OpenRecordset\n    End If\n\n    If rStartCell Is Nothing Then\n        Set rStartCell = wrkSht.cells(1, 1)\n    Else\n        If rStartCell.Parent.Name &lt;&gt; wrkSht.Name Then\n            Err.Raise 4000, , \"Incorrect Start Cell parent.\"\n        End If\n    End If\n\n\n    If Not rst.BOF And Not rst.EOF Then\n        With wrkSht\n            Set oXLCell = rStartCell\n\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            'Paste the field names from the query into row 1 of the sheet. '\n            'TO DO: Facility to use an alternative name.                   '\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            If colHeadings Is Nothing Then\n                For Each fld In rst.Fields\n                    oXLCell.Value = fld.Name\n                    Set oXLCell = oXLCell.Offset(, 1)\n                Next fld\n            Else\n                For Each vHeading In colHeadings\n                    oXLCell.Value = vHeading\n                    Set oXLCell = oXLCell.Offset(, 1)\n                Next vHeading\n            End If\n\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            'Paste the records from the query into row 2 of the sheet. '\n            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            Set oXLCell = rStartCell.Offset(1, 0)\n            oXLCell.copyfromrecordset rst\n            If AutoFitCols Then\n                .Columns.Autofit\n            End If\n\n            If SheetName &lt;&gt; \"\" Then\n                .Name = SheetName\n            End If\n\n            '''''''''''''''''''''''''''''''''''''''''''\n            'TO DO: Has recordset imported correctly? '\n            '''''''''''''''''''''''''''''''''''''''''''\n            QueryExportToXL = True\n\n        End With\n    Else\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        'There are no records to export, so the export has failed. '\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n        QueryExportToXL = False\n    End If\n\n    Set db = Nothing\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure QueryExportToXL.\"\n            Err.Clear\n            Resume\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>A bit long winded, but you can rename headings and export tables or queries with or without parameters and paste the result starting at a specific cell within a specific worksheet.</p>\n\n<hr>\n\n<p><strong>Update:</strong>\nRather than create a new workbook with a single worksheet each time you can change the ExportMyQuery procedure to pass different worksheets and cell references to the main procedures:</p>\n\n<pre><code>Public Sub ExportMyQuery1()\n\n    Dim oXLApp As Object             'Reference to Excel Application.\n    Dim oXLWrkBk As Object           'Reference to workbook.\n    Dim oXLWrkSht As Object          'Reference to worksheet.\n    Dim colHeadings As Collection\n\n    Set colHeadings = New Collection\n    colHeadings.Add \"MyField1\"\n    colHeadings.Add \"MyField2\"\n    colHeadings.Add \"MyField3\"\n    colHeadings.Add \"MyField4\"\n    colHeadings.Add \"MyField5\"\n    colHeadings.Add \"MyField6\"\n\n    Set oXLApp = CreateXL\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Open an existing workbook and add a sheet at the end. '\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    Set oXLWrkBk = oXLApp.workbooks.Open(\"C:\\Documents and Settings\\crladmin.ADMINNOT\\Desktop\\Book1.xlsx\")\n    Set oXLWrkSht = oXLWrkBk.worksheets.Add(, oXLWrkBk.worksheets(oXLWrkBk.worksheets.Count))\n    Set oXLWrkSht.Name = \"A WorkSheet Name\"\n\n    If QueryExportToXL(oXLWrkSht, \"qry_MyQuery\", , oXLWrkSht.Name, oXLWrkSht.Cells(2, 1), , colHeadings) = True Then\n        MsgBox \"Successful\"\n    Else\n        MsgBox \"Failed\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Public Sub ExportMyQuery2()\n\n    Dim oXLApp As Object             'Reference to Excel Application.\n    Dim oXLWrkBk As Object           'Reference to workbook.\n    Dim oXLWrkSht As Object          'Reference to worksheet.\n    Dim colHeadings As Collection\n    Dim x As Long\n\n    Set colHeadings = New Collection\n    colHeadings.Add \"MyField1\"\n    colHeadings.Add \"MyField2\"\n    colHeadings.Add \"MyField3\"\n    colHeadings.Add \"MyField4\"\n    colHeadings.Add \"MyField5\"\n    colHeadings.Add \"MyField6\"\n\n    Set oXLApp = CreateXL\n\n    ''''''''''''''''''''''''''''\n    'Open an existing workbook '\n    ''''''''''''''''''''''''''''\n    Set oXLWrkBk = oXLApp.workbooks.Open(\"C:\\Documents and Settings\\crladmin.ADMINNOT\\Desktop\\Book1.xlsx\")\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Create three sheets and export the query results to each sheet. '\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    For x = 1 To 3\n\n        Set oXLWrkSht = oXLWrkBk.worksheets.Add(, oXLWrkBk.worksheets(oXLWrkBk.worksheets.Count))\n        oXLWrkSht.Name = \"A WorkSheet Name\" &amp; x\n\n        If QueryExportToXL(oXLWrkSht, \"qry_MyQuery\", , oXLWrkSht.Name, oXLWrkSht.Cells(2, 1), , colHeadings) = True Then\n            MsgBox \"Successful\"\n        Else\n            MsgBox \"Failed\"\n        End If\n\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>Public Sub ExportMyQuery()\n\n    Dim oXLApp As Object             'Reference to Excel Application.\n    Dim oXLWrkBk As Object           'Reference to workbook.\n    Dim oXLWrkSht As Object          'Reference to worksheet.\n    Dim colHeadings As Collection\n    Dim x As Long\n    Dim lLastRow As Long\n\n    Set colHeadings = New Collection\n    colHeadings.Add \"MyField1\"\n    colHeadings.Add \"MyField2\"\n    colHeadings.Add \"MyField3\"\n    colHeadings.Add \"MyField4\"\n    colHeadings.Add \"MyField5\"\n    colHeadings.Add \"MyField6\"\n\n    Set oXLApp = CreateXL\n\n    ''''''''''''''''''''''''''''\n    'Open an existing workbook '\n    ''''''''''''''''''''''''''''\n    Set oXLWrkBk = oXLApp.workbooks.Open(\"C:\\Documents and Settings\\crladmin.ADMINNOT\\Desktop\\Book1.xlsx\")\n    Set oXLWrkSht = oXLWrkBk.worksheets.Add(, oXLWrkBk.worksheets(oXLWrkBk.worksheets.Count))\n    oXLWrkSht.Name = \"A WorkSheet Name\"\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Export the same query to 1 sheet 3 times, appending to the bottom of the data. '\n    'NB - I haven't added anything to remove field headings each time.              '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    For x = 1 To 3\n\n        lLastRow = oXLWrkSht.Cells(oXLWrkSht.Rows.Count, \"A\").End(-4162).Row '-4162 = xlUp\n\n        QueryExportToXL oXLWrkSht, \"qry_MyQuery\", , oXLWrkSht.Name, oXLWrkSht.Cells(lLastRow + 1, 1), , colHeadings\n\n\n    Next x\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 4092675, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1463524265/picture?type=large", "display_name": "Chris Chevalier", "link": "https://stackoverflow.com/users/4092675/chris-chevalier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 30355424, "answer_count": 2, "score": 1, "last_activity_date": 1432204539, "creation_date": 1432137118, "last_edit_date": 1432139769, "question_id": 30354613, "link": "https://stackoverflow.com/questions/30354613/how-would-i-convert-a-ms-acess-query-to-a-sheet-in-ms-excel", "title": "How would I convert a MS-Acess Query to a sheet in MS-Excel", "body": "<p>I'm trying to create a VBA script in access to periodically save a query's data as a new sheet in a excel file. I've started the code but am stuck how to convert a query to data in the sheet. I'm sure there is a command to do so (such as exporting a table as a excel file) but I haven't been able to find one. Here is my code so far.</p>\n\n<pre><code>    Dim xlsApp As Excel.Application\n    Dim xlsBook As Excel.Workbook\n    Dim xlsSheet As Excel.Worksheet\n    Dim SheetName As String\n    SheetName = Format(Date, \"YYYY MM DD\") ' name sheet after date\n    Set xlsBook = Workbook.Open(\"C:\\Users\\...\")\n    Set xlsApp = xlsBook.Parent\n    Set xlsSheet = xlsBook.sheets(SheetName).Add\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432137373, "post_id": 30354597, "comment_id": 48801600, "body": "Is the SELECT Query saved as a per-compiled Query? Or you want to do this in run time?"}, {"owner": {"reputation": 1, "user_id": 4921029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85808c85664395a968f7c7de2d5de246?s=128&d=identicon&r=PG&f=1", "display_name": "Chip W.", "link": "https://stackoverflow.com/users/4921029/chip-w"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432140135, "post_id": 30354597, "comment_id": 48803414, "body": "I&#39;d like to run this in real time. I currently have the query in a SQL Select statement, but I&quot;m happy to save the query as a query object in the DB."}, {"owner": {"reputation": 1, "user_id": 4921029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85808c85664395a968f7c7de2d5de246?s=128&d=identicon&r=PG&f=1", "display_name": "Chip W.", "link": "https://stackoverflow.com/users/4921029/chip-w"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432140629, "post_id": 30354597, "comment_id": 48803739, "body": "I think i may have found a solution. Rather than using a textbox, or a combobox, I was able to get a list box to reflect the value. There&#39;s probably a better way to do this but incase this helps anyone else. I added the query statement to the listbox RowSource and DefaultValue properties and used an on change event on the prior combobox control to requery the statement."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432198633, "post_id": 30354597, "comment_id": 48828424, "body": "As long as you are happy. Just that you know, I have written a solution if you want to know how to do it. Good luck !"}, {"owner": {"reputation": 1, "user_id": 4921029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85808c85664395a968f7c7de2d5de246?s=128&d=identicon&r=PG&f=1", "display_name": "Chip W.", "link": "https://stackoverflow.com/users/4921029/chip-w"}, "reply_to_user": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432245160, "post_id": 30354597, "comment_id": 48859153, "body": "Thanks Paul! I&#39;ll look over it and see if it will work for my purposes. I&#39;m not sure if my method is the most efficient and I&#39;m willing to look at other options to achieve my goal."}], "answers": [{"tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 1, "last_activity_date": 1432140583, "creation_date": 1432140583, "answer_id": 30355818, "question_id": 30354597, "link": "https://stackoverflow.com/questions/30354597/passing-query-result-to-a-textbox-control-on-an-access-form/30355818#30355818", "title": "Passing query result to a textbox control on an access form", "body": "<p>If you wish to do this in run time, you need to do the following, I take the controls you are referring to in this is on the same form.</p>\n\n<p>The very simple and straight forward way to get it done is as follows,</p>\n\n<pre><code>Private Sub cbo3_Change()\n    Dim tmpRS As DAO.Recordset\n\n    Set tmpRS = CurrentDb.OpenRecordset(\"SELECT tbl_Billing.Savings_b FROM tbl_Billing GROUP BY \" &amp; _\n                                        \"tbl_Billing.UBI_b, tbl_Billing.TaxYr_b, tbl_Billing.TaxPrg_b, \" &amp; _\n                                        \"tbl_Billing.Savings_b HAVING ((tbl_Billing.UBI_b = '\" &amp; Me.cbo1 &amp; \"') And (tbl_Billing.TaxYr_b = '\" &amp; Me.cbo2 &amp; \"') \" &amp; _\n                                        \"And (tbl_Billing.TaxPrg_b = '\" &amp; Me.cbo3 &amp; \"'))\")\n    If tmpRS.RecordCount &gt; 0 Then\n        Me.tbx2 = tmpRS.Fields(0)\n    Else\n        Me.tbx2 = 0\n    End If\n\n    Set tmpRS = Nothing\nEnd Sub \n</code></pre>\n\n<p>Just note, I have implied all your combo boxes are returning <strong>String</strong> and the field you are comparing against are <strong>Text</strong> type. If that is not the case, you need to make changes accordingly.</p>\n"}], "owner": {"reputation": 1, "user_id": 4921029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85808c85664395a968f7c7de2d5de246?s=128&d=identicon&r=PG&f=1", "display_name": "Chip W.", "link": "https://stackoverflow.com/users/4921029/chip-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8560, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643633, "creation_date": 1432137102, "last_edit_date": 1594643633, "question_id": 30354597, "link": "https://stackoverflow.com/questions/30354597/passing-query-result-to-a-textbox-control-on-an-access-form", "title": "Passing query result to a textbox control on an access form", "body": "<p>I need help with a textbox field on an Access 2007 form. I'm trying to insert the result of a query into the text box control on the form.  This is used soley as information for the user. The form supplies the query with parameters to get the value. The query works fine and returns the correct result. What I can't seem to figure out is how to pass the query result to the textbox. I\u2019ve tried several different ways but with no luck. </p>\n\n<p>(PS> I know a combo box can do a lookup, however I don\u2019t want the user to have to click the dropdown just to select the value as there can only ever be one value result from the query.) I'm open to suggestions as I'm not a programmer or DB Admin, but I've taking a few classes on Access (enough to be dangerous).</p>\n\n<pre><code>Private Sub cbo3_Change()\nMe.tbx2 = (\"SELECT tbl_Billing.Savings_b FROM tbl_Billing GROUP BY tbl_Billing.UBI_b, tbl_Billing.TaxYr_b, tbl_Billing.TaxPrg_b, tbl_Billing.Savings_b HAVING (((tbl_Billing.UBI_b)=forms!f1_UpBilled!cbo1) And ((tbl_Billing.TaxYr_b)=forms!f1_Upbilled!cbo2) And ((tbl_Billing.TaxPrg_b)=forms!f1_UpBilled!cbo3));\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "is_accepted": true, "score": 0, "last_activity_date": 1432145418, "creation_date": 1432145418, "answer_id": 30357311, "question_id": 30354536, "link": "https://stackoverflow.com/questions/30354536/vba-ms-word-legacy-form-field-calculation/30357311#30357311", "title": "VBA MS-Word legacy form field calculation", "body": "<p>I researched some more and discovered how the Calculations work in fields... I check \"Calculate on Exit\" for text1 &amp; text2, and select \"Calculation\" as the type on text3, with the expression \"=text1+text2\" and no VBA is required. I then can have a macro to record the results of text1 + text2 run on exit in text2 if I need to capture that variable for later use.</p>\n"}], "owner": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 30357311, "answer_count": 1, "score": 0, "last_activity_date": 1432145418, "creation_date": 1432136950, "last_edit_date": 1432139131, "question_id": 30354536, "link": "https://stackoverflow.com/questions/30354536/vba-ms-word-legacy-form-field-calculation", "title": "VBA MS-Word legacy form field calculation", "body": "<p>I have 3 legacy form fields, named text1, text2, and text3. My sample code is:</p>\n\n<pre><code>Option Explicit\n\nPublic a as integer\nPublic b as integer\nPublic c as integer\n\nSub TextA()\n  If ActiveDocument.FormFields(\"text1\").Result = \"\" Then\n    MsgBox \"You must specify a number. If none, enter a zero.\"\n  End If\n  a = ActiveDocument.FormFields(\"text1\").Result  \nEnd Sub\n\nSub TextB()\n  If ActiveDocument.FormFields(\"text2\").Result = \"\" Then\n    MsgBox \"You must specify a number. If none, enter a zero.\"\n  End If\n  b = ActiveDocument.FormFields(\"text2\").Result\nEnd Sub\n\nSub CalculateC()\n  c = a + b\nEnd Sub\n</code></pre>\n\n<p>Now text1 and text2 run the 1st two subs respectively on exit (set in their property menu)...I want text3 to automatically display c. I'm thinking I could use the form field property \"Calculate\" or run the sub (run on entry perhaps?) - or a combination of both, but cannot quite get it working. What are my options?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1432136348, "post_id": 30354230, "comment_id": 48800888, "body": "You are not looping backwards. You are defining the range by supplying the end and start cell references but that loop is still going forwards. Loop using the row number from end to start with Step -1."}, {"owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1432136635, "post_id": 30354230, "comment_id": 48801096, "body": "Ah I see that now. Please post an answer. +1"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1432137289, "post_id": 30354230, "comment_id": 48801562, "body": "You can also build a <code>Range</code> using <code>Union</code> and then do a single <code>Delete</code> at the end.  Same idea as @Jeeped but does not require row numbers or going backwards."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432137651, "post_id": 30354710, "comment_id": 48801797, "body": "TBH, the second (nested) For/Next only deletes a single row then exits so if your original code was working for you in that respect, it did not have to be changed. All parameters are re-evaluated if the loop is entered a second time. Personally, I might have used filters to avoid looping through each cell individually."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1432137386, "creation_date": 1432137386, "answer_id": 30354710, "question_id": 30354230, "link": "https://stackoverflow.com/questions/30354230/deletion-loop-requires-multiple-runs-to-delete-all-rows-meeting-criteria/30354710#30354710", "title": "Deletion loop requires multiple runs to delete all rows meeting criteria", "body": "<p>Here is a portion of your code rewritten to accommodate walking backwards through the rows. Note that I have adjusted your string concatenation as well.</p>\n\n<pre><code>Dim rw1 As Long, rw2 As Long\nWith ThisWorkbook.Worksheets(\"Values\")\n    For rw1 = .Cells(Rows.Count, 2).End(xlUp).Row To 15 Step -1\n        If LCase(VSecT.Value) = LCase(SecDelete) Then\n            'Identify ID\n            IDF = .Cells(rw1, 2).Value &amp; Format(.Cells(rw1, 2).Offset(columnOffset:=3).Value, \" 0000\")\n            'Find offset ID in 'Req Raw'\n            With ThisWorkbook.Worksheets(\"Req Raw\")\n                For rw2 = .Cells(Rows.Count, 1).End(xlUp).Row To 2 Step -1\n                    If .Cells(rw2, 1).Value = IDF Then\n                        'Delete from 'Req Raw'\n                        .Rows(rw2).EntireRow.Delete\n                        Exit For\n                    End If\n                Next RReq\n            End With\n            'Delete from 'Values'\n            .Rows(rw1).EntireRow.Delete\n        End If\n    Next rw1\nEnd With\n</code></pre>\n\n<p>Simply put, you can define a range as <code>.Range(\"A10:A1\")</code> but if you use a For Each/Next to crawl through the cells you will still be progressing through A1, A2, A3.... A10. The numerical row number with Step -1 is the best (only...?) way to work backwards through your data set.</p>\n"}, {"tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1432137629, "creation_date": 1432137629, "answer_id": 30354803, "question_id": 30354230, "link": "https://stackoverflow.com/questions/30354230/deletion-loop-requires-multiple-runs-to-delete-all-rows-meeting-criteria/30354803#30354803", "title": "Deletion loop requires multiple runs to delete all rows meeting criteria", "body": "<p>Reason behind this is cell addressing i believe. If you loop through range e.g. a1 to a10 like this</p>\n\n<pre><code>range(\"a1:a10\").select\nfor each cell in selection\nif cell.value = something then\ncell.entirerow.delete\nend if \nnext cell\n</code></pre>\n\n<p>it is analogical to your code, so what happens when row 2 is deleted? all cells shift upwards so macro on next run skips address A2(which in fact was A3 before deleting) because the loop already passed it. There is the hole in the algorythm, what you need is to go back by one row every time macro deletes a row, so you need to rebuild the macro like this(for my example):</p>\n\n<pre><code>for i = 1 to 10\nif range(\"a\" &amp; i ).value = something\n  range(\"a\" &amp; i).entirerow.delete\n  i = i - 1\n\nnext i ' so that each time something is deleted loop steps backward to catch shifted value\n</code></pre>\n\n<p>hope this helps, cheers</p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 4847484, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ffbe465422ceecf17a59ba1d46a0e22b?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Sanchez", "link": "https://stackoverflow.com/users/4847484/federico-sanchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1432137646, "creation_date": 1432137646, "answer_id": 30354808, "question_id": 30354230, "link": "https://stackoverflow.com/questions/30354230/deletion-loop-requires-multiple-runs-to-delete-all-rows-meeting-criteria/30354808#30354808", "title": "Deletion loop requires multiple runs to delete all rows meeting criteria", "body": "<p>When I have to delete rows from a set range, what I do while mixing the If statements to search for the rows that will be deleted is, for example, change the value of a the cell in a given column (which i know always has values) to blank. then using the specialcells blanks i select all the new blanks cells and then delete the entire row.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1432185916, "last_edit_date": 1432185916, "creation_date": 1432185435, "answer_id": 30365123, "question_id": 30354230, "link": "https://stackoverflow.com/questions/30354230/deletion-loop-requires-multiple-runs-to-delete-all-rows-meeting-criteria/30365123#30365123", "title": "Deletion loop requires multiple runs to delete all rows meeting criteria", "body": "<p>I don't like deleting in loops, This code will build a range reference (Rng) and delete all rows in one go at the end.</p>\n\n<pre><code>Sub DeleteBlanks()\nDim Rng As Range, X As Long\nFor X = 1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    If Range(\"A\" &amp; X).Text = \"\" Then\n        If Rng Is Nothing Then 'This has to be in here because you can't union a range if it is currently nothing\n            Set Rng = Range(\"A\" &amp; X)\n        Else\n            Set Rng = Union(Rng, Range(\"A\" &amp; X))\n        End If\n    End If\nNext\nIf Not Rng Is Nothing Then Rng.Rows.Delete 'If no blanks are found, this will stop it erroring. Only delete when there is something in Rng\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 1, "accepted_answer_id": 30354710, "answer_count": 4, "score": 1, "last_activity_date": 1501674737, "creation_date": 1432136096, "last_edit_date": 1432179766, "question_id": 30354230, "link": "https://stackoverflow.com/questions/30354230/deletion-loop-requires-multiple-runs-to-delete-all-rows-meeting-criteria", "title": "Deletion loop requires multiple runs to delete all rows meeting criteria", "body": "<p>I have a msgbox which gets the user to input a value. My workbook then looks up the value in another sheet called 'Values'. In most cases, there are multiple instances of this value in that sheet. </p>\n\n<p>I then take another value from that row (ID) and look for it in a third sheet called 'Req Raw' using the format \"[InputValue] [ID]\" where ID is a numeric string in the format of \"0000\". </p>\n\n<p>The workbook then deletes that row in both 'Req Raw' and 'Values' and repeats; continuing to look for the input value in 'Values'.</p>\n\n<pre><code>'SecDelete = Input Value\n'VSect = Range in sheet 'Values'\n'RReq = Range in sheet 'Req Raw'\n\nWith ThisWorkBook.Worksheets(\"Values\")\nFor Each VSecT In .Range(.Cells(.Cells(Rows.count, 2).End(xlUp).Row, 2), .Cells(15, 2))\n    If LCase(VSecT.Value) = LCase(SecDelete) Then\n        'Identify ID\n        IDF = CStr(VSecT.Offset(columnOffset:=3).Value)\n        IDF = Format(IDF, \"0000\")\n        'Find offset ID in 'Req Raw'\n        For Each RReq In ThisWorkbook.Worksheets(\"Req Raw\").Range(ThisWorkbook.Worksheets(\"Req Raw\").Cells(ThisWorkbook.Worksheets(\"Req Raw\").Cells(Rows.count, 1).End(xlUp).Row, 1), _\n        ThisWorkbook.Worksheets(\"Req Raw\").Cells(2, 1))\n            If RReq.Value = VSecT.Value &amp; \" \" &amp; IDF Then\n                'Delete from 'Req Raw'\n                RReq.EntireRow.Delete\n                Exit For\n            End If\n        Next RReq\n        'Delete from 'Values'\n        VSecT.EntireRow.Delete\n    End If\nNext VSecT\nEnd With\n</code></pre>\n\n<p>I have found that for some reason, a random number of rows are removed rather than all with the input value.</p>\n\n<p>For example, if my input value was \"Test 1.0\" and there were ten instances in the 'Values' sheet where \"Test 1.0\" was present, with corresponding IDs 0000, 0001, 0002, ... 0010, only some of the rows would be deleted each time I run the sub. I have to run the sub 7-8 times before all rows with \"Test 1.0\" are deleted.</p>\n\n<p>Note that I am looping backwards in both <code>For Each</code> statements.</p>\n"}, {"tags": ["list", "vba", "excel", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4526113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae0225249dfd88301bdce7682b541f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kmanchel", "link": "https://stackoverflow.com/users/4526113/kmanchel"}, "edited": false, "score": 0, "creation_date": 1432142291, "post_id": 30354699, "comment_id": 48804653, "body": "Thank you for the response. This works, except it makes the ListBox smaller and smaller as I check and uncheck the CheckBox. Logically it seems fine, but I wonder why it is doing this."}, {"owner": {"reputation": 1, "user_id": 4526113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae0225249dfd88301bdce7682b541f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kmanchel", "link": "https://stackoverflow.com/users/4526113/kmanchel"}, "edited": false, "score": 0, "creation_date": 1432142596, "post_id": 30354699, "comment_id": 48804812, "body": "I figured it out. The ListBox stopped becoming smaller and smaller when I opened the properties window and changed the integral height from &quot;True&quot; to &quot;False&quot;. I have found the solution, but it still doesn&#39;t make sense why it would do that."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 1, "user_id": 4526113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae0225249dfd88301bdce7682b541f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kmanchel", "link": "https://stackoverflow.com/users/4526113/kmanchel"}, "edited": false, "score": 0, "creation_date": 1432142608, "post_id": 30354699, "comment_id": 48804817, "body": "@Kmanchel I didn&#39;t have the same issue in my test case, so it&#39;s difficult for me to assist. One option is to code the <code>ListBox</code> height so that it expands to the appropriate height on click: <code>ListBox1.Height = 200</code> for example"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1432137329, "creation_date": 1432137329, "answer_id": 30354699, "question_id": 30354101, "link": "https://stackoverflow.com/questions/30354101/excel-vba-checkbox-element-and-how-to-count-list-elements/30354699#30354699", "title": "Excel VBA: Checkbox element and How to count list elements", "body": "<p>Maybe something like below:</p>\n\n<pre><code>Private Sub CheckBox1_Click()\n    If Me.CheckBox1.Value = True Then\n        ListBox1.ListFillRange = \"=A1:A4\"\n    Else\n        ListBox1.ListFillRange = \"\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4526113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae0225249dfd88301bdce7682b541f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kmanchel", "link": "https://stackoverflow.com/users/4526113/kmanchel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 30354699, "answer_count": 1, "score": 0, "last_activity_date": 1432137329, "creation_date": 1432135787, "question_id": 30354101, "link": "https://stackoverflow.com/questions/30354101/excel-vba-checkbox-element-and-how-to-count-list-elements", "title": "Excel VBA: Checkbox element and How to count list elements", "body": "<p>I have created a listbox using activex controls. I want to have the list be populated given a range of cells in the condition that the checkbox has been clicked and it is empty at the time of being clicked. Also, I would like to clear out the list once the checkbox is unchecked (the line of code for this is wrong, please rectify): </p>\n\n<pre><code>Private Sub CheckBox1_Click()\n    If CheckBox1 = True  Then\n        Listbox1.List = Range(\"C32:C33\").Value\n    ElseIf Check_Box1 = False Then\n        Listbox1.List = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Additionally, is there a function to count the number of elements in a given listbox?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2204986, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6911fa5ecb937c80c14a2075c96f9a32?s=128&d=identicon&r=PG", "display_name": "Arcus", "link": "https://stackoverflow.com/users/2204986/arcus"}, "edited": false, "score": 0, "creation_date": 1432136876, "post_id": 30354024, "comment_id": 48801283, "body": "This worked and it didn&#39;t.  I stupidly thought you could just change the extension and everything would be okay.  However, after I changed the extension and opened up the new .docx file I got this:  &quot;The file FileNameHere.docx cannot be opened because there are problems with the contents.  Details?"}], "tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1432135578, "creation_date": 1432135578, "answer_id": 30354024, "question_id": 30353629, "link": "https://stackoverflow.com/questions/30353629/how-do-i-change-a-file-format-when-saving-a-microsoft-word-doc-programmatically/30354024#30354024", "title": "How do I change a file format when saving a Microsoft Word Doc programmatically?", "body": "<p>To get rid of the .docm I would do </p>\n\n<p><code>.saveAs2 left(ActiveDocument.Name,len(ActiveDocument.Name)-5)</code></p>\n\n<p>This will take off the last 5 characters of the <code>ActiveDocument.Name</code> leaving just the document name not the extension. </p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 2204986, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6911fa5ecb937c80c14a2075c96f9a32?s=128&d=identicon&r=PG", "display_name": "Arcus", "link": "https://stackoverflow.com/users/2204986/arcus"}, "edited": false, "score": 0, "creation_date": 1432137694, "post_id": 30354318, "comment_id": 48801821, "body": "This literally fixed my is question from before.  You guys rock!  Thanks!  I&#39;m assuming just changing the extension doesn&#39;t modify any of the internal junk that makes a .docx and a .docm different?  Which is why we use the FileFormat to convert it?"}, {"owner": {"reputation": 3060, "user_id": 1101846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f30e989c661c62552c62e7af06f2d0e?s=128&d=identicon&r=PG&f=1", "display_name": "Cor_Blimey", "link": "https://stackoverflow.com/users/1101846/cor-blimey"}, "reply_to_user": {"reputation": 51, "user_id": 2204986, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6911fa5ecb937c80c14a2075c96f9a32?s=128&d=identicon&r=PG", "display_name": "Arcus", "link": "https://stackoverflow.com/users/2204986/arcus"}, "edited": false, "score": 1, "creation_date": 1432199216, "post_id": 30354318, "comment_id": 48828842, "body": "@Arcus glad it helped. You are correct - file extension just associates a file with an application in Windows. However, Word won&#39;t let you open/save files into a format that differs to its extension (for various reasons, primarily for security reasons)"}], "tags": [], "owner": {"reputation": 3060, "user_id": 1101846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f30e989c661c62552c62e7af06f2d0e?s=128&d=identicon&r=PG&f=1", "display_name": "Cor_Blimey", "link": "https://stackoverflow.com/users/1101846/cor-blimey"}, "is_accepted": true, "score": 2, "last_activity_date": 1432136345, "creation_date": 1432136345, "answer_id": 30354318, "question_id": 30353629, "link": "https://stackoverflow.com/questions/30353629/how-do-i-change-a-file-format-when-saving-a-microsoft-word-doc-programmatically/30354318#30354318", "title": "How do I change a file format when saving a Microsoft Word Doc programmatically?", "body": "<p>Don't use file extension to indicate file type. Don't use a fixed number of chars to remove an extension - this will fail for old fashioned .doc (instead of .docm). Use InStrRev. This is designed for things like this.</p>\n\n<p>Strip the extension off, then save as your desired type using the argument specifically intended for this purpose: FileFormat.</p>\n\n<p><code>doc.SaveAs2 Left(doc.Name, InStrRev(doc.Name, \".\") - 1), wdSaveFormat.wdFormatXMLDocument</code></p>\n"}], "owner": {"reputation": 51, "user_id": 2204986, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6911fa5ecb937c80c14a2075c96f9a32?s=128&d=identicon&r=PG", "display_name": "Arcus", "link": "https://stackoverflow.com/users/2204986/arcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3057, "favorite_count": 2, "accepted_answer_id": 30354318, "answer_count": 2, "score": 1, "last_activity_date": 1539242150, "creation_date": 1432134462, "last_edit_date": 1539242150, "question_id": 30353629, "link": "https://stackoverflow.com/questions/30353629/how-do-i-change-a-file-format-when-saving-a-microsoft-word-doc-programmatically", "title": "How do I change a file format when saving a Microsoft Word Doc programmatically?", "body": "<p>I'm currently modifying a Microsoft Word doc to prompt the user to do something when they save.  </p>\n\n<p>After they select an answer, I want to save the document as a different file type, converting it specifically from a .docm to a .docx file.</p>\n\n<pre><code> Sub FileSave()\n Dim myQ As Integer\n With ActiveDocument\n\n    myQ = MsgBox(\"Is this the Final version of this document?  Clicking  'Yes' will permanently disable macros for moving issues and remove the blank final page.\", vbQuestion + vbYesNo)\n    If myQ = vbYes Then\n      .SaveAs2 ActiveDocument.Name &amp; \".docx\"\n      DeleteFinalPage\n    Else\n       .SaveAs2 ActiveDocument.Name\n    End If\n\n    End With\n\n End Sub\n</code></pre>\n\n<p>As you can see, this saves the document as \"DocumentNameHere.docm.docx\"</p>\n\n<p>How exactly do I go about getting rid of that nasty .docm in the file name?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1432134607, "post_id": 30353589, "comment_id": 48799598, "body": "<code>col.Add Val.Value,cstr(Val.Value)</code> ? This will give you an error if you try to add same item twice so you may have to envelope it between <code>On Error Resume Next</code> and <code>On Error GoTo 0</code>"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432134791, "post_id": 30353589, "comment_id": 48799735, "body": "Unfortunately I received the same error after trying that."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1432134851, "post_id": 30353589, "comment_id": 48799787, "body": "See my Edit on the comment"}, {"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432134955, "post_id": 30353589, "comment_id": 48799859, "body": "I am no longer getting the error.  Do you know what the cause of it could have been?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1432135441, "post_id": 30353589, "comment_id": 48800251, "body": "I am stepping out for 1 hour. If you have any quesitons, please leave a comment below my question and I will answer it when i come back :)"}], "answers": [{"tags": [], "owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "is_accepted": false, "score": 1, "last_activity_date": 1432134827, "creation_date": 1432134827, "answer_id": 30353756, "question_id": 30353589, "link": "https://stackoverflow.com/questions/30353589/run-time-error-on-add-method-vba/30353756#30353756", "title": "Run-Time error on add method VBA", "body": "<p>Change <code>Dim Val As Variant</code> to <code>Dim Val As Range</code></p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1432135317, "last_edit_date": 1432135317, "creation_date": 1432135006, "answer_id": 30353813, "question_id": 30353589, "link": "https://stackoverflow.com/questions/30353589/run-time-error-on-add-method-vba/30353813#30353813", "title": "Run-Time error on add method VBA", "body": "<p>Let's say your worksheet looks like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/Wkrlv.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is what I get when I run the code</p>\n\n<p><img src=\"https://i.stack.imgur.com/fIwMK.jpg\" alt=\"enter image description here\"></p>\n\n<p>Further to my comment, see this</p>\n\n<p>The syntax is <em>col.add \"Item\",\"Key\"</em>. The key has to be unique. If you have duplicate values then then use OERN as I suggested or use a unique key.</p>\n\n<pre><code>Sub Sample()\n    Dim c As New Collection\n\n    For Each itm In Range_Collection(c, Range(\"A1:A5\"))\n        Debug.Print itm\n    Next\nEnd Sub\nFunction Range_Collection(col As Collection, rng As Range) As Collection\n\n    Dim rVal As Variant\n\n    For Each rVal In rng\n        If Not rVal.Value = False Then\n            On Error Resume Next\n            col.Add rVal.Value, CStr(rVal.Value)\n            On Error GoTo 0\n        End If\n    Next rVal\n\n    Set Range_Collection = col\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432136051, "post_id": 30353891, "comment_id": 48800664, "body": "Thanks for pointing that out!  I&#39;m used to parenthesizing everything in Java so now with VBA I tend to get a little confused as many functions don&#39;t require parenthesis and some have different needs for them."}, {"owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "reply_to_user": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "edited": false, "score": 0, "creation_date": 1432136194, "post_id": 30353891, "comment_id": 48800772, "body": "It&#39;s a very &quot;loosey goosey&quot; syntax ... which is sorta what you get when a language tries to be helpful, <i>and</i> which is one of the reasons why Java is <i>(ahem...)</i> &quot;so very anal about parentheses and lots of other things.  Nothing wrong with either of the two languages, but they are very different animals written by two entirely different teams."}], "tags": [], "owner": {"reputation": 7429, "user_id": 4811873, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/2ef5bab087ac0b70e03e34b0b0009fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Robinson", "link": "https://stackoverflow.com/users/4811873/mike-robinson"}, "is_accepted": false, "score": 1, "last_activity_date": 1432135531, "last_edit_date": 1432135531, "creation_date": 1432135215, "answer_id": 30353891, "question_id": 30353589, "link": "https://stackoverflow.com/questions/30353589/run-time-error-on-add-method-vba/30353891#30353891", "title": "Run-Time error on add method VBA", "body": "<p>Also, <strong>watch out</strong> for <em>this</em> little \"potential language oddity\" ... <em>(in any language)</em></p>\n\n<p>When you wrote:</p>\n\n<pre><code>If Not Val.Value = False Then\n</code></pre>\n\n<p>... then you no doubt <em>intended</em> to say:  <em>(note the parentheses, carefully ...)</em></p>\n\n<pre><code> If Not (Val.Value = False) Then \n</code></pre>\n\n<p>... <em>(in other words, \"not equal to\")</em> ...</p>\n\n<p>But most grammars actually bind the <code>Not</code> operator more tightly than a relational-operator such as <code>=</code>, producing what could be this <em>actual</em> interpretation, with no syntax-errors:</p>\n\n<pre><code> If (Not Val.Value) = False Then\n</code></pre>\n\n<p>... <em>(in other words, \"if <code>Val.Value</code> is <strong>True</strong>!\")</em></p>\n\n<p>The compiler judges your statement to be \"syntactically and semantically correct,\" as in fact it <em>is.</em>  But its <strong>interpretation</strong> of what you have written might not be what you thought it was.  If you include the parentheses as I have shown above, all ambiguity is removed.</p>\n\n<ul>\n<li>If you want <em>\"not equal to\"</em>, <strong>always</strong> use the appropriate operator.</li>\n<li>When using logical operators, use parentheses plentifully to make your intentions clear, both to the compiler and to other people.</li>\n</ul>\n\n<p>Oddly enough, this sort of issue led to a bug in the <em>very first</em> program that I ever wrote:  which \"was 6 lines long, took me 6 months to write (in BASIC for a timesharing computer, nevermind how long ago now), and had a bug in it.\"</p>\n"}], "owner": {"reputation": 4124, "user_id": 3183924, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5e9d0e2a47aea15d63e369970b921cca?s=128&d=identicon&r=PG&f=1", "display_name": "Paradox", "link": "https://stackoverflow.com/users/3183924/paradox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 30353813, "answer_count": 3, "score": 1, "last_activity_date": 1432135531, "creation_date": 1432134373, "question_id": 30353589, "link": "https://stackoverflow.com/questions/30353589/run-time-error-on-add-method-vba", "title": "Run-Time error on add method VBA", "body": "<p>My function's intent is explained in the docstring.  However, when I run it, I get a \"Run-Time error '91': Object variable or With block variable not set\", and a line of code is highlighted, as indicated below.  I cannot find the source of this issue, especially since I am rather new to VBA.  Any help would be greatly appreciated!</p>\n\n<pre><code>'==============================|Range_Collection FUNCTION|=============================='\n' Given a collection and a range, add each value in that range to the collection, except\n' for False values.\nFunction Range_Collection(col As Collection, rng As Range) As Collection\n\n    Dim Val As Variant\n    For Each Val In rng\n        If Not Val.Value = False Then\n            col.Add Val.Value ;************** THIS CODE IS HIGHLIGHTED************\n        End If\n    Next Val\n    Set Range_Collection = col\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "vb.net", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1432134520, "post_id": 30353557, "comment_id": 48799536, "body": "is there any reason you arent using a SQL UPDATE query?"}, {"owner": {"reputation": 95, "user_id": 4829219, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ivoy7.png?s=128&g=1", "display_name": "AngryCubeDev", "link": "https://stackoverflow.com/users/4829219/angrycubedev"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1432135365, "post_id": 30353557, "comment_id": 48800183, "body": "Hi, I used UPDATE previously but it through up some strange exceptions so this way worked when i tried it."}, {"owner": {"reputation": 2526, "user_id": 4479165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb7faf1344075e6252156358b64e539?s=128&d=identicon&r=PG&f=1", "display_name": "theduck", "link": "https://stackoverflow.com/users/4479165/theduck"}, "edited": false, "score": 3, "creation_date": 1432137608, "post_id": 30353557, "comment_id": 48801765, "body": "You do call <code>cmd.ExecuteNonQuery()</code> twice with the <code>INSERT</code> command text."}], "owner": {"reputation": 95, "user_id": 4829219, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ivoy7.png?s=128&g=1", "display_name": "AngryCubeDev", "link": "https://stackoverflow.com/users/4829219/angrycubedev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1432134268, "creation_date": 1432134268, "question_id": 30353557, "link": "https://stackoverflow.com/questions/30353557/stop-commandtext-insert-adding-a-duplicate-into-the-sql-database", "title": "Stop CommandText Insert adding a Duplicate into the SQL Database", "body": "<p>I have a form that displays customer information and allows users to edit and add more after it has been originally entered. The code I have written deletes the instance and adds it again using a different GUID but is duplicating the newly added one.</p>\n\n<p>I looking for the code to just save a single instance of this in the database and not have the duplicate.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click\n    Dim strGUID As String\n    strGUID = System.Guid.NewGuid().ToString\n    If CNameText.Text &lt;&gt; \"\" And AddressTextBox.Text &lt;&gt; \"\" And PhoneText.Text &lt;&gt; \"\" And DateTextBox.Text &lt;&gt; \"\" And CashierText.Text &lt;&gt; \"\" And EmailText.Text &lt;&gt; \"\" And SubjectText.Text &lt;&gt; \"\" And DepartmentTextBox.Text &lt;&gt; \"\" And EnquiryText.Text &lt;&gt; \"\" Then\n        cn.Open()\n        cmd.CommandText = \"DELETE from Enquiries where UniqueID = '\" &amp; GUIDTextBox.Text &amp; \"' \"\n        cmd.ExecuteNonQuery()\n        cn.Close()\n\n        GUIDTextBox.Text = strGUID\n\n        cn.Open()\n        cmd.CommandText = \"INSERT into Enquiries (CName, Address, Phone, Date, Email, Cashier, Department, Subject, Enquiry, Note, UniqueID, FutDate) values ('\" &amp; CNameText.Text &amp; \"', '\" &amp; AddressTextBox.Text &amp; \"', '\" &amp; PhoneText.Text &amp; \"', '\" &amp; DateTextBox.Text &amp; \"', '\" &amp; EmailText.Text &amp; \"', '\" &amp; CashierText.Text &amp; \"', '\" &amp; DepartmentTextBox.Text &amp; \"',  '\" &amp; SubjectText.Text &amp; \"', '\" &amp; EnquiryText.Text &amp; \"', '\" &amp; NoteTextBox.Text &amp; \"', '\" &amp; GUIDTextBox.Text &amp; \"', '\" &amp; FutDateTextBox.Text &amp; \"')\"\n        cmd.ExecuteNonQuery()\n        cn.Close()\n\n        CNameText.Text = \"\"\n        AddressTextBox.Text = \"\"\n        DateTextBox.Text = \"\"\n        PhoneText.Text = \"\"\n        CashierText.Text = \"\"\n        EmailText.Text = \"\"\n        SubjectText.Text = \"\"\n        DepartmentTextBox.Text = \"\"\n        EnquiryText.Text = \"\"\n        NoteTextBox.Text = \"\"\n        GUIDTextBox.Text = \"\"\n\n        cn.Open()\n        EnquiriesTableAdapter.Fill(Database1DataSet1.Enquiries)\n        cmd.ExecuteNonQuery()\n        cn.Close()\n\n\n        MsgBox(\"Enquiry Successfully Updated\")\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432134242, "post_id": 30353399, "comment_id": 48799327, "body": "Can you give an example of what you want to happen?"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1432134247, "post_id": 30353399, "comment_id": 48799333, "body": "Do you mean you want to select a range in sheet A and get the cell content of sheet B from the same addresses into sheet A?"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432134621, "post_id": 30353399, "comment_id": 48799609, "body": "what is the correlation between <code>a1:b50</code> and <code>c51:d100</code>"}, {"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1432135109, "post_id": 30353399, "comment_id": 48799979, "body": "Range size, I want to select the same range size in the new sheet as the current sheet"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432135455, "post_id": 30353399, "comment_id": 48800266, "body": "But <i>why</i> <code>c51:d100</code>? like why not <code>y51:z100</code> or <code>g21:h70</code>"}, {"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1432135623, "post_id": 30353399, "comment_id": 48800379, "body": "Sorry can be any as per your comment"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432135768, "post_id": 30353399, "comment_id": 48800483, "body": "Let me ask this a different way.  Say I select <code>c51:d100</code> <i>on the first sheet</i> what should the selection be on the second sheet?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432135937, "post_id": 30353399, "comment_id": 48800588, "body": "@chancea I understood him to mean it&#39;s whichever cell is currently selected on the second sheet. So, if cell <code>R35</code> is selected on the other sheet, he wants that to be the starting point."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1432136013, "post_id": 30353399, "comment_id": 48800636, "body": "@user3561813 you are just guessing.  I want the OP to explicitly explain that."}, {"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432136072, "post_id": 30353399, "comment_id": 48800677, "body": "@chancea Any range required at the time that&#39;s 50 rows and 2 columns in size"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432136109, "post_id": 30353399, "comment_id": 48800708, "body": "@Krishn How do I know <i>what range is required at the time</i>"}, {"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "reply_to_user": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 1, "creation_date": 1432136269, "post_id": 30353399, "comment_id": 48800828, "body": "@chancea Ok lets say the same columns and the end of the range in the next sheet"}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1432136375, "post_id": 30353399, "comment_id": 48800902, "body": "@user3561813 The OP has spoken.  Keep the columns the same, change the row"}], "answers": [{"comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1432135922, "post_id": 30354102, "comment_id": 48800582, "body": "I should prob ask why you need this? A lot of actions (copy &amp; paste, etc) do not need to have the destination selection set to the same size."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1432135789, "creation_date": 1432135789, "answer_id": 30354102, "question_id": 30353399, "link": "https://stackoverflow.com/questions/30353399/select-new-range-based-on-another-sheets-selection/30354102#30354102", "title": "Select new range based on another sheets selection", "body": "<p>When your code reads the <code>Selection.Address</code> you should prefix it with the sheet that you want to use for the source. So:</p>\n\n<pre><code>Sub MatchRange()    \n    Dim ady As String    \n    ady = Sheets(\"sheet_name\").Selection.Address    \n    Sheets(\"Sheet2\").Select    \n    Range(ady).Select\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1432137419, "post_id": 30354146, "comment_id": 48801633, "body": "So just to clarify, this is selecting the size based on the current R1C1 selected cell in the second sheet.  Not explained at all in the question"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1432135882, "creation_date": 1432135882, "answer_id": 30354146, "question_id": 30353399, "link": "https://stackoverflow.com/questions/30353399/select-new-range-based-on-another-sheets-selection/30354146#30354146", "title": "Select new range based on another sheets selection", "body": "<p>The question is a bit vague, but I'll give an example on a method of selecting an equivalent sized range based on the selected cells in each sheet. Please try to amend to meet your needs and let us know if you have more specific questions.</p>\n\n<pre><code>Sub MatchSelectionArea()\n    Dim rng As Range\n    Dim nRows As Long\n    Dim nCols As Long\n\n    Set rng = Selection\n\n    nRows = rng.Rows.Count\n    nCols = rng.Columns.Count\n\n    Sheets(\"Sheet2\").Activate\n\n    ActiveCell.Resize(nRows, nCols).Select\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 0, "last_activity_date": 1432135901, "creation_date": 1432135901, "answer_id": 30354150, "question_id": 30353399, "link": "https://stackoverflow.com/questions/30353399/select-new-range-based-on-another-sheets-selection/30354150#30354150", "title": "Select new range based on another sheets selection", "body": "<p>I'm not sure of what you need but this is an example to get a range of the same dimensions of another range (hope it helps)</p>\n\n<pre><code>Set ady = Range(\"A1:C3\")\nRngNumCol = ady.Columns.Count\nRngNumRow = ady.Rows.Count\n\nNewRngStart = ActiveCell.Address 'Here the starting cell of the new range\nNewRngEnd = Range(NewRngStart).Offset(RngNumRow - 1, RngNumCol - 1).Address\nSet NewRng = Range(NewRngStart, NewRngEnd)\n\n'Test\nFor Each mycell In NewRng.Cells\n    mycell .Value = \"Test\"\nNext\n</code></pre>\n"}], "owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 30354146, "answer_count": 3, "score": -1, "last_activity_date": 1432135901, "creation_date": 1432133906, "last_edit_date": 1495535213, "question_id": 30353399, "link": "https://stackoverflow.com/questions/30353399/select-new-range-based-on-another-sheets-selection", "title": "Select new range based on another sheets selection", "body": "<p>I was assisted with the code below which is great, however it brings through/selects the cell address as per the previous sheet, please can you provide code for a dynamic range so it brings through/selects cells based upon current selection in the new sheet rather than cell address</p>\n\n<pre><code>Sub MatchRange()    \n    Dim ady As String    \n    ady = Selection.Address    \n    Sheets(\"Sheet2\").Select    \n    Range(ady).Select\nEnd Sub\n</code></pre>\n\n<p>Link to where previous code was sourced:\n<a href=\"https://stackoverflow.com/questions/30139292/match-resize-new-range-based-on-another-sheets-selection\">Match/resize new range based on another sheets selection</a></p>\n\n<p>Sorry for being vague, so lets say in sheet a I have range a1:b50 selected, I want to match the selection size in sheet b. So in this situation it would be c51:d100. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432134581, "post_id": 30353387, "comment_id": 48799580, "body": "Is that <i>Workbook_SheetChange</i> on the <b>Sheets(1)</b> code sheet or are you trying to put a <i>1</i> into a different worksheet?"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "edited": false, "score": 0, "creation_date": 1432134858, "post_id": 30353676, "comment_id": 48799795, "body": "Oh, man, this is brilliant. It was the first time, when I failed to find an answer myself in this site and in google, so I was even forced to sing here up :) And it was worth that )"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432134921, "post_id": 30353676, "comment_id": 48799841, "body": "If the OP is trying to write to the same worksheet that triggered the event, the <i>ThisWorkbook.Sheets(1)</i> can be eliminated. It only causes confusion and could result in a different worksheet receiving the <i>1</i> if the worksheets were reordered."}, {"owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "edited": false, "score": 0, "creation_date": 1432135099, "post_id": 30353676, "comment_id": 48799963, "body": "to:Jeeped Well, surely, there is meaningfull name of the sheet, I&#39;ve just simplified the code for my example here. BTW, how to reference particular user in my answer? )"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "edited": false, "score": 0, "creation_date": 1432135542, "post_id": 30353676, "comment_id": 48800319, "body": "Simply prefix the user&#39;s name with the @ character (e.g. @Gurov Stepan) to show that you are replying to their comment"}, {"owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "edited": false, "score": 0, "creation_date": 1432192367, "post_id": 30353676, "comment_id": 48824607, "body": "@ChipsLetten Thanks. Quite obvious actually. Should have guessed myself."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 1, "last_activity_date": 1432134613, "creation_date": 1432134613, "answer_id": 30353676, "question_id": 30353387, "link": "https://stackoverflow.com/questions/30353387/runtime-errors-and-cells-property-fails-inside-workbook-sheetchange/30353676#30353676", "title": "RunTime errors and Cells() property fails inside Workbook_SheetChange", "body": "<p>Your code triggers the SheetChange event because the code writes to the sheet so the code creates a recurring loop. Try turning events off and then back on again.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\nApplication.EnableEvents = False\n\nLastRow = ThisWorkbook.Sheets(1).Cells(ThisWorkbook.Sheets(1).Rows.Count, 1).End(xlUp).Row\n\nThisWorkbook.Sheets(1).Cells(LastRow, 1).Offset(1, 0).Value = 1\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1432134738, "creation_date": 1432134738, "answer_id": 30353721, "question_id": 30353387, "link": "https://stackoverflow.com/questions/30353387/runtime-errors-and-cells-property-fails-inside-workbook-sheetchange/30353721#30353721", "title": "RunTime errors and Cells() property fails inside Workbook_SheetChange", "body": "<p>You are probably re-triggering <em>Events.</em>  Disable events before:</p>\n\n<pre><code>ThisWorkbook.Sheets(1).Cells(LastRow, 1).Offset(1, 0).Value = 1\n</code></pre>\n\n<p>and re-enable them afterwards.</p>\n"}], "owner": {"reputation": 127, "user_id": 4920966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-PTPofWizOIg/AAAAAAAAAAI/AAAAAAAAAFE/wkyfYiUCgxs/photo.jpg?sz=128", "display_name": "laooglee", "link": "https://stackoverflow.com/users/4920966/laooglee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 30353676, "answer_count": 2, "score": 0, "last_activity_date": 1432134738, "creation_date": 1432133874, "last_edit_date": 1432134720, "question_id": 30353387, "link": "https://stackoverflow.com/questions/30353387/runtime-errors-and-cells-property-fails-inside-workbook-sheetchange", "title": "RunTime errors and Cells() property fails inside Workbook_SheetChange", "body": "<p>I'm trying to write a simple tracking procedure, but can't teach it properly fill the report line by line.</p>\n\n<p>The idea is:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n'define last row in report\n    &lt;proper code for it&gt;\n\n    'fill in \"last row +1\" with tracking info\n     &lt;proper code for it as well&gt;\n\nEnd Sub\n</code></pre>\n\n<p>So i've tried two options:</p>\n\n<p>1) With Cells() property (instead of <code>Offset</code> there might be just <code>LastRow + 1</code> for row index)</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    LastRow = ThisWorkbook.Sheets(1).Cells(ThisWorkbook.Sheets(1).Rows.Count, 1).End(xlUp).Row\n\n    ThisWorkbook.Sheets(1).Cells(LastRow, 1).Offset(1, 0).Value = 1\n\nEnd Sub\n</code></pre>\n\n<p>And it results in multiple rows filling with desired values. Strangely it always took 93 rows down of the chosen cell after each change in the worksheet (so 93 186 279 372 465 558).</p>\n\n<p>2) With Range() property:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    LastRow = ThisWorkbook.Sheets(1).Cells(ThisWorkbook.Sheets(1).Rows.Count, 1).End(xlUp).Row\n\n    ThisWorkbook.Sheets(1).Range(\"A1\").Offset(LastRow, 1).Value = 1\n\nEnd Sub\n</code></pre>\n\n<p>Then it properly fill required cell, but then constantly results in </p>\n\n<blockquote>\n  <p>run-time error '-2147417848 (80010108): method range of object\n  _worksheet failed</p>\n</blockquote>\n\n<p>And in one of three times it also make Excel crash.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2013"], "comments": [{"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 0, "creation_date": 1432132688, "post_id": 30352709, "comment_id": 48798068, "body": "You need to work with Recordset Objects. To loop through and get the list"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4870388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aabbca7b7804c7314a8b54b811a1df23?s=128&d=identicon&r=PG&f=1", "display_name": "Roshan Tated", "link": "https://stackoverflow.com/users/4870388/roshan-tated"}, "edited": false, "score": 0, "creation_date": 1433176317, "post_id": 30353260, "comment_id": 49227267, "body": "HI Paul, thanks for the response. The problem is that &#39;Form text fields&#39; are used as argument for running the query. When I am running the code you have suggested on the query results. It gives the error &#39;Arguments required. Argument number x&#39;. How can this problem be tackled?"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 11, "user_id": 4870388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aabbca7b7804c7314a8b54b811a1df23?s=128&d=identicon&r=PG&f=1", "display_name": "Roshan Tated", "link": "https://stackoverflow.com/users/4870388/roshan-tated"}, "edited": false, "score": 0, "creation_date": 1433176537, "post_id": 30353260, "comment_id": 49227401, "body": "Please update your original post with what you have done so far."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 0, "last_activity_date": 1432133589, "creation_date": 1432133589, "answer_id": 30353260, "question_id": 30352709, "link": "https://stackoverflow.com/questions/30352709/sub-query-to-retrieve-email-addresses-as-semi-colon-separated-list-in-ms-access/30353260#30353260", "title": "Sub query to retrieve email addresses as semi-colon separated list in MS Access", "body": "<p>You might as well make use of an UDF, just keeping it out of the procedure. Get the criteria by which you filter the result. Then you simply pass the criteria. I am not sure how you have built your criteria. A stab in the dark is get all email of people named \"Paul\". So your code will be.</p>\n\n<pre><code>Public Sub getEmailString(FieldName As String, Tablename As String, Criteria As String)\n    Dim tmpRS As DAO.Recordset\n    Dim tmpStr As String, retStr As String\n\n    tmpStr = \"SELECT \" &amp; FieldName &amp; \" FROM \" &amp; Tablename &amp; \" WHERE \" &amp; Criteria\n\n    Set tmpRS = CurrentDB.OpenRecordset(tmpStr)\n\n    If tmpRS.RecordCount &gt; 0 Then\n        Do While Not tmpRS.EOF\n            retStr = retStr &amp; tmpRS.Fields(0) &amp; \";\"\n            tmpRS.MoveNext\n        Loop\n    End If \n    getEmailString = retStr\n    Set tmpRS = Nothing\nEnd Sub\n</code></pre>\n\n<p>To use it, you simply use.</p>\n\n<pre><code>Dim someEmailString As String\nsomeEmailString = getEmailString(\"EmailFieldName\", \"ContactsTableName\", \"FirstName = 'Paul'\")\n</code></pre>\n\n<p>If you have something it should return,</p>\n\n<pre><code>paul.someone@somedomain.com;paul.someoneelse@somenewdomain.co.uk;\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 11, "user_id": 4870388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aabbca7b7804c7314a8b54b811a1df23?s=128&d=identicon&r=PG&f=1", "display_name": "Roshan Tated", "link": "https://stackoverflow.com/users/4870388/roshan-tated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 557, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432133589, "creation_date": 1432132289, "question_id": 30352709, "link": "https://stackoverflow.com/questions/30352709/sub-query-to-retrieve-email-addresses-as-semi-colon-separated-list-in-ms-access", "title": "Sub query to retrieve email addresses as semi-colon separated list in MS Access", "body": "<p>I have a table Contacts in Access and a search form. After the user specifies the search criteria, the table only shows records that meet the criteria</p>\n\n<p>Is their a way to retrieve all email addresses of searched contacts as semi-colon separated list so that i can just copy and paste in new email's To field. </p>\n\n<p>Any help is appreciated</p>\n\n<p>Roshan.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2013"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1432134552, "post_id": 30352451, "comment_id": 48799554, "body": "Show the code you have now or the relevant sections of it."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432165895, "post_id": 30352451, "comment_id": 48816004, "body": "Try uninstalling your outlook-2013 and then do clean installation, that might fix the problem you are having, your receive email should not be saved as dot-file. all outlook email are saved dot.msg."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432167481, "post_id": 30352451, "comment_id": 48816408, "body": "or try turn off your add-in and test the code"}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432299170, "post_id": 30352451, "comment_id": 48882144, "body": "@Omar are you talking about turning off all my add-ins?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432311719, "post_id": 30352451, "comment_id": 48890752, "body": "Yes it could be something that is messing up ur file format. It&#39;s it&#39;s unusual that outlook is saving ur emails as .file"}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1432650922, "post_id": 30352451, "comment_id": 49003592, "body": "I have tried disabling all of my add-ins and the problem still persists. The only thing I have not done yet is uninstall and reinstall office. I will give that a shot this weekend and will let you know if that solved my issues or not."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1432145554, "post_id": 30353899, "comment_id": 48806533, "body": "I don&#39;t believe that I would need to use the msgflags. What happens is all responses and forwards get saved as a .file extension rather than .msg. My plan is to find a way to check that the email that is coming in is a reply, forward, original email then save as .msg. The original email saves fine, but not replies or forwards. Those are all being saved as .file."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 2, "last_activity_date": 1432135234, "creation_date": 1432135234, "answer_id": 30353899, "question_id": 30352451, "link": "https://stackoverflow.com/questions/30352451/how-to-test-if-the-email-is-a-regular-email-or-reply/30353899#30353899", "title": "How to test if the email is a regular email or reply?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/bb415575.aspx\" rel=\"nofollow\">PR_MESSAGE_FLAGS</a> low-level property contains a bitmask of flags indicating the origin and current state of a message. You are interested in the following flags:</p>\n\n<ul>\n<li>MSGFLAG_READ</li>\n</ul>\n\n<p>The message is marked as having been read. Clients can set this flag by calling a message's IMAPIProp::SetProps method before the message has been saved for the first time. This flag is ignored if the MSGFLAG_ASSOCIATED flag is set.</p>\n\n<ul>\n<li>MSGFLAG_UNSENT</li>\n</ul>\n\n<p>The message is still being composed. It is saved, but has not been sent. Typically, this flag is cleared after the message is sent.</p>\n\n<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/bb176395%28office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">PropertyAccessor</a> object to get the low-level property value. DASL name is <code>http://schemas.microsoft.com/mapi/proptag/0x0E070003</code>.</p>\n\n<p>Use any low-level property viewer such as MFCMAPI or OutlookSpy for exploring such properties and their values.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1432139138, "post_id": 30354867, "comment_id": 48802749, "body": "Regular mail I mean when the new message first arrives. Example, I receive an email from Joe for the very first time."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1432139867, "post_id": 30354867, "comment_id": 48803246, "body": "You may find the PR_LAST_VERB_EXECUTED (0x10810003) property helpful. The DASL name is <code>http:&#47;&#47;schemas.microsoft.com&#47;mapi&#47;proptag&#47;0x10810003</code>. Use the PropertyAccessor object for getting the value."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1432142493, "post_id": 30354867, "comment_id": 48804760, "body": "Do you mean a message that is not a reply to your original message? You can check if PR_IN_REPLY_TO_ID (DASL name <code>http:&#47;&#47;schemas.microsoft.com&#47;mapi&#47;proptag&#47;0x1042001F</code>) is set - it corresponds to the In-Reply-To MIME header which you can see in the PR_TRANSPORT_MESSAGE_HEADERS property. Take a look at a message with OutlookSpy (click IMessage) to see if these properties are present in your case and have the expected values."}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1432144805, "post_id": 30354867, "comment_id": 48806083, "body": "I guess basically my thought process for this right now is since that ALL replies and forwards are being saved as a .file, I figure lets run this through an IF statement. My thoughts is that the IF statement will check if the message is a reply or forward, and if it is, save it as a message. That is the only other thing I can think of to possibly prevent all of the email messages that are a reply or a forward to be saved properly."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1432137805, "creation_date": 1432137805, "answer_id": 30354867, "question_id": 30352451, "link": "https://stackoverflow.com/questions/30352451/how-to-test-if-the-email-is-a-regular-email-or-reply/30354867#30354867", "title": "How to test if the email is a regular email or reply?", "body": "<p>What is your definition of \"regular email\"? Do you mean you need to distinguish whether a message was <strong>sent</strong> by the current user or <strong>received</strong>?</p>\n\n<p>Received messages have the MailItem.ReceivedByName populated. Sent messages do not.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1432754178, "post_id": 30487946, "comment_id": 49060371, "body": "I am doing so with the Sub Routine that I created. That Sub is being called after I set the namespace. In that Sub, I have it set to replace the colon"}, {"owner": {"reputation": 338, "user_id": 3149631, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242794480/picture?type=large", "display_name": "sgriffin", "link": "https://stackoverflow.com/users/3149631/sgriffin"}, "reply_to_user": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1432756550, "post_id": 30487946, "comment_id": 49061812, "body": "If you&#39;re speaking of <code>ReplaceCharsForFileName</code>, you&#39;re calling it when SaveName is still an empty string, but not later after you&#39;ve set SaveName to a string derived from the subject. You needs to call is some time after the <code>SaveName = Format</code> line."}, {"owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "edited": false, "score": 0, "creation_date": 1432817713, "post_id": 30487946, "comment_id": 49089916, "body": "Wow, I was completely blind. That did it. Thank you very much for your help. That was killing me"}], "tags": [], "owner": {"reputation": 338, "user_id": 3149631, "user_type": "registered", "profile_image": "https://graph.facebook.com/1242794480/picture?type=large", "display_name": "sgriffin", "link": "https://stackoverflow.com/users/3149631/sgriffin"}, "is_accepted": true, "score": 1, "last_activity_date": 1432743401, "creation_date": 1432743401, "answer_id": 30487946, "question_id": 30352451, "link": "https://stackoverflow.com/questions/30352451/how-to-test-if-the-email-is-a-regular-email-or-reply/30487946#30487946", "title": "How to test if the email is a regular email or reply?", "body": "<p>You note that the problem happens when you encounter a message which is either a reply or a forward. One thing both of those have in common is a prefix on the subject, like \"RE: something\" or \"FW: something else\". Note the colon in the prefix. I don't see you doing any work to scrub that colon out of the name before calling SaveAs. So you'd be giving SaveAs a pretty odd path with multiple colons in it.</p>\n\n<p>I don't know how SaveAs would react to that, but I'd start there.</p>\n"}], "owner": {"reputation": 81, "user_id": 4854060, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d40f29e25e6a9929c446d61a63bad53f?s=128&d=identicon&r=PG&f=1", "display_name": "novicevba", "link": "https://stackoverflow.com/users/4854060/novicevba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1653, "favorite_count": 0, "accepted_answer_id": 30487946, "answer_count": 3, "score": 0, "last_activity_date": 1592895821, "creation_date": 1432131673, "last_edit_date": 1592895821, "question_id": 30352451, "link": "https://stackoverflow.com/questions/30352451/how-to-test-if-the-email-is-a-regular-email-or-reply", "title": "How to test if the email is a regular email or reply?", "body": "<p>I am writing a script which will automatically save emails to a specified folder based on date. So basically, all of the emails today, will be saved in a folder marked 05/20/2015.</p>\n\n<p>The problem in which I am currently experiencing is that all reply messages are being saved as a file, rather than <strong>.msg</strong>. </p>\n\n<p>My question is, is there a way to test if the email is a response or a regular email. I figure that I would have been able to do something like this. <code>If Item.Reply Then (code here)</code>. Would this be the correct way of doing so, or would I have to go about in testing if the email is a reply is a different way?</p>\n\n<p>Here is the code that I am working with. Here is an example of what I mean. Joe sends me an email. That email gets saved to my specified folder as a .msg. I respond to Joe. Joe responds back. Theoretically the response back from Joe should be saved as .msg, but the message is being saved as .file. That is the part that I do not understanding and I have no idea why this is happening. </p>\n\n<pre><code>    Option Explicit\n'// Save the message as a native .msg\nPublic Sub SaveMesg(Item As Outlook.MailItem)\n Dim fso As FileSystemObject\n Dim olNS As Outlook.NameSpace\n Dim SavePath As String\n Dim TimeDate As Date\n Dim SaveName As String\n Dim Enviro As String\n Dim NewFolder As String\n Dim EmailSubject As String\n\n'// enviro gets the user account part of the path\n'// so you can use the same code on different computers\nSet olNS = Application.GetNamespace(\"MAPI\")\n\nReplaceCharsForFileName SaveName, \"_\"\n\n'// Use My Documents for older Windows.\nNewFolder = \"C:\\ITDocs\\\" &amp; Format(Now, \"YYYY-MM-DD\") &amp; \"\\\"\n\n'// Test if directory or file exists\nIf FileOrDirExists(NewFolder) Then\n    MsgBox NewFolder &amp; \" exists!\"\nElse\n    MkDir NewFolder\nEnd If\n\nEmailSubject = FileName(Item.Subject)\n\n'// Determine if there is subject\nIf Item.Subject &lt;&gt; vbNullString Then\n    EmailSubject = Item.Subject\nElse\n    EmailSubject = \"No Subject\"\nEnd If\n\n'// Determine if the email is a response or not\n'// If Item.Reply &lt;&gt; vbNullString Then\n   '// EmailSubject = Item.Subject\n '//End If\n\n\n'// Get Email subject &amp; set name to be saved as\nTimeDate = Item.ReceivedTime\nSaveName = Format(TimeDate, \"YYYYMMDD\", vbUseSystemDayOfWeek, _\nvbUseSystem) &amp; Format(TimeDate, \"-HHNNSS\", _\nvbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; EmailSubject &amp; SaveName &amp; \".msg\"\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\n\n\n'// Save .msg File\nSavePath = \"C:\\IT Documents\\\" &amp; NewFolder &amp; \"\\\"\nDebug.Print NewFolder &amp; SaveName\nItem.SaveAs NewFolder &amp; SaveName, olMSG\n\nEnd Sub\n\n'// This function removes invalid and other characters from file names\nPrivate Sub ReplaceCharsForFileName(SaveName As String, _\n sChr As String _\n )\n SaveName = Replace(SaveName, \"/\", sChr)\n SaveName = Replace(SaveName, \"\\\", sChr)\n SaveName = Replace(SaveName, \":\", sChr)\n SaveName = Replace(SaveName, \"?\", sChr)\n SaveName = Replace(SaveName, Chr(34), sChr)\n SaveName = Replace(SaveName, \"&lt;\", sChr)\n SaveName = Replace(SaveName, \"&gt;\", sChr)\n SaveName = Replace(SaveName, \"|\", sChr)\n SaveName = Replace(SaveName, \"&amp;\", sChr)\n SaveName = Replace(SaveName, \"%\", sChr)\n SaveName = Replace(SaveName, \"*\", sChr)\n SaveName = Replace(SaveName, \" \", sChr)\n SaveName = Replace(SaveName, \"{\", sChr)\n SaveName = Replace(SaveName, \"[\", sChr)\n SaveName = Replace(SaveName, \"]\", sChr)\n SaveName = Replace(SaveName, \"}\", sChr)\n SaveName = Replace(SaveName, \"!\", sChr)\n\nEnd Sub\n\n'// Good practice suggests that it is wise to check before taking certain               actions\n'// This function checks if File or Dir Exists\nFunction FileOrDirExists(PathName As String) As Boolean\nDim iTemp As Integer\n\n '// Ignore errors to allow for error evaluation\nOn Error Resume Next\niTemp = GetAttr(PathName)\n\n '// Check if error exists and set response appropriately\nSelect Case Err.Number\nCase Is = 0\n    FileOrDirExists = True\nCase Else\n    FileOrDirExists = False\nEnd Select\n\n '// Resume error checking\nOn Error GoTo 0\nEnd Function\n\nFunction FileName(strText As String) As String\n Dim strStripChars As String\n Dim intLen As Integer\n Dim i As Integer\n strStripChars = \"/\\[]:=,\" &amp; Chr(34)\n    intLen = Len(strStripChars)\n strText = Trim(strText)\n    For i = 1 To intLen\n strText = Replace(strText, Mid(strStripChars, i, 1), \"\")\n\n Next\n FileName = strText\nEnd Function\n</code></pre>\n"}, {"tags": ["string", "vba", "excel", "find"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1432131651, "post_id": 30352202, "comment_id": 48797191, "body": "What do you mean the string is comes from an arrow in a row? Do you mean that the cells contain arrays?? Or that the values in the cells came from an VBA array before?"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1432131787, "creation_date": 1432131787, "answer_id": 30352495, "question_id": 30352202, "link": "https://stackoverflow.com/questions/30352202/how-to-search-for-a-strings-in-a-row-and-create-an-array-with-them-vba/30352495#30352495", "title": "How to search for a strings in a row and create an array with them VBA", "body": "<p>You don't need two arrays from what I can see.</p>\n\n<p>Is this what you are trying (<strong>UNTESTED</strong>)? I have commented the code. Do let me know if you have a question.</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet, wsI As Worksheet\n    Dim MyAr As Variant\n    Dim SearchString As String, tmpString As String, sDelim As String\n    Dim aCell As Range\n\n    '~~&gt; Worksheet where you need to search\n    Set wsI = Workbooks(strProjectedRevenue).Worksheet(\"Month\")\n\n    '~~&gt; I am assuming that none of the sheets have this name. Else Change it\n    '~~&gt; to something unique\n    sDelim = \"lbochitt\"\n\n    '~~&gt; Loop through the worksheets\n    For Each ws In ThisWorkbook.Sheets\n        '~~&gt; Search String\n        SearchString = ws.Name\n\n        '~~&gt; Find the string\n        Set aCell = wsI.Rows(2).Find(What:=SearchString, LookIn:=xlValues, _\n                    LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n\n        '~~&gt; Check if the result returned anything\n        If Not aCell Is Nothing Then\n            '~~&gt; Store the offset value in a string separated with a delimiter\n            If tmpString = \"\" Then\n                tmpString = aCell.Offset(, 1).Value\n            Else\n                tmpString = tmpString &amp; sDelim &amp; aCell.Offset(, 1).Value\n            End If\n            Set aCell = Nothing\n        Next\n    Next\n\n    If tmpString &lt;&gt; \"\" Then\n        '~~&gt; here is your final array\n        MyAr = Split(tmpString, sDelim)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4920727, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gFiLzxZ3Pos/AAAAAAAAAAI/AAAAAAAAAD4/TwaiUhsBiKU/photo.jpg?sz=128", "display_name": "lbochitt", "link": "https://stackoverflow.com/users/4920727/lbochitt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507106906, "creation_date": 1432131082, "last_edit_date": 1531164843, "question_id": 30352202, "link": "https://stackoverflow.com/questions/30352202/how-to-search-for-a-strings-in-a-row-and-create-an-array-with-them-vba", "title": "How to search for a strings in a row and create an array with them VBA", "body": "<p>I need a macro to look for a string (that string comes from an array) in a row and then after locating that cell in which the string is, store the value next to it into another array. Is there a way of doing this or am I thinking of something impossible? This is what I got so far</p>\n\n<pre><code>Sub ListWorkSheetNames()\nDim Cellnames(1000) As String\nDim Shrinkage(1000) As Double\nFor i = 1 To Application.Sheets.Count \nCellnames(i) = Application.Sheets(i).Name   \n\nstrName = Cellnames(i)\n\nShrinkage(i) = Workbooks(strProjectedRevenue).Worksheet(\"Month\").Rows(2).Find(What:=strName, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n\nWorkbooks(strB.xlsm).Worksheets(\"Sheet1\").Range(\"E\" &amp; i) = Shrinkage\nWorkbooks(strB.xlsm).Worksheets(\"Sheet1\").Range(\"D\" &amp; i) = strName\n\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "edited": false, "score": 0, "creation_date": 1432132054, "post_id": 30352173, "comment_id": 48797571, "body": "Thanks... I like the latter option much better and it works great! It&#39;s a little cleaner and I don&#39;t have to edit my existing code. Are there any disadvantages to using it over the first option?"}, {"owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "reply_to_user": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "edited": false, "score": 0, "creation_date": 1432132148, "post_id": 30352173, "comment_id": 48797653, "body": "In smaller solution not really, but if you plan to extend it it can get messy with e.g. 10 public vars with god knows where assignments"}], "tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1432130999, "creation_date": 1432130999, "answer_id": 30352173, "question_id": 30351973, "link": "https://stackoverflow.com/questions/30351973/saving-recalling-vba-variables-in-word-2013/30352173#30352173", "title": "saving/recalling VBA variables in Word 2013", "body": "<p>There are two ways to do this, either you declare the separate subroutines e.g.\n    sub mySub(myVar as integer)\nthen call the sub within your code with:\n    mySub(b)\nThe 2nd way is to declare the variables outside any subroutines like:\n    public b as integer\nthen you can simply use them in all subroutines.</p>\n"}], "owner": {"reputation": 27, "user_id": 4843452, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b392671f5d71415d46aeb5ffcaea9c71?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4843452/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 30352173, "answer_count": 1, "score": 0, "last_activity_date": 1432663346, "creation_date": 1432130483, "last_edit_date": 1432663346, "question_id": 30351973, "link": "https://stackoverflow.com/questions/30351973/saving-recalling-vba-variables-in-word-2013", "title": "saving/recalling VBA variables in Word 2013", "body": "<p>I'm using VBA in Word 2013 to score and return some basic info that the end user will input in the document in some legacy form fields.  My code, which works fine if I have it all in a single sub, is:</p>\n\n<pre><code>Option Explicit\n\nSub ScoreLevel()\n\nDim a As Integer\nDim b As Integer\nDim Score as Integer\nDim Level as String\n\nIf ActiveDocument.FormFields(\"Text37\").Result &lt; \"33\" Then\n    a = 2\nElse\n    a = 0\nEnd If\n\nIf ActiveDocument.FormFields(\"Text40\").Result = \"0\" Then\n    b = 0\nElseIf ActiveDocument.FormFields(\"Text40\").Result = \"1\" Then\n    b = 1\nElseIf ActiveDocument.FormFields(\"Text40\").Result &gt; \"1\" Then\n    b = 2\nElse\n    b = 0\nEnd If\n\nScore = a + b\n\nSelect Case Score\n    Case 0 To 1\n        Level = \"Low\"\n    Case 2 To 3\n        Level = \"Moderate\"\n    Case Is &gt; 3\n        Level = \"High\"\nEnd Select\n\nMsgBox \"Score = \" &amp; Score &amp; vbNewLine &amp; \"Level: \" &amp; Level \n\nEnd Sub\n</code></pre>\n\n<p>Now I'm trying to separate the a variable and the b variable routines into their own (individual) sub routines, but the variables did not pass down.  Any help how to do this?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": true, "score": 0, "last_activity_date": 1432131564, "creation_date": 1432131564, "answer_id": 30352411, "question_id": 30351966, "link": "https://stackoverflow.com/questions/30351966/combining-functions-for-auto-attachment/30352411#30352411", "title": "Combining functions for auto attachment", "body": "<p>What I actually would do instead is:</p>\n\n<pre><code>Sub AddAttachment(Item As Outlook.MailItem)\n Dim myOlApp As Outlook.Application\n Dim myItem As Outlook.MailItem\n Dim myAttachments As Outlook.Attachments\n Set myOlApp = CreateObject(\"Outlook.Application\")\n Set myItem = myOlApp.CreateItemFromTemplate(\"C:\\Templates\\test upload file.oft\")\nSet myAttachments = myItem.Attachments\nmyAttachments.Add \"C:\\TEST\\\" &amp; Format(Date, \"yymmdd\") &amp; \"ABCDE.txt\"\nmyItem.Send\nEnd Sub\n</code></pre>\n\n<p>Hope this helps</p>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1432131692, "creation_date": 1432131692, "answer_id": 30352460, "question_id": 30351966, "link": "https://stackoverflow.com/questions/30351966/combining-functions-for-auto-attachment/30352460#30352460", "title": "Combining functions for auto attachment", "body": "<p>I have noticed the following line of code in the script:</p>\n\n<blockquote>\n  <p>Set myOlApp = CreateObject(\"Outlook.Application\")</p>\n</blockquote>\n\n<p>Why do you need to create a new Outlook Application instance in the code? Instead, you may use the Application property in VBA or just use the passed argument to retrieve the required properties. </p>\n\n<pre><code>Sub AddAttachment(Item As Outlook.MailItem)\n Dim myOlApp As Outlook.Application\n Dim myItem As Outlook.MailItem\n Dim myAttachments As Outlook.Attachments\n Set myOlApp = CreateObject(\"Outlook.Application\")\n Set myItem = myOlApp.CreateItemFromTemplate(\"C:\\Templates\\test upload file.oft\")\n Set myAttachments = myItem.Attachments\n myAttachments.Add \"C:\\Test\\\" &amp; Mid(Year(Now), 3, 2) &amp; LPad(Month(Now), \"0\", 2) &amp; LPad(Day(Now), \"0\", 2) &amp; \"ABCDE.txt\"\n ' or simply use the Format method\n ' myAttachments.Add \"C:\\TEST\\\" &amp; Format(Date, \"yymmdd\") &amp; \"ABCDE.txt\"\n myItem.Send\nEnd Sub\n\nFunction LPad (str, pad, length)\n  LPad = String(length - Len(str), pad) &amp; str\nEnd Function\n</code></pre>\n\n<p>Finally, you may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}], "owner": {"reputation": 15, "user_id": 4920770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/090722793b95b0b42629ee0b718d4f53?s=128&d=identicon&r=PG&f=1", "display_name": "Tiggerbasher", "link": "https://stackoverflow.com/users/4920770/tiggerbasher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 30352411, "answer_count": 2, "score": 1, "last_activity_date": 1593513922, "creation_date": 1432130474, "last_edit_date": 1593513922, "question_id": 30351966, "link": "https://stackoverflow.com/questions/30351966/combining-functions-for-auto-attachment", "title": "Combining functions for auto attachment", "body": "<p>I have some script which attaches and sends a file based on some incoming e-mail rules which works perfectly.</p>\n\n<pre><code>Sub AddAttachment(Item As Outlook.MailItem)\n    Dim myOlApp As Outlook.Application\n    Dim myItem As Outlook.MailItem\n    Dim myAttachments As Outlook.Attachments\n    Set myOlApp = CreateObject(\"Outlook.Application\")\n    Set myItem = myOlApp.CreateItemFromTemplate(\"C:\\Templates\\test upload file.oft\")\n    Set myAttachments = myItem.Attachments\n    myAttachments.Add \"C:\\TEST\\150520ABCDE.txt\"\nmyItem.Send\nEnd Sub\n</code></pre>\n\n<p>Trouble I have is the attachment file name \"150520ABCDE.txt\" changes daily. \"150520\" being the date.</p>\n\n<p>I therefore have some more script which should assign the correct file name based on date.</p>\n\n<pre><code>Function LPad (str, pad, length)\n    LPad = String(length - Len(str), pad) &amp; str\nEnd Function\n\ny = Year(Now)\nm = Month(Now)\nd = Day(Now)\n\nf = \"C:\\Test\\\" &amp; Mid(y, 3, 2) &amp; LPad(m, \"0\", 2) &amp; LPad(d, \"0\", 2) &amp; \"ABCDE.txt\"\n\nmyAttachments.Add f\n</code></pre>\n\n<p>My question is how do I tie them both together in to one script?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432129888, "post_id": 30351612, "comment_id": 48795765, "body": "Where is it flagging the error?"}, {"owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "reply_to_user": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432130040, "post_id": 30351612, "comment_id": 48795896, "body": "Do While Cells(i, 1) &lt;&gt; &quot;&quot;"}, {"owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "reply_to_user": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432130090, "post_id": 30351612, "comment_id": 48795931, "body": "If you want u can change it conpletely . I should just get worked"}, {"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "edited": false, "score": 0, "creation_date": 1432130131, "post_id": 30351612, "comment_id": 48795972, "body": "You haven&#39;t set a value for <code>i</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "edited": false, "score": 0, "creation_date": 1432130628, "post_id": 30351943, "comment_id": 48796353, "body": "I wrote i=1 now but now its showing errors in this line                                  If InStr(ActiveCell.Value, errorcode, vbTextCompare) &lt;&gt; 0 Then"}, {"owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "edited": false, "score": 0, "creation_date": 1432130718, "post_id": 30351943, "comment_id": 48796424, "body": "i dont know if its a correct way to check a check the input text"}], "tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": false, "score": 0, "last_activity_date": 1432130418, "creation_date": 1432130418, "answer_id": 30351943, "question_id": 30351612, "link": "https://stackoverflow.com/questions/30351612/search-the-input-text/30351943#30351943", "title": "Search the input text", "body": "<p>You haven't set <code>i</code> equal to a valid column row number.</p>\n\n<p>It's currently trying to evaluate <code>Do While Cells(0, 1) &lt;&gt; \"\"</code> which obviously doesn't make sense.</p>\n\n<p>Put <code>i = 1</code> (or whatever row you wish to start at) on the line above.</p>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1432133651, "last_edit_date": 1432133651, "creation_date": 1432133196, "answer_id": 30353073, "question_id": 30351612, "link": "https://stackoverflow.com/questions/30351612/search-the-input-text/30353073#30353073", "title": "Search the input text", "body": "<p>This is the description of your goal for the macro from your original question:</p>\n\n<blockquote>\n  <p>\"searches the Input text and if it is present anywhere from Column A\n  through Column L it should write the user input in Column V of that\n  particular row\"</p>\n</blockquote>\n\n<p>This code will accomplish that goal, commented to help provide clarity:</p>\n\n<pre><code>Sub tgr()\n\n    'Declare variables\n    Dim ws As Worksheet         'Used to store the worksheet that contains the data\n    Dim rngData As Range        'Used to store the range that contains the data\n    Dim rngFound As Range       'Used to find all matches (if any)\n    Dim rngOutput As Range      'Used to store cells where the output will be displayed (in column V)\n    Dim strErrorCode As String  'Used to store the user input\n    Dim strFirst As String      'Used to store the first found cell to prevent infinite loop\n\n    'Get input from user\n    strErrorCode = InputBox(\"Enter Error Code\")\n    If Len(strErrorCode) = 0 Then Exit Sub    'Pressed cancel\n\n    Set ws = ActiveWorkbook.Sheets(\"DUT1\")  'Set the ws variable to the worksheet that contains the data\n    Set rngData = ws.Range(\"A:L\")           'Set the rngData variable to the range that contains the data\n    ws.Columns(\"V\").ClearContents           'Clear column V of previous results\n\n    'Check columns A:L for the provided input, checking for partial matches\n    Set rngFound = rngData.Find(strErrorCode, rngData.Cells(rngData.Cells.Count), xlValues, xlPart)\n\n    'Was anything found?\n    If rngFound Is Nothing Then\n        'Nothing found, return error\n        MsgBox \"No matches found for [\" &amp; strErrorCode &amp; \"]\"\n    Else\n        'Found a match, record first found cell and begin building the output range\n        strFirst = rngFound.Address\n        Set rngOutput = ws.Cells(rngFound.Row, \"V\")\n\n        'Initiate a loop to find all matches\n        Do\n            'Build output range from matching cells using the Union method\n            Set rngOutput = Union(rngOutput, ws.Cells(rngFound.Row, \"V\"))\n\n            Set rngFound = rngData.FindNext(rngFound)   'Go to next matching cell\n        Loop While rngFound.Address &lt;&gt; strFirst 'End loop when back to first found cell\n\n        'Output the data to the output range\n        rngOutput.Value = strErrorCode\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432661715, "creation_date": 1432129589, "last_edit_date": 1432661715, "question_id": 30351612, "link": "https://stackoverflow.com/questions/30351612/search-the-input-text", "title": "Search the input text", "body": "<p>I am new to Excel Vba and I have written a program which searches the Input text and if it is present anywhere from Column A through Column L it should write the user input in Column V of that particular row. I am running into a error here on the <code>Do While Cells(i,1)&lt;&gt;\"\"</code> line. Any advice in solving this would be greatly appreciated.</p>\n\n<pre><code>Sub testing()\n\nApplication.ScreenUpdating = False\n\nDim oRange As Range, aCell As Range, bCell As Range, sAddress As Range\nDim store As Variant\nDim ws As Worksheet\nDim SearchString As String, FoundAt As String, Device As String,  FailureUnitValue As String\nDim Occurence1ms As Integer, Occurence10ms As Integer, Occurence As Integer\nDim DeviceCellAdd As Variant, DeviceCellValue As Variant, FailureUnitAddress As Variant, Failure As Variant\n\nDim errorcode As Variant\nDim rowNum As Double\nDim i As Long\n\n\nDim lastrow As Double\n\n\nerrorcode = InputBox(\"Enter Error Code\")\n\nWorksheets(\"DUT1\").Activate\nRange(\"V:V\").ClearContents\n\n\nSet oRange = Range(\"G:G\")\n\nDo While Cells(i, 1) &lt;&gt; \"\"\n\nIf InStr(ActiveCell.Value, errorcode, vbTextCompare) &lt;&gt; 0 Then\n\nrowNum = ActiveCell.Row\n\nRange(\"V:\" &amp; rowNum).Value = errorcode\n\nActiveCell.Offset(0, -1).Select\n\n\nEnd If\n\ni = i + 1\n\n\nLoop\n\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1634, "user_id": 801579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ddca488ca1f1edcb6c4348a7207920?s=128&d=identicon&r=PG", "display_name": "Wyatt Earp", "link": "https://stackoverflow.com/users/801579/wyatt-earp"}, "edited": false, "score": 0, "creation_date": 1432129079, "post_id": 30351254, "comment_id": 48795075, "body": "Please add some sample input, along with expected output.  In addition, what exactly have you tried so far?"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1432129285, "post_id": 30351254, "comment_id": 48795251, "body": "post picture with fake data, just to see what you trying to achieve (example what you have and what you need)"}, {"owner": {"reputation": 3, "user_id": 4919251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0770cb4021abe7bf836c41ac0f4a3a6d?s=128&d=identicon&r=PG&f=1", "display_name": "zaza410", "link": "https://stackoverflow.com/users/4919251/zaza410"}, "edited": false, "score": 0, "creation_date": 1432129704, "post_id": 30351254, "comment_id": 48795614, "body": "I added some more details, but I cannot post a picture to to account restrictions."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1432131283, "post_id": 30351254, "comment_id": 48796867, "body": "Welcome to SO! Reading <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> will help you get an answer sooner. Remember, this isn&#39;t a code-writing service, so post what you&#39;ve got &amp; we can help you fix it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1432131771, "post_id": 30351254, "comment_id": 48797295, "body": "What is the intended result if a single shipment is over the capacity?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1432133442, "creation_date": 1432133442, "answer_id": 30353201, "question_id": 30351254, "link": "https://stackoverflow.com/questions/30351254/create-new-id-based-on-cumulative-sum-in-excel-vba/30353201#30353201", "title": "Create new ID based on cumulative sum in excel vba", "body": "<p>A simple formula could be written that 'floats' the range totals for each successive load ID.</p>\n\n<p>In the following, I've typed <em>25</em> and <em>15</em> in D1:E1 and used a custom number format of <em>I\\D 0</em>. In this way, the column is identified and the cell can be referenced as a true number load limit. You can hard-code the limits into the formula if you prefer by overwriting <strong>D$1</strong> but you will not have a one-size-fits-all formula that can be copied right for alternate load limits as I have in my example..</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<img src=\"https://i.stack.imgur.com/BVq2z.png\" alt=\"Floating SUM load limit\"></p>\n\n<p>The formula in D2 is,</p>\n\n<pre><code>=IF(ROW()=2, 1, (SUM(INDEX($B:$B, MATCH(D1, D1:D$1, 0)):$B2)&gt;D$1)+ D1)\n</code></pre>\n\n<p>Fill right to E2 then down as necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4919251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0770cb4021abe7bf836c41ac0f4a3a6d?s=128&d=identicon&r=PG&f=1", "display_name": "zaza410", "link": "https://stackoverflow.com/users/4919251/zaza410"}, "edited": false, "score": 0, "creation_date": 1432189806, "post_id": 30353232, "comment_id": 48823185, "body": "Worked like a charm for 10000 entries! Thanks!"}], "tags": [], "owner": {"reputation": 878, "user_id": 4839592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6d7b83ccb165cc0eb54b10e0ba29a7?s=128&d=identicon&r=PG&f=1", "display_name": "TMH8885", "link": "https://stackoverflow.com/users/4839592/tmh8885"}, "is_accepted": true, "score": 0, "last_activity_date": 1432133492, "creation_date": 1432133492, "answer_id": 30353232, "question_id": 30351254, "link": "https://stackoverflow.com/questions/30351254/create-new-id-based-on-cumulative-sum-in-excel-vba/30353232#30353232", "title": "Create new ID based on cumulative sum in excel vba", "body": "<p>I think I see what you're trying to do here, and just using an IF formula (and inserting a new column to keep track):</p>\n\n<p><img src=\"https://i.stack.imgur.com/v4OWo.jpg\" alt=\"Example\"></p>\n\n<p>In the Columns C and D, insert these formulas in row 3 and copy down (changing 15 for whatever you want your new volume capacity to be):</p>\n\n<p>Column C: =IF(B3+C2&lt;15,B3+C2,B3) </p>\n\n<p>Column D: =IF(B3+C2&lt;15,D2,D2+1)</p>\n\n<p>And for the cells C2 and D2:</p>\n\n<p>C2: = B2</p>\n\n<p>D2: = A2</p>\n\n<p>Is this what you're looking to do?</p>\n"}], "owner": {"reputation": 3, "user_id": 4919251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0770cb4021abe7bf836c41ac0f4a3a6d?s=128&d=identicon&r=PG&f=1", "display_name": "zaza410", "link": "https://stackoverflow.com/users/4919251/zaza410"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 30353232, "answer_count": 2, "score": 0, "last_activity_date": 1432133492, "creation_date": 1432128804, "last_edit_date": 1531164843, "question_id": 30351254, "link": "https://stackoverflow.com/questions/30351254/create-new-id-based-on-cumulative-sum-in-excel-vba", "title": "Create new ID based on cumulative sum in excel vba", "body": "<p>I need to create a new transport ID based on the cumulative sum of the volume being transported. Let\u00b4s say that originally everything was transported in truck A with a capacity of 25. Now I want to assign these items to shipments with truck B (Capacity 15).</p>\n\n<p>The only real constraint is amt shipped cannot exceed capacity.</p>\n\n<p>I can\u00b4t post a picture because of the restrictions...but the overall set up would be like this:</p>\n\n<pre><code>Old Trans # Volume  New Trans # Cumulative Volume for Trans\n\n1   1       \n1   9       \n1   3       \n1   7       \n1   4       \n2   9       \n2   10      \n3   8       \n3   5       \n3   9       \n4   4       \n4   6       \n4   8       \n5   9       \n5   1       \n5   5       \n5   8       \n6   3       \n6   4       \n6   3       \n6   4       \n6   4       \n6   7       \n7   7       \n7   10      \n7   4       \n8   10      \n8   6       \n8   7       \n9   4       \n9   9       \n9   6       \n10  7       \n10  4       \n10  1       \n10  1       \n10  5       \n10  2       \n11  9       \n11  3       \n11  9       \n12  8       \n12  5       \n12  9       \n13  9       \n</code></pre>\n\n<p>Expected output would be that the first three entries would result in a new shipment ID of 1;the next two entries would result in a new shipment ID of 2;and so on... I\u00b4ve tried everthing that I know(excluding VBA): Index/lookup/if functions. My VBA skills are very limited though.Any tips?? thanks!</p>\n\n<p><img src=\"https://i.stack.imgur.com/CsItD.png\" alt=\"http://i.stack.imgur.com/CsItD.png\"></p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1432128353, "post_id": 30350996, "comment_id": 48794496, "body": "Also need to have single quotes around the PostalCode - as a number it will read 5021 and not 05021."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1432128477, "post_id": 30350996, "comment_id": 48794584, "body": "@Parado you <i>can</i> have them at the same level, but the order of execution is usually different that what&#39;s intended."}, {"owner": {"reputation": 24071, "user_id": 1579182, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/29b8eb1189d3a4ea2fa71ccd069f9ca3?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1579182/robert"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1432128673, "post_id": 30350996, "comment_id": 48794749, "body": "@DStanley True I wasn&#39;t clarify with it. I polished my answer :)"}], "tags": [], "owner": {"reputation": 24071, "user_id": 1579182, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/29b8eb1189d3a4ea2fa71ccd069f9ca3?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1579182/robert"}, "is_accepted": true, "score": 2, "last_activity_date": 1432133628, "last_edit_date": 1432133628, "creation_date": 1432128170, "answer_id": 30350996, "question_id": 30350930, "link": "https://stackoverflow.com/questions/30350930/sql-select-with-multiple-and-and-ors-goes-wrong/30350996#30350996", "title": "SQL Select with multiple AND and OR&#39;s goes wrong", "body": "<p>You can't keep <code>OR</code> and <code>AND</code> on the same condition level. Keeping your logic you have to use parenthesis for <code>OR</code> as below</p>\n\n<pre><code>SELECT * FROM Customers\nWHERE (Country Like '*m*' Or City Like '*m*')\nAnd PostalCode='05021';  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1432128880, "creation_date": 1432128880, "answer_id": 30351284, "question_id": 30350930, "link": "https://stackoverflow.com/questions/30350930/sql-select-with-multiple-and-and-ors-goes-wrong/30351284#30351284", "title": "SQL Select with multiple AND and OR&#39;s goes wrong", "body": "<p>this is additional variants to already posted variant by <code>@Parado</code></p>\n\n<pre><code>SELECT  *\nFROM    Customers\nWHERE   (Country &amp; City) LIKE '*m*'\n         AND PostalCode = '05021'\n-------------------------------------------------\nSELECT  *\nFROM    Customers\nWHERE   (Country &amp; City &amp; PostalCode) = '*m*05021'\n-------------------------------------------------\nSELECT  *\nFROM    Customers\nWHERE   (Country + City + PostalCode) = '%m%05021'\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4022167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 30350996, "answer_count": 2, "score": 1, "last_activity_date": 1432133628, "creation_date": 1432128010, "last_edit_date": 1432128317, "question_id": 30350930, "link": "https://stackoverflow.com/questions/30350930/sql-select-with-multiple-and-and-ors-goes-wrong", "title": "SQL Select with multiple AND and OR&#39;s goes wrong", "body": "<pre><code>Name | ContactName | Address | City | PostalCode | Country\n\nAlfreds | Maria Anders | Path 57 | Berlin | 12209 | Germany\n\nAna | Ana Trujillo | Kanne 22 | M\u00e9xico | 05021 | Mexico\n</code></pre>\n\n<p>I have pretty the same problem:</p>\n\n<pre><code>SELECT * FROM Customers\nWHERE Country Like '*m*'\nOr City Like '*m*'\nAnd PostalCode=05021;  \n</code></pre>\n\n<p>Normally I should get Ana.. but I get those datasets. For any reason PostalCode isn't minded.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1432127644, "creation_date": 1432127644, "answer_id": 30350780, "question_id": 30350480, "link": "https://stackoverflow.com/questions/30350480/vba-1004-error-application-defined-or-object-defined-error/30350780#30350780", "title": "VBA 1004 error : Application defined or object defined error", "body": "<p>One issue that is clear (maybe the cause of the whole error), is that variables are being used <em>within</em> a string. So, what does that mean? I'll simplify using the code below as a template:</p>\n\n<pre><code>Sub Test1()\n    Dim i as Integer\n    Dim j as Integer\n\n    i = 2\n    j = 3\n\n    Cells(i, j).Value = \"The row number is i and the column number is j\"\nEnd Sub\n</code></pre>\n\n<p>In the <code>Cells</code> line, it correctly refers to cell <code>C2</code>, which is the second row and third column. But what value is inserted into the cell? It's literally <code>\"The row number is i and the column number is j\"</code> using the letters, and not their corresponding numbers. Similarly, in your case, the formula will read: <code>VLOOKUP(CELLS(i,1)...</code> using the letter i, which is incorrect. </p>\n\n<p>Additionally, a cell's formula doesn't use the <code>CELLS</code> syntax. You instead need to build a string using the variables. It would look a lot like:</p>\n\n<pre><code>\"=VLOOKUP(\" &amp; Cells(i, 1).Address &amp; \"SKULifeCycle_Table_Temp!R1C1:R5000C500, Match(\" &amp; Cells(i, 1)Address ... \"\n</code></pre>\n\n<p>Try to build out your formula string and refer back to this post with any specific questions.</p>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 4, "last_activity_date": 1432127800, "creation_date": 1432127800, "answer_id": 30350833, "question_id": 30350480, "link": "https://stackoverflow.com/questions/30350480/vba-1004-error-application-defined-or-object-defined-error/30350833#30350833", "title": "VBA 1004 error : Application defined or object defined error", "body": "<p>A few things wrong there:</p>\n\n<p>First, you're using the literal text \"Cells(i, 1).Value\" and \"Cells(1, j).Value\" in the formula string. You would need to concatenate the values into the string like this:</p>\n\n<pre><code>Cells(i, j).FormulaR1C1 = \"=vlookup(\" &amp; Cells(i,1).Value &amp; \",SKULifeCycle_Table_Temp!R1C1:R5000C500,match(\" &amp; Cells(1,j).Value &amp; \",'SKULifeCycle_Table_Temp'!R1C1:R1C500,0),0)\"\n</code></pre>\n\n<p>Second, you used the <code>.Formula</code> property but passed R1C1 style references, so you should use the <code>.FormulaR1C1</code> property (as I did above).</p>\n\n<p>Third, if the values in the cells that you are using for the lookup values are text, you need to enclose them in quotes:</p>\n\n<pre><code>    Cells(i, j).FormulaR1C1 = \"=vlookup(\"\"\" &amp; Cells(i,1).Value &amp; \"\"\",SKULifeCycle_Table_Temp!R1C1:R5000C500,match(\"\"\" &amp; Cells(1,j).Value &amp; \"\"\",'SKULifeCycle_Table_Temp'!R1C1:R1C500,0),0)\"\n</code></pre>\n\n<p>or use the addresses (in R1C1 format) instead:</p>\n\n<pre><code>Cells(i, j).FormulaR1C1 = \"=vlookup(RC1,SKULifeCycle_Table_Temp!R1C1:R5000C500,match(R1C,'SKULifeCycle_Table_Temp'!R1C1:R1C500,0),0)\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4920507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1237477669694837/picture?type=large", "display_name": "anathema1987", "link": "https://stackoverflow.com/users/4920507/anathema1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432127904, "creation_date": 1432126926, "last_edit_date": 1531164843, "question_id": 30350480, "link": "https://stackoverflow.com/questions/30350480/vba-1004-error-application-defined-or-object-defined-error", "title": "VBA 1004 error : Application defined or object defined error", "body": "<p>I am a novice at Excel VBA and am running into an error 1004 while compiling a portion of the code:</p>\n\n<pre><code>Cells(i, j).Formula = _\"=vlookup(Cells(i,1).Value,SKULifeCycle_Table_Temp!R1C1:R5000C500,match(Cells(1,j).Value,'SKULifeCycle_Table_Temp'!R1C1:R1C500,0),0)\"\n</code></pre>\n\n<p><code>i</code> and <code>j</code> have been defined previously as integers and are part of a for loop. Could anyone please help me out on this?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432127966, "post_id": 30350064, "comment_id": 48794176, "body": "I 100% cannot duplicate this, I have Form1 which has a button that is used to change the value of a checkbox on Form2 and both methods work.   Do you have any other OnUpdate or BeforeUpdate code that could be interfering here?"}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432128694, "post_id": 30350064, "comment_id": 48794765, "body": "I&#39;ve added the code snippet so you can see @Newd. When I step through the code it doesn&#39;t run anything else afterwards that I can see...unless access runs ninja code behind the scenes =P"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432128885, "post_id": 30350064, "comment_id": 48794916, "body": "So just to clarify, it does run through the <code>Forms!frmAAdmin9110YearEnd!ChkValidated = True</code>? And can you comment out the other lines of code and see if it makes a difference?"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1432129034, "post_id": 30350064, "comment_id": 48795037, "body": "In your question you said the name of the checkbox was <code>ChkConfirmed </code> but your VBA says <code>ChkValidated</code>..."}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1432129340, "post_id": 30350064, "comment_id": 48795298, "body": "@Invent-Animate - Just an example - I wasn&#39;t going to put snippets in originally"}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432129431, "post_id": 30350064, "comment_id": 48795375, "body": "@Newd Yes it works for #2 and if I change it to #1 nothing happens."}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1432130962, "post_id": 30350064, "comment_id": 48796635, "body": "I&#39;m unable to reproduce this issue. I&#39;ve reproduced everything that we know and I was able to mark the checkbox as true on another form immediately after closing the current form."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 1, "creation_date": 1432135205, "post_id": 30350064, "comment_id": 48800062, "body": "I always follow the rule that if you are trying to change something in/on a form using VBA written outside of that form (i.e. in separate module or something) then you have to use <code>Forms!myForm</code>... in order to go through the objects and allow access to find the form you want to reference... as per the &quot;not on these forms&quot; quadrant on this cheat sheet: <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "edited": false, "score": 0, "creation_date": 1432127486, "post_id": 30350553, "comment_id": 48793812, "body": "Maybe you should try again - it definitely works... just not sure why it doesn&#39;t work in this situation."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432128092, "post_id": 30350553, "comment_id": 48794272, "body": "One thing I have learned about access is that there is too many ways to reference objects.  But Cocojay is correct, these do work."}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1432128153, "post_id": 30350553, "comment_id": 48794319, "body": "What version of Access are we talking about here?"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432128230, "post_id": 30350553, "comment_id": 48794390, "body": "Take a look in the tags ;-)"}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "edited": false, "score": 0, "creation_date": 1432128515, "post_id": 30350553, "comment_id": 48794622, "body": "@Gene - to be honest I&#39;ve been using #1 method since Access 2000 so it can&#39;t be a version issue."}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "reply_to_user": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "edited": false, "score": 0, "creation_date": 1432130025, "post_id": 30350553, "comment_id": 48795879, "body": "@cocojay - Please don&#39;t  misunderstanding, i&#39;m not saying your wrong, just I&#39;ve never seen it andit failed in testing.  I&#39;ve put the file on i used to test on dropbox, maybe you can look at it and see what I saw. <a href=\"https://www.dropbox.com/s/ok66933kz0rzwns/Test%28checkbox%291.accdb?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/ok66933kz0rzwns/Test%28checkbox%291.accdb?dl=0</a>"}, {"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1432130745, "post_id": 30350553, "comment_id": 48796446, "body": "The first version of the code-syntax will most likely fail if the Form referenced by the code has the HasModule-Property set to &quot;No&quot;. Then there is no class module that can be instanced and no object afterwards, hence the error."}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "edited": false, "score": 0, "creation_date": 1432130757, "post_id": 30350553, "comment_id": 48796458, "body": "@Gene - Hey Gene, I had a look at your code. Just a couple things to make sure you can replicate the issue I had. Design formXYZ and on the ribbon click on &quot;View in Code&quot; this will create a class object for the form in the code.  Then, when running make sure both forms are open. Give that a go and let me know if it works."}], "tags": [], "owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "is_accepted": false, "score": -2, "last_activity_date": 1432127068, "creation_date": 1432127068, "answer_id": 30350553, "question_id": 30350064, "link": "https://stackoverflow.com/questions/30350064/differences-in-referencing-forms-in-vba-access/30350553#30350553", "title": "Differences in referencing forms in VBA Access", "body": "<p>To be honest, I've never seen your 1st example used, ever... In fact a quick test in Access 2010 fails with an \"Object Required\" error message. All the code I've ever done uses the exclamation, which (someone correct me if I'm worng) works in all circumstances where you would need to reference another form for something.</p>\n"}, {"comments": [{"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 1, "creation_date": 1432131017, "post_id": 30351805, "comment_id": 48796663, "body": "Access can treat forms only as a classes if they have a (class) module. See the HasModule-Property of the form."}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "reply_to_user": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1432131460, "post_id": 30351805, "comment_id": 48797008, "body": "@PhilS Sorry, I was mistaken. Not sure what I was thinking."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1432131479, "post_id": 30351805, "comment_id": 48797029, "body": "@Invent-Animate phil is correct you need to have a &quot;class module&quot; attached to it to get the class behaviors"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432134337, "post_id": 30351805, "comment_id": 48799402, "body": "Very Neat, so basically that would mean that if it is being instanced then as soon as the function ends it would clear from memory?"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1432137661, "post_id": 30351805, "comment_id": 48801804, "body": "no you can keep the instances active by saving the hwnd in a public variable."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432138811, "post_id": 30351805, "comment_id": 48802578, "body": "I meant mainly in this situation, so it would open a hidden instance of the form then wipe it from memory almost instantly."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1432144698, "post_id": 30351805, "comment_id": 48806025, "body": "no the instance will remain loaded until you close it, or the original/Main form is closed. If the main form is closed all instance will also be closed."}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "edited": false, "score": 0, "creation_date": 1432201356, "post_id": 30351805, "comment_id": 48830361, "body": "@krish  &gt;its because your form is being instanced and its hidden.  - by hidden do you mean it is not in focus? I&#39;m not completely versed with the hwnd side of coding - do you have useful sources that might help me further understand this and instances?"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1432233904, "post_id": 30351805, "comment_id": 48853036, "body": "@krish so does that mean he should be able to put in <code>Forms!frmAAdmin9110YearEnd.Visible = True</code> and it will pop up?"}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": true, "score": 4, "last_activity_date": 1432131216, "last_edit_date": 1432131216, "creation_date": 1432130046, "answer_id": 30351805, "question_id": 30350064, "link": "https://stackoverflow.com/questions/30350064/differences-in-referencing-forms-in-vba-access/30351805#30351805", "title": "Differences in referencing forms in VBA Access", "body": "<p>Access (I think >=97) treats <strong>Forms</strong> as a <strong>Class</strong> which means your forms are now a class module and can have all [class behaviors] including instancing.</p>\n\n<p><code>Form_your_formname</code>: you are referencing the Form via the Class module.</p>\n\n<p><code>Forms!your_form name</code>: You are referencing the form by its form name.</p>\n\n<p>To access a form via <code>Forms!form_name</code>, the form must already have been loaded. Otherwise the form won't be reachable and you will get an error message <strong><em><code>\"the referenced ...... not found\"</code></em></strong></p>\n\n<p>On the other hand, <code>Form_form_name</code> can be accessed at any time as a class. It can have multiple instances like all classes do. Accessing an <strong>unopened form</strong> via its class module will cause the form is being instanced. This means Access will create a new hidden instance of that Form.</p>\n\n<p>To test this try following. </p>\n\n<ol>\n<li>Create a new form called: frm_test with a text box in it called: txt_id</li>\n<li>go to your immediate window and try following code:</li>\n<li><strong>Edit</strong> forgot to mention. The test form hast to have a vba module attached to it then only it becomes a class module</li>\n</ol>\n\n<p><code>Form_frm_test.txt_id = 1\n Form_frm_test.visible = true\n?Form_frm_test.hwnd\n docmd.openform \"frm_test\"\n?Forms!frm_test.hwnd\n</code></p>\n\n<p>Now you will see two instance of the frm_test form and each of them will have their own window handle.</p>\n\n<p><strong>to answer your question:</strong></p>\n\n<ol>\n<li><p>But, when I use #1 here and step through the code, it definitely runs the code but does not check any boxes...just nothing.</p>\n\n<p>its because your form is being instanced and its hidden.</p></li>\n<li><p>So, I would love to know the technical differences to help me understand when to use each one and in what cases.</p>\n\n<p>Technical explanation given above.\nif your form is already loaded you can use the Form!form_name / form_name to access it. If you are instancing use the class name.</p></li>\n</ol>\n"}], "owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 0, "accepted_answer_id": 30351805, "answer_count": 2, "score": 2, "last_activity_date": 1432131216, "creation_date": 1432125911, "last_edit_date": 1432128370, "question_id": 30350064, "link": "https://stackoverflow.com/questions/30350064/differences-in-referencing-forms-in-vba-access", "title": "Differences in referencing forms in VBA Access", "body": "<p><strong>Intro:</strong></p>\n\n<p>I have two separate forms.</p>\n\n<ol>\n<li>frmABC</li>\n<li>frmXYZ</li>\n</ol>\n\n<p>I have <strong>frmABC</strong> in focus and I run a procedure that will \"Tick\" a checkbox called <strong>ChkConfirmed</strong> on <strong>frmXYZ</strong>.</p>\n\n<hr>\n\n<p><strong>Question:</strong></p>\n\n<p>What is the <strong>difference</strong> between these two ways of referencing another form?</p>\n\n<p><strong>1</strong>. Form_frmXYZ.ChkConfirmed = True</p>\n\n<p><strong>2</strong>. Forms!frmXYZ.ChkConfirmed = True</p>\n\n<hr>\n\n<p>For some reason, only <strong>#2</strong> works in this scenario. For me this is bewildering purely beacuse I have always used <strong>#1</strong> and it has never complained before (when I say complain, I mean it does the job).</p>\n\n<p>But, when I use <strong>#1</strong> here and step through the code, it definitely runs the code but does not check any boxes...just nothing.</p>\n\n<p>So, I would love to know the technical differences to help me understand when to use each one and in what cases.</p>\n\n<hr>\n\n<p>EDIT:\nActual code snippet (as requested)</p>\n\n<p><strong>#1 Version</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/zv6LB.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>#2 Version</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/Vfjy2.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432126192, "post_id": 30350041, "comment_id": 48792768, "body": "++ You beat me to it :)"}], "tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": true, "score": 3, "last_activity_date": 1432125877, "creation_date": 1432125877, "answer_id": 30350041, "question_id": 30349633, "link": "https://stackoverflow.com/questions/30349633/validate-cell-and-get-grade/30350041#30350041", "title": "Validate cell and get grade", "body": "<p>I think what you actually need to do is get rid of the activecell like this:</p>\n\n<pre><code>Sub SetGrade()\nDim r As Integer\nDim Score As Double\n\nFor r = 2 To 20\n\nScore = Cells(r, 2).Value\n\nIf Score &gt;= 90 And Score &lt;= 100 Then\n\n    Cells(r, 3).Value = \"A\"\n    Cells(r, 3).Interior.ColorIndex = 4\n    Cells(r, 3).HorizontalAlignment = xlCenter\n\nElseIf Score &gt;= 75 And Score &lt;= 90 Then\n\n    Cells(r, 3).Value = \"B\"\n    Cells(r, 3).Interior.ColorIndex = 46\n    Cells(r, 3).HorizontalAlignment = xlLeft\n\nEnd If\n\nNext r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4830772, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153285211504295/picture?type=large", "display_name": "Winston Rajesh", "link": "https://stackoverflow.com/users/4830772/winston-rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 30350041, "answer_count": 1, "score": 1, "last_activity_date": 1432126519, "creation_date": 1432124793, "last_edit_date": 1531161705, "question_id": 30349633, "link": "https://stackoverflow.com/questions/30349633/validate-cell-and-get-grade", "title": "Validate cell and get grade", "body": "<p>Here is my requirement. I have sheet in which column B has marks. Based on the marks and with a click of a button, I'm trying to get grades and colour the cell based on grade. Following is the code I wrote but this is not successfully working. Kindly, help</p>\n\n<pre><code>Sub SetGrade()\n    Dim r As Integer\n    Dim Score As Double\n\n    For r = 2 To 20\n        Score = Cells(r, 2).Value\n\n        If Score &gt;= 90 And Score &lt;= 100 Then\n            ActiveCell(1, 2).Value = \"A\"\n            ActiveCell(1, 2).Interior.ColorIndex = 4\n            ActiveCell(1, 2).HorizontalAlignment = xlCenter\n        ElseIf Score &gt;= 75 And Score &lt;= 90 Then\n            ActiveCell(1, 2).Value = \"B\"\n            ActiveCell(1, 2).Interior.ColorIndex = 46\n            ActiveCell(1, 2).HorizontalAlignment = xlLeft\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1432125540, "post_id": 30348987, "comment_id": 48792248, "body": "Reading <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> will help you get an answer sooner. Remember, this isn&#39;t a code-writing service, so post what you&#39;ve got &amp; we can help you fix it."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1432127659, "post_id": 30348987, "comment_id": 48793942, "body": "Entirely agree with FreeMan. In order to encourage improvement of your question, there are several methods that can be applied formulas, macros, but basically we need to know what you are looking for. Also I wonder if the numbers for the gap between 20/05/2015 07:06 13218.30000 and 20/05/2015 07:12 13218.40000 should not be 20/05/2015 07:06\t13218.35000 20/05/2015 07:07\t13218.40000 20/05/2015 07:08\t13218.45000 20/05/2015 07:09\t13218.50000 20/05/2015 07:10\t13218.55000 20/05/2015 07:12\t13218.40000 Just curious about it."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432136335, "post_id": 30348987, "comment_id": 48800881, "body": "This is related to <a href=\"http://stackoverflow.com/a/2824094/4288101\">this answer</a>.  The idea is that you <code>FORECAST</code> on a 2x2 grid of dates and values.  You get the grid using <code>OFFSET</code> and <code>MATCH</code>.  Other site with formulas to review include <a href=\"http://www.blueleafsoftware.com/Products/Dagra/LinearInterpolationExcel.php\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://www.mrexcel.com/forum/excel-questions/138021-interpolate-between-two-dates.html\" rel=\"nofollow noreferrer\">this</a>.  Google is your friend with <a href=\"https://www.google.com/search?q=excel+two+date+interpolation\" rel=\"nofollow noreferrer\">this search</a>."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 1, "creation_date": 1432136383, "post_id": 30348987, "comment_id": 48800907, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/1043513/interpolating-data-points-in-excel\">Interpolating data points in Excel</a>"}], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 4430375, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/51ee13ebaef0e2d2b136f5f07b5f5249?s=128&d=identicon&r=PG&f=1", "display_name": "twegner", "link": "https://stackoverflow.com/users/4430375/twegner"}, "is_accepted": false, "score": 0, "last_activity_date": 1432139395, "creation_date": 1432139395, "answer_id": 30355448, "question_id": 30348987, "link": "https://stackoverflow.com/questions/30348987/automate-interpolation-of-time-stamped-data-in-excel/30355448#30355448", "title": "automate interpolation of time-stamped data in excel", "body": "<p>I wrote my own interpolate function. It is not designed for dates so you will need to modify the parameters. It might be a good starting point for you. The first parameter is the data point you want to interpolate on. the second parameter is the range of input data defining your curve. Note, when a data point is out of bounds the return value will be the nearest data point, not an extrapolated value.</p>\n\n<pre><code>Function interpolate(inp As Double, rng As Range)\n' written by: Todd Wegner\n'\n'  inp --&gt; the data point to interpolate\n'  rng --&gt; the range of original data\n'\n' early binding\nDim i As Long, dim1 As Long\nDim x1 As Double, x2 As Double, y1 As Double, y2 As Double\nDim arr As Variant\n'\n' set array to the Range(rng)\n  arr = rng\n'\n' if the input is below the data bounds\n' use the first data point, DO NOT extrapolate\n  If inp &lt; arr(1, 1) Then\n    interpolate = arr(1, 2)\n    Exit Function\n  End If\n'\n' get array upper bound\n  dim1 = UBound(arr)\n'\n' if the input is above the data bounds\n' use the last data point, DO NOT extrapolate\n  If inp &gt; arr(dim1, 1) Then\n    interpolate = arr(dim1, 2)\n    Exit Function\n  End If\n'\n' inputs that lie within the data range get interpolated\n  i = 1\n  Do Until inp &lt; arr(i, 1)\n    i = i + 1\n  Loop\n  x1 = arr(i - 1, 1)\n  x2 = arr(i, 1)\n  y1 = arr(i - 1, 2)\n  y2 = arr(i, 2)\n'\n' return\n  interpolate = (y2 - y1) / (x2 - x1) * (inp - x1) + y1\n'\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432155108, "post_id": 30359989, "comment_id": 48811980, "body": "I don&#39;t believe this works in a wide range of cases.  I can create some simple examples where it returns unexpected outputs.  Are there limitations to the input data (dates and values) that can be used?  Example: Dates: <code>5&#47;21, 5&#47;22, 5&#47;23</code>, Values: <code>10,8,18</code>, Input: <code>5&#47;22</code>, Output:<code>10</code> where it should be <code>8</code>.  It is also wrong on other non-exact matching scenarios."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432158326, "post_id": 30359989, "comment_id": 48813554, "body": "Thanks for adding the conditions.  In my experience, data rarely goes one direction so this formula caught me off guard."}, {"owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432159106, "post_id": 30359989, "comment_id": 48813893, "body": "You&#39;re right it&#39;s always better to clarify conditions for applicability. From a sample of interpolation examples posted in groups most are increasing or decreasing relationships. If you want to apply to a decreasing relationship you can use the same formula with <code>1-PERCENTRANK</code>"}], "tags": [], "owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1432158264, "last_edit_date": 1432158264, "creation_date": 1432154468, "answer_id": 30359989, "question_id": 30348987, "link": "https://stackoverflow.com/questions/30348987/automate-interpolation-of-time-stamped-data-in-excel/30359989#30359989", "title": "automate interpolation of time-stamped data in excel", "body": "<p>You could try filling down from <code>E1</code>:</p>\n\n<pre><code>=PERCENTILE(B$1:B$7,PERCENTRANK(A$1:A$7,D1,30))\n</code></pre>\n\n<p>(assumes values are non-decreasing.)</p>\n"}], "owner": {"reputation": 921, "user_id": 2902402, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YggDC.jpg?s=128&g=1", "display_name": "amit_183", "link": "https://stackoverflow.com/users/2902402/amit-183"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432158264, "creation_date": 1432123031, "last_edit_date": 1531161705, "question_id": 30348987, "link": "https://stackoverflow.com/questions/30348987/automate-interpolation-of-time-stamped-data-in-excel", "title": "automate interpolation of time-stamped data in excel", "body": "<p>I have existing data collected at 6 minute interval. Time stamps for which are in column A and the corresponding values are in column B.  </p>\n\n<p>I want to interpolate this data to get a minute by minute breakdown, calculated using a basic interpolation method. A sample of the desired output is shown in columns D and E. </p>\n\n<p>Is there a way to automate this calculation?<img src=\"https://i.stack.imgur.com/3vXle.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["date", "ms-access", "vba"], "comments": [{"owner": {"reputation": 228178, "user_id": 87015, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2f9b099fb455d3ddedb0bfa7430e51a9?s=128&d=identicon&r=PG&f=1", "display_name": "Salman A", "link": "https://stackoverflow.com/users/87015/salman-a"}, "edited": false, "score": 0, "creation_date": 1432122685, "post_id": 30348540, "comment_id": 48790112, "body": "(I think) You count the number of holidays between <code>Date Opened</code> and <code>Date Opened + 25 days</code> and add the result to <code>Date Opened + 25 days</code>."}, {"owner": {"reputation": 5924, "user_id": 636987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/080dab36cef0f86aa173256c277152e6?s=128&d=identicon&r=PG", "display_name": "Mus", "link": "https://stackoverflow.com/users/636987/mus"}, "reply_to_user": {"reputation": 228178, "user_id": 87015, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2f9b099fb455d3ddedb0bfa7430e51a9?s=128&d=identicon&r=PG&f=1", "display_name": "Salman A", "link": "https://stackoverflow.com/users/87015/salman-a"}, "edited": false, "score": 0, "creation_date": 1432123306, "post_id": 30348540, "comment_id": 48790521, "body": "Yes, I think that might do it.  Although the problem is that I would also need to figure out a way of calculating the weekends, too.  Unless, of course, I add the weekends into my <code>holidays</code> table."}, {"owner": {"reputation": 5924, "user_id": 636987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/080dab36cef0f86aa173256c277152e6?s=128&d=identicon&r=PG", "display_name": "Mus", "link": "https://stackoverflow.com/users/636987/mus"}, "edited": false, "score": 0, "creation_date": 1432910956, "post_id": 30348540, "comment_id": 49138760, "body": "I disagree - it is not off-topic and is very much the same question with no extra requirements. Asking a new question would almost certainly constitute a duplicate as the requirements will remain the same, and the only possible outcome is an answer spread over 2 questions. After some investigation it appears that it was not actually resolved after all as the resulting value in the field still sometimes falls on a bank holiday or weekend and this is only something that could have come up through using the system.  If an answer (updated or new) resolves this, then I will accept accordingly."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "edited": false, "score": 1, "creation_date": 1432911850, "post_id": 30348540, "comment_id": 49139482, "body": "Okay in that case, adding 25 working days to 01 Jan 2015, will be 06 Feb 2015 which is Friday. Say it is 26 days, then you would want 09 Feb 2015? If that&#39;s the case, please check my edited answer."}], "answers": [{"comments": [{"owner": {"reputation": 5924, "user_id": 636987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/080dab36cef0f86aa173256c277152e6?s=128&d=identicon&r=PG", "display_name": "Mus", "link": "https://stackoverflow.com/users/636987/mus"}, "edited": false, "score": 0, "creation_date": 1432910333, "post_id": 30349067, "comment_id": 49138283, "body": "I&#39;ve spotted a problem - the date that the field contains sometimes is a weekend and I want it to exclude weekends, with the result being a working day also - is this possible?  I was not aware of this initially but after testing the system further and more intensely, this problem has arisen.  I will also update the existing question to include this. Thank you."}, {"owner": {"reputation": 5924, "user_id": 636987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/080dab36cef0f86aa173256c277152e6?s=128&d=identicon&r=PG", "display_name": "Mus", "link": "https://stackoverflow.com/users/636987/mus"}, "edited": false, "score": 0, "creation_date": 1433145458, "post_id": 30349067, "comment_id": 49207186, "body": "Thank you for the update, PaulFrancis. I have to disagree again, as I did not have a new problem - a new aspect of the initial problem had surfaced once I had implemented your answer and having an answer split between two questions regarding the same issue is somewhat counter-intuitive.  However, your updated answer works exactly as hoped for and for that reason, I have re-accepted your (updated) answer.  Thank you for your help with this."}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 5924, "user_id": 636987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/080dab36cef0f86aa173256c277152e6?s=128&d=identicon&r=PG", "display_name": "Mus", "link": "https://stackoverflow.com/users/636987/mus"}, "edited": false, "score": 0, "creation_date": 1433147196, "post_id": 30349067, "comment_id": 49208042, "body": "Glad to hear you have it resolved. I have retracted my vote. Good luck. :)"}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": true, "score": 1, "last_activity_date": 1432911819, "last_edit_date": 1432911819, "creation_date": 1432123295, "answer_id": 30349067, "question_id": 30348540, "link": "https://stackoverflow.com/questions/30348540/count-x-amount-of-working-days-from-date-entered/30349067#30349067", "title": "Count X Amount of Working Days from Date Entered", "body": "<p>You might need a UDF to get you through this. Something like,</p>\n\n<pre><code>Function addWorkDays(addNumber As Long, Date2 As Date) As Date\n'********************\n'Code Courtesy of\n'  Paul Eugin\n'********************\n\n    Dim finalDate As Date\n    Dim i As Long, tmpDate As Date\n    tmpDate = Date2\n    i = 1\n    Do While i &lt;= addNumber\n        If Weekday(tmpDate) &lt;&gt; 1 And Weekday(tmpDate) &lt;&gt; 7 And _\n            DCount(\"*\", \"tbl_BankHolidays\", \"bankDate = \" &amp; Format(tmpDate, \"\\#mm\\/dd\\/yyyy\\#\")) = 0 Then i = i + 1\n        tmpDate = DateAdd(\"d\", 1, tmpDate)\n    Loop\n\n    Do While Weekday(tmpDate) = 1 Or Weekday(tmpDate) = 7 Or _\n        DCount(\"*\", \"tbl_BankHolidays\", \"bankDate = \" &amp; Format(tmpDate, \"\\#mm\\/dd\\/yyyy\\#\")) &lt;&gt; 0\n        tmpDate = DateAdd(\"d\", 1, tmpDate)\n    Loop\n\n    addWorkDays = tmpDate\nEnd Function\n</code></pre>\n\n<p>So, when you add 25 days to a date, it will skip all weekends and bank holidays stored in your table - <code>tbl_BankHolidays</code>. </p>\n\n<pre><code>? addWorkDays(25, Date())\n  25/06/2015 \n</code></pre>\n\n<p>Hope this helps !</p>\n\n<p><strong>EDIT:</strong> I have added another loop to see if the end date falls on a bank holiday or weekend, if it does it will add one more day until it reaches a weekday. </p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1432123345, "creation_date": 1432123345, "answer_id": 30349092, "question_id": 30348540, "link": "https://stackoverflow.com/questions/30348540/count-x-amount-of-working-days-from-date-entered/30349092#30349092", "title": "Count X Amount of Working Days from Date Entered", "body": "<p>You can use this function:</p>\n\n<pre><code>Public Function DateAddWorkdays( _\n    ByVal lngNumber As Long, _\n    ByVal datDate As Date, _\n    Optional ByVal booWorkOnHolidays As Boolean) _\n    As Date\n\n'   Adds lngNumber of workdays to datDate.\n'   2014-10-03. Cactus Data ApS, CPH\n\n    ' Calendar days per week.\n    Const clngWeekdayCount  As Long = 7\n    ' Workdays per week.\n    Const clngWeekWorkdays  As Long = 5\n    ' Average count of holidays per week maximum.\n    Const clngWeekHolidays  As Long = 1\n    ' Maximum valid date value.\n    Const cdatDateRangeMax  As Date = #12/31/9999#\n    ' Minimum valid date value.\n    Const cdatDateRangeMin  As Date = #1/1/100#\n\n    Dim aHolidays() As Date\n\n    Dim lngDays     As Long\n    Dim lngDiff     As Long\n    Dim lngDiffMax  As Long\n    Dim lngSign     As Long\n    Dim datDate1    As Date\n    Dim datDate2    As Date\n    Dim datLimit    As Date\n    Dim lngHoliday  As Long\n\n\n    lngSign = Sgn(lngNumber)\n    datDate2 = datDate\n\n    If lngSign &lt;&gt; 0 Then\n        If booWorkOnHolidays = True Then\n            ' Holidays are workdays.\n        Else\n            ' Retrieve array with holidays between datDate and datDate + lngDiffMax.\n            ' Calculate the maximum calendar days per workweek.\n            lngDiffMax = lngNumber * clngWeekdayCount / (clngWeekWorkdays - clngWeekHolidays)\n            ' Add one week to cover cases where a week contains multiple holidays.\n            lngDiffMax = lngDiffMax + Sgn(lngDiffMax) * clngWeekdayCount\n            datDate1 = DateAdd(\"d\", lngDiffMax, datDate)\n            aHolidays = GetHolidays(datDate, datDate1)\n        End If\n        Do Until lngDays = lngNumber\n            If lngSign = 1 Then\n                datLimit = cdatDateRangeMax\n            Else\n                datLimit = cdatDateRangeMin\n            End If\n            If DateDiff(\"d\", DateAdd(\"d\", lngDiff, datDate), datLimit) = 0 Then\n                ' Limit of date range has been reached.\n                Exit Do\n            End If\n\n            lngDiff = lngDiff + lngSign\n            datDate2 = DateAdd(\"d\", lngDiff, datDate)\n            Select Case Weekday(datDate2)\n                Case vbSaturday, vbSunday\n                    ' Skip weekend.\n                Case Else\n                    ' Check for holidays to skip.\n                    ' Ignore error when using LBound and UBound on an unassigned array.\n                    On Error Resume Next\n                    For lngHoliday = LBound(aHolidays) To UBound(aHolidays)\n                        If Err.Number &gt; 0 Then\n                            ' No holidays between datDate and datDate1.\n                        ElseIf DateDiff(\"d\", datDate2, aHolidays(lngHoliday)) = 0 Then\n                            ' This datDate2 hits a holiday.\n                            ' Subtract one day before adding one after the loop.\n                            lngDays = lngDays - lngSign\n                            Exit For\n                        End If\n                    Next\n                    On Error GoTo 0\n                    lngDays = lngDays + lngSign\n            End Select\n        Loop\n    End If\n\n    DateAddWorkdays = datDate2\n\nEnd Function\n\nPublic Function GetHolidays( _\n    ByVal datDate1 As Date, _\n    ByVal datDate2 As Date, _\n    Optional ByVal booDesc As Boolean) _\n    As Date()\n\n'   Finds the count of holidays between datDate1 and datDate2.\n'   The holidays are returned as an array of dates.\n'   DAO objects are declared static to speed up repeated calls with identical date parameters.\n'   2014-10-03. Cactus Data ApS, CPH\n\n    ' The table that holds the holidays.\n    Const cstrTable             As String = \"tblHoliday\"\n    ' The field of the table that holds the dates of the holidays.\n    Const cstrField             As String = \"HolidayDate\"\n    ' Constants for the arrays.\n    Const clngDimRecordCount    As Long = 2\n    Const clngDimFieldOne       As Long = 0\n\n    Static dbs              As DAO.Database\n    Static rst              As DAO.Recordset\n\n    Static datDate1Last     As Date\n    Static datDate2Last     As Date\n\n    Dim adatDays()  As Date\n    Dim avarDays    As Variant\n\n    Dim strSQL      As String\n    Dim strDate1    As String\n    Dim strDate2    As String\n    Dim strOrder    As String\n    Dim lngDays     As Long\n\n    If DateDiff(\"d\", datDate1, datDate1Last) &lt;&gt; 0 Or DateDiff(\"d\", datDate2, datDate2Last) &lt;&gt; 0 Then\n        ' datDate1 or datDate2 has changed since the last call.\n        strDate1 = Format(datDate1, \"\\#yyyy\\/mm\\/dd\\#\")\n        strDate2 = Format(datDate2, \"\\#yyyy\\/mm\\/dd\\#\")\n        strOrder = Format(booDesc, \"\\A\\s\\c;\\D\\e\\s\\c\")\n\n        strSQL = \"Select \" &amp; cstrField &amp; \" From \" &amp; cstrTable &amp; \" \" &amp; _\n            \"Where \" &amp; cstrField &amp; \" Between \" &amp; strDate1 &amp; \" And \" &amp; strDate2 &amp; \" \" &amp; _\n            \"Order By 1 \" &amp; strOrder\n\n        Set dbs = CurrentDb\n        Set rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)\n\n        ' Save the current set of date parameters.\n        datDate1Last = datDate1\n        datDate2Last = datDate2\n    End If\n\n    lngDays = rst.RecordCount\n    If lngDays = 0 Then\n        ' Leave adatDays() as an unassigned array.\n    Else\n        ReDim adatDays(lngDays - 1)\n        ' As repeated calls may happen, do a movefirst.\n        rst.MoveFirst\n        avarDays = rst.GetRows(lngDays)\n        ' rst is now positioned at the last record.\n        For lngDays = LBound(avarDays, clngDimRecordCount) To UBound(avarDays, clngDimRecordCount)\n            adatDays(lngDays) = avarDays(clngDimFieldOne, lngDays)\n        Next\n    End If\n\n    ' DAO objects are static.\n    ' Set rst = Nothing\n    ' Set dbs = Nothing\n\n    GetHolidays = adatDays()\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5924, "user_id": 636987, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/080dab36cef0f86aa173256c277152e6?s=128&d=identicon&r=PG", "display_name": "Mus", "link": "https://stackoverflow.com/users/636987/mus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1714, "favorite_count": 0, "accepted_answer_id": 30349067, "answer_count": 2, "score": 0, "last_activity_date": 1432911819, "creation_date": 1432121821, "last_edit_date": 1432910395, "question_id": 30348540, "link": "https://stackoverflow.com/questions/30348540/count-x-amount-of-working-days-from-date-entered", "title": "Count X Amount of Working Days from Date Entered", "body": "<p>I have a Microsoft Access database where the user is required to enter a <code>Date Opened:</code> value.  Once entered, this triggers a calculation in another field, <code>Deadline (25 WD):</code>.  This works via the following function in the latter field:</p>\n\n<pre><code>=DateAdd(\"d\",25,[Date opened])\n</code></pre>\n\n<p>What I want to do, however, is to count 25 <strong>working</strong> days from the date entered in <code>Date Opened:</code>.  I have a table <code>holidays</code> which contains a list of UK holidays up until 2020.</p>\n\n<p>How can I merge to two, so-to-speak, in order to produce a valid <code>Deadline (25 WD):</code> value which does not count any of the dates listed in <code>holidays</code>?</p>\n\n<p>For example, if the date entered is 01/01/2015, then the function would count 25 working days from 01/01/2015, meaning that it would exclude all weekends and any bank holidays that fall within that period and <strong>the resulting date value in the field <code>Deadline (25 WD)</code> will also be a working day (i.e. not a weekend or bank holiday)</strong>.</p>\n"}, {"tags": ["database", "ms-access", "vba", "checkboxlist"], "answers": [{"tags": [], "owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1432122210, "creation_date": 1432122210, "answer_id": 30348691, "question_id": 30348245, "link": "https://stackoverflow.com/questions/30348245/how-to-automatically-delete-rows-when-all-checkboxes-are-checked-in-microsoft-ac/30348691#30348691", "title": "how to automatically delete rows when all checkboxes are checked in microsoft access database?", "body": "<p>Forgive me if I'm off base, but from your description it sounds like you should reconsider your table structure.  As of right now you are limiting yourself to these 10 check boxes per employee. What if the company changes their training, or adds more training.  Look into table Normalization.  Maybe add a table that consists of employeeID, TrainingID, and check box for complete or not. They can be populated when the user is created or new trainings are added or removed, but you'd be able to add as many records as needed if the training number or method changes.\nI would also make the suggestion that it is best practice to not delete records such as these from your table. Instead use some type of identifier for Active or not. This also eliminates your need to insert a record into another table when you delete a record from this one. This type of procedure is usually unnecessary and complicates what should be changing a simple Boolean from true to false.</p>\n"}, {"tags": [], "owner": {"reputation": 868, "user_id": 1321707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e64dedac8fa02cae04b5c29e520925d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1321707/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1432127711, "last_edit_date": 1432127711, "creation_date": 1432122632, "answer_id": 30348847, "question_id": 30348245, "link": "https://stackoverflow.com/questions/30348245/how-to-automatically-delete-rows-when-all-checkboxes-are-checked-in-microsoft-ac/30348847#30348847", "title": "how to automatically delete rows when all checkboxes are checked in microsoft access database?", "body": "<p>For the time being you could make a string by concatenating the values of the checkboxes and check whether the value corresponds to your criteria (abs the value in order to get 1 instead of -1)\ne.g. </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>checkCompletion = chk1 &amp; chk2 &amp; chk3 '(1 &amp; 1 &amp; 1 = \"111\")\n\nIf checkCompletion = \"111\" Then\n    'Do Something\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4890854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kX14x.png?s=128&g=1", "display_name": "imstuck", "link": "https://stackoverflow.com/users/4890854/imstuck"}, "edited": false, "score": 0, "creation_date": 1432146694, "post_id": 30350091, "comment_id": 48807187, "body": "Newd, John, thank you very much for your replies. I&#39;m still a newbie, but your explanation really helpful in so many ways. I will be back if I get stuck. once again, thank you!"}], "tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 1, "last_activity_date": 1432126656, "last_edit_date": 1432126656, "creation_date": 1432125967, "answer_id": 30350091, "question_id": 30348245, "link": "https://stackoverflow.com/questions/30348245/how-to-automatically-delete-rows-when-all-checkboxes-are-checked-in-microsoft-ac/30350091#30350091", "title": "how to automatically delete rows when all checkboxes are checked in microsoft access database?", "body": "<p>You will need to add a function onto each <code>After Update</code> even on all of the checkboxes.  That event will call a function that you need to create which will check to see if all checkboxes have been check. </p>\n\n<p>The function will look fairly close to what John had mentioned, however you will need to expand on it to check all ten boxes, if all are checked run an update query for your <code>CSA_Lisence</code> and then run a delete query for your <code>Development</code> table.  So something like this in to check the status of the training:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function CheckCompletion() As Boolean\n\n    Dim blnComplete As Boolean \n    Dim strCompletionSummary as String \n\n    strCompletionSummary = chk1 &amp; chk2 &amp; chk3 &amp; chk4 &amp; chk5 'etc\n\n    If strCompletionSummary = \"11111\" Then \n        blnComplete = True\n    Else \n        blnComplete = False\n    End If \n\nEnd Function\n</code></pre>\n\n<p>Then on your <code>AfterUpdate</code> event you could call a function that handles if all of the boxes are checked, something like this:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function UpdateEmployee() \n\n    If CheckCompletion Then \n        'Run Update Query\n        'Run Delete Query\n    End If \n\nEnd Function\n</code></pre>\n\n<p>Then you would have something like this in every checkbox's update event: \n</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub chk1_AfterUpdate()\n    Call UpdateEmployee()\nEnd Sub\n</code></pre>\n\n<p>But you also need to know that at Stack Overflow isn't really a place where you can go to get people to write code for you so I have only provided you with a skeleton structure to start with.  So you will need to do some research for how to accomplish this and attempt it yourself.  But if you ever get stuck that is what we are here for :-)</p>\n"}], "owner": {"reputation": 13, "user_id": 4890854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kX14x.png?s=128&g=1", "display_name": "imstuck", "link": "https://stackoverflow.com/users/4890854/imstuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "closed_date": 1432275825, "answer_count": 3, "score": 0, "last_activity_date": 1432129830, "creation_date": 1432121054, "last_edit_date": 1432129830, "question_id": 30348245, "link": "https://stackoverflow.com/questions/30348245/how-to-automatically-delete-rows-when-all-checkboxes-are-checked-in-microsoft-ac", "closed_reason": "Needs more focus", "title": "how to automatically delete rows when all checkboxes are checked in microsoft access database?", "body": "<p>I'm on my way on creating a simple Database for a company. This database contains several tables, one of the tables will record information about the training that had been completed by each employee. There are about ten sections of training that should be completed.</p>\n\n<p>I plan to put these sections into checkboxes to make it easier for the admins to see which sections the employee has been finished, and which sections the employee hasn't finished yet.</p>\n\n<p>I have already made the table and it consists of employees' basic information such as ID, name, and these checkboxes. However I need to create a system that manages whenever all the checkboxes have been checked. </p>\n\n<p>I need it so once all checkboxes for an employee have been checked the information of this employee to be automatically deleted from the table. At the same time I need some contents automatically inserted to another table.</p>\n\n<p>For example, there are two tables : <code>Development</code> and <code>CSA_Lisence</code>. <code>Development</code> is the table containing checkboxes and <code>CSA_Lisence</code> is the table that automatically updated when the checkboxes on <code>Development</code>  are fully checked. I don't know how to do this, how to code this on my VBA.</p>\n"}, {"tags": ["vba", "excel", "solver"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4920028, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Az45BrrV73E/AAAAAAAAAAI/AAAAAAAAAEU/8HCDCf6aUY0/photo.jpg?sz=128", "display_name": "Nicola Torrisi", "link": "https://stackoverflow.com/users/4920028/nicola-torrisi"}, "edited": false, "score": 0, "creation_date": 1432195942, "post_id": 30353534, "comment_id": 48826738, "body": "That&#39;s a good tip, I&#39;ve tried to catch the value of <code>SolverSolve</code> and the value is at the first run ( the one that ends before of the time) is   0  Solver found a solution. All constraints and optimality conditions are satisfied.    When I click the <code>CommandButton</code> I get  1 Solver has converged to the current solution. All constraints are satisfied.  I still have no clue of why this is happening, any thoughts?"}], "tags": [], "owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "is_accepted": false, "score": 1, "last_activity_date": 1432134218, "creation_date": 1432134218, "answer_id": 30353534, "question_id": 30347936, "link": "https://stackoverflow.com/questions/30347936/excel-solver-ends-before-finding-a-solution-vba/30353534#30353534", "title": "Excel Solver ends before finding a solution - VBA", "body": "<p>A first step would be to catch the return value from <code>SolverSolve</code>.  This would allow you to determine why it ended.  </p>\n\n<pre><code>Sub NSCoeff()\n    Dim current_wb As Workbook\n    Dim ret As Integer\n\n    Set current_wb = ThisWorkbook\n\n    current_wb.Sheets(\"Nelson_Siegel\").Activate\n\n    SolverOk SetCell:=\"$N$9\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$N$4:$S$4\", _\n        Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverAdd CellRef:=\"$N$4\", Relation:=3, FormulaText:=\"0.001\"\n    SolverAdd CellRef:=\"$S$4\", Relation:=3, FormulaText:=\"0.001\"\n    ret = SolverSolve userFinish:=True\n    MsgBox \"SolverSolve returned a value of \" &amp; ret\nEnd Sub\n</code></pre>\n\n<p>Then you can consult <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff197237.aspx\" rel=\"nofollow\">Microsoft's Website</a> to determine why the solver decided to exit.</p>\n\n<p>From there, you can use that information to determine how to proceed to.</p>\n"}], "owner": {"reputation": 19, "user_id": 4920028, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Az45BrrV73E/AAAAAAAAAAI/AAAAAAAAAEU/8HCDCf6aUY0/photo.jpg?sz=128", "display_name": "Nicola Torrisi", "link": "https://stackoverflow.com/users/4920028/nicola-torrisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432134218, "creation_date": 1432120197, "question_id": 30347936, "link": "https://stackoverflow.com/questions/30347936/excel-solver-ends-before-finding-a-solution-vba", "title": "Excel Solver ends before finding a solution - VBA", "body": "<p>I'm a starter user of VBA and I'm having some problem with Excel Solver.</p>\n\n<p>Basically I have to calculate the Fair Values of several financial instruments, grouped by the country of origins.</p>\n\n<p>For each country the solver will minimize a function in order to find the model parameters.</p>\n\n<p>So far I've been able to make it work and among 50 different countries/category the solver works in 49 cases.</p>\n\n<p>Here comes my problem, when it comes to this country the solvers steps out after 3 or 4 iterations. leaving the objective funciont far from been minimized.\nBut when I click on a commandbutton linked exactly to the same subroutine it finds a solution.</p>\n\n<p>Here is part of my code, NSCoeff is the sub linked to the solver.</p>\n\n<pre><code>Sub NelsonSiegel()\nDim a, b, c, d, e, f, g, p, s, I, t, v, pv, TIR As Variant\nDim NumBonds, bnd_cnt As Integer\nDim current_wb As String\nDim spot(), df, dfcf, NumberCashFlows, Lambda, Lambda2, Beta1, Beta2, Beta3, Beta4, TimeToCashFlow(), NSPV As Variant\nDim j As Integer\nDim Time() As Variant\nDim A1() As Variant\nDim A2() As Variant\nDim A3() As Variant\nDim A4() As Variant\ncurrent_wb = ThisWorkbook.Name\nNumBonds = Sheets(\"bonds\").Cells(1, 7).Value\n\nWorkbooks(current_wb).Sheets(\"Nelson_Siegel\").Range(\"n4:s4\").Value = 1\nNSCoeff\nWorkbooks(current_wb).Sheets(\"bonds\").Calculate 'download coupon date for NS procedure\n\nLambda = Worksheets(\"model\").Cells(28, 2)\nBeta1 = Worksheets(\"model\").Cells(29, 2)\nBeta2 = Worksheets(\"model\").Cells(30, 2)\nBeta3 = Worksheets(\"model\").Cells(31, 2)\nBeta4 = Worksheets(\"model\").Cells(32, 2)\nLambda2 = Worksheets(\"model\").Cells(33, 2)\n</code></pre>\n\n<p>and here the NSCoeff sub</p>\n\n<pre><code>Sub NSCoeff()\nDim current_wb As String\ncurrent_wb = ThisWorkbook.Name\n\n\nWorkbooks(current_wb).Sheets(\"Nelson_Siegel\").Activate\n\n    SolverOk SetCell:=\"$N$9\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$N$4:$S$4\", _\n        Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverAdd CellRef:=\"$N$4\", Relation:=3, FormulaText:=\"0.001\"\n    SolverAdd CellRef:=\"$S$4\", Relation:=3, FormulaText:=\"0.001\"\n    SolverOk SetCell:=\"$N$9\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$N$4:$S$4\", _\n        Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverOk SetCell:=\"$N$9\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$N$4:$S$4\", _\n        Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverSolve userFinish:=True\n</code></pre>\n\n<p>Any Idea on how to solve this problem? The solver doesn't find a solution when is launched from another subroutine but when it's lauched from a commandbutton it works.</p>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["vba", "find"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4919985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/730cc8d8f663cf86753aa8aa0d69823b?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/4919985/gio"}, "edited": false, "score": 0, "creation_date": 1432435036, "post_id": 30348201, "comment_id": 48924916, "body": "Thank you R3uK. I see the simpleness of this piece of code blows me away and it is rather elegant I have to say. this said I have some study and adaptation to substitute what I had going on with .find based code."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1432120941, "creation_date": 1432120941, "answer_id": 30348201, "question_id": 30347817, "link": "https://stackoverflow.com/questions/30347817/finding-from-non-sequential-columns/30348201#30348201", "title": "Finding from non-sequential columns", "body": "<p>Generally to use multiple criteria matching it is easier to use a loop like this :</p>\n\n<pre><code>DB = ThisWorkbook.Sheets(\"DB\").Range(\"Db_Val\").Value2\nDim A()\nReDim A(1, 0)\n\nFor i = LBound(DB, 1) To UBound(DB, 1)\n\n    If Factory &lt;&gt; DB(i, 1) Then\n    Else\n        If Product &lt;&gt; DB(i, 4) Then\n        Else\n            If Location &lt;&gt; DB(i, 6) Then\n            Else\n                A(0, UBound(A, 2)) = i\n                A(1, UBound(A, 2)) = DB(i, 2)\n                ReDim Preserve A(UBound(A, 1), UBound(A, 2) + 1)\n            End If\n        End If\n    End If\n\nNext i\n\nIf UBound(A, 2) &gt; 0 Then ReDim Preserve A(UBound(A, 1), UBound(A, 2) - 1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4919985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/730cc8d8f663cf86753aa8aa0d69823b?s=128&d=identicon&r=PG&f=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/4919985/gio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507091114, "creation_date": 1432119827, "last_edit_date": 1507091114, "question_id": 30347817, "link": "https://stackoverflow.com/questions/30347817/finding-from-non-sequential-columns", "title": "Finding from non-sequential columns", "body": "<p>I am a novice and trying to figure out an elegant strategy with VBA to find data from multiple, non-sequential columns with column specific criteria.</p>\n\n<p>Example: Find rows where the three column specific criteria are all a match (logical And):\nColumn A, criteria 1; Column D:, criteria 2, Column F: criteria 3.</p>\n\n<p>For sake of example let's assume Column A = Factory, Column D = Product, Column F = Location.</p>\n\n<p>This is pretty simple on sheet, but on VBA I am puzzled with .find, application union and so on.</p>\n"}, {"tags": ["excel", "vba", "formatting", "duplicates"], "answers": [{"tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1432120104, "creation_date": 1432120104, "answer_id": 30347907, "question_id": 30347737, "link": "https://stackoverflow.com/questions/30347737/highlighting-duplicates-based-on-data-within-the-same-column/30347907#30347907", "title": "Highlighting duplicates based on data within the same column", "body": "<p>At the moment I see one problem, you are referring to Activecell, However you never activate or select any cell nor range. This makes the color change on a cell that you have selected when running the macro and no other. If you replace activecell.row with variable i the macro should be working fine.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1432122149, "post_id": 30347962, "comment_id": 48789733, "body": "Will this not colour the entire row though? I only want to colour the cells up to row I  Actually in practice this just highlights column B, which I guess actually makes sense looking back at the macro"}], "tags": [], "owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "is_accepted": false, "score": 0, "last_activity_date": 1432123526, "last_edit_date": 1432123526, "creation_date": 1432120268, "answer_id": 30347962, "question_id": 30347737, "link": "https://stackoverflow.com/questions/30347737/highlighting-duplicates-based-on-data-within-the-same-column/30347962#30347962", "title": "Highlighting duplicates based on data within the same column", "body": "<p>You are always setting <code>rng3</code> to the same cells, because you never change the active cell. Also, you don't really need to have an extra range because you are already looping through the cells.</p>\n\n<pre><code>Sub Duplicate()\n\n Dim rng1 As Range, rng2 As Range, rng3 As Range, i As Long, j As Long\n Dim w1 As Worksheet\n Set w1 = Worksheets(\"Sheet1\")\n For i = 1 To w1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    Set rng1 = w1.Range(\"B\" &amp; i)\n    For j = 1 To w1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        If j &lt;&gt; i Then\n          Set rng2 = w1.Range(\"B\" &amp; j)\n          If StrComp(Trim(rng1.Text), Trim(rng2.Text), vbTextCompare) = 0 Then\n             rng1.Interior.Color = RGB(168, 188, 255)\n             rng2.Interior.Color = RGB(168, 188, 255)\n          End If\n          Set rng2 = Nothing\n        End If\n    Next j\n    Set rng1 = Nothing\n Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1432121580, "post_id": 30348067, "comment_id": 48789299, "body": "This will be run in conjunction with a series of other macros, with the idea in mind of eliminating as many clicks as possible from the current system, so ideally I&#39;d prefer it to run within a VBA macro"}, {"owner": {"reputation": 85, "user_id": 3911007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g3t7B.jpg?s=128&g=1", "display_name": "Andy Herd", "link": "https://stackoverflow.com/users/3911007/andy-herd"}, "reply_to_user": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "edited": false, "score": 0, "creation_date": 1432130914, "post_id": 30348067, "comment_id": 48796587, "body": "@Chris Ok. But if you use native XL functionality then you won&#39;t even need a single click to start the macro... clicks=eliminated!"}], "tags": [], "owner": {"reputation": 85, "user_id": 3911007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g3t7B.jpg?s=128&g=1", "display_name": "Andy Herd", "link": "https://stackoverflow.com/users/3911007/andy-herd"}, "is_accepted": false, "score": 0, "last_activity_date": 1432120561, "creation_date": 1432120561, "answer_id": 30348067, "question_id": 30347737, "link": "https://stackoverflow.com/questions/30347737/highlighting-duplicates-based-on-data-within-the-same-column/30348067#30348067", "title": "Highlighting duplicates based on data within the same column", "body": "<p>Does this have to be within VBA? The conditional formatting feature in Excel can do this without having to rely on a macro. This should also refresh faster than running the VBA. For this you have to rely on relative references within the conditional formatting, which are relative to the activecell at the time you set up the rule.</p>\n\n<ol>\n<li>Select your data from A:I</li>\n<li>Conditional formatting> new rule</li>\n<li>Select 'use a formula to determine which cells to format'</li>\n<li>Use the formula <code>=COUNTIF($B$1:$B$6,$B1)&gt;1</code>, replacing the first variable with your entire range in column B. The single dollar sign on reference <code>$B1</code> is very important as it tells it to check column B regardless of which column the formatting is being applied to.</li>\n</ol>\n"}], "owner": {"reputation": 35, "user_id": 4819061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/07c819c65c2d9640387ff63e810194a9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/4819061/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1442056527, "creation_date": 1432119626, "last_edit_date": 1442056527, "question_id": 30347737, "link": "https://stackoverflow.com/questions/30347737/highlighting-duplicates-based-on-data-within-the-same-column", "title": "Highlighting duplicates based on data within the same column", "body": "<p>I'm trying to create a macro that searches the B column to find duplicates of the same string, and then highlights said duplicates from columns A to I </p>\n\n<p>I've managed to create something that highlights the correct cells but does not seem to be able to find the duplicates. Not entirely sure where I've gone wrong but I think it could be because I'm adapting a former macro that looked across two sheets</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Duplicate()\n\nDim rng1 As Range, rng2 As Range, rng3 As Range, i As Long, j As Long\nDim w1 As Worksheet\nSet w1 = Worksheets(\"Sheet1\")\nFor i = 1 To w1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    Set rng1 = w1.Range(\"B\" &amp; i)\n    For j = 1 To w1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        Set rng2 = w1.Range(\"B\" &amp; j)\n        Set rng3 = w1.Range(Cells(ActiveCell.Row, 1), Cells(ActiveCell.Row, 9))\n        If StrComp(Trim(rng1.Text), Trim(rng2.Text), vbTextCompare) = 0 Then\n            rng3.Interior.Color = RGB(168, 188, 255)\n        End If\n        Set rng2 = Nothing\n    Next j\n    Set rng1 = Nothing\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "answers": [{"comments": [{"owner": {"reputation": 918, "user_id": 1378651, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/96278ad40181cc4a376ac1e8b0ebde01?s=128&d=identicon&r=PG", "display_name": "Tensigh", "link": "https://stackoverflow.com/users/1378651/tensigh"}, "edited": false, "score": 0, "creation_date": 1432121991, "post_id": 30347689, "comment_id": 48789612, "body": "Thank you! I forgot about opening the files. Rather obvious, really. I&#39;m new to VBA, I&#39;m more of a Python guy. Thanks!"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1432123538, "post_id": 30347689, "comment_id": 48790708, "body": "In this case It&#39;s not a good practice to use the <i>Sheets.Index</i>, since you already know the name of the Sheets to print I suggest to use their Names instead of the index. Create an array with the names and For Next the array"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1432123775, "post_id": 30347689, "comment_id": 48790874, "body": "@EEM: I gave the 2nd option and mentioned what it does. Since OP said &quot;first 2 sheets&quot;, I gave that as an alternative :)"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1432123922, "post_id": 30347689, "comment_id": 48790969, "body": "User also mentioned: <i>&quot;The names of the worksheets will be constant so this shouldn&#39;t be too hard.&quot;</i>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1432123950, "post_id": 30347689, "comment_id": 48790994, "body": "@EEM: Tru and hence the first option :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1432119861, "last_edit_date": 1432119861, "creation_date": 1432119520, "answer_id": 30347689, "question_id": 30347544, "link": "https://stackoverflow.com/questions/30347544/loop-through-directory-open-workbook-print-selected-worksheets/30347689#30347689", "title": "Loop through directory, open workbook, print selected worksheets", "body": "<p>I see two problems</p>\n\n<ol>\n<li>Where are you opening the workbook?</li>\n<li>You need to move <code>StrFile = Dir</code> just before the <code>Loop</code>. With this command you are telling it to find the next file.</li>\n</ol>\n\n<p>Try this (<strong>UNTESTED</strong>)</p>\n\n<pre><code>Sub Loop2()\n    Dim StrFile As String\n    Dim WSCount As Integer\n    Dim sh As Worksheet\n    Dim wb As Workbook\n\n    StrFile = Dir(\"c:\\temp\\*.xls*\")\n\n    Do While Len(StrFile) &gt; 0\n        Set wb = Workbooks.Open(\"c:\\temp\\\" &amp; StrFile)\n\n        For Each sh In wb.Worksheets\n            If (sh.Name &lt;&gt; \"Credits\") Then\n                sh.PrintOut\n                DoEvents\n            End If\n        Next sh\n\n        wb.Close (False)\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>And if you want to print the first 2 sheets as mentioned in your question then do this. This will not check the name of the worksheets</p>\n\n<pre><code>Sub Loop2()\n    Dim StrFile As String\n    Dim WSCount As Integer\n    Dim wb As Workbook\n\n    StrFile = Dir(\"c:\\temp\\*.xls*\")\n\n    Do While Len(StrFile) &gt; 0\n        Set wb = Workbooks.Open(\"c:\\temp\\\" &amp; StrFile)\n\n        wb.Sheets(1).PrintOut\n        DoEvents\n        wb.Sheets(2).PrintOut\n\n        wb.Close (False)\n        StrFile = Dir\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 918, "user_id": 1378651, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/96278ad40181cc4a376ac1e8b0ebde01?s=128&d=identicon&r=PG", "display_name": "Tensigh", "link": "https://stackoverflow.com/users/1378651/tensigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 30347689, "answer_count": 1, "score": 1, "last_activity_date": 1432119861, "creation_date": 1432119158, "last_edit_date": 1432119767, "question_id": 30347544, "link": "https://stackoverflow.com/questions/30347544/loop-through-directory-open-workbook-print-selected-worksheets", "title": "Loop through directory, open workbook, print selected worksheets", "body": "<p>I have about 50 workbooks that have 3 worksheets, and I need to print the first 2. The names of the worksheets will be constant so this shouldn't be too hard.</p>\n\n<p>I wrote the following in VBA and it doesn't error out but my printer doesn't print anything. What am I missing?</p>\n\n<pre><code>Sub Loop2()\n    Dim StrFile As String\n    Dim WSCount As Integer\n    Dim sh As Worksheet\n\n    StrFile = Dir(\"c:\\temp\\*.xls*\")\n    Do While Len(StrFile) &gt; 0\n        Debug.Print StrFile\n        StrFile = Dir\n\n        For Each sh In ActiveWorkbook.Worksheets\n\n           If (sh.Name &lt;&gt; \"Credits\") Then\n\n               sh.PrintOut\n\n           End If\n        Next sh\n    Loop\nEnd Sub\n</code></pre>\n\n<p>If I use a <code>MsgBox</code> as scaffolding I do get the files and their worksheets, but no printing. </p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 274, "user_id": 4872561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9ed7fc4936f96dd6edfcfdc1d05c24?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/4872561/abe"}, "edited": false, "score": 0, "creation_date": 1432654441, "post_id": 30346829, "comment_id": 49006289, "body": "Can you explain a little bit more the structure you have? How do you refresh this XML list, by code or on the excel refresh button? Are you accepting vba solutions for that?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1432747394, "post_id": 30346829, "comment_id": 49056623, "body": "I&#39;d recommend an on change event that triggers when you make a change to Sheet1 (refreshing the e-mail list) which checks it against Sheet2.  When an anomaly is found, execute the line delete or line add accordingly."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1433318614, "post_id": 30346829, "comment_id": 49295057, "body": "I have given full working answer."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 1351226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c07953cbbad36459b15d82b0e94ad5ff?s=128&d=identicon&r=PG", "display_name": "cbarlow123", "link": "https://stackoverflow.com/users/1351226/cbarlow123"}, "edited": false, "score": 0, "creation_date": 1433766649, "post_id": 30464303, "comment_id": 49475634, "body": "This looks great, I&#39;ve tried it and got your example working. If I have multiple columns, not just Name,  such as DOB, Address 1 and Address 2. How can I ensure that all columns get copied backwards and forwards between Data and Aux sheets."}, {"owner": {"reputation": 274, "user_id": 4872561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9ed7fc4936f96dd6edfcfdc1d05c24?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/4872561/abe"}, "reply_to_user": {"reputation": 207, "user_id": 1351226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c07953cbbad36459b15d82b0e94ad5ff?s=128&d=identicon&r=PG", "display_name": "cbarlow123", "link": "https://stackoverflow.com/users/1351226/cbarlow123"}, "edited": false, "score": 0, "creation_date": 1433786492, "post_id": 30464303, "comment_id": 49489480, "body": "Hello, I have edited the code doing a small change on the FormulaR1C1 section, switchin C[-1] to C1, this will ensure the VLookUp formula will work if you have more than 2 columns. Also, if you want this to work, just be sure all data is inside the table, so that @address will point to the column that fills your e-mail addresses. The formulas using xlUp and xlToRight will work out the column number changing and the row number changing for you automatically."}], "tags": [], "owner": {"reputation": 274, "user_id": 4872561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9ed7fc4936f96dd6edfcfdc1d05c24?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/4872561/abe"}, "is_accepted": true, "score": 2, "last_activity_date": 1433786325, "last_edit_date": 1433786325, "creation_date": 1432658466, "answer_id": 30464303, "question_id": 30346829, "link": "https://stackoverflow.com/questions/30346829/excel-xml-data-feed-making-row-data-out-of-line/30464303#30464303", "title": "Excel XML data feed making row data out of line", "body": "<p>First of all, since there is lack of information, I will assume a scenario to work from and try to achieve what you need. You might have to change the code a little to fit your needs, but this gives you a base to work.</p>\n\n<p>Since your XML feed does not contain additional data, the table containing the e-mail addresses will not add rows to the rest of the table as you want. My suggestion is that you use vba code to do the job for you.</p>\n\n<p>Assuming you have the following xml file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Email&gt;\n    &lt;address&gt;teste@teste.com&lt;/address&gt;\n    &lt;address&gt;teste1@teste.com&lt;/address&gt;\n    &lt;address&gt;teste2@teste.com&lt;/address&gt;\n    &lt;address&gt;teste3@teste.com&lt;/address&gt;\n    &lt;address&gt;teste4@teste.com&lt;/address&gt;\n    &lt;address&gt;teste6@teste.com&lt;/address&gt;\n&lt;/Email&gt;\n</code></pre>\n\n<p>Using the following code will generate a table on the worksheet:</p>\n\n<pre><code>Const xmlFileUrl As String = \"c:\\filePath\\note.xml\"\nSub ClearXmlMaps()\n\n    Dim existingXmlMap As XmlMap\n\n    For Each existingXmlMap In ActiveWorkbook.XmlMaps\n\n       existingXmlMap.Delete\n\n    Next existingXmlMap\n\nEnd Sub\n\nSub CreateMailList()\n\n    Dim xmlTable As XmlMap\n\n    ClearXmlMaps\n\n    Application.WindowState = xlNormal\n    ActiveWorkbook.XmlImport URL:=xmlFileUrl, ImportMap:=Nothing, Overwrite:=True, Destination:=Range(\"$A$1\")\n\n    Set xmlTable = ActiveWorkbook.XmlMaps(1)\n\n    xmlTable.Name = \"EmailList\"\n\nEnd Sub\n</code></pre>\n\n<p>The code generated the red squared part of the table below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/lhv0j.jpg\" alt=\"XMLTable\"></p>\n\n<p>And I have added a new column called \"Name\". Now suppose I want to refresh my XML feed without clearing all information on the column name. For that, I will use an auxiliary sheet (my main sheet here is the \"Data\" and the auxiliary is the \"Aux\" sheet) to copy all data, refresh the feed, and finally, refill my table with the last state by using the VLOOKUP command, such as below:</p>\n\n<pre><code>Sub RefreshEmailList()\n\n    Dim existingXmlMap As XmlMap\n    Dim dataSheet As Worksheet\n    Dim auxSheet As Worksheet\n\n    Set dataSheet = ThisWorkbook.Worksheets(\"Data\")\n    Set auxSheet = ThisWorkbook.Worksheets(\"Aux\")\n\n    dataSheet.Cells.Copy auxSheet.Cells(1, 1)\n\n    auxSheet.Range(auxSheet.Cells(1, 1), auxSheet.Cells(auxSheet.Cells(auxSheet.Rows.Count, 1).End(xlUp).Row, auxSheet.Cells(1, auxSheet.Columns.Count).End(xlToLeft).Column)).Value = auxSheet.Range(auxSheet.Cells(1, 1), auxSheet.Cells(auxSheet.Cells(auxSheet.Rows.Count, 1).End(xlUp).Row, auxSheet.Cells(1, auxSheet.Columns.Count).End(xlToLeft).Column)).Value\n\n\n    dataSheet.Range(dataSheet.Cells(2, 2), dataSheet.Cells(dataSheet.Cells(dataSheet.Rows.Count, 1).End(xlUp).Row, dataSheet.Cells(1, dataSheet.Columns.Count).End(xlToLeft).Column)).Clear\n\n    For Each existingXmlMap In ThisWorkbook.XmlMaps\n\n        If existingXmlMap.Name = \"EmailList\" Then\n\n            ActiveWorkbook.XmlMaps(\"EmailList\").DataBinding.Refresh\n\n        End If\n\n    Next existingXmlMap\n\n    dataSheet.Range(dataSheet.Cells(2, 2), dataSheet.Cells(dataSheet.Cells(dataSheet.Rows.Count, 1).End(xlUp).Row, dataSheet.Cells(1, dataSheet.Columns.Count).End(xlToLeft).Column)).FormulaR1C1 = \"=IFERROR(IF(VLOOKUP([@address],Aux!C1:C,COLUMN(),FALSE) = 0 , \"\"\"\", VLOOKUP([@address],Aux!C1:C,COLUMN(),FALSE)), \"\"\"\")\"\n    dataSheet.Range(dataSheet.Cells(2, 2), dataSheet.Cells(dataSheet.Cells(dataSheet.Rows.Count, 1).End(xlUp).Row, dataSheet.Cells(1, dataSheet.Columns.Count).End(xlToLeft).Column)).Value = dataSheet.Range(dataSheet.Cells(2, 2), dataSheet.Cells(dataSheet.Cells(dataSheet.Rows.Count, 1).End(xlUp).Row, dataSheet.Cells(1, dataSheet.Columns.Count).End(xlToLeft).Column)).Value\n\n\nEnd Sub\n</code></pre>\n\n<p>If you change the xml file to the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Email&gt;\n    &lt;address&gt;teste@teste.com&lt;/address&gt;\n    &lt;address&gt;teste1@teste.com&lt;/address&gt;\n    &lt;address&gt;teste2@teste.com&lt;/address&gt;\n    &lt;address&gt;teste3@teste.com&lt;/address&gt;\n    &lt;address&gt;teste4@teste.com&lt;/address&gt;\n    &lt;address&gt;teste5@teste.com&lt;/address&gt;\n    &lt;address&gt;teste6@teste.com&lt;/address&gt;\n&lt;/Email&gt;\n</code></pre>\n\n<p>And then run the RefreshEmailList() subroutine, you will get the result below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/cPXD3.jpg\" alt=\"FinalXmlFeedResult\"></p>\n\n<p>The solution above works for adding or removing rows, but you should be aware of two things:</p>\n\n<ul>\n<li>Refreshing the XML Feed using the refresh button will not trigger the event</li>\n<li>This solution does not keep old states, which means that, if one e-mail is removed and then re-added, information about that user might be lost.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2738, "user_id": 170275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccde89366ca85d1f32e04f736302298c?s=128&d=identicon&r=PG", "display_name": "dendarii", "link": "https://stackoverflow.com/users/170275/dendarii"}, "is_accepted": false, "score": 0, "last_activity_date": 1432731278, "creation_date": 1432731278, "answer_id": 30483108, "question_id": 30346829, "link": "https://stackoverflow.com/questions/30346829/excel-xml-data-feed-making-row-data-out-of-line/30483108#30483108", "title": "Excel XML data feed making row data out of line", "body": "<p>Instead of automatically refreshing the column, you could put the incoming data into a \"holding area\" (either a separate worksheet, or an array depending on which you're more comfortable with). </p>\n\n<p>Then you could compare the two lists to check for new email addresses (add them to the end of the existing data) or email addresses that no longer exist in the incoming data (delete the rows from existing data).</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 3449173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k1WbA.png?s=128&g=1", "display_name": "Nordik", "link": "https://stackoverflow.com/users/3449173/nordik"}, "is_accepted": false, "score": 0, "last_activity_date": 1432891283, "last_edit_date": 1432891283, "creation_date": 1432890772, "answer_id": 30525646, "question_id": 30346829, "link": "https://stackoverflow.com/questions/30346829/excel-xml-data-feed-making-row-data-out-of-line/30525646#30525646", "title": "Excel XML data feed making row data out of line", "body": "<p>To <strong>insert</strong> a new row (and shift every column down) you may use this VBA code:</p>\n\n<pre><code>ActiveCell.EntireRow.Insert xlShiftDown\n</code></pre>\n\n<p>with ActiveCell being a cell (range) in the row where the new one should appear: if you need to add 5th empty row ActiveCell.Row should be = 5.</p>\n\n<p>To <strong>delete</strong> entire row the code will be:</p>\n\n<pre><code>ActiveCell.EntireRow.Delete xlShiftUp\n</code></pre>\n\n<p>with ActiveCell being a cell (range) in the row to delete</p>\n"}], "owner": {"reputation": 207, "user_id": 1351226, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c07953cbbad36459b15d82b0e94ad5ff?s=128&d=identicon&r=PG", "display_name": "cbarlow123", "link": "https://stackoverflow.com/users/1351226/cbarlow123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 0, "accepted_answer_id": 30464303, "answer_count": 3, "score": 5, "last_activity_date": 1433786325, "creation_date": 1432117212, "last_edit_date": 1432653612, "question_id": 30346829, "link": "https://stackoverflow.com/questions/30346829/excel-xml-data-feed-making-row-data-out-of-line", "title": "Excel XML data feed making row data out of line", "body": "<p>I have an XML feed that is drawing a list of email addresses sorted in alphabetical order into Sheet 1</p>\n\n<p>In Sheet 2 I have the list of email addresses in column 1 and then several other columns with user information. </p>\n\n<p>When I refresh the data and a new email is added to the list, the list of email addresses in column 1 is shifted down and therefore the data in the other columns is out of line. Is there anyway I can insert a new row and shift all data down in all the columns if and when a new address is added into column 1. Similarly, remove a line of data if the email is removed from the feed.</p>\n\n<p>I know this is really meant to be in a database but I don't have that option. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1432117442, "post_id": 30346682, "comment_id": 48786520, "body": "You can&#39;t use <code>Dim elements()</code> .Change the name of your array and it will work.  Use <code>Dim Myelements</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1432117614, "post_id": 30346682, "comment_id": 48786646, "body": "@genespos: No it is not a reserved name :)"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1432117620, "post_id": 30346682, "comment_id": 48786651, "body": "@genespos that&#39;s just a mock name I&#39;ve used for sampling, but the real variable name is sure not a reserved one. But for sake of clarity I&#39;m going to edit my question, thank you for the remark."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432117686, "post_id": 30346682, "comment_id": 48786699, "body": "@MatteoNNZ: Make that small change that I suggested and it will work :)"}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1432117687, "post_id": 30346682, "comment_id": 48786700, "body": "Sorry... :( the problem was in the &quot;()&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1432117767, "post_id": 30346906, "comment_id": 48786770, "body": "Thanks a lot Siddhart, it works as a charme. Would you mind explaining me why? I mean, what I get in the variable is not an array?"}, {"owner": {"reputation": 6392, "user_id": 1252228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wOcT1.png?s=128&g=1", "display_name": "Pradeep Kumar", "link": "https://stackoverflow.com/users/1252228/pradeep-kumar"}, "edited": false, "score": 2, "creation_date": 1432121771, "post_id": 30346906, "comment_id": 48789440, "body": "++ Wish you were my teacher when I was learning VBA... LOL. You would have explained everything so nicely.. For FREE :D"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 6392, "user_id": 1252228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wOcT1.png?s=128&g=1", "display_name": "Pradeep Kumar", "link": "https://stackoverflow.com/users/1252228/pradeep-kumar"}, "edited": false, "score": 0, "creation_date": 1432121899, "post_id": 30346906, "comment_id": 48789542, "body": "Stop embarrassing me @PradeepKumar. :D"}, {"owner": {"reputation": 6392, "user_id": 1252228, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/wOcT1.png?s=128&g=1", "display_name": "Pradeep Kumar", "link": "https://stackoverflow.com/users/1252228/pradeep-kumar"}, "edited": false, "score": 1, "creation_date": 1432122098, "post_id": 30346906, "comment_id": 48789685, "body": "Heh Heh. No, Seriously, I like the way you take the time to explain. BTW Congrats on 70k ;)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432122134, "post_id": 30346906, "comment_id": 48789724, "body": "Damn I didn&#39;t realize! Thanky Thanky :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 5, "last_activity_date": 1432121362, "last_edit_date": 1432121362, "creation_date": 1432117441, "answer_id": 30346906, "question_id": 30346682, "link": "https://stackoverflow.com/questions/30346682/getting-full-split-array-into-a-vba-variable/30346906#30346906", "title": "Getting full Split array into a VBA variable", "body": "<p>Change <code>Dim elements()</code> to <code>Dim elements As Variant</code></p>\n\n<p>You need to declare it as a Variant.</p>\n\n<p><strong>Explanation</strong>:</p>\n\n<p>The data in Excel cell can be anything. So use a <code>Variant</code>. In cases like below, you know it is a <code>String</code> so declare it like a <code>String</code></p>\n\n<pre><code>Sub Sample()\n    Dim myElements() As String\n    Dim myString As String\n\n    myString = \"aaa/bbb/ccc\"\n\n    myElements = Split(myString, \"/\")\n\n    Debug.Print myElements(0)\n    Debug.Print myElements(1)\n    Debug.Print myElements(2)\nEnd Sub\n</code></pre>\n\n<p><code>Split</code> returns a <code>String Array</code>. You may want to see <a href=\"https://support.microsoft.com/en-us/kb/266289\" rel=\"nofollow\">This</a></p>\n\n<p><strong>Edit</strong>: I have a feeling that I may confuse someone with my explanation so let me explain it a bit more.</p>\n\n<p><code>Dim myElements()</code> means \"<em>Declare myElements as array of Variants</em>\".\n<code>Split</code> returns an array of Strings. Hence, the mismatch.</p>\n\n<p>You can do either <code>Dim myElements</code> or <code>Dim myElements as Variant</code> or <code>Dim myElements() as String</code> to resolve the problem.</p>\n\n<p>Here is why each one of these works:</p>\n\n<ol>\n<li><p><code>Dim myElements</code> and <code>Dim myElements as Variant</code> </p>\n\n<p>Both of these means that you declare myElements as Variant. Variants are special types, which can accept anything. As such, they can accept <code>array of strings</code> easily. However, variants have large memory overheads and should be avoided wherever possible.</p></li>\n<li><p><code>Dim myElements() as String</code> </p>\n\n<p>This means that you declare myElements as array of strings. Since this is the same type as what is returned by the <code>Split</code> function, it is accepted.</p></li>\n</ol>\n\n<p>Ideally, if you know the return type of a function, you should specify the correct type for your variables.\nSo in this case, <code>Dim myElements() as String</code>   which is the same type returned from the <code>Split</code> funcition.</p>\n"}], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2071, "favorite_count": 0, "accepted_answer_id": 30346906, "answer_count": 1, "score": 2, "last_activity_date": 1579884284, "creation_date": 1432116741, "last_edit_date": 1579884284, "question_id": 30346682, "link": "https://stackoverflow.com/questions/30346682/getting-full-split-array-into-a-vba-variable", "title": "Getting full Split array into a VBA variable", "body": "<p>Say I have a path in <code>Range(\"A1\")</code> that looks like this: </p>\n\n<pre><code>/data/apps/server/\n</code></pre>\n\n<p>I would like to get the three elements into a variable. I've thought doing a <code>Split()</code> by the separator <code>/</code> I would get the full array: </p>\n\n<pre><code>Dim myElements()\nmyElements = Split(Range(\"A1\").Value,\"/\")\n'&gt;&gt;&gt; EXPECTED: myElements is [data, apps, servers]\n</code></pre>\n\n<p>but I actually get a <code>Type mismatch</code> error on the line <code>myElements = Split(Range(\"A1\").Value,\"/\")</code>. What does the <code>Split</code> function return? Does it actually return the array or it rather gives read-only access?</p>\n\n<p>I would just like to get the array of the <code>Split</code> method without having to loop through them and build my own array, if possible of course.   </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1432115568, "post_id": 30346060, "comment_id": 48785098, "body": "Need more information: which version of Excel you use? The cells in the row are all full or there are blank cells?"}, {"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "reply_to_user": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1432115707, "post_id": 30346060, "comment_id": 48785202, "body": "excel 2007 and cells will not be blank. I want to copy till last used cell in that row."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1432117233, "post_id": 30346060, "comment_id": 48786387, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> then edit your question. When asking about VBA code it&#39;s hoped or even expected that the question will include the code that you have developed and tried. It&#39;s also good to include details about where the code is falling over and the message received."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432119527, "post_id": 30346786, "comment_id": 48787918, "body": "Is there anyway to hard-code that Activecell part.??"}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "reply_to_user": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432119617, "post_id": 30346786, "comment_id": 48787978, "body": "What do you mean? you can use a specific address instead of activecell"}, {"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432120058, "post_id": 30346786, "comment_id": 48788250, "body": "Will i able to use specific cell address in that place."}, {"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432124130, "post_id": 30346786, "comment_id": 48791115, "body": "If i copy i need to copy only from D4 to last used cell. I dont want the values of cells A4, B4, C4."}, {"owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432183823, "post_id": 30346786, "comment_id": 48820737, "body": "It works ..will i able to copy that into single cell ??"}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "reply_to_user": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "edited": false, "score": 0, "creation_date": 1432193143, "post_id": 30346786, "comment_id": 48825042, "body": "What do you mean? The destination cell is the starting cell to paste all the range"}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": true, "score": 0, "last_activity_date": 1432125007, "last_edit_date": 1432125007, "creation_date": 1432117057, "answer_id": 30346786, "question_id": 30346060, "link": "https://stackoverflow.com/questions/30346060/copy-entire-row-from-specific-cell/30346786#30346786", "title": "Copy entire row from specific cell", "body": "<p>Assuming activecell as interested cell, to copy all cells on the row you can use:</p>\n\n<pre><code>StartCol = ActiveCell.End(xlToLeft).Column\nEndCol = ActiveCell.End(xlToRight).Column\nmRow = ActiveCell.Row\nSet mRange = Range(Cells(mRow, StartCol), Cells(mRow, EndCol))\nmRange.Copy Destination:=Range(\"A20\") 'Insert your destination instead of \"A20\"\n</code></pre>\n\n<p>If you need to insert a specific cell value you can use <code>Range(\"your address\")</code> or <code>Cells(RowNumber, ColumnNuber)</code> instead of ActiveCell.</p>\n\n<p>You also can use a string variable containig an address into Range, so, for example:</p>\n\n<pre><code>mAddress = \"D5\"\nStartCol = Range(mAddress).End(xlToLeft).Column\nEndCol = Range(mAddress).End(xlToRight).Column\nmRow = Range(mAddress).Row\nSet mRange = Range(Cells(mRow, StartCol), Cells(mRow, EndCol))\nmRange.Copy Destination:=Range(\"A20\") 'Insert your destination instead of \"A20\"\n</code></pre>\n\n<p>Changing the value of mAddress you'll have what you need</p>\n\n<p>Edit:\nThis is to copy from D4 to the end of row</p>\n\n<pre><code>mAddress = \"D4\"\nStartCol = Range(mAddress).Column\nEndCol = Range(mAddress).End(xlToRight).Column\nmRow = Range(mAddress).Row\nSet mRange = Range(Cells(mRow, StartCol), Cells(mRow, EndCol))\nmRange.Copy Destination:=Range(\"A20\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 4209542, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LU9qTK2gQHo/AAAAAAAAAAI/AAAAAAAAAAA/-6ZlzT4HEJc/photo.jpg?sz=128", "display_name": "Diederik Sieburgh", "link": "https://stackoverflow.com/users/4209542/diederik-sieburgh"}, "is_accepted": false, "score": 0, "last_activity_date": 1432126339, "creation_date": 1432126339, "answer_id": 30350236, "question_id": 30346060, "link": "https://stackoverflow.com/questions/30346060/copy-entire-row-from-specific-cell/30350236#30350236", "title": "Copy entire row from specific cell", "body": "<p>Also, in your initial question you ask about cell count. In order to calculate this, you would just need to use this line:</p>\n\n<pre><code>cellCount = endCol - startCol + 1\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4764329, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d84b1b6fb30448e792096255d9eae6?s=128&d=identicon&r=PG&f=1", "display_name": "taz", "link": "https://stackoverflow.com/users/4764329/taz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 30346786, "answer_count": 2, "score": -1, "last_activity_date": 1432126339, "creation_date": 1432115105, "last_edit_date": 1531161705, "question_id": 30346060, "link": "https://stackoverflow.com/questions/30346060/copy-entire-row-from-specific-cell", "title": "Copy entire row from specific cell", "body": "<p>I am relatively new to vba. I have a problem in copying a row from specific cell. That is if my cell position is at D5 then it should copy the entire row from that cell position into a single cell in sheet 2. And i need the count of the total cell copied.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "if-statement", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1432113801, "post_id": 30345374, "comment_id": 48783754, "body": "The reason is the limited precision of floating point numbers.  <a href=\"http://stackoverflow.com/a/7330887/445425\">See this answer</a>"}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1432113935, "post_id": 30345374, "comment_id": 48783853, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/7330665/vba-rounding-problem\">VBA rounding problem</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "is_accepted": false, "score": 0, "last_activity_date": 1432113900, "creation_date": 1432113900, "answer_id": 30345568, "question_id": 30345374, "link": "https://stackoverflow.com/questions/30345374/vba-elseif-evaluation-error/30345568#30345568", "title": "VBA ElseIf evaluation error", "body": "<p>Floating point values (including VBA's <code>double</code> type) are imprecise.</p>\n\n<p>If you output <code>tm</code> with sufficient decimal places you will find it is a little less than 5.0 (eg. 4.9999999999999) it , but is being rounded for display.</p>\n"}, {"tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1432114338, "creation_date": 1432114338, "answer_id": 30345761, "question_id": 30345374, "link": "https://stackoverflow.com/questions/30345374/vba-elseif-evaluation-error/30345761#30345761", "title": "VBA ElseIf evaluation error", "body": "<p>I think the problem occurs due to data types, double sometimes misrounds numbers due to its precision type, take a look at the case when you use \"Currency\" instead of \"Double\" then the condition for 5 is false this could be solution to your problem.</p>\n"}, {"comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "reply_to_user": {"reputation": 1, "user_id": 4919626, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155581487600203/picture?type=large", "display_name": "Jone", "link": "https://stackoverflow.com/users/4919626/jone"}, "edited": false, "score": 0, "creation_date": 1432125373, "post_id": 30345942, "comment_id": 48792098, "body": "if it solution for your problem please accept it as an answer, that&#39;s enough not necessary to vote too"}], "tags": [], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "is_accepted": false, "score": 0, "last_activity_date": 1432114802, "creation_date": 1432114802, "answer_id": 30345942, "question_id": 30345374, "link": "https://stackoverflow.com/questions/30345374/vba-elseif-evaluation-error/30345942#30345942", "title": "VBA ElseIf evaluation error", "body": "<p>As stated already it's due to precision of floating point operations. If you want to avoid it round your value before comparison to the desired accuracy, e.g. <code>round(tm,2)&lt;5</code> instead of just <code>tm&lt;5</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 4919626, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155581487600203/picture?type=large", "display_name": "Jone", "link": "https://stackoverflow.com/users/4919626/jone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1507108616, "creation_date": 1432113453, "last_edit_date": 1531164843, "question_id": 30345374, "link": "https://stackoverflow.com/questions/30345374/vba-elseif-evaluation-error", "title": "VBA ElseIf evaluation error", "body": "<p>I am doing VBA coding in Excel 2007.</p>\n\n<p>I want to add 0.1 when tm is &lt; 5 and add 0.25 when tm is at least 5, and some other cases. In the following code, when in 3rd iteration, the expression <code>(tm &lt; 5)</code> is evaluated true when tm = 5. What is going on?</p>\n\n<p>Even more interesting, if you try starting tm = 4.9, the evaluation would be correct!</p>\n\n<pre><code>    Sub test()\n\nDim i As Integer\nDim tm As Double\ntm = 4.8\n\nFor i = 1 To 5\n\nMsgBox tm &amp; \" \" &amp; (tm &lt; 5)\n\n    If tm &lt; 2 Then\n        tm = tm + 0.05\n    ElseIf tm &lt; 5 Then\n        tm = tm + 0.1\n    Else\n        tm = tm + 1\n    End If\n\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "attachment"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1432128969, "creation_date": 1432128969, "answer_id": 30351321, "question_id": 30345193, "link": "https://stackoverflow.com/questions/30345193/add-the-names-of-attachments-to-the-body-of-an-outgoing-email/30351321#30351321", "title": "Add the names of attachments to the body of an outgoing email", "body": "<p>You need to use the Body or HTMLBody properties for customizing the message body in the ItemSend event handler. The Word editor may not be available at this stage, i.e. it can be too late. Also changes made using the WordEditor property in the Send or ItemSend event are not saved. Take a look at the described <a href=\"https://support.microsoft.com/en-us/kb/2605734\" rel=\"nofollow\">similar issue</a> for more information. </p>\n"}, {"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1432232990, "last_edit_date": 1432232990, "creation_date": 1432227695, "answer_id": 30380056, "question_id": 30345193, "link": "https://stackoverflow.com/questions/30345193/add-the-names-of-attachments-to-the-body-of-an-outgoing-email/30380056#30380056", "title": "Add the names of attachments to the body of an outgoing email", "body": "<p>You pass \"item As Object\" so you do not have to find it again.</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal item As Object, cancel As Boolean)\n    Dim oAtt As attachment\n    Dim strAtt, DateMark, ShortTime, FinalMsg, AttachName, TriggerText As String\n    'Dim olInspector, oInspector As Inspector\n    Dim olDocument As Object\n    Dim olSelection As Object\n    Dim NewMail As MailItem\n    Dim AttchCount, i As Integer\n\n    TriggerText = \"Joe Bloggs\"\n\n    'If oInspector Is Nothing Then\n    '    'Set NewMail = Application.ActiveExplorer.Selection.Item(1)\n    '   Set NewMail = oExpl.ActiveInlineResponse\n    '  If NewMail Is Nothing Then\n    '       'MsgBox \"No active inspector or inline response\"\n    '       Exit Sub\n    '    End If\n    'Else\n    '    Set NewMail = oInspector.currentItem\n    'End If 'oInspector is Nothing\n\n    'Set oInspector = Application.ActiveInspector\n    'If oInspector.currentItem.Class = olAppointment Then End\n\n    If TypeOf item Is MailItem Then\n\n        Set NewMail = item\n\n        With NewMail ' In future coding you need not bother to set NewMail just use item\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 3005415, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/654840d56314c119200070c62ffcb799?s=128&d=identicon&r=PG", "display_name": "Cassiopeia", "link": "https://stackoverflow.com/users/3005415/cassiopeia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593071247, "creation_date": 1432113003, "last_edit_date": 1593071247, "question_id": 30345193, "link": "https://stackoverflow.com/questions/30345193/add-the-names-of-attachments-to-the-body-of-an-outgoing-email", "title": "Add the names of attachments to the body of an outgoing email", "body": "<p>I had a script which did this well in outlook 2010 but since upgrading to outlook 2013 it crashes at a number of different points. I wonder if anyone else has a way to do it or can see if it can be repaired?</p>\n\n<p>It seems to crash at a number of the olDocument, oInspector, ActiveInspector.WordEditor.Application steps, depending on how the wind is blowing.</p>\n\n<p>Thanks for any help</p>\n\n<pre><code>Option Explicit\nPrivate WithEvents oExpl As Explorer\nPrivate WithEvents oItem As MailItem\nPrivate bDiscardEvents, Cancel As Boolean\nPrivate strAtt, FinalMsg As String\nPrivate oAtt As Attachment\nPrivate oResponse As MailItem\n'This sub inserts the name of any meaningful attachments just after the signature\nPrivate Sub Application_ItemSend(ByVal item As Object, Cancel As Boolean)\nDim oAtt As Attachment\nDim strAtt, DateMark, ShortTime, FinalMsg, AttachName, TriggerText As String\nDim olInspector, oInspector As Inspector\nDim olDocument As Object\nDim olSelection As Object\nDim NewMail As MailItem\nDim AttchCount, i As Integer\nExit Sub\n\nTriggerText = \"Joe Bloggs\"\n\nIf oInspector Is Nothing Then\n     'Set NewMail = Application.ActiveExplorer.Selection.Item(1)\n     Set NewMail = oExpl.ActiveInlineResponse\n     If NewMail Is Nothing Then\n        'MsgBox \"No active inspector or inline response\"\n        Exit Sub\n     End If\nElse\n    Set NewMail = oInspector.CurrentItem\nEnd If 'oInspector is Nothing\n\nSet oInspector = Application.ActiveInspector\nIf oInspector.CurrentItem.Class = olAppointment Then End\n\n\n\nWith NewMail\n    AttchCount = .Attachments.Count\n\n    If AttchCount &gt; 0 Then\n        For i = 1 To AttchCount\n        AttachName = .Attachments.item(i).DisplayName\n            If InStr(LCase(AttachName), \"pdf\") &lt;&gt; 0 Or InStr(LCase(AttachName), \"xls\") &lt;&gt; 0 Or InStr(LCase(AttachName), \"doc\") &lt;&gt; 0 Or InStr(LCase(AttachName), \"ppt\") &lt;&gt; 0 Or InStr(LCase(AttachName), \"msg\") &lt;&gt; 0 Or .Attachments.item(i).Size &gt; 95200 Then\n                strAtt = strAtt &amp; \"&lt;&lt;\" &amp; AttachName &amp; \"&gt;&gt; \" &amp; vbNewLine\n            End If\n        Next i\n    End If\nEnd With\n\n' this section is an alternative method of getting attachment names\n'For Each oAtt In Item.Attachments\n'    If InStr(oAtt.FileName, \"xls\") &lt;&gt; 0 Or InStr(oAtt.FileName, \"doc\") &lt;&gt; 0 Or InStr(oAtt.FileName, \"pdf\") &lt;&gt; 0 Or InStr(oAtt.FileName, \"ppt\") &lt;&gt; 0 Or InStr(oAtt.FileName, \"msg\") &lt;&gt; 0 Or oAtt.Size &gt; 95200 Then\n'    strAtt = strAtt &amp; \"&lt;&lt;\" &amp; oAtt.FileName &amp; \"&gt;&gt; \" &amp; vbNewLine\n'End If\n'Next\n'Set olInspector = Application.ActiveInspector()\n'Set olDocument = olInspector.WordEditor\n'Set olSelection = olDocument.Application.Selection\n\nDateMark = \"\" '\" (dated \" &amp; Date &amp; \")\" 'Date not necessary now this is working well\nIf strAtt = \"\" Then\nFinalMsg = \"\"\nExit Sub\nElse\nFinalMsg = \"Documents attached to this email\" &amp; DateMark &amp; \": \" &amp; vbNewLine &amp; strAtt\nEnd If\n\nDim inputArea, SearchTerm As String\nDim SignatureLine, FromLine, EndOfEmail As Integer\n\n\n\n'Find the end of the signature\nWith ActiveInspector.WordEditor.Application 'Might be able to use: Application.ActiveWindow.CurrentItem\n\n    .Selection.WholeStory\n    .Selection.Find.ClearFormatting\n    With .Selection.Find\n        .Text = TriggerText\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindAsk\n        .Format = False\n        .MatchCase = False\n        .Execute\n    End With\n    SignatureLine = .Selection.Range.Information(wdFirstCharacterLineNumber) + 1\n    .Selection.EndKey Unit:=wdLine\nEnd With\n\n'check to see if attachment info has already been added\nWith ActiveInspector.WordEditor.Application\n    .Selection.MoveDown Unit:=wdLine, Count:=3, Extend:=wdExtend\n    inputArea = .Selection\n    .Selection.HomeKey Unit:=wdLine\n    .Selection.EndKey Unit:=wdLine\n    'SelectedLine = .Selection.Range.Information(wdFirstCharacterLineNumber) + 1\n\n\n    'detect existing attachment lists\n    If Not InStr(inputArea, \"Documents attached to this email\") &lt;&gt; 0 Then\n        .Selection.EndKey Unit:=wdLine\n        .Selection.TypeParagraph\n    Else\n        With .Selection.Find\n            .Text = \"From:\"\n            .Replacement.Text = \"\"\n            .Forward = True\n            .Wrap = wdFindAsk\n            .Format = False\n            .MatchCase = True\n            .Execute\n        End With\n    FromLine = .Selection.Range.Information(wdFirstCharacterLineNumber) + 1\n\n    'In case the email being replied to is not in english,\n    'try to detect the first line of the next email by looking for mailto\n        If .Selection.Find.Found = False Then\n            With .Selection.Find\n                .Text = \"&gt;&gt;\"\n                .Replacement.Text = \"\"\n                .Forward = False\n                .Wrap = wdFindAsk\n                .Format = False\n                .Execute\n            End With\n        End If\n\n\n        'designate the last line of the email and delete anything between this and the signature\n        EndOfEmail = .Selection.Range.Information(wdFirstCharacterLineNumber) - 1\n        .Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend\n        .Selection.EndKey Unit:=wdLine\n        .Selection.MoveUp Unit:=wdLine, Count:=EndOfEmail - SignatureLine, Extend:=wdExtend\n        .Selection.Expand wdLine\n        .Selection.Delete\n    End If\nEnd With\n\n'Insert the text and format it.\nIf Not NewMail.BodyFormat = olFormatPlain Then\n    With ActiveInspector.WordEditor.Application\n        .Selection.TypeParagraph\n        .Selection.InsertAfter FinalMsg 'insert the message at the cursor.\n        .Selection.Font.Name = \"Calibri\"\n        .Selection.Font.Size = 8\n        .Selection.Font.Color = wdColorBlack\n        .Selection.EndKey Unit:=wdLine\n        'If FromLine - EndOfEmail &lt; 2 Then .Selection.TypeParagraph\n        '.Selection.Delete\n    End With\nEnd If\nlastline:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1432326705, "post_id": 30345179, "comment_id": 48898479, "body": "An administrator could grant full access.  a) <a href=\"http://www.adamfowlerit.com/2013/01/17/propegating-user-folder-permissions-on-exchange/\" rel=\"nofollow noreferrer\">adamfowlerit.com/2013/01/17/&hellip;</a>  b) <a href=\"https://technet.microsoft.com/en-us/library/aa996343(v=exchg.141).aspx\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/library/aa996343(v=exchg.141).as&zwnj;&#8203;px</a>  c) <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=22427\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=22427</a>"}, {"owner": {"reputation": 111, "user_id": 3852566, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/157f64daea490c255a5f30cebb85cd2e?s=128&d=identicon&r=PG&f=1", "display_name": "PeteBradshaw", "link": "https://stackoverflow.com/users/3852566/petebradshaw"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1432541534, "post_id": 30345179, "comment_id": 48951429, "body": "Hi Niton, I work for a large organisation and the administrator has things pretty much locked down and won&#39;t allow additional access. It&#39;s a pain to be honest, but I understand the reason..."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1432554421, "post_id": 30345179, "comment_id": 48958322, "body": "Additional access is not locked down if you can update the painful way. The links describe how an Administrator could grant access when you request it for new people."}, {"owner": {"reputation": 111, "user_id": 3852566, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/157f64daea490c255a5f30cebb85cd2e?s=128&d=identicon&r=PG&f=1", "display_name": "PeteBradshaw", "link": "https://stackoverflow.com/users/3852566/petebradshaw"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1432559977, "post_id": 30345179, "comment_id": 48961432, "body": "Thanks Niton, I&#39;ve had a look at the links but I don&#39;t have permission to download and install any additional software, and my administrator won&#39;t do it due to company policy. So I have to do this manually, which is a real chore. Thanks again for your help, but I don&#39;t think there is a solution to this issue. Company policy means I&#39;m restricted to VBA only, and this isn&#39;t able to address the issue."}, {"owner": {"reputation": 159, "user_id": 3142056, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1554ec5d3afdcf3f3992b1bf433373bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3142056", "link": "https://stackoverflow.com/users/3142056/user3142056"}, "edited": false, "score": 0, "creation_date": 1581552854, "post_id": 30345179, "comment_id": 106477437, "body": "Check out the workaround described in this <a href=\"https://superuser.com/questions/650134/change-multiple-mail-folders-permission-at-once-in-outlook\">superuser thread</a>."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 3852566, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/157f64daea490c255a5f30cebb85cd2e?s=128&d=identicon&r=PG&f=1", "display_name": "PeteBradshaw", "link": "https://stackoverflow.com/users/3852566/petebradshaw"}, "edited": false, "score": 0, "creation_date": 1432284140, "post_id": 30348963, "comment_id": 48872381, "body": "Hi Guys, thanks for replying. It looks like I need either Remption or C++ / Delphi to resolve this issue. Unfortunately, the powers that be will only allow access to VBA, so it looks like I&#39;ll be doing a lot of repetative pointing and clicking in the future!"}, {"owner": {"reputation": 111, "user_id": 3852566, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/157f64daea490c255a5f30cebb85cd2e?s=128&d=identicon&r=PG&f=1", "display_name": "PeteBradshaw", "link": "https://stackoverflow.com/users/3852566/petebradshaw"}, "edited": false, "score": 0, "creation_date": 1432284274, "post_id": 30348963, "comment_id": 48872458, "body": "Note: I did try creating a DL and assigning this access to a folder, but this didn&#39;t work either. Thanks again for all your help."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1432122955, "last_edit_date": 1495539825, "creation_date": 1432122955, "answer_id": 30348963, "question_id": 30345179, "link": "https://stackoverflow.com/questions/30345179/assign-folder-permissions-in-outlook-2010-with-vba/30348963#30348963", "title": "Assign folder permissions in Outlook 2010 with VBA", "body": "<p>The Outlook object model (used in VBA) doesn't provide anything for changing folder permissions. </p>\n\n<p>You can use a low-level API - Extended MAPI for accessing permissions. Folder level permissions are stored in folders. You need to get the  PR_ACL_TABLE property value using the IMAPIFolder::OpenProperty method. Or you may consider using any third-party wrappers around that API that simplify the dev process. See <a href=\"https://stackoverflow.com/questions/21325153/changes-in-outlook-2010-folder-permissions-not-shown-in-active-directory\">Changes in Outlook 2010 folder permissions not shown in Active Directory</a> for more information.</p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 3852566, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/157f64daea490c255a5f30cebb85cd2e?s=128&d=identicon&r=PG&f=1", "display_name": "PeteBradshaw", "link": "https://stackoverflow.com/users/3852566/petebradshaw"}, "edited": false, "score": 0, "creation_date": 1432541745, "post_id": 30354793, "comment_id": 48951507, "body": "Hi Dimitry, thanks for the code. Unfortunately, my administrator won&#39;t allow access to Redemption, so I&#39;m stuck and have to do it manually."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1432153803, "last_edit_date": 1432153803, "creation_date": 1432137612, "answer_id": 30354793, "question_id": 30345179, "link": "https://stackoverflow.com/questions/30345179/assign-folder-permissions-in-outlook-2010-with-vba/30354793#30354793", "title": "Assign folder permissions in Outlook 2010 with VBA", "body": "<p>Since you are using VBA, Extended MAPI is out of the question (you'd need C++ or Delphi). </p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow\">Redemption</a> is an option, you can use its <a href=\"http://www.dimastr.com/redemption/RDOACL.htm\" rel=\"nofollow\">RDOACL</a> object (returned by <a href=\"http://www.dimastr.com/redemption/RDOFolder.htm\" rel=\"nofollow\">RDOFolder</a>.ACL property) to manage any Exchange folder permissions: </p>\n\n<pre><code> set Session = CreateObject(\"Redemption.RDOSession\")\n Session.MAPIOBJECT = Application.Session.MAPIOBJECT\n set Folder = Session.GetDefaultFolder(olFolderCalendar)\n\n'make sure we get back an Exchange user\n set AddressEntry = Session.AddressBook.GAL.ResolveName(\"Pete\")\n set ACE = Folder.ACL.Add(AddressEntry)\n ACE.Rights = ROLE_PUBLISH_EDITOR\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 3852566, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/157f64daea490c255a5f30cebb85cd2e?s=128&d=identicon&r=PG&f=1", "display_name": "PeteBradshaw", "link": "https://stackoverflow.com/users/3852566/petebradshaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2255, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593157261, "creation_date": 1432112972, "last_edit_date": 1593157261, "question_id": 30345179, "link": "https://stackoverflow.com/questions/30345179/assign-folder-permissions-in-outlook-2010-with-vba", "title": "Assign folder permissions in Outlook 2010 with VBA", "body": "<p>Morning,</p>\n\n<p>I'm trying to identify a way of updating permissions to an Outlook 2010 inbox and all of its subfolders with VBA.</p>\n\n<p>We have an account with a large amount of subfolders that several new users need access to. To assign each of these manually will take hours and I'm looking for an automated process, as this will be a reoccuring task.</p>\n\n<p>Due to administrator restrictions I'm only able to use native VBA.</p>\n\n<p>Is this possible, or am I doomed to hours of mundane repetitive pointing and clicking?</p>\n\n<p>Many thanks</p>\n\n<p>Pete</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 3, "creation_date": 1432113682, "post_id": 30345154, "comment_id": 48783674, "body": "Your case is inconsistent, try <code>If Data = &quot;False&quot; Then</code>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1432115147, "post_id": 30345154, "comment_id": 48784774, "body": "<code>If CStr(Data) = CStr(False) Then</code> or <code>If TypeName(Data) = &quot;Boolean&quot; And Data = False Then</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1432115392, "post_id": 30345154, "comment_id": 48784954, "body": "I deleted my answer. Stick with what @brettdj suggested."}, {"owner": {"reputation": 173, "user_id": 4796843, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2d8e8f10db1d8661b11b56aa2ec381b?s=128&d=identicon&r=PG&f=1", "display_name": "Skipjack3", "link": "https://stackoverflow.com/users/4796843/skipjack3"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1432115737, "post_id": 30345154, "comment_id": 48785226, "body": "@brettdj this works great! if you write it into an answer I&#39;ll mark it as such... but can you explain how it works? I don&#39;t really see such a difference from what I originally did and still it makes a huge difference!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432115833, "post_id": 30345154, "comment_id": 48785305, "body": "False has a value equal to 0. And hence it was exiting the loop in my code.  <code>Data = &quot;False&quot;</code> or <code>Ucase(Data)= &quot;FALSE&quot;</code> is just another way of saying the same thing"}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 0, "last_activity_date": 1432116172, "last_edit_date": 1432116172, "creation_date": 1432115688, "answer_id": 30346264, "question_id": 30345154, "link": "https://stackoverflow.com/questions/30345154/vba-excel-inputbox-cancel-exiting-loop/30346264#30346264", "title": "vba excel inputbox cancel exiting loop", "body": "<p>The problem is in VBA 0 = False and there is no <code>==</code>or <code>===</code> comparator. So you can't differ between 0 and False in direct comparison.</p>\n\n<p><code>If Data = \"False\" Then</code> will convert <code>Data</code> to String and compare then. If Data is 0 then it compares \"0\" with \"False\" and if Data is False then it compares \"False\" with \"False\". So this works with English Excel versions.</p>\n\n<p><code>If CStr(Data) = CStr(False) Then</code> or <code>If TypeName(Data) = \"Boolean\" And Data = False Then</code> will be locale independent. </p>\n"}], "owner": {"reputation": 173, "user_id": 4796843, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e2d8e8f10db1d8661b11b56aa2ec381b?s=128&d=identicon&r=PG&f=1", "display_name": "Skipjack3", "link": "https://stackoverflow.com/users/4796843/skipjack3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1671, "favorite_count": 0, "accepted_answer_id": 30346264, "answer_count": 1, "score": 1, "last_activity_date": 1432116172, "creation_date": 1432112908, "question_id": 30345154, "link": "https://stackoverflow.com/questions/30345154/vba-excel-inputbox-cancel-exiting-loop", "title": "vba excel inputbox cancel exiting loop", "body": "<p>I have a few problems with the cancel button of <code>application.inputbox</code>, it seems to be a problem with which a lot of people have to deal with but I haven't really managed too adapt the various solutions to my case.<br>\nWhat I would like to is to have an \"infinite\" loop that asks the user to input a number until he presses cancel on the inputbox.</p>\n\n<p>To explain the situation a little the loop should ask for the consumption for this month and then write the month in cell A1 and the consumption in B1, then ask for the consumption for the previous month and write it underneath and so on until the user finishes the data to input and presses cancel, but if you press cancel my code will just write FALSE and keep running despite the <code>Data = \"FALSE\"</code> check.<br>\nMany solutions I found online don't work because I need the program to accept 0 as a number, refuse anything that is not a number and keep asking on the same month if ok is pressed without anything inside.</p>\n\n<pre><code>Dim Data\nDim i As Integer, Years As Integer, MonthNum As Integer, LastRow As Integer\n\ni = 2\nDo While i &lt;= 10\n    MonthNum = Month(DateAdd(\"m\", -i + 1, Date))    'calculates month\n    Years = year(DateAdd(\"m\", -i + 1, Date))        'calculates year\n    Data = Application.InputBox(\"Please enter consumption of \" &amp; vbNewLine _\n        &amp; MonthNum &amp; \".\" &amp; Years, \"Imput Consumtion\", Type:=1)\n    If Data = \"FALSE\" Then\n        Exit Do\n    Else\n        Cells(i, 1) = MonthName(MonthNum, 1) &amp; \" \" &amp; Years\n        Cells(i, 2) = Data\n        i = i + 1\n    End If\nLoop\nLastRow = Range(\"A:A\").Find(\"*\", searchorder:=xlByRows, searchdirection:=xlPrevious).Row\nRange(Cells(i, 1), Cells(LastRow, 2)).Clear\n</code></pre>\n\n<p>I'm using <code>application.inputbox</code> because I thought it would work better (I tried using <code>Type:=1 + 2</code> and <code>Type:=1 + 8</code> to solve the problem but got no useful results) but if there is a way to do it with the regular inputbox I'm obviously ok with that.<br>\nThe <code>While i &lt;= 0</code> condition is just to stop the loop from going on forever, in my final code I would put there what ever condition I need to exit.</p>\n\n<p>Any suggestinos? thanks everybody!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4804935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc8f7a0fc271c29beeeb62485343a46?s=128&d=identicon&r=PG&f=1", "display_name": "chia fatt Tan", "link": "https://stackoverflow.com/users/4804935/chia-fatt-tan"}, "edited": false, "score": 0, "creation_date": 1432113467, "post_id": 30345287, "comment_id": 48783544, "body": "The problem is when i type in in the format &quot;dd-mm-yy&quot; when CDATE() happen will store it to &quot;yy-mm-dd&quot; so everytime my date will become year and year become date... &gt;.&lt;"}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "reply_to_user": {"reputation": 25, "user_id": 4804935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc8f7a0fc271c29beeeb62485343a46?s=128&d=identicon&r=PG&f=1", "display_name": "chia fatt Tan", "link": "https://stackoverflow.com/users/4804935/chia-fatt-tan"}, "edited": false, "score": 0, "creation_date": 1432114863, "post_id": 30345287, "comment_id": 48784552, "body": "You can use Format to obtain the desired output. What format do you need?"}, {"owner": {"reputation": 25, "user_id": 4804935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc8f7a0fc271c29beeeb62485343a46?s=128&d=identicon&r=PG&f=1", "display_name": "chia fatt Tan", "link": "https://stackoverflow.com/users/4804935/chia-fatt-tan"}, "edited": false, "score": 0, "creation_date": 1432114940, "post_id": 30345287, "comment_id": 48784614, "body": "Erm ~ actually i had found out a way but havent try coding yet that is converting my string into array and do comparison ~ might be abit long and abit messy with the code but i think should be working :D ~ thanks alot :D"}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 0, "last_activity_date": 1432115239, "last_edit_date": 1432115239, "creation_date": 1432113240, "answer_id": 30345287, "question_id": 30345106, "link": "https://stackoverflow.com/questions/30345106/excel-vba-how-to-compare-specific-string/30345287#30345287", "title": "Excel VBA : How to Compare specific String", "body": "<p>If you won't use \"Dim DateStart as Date\" maybe you can use \"CDate(DateStart)\" while comparing.</p>\n\n<p>If you need a specific format you can use (for example):</p>\n\n<pre><code>Format(CDate(DateStart), \"dd/mm/yy\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4804935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc8f7a0fc271c29beeeb62485343a46?s=128&d=identicon&r=PG&f=1", "display_name": "chia fatt Tan", "link": "https://stackoverflow.com/users/4804935/chia-fatt-tan"}, "edited": false, "score": 0, "creation_date": 1432171934, "post_id": 30346436, "comment_id": 48817555, "body": "Thanks alot :) i think you had answered my second question but i had found another way :D ~ but you had let me know a better way :D ~"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1432119121, "last_edit_date": 1432119121, "creation_date": 1432116170, "answer_id": 30346436, "question_id": 30345106, "link": "https://stackoverflow.com/questions/30345106/excel-vba-how-to-compare-specific-string/30346436#30346436", "title": "Excel VBA : How to Compare specific String", "body": "<blockquote>\n  <p>how can i compare the 01-05 with 02-05</p>\n</blockquote>\n\n<p>Since you are doing a <code>String</code> match, try this</p>\n\n<pre><code>Sub Sample()\n    Dim DateStart As String\n    Dim CompareDate As String\n\n    CompareDate = \"02-05-15\"\n    DateStart = \"01-05-15\"\n\n    If Left(DateStart, (InStrRev(DateStart, \"-\", -1, vbTextCompare) - 1)) = _\n       Left(CompareDate, (InStrRev(CompareDate, \"-\", -1, vbTextCompare) - 1)) Then\n        MsgBox \"Matches\"\n    Else\n        MsgBox \"Doesn't Match\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>The <code>InStrRev</code> function returns the position of the first occurrence of a string (<code>-</code> in your case) in another string, starting from the <code>end</code> of the string. </p>\n\n<p>Or you could you this simple code</p>\n\n<pre><code>If Left(DateStart, 5) = Left(CompareDate, 5) Then\n    MsgBox \"Matches\"\nElse\n    MsgBox \"Doesn't Match\"\nEnd If\n</code></pre>\n\n<p>Regarding your second question, I am sorry, I didn't understand what are you trying to achieve. Perhaps if you rephrase it?</p>\n\n<p><strong>Edit</strong>: Did you mean you want this <code>SearchOrder:=xlByColumns</code> instead of <code>SearchOrder:=xlByRows</code></p>\n"}], "owner": {"reputation": 25, "user_id": 4804935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecc8f7a0fc271c29beeeb62485343a46?s=128&d=identicon&r=PG&f=1", "display_name": "chia fatt Tan", "link": "https://stackoverflow.com/users/4804935/chia-fatt-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 30346436, "answer_count": 2, "score": 0, "last_activity_date": 1432119121, "creation_date": 1432112776, "question_id": 30345106, "link": "https://stackoverflow.com/questions/30345106/excel-vba-how-to-compare-specific-string", "title": "Excel VBA : How to Compare specific String", "body": "<p>I had came up with some problem that i not sure on how to compare string.</p>\n\n<p>Example </p>\n\n<pre><code>Dim DateStart as String\nDim CompareDate as String\nDateStart = \"01-05-15\"\n</code></pre>\n\n<p>In <code>CompareDate</code> i type in a value 02-05-15, how can i compare the 01-05 with 02-05?</p>\n\n<p>I do not want to use Dim DateStart as Date.</p>\n\n<p>And also how can i compare Column instead of Row?\nThe current code i using for comparing row is :</p>\n\n<pre><code>iRow = ws.Cells.Find(what:=\"*\", After:=ws.Range(\"a1\"), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "reply_to_user": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432113557, "post_id": 30344546, "comment_id": 48783607, "body": "did you try: thisworkbook.sheets(1).cells(1,8).copy destination:= newWorkBook1.Worksheets(&quot;Feuil1&quot;).Cells(1, 8)"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432113888, "post_id": 30344546, "comment_id": 48783820, "body": "Yes, actually the copy works but the content copied is not from my &quot;source&quot; worksheet"}, {"owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "reply_to_user": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432115860, "post_id": 30344546, "comment_id": 48785328, "body": "So the source data is in the same wbk as code but a different specific sheet?"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432119914, "post_id": 30344546, "comment_id": 48788170, "body": "I use a workbook with a macro to programmatically create a new workbook containing a button with an associated macro, when I click on this button, I want the content of this workbook to be copied into an other workbook that is created."}], "tags": [], "owner": {"reputation": 333, "user_id": 4919505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abda443f204b1300acb3ec3dc1bb72c7?s=128&d=identicon&r=PG&f=1", "display_name": "KKowalczyk", "link": "https://stackoverflow.com/users/4919505/kkowalczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1432111690, "last_edit_date": 1432111690, "creation_date": 1432111365, "answer_id": 30344546, "question_id": 30344335, "link": "https://stackoverflow.com/questions/30344335/write-from-a-worksheet-to-another-using-a-macro-added-programmatically/30344546#30344546", "title": "Write from a worksheet to another using a macro added programmatically", "body": "<p>To access the content of the first worksheet of workbook containing macro you need to use:</p>\n\n<pre><code>Thisworkbook.sheets(1).range(\"a1:a100\") ' range as an example you can input anything\n</code></pre>\n\n<p>Hope it helped.</p>\n"}, {"comments": [{"owner": {"reputation": 706, "user_id": 4343507, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MsGyG.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/4343507/neo"}, "edited": false, "score": 0, "creation_date": 1432121267, "post_id": 30347983, "comment_id": 48789060, "body": "Thanks for your answer. Actually I use a first workbook to create a second workbook with a macro associated to a button. And I what that when I click on this button, the content of the second workbook is copied to a third workbook that is created, I hope it&#39;s more clear now."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 706, "user_id": 4343507, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/MsGyG.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/4343507/neo"}, "edited": false, "score": 0, "creation_date": 1432121472, "post_id": 30347983, "comment_id": 48789213, "body": "Yes you have to still use what I gave above. In <code>Sub checkPVC_Click()</code>, use <code>Activeworkbook</code> to copy from 2nd to 3rd."}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432122520, "post_id": 30347983, "comment_id": 48790002, "body": "I now get a runtime error : Subscript out of range (Error 9)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432122617, "post_id": 30347983, "comment_id": 48790058, "body": "Can you update the question with the code that you are now using?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1432123889, "post_id": 30347983, "comment_id": 48790953, "body": "Are you creating that sheet in the 2nd workbook? Because all I can see is that you are adding a button to the new workbook. I do not see you creating any sheet with that name in the new file (2nd workbook)"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432124452, "post_id": 30347983, "comment_id": 48791347, "body": "I just change the name of the first sheet of the 2nd workbook to &quot;Valeurs&quot; : newWorkBook.Worksheets(&quot;Feuil1&quot;).Name = &quot;Valeurs&quot;``, this code is in the first workbook"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432124493, "post_id": 30347983, "comment_id": 48791377, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/78321/discussion-between-siddharth-rout-and-otus\">continue this discussion in chat</a>."}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432124644, "post_id": 30347983, "comment_id": 48791498, "body": "Ok, I can&#39;t now actually because the filter of my company&#39;s computer doesn&#39;t allow me to access chat"}, {"owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "edited": false, "score": 0, "creation_date": 1432126270, "post_id": 30347983, "comment_id": 48792829, "body": "@SiddharthRout I tested the code of your last edit and it works now, thanks :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1432124792, "last_edit_date": 1432124792, "creation_date": 1432120309, "answer_id": 30347983, "question_id": 30344335, "link": "https://stackoverflow.com/questions/30344335/write-from-a-worksheet-to-another-using-a-macro-added-programmatically/30347983#30347983", "title": "Write from a worksheet to another using a macro added programmatically", "body": "<p>You can leave the <code>Sub checkPVC_Click</code> in the original workbook. Just ensure that you give full path and name of the file which has that macro. For example. Please ensure that the file from where you are running this macro is saved at least once.</p>\n\n<pre><code>Sub Sample()\n    Dim NewWorkbook As Workbook\n\n    Set NewWorkbook = Workbooks.Add\n\n    With NewWorkbook.Worksheets(1).Buttons\n        .Add 350, 15, 173.25, 41.25\n        .OnAction = \"'\" &amp; ThisWorkbook.FullName &amp; \"'!checkPVC_Click\"\n    End With\nEnd Sub\n\nSub checkPVC_Click()\n    MsgBox \"a\"\nEnd Sub\n</code></pre>\n\n<p>Regarding your Second question, you need to fully qualify the <code>Cells</code> object so that it know which cells are you referring to</p>\n\n<p><code>ThisWorkbook</code> will refer to the cell from the workbook which hosts the code.</p>\n\n<p><code>Activeworkbook</code> will refer to the cell from the workbook which is currently active.</p>\n\n<p><strong>Edit</strong>: Followup from comments. Is this what you are trying?</p>\n\n<pre><code>Sub Sample()\n    Dim newWorkBook As Workbook\n    Dim ws As Worksheet\n\n    Set newWorkBook = Workbooks.Add\n    Set ws = newWorkBook.Sheets(1)\n    ws.Name = \"Valeurs\"\n\n    With ws.Buttons\n        .Add 350, 15, 173.25, 41.25\n        .OnAction = \"'\" &amp; ThisWorkbook.FullName &amp; \"'!checkPVC_Click\"\n    End With\nEnd Sub\n\nSub checkPVC_Click()\n    Dim OldWorkbook As Workbook, newWorkBook As Workbook\n    Dim createdSheetColumnsTab(100) As String\n\n    Set OldWorkbook = ActiveWorkbook\n\n    Set newWorkBook1 = Workbooks.Add\n\n    newWorkBook1.Worksheets(\"Feuil1\").Cells(1, 1).Value = \"Stat\"\n\n    newWorkBook1.Worksheets(\"Feuil1\").Cells(2, 1) = OldWorkbook.Worksheets(\"Valeurs\").Cells(12, 1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 4515246, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/97a1a7d84c476fd43e855aac6622de1b?s=128&d=identicon&r=PG&f=1", "display_name": "otus", "link": "https://stackoverflow.com/users/4515246/otus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 1, "accepted_answer_id": 30347983, "answer_count": 2, "score": 2, "last_activity_date": 1432125211, "creation_date": 1432110775, "last_edit_date": 1432125211, "question_id": 30344335, "link": "https://stackoverflow.com/questions/30344335/write-from-a-worksheet-to-another-using-a-macro-added-programmatically", "title": "Write from a worksheet to another using a macro added programmatically", "body": "<p>I actually create worksheets programmatically and add button with a macro associated to these worksheets programmatically. What I want to do is that when I click on the button the content of the worksheet containing the button is copied to another worksheet.</p>\n\n<p>There are actually two things that confuse me : <strong>Firstly</strong> I don't understand if the macro I associate to the button is located (I mean its code is located) in the file creating the worksheet or in the created worksheet itself.</p>\n\n<p>Here is the code I create to add a button with an associated macro : </p>\n\n<pre><code> With newWorkBook.Worksheets(1).Buttons\n        .Add 350, 75, 173.25, 41.25\n        .OnAction = \"'\" &amp; ThisWorkbook.FullName &amp; \"'!export_Click\"\n        .Caption = \"Exporter la fiche\"\n      End With\n\n      newWorkBook.Worksheets(\"Feuil1\").Name = \"Valeurs\"\n</code></pre>\n\n<p>The <code>checkPVC_Click</code> Sub is in a module located in the Excel file used to generate the worksheets.</p>\n\n<p><strong>Secondly</strong>, within the macro that is supposed to copy the content of a worksheet to another, I don't know how to refer differently to the two worksheets (source and target) in the code.</p>\n\n<p>In the code below :</p>\n\n<pre><code>Dim newWorkBook As Workbook\nDim createdSheetColumnsTab(100) As String\nDim col As Integer\ncol = Cells(1, 8).Value\n\nSet newWorkBook1 = Workbooks.Add\n\nnewWorkBook1.Worksheets(\"Feuil1\").Cells(1, 1).Value = \"Stat\"\n\nnewWorkBook1.Worksheets(\"Feuil1\").Cells(2, 1) = ActiveWorkbook.Worksheets(\"Valeurs\").Cells(12, 1)\n</code></pre>\n\n<p>Here in the line <code>col = Cells(1, 8).Value</code> I access to the content of the worksheet which content I want to copy, and in the line <code>newWorkBook1.Worksheets(\"Feuil1\").Cells(1, 1).Value = \"Stat\"</code> I access to the content of the \"target\" worksheet and I don't know how to refer to the content of the first worksheet in the following of the code in order to copy the content.</p>\n\n<p>I hope I was clear, and I can add more precisions if necessary, sorry I don't master English so it's hard for me to explain the issue.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1432110640, "post_id": 30344149, "comment_id": 48781589, "body": "Thanks Aprillion - Its still not quite working for me. Will this formula change if the contract number has letters in as well? - for example if it&#39;s 1-2ABC4D5"}, {"owner": {"reputation": 16381, "user_id": 1176601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YCkL9.jpg?s=128&g=1", "display_name": "Aprillion", "link": "https://stackoverflow.com/users/1176601/aprillion"}, "reply_to_user": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 1, "creation_date": 1432110753, "post_id": 30344149, "comment_id": 48781664, "body": "no, have you entered the formula with Ctrl+Shift+Enter?"}, {"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1432110935, "post_id": 30344149, "comment_id": 48781781, "body": "No, just copy pasted the formula into excel, and changed the references to be correct for my spreadsheet - in my spreadsheet the contract number is in column D, and version in column E - so I&#39;ve got &#39;=if(e2=max(if(d2=d:d,E:e)),&quot;Yes&quot;,&quot;No&quot;)&#39;"}, {"owner": {"reputation": 16381, "user_id": 1176601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YCkL9.jpg?s=128&g=1", "display_name": "Aprillion", "link": "https://stackoverflow.com/users/1176601/aprillion"}, "reply_to_user": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 1, "creation_date": 1432111029, "post_id": 30344149, "comment_id": 48781843, "body": "then please do confirm your adjusted formula with Ctrl+Shift+Enter instead of plain Enter - I added a link to official guidelines about array formulas in my answer, you might want to have a look"}, {"owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "edited": false, "score": 0, "creation_date": 1432111417, "post_id": 30344149, "comment_id": 48782107, "body": "Legendary, Didn&#39;t know about that Aprillion, thank you very much for your help."}], "tags": [], "owner": {"reputation": 16381, "user_id": 1176601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YCkL9.jpg?s=128&g=1", "display_name": "Aprillion", "link": "https://stackoverflow.com/users/1176601/aprillion"}, "is_accepted": true, "score": 3, "last_activity_date": 1432110902, "last_edit_date": 1432110902, "creation_date": 1432110233, "answer_id": 30344149, "question_id": 30343908, "link": "https://stackoverflow.com/questions/30343908/checking-for-the-latest-version-of-a-contract-in-excel/30344149#30344149", "title": "Checking for the latest version of a contract in Excel", "body": "<p>you were close, but not quite, with the <a href=\"https://support.office.com/en-za/article/Guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow\">array formula</a>, entered with <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd>:</p>\n\n<pre><code>=IF(B2=MAX(IF(A2=A:A,B:B)),\"Yes\",\"No\")\n</code></pre>\n"}], "owner": {"reputation": 404, "user_id": 4916993, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh3.googleusercontent.com/-RKGsQJH3P1U/AAAAAAAAAAI/AAAAAAAAAEg/TBqBqMyLQeY/photo.jpg?sz=128", "display_name": "Miller86", "link": "https://stackoverflow.com/users/4916993/miller86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 30344149, "answer_count": 1, "score": 3, "last_activity_date": 1435178722, "creation_date": 1432109520, "last_edit_date": 1531161705, "question_id": 30343908, "link": "https://stackoverflow.com/questions/30343908/checking-for-the-latest-version-of-a-contract-in-excel", "title": "Checking for the latest version of a contract in Excel", "body": "<p>First stackoverflow question, so hopefully I've done this correctly! I've had a good look on various sites ranging from Mr XL to Chandoo, and a good look on here too, and I've not come up with a solution yet.</p>\n\n<p>I've got a spreadsheet which tracks contracts, but I need to know if its the latest version. I've tried the If(Max) formula I've seen suggested to no avail. </p>\n\n<p>This is what I've got so far and its not working! </p>\n\n<p>Example:</p>\n\n<pre><code>   Contract Number     Version               - Latest Version\n\n    12345                 1                    =IF(B2=(MAX(A:A=A2,B:B)),\"Yes\",\"No\")\n    12345                 2                    \n</code></pre>\n\n<p>Is this something I'd have to VBA up a solution for?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 45896, "user_id": 2442804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wBmyS.jpg?s=128&g=1", "display_name": "luk2302", "link": "https://stackoverflow.com/users/2442804/luk2302"}, "edited": false, "score": 0, "creation_date": 1432111198, "post_id": 30343847, "comment_id": 48781950, "body": "try adding a space in front of <code>SET</code> - and you first value has no leading and trailing <code>&#39;</code>. And your are failing to escape your input, if a user inputs <code>test&#39;test</code> your query will always fail."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1432114512, "creation_date": 1432114512, "answer_id": 30345838, "question_id": 30343847, "link": "https://stackoverflow.com/questions/30343847/access-form-vba-update-record/30345838#30345838", "title": "Access Form Vba Update Record", "body": "<p>It should probably read:</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE Ensamblador \" &amp; _\n\"SET NombredeEnsamblador = '\" &amp; Me.textboxtwo &amp; \"'\" &amp; _\n\", Especialidad='\" &amp; Me.textboxthree &amp; \"' \" &amp; _\n\"WHERE NumerodeEnsamblador=\" &amp; Me.textboxone &amp; \"\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4089752, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/26fe49ee498eb359c116baf0d02c3e68?s=128&d=identicon&r=PG&f=1", "display_name": "Giovannie Sanchez Diaz", "link": "https://stackoverflow.com/users/4089752/giovannie-sanchez-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 30345838, "answer_count": 1, "score": 0, "last_activity_date": 1432114512, "creation_date": 1432109372, "question_id": 30343847, "link": "https://stackoverflow.com/questions/30343847/access-form-vba-update-record", "title": "Access Form Vba Update Record", "body": "<p>I want to update a record in Microsoft Access database using forms but is giving and error Expected en of statement. :|</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE [Ensamblador]\" _\n\"SET NumerodeEnsamblador=\" &amp; Me.textboxone  &amp; \"\" _\n\", NombredeEnsamblador='\" &amp; Me.textboxtwo &amp; \"'\" &amp; _\n\", Especialidad='\" &amp; Me.textboxthree &amp; \"'\" &amp; _\n\" WHERE NumerodeEnsamblador=\" &amp; Me.textboxone\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432140063, "post_id": 30348683, "comment_id": 48803370, "body": "Do you use the passed parameter now for getting attachments?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1432148851, "post_id": 30348683, "comment_id": 48808446, "body": "Use <code>Set colAtts = olMail.Attachments</code> instead. See the code I posted."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432150168, "post_id": 30348683, "comment_id": 48809189, "body": "Perfect. Thank you very much."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1432122194, "creation_date": 1432122194, "answer_id": 30348683, "question_id": 30343834, "link": "https://stackoverflow.com/questions/30343834/runtime-error-91-outlook-save-attchments/30348683#30348683", "title": "Runtime error 91 Outlook Save Attchments", "body": "<p>The <code>olAtt</code> object is declared, but not initialized in the code. You need to use the <code>olMail</code> object instead in the code:</p>\n\n<pre><code>Private Sub SaveMovePrint(olMail As Outlook.MailItem)\n    'On Error Resume Next\n    Dim colAtts As Outlook.Attachments\n    Dim olFile As String\n    Dim olDirectory As String\n    Dim olFileType As String\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olInbox As Outlook.Folder\n    Dim olDestFolder As Outlook.Folder\n    Dim olItems As Outlook.Items\n    Dim olItem As Object\n\n    Set colAtts = olMail.Attachments\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olInbox = olNameSpace.GetDefaultFolder(olFolderInbox)\n    Set olItems = olInbox.Items\n\n    '// Save attachment then move\n    If colAtts.Count Then\n\n        '// Select Case save attch move\n        Select Case olMail.SenderEmailAddress\n            '// One\n            Case \"FaxOne@one.com\"\n                '// Save it to\n                olDirectory = \"C:\\Users\\Documents\\FaxOne\\\"\n                '// Move email to subfolder\n                Set olDestFolder = olInbox.Folders(\"FaxOne\")\n                Set olItem = olItems.Find(\"[SenderName] = FaxOne@one.com'\")\n                While TypeName(olItem) &lt;&gt; \"Nothing\"\n                    olItem.Move olDestFolder\n                Set olItem = olItems.FindNext\n                Wend\n\n            '// Two\n            Case \"FaxTwo@two.com\"\n                '// Save attachments to\n                olDirectory = \"C:\\Users\\Documents\\FaxTwo\\\" \n                Set olDestFolder = olInbox.Folders(\"FaxTwo\")\n                Set olItem = olItems.Find(\"[SenderName] = 'FaxTwo@two.com'\")\n                While TypeName(olItem) &lt;&gt; \"Nothing\"\n                    olItem.Move olDestFolder\n                Set olItem = olItems.FindNext\n                Wend\n            Case Else: Exit Sub\n        End Select\n\n        For Each olAtt In colAtts\n\n            '// The code looks last 4 characters,\n            '// including period and will work as long\n            '// as you use 4 characters in each extension.\n            olFileType = LCase$(Right$(olAtt.FileName, 4))\n\n            '// Select Case File &amp; Print\n            Select Case olFileType\n\n                '// Add additional file types below\n                Case \"docx\", \".pdf\", \".doc\"\n\n                olFile = olDirectory &amp; olAtt.FileName\n                olAtt.SaveAsFile olFile\n\n                '// to print attachements\n                ShellExecute 0, \"print\", olFile, vbNullString, vbNullString, 0\n            End Select\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 30348683, "answer_count": 1, "score": 0, "last_activity_date": 1592993909, "creation_date": 1432109341, "last_edit_date": 1592993909, "question_id": 30343834, "link": "https://stackoverflow.com/questions/30343834/runtime-error-91-outlook-save-attchments", "title": "Runtime error 91 Outlook Save Attchments", "body": "<blockquote>\n  <blockquote>\n    <p><em>Runtime error 91 -Object Variable or With Block variable not set</em></p>\n  </blockquote>\n</blockquote>\n\n<p>I'm getting Error 91<br>\nI am trying to save attachment as they arrive and then move it to sub-folder  then print.</p>\n\n<p>I am using the code on ThisOutlookSession</p>\n\n<pre><code>Private Sub SaveMovePrint(olMail As Outlook.MailItem)\n    'On Error Resume Next\n    Dim colAtts As Outlook.Attachments\n    Dim olAtt As Outlook.Attachment\n    Dim olFile As String\n    Dim olDirectory As String\n    Dim olFileType As String\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olInbox As Outlook.Folder\n    Dim olDestFolder As Outlook.Folder\n    Dim olItems As Outlook.Items\n    Dim olItem As Object\n</code></pre>\n\n<p>this line is where the Error is coming from <code>Set colAtts = olAtt.Attachments</code></p>\n\n<pre><code>    Set colAtts = olAtt.Attachments\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olInbox = olNameSpace.GetDefaultFolder(olFolderInbox)\n    Set olItems = olInbox.Items\n\n    '// Save attachment then move\n    If colAtts.Count Then\n\n        '// Select Case save attch move\n        Select Case olMail.SenderEmailAddress\n            '// One\n            Case \"FaxOne@one.com\"\n                '// Save it to\n                olDirectory = \"C:\\Users\\Documents\\FaxOne\\\"\n                '// Move email to subfolder\n                Set olDestFolder = olInbox.Folders(\"FaxOne\")\n                Set olItem = olItems.Find(\"[SenderName] = FaxOne@one.com'\")\n                While TypeName(olItem) &lt;&gt; \"Nothing\"\n                    olItem.Move olDestFolder\n                Set olItem = olItems.FindNext\n                Wend\n\n            '// Two\n            Case \"FaxTwo@two.com\"\n                '// Save attachments to\n                olDirectory = \"C:\\Users\\Documents\\FaxTwo\\\" \n                Set olDestFolder = olInbox.Folders(\"FaxTwo\")\n                Set olItem = olItems.Find(\"[SenderName] = 'FaxTwo@two.com'\")\n                While TypeName(olItem) &lt;&gt; \"Nothing\"\n                    olItem.Move olDestFolder\n                Set olItem = olItems.FindNext\n                Wend\n            Case Else: Exit Sub\n        End Select\n\n        For Each olAtt In colAtts\n\n            '// The code looks last 4 characters,\n            '// including period and will work as long\n            '// as you use 4 characters in each extension.\n            olFileType = LCase$(Right$(olAtt.FileName, 4))\n\n            '// Select Case File &amp; Print\n            Select Case olFileType\n\n                '// Add additional file types below\n                Case \"docx\", \".pdf\", \".doc\"\n\n                olFile = olDirectory &amp; olAtt.FileName\n                olAtt.SaveAsFile olFile\n\n                '// to print attachements\n                ShellExecute 0, \"print\", olFile, vbNullString, vbNullString, 0\n            End Select\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "inputbox"], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 0, "last_activity_date": 1432136998, "creation_date": 1432136998, "answer_id": 30354561, "question_id": 30343722, "link": "https://stackoverflow.com/questions/30343722/access-save-inputbox-value-to-datasheet-table/30354561#30354561", "title": "Access - Save inputbox value to datasheet (table)", "body": "<p>Try:</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO [Registratie formulier].[PV_Location] \" _\n    &amp; \"(PV_Location) VALUES \" _\n    &amp; \"('\" &amp; hyperlink_pv_var$ &amp; \"');\"\n</code></pre>\n\n<p>Notes:</p>\n\n<ol>\n<li>If a field, table or database name contains a blank, enclose in <code>[ ]</code></li>\n<li>This code assumes that <code>hyperlink_pv_var$</code> is always a string.</li>\n</ol>\n"}], "owner": {"reputation": 31, "user_id": 4400483, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a35900f5383704754e02ea58d9ea4a95?s=128&d=identicon&r=PG&f=1", "display_name": "PatrickStel", "link": "https://stackoverflow.com/users/4400483/patrickstel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 30354561, "answer_count": 1, "score": 0, "last_activity_date": 1594652336, "creation_date": 1432109067, "last_edit_date": 1594652336, "question_id": 30343722, "link": "https://stackoverflow.com/questions/30343722/access-save-inputbox-value-to-datasheet-table", "title": "Access - Save inputbox value to datasheet (table)", "body": "<p>I'm stuck on a problem I've tried several outcomes I've found on the Internet but I can't seem to get it working.</p>\n\n<pre><code>'Pop-up for information where the pv is located and save it to the db\nPrivate Sub Destroyed_pv_Click()\nIf Me.Destroyed_pv = vbTrue Then\n    Dim Strg As String, hyperlink_pv_var$\n    Strg = \"Typ your location here...\"\n    Strg = InputBox(\"Fill in the location of the PV.\", \"PV Location\", Strg)\n    If Strg = \"\" Then\n        hyperlink_pv_var$ = \"You didn't fill in the box\"\n    Else\n        hyperlink_pv_var$ = \"Location of the PV is: \" &amp;vbNewLine &amp; Strg\n    End If\n    MsgBox hyperlink_pv_var$\nElse\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I need to put the outcome of hyperlink_pv_var$ in my datasheet (table)\nI've tried this</p>\n\n<pre><code>DoCmd.RunSQL \"INSERT INTO Registratie formulier.PV_Location\"_&amp;\"(PV_Location) VALUES \"_&amp;\"(hyperlink_pv_var$);\"\n</code></pre>\n\n<p>But this doesn't work. I hope you guys can help me out with this.</p>\n\n<p>Cheers,\nPatrick</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432107311, "post_id": 30342929, "comment_id": 48779583, "body": "You don&#39;t need VBA, just use the <code>INDIRECT()</code> function."}, {"owner": {"reputation": 1, "user_id": 4919181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ob6euZKgB14/AAAAAAAAAAI/AAAAAAAAABQ/0SS8T6hojVM/photo.jpg?sz=128", "display_name": "Kobelco Norge", "link": "https://stackoverflow.com/users/4919181/kobelco-norge"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432107530, "post_id": 30342929, "comment_id": 48779738, "body": "Hei, thanks, I&#39;m a bit new to this how would I use the Indirect() function to show the named range in my listbox ?"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432107695, "post_id": 30342929, "comment_id": 48779844, "body": "Validation rule: List; rule: <code>=INDIRECT($A$1)</code>, If the value of <code>A1</code> is <code>list1</code> then the validation list will be the array of <code>list1</code>&#39;s cell values. If <code>A1</code> contains &quot;A8:A15&quot; then the validation rule will be <code>A8:A15</code>."}, {"owner": {"reputation": 1, "user_id": 4919181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ob6euZKgB14/AAAAAAAAAAI/AAAAAAAAABQ/0SS8T6hojVM/photo.jpg?sz=128", "display_name": "Kobelco Norge", "link": "https://stackoverflow.com/users/4919181/kobelco-norge"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432114888, "post_id": 30342929, "comment_id": 48784575, "body": "I&#39;m using a mulicolumn userform listbox which is using VBA to select rows and populate workbook cells with numbers and text. Can I use Indirect() function here ? \u2013"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432116087, "post_id": 30342929, "comment_id": 48785506, "body": "Sorry, I was not thinking in terms of a listbox but in terms of a validation list. When asking for advices on how to do something in VBA you are supposed to bring your code here, otherwise it&#39;s not education but programming, which we&#39;re not doing (for free). The vague description below could be the most you can get without even trying to create something upfront."}, {"owner": {"reputation": 1, "user_id": 4919181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ob6euZKgB14/AAAAAAAAAAI/AAAAAAAAABQ/0SS8T6hojVM/photo.jpg?sz=128", "display_name": "Kobelco Norge", "link": "https://stackoverflow.com/users/4919181/kobelco-norge"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1432205613, "post_id": 30342929, "comment_id": 48833216, "body": "Hei, understand and I&#39;m not looking for &#39;free&#39; coding. Ive set up a new user form with listbox and set my named range from the value in cell B2. This value corresponds to named ranges in a price list. To load the correct range into the list Box, I&#39;m using   :                                                 If rRange = &quot;SK75SR3E&quot; Then ListBox1.RowSource = &quot;SK75SR3E&quot;. There are alot of named ranges in the list, is there a more effecitve VBA Method which could be used ?"}], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1432107849, "creation_date": 1432107849, "answer_id": 30343318, "question_id": 30342929, "link": "https://stackoverflow.com/questions/30342929/vba-code-to-use-cell-value-to-select-and-show-named-range-in-a-listbox-in-excel/30343318#30343318", "title": "VBA code to use cell value to select and show named range in a listbox in excel", "body": "<p>The VBA solution I would suppose:<br>\nCreate an array with the numerosity of your named range<br>\nadd each cell's value in your named range to the corresponding array position<br>\njoin the array with commas and add the resulting string to your cell's validation rule.</p>\n"}], "owner": {"reputation": 1, "user_id": 4919181, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ob6euZKgB14/AAAAAAAAAAI/AAAAAAAAABQ/0SS8T6hojVM/photo.jpg?sz=128", "display_name": "Kobelco Norge", "link": "https://stackoverflow.com/users/4919181/kobelco-norge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1432107849, "creation_date": 1432106626, "last_edit_date": 1531164843, "question_id": 30342929, "link": "https://stackoverflow.com/questions/30342929/vba-code-to-use-cell-value-to-select-and-show-named-range-in-a-listbox-in-excel", "title": "VBA code to use cell value to select and show named range in a listbox in excel", "body": "<p>Hei \nI would like A1 cell value to point to a named range and show this in a listbox.  The value in A1 is text which corresponds to one of many named ranges in a price list. If I select for e.g. value 'list1' in cell A1 then the corresponding named range shows in the listbox. How can I do this with VBA in Excel ? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "edited": false, "score": 0, "creation_date": 1432108565, "post_id": 30343384, "comment_id": 48780358, "body": "I feel like option one is much more simple! Will that take the entire row with it though? I need the whole entry."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "edited": false, "score": 0, "creation_date": 1432108682, "post_id": 30343384, "comment_id": 48780433, "body": "Sure if will take all columns if you use <code>SELECT *</code> or it can take just some columns if you name them like <code>SELECT Address, ZIP</code>. See my post just to learn more on how to use Microsoft Queries in Excel: <a href=\"http://www.analystcave.com/excel-tools/excel-sql-add-in-free/\" rel=\"nofollow noreferrer\">analystcave.com/excel-tools/excel-sql-add-in-free</a>"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "edited": false, "score": 0, "creation_date": 1432109205, "post_id": 30343384, "comment_id": 48780722, "body": "Would appreciate the +1 if this proved helpful"}, {"owner": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "edited": false, "score": 0, "creation_date": 1432134457, "post_id": 30343384, "comment_id": 48799493, "body": "I could not get the first option to work. The second is basically how I planned to do it origanly but the amount of code to do this is quite large. There are roughly 40 zips that I will need to filter through. It may be my only option though"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "edited": false, "score": 0, "creation_date": 1432134786, "post_id": 30343384, "comment_id": 48799730, "body": "Checkout my updated post. I included a screenshot using my AddIn. You may just as well use Data-&gt;From other...-&gt;Microsoft Query"}, {"owner": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "edited": false, "score": 0, "creation_date": 1432135872, "post_id": 30343384, "comment_id": 48800557, "body": "I see how that would work well but im not sure how you are able to compare to &quot;ZIP&quot; how do you label your columns like that? furthermore I need to be able to automate the process so a coworker can use this file."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "edited": false, "score": 0, "creation_date": 1432135961, "post_id": 30343384, "comment_id": 48800607, "body": "The label is simply the value of the first cell in the column of your Sheet1 worksheet. That&#39;s how Microsoft Query works. The labels should be in row #1. Anyone can use the file as it is a standard MS Query. The AddIn is just to make it easier to create the queries - its open source anyway in VBA"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1432134742, "last_edit_date": 1432134742, "creation_date": 1432108031, "answer_id": 30343384, "question_id": 30342704, "link": "https://stackoverflow.com/questions/30342704/i-need-to-copy-rows-with-matching-zips-to-their-corresponding-sheets/30343384#30343384", "title": "I need to copy rows with matching zips to their corresponding sheets", "body": "<h2>Option 1: Use Microsoft Query on each Worksheet in Excel</h2>\n\n<p>Create on each worksheet a quick MS Query like the one below.</p>\n\n<pre><code>SELECT * FROM [Sheet1$] WHERE ZIP = \"94585\"\n</code></pre>\n\n<p>In case you need more than 1 ZIP code:</p>\n\n<pre><code>SELECT * FROM [Sheet1$] WHERE ZIP = \"94585\" OR ZIP = \"94586\"\n</code></pre>\n\n<p>How to create Microsoft Queries in Excel? Go to <code>Data-&gt;From Other Sources-&gt;Microsoft Query</code> or use my AddIn: <a href=\"http://www.analystcave.com/excel-tools/excel-sql-add-in-free/\" rel=\"nofollow noreferrer\">link here</a>.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZLA5H.png\" alt=\"Using Microsoft Query to get subset of Zip records\"></p>\n\n<h2>Option 2: VBA Macro</h2>\n\n<p>Create a VBA macro that:</p>\n\n<ol>\n<li>Traverses across the Worksheets</li>\n<li>Checks the ZIP code in the name of the Worksheet (i am guessing this is how it's organized)</li>\n<li>Traverses all rows in <code>Sheet1</code> and copies the row if it matches the ZIP(s)</li>\n</ol>\n\n<p>Some code stubs below:</p>\n\n<p><strong>Traversing worksheets</strong></p>\n\n<pre><code>for each ws in ActiveWorkbook.Sheets\n  'Your code here\nNext ws\n</code></pre>\n\n<p><strong>Traverse rows and check if matching zip(s)</strong></p>\n\n<pre><code>  for i = 1 to i = (ws.Range(\"A1\").End(xlDown).Row-1)\n  if Range(\"A1\").Offset(i).Value = ZIP1 or Range(\"A1\").Offset(i).Value = ZIP2 then\n    'Copy the row\n  end if\nNext ws\n'ws - is Sheet1\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 2192823, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5535893444af9df62591c741d0672ab1?s=128&d=identicon&r=PG", "display_name": "M.Stair", "link": "https://stackoverflow.com/users/2192823/m-stair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432134742, "creation_date": 1432105864, "question_id": 30342704, "link": "https://stackoverflow.com/questions/30342704/i-need-to-copy-rows-with-matching-zips-to-their-corresponding-sheets", "title": "I need to copy rows with matching zips to their corresponding sheets", "body": "<p>As you can see in the image I have a column with zip codes and sheets that match up. I need to have all of the zip codes that match a sheet copied over, another issue is that some sheets are made up of two or more zip codes. I know I can do this with an incredible amount of If statements nested in a Do Until but I feel like that is a very inefficient way to do this. I am still learning so I was hoping someone might be able to help out. Thanks in advance. </p>\n\n<p><img src=\"https://i.stack.imgur.com/ScKLN.png\" alt=\"Data\"></p>\n"}, {"tags": ["vba", "excel", "ms-access", "ms-access-2003"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1432109023, "post_id": 30342536, "comment_id": 48780619, "body": "<a href=\"http://www.excelhelpdesk.com/macros/disable-alerts-warning-messages-excel/\" rel=\"nofollow noreferrer\">Does this help?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 1, "last_activity_date": 1432115719, "creation_date": 1432115719, "answer_id": 30346280, "question_id": 30342536, "link": "https://stackoverflow.com/questions/30342536/suppress-ms-access-excel-warning-error/30346280#30346280", "title": "Suppress MS Access Excel warning/error", "body": "<p>You could try something like</p>\n\n<pre><code>xlApp.application.displayalerts = false\nxlApp.xlWB.SaveAs &lt;NAME OF FILE&gt;, FileFormat:=56\nxlApp.xlWB.close true\nxlApp.application.displayalerts = True\n</code></pre>\n\n<p>Change NAME OF APPLICATION to the filepath and filename of the xls you are saving.</p>\n\n<p>xlApp should be the ref to Excel from Access, xlWB is the ref to the workbook itself. names may need to be changed to match your code but should be enough to get you on your way.</p>\n"}], "owner": {"reputation": 1410, "user_id": 3713955, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/189c41b6e8cd9db66d5adc85813172cc?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Gupta", "link": "https://stackoverflow.com/users/3713955/rahul-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 30346280, "answer_count": 1, "score": 0, "last_activity_date": 1432115719, "creation_date": 1432105447, "last_edit_date": 1531164843, "question_id": 30342536, "link": "https://stackoverflow.com/questions/30342536/suppress-ms-access-excel-warning-error", "title": "Suppress MS Access Excel warning/error", "body": "<p>I am trying to suppress the message window, I receive when I try to save the Excel from MS Access 2003. <br> \nI am getting the following error. <br>\nReport.xls is a Microsoft excel 95/5.0 workbook. Do you want to overwrite with latest excel format? <br>\nI want to set it to 'Yes' by default. <br>\nHow can I achieve this in MS Access 2003? Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "file-handling"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1432115054, "post_id": 30340802, "comment_id": 48784694, "body": "Are the last six characters always the date? What is the format of the date: yyyy-mm-dd or mm/dd/yyyy or dd.mm.yyyy or yyyyddmm .... Is the date recognized by Excel as such? Did you verify using <code>IsDate(Right(backup, 6))</code>? I also believe that you are mixing up two questions: (1) which backup is outdated &gt; 30 days compared to now and (2) which is the latest backup. In order to get an answer to both questions it would be good to have all backups parsed into name and date into an array and then sort it. Then you can get both questions answered."}, {"owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1432116481, "post_id": 30340802, "comment_id": 48785828, "body": "Yes, the end is always the same. <code>&lt;year-month-day_hour-minute-second.zip&gt;</code> ex. <code>&lt;name&gt;_2015-05-18_09-24-22.zip</code>. The name is always the same length: 7 characters + &quot;_&quot; I can get the exact date with <code>FileDateTime(file)</code> for a single file, but when there are two, I will still get only one result. Tried <code>msgbox IsDate(Mid(file, 9, 19)</code>, I get false as result. The question I want to get the answer for looks like: If the file exists: <code>If InStr(file, backup) &gt; 0</code> than if the latest file backup older than 30 days? <code>If now - FileDateTime(file) &gt; 30</code> Problem is that I can not refer to <b>latest file</b>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1432122209, "post_id": 30340802, "comment_id": 48789774, "body": "I believe the code you are looking for can be found (in a modified context) here: <a href=\"http://stackoverflow.com/questions/22305857/vba-loop-through-directory\" title=\"vba loop through directory\">stackoverflow.com/questions/22305857/vba-loop-through-direct&zwnj;&#8203;ory</a>"}], "answers": [{"tags": [], "owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "is_accepted": true, "score": 1, "last_activity_date": 1432199479, "last_edit_date": 1432199479, "creation_date": 1432198740, "answer_id": 30369025, "question_id": 30340802, "link": "https://stackoverflow.com/questions/30340802/how-to-make-excel-backup-checker-script-get-file-with-newest-date/30369025#30369025", "title": "How to make excel backup checker script get file with newest date", "body": "<p>I have found a way around it using the <code>Dir()</code> function:</p>\n\n<pre><code>'auto check if backup exists - on click\n\nDim i\ni = 1\n\nfile = Dir(path)\nDo While file &lt;&gt; \"\"\n    myBool = False\n    isnew = False\n    backup = Right(backup, 6)\n        If InStr(file, backup) &gt; 0 Then\n\n            myBool = True\n            cfile = Dir(path &amp; Left(c, 7) &amp; \"*\") 'c is the active cell\n\n            Do While cfile &lt;&gt; \"\"\n                ReDim arr(i)\n                arr(i) = FileDateTime(path &amp; cfile)\n\n                If Now - arr(i) &lt; 30 Then\n                    isnew = True\n                End If\n\n                i = i + 1\n                cfile = Dir()\n            Loop                \n\n            If isnew = False Then\n                ActiveCell.Interior.ColorIndex = \"6\"\n            ElseIf isnew = True Then\n                ActiveCell.Interior.ColorIndex = \"35\"\n            End If\n\n            Exit Do\n        End If\n    file = Dir\nLoop\n    If Not myBool Then\n        ActiveCell.Interior.ColorIndex = \"22\"\n    End If\n</code></pre>\n"}], "owner": {"reputation": 466, "user_id": 1402297, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7ebbe4844ac99c1c36164b1378c08bcd?s=128&d=identicon&r=PG", "display_name": "Divin3", "link": "https://stackoverflow.com/users/1402297/divin3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 30369025, "answer_count": 1, "score": 0, "last_activity_date": 1432199479, "creation_date": 1432099011, "last_edit_date": 1531164843, "question_id": 30340802, "link": "https://stackoverflow.com/questions/30340802/how-to-make-excel-backup-checker-script-get-file-with-newest-date", "title": "How to make excel backup checker script get file with newest date", "body": "<p>I have a program that creates backups after format: <code>&lt;name&gt;_&lt;date&gt;</code>  </p>\n\n<p>Some of them have more backups, some of them have none.  </p>\n\n<p>There are kept up to 3 backups with same name but different dates.</p>\n\n<p>I have an excel table that contains names and a script that checks if there is a backup or not, and colors the cell after the result. </p>\n\n<p>I want to improve the script, so it would check if the backup is outdated (older than 30 days).</p>\n\n<p>I have got the idea, but I ran into a problem. If there are multiple backups of the same name, I cant figure out, how to make it compare the newest of them.</p>\n\n<p>the script:</p>\n\n<pre><code>'auto check if backup exists - on click\nfile = Dir(\"&lt;filepath&gt;\")\nDo While file &lt;&gt; \"\"\n    myBool = False\n    backup = Right(backup, 6)\n        If InStr(file, backup) &gt; 0 Then\n            If now - FileDateTime(file) &gt; 30 Then 'this is where I have the problem... how do I make it grab the newest of the backups?\n            'outdated \n            End If\n\n            myBool = True\n            ActiveCell.Interior.ColorIndex = \"35\"\n            Exit Do\n        End If\n    file = Dir\nLoop\n    If Not myBool Then\n        ActiveCell.Interior.ColorIndex = \"22\"\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21, "user_id": 4918738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe50be50a07365c11052f838a2fe7b3?s=128&d=identicon&r=PG&f=1", "display_name": "Bianca", "link": "https://stackoverflow.com/users/4918738/bianca"}, "reply_to_user": {"reputation": 7810, "user_id": 3852907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/81EFQ.jpg?s=128&g=1", "display_name": "Anirudh Sharma", "link": "https://stackoverflow.com/users/3852907/anirudh-sharma"}, "edited": false, "score": 0, "creation_date": 1432098396, "post_id": 30340590, "comment_id": 48774894, "body": "wrong number of arguments or invalid property assignment."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1432103882, "post_id": 30340590, "comment_id": 48777335, "body": "see if this helps <a href=\"http://dmcritchie.mvps.org/excel/sheets.htm\" rel=\"nofollow noreferrer\">Link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4918738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe50be50a07365c11052f838a2fe7b3?s=128&d=identicon&r=PG&f=1", "display_name": "Bianca", "link": "https://stackoverflow.com/users/4918738/bianca"}, "edited": false, "score": 0, "creation_date": 1432101326, "post_id": 30340728, "comment_id": 48776037, "body": "Thanks! I tried this but it shows error on this part: For iCol = 1 To dataSheet.UsedRange.Rows.Count"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1432099093, "last_edit_date": 1432099093, "creation_date": 1432098687, "answer_id": 30340728, "question_id": 30340590, "link": "https://stackoverflow.com/questions/30340590/vba-how-can-i-reference-multiple-sheets/30340728#30340728", "title": "VBA. How can I reference multiple sheets?", "body": "<p>use <code>Set datasheet = Worksheets(Array(\"CAP\", \"RES\"))</code> as in example below</p>\n\n<pre><code>Sub test()\n    Dim sh As Worksheet, datasheet As Object\n    Set datasheet = Worksheets(Array(\"CAP\", \"RES\"))\n    For Each sh In datasheet\n        Debug.Print sh.Name\n    Next sh\nEnd Sub\n</code></pre>\n\n<p>output</p>\n\n<p><img src=\"https://i.stack.imgur.com/vpq5D.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 21, "user_id": 4918738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe50be50a07365c11052f838a2fe7b3?s=128&d=identicon&r=PG&f=1", "display_name": "Bianca", "link": "https://stackoverflow.com/users/4918738/bianca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1432103063, "creation_date": 1432097915, "last_edit_date": 1531164843, "question_id": 30340590, "link": "https://stackoverflow.com/questions/30340590/vba-how-can-i-reference-multiple-sheets", "title": "VBA. How can I reference multiple sheets?", "body": "<p>This is  my working code:</p>\n\n<pre><code>Set newwbk = Workboooks.Open(Newtext.Text)\nSet newSheet = newwbk.Worksheets(\"Sheet1\")\nSet datawbk = Workboooks.Open(Datatext.Text)\nSet dataSheet = datawbk.Worksheets(\"CAP\", \"RES\")\n</code></pre>\n\n<p>I am having an error at the second line. Can anyone help me? </p>\n\n<p>How can I reference the \"Two sheets CAP and RES\"?<br>\nWhat I am trying to do is compare the \"datawbk\" (which has multiple sheets) with another workbook, say \"newwbk\" (only one sheet), then for example if they have same input in D2, the whole row of D2 (A2, B2, C2, E2...) in \"newwbk\" will be filled up with what is written in \"datawbk\" A2, B2, C2, etc. respectively.</p>\n"}, {"tags": ["regex", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1432098577, "post_id": 30340657, "comment_id": 48774958, "body": "jus a qn: when i tried &quot;[\\d+]&quot;, it was returning all the letters. Why is that so? i thought that \\d looks for digits in a string right?"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 1, "creation_date": 1432098901, "post_id": 30340657, "comment_id": 48775081, "body": "\\d+ means one or more digits. So the RegEx stripped off everything except the numbers 0-9 and gave you <code>650000000000593000000</code>. With \\d.:+ we asked RegEx to keep 0-9, dot and colon but strip out everything else."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1432099000, "post_id": 30340657, "comment_id": 48775135, "body": "but u have entered &quot;[^\\d.:+]&quot; not [\\d.:+]. so where is the difference?"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "reply_to_user": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1432099615, "post_id": 30340657, "comment_id": 48775391, "body": "Correct usage is <code>[^\\d.:+]</code>. I wrote <code>\\d.:+</code> in a hurry. <code>[^\\d.:+]</code>s beauty lies in the <code>^</code> part of the RegEx. The caret symbol inverts the selection; meaning, it match all characters that are <b>not</b> a digit, dot or colon. That&#39;s how you can strip characters you don&#39;t want."}, {"owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "edited": false, "score": 0, "creation_date": 1432101313, "post_id": 30340657, "comment_id": 48776033, "body": "i thought it was re.Execute, didn&#39;t know it is re.Replace. Thanks a lot."}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 2, "last_activity_date": 1432098269, "creation_date": 1432098269, "answer_id": 30340657, "question_id": 30340528, "link": "https://stackoverflow.com/questions/30340528/getting-only-digits-in-a-string-using-regex-in-vba/30340657#30340657", "title": "Getting only digits in a string using regex in vba", "body": "<p>Just did a minor change in your regex. Instead of just using <code>[^\\d+]</code>, now <code>[^\\d.:+]</code> is being used to indicate that we would like one or more of digits, dots or colons. Then, colon is replaced with a comma to get the desired result.</p>\n\n<pre><code>Sub Test()\n    Dim tempString As String\n    tempString = \"65.00000000;ACCUMPOINTS;Double:0.0593000000;D\"\n    temp = NumericOnly(tempString)\n    MsgBox temp\nEnd Sub\n\nPublic Function NumericOnly(s As String) As String\n    Dim s2 As String\n    Dim replace_hyphen As String\n    replace_hyphen = \" \"\n    Static re As VBScript_RegExp_55.RegExp\n    If re Is Nothing Then Set re = New RegExp\n    re.IgnoreCase = True\n    re.Global = True\n\n    re.Pattern = \"[^\\d.:+]\"\n    s2 = re.Replace(s, vbNullString)\n\n    re.Pattern = \"[^\\d.:+]\"\n\n    NumericOnly = re.Replace(s2, replace_hyphen)\n    NumericOnly = Replace(NumericOnly, \":\", \",\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1959, "favorite_count": 0, "accepted_answer_id": 30340657, "answer_count": 1, "score": 1, "last_activity_date": 1432098269, "creation_date": 1432097574, "question_id": 30340528, "link": "https://stackoverflow.com/questions/30340528/getting-only-digits-in-a-string-using-regex-in-vba", "title": "Getting only digits in a string using regex in vba", "body": "<p>I have a string as such:</p>\n\n<pre><code>tempString = \"65.00000000;ACCUMPOINTS;Double:0.0593000000;D\"\n</code></pre>\n\n<p>And my output shld be <code>\"65.000000,0.0593000000\"</code> or at least give two separated values.</p>\n\n<p>I am using regex to find the values in the string.</p>\n\n<p>My code:</p>\n\n<pre><code>tempString = \"65.00000000;ACCUMPOINTS;Double:0.0593000000;D\"\ntemp = NumericOnly(tempString)\n\nPublic Function NumericOnly(s As String) As String\n    Dim s2 As String\n    Dim replace_hyphen As String\n    replace_hyphen = \" \"\n    Static re As VBScript_RegExp_55.RegExp\n    If re Is Nothing Then Set re = New RegExp\n    re.IgnoreCase = True\n    re.Global = True\n    re.Pattern = \"[^\\d+]\" 'includes space, if you want to exclude space \"[^0-9]\"(\"-?\\\\d+\");\n    s2 = re.Replace(s, vbNullString)\n    re.Pattern = \"[^\\d+]\"\n    NumericOnly = re.Replace(s2, replace_hyphen)\nEnd Function\n</code></pre>\n\n<p>My output is like this:</p>\n\n<pre><code>\"650000000000593000000\"\n</code></pre>\n\n<p>How to go about doing this? Need some help.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1432094354, "post_id": 30339997, "comment_id": 48773680, "body": "Doesn&#39;t Access already have <a href=\"https://www.safaribooksonline.com/library/view/access-2003-for/0596006659/httpatomoreillycomsourceoreillyimages2038290.png.jpg\" rel=\"nofollow noreferrer\">something like that</a>?"}, {"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "reply_to_user": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1432094500, "post_id": 30339997, "comment_id": 48773726, "body": "Yes it does (you are referring to the property which allows you to display the navigation buttons and the record count at the bottom).  I am looking for the way to allow for me to rebuild those functions to give me more flexibility and variety with the buttons (controls)"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1432096032, "post_id": 30339997, "comment_id": 48774137, "body": "Ah, I see, you are looking to customize and control the look and feel instead of relying on the one supplied. Let me put a quick example code together."}], "answers": [{"comments": [{"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1432096960, "post_id": 30340303, "comment_id": 48774434, "body": "Excellent! This will be reviewed thoroughly the first chance i get and then I will let you know. Thank you."}, {"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1432365484, "post_id": 30340303, "comment_id": 48907042, "body": "Thank you Zedfoxus. This is absolutely what I need. I have an issue with this solution however, the form where I am building this, on the load event queries a table.  The solution you provided me above includes all records in the table.  What I need is the DCount function to only consider records in the query. I am sure this is possible but I cant figure it out. Thanks"}, {"owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1432365686, "post_id": 30340303, "comment_id": 48907086, "body": "Me.etcRecordNumber.Caption = &quot;Record &quot; &amp; Me.CurrentRecord &amp; &quot; of &quot; &amp; DCount(&quot;ID&quot;, &quot;tblCompetency06&quot;) WHERE [tblcompetency].[teamID]= &#39;&quot; &amp; me.teamid &amp; &quot;&#39;&quot;"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "reply_to_user": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "edited": false, "score": 0, "creation_date": 1432399713, "post_id": 30340303, "comment_id": 48916383, "body": "@MarcheseIlChihuahua Edited the answer with code that will help with the case you described"}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 1, "last_activity_date": 1432399640, "last_edit_date": 1432399640, "creation_date": 1432096212, "answer_id": 30340303, "question_id": 30339997, "link": "https://stackoverflow.com/questions/30339997/how-to-count-records-and-its-numerical-value/30340303#30340303", "title": "How to count records and it&#39;s numerical value", "body": "<p>On my form I placed a label and called it lblRecords:</p>\n\n<p>On the Form's Current event, Form's CurrentRecord to get the current record number. Although <code>DCount</code> is used below, please read through <a href=\"http://www.fontstuff.com/mailbag/qaccess04.htm\" rel=\"nofollow\">http://www.fontstuff.com/mailbag/qaccess04.htm</a> for examples better than <code>DCount</code> to count number of records.</p>\n\n<pre><code>Private Sub Form_Current()\n    Me.lblRecords.Caption = \"Record \" &amp; Me.CurrentRecord &amp; \" of \" &amp; DCount(\"ID\", \"Table1\")\nEnd Sub\n</code></pre>\n\n<p>Using <a href=\"http://www.slxdeveloper.com/page.aspx?action=viewarticle&amp;articleid=33\" rel=\"nofollow\">ADODB</a>, a record count can also be obtained.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>To get recordcount of the datasource bound to the form, one can do this:</p>\n\n<pre><code>Private Sub Form_Current()\n    Me.lblRecords.Caption = \"Record \" &amp; Me.CurrentRecord &amp; \" of \" &amp; RecordCount()\nEnd Sub\n\n\nFunction RecordCount() As Integer\n\nOn Error GoTo ErrorHandler\n    Dim RecordsClone As Object\n\n    Set RecordsClone = Me.RecordsetClone\n    RecordsClone.MoveLast\n    RecordCount = RecordsClone.RecordCount\n    Exit Function\n\nErrorHandler:\n    RecordCount = \"NA\"\n\nEnd Function\n</code></pre>\n\n<p>If the form is bound to a query that shows only a small subset of records from a table, <code>Function RecordCount()</code> will show correct information of the number of records.</p>\n\n<p>But what if the data source of the form is changed dynamically using VBA? The above function will still work correctly. Here's an example of how one can change the data source of the form dynamically.</p>\n\n<pre><code>Public Sub ChangeFormQuery()\n    Form_Form1.RecordSource = \"select * from table1 where [id] between 3 and 4\"\n    Form_Form1.Requery\n    Form_Form1.Refresh\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "is_accepted": false, "score": 0, "last_activity_date": 1432367390, "creation_date": 1432367390, "answer_id": 30410298, "question_id": 30339997, "link": "https://stackoverflow.com/questions/30339997/how-to-count-records-and-its-numerical-value/30410298#30410298", "title": "How to count records and it&#39;s numerical value", "body": "<p>In alternative to using the DCount function, the following is an optimal solution using the label called 'etcRecordNumber' :</p>\n\n<pre><code>RC = Form_frmStaticDataSkills03.Recordset.RecordCount\nRN = Form_frmStaticDataSkills03.CurrentRecord\n\nMe.etcRecordNumber.Caption = \"This is record \" &amp; RN &amp; \" of \" &amp; RC\n</code></pre>\n"}], "owner": {"reputation": 1027, "user_id": 3140837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/668051698/picture?type=large", "display_name": "Marchese Il Chihuahua", "link": "https://stackoverflow.com/users/3140837/marchese-il-chihuahua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 30340303, "answer_count": 2, "score": 0, "last_activity_date": 1594644539, "creation_date": 1432094137, "last_edit_date": 1594644539, "question_id": 30339997, "link": "https://stackoverflow.com/questions/30339997/how-to-count-records-and-its-numerical-value", "title": "How to count records and it&#39;s numerical value", "body": "<p>I am looking for the best way to count records in an underlying table (or query) and allow one to capture that number on the active form.  In short, I would like to create an object on my form which tells the users which record out of how many he is currently looking at (e.g. This is record 3 of 6)</p>\n\n<p>I know how to use the record count function but am having difficulty in transfering that number to an object on my form.</p>\n"}, {"tags": ["vb.net", "vba", "class"], "comments": [{"owner": {"reputation": 8789, "user_id": 1348647, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Gt5Hc.jpg?s=128&g=1", "display_name": "OneFineDay", "link": "https://stackoverflow.com/users/1348647/onefineday"}, "edited": false, "score": 0, "creation_date": 1432093682, "post_id": 30339887, "comment_id": 48773506, "body": "The <code>length</code> and <code>height</code> properties are private so they are not exposed beyond the class."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1432095745, "post_id": 30339887, "comment_id": 48774068, "body": "They&#39;re not properties, they&#39;re fields. Don&#39;t make fields public. Ever."}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 2012155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5948ee35f1fee6afa2420f25f85abb11?s=128&d=identicon&r=PG", "display_name": "KK_", "link": "https://stackoverflow.com/users/2012155/kk"}, "edited": false, "score": 0, "creation_date": 1432139658, "post_id": 30340199, "comment_id": 48803094, "body": "Thank you @mats-mug. Is it possible to see the properties in the Watches window when debugging? They are accessible in code and the Immediate window."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1432095628, "creation_date": 1432095628, "answer_id": 30340199, "question_id": 30339887, "link": "https://stackoverflow.com/questions/30339887/create-vba-class-in-vb-net/30340199#30340199", "title": "Create VBA class in VB.net", "body": "<p>It won't be <em>recognized as a VBA class</em> - it's <em>not</em> a VBA class, but a COM object.</p>\n\n<p>Your <code>Rectangle</code> class has <em>private fields</em>. Private fields are, well, <code>Private</code>. This is, roughly, what VBA sees:</p>\n\n<pre><code>Public Class Rectangle\n   Sub init(ByRef hgt As Double)    \n   Function dbl_height()\nEnd Class\n</code></pre>\n\n<p>Where are the fields?</p>\n\n<pre><code>Private length As Double\nPrivate height As Double\n</code></pre>\n\n<p>You haven't exposed them - as far as VBA goes, they don't exist.</p>\n\n<p>Now, you could make them <code>Public</code> - but then you would be breaking encapsulation by exposing fields; <strong>don't do that!</strong></p>\n\n<p>Expose property getters instead, and setters if you want VBA code to be able to change the <code>Length</code> and <code>Height</code> properties of a <code>Rectangle</code> instance.</p>\n"}], "owner": {"reputation": 154, "user_id": 2012155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5948ee35f1fee6afa2420f25f85abb11?s=128&d=identicon&r=PG", "display_name": "KK_", "link": "https://stackoverflow.com/users/2012155/kk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 1, "accepted_answer_id": 30340199, "answer_count": 1, "score": 4, "last_activity_date": 1432139532, "creation_date": 1432093379, "last_edit_date": 1432139532, "question_id": 30339887, "link": "https://stackoverflow.com/questions/30339887/create-vba-class-in-vb-net", "title": "Create VBA class in VB.net", "body": "<p>Is it possible (using COM and regasm.exe) to have a vba function call a vb.net function - which creates the class in vb.net and then passes the class back to vba, where it is recognised as a vba class?</p>\n\n<p>In VBA, I can work with classes by using Insert>Class Module. I have set up a function that creates a class.</p>\n\n<pre><code>Private length As Double\nPrivate height As Double\nPublic Sub init(ByRef hgt As Double)\n  height = hgt\n  length = dbl_height()\nEnd Sub\n\nPublic Function dbl_height()\n  dbl_height = height * 2\nEnd Function\n</code></pre>\n\n<p>I can initialize it accordingly using this function:</p>\n\n<pre><code>Public Function CreateClassFunction(foo As Integer)\n  Dim my_rect As Rectangle\n  Set my_rect = New Rectangle\n  my_rect.init (foo)\n  Set CreateClassFunction = my_rect\nEnd Function\n</code></pre>\n\n<p>I can also do the same thing in vb.net with virtually identical code.</p>\n\n<pre><code>Public Class Rectangle\n   Private length As Double\n   Private height As Double\n   Public Sub init(ByRef hgt As Double)\n     height = hgt\n     length = dbl_height()\n   End Sub\n\n   Public Function dbl_height()\n     dbl_height = height * 2\n   End Function\nEnd Class\n</code></pre>\n\n<p>where this vb.net function creates the class:</p>\n\n<pre><code>Public Function CreateClassFunction(foo As Integer) As Rectangle\n    Dim my_rect As Rectangle\n    my_rect = New Rectangle\n    my_rect.init(foo)\n    CreateClassFunction = my_rect\nEnd Function\n</code></pre>\n\n<p>I can pull in a Variant/Object/Rectangle into vba using:</p>\n\n<pre><code>Function MyCreateClass(a As Double)\n  Dim classLib As New MyAnalytics.Class1\n  Set MyCreateClass = classLib.CreateClassFunction(a)\nEnd Function\n</code></pre>\n\n<p>However this object does not have the height or length variables. (It says \"no variables\" on the watch window)</p>\n\n<p>Edit:</p>\n\n<p>Amended code as per Mat's Mug answer:</p>\n\n<pre><code>Public Class Rectangle\nPrivate plength As Double\nPrivate pheight As Double\nPublic Property length() As Double\n    Get\n        Return plength\n    End Get\n    Set(ByVal value As Double)\n        plength = value\n    End Set\nEnd Property\n\nPublic Property height() As Double\n    Get\n        Return pheight\n    End Get\n    Set(ByVal value As Double)\n        pheight = value\n    End Set\nEnd Property\n\nPublic Sub init(ByRef hgt As Double)\n    height = hgt\n    length = dbl_height()\nEnd Sub\n\nPublic Function dbl_height()\n    dbl_height = height * 2\nEnd Function\n\nEnd Class\n</code></pre>\n\n<p>and testing in VBA:</p>\n\n<pre><code>Function MyCreateClass(a As Double)\n  Dim classLib As New MyAnalytics.Class1\n\n  Set MyCreateClass = classLib.CreateClassFunction(a)\n\n  Debug.Print MyCreateClass.Height()\n  Debug.Print MyCreateClass.length()\n\n  MyCreateClass.Height = 30\n  MyCreateClass.length = 20\n\n  Debug.Print MyCreateClass.Height()\n  Debug.Print MyCreateClass.length()\n\n  MyCreateClass.init (100)\n  Debug.Print MyCreateClass.Height()\n  Debug.Print MyCreateClass.length()\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 2, "creation_date": 1432089336, "post_id": 30339328, "comment_id": 48772468, "body": "Sure. Take a look at the <code>Worksheet_SelectionChange</code> event: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194470.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff194470.aspx</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1432091099, "post_id": 30339328, "comment_id": 48772862, "body": "You can use conditional formatting for this, or format your data as a Table and select a style with alternating row colors."}, {"owner": {"reputation": 13, "user_id": 4373222, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1290894080/picture?type=large", "display_name": "Jim", "link": "https://stackoverflow.com/users/4373222/jim"}, "edited": false, "score": 0, "creation_date": 1432177104, "post_id": 30339328, "comment_id": 48818831, "body": "I have been googling the problem for a while but in vein. I believe I used the wrong search words. Thans Doug for the reference."}, {"owner": {"reputation": 13, "user_id": 4373222, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1290894080/picture?type=large", "display_name": "Jim", "link": "https://stackoverflow.com/users/4373222/jim"}, "edited": false, "score": 0, "creation_date": 1432177265, "post_id": 30339328, "comment_id": 48818866, "body": "I know the two ways you mentioned. But not exactly what I am looking for. But thanks for pointing it out, Tim."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4373222, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1290894080/picture?type=large", "display_name": "Jim", "link": "https://stackoverflow.com/users/4373222/jim"}, "edited": false, "score": 0, "creation_date": 1432177026, "post_id": 30339385, "comment_id": 48818811, "body": "I started a new module and pasted your code in VBA editor. When I run it, excel kept prompting me to name the marco and save it. But I believe it was already named (Worksheet_Change). I am using excel 2007. Is it the version issue or do I miss anything?"}, {"owner": {"reputation": 13, "user_id": 4373222, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1290894080/picture?type=large", "display_name": "Jim", "link": "https://stackoverflow.com/users/4373222/jim"}, "edited": false, "score": 0, "creation_date": 1432177966, "post_id": 30339385, "comment_id": 48819028, "body": "Well, I think I know the problem. I need to change the two dropdown menu about the vba editor area to &quot;worksheet&quot; &amp; &quot;selection Change&quot;."}, {"owner": {"reputation": 13, "user_id": 4373222, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1290894080/picture?type=large", "display_name": "Jim", "link": "https://stackoverflow.com/users/4373222/jim"}, "edited": false, "score": 0, "creation_date": 1432178718, "post_id": 30339385, "comment_id": 48819180, "body": "Another problem pops up. &quot;worksheet-change&quot; will color the cell whenever I click the cell in range, no matter it is filled or empty. Do I have to put a checking mechanism in the code to see if cells in range are empty or not? Is there a better a to do it?"}], "tags": [], "owner": {"reputation": 31, "user_id": 4906341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495949c7bb7abb9a09f87b817434aa58?s=128&d=identicon&r=PG&f=1", "display_name": "DirkS", "link": "https://stackoverflow.com/users/4906341/dirks"}, "is_accepted": false, "score": 0, "last_activity_date": 1432089491, "creation_date": 1432089491, "answer_id": 30339385, "question_id": 30339328, "link": "https://stackoverflow.com/questions/30339328/vba-to-detect-row-number-in-real-time/30339385#30339385", "title": "VBA to detect row number in REAL TIME", "body": "<p>Yes, there is a function called Worksheet_Change, which is called any time a cell will change. Try the following code (paste it in the VBA-Editor of the worksheet)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set KeyCells = Range(\"A1:C10\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n\n        ' Display a message when one of the designated cells has been \n        ' changed.\n        ' Place your code here.\n        MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4373222, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1290894080/picture?type=large", "display_name": "Jim", "link": "https://stackoverflow.com/users/4373222/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444767303, "creation_date": 1432089153, "last_edit_date": 1531164843, "question_id": 30339328, "link": "https://stackoverflow.com/questions/30339328/vba-to-detect-row-number-in-real-time", "title": "VBA to detect row number in REAL TIME", "body": "<p>I have a piece of VBA code to alternate row color in a specific range. But it only runs once when the excel file is open. </p>\n\n<p>Currently I am using a button to run the VBA when I need to renew the alternate color. Is there any way the VBA can detect the change in row in REAL TIME? </p>\n\n<p>Thanks in advance for your help</p>\n\n<p>Jim</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 2, "creation_date": 1432088890, "post_id": 30339195, "comment_id": 48772338, "body": "What is your code so far? What are you struggling with? Happy to look at your code, but nobody here will write it for you from scratch."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1432092339, "post_id": 30339195, "comment_id": 48773198, "body": "You will also get a bit further if you post the expected output for an item or two.  Textual descriptions of this sort can be difficult to understand.  Output is king."}, {"owner": {"reputation": 1, "user_id": 4918532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bEN8JHvFeZs/AAAAAAAAAAI/AAAAAAAAAZY/zbE1CNx1gNI/photo.jpg?sz=128", "display_name": "Sai Rajesh", "link": "https://stackoverflow.com/users/4918532/sai-rajesh"}, "edited": false, "score": 0, "creation_date": 1432092595, "post_id": 30339195, "comment_id": 48773270, "body": "Here is my code... but the problem is I am not able to delete text after &quot;<i>&quot; as shown in list for item 4 Sub Replace_Characters()  row_number = 1  Do DoEvents row_number = row_number + 1 the_description = Sheet2.Range(&quot;A&quot; &amp; row_number) the_description = Replace(the_description, &quot;HY</i>&quot;, &quot;&quot;) the_description = Replace(the_description, &quot;HY-&quot;, &quot;&quot;) the_description = Replace(the_description, &quot;_HY&quot;, &quot;&quot;) the_description = Replace(the_description, &quot;-HY&quot;, &quot;&quot;) the_description = Replace(the_description, &quot;HY&quot;, &quot;&quot;)  Sheet2.Range(&quot;A&quot; &amp; row_number) = the_description  Loop Until row_number = 20  End Sub"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1432094599, "post_id": 30339195, "comment_id": 48773754, "body": "@SaiRajesh I have formatted and moved your comment in your question. Code should always go with the question since comments make it difficult to format code."}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1432220817, "post_id": 30339195, "comment_id": 48844742, "body": "@SaiRajesh If either of the answers helped you, could you please mark one as accepted?"}], "answers": [{"tags": [], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "is_accepted": false, "score": 0, "last_activity_date": 1432095388, "creation_date": 1432095388, "answer_id": 30340168, "question_id": 30339195, "link": "https://stackoverflow.com/questions/30339195/how-to-delete-text-before-and-after-a-symbol-and/30340168#30340168", "title": "How to delete text before and after a symbol &quot;_&quot; and &quot;-&quot;?", "body": "<p><code>left(the_description,instr(the_description,\"_\")-1)</code> will delete \"_\" and everything after it in your text.<br>\nIf you do many replace like that, then maybe using regular expressions in VBA would be the ultimate solution for you. There are plenty of support materials on the internet.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4918532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bEN8JHvFeZs/AAAAAAAAAAI/AAAAAAAAAZY/zbE1CNx1gNI/photo.jpg?sz=128", "display_name": "Sai Rajesh", "link": "https://stackoverflow.com/users/4918532/sai-rajesh"}, "edited": false, "score": 0, "creation_date": 1432525343, "post_id": 30340186, "comment_id": 48946089, "body": "Thank you for your support, I cannot apply function because this items will keep on changing and there will be big list. I have recorded a macro using find and replace example find ---&gt; &quot;<i>*&quot; if I do this its deleting every thing after the symbol &quot;</i>&quot;."}], "tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": false, "score": 0, "last_activity_date": 1432095546, "creation_date": 1432095546, "answer_id": 30340186, "question_id": 30339195, "link": "https://stackoverflow.com/questions/30339195/how-to-delete-text-before-and-after-a-symbol-and/30340186#30340186", "title": "How to delete text before and after a symbol &quot;_&quot; and &quot;-&quot;?", "body": "<p>I'd recommend writing a function. Send the function the information you want and all the rules can just sit there like this:</p>\n\n<pre><code>Function CleanData(Description As String) As String\n\n    Description = Replace(Description, \"HY_\", \"\", 1)\n    Description = Replace(Description, \"_HY\", \"\")\n    Description = Replace(Description, \"HW-\", \"\", 1)\n    Description = Replace(Description, \"-HY\", \"\")\n\n    Dim DescriptionArray() As String\n    DescriptionArray = Split(Description, \"_\")\n    Description = DescriptionArray(0)\n\n    CleanData = Description\n\nEnd Function\n\nSub Test()\n\n    MsgBox CleanData(\"HY_5AP001KL10\"), vbOKOnly + vbInformation, \"Expected: 5AP001KL10\"\n    MsgBox CleanData(\"5AP0015K20_HY\"), vbOKOnly + vbInformation, \"Expected: 5AP0015K20\"\n    MsgBox CleanData(\"HW-5AP002H20\"), vbOKOnly + vbInformation, \"Expected: 5AP002H20\"\n    MsgBox CleanData(\"5AP002lE_LEE SPRING\"), vbOKOnly + vbInformation, \"Expected: 5AP002lE\"\n    MsgBox CleanData(\"NAS4021-2E-12\"), vbOKOnly + vbInformation, \"Expected: NAS4021-2E-12\"\n\nEnd Sub\n</code></pre>\n\n<p>I have tested the 5 uses cases and the output looks fine to me, but please feel free to modify it to your needs.</p>\n"}], "owner": {"reputation": 1, "user_id": 4918532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bEN8JHvFeZs/AAAAAAAAAAI/AAAAAAAAAZY/zbE1CNx1gNI/photo.jpg?sz=128", "display_name": "Sai Rajesh", "link": "https://stackoverflow.com/users/4918532/sai-rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1432095546, "creation_date": 1432088225, "last_edit_date": 1531164843, "question_id": 30339195, "link": "https://stackoverflow.com/questions/30339195/how-to-delete-text-before-and-after-a-symbol-and", "title": "How to delete text before and after a symbol &quot;_&quot; and &quot;-&quot;?", "body": "<p>I got a list where I want to delete certain text</p>\n\n<ol>\n<li>HY_5AP001KL10   Output 5AP001KL10</li>\n<li>5AP0015K20_HY   Output 5AP0015K20</li>\n<li>HW-5AP002H20    Output 5AP002H20 </li>\n<li>5AP002lE_LEE SPRING    Output 5AP002lE  </li>\n<li>NAS4021-2E-12    Output   NAS4021-2E-12 </li>\n</ol>\n\n<p>In the above mentioned list I want to delete HY before and after along with the symbol <code>_</code> and HW before and after <code>-</code> and every thing after symbol <code>_</code> as LEE SPRING mentioned in 4th item and must not delete -2E or -12 for last item. Can someone please help on this. The above mentioned list will be single item per each cell.</p>\n\n<p>Here is my code... but the problem is I am not able to delete text after \"\" as shown in list for item 4 </p>\n\n<pre><code>Sub Replace_Characters() \n    row_number = 1 \n\n    Do \n\n        DoEvents \n\n        row_number = row_number + 1 \n        the_description = Sheet2.Range(\"A\" &amp; row_number) \n        the_description = Replace(the_description, \"HY\", \"\") \n        the_description = Replace(the_description, \"HY-\", \"\") \n        the_description = Replace(the_description, \"_HY\", \"\") \n        the_description = Replace(the_description, \"-HY\", \"\") \n        the_description = Replace(the_description, \"HY\", \"\") \n        Sheet2.Range(\"A\" &amp; row_number) = the_description \n    Loop Until row_number = 20 \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1432095989, "creation_date": 1432095989, "answer_id": 30340261, "question_id": 30338935, "link": "https://stackoverflow.com/questions/30338935/outlook-vba-saving-selected-emails-to-single-text-file-without-format-change/30340261#30340261", "title": "Outlook VBA - Saving selected emails to single text file, without format change", "body": "<ol>\n<li><p>Outlook does not save multiple items in a single file. It is your responsibility to merge multiple files if that is what you want.</p></li>\n<li><p>Is that what you see for the Body property in Outlook? You can check its value in <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow\">OutlookSpy</a> - select the message, click Item property, select the Body property. </p></li>\n</ol>\n"}], "owner": {"reputation": 391, "user_id": 4132538, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/264569d9d8bff833f8935405ec0a1453?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper", "link": "https://stackoverflow.com/users/4132538/jesper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1593305992, "creation_date": 1432086252, "last_edit_date": 1593305992, "question_id": 30338935, "link": "https://stackoverflow.com/questions/30338935/outlook-vba-saving-selected-emails-to-single-text-file-without-format-change", "title": "Outlook VBA - Saving selected emails to single text file, without format change", "body": "<p>I'm trying to make a macro / script, that will take my selected outlook mails, and save them to a .txt file.</p>\n\n<p>I've actually got it to save it correctly with 1 mail selected, but the problem is that the formatting got all messed up, and started cutting up words - Heres the code I've used: </p>\n\n<pre><code>Sub SaveSelectedMailAsTxtFile()\n Const OLTXT = 0\n  Dim currentExplorer As Explorer\n  Dim Selection As Selection\n  Dim oMail As Outlook.MailItem\n  Dim obj As Object\n  Dim sPath As String\n  Dim dtDate As Date\n  Dim sName As String\n\n\n  Set currentExplorer = Application.ActiveExplorer\n    Set Selection = currentExplorer.Selection\n\n For Each obj In Selection\n  Set oMail = obj\n  sName = oMail.Subject\n\n\n  oMail.SaveAs \"C:\\path\\file.txt\", OLTXT\n\n  Next\n\nEnd Sub\n\nPrivate Sub ReplaceCharsForFileName(sName As String, _\n  sChr As String _\n)\n  sName = Replace(sName, \"/\", sChr)\n  sName = Replace(sName, \"\\\", sChr)\n  sName = Replace(sName, \":\", sChr)\n  sName = Replace(sName, \"?\", sChr)\n  sName = Replace(sName, Chr(34), sChr)\n  sName = Replace(sName, \"&lt;\", sChr)\n  sName = Replace(sName, \"&gt;\", sChr)\n  sName = Replace(sName, \"|\", sChr)\nEnd Sub\n</code></pre>\n\n<p>2 Problems - </p>\n\n<p>1 Is that I cant select multiple mails, and save them to 1 text file. </p>\n\n<p>2 The formatting of the mail gets cut up alot. For example, I got this product name: </p>\n\n<p><code>\"Dansk kolloid s\u00f8lv 1 liter, fremstillet i K\u00f8benhavn\"</code> - </p>\n\n<p>copy pasted from outlook mail.</p>\n\n<p>In the text file i get from the script, its printed like this: </p>\n\n<p>Da\nnsk \nkoll\noid \ns\u00f8l\nv 1 \nliter\n, \nfre\nmst\nillet \ni \nK\u00f8\nben\nhav\nn</p>\n\n<p>Which makes it kinda hard to work with :S Any suggestions? Any help would be grately appreciated :)</p>\n\n<p>Bonus info: I've tried doing another work around, where I select multiple emails, and just use outlook's save as function. Now if I choose mails containing plain text, I get the same issue - However, If I choose the same order email, combined with an email from say Humble Bundle or Twitch (I think they are HTML based emails? not sure tho), and save these emails, the formatting is untouched in the text based emails, and therefore useable.</p>\n"}, {"tags": ["excel", "cells", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1432086663, "last_edit_date": 1432086663, "creation_date": 1432086232, "answer_id": 30338930, "question_id": 30338878, "link": "https://stackoverflow.com/questions/30338878/select-mutiple-cell-using-cells-function/30338930#30338930", "title": "Select mutiple cell using Cells() function", "body": "<p>Consider:</p>\n\n<pre><code>Sub RangeRover()\nRange(\"A3,C1\").Select\nEnd Sub\n</code></pre>\n\n<p>and if you really want to use <em>Cells()</em> then:</p>\n\n<pre><code>Sub ytrewq()\nUnion(Cells(1, 3), Cells(3, 1)).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 2291480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634c15fd4fa5c05dd57a79308e18f921?s=128&d=identicon&r=PG", "display_name": "djEthen", "link": "https://stackoverflow.com/users/2291480/djethen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 30338930, "answer_count": 1, "score": 0, "last_activity_date": 1432093440, "creation_date": 1432085936, "last_edit_date": 1531161705, "question_id": 30338878, "link": "https://stackoverflow.com/questions/30338878/select-mutiple-cell-using-cells-function", "title": "Select mutiple cell using Cells() function", "body": "<pre><code>          A    B    C  \n1        100  101  102\n2        103  104  105\n3        106  107  108\n</code></pre>\n\n<p>How can I select only <code>C1</code> and <code>A3</code> cell together?</p>\n\n<pre><code>Range(Cells(1, 3), Cells(1, 1)).Select\n</code></pre>\n\n<p>That selects it as a range instead of just those specific cells.</p>\n\n<p><em>I know I haven't provided my code, but just looking for a quick advice.</em></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "edited": false, "score": 0, "creation_date": 1432086437, "post_id": 30338724, "comment_id": 48771752, "body": "You&#39;re getting the error because your 2nd While loop moves down the column until it finds a blank, once it finds one it moves across 2 columns. I&#39;d suggest you just need to add in a line which identifies the last row in the column which has data in it."}], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1432257092, "post_id": 30338998, "comment_id": 48862891, "body": "this code runs faster that Bigbobby&#39;s answer, but it includes those blanks cells in the results as well. How to modify the code not to include those blank cells?"}, {"owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1432259506, "post_id": 30338998, "comment_id": 48863475, "body": "So it does! I&#39;ve updated it to skip over the blank cells. I&#39;ve not tested it but have a go and see if you can make it work if it doesn&#39;t already."}, {"owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1432259585, "post_id": 30338998, "comment_id": 48863495, "body": "Although just seen Bigbobby&#39;s answer, I&#39;m sure you can tinker with it to speed it up!"}], "tags": [], "owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "is_accepted": true, "score": 1, "last_activity_date": 1432259465, "last_edit_date": 1432259465, "creation_date": 1432086723, "answer_id": 30338998, "question_id": 30338724, "link": "https://stackoverflow.com/questions/30338724/merge-data-from-multiple-columns-into-one-column/30338998#30338998", "title": "Merge data from multiple columns into one column", "body": "<p>Adjust this code:</p>\n\n<pre><code>While Cells(Row, Col).Value &lt;&gt; \"\"\n    Cells(Out_Row, OUTPUT_COL).Value = Cells(Row, Col).Value\n    Out_Row = Out_Row + 1\n    Row = Row + 1\nWend\n</code></pre>\n\n<p>For:</p>\n\n<pre><code>Do until row &gt; Cells(65536, Col).End(xlUp).Row\n    Cells(Out_Row, OUTPUT_COL).Value = Cells(Row, Col).Value\n    Out_Row = Out_Row + 1\n    Row = Row + 1\nLoop\n</code></pre>\n\n<p>This essentially checks to see if the row has passed the last row with data, and if it has, it moves onto the next column.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>To not copy across the blank cells use this:</p>\n\n<pre><code>    Do until row &gt; Cells(65536, Col).End(xlUp).Row\n        If Cells(Row, Col).Value &lt;&gt; \"\" then\n            Cells(Out_Row, OUTPUT_COL).Value = Cells(Row, Col).Value\n            Out_Row = Out_Row + 1\n        End If\n        Row = Row + 1\n    Loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1432256795, "post_id": 30351843, "comment_id": 48862816, "body": "this is working. But it is taking so long to run the command. Why is that?"}, {"owner": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "reply_to_user": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "edited": false, "score": 0, "creation_date": 1432302735, "post_id": 30351843, "comment_id": 48884713, "body": "How much data do you have?  It runs quickly here, but I am not testing with many rows and I have a very fast computer.  One trick you can use to make macros go faster, is to include:    <code>Application.ScreenUpdating = False</code> at the beginning of the macro, and then <code>Application.ScreenUpdating = True</code> at the end.  That way, Excel isn&#39;t repainting the screen after every operation that affects a cell."}], "tags": [], "owner": {"reputation": 363, "user_id": 3754356, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6b495b6f193597f8c45229e249cd96f0?s=128&d=identicon&r=PG&f=1", "display_name": "BigBobby", "link": "https://stackoverflow.com/users/3754356/bigbobby"}, "is_accepted": false, "score": 2, "last_activity_date": 1432130167, "creation_date": 1432130167, "answer_id": 30351843, "question_id": 30338724, "link": "https://stackoverflow.com/questions/30338724/merge-data-from-multiple-columns-into-one-column/30351843#30351843", "title": "Merge data from multiple columns into one column", "body": "<p>The previous answer is close, but it will also copy all of the blank spaces.  This code should do what you need:</p>\n\n<pre><code>Sub MoveData()\n\nSTART_ROW = 5\nSTART_COL = 1\nSTEP_COL = 2\nOUTPUT_ROW = 5\nOUTPUT_COL = 10\n\nRow = START_ROW\nCol = START_COL\nOut_Row = OUTPUT_ROW\nWhile Col &lt; OUTPUT_COL\n    While Row &lt; ActiveSheet.UsedRange.Rows.Count\n        If Cells(Row, Col).Value &lt;&gt; \"\" Then\n            Cells(Out_Row, OUTPUT_COL).Value = Cells(Row, Col).Value\n            Out_Row = Out_Row + 1\n        End If\n        Row = Row + 1\n    Wend\n    Row = START_ROW\n    Col = Col + STEP_COL\nWend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1015, "user_id": 4835480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1517f7087c4b0bfa7556e8ba03d04412?s=128&d=identicon&r=PG&f=1", "display_name": "cplus", "link": "https://stackoverflow.com/users/4835480/cplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 0, "accepted_answer_id": 30338998, "answer_count": 2, "score": 0, "last_activity_date": 1432259465, "creation_date": 1432084882, "last_edit_date": 1592644375, "question_id": 30338724, "link": "https://stackoverflow.com/questions/30338724/merge-data-from-multiple-columns-into-one-column", "title": "Merge data from multiple columns into one column", "body": "<p>I have the following:<br>\n<img src=\"https://i.stack.imgur.com/Ztzu9.png\" alt=\"enter image description here\" /></p>\n<p><br>I am using <a href=\"https://stackoverflow.com/a/30330091/4835480\">@BigBobby's answer</a> to achieve this:<br></p>\n<pre><code>Sub MoveData()\nRange(&quot;H5:H99&quot;).ClearContents\nSTART_ROW = 5\nSTART_COL = 1\nSTEP_COL = 2\nOUTPUT_ROW = 5\nOUTPUT_COL = 8\nLimit_Col = 9\n\nRow = START_ROW\nCol = START_COL\nOut_Row = OUTPUT_ROW\nWhile Col &lt; Limit_Col\n    While Cells(Row, Col).Value &lt;&gt; &quot;&quot;\n        Cells(Out_Row, OUTPUT_COL).Value = Cells(Row, Col).Value\n        Out_Row = Out_Row + 1\n        Row = Row + 1\n    Wend\n    Row = START_ROW\n    Col = Col + STEP_COL\nWend\nEnd Sub\n</code></pre>\n<p><br>But as you see, I expect to get those values which appear after a blank cell in the columns. But this code fails to pull those cells highlighted in yellow.\n<br><em>How to modify this code to pull all of the data which may appear after one or several blank cells?</em></p>\n"}, {"tags": ["vba", "excel", "onerror"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 3, "creation_date": 1432085408, "post_id": 30338663, "comment_id": 48771471, "body": "here is helpful <a href=\"https://msdn.microsoft.com/en-us/library/5hsw66as.aspx\" rel=\"nofollow noreferrer\">Link</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1432087401, "creation_date": 1432087401, "answer_id": 30339082, "question_id": 30338663, "link": "https://stackoverflow.com/questions/30338663/vba-excel-stop-on-error-goto/30339082#30339082", "title": "VBA Excel Stop On Error Goto", "body": "<p>try this</p>\n\n<pre><code>    On Error Resume Next '\".. GoTo ErrorMessage\" replaced by \"...resume next\"\n    Sheet2.Range(\"A1\").Font.Bold = True\n    Sheet2.Range(\"B1\").Font.Bold = True\n    If LastRow_Sh2 &gt;= First_Row_Sheet2 Then\n        Sheet2.Range(FromCol &amp; First_Row_Sheet2 &amp; \":\" &amp; ToCol &amp; LastRow_Sh2).ClearContents\n        Exit Sub\n    End If\n\n    If Err.Number &gt; 0 Then GoTo ErrorMessage ' Stop here\n\n    ' I have some codes here\n\nErrorMessage:\n    MsgBox (\"Error message: The input values are invalid\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "is_accepted": true, "score": 7, "last_activity_date": 1432087555, "creation_date": 1432087555, "answer_id": 30339100, "question_id": 30338663, "link": "https://stackoverflow.com/questions/30338663/vba-excel-stop-on-error-goto/30339100#30339100", "title": "VBA Excel Stop On Error Goto", "body": "<p>Take a look at the example below that shows both - error handling manually and allow VBA to catch a runtime error:</p>\n\n<pre><code>Sub Test()\n\n    On Error GoTo ErrorHandler\n    Dim Divisor As Integer\n    Dim Num As Integer\n    Dim Answer As Double\n\n    Num = 100\n    Divisor = 0\n\n    ' ================================\n    ' throw an error here forcefully\n    ' and allow ErrorHandler to handle\n    ' the error\n    ' ================================\n    Answer = Num / Divisor\n    MsgBox \"Answer is \" &amp; Answer, vbOKOnly + vbInformation, \"Answer\"\n\n    ' stop error handling\n    On Error GoTo 0\n\n    ' ================================\n    ' throw an error here forcefully\n    ' and allow VBA to handle the error\n    ' ================================\n    Answer = Num / Divisor\n    MsgBox \"Answer is \" &amp; Answer, vbOKOnly + vbInformation, \"Answer\"\n\n    Exit Sub\n\nErrorHandler:\n    MsgBox \"Handling the error here\", vbOKOnly + vbInformation, \"ErrorHandler\"\n    Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>Based on this, you can modify your code slightly to allow VBA to handle the error on runtime.</p>\n\n<pre><code>On Error GoTo ErrorMessage\nSheet2.Range(\"A1\").Font.Bold = True\nSheet2.Range(\"B1\").Font.Bold = True     \nIf LastRow_Sh2 &gt;= First_Row_Sheet2 Then\n    Sheet2.Range(FromCol &amp; First_Row_Sheet2 &amp; \":\" &amp; ToCol &amp; LastRow_Sh2).ClearContents\n    Exit Sub\nEnd If\n\n' Stop here\n' The statement below will disable error handling that was\n' done by ErrorMessage\nOn Error GoTo 0\n\n' I have some codes here\n' If this block of code has errors, VBA will handle it and\n' allow debugging\n\nErrorMessage:\n    MsgBox (\"Error message: The input values are invalid\")\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15029, "favorite_count": 1, "accepted_answer_id": 30339100, "answer_count": 2, "score": 2, "last_activity_date": 1432087555, "creation_date": 1432084465, "last_edit_date": 1531164843, "question_id": 30338663, "link": "https://stackoverflow.com/questions/30338663/vba-excel-stop-on-error-goto", "title": "VBA Excel Stop On Error Goto", "body": "<p>I have written <code>On Error GoTo ErrorMessage</code> somewhere in a subroutine. I want to stop this command after <code>End if</code> command as shown below.     </p>\n\n<pre><code>    On Error GoTo ErrorMessage\n    Sheet2.Range(\"A1\").Font.Bold = True\n    Sheet2.Range(\"B1\").Font.Bold = True     \n    If LastRow_Sh2 &gt;= First_Row_Sheet2 Then\n        Sheet2.Range(FromCol &amp; First_Row_Sheet2 &amp; \":\" &amp; ToCol &amp; LastRow_Sh2).ClearContents\n        Exit Sub\n    End If\n    ' Stop here\n\n    ' I have some codes here\n\nErrorMessage:\n    MsgBox (\"Error message: The input values are invalid\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "random"], "answers": [{"tags": [], "owner": {"reputation": 665, "user_id": 4259417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a82ce39c7bfa96f76ec14a5dffdd27ef?s=128&d=identicon&r=PG", "display_name": "Shauno_88", "link": "https://stackoverflow.com/users/4259417/shauno-88"}, "is_accepted": false, "score": 0, "last_activity_date": 1432085425, "creation_date": 1432085425, "answer_id": 30338805, "question_id": 30338578, "link": "https://stackoverflow.com/questions/30338578/summing-randomly-generated-values-in-excel/30338805#30338805", "title": "Summing randomly generated values in Excel", "body": "<p>Pseudo code is a good place to start! If you name the total cell in your sheet to \"Total\", you should be able to run the below, which is my take on your pseudo code:</p>\n\n<pre><code>noRuns = 100\ngrandTotal = 0\nFor i = 1 to noRuns\n    ActiveSheet.Calculate\n    grandTotal = grandTotal + Range(\"Total\").Value\nNext i\nMsgBox \"The average value is \" &amp; grandTotal / noRuns \n</code></pre>\n\n<p>If that doesn't work, have a play with it and let me know how you get on.</p>\n"}], "owner": {"reputation": 1, "user_id": 4918383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a52b47f88635b8cc382200fc75b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "CTT", "link": "https://stackoverflow.com/users/4918383/ctt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432086227, "creation_date": 1432083841, "last_edit_date": 1432086227, "question_id": 30338578, "link": "https://stackoverflow.com/questions/30338578/summing-randomly-generated-values-in-excel", "title": "Summing randomly generated values in Excel", "body": "<p>I am trying to randomly select values from a short list, sum them, then iterate that process many times. So far I think I am successful in generating the values:       </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Work so far\r\n\r\n\t\t\t\t0.4855981\t0\t0\tFALSE\r\n\tPrice\t\t\t0.337666609\t0\t0\tFALSE\r\n1\t$29.74 \t\t\t0.808816075\t0\t0\tFALSE\r\n2\t$0.85 \t\t\t0.906751484\t0\t0\tFALSE\r\n3\t$38.24 \t\t\t0.10572928\t1\t4\t17\r\n4\t$17 \t\t\t0.957321497\t0\t0\tFALSE\r\n5\t$25.50 \t\t\t0.644195743\t0\t0\tFALSE\r\n6\t$18.70 \t\t\t0.133302328\t0\t0\tFALSE\r\n7\t$29.75 \t\t\t0.907771163\t0\t0\tFALSE\r\n8\t$14.45 \t\t\t0.156311546\t0\t0\tFALSE\r\n9\t$30.60 \t\t\t0.871958447\t0\t0\tFALSE\r\n10\t$26.34 \t\t\t0.0790938\t1\t14\t24.65\r\n11\t$11.05 \t\t\t0.696383544\t0\t0\tFALSE\r\n12\t$124.95 \t\t0.080728462\t1\t3\t38.24\r\n13\t$9.35 \t\t\t0.03717127\t1\t10\t26.34\r\n14\t$24.65 \t\t\t0.970430159\t0\t0\tFALSE\r\n15\t$41.65 \t\t\t0.814402286\t0\t0\tFALSE\r\n\t\t\t\t0.462967917\t0\t0\tFALSE\r\n\t\t\t\t0.646432058\t0\t0\tFALSE\r\n\t\t\t\t0.49384003\t0\t0\tFALSE\r\n\t\t\t\t0.381349746\t0\t0\tFALSE\r\n\t\t\t\t0.129594937\t0\t0\tFALSE\r\n\t\t\t\t0.576582174\t0\t0\tFALSE\r\n\t\t\t\t0.37483142\t0\t0\tFALSE\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tTotal\t106.23</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>In any set there are 24 attempts at selecting an item from the price list. What I have done is randomly generate a number and if it less than 0.125 (1/8 chance of getting a value from the price list per attempt) then I generate a random number between 1 and 15 and then vlookup to get the price. </p>\n\n<p>However I want to iterate this process many times, so say out of 100 times each consisting of 24 attempts, what is the average value I return. I cannot find a way to simply add the number to itself each time I update the random numbers, and my VBA is pretty limited - I was considering a loop that has a clickbutton to refresh the numbers. Pseudo code since I know very little VBA:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>for 1=1:100\r\n  clickbutton() #to refresh\r\n  grandtotal=grandtotal+total\r\nend\r\n\r\naveragevalue=grandtotal/i</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I know it seems really easy, but I have not had luck searching how refresh with the clickbutton, or if that is even the best way. Thanks!</p>\n"}, {"tags": ["vba", "excel", "nonblank"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1432085846, "post_id": 30337968, "comment_id": 48771594, "body": "How are you calling the function?  It sounds like the Range you&#39;re passing isn&#39;t bounded by the used cells."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 2, "creation_date": 1432091378, "post_id": 30337968, "comment_id": 48772922, "body": "I added an answer which will help the situation, but the larger question here is: what is the end goal of all this?  There are much easier ways to find blank cells: <code>DataRange.SpecialCells(xlCellTypeBlanks)</code> will give them all to you.  There are probably faster ways to this also even if the blanks are just a step in the process."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "edited": false, "score": 0, "creation_date": 1432141236, "post_id": 30339610, "comment_id": 48804073, "body": "Ahh ok, I get it. It didn&#39;t work, but I think I&#39;m using it wrong. When I enter the array into the cells &quot;=nonblanks(I:K)&quot; it will extend all the way to the millionth cell making the file massive; I understand I&#39;m using the entire columns but there&#39;s no data past 2000. I just wanted to extend far enough so when there is more data in I:K the array will already be there. Now the workaround I did before your answer is just &quot;=nonblanks(I1:K2000). I just had the problem of it going to the millionth cell..."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": false, "score": 0, "last_activity_date": 1432091299, "creation_date": 1432091299, "answer_id": 30339610, "question_id": 30337968, "link": "https://stackoverflow.com/questions/30337968/how-do-i-make-this-vba-faster-removes-blank-cells/30339610#30339610", "title": "How do I make this VBA faster, Removes Blank Cells", "body": "<p>Assuming <code>DataRange</code> is a valid <code>Range</code> object, you can do a very quick limit on the size of the range with</p>\n\n<pre><code>Set DataRange = Intersect(DataRange.Parent.UsedRange, DataRange)\n</code></pre>\n\n<p>Stick that at the top before you do the <code>If TypeName...</code> bit.</p>\n\n<p>The <code>Parent</code> of a <code>Range</code> is a <code>Worksheet</code> object.  The <code>Worksheet</code> maintains a property called <code>UsedRange</code> which includes all cells that have data or formatting or are somehow different than a default blank cell.  It beats going corner to corner on the whole sheet.</p>\n"}], "owner": {"reputation": 73, "user_id": 4902031, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/377e1c0b02239abddf1b4f82dfad3129?s=128&d=identicon&r=PG&f=1", "display_name": "Trosky6708", "link": "https://stackoverflow.com/users/4902031/trosky6708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432091299, "creation_date": 1432078951, "last_edit_date": 1432079419, "question_id": 30337968, "link": "https://stackoverflow.com/questions/30337968/how-do-i-make-this-vba-faster-removes-blank-cells", "title": "How do I make this VBA faster, Removes Blank Cells", "body": "<p>This VBA array works and removes all the blanks I want. But it's extending all the way down to like the millonth row, taking up valuable computer resources. I need to either make the VBA stop if \"the next 10 rows in the array are not filled with data\" OR I just need it to stop at row 2000. It scans I1:K2000 &amp; the data is displayed in M1:O2000. </p>\n\n<pre><code>Function NonBlanks(DataRange As Variant) As Variant\n\nDim i As Long, J As Long, NumRows As Long, NumCols As Long, RtnA() As Variant\nDim RtnRow As Long\n\nApplication.ScreenUpdating = 0\nIf TypeName(DataRange) = \"Range\" Then DataRange = DataRange.Value2\n\nNumRows = UBound(DataRange)\nNumCols = UBound(DataRange, 2)\n\nReDim RtnA(1 To NumRows, 1 To NumCols)\n\nFor i = 1 To NumRows\nIf DataRange(i, 1) &lt;&gt; \"\" Then\nRtnRow = RtnRow + 1\nFor J = 1 To NumCols\nIf DataRange(i, J) &lt;&gt; \"\" Then RtnA(RtnRow, J) = DataRange(i, J) _\nElse RtnA(RtnRow, J) = \"\"\nNext J\n  End If\nNext i\n\nFor i = RtnRow + 1 To NumRows\nFor J = 1 To NumCols\nRtnA(i, J) = \"\"\nNext J\nNext i\n\nNonBlanks = RtnA\nApplication.ScreenUpdating = 1\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1432107626, "creation_date": 1432107626, "answer_id": 30343241, "question_id": 30337627, "link": "https://stackoverflow.com/questions/30337627/using-microsoft-access-vba-and-sql-what-is-the-simplest-way-to-trim-all-fields/30343241#30343241", "title": "Using Microsoft Access, VBA and SQL what is the simplest way to trim all fields in a table?", "body": "<p>You could trim only the fields/records needed:</p>\n\n<pre><code>CurrentDb.Execute (\"UPDATE tblName SET [\" &amp; fld.Name &amp; \"] = LTrim([\" &amp; fld.Name &amp; \"]) Where Left([\" &amp; fld.Name &amp; \"], 1) = ' ';\")\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4900796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b8f09cab5e0a4f675e19eca8fa7a96f?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/4900796/art"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1432153933, "creation_date": 1432076841, "last_edit_date": 1432153933, "question_id": 30337627, "link": "https://stackoverflow.com/questions/30337627/using-microsoft-access-vba-and-sql-what-is-the-simplest-way-to-trim-all-fields", "title": "Using Microsoft Access, VBA and SQL what is the simplest way to trim all fields in a table?", "body": "<p>I'm looking for the simplest way to trim all text/memo fields in an Access table. I'm currently using...</p>\n\n<pre><code>    Public Sub Trimmer()\n    Dim db As DAO.Database\n    Dim tdf As DAO.TableDef\n    Dim fld As DAO.Field\n\n    Set db = CurrentDb\n    Set tdf = db.TableDefs(\"tblName\")\n    For Each fld In tdf.Fields\n    Debug.Print fld.Name\n    If fld.Type = dbText Or fld.Type = dbMemo Then\n    Debug.Print \"Since \" &amp; fld.Name &amp; \" is a text or Memo field we should trim it.\"\n        CurrentDb.Execute (\"UPDATE tblName SET tblName.[\" &amp; fld.Name &amp; \"] = Trim([\" &amp; fld.Name &amp; \"]);\")\n    End If\n    Next\n    Set fld = Nothing\n    Set tdf = Nothing\n    Set db = Nothing\n    end sub\n</code></pre>\n\n<p>Is there a simpler way?</p>\n"}, {"tags": ["vba", "autocad"], "answers": [{"tags": [], "owner": {"reputation": 8051, "user_id": 4838205, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RBf0X.jpg?s=128&g=1", "display_name": "Augusto Goncalves", "link": "https://stackoverflow.com/users/4838205/augusto-goncalves"}, "is_accepted": true, "score": 2, "last_activity_date": 1432140420, "creation_date": 1432140420, "answer_id": 30355765, "question_id": 30337536, "link": "https://stackoverflow.com/questions/30337536/access-autocad-object-properties-without-opening-it-by-vba/30355765#30355765", "title": "Access autocad object properties without opening it by VBA", "body": "<p>To effectively read a .dwg file you'll need to open AutoCAD, otherwise the information is not accessible. Some properties may be, such as author, but not number of layouts...</p>\n\n<p>But you can use AutoCAD Console (accoreconsole.exe) to run a headless AutoCAD and use APIs to read any information you need. This is really fast for reading lot's of files and the user will not see it running (but it needs to be installed anyway).</p>\n\n<p><a href=\"http://aucache.autodesk.com/au2012/sessionsFiles/3338/3323/handout_3338_CP3338-Handout.pdf\" rel=\"nofollow\">http://aucache.autodesk.com/au2012/sessionsFiles/3338/3323/handout_3338_CP3338-Handout.pdf</a></p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1454744965, "creation_date": 1454744965, "answer_id": 35238676, "question_id": 30337536, "link": "https://stackoverflow.com/questions/30337536/access-autocad-object-properties-without-opening-it-by-vba/35238676#35238676", "title": "Access autocad object properties without opening it by VBA", "body": "<p>you could stay in VBA and use ObjectDBX\nit leads to a very similar approach as accoreconsole.exe on in .NET does, i.e you won't see any drawing open in UI since it works on the database itself\nIt requires adding library reference (Tools->References) to \"AutoCAD/ObjectDBX Common XX.Y Type Library\", where \"XX.Y\" is \"19.0\" for AutoCAD 2014\na minimal functioning code is</p>\n\n<pre><code>Sub main()\n\nDim myAxDbDoc As AxDbDocument\nDim FullFileName As String\n\nFullFileName = \"C:\\..\\mydrawing.dwg\"  '&lt;== put here the full name of the file to be opened\nSet myAxDbDoc = AxDb_SetDrawing(FullFileName)\nMsgBox myAxDbDoc.Layers.Count\n\nEnd Sub\n\n\n\nFunction AxDb_SetDrawing(FullFileName As String) As AxDbDocument\nDim DBXDoc As AxDbDocument\n\nSet DBXDoc = Application.GetInterfaceObject(\"ObjectDBX.AxDbDocument.19\") '&lt;== place correct AutoCAD version numeber (\"19\" works for AutoCAD 2014)\n\nOn Error Resume Next\nDBXDoc.Open FullFileName\nIf Err &lt;&gt; 0 Then\n    MsgBox \"Couldn't open\" &amp; vbCrLf &amp; vbCrLf &amp; FullFileName, vbOKOnly + vbCritical, \"AxDB_SetDrawing\"\nElse\n    Set AxDb_SetDrawing = DBXDoc\nEnd If\nOn Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>Still, you must have one AutoCAD session running from which make this sub run! But you should have it since talked about \"currently open\" drawing</p>\n"}], "owner": {"reputation": 71, "user_id": 3892939, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qL6L2.jpg?s=128&g=1", "display_name": "aleksacavic", "link": "https://stackoverflow.com/users/3892939/aleksacavic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2764, "favorite_count": 0, "accepted_answer_id": 30355765, "answer_count": 2, "score": 0, "last_activity_date": 1454744965, "creation_date": 1432076307, "question_id": 30337536, "link": "https://stackoverflow.com/questions/30337536/access-autocad-object-properties-without-opening-it-by-vba", "title": "Access autocad object properties without opening it by VBA", "body": "<p>I have been using folder browser for VBA, I could paste the code of it, but bottom line is that I get returned file name as a string.\nIs there any way to access drawing properties (i.e number of layouts) without open?</p>\n\n<pre><code>Public Sub TestFileDialog()\n    dwgname = FileBrowseOpen(\"C:\", \"*\", \".dwg\", 1) 'dwgname is typeof string\nEnd Sub\n</code></pre>\n\n<p>Its only the first step (use of FileBrowseOpen function is shown, but also i can use FolderBrowse and collect all .dwg inside of folder),actually i had in mind to batch export all layouts of selected .dwgs to currenty open one. Is there any chance for that?</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1432125166, "post_id": 30337568, "comment_id": 48791930, "body": "Exactly what I needed. : )"}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": true, "score": 6, "last_activity_date": 1432076880, "last_edit_date": 1432076880, "creation_date": 1432076518, "answer_id": 30337568, "question_id": 30337385, "link": "https://stackoverflow.com/questions/30337385/if-a-cell-in-excel-contains-an-array-formula-like-1-2-3-can-i-extract-the/30337568#30337568", "title": "If a cell in Excel contains an array formula (like `={1,2,3}`) can I extract the elements of the array with VBA", "body": "<p>You can first get the <code>FormulaArray</code> property of the <code>Range</code> object, then <code>Evaluate</code> it to return the full array: </p>\n\n<pre><code>v = Evaluate(Range(\"A1\").FormulaArray)\n</code></pre>\n\n<p>You can access the elements as you expect (and/or manipulate them as having declared an <code>Array</code> normally): </p>\n\n<pre><code>v(1) --&gt; 1\nv(2) --&gt; 2\nv(3) --&gt; 3\n</code></pre>\n"}], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 0, "accepted_answer_id": 30337568, "answer_count": 1, "score": 2, "last_activity_date": 1432076880, "creation_date": 1432075285, "last_edit_date": 1531161705, "question_id": 30337385, "link": "https://stackoverflow.com/questions/30337385/if-a-cell-in-excel-contains-an-array-formula-like-1-2-3-can-i-extract-the", "title": "If a cell in Excel contains an array formula (like `={1,2,3}`) can I extract the elements of the array with VBA", "body": "<p>Like the title says, a cell <code>A1</code> contains the formula <code>={1,2,3}</code>, which is a valid input for a cell, can I use VBA to get the elements of the array.</p>\n\n<p>Note that <code>Range(\"A1\").Value</code> returns the value <code>1</code>, but <code>Range(\"A1\").Formula</code> returns the string <code>={1,2,3}</code>. So the only way I could think of is to parse the formula and separate the values with the <code>,</code> (like CSV line). </p>\n\n<p>Is there any other way to return an array of values in vba in this situation. I even tried to read it as an array into a variant with <code>v=Range(\"A1:A2\").Value2</code> but <code>v(1)</code> contains <code>1</code> only. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1432075714, "post_id": 30337221, "comment_id": 48769082, "body": "I am not sure what SO formatting method I am not using correctly but when I go to edit my comment, there are two backslashes, they just don&#39;t show on the post."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1432076808, "post_id": 30337221, "comment_id": 48769359, "body": "It looks like you&#39;re nesting calls to <code>Dir()</code> - that method is &quot;global&quot;, so you cannot use nested calls: once you call it with a parameter in the inner loop, then the outer loop is also reset.  An alternative approach is to first collect all the &quot;outer loop&quot; paths in an array or collection: then you can loop over that and use your &quot;inner&quot; loop safely."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432094849, "post_id": 30337221, "comment_id": 48773826, "body": "Thanks for the pointer Tim. I don&#39;t know enough about <code>Dir()</code> yet to understand how overwriting a loop that checks whether there&#39;s more work to do would affect a command inside the loop when it has already been determined for that iteration that there is more work to be done. However, I trust your experience and knowledge. Once I get more confirmation and change things according to your suggestion, I&#39;ll comment again asking you to post as an answer if everything works. Thanks again!"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432129430, "post_id": 30337221, "comment_id": 48795371, "body": "Tim, I also realized last night that this loop is not a loop as it is typically defined. Because the file that serves as the loop&#39;s iteration point is deleted each time, at the bottom of the iteration there is a copy of the line before the loop starts, <code>String4 = Dir(StrDir1 &amp; String2)</code>. It repeats until the folder is empty. The loop mostly serves to repeat the same commands over and over again, but it does not act on every member of a set while leaving the set intact as usual."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432134376, "post_id": 30337221, "comment_id": 48799436, "body": "I was going on the first two lines of your code, where it looks like your setting up a Do Whlie loop using Dir(), and then that you call Dir() again within that loop.  If you added the full code then that would be helpful - I was taking clues from the indentation of what you posted."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1432135171, "post_id": 30337221, "comment_id": 48800041, "body": "I might do that but I think I just figured it out. I was thinking that since the String6 directory is created earlier in the code, that it could be a timing issue somehow. I made the String6 directory by hand and made a new macro where the only commands are setting up the strings and filesystemobjects and copying. It didn&#39;t work, but when I made a new directory with a shorter name it did copy successfully before Excel crashed. Trying again to see if it works without crashing, but I think the problem is String6 is too long.  Thanks for taking clues, sorry you didn&#39;t have the full code."}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1432094400, "post_id": 30337676, "comment_id": 48773697, "body": "Thank you very much. I am completely self-taught from mrexcel and stackexchange for vba and this project has been my introduction to manipulating files outside of Excel. Both your research and your advice about FSO will benefit me a lot!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1432077150, "creation_date": 1432077150, "answer_id": 30337676, "question_id": 30337221, "link": "https://stackoverflow.com/questions/30337221/filecopy-gives-error-53-file-not-found/30337676#30337676", "title": "FileCopy gives Error 53 File Not Found", "body": "<p>I don't see any obvious reason that you should be getting an error 53 for the destination file.  Some sources indicate that FileCopy can be quirky with spaces in the path, but that really should be giving an error 52 if that's the case.  I found one other report of somebody claiming that they needed to stop hiding know file extensions in the destination folder to avoid an error with FileCopy, but I'm not sure I'm buying that one.  </p>\n\n<p>I'd make sure that you have the appropriate permissions in the folder you're writing to, and use the Scripting.FilesystemObject to perform the copy instead - it's typically more robust:</p>\n\n<pre><code>Dim fso As Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nfso.CopyFile String5, String6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": true, "score": 0, "last_activity_date": 1432136668, "creation_date": 1432136668, "answer_id": 30354418, "question_id": 30337221, "link": "https://stackoverflow.com/questions/30337221/filecopy-gives-error-53-file-not-found/30354418#30354418", "title": "FileCopy gives Error 53 File Not Found", "body": "<p>The answer was that String6 exceeded the maximum character length. So be warned that that is a possibility when getting Error 53 or Error 76 when using FileCopy or fso.copyfile.</p>\n\n<p>Note: Because of my inexperience with FSO, this might not be exactly/technically correct, but I hope it informs you enough to get you on the right path if you're stuck.</p>\n"}], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5050, "favorite_count": 0, "accepted_answer_id": 30354418, "answer_count": 2, "score": 0, "last_activity_date": 1469717630, "creation_date": 1432074448, "last_edit_date": 1531164843, "question_id": 30337221, "link": "https://stackoverflow.com/questions/30337221/filecopy-gives-error-53-file-not-found", "title": "FileCopy gives Error 53 File Not Found", "body": "<p><strong>The Problem:</strong></p>\n\n<p>As stated above, I have a line of code, <code>FileCopy String5, String6</code>, that is giving Error 53: File Not Found. I have determined that the error is occurring with String6. I need another pair of eyes to help me find the error.</p>\n\n<p><strong>What I've Tried:</strong></p>\n\n<ul>\n<li>Printing String6 to a cell to make sure it is correct</li>\n<li>Copying String6 into Windows Explorer and Windows-->Run (after deleting the file name, it hasn't been created yet due to the macro error) to make sure they open the folder correctly</li>\n<li><p>Used Dir function to double check that Excel can see the copyto directory after I've made it</p></li>\n<li><p>Because the files about to be copied come from a folder that was unzipped prior to the code, adding a 1 second wait in case the new files somehow hadn't been detected (basically trying everything now)</p></li>\n</ul>\n\n<p>I'm open to any suggestions. Here's an <strong>updated</strong> section of my code in case it helps, and I'd be happy to post the whole thing as well:</p>\n\n<pre><code>'File Manipulation\n'Find a file in StrDir1 with String2 extension, \"*.dat\"\nString4 = Dir(StrDir1 &amp; String2)\nDo While String4 &lt;&gt; \"\"\n    'Save the complete path of the file found\n    String5 = StrDir1 &amp; String4\n    For Loop1 = LBound(Array1) To UBound(Array1)\n        'Array1 has file identifiers in it that identify who the file belongs to for later separation and folder placement\n        If InStr(String5, Array1(Loop1)) Then\n            'We found a file with the identifier, save the future complete path of the copied file\n            String6 = StrDir1 &amp; Array2(Loop1) &amp; String4\n            'Create the containing folder where the file will be copied if it does not already exist\n            String10 = vbNullString\n            On Error Resume Next\n            'Check if the folder already exists\n            String10 = Dir(StrDir1 &amp; Array2(Loop1), vbDirectory)\n            On Error GoTo 0\n            'If it doesn't exist, create it\n            If String10 = vbNullString Then\n                MkDir StrDir1 &amp; Array2(Loop1)\n            End If\n            'String8 is the file type, it was determined earlier\n            If String8 = \"997\" Then\n                String7 = \"\\\\(directory)\\\" &amp; String4\n                'This works, which makes me think the problem is String6.\n                Object2.CopyFile String5, String7\n                'For testing purposes\n                ThisWorkbook.Sheets(1).Cells(1, 1).Value = String5\n                ThisWorkbook.Sheets(1).Cells(2, 1).Value = String6\n                String10 = Dir(StrDir1 &amp; Array2(Loop1), vbDirectory)\n                'Back to the real code\n                'When these lines are commented, Error 53, file not found. When uncommented, Error 76, path not found.\n'                String5 = \" &amp; String5 &amp; \"\n'                String6 = \" &amp; String6 &amp; \"\n                'Error occurs here\n                Object2.CopyFile String5, String6\n                Kill String5\n                String4 = Dir(StrDir1 &amp; String2)\n                'code continues\n</code></pre>\n\n<p>To reiterate, the error occurs on the <code>Object2.CopyFile String5, String6</code> line of the above code.</p>\n\n<p>Here are String5 and String6 at the time of error, in case it helps anyone. These values are copied from Cells 1,1 and 2,1:</p>\n\n<p>String5: \\\\extremely long directory\\extremely long file name.ext</p>\n\n<p>String6: \\\\extremely long directory\\extremely long file name.ext</p>\n\n<p><strong>Update:</strong> I switched to fso.copyfile and I also tried adding quotes around my strings to avoid any problems with the directories containing spaces. When I added quotes, the error changed to Error 76, path not found. Does this help troubleshoot my code?</p>\n\n<p>(I also added a few more lines to my code snippet to hopefully demonstrate this isn't a Dir() problem to the best of my knowledge, but since I am new to Dir(), Tim could still be right.)</p>\n\n<p><strong>Update 2:</strong> I think String6 is too long. I'm using the following code to test but Excel keeps crashing after successfully copying the file when I try to run it. Is there something I need to know about FSO to prevent that?</p>\n\n<pre><code>Sub M2Pathtester()\n\nDim String5 As String\nDim String6 As String\nDim Object2 As Object\n\nSet Object2 = CreateObject(\"scripting.filesystemobject\")\n\nString5 = ThisWorkbook.Sheets(1).Cells(1, 1)\nString6 = ThisWorkbook.Sheets(1).Cells(2, 1)\nObject2.CopyFile String5, String6\n\nEnd Sub\n</code></pre>\n\n<p><strong>Final Update:</strong>\nYes, the string was too long. Excel still repeatedly crashes (after successfully copying) using the fso.copyfile method, but when I reverted back to FileCopy, it worked smoothly.</p>\n"}]