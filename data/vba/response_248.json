[{"tags": ["vba", "forms", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570661629, "post_id": 58312936, "comment_id": 102987417, "body": "Why would 1 client have multiple names? There should be a client master record and then save that record ID key into related dependent records."}, {"owner": {"reputation": 131, "user_id": 2824252, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2f282db1c6fec43c4dad4e1f735c0aa9?s=128&d=identicon&r=PG&f=1", "display_name": "A.Birdman", "link": "https://stackoverflow.com/users/2824252/a-birdman"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570665199, "post_id": 58312936, "comment_id": 102988070, "body": "You are correct! There <i>should</i> be. However I&#39;m dealing with an old database I inherited and which is slated for archiving within about 2 years. This system receives data from several others and many of the admin staff are A) not very computer savvy, and B) entering information secondhand from an investigation. One investigator may meet &quot;Jim Smith&quot; and a year or two later, a different investigator will meet &quot;James Smith&quot; and each puts on their report what they are given. It is awful having to clean up after everyone. I&#39;m making headway. Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 2824252, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2f282db1c6fec43c4dad4e1f735c0aa9?s=128&d=identicon&r=PG&f=1", "display_name": "A.Birdman", "link": "https://stackoverflow.com/users/2824252/a-birdman"}, "edited": false, "score": 0, "creation_date": 1570664945, "post_id": 58313276, "comment_id": 102988023, "body": "Good grief... sometimes doing this makes me feel so dumb... I tried it with the wildcards but forgot the &#39;LIKE&#39;. Thanks so much!"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1570661490, "creation_date": 1570661490, "answer_id": 58313276, "question_id": 58312936, "link": "https://stackoverflow.com/questions/58312936/how-to-add-a-wildcard-to-combobox-selected-value-to-broaden-values-returned-in-m/58313276#58313276", "title": "How to add a wildcard to combobox-selected value to broaden values returned in multiple item form", "body": "<p>Of course, use LIKE with wildcard:</p>\n\n<p><code>Me.Filter = \"LName LIKE '\" &amp; Me.cboFindLast &amp; \"*'\"</code></p>\n\n<p><code>Me.Filter = \"FName LIKE '\" &amp; Me.cboFindFirst &amp; \"*' And LName LIKE '\" &amp; Me.cboFindLast &amp; \"*'\"</code></p>\n"}], "owner": {"reputation": 131, "user_id": 2824252, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2f282db1c6fec43c4dad4e1f735c0aa9?s=128&d=identicon&r=PG&f=1", "display_name": "A.Birdman", "link": "https://stackoverflow.com/users/2824252/a-birdman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58313276, "answer_count": 1, "score": 0, "last_activity_date": 1594421404, "creation_date": 1570658965, "last_edit_date": 1594421404, "question_id": 58312936, "link": "https://stackoverflow.com/questions/58312936/how-to-add-a-wildcard-to-combobox-selected-value-to-broaden-values-returned-in-m", "title": "How to add a wildcard to combobox-selected value to broaden values returned in multiple item form", "body": "<p>I have a multiple item form which displays client records, e.g., first and last name, date of birth, address, etc\u2026 The same client can be listed multiple times in multiple ways and may have the same or similar name as other clients (because bad historic data process). Jim Smith, James Smith, and Jim Smith Jr. could be the same or more than three different people (with date of birth and other information helping to resolve such issues). </p>\n\n<p>I have set up two combo boxes to filter the form sequentially, but I need some help getting them to function as desired. The first combo pulls the list of distinct last names from the underlying table via a simple select query. Once a name is selected the second combo box offers the set of distinct first names with the selected last name. </p>\n\n<p>Is there a way to use the selected last name plus wildcards in the vba so that selecting \u201cSmith\u201d would also return \u201cSmith Jr.\u201d, \u201cSmith-Jones\u201d, and \u201cSmithers\u201d? Right now I have the following which requeries the second combobox and sets the initial filter on the form, at the moment only to \u201cSmith\u201d in my example:</p>\n\n<pre><code>Private Sub cboFindLast_AfterUpdate()\n    Me.cboFindFirst.Requery\n    Me.cboFindFirst = Null\n    Me.Filter = \"LName = '\" &amp; Me.cboFindLast &amp; \"'\"\n    Me.FilterOn = True\nEnd Sub    \n</code></pre>\n\n<p>This works as desired except for not returning the \u201cSmith+\u201d entries. At this point the user can select from cboFindFirst to reduce the list even more. Again, it would be nice if selecting \u201cAnn\u201d would return Ann, Anna, Annie, and even Ruth-Ann if any of those occur. The code currently on the second box is:</p>\n\n<pre><code>Private Sub cboFindFirst_AfterUpdate()\n    Me.Filter = \"FName = '\" &amp; Me.cboFindFirst &amp; \"' And LName = '\" &amp; Me.cboFindLast &amp; \"'\"\n    Me.FilterOn = True\nEnd Sub\n</code></pre>\n\n<p>Again, this works well and reduces the list to e.g., all of the \u201cAnn Smith\u201d records, but maybe there\u2019s a more recent \u201cAnnie Smith-Jones\u201d after she was married and I\u2019d like that record to show as well.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1570658362, "post_id": 58312794, "comment_id": 102986658, "body": "What is the conditional formatting rule? This does not clear formatting for me so I would check to see what range your rule is applied to"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570658809, "post_id": 58312794, "comment_id": 102986764, "body": "... or if your rule is dependant on visible/hidden rows? Maybe the <code>Aggregate</code> function?"}, {"owner": {"reputation": 1, "user_id": 12191623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBiuoBL8P2KjLhhffbVn6hexq-8c1Z1-u7cTVrApQ=k-s128", "display_name": "Ford Prefect", "link": "https://stackoverflow.com/users/12191623/ford-prefect"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570668640, "post_id": 58312794, "comment_id": 102988687, "body": "There are several columns (D to AQ) that get updated once a week. The formatting changes the cell color to green, if its lower then the previous week, and red if its higher (it stays white if no change). Its a pretty simple format rule. I didn&#39;t make the original formatting rules, the doc was given to me, and it was working fine. Now I&#39;m being asked to hide any row with all 0s. Frankly, I&#39;m too lazy to do and undo this each week. As Ross suggest, now that I look at the formatting, it might actually be easier to do the formatting in the code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12191623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBiuoBL8P2KjLhhffbVn6hexq-8c1Z1-u7cTVrApQ=k-s128", "display_name": "Ford Prefect", "link": "https://stackoverflow.com/users/12191623/ford-prefect"}, "edited": false, "score": 0, "creation_date": 1570668850, "post_id": 58313820, "comment_id": 102988720, "body": "Looking at how the person who did the formatting rules, this idea may actually be more elegant."}], "tags": [], "owner": {"reputation": 374, "user_id": 7261668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211502888638056/picture?type=large", "display_name": "Ross Symonds", "link": "https://stackoverflow.com/users/7261668/ross-symonds"}, "is_accepted": false, "score": 0, "last_activity_date": 1570666752, "creation_date": 1570666752, "answer_id": 58313820, "question_id": 58312794, "link": "https://stackoverflow.com/questions/58312794/excel-vba-unhiding-rows-clears-their-formatting/58313820#58313820", "title": "Excel VBA - Unhiding rows clears their formatting", "body": "<p>It is perhaps not the best fix but could you program the conditional formatting into the VBA code. When you unhide the columns could the conditional formatting be reapplied? </p>\n"}], "owner": {"reputation": 1, "user_id": 12191623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBiuoBL8P2KjLhhffbVn6hexq-8c1Z1-u7cTVrApQ=k-s128", "display_name": "Ford Prefect", "link": "https://stackoverflow.com/users/12191623/ford-prefect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570666752, "creation_date": 1570657989, "question_id": 58312794, "link": "https://stackoverflow.com/questions/58312794/excel-vba-unhiding-rows-clears-their-formatting", "title": "Excel VBA - Unhiding rows clears their formatting", "body": "<p>When I call the following, it will clear any conditional formatting that was previously applied to those cells:</p>\n\n<pre><code>Sub UnhideAll()\n    Columns.EntireRow.Hidden = False\n\nEnd Sub\n\n</code></pre>\n\n<p>For the life of me, I can't figure out why. Using Excel 2016. Appreciate any help :)</p>\n"}, {"tags": ["excel", "vba", "comments"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "edited": false, "score": 0, "creation_date": 1570658177, "post_id": 58312676, "comment_id": 102986609, "body": "Use InStr(1, UCase(Target.Value), &quot;A&quot;) &gt; 0 instead of Target.Value=&quot;A&quot;, etc. So that you are looking for if the string Contains &quot;A&quot; rather than that it is solely equal to a. Also, this will check for if &quot;A&quot; or &quot;a&quot; is entered."}, {"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "edited": false, "score": 0, "creation_date": 1570659095, "post_id": 58312676, "comment_id": 102986836, "body": "Thank you, but I want the code only to check for the letter &quot;A&quot;/&quot;a&quot; in the cell. So, if the cell contains e.g. &quot;Ab&quot; then the comment should not appear."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "edited": false, "score": 0, "creation_date": 1570659704, "post_id": 58312988, "comment_id": 102986976, "body": "Just modify Target.Cells to UCase(Target.Value) and it&#39;s no longer case sensitive."}, {"owner": {"reputation": 78, "user_id": 12184129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ef212e46e097237116a1e150edb924?s=128&d=identicon&r=PG&f=1", "display_name": "SpyingSphinx", "link": "https://stackoverflow.com/users/12184129/spyingsphinx"}, "edited": false, "score": 1, "creation_date": 1570660042, "post_id": 58312988, "comment_id": 102987054, "body": "Yeah that will enable lower case, if you wanted either &quot;A&quot; or &quot;a&quot; then simple change the case to:  Case &quot;A&quot;, &quot;a&quot;: Target.AddComment (&quot;explanationA: &quot;)"}, {"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "edited": false, "score": 0, "creation_date": 1570692674, "post_id": 58312988, "comment_id": 102995010, "body": "Thank you! Your answer was very helpful to write more comprehensive code!"}], "tags": [], "owner": {"reputation": 78, "user_id": 12184129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ef212e46e097237116a1e150edb924?s=128&d=identicon&r=PG&f=1", "display_name": "SpyingSphinx", "link": "https://stackoverflow.com/users/12184129/spyingsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1570659338, "creation_date": 1570659338, "answer_id": 58312988, "question_id": 58312676, "link": "https://stackoverflow.com/questions/58312676/vba-code-to-automatically-add-a-comment-if-a-cell-contains-a-certain-letter/58312988#58312988", "title": "VBA Code to automatically add a comment if a cell contains a certain letter", "body": "<p>Something quick and easy would be like this below;</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\nSelect Case Target.Cells\n    Case Is = \"A\": Target.AddComment (\"explanationA: \")\n    Case Is = \"B\": Target.AddComment (\"explanationB: \")\n    Case Is = \"C\": Target.AddComment (\"explanationC: \")\n    Case Is = \"D\": Target.AddComment (\"explanationD: \")\n    Case Is = \"E\": Target.AddComment (\"explanationE: \")\nEnd Select\nOn Error Resume Next\nEnd Sub\n</code></pre>\n\n<p>Just remember to put the code on the sheet you want it to happen on, and it appears its case sensitive also.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "edited": false, "score": 0, "creation_date": 1570692601, "post_id": 58313651, "comment_id": 102994969, "body": "Thank you for the explanation! There was my mistake."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1570665305, "creation_date": 1570665305, "answer_id": 58313651, "question_id": 58312676, "link": "https://stackoverflow.com/questions/58312676/vba-code-to-automatically-add-a-comment-if-a-cell-contains-a-certain-letter/58313651#58313651", "title": "VBA Code to automatically add a comment if a cell contains a certain letter", "body": "<p>You can use <code>Option Compare Text</code> at the declarations section (top) of your module to allow comparisons for the entire module to be case-insensitive.</p>\n\n<p>Although the code within the sub routine \"MyCompare\" is identical, their outcome is different:</p>\n\n<pre><code>Sub MyCompare\n\n    Debug.print \"a\" = \"A\"\n    ' Prints False\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>Option Compare Text\n\nSub MyCompare\n\n    Debug.Print \"a\" = \"A\"\n    ' Prints True\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>But anyway, let's get to your <em>actual</em> problem. It's with this line in your code:</p>\n\n<pre><code>Application.EnableEvents = False\n</code></pre>\n\n<p>Notice the reason your code worked the first time was because you captured the <code>Worksheet_Change</code> event. But now you just disabled events within this code and never turned it back on, therefore you will no longer be able to run your <code>Worksheet_Change</code> subroutine.</p>\n\n<p>Just make sure to turn it back on before you exit your code. Also, it would be wise to handle your errors in a way that will enable events rather than prematurely stopping your code, which would keep them disabled.</p>\n\n<p>The way I usually enable events without running a Sub is by using the debug window. Press <kbd>Ctrl</kbd> + <kbd>G</kbd> within the VBE to open this window, then within the window simply type <code>Application.EnableEvents = True</code> and press <kbd>Return</kbd> and you've just change that property.</p>\n"}], "owner": {"reputation": 59, "user_id": 10348356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e3dd9f6d537257c76467b31b03cf2f?s=128&d=identicon&r=PG&f=1", "display_name": "greenfield", "link": "https://stackoverflow.com/users/10348356/greenfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 58313651, "answer_count": 2, "score": 0, "last_activity_date": 1570665305, "creation_date": 1570657134, "question_id": 58312676, "link": "https://stackoverflow.com/questions/58312676/vba-code-to-automatically-add-a-comment-if-a-cell-contains-a-certain-letter", "title": "VBA Code to automatically add a comment if a cell contains a certain letter", "body": "<p>I just started learning VBA last week and now I am trying to solve the following problem: If users type in a certain letter (and only these specified letters), then a comment should be added automatically to the selected cell. The comment should contain a small \"header\" and then an explanatory text, which is typed in by the user. \nThe shown code actually worked, but only for the first cell I tested it with. So, when I executed it the first time, the comment automatically appeared with the specified text as I intended, but in the next cell it didn't. Even restarting Excel didn't help - so now even the first cell doesn't create the comment. That's why I am confused.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim x\n\nApplication.EnableEvents = False\n\nIf Target.Value = \"\" Then\n\n    Application.Undo\n    x = Target.Value\n    Target.Value = \"\"\n    On Error Resume Next\n\n    If (x = \"A\") Or (x = \"B\") Or (x = \"C\") Or (x = \"D\") Or (x = \"E\") Then Target.Comment.Delete\n    On Error GoTo 0   \n\nElseIf Target.Value = \"A\" Then\n    Target.AddComment (\"explanationA: \")\n\nElseIf Target.Value = \"B\" Then\n    Target.AddComment \"explanationB: \"\n\nElseIf Target.Value = \"C\" Then\n    Target.AddComment \"explanationC: \"\n\nElseIf Target.Value = \"D\" Then\n    Target.AddComment \"explanationD: \"\n\nElseIf Target.Value = \"E\" Then\n    Target.AddComment \"explanationE: \"\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I have specified to \"Worksheet\" and \"Change\".</p>\n\n<p>There is also an additional question, which would be of interest for me: is there a possibility, that excel automatically selects the comment after it was generated, so that the user can type in some explanatory information without needing to select the comment manually?</p>\n\n<p>Help is appreciated! Thank you very much in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570655735, "post_id": 58312238, "comment_id": 102985867, "body": "What is the <code>ii = 192</code> here? Has this been modified at all for your needs? Parts of this seem clear. Change the ranges that are being set to the columns you care about. In above code, the values in columns D, O, K, &amp; M are being replaced by columns from X, Z, AB, AD (respectively) from a second sheet. It seems at minimum, that could be figured out?"}, {"owner": {"reputation": 1, "user_id": 12190331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f1042c46c57377eda8ab227490b0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "SysEng91", "link": "https://stackoverflow.com/users/12190331/syseng91"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570659810, "post_id": 58312238, "comment_id": 102986994, "body": "I have not tried modifying it to my needs yet. While I can, yes, probably tweak the column ranges, row ranges, and IF statement conditions in the For loop, I do not have sufficient VBA proficiency to know how to get the macro running across more than one reference sheet."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570662932, "post_id": 58312238, "comment_id": 102987662, "body": "How to do that is well documented here (<a href=\"https://stackoverflow.com/questions/25953916/excel-vba-looping-through-multiple-worksheets\">see posts like this</a>). At the very least, you should update what you can and do research before posting"}, {"owner": {"reputation": 1, "user_id": 12190331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f1042c46c57377eda8ab227490b0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "SysEng91", "link": "https://stackoverflow.com/users/12190331/syseng91"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570664386, "post_id": 58312238, "comment_id": 102987915, "body": "I had done research prior to posting. The referenced code snippet is a direct result of that research. Having already been beating my head against this task for about a day and a half I had been thinking of reaching a direct resolution. That said, I thank you for providing additional information, and will endeavor to further decompose my objective in future queries so as to acquire more applicable results."}], "answers": [{"tags": [], "owner": {"reputation": 374, "user_id": 7261668, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211502888638056/picture?type=large", "display_name": "Ross Symonds", "link": "https://stackoverflow.com/users/7261668/ross-symonds"}, "is_accepted": false, "score": 0, "last_activity_date": 1570667039, "creation_date": 1570667039, "answer_id": 58313848, "question_id": 58312238, "link": "https://stackoverflow.com/questions/58312238/automation-of-selective-cell-linking-across-worksheets-runtime-error-91/58313848#58313848", "title": "Automation of selective cell linking across worksheets &gt; Runtime Error 91", "body": "<p>When do you copy cells, what conditionals in column I need to be true/false? You could use Union to select multiple rows of cells at once. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12190331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f1042c46c57377eda8ab227490b0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "SysEng91", "link": "https://stackoverflow.com/users/12190331/syseng91"}, "is_accepted": true, "score": 0, "last_activity_date": 1571429188, "creation_date": 1571429188, "answer_id": 58457517, "question_id": 58312238, "link": "https://stackoverflow.com/questions/58312238/automation-of-selective-cell-linking-across-worksheets-runtime-error-91/58457517#58457517", "title": "Automation of selective cell linking across worksheets &gt; Runtime Error 91", "body": "<p>Courtesy of help I get from my own company's e-forums and a good bit more work, I have finally gotten my desired output. The below macro will copy data from the identified ranges into a semi-dynamic range in a \"Summary Sheet\". It requires some knowledge of how the source sheet(s) will be formatted.</p>\n\n<pre><code>Option Explicit\n\nSub Data_Rollup()\n    'Object variables, which need to be released from memory at the end.\n    Dim wb As Workbook\n    Dim summarySheet As Worksheet\n    Dim sourceSheet As Worksheet\n\n    'Non-object variables\n    Dim summarySheetTargetRow As Long\n    Dim sourceSheetTargetRow As Long\n    Dim sourceSheetLastRow As Long\n    Dim sourceSheetIndex As Long\n    Dim numSheets As Long\n\n    On Error GoTo Error_Test 'Escape clause\n\n    'Initialize objects\n    Set wb = ThisWorkbook\n    Set summarySheet = wb.Sheets(\"Summary Sheet\")\n\n    'Initialize non-object variables\n    sourceSheetIndex = 5                                        'Hard-coded starting point for data pull. This should be greater than the number for the Summary sheet.\n    summarySheetTargetRow = 38                                  'Hard-coded starting point for data deposition\n    numSheets = wb.Sheets.Count                                 'returns the number of sheets in workbook \"wb\"\n    Sheets(\"Summary Sheet\").Range(\"A38:D1415\").ClearContents    'Clears out destination cells in summary sheet\n\n    'Main loop\n    For sourceSheetIndex = 5 to numSheets\n        Set sourceSheet = wb.Worksheets(sourceSheetIndex)\n        If Not (sourceSheet.Range(\"A2:A1000\").Find(\"*\", SearchDirection:=xlPrevious) Is Nothing) Then 'Using *If Not (* Is Empty) Then* ensures the code just skips over sheets that don't have the range A2:A1000 populated \n            sourceSheetLastRow = sourceSheet.Range(\"A2:A1000\").Find(\"*\", SearchDirection:=xlPrevious).Row 'searches through the defined range from the bottom up, and returns the number of the first populated row\n            For sourceSheetTargetRow = 2 To sourceSheetLastRow 'Start at second row to skip headers\n                If sourceSheet.Range(\"I\" &amp; sourceSheetTargetRow) = \"Text\" Then\n                    summarySheet.Range(\"A\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"A\" &amp; sourceSheetTargetRow)\n                    summarySheet.Range(\"B\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"M\" &amp; sourceSheetTargetRow)\n                    summarySheet.Range(\"C\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"H\" &amp; sourceSheetTargetRow)\n                    summarySheet.Range(\"D\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"F\" &amp; sourceSheetTargetRow)\n                    summarySheetTargetRow = summarySheetTargetRow + 1\n                End If 'best practise is to always have an Else clause, but it isn't technically necessary\n            Next sourceSheetTargetRow 'Cycles loop to next row down\n        End If 'best practise is to always have an Else clause, but it isn't technically necessary\n    Next sourceSheetIndex 'Cycles loop to next worksheet\n\nExit_Test: 'Deallocates memory for object variables\n    Set sourceSheet = Nothing\n    Set summarySheet = Nothing\n    Set wb = Nothing\n    Exit Sub\nError_Test\n    MsgBox Err.Number &amp; \"-\" &amp; Err.Description\n    GoTo Exit_Test\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12190331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f1042c46c57377eda8ab227490b0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "SysEng91", "link": "https://stackoverflow.com/users/12190331/syseng91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58457517, "answer_count": 2, "score": -1, "last_activity_date": 1571429188, "creation_date": 1570654861, "last_edit_date": 1570818673, "question_id": 58312238, "link": "https://stackoverflow.com/questions/58312238/automation-of-selective-cell-linking-across-worksheets-runtime-error-91", "title": "Automation of selective cell linking across worksheets &gt; Runtime Error 91", "body": "<p>I'm looking to automate the selective copying and stacking of data from multiple sheets into a single sheet. More specifically, I have 4 columns (M, H, A, &amp; F) from which I need to selectively copy cells based on the same-row value of Column I. E.g. with the below case:</p>\n\n<pre><code>Worksheets 2...N  \nColumn A_____Column F_____Column H_____Column I_____Column M  \n_#####________AAAAAA______AAAAAA_______Rqrmnt_______Date\n_#####________AAAAAA______AAAAAA_______Heading_______Blank\n</code></pre>\n\n<p>For all rows with column I = Rqrmnt across N worksheets, I need to copy the corresponding values in columns A, F, H, and M into worksheet 1, stacking the imports of each sheet top-to-bottom, e.g.:</p>\n\n<pre><code>Worksheet 2 Column A...Worksheet 2 Column M  \nWorksheet 3 Column A...Worksheet 3 Column M  \n... \nWorksheet N Column A...Worksheet N Column M  \n</code></pre>\n\n<p>I need to be able to perform limited manipulation on the resulting table, specifically sorting the rows by the value of Column M  </p>\n\n<p>As I have several hundred such entries, I would prefer to not build this up by linking cells 1-by-1. Additionally, I would prefer to place the copied pseudo-columns individually (i.e. rearrange them in the order M>H>A>F on the master spreadsheet). I Have the following macro, derived from <a href=\"https://stackoverflow.com/questions/47321678/selectively-copy-non-blank-cells-only-in-random-column-order-from-one-sheet-to\">these</a> <a href=\"https://stackoverflow.com/questions/25953916/excel-vba-looping-through-multiple-worksheets\">posts</a> (thanks to urdearboy's comment below for the second linked post). However, I get a Run-time Error 91 fault when I try to run the macro, and the debugger highlights the identified line below. While <a href=\"https://stackoverflow.com/questions/18927297/vba-run-time-error-91\">this</a> post explains the error itself, I has not helped me solve this problem. I have tried initializing the sourceSheetLastRow to an arbitrary number, and slapping the <code>Set</code> keyword in front of the formula, but to no avail.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim summarySheetTargetRow As Long\n    Dim sourceSheetTargetRow As Long\n    Dim sourceSheetLastRow As Long\n    Dim sourceSheetIndex As Long\n    Dim numSheets As Long\n    Dim wb As Workbook\n    Dim summarySheet As Worksheet\n    Dim sourceSheet As Worksheet\n\n    Set wb = ThisWorkbook\n    Set summarySheet = wb.Sheets(\"Summary Sheet\")\n\n    numSheets = ThisWorkbook.Sheets.Count  `My understanding is that this will return the total number of worksheets in the workbook. However, the sheet index seems to skip the number 5, so this may not be getting me the actual number of sheets\n    sourceSheetIndex = 6                   `First sheet from which I want to pull values. Note that the sheets have inconsistent names, so I'm trying to use the sheet index.\n    summarySheetTargetRow = 38             `Where I want to start plugging in copied cell values\n    `Make sure receiving area for copied info is clear\n    Sheets(\"Summary Sheet\").Range(\"A38:D1415\").ClearContents\n\n\n    For sourceSheetIndex = 6 To numSheets\n        Set sourceSheet = wb.Worksheets(sourceSheetIndex)\n\n        DEBUG THORWS FAULT HERE[\n        sourceSheetLastRow = sourceSheet.Range(\"M2:M1000\").Find(\"*\", SearchDirection:=xlPrevious).Row `I understand this to return the number of cells in the specified range, starting from the last non-empty cell.\n        ]DEBUG THORWS FAULT HERE\n\n        For sourceSheetTargetRow = 2 To sourceSheetLastRow `Start at second row because header rows will never have relevant value\n            If sourceSheet.Range(\"I\" &amp; sourceSheetTargetRow) = \"Text\" Then\n                summarySheet.Range(\"A\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"A\" &amp; sourceSheetTargetRow)\n                summarySheet.Range(\"B\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"M\" &amp; sourceSheetTargetRow)\n                summarySheet.Range(\"C\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"H\" &amp; sourceSheetTargetRow)\n                summarySheet.Range(\"D\" &amp; summarySheetTargetRow) = sourceSheet.Range(\"F\" &amp; sourceSheetTargetRow)\n                summarySheetTargetRow = summarySheetTargetRow + 1\n            End If\n        Next sourceSheetTargetRow\n    Next sourceSheetIndex\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "import", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5339974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efec2307386dee045e1225b87035397e?s=128&d=identicon&r=PG&f=1", "display_name": "Frooga", "link": "https://stackoverflow.com/users/5339974/frooga"}, "is_accepted": false, "score": 0, "last_activity_date": 1571792318, "creation_date": 1571792318, "answer_id": 58514059, "question_id": 58312069, "link": "https://stackoverflow.com/questions/58312069/import-first-line-of-text-in-each-row-col-of-word-table-to-excel-using-vba/58514059#58514059", "title": "Import first line of text in each row/col of Word table to Excel using VBA", "body": "<p>Turns out that the error was occurring because there were tables embedded in the tables being parsed, not due to the length of the body of text in the cell.</p>\n\n<p>The hangup would occur on this line during the processing of the .docx file with the embedded tables:</p>\n\n<pre><code>.Paste Destination:=.Range(\"A\" &amp; r)\n</code></pre>\n\n<p>Once the tables were deleted from the file, the macro works like a champ!</p>\n"}], "owner": {"reputation": 31, "user_id": 5339974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efec2307386dee045e1225b87035397e?s=128&d=identicon&r=PG&f=1", "display_name": "Frooga", "link": "https://stackoverflow.com/users/5339974/frooga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575839599, "creation_date": 1570654117, "last_edit_date": 1575839599, "question_id": 58312069, "link": "https://stackoverflow.com/questions/58312069/import-first-line-of-text-in-each-row-col-of-word-table-to-excel-using-vba", "title": "Import first line of text in each row/col of Word table to Excel using VBA", "body": "<p>I have a macro I am using to import the contents of tables in Word files into an Excel worksheet.  The current script is working well, but there are times and error occurs in this line while processing a file where the contents of one of the columns becomes very lengthy:</p>\n\n<pre><code>  .Paste Destination:=.Range(\"A\" &amp; r)\n</code></pre>\n\n<p>I don't need the full contents of the text in each column.  I would like to modify this to either copy only the first line of text or a defined number of characters in each row/column of the table.</p>\n\n<p>Is there a way to do this?  </p>\n\n<p>Here is the script I am currently using:</p>\n\n<pre><code>Sub GetFirstTableData()\n'Note: this code requires a reference to the Word object model.\n'See under the VBE's Tools|References.\nApplication.ScreenUpdating = False\nDim wdApp As New Word.Application, wdDoc As Word.Document\nDim strFolder As String, strFile As String, r As Long\nstrFolder = GetFolder: If strFolder = \"\" Then GoTo ErrExit\nstrFile = Dir(strFolder &amp; \"\\*.doc\", vbNormal)\nWhile strFile &lt;&gt; \"\"\n  Set wdDoc = wdApp.Documents.Open(Filename:=strFolder &amp; \"\\\" &amp; strFile, AddToRecentFiles:=False, Visible:=False)\n  With wdDoc\n    With .Tables(1)\n      With .Range.Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .Text = \"[^13^l]\"\n        .Replacement.Text = Chr(182)\n        .Forward = True\n        .Format = False\n        .MatchWildcards = True\n        .Execute Replace:=wdReplaceAll\n      End With\n      .Columns.Add\n      .Cell(1, 8).Range.Text = Split(strFile, \".doc\")(0)\n      .Range.Copy\n    End With\n    With ActiveSheet\n      r = .Cells(.Rows.Count, 1).End(xlUp).Row\n      If r &gt; 1 Then r = r + 2\n      .Paste Destination:=.Range(\"A\" &amp; r)\n    End With\n    .Close SaveChanges:=False\n  End With\n  strFile = Dir()\nWend\nActiveSheet.UsedRange.Replace What:=Chr(182), Replacement:=Chr(10), LookAt:=xlPart, SearchOrder:=xlByRows\nErrExit:\nwdApp.Quit\nSet wdDoc = Nothing: Set wdApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n\nFunction GetFolder() As String\n    Dim oFolder As Object\n    GetFolder = \"\"\n    Set oFolder = CreateObject(\"Shell.Application\").BrowseForFolder(0, \"Choose a folder\", 0)\n    If (Not oFolder Is Nothing) Then GetFolder = oFolder.Items.Item.Path\n    Set oFolder = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570654022, "post_id": 58312010, "comment_id": 102985223, "body": "You started a good list at the bottom. Do not try to tackle this in one go. Break your problem out into its logical parts. Finding the visible cells from an autofilter can easily be searched (<a href=\"https://stackoverflow.com/questions/17531128/copy-paste-calculate-visible-cells-from-one-column-of-a-filtered-table\">returning useful links like this</a>). Next, what loop to use with an array? <a href=\"https://stackoverflow.com/questions/4228137/how-can-i-use-a-for-each-loop-on-an-array\">Try This</a>. The point is, all of your individual needs are answered here. You just need to do the work to put them together :)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570654151, "post_id": 58312010, "comment_id": 102985274, "body": "<i>Cont...</i> Last, how to determine if a filter returned any values? <a href=\"https://stackoverflow.com/questions/36562549/what-to-do-when-autofilter-in-vba-returns-no-data\">See this post</a>. Try to tackle one part of a time. If you struggle then you can come back with a specific question. Lastly, I highly recomend you read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">the king of all posts</a> which will explain why &amp; how you should avoid <code>.Select</code> and it&#39;s counterparts that are all over your posted code. Good luck"}, {"owner": {"reputation": 1, "user_id": 12191107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCg7jJJ_UJxTtuYOKtetr29WUGlE6THn3fITvuI=k-s128", "display_name": "FirewallCMD", "link": "https://stackoverflow.com/users/12191107/firewallcmd"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1570655792, "post_id": 58312010, "comment_id": 102985881, "body": "@urdearboy Oh my goodness, thank you so much for your quick responses!! You definitely nailed it, I know I&#39;m way overcomplicating this and overwhelming myself with this many steps. I&#39;ve got all of your links opened in a tab for myself and I&#39;m going to see what I can do. Thanks again!!"}], "owner": {"reputation": 1, "user_id": 12191107, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCg7jJJ_UJxTtuYOKtetr29WUGlE6THn3fITvuI=k-s128", "display_name": "FirewallCMD", "link": "https://stackoverflow.com/users/12191107/firewallcmd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570659099, "creation_date": 1570653768, "last_edit_date": 1570659099, "question_id": 58312010, "link": "https://stackoverflow.com/questions/58312010/vba-filter-by-text-value-in-an-array-determine-if-filter-returns-blank-value", "title": "VBA - Filter By Text Value In An Array, Determine If Filter Returns Blank Value, Copy Non-Blank Rows To Another Named Sheet; LOOP", "body": "<p><strong><em>Hello - I apologize if my title wasn't very well worded, but I'll try to elaborate further in the body here.</em></strong></p>\n\n<p><strong>Quick Background / What I Know</strong></p>\n\n<p>I'm not a programmer of any kind, but I am a 2nd year currently in school for a CIS degree; my only experience with programming is an object-oriented programming class and basic self-taught Excel VBA using Google and the macro recorder, and I'm learning as I go to help automate certain processes and routine at work.</p>\n\n<p><strong>What I'm Trying To Accomplish</strong></p>\n\n<ul>\n<li>This process should theoretically loop exactly 5 times</li>\n<li>Create an autofilter by text value on a \"Master\" worksheet (Sheet2) in column \"D\"</li>\n<li>The text value will be based on an array (\"<em>HQ</em>\", \"<em>MTV</em>\", \"<em>OTV</em>\", \"<em>RTD</em>\", <em>Anything else not highlighted yellow</em>)</li>\n<li>There are also 5 premade sheets labeled (\"<em>CORP</em>\", \"<em>MTV</em>\", \"<em>OTV</em>\", \"<em>RTD</em>\", \"<em>Exceptions</em>\")</li>\n<li>For each text value in the array, filter and determine if a visible row is returned. </li>\n<li><p><strong>IF SO</strong></p>\n\n<ul>\n<li><strong>1.</strong> Highlight the rows yellow;</li>\n<li><strong>2.</strong> Copy rows (minus highlighting) to another worksheet at RC(2,0);</li>\n<li><strong>3.</strong> In Column A, go to the last row + offset by (2,0) and enter a value of \"TOTAL:\"; </li>\n<li><strong>4.</strong> Offset selection by (0,1) and enter an application COUNTA formula to count the total of rows minus the header (row 1)</li>\n</ul></li>\n<li><strong>IF NO VISIBLE ROWS RETURNED</strong> Continue on to the next item in the array</li>\n<li>Once the array is complete, anything that is <strong>NOT</strong> highlighted yellow should be copied &amp; pasted to the worksheet named \"Exceptions\" starting at A2</li>\n<li>The totals created on the other worksheets (\"CORP\", \"MTV\", \"OTV\", \"RTD\") should then be automatically entered to a premade \"Totals\" sheet (which I imagine can be done with a VLOOKUP)</li>\n</ul>\n\n<h3>Here's what I'm talking about regarding the totals page</h3>\n\n<p><a href=\"https://i.stack.imgur.com/QB0ju.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QB0ju.png\" alt=\"Here&#39;s what I&#39;m talking about regarding the totals page\"></a></p>\n\n<p><strong>What I've Already Tried / What I'm Struggling With</strong></p>\n\n<p>So, I've tried using the Macro recorder in about 5 different ways to try to figure this out, and I can very easily do this manually and <em>cheat</em> my way through, but I want to make this code fully autonomous and dynamic, and I think I'm over-complicating it. Creating the worksheets and formatting each page automatically is simple enough, and it appears that the rest is mostly just a simple filter > copy > paste routine. </p>\n\n<p>Here's what I have so far -</p>\n\n<pre><code>Sub AutoFilterFormat()\n\nRange(\"A1:D1\").Select\n    Selection.AutoFilter 'cancel filter already in place on header range\n    ActiveSheet.Range(\"$A$1:$D$212\").AutoFilter Field:=4, Criteria1:=\"=*HQ*\", _\n    Operator:=xlAnd 'filter that will be used for the following array:(HQ, CORP, MTV, OTV, RTD, &lt;&gt;)\n\nRange(\"A1\").Select\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select '\n    Selection.Copy\nSheets(\"CORP\").Select\n    Range(\"A1\").Select\n        ActiveSheet.Paste\n    Range(\"A1\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.End(xlDown).Select\n        Selection.Offset(2, 0).Activate\n        Selection.Value = \"TOTAL:\"\n        Selection.Offset(0, 1).Activate\n        '\n        'application COUNTA formula to count each non-blank row, excluding header A1:D1\n        '\n\nEnd Sub\n</code></pre>\n\n<p><strong>What I'm Looking For</strong></p>\n\n<p>I don't want it to seem like I need someone to build the code straight-out for me, as that's not what I'm looking for. Since I have very weak foundational knowledge of VBA, I struggle with finding the best ways to solve any time of dynamic issue, so I'm hoping to get some pointers, specifically about:</p>\n\n<ul>\n<li>Find the LastRow of ONLY visible cells from an autofilter</li>\n<li>What Loop to use with an Array</li>\n<li>If no results from autofilter, continue to the next item in the array</li>\n</ul>\n\n<p>Thank you for your time, and I apologize if my issue was too long or if I came off with any level of impropriety.</p>\n\n<p>Thanks again!</p>\n"}, {"tags": ["excel", "vba", "loops", "email", "if-statement"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1570650047, "post_id": 58311120, "comment_id": 102983713, "body": "Is this a one time thing or something you will need to do multiple times?"}, {"owner": {"reputation": 3, "user_id": 12190876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd12285a08491b1a3576a1fd202a7d93?s=128&d=identicon&r=PG&f=1", "display_name": "EvanSkywalker", "link": "https://stackoverflow.com/users/12190876/evanskywalker"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1570730081, "post_id": 58311120, "comment_id": 103015264, "body": "Something I would need to do multiple times"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12190876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd12285a08491b1a3576a1fd202a7d93?s=128&d=identicon&r=PG&f=1", "display_name": "EvanSkywalker", "link": "https://stackoverflow.com/users/12190876/evanskywalker"}, "edited": false, "score": 0, "creation_date": 1570731517, "post_id": 58312632, "comment_id": 103015917, "body": "rickmanalexander:  it works flawlessly!!!! You are a saint.  Thank you so much. Question: how would you rate the difficulty of this?  I am in sales but kinda like programing and want to get my chops up so I would be nice to know how hard your solution is as a benchmark"}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 3, "user_id": 12190876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd12285a08491b1a3576a1fd202a7d93?s=128&d=identicon&r=PG&f=1", "display_name": "EvanSkywalker", "link": "https://stackoverflow.com/users/12190876/evanskywalker"}, "edited": false, "score": 0, "creation_date": 1570732108, "post_id": 58312632, "comment_id": 103016187, "body": "@EvanSkywalker You are most welcome! Also, if you could do me a favor and mark my answer as the answer, that way this post can be closed, I would really appreciate it.  As for difficulty rating, I would say It depends on what you would rate your current ability at. If you think of yourself as a beginner, then this is solid 10, lol. If you are intermediate, then I would say a 6.5 ish, and advanced I would say like a 1. In each case I am considering 0 to be the most trivial and 10 to be the most difficult."}, {"owner": {"reputation": 3, "user_id": 12190876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd12285a08491b1a3576a1fd202a7d93?s=128&d=identicon&r=PG&f=1", "display_name": "EvanSkywalker", "link": "https://stackoverflow.com/users/12190876/evanskywalker"}, "edited": false, "score": 0, "creation_date": 1570732497, "post_id": 58312632, "comment_id": 103016355, "body": "marked!  Your rating makes sense to me.  I&#39;m definitely a beginner and understand about 50% of what you coded.  I guess i want to set my goal to be an intermediate...advance scares me and probably makes sense to pay someone so i don&#39;t blow up my computer."}], "tags": [], "owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "is_accepted": true, "score": 0, "last_activity_date": 1570656850, "creation_date": 1570656850, "answer_id": 58312632, "question_id": 58311120, "link": "https://stackoverflow.com/questions/58311120/impossible-excel-vba-email-loop/58312632#58312632", "title": "Impossible Excel-VBA Email Loop", "body": "<p>Based on your example I quickly wrote the following: </p>\n\n<pre><code>Option Explicit\n\nPublic Sub SendEmails()\n\n Dim dictEmailData As Object\n Dim CurrentWorkBook As Workbook\n Dim WrkSht As Worksheet\n Dim rngToLookUp As Range\n Dim lngLastRow As Long, i As Long\n Dim arryEmailData As Variant\n Dim objOutlookApp As Object, objOutlookEmail As Object\n Dim varKey As Variant\n\n    Application.ScreenUpdating = False\n\n    Set CurrentWorkBook = Workbooks(\"SomeWBName\")\n    Set WrkSht = CurrentWorkBook.Worksheets(\"SomeWSName\")\n    lngLastRow = WrkSht.Cells(WrkSht.Rows.Count, \"A\").End(xlUp).Row   'Find last row with data\n    Set rngToLookUp = WrkSht.Range(\"A2:B\" &amp; lngLastRow)              'set range for last row of data\n\n    arryEmailData = rngToLookUp.Value2    'Get the email data from the sheet into an array\n\n        Set dictEmailData = CreateObject(\"Scripting.Dictionary\")      'set the dicitonary object\n\n            On Error GoTo CleanFail\n            For i = LBound(arryEmailData, 1) To UBound(arryEmailData, 1)\n\n                varKey = UCase(Trim(arryEmailData(i, 1)))\n\n                    If Not dictEmailData.Exists(varKey) Then\n                        dictEmailData(varKey) = vbNewLine &amp; vbNewLine &amp; Trim(arryEmailData(i, 2))\n\n                    Else\n                        dictEmailData(varKey) = dictEmailData(varKey) &amp; vbNewLine &amp; Trim(arryEmailData(i, 2))\n\n                    End If\n\n                varKey = Empty\n\n            Next i\n\n            'for each unique key in the dicitonary\n            'get the corresponding item\n            'created in the loop above\n            Set objOutlookApp = CreateObject(\"Outlook.Application\") 'set the outlook object\n            Dim Msg As String, MailBody As String\n\n            For Each varKey In dictEmailData.Keys\n                Msg = dictEmailData.Item(varKey)\n                Set objOutlookEmail = objOutlookApp.CreateItem(0)\n\n                    MailBody = \"Dear Colleague,\" &amp; Msg\n                    With objOutlookEmail\n                        .To = varKey\n                        .Subject = \"Remittance Advice\"\n                        .Body = MailBody\n                        .Send\n                    End With\n                Set objOutlookEmail = Nothing\n                Msg = Empty: MailBody = Empty\n            Next\n\n    MsgBox \"All Emails have been sent\", vbInformation\n\nCleanExit:\n    Set objOutlookApp = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\n\nCleanFail:\n    Resume CleanExit\n\nEnd Sub\n</code></pre>\n\n<p>Add the first occurrence of a <code>varKey</code> = email address to the dictionary <code>dictEmailData</code> along with its corresponding <code>item</code> <code>dictEmailData(varKey)</code> = Email body. On the next occurrence of the email address, append to the Email body. Once the dictionary is built, loop through it and send the emails</p>\n\n<p>Printing to the immediate window yields: </p>\n\n<p><a href=\"https://i.stack.imgur.com/abhlK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/abhlK.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 12190876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd12285a08491b1a3576a1fd202a7d93?s=128&d=identicon&r=PG&f=1", "display_name": "EvanSkywalker", "link": "https://stackoverflow.com/users/12190876/evanskywalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 58312632, "answer_count": 1, "score": 0, "last_activity_date": 1570656850, "creation_date": 1570649714, "question_id": 58311120, "link": "https://stackoverflow.com/questions/58311120/impossible-excel-vba-email-loop", "title": "Impossible Excel-VBA Email Loop", "body": "<p>If someone could help me from going insane, my mother would appreciate it. </p>\n\n<p>I have a long list of email addresses (many repeats) with associated Audit Locations.  Basically I need to create <strong>one</strong> email for each email address and populate said email body with a list of all the associated Audit Locations. </p>\n\n<p>e.g.</p>\n\n<pre><code>Column One (Email Address)  |  Column 2 (Audit Location)\nYoda1@lightside.org   |  Coruscant\nYoda1@lightside.org   |  Death Star\nYoda1@lightside.org   |  Tatooine\nVader@Darkside.org    |  Death Star\nVader@Darkside.org    |  Coruscant\nJarjar@terrible.org   |  Yavin\n</code></pre>\n\n<p>So far I have created a CommandButton Controlled vba that takes Column One and makes it unique in a new worksheet.</p>\n\n<p>Then I have another sub that creates an email for each unique email address. But I am stuck on the \"If...Then\" statement.  Essentially, I want to add the information in Column 2 (Audit Location) if the Recipient of the email is the email address in Column One and then continue to append to the email body until the email address no longer equals the recipient email address.  Any guidance would be huge. </p>\n\n<pre><code>   Private Sub CommandButton1_Click()\n\nCall MakeUnique\nCall EmailOut\nEnd Sub\nSub MakeUnique()\nDim vaData As Variant\n    Dim colUnique As Collection\n    Dim aOutput() As Variant\n    Dim i As Long\n\n    'Put the data in an array\n    vaData = Sheet1.Range(\"A:A\").Value\n\n    'Create a new collection\n    Set colUnique = New Collection\n\n    'Loop through the data\n    For i = LBound(vaData, 1) To UBound(vaData, 1)\n        'Collections can't have duplicate keys, so try to\n        'add each item to the collection ignoring errors.\n        'Only unique items will be added\n        On Error Resume Next\n            colUnique.Add vaData(i, 1), CStr(vaData(i, 1))\n        On Error GoTo 0\n    Next i\n\n    'size an array to write out to the sheet\n    ReDim aOutput(1 To colUnique.Count, 1 To 1)\n\n    'Loop through the collection and fill the output array\n    For i = 1 To colUnique.Count\n        aOutput(i, 1) = colUnique.Item(i)\n    Next i\n\n    'Write the unique values to column B\n    Sheets.Add.Name = \"Unique\"\n    ActiveSheet.Range(\"A1\").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput\n\nEnd Sub\n\nSub EmailOut()\n    Dim xOutApp As Object\n    Dim xOutMail As Object\n    Dim xMailBody As String\n    On Error Resume Next\n\n\n    Dim cell As Range\n\n    For Each cell In Worksheets(\"Unique\").Columns(\"a\").Cells.SpecialCells(xlCellTypeConstants)\n    recip = cell.Value\n\n    Set xOutApp = CreateObject(\"Outlook.Application\")\n    Set xOutMail = xOutApp.CreateItem(0)\n\n        For Each org In Columns(\"b\").Cells.SpecialCells(xlCellTypeConstants)\n         If org.Value Like recip Then\n      xMailBody = \"Body content\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"This is line 1\" &amp; \" \" &amp; cell.Offset(0, 3).Value &amp; vbNewLine &amp; _\n              [B5] &amp; vbNewLine &amp; _\n              \"This is line 2\"\n\n             End If\n             Next org\n\nOn Error Resume Next\n    With xOutMail\n        .To = recip\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = cell.Offset(0, 2).Value &amp; \" \" &amp; cell.Offset(0, 3).Value &amp; \" \" &amp; \"Remittance Advice\"\n        .Body = xMailBody\n        .Display   'or use .Send\n    End With\n    On Error GoTo 0\n    Set xOutMail = Nothing\n    Set xOutApp = Nothing\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "odbc", "sql-like"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1570652207, "post_id": 58310879, "comment_id": 102984500, "body": "How many columns do you have to need to build a dynamic query? Hundreds?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1570686139, "post_id": 58310879, "comment_id": 102992374, "body": "@Parfait it depends upon the client forecast. Most csv&#39;s may have 30-40 SGroups shown in columns. But some may have just 5. So it variates everytime."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1570716952, "post_id": 58310879, "comment_id": 103008583, "body": "You need to clean up the CSVs to the format you need and then handle with SQL which relies on structured data."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 1, "creation_date": 1570651378, "post_id": 58311305, "comment_id": 102984229, "body": "I am using Excel with VBA to create the SQL query."}], "tags": [], "owner": {"reputation": 1, "user_id": 12191094, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MipgxfqzrBk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdH6pD4Jxi1s1aICcSOOmnfiY2UHQ/photo.jpg?sz=128", "display_name": "Nachiket Mundafale", "link": "https://stackoverflow.com/users/12191094/nachiket-mundafale"}, "is_accepted": false, "score": 0, "last_activity_date": 1570665805, "last_edit_date": 1570665805, "creation_date": 1570650517, "answer_id": 58311305, "question_id": 58310879, "link": "https://stackoverflow.com/questions/58310879/selecting-similar-column-names-having-common-text-in-sql-query/58311305#58311305", "title": "Selecting similar Column names having common text in SQL Query", "body": "<p>There is no straight forward way to achieve something like that.\nYou will either have to modify the VBA code to generate the string with the required columns.\nOr if changing the VBA is not possible, insert the data in a staging table and then generate a Dynamic query for selecting the required data</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>DECLARE @query NVARCHAR(MAX) = ''\nSELECT @query = @query + ',' + name\nFROM sys.columns\nWHERE object_name(object_id) = '&lt;Your Staging table name&gt;'\nAND name like 'sg%'\n\nSET @query = 'SELECT ' + RIGHT(@query, LEN(@query)-1) + '\nINTO &lt;whichever permanent or temp table you need&gt;\nFROM &lt;Your Staging table name&gt;'\n\nEXEC(@query)\n</code></pre>\n\n<p>This will give you the Select statement required for your details.</p>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1570665805, "creation_date": 1570648706, "question_id": 58310879, "link": "https://stackoverflow.com/questions/58310879/selecting-similar-column-names-having-common-text-in-sql-query", "title": "Selecting similar Column names having common text in SQL Query", "body": "<p>I am importing a CSV from a network drive, which has lots of columns containing text <code>SG_</code>. I am currently renaming these columns via code by running a 1st query to create a recordset with <code>SELECT TOP 1* FROM FILENAME.EXT</code> rows. Then i am looping the <code>recordset.Fields</code> and removing the prefixed text e.g. <code>nnn_</code> using <code>MID Function</code> and using the remaining text to use them as <code>Aliases</code> for these <code>SG</code> columns. So my 1st VBA created SQL string looks like this:</p>\n\n<pre><code>StrSQL = \"SELECT [Food],[Bev],[Meds],[Average 1],[Midpoint],[Average 2],[SG_ABC],[SG_DEF],[SG_GHI]\n</code></pre>\n\n<p>From this, i want to pick up the columns containing <code>SG_</code>.</p>\n\n<p><strong>Sample VBA Code:</strong></p>\n\n<pre><code>Set oCon = CreateObject(\"ADODB.Connection\")\nSet oRs = CreateObject(\"ADODB.Recordset\")\nstrCon = \"Driver=Microsoft Access Text Driver (*.txt, *.csv);Dbq=\" &amp; sFullDirectory &amp; \";Extensions=asc,csv,tab,txt;HDR=Yes;\"        \n\nstrSQL = \"SELECT TOP 1 * FROM \" &amp; FILE1\noCon.Open strCon\nSet oRs = oCon.Execute(strSQL)\n\ni = 1\nstrSQL = \"SELECT \"\n\nFor Each Fld In oRs.Fields\n    Select Case True\n     Case Is = InStr(1, Fld.Name,\"SG_\") &gt; 0\n       TempSG=Trim(Mid(Fld.Name,InStr(1,Fld.Name,\"SG_\"),Len(Fld.Name)))\n       strSQL = strSQL &amp; \" CDbl([\" &amp; Fld.Name &amp; \"]) AS [\" &amp; TempSG &amp; \"], \"\n....more Cases...\n\n  End Select\nNext Fld\n\noRs.Close\n....more code.\n</code></pre>\n\n<p>Then i am joining this <code>strSQL</code> query to other tables for selecting other columns and loading the result to an ado recordset. I am currently using <strong>Microsoft Access Text Driver</strong> in Excel using VBA. </p>\n\n<pre><code>strSQL1 = \"SELECT  G.[lbl], A.[tval], Q.*\"\nstrSQL1 = strSQL1 &amp; \" FROM \"\nstrSQL1 = strSQL1 &amp; \" (SELECT G.[pos], A.[pos], G.[lbl], A.[tval] FROM \" &amp; FILE2 &amp; \"  G,\" &amp; FILE3 &amp; \" A WHERE G.[ID] = A.[ID])  T, (\" &amp; strSQL &amp; \")  Q \"\nstrSQL1 = strSQL1 &amp; \" WHERE (CLng(T.[G].[pos]) = CLng(Q.[gval])) AND (CLng(T.[A].[pos]) = CLng(Q.[pos]))\"\nstrSQL1 = strSQL1 &amp; \" ORDER BY CLng(Q.[gval]), CDbl(Q.[Aggregate 1]) DESC, G.[lbl];\"\n\nSet oRs = oCon.Execute(strSQL1)\n</code></pre>\n\n<p>In the above code, <code>Q.*</code> represents the below table from which i want to only select the <code>SG_</code> columns. Hope this makes things clear. e.g.</p>\n\n<pre><code>SELECT  G.[lbl], A.[tval], Q.* LIKE 'SG_'\n</code></pre>\n\n<p><strong>CSV Table:</strong></p>\n\n<pre><code>Food   |  Bev |  Meds | Average |  Midpoint  |  Average  | 434_SG_ABC | 236_SG_DEF | 121_SG_GHI  |\n--------------------------------------------------------------------------------------------------\ncheese | Rum  |  cold | 1.22    |  4.98      |   0.24    |  23.43     |  54.67     |  89.33      |\nButter | Wine |  heat | 3.56    |  2.40      |   0.98    |  12.12     |  90.23     |  33.43      |\nOlive  | Beer |  rain | 4.33    |  7.11      |   1.45    |  11.55     |  10.31     |  87.22      |\nRice   | Gin  |  hail | 2.02    |  7.86      |   3.36    |  25.82     |  29.44     |  65.70      |\n</code></pre>\n\n<p>Is there a way to select these Columns?</p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570649280, "post_id": 58310667, "comment_id": 102983382, "body": "Make sure <code>Frame</code> is resolving to the correct type - if <code>Access.Frame</code> is a thing (IDK), then it takes precedence over <code>MSForms.Frame</code> because <code>Access</code> is higher in the reference priority (it&#39;s the host app, so you can&#39;t move it down). Try fully qualifying <code>Dim MyFrame As MSForms.Frame</code>."}, {"owner": {"reputation": 33, "user_id": 5178865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d1e533ea5f94bce40ac0183e44c976?s=128&d=identicon&r=PG&f=1", "display_name": "EddieL", "link": "https://stackoverflow.com/users/5178865/eddiel"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570649750, "post_id": 58310667, "comment_id": 102983580, "body": "Mathieu that is brilliant. Thank you so much. It is working perfectly now."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570649865, "post_id": 58310667, "comment_id": 102983634, "body": "Cool! Posted as an answer, below - feel free to mark as accepted!"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1570649844, "creation_date": 1570649844, "answer_id": 58311147, "question_id": 58310667, "link": "https://stackoverflow.com/questions/58310667/type-mismatch-in-set-frame-statement/58311147#58311147", "title": "Type mismatch in set frame statement", "body": "<p>Assuming you mean <code>Frame</code> to refer to the MSForms type, then you may need to fully-qualify it:</p>\n\n<pre><code>Dim MyFrame As MSForms.Frame\n</code></pre>\n\n<p>In general, it's a good habit to fully-qualify types that have a name that may exist in more than just one referenced type library: if <code>Access.Frame</code> exists, then it has a higher priority in the resolution order (see ordering of libraries in the tools/references dialog), so an unqualified <code>Frame</code> would be implicitly <code>Access.Frame</code>, hence the type mismatch.</p>\n"}], "owner": {"reputation": 33, "user_id": 5178865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d1e533ea5f94bce40ac0183e44c976?s=128&d=identicon&r=PG&f=1", "display_name": "EddieL", "link": "https://stackoverflow.com/users/5178865/eddiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 58311147, "answer_count": 1, "score": 1, "last_activity_date": 1570649844, "creation_date": 1570647902, "last_edit_date": 1570648204, "question_id": 58310667, "link": "https://stackoverflow.com/questions/58310667/type-mismatch-in-set-frame-statement", "title": "Type mismatch in set frame statement", "body": "<p>I am trying to use the Outlook View Control in Microsoft Access. As I understand it, this can only be used by embedding it in a Microsoft Forms 2.0 Frame control. </p>\n\n<p>After being unsuccessful, I downloaded a database from Experts Exchange that worked fine. When I tried to replicate it in my database I received a Type Mismatch error. I then imported the form from the database I had downloaded which was working correctly, but when I ran it in my database, I get the same type mismatch error.</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n\n    Dim MyFrame As Frame\n    Dim vc As viewctl\n\n    Set MyFrame = Me.Frame0.Object\n    Set vc = MyFrame!ViewCtl1\n\n    With vc\n        .Folder = \"John Smith\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The code is very simple, but I fail to understand what is causing the problem. The references have been added for Microsoft Forms 2.0 object library and Microsoft Outlook View Control. In fact, I have all of the references in the working database I downloaded together with others in my database.</p>\n\n<p>The code is as follows:</p>\n\n<p>The error throws up on <code>Set MyFrame = Me.Frame0.Object</code> as </p>\n\n<blockquote>\n  <p>error 13 Type Mismatch.</p>\n</blockquote>\n\n<p>The folder name is the name of a shared calendar.</p>\n\n<p>If anyone can help I would be very grateful.</p>\n\n<p>The link to the database I downloaded is: </p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/4617/Outlook-View-Control-OVC-part-two-Changing-folders-and-interacting-programmatically-Access-2007.html#comments\" rel=\"nofollow noreferrer\">https://www.experts-exchange.com/articles/4617/Outlook-View-Control-OVC-part-two-Changing-folders-and-interacting-programmatically-Access-2007.html#comments</a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1570647985, "post_id": 58310430, "comment_id": 102982833, "body": "Is the error literally &quot;<i>Method or Data Member Not found for every control or event</i>&quot;? Might be helpful to see the line that the error show up on."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570654884, "post_id": 58310430, "comment_id": 102985549, "body": "Run Compact &amp; Repair, maybe even decompile then recompile. There may be corruption that cannot be fixed without recreating something, maybe even require new db file. Start by building another form and see if its code finds fields/controls."}, {"owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "edited": false, "score": 0, "creation_date": 1570665480, "post_id": 58310430, "comment_id": 102988122, "body": "I found out the issue but not sure why Access misguided me. Posted below"}], "answers": [{"tags": [], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "is_accepted": true, "score": 0, "last_activity_date": 1570665383, "creation_date": 1570665383, "answer_id": 58313661, "question_id": 58310430, "link": "https://stackoverflow.com/questions/58310430/method-or-data-member-not-found-for-every-control-or-event-suddenly/58313661#58313661", "title": "Method or Data Member Not found for every control or event suddenly", "body": "<p>Well, I had about 9 or 10 references to the form controls and I had incorrect name on one of them. </p>\n\n<pre><code>strSelectQuery = \"SELECT \" &amp; Me.ID &amp; \" ,\" &amp; Nz(Me.Date, \"Null\") &amp; \" ,\" &amp; Me.User &amp; \" ,\" &amp; Nz(Me.Name, \"Null\") &amp; _\n    \" ,'\" &amp; Me.Val &amp; \"' ,'\" &amp; Me.JOB &amp; \"' , INVD.ID,0,0,0, '\" &amp; Me.vis &amp; \"', '\" &amp; me.vis2 &amp; \"', '\" &amp; ind &amp; \"', '\" &amp; Me.vis4 &amp; \"', '\" &amp; Me.vid3 &amp; \"', '\" &amp; Me.vid5 &amp; \"'\" &amp; _\n    \" FROM Table1\"\n</code></pre>\n\n<p>All of the control names were correct except <code>me.vis2</code> was supposed to be <code>me.vid2</code>, however Access was not highlighting that field but was highlighting other controls that were not incorrect. </p>\n\n<p>I had to remove everything and type it one at at time to find out the issue. </p>\n\n<p>Throwing error on correct field names completely threw me off as I thought something was wrong with Access.</p>\n\n<p>If someone could explain why this happens that would be great.</p>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58313661, "answer_count": 1, "score": -1, "last_activity_date": 1594278560, "creation_date": 1570646896, "last_edit_date": 1594278560, "question_id": 58310430, "link": "https://stackoverflow.com/questions/58310430/method-or-data-member-not-found-for-every-control-or-event-suddenly", "title": "Method or Data Member Not found for every control or event suddenly", "body": "<p>I was working on my access project and I closed and restarted it. I do not think that I changed anything in there. I have a button click event in the form that gets values like</p>\n\n<p><code>me.num</code>, <code>me.amount</code> etc.</p>\n\n<p>On button click however I am getting an error:</p>\n\n<blockquote>\n  <p>Method or Data Member Not found for every control or event</p>\n</blockquote>\n\n<p>on every single controls.</p>\n\n<p>I made sure that all of my references are there</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZuJRX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZuJRX.png\" alt=\"enter image description here\"></a></p>\n\n<p>What is really wierd is that if I type <code>me.</code> access automatically brings up all the field names that it says it cannot find when the button click event fires. </p>\n\n<p>I have deleted the button and recreated a new one and pasted the code but it gives the same error.</p>\n\n<p>How is this even possible?</p>\n"}, {"tags": ["excel", "vba", "range", "max", "long-integer"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1570645909, "post_id": 58310151, "comment_id": 102981962, "body": "It works with<code>xlformulas</code> - don&#39;t ask me why!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1570646146, "post_id": 58310151, "comment_id": 102982078, "body": "And if the whole column is empty, it throws 1004 error."}, {"owner": {"reputation": 15, "user_id": 12190618, "user_type": "registered", "profile_image": "https://graph.facebook.com/2571266699562775/picture?type=large", "display_name": "Jeff F", "link": "https://stackoverflow.com/users/12190618/jeff-f"}, "edited": false, "score": 0, "creation_date": 1570646941, "post_id": 58310151, "comment_id": 102982389, "body": "I have been banging my head on this for about 8 hours... xlformulas... it works... so frustrated but relieved. Thanks."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1570647574, "post_id": 58310151, "comment_id": 102982664, "body": "@JeffF - <code>Find</code> is really a bit buggy sometimes, giving unexpected outcome with doubles and dates. Usually if possible I write my own function (and loop slowly) or parse to string. <a href=\"https://stackoverflow.com/questions/48932196/range-find-not-making-a-difference-between-january-and-november-february-and-de\">Find bugs example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1570646970, "post_id": 58310360, "comment_id": 102982399, "body": "@SJR - I just thought it is buggy. Anyway, the problem is in the <code>,</code> and the <code>.</code>. VBA uses dot and Excel uses comma as a decimal separator. I have edited."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570646985, "post_id": 58310360, "comment_id": 102982405, "body": "@JvdV - same with me actually. I have edited it to make it work."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570647576, "post_id": 58310360, "comment_id": 102982666, "body": "I&#39;m still not sure about the answer. While it obviously would work since you parse values as string, the <code>What</code> parameter of <code>Find</code> <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">can take any excel data type</a>. And if we first try to inspect the variable <code>WorksheetFunction.Large(Range(&quot;A:A&quot;), 1)</code> we can see that VBA stores it with a dot since its en_US based. You sure it&#39;s a bug and <code>Find</code> takes strings only? Why would under 9 chars work? Furthermore, why would <code>xlFormulas</code> work. I&#39;m also trying to make sense of this atm. =)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570647851, "post_id": 58310360, "comment_id": 102982776, "body": "@JvdV - <code>WorksheetFunction.Large(Range(&quot;A:A&quot;), 1)</code> works correctly and passes it to the <code>biggus</code> variable of type <code>double</code> correctly. The problem appears when the <code>A:A</code> column is searched for that variable - it &quot;reads&quot; wrongly the dots and the commas, thus it cannot find it."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570653991, "post_id": 58310360, "comment_id": 102985211, "body": "@JvdV - concerning the other questions - <code>Find()</code> does not takes strings only, but it parses to string the arguments and thus the problem appears. The under 9 chars functioning should be some kind of optimization, in order to make the function quick, I guess. And about <code>xlFormulas</code> automatically converts the input of the cell to string, thus it works. After all, <code>=SUM(A1+A2)</code> is a pure string (e.g., not a <code>Long</code>, nor <code>Date</code>, nor <code>Double</code>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570687592, "post_id": 58310360, "comment_id": 102992845, "body": "Thanks for the explanation Vityata. Still find the whole operation weird and buggy but it also strangely makes sense. Ohwell. + For the research on this. =)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1570654143, "last_edit_date": 1570654143, "creation_date": 1570646568, "answer_id": 58310360, "question_id": 58310151, "link": "https://stackoverflow.com/questions/58310151/vba-range-find-function-not-working-with-large-floating-numbers/58310360#58310360", "title": "VBA Range.Find() function not working with large floating numbers", "body": "<p>The problem is in the different decimal separators that Excel and VBA are using. Thus, in the floating point values, there is a \"hidden feature\". The <code>Find()</code> function actually looks for a <code>string</code> and the double is \"stringified\" obviously not the correct way - with a comma and not with a dot. Consider parsing to string and replacing the comma with a dot to make it work:</p>\n\n<pre><code>Sub Populate()\n\n    Dim foo As Range        \n    Dim biggus As Double\n\n    biggus = WorksheetFunction.Large(Range(\"A:A\"), 1)\n    Set foo = Range(\"A:A\").Find(ReplaceCommas(biggus), , xlValues)\n\n    Debug.Print foo.Address\n\nEnd Sub\n\nFunction ReplaceCommas(valueAsString As Variant) As String\n\n    Dim valueToReplace  As String\n    valueToReplace = valueAsString\n    ReplaceCommas = Replace(valueAsString, \",\", \".\")\n\nEnd Function\n</code></pre>\n\n<p>The fact that the \"feature\", does not appear, when <code>xlFormulas</code>, is in the <code>SearchIn</code> parameter, is due to the fact, that <code>xlFormulas</code> converts the content of the cell to string, in order to search in it. E.g., if there is <code>=SUM(A1+A2)</code> and we are looking for <code>1+A</code>, the only way to find it is to parse the content of the cell to String.</p>\n"}], "owner": {"reputation": 15, "user_id": 12190618, "user_type": "registered", "profile_image": "https://graph.facebook.com/2571266699562775/picture?type=large", "display_name": "Jeff F", "link": "https://stackoverflow.com/users/12190618/jeff-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570654397, "creation_date": 1570645534, "last_edit_date": 1570654397, "question_id": 58310151, "link": "https://stackoverflow.com/questions/58310151/vba-range-find-function-not-working-with-large-floating-numbers", "title": "VBA Range.Find() function not working with large floating numbers", "body": "<p>I am writing code to lookup the highest dollar amount in a column and bring back the value as well as the value of cells in adjacent columns with 9 char in the target cell</p>\n\n<p>When I set the range variable it shows the value of \"12000.88\" which works fine, however as soon as that value extends to over 9 digits \"123000.55\" the \"set fnd\" doesn't find it and the range variable is Nothing. I have tested many other things and have found the only difference is the length of the value</p>\n\n<pre><code>Sub Populate()\n\n    Dim Fnd As Range    \n    Set Fnd = Range(\"L:L\").Find(WorksheetFunction.Large(Range(\"L:L\"), 1), , xlValues)\n\nEnd Sub\n</code></pre>\n\n<p>I have no problem with smaller numbers but I don't understand why this wouldn't work with larger numbers.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570645779, "post_id": 58310096, "comment_id": 102981911, "body": "Put a breakpoint on the first line in your code and run in from the userform again just to check if you actually call the same sub. If this is the code you call it shouldn&#39;t hang for minutes."}, {"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570646303, "post_id": 58310096, "comment_id": 102982154, "body": "I tried adding a breakpoint and ran it from the userform, and it does call the proper function."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570647878, "post_id": 58310096, "comment_id": 102982785, "body": "You&#39;re iterating a range and involving the clipboard (which shouldn&#39;t be needed to overwrite formulas in-place with their respective values) - consider extending the <code>Find</code> area to the <code>CurrentRegion</code> you&#39;re iterating, and looping until <code>Find</code> returns <code>Nothing</code>: there&#39;s no need to iterate each row individually. As for the slowdown, could be <code>Application.ScreenUpdating</code> being <code>True</code> causing constant redraws since there&#39;s now a form displayed. Try setting it to <code>False</code> (and back to <code>True</code> once done)."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570648016, "post_id": 58310096, "comment_id": 102982844, "body": "Ill piggyback off of @MathieuGuindon - all those range objects could be done in memory. You could easily rewrite this to not interact with the excel application until the very end."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570648064, "post_id": 58310096, "comment_id": 102982860, "body": "Also <code>r</code> for a variable representing a cell in row 1 is... confusing, at best."}, {"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570648349, "post_id": 58310096, "comment_id": 102982974, "body": "I did as @MathieuGuindon suggest by turning Application.ScreenUpdating to True, and that solved the issue of speed! It ran almost instantly. Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570648496, "post_id": 58310096, "comment_id": 102983044, "body": "Note that it doesn&#39;t make your code any more <i>efficient</i> - it only makes Excel stop redrawing. There&#39;s quite a bit of room for actual efficiency enhancements here, feel free to post your (entire) code on <a href=\"https://codereview.stackexchange.com\">Code Review</a> if you&#39;d like feedback on any/all aspects of the code, and learn a bunch of new concepts."}, {"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "edited": false, "score": 0, "creation_date": 1570648673, "post_id": 58310096, "comment_id": 102983132, "body": "That makes sense. I am relatively new to VBA so I know there are many enhancements I can make to the code, and it always helps to get a second eye to look at it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570649010, "post_id": 58310096, "comment_id": 102983277, "body": "I&#39;d warmly recommend running it by <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> code inspections first though - that could eliminate a number of &quot;low-hanging fruit&quot; issues that reviewers are definitely going to point out anyway =)"}, {"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570655815, "post_id": 58310096, "comment_id": 102985891, "body": "@MathieuGuindon Could you expand a little further what lines of code I would change to update the Find area to the Current Region. This is a code I adapted from someone else, and I am still pretty new to VBA."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570657568, "post_id": 58310096, "comment_id": 102986441, "body": "Don&#39;t worry about it for now, so long as it works as intended, it being inefficient will definitely be fully addressed in details over on Code Review!"}], "owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570647586, "creation_date": 1570645303, "last_edit_date": 1570647586, "question_id": 58310096, "link": "https://stackoverflow.com/questions/58310096/macro-runs-faster-when-run-from-developer-pane-but-extremley-slow-when-called-f", "title": "Macro runs faster when run from developer pane, but extremley slow when called from userform", "body": "<p>I am run the same piece of VBA code in Excel in two different ways.\n 1. From the developer tab, takes less than 2 sec.\n 2. Calling the macro from a userform, takes over a minute and freezes</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Import()\n\nDim wbSource As Workbook\nDim wbDest As Workbook\nDim TargetSheet As Worksheet\nDim c As Range\nDim rng As Range\nDim i As Integer\nDim MyRange As Range\nDim SourceSheet As Worksheet\nDim source As String\nDim dest As String\nDim r As Range\nDim msg As String\n\n\nsource = Worksheets(\"Set-Up\").Range(\"B11\")\ndest = Worksheets(\"Set-Up\").Range(\"B8\")\n\nSet wbSource = Workbooks(source)\nSet SourceSheet = wbSource.Worksheets(\"HFL01 Extract\")\nSet wbDest = Workbooks(dest)\nSet TargetSheet = wbDest.Worksheets(\"INPUTS1\")\n\n    With SourceSheet.Range(\"A1\").CurrentRegion\n        For Each r In TargetSheet.Range(\"A1:N1\") 'Range(\"A1:cc1\")\n            Set c = .Rows(1).Find(r.Value, , , xlWhole, , 0)\n            If Not c Is Nothing Then\n                .Columns(c.Column).Copy\n                r.PasteSpecial xlPasteValues\n\n            End If\n        Next\n        Application.CutCopyMode = False\n    End With\n\nSet fileDialog = Nothing\nSet wbSource = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Why does running the macro in different ways cause it to be slow? How do I make the macro run at the same speed when called from the userform?</p>\n"}, {"tags": ["sql", "excel", "vba", "odbc", "import-csv"], "comments": [{"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1570644678, "post_id": 58309879, "comment_id": 102981394, "body": "I know you are not asking advice on this, but I am sure you could give better names to both Average Columns, even if you get the problem sorted this way, this is recipe for disaster... They could be called whatever they are the average of... Average_Temp or Average_Weight, whatever..."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1570644797, "post_id": 58309879, "comment_id": 102981448, "body": "@AndrasDorko, yes they represent some different weights, but i need to pull them first. Right now, i am helpless as only the 1st Average column gets pulled in twice...though i can see in the Watch window on looping on the Fld.Name, that the 2nd column gets selected the 2nd time."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570646347, "post_id": 58309879, "comment_id": 102982168, "body": "Have you tried a <code>select into</code> then correcting the resultant table, or using some of the other functions etc of ADO, if you&#39;re using that, cant see how the recordset is populated, but there are things like <code>.openschema</code> to inspect maybe, not sure how you&#39;re accessing, so a bit of a finger in the air.  Or in the connection string <code>HDR=Yes</code> could be your solution, leave the fields as is, unless if start &quot;Field&quot;?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570646591, "post_id": 58309879, "comment_id": 102982259, "body": "@Nathan_Sav, I am using <code>ODBC Microsoft Access Text Driver</code> with <code>HDR=YES</code> in <code>EXCEL VBA</code>. I cannot dump into a <code>resultant table</code> as i am creating a <code>Recordset</code> on the fly."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570646690, "post_id": 58309879, "comment_id": 102982299, "body": "Can you explain your reasoning then please?  Where is the data to be going?  Can it not be treated as a text file as in normal opening?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570646703, "post_id": 58309879, "comment_id": 102982308, "body": "@Nathan_Sav i am not familiar with <code>.openschema</code>. Is there a way to know how duplicate Columns can be referenced individually in SQL with it?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570646787, "post_id": 58309879, "comment_id": 102982340, "body": "@Nathan_Sav for automated Pivot Charts and Pivot Tables. Via VBA code, i am creating an SQL string that joins multiple csv files to pull different columns and create a single recordset. Hope this makes things clear."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1570650246, "post_id": 58311153, "comment_id": 102983783, "body": "I am using the <code>MICROSOFT ACCESS TEXT DRIVER</code> because the file paths contain spaces in the sub-folders. I am not able to work with JET or ACE because of this reason."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1570651277, "post_id": 58311153, "comment_id": 102984189, "body": "Yes, I using backticks with the Access driver, which somehow don&#39;t work with ACE. BTW, I am using Excel 2016 pro."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1570702338, "post_id": 58311153, "comment_id": 103000063, "body": "modified the post including the entire code. Also, included the other post question here to save time."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1570716320, "post_id": 58311153, "comment_id": 103008167, "body": "Wow! This is a radically different question now. Will need to delete my answer here. Fundamentally, you should not use SQL which relies on structured, relational data not flat files of varying content. SQL on CSV is a convenience tool. Consider data analytics tools (Python Pandas, R, Julia, SAS, Stata, SPSS) which can easily read in CSVs, split and clean up headers, and merge data sets or run loops in Excel to clean up the CSVs."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574328444, "post_id": 58311153, "comment_id": 104196564, "body": "Hi @Parfait, could you update your answer for the various drivers, to reflect a join between 2 files viz., <code>File1.csv</code> &amp; <code>File2.csv</code> ? Currently, i am getting an error <code>Syntax error in FROM clause</code> when i am trying to join 2 csv files."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574348632, "post_id": 58311153, "comment_id": 104208947, "body": "Please show your attempted SQL. Make sure you bracket the file names <code>[...]</code>."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1574352211, "post_id": 58311153, "comment_id": 104211160, "body": "here is the post where i have put the SQL and issue. Could you help me with it? I tried using your given suggestions with the various drivers, but not working. <code>https:&#47;&#47;stackoverflow.com&#47;questions&#47;58917099&#47;excel-vba-micro&zwnj;&#8203;softodbc-text-driver&zwnj;&#8203;-record-is-too-large</code>"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1570652051, "last_edit_date": 1570652051, "creation_date": 1570649872, "answer_id": 58311153, "question_id": 58309879, "link": "https://stackoverflow.com/questions/58309879/importing-csv-having-duplicate-column-names-with-sql-query/58311153#58311153", "title": "Importing CSV having Duplicate Column names with SQL Query", "body": "<p>Consider running pure SQL by querying the CSV file directly with needed column aliases:</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT t.Food, t.Bev, t.Meds, t.[Average], t.Midpoint, t.Average AS [OtherAverage]\nFROM [text;database=C:\\Folder\\To\\CSV With Spaces].[my File].csv AS t;\n</code></pre>\n\n<p>Additionally, query can be integrated into action queries:</p>\n\n<p>Make-Table Query</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT t.Food, t.Bev, t.Meds, t.[Average], t.Midpoint, t.Average AS [OtherAverage]\nINTO [myNewtable]\nFROM [text;database=C:\\Folder\\To\\CSV With Spaces].[my File].csv AS t;\n</code></pre>\n\n<p>Append Query</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO myFinalTable (Food, Bev, Meds, Average, Midpoint, OtherAverage)\nSELECT t.Food, t.Bev, t.Meds, t.Average, t.Midpoint, t.Average AS [OtherAverage]\nFROM [text;database=C:\\Folder\\To\\CSV With Spaces].[my File].csv AS t;\n</code></pre>\n\n<hr>\n\n<p>To run with ADO in VBA, use the Jet/ACE SQL engine either with Excel or Access ODBC driver where workbook or database file source does not matter since you remotely connect to CSV:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set conn = CreateObject(\"ADODB.Connection\")\nSet rst = CreateObject(\"ADODB.Recordset\")\n\n' EXCEL DRIVER\nconn.Open \"Driver={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n            &amp; \"DBQ=\" &amp; ThisWorkbook.FullName &amp; \";\"\nrst.Open \"SELECT t.Food, t.Bev, t.Meds, t.[Average], t.Midpoint, t.Average AS [OtherAverage] \" _\n            &amp; \" FROM [text;database=C:\\Folder\\To\\CSV With Spaces].[my File].csv AS t\", conn \n\n' ACCESS DRIVER\nconn.Open \"Driver={Microsoft Access Driver (*.mdb, *.accdb)};\" _\n            &amp; \"DBQ=C:\\Path\\To\\Any\\Database.accdb\"\nrst.Open \"SELECT t.Food, t.Bev, t.Meds, t.[Average], t.Midpoint, t.Average AS [OtherAverage] \" _\n            &amp; \" FROM [text;database=C:\\Folder\\To\\CSV With Spaces].[my File].csv AS t\", conn \n</code></pre>\n\n<p>Using the Access ODBC text driver</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Set oCon = CreateObject(\"ADODB.Connection\")\nSet oRs = CreateObject(\"ADODB.Recordset\")\n\nsFullDirectory = \"C:\\Folder\\To\\CSV With Spaces\"\n\nstrCon = \"Driver=Microsoft Access Text Driver (*.txt, *.csv);\" _\n           &amp; \"Dbq=\" &amp; sFullDirectory &amp; \";Extensions=asc,csv,tab,txt;HDR=Yes;\"\nstrSQL = \"SELECT t.Food, t.Bev, t.Meds, t.[Average], t.Midpoint, t.Average AS [OtherAverage] \" _\n            &amp; \" FROM [my File.csv] AS t\"\n\noCon.Open strCon\nSet oRs = oCon.Execute(strSQL)\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1570715625, "creation_date": 1570644302, "last_edit_date": 1592644375, "question_id": 58309879, "link": "https://stackoverflow.com/questions/58309879/importing-csv-having-duplicate-column-names-with-sql-query", "title": "Importing CSV having Duplicate Column names with SQL Query", "body": "<p>I have 3 csv files located in different network folders. The network folders/sub-folders may have spaces in them. I want to join these 3 csv files to create a single ADO Recordset containing required columns.</p>\n<p><strong>Test1.csv</strong> (I have excluded unnecessary columns from all csv's)</p>\n<pre class=\"lang-none prettyprint-override\"><code>T1Id  | Gpos | lbl\n-----------------------\n1001  |  0   | Innovate\n1002  |  1   | Buys\n1003  |  2   | Sales\n1004  |  3   | Forecasts\n1005  |  4   | Usage\n1006  |  5   | Forum\n</code></pre>\n<p><strong>Test2.csv:</strong> (I have excluded unnecessary columns from all csv's)</p>\n<pre class=\"lang-none prettyprint-override\"><code>T2Id |  T1Id |  Apos | tval\n-----------------------------------\n382  |  1001 |  1   | my life my rules.\n203  |  1001 |  2   | earth wind rain and fire.\n658  |  1002 |  1   | wealth power blood desire.\n200  |  1003 |  1   | one good to live for.\n301  |  1003 |  2   | before we die.\n439  |  1004 |  1   | one taste to glory\n795  |  1004 |  2   | one mouthful of sky.\n494  |  1004 |  3   | some other text.\n</code></pre>\n<p><strong>Test3.csv:</strong> (I have excluded unnecessary columns from all csv's)</p>\n<pre class=\"lang-none prettyprint-override\"><code>(blank)  Aggregate (blank) Aggregate  149_SG_Bryl_Cream   891_SG_Myo__Sky_Blue_Dress\n------------------------------------------------------------------------------\nX0.1     0.422300          0.424658    0.458014          0.434639\nX0.2     0.318628          0.345475    0.334548          0.333675\nX0.3     0.274694          0.274643    0.243424          0.286865\nX0.4     0.294568          0.346758    0.276552          0.366648\nX1.1     0.565734          0.293436    0.283564          0.235366\nX1.2     0.286657          0.755456    0.283233          0.310544\nX2.1     0.234643          0.245459    0.245434          0.343423\nX2.2     0.343645          0.455659    0.343282          0.334343\nX2.3     0.234643          0.245459    0.245434          0.343423\n</code></pre>\n<p>As you can see, Test3.csv has 4 issues:</p>\n<ol>\n<li>It has Columns with Blank headers, but containing data e.g. <code>X0.1</code>.</li>\n<li>It has Columns with Blank headers, but with <code>no data</code>.</li>\n<li>It has 2 <code>Aggregate</code> columns with same names.</li>\n<li>It has <code>SG</code> columns (many) that i need to extract <code>only the part starting from 'SG'.</code></li>\n</ol>\n<p><strong>Requirements</strong></p>\n<ol>\n<li><code>Test1</code> &amp; <code>Test2</code> CSVs need to be joined on <code>T1Id</code>.</li>\n<li>Only the <code>lbl</code> and <code>tval</code> columns from these file need ot be kept.</li>\n<li>The <code>Apos</code> and <code>Gpos</code> will be used to join 2 columns created from the 1st blank Header column (containing values like <code>X0.1</code>) in <code>Test3.csv</code> file.</li>\n</ol>\n<p><strong>Code:</strong></p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Doit(cFiles As Collection)\n        \n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n    \n    Dim strSQL1$, TempSG$,sFullDirectory$\n    \n    sFullDirectory = `\\\\xxx.xxx.xxx\\client name`\\\n    \n    strFF1 = &quot;Test1.csv&quot;\n    strFF2 = &quot;Test2.csv&quot;\n    strFF3 = &quot;Test3.csv&quot;\n   \n    ' Test1.csv Path: `\\\\xxx.xxx.xxx\\client name\\XYZ\\sub-folder1 name`\\\n    strF1 = cFiles(strFF1) \n\n    ' Test1.csv Path: `\\\\xxx.xxx.xxx\\client name\\ABC\\sub-folder2 name`\\\n    strF2 = cFiles(strFF2)\n\n    ' Test1.csv Path: `\\\\xxx.xxx.xxx\\client name\\DEF\\GHI\\sub-folder1 name`\\\n    strF3 = cFiles(strFF3)\n\n    Set oCon = CreateObject(&quot;ADODB.Connection&quot;)\n    Set oRs = CreateObject(&quot;ADODB.Recordset&quot;)\n    strCon = &quot;Driver=Microsoft Access Text Driver (*.txt, *.csv);Dbq=&quot; &amp; sFullDirectory &amp; &quot;;Extensions=asc,csv,tab,txt;HDR=Yes;&quot;\n    \n    ' Select TOP 1 row with headers from `Test3.csv`\n    strSQL = &quot;SELECT TOP 1 * FROM &quot; &amp; strF3 &amp; strFF3\n    oCon.Open strCon\n    Set oRs = oCon.Execute(strSQL)\n    \n    i = 1\n    strSQL = &quot;SELECT &quot;\n\n    For Each Fld In oRs.Fields\n        Select Case True\n            Case Is = Fld.Name = &quot;NoName&quot;  'Blank header columns\n                If Fld.Value &lt;&gt; vbNullString Then\n                    strSQL = strSQL &amp; &quot; CLng(Replace(Left(&quot; &amp; Fld.Name &amp; &quot;, InStr(&quot; &amp; Fld.Name &amp; &quot;, '.') - 1), 'X', ''))&quot; &amp; &quot; AS [gval],&quot;\n                    strSQL = strSQL &amp; &quot; CLng(Right(&quot; &amp; Fld.Name &amp; &quot;, Len(&quot; &amp; Fld.Name &amp; &quot;) - InStr(&quot; &amp; Fld.Name &amp; &quot;, '.')))&quot; &amp; &quot; AS [pos],&quot;\n                Else\n                ' Do nothing here\n                End If\n            Case Is = Fld.Name = &quot;Aggregate&quot;\n                strSQL = strSQL &amp; &quot; CDbl([&quot; &amp; Fld.Name &amp; &quot;]) AS [Aggregate &quot; &amp; i &amp; &quot;],&quot;\n                i = i + 1\n            Case Is = InStr(1, Fld.Name, &quot;SG&quot;) &gt; 0\n                TempSG = Trim(Mid(Fld.Name, InStr(1, Fld.Name, &quot;SG&quot;), Len(Fld.Name)))\n                strSQL = strSQL &amp; &quot; CDbl([&quot; &amp; Fld.Name &amp; &quot;]) AS [&quot; &amp; TempSG &amp; &quot;], &quot;\n        End Select\n    Next Fld\n    \n    If Right(Trim(strSQL), 1) = &quot;,&quot; Then strSQL = Left(Trim(strSQL), Len(Trim(strSQL)) - 1)\n    strSQL = strSQL &amp; &quot; FROM &quot; &amp; strF3 &amp; strFF3\n    strSQL = strSQL &amp; &quot; WHERE ((NoName) &lt;&gt; 'Base Sizes')&quot;\n    \n    oRs.Close\n    \n    ' This `strSQL1` will be used to join `strSQL`.\n    strSQL1 = &quot;SELECT  G.[lbl], A.[tval], Q.*&quot;\n    strSQL1 = strSQL1 &amp; &quot; FROM &quot;\n    strSQL1 = strSQL1 &amp; &quot; (SELECT G.[Gpos], A.[Apos], G.[lbl], A.[tval] FROM &quot; &amp; strF1 &amp; strFF1 &amp; &quot;  G,&quot; &amp; strF2 &amp; strFF2 &amp; &quot;  A WHERE G.[T1Id] = A.[T1Id])  T, (&quot; &amp; strSQL &amp; &quot;)  Q &quot;\n    strSQL1 = strSQL1 &amp; &quot; WHERE (CLng(T.[G].[Gpos]) = CLng(Q.[gval])) AND (CLng(T.[A].[Apos]) = CLng(Q.[pos]))&quot;\n    strSQL1 = strSQL1 &amp; &quot; ORDER BY CLng(Q.[gval]), CDbl(Q.[Aggregate 1]) DESC, G.[lbl];&quot;\n    \n    'CREATE RECORDSET FROM SQL STRING\n    Set oRs = oCon.Execute(strSQL1)\n    \nExitSub:\n    oRs.Close\n    oCon.Close\n    Set oRs = Nothing\n    Set oCon = Nothing\n    \n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    \nExit Sub\nErrorHandler:\n    MsgBox &quot;Error No: &quot; &amp; Err.Number &amp; vbCrLf &amp; &quot;Description: &quot; &amp; Err.Description, vbCritical + vbOKOnly, &quot;An Error occurred!&quot;\n    Err.Clear\n    On Error GoTo 0\n    Resume ExitSub\n\nEnd Sub\n</code></pre>\n<p>After Splitting the Test3.csv table would like this:</p>\n<pre class=\"lang-none prettyprint-override\"><code>gval   pos    (blank)  Aggregate (blank) Aggregate  149_SG_Bryl_Cream   891_SG_Myo__Sky_Blue_Dress\n------------------------------------------------------------------------------\n0      1     0.422300          0.424658    0.458014          0.434639\n0      2     0.318628          0.345475    0.334548          0.333675\n0      3     0.274694          0.274643    0.243424          0.286865\n0      4     0.294568          0.346758    0.276552          0.366648\n1      1     0.565734          0.293436    0.283564          0.235366\n1      2     0.286657          0.755456    0.283233          0.310544\n2      1     0.234643          0.245459    0.245434          0.343423\n2      2     0.343645          0.455659    0.343282          0.334343\n2      3     0.234643          0.245459    0.245434          0.343423\n</code></pre>\n<p><strong>Final Table:</strong> (short example)</p>\n<pre class=\"lang-none prettyprint-override\"><code>lbl       txval                     gval    pos  Aggregate 1       Aggregate 2   SG_Bryl_Cream    SG_Myo__Sky_Blue_Dress\n-------------------------------------------------------------------------------------------------------------------\nInnovate  My life my rules.          0      1    0.422300          0.424658    0.458014          0.434639\nInnovate  earth wind rain and fire.  0      2    0.318628          0.345475    0.334548          0.333675\nBuys      my life my rules.          1      1    0.565734          0.293436    0.283564          0.235366\nBuys      earth wind rain and fire.  1      2    0.286657          0.755456    0.283233          0.310544\nSales     my life my rules.          2      1    0.234643          0.245459    0.245434          0.343423\nSales     earth wind rain and fire.  2      2    0.343645          0.455659    0.343282          0.334343\nSales     Some other text.           2      3    0.234643          0.245459    0.245434          0.343423\n...\n</code></pre>\n<p><strong>Questions</strong></p>\n<ol>\n<li>Is there a way to pickup both duplicate <code>Aggregate</code> columns via SQL?</li>\n<li>Is there a way to Select only <code>SG</code> columns from <code>Q</code> ie. <code>Test3.csv</code> via SQL?</li>\n</ol>\n<p><strong>e.g.</strong></p>\n  <pre class=\"lang-vb prettyprint-override\"><code>strSQL1 = &quot;SELECT  G.[lbl], A.[tval], Q.* &quot;\n</code></pre>\n<p>instead:</p>\n<pre><code>strSQL1 = &quot;SELECT  G.[lbl], A.[tval], Q.* LIKE 'SG' &quot;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1570644385, "post_id": 58309631, "comment_id": 102981230, "body": "<a href=\"https://stackoverflow.com/q/10714251\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1570644850, "post_id": 58309631, "comment_id": 102981478, "body": "If you have a backup copy of the file before you added the code, open that file and add the code again and see if it corrupts. If it does, add the code little by little to find the offending issue. All that said, I suspect it&#39;s not just adding the code that is the issue, but how the code runs. In that light, follow the same pattern."}, {"owner": {"reputation": 11, "user_id": 11633717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc27a15e8e22bd30771be3806222cefd?s=128&d=identicon&r=PG&f=1", "display_name": "usuario_estudo", "link": "https://stackoverflow.com/users/11633717/usuario-estudo"}, "edited": false, "score": 0, "creation_date": 1570650328, "post_id": 58309631, "comment_id": 102983818, "body": "I&#39;m noting that the problem is in this part of the code:    With Workbooks(&quot;TAB AUTO.xlsm&quot;).Sheets(&quot;input4&quot;).Range(&quot;B7:B100&quot;).Validation .Delete .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _ xlBetween, Formula1:=&quot;mar/2008,jun/2008,set/2008,dez/2008,mar/2009,jun/&zwnj;&#8203;2009,set/2009,dez/20&zwnj;&#8203;09,mar/2010,jun/2010&zwnj;&#8203;,set/2010,dez/2010,m&zwnj;&#8203;ar/2011,jun/2011,set&zwnj;&#8203;/2011,dez/2011,mar/2&zwnj;&#8203;012,jun/2012,set/201&zwnj;&#8203;2,dez/2012,mar/2013,&zwnj;&#8203;jun/2013,set/2013,de&zwnj;&#8203;z/2013"}], "owner": {"reputation": 11, "user_id": 11633717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc27a15e8e22bd30771be3806222cefd?s=128&d=identicon&r=PG&f=1", "display_name": "usuario_estudo", "link": "https://stackoverflow.com/users/11633717/usuario-estudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570643357, "creation_date": 1570643357, "question_id": 58309631, "link": "https://stackoverflow.com/questions/58309631/excel-corrupted-vba-macro-we-found-a-problem-with-some-content-in", "title": "Excel corrupted vba macro &quot;We found a problem with some content in &quot;", "body": "<p>My excel is being corrupted.\nWhen I open excel the following message appears:</p>\n\n<p>\"We found a problem with some content  in \"\". Do you want us to try to recover as much as we can? If you trust the source of this workbook, click Yes\"</p>\n\n<p>And when I click \"yes\" opens excel with the \"input4\" tab misconfigured</p>\n\n<p>I think it may be something related to the macros I added below. </p>\n\n<p>I can't figure out where the problem is, can someone help me please?</p>\n\n<pre><code>Sub gera_quadro_inp4()\n\nDim n As Integer\nDim u As Integer\nDim LastR As Integer\nDim Cart As String\n\nWith Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(\"B7:B100\").Validation\n.Delete\n.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\nxlBetween, Formula1:=\"mar/2008,jun/2008,set/2008,dez/2008,mar/2009,jun/2009,set/2009,dez/2009,mar/2010,jun/2010,set/2010,dez/2010,mar/2011,jun/2011,set/2011,dez/2011,mar/2012,jun/2012,set/2012,dez/2012,mar/2013,jun/2013,set/2013,dez/2013,mar/2014,jun/2014,set/2014,dez/2014,mar/2015,jun/2015,set/2015,dez/2015,mar/2016,jun/2016,set/2016,dez/2016,mar/2017,jun/2017,set/2017,dez/2017,mar/2018,jun/2018,set/2018,dez/2018,mar/2019,jun/2019,set/2019,dez/2019,mar/2020,jun/2020,set/2020,dez/2020,mar/2021,jun/2021,set/2021,dez/2021,mar/2022,jun/2022,set/2022,dez/2022,mar/2023,jun/2023,set/2023,dez/2023,mar/2024,jun/2024,set/2024,\" &amp; _\n\"dez/2024,mar/2025,jun/2025,set/2025,dez/2025,mar/2026,jun/2026,set/2026,dez/2026,mar/2027,jun/2027,set/2027,dez/2027,mar/2028,jun/2028,set/2028,dez/2028,mar/2029,jun/2029,set/2029,dez/2029,mar/2030,jun/2030,set/2030,dez/2030,mar/2031,jun/2031,set/2031,dez/2031,mar/2032,jun/2032,set/2032,dez/2032,mar/2033,jun/2033,set/2033,dez/2033,mar/2034,jun/2034,set/2034,dez/2034,mar/2035,jun/2035,set/2035,dez/2035,mar/2036,jun/2036,set/2036,dez/2036,mar/2037,jun/2037,set/2037,dez/2037,mar/2038,jun/2038,set/2038,dez/2038,mar/2039,jun/2039,set/2039,dez/2039,mar/2040,jun/2040,set/2040,dez/2040\"\nEnd With\n\nLastR = Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input1\").Range(\"C8\").End(xlDown).row\n\n'Armazena carteiras em Cart\nFor Each Value In Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input1\").Range(\"B8:B\" &amp; LastR)\nCart = Cart &amp; \",\" &amp; Value\nNext Value\n\n'Cria lista de op\u00e7\u00e3o de carteiras\nWith Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(\"C7:C100\").Validation\n.Delete\n.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\nxlBetween, Formula1:=Cart\nEnd With\n\n\n'Cria vari\u00e1veis do quadro\ncen = Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input3\").Range(\"F6\").Value\nWorkbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Cells(6, 2), Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Cells(6, 100)).Value = \"\"\n\nWorkbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(\"B6\").Value = \"PERIODO_TRI_AJUSTE\"\nWorkbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(\"C6\").Value = \"CARTEIRA\"\nWorkbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(\"D6\").Value = \"VALOR_ANCL_ANT\"\n\nFor u = 1 To cen\n    Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Cells(6, 4 + u).Value = \"OVERRIDE_TRI_C\" &amp; u\n    Workbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Cells(6, 4 + cen + u).Value = \"OVERRIDE_ANO_C\" &amp; u\nNext u\n\n\n\nWorkbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(\"B6\").Select\nRange(Selection, Selection.End(xlToRight)).Select\n\nWith Selection.Interior\n       .Pattern = xlSolid\n       .PatternColorIndex = xlAutomatic\n       .ThemeColor = xlThemeColorDark1\n       .TintAndShade = -0.149998474074526\n       .PatternTintAndShade = 0\n   End With\n   Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n   Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n   With Selection.Borders(xlEdgeLeft)\n       .LineStyle = xlContinuous\n       .ColorIndex = 0\n       .TintAndShade = 0\n       .Weight = xlThin\n   End With\n   With Selection.Borders(xlEdgeTop)\n       .LineStyle = xlContinuous\n       .ColorIndex = 0\n       .TintAndShade = 0\n       .Weight = xlThin\n   End With\n   With Selection.Borders(xlEdgeBottom)\n       .LineStyle = xlContinuous\n       .ColorIndex = 0\n       .TintAndShade = 0\n       .Weight = xlThin\n   End With\n   With Selection.Borders(xlEdgeRight)\n       .LineStyle = xlContinuous\n       .ColorIndex = 0\n       .TintAndShade = 0\n       .Weight = xlThin\n   End With\n   With Selection.Borders(xlInsideVertical)\n       .LineStyle = xlContinuous\n       .ColorIndex = 0\n       .TintAndShade = 0\n       .Weight = xlThin\n   End With\n   With Selection.Borders(xlInsideHorizontal)\n       .LineStyle = xlContinuous\n       .ColorIndex = 0\n       .TintAndShade = 0\n       .Weight = xlThin\n   End With\n   With Selection.Font\n       .Name = \"Calibri\"\n       .Size = 11\n       .Strikethrough = False\n       .Superscript = False\n       .Subscript = False\n       .OutlineFont = False\n       .Shadow = False\n       .Underline = xlUnderlineStyleNone\n       .ThemeColor = xlThemeColorLight1\n       .TintAndShade = 0\n       .ThemeFont = xlThemeFontMinor\n   End With\n   With Selection.Font\n       .Name = \"Calibri\"\n       .Size = 11\n       .Strikethrough = False\n       .Superscript = False\n       .Subscript = False\n       .OutlineFont = False\n       .Shadow = False\n       .Underline = xlUnderlineStyleNone\n       .ThemeColor = xlThemeColorLight1\n       .TintAndShade = 0\n       .ThemeFont = xlThemeFontMinor\n   End With\n   Selection.Font.Bold = True\n\nCells.Select\n\nCells.EntireColumn.AutoFit\nRange(\"A1\").Select\n</code></pre>\n\n<p>End Sub</p>\n\n<p>'Gera input4\nSub gera_input4()</p>\n\n<pre><code>Dim nework As Workbook\n\nWorkbooks(\"TAB AUTO.xlsm\").Sheets(\"input4\").Range(\"B6\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\nSet nework = Workbooks.Add\n\nnework.Sheets(1).Range(\"A1\").PasteSpecial xlPasteValues\n\nnework.Sheets(1).Range(\"A2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.NumberFormat = \"mmm-yy\"\n\nCells.Select\nCells.EntireColumn.AutoFit\nnework.Sheets(1).Range(\"A1\").Select\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "function", "outlook", "nested"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1570643454, "post_id": 58309604, "comment_id": 102980804, "body": "Do you ever use <code>CalculatedFolderName</code>? I don&#39;t see where the return is used."}, {"owner": {"reputation": 31, "user_id": 3561673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f1ca9a9754912a0f0160cd1f9dd93?s=128&d=identicon&r=PG&f=1", "display_name": "WinstonKyu", "link": "https://stackoverflow.com/users/3561673/winstonkyu"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1570644245, "post_id": 58309604, "comment_id": 102981157, "body": "I haven&#39;t.  I am planning to use that to create a folder if the function works."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1570644511, "post_id": 58309604, "comment_id": 102981302, "body": "Both domainname and foldername are to to <code>&quot;&quot;</code> at the start of your code; you then redefine domainname in an if-statement... did you step through and verify that the if-statement  criteria were met?"}, {"owner": {"reputation": 31, "user_id": 3561673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f1ca9a9754912a0f0160cd1f9dd93?s=128&d=identicon&r=PG&f=1", "display_name": "WinstonKyu", "link": "https://stackoverflow.com/users/3561673/winstonkyu"}, "edited": false, "score": 0, "creation_date": 1570644649, "post_id": 58309604, "comment_id": 102981383, "body": "yes.  Before I introduced the function, it executed perfectly fine."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1570644930, "post_id": 58309604, "comment_id": 102981525, "body": "So the issue is with domainname then and not the function return? Returning something you never use isn&#39;t going to break anything (assuming the function isn&#39;t failing). Do you have Calculatedfoldername in a watch window or a break point to see that it is empty?"}, {"owner": {"reputation": 31, "user_id": 3561673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f1ca9a9754912a0f0160cd1f9dd93?s=128&d=identicon&r=PG&f=1", "display_name": "WinstonKyu", "link": "https://stackoverflow.com/users/3561673/winstonkyu"}, "edited": false, "score": 0, "creation_date": 1570647039, "post_id": 58309604, "comment_id": 102982423, "body": "I found out that my if, ElseIf were formatted incorrectly. After &quot;Then&quot; statement, it is supposed to be next line."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 3561673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f1ca9a9754912a0f0160cd1f9dd93?s=128&d=identicon&r=PG&f=1", "display_name": "WinstonKyu", "link": "https://stackoverflow.com/users/3561673/winstonkyu"}, "is_accepted": true, "score": 0, "last_activity_date": 1570647393, "creation_date": 1570647393, "answer_id": 58310546, "question_id": 58309604, "link": "https://stackoverflow.com/questions/58309604/call-function-within-another-sub-in-vba-for-outlook/58310546#58310546", "title": "Call function within another sub in VBA for Outlook", "body": "<p>The fix was done by moving the next statement to the next line.</p>\n\n<pre><code>If (DomainName = \"abc\") Then \n     FolderName = \"A\"\nElseIf (DomainName = \"xyz\") Then \n     FolderName = \"B\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3561673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289f1ca9a9754912a0f0160cd1f9dd93?s=128&d=identicon&r=PG&f=1", "display_name": "WinstonKyu", "link": "https://stackoverflow.com/users/3561673/winstonkyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 58310546, "answer_count": 1, "score": 0, "last_activity_date": 1571964227, "creation_date": 1570643250, "last_edit_date": 1571964227, "question_id": 58309604, "link": "https://stackoverflow.com/questions/58309604/call-function-within-another-sub-in-vba-for-outlook", "title": "Call function within another sub in VBA for Outlook", "body": "<p>I have a VBA script for Outlook. I am writing to download the attachments and sort them into their own folders. I am trying to call a function to calculate the name of the folder that it should go into based on the domain name but when I introduced the function, the rule is not running. I was able to download the files into a single folder when function was not there.</p>\n\n<p>I have tried examples on changing function and also tried it as a Sub but unable to get them to work.</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nDim EmailAddress As String\nDim FullDomainName As String\nDim DomainName As String\nDim CalculatedFolderName As String\n\nEmailAddress = itm.SenderEmailAddress\nDomainName = \"\"\nCalculatedFolderName = \"\"\nIf (InStr(EmailAddress, \"@\") &gt; 0) Then\nFullDomainName = Right(EmailAddress, Len(EmailAddress) - InStr(EmailAddress, \"@\"))\nDomainName = Left(FullDomainName, InStr(FullDomainName, \".\") - 1)\nEnd If\n\nMsgBox DomainName\n\nCalculatedFolderName = FolderName(DomainName)\n\nsaveFolder = \"c:\\attachment\\test\\\"\n     For Each objAtt In itm.Attachments\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; DomainName &amp; \" \" &amp; objAtt.DisplayName\n          Set objAtt = Nothing\n     Next\n\nEnd Sub\n\nFunction FolderName(DomainName As String) As String\n    MsgBox DomainName\n    FolderName = \"\"\n    If (DomainName = \"abc\") Then FolderName = \"A\"\n    ElseIf (DomainName = \"xyz\") Then FolderName = \"B\"\n    Else\n        FolderName = DomainName\n    End If\n    Exit Function\nEnd Function\n</code></pre>\n\n<p>I was expecting a folder name to return when the function is called.</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570643021, "post_id": 58309275, "comment_id": 102980602, "body": "&quot;didn&#39;t seem to work&quot; is a rather vague description of what the problem is. If there is no event that fires given <i>exactly</i> the conditions you need, then you need to use an event that fires in the next-closest scenario, and then in that event handler you determine whether your conditions are met - if that means caching shapes&#39; layer and comparing to a modified shape&#39;s current layer, then you need to implement that. Does <code>ShapeChanged</code> fire when you move a shape from one layer to another?"}, {"owner": {"reputation": 17, "user_id": 6194659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lBE88.jpg?s=128&g=1", "display_name": "Runa", "link": "https://stackoverflow.com/users/6194659/runa"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570644172, "post_id": 58309275, "comment_id": 102981121, "body": "@MathieuGuindon I&#39;ve used ShapeChanged Private Sub but it didn&#39;t change the shape&#39;s format. The closest I can get is CellChanged, hoping that I can find the properties from the Shapesheet to directly call out the layers. (For example, If this shape&#39;s layer cell changes value, then fill color etc.) But it doesn&#39;t look like there&#39;s any property I can use from Shapesheet sadly."}], "owner": {"reputation": 17, "user_id": 6194659, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/lBE88.jpg?s=128&g=1", "display_name": "Runa", "link": "https://stackoverflow.com/users/6194659/runa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570641807, "creation_date": 1570641807, "question_id": 58309275, "link": "https://stackoverflow.com/questions/58309275/trigger-event-for-shapes-that-change-layer-on-visio-vba", "title": "Trigger Event for Shapes that change layer on Visio VBA", "body": "<p>I want to stylize the shapes the first time it goes in a different layer but only ONCE. (Example: The Shape will change color when it goes in the Visible layer for the first time) Is there any event I can use that triggers every time a Shape is moved from one layer to another? </p>\n\n<p>I've tried using CellChanged, ShapeChanged, and FormulaChanged with the target vsoShape but it didn't seem to work.\nAny help would be greatly appreciated.\nThanks!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1570642151, "post_id": 58308948, "comment_id": 102980216, "body": "Should be relatively easy if you can use a helper column. In column C, you could put <code>=IF(A2=&quot;&quot;,&quot;NL-&quot;&amp;COUNTIF($A$1:A2,&quot;&quot;),A2)</code> and drag down. That&#39;s the formula, now you just need to make the macro that adds to your range."}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570643240, "post_id": 58308948, "comment_id": 102980700, "body": "Thanks @BruceWayne it worked perfectly!"}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570643392, "post_id": 58308948, "comment_id": 102980778, "body": "Sorry @JvdV I tried using a IF function and updated the solution. I am just learning excel macros and also new to this forum and hence the incomplete question! Thanks for pointing that out, I will remember to put my code next time."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570643435, "post_id": 58308948, "comment_id": 102980796, "body": "That&#39;s fine, I guess you are not using any code at all then? Just worksheet formulas?"}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570643493, "post_id": 58308948, "comment_id": 102980827, "body": "@BruceWayne I cannot find a way to give your comment an upvote, please let me know if there is something I can do to rate your answer. Thanks."}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570643779, "post_id": 58308948, "comment_id": 102980946, "body": "@JvdV I want to build a button to do this, I was just trying to figure out the logic of how I can do this. I don&#39;t know if my approach is correct. I am just trying to watch some videos on youtube and figure this out."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "edited": false, "score": 0, "creation_date": 1570643867, "post_id": 58309610, "comment_id": 102980981, "body": "Thanks for the solution ! This is perfect, my next step is to build the logic behind a button!"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "edited": false, "score": 0, "creation_date": 1570643989, "post_id": 58309610, "comment_id": 102981038, "body": "@RupeshGhosh, building this in VBA requires different steps to follow and would not really look like this at all. One thing it will have in common are A) a <code>Range</code> object and B) a iteration through empty cells."}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "edited": false, "score": 0, "creation_date": 1570644239, "post_id": 58309610, "comment_id": 102981152, "body": "Oh I see, I will try to figure it out. Also, if you could direct me to some materials where I can learn VBA coding, especially to a similar thing like this, then that would be great.Thank you."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "edited": false, "score": 0, "creation_date": 1570644898, "post_id": 58309610, "comment_id": 102981512, "body": "@RupeshGhosh, I couldn&#39;t help myself but to quickly piece the edited answer together. Try to understand the logic in the macro instead of simply implementing it. Btw, the <code>CodeName</code> of your sheet is not the same as the name of the sheet. You&#39;ll find it in the VBE Project Explorer (google will guide you)."}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "edited": false, "score": 0, "creation_date": 1570644961, "post_id": 58309610, "comment_id": 102981534, "body": "Thank you, I will look into it! Appreciate your help."}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "edited": false, "score": 0, "creation_date": 1570645104, "post_id": 58309610, "comment_id": 102981599, "body": "Thank you for the code, I will surely understand the macro first. I want to learn this as it is a necessary skill, truly appreciate your help."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1570644807, "last_edit_date": 1570644807, "creation_date": 1570643293, "answer_id": 58309610, "question_id": 58308948, "link": "https://stackoverflow.com/questions/58308948/if-a-field-is-blank-in-excel-then-generate-nl-1-nl-2-nl-n-automaticall/58309610#58309610", "title": "If a field is blank in Excel then generate &#39;NL-1, NL-2........Nl-n&#39; automatically on a button click", "body": "<p>There are obviously several ways to tackle this, let me show you one:</p>\n\n<hr>\n\n<p><strong><em>Without VBA or helper column</em></strong></p>\n\n<ul>\n<li>Select your column A range <code>A2:A14</code></li>\n<li>Press <kbd>F5</kbd> > <code>Special</code> > <code>Empty Values</code> > <code>OK</code></li>\n<li>Press <kbd>F2</kbd> or place your cursor in the Formula Bar</li>\n<li>Enter the following formula: <code>=\"NL-\"&amp;COUNTIF($A$1:INDEX(A:A,ROW()-1),\"NL-*\")+1</code></li>\n<li>Press <kbd>Ctrl</kbd>+<kbd>Enter</kbd></li>\n</ul>\n\n<hr>\n\n<p><strong><em>With VBA</em></strong></p>\n\n<p>Assign the following to your button:</p>\n\n<pre><code>Sub Test()\n\nDim lr As Long, x As Long\nDim rng1 As Range, rng2 As Range, cl As Range\n\nWith Sheet1 'Change this into the CodeName of the sheet you refering too\n    lr = .Cells(.Rows.Count, 2).End(xlUp).Row\n    Set rng1 = .Range(\"A1:A\" &amp; lr)\n    If Application.WorksheetFunction.CountBlank(rng1) &gt; 0 Then\n        Set rng2 = Intersect(rng1, rng1.SpecialCells(xlCellTypeBlanks))\n        x = 1\n        For Each cl In rng2\n            cl.Value = \"NL-\" &amp; x\n            x = x + 1\n        Next cl\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 58309610, "answer_count": 1, "score": -3, "last_activity_date": 1570686520, "creation_date": 1570640293, "last_edit_date": 1570686520, "question_id": 58308948, "link": "https://stackoverflow.com/questions/58308948/if-a-field-is-blank-in-excel-then-generate-nl-1-nl-2-nl-n-automaticall", "title": "If a field is blank in Excel then generate &#39;NL-1, NL-2........Nl-n&#39; automatically on a button click", "body": "<p>I am trying to build a button in excel such that on clicking it, it generates 'NL-1, NL-2, ..... NL-n' until the end of the row in Excel.</p>\n\n<p>For example </p>\n\n<pre><code>Sample No    Value       \n123           1\n245           2\n              3\n345           4\n678           5\n345           6\n              7\n              8\n347           9\n678          10\n343          11\n             12\n098          13\n</code></pre>\n\n<p>On clicking the button </p>\n\n<pre><code>Sample No    Value       \n123           1\n245           2\nNL-1          3\n345           4\n678           5\n345           6\nNL-2          7\nNL-3          8\n347           9\n678          10\n343          11\nNL-4         12\n098          13\n</code></pre>\n\n<p>I was able to built a logic using a third reference column and an IF statement \ni.e. IF(A$2=\"\",C$2) where C was \"NL-1......NL-99\"  and it gave me a solution like this</p>\n\n<pre><code>Sample No    Value     NL(Hidden)  \n123           1          NL-1\n245           2          NL-2\nNL-3          3          NL-3\n345           4          NL-4\n678           5          NL-5\n345           6          NL-6\nNL-7          7          NL-7\nNL-8          8          NL-8\n\n</code></pre>\n\n<p>But I would like to have it as the second table as shown!\nAny help would be really appreciated.\nThanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1570640686, "post_id": 58308931, "comment_id": 102979527, "body": "Why can&#39;t you reference your cells with <code>myCell</code>? you can <code>myCell.Address</code> and there you get the address"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1570640717, "post_id": 58308931, "comment_id": 102979546, "body": "Looks like you have to refer to <code>Areas</code> rather than <code>Cells</code>, if your selections consist of single-cell non-contiguous areas. But basing things on selected cells is not advisable."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1570640836, "post_id": 58308931, "comment_id": 102979603, "body": "Side note: <code>Dim usr1, usr2 As String</code> should be <code>Dim usr1 as String, usr2 As String</code> otherwise <code>usr1</code> will not be a string"}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570641692, "post_id": 58308931, "comment_id": 102979993, "body": "Did you try the Cell() Object ? Or to ask the Celll object ? With the Cell Object you can act on  the sheets and tables like on a array."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570641913, "post_id": 58308931, "comment_id": 102980106, "body": "@ThomasLudewig there is no <code>Cell</code> object in the Excel object model."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1570642581, "post_id": 58308931, "comment_id": 102980419, "body": "Either try: <code>xxx = Selection.Areas(1).Value</code> or <code>xxx = Range(Split(Selection.Address, &quot;,&quot;)(0)).Value</code>. But as @SJR said. Coding based on selections is non-advisable."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570644762, "post_id": 58308931, "comment_id": 102981436, "body": "One thing I don&#39;t understand is that <code>Selection.count</code> returns 2 which seems inconsistent. Any idea why @MathieuGuindon / @JvdV?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1570645303, "post_id": 58308931, "comment_id": 102981680, "body": "@SJR it&#39;s because of the disjointed selection areas. Everything works as expected if you use <code>Areas</code>; remember that <code>Cells</code> takes no parameters, it just returns a <code>Range</code>, and the arguments go against <code>Range.[_Default]</code>. So if you select <code>C16:C18</code> you can still get a cell out of <code>Selection.Cells(1, 2)</code>, even if that cell isn&#39;t in the selection."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570645764, "post_id": 58308931, "comment_id": 102981901, "body": "@MathieuGuindon - I just thought that if it recognised that Selection held 2 cells (and not 1) it would be able to retrieve their values (in layman&#39;s terms). I&#39;d have understood if the &quot;disjointed selection areas&quot; meant it would detect both cells."}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570645999, "post_id": 58308931, "comment_id": 102982008, "body": "Ok we do not have Sheet and Cell objects in excel.. You are a Excel hero i gues.. I just wonder why things like this work all the time. <a href=\"https://stackoverflow.com/questions/57730093/how-do-i-copy-a-worksheet-from-one-workbook-to-another/57732535#57732535\" title=\"how do i copy a worksheet from one workbook to another\">stackoverflow.com/questions/57730093/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570647009, "post_id": 58308931, "comment_id": 102982413, "body": "@ThomasLudewig <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">Implicit ActiveSheet references</a> flags them.. it works because the object model is abusing global objects, they really are member calls, going against a hidden <code>[_Global]</code> object."}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570651256, "post_id": 58308931, "comment_id": 102984176, "body": "Mathieu we can slice hairs about that.If he get it working with this kind of reference who cares.  :)"}, {"owner": {"reputation": 11, "user_id": 12190004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdurtMTvSwqH_7wt4AUbd0SSCVKgtNZp7F_UG-g=k-s128", "display_name": "Pablo Ortiz", "link": "https://stackoverflow.com/users/12190004/pablo-ortiz"}, "edited": false, "score": 0, "creation_date": 1570659134, "post_id": 58308931, "comment_id": 102986840, "body": "Thank you All for your comprehensive and very valuable input!! Regarding the not advisable to base things on selected cells issue, other than the likelihood of non-desired cells being selected when the code is called, which requires additional logic to prevent, for which other reasons isn&#39;t it advisable?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1570660397, "post_id": 58308931, "comment_id": 102987132, "body": "As if that wasn&#39;t reason enough?  An errant mouse click  or key press could make your program do who knows what! That is an unacceptable risk.  Speed also plays a big factor,  you can work with many ranges but only  one selection, and more.  I can see it now... You&#39;re so happy you have this thing working it will save you so much time and then you think you&#39;ll take advantage of the opportunity and multitask while it&#39;s running.  You open a second workbook and.... Oops.  Now your macro is changing the wrong workbook.  Hope it doesnt save it because undo wont work"}], "owner": {"reputation": 11, "user_id": 12190004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfdurtMTvSwqH_7wt4AUbd0SSCVKgtNZp7F_UG-g=k-s128", "display_name": "Pablo Ortiz", "link": "https://stackoverflow.com/users/12190004/pablo-ortiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1584459235, "creation_date": 1570640218, "last_edit_date": 1584459235, "question_id": 58308931, "link": "https://stackoverflow.com/questions/58308931/how-can-i-reference-selected-cells", "title": "How can I reference selected cells?", "body": "<p>I'm trying to obtain the text/value of two selected cells (not necessarily adjacent) in an Excel sheet.</p>\n\n<p>How can I reference the cells in the selection via some sort of \"indexing\"?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>xxx = selection.cells(1).value\nyyyy = selection.cells(2).value\n</code></pre>\n\n<p>doesn't do it, since the second refers to the cell exactly below that is referenced by the first.</p>\n\n<p>I have this code to iterate the selected cells, but I don't like it, as I cannot reference the cells by address or index. usr1 and usr2 are to have the names of the two \"users\" selected in the sheet.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim usr1, usr2 As String\nDim usrs(1) As String\nDim myCell As Range\nDim uIndex As Integer\n\nWorksheets(\"Tests\").Activate\nuIndex = 0\nFor Each myCell In Selection\n    usrs(uIndex) = myCell.Value\n    uIndex = uIndex + 1\nNext\n\nusr1 = usrs(0)\nusr2 = usrs(1)\n</code></pre>\n\n<p>How can I reference the different selected cells directly?</p>\n"}, {"tags": ["excel", "vba", "list"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1570640224, "post_id": 58308905, "comment_id": 102979321, "body": "What does your data look like?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1570640371, "post_id": 58308905, "comment_id": 102979383, "body": "No oxford comma, eh?"}, {"owner": {"reputation": 3, "user_id": 12190150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcfb71f3bfe5934af6cb510c4647894b?s=128&d=identicon&r=PG&f=1", "display_name": "garth123", "link": "https://stackoverflow.com/users/12190150/garth123"}, "edited": false, "score": 0, "creation_date": 1570640425, "post_id": 58308905, "comment_id": 102979403, "body": "My list can have up to 9 different items and are selected for by a user form. I need them to produce a text in a cell that uses &#39;,&#39; and &#39;and&#39; appropriately."}, {"owner": {"reputation": 3, "user_id": 12190150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcfb71f3bfe5934af6cb510c4647894b?s=128&d=identicon&r=PG&f=1", "display_name": "garth123", "link": "https://stackoverflow.com/users/12190150/garth123"}, "edited": false, "score": 0, "creation_date": 1570640592, "post_id": 58308905, "comment_id": 102979477, "body": "Bruce, if you could show me an alternative that uses the Oxford comma I would happily upgrade my sloppy grammar. To give some context to my problem I am trying to use VBA to automate the writing of a legal document and the title is dependant on components are selected."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570640651, "post_id": 58308905, "comment_id": 102979510, "body": "How will the list be in Excel? Will a cell have a single word (like in my Formula answer below), or would a cell literally have <code>Apples + Bananas</code> or <code>Apples + Bananas + Bononos</code>?"}, {"owner": {"reputation": 3, "user_id": 12190150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcfb71f3bfe5934af6cb510c4647894b?s=128&d=identicon&r=PG&f=1", "display_name": "garth123", "link": "https://stackoverflow.com/users/12190150/garth123"}, "edited": false, "score": 0, "creation_date": 1570641036, "post_id": 58308905, "comment_id": 102979678, "body": "[1]: <a href=\"https://i.stack.imgur.com/Z1nkN.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/Z1nkN.png</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12190150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcfb71f3bfe5934af6cb510c4647894b?s=128&d=identicon&r=PG&f=1", "display_name": "garth123", "link": "https://stackoverflow.com/users/12190150/garth123"}, "edited": false, "score": 0, "creation_date": 1570640922, "post_id": 58309034, "comment_id": 102979637, "body": "Added a link of what the data looks like. Thank you for the Excel formula, interesting way to approach it."}, {"owner": {"reputation": 3, "user_id": 12190150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcfb71f3bfe5934af6cb510c4647894b?s=128&d=identicon&r=PG&f=1", "display_name": "garth123", "link": "https://stackoverflow.com/users/12190150/garth123"}, "edited": false, "score": 0, "creation_date": 1570642404, "post_id": 58309034, "comment_id": 102980336, "body": "Thank you very much Bruce!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1570641145, "last_edit_date": 1570641145, "creation_date": 1570640597, "answer_id": 58309034, "question_id": 58308905, "link": "https://stackoverflow.com/questions/58308905/using-vba-excel-to-create-a-gramatically-correct-list/58309034#58309034", "title": "Using VBA Excel to create a gramatically correct list", "body": "<p>If you're okay with a formula (I know you're asking for VBA...), you can use this one:</p>\n\n<pre><code>=IF(COUNTA(A1:D1)=2,A1&amp;\" and \"&amp;B1,TEXTJOIN($A$5:$B$5,TRUE,A1:D1))\n</code></pre>\n\n<p>In <code>A5</code>, put just a comma and a space. In <code>B5</code>, put <code>, and</code> (note there's a space after <code>and</code>).</p>\n\n<p><a href=\"https://i.stack.imgur.com/PnZfi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PnZfi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Edit: I'll work on a VBA answer..but keep this, since I learned you can have multiple delimiters within a single <code>TEXTJOIN()</code>, which I didn't know!</p>\n\n<p>Edit2: After seeing your data, you can still use a formula.  Again, put the <code>,</code> and <code>, and</code> somewhere (I used <code>A8:B8</code> here):</p>\n\n<p>Enter this as an array formula: </p>\n\n<pre><code>=TEXTJOIN($A$8:$B$8,TRUE,IF(B1:B4=\"YES\",A1:A4,\"\"))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/a3hWL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a3hWL.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And VBA (cheating a little, since I'm just using that formula, but it works):</p>\n\n<pre><code>Sub t()\nDim output As String\noutput = Evaluate(\"=TEXTJOIN($A$8:$B$8,TRUE,IF(B1:B4=\"\"YES\"\",A1:A4,\"\"\"\"))\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12190150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcfb71f3bfe5934af6cb510c4647894b?s=128&d=identicon&r=PG&f=1", "display_name": "garth123", "link": "https://stackoverflow.com/users/12190150/garth123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 58309034, "answer_count": 1, "score": -2, "last_activity_date": 1570714213, "creation_date": 1570640135, "last_edit_date": 1570714213, "question_id": 58308905, "link": "https://stackoverflow.com/questions/58308905/using-vba-excel-to-create-a-gramatically-correct-list", "title": "Using VBA Excel to create a gramatically correct list", "body": "<p>I need to find a way to write a list using ',' and 'and' in the correct manner based on a varying number of items in a list. See demo below:</p>\n\n<pre><code>Apples + Oranges + Bananas = Apples, Oranges and Bananas\nApples + Oranges + Pineapples + Bananas = Apples, Oranges, Pineapples and Bananas\nApples + Oranges = Apples and Oranges\n</code></pre>\n\n<p>My first guess would be to create a list or array of values then use some kind of 'n-1' or 'last' function to place the word 'AND' between the last two items and place the symbol ',' between all other items. </p>\n\n<p>Unfortunately I am still fairly new to VBA so haven't been able to make much headway, any guidance or code greatly appreciated.</p>\n\n<p>Best wishes,</p>\n\n<p>Garth\n<a href=\"https://i.stack.imgur.com/Z1nkN.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 637, "user_id": 464219, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7fe621f719719124990e01f6c7e7679d?s=128&d=identicon&r=PG", "display_name": "Hamedz", "link": "https://stackoverflow.com/users/464219/hamedz"}, "edited": false, "score": 0, "creation_date": 1570640765, "post_id": 58308723, "comment_id": 102979572, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21267283/error-running-shell-object-commands-through-excel-vba\" title=\"error running shell object commands through excel vba\">stackoverflow.com/questions/21267283/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10206942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBwaREIBBqs/AAAAAAAAAAI/AAAAAAAAAMQ/Yu9am1ElBoQ/photo.jpg?sz=128", "display_name": "Jitender Singh Soam", "link": "https://stackoverflow.com/users/10206942/jitender-singh-soam"}, "edited": false, "score": 0, "creation_date": 1570682535, "post_id": 58308943, "comment_id": 102991485, "body": "Thank you very much buddy the Chr$ one worked. However, the second one require a little bit of Tweaking.  sApp = &quot;&quot;&quot;&quot; &amp; ThisWorkbook.Path &amp; &quot;\\protected\\WSInvoke.bat&quot;&quot; &quot;&quot;&quot; &amp; ThisWorkbook.Path &amp; &quot;\\protected\\Refresh.txt&quot;&quot; &quot;&quot;&quot; &amp; ThisWorkbook.Path &amp; &quot;&quot;&quot;&quot;"}, {"owner": {"reputation": 16, "user_id": 10759953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZLnON.png?s=128&g=1", "display_name": "Jason Cote", "link": "https://stackoverflow.com/users/10759953/jason-cote"}, "reply_to_user": {"reputation": 3, "user_id": 10206942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBwaREIBBqs/AAAAAAAAAAI/AAAAAAAAAMQ/Yu9am1ElBoQ/photo.jpg?sz=128", "display_name": "Jitender Singh Soam", "link": "https://stackoverflow.com/users/10206942/jitender-singh-soam"}, "edited": false, "score": 0, "creation_date": 1570794908, "post_id": 58308943, "comment_id": 103036663, "body": "Oops you&#39;re right, I missed quotes there, thanks for catching it. I updated my answer with the corrected text."}], "tags": [], "owner": {"reputation": 16, "user_id": 10759953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZLnON.png?s=128&g=1", "display_name": "Jason Cote", "link": "https://stackoverflow.com/users/10759953/jason-cote"}, "is_accepted": true, "score": 0, "last_activity_date": 1570794837, "last_edit_date": 1570794837, "creation_date": 1570640274, "answer_id": 58308943, "question_id": 58308723, "link": "https://stackoverflow.com/questions/58308723/getting-run-time-error-2147024894-80070002-when-my-code-file-is-palced-in-a/58308943#58308943", "title": "Getting Run-time error &#39;-2147024894 (80070002)&#39; when my code file is palced in a folder with space in it&#39;s name", "body": "<p>You need quotes around the paths to be able to handle spaces. Try either of these:</p>\n\n<p>sApp = Chr$(34) &amp; ThisWorkbook.Path &amp; \"\\protected\\WSInvoke.bat\" &amp; Chr$(34) &amp; \" \" &amp; Chr$(34) &amp; ThisWorkbook.Path &amp; \"\\protected\\Refresh.txt\"  &amp; Chr$(34) &amp; \" \"  &amp; Chr$(34) &amp; ThisWorkbook.Path &amp; Chr$(34)</p>\n\n<p>or if Chr() doesn't work:</p>\n\n<p>sApp = \"\"\"\" &amp; ThisWorkbook.Path &amp; \"\\protected\\WSInvoke.bat\"\" \"\"\" &amp; ThisWorkbook.Path &amp; \"\\protected\\Refresh.txt\"\" \"\"\" &amp; ThisWorkbook.Path &amp; \"\"\"\"</p>\n"}], "owner": {"reputation": 3, "user_id": 10206942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UBwaREIBBqs/AAAAAAAAAAI/AAAAAAAAAMQ/Yu9am1ElBoQ/photo.jpg?sz=128", "display_name": "Jitender Singh Soam", "link": "https://stackoverflow.com/users/10206942/jitender-singh-soam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1205, "favorite_count": 0, "accepted_answer_id": 58308943, "answer_count": 1, "score": -1, "last_activity_date": 1570794837, "creation_date": 1570639342, "last_edit_date": 1570652204, "question_id": 58308723, "link": "https://stackoverflow.com/questions/58308723/getting-run-time-error-2147024894-80070002-when-my-code-file-is-palced-in-a", "title": "Getting Run-time error &#39;-2147024894 (80070002)&#39; when my code file is palced in a folder with space in it&#39;s name", "body": "<p>When I am placing the code Excel file in a folder/directory which does not have any space in it the naming conventions than it is working fine and firing the Web-Service. But when I place the code Excel file in a folder which has space in it's naming convention, I am getting a run-time error:</p>\n\n<blockquote>\n  <p>'-2147024894 (80070002).</p>\n</blockquote>\n\n<p>Please help</p>\n\n<pre><code>Sub InvokShellScript1()\n\nDim sApp As String\nDim var As Integer\n\nsApp = ThisWorkbook.Path &amp; \"\\protected\\WSInvoke.bat   \" &amp; ThisWorkbook.Path &amp; \"\\protected\\Refresh.txt  \" &amp; ThisWorkbook.Path\n\nDim objShell As Object\n\n   Set objShell = CreateObject(\"WScript.Shell\")\n   var = objShell.Run(sApp, 0, True)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1570638359, "post_id": 58308368, "comment_id": 102978525, "body": "You need <code>Set</code> for Object variables, i.e. <code>EndRange</code>."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1570638382, "post_id": 58308368, "comment_id": 102978537, "body": "<code>xlToRight</code> would be correct syntax"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1570638649, "post_id": 58308368, "comment_id": 102978655, "body": "What are the <code>.select</code> statements even being used for?  there is no reference to <code>.selection</code>, and each <code>set endrange</code> refinds those points.  Seems like those could be removed completely and this would still work.  And <code>endrange</code> is just finding the last column then offsetting two rows down; is this the goal?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1570686941, "post_id": 58308368, "comment_id": 102992612, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1570638273, "creation_date": 1570638273, "answer_id": 58308449, "question_id": 58308368, "link": "https://stackoverflow.com/questions/58308368/how-to-put-all-values-in-the-first-row-into-an-array/58308449#58308449", "title": "How to put all values in the first row into an array?", "body": "<p>If you replace <code>xlRight</code> with <code>xlToRight</code> you should be good</p>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1570640350, "last_edit_date": 1570640350, "creation_date": 1570639061, "answer_id": 58308654, "question_id": 58308368, "link": "https://stackoverflow.com/questions/58308368/how-to-put-all-values-in-the-first-row-into-an-array/58308654#58308654", "title": "How to put all values in the first row into an array?", "body": "<p>I believe you're looking for something more like:</p>\n\n<pre><code>Sub Ls_List_Click()\n'variables used in for each loops\nDim Column_Array() As Variant\n\nColumn_Array() = Range(Cells(1,1),Cells(1, Cells(1, 1).End(xlToRight).Column)).value\n\n'... couple of for each loops\n\nEnd Sub\n</code></pre>\n\n<p>There didn't appear to be rhyme or reason for the <code>.select</code> components beyond stepping through to see where things were (nice for testing... i guess?).</p>\n\n<p>Just one line of code gets your array generated for all the contiguous headers in your first row.</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Checking back, because <code>EndRange</code> is used for looping, you may want to write:</p>\n\n<pre><code>Sub Ls_List_Click()\n'variables used in for each loops\nDim Column_Array() As Variant, EndRange as Long 'reference to column number, not a range, so watch referencing\n\nEndRange = Cells(1, 1).End(xlToRight).Column\nColumn_Array() = Range(Cells(1,1),Cells(1, EndRange)).value\n\n'... couple of for each loops\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1570685064, "creation_date": 1570685064, "answer_id": 58315937, "question_id": 58308368, "link": "https://stackoverflow.com/questions/58308368/how-to-put-all-values-in-the-first-row-into-an-array/58315937#58315937", "title": "How to put all values in the first row into an array?", "body": "<p>Two main issues with your code:</p>\n\n<ol>\n<li><p>You misspelled <code>xlRight</code> - the correct value is <code>xlToRight</code>. That's why it is recommended to use <code>Option Explicit</code>, so such errors are detected at compile time.</p></li>\n<li><p>You shouldn't use <code>Select</code> - what for? If you want to reference particular cells/range, just use <code>Cells(row, column)</code> (<code>row</code> and <code>column</code> are integers) or <code>Range(\"A1:B3\")</code> (just example).</p></li>\n</ol>\n\n<p>Having said that, to get values into an array, you should use:</p>\n\n<pre><code>firstRowArray = Range(Cells(1, 1), Cells(1, 1).End(xlToRight)).Value2\n</code></pre>\n\n<p>Expalnation:</p>\n\n<p>I used <code>Range</code> overload, accepting two cells as top-left and bottom-right cells to define the range. Top left is <code>Cell(1, 1)</code>, i.e. <code>A1</code> and bottom left is <code>Cells(1, 1).End(xlToRight)</code>, which you are already familiar with :)</p>\n\n<p>Then I use <code>Value2</code> property, which return array of values (you could use <code>Value</code> but it's slower).</p>\n\n<p>Note that, the result will be <strong>two-diensional</strong> array with number of rows and number of columns same as in the range.</p>\n"}], "owner": {"reputation": 42, "user_id": 12121394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4500abfc8a3a455f2cae868a37f16047?s=128&d=identicon&r=PG&f=1", "display_name": "Marat_Muginov", "link": "https://stackoverflow.com/users/12121394/marat-muginov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1570686916, "creation_date": 1570637998, "last_edit_date": 1570686916, "question_id": 58308368, "link": "https://stackoverflow.com/questions/58308368/how-to-put-all-values-in-the-first-row-into-an-array", "title": "How to put all values in the first row into an array?", "body": "<p>I am trying to set my array equal to all column headers of tables in a worksheet. </p>\n\n<p>If I were doing this in Excel, I would click on <code>A1</code> and do Control+Shift+Right Arrow. I've found some 15 year old code attempting to simulate this, shown below, but it doesn't recognize the last Column.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Ls_List_Click()\n'variables used in for each loops\nDim Column_Array() As Variant\nDim EndRange As Range\n\nThisWorkbook.Worksheets(Me.Ls_List.Value).Select\n\nRange(\"A1\", Range(\"A1\").End(xlRight)).Select\n\nEndRange = Range(\"A1\").End(xlRight).Offset(2, 0)\n\nRange(EndRange, EndRange.End(xlRight)).Select\nEndRange = EndRange.End(xlRight).Offset(2, 0)\n\nColumn_Array() = EndRange\n\n'... couple of for each loops\n\nEnd Sub\n</code></pre>\n\n<p>I get error 1004 on the following line:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Range(\"A1\", Range(\"A1\").End(xlRight)).Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1570637849, "post_id": 58308148, "comment_id": 102978299, "body": "In what module did you put this code?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1570638184, "post_id": 58308148, "comment_id": 102978436, "body": "Add the workbook open event to your PERSONAL workbook as it opens when you start Excel up. No need for the <code>WithEvents</code> part."}, {"owner": {"reputation": 11, "user_id": 12189879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f52ffe66ddd27f6d64fe1ce4482566?s=128&d=identicon&r=PG&f=1", "display_name": "chodge", "link": "https://stackoverflow.com/users/12189879/chodge"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1570650367, "post_id": 58308148, "comment_id": 102983834, "body": "@Sam The code was origianally in a class module within my personal workbook."}, {"owner": {"reputation": 11, "user_id": 12189879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f52ffe66ddd27f6d64fe1ce4482566?s=128&d=identicon&r=PG&f=1", "display_name": "chodge", "link": "https://stackoverflow.com/users/12189879/chodge"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1570650627, "post_id": 58308148, "comment_id": 102983926, "body": "@DarrenBartrup-Cook That is the way I tried it at first, I figured that it was not firing because PERSONAL was not firing the event."}], "owner": {"reputation": 11, "user_id": 12189879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f52ffe66ddd27f6d64fe1ce4482566?s=128&d=identicon&r=PG&f=1", "display_name": "chodge", "link": "https://stackoverflow.com/users/12189879/chodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570637129, "creation_date": 1570637129, "question_id": 58308148, "link": "https://stackoverflow.com/questions/58308148/add-list-of-macros-from-personal-xlsb-to-right-click-shortcut-menu-on-applicatio", "title": "Add List of Macros from PERSONAL.XLSB to Right Click Shortcut Menu on application startup", "body": "<p>I am trying to add a sub menu to the right click shortcut menu that contains a list of commonly used macros. I want this to happen when any workbook is opened.</p>\n\n<p>I have tried using the application.WorkbookOpen event (which I believe fires when ANY workbook opens?). </p>\n\n<pre><code>Private WithEvents app As Application\nPrivate Sub app_WorkbookOpen(ByVal Wb As Workbook)\nDim Menu As Object\nSet Menu = Application.ShortcutMenus(xlWorksheetCell).MenuItems.AddMenu(\"Macors\", 1)\n\n\nWith Menu.MenuItems\n    .Add \"MacroName\", \"MacroName\", , 1, , \"\"\n\nEnd With\n\n Set MyMenu = Nothing\nEnd Sub\n\nPrivate Sub Workbook_Open()\n  Set app = Application\nEnd Sub\n</code></pre>\n\n<p>However, it doesn't seem to fire on start up. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1570636185, "post_id": 58307865, "comment_id": 102977467, "body": "you are using different arguments in your special cells"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1570636201, "post_id": 58307865, "comment_id": 102977475, "body": "Are both of these variables declared as <code>Range</code>?"}, {"owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "edited": false, "score": 0, "creation_date": 1570636455, "post_id": 58307865, "comment_id": 102977625, "body": "Both are declared as ranges, xlCellType corrected"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570636511, "post_id": 58307865, "comment_id": 102977650, "body": "I have done this before so i&#39;m wondering if any cells in your range actually meet the criteria? i.e. when you set <code>aRange</code>, have you verified it has any cells that meet criteria <code>xlCellTypeConstants</code>?"}, {"owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "edited": false, "score": 0, "creation_date": 1570636541, "post_id": 58307865, "comment_id": 102977666, "body": "They do, I have checked that. I can use the work around in the second code snippet, but am wondering why this happens."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1570636594, "post_id": 58307865, "comment_id": 102977693, "body": "I would qualify your range with a worksheet. If your range location is defined correct and has constants then unqualified ranges would be the likely issue"}, {"owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "edited": false, "score": 0, "creation_date": 1570636862, "post_id": 58307865, "comment_id": 102977815, "body": "Yes, that worked: Set aRange = ActiveSheet.Range(Cells(2, 5), Cells(botRow, 5))"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1570637333, "post_id": 58307865, "comment_id": 102978035, "body": "<code>ActiveSheet</code> on its own won&#39;t rectify the problem."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1570636693, "creation_date": 1570636693, "answer_id": 58308038, "question_id": 58307865, "link": "https://stackoverflow.com/questions/58307865/using-a-defined-range-with-specialcells/58308038#58308038", "title": "Using A Defined Range With SpecialCells", "body": "<p>Try to qualify your objects (<em><code>Ranges &amp; Cells</code></em>) with a worksheet:</p>\n\n<pre><code>Dim ws as Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- Update\n\nDim aRange as Range, tRange as Range\n\nSet aRange = ws.Range(ws.Cells(2, 5), ws.Cells(botRow, 5))\nSet tRange = aRange.SpecialCells(xlCellTypeConstants)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1570637623, "creation_date": 1570637623, "answer_id": 58308276, "question_id": 58307865, "link": "https://stackoverflow.com/questions/58307865/using-a-defined-range-with-specialcells/58308276#58308276", "title": "Using A Defined Range With SpecialCells", "body": "<p>When you are using <code>SpecialCells</code> with <code>xlCellTypeConstants</code>, add the second parameter too. This is a combination of the checkboxes you find in the Go To Special dialog. If you want all, do like this:</p>\n\n<pre><code>aRange.SpecialCells(xlCellTypeConstants, xlErrors + xlLogical + xlNumbers + xlTextValues)\n</code></pre>\n\n<p>This will work with both your versions.</p>\n"}], "owner": {"reputation": 181, "user_id": 5730226, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7rBre.png?s=128&g=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5730226/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 1, "accepted_answer_id": 58308038, "answer_count": 2, "score": 0, "last_activity_date": 1570639244, "creation_date": 1570636101, "last_edit_date": 1570639244, "question_id": 58307865, "link": "https://stackoverflow.com/questions/58307865/using-a-defined-range-with-specialcells", "title": "Using A Defined Range With SpecialCells", "body": "<p>I am trying to find nonempty cells in a defined range variable using <code>.SpecialCells</code>, if I use:</p>\n\n<pre><code>    Set aRange = Range(Cells(2, 5), Cells(botRow, 5))\n    Set tRange = aRange.SpecialCells(xlCellTypeConstants)\n</code></pre>\n\n<p><code>tRange</code> is Empty. However, if I use:</p>\n\n<pre><code>    Set tRange = Range(Cells(2, 5), Cells(botRow, 5)).SpecialCells(xlCellTypeConstants)\n</code></pre>\n\n<p><code>tRange</code> has what I want.</p>\n\n<p>Why doesn't <code>.SpecialCells</code> work on a defined range variable?\nAm I missing something?</p>\n"}, {"tags": ["arrays", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "edited": false, "score": 0, "creation_date": 1570693787, "post_id": 58309324, "comment_id": 102995545, "body": "Thank you so much you have guided me a lot let me now start working on it and taking every bit of information you provided.Many many thanks"}, {"owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "edited": false, "score": 0, "creation_date": 1570703879, "post_id": 58309324, "comment_id": 103000908, "body": "We are still having the same problem , the code is still picking only 1 item for each product:"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "edited": false, "score": 0, "creation_date": 1570711728, "post_id": 58309324, "comment_id": 103005267, "body": "Your original post is not showing how you are attempting to get additional items for each product. I&#39;d suggest opening a new question with your updated code in order to get more help on this new issue. Your original code seems to be only pulling information from the form, not from the recordset."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1570642009, "creation_date": 1570642009, "answer_id": 58309324, "question_id": 58307424, "link": "https://stackoverflow.com/questions/58307424/how-to-load-all-the-field-in-the-subform-to-be-part-of-the-json-string-in-ms-acc/58309324#58309324", "title": "How to load all the field in the subform to be part of the Json String in Ms Access VBA", "body": "<p>You're having an issue with nesting the objects, which can get tricky. The example below should help. I created a <a href=\"https://stackoverflow.com/a/46245469/4717755\">helpful guide</a> in this answer that I constantly refer back to.</p>\n\n<p>As a side note, I strongly reccommend using better names for your variables. Not only was I confused about <code>foo</code>, <code>Koo</code>, <code>Noor, and</code>hoo`, but I can guarantee that you'll be confused in a few months when you have to come back and maintain/change your code.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nSub CreateJSON()\n    Dim rs As Recordset\n    Set rs = CurrentDb.OpenRecordset(\"Table1\")\n\n    Dim root As Dictionary\n    Set root = New Dictionary\n\n    Dim transaction As Dictionary\n    Dim transactions As Collection\n    Dim item As Dictionary\n    Dim items As Collection\n    Dim invoice As Dictionary\n    Dim invoices As Collection\n\n    Dim i As Long\n    Dim j As Long\n    Set transactions = New Collection\n\n    rs.MoveFirst\n    Do While Not rs.EOF\n        Set transaction = New Dictionary\n        transaction.Add \"PosSerialNumber\", rs!PosSerialNumber\n        transaction.Add \"IssueTime\", rs!IssueTime\n        transaction.Add \"Customer\", rs!Customer\n        transaction.Add \"TransactionTyp\", 0\n        transaction.Add \"PaymentMode\", 0\n        transaction.Add \"SaleType\", 0\n\n        '--- loop over all the items\n        Dim itemCount As Long\n        itemCount = 2\n        Set items = New Collection\n        For i = 1 To itemCount\n            Set item = New Dictionary\n            item.Add \"ItemID\", i\n            item.Add \"Description\", \"some description\"\n            item.Add \"BarCode\", \"some barcode\"\n            item.Add \"Quantity\", \"some quantity\"\n            item.Add \"UnitPrice\", \"some unit price\"\n            item.Add \"Discount\", \"some discount\"\n\n            '--- loop over all the invoices\n            Dim invoiceCount As Long\n            invoiceCount = 3\n            Set invoices = New Collection\n            For j = 1 To invoiceCount\n                Set invoice = New Dictionary\n                invoice.Add \"Total\", 120 + j\n                invoice.Add \"IsTaxInclusive\", \"of course it is\"\n                invoice.Add \"RRP\", \"something about RRP\"\n                invoices.Add invoice\n            Next j\n            item.Add \"Taxable\", invoices\n            items.Add item\n        Next i\n        transaction.Add \"Items\", items\n        transactions.Add transaction\n        rs.MoveNext\n    Loop\n    root.Add \"JSON Created\", Now()\n    root.Add \"Transactions\", transactions\n\n    Dim json As String\n    json = JsonConverter.ConvertToJson(root, Whitespace:=3)\n    Debug.Print json\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570642009, "creation_date": 1570634629, "last_edit_date": 1570639230, "question_id": 58307424, "link": "https://stackoverflow.com/questions/58307424/how-to-load-all-the-field-in-the-subform-to-be-part-of-the-json-string-in-ms-acc", "title": "How to load all the field in the subform to be part of the Json String in Ms Access VBA", "body": "<p>I want to have all the data in the open subform to be part of my JSON string. Currently, only the first row is picked up. I want all current rows to be picked up after pressing the <code>save</code> button.</p>\n\n<p>The parent form data is properly picked up, it's just this part on the subform which is incomplete: it's only picking the first-row data, the second-row data through the last is not picked up.</p>\n\n<p>I want the first row of data to the last to be picked up after pressing the <code>save</code> button from the subform called [sfrmInvoicedetails Subform]</p>\n\n<pre><code>Private Sub CmdSales_Click()\n\n    Dim rs As Recordset\n    Dim foo As New Dictionary\n    Set foo = New Dictionary\n\n    Dim Noor As Dictionary\n    Set Noor = New Dictionary\n\n    Dim hoo As New Collection\n    Dim goo As New Dictionary\n    Set goo = New Dictionary\n\n    Dim Zoo As New Dictionary\n    Set Zoo = New Dictionary\n\n    Dim Koo As New Collection\n    Dim Too As New Collection\n\n    Set rs = Me.[sfrmInvoicedetails Subform].Form.RecordsetClone\n\n    With rs\n        Do While Not .EOF\n        'Do Something\n        .MoveNext\n        Loop\n    End With\n\n    Set rs = Nothing\n    With foo\n        .Add \"PosSerialNumber\", Me.INV\n        .Add \"IssueTime\", Me.InvoiceDate\n        .Add \"Customer\", Me.Customer.Column(1)\n        .Add \"TransactionTyp\", 0\n        .Add \"PaymentMode\", 0\n        .Add \"SaleType\", 0\n        .Add \"Items\", Koo\n     Koo.Add Noor\n     Noor.Add \"ItemID\", 1\n     Noor.Add \"Description\", Forms!frmInvoice![sfrmInvoicedetails Subform]!Description.Column(1)\n     Noor.Add \"BarCode\", \"4589630036\"\n     Noor.Add \"Quantity\", Forms!frmInvoice![sfrmInvoicedetails Subform]!Qty\n     Noor.Add \"UnitPrice\", Forms!frmInvoice![sfrmInvoicedetails Subform]!UnitPrice\n     Noor.Add \"Discount\", Forms!frmInvoice![sfrmInvoicedetails Subform]!Discount\n     Noor.Add \"Taxable\", hoo\n     hoo.Add Forms!frmInvoice![sfrmInvoicedetails Subform]!Taxables\n     Noor.Add \"Total\", 120\n     Noor.Add \"IsTaxInclusive\", Forms!frmInvoice![sfrmInvoicedetails Subform]!Inclusive\n     Noor.Add \"RRP\", Forms!frmInvoice![sfrmInvoicedetails Subform]!RRP\n     End With\n\n     Dim member As Variant\n     For Each member In foo\n\n     Next\n\n     MsgBox JsonConverter.ConvertToJson(foo, Whitespace:=3), vbOKOnly, \"Audited by Chris H\"\nEnd Sub\n</code></pre>\n\n<p>Full data rows picked from the recordset of the subform called <code>[sfrmInvoicedetails Subform]</code> and show in the JSON string</p>\n"}, {"tags": ["vba", "ms-access", "stream", "adodb"], "comments": [{"owner": {"reputation": 1, "user_id": 6346925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206903325996963/picture?type=large", "display_name": "KGB", "link": "https://stackoverflow.com/users/6346925/kgb"}, "edited": false, "score": 0, "creation_date": 1570643344, "post_id": 58307252, "comment_id": 102980751, "body": "Well, I&#39;ve been playing around with it more, and it seems to be some sort of slowing down of my system. If I wait several minutes, the file updates correctly. I&#39;m running Win 10 on a very new system....How can I check to see if the memory has correctly been cleared and how long that takes (if that&#39;s even possible)?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1570696826, "post_id": 58307252, "comment_id": 102997029, "body": "Have you tried <code>With CreateObject(&quot;microsoft.XMLHTTP&quot;) ... End With</code>?"}, {"owner": {"reputation": 1, "user_id": 6346925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206903325996963/picture?type=large", "display_name": "KGB", "link": "https://stackoverflow.com/users/6346925/kgb"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1570823774, "post_id": 58307252, "comment_id": 103050552, "body": "Thanks for the reply. I haven&#39;t tried that. Do you have an example of how I might make that work or a link for some instruction?"}], "owner": {"reputation": 1, "user_id": 6346925, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206903325996963/picture?type=large", "display_name": "KGB", "link": "https://stackoverflow.com/users/6346925/kgb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593762695, "creation_date": 1570633955, "last_edit_date": 1593762695, "question_id": 58307252, "link": "https://stackoverflow.com/questions/58307252/adodb-stream-not-clearing-cache-when-set-to-nothing", "title": "ADODB Stream not clearing cache when set to Nothing", "body": "<p>Hoping someone can help. I am trying to download both MS Access databases and Excel files via URL link, but if the file updates, my download script does not update the stream. The cache is not clearing when the variable is set to nothing. The next time I try to run the code, the original file downloads instead of the updated file.</p>\n\n<p>I have tried adding \"set to nothing\" in multiple places, but I think my problem, as I found in a similar post here is that I am not more specific with my declaration of the object variables. I'm not very experienced with this aspect of VBA.</p>\n\n<pre><code>Dim sFo as string\nDim oStrm As Object\nDim HttpReq As Object\nDim nwLBUDir As String\n\nsFo = \"http://10.38.111.342/Shared_Docs//Docs/Locfile.mdb\"\nnwLBUDir = Application.CurrentProject.Path\n\nSet HttpReq = CreateObject(\"microsoft.XMLHTTP\")\n    HttpReq.Open \"GET\", sFo, False\n    HttpReq.send\n\n    sFo = HttpReq.responseBody\n    If HttpReq.Status = 200 Then\n        Set oStrm = CreateObject(\"ADODB.Stream\")\n        oStrm.Open\n        oStrm.Type = 1\n        oStrm.Write HttpReq.responseBody\n        oStrm.SaveToFile nwLBUDir &amp; \"\\\" &amp; \"Locfile.mdb\", 2\n        oStrm.Close\n    End If\n    Set oStrm = Nothing\n</code></pre>\n\n<p>I would greatly appreciate it if someone could point out what I am failing to do to get the variable to set to nothing. Thank you ahead of time. :)</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1570638922, "post_id": 58307050, "comment_id": 102978785, "body": "Are you sure that the range in Word is not formatted using &quot;All Caps&quot;? If it is, this is what needs to be changed..."}, {"owner": {"reputation": 1, "user_id": 12189433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157449593892969/picture?type=large", "display_name": "Jos&#233; Dias Neves", "link": "https://stackoverflow.com/users/12189433/jos%c3%a9-dias-neves"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570707921, "post_id": 58307050, "comment_id": 103002984, "body": "@CindyMeister, it was exactly that! thank you!"}], "owner": {"reputation": 1, "user_id": 12189433, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157449593892969/picture?type=large", "display_name": "Jos&#233; Dias Neves", "link": "https://stackoverflow.com/users/12189433/jos%c3%a9-dias-neves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570634369, "creation_date": 1570633219, "last_edit_date": 1570634369, "question_id": 58307050, "link": "https://stackoverflow.com/questions/58307050/excel-to-word-long-date-writing-to-upper-case-automatically", "title": "Excel to Word, Long Date Writing To Upper Case Automatically", "body": "<p>I am creating a Macro in VBA to find and replace some words in a Word doc. However, the code is putting the dates in the word.doc in upper case and I want it low case. Could you please help? I have the date in the excel file in DD/MM/YY format and I want it in Long Date format</p>\n\n<pre><code>Sub test_date()    \n    Dim wdApp As Word.Application\n    Dim wdDoc As Word.Document    \n    Dim wdRng As Word.Range\n    Dim w_data As Worksheet\n\n    Set w_data = ThisWorkbook.Worksheets(\"DATA\")\n    Set wdApp = CreateObject(\"word.application\")\n    wdApp.Visible = True\n    Set wdDoc = wdApp.Documents.Open(\"C:\\Users\\*******\")\n\n    For Each wdRng In wdDoc.StoryRanges\n        With wdRng.Find\n            .Text = \"D_H\"\n            .Replacement.Text = WorksheetFunction.Text(Date, \"[$-pt-PT]dd \"\"de\"\" mmmm \"\"de\"\" yyyy\")\n            .Wrap = wdFindContinue\n            .Execute Replace:=wdReplaceAll\n\n            .Text = \"D_VL\"\n            .Replacement.Text = WorksheetFunction.Text(w_data.Range(\"C9\"), \"[$-pt-PT]dd \"\"de\"\" mmmm \"\"de\"\" yyyy\")\n\n            .Wrap = wdFindContinue    \n            .Execute Replace:=wdReplaceAll\n        End With\n        Set wdApp = Nothing: Set wdDoc = Nothing: Set wdRng = Nothing\n    Next wdRng\n    MsgBox (\"test finished\")  \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1570632971, "post_id": 58306830, "comment_id": 102975723, "body": "There are various ways you can do this. You can use Arrays to save the data and do a quick Sum to check which cost center to allocate, or you could use a pivot table, or you could just use loops to sum the amount whenever you hit the &quot;Service Fee&quot; in your current code."}], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "is_accepted": false, "score": 0, "last_activity_date": 1570634401, "last_edit_date": 1570634401, "creation_date": 1570633380, "answer_id": 58307087, "question_id": 58306830, "link": "https://stackoverflow.com/questions/58306830/find-highest-value-based-on-two-criteria-then-write-to-cell/58307087#58307087", "title": "Find Highest Value based On Two Criteria, then Write to Cell", "body": "<pre><code> function max2(arr,i) as double\n  dim max as double \n  max=arr(i,0);\n  for j=0 to ubound(arr,2)\n    if arr(i,j)&gt;max then max=arr(i,j)\n   next\n    max2=max\n end sub \n\n sub test\n\n  'build some kind of array structure for your pricing mess\n\n  dim cc() as double\n  redim cc(2,3)\n\n\n   'just fill the structure somehow\n   cc(0,0)=1'cc=cost center\n   cc(0,1)=2\n   cc(0,2)=3\n\n   cc(1,0)=5\n   cc(1,1)=1\n   cc(1,2)=7\n\n   'get the maximum profit to be able to buy a new Porsche      \n\n  debug.print max2(cc,0)  \n\n  debug.print max2(cc,1)\n\n 'if we need a Ferrari\n\n  result=max2(cc,0)  \n  if max2(cc,1) &gt; result then result =max2(cc,1)\n\n  ' or just add a modified max sub with just one dimension\n  'or fill a virtual cost center array with the results so far... and run the \n  'max2 fucntion on that  \n\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570634937, "post_id": 58307263, "comment_id": 102976776, "body": "I&#39;ve done that. Ran into issues when I got handed a data set of over 100,000 values which needed to be parsed and referenced against each other. The problem with using public function x(a as variant, b as long, ... z as string) as variant is the processing time it takes for excel in trying to calculate the amount going on. It depends on the complexity of what you want to do, and if you can reasonably pull out the meaning of a function. For this, it works and it&#39;s reasonably readable."}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570636307, "post_id": 58307263, "comment_id": 102977539, "body": "Depends on taste. I often do not use my programs for quite a while and then the mentioned fun part follows. 100.000 VBA values are not a problem. If that causes performmance issues then i would say you has a problem in the algorithm itselv, Such datamasses i would put in head of a module and update they on needs. To parse them on every excel calculation step is for sure not a good idea.  In one of my acad programs ive git 8.000.000 coordinates in 3d. To find the next by coordinate takes 8 ms. Based on a clever algorithm (octree) VBA is  not the performance  brake. if nothing helps -&gt; c++ dll."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570637183, "post_id": 58307263, "comment_id": 102977965, "body": "It was more a problem in what I was requested to do, than a problem with the algorithms. It took 36 custom functions and turning Excel into a makeshift database for modeling changes across 16 different groups over 29 different projects, over a projected period of 2 years, in allowing any changes made in the weekly scheduling to be changed - whether it was in where the number of hours per week, or the actual timing of the projects - and propagate out for cost, manpower, and funding required at any point, from a collection of sheets that were hastily thrown together. I told them it would be slow"}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570638931, "post_id": 58307263, "comment_id": 102978787, "body": "Are you totally sure that Excel was the tool of choice in that case ? I would use a server based database and just maybee Excel as some kind of Frontend. I do not understand why a lot of people thing a simple table sheet can be as good as a database. And later they start wondering obout the results. Excel is nice to collect some table datas like a color book.Have a look here <a href=\"http://www.wampserver.com/en/\" rel=\"nofollow noreferrer\">wampserver.com/en</a> You can collect your datas central, connect with  whatever ODBC native connectors etc . And the beast is free of charge."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570639330, "post_id": 58307263, "comment_id": 102978934, "body": "I agree that Excel would Not have been my tool of choice for the matter; they actually have a Quick Base(QB) account with open App slots and bandwidth that would have functioned better for it. BUT... management said no to using QB as their &quot;dedicated&quot; devs (I was new-hire &#39;Data Analyst&#39;, even though I&#39;m certified as an Expert Developer for QB) &quot;Didn&#39;t have time&quot;. So, instead they had me program out a massive Excel sheet to do it, slowly. Got shifted then to the Next project, which will probably be handed the same as the last."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11937721"}, "is_accepted": false, "score": 1, "last_activity_date": 1570634015, "creation_date": 1570634015, "answer_id": 58307263, "question_id": 58306830, "link": "https://stackoverflow.com/questions/58306830/find-highest-value-based-on-two-criteria-then-write-to-cell/58307263#58307263", "title": "Find Highest Value based On Two Criteria, then Write to Cell", "body": "<p>For a formula in cell application,</p>\n\n<pre><code>=INDEX(A:C,MATCH(MAXIFS(C:C,A:A,\"=\"&amp; A8,C:C,\"&lt;&gt;\"&amp;C8),C:C),2)\n</code></pre>\n\n<p>Just replace A8/C8 with the row it is being put into, or paste it into B8, and then copy/paste the cell into other rows. it's a quick fix and no programming, just using the built-in functionality of Excel.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2rH9W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2rH9W.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570636528, "post_id": 58307496, "comment_id": 102977656, "body": "Yes perfect simple solution.  Dictionarys are great. I use them often. But based on the header of the question i am not that sure if he get it :) Anyhow he will learn something new :)"}, {"owner": {"reputation": 3, "user_id": 10625571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25cf78fae04d8903cf3a0b1869c25237?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Webster", "link": "https://stackoverflow.com/users/10625571/ian-webster"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 1, "creation_date": 1570653869, "post_id": 58307496, "comment_id": 102985164, "body": "This function works in my example and points me in the direction I want to go. I thought dictionaries would be involved but I didn&#39;t have enough experience to know. As @ThomasLudewig stated, I don&#39;t really get it but I am happy to dissect this and learn over the next couple days. Much appreciated"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 3, "user_id": 10625571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25cf78fae04d8903cf3a0b1869c25237?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Webster", "link": "https://stackoverflow.com/users/10625571/ian-webster"}, "edited": false, "score": 0, "creation_date": 1570691474, "post_id": 58307496, "comment_id": 102994505, "body": "@IanWebster Feel free to ask for clarification on or explanation of specific parts if you need anything, glad to help."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 1, "last_activity_date": 1570634858, "creation_date": 1570634858, "answer_id": 58307496, "question_id": 58306830, "link": "https://stackoverflow.com/questions/58306830/find-highest-value-based-on-two-criteria-then-write-to-cell/58307496#58307496", "title": "Find Highest Value based On Two Criteria, then Write to Cell", "body": "<p>I wrote a user-defined function that returns the CostCenter you need:</p>\n\n<pre><code>Public Function MaxCC()\n\nDim strAcc As String, strCC As String, dblChg As Double, lastrow As Long\n\nstrAcc = Application.Caller.Offset(, -1).Value2\nlastrow = Application.Caller.Worksheet.Cells(Rows.Count, 1).End(xlUp).Row\n\nDim dictCC As New Scripting.Dictionary\n\nDim i As Long\nFor i = 2 To lastrow\n    If Application.Caller.Worksheet.Cells(i, 1).Value2 = strAcc Then\n        If i &lt;&gt; Application.Caller.Row Then strCC = Application.Caller.Worksheet.Cells(i, 2).Value2\n        dblChg = Application.Caller.Worksheet.Cells(i, 3).Value2\n\n        If Not dictCC.Exists(strCC) Then dictCC.Add strCC, 0\n\n        dictCC(strCC) = dictCC(strCC) + dblChg\n    End If\nNext i\n\nDim strMaxCC As String, dblMaxCC As Double, varKey As Variant\ndblMaxCC = 0\nFor Each varKey In dictCC.Keys\n    If dictCC(varKey) &gt; dblMaxCC Then\n        strMaxCC = CStr(varKey)\n        dblMaxCC = dictCC(varKey)\n    End If\nNext varKey\n\nMaxCC = strMaxCC\n\nEnd Function\n</code></pre>\n\n<p>This function uses a dictionary, just be sure to reference <code>Microsoft Scripting Runtime</code> as is described <a href=\"https://stackoverflow.com/a/915333/9173379\">here</a>.</p>\n\n<p>You will be able to enter <code>=MaxCC()</code> as a formula into the empty cells you need filled and it will provide you with the correct CostCenter. Let me know if this works for you and if you have follow-up questions.</p>\n"}, {"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1570635483, "creation_date": 1570635483, "answer_id": 58307673, "question_id": 58306830, "link": "https://stackoverflow.com/questions/58306830/find-highest-value-based-on-two-criteria-then-write-to-cell/58307673#58307673", "title": "Find Highest Value based On Two Criteria, then Write to Cell", "body": "<p>This solution uses a class, I used late binding on the dictionaries, if you want early binding add the reference and <code>set variable = New Dictionary</code> </p>\n\n<p>Class Code:</p>\n\n<pre><code>Option Explicit\n\nPrivate pCenterdict As Object\n\nPublic Sub Load_Data(center As String, cost As Double)\n    If Not pCenterdict.Exists(center) Then\n        pCenterdict.Add center, cost\n    Else\n        pCenterdict(center) = pCenterdict(center) + cost\n    End If\nEnd Sub\n\nPublic Sub initialize()\n    Set pCenterdict = CreateObject(\"Scripting.Dictionary\")\nEnd Sub\n\nPublic Function return_highest() As String\n    Dim key As Variant\n    Dim highestkey As String\n    Dim highestval As Double\n\n    highestval = 0\n    For Each key In pCenterdict.Keys()\n        If pCenterdict(key) &gt; highestval Then\n            highestval = pCenterdict(key)\n            highestkey = key\n        End If\n    Next key\n    return_highest = highestkey\nEnd Function\n</code></pre>\n\n<p>Main code:</p>\n\n<pre><code>Sub test()\n    Dim lr As Long\n    Dim i As Long\n\n    Dim clsdict As Object\n    Dim clsobj As Object\n\n    Set clsdict = CreateObject(\"Scripting.Dictionary\")\n\n    With ActiveWorkbook.Sheets(\"Sheet1\") ' Change this to whatever the sheet name is\n    lr = .Cells(.rows.count, 1).End(xlUp).row\n\n    For i = 2 To lr\n        If Not .Cells(i, 4).value = \"Service Fee\" Then\n            If Not clsdict.Exists(.Cells(i, 1).value) Then\n                Set clsobj = New Cls_SO 'Create instance, If you name your class something else change this to New YourClassNameHere\n                clsobj.initialize 'Create Dictionary\n                clsobj.Load_Data .Cells(i, 2).value, .Cells(i, 3).value 'Load Values\n                clsdict.Add .Cells(i, 1).value, clsobj\n            Else\n                clsdict(.Cells(i, 1).value).Load_Data .Cells(i, 2).value, .Cells(i, 3).value 'Load Values\n            End If\n        Else\n            .Cells(i, 2).value = clsdict(.Cells(i, 1).value).return_highest 'Get Highest\n        End If\n    Next\n    End With\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10625571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25cf78fae04d8903cf3a0b1869c25237?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Webster", "link": "https://stackoverflow.com/users/10625571/ian-webster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 58307496, "answer_count": 4, "score": 0, "last_activity_date": 1581922877, "creation_date": 1570632518, "last_edit_date": 1581922877, "question_id": 58306830, "link": "https://stackoverflow.com/questions/58306830/find-highest-value-based-on-two-criteria-then-write-to-cell", "title": "Find Highest Value based On Two Criteria, then Write to Cell", "body": "<p>I have a large csv/Excel invoice (UPS - not sure if that will matter). I validate and assign missing cost centers every week, using VBA to automate this process.</p>\n\n<p>Usually it is no more complicated than, if x is this cell, then use y cost center.</p>\n\n<p>Here is the problem: </p>\n\n<p>We use a consolidated invoice which contains many different accounts. Sometimes the account is charged a service fee. If so, that service fee is applied to the cost center under the account which had the highest amount of charges.</p>\n\n<p>Here is a stripped-down example.</p>\n\n<p>We start with:<br>\n<a href=\"https://i.stack.imgur.com/aPldZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aPldZ.png\" alt=\"Start\"></a></p>\n\n<p>Because <code>D8</code> says \u201cService Fee\u201d I need <code>B8</code> to equal the cost center with the highest amount of charges. In the case of Account1, CostCenter1 has the most charges at $17.00. For Account2, it will be CostCenter3.</p>\n\n<p>The final product should look like:<br>\n<a href=\"https://i.stack.imgur.com/S67vi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S67vi.png\" alt=\"End\"></a></p>\n\n<p>I would show some code but I am at a loss of where to start.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12175844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6abff58e06812025f19a6ed8d9f25?s=128&d=identicon&r=PG&f=1", "display_name": "Miss.Tech", "link": "https://stackoverflow.com/users/12175844/miss-tech"}, "edited": false, "score": 0, "creation_date": 1570699807, "post_id": 58309323, "comment_id": 102998666, "body": "Hello niton, thanks for the reply; however, even with your changes, I am still getting only appointments which are not re-occurrences."}, {"owner": {"reputation": 1, "user_id": 12175844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6abff58e06812025f19a6ed8d9f25?s=128&d=identicon&r=PG&f=1", "display_name": "Miss.Tech", "link": "https://stackoverflow.com/users/12175844/miss-tech"}, "edited": false, "score": 0, "creation_date": 1571126821, "post_id": 58309323, "comment_id": 103126612, "body": "thank you; however, I am still not getting the recurring meetings. :("}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1570720198, "last_edit_date": 1570720198, "creation_date": 1570642004, "answer_id": 58309323, "question_id": 58306804, "link": "https://stackoverflow.com/questions/58306804/getting-reccuring-appointments-vba/58309323#58309323", "title": "Getting reccuring appointments VBA", "body": "<p>Items in a folder have to be made into a collection to then manipulate.</p>\n\n<pre><code>On Error Resume Next ' This is a rare proper use.\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &gt; 0 Then Set olApp = CreateObject(\"Outlook.Application\")\nOn Error GoTo 0\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olFolder = olNS.GetDefaultFolder(9) 'olFolderCalendar\n\nSet itmCollection = olFolder.Items\n\n'include recurring items\n'-------------------------\nitmCollection.Sort (\"[Start]\")\nitmCollection.IncludeRecurrences = True\n'-------------------------\n\nFor Each olApt In itmCollection\n</code></pre>\n\n<p>Demo code</p>\n\n<pre><code>Option Explicit\n\nSub apptsInDateRangeIncludingRecurrences()\n\nDim ToDate As Date\nDim FromDate As Date\n\nDim olApp As Object\nDim olNS As Object\nDim olFolder As Object\n\nDim itmCollection As Object\nDim itmCollectionFrom As Object\nDim itmCollectionFromTo As Object\nDim sFilter As String\n\nDim olApt As Object\n\nToDate = CDate(\"10/12/2019\")\nFromDate = CDate(\"10/06/2019\")\n\nOn Error Resume Next ' This is a rare proper use.\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &gt; 0 Then Set olApp = CreateObject(\"Outlook.Application\")\nOn Error GoTo 0\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olFolder = olNS.GetDefaultFolder(9) 'olFolderCalendar\n\nSet itmCollection = olFolder.Items\n\n'include recurring items\n'-------------------------\nitmCollection.Sort (\"[Start]\")\nitmCollection.IncludeRecurrences = True\n'-------------------------\n\n'Filter for applicable items\nsFilter = \"[Start]&gt;='\" &amp; FromDate &amp; \"'\"\n'Debug.Print sFilter\nSet itmCollectionFrom = itmCollection.Restrict(sFilter)\n\nsFilter = \"[Start]&lt;='\" &amp; ToDate &amp; \"'\"\n'Debug.Print sFilter\nSet itmCollectionFromTo = itmCollectionFrom.Restrict(sFilter)\n\nFor Each olApt In itmCollectionFromTo\n    If olApt.Start &gt;= FromDate Then\n        Debug.Print olApt.Start &amp; \" \" &amp; olApt.Subject\n    End If\nNext olApt\n\nDebug.Print \"Done.\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12175844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e6abff58e06812025f19a6ed8d9f25?s=128&d=identicon&r=PG&f=1", "display_name": "Miss.Tech", "link": "https://stackoverflow.com/users/12175844/miss-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570720198, "creation_date": 1570632444, "last_edit_date": 1570639002, "question_id": 58306804, "link": "https://stackoverflow.com/questions/58306804/getting-reccuring-appointments-vba", "title": "Getting reccuring appointments VBA", "body": "<p>Can somebody please help me out. I have this code and it reads all appointments from the calendar for specific dates; however, the code doesn't display any recurring meetings within given dates: </p>\n\n<pre><code>ToDate = CDate(\"10/12/2019\")\nFromDate = CDate(\"10/06/2019\")\n\n'On Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &gt; 0 Then Set olApp = CreateObject(\"Outlook.Application\")\nOn Error GoTo 0\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olFolder = olNS.GetDefaultFolder(9) 'olFolderCalendar\n\n'include reccuring items\n'-------------------------\nolFolder.Items.Sort (\"[Start]\")\nolFolder.Items.IncludeRecurrences = True\n\n'-------------------------\n\nNextRow = 2\n\nWith Sheets(\"Sheet1\") 'Change the name of the sheet here\n    .Range(\"A1:F1\").Value = Array(\"Report Date\", \"Date\", \"Time spent\", \"Location\", \"Categories\", \"Title\")\n\n    For Each olApt In olFolder.Items\n\n        If (olApt.Start &gt;= FromDate And olApt.Start &lt;= ToDate) Then\n\n            .Cells(NextRow, \"A\").Value = Format(Now, \"DD-MM-YY\")\n            .Cells(NextRow, \"B\").Value = CDate(olApt.Start)\n            .Cells(NextRow, \"C\").Value = olApt.End - olApt.Start\n             .Cells(NextRow, \"C\").NumberFormat = \"HH:MM\"\n            .Cells(NextRow, \"E\").Value = olApt.Categories\n            .Cells(NextRow, \"F\").Value = olApt.Subject\n            NextRow = NextRow + 1\n        Else\n        End If\n    Next olApt\n    .Columns.AutoFit\nEnd With\n</code></pre>\n\n<p>Can somebody please help me out and let me know what I am doing wrong?!</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1570632420, "post_id": 58306589, "comment_id": 102975395, "body": "Have you tried <code>WHERE Unit IN (&#39;AA&#39;, &#39;BB&#39;)</code>?"}, {"owner": {"reputation": 99, "user_id": 8485382, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qbj4c7qsJuk/AAAAAAAAAAI/AAAAAAAAO44/jP1r7VBaINs/photo.jpg?sz=128", "display_name": "David Declercq", "link": "https://stackoverflow.com/users/8485382/david-declercq"}, "reply_to_user": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1570634038, "post_id": 58306589, "comment_id": 102976273, "body": "yes, but then I have to manually add this text in all the queries. My goal is to automate that process."}, {"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 1, "creation_date": 1570634890, "post_id": 58306589, "comment_id": 102976752, "body": "Then create another table with the list of values you want and <code>JOIN ON Unit = ValidUnits.Unit</code>"}, {"owner": {"reputation": 1980, "user_id": 11517179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zH4UW.gif?s=128&g=1", "display_name": "daShier", "link": "https://stackoverflow.com/users/11517179/dashier"}, "edited": false, "score": 0, "creation_date": 1570635451, "post_id": 58306589, "comment_id": 102977067, "body": "One other option would be if all valid values for <code>Unit</code> are <code>AA, BB, CC,...ZZ</code>, then you could try something like <code>WHERE LEN(Unit) = 2 AND LEFT(Unit,1) = RIGHT(Unit,1)</code> That&#39;s not perfect because <code>11</code> or <code>$$</code> will also match, but it might work for your situation. Or you can use a regular expression, but I think you need VBA for that in Access."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570654534, "post_id": 58306589, "comment_id": 102985418, "body": "I doubt AA, BB, CC are real values in table. If you filter for Detail 1, specifying Units seems redundant. I don&#39;t use dynamic parameterized queries. I apply filter criteria to forms and reports."}], "owner": {"reputation": 99, "user_id": 8485382, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qbj4c7qsJuk/AAAAAAAAAAI/AAAAAAAAO44/jP1r7VBaINs/photo.jpg?sz=128", "display_name": "David Declercq", "link": "https://stackoverflow.com/users/8485382/david-declercq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594421417, "creation_date": 1570631739, "last_edit_date": 1594421417, "question_id": 58306589, "link": "https://stackoverflow.com/questions/58306589/microsoft-access-use-table-filter-as-where-in-sql-query", "title": "Microsoft Access use table filter as where in SQL query", "body": "<p>I have an MS Access Database with a lot of tables (including data for certain units) and a lot of queries. I have another table of units that I want to investigate.</p>\n\n<p>For now the queries apply to all units in the tables.</p>\n\n<p>My goal is depending on the filter that I select in the unit table, execute all my queries taking into account in the <code>where</code> clause that only these units can be shown.</p>\n\n<p>So my table is for example (the actual table is 5000 records)</p>\n\n<pre><code>Unit   Detail\nAA     1\nBB     1\nCC     3\n</code></pre>\n\n<p>If I filter in this table for Detail <code>1</code>, I want all my queries to add in the where clause:</p>\n\n<pre><code>Where Unit=\"AA\" or Unit=\"BB\"\n</code></pre>\n\n<p>Is there a way to achieve this?</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1570686856, "post_id": 58305952, "comment_id": 102992581, "body": "Can you be more precise what you mean by &quot;open a new frame&quot;? What is the overall purpose of that? What are you trying to do? We need more information (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> to <a href=\"https://stackoverflow.com/posts/58305952/edit\">edit</a> and improve your question)."}, {"owner": {"reputation": 3, "user_id": 12189112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HSc1e_JqkKs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8Uv3LCaNZrytXqCcLaguxqO4kMw/photo.jpg?sz=128", "display_name": "Patrick9559", "link": "https://stackoverflow.com/users/12189112/patrick9559"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1570688731, "post_id": 58305952, "comment_id": 102993333, "body": "Ok, I will try to be more precise. I want to make a document on excel for employees, where they have to put the general information about them with some specifications, for example trainee, etc. And this document has to be written on a frame. And the specfications (like the trainee) have to be on &quot;frame2&quot;, but unvisble. And I need a shortcut between frame1, the general document and frame2. I was trying to do this with a command button on frame1, so when I click the button, frame2 get visible. But that didnt&#39;t worked out."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1570688961, "post_id": 58305952, "comment_id": 102993425, "body": "Can you show an example in a screenshot please? That would help. I think it is still unclear what exactly you mean."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12189112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HSc1e_JqkKs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8Uv3LCaNZrytXqCcLaguxqO4kMw/photo.jpg?sz=128", "display_name": "Patrick9559", "link": "https://stackoverflow.com/users/12189112/patrick9559"}, "edited": false, "score": 0, "creation_date": 1570633431, "post_id": 58306744, "comment_id": 102975974, "body": "Thank you for your answer,  i already did that, and it didn&#39;t worked out."}], "tags": [], "owner": {"reputation": 87, "user_id": 7608839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E2arP.jpg?s=128&g=1", "display_name": "Olalekan", "link": "https://stackoverflow.com/users/7608839/olalekan"}, "is_accepted": false, "score": 0, "last_activity_date": 1570632263, "creation_date": 1570632263, "answer_id": 58306744, "question_id": 58305952, "link": "https://stackoverflow.com/questions/58305952/opening-a-new-frame-with-a-commandbutton-in-excel/58306744#58306744", "title": "Opening a new frame with a CommandButton in Excel", "body": "<p>I think what could be done is to create a kind of shape or button on your worksheet, then, attach a vba script to activate the frame when clicked. It's just the same way on the UserForm only that you are using a shape or button in which you have attached a macro to on your worksheet.</p>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "is_accepted": true, "score": 0, "last_activity_date": 1570691420, "creation_date": 1570691420, "answer_id": 58317308, "question_id": 58305952, "link": "https://stackoverflow.com/questions/58305952/opening-a-new-frame-with-a-commandbutton-in-excel/58317308#58317308", "title": "Opening a new frame with a CommandButton in Excel", "body": "<p><strong>With an ActiveX button:</strong></p>\n\n<ol>\n<li>Insert a button into your sheet from the Developer tab -> Insert -> ActiveX Controls. </li>\n<li>Double-click on the button and it will take you to the VBA editor, in the Click event of that button.</li>\n<li>Add the code <code>UserForm.Show</code> in the event code where UserForm is the name of your form.</li>\n</ol>\n\n<hr>\n\n<p><strong>With a form control:</strong></p>\n\n<ol>\n<li><p>Create a Sub in a module where you call the Show method of your UserForm (or frame as you call it).</p></li>\n<li><p>Then insert a button into your sheet from the Developer tab -> Insert -> Form Controls. It will ask you what macro you want to assign to that button. Choose the Sub from step 1.</p>\n\n<pre><code>Sub showForm()\n\n    UserForm1.Show\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 12189112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HSc1e_JqkKs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8Uv3LCaNZrytXqCcLaguxqO4kMw/photo.jpg?sz=128", "display_name": "Patrick9559", "link": "https://stackoverflow.com/users/12189112/patrick9559"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 58317308, "answer_count": 2, "score": -1, "last_activity_date": 1570691420, "creation_date": 1570629753, "last_edit_date": 1570686756, "question_id": 58305952, "link": "https://stackoverflow.com/questions/58305952/opening-a-new-frame-with-a-commandbutton-in-excel", "title": "Opening a new frame with a CommandButton in Excel", "body": "<p>Hello I just started programming and I have a question: I want to open a new frame with the command button, it worked on the UserForm but not on the sheet in Excel. Can anyone help me?</p>\n"}, {"tags": ["vba", "ms-access", "ms-word"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1570631086, "post_id": 58305934, "comment_id": 102974580, "body": "instead of <code>with activedocument.mailmerge</code> try <code>with owdoc.mailmerge</code> I don&#39;t think owdoc is active."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570631102, "post_id": 58305934, "comment_id": 102974589, "body": "Why are you using <code>ActiveDocument</code> instead of <code>oWdoc</code> - throughout the code?"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 2, "creation_date": 1570631233, "post_id": 58305934, "comment_id": 102974663, "body": "hi. this doesnt make sense &quot;CurrentProject.Path &amp; &quot;X:\\PM\\PM-O\\PM-OQ\\PM-OQRA\\PROCESSES\\03_Pigments\\98_ Database\\05_Inventory\\02_Bulk_letter\\word_template.docx&quot;. leave just te &quot;X:\\....&quot; and delete the CurrentProject.Path"}, {"owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "edited": false, "score": 0, "creation_date": 1570635300, "post_id": 58305934, "comment_id": 102976975, "body": "I have edited the code as suggested but the error as changed to &quot;The is not a valid file name&quot; and it colours  <code>oWord.ActiveDocument.SaveAs2 wdOutputName &amp; &quot;.docx&quot;, 16</code> as yellow. I tried to remove the <code>activedocument</code> but the error changed to method or data member not found"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570638530, "post_id": 58305934, "comment_id": 102978603, "body": "whats the value of wdOutputName ?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570638742, "post_id": 58305934, "comment_id": 102978698, "body": "<code>OutFileName</code> is lacking a file extension, such as docx."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570654029, "post_id": 58305934, "comment_id": 102985226, "body": "Not source of error but need to use <code>nn</code> for minutes <code>yyyymmddnnss</code>."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570691852, "post_id": 58305934, "comment_id": 102994674, "body": "is this word ? i believe that CurrentProject.Path  is from access. in word is document.path i believe"}, {"owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "edited": false, "score": 0, "creation_date": 1570694381, "post_id": 58305934, "comment_id": 102995848, "body": "Let me once again clarify more the problem for easier understanding 1.There is an existing macro-enabled word template that is perfectle working 2. but i will have to click on the word in order to run it,(i didnt know who designed it). 3. now I want to be running it by clicking a button on a form 4.so I am trying to adapt the macro in the word to the <code>on click event</code> of the button. 5. i have tried to erase the macro from the word (though i still have it somewhere) 6. Like i said, my experience is low 7. I need serious help in this as I am on a borrowed time about this project already"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570697656, "post_id": 58305934, "comment_id": 102997512, "body": "This line: <code>Set oWdoc = oWord.Documents.Open(wdInputName)</code>: Write in the correct path, manually, for testing purposes. Does that work? If it does, start checking each part of the code that builds <code>wdInputName</code> until you find where the error is. Given the information in the question and your lack of experience, that&#39;s the only way. You have to <b>learn</b> how to track these things down."}], "owner": {"reputation": 39, "user_id": 11992864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7c4419440df1f1643ac3e7c9e3499d?s=128&d=identicon&r=PG&f=1", "display_name": "firmphem", "link": "https://stackoverflow.com/users/11992864/firmphem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570653628, "creation_date": 1570629722, "last_edit_date": 1570653628, "question_id": 58305934, "link": "https://stackoverflow.com/questions/58305934/this-command-is-not-available-because-no-document-is-opened", "title": "This command is not available because no document is opened", "body": "<p>I am relatively new to mailmerge. I tried to implement this code for an action button in order to implement mail merge but i keep getting error as stated in the subject with this line <code>With ActiveDocument.MailMerge</code> being highlighed with yellow</p>\n\n<p>I have looked at my word template and nothing seems to be wrong.</p>\n\n<pre><code>Private Sub Command30_Click()\n   'set variables\n    Dim oWord As Word.Application\n    Dim oWdoc As Word.Document\n    Dim wdInputName As String\n    Dim wdOutputName As String\n    Dim outFileName As String\n\n' Set Template Path\n    '------------------------------------------------\n    wdInputName = CurrentProject.Path &amp; \"X:\\PM\\PM-O\\PM-OQ\\PM-OQRA\\PROCESSES\\03_Pigments\\98_ Database\\05_Inventory\\02_Bulk_letter\\word_template.docx\"\n\n ' Create unique save filename with minutes\n    ' and seconds to prevent overwrite\n    '------------------------------------------------\n    outFileName = \"Merck_InvStatements_\" &amp; Format(Now(), \"yyyymmddmms\")\n\n ' Output File Path w/outFileName\n    '------------------------------------------------\n    wdOutputName = CurrentProject.Path &amp; \"\\desktop\\completed\\\" &amp; outFileName\n\n     Set oWord = New Word.Application\n    Set oWdoc = oWord.Documents.Open(wdInputName)\n\n    ' Start mail merge\n    '------------------------------------------------\n    With oWord\n\n    oWord.Visible = True\n    With ActiveDocument.MailMerge\n        .MainDocumentType = wdFormLetters\n        .OpenDataSource _\n            Name:=CurrentProject.FullName, _\n            AddToRecentFiles:=False, _\n            LinkToSource:=True, _\n            Connection:=\"Q_SERIAL_INVENTORY_A02\", _\n            SQLStatement:=\"SELECT * FROM [Q_SERIAL_INVENTORY_A02]\"\n        .Destination = wdSendToNewDocument\n        .Execute Pause:=False\n    End With\n   End With\n ' Hide Word During Merge\n    '------------------------------------------------\n    oWord.Visible = False\n\n    ' Save file as PDF\n    ' Uncomment the line below and comment out\n    ' the line below \"Save file as Word Document\"\n    '------------------------------------------------\n    'oWord.ActiveDocument.SaveAs2 wdOutputName &amp; \".pdf\", 17\n\n    ' Save file as Word Document\n    '------------------------------------------------\n    oWord.ActiveDocument.SaveAs2 wdOutputName &amp; \".docx\", 16\n\n    ' Quit Word to Save Memory\n    '------------------------------------------------\n    oWord.Quit savechanges:=False\n\n    ' Clean up memory\n    '------------------------------------------------\n    Set oWord = Nothing\n    Set oWdoc = Nothing\n     End Sub`\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 2, "creation_date": 1570629981, "post_id": 58305879, "comment_id": 102973969, "body": "I believe arrays stored as an item in a dictionary become immutable. You need to create a temporary array, copy the value of the dictionary item, redim the temporary, and then load it into the dictionary."}, {"owner": {"reputation": 614, "user_id": 3893580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bbf5b1f688a462c3a076210ea9efb3?s=128&d=identicon&r=PG&f=1", "display_name": "Caerus", "link": "https://stackoverflow.com/users/3893580/caerus"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1570630332, "post_id": 58305879, "comment_id": 102974169, "body": "That&#39;s wild. Every time I work in VBA I wish it were more like Python. Thanks."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1570630397, "post_id": 58305879, "comment_id": 102974207, "body": "You and me both."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1570631437, "post_id": 58305879, "comment_id": 102974809, "body": "Your problem comes from trying to use arrays.  You should try replacing your arrays with either a collection,  scripting.dictionary or an ArrayList."}], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1570662503, "last_edit_date": 1570662503, "creation_date": 1570659457, "answer_id": 58313007, "question_id": 58305879, "link": "https://stackoverflow.com/questions/58305879/resize-an-array-inside-an-array/58313007#58313007", "title": "Resize an Array inside an Array", "body": "<p>@Warcupine is correct. You have to pull the array out of the dictionary, redim it, set the value for that index and then add it back to the dictionary. </p>\n\n<p>I haven't tested this, but it should work: </p>\n\n<pre><code>If Not .Exists(animalName) Then\n    ReDim kilosEatenArr(0)\n    ReDim kilosGainedArr(0)\n\n    kilosEatenArr(0) = kilosEatenCount\n    kilosGainedArr(0) = kilosGainedCount\n\n    outerArr = Array(kilosEatenArr(0),kilosGainedArr(0))\n\n    animalDict(animalName) = outerArr   'implict adds are faster\n\nElse \n\n    outerArr = animalDict(animalName)\n\n    kilosEatenArr = outerArr(0)\n    kilosGainedArr = outerArr(1)\n\n    ReDim Preserve kilosEatenArr(LBound(kilosEatenArr) To UBound(kilosEatenArr) + 1)    \n    ReDim Preserve kilosGainedArr(LBound(kilosGainedArr) To UBound(kilosGainedArr) + 1)\n\n    kilosEatenArr(UBound(kilosEatenArr)) = kilosEatenCount\n    kilosGainedArr(UBound(kilosGainedArr)) = kilosGainedCount\n\n    outerArr = Array(kilosEatenArr, kilosGainedArr)\n\n    animalDict(animalName) = outerArr\n\nEnd If \n\n\nErase outerArr\nErase kilosEatenArr\nErase kilosGainedArr\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 3893580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bbf5b1f688a462c3a076210ea9efb3?s=128&d=identicon&r=PG&f=1", "display_name": "Caerus", "link": "https://stackoverflow.com/users/3893580/caerus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570662503, "creation_date": 1570629530, "last_edit_date": 1570629885, "question_id": 58305879, "link": "https://stackoverflow.com/questions/58305879/resize-an-array-inside-an-array", "title": "Resize an Array inside an Array", "body": "<p>I have a VBA dictionary with key:value pairs. The key is an animal name and the value is an array of arrays that looks like this: [[kilos eaten], [kilos gained]]. I'm trying to resize the inner arrays so that I can add items to these arrays via a loop. The <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/redim-statement\" rel=\"nofollow noreferrer\">documentation</a> indicates that \"To resize an array contained in a Variant, you must explicitly declare the Variant variable before attempting to resize its array.\" I've done this earlier in the code, but I still have a syntax error.</p>\n\n<pre><code>            With animalDict\n                'Check if the animal is already in the dict\n                'If not, create a key:value entry that is equal to (animal name):[[kilos eaten],[kilos gained]]\n                If Not .Exists(animalName) Then\n                    ReDim kilosEatenArr(0)\n                    ReDim kilosGainedArr(0)\n                    ReDim outerArr(1)\n                    kilosEatenArr(0) = kilosEatenCount\n                    kilosGainedArr(0) = kilosGainedCount\n                    outerArr(0) = kilosEatenArr\n                    outerArr(1) = kilosGainedArr\n                    .Add Key:=animalName, Item:=outerArr\n                Else\n                    outerArr = .Item(animalName)\n                    ReDim Preserve outerArr(0)(LBound(outerArr(0)) To UBound(outerArr(0)) + 1) 'Sytnax error here\n                    ReDim Preserve outerArr(1)(LBound(outerArr(1)) To UBound(outerArr(1)) + 1) 'Another sytnax error here\n                    kilosEatenArr(UBound(kilosEatenArr)) = kilosEatenCount\n                    kilosGainedArr(UBound(kilosGainedArr)) = kilosGainedCount\n                    outerArr(0) = kilosEatenArr\n                    outerArr(1) = kilosGainedArr\n                    animalDict(animalName) = outerArr\n                End If\n            End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "optimization", "foreach"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1570625790, "post_id": 58304413, "comment_id": 102971451, "body": "You may benefit from <a href=\"https://stackoverflow.com/questions/53987345/speed-up-excel-vba-copying-data-from-one-sheet-to-another\">Understanding Read/ Write Speeds</a> from hard disk vs memory."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 2, "creation_date": 1570626269, "post_id": 58304413, "comment_id": 102971728, "body": "if you have the result of your visible calculations in a (hidden) column on the row, then apply a <code>.autofilter</code> to all the false values in one go. It would be much faster than looping over all of them."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1570626419, "post_id": 58304413, "comment_id": 102971807, "body": "I like the idea of an <code>AutoFilter</code>, or else go loop through an array and use <code>Union</code> to create two range object to hide/unhide all at once. That would be faster than to iterate over items and hide/unhide rows one by one. Futhermore, working code might be better suited for <a href=\"https://codereview.stackexchange.com/\">Code Review</a> instead =)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1570626608, "post_id": 58304413, "comment_id": 102971928, "body": "Also if you need the rows hidden instead of filtered (there is a small difference) then this can be done with an <code>.advancedfilter</code>. <a href=\"https://stackoverflow.com/questions/58232543/advanced-filter-in-vba-excel-with-combobox/58233316#58233316\">Shameless self plug</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 2, "last_activity_date": 1570626333, "creation_date": 1570626333, "answer_id": 58304857, "question_id": 58304413, "link": "https://stackoverflow.com/questions/58304413/how-can-i-speed-up-this-for-each-loop-in-vba/58304857#58304857", "title": "How can I speed up this For Each loop in VBA?", "body": "<p>I'd suggest copying your data range to a memory-based array and checking that, then using that data to adjust the visibility of each row. It minimizes the number of interactions you have with the worksheet <code>Range</code> object, which takes up lots of time and is a big performance hit for large ranges.</p>\n\n<pre><code>Sub HideHiddenRows()\n    Dim dataRange As Range\n    Dim data As Variant\n    Set dataRange = Sheet1.Range(\"A13:A2019\")\n    data = dataRange.Value\n\n    Dim rowOffset As Long\n    rowOffset = IIf(LBound(data, 1) = 0, 1, 0)\n\n    ApplicationPerformance Flag:=False\n\n    Dim i As Long\n    For i = LBound(data, 1) To UBound(data, 1)\n        If data(i, 1) = \"Hide\" Then\n            dataRange.Rows(i + rowOffset).EntireRow.Hidden = True\n        Else\n            dataRange.Rows(i + rowOffset).EntireRow.Hidden = False\n        End If\n    Next i\n    ApplicationPerformance Flag:=True\nEnd Sub\n\nPublic Sub ApplicationPerformance(ByVal Flag As Boolean)\n    Application.ScreenUpdating = Flag\n    Application.DisplayAlerts = Flag\n    Application.EnableEvents = Flag\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 2, "last_activity_date": 1570628053, "last_edit_date": 1570628053, "creation_date": 1570627736, "answer_id": 58305303, "question_id": 58304413, "link": "https://stackoverflow.com/questions/58304413/how-can-i-speed-up-this-for-each-loop-in-vba/58305303#58305303", "title": "How can I speed up this For Each loop in VBA?", "body": "<p>to increase perfomance you can populate dictionary with range addresses, and hide or unhide at once, instead of hide/unhide each particular row (but this is just in theory, you should test it by yourself), just an example:</p>\n\n<pre><code>Sub HideHiddenRows()\n    Dim cl As Range, x As Long\n    Dim dic As Object: Set dic = CreateObject(\"Scripting.Dictionary\")\n\n    x = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For Each cl In Range(\"A1\", Cells(x, \"A\"))\n        If cl.Value = 0 Then dic.Add cl.Address(0, 0), Nothing\n    Next cl\n\n    Range(Join(dic.keys, \",\")).EntireRow.Hidden = False\n\nEnd Sub\n</code></pre>\n\n<p>demo:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9HsDo.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9HsDo.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "edited": false, "score": 0, "creation_date": 1570637762, "post_id": 58307939, "comment_id": 102978262, "body": "This was the fastest solution for me. Thank you!"}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "reply_to_user": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "edited": false, "score": 0, "creation_date": 1570638849, "post_id": 58307939, "comment_id": 102978751, "body": "@jakrooster. Try it on 50,000 rows to see its real power. :-)"}], "tags": [], "owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "is_accepted": true, "score": 2, "last_activity_date": 1570636354, "creation_date": 1570636354, "answer_id": 58307939, "question_id": 58304413, "link": "https://stackoverflow.com/questions/58304413/how-can-i-speed-up-this-for-each-loop-in-vba/58307939#58307939", "title": "How can I speed up this For Each loop in VBA?", "body": "<p>Another possibility:</p>\n\n<pre><code>Dim mergedRng As Range\n\n'.......\n\nrng_HideFormula.EntireRow.Hidden = False\nFor Each rng_Item In rng_HideFormula\n    If rng_Item.Value2 = str_HideRef Then\n        If Not mergedRng Is Nothing Then\n            Set mergedRng = Application.Union(mergedRng, rng_Item)\n        Else\n            Set mergedRng = rng_Item\n        End If\n    End If\nNext rng_Item\nIf Not mergedRng Is Nothing Then mergedRng.EntireRow.Hidden = True\nSet mergedRng = Nothing\n\n'........\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 58307939, "answer_count": 3, "score": 2, "last_activity_date": 1570636354, "creation_date": 1570625044, "last_edit_date": 1570628745, "question_id": 58304413, "link": "https://stackoverflow.com/questions/58304413/how-can-i-speed-up-this-for-each-loop-in-vba", "title": "How can I speed up this For Each loop in VBA?", "body": "<p>I have an Worksheet_Change macro that hides/unhides rows depending on the choice a user makes in a cell with a data validation list.</p>\n\n<p>The code takes a minute to run. It's looping over c.2000 rows. I'd like it to take closer to a few seconds so it becomes a useful user tool.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    'Exit the routine early if there is an error\n    On Error GoTo EExit\n\n    'Manage Events\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    'Declare Variables\n    Dim rng_DropDown As Range\n    Dim rng_HideFormula As Range\n    Dim rng_Item As Range\n\n    'The reference the row hide macro will look for to know to hide the row\n    Const str_HideRef As String = \"Hide\"\n\n    'Define Variables\n    'The range that contains the week selector drop down\n    Set rng_DropDown = Range(\"rng_WeekSelector\")\n    'The column that contains the formula which indicates if a row should \n    'be hidden c.2000 rows\n    Set rng_HideFormula = Range(\"rng_HideFormula\")\n\n    'Working Code\n    'Exit sub early if the Month Selector was not changed\n    If Not Target.Address = rng_DropDown.Address Then GoTo EExit\n\n    'Otherwise unprotect the worksheet\n    wks_DailyPlanning.Unprotect (str_Password)\n\n    'For each cell in the hide formula column\n    For Each rng_Item In rng_HideFormula\n\n        With rng_Item\n            'If the cell says \"hide\"\n            If .Value2 = str_HideRef Then\n\n                'Hide the row\n                .EntireRow.Hidden = True\n\n            Else\n                'Otherwise show the row\n                .EntireRow.Hidden = False\n\n            End If\n        End With\n    'Cycle through each cell\n    Next rng_Item\n\n    EExit:\n    'Reprotect the sheet if the sheet is unprotected\n    If wks_DailyPlanning.ProtectContents = False Then wks_DailyPlanning.Protect (str_Password)\n\n\n    'Clear Events\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I have looked at some links provided by other users on this website and I think the trouble lies in the fact I'm having to iterate through each row individually.</p>\n\n<p>Is it possible to create something like an array of .visible settings I can apply to the entire range at once?</p>\n"}, {"tags": ["excel", "vba", "loops", "find"], "comments": [{"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1570623668, "post_id": 58303785, "comment_id": 102970243, "body": "If you want to perform a loop where the number of loops depend on a variable (such as the first empty cell), you can use a do-loop in vba: <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/do-loop-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a>"}, {"owner": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "edited": false, "score": 0, "creation_date": 1570625704, "post_id": 58303785, "comment_id": 102971394, "body": "<a href=\"https://stackoverflow.com/questions/30586423/excel-vba-find-text-in-sheet-copy-range-paste-to-other-sheet\">duplicate</a> This is exactly same problem, with accepted answear"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570625318, "post_id": 58304211, "comment_id": 102971160, "body": "Hi SJR, Thank you for the assist, but the code you gave me does no action. The sheets aren&#39;t created and the information is not copied from FULL HISTORY FILE to the newly created sheet."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570625578, "post_id": 58304211, "comment_id": 102971305, "body": "Works for me. Probably the issue is that the text is not found. Perhaps you need <code>Lookat:=xlpart</code> - hard to say without knowing your set up."}, {"owner": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570686432, "post_id": 58304211, "comment_id": 102992458, "body": "Hi SJR, The moment I remove the For i statement and Next i, the code copies to one Sheet &quot;Blasted 0&quot;. I debugged the code and noticed it goes to the For i = 1 statement and then immediately goes to End With. Do you perhaps know why?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570696075, "post_id": 58304211, "comment_id": 102996685, "body": "As alluded to above, it sounds as if your cells do not contain exactly that text and nothing else. I&#39;ve made a couple of amendments so give it another try."}, {"owner": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570698662, "post_id": 58304211, "comment_id": 102998026, "body": "Hi SJR, I found another snag, it does copy the data as I want except for the last event that doesn&#39;t get copied onto a sheet. For example...there are 24 times I find &quot;BLAST DRIVER ON&quot; in the sheet, but it only copies until the 23rd event. Another question is how would I also copy the first found with the rest of the data? Thank you again for putting me in the right direction"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570698903, "post_id": 58304211, "comment_id": 102998164, "body": "Is there data after the last &quot;&quot;BLAST DRIVER ON&quot; that should be copied? I assumed the last cell contained that text."}, {"owner": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570698981, "post_id": 58304211, "comment_id": 102998211, "body": "Yes the last cell after the last BLAST DRIVER ON will END OF HISTORY FILE. I modified the code to include the first found event. So that is fixed."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570699203, "post_id": 58304211, "comment_id": 102998325, "body": "So after the last instance of BLAST DRIVER ON there are some cells with data and then a cell containing END OF HISTORY FILE every time?"}, {"owner": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "edited": false, "score": 0, "creation_date": 1570699238, "post_id": 58304211, "comment_id": 102998342, "body": "Yes that is exactly it"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1570699606, "last_edit_date": 1570699606, "creation_date": 1570624346, "answer_id": 58304211, "question_id": 58303785, "link": "https://stackoverflow.com/questions/58303785/loop-to-find-2-strings-and-copy-to-a-new-sheet/58304211#58304211", "title": "Loop to find 2 strings and copy to a new sheet", "body": "<p>Perhaps this will help. You can use a For-Next loop, as I have here, or a Do loop as suggested by Alex.</p>\n\n<pre><code>Sub x()\n\nDim i As Long, rFind As Range, rFind2 As Range, rFind3 As Range, ws As Worksheet, s As String\n\ns = \"BLAST DRIVER ON\" 'define search term here so only need to change once if needed\n\nWith Sheets(\"Full History File\").Columns(1)\n    Set rFind3 = .Find(What:=\"END HISTORY FILE\", LOokat:=xlPart, MatchCase:=False, SearchFormat:=False)\n    Set rFind = .Cells(Rows.Count, 1)\n    For i = 1 To WorksheetFunction.CountIf(.Cells, \"*\" &amp; s &amp; \"*\")         'cycle through number of times text is found\n        Set rFind = .Find(What:=s, After:=rFind, LookIn:=xlFormulas, _\n                          LOokat:=xlPart, SearchOrder:=xlByRows, _\n                          SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False) 'specify all parameters to be on the safe side\n        If Not rFind Is Nothing Then\n            Set rFind2 = .Find(What:=s, After:=rFind)                     'find next instance\n            Set ws = Worksheets.Add(After:=Sheets(Sheets.Count))          'add new sheet\n            ws.Name = \"Blasted \" &amp; i                                      'name it\n            If i = WorksheetFunction.CountIf(.Cells, \"*\" &amp; s &amp; \"*\") Then\n                Set rFind2 = rFind3.Offset(1)                             'remove .Offset(1) if you don't want \"END OF HISTORY FILE\" copied\n            End If\n            Range(rFind, rFind2.Offset(-1)).Copy ws.Range(\"A1\") 'copy intermediate range\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1570625144, "creation_date": 1570625144, "answer_id": 58304450, "question_id": 58303785, "link": "https://stackoverflow.com/questions/58303785/loop-to-find-2-strings-and-copy-to-a-new-sheet/58304450#58304450", "title": "Loop to find 2 strings and copy to a new sheet", "body": "<p>Not sure if this is exactly what you're looking for, but this is a much simpler version of the loop you've described. It negates the need to find a specific value in a range of cells, and the range between two hits. </p>\n\n<pre><code>Sub BLAST()\nApplication.ScreenUpdating = False\nDim last As Integer, i As Integer, j As Integer, cel As Range\nlast = Sheets(\"Sheet1\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\ni = 0\nj = 2\nFor Each cel In Sheets(\"Sheet1\").Range(\"A1:A\" &amp; last)\n    If cel.Value = \"BLAST\" Then\n        i = i + 1\n        j = 2\n        Sheets.Add After:=Sheets(Sheets.Count)\n        Sheets(Sheets.Count).Name = \"Blasted \" &amp; i\n        Sheets(\"Blasted \" &amp; i).Range(\"A1\") = cel.Value\n    Else\n        Sheets(\"Blasted \" &amp; i).Range(\"A\" &amp; j) = cel.Value\n        j = j + 1\n    End If\nNext cel\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This simply loops through all the cells in your range, and if the criteria is found, the cell value is copied to a new sheet with the name \"Blasted \" + the next number. Then every subsequent cell is copied into the next row on that sheet, until another match is found.</p>\n\n<p>It's a bit basic at the moment but can easily be modified to suit your needs (copy entire row instead of value for example, or end at next blank cell instead of the full used range in A:A)</p>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1570625232, "creation_date": 1570625232, "answer_id": 58304481, "question_id": 58303785, "link": "https://stackoverflow.com/questions/58303785/loop-to-find-2-strings-and-copy-to-a-new-sheet/58304481#58304481", "title": "Loop to find 2 strings and copy to a new sheet", "body": "<p>Here's another example with a slightly different approach. It sets up the range for your source data and just walks straight down until it finds a blank cell. The <code>Find</code> and <code>Copy</code> methods are not used at all, just a simple assignment statement.</p>\n\n<pre><code>Sub CopyBlastedData()\n    Dim copiedBlastedWS As Worksheet\n    Dim copiedBlastedData As Range\n\n    Dim blastedData As Range\n    Set blastedData = ThisWorkbook.Sheets(\"Full History File\").Range(\"A1\")\n    Do While Not IsEmpty(blastedData)\n        If blastedData.Value = \"BLAST DRIVER ON\" Then\n            '--- create a new sheet\n            Set copiedBlastedWS = ThisWorkbook.Sheets.Add\n            Set copiedBlastedData = copiedBlastedWS.Range(\"A1\")\n            copiedBlastedData.Value = blastedData.Value\n        Else\n            copiedBlastedData.Value = blastedData.Value\n        End If\n        Set copiedBlastedData = copiedBlastedData.Offset(1, 0)\n        Set blastedData = blastedData.Offset(1, 0)\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8214471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39cda3ef3097c4dcefc9e0f99cf7e8b?s=128&d=identicon&r=PG&f=1", "display_name": "Hendrik Sidaway", "link": "https://stackoverflow.com/users/8214471/hendrik-sidaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 58304211, "answer_count": 3, "score": 0, "last_activity_date": 1570699606, "creation_date": 1570622772, "last_edit_date": 1592644375, "question_id": 58303785, "link": "https://stackoverflow.com/questions/58303785/loop-to-find-2-strings-and-copy-to-a-new-sheet", "title": "Loop to find 2 strings and copy to a new sheet", "body": "<p>I am really new to VBA and I am experimenting, but got stuck.</p>\n<p>I have a sheet called Full History File with various data in column A.</p>\n<p>I then wrote code to create various sheets called Blasted 1 to Blasted i</p>\n<p>I now want to use code start in cell A1 on Sheet Full History File to find the string 1 &quot;BLAST DRIVER ON&quot; and then the string 2 &quot;BLAST DRIVER ON&quot; and copy all rows between the string 1 and string 2 - 1 row to sheet Blasted 1</p>\n<p>Then it must loop copying the data between String 2 and the next &quot;BLAST DRIVER ON&quot; to sheet Blasted 1 + i</p>\n<p>This must continue until a blank cell is reached.</p>\n<p>I managed to get the code working to copy the first find, but have no idea how to loop it:</p>\n<pre><code>Sub CopyData() \nDim s As Range, e As Range, i As Long \ni = 1 With Sheets(&quot;Full History File&quot;) \nSet r = .Range(&quot;A:A&quot;).Find(&quot;BLAST DRIVER ON&quot;) \nIf Not r Is Nothing Then \nSet e = .Range(&quot;A:A&quot;).Find(&quot;BLAST DRIVER ON&quot;, r) \nIf Not e Is Nothing Then \n.Range(r, e).EntireRow.Cut Sheets(&quot;Blasted 1&quot;).Range(&quot;A1&quot;)\nEnd If \nEnd If \nEnd With \nEnd Sub \n</code></pre>\n<p>Any and all help please!</p>\n<p>If needed here is the code I used to create the sheets that I found using Google:</p>\n<pre><code>Dim cell As Range\nDim b As String\nDim e As String\nDim s As Integer\nSheets(&quot;Blast List&quot;).Select\nb = &quot;A2&quot; \n\ne = Range(b).End(xlDown).Address \n\nFor Each cell In Range(b, e)\ns = Sheets.Count\nSheets.Add After:=Sheets(s)\nSheets(s + 1).Name = cell.Value\nNext cell\n</code></pre>\n<p>Thank you for any and all help</p>\n<blockquote>\n<p>Revision as I think I explained what I need incorrectly:</p>\n<p>What I have in Column A of sheet &quot;FULL HISTORY FILE&quot; is multiple rows that &gt;contains the text &quot;BLAST DRIVER ON&quot; with some other text. I am looking for code &gt;to find the first row (Find 1) and the next row (Find 2) that contains this &gt;text.</p>\n<p>I then want the code to create a sheet called Blasted 1 (as it is the first &gt;instance of the found text) and copy all rows between Find 1 and Find 2 to the &gt;newly created sheet &quot;Blasted 1&quot;</p>\n<p>I then want the code to find the next row after Find 2 containing the text\n(Find 3) and create a sheet called &quot;Blasted 2&quot; (second instance found) and copy &gt;the rows between Find 2 and Find 3 to the newly created sheet.</p>\n<p>I hope this is better understood</p>\n</blockquote>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1570623826, "post_id": 58303229, "comment_id": 102970324, "body": "I think you can find your question in example 2 of this site, but I&#39;m not sure: <a href=\"https://www.rondebruin.nl/win/s2/win003.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s2/win003.htm</a>"}, {"owner": {"reputation": 69, "user_id": 10169933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PhrwCgSeF3E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ojDDgKcbMXoPT9gX8cJGsRnJFJRA/mo/photo.jpg?sz=128", "display_name": "Zahid Khan", "link": "https://stackoverflow.com/users/10169933/zahid-khan"}, "reply_to_user": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1570632751, "post_id": 58303229, "comment_id": 102975595, "body": "Have Tried this <code>Sub FontColorPicker()     Application.CommandBars.ExecuteMso &quot;FontcolorPicker&quot; End Sub </code> But it&#39;s not working"}], "answers": [{"comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 2, "creation_date": 1570983002, "post_id": 58329707, "comment_id": 103081228, "body": "You can often find the name of the control in the Customize Ribbon dialog box.  Locate the control you want to add, hover over it with the mouse and the last bit of the tooltip, (the part in parentheses) will give you the name you need to add to your RibbonX."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 1, "last_activity_date": 1570734930, "last_edit_date": 1592644375, "creation_date": 1570734930, "answer_id": 58329707, "question_id": 58303229, "link": "https://stackoverflow.com/questions/58303229/how-to-add-inbuilt-tool-of-powerpoint-in-custom-ui-editor-customized-tab/58329707#58329707", "title": "How to add inbuilt tool of Powerpoint in Custom UI Editor Customized Tab", "body": "<p>In a ribbon mod, the XML for a built-in gallery looks like this:</p>\n<pre><code>&lt;gallery\n  idMso=&quot;FontColorPicker&quot;\n  showImage=&quot;true&quot;\n  showLabel=&quot;false&quot;/&gt;\n</code></pre>\n<p>To find other idMso identifiers, you need to reference a set of Excel spreadsheets published by Microsoft. Here's the link for the 2016 (also applies to 2019) files: <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=50745\" rel=\"nofollow noreferrer\">Office 2016 Help Files: Office Fluent User Interface Control Identifiers</a></p>\n<p>There is one workbook for PowerPoint. Search the first column.</p>\n"}], "owner": {"reputation": 69, "user_id": 10169933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PhrwCgSeF3E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ojDDgKcbMXoPT9gX8cJGsRnJFJRA/mo/photo.jpg?sz=128", "display_name": "Zahid Khan", "link": "https://stackoverflow.com/users/10169933/zahid-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 58329707, "answer_count": 1, "score": 0, "last_activity_date": 1582782059, "creation_date": 1570620924, "last_edit_date": 1582782059, "question_id": 58303229, "link": "https://stackoverflow.com/questions/58303229/how-to-add-inbuilt-tool-of-powerpoint-in-custom-ui-editor-customized-tab", "title": "How to add inbuilt tool of Powerpoint in Custom UI Editor Customized Tab", "body": "<p>As I was creating customized tab which will help me all the tool I use in single tab with the help of <strong>\"Custom UI\"</strong> in that I can add which i have scripted, but not getting how to add the inbuilt tool of powerpoint for example \"Font Color Picker\" i want to add what should I do.</p>\n\n<p>Below are the script</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n    &lt;ribbon startFromScratch=\"false\"&gt;\n        &lt;tabs&gt;\n            &lt;tab id=\"customTab\" label=\"GEPper\"&gt;\n                &lt;group id=\"TextTools\" label=\"Text Tools\"&gt;\n                    &lt;button id=\"FontSize\" label=\" \" image=\"a4\" size=\"normal\" onAction=\"FontSize\" screentip=\"Font Size 10\" supertip=\" \"/&gt;\n                    &lt;button id=\"FontSize12\" label=\" \" image=\"a3\" size=\"normal\" onAction=\"FontSize12\" screentip=\"Font Size 12\" supertip=\" \"/&gt;\n                    &lt;button id=\"FontSize14\" label=\" \" image=\"a2\" size=\"normal\" onAction=\"FontSize14\" screentip=\"Font Size 14\" supertip=\" \"/&gt;\n                    &lt;button id=\"FontSize16\" label=\" \" image=\"a1\" size=\"normal\" onAction=\"FontSize16\" screentip=\"Font Size 16\" supertip=\" \"/&gt;\n                    &lt;button id=\"FontColorBlack\" label=\" \" image=\"black\" size=\"normal\" onAction=\"FontColorBlack\" screentip=\"Font Color Black\" supertip=\" \"/&gt;\n                    &lt;button id=\"FontColorWhite\" label=\" \" image=\"white\" size=\"normal\" onAction=\"FontColorWhite\" screentip=\"Font Color White\" supertip=\" \"/&gt;\n                    &lt;button id=\"Bullet\" label=\" \" image=\"bullet\" size=\"normal\" onAction=\"Bullet\" screentip=\"Bullet Color Black\" supertip=\" \"/&gt;\n                    &lt;button idMso=\"FontColorPicker\"/&gt;\n                &lt;/group&gt;\n            &lt;/tab&gt;\n        &lt;/tabs&gt;\n    &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>It would be great help if anyone can help me out</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12188093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_b2dWKRHCw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd7e6gLdmkB8V2e5z6WDL0V_htERA/photo.jpg?sz=128", "display_name": "Pieterjan10", "link": "https://stackoverflow.com/users/12188093/pieterjan10"}, "edited": false, "score": 0, "creation_date": 1570629677, "post_id": 58303922, "comment_id": 102973811, "body": "Hello Alex, thanks for your quick reply. Indeed, if I enter objIE.document.getElementsByClassName(&quot;typeahead search-box-input left&quot;)(0).Value = &quot;something&quot; then it works. However, it only works if I previously manually selected this input box. If I did not do this, then nothing happens. Do you know how I should do this automatically?"}, {"owner": {"reputation": 1, "user_id": 12188093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_b2dWKRHCw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd7e6gLdmkB8V2e5z6WDL0V_htERA/photo.jpg?sz=128", "display_name": "Pieterjan10", "link": "https://stackoverflow.com/users/12188093/pieterjan10"}, "edited": false, "score": 0, "creation_date": 1570629838, "post_id": 58303922, "comment_id": 102973890, "body": "And do you also know how I can press &quot;enter&quot; in that input box?"}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "reply_to_user": {"reputation": 1, "user_id": 12188093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_b2dWKRHCw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd7e6gLdmkB8V2e5z6WDL0V_htERA/photo.jpg?sz=128", "display_name": "Pieterjan10", "link": "https://stackoverflow.com/users/12188093/pieterjan10"}, "edited": false, "score": 0, "creation_date": 1570780054, "post_id": 58303922, "comment_id": 103029486, "body": "You can use the SendKeys function: <a href=\"https://www.contextures.com/excelvbasendkeys.html\" rel=\"nofollow noreferrer\">contextures.com/excelvbasendkeys.html</a>"}], "tags": [], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "is_accepted": false, "score": 0, "last_activity_date": 1570623307, "creation_date": 1570623307, "answer_id": 58303922, "question_id": 58303208, "link": "https://stackoverflow.com/questions/58303208/assign-a-value-from-excel-to-a-html-input-box-through-excel-vba/58303922#58303922", "title": "Assign a value from excel to a html input box through excel vba", "body": "<p>The <code>getElementsByClassName</code> method returns an array of all elements with that classname, even if that is only one element. So if you know it is the first and only element with that classname, you can use <code>getElementsByClassName(\"search-widget\")(0).Value</code></p>\n\n<p>Furthermore, you can find the right classname by inspecting the pages html. In chrome, you can do that by right clicking the element and press \"inspect\". The only searchbar I saw on the site has \"typeahead search-box-input left\" as classname by the way.</p>\n"}], "owner": {"reputation": 1, "user_id": 12188093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_b2dWKRHCw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd7e6gLdmkB8V2e5z6WDL0V_htERA/photo.jpg?sz=128", "display_name": "Pieterjan10", "link": "https://stackoverflow.com/users/12188093/pieterjan10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570636093, "creation_date": 1570620831, "last_edit_date": 1570636093, "question_id": 58303208, "link": "https://stackoverflow.com/questions/58303208/assign-a-value-from-excel-to-a-html-input-box-through-excel-vba", "title": "Assign a value from excel to a html input box through excel vba", "body": "<p>I have some ISIN-codes from bonds in an excel sheet (column A). I would like to find the corresponding rating from the site \"<a href=\"https://www.moodys.com\" rel=\"nofollow noreferrer\">https://www.moodys.com</a>\".\nAs this should be done on a regular basis, I would like to automate this process through Excel VBA. \nThe website does not use any ID's so I can't use getElementById.</p>\n\n<p>I tried using through \"getElementsByClassName\", but this does not work. Also I am not sure if the \"search-widget\" is the correct class name.</p>\n\n<p>The Error message is: \"Object doesn't support this property or method (Error 438)\"</p>\n\n<p>Many thanks in advance!\nPieterjan</p>\n\n<p>Sub SearchBot()</p>\n\n<pre><code>Dim objIE As InternetExplorer 'special object variable representing the IE browser\n</code></pre>\n\n<p>Nbr = ThisWorkbook.Sheets(\"Sheet1\").Cells(1, 1).End(xlDown).Row - 1</p>\n\n<p>With Worksheets(\"Sheet1\").Range(Cells(2, 2), Cells(100000, 6))\n    .ClearContents\n End With</p>\n\n<p>For i = 1 To 1 'Nbr</p>\n\n<pre><code>'initiating a new instance of Internet Explorer and asigning it to objIE\nSet objIE = New InternetExplorer\n\n 'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate \"https://www.moodys.com\"\n\n'wait here a few seconds while the browser is busy\nApplication.Wait (Now + TimeValue(\"00:00:04\"))\n'Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\nDo\nDoEvents\nLoop Until objIE.readyState = 4\n</code></pre>\n\n<p>objIE.document.getElementsByClassName(\"search-widget\").Value = Sheets(\"Sheet1\").Range(\"A\" &amp; i + 1).Value</p>\n\n<pre><code>...\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "automation"], "comments": [{"owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "edited": false, "score": 0, "creation_date": 1570620093, "post_id": 58302998, "comment_id": 102968254, "body": "last line of my code is not working."}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1570623436, "post_id": 58302998, "comment_id": 102970117, "body": "Do you get an error when it&#39;s not working? Or does it just not change?"}, {"owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "reply_to_user": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1570627376, "post_id": 58302998, "comment_id": 102972428, "body": "I get the error as - Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "edited": false, "score": 0, "creation_date": 1570635917, "post_id": 58306017, "comment_id": 102977322, "body": "It is not working, but I&#39;m not getting any error now."}, {"owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "edited": false, "score": 0, "creation_date": 1570636140, "post_id": 58306017, "comment_id": 102977437, "body": "While inspecting elements this is the code which I get for Nature of Payment Tab   &lt;select name=&quot;NaturePayment&quot; class=&quot;form-control&quot;&gt;                                      &lt;option selected=&quot;&quot;&gt;Nature of Payment&lt;/option&gt;                                    &lt;option value=&quot;193 - Interest on Securities&quot;&gt;193 - Interest on Securities&lt;/option&gt;                                &lt;option value=&quot;194 - Dividend&quot;&gt;194 - Dividend&lt;/option&gt;                                &lt;option value=&quot;195 - Other sums payable to a non-resident&quot;&gt;195 - Other sums payable to a non-resident&lt;/option&gt;                &lt;/select&gt;"}], "tags": [], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "is_accepted": false, "score": 0, "last_activity_date": 1570629946, "creation_date": 1570629946, "answer_id": 58306017, "question_id": 58302998, "link": "https://stackoverflow.com/questions/58302998/requiring-line-of-code-to-select-nature-of-payment-from-drop-down-list/58306017#58306017", "title": "Requiring line of code to select nature of payment from drop down list", "body": "<p>the <code>getElementsByName</code> method returns an array of elements, even if there is only one element with that name. You have to use <code>getElementsByName(\"NaturePayment\")(0).Value</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "edited": false, "score": 0, "creation_date": 1570705207, "post_id": 58315428, "comment_id": 103001551, "body": "This is working fine, but I have one more select.form-control in the given website by the name of Assessment Year, what should I do for this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1570681423, "creation_date": 1570681423, "answer_id": 58315428, "question_id": 58302998, "link": "https://stackoverflow.com/questions/58302998/requiring-line-of-code-to-select-nature-of-payment-from-drop-down-list/58315428#58315428", "title": "Requiring line of code to select nature of payment from drop down list", "body": "<p>You can use <code>selectedIndex</code> on the <code>select</code> itself then specify index of option of interest in the list under that select. I</p>\n\n<pre><code>ie.document.querySelector(\"select.form-control\").SelectedIndex = 2 '3 or 3 etc....\n</code></pre>\n\n<p>Or </p>\n\n<p>Use <code>.Selected = True</code> on the option element itself e.g.</p>\n\n<pre><code>ie.document.querySelector(\"[value='193 - Interest on Securities']\").Selected = True\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58315428, "answer_count": 2, "score": 0, "last_activity_date": 1570681472, "creation_date": 1570620027, "last_edit_date": 1570681472, "question_id": 58302998, "link": "https://stackoverflow.com/questions/58302998/requiring-line-of-code-to-select-nature-of-payment-from-drop-down-list", "title": "Requiring line of code to select nature of payment from drop down list", "body": "<p><a href=\"https://i.stack.imgur.com/n0rja.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n0rja.png\" alt=\"enter image description here\"></a></p>\n\n<p>I complied the below mentiond code line, but it is not working. I'm not able to figure out how to select nature of payment , the nature of payment tab is marked between arrows in the attached image.</p>\n\n<pre><code>Sub TDS_Autofill()\nDim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate \"https://onlineservices.tin.egov-nsdl.com/etaxnew/tdsnontds.jsp\"\nDo While IE.Busy\nApplication.Wait DateAdd(\"s\", 1, Now)\nLoop\n\nSet doc = IE.document\n\ndoc.parentWindow.execScript \"sendRequest(281)\", \"JavaScript\"\n\nDo While IE.Busy\nApplication.Wait DateAdd(\"s\", 1, Now)\nLoop\n\n\nIf ThisWorkbook.Sheets(\"Challan AutoFill\").Range(\"m2\").Value = \"Company\" \nThen\ndoc.getElementById(\"0020\").Click\nElseIf ThisWorkbook.Sheets(\"Challan AutoFill\").Range(\"m2\").Value = \"Non \nCompany\" Then\ndoc.getElementById(\"0021\").Click\nEnd If\n\n\n\nIf ThisWorkbook.Sheets(\"Challan AutoFill\").Range(\"o2\").Value = \"(200) \nTDS/TCS Payable by Taxpayer\" Then\ndoc.getElementById(\"200\").Click\nElseIf ThisWorkbook.Sheets(\"Challan AutoFill\").Range(\"o2\").Value = \"(400) \nTDS/TCS Regular Assessment\" Then\ndoc.getElementById(\"400\").Click\nEnd If\n\ndoc.getElementsByName(\"NaturePayment\").Value = ThisWorkbook.Sheets(\"Challan \nAutoFill\").Range(\"q2\").Value\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 194, "user_id": 9390758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f7f95c8a370a7e9afb4f728c5a0bcc?s=128&d=identicon&r=PG&f=1", "display_name": "SlappedProgrammer", "link": "https://stackoverflow.com/users/9390758/slappedprogrammer"}, "edited": false, "score": 0, "creation_date": 1570621085, "post_id": 58302870, "comment_id": 102968819, "body": "I believe mkdir is max 260 characters so this could be why it crashes"}, {"owner": {"reputation": 1, "user_id": 12187867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-44jvRGDB9I0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcy1TBySwj-Cqz3fqWVCfnnepIV-g/photo.jpg?sz=128", "display_name": "Nikolozi Gogoladze", "link": "https://stackoverflow.com/users/12187867/nikolozi-gogoladze"}, "reply_to_user": {"reputation": 194, "user_id": 9390758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f7f95c8a370a7e9afb4f728c5a0bcc?s=128&d=identicon&r=PG&f=1", "display_name": "SlappedProgrammer", "link": "https://stackoverflow.com/users/9390758/slappedprogrammer"}, "edited": false, "score": 0, "creation_date": 1570626578, "post_id": 58302870, "comment_id": 102971908, "body": "I don&#39;t think that might be the issue. If the name in mkdir would exceed 260 characters then yes, but here the problem was that after creating 280 folders is snaps (I personally think it has to do something with memory, since excel is a bit weak)"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570631627, "post_id": 58302870, "comment_id": 102974922, "body": "i dont think this is the problem, but put the Dim path As String Dim Folder As String outside the loop."}, {"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1570636269, "post_id": 58302870, "comment_id": 102977513, "body": "You say there is 150k rows in the payment list. Have you checked how many loans there are? You have declared <code>Dim i As Integer</code> which goes to max 32768. Change that to <code>Dim i As Long</code> in any case."}, {"owner": {"reputation": 1, "user_id": 12187867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-44jvRGDB9I0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcy1TBySwj-Cqz3fqWVCfnnepIV-g/photo.jpg?sz=128", "display_name": "Nikolozi Gogoladze", "link": "https://stackoverflow.com/users/12187867/nikolozi-gogoladze"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570691296, "post_id": 58302870, "comment_id": 102994417, "body": "@LuisCurado I tried it, no luck. I checked and it crashes here <code>nwb = workbooks.add</code> I assume it has problem with opening a lot of workbooks (e.g. book1, book2, book3..... book280, etc.)  I think there is some kind of limit there"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570692527, "post_id": 58302870, "comment_id": 102994937, "body": "if they stay open theres a limit set by your memory, but u are closing them. i cant see why is crashing in thar line..."}, {"owner": {"reputation": 1, "user_id": 12187867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-44jvRGDB9I0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcy1TBySwj-Cqz3fqWVCfnnepIV-g/photo.jpg?sz=128", "display_name": "Nikolozi Gogoladze", "link": "https://stackoverflow.com/users/12187867/nikolozi-gogoladze"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570694996, "post_id": 58302870, "comment_id": 102996138, "body": "@LuisCurado I think you had a good feeling about where it crashes. Yes I am closing, but somehow when I open a new workbook it overloads system too much. So I found a solution, an easy fix:  I moved  nw=workbooks.add outside loop and I am creating only one additional workbook and instead of closing, I am clearing it out.   <b>SOLUTION</b>  I moved this before loop  <code>Set nwb = Workbooks.Add Set nsh = nwb.Sheets(1) </code>  and last part of loop, I changed code to this (instead of closing).    ` nsh.Range(&quot;A:AA&quot;).Clear data_sh.AutoFilterMode = False Next i `   It works even faster."}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570695194, "post_id": 58302870, "comment_id": 102996253, "body": "nice. its a good solucion and faster. Excelent!!!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12187867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-44jvRGDB9I0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcy1TBySwj-Cqz3fqWVCfnnepIV-g/photo.jpg?sz=128", "display_name": "Nikolozi Gogoladze", "link": "https://stackoverflow.com/users/12187867/nikolozi-gogoladze"}, "is_accepted": false, "score": 0, "last_activity_date": 1570695819, "creation_date": 1570695819, "answer_id": 58318459, "question_id": 58302870, "link": "https://stackoverflow.com/questions/58302870/how-to-fix-error-access-violation-in-module-ntdll-dll-vba-code-crashes/58318459#58318459", "title": "How to fix Error - &quot;access violation in module &#39;ntdll.dll&#39; &quot;? VBA code crashes", "body": "<p>It turns out that the problem was opening too many new workbooks and closing them. It seemed to overload excel too much. So instead of creating new workbooks in the loop, I created one before it and inside the loop I was clearing it out. The code became so much faster and works great too. </p>\n\n<pre><code>Sub Split_excel_into_folders()Set data_sh = ThisWorkbook.Sheets(\"Data\")\nDim setting_Sh As Worksheet\nSet setting_Sh = ThisWorkbook.Sheets(\"Settings\")\nDim nwb As Workbook\nDim nsh As Worksheet\nSet nwb = Workbooks.Add\nSet nsh = nwb.Sheets(1)\n''''' Get unique loan ids\nsetting_Sh.Range(\"A:A\").Clear\ndata_sh.AutoFilterMode = False\ndata_sh.Range(\"B:C\").Copy setting_Sh.Range(\"A1\")\nsetting_Sh.Range(\"A:B\").RemoveDuplicates 1, xlYes\nDim i As Integer\nFor i = 2 To Application.CountA(setting_Sh.Range(\"A:A\"))\ndata_sh.UsedRange.AutoFilter 2, setting_Sh.Range(\"A\" &amp; i).Valuedata_sh.UsedRange.SpecialCells(xlCellTypeVisible).Copy nsh.Range(\"A1\")\nnsh.UsedRange.EntireColumn.ColumnWidth = 25\nDim path As String\nDim Folder As String\npath = setting_Sh.Range(\"H6\").Value &amp; \"\\\" &amp; setting_Sh.Range(\"B\" &amp; i).Value\nFolder = Dir(path, vbDirectory)\nIf Folder = VBA.vbNullString Then\nVBA.MkDir (path)\nEnd If\nnwb.SaveAs setting_Sh.Range(\"H6\").Value &amp; \"\\\" &amp; setting_Sh.Range(\"B\" &amp; i).Value &amp; \"/\" &amp; setting_Sh.Range(\"A\" &amp; i).Value &amp; \".xlsx\"\nnsh.Range(\"A:AA\").Clear\ndata_sh.AutoFilterMode = False\nNext i\nsetting_Sh.Range(\"A:B\").Clear\nnwb.Close False\nMsgBox \"Done\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12187867, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-44jvRGDB9I0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcy1TBySwj-Cqz3fqWVCfnnepIV-g/photo.jpg?sz=128", "display_name": "Nikolozi Gogoladze", "link": "https://stackoverflow.com/users/12187867/nikolozi-gogoladze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570695819, "creation_date": 1570619580, "last_edit_date": 1570638547, "question_id": 58302870, "link": "https://stackoverflow.com/questions/58302870/how-to-fix-error-access-violation-in-module-ntdll-dll-vba-code-crashes", "title": "How to fix Error - &quot;access violation in module &#39;ntdll.dll&#39; &quot;? VBA code crashes", "body": "<p>I need to split Data of incoming payments by clients and by loans for each client, and save these into different excel files across different folders. Let me explain in detail.</p>\n\n<p>Data description: There is an excel file of around 150k rows, with payments on different loans on various clients. 1 client might have several different loans.</p>\n\n<p>1) Create a folder for each client with the Client ID as a name.\n2) create a separate excel file for each loan and only include filtered payments on that loan. Save this excel file with the name of the loan ID, under the folder of the client's ID. (and yes some folders will have several excel files).</p>\n\n<p>I am new to coding, so after a lot of google and youtube, I came up with the code below. </p>\n\n<ol>\n<li>I have around 12 columns in the DATA sheet. Column B - Loan ID \nColumn C - Client ID</li>\n<li>I copy those two columns in the Settings sheet and remove duplicates on Loan ID - since I need to create separate excel files for each LOAN ID</li>\n<li>Afterward, open a new workbook and copy one-by-one the whole data and create a folder with CLIENT ID as a name. </li>\n</ol>\n\n<p>-</p>\n\n<pre><code>Sub Split_excel_into_folders()\n\n    Set data_sh = ThisWorkbook.Sheets(\"Data\")\n\n    Dim setting_Sh As Worksheet\n    Set setting_Sh = ThisWorkbook.Sheets(\"Settings\")\n\n    Dim nwb As Workbook\n    Dim nsh As Worksheet\n\n    'Get unique loan ids\n    setting_Sh.Range(\"A:B\").Clear\n    data_sh.AutoFilterMode = False\n    data_sh.Range(\"B:C\").Copy setting_Sh.Range(\"A1\")\n    setting_Sh.Range(\"A:B\").RemoveDuplicates 1, xlYes\n\n    Dim i As Integer\n    For i = 2 To Application.CountA(setting_Sh.Range(\"A:A\"))\n        data_sh.UsedRange.AutoFilter 2, setting_Sh.Range(\"A\" &amp; i).Value\n        Set nwb = Workbooks.Add\n        Set nsh = nwb.Sheets(1)\n        data_sh.UsedRange.SpecialCells(xlCellTypeVisible).Copy nsh.Range(\"A1\")\n        nsh.UsedRange.EntireColumn.ColumnWidth = 25\n        Dim path As String\n        Dim Folder As String\n        path = setting_Sh.Range(\"H6\").Value &amp; \"\\\" &amp; setting_Sh.Range(\"B\" &amp; i).Value\n        Folder = Dir(path, vbDirectory)\n        If Folder = VBA.vbNullString Then\n            VBA.MkDir (path)\n        End If\n        nwb.SaveAs setting_Sh.Range(\"H6\").Value &amp; \"\\\" &amp; setting_Sh.Range(\"B\" &amp; i).Value &amp; \"/\" &amp; setting_Sh.Range(\"A\" &amp; i).Value &amp; \".xlsx\"\n        nwb.Close False\n        data_sh.AutoFilterMode = False\n    Next i\n\n    setting_Sh.Range(\"A:A\").Clear\n    MsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>The code actually works wonders, but only on small data. It starts creating folders and saves excels as well, but crashes after creating around 283 folders. with the error:</p>\n\n<blockquote>\n  <p>\"Access violation at address 00007FFE7E3EBE6B in module 'ntdll.dll'. write of address 0000000000000024.\"  </p>\n</blockquote>\n\n<p>I've tested multiple times, sometimes it crashes because of not enough memory. I am guessing I need to optimize it a little bit so it eats up a little fewer resources. Can you help me, please? </p>\n\n<p>P.S</p>\n\n<p>I think it crashes on the line - <code>Set nwb = workbooks.add</code></p>\n"}, {"tags": ["excel", "vba", "module"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1570619444, "post_id": 58302795, "comment_id": 102967905, "body": "If you declare variables inside a procedure they are only available to that procedure. Read up on variable scope."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1570619727, "post_id": 58302795, "comment_id": 102968053, "body": "<code>Option Explicit</code> could also require a variable to be declared in a procedure"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1570619810, "post_id": 58302795, "comment_id": 102968108, "body": "If variables from <code>CPC_Click</code> are declared in <code>fleVarDec</code> I totally agree with @SJR .If it is not that, maybe <code>Call fVarDec.fleVarDec</code> will help."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 1, "creation_date": 1570620758, "post_id": 58302795, "comment_id": 102968631, "body": "Also, if you are running from a module, <code>Cells(1,2)</code> needs to be qualified with a workbook and worksheet otherwise it will be whatever sheet happens to be active, i.e. <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Cells(1,2)</code>"}], "owner": {"reputation": 139, "user_id": 3641311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41765b97421d3c719a1277723bdc6f0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3641311", "link": "https://stackoverflow.com/users/3641311/user3641311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571848640, "creation_date": 1570619274, "last_edit_date": 1571848640, "question_id": 58302795, "link": "https://stackoverflow.com/questions/58302795/variable-not-declared-call-sub-from-another-modules", "title": "Variable not declared, call sub from another modules", "body": "<p>I'm trying to code in Excel VBA some routines, which I'd like to separate in different modules.</p>\n\n<p>My code is the following one:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CPC_Click()\n\n    Call fleVarDec\n\n    Call fleRView\n\n    Cells(1, 2) = Rp.Project.Name 'line error\n</code></pre>\n\n<p>fleVarDec is defined in fVarDec module; fleRView is defined in fRView.</p>\n\n<p>I'm defining my modules in the following way:</p>\n\n<pre><code>Sub fleVarDec()\n\n...\n\nEnd Sub\n</code></pre>\n\n<p>However, when I run my code it gives me the following error:</p>\n\n<blockquote>\n  <p>'Variable not declared'.</p>\n</blockquote>\n\n<p>But my variables are defined in fleVarDec module.</p>\n\n<p>Any help please?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6751, "user_id": 3233388, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ad2d4deac3458258ad6d62a6b6f350?s=128&d=identicon&r=PG&f=1", "display_name": "Adelin", "link": "https://stackoverflow.com/users/3233388/adelin"}, "edited": false, "score": 0, "creation_date": 1570620031, "post_id": 58302543, "comment_id": 102968221, "body": "i&#39;m here because of tag <a href=\"https://stackoverflow.com/questions/tagged/leanft\">leanft</a> but doesn&#39;t seem related. why did you include that tag?"}, {"owner": {"reputation": 74, "user_id": 2640987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t6AyA.jpg?s=128&g=1", "display_name": "Sandeep jaju", "link": "https://stackoverflow.com/users/2640987/sandeep-jaju"}, "edited": false, "score": 0, "creation_date": 1570620278, "post_id": 58302543, "comment_id": 102968365, "body": "Try deleting blank rows in the sheet. Select all rows below 4 rows rt click and delete."}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 11952694, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-944yPmLgXDA/AAAAAAAAAAI/AAAAAAAAAXE/PqIr5_3XYvk/photo.jpg?sz=128", "display_name": "Rik", "link": "https://stackoverflow.com/users/11952694/rik"}, "is_accepted": false, "score": 0, "last_activity_date": 1570628111, "creation_date": 1570628111, "answer_id": 58305442, "question_id": 58302543, "link": "https://stackoverflow.com/questions/58302543/why-does-row-count-return-more-than-the-number-of-rows-with-data/58305442#58305442", "title": "Why does row count return more than the number of rows with data?", "body": "<p>Delete the rows after the 4\u00ba.</p>\n\n<p>U can lock the script to run the iteration u wanna or just run one.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UpyrI.png\" rel=\"nofollow noreferrer\">Settings</a></p>\n"}, {"tags": [], "owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "is_accepted": false, "score": 0, "last_activity_date": 1570729736, "creation_date": 1570729736, "answer_id": 58328508, "question_id": 58302543, "link": "https://stackoverflow.com/questions/58302543/why-does-row-count-return-more-than-the-number-of-rows-with-data/58328508#58328508", "title": "Why does row count return more than the number of rows with data?", "body": "<p>Use <code>UsedRange</code>:</p>\n\n<pre><code>iteration = datatable.GetSheet(3).UsedRange.Rows.Count\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12187846, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDlajIFOJ8ZU4bxLNNtC9j04gyGGVdnCoHxlH5o7g=k-s128", "display_name": "Mrigaja Shelke", "link": "https://stackoverflow.com/users/12187846/mrigaja-shelke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574136879, "creation_date": 1570618394, "last_edit_date": 1574136879, "question_id": 58302543, "link": "https://stackoverflow.com/questions/58302543/why-does-row-count-return-more-than-the-number-of-rows-with-data", "title": "Why does row count return more than the number of rows with data?", "body": "<p>I have added a new sheet and imported Excel data in that sheet.</p>\n\n<pre><code>iteration=datatable.GetSheet(3).GetRowCount\n</code></pre>\n\n<p>There are four rows in my sheet. The script is running continuously after the 4th iteration taking blank data.</p>\n\n<p>When I displayed total count writing as <code>msgbox iteration</code>, it is showing 999 rows</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1570618932, "post_id": 58302302, "comment_id": 102967666, "body": "You do not reset <code>Row</code> variable before the second loop, so it is never executed, add <code>Row = 2</code> before second <code>Do While</code>."}, {"owner": {"reputation": 21, "user_id": 12187675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbe4ca3a8a550e46be9627f2defe20d?s=128&d=identicon&r=PG&f=1", "display_name": "Kestrel Aviation", "link": "https://stackoverflow.com/users/12187675/kestrel-aviation"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1570623677, "post_id": 58302302, "comment_id": 102970250, "body": "There seems to be no loop? Only one coordinate is between the coordinates tags. &lt;coordinates&gt;121.4617,-30.78944&lt;/coordinates&gt;  The generated KML file should be something like,  &lt;coordinates&gt; 121.46166666667,-30.7894444444391,0 128.883333333302,-31.7166666666744,0 121.46166666667,-30.7894444444391,0 &lt;/coordinates&gt;"}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1570624686, "post_id": 58302302, "comment_id": 102970787, "body": "The loop goes over the <code>&lt;placemark&gt;</code> tag. So for each row it should create the entire <code>&lt;placemark&gt;</code> node."}, {"owner": {"reputation": 21, "user_id": 12187675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbe4ca3a8a550e46be9627f2defe20d?s=128&d=identicon&r=PG&f=1", "display_name": "Kestrel Aviation", "link": "https://stackoverflow.com/users/12187675/kestrel-aviation"}, "edited": false, "score": 0, "creation_date": 1570627056, "post_id": 58302302, "comment_id": 102972219, "body": "Thanks Alex, but I don&#39;t understand what I need to change in the code. Sorry for being new to this but I still have trouble with syntax and order of code."}, {"owner": {"reputation": 21, "user_id": 12187675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbe4ca3a8a550e46be9627f2defe20d?s=128&d=identicon&r=PG&f=1", "display_name": "Kestrel Aviation", "link": "https://stackoverflow.com/users/12187675/kestrel-aviation"}, "edited": false, "score": 0, "creation_date": 1570742519, "post_id": 58302302, "comment_id": 103020322, "body": "What needs to be changed in the second loop to return only &lt;Stringline&gt; . It should be something like this which includes &lt;Placemark&gt; as an opening statement. &lt;Placemark&gt; &lt;name&gt;Flight plan&lt;/name&gt;  &lt;description&gt;Flight plan from Charter Enquiry&lt;/description&gt;  &lt;styleUrl&gt;#yellowLine&lt;/styleUrl&gt;&lt;LineString&gt;         &lt;extrude&gt;0&lt;/extrude&gt; &lt;tessellate&gt;1&lt;/tessellate&gt;&lt;altitudeMode&gt;clampToGround&lt;/altit&zwnj;&#8203;udeMode&gt; &lt;coordinates&gt;           121.461666,-30.7894491,0           128.883302,-31.7166744,0           121.4616667,-30.789491,0         &lt;/coordinates&gt;       &lt;/LineString&gt;     &lt;/Placemark&gt;"}], "owner": {"reputation": 21, "user_id": 12187675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbe4ca3a8a550e46be9627f2defe20d?s=128&d=identicon&r=PG&f=1", "display_name": "Kestrel Aviation", "link": "https://stackoverflow.com/users/12187675/kestrel-aviation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1570617595, "creation_date": 1570617595, "question_id": 58302302, "link": "https://stackoverflow.com/questions/58302302/adding-google-earth-linestrings-to-existing-code", "title": "Adding Google Earth linestrings to existing code", "body": "<p>Whilst fairly proficient with Excel, VBA makes my head spin. Please be patient with the newbies.</p>\n\n<p>I have some existing code which parses data from an Excel spreadsheet and creates a KML file which plots placemarks on Google Earth. I would like to add linestrings joining these placemarks.</p>\n\n<p>The code included a Public Function CreatePlacemark which I copied and created Public Function CreateLineString.\nI then modified the existing Public Sub CreateKML() and tried to add the code to create the Linestring's.</p>\n\n<pre><code>    Public Function CreatePlacemark(PlaceName As String, Description As String, Longitude As Double, Latitude As Double) As String\n  Dim Xml As String\n  Xml = \"\"\n  Xml = Xml &amp; \"  &lt;Placemark&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;description&gt;{DESCRIPTION}&lt;/description&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;name&gt;{PLACE_NAME}&lt;/name&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;View&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;longitude&gt;{LONGITUDE}&lt;/longitude&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;latitude&gt;{LATITUDE}&lt;/latitude&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;range&gt;{RANGE}&lt;/range&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;tilt&gt;{TILT}&lt;/tilt&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;heading&gt;{HEADING}&lt;/heading&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;/View&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;visibility&gt;1&lt;/visibility&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;styleUrl&gt;root://styleMaps#default?iconId=0x307&lt;/styleUrl&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;Style&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;icon&gt;&lt;/icon&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;/Style&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;Point&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;coordinates&gt;{LONGITUDE},{LATITUDE}&lt;/coordinates&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;/Point&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"  &lt;/Placemark&gt;\" &amp; vbCrLf\n  Xml = Replace(Xml, \"{PLACE_NAME}\", CleanString(PlaceName))\n  Xml = Replace(Xml, \"{DESCRIPTION}\", CleanString(Description))\n  Xml = Replace(Xml, \"{LONGITUDE}\", Longitude)\n  Xml = Replace(Xml, \"{LATITUDE}\", Latitude)\n  Xml = Replace(Xml, \"{RANGE}\", 141.4)\n  Xml = Replace(Xml, \"{TILT}\", 0)\n  Xml = Replace(Xml, \"{HEADING}\", 0)\n  CreatePlacemark = Xml\nEnd Function\nPublic Function CreateLineString(PlaceName As String, Description As String, Longitude As Double, Latitude As Double) As String\n  Dim Xml As String\n  Xml = \"\"\n  Xml = Xml &amp; \"  &lt;Placemark&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;description&gt;{DESCRIPTION}&lt;/description&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;name&gt;{PLACE_NAME}&lt;/name&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;styleUrl&gt;#yellowLine&lt;/styleUrl&gt;\"\n  Xml = Xml &amp; \"    &lt;LineString&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;extrude&gt;0&lt;/extrude&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;tessellate&gt;1&lt;/tessellate&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"      &lt;coordinates&gt;{LONGITUDE},{LATITUDE}&lt;/coordinates&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"    &lt;/LineString&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"  &lt;/Placemark&gt;\" &amp; vbCrLf\n  Xml = Replace(Xml, \"{PLACE_NAME}\", CleanString(PlaceName))\n  Xml = Replace(Xml, \"{DESCRIPTION}\", CleanString(Description))\n  Xml = Replace(Xml, \"{LONGITUDE}\", Longitude)\n  Xml = Replace(Xml, \"{LATITUDE}\", Latitude)\n  Xml = Replace(Xml, \"{RANGE}\", 141.4)\n  Xml = Replace(Xml, \"{TILT}\", 0)\n  Xml = Replace(Xml, \"{HEADING}\", 0)\n  CreateLineString = Xml\nEnd Function\nPublic Sub CreateKML()\n  Dim OutputPath As String, Filename As String\n  Dim KMLName As String\n  Dim PlaceName As String, Description As String\n  Dim LineString As String\n  Dim Longitude As Double, Latitude As Double\n  Dim Xml As String\n  Dim Sht As Excel.Worksheet\n  Dim Rng As Excel.Range\n  Dim Row As Long\n  Dim Arr As Variant\n  Dim f As Long\n  Set Sht = ThisWorkbook.Worksheets(\"KML\")\n  Set Rng = Sht.Range(\"CoordData\")\n  OutputPath = Sht.Range(\"OutputPath\").Value\n  KMLName = Sht.Range(\"KMLName\").Value\n  Arr = Rng.Value\n  Row = 2\n  Xml = \"\"\n  Xml = Xml &amp; \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"&lt;Folder&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"  &lt;name&gt;{FOLDER_NAME}&lt;/name&gt;\" &amp; vbCrLf\n  Xml = Xml &amp; \"  &lt;open&gt;1&lt;/open&gt;\" &amp; vbCrLf\n  Xml = Replace(Xml, \"{FOLDER_NAME}\", KMLName)\n  Do While Arr(Row, 1) &lt;&gt; \"\"\n    PlaceName = Arr(Row, 1)\n    Description = \"\"\n    Latitude = Arr(Row, 2)\n    Longitude = Arr(Row, 3)\n    Xml = Xml &amp; CreatePlacemark(PlaceName, Description, Longitude, Latitude)\n    Row = Row + 1\n  Loop\n\n  Do While Arr(Row, 1) &lt;&gt; \"\"\n    PlaceName = Arr(Row, 1)\n    Description = \"\"\n    Latitude = Arr(Row, 2)\n    Longitude = Arr(Row, 3)\n  Xml = Xml &amp; CreateLineString(PlaceName, Description, Longitude, Latitude)\n    Row = Row + 1\n  Loop\n\n\n\n  Xml = Xml &amp; \"&lt;/Folder&gt;\" &amp; vbCrLf\n  Filename = OutputPath &amp; \"\\\" &amp; KMLName &amp; \".kml\"\n  On Error Resume Next\n  Kill Filename\n  On Error GoTo 0\n  f = FreeFile\n  Open Filename For Binary As #f\n  Put #f, , Xml\n  Close #f\n  LaunchAssociatedFile Filename\nEnd Sub\n</code></pre>\n\n<p>The code runs without any errors but only displays Placemarks but no LineStrings.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1570618732, "post_id": 58301992, "comment_id": 102967566, "body": "Hey Xabier, this worked. I just had to copy and paste. Appreciate it :)"}, {"owner": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1570689692, "post_id": 58301992, "comment_id": 102993754, "body": "What should I change in the code so that I can check for changes in an series of cells. Above only B2 was considered. if I were to check for say changes B2-B26 to trigger the macro what should be the change? I changed the range B2-B26 but that didnt work."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1570691942, "post_id": 58301992, "comment_id": 102994707, "body": "@Seb12345 I&#39;ve updated my answer to reflect your comments, hope it helps! :)"}, {"owner": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1570695859, "post_id": 58301992, "comment_id": 102996568, "body": "Monitored remains the same ? No need to declare it as an array ? You are essentially saying replace B2 with B2:B26 right?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1570697627, "post_id": 58301992, "comment_id": 102997495, "body": "@Seb12345 sorry you are right, I&#39;ve now updated it to look at an Array, hope it works as you expect it to. :)"}, {"owner": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1571032388, "post_id": 58301992, "comment_id": 103091075, "body": "It&#39;s not showing any line in particular. Just Runtime Error 9: Subscript out of range. I have put my latest code in the edited question, though for some reason I am not able to format it as a code."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1571039213, "post_id": 58301992, "comment_id": 103093810, "body": "@Seb12345 I&#39;ve now updated my answer slightly, I&#39;ve tested this and it should work for you too. :)"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "edited": false, "score": 0, "creation_date": 1571125701, "post_id": 58301992, "comment_id": 103126095, "body": "@Seb12345 no worries, glad we got there in the end... :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1571039184, "last_edit_date": 1571039184, "creation_date": 1570616449, "answer_id": 58301992, "question_id": 58301623, "link": "https://stackoverflow.com/questions/58301623/unable-to-activate-macro-when-active-cell-changes-through-formula/58301992#58301992", "title": "Unable to Activate Macro when Active Cell Changes Through formula", "body": "<p>Probably the easiest fix would be to place the Worksheet_Change event under the cells that generate the value on your cell B2, as changes in formula values don't trigger the Change event... or you can change it to Worksheet_Calculate event instead, this will pick up changes in formula results as below:</p>\n\n<pre><code>Option Explicit\n 'Create variable to hold values\nDim Monitored\n\nSub Advanced_Filtering()\n    Range(\"A7:G730\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range(\"A1:G2\"), CopyToRange:=Sheets(\"Sheet3\").Range(\"L1:R1\")\nEnd Sub\n\nPrivate Sub Worksheet_Activate()\n    Monitored = Range(\"B2\").Value 'Read in value prior to any changes\nEnd Sub\n\nPrivate Sub Worksheet_Calculate()\n    Dim Xrg As Range\n    Set Xrg = Range(\"B2\")\n\n    If Not Intersect(Xrg, Range(\"B2\")) Is Nothing Then\n        Application.EnableEvents = False\n         'Compare monitored cell with initial value\n        If Range(\"B2\").Value &lt;&gt; Monitored Then\n             'Do things as a result of a change\n           Call Advanced_Filtering\n             'Reset Variable with new monitored value\n            Monitored = Range(\"B2\").Value\n        End If\n         'Reset events\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>To use a Range of cells instead of a single one, you should change the following:</p>\n\n<pre><code>Option Explicit\n 'Create variable to hold values\nDim Monitored()\n\nSub Advanced_Filtering()\n    Range(\"A7:G730\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range(\"A1:G2\"), CopyToRange:=Sheets(\"Sheet3\").Range(\"L1:R1\")\nEnd Sub\n\nPrivate Sub Worksheet_Activate()\n    Monitored = Range(\"B2:C2\").Value 'Read in value prior to any changes\nEnd Sub\n\nPrivate Sub Worksheet_Calculate()\n    Dim Xrg As Range, c As Range, x As Integer\n    Set Xrg = Range(\"B2:C2\")\n\n    If Not Intersect(Xrg, Range(\"B2:C2\")) Is Nothing Then\n        Application.EnableEvents = False\n         'Compare monitored cell with initial value\n        x = 1\n        For Each c In Range(\"B2:C2\")\n            If c.Value &lt;&gt; Monitored(1, x) Then\n                Call Advanced_Filtering\n                Monitored(1, x) = c.Value\n            End If\n            x = x + 1\n        Next c\n         'Reset events\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12187509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9105cb051758a3a8a83adf7429427cc8?s=128&d=identicon&r=PG&f=1", "display_name": "Seb12345", "link": "https://stackoverflow.com/users/12187509/seb12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58301992, "answer_count": 1, "score": 0, "last_activity_date": 1571039184, "creation_date": 1570615151, "last_edit_date": 1571037235, "question_id": 58301623, "link": "https://stackoverflow.com/questions/58301623/unable-to-activate-macro-when-active-cell-changes-through-formula", "title": "Unable to Activate Macro when Active Cell Changes Through formula", "body": "<p>My aim is to trigger the advanced filter macro when cell B2 changes (a part of the filtering criteria). B2 is linked to another cell(in another worksheet) which dynamically gets data from external sources. The problem I am facing is that the macro does not activate automatically. Only when I manually change something in B2 is the macro activated. Otherwise the old criteria remains in place. A1 to G1 has the 7 categories and A2-G2 has the inputs for the filter. Only B2 changes effectively. I have not coded in VBA before so most of this code is copied from websites and modified for my workbook. Below is my code. Appreciate any help on this. </p>\n\n<pre><code>Option Explicit\n 'Create variable to hold values\nDim Monitored()\nSub Advanced_Filtering()\n    Range(\"A7:G730\").AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range(\"A1:G2\"), CopyToRange:=Sheets(\"Sheet3\").Range(\"L1:R1\")\nEnd Sub\nPrivate Sub Worksheet_Activate()\n    Monitored = Range(\"B2:C2\").Value 'Read in value prior to any changes\nEnd Sub\nPrivate Sub Worksheet_Calculate()\n    Dim Xrg As Range, c As Range, x As Integer\n    Set Xrg = Range(\"B2:C2\")\n    If Not Intersect(Xrg, Range(\"B2:C2\")) Is Nothing Then\n        Application.EnableEvents = False\n         'Compare monitored cell with initial value\n        x = 1\n        For Each c In Range(\"B2:C2\")\n            If c.Value &lt;&gt; Monitored(x, 1) Then\n                Call Advanced_Filtering\n                Monitored(x, 1) = c.Value\n            End If\n            x = x + 1\n        Next c\n         'Reset events\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "cell"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1570614704, "post_id": 58301259, "comment_id": 102965484, "body": "I&#39;m having some trouble determining what the issue is here. Is there <code>ACCT:ACCT:ACCT:Zeer Dringend</code> in cell(6,3), and you need that trimmed down? If not, can you edit your question with your full code so we can determine where the issue lies?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1570615109, "post_id": 58301259, "comment_id": 102965719, "body": "This code gives the expected output <code>&quot;Een nieuwe retour zending registratie werd aangemaakt met urgentie: &quot; &amp; ws.Cells(6, 3).Value &amp; &quot;.&quot; &amp; vbNewLine &amp; vbNewLine &amp; &quot;Het pakket nummer is &quot; &amp; ws.Cells(22, 3).Value &amp; &quot;.&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 12187248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb381b34cd08ecbc553e8a47a2d1c0ec?s=128&d=identicon&r=PG&f=1", "display_name": "user12187248", "link": "https://stackoverflow.com/users/12187248/user12187248"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1570624343, "post_id": 58301259, "comment_id": 102970592, "body": "Thanks for the feedback, I&#39;ve updated the question with the full code, I hope it is clear now"}], "answers": [{"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1570696574, "creation_date": 1570696574, "answer_id": 58318693, "question_id": 58301259, "link": "https://stackoverflow.com/questions/58301259/include-cell-value-in-email-body-code-fix/58318693#58318693", "title": "Include cell value in email body - code fix", "body": "<p>The code you provided seems to work as expected, you should attempt to investigate where the <code>ACCT:ACCT:ACCT:</code> string is actually coming from, maybe the following helps, where I've changed the ActiveWorkbook to ThisWorkbook to eliminate the possibility of the code picking up data from a workbook that might be active, but not necessarily the intended one:</p>\n\n<pre><code>Sub Send_Email()\nDim OutApp As Object\nDim OutMail As Object\nDim strbody As String\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Ingave\")\n'make sure that we are looking at the this workbook and not the Active one.\n\nIf ThisWorkbook.Path &lt;&gt; \"\" Then\n'make sure the workbook has been saved, so we get a Path property.\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    strbody = \"&lt;font size=\"\"3\"\" face=\"\"Calibri\"\"&gt;\" &amp; _\n    \"Beste Collega,&lt;br&gt;&lt;br&gt;\" &amp; _\n    \"Een nieuwe retour zending registratie werd aangemaakt met urgentie: &lt;B&gt;\" &amp; ws.Cells(6, 3).Value &amp; \"&lt;/B&gt;.&lt;br&gt;\" &amp; _\n    \"Het pakket nummer is &lt;B&gt;\" &amp; ws.Cells(22, 3).Value &amp; \"&lt;/B&gt;.&lt;br&gt;&lt;B&gt; \" &amp; _\n    \"&lt;/B&gt;&lt;br&gt;&lt;br&gt;In geval van vragen gelieve contact op te nemen.\" &amp; _\n    \"&lt;br&gt;&lt;br&gt; Met vriendelijke groeten, &lt;/font&gt;\"\n    'On Error Resume Next\n\n    With OutMail\n        .to = \"xxx@yyy\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Nieuwe registratie retour pakket \"\n        .HTMLBody = strbody\n        .Display   'or use .Send\n    End With\n    'On Error GoTo 0\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nElse\n    MsgBox \"U moet de file eerst opslaan voor u verder kan gaan.\"\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12187248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb381b34cd08ecbc553e8a47a2d1c0ec?s=128&d=identicon&r=PG&f=1", "display_name": "user12187248", "link": "https://stackoverflow.com/users/12187248/user12187248"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570696574, "creation_date": 1570614007, "last_edit_date": 1570651015, "question_id": 58301259, "link": "https://stackoverflow.com/questions/58301259/include-cell-value-in-email-body-code-fix", "title": "Include cell value in email body - code fix", "body": "<p>My code is sending an e-mail through outlook.<br>\nI want the value of two cells included in the e-mail body.<br>\nFormatting of the e-mail is working fine and the text is properly shown. \nAlso the cell value is shown properly in one of two cases. For one part of the code, it is adding <code>ACCT:ACCT:ACCT:</code>  in front of the cell value. \nAny help on how I can get this fixed?</p>\n\n<p>The cell value for cell (6,3) = Zeer Dringend<br>\nThe cell value for cell (22,3) = 2019-0004</p>\n\n<p>This is the e-mail body generated by the code </p>\n\n<p>Beste Collega,</p>\n\n<p>Een nieuwe retour zending registratie werd aangemaakt met urgentie: <strong>ACCT:ACCT:ACCT:Zeer Dringend</strong>.</p>\n\n<p>Het pakket nummer is <strong>2019-0004</strong>.</p>\n\n<p>In geval van vragen gelieve contact op te nemen.</p>\n\n<p>Met vriendelijke groeten, </p>\n\n<p>So where it shows   <strong>ACCT:ACCT:ACCT:Zeer Dringend</strong>, it should say <strong>Zeer Dringend</strong></p>\n\n<p>This is the full code</p>\n\n<pre><code>Dim OutApp As Object\nDim OutMail As Object\nDim strbody As String\nDim WS As Worksheet\n\nIf ActiveWorkbook.Path &lt;&gt; \"\" Then\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\nSet WS = Sheets(\"Ingave\")\n\nstrbody = \"&lt;font size=\"\"3\"\" face=\"\"Calibri\"\"&gt;\" &amp; _\n\"Beste Collega,&lt;br&gt;&lt;br&gt;\" &amp; _\n\"Een nieuwe retour zending registratie werd aangemaakt met urgentie: &lt;B&gt;\" &amp; WS.Cells(6, 3).Value &amp; \"&lt;/B&gt;.&lt;br&gt;\" &amp; _\n\"Het pakket nummer is &lt;B&gt;\" &amp; WS.Cells(22, 3).Value &amp; \"&lt;/B&gt;.&lt;br&gt;&lt;B&gt; \" &amp; _\n\"&lt;/B&gt;&lt;br&gt;&lt;br&gt;In geval van vragen gelieve contact op te nemen.\" &amp; _\n\"&lt;br&gt;&lt;br&gt; Met vriendelijke groeten, &lt;/font&gt;\"\nOn Error Resume Next\n\nWith OutMail\n.to = \"xxx@yyy\"\n.CC = \"\"\n.BCC = \"\"\n.Subject = \"Nieuwe registratie retour pakket \"\n.HTMLBody = strbody\n.Display   'or use .Send\nEnd With\nOn Error GoTo 0\nSet OutMail = Nothing\nSet OutApp = Nothing\nElse\nMsgBox \"U moet de file eerst opslaan voor u verder kan gaan.\"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570614490, "post_id": 58301096, "comment_id": 102965359, "body": "When asking a question like this it&#39;s very important to explain HOW something &quot;doesn&#39;t work&quot;. That&#39;s missing in this question. To go back and add information to a question, use the <a href=\"https://stackoverflow.com/posts/58301096/edit\">edit</a> link below it."}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "is_accepted": true, "score": 0, "last_activity_date": 1570614413, "last_edit_date": 1570614413, "creation_date": 1570613886, "answer_id": 58301230, "question_id": 58301096, "link": "https://stackoverflow.com/questions/58301096/macro-to-fill-new-added-column-with-vlookup-formula/58301230#58301230", "title": "Macro to Fill new added column with vlookup formula", "body": "<p>The problem is in your language settings. If you write your formula in a worksheet you use \";\" to separate the variables. In Vba you have to use \",\" so your formula would be:\n<code>\"=VLOOKUP(C2,'Output'!$A:$B,2,FALSE)\"</code></p>\n"}], "owner": {"reputation": 37, "user_id": 12187275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59c8322aae0c3f8bc8400596ff565c8?s=128&d=identicon&r=PG&f=1", "display_name": "G_TTI", "link": "https://stackoverflow.com/users/12187275/g-tti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 58301230, "answer_count": 1, "score": 0, "last_activity_date": 1570614413, "creation_date": 1570613445, "last_edit_date": 1570614405, "question_id": 58301096, "link": "https://stackoverflow.com/questions/58301096/macro-to-fill-new-added-column-with-vlookup-formula", "title": "Macro to Fill new added column with vlookup formula", "body": "<p>The macro accesses the last sheet in the workbook (always the same format) and adds a column D, with a header. Until here all is well; the final step is where I get issues. </p>\n\n<p>I want the new column filled with the formula: </p>\n\n<pre><code>=VLOOKUP(C2;'Output'!$A:$B;2;FALSE). \n</code></pre>\n\n<p>Note that the current sheet is different from where the formula looks (sheet <code>Output</code>).</p>\n\n<p>I have tried various codes that I found here and there... but I cannot manage to make it work correctly right. </p>\n\n<p>Here how my code looks currently:</p>\n\n<pre><code>Sub ColumnInsert()\n\nDim rws As Long\nrws = Cells(Rows.Count, \"D\").End(xlUp).Row\n\n  Sheets(Sheets.Count).Select\n\n  Range(\"D:D\").EntireColumn.Insert\n\n  Range(\"D1\").Value = \"BOX Number\"\n\n  Range(\"D2:D\" &amp; rws).Formula = \"=VLOOKUP(C2;'Output'!$A:$B;2;FALSE)\"\n\nEnd Sub\n</code></pre>\n\n<p>the last row of code is what does not work... could you please help me?</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2013"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1570612230, "post_id": 58300617, "comment_id": 102964074, "body": "Yes, check <a href=\"https://support.office.com/en-us/article/search-searchb-functions-9ab04538-0e55-4719-a72e-b6f54513b495?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">SEARCH</a> and combine it with an IF to get a number in B, and then sort it."}, {"owner": {"reputation": 41, "user_id": 7329107, "user_type": "registered", "profile_image": "https://graph.facebook.com/1288173361228518/picture?type=large", "display_name": "Ahmed Badreldin Amado", "link": "https://stackoverflow.com/users/7329107/ahmed-badreldin-amado"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1570612326, "post_id": 58300617, "comment_id": 102964132, "body": "I don&#39;t want to sort depends on B I want to sort depend on A contains the word SERVER"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1570612659, "post_id": 58300617, "comment_id": 102964309, "body": "To sort it as you want, you&#39;ll need an auxiliary column. I said B, but it could be anywhere. Based only in column A is not possible even with VBA, because you would need a complex macro that order all ranges copying and moving rows according to a value. Your best option is, indeed, the auxiliary/helper column."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7329107, "user_type": "registered", "profile_image": "https://graph.facebook.com/1288173361228518/picture?type=large", "display_name": "Ahmed Badreldin Amado", "link": "https://stackoverflow.com/users/7329107/ahmed-badreldin-amado"}, "edited": false, "score": 0, "creation_date": 1570613613, "post_id": 58300948, "comment_id": 102964857, "body": "it worked just fine  Just replacing every &quot;;&quot; with &#39;,&#39; Thanx man that was really very helpfull"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1570614434, "post_id": 58300948, "comment_id": 102965330, "body": "This is exactly what I said in the comments. An Auxiliary column with a formula with SEARCH and IF combined. Upvoted."}], "tags": [], "owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "is_accepted": true, "score": 3, "last_activity_date": 1570612960, "creation_date": 1570612960, "answer_id": 58300948, "question_id": 58300617, "link": "https://stackoverflow.com/questions/58300617/is-there-a-way-to-sort-data-depends-on-a-value-on-excel/58300948#58300948", "title": "is there a way to sort data depends on a value on excel", "body": "<p>Easiest solution is indeed with auxiliary column.</p>\n\n<p>Put this formula in C column :</p>\n\n<pre><code>=IF(NOT(ISERROR(SEARCH(\"server\";A1)));\"A\";\"B\")\n</code></pre>\n\n<p>Then sort on column C and all row with \"server\" keyword in column A will appear first.</p>\n"}], "owner": {"reputation": 41, "user_id": 7329107, "user_type": "registered", "profile_image": "https://graph.facebook.com/1288173361228518/picture?type=large", "display_name": "Ahmed Badreldin Amado", "link": "https://stackoverflow.com/users/7329107/ahmed-badreldin-amado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58300948, "answer_count": 1, "score": -1, "last_activity_date": 1570620066, "creation_date": 1570611908, "last_edit_date": 1570620066, "question_id": 58300617, "link": "https://stackoverflow.com/questions/58300617/is-there-a-way-to-sort-data-depends-on-a-value-on-excel", "title": "is there a way to sort data depends on a value on excel", "body": "<p>I want to put some excel in row if they contain a specific word </p>\n\n<pre><code> A              |B\n ____________________\n HP SERVER      | 1\n HP LAPTOP      | 2\n DELL SERVER    | 2\n LENOVO LAPTOP  | 3\n HP SERVER G8   | 2\n</code></pre>\n\n<p>I want the result to be sorting all SERVER in row like this</p>\n\n<pre><code> A              |B\n ____________________\n HP SERVER      | 1\n DELL SERVER    | 2\n HP SERVER G8   | 2\n HP LAPTOP      | 2\n LENOVO LAPTOP  | 3\n</code></pre>\n\n<p>is there any way to do that with formula or VBA\nI am using Microsoft Office 2013</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 2, "creation_date": 1570612637, "post_id": 58300419, "comment_id": 102964290, "body": "I would use a collection and loop through using <code>xlCellTypeVisible</code> more <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.specialcells\" rel=\"nofollow noreferrer\">here</a>. For each item check if it doesn&#39;t exist, then add."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570613503, "post_id": 58300419, "comment_id": 102964788, "body": "Could you please use the <a href=\"https://stackoverflow.com/posts/58300419/edit\">edit</a> link to show what you&#39;ve tried? (Such as creating the array with all the values.) That would give people a starting point to build on demonstrating the part that you&#39;re missing..."}, {"owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "edited": false, "score": 0, "creation_date": 1570614234, "post_id": 58300419, "comment_id": 102965214, "body": "You may copy the filtered value to another range and use <code>RemoveDuplicates</code> to get unique values"}], "answers": [{"comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1570614428, "post_id": 58301324, "comment_id": 102965324, "body": "Why not use <code>Dim dic As Scripting.Dictionary</code> instead of <code>Dim dic As Object: Set dic = CreateObject(&quot;Scripting.Dictionary&quot;)</code>?"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1570614507, "post_id": 58301324, "comment_id": 102965376, "body": "Also make OP aware that they will need to enable Microsoft Scripting Runtime in References in the VBE if using a dictionary."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 1, "creation_date": 1570614855, "post_id": 58301324, "comment_id": 102965578, "body": "@DeanDeVilliers there is no necessary of enabling Microsoft Scripting Runtime in References when used such approach of declaration <code>Dim dic As Object: Set dic = CreateObject(&quot;Scripting.Dictionary&quot;)</code>. Your proposed approach of declaration <code>Dim dic As Scripting.Dictionary</code> require additional steps of enabling  Microsoft Scripting Runtime in References"}, {"owner": {"reputation": 31, "user_id": 12186869, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA5FuAQS1AnytSu46oQFTAM29zkgU9szf8vVN7ZMw=k-s128", "display_name": "Gianluca ", "link": "https://stackoverflow.com/users/12186869/gianluca"}, "edited": false, "score": 0, "creation_date": 1570625233, "post_id": 58301324, "comment_id": 102971117, "body": "Thank you Vasily, your solutions worked just fine. Now I will try to understand how does it work, but I copied your code and it works."}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": true, "score": 1, "last_activity_date": 1570614180, "creation_date": 1570614180, "answer_id": 58301324, "question_id": 58300419, "link": "https://stackoverflow.com/questions/58300419/populate-array-with-unique-values-from-a-filtered-column-with-multiple-values/58301324#58301324", "title": "Populate array with unique values from a filtered column with multiple values", "body": "<p>you can use <code>Scripting.Dictionary</code> for such task and <code>xlCellTypeVisible</code>, example:</p>\n\n<pre><code>Sub sometest()\n    Dim x As Long, cl As Range\n    Dim dic As Object: Set dic = CreateObject(\"Scripting.Dictionary\")\n    dic.comparemode = vbTextCompare\n\n    x = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For Each cl In Range(Cells(2, \"A\"), Cells(x, \"A\")).SpecialCells(xlCellTypeVisible)\n        If Not dic.exists(cl.Value) Then\n            dic.Add cl.Value, Nothing\n        End If\n    Next cl\n\n    Debug.Print Join(dic.keys, \",\")\n\nEnd Sub\n</code></pre>\n\n<p>test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7bb6x.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7bb6x.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 12186869, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA5FuAQS1AnytSu46oQFTAM29zkgU9szf8vVN7ZMw=k-s128", "display_name": "Gianluca ", "link": "https://stackoverflow.com/users/12186869/gianluca"}, "edited": false, "score": 1, "creation_date": 1570625678, "post_id": 58301493, "comment_id": 102971378, "body": "Thank you for your solutions, it works as well as the one below. I simply used the second proposal because I understand it better but I thank you anyway because I tried yours too and it works."}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": false, "score": 2, "last_activity_date": 1570616491, "last_edit_date": 1570616491, "creation_date": 1570614690, "answer_id": 58301493, "question_id": 58300419, "link": "https://stackoverflow.com/questions/58300419/populate-array-with-unique-values-from-a-filtered-column-with-multiple-values/58301493#58301493", "title": "Populate array with unique values from a filtered column with multiple values", "body": "<h3> Use Scripting.Dictionary </h3>\n\n<p>You can select all the data from a column with <code>sht.Cells(sht.Rows.Count, \"F\").End(xlUp).Row</code> and then use a <code>Scripting.Dictionary</code> to find your unique values. Here's the code:</p>\n\n<pre><code>'Main Routine\nSub MyMacro()\n    Dim sht As Worksheet\n    Dim column As Range\n    Dim LastRow As Long\n    Dim uniqueValues() As Variant\n\n    Set sht = ActiveSheet 'Set your sheet here\n\n    LastRow = sht.Cells(sht.Rows.Count, \"F\").End(xlUp).Row\n    Set column = Range(\"F1:F\" &amp; LastRow)\n    uniqueValues = getUniqueValues(column)\n    'Do what you need to do with your values [...]\nEnd Sub\n\n'Return unique values from a Range\nFunction getUniqueValues(column As Range)\n    Dim dict As New Scripting.Dictionary ' requires \"Microsoft Scripting Runtime\"\n    Dim cell As Range\n\n    For Each cell In column\n        dict(cell.Value) = \"1\"\n    Next\n\n    'A double Transpose will put your data in an Array() format\n    getUniqueValues = Application.Transpose(Application.Transpose(dict.Keys))\nEnd Function\n</code></pre>\n\n<p>If you don't want to import <code>Microsoft Scripting Runtime</code>, use this code for <code>dict</code> declaration:</p>\n\n<pre><code>    'If you don't want to import Scripting Runtime, use this code\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong>: This is tested and works perfectly.</p>\n</blockquote>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 31, "user_id": 12186869, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA5FuAQS1AnytSu46oQFTAM29zkgU9szf8vVN7ZMw=k-s128", "display_name": "Gianluca ", "link": "https://stackoverflow.com/users/12186869/gianluca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58301324, "answer_count": 2, "score": 2, "last_activity_date": 1581870231, "creation_date": 1570611225, "last_edit_date": 1581870231, "question_id": 58300419, "link": "https://stackoverflow.com/questions/58300419/populate-array-with-unique-values-from-a-filtered-column-with-multiple-values", "title": "Populate array with unique values from a filtered column with multiple values", "body": "<p>I am trying to populate an array with values from a column in a filtered Excel table.</p>\n\n<p>In this column, the values may appear multiple times, but I need to return unique values, not all occurrences of each value.</p>\n\n<pre><code>Column F\na\na\na\nb\nc\nc\na\nb\nd\n</code></pre>\n\n<p>The array would have a variable length and, based on the sample column would have the elements: {a, b, c, d}</p>\n\n<p>The length of the array cannot be fixed because my function works with a filtered table that varies in length. Sometimes there may be only one unique value, other times there might be three.</p>\n\n<p>I need to do this because my array will be used to determine the subject of an e-mail with, \"... \" &amp; Array.</p>\n\n<p>How do I extract unique values in a column to the array?</p>\n"}, {"tags": ["excel", "vba", "loops", "copy"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570613740, "post_id": 58300234, "comment_id": 102964935, "body": "Wayne, a couple of tips: 1) To reply to people in comments you need to prefix their screen name with @ ; 2) Use the <a href=\"https://stackoverflow.com/posts/58300234/edit\">edit</a> link below a question to add additional content. It &quot;gets lost&quot; in a comment and cannot be formatted (looking at the <code>For Each...</code> here)"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1570611912, "creation_date": 1570611912, "answer_id": 58300620, "question_id": 58300234, "link": "https://stackoverflow.com/questions/58300234/vba-loop-copy-cells-from-worksheets-into-master-sheet/58300620#58300620", "title": "VBA Loop Copy cells from worksheets into master sheet", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim wsMaster As Worksheet, ws As Worksheet\n    Dim counter As Long\n\n    counter = 2\n\n    Set wsMaster = ThisWorkbook.Worksheets(\"Master\")\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        If ws.Name &lt;&gt; \"Master\" Then\n\n            ws.Range(\"A4\").Copy\n            wsMaster.Cells(3, counter).PasteSpecial xlPasteValues\n\n            ws.Range(\"K7:K42\").Copy\n            wsMaster.Cells(4, counter).PasteSpecial xlPasteValues\n\n            counter = counter + 1\n\n        End If\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 12187000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8676b96cbd2ea97d16f9aa644f3207ba?s=128&d=identicon&r=PG&f=1", "display_name": "WayneRN", "link": "https://stackoverflow.com/users/12187000/waynern"}, "edited": false, "score": 0, "creation_date": 1570612752, "post_id": 58300718, "comment_id": 102964359, "body": "Thank you for this, the answer above worked perfect but I thank you for your input. I did try your code as well and it pastes the first sheet into the mast sheet and then overwrites this data with the other sheets. Effectively putting all the data onto the same cells in master sheet.  But I thank you for your time."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1570612237, "creation_date": 1570612237, "answer_id": 58300718, "question_id": 58300234, "link": "https://stackoverflow.com/questions/58300234/vba-loop-copy-cells-from-worksheets-into-master-sheet/58300718#58300718", "title": "VBA Loop Copy cells from worksheets into master sheet", "body": "<p>Try this code:</p>\n\n<pre><code>Sub smth()\n\nDim myws As Worksheet, i As Long, ind As Long, col As Long\n\nFor Each myws In Worksheets\n\n    If myws.Name &lt;&gt; \"Master\" Then\n\n        ind = 0\n        For i = Len(myws.Name) To 1 Step -1\n            If IsNumeric(Mid(myws.Name, i, 1)) Then\n                ind = i\n            Else\n                Exit For\n            End If\n        Next i\n        If ind = 0 Then GoTo nextWS\n        col = CLng(Mid(myws.Name, ind, Len(myws.Name) - ind + 1))\n\n        myws.Range(\"A4\").Copy Destination:=Sheets(\"Master\").Cells(3, ind)\n        myws.Range(\"K7:K42\").Copy Destination:=Sheets(\"Master\").Cells(4, ind)\n\n    End If\nnextWS:\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This code will check if your sheet name has numbers at the end and if yes it will use that number as the column to paste to.</p>\n"}], "owner": {"reputation": 13, "user_id": 12187000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8676b96cbd2ea97d16f9aa644f3207ba?s=128&d=identicon&r=PG&f=1", "display_name": "WayneRN", "link": "https://stackoverflow.com/users/12187000/waynern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 58300620, "answer_count": 2, "score": -1, "last_activity_date": 1570612237, "creation_date": 1570610618, "last_edit_date": 1570612106, "question_id": 58300234, "link": "https://stackoverflow.com/questions/58300234/vba-loop-copy-cells-from-worksheets-into-master-sheet", "title": "VBA Loop Copy cells from worksheets into master sheet", "body": "<p>I'm fairly new to VBA and so looking for help.</p>\n\n<p>I have a master sheet that I want to collate data gathered from other sheets in the same workbook, sheets 2-60. I would like to copy cell A4 of the first sheet into cell B3 and the data from cells K7:K42 into cell B4:B41. Then move onto the next sheet and insert the same data range into column D3 and D4:D41 and so on until all sheets have been copied.</p>\n\n<p>This is what I have so far but as you can tell, this is going to be very long winded writing out the same two lines of code for 60+ sheets.</p>\n\n<pre><code>If myWs.Name &lt;&gt; \"Master\" Then\n\n    If myWs.Name = \"Sheet2\" Then\n    Sheets(myWs.Name).Range(\"K7:K42\").Copy Destination:=Sheets(\"Master\").Range(\"B4\")\n    Sheets(myWs.Name).Range(\"A4\").Copy Destination:=Sheets(\"Master\").Range(\"B3\")\n    End If\n\n    If myWs.Name = \"Sheet3\" Then\n    Sheets(myWs.Name).Range(\"K7:K42\").Copy Destination:=Sheets(\"Master\").Range(\"C4\")\n    Sheets(myWs.Name).Range(\"A4\").Copy Destination:=Sheets(\"Master\").Range(\"C3\")\n    End If\n\nEnd If\n\nNext\n</code></pre>\n\n<p>I have search SO for the last 2 days really and tried many things/code, but so far coming up short and very confusing.</p>\n"}, {"tags": ["excel", "vba", "string", "loops", "data-collection"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1570609658, "post_id": 58299876, "comment_id": 102962672, "body": "<code>dim arr(1 to 67) as string</code>, <code>arr(i) = Range(&quot;B&quot; &amp; i).Value</code>."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1570609707, "post_id": 58299876, "comment_id": 102962701, "body": "Instead of dimming 67 different inputs, it&#39;s better to put this in a single <code>array(1 to 67)</code> instead. <a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">reading material</a>"}, {"owner": {"reputation": 15, "user_id": 10160921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9KbFaY10paY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pedgEITAu70v0ESTsq7V06X63cSw/mo/photo.jpg?sz=128", "display_name": "Robo Bette\u0161", "link": "https://stackoverflow.com/users/10160921/robo-bette%c5%a1"}, "edited": false, "score": 0, "creation_date": 1570609822, "post_id": 58299876, "comment_id": 102962756, "body": "Thank you it is working."}, {"owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "edited": false, "score": 0, "creation_date": 1570609868, "post_id": 58299876, "comment_id": 102962779, "body": "And I do not think VBA has built-in variable reflection feature so you will need array instead"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1570610039, "post_id": 58299876, "comment_id": 102962856, "body": "Except for <code>input67</code>, all other input variables are defined as <code>Variant</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10160921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9KbFaY10paY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pedgEITAu70v0ESTsq7V06X63cSw/mo/photo.jpg?sz=128", "display_name": "Robo Bette\u0161", "link": "https://stackoverflow.com/users/10160921/robo-bette%c5%a1"}, "edited": false, "score": 0, "creation_date": 1570611689, "post_id": 58300186, "comment_id": 102963779, "body": "It works for me but only with small changes.  <code>Dim inputdict Set inputdict = CreateObject(&quot;Scripting.Dictionary&quot;)</code> and without the sentence <code>Set inputdict = New Scripting.Dictionary</code>"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 0, "last_activity_date": 1570612360, "last_edit_date": 1570612360, "creation_date": 1570610413, "answer_id": 58300186, "question_id": 58299876, "link": "https://stackoverflow.com/questions/58299876/vba-setting-string-value-with-changing-string-name/58300186#58300186", "title": "VBA Setting string value with changing string name", "body": "<p>This seems to be a perfect example for a dictionary</p>\n\n<pre><code>Option Explicit\n\nDim wb As Workbook, ws As Worksheet\nDim inputdict As Variant\nDim i As Long\n\nSet inputdict = CreateObject(\"Scripting.Dictionary\")\nSet wb = ThisWorkbook 'Change if necessary\nSet ws = wb.Sheets(1) 'Change if necessary\n\nFor i = 1 To 67\n    If ws.Cells(i, \"B\").Value = vbNullString Then\n        MsgBox \"Please fill all required data (The cells with red fill)\", vbOKOnly, \"Missing data\"\n        ws.Cells(i, \"B\").Select\n    Else\n        inputdict.Add i, ws.Cells(i, \"B\").Value\n    End If\nNext i\n</code></pre>\n\n<p>This creates a dictionary (<code>inputdict</code>). The keys for this dictionary are integers defined by <code>i</code> ranging from 1 to 67. The values are the values in the cells as you specified in your code already.</p>\n"}], "owner": {"reputation": 15, "user_id": 10160921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9KbFaY10paY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pedgEITAu70v0ESTsq7V06X63cSw/mo/photo.jpg?sz=128", "display_name": "Robo Bette\u0161", "link": "https://stackoverflow.com/users/10160921/robo-bette%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 58300186, "answer_count": 1, "score": 0, "last_activity_date": 1570612360, "creation_date": 1570609325, "last_edit_date": 1570609748, "question_id": 58299876, "link": "https://stackoverflow.com/questions/58299876/vba-setting-string-value-with-changing-string-name", "title": "VBA Setting string value with changing string name", "body": "<p>Hi I'm trying to create macro that will collect data from excell table. I create strings with similar names and ended by number. Please is there a way to loop over this strings ? This Code is not working, but will explain what I want to do.</p>\n\n<pre><code>Sub vzor()\n\nDim i As Integer\n\nDim input1, input2, input3, input4, input5, input6, input7, _\ninput8, input9, input10, input11, input12, input13, input14, _\ninput15, input16, input17, input18, input19, input20, input21, _\ninput22, input23, input24, input25, input26, input27, input28, _\ninput29, input30, input31, input32, input33, input34, input35, _\ninput36, input37, input38, input39, input40, input41, input42, _\ninput43, input44, input45, input46, input47, input48, input49, _\ninput50, input51, input52, input53, input54, input55, input56, _\ninput57, input58, input59, input60, input61, input62, input63, _\ninput64, input65, input66, input67 As String\n\nFor i = 2 To 67\n\n    If Range(\"B\" &amp; i).Value = \"\" Then\n        MsgBox \"Please fill all required data (The cells with red fill)\", vbOKOnly, \"Missing data\"\n        Range(\"B\" &amp; i).Select\n    Else\n         input &amp; i = Range(\"B\" &amp; i).Value\n    End If\n\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "edited": false, "score": 0, "creation_date": 1570609431, "post_id": 58299636, "comment_id": 102962567, "body": "You should provide the HTML code from the website to get better answer. To do what you want you will probably need a DOM parser and interact with elements through it"}, {"owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "reply_to_user": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "edited": false, "score": 0, "creation_date": 1570611520, "post_id": 58299636, "comment_id": 102963683, "body": "while inspecting elements this was the line of code which I get from the website for the required Proceed Button : &lt;a href=&quot;javascript:sendRequest(281);&quot; class=&quot;btn btn-info b-align &quot;&gt;Proceed&lt;/a&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1570611421, "creation_date": 1570611421, "answer_id": 58300484, "question_id": 58299636, "link": "https://stackoverflow.com/questions/58299636/requiring-code-line-for-clicking-on-button-on-website/58300484#58300484", "title": "Requiring code line for clicking on button on website", "body": "<p>If you have a look at the code of this button it is</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;a href=\"javascript:sendRequest(281);\" class=\"btn btn-info b-align \"&gt;Proceed&lt;/a&gt;\n</code></pre>\n\n<p>so if you click on the button (which is actually just a link) it actually runs the JavaScript function <code>sendRequest(281)</code>. So all you have to do in VBA is to run exactly that function with </p>\n\n<pre><code>doc.parentWindow.execScript \"sendRequest(281)\", \"JavaScript\"\n</code></pre>\n\n<p>and it would have the same effect as clicking on that button.</p>\n\n<pre><code>Option Explicit \n\nPublic Sub TDS_Autofill()\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.navigate \"https://onlineservices.tin.egov-nsdl.com/etaxnew/tdsnontds.jsp\"\n\n    Do While IE.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n    Dim doc As Object\n    Set doc = IE.document\n    doc.parentWindow.execScript \"sendRequest(281)\", \"JavaScript\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 10044037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k3zZzSomgYw/AAAAAAAAAAI/AAAAAAAAAJA/y2vV7vONc70/photo.jpg?sz=128", "display_name": "Arpit Jain", "link": "https://stackoverflow.com/users/10044037/arpit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58300484, "answer_count": 1, "score": 1, "last_activity_date": 1570611771, "creation_date": 1570608346, "last_edit_date": 1570611771, "question_id": 58299636, "link": "https://stackoverflow.com/questions/58299636/requiring-code-line-for-clicking-on-button-on-website", "title": "Requiring code line for clicking on button on website", "body": "<p><a href=\"https://i.stack.imgur.com/x2C4j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x2C4j.png\" alt=\"enter image description here\"></a></p>\n\n<p>I complied the below mentiond code, but I'm not able to figure out how to click on proceed button, the button which I sought to be clicked is marked between arrows in the attached image.</p>\n\n<pre><code>Sub TDS_Autofill()\nDim IE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate \"https://onlineservices.tin.egov-nsdl.com/etaxnew/tdsnontds.jsp\"\nDo While IE.Busy\nApplication.Wait DateAdd(\"s\", 1, Now)\nLoop\n\nSet doc = IE.document\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1570608359, "post_id": 58299463, "comment_id": 102962029, "body": "What happens is you create a &quot;call stack&quot; and you utilise <a href=\"https://support.microsoft.com/en-gb/help/3066990/memory-usage-in-the-32-bit-edition-of-excel-2013-and-2016\" rel=\"nofollow noreferrer\">Excel Memory</a> for each routine you have &quot;open&quot;. Perhaps you are creating a large call stack that is overloading your Excel internal memory (RAM). Maybe look at trying to create less individual routines and combine them into one. If that still causes your Excel to crash perhaps it&#39;s your code, and not your lack of memory resource management."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 2, "creation_date": 1570608573, "post_id": 58299463, "comment_id": 102962138, "body": "@DeanDeVilliers Or instead of the current practice, calling routine 3 from within 2, call routine 3 from within routine 1. Allowing routine 2 to close."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1570608894, "post_id": 58299463, "comment_id": 102962287, "body": "Yes, @Luuklag, or that"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1570608994, "post_id": 58299463, "comment_id": 102962344, "body": "You need to tell us what &quot;crash&quot; means here. Without that we can only guess"}, {"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1570609473, "post_id": 58299463, "comment_id": 102962583, "body": "It is a good thing that you have split up the whole task in to smaller ones. You could now do what most programmers would do, create one &#39;main&#39; sub, from which you call the present subs one after another. Thus you would only call the &#39;main&#39; and that would take care of the rest."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "edited": false, "score": 0, "creation_date": 1570686412, "post_id": 58300074, "comment_id": 102992449, "body": "I fail to see the logic in this."}, {"owner": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "edited": false, "score": 0, "creation_date": 1570688650, "post_id": 58300074, "comment_id": 102993292, "body": "i have a public variable already defined at project level. when I assign a value within a sub it&#39;s the public variable that changes. The same chain works with a simpler set of macros."}, {"owner": {"reputation": 169, "user_id": 8832702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aea17d661267cc5edc6ec36f0ee229e?s=128&d=identicon&r=PG", "display_name": "Dschuli", "link": "https://stackoverflow.com/users/8832702/dschuli"}, "reply_to_user": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "edited": false, "score": 0, "creation_date": 1570781009, "post_id": 58300074, "comment_id": 103029912, "body": "You did not share this info when you posted the question.  Would have appreciated you did."}, {"owner": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "edited": false, "score": 0, "creation_date": 1570903425, "post_id": 58300074, "comment_id": 103066987, "body": "well.. actually I wrote &quot;So far I have been using this method: First I have a mini sub that assigns value=1 to the global variable &quot;oneclick&quot;, and then calls the first macro of the chain&quot;. I didn&#39;t put it together with the rest, sorry if it confused you."}], "tags": [], "owner": {"reputation": 169, "user_id": 8832702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aea17d661267cc5edc6ec36f0ee229e?s=128&d=identicon&r=PG", "display_name": "Dschuli", "link": "https://stackoverflow.com/users/8832702/dschuli"}, "is_accepted": false, "score": -1, "last_activity_date": 1570611294, "last_edit_date": 1570611294, "creation_date": 1570609996, "answer_id": 58300074, "question_id": 58299463, "link": "https://stackoverflow.com/questions/58299463/issue-with-concatenated-subs/58300074#58300074", "title": "issue with concatenated subs", "body": "<p>What probably is happening is that <code>oneclick</code> is not defined with a <code>Dim</code> statement, so by default its defined at procedure level, meaning if you set <code>oneclick</code> it to 0 in another <code>Sub</code>, your setting another local/procedure level variable, and your variable in <code>macro1</code> is unchanged, so your chain of macros never stops, which leads to a stack overflow/crash as stated in one of the comments above.</p>\n\n<p>So either define <code>oneclick</code> as public variable (I recommend to define it as Boolean as it seems to basically be a switch .... True/False) or you pass the variable as argument down your chain of macros ( <code>Sub Macro2(ByRef oneclick as Boolean)</code> ).</p>\n\n<p>All that said, as one of comments above stated, you can have all your chained subs in the main sub ( <code>macro1</code> ) as they will only get executed one after the other, e.g. </p>\n\n<pre><code>Sub macro1()\n    Dim oneclick As Boolean\n\n    oneclick = True         'Need to get set to true to start\n\n    If oneclick Then Call macro2(oneclick)\n\n    If oneclick Then Call macro3(oneclick)\n\n    ........\n\n\nEnd Sub\n\nSub macro2(ByRef oneclick As Boolean)\n\n    oneclick = False            'One of your macros has to set oneclick to false to stop the chain/execution, probably under acondition\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "edited": false, "score": 0, "creation_date": 1570685891, "post_id": 58300266, "comment_id": 102992299, "body": "tried this solution, but excel still crashes. All the individual subs run without a glitch, so I think that this structure is not exactly &quot;neutral&quot; when it comes to executing each macro as a completely &quot;insulated&quot; block."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "edited": false, "score": 0, "creation_date": 1570692165, "post_id": 58300266, "comment_id": 102994794, "body": "@PaoloRomano - I added <code>DoEvents</code> to the code above. That will tell Excel to finish whatever is going on before taking on the next step. If that doesn&#39;t help, the next thing is to disect the macros"}, {"owner": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "edited": false, "score": 0, "creation_date": 1570695869, "post_id": 58300266, "comment_id": 102996572, "body": "actually I did a bit of research on the topic, without the <code>doevents</code> part it will actually sort of multithread the macro wherever possible. two of my macros were actually reading/writing to and from the same cells, I think this was the reason of the crash."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 2, "last_activity_date": 1570692071, "last_edit_date": 1570692071, "creation_date": 1570610725, "answer_id": 58300266, "question_id": 58299463, "link": "https://stackoverflow.com/questions/58299463/issue-with-concatenated-subs/58300266#58300266", "title": "issue with concatenated subs", "body": "<p>It is best if you don't chain the macros, but instead call them from another sub. This way you will have a clear way of understanding what you are doing, in what order.</p>\n\n<pre><code>Sub AllOfIt()\n    macro1\n    DoEvents\n\n    macro2\n    DoEvents\n\n    macro3\nEnd Sub\n\nSub macro1\n    ...\nEnd Sub\n\nSub macro2\n    ...\nEnd Sub\n\nSub macro3\n    ...\nEnd Sub\n</code></pre>\n\n<p>There is generally no need to worry about if something starts before the previous macro ended. That does not happen unless you do something like using <code>Application.OnTime</code></p>\n"}], "owner": {"reputation": 9, "user_id": 12186621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAPdZxIPU6K50OyfUaGxTscYh2jOuD8cAatV_ue=k-s128", "display_name": "Paolo Romano", "link": "https://stackoverflow.com/users/12186621/paolo-romano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570692071, "creation_date": 1570607642, "last_edit_date": 1570625210, "question_id": 58299463, "link": "https://stackoverflow.com/questions/58299463/issue-with-concatenated-subs", "title": "issue with concatenated subs", "body": "<p>DISCLAIMER: I'm not a developer, just an average guy trying to use VBA on his own project. First time I post on stackoverflow so forgive me if I'm violating any unwritten community rule..</p>\n\n<p>Hi all, I'm trying to have a bunch of subs running in sequence, so the next one starts only when the previous one has finished. </p>\n\n<p>The problem is that excel keep on crashing during the execution, while if I run each sub manually they have no issue at all.</p>\n\n<p>So far I have been using this method: First I have a mini sub that assigns value=1 to the global variable \"oneclick\", and then calls the first macro of the chain</p>\n\n<p>then, in each sub there is a tiny piece just before the end:</p>\n\n<pre><code>sub macro1()\n\n...macro code...\n\nif oneclick=1 then\n  call macro2\nend if\n\nend sub\n</code></pre>\n\n<p>and so on for all the subs until the final sub resets the oneclick variable to zero.</p>\n\n<p>I have no idea why this keeps on crashing. I can see that actually none of these subs is really closing until the very end of the last one, would this hit any sort of code limitation? I would be actually happier to have a single master sub that directs the process instead of relying on a kludge like this! any suggestion?</p>\n\n<p>EDIT:\noh wow already so many answers.. now I'm gonna try some of those. Answering some of your questions:</p>\n\n<p>1) the crash is really something sudden, not even an error message, simply excel quits and reopens, in the same state as it was when the macro chain first started. </p>\n\n<p>2) I agree with you guys that there should be a master sub calling the smaller ones, however last time I tried I got a series of problems because one macro needs to work on the results of the previous one and so on. How do you tell to vba to wait until the previous sub has ended?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "edited": false, "score": 0, "creation_date": 1570606843, "post_id": 58299109, "comment_id": 102961275, "body": "You are checking the entire range where the <code>Target</code> may refer to a single cell also. Your <code>Range(&quot;H11:H23&quot;).Value = &#39;Yes&#39;</code> seems a syntax error."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1570607760, "post_id": 58299109, "comment_id": 102961743, "body": "Note that <code>ActiveWorkbook</code> is not the workbook the code is in (it is the workbook that is on top while the code is executed). The workbook the code is in would be <code>ThisWorkbook</code>. In any doubts use <code>ThisWorkbook</code> and avoid anything that has an <code>Active</code> in its name. They are only needed in rare cases."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1570607635, "last_edit_date": 1570607635, "creation_date": 1570606957, "answer_id": 58299283, "question_id": 58299109, "link": "https://stackoverflow.com/questions/58299109/conditional-hiding-worksheet-from-multiple-selections/58299283#58299283", "title": "Conditional hiding worksheet from multiple selections", "body": "<p>i think you could try:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim cell As Range, rng As Range\n    Dim Inrng As Boolean\n\n    If Not Intersect(Target, Me.Range(\"H11:H23\")) Is Nothing Then\n        'Set a boolean variable to false\n        Inrng = False\n        'Set a range to loop\n        Set rng = Me.Range(\"H11:H23\")\n        'Start looping the range\n        For Each cell In rng\n            'Convert the value of a cell to Upper case to avoid case sensitive issues\n            If UCase(cell.Value) = \"YES\" Then\n                'Turn the variable to true if value appears in the range\n                Inrng = True\n                'Exit the loop to avoid time consuming\n                Exit For\n            End If\n\n        Next cell\n\n        If Inrng = True Then\n            Worksheets(\"Sheet2\").Visible = True\n        Else\n            Worksheets(\"Sheet2\").Visible = False\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1570607227, "creation_date": 1570607227, "answer_id": 58299353, "question_id": 58299109, "link": "https://stackoverflow.com/questions/58299109/conditional-hiding-worksheet-from-multiple-selections/58299353#58299353", "title": "Conditional hiding worksheet from multiple selections", "body": "<p>An easier solution without looping would be to count the <code>Yes</code> using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.countif\" rel=\"nofollow noreferrer\">WorksheetFunction.CountIf method</a>.</p>\n\n<p>Use the following to show <code>Sheet2</code> if <strong>at least one cell</strong> has the <code>Yes</code>.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim TestRange As Range\n    Set TestRange = Me.Range(\"H11:H23\")\n\n    If Not Application.Intersect(Target, TestRange) Is Nothing Then  'if target is in test range\n\n        If Application.WorksheetFunction.CountIf(TestRange, \"Yes\") &gt; 0 Then\n            Worksheets(\"Sheet2\").Visible = True\n        Else\n            Worksheets(\"Sheet2\").Visible = False\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>If <strong>all cells</strong> in the test range need to be <code>Yes</code> then change it to</p>\n\n<pre><code>If Application.WorksheetFunction.CountIf(TestRange, \"Yes\") = TestRange.Cells.Count Then\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12186576, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218033411960533/picture?type=large", "display_name": "James Reed", "link": "https://stackoverflow.com/users/12186576/james-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 1, "accepted_answer_id": 58299353, "answer_count": 2, "score": 0, "last_activity_date": 1570610895, "creation_date": 1570606274, "last_edit_date": 1570610895, "question_id": 58299109, "link": "https://stackoverflow.com/questions/58299109/conditional-hiding-worksheet-from-multiple-selections", "title": "Conditional hiding worksheet from multiple selections", "body": "<p>I need a sheet in Excel to activate if any cells in a column are selected as \"Yes\", but my VBA code won't stick - simple enough to do for one cell, but the whole column is throwing me. The cells are a drop down list with solely the options \"Yes\" or \"No\"</p>\n\n<p>Currently trying:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$H$11:$H$23\" Then\n            If ActiveWorkbook.Worksheets(\"Sheet1\").Range(\"H11:H23\").Value = \"Yes\" Then\n            Sheets(\"Sheet2\").Visible = True\n        Else\n            Sheets(\"Sheet2\").Visible = False\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Any tips? Thanks</p>\n"}, {"tags": ["excel", "vba", "performance"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570610917, "post_id": 58298392, "comment_id": 102963354, "body": "Sorry but this code is idiotic.  You are testing every character of every string for bold, italic and underline.  You should first split each string into entirely bold, entirely not bold, mixed bold and not bold.  Only for mixed bold and not bold do you need to examine every character.  Ditto for italic and underline.  Even with better code, examining every character of a string is slow but, if you only do so when necessary, the total runtime can be minimised."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570611187, "post_id": 58298392, "comment_id": 102963500, "body": "@TonyDallimore No sure how I should do that. How do I detect if the string is mixed bold/not bold? If I&#39;m not mistaken the properties Font.Bold and Font.Italic are booleans, so for any range of characters it would return either True (I guess if the whole range is bold) or False (if not the whole range is Bold?) but never &quot;mixed&quot;"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1570611362, "post_id": 58298392, "comment_id": 102963596, "body": "<code>Range.Characters.Font.Bold</code> is <code>Null</code> when some of the characters are bold. If you right-click <code>.Bold</code> and click on Definition, you can see that it is Variant instead of Boolean"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1570611412, "post_id": 58298392, "comment_id": 102963620, "body": "You are wrong about Booleans, those are Variant with Null when mixed. This way you can detect if any of the 3 formatting types were applied. Also there is no short circuiting in VBA - you can split those if&#39;s testing booleans first."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1570611655, "post_id": 58298392, "comment_id": 102963761, "body": "@Slai @ BrakNicku That&#39;s good news. That will at least allow me to skip the whole thing if there is no formatting at all. And then it could still be optimized by splitting the string in parts, each time checking the formatting of each part. Thanks"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1570612027, "post_id": 58298392, "comment_id": 102963954, "body": "You can also test all cells on the sheet or used range at once with <code>Range.Font</code>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570613308, "post_id": 58298392, "comment_id": 102964670, "body": "I have a VBA routine that performs this conversion but it has some weaknesses for you,  (1) it handles all Excel formatting; font, font face, font size, interior and so on. I assume this is overload for you.  (2) It handles overlapping formatting which again may be overload. If not, I doubt this routine would handle overlaps.(3) I wrote it years ago before I knew how to use a StringBuilder class within VBA."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570613956, "post_id": 58298392, "comment_id": 102965055, "body": "Have you had a look at <a href=\"https://fastexcel.wordpress.com/2017/03/13/excel-range-valuevaluetype-what-is-this-parameter/\" rel=\"nofollow noreferrer\">Range.Value(ValueType)</a>. You could use <code>xlRangeValueXMLSpreadsheet</code> value type (which gives you the XML for your cell). You could potentially then extract what you need from the XML"}], "answers": [{"comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570612760, "post_id": 58300363, "comment_id": 102964365, "body": "If you are going t suggest using a StringBuilder class, which is good, you ought to say where the OP can find one."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1570614290, "post_id": 58300363, "comment_id": 102965255, "body": "For now I&#39;m going to stay with VBA, but the suggestion to us the formatting info in xml format is certainly valuable. I&#39;ll look into that."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1570611763, "last_edit_date": 1570611763, "creation_date": 1570611034, "answer_id": 58300363, "question_id": 58298392, "link": "https://stackoverflow.com/questions/58298392/how-to-improve-performance-when-iterating-characters-in-excel-cell/58300363#58300363", "title": "How to improve performance when iterating characters in Excel cell", "body": "<p>The Microsoft Office libraries is unusually one of the slowest ways to read and write Office documents (I am not aware of any slower way). Also, VBA is limited to single thread. Most of the delay is from the communication between the Office library and the language. In your case there are multiple calls to the Excel library per each character.<br>\nMuch faster alternatives are libraries like <strong>OpenXML</strong>, <strong>ClosedXML</strong>, <strong>EPPlus</strong>, etc. Most of them are limited to xlsx file format, but the <strong>NPOI</strong> library seems to support xls too. I am not sure if there is a way to use any of them with VBA, as most of them are for .Net and Java. </p>\n\n<p>If for some reason you are limited to VBA, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.value\" rel=\"nofollow noreferrer\"><code>Range.Value(11)</code></a> can be used to retrieve formatting information in XML Spreadsheet format that can be processed with VBA and XML processing library.</p>\n\n<p>Another alternative could be to save the file as html or mhtml and process that.</p>\n"}, {"comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 1, "creation_date": 1570613041, "post_id": 58300812, "comment_id": 102964521, "body": "I think this will handle 99% of cases and the 1% High-CPU won&#39;t be noticeable. To expand on the strategy of &quot;Range-Wide&quot; (instead of per character) formatting the OP can borrow some more formats from me: <a href=\"https://stackoverflow.com/questions/39210329/export-the-datagridview-to-excel-with-all-the-cells-format\" title=\"export the datagridview to excel with all the cells format\">stackoverflow.com/questions/39210329/&hellip;</a>"}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1570631429, "post_id": 58300812, "comment_id": 102974806, "body": "This is the one I ended up using. Minimal change to the code with a major improvement of performance (since about 90% of the data doesn&#39;t have any formatting anyway)"}], "tags": [], "owner": {"reputation": 323, "user_id": 12089232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCfPL0FhSRKDbRwRWWDzMUtNrVlMgKovxcm8ZNZ=k-s128", "display_name": "Dhirendra Kumar", "link": "https://stackoverflow.com/users/12089232/dhirendra-kumar"}, "is_accepted": true, "score": 2, "last_activity_date": 1570613183, "last_edit_date": 1570613183, "creation_date": 1570612506, "answer_id": 58300812, "question_id": 58298392, "link": "https://stackoverflow.com/questions/58298392/how-to-improve-performance-when-iterating-characters-in-excel-cell/58300812#58300812", "title": "How to improve performance when iterating characters in Excel cell", "body": "<p>For your second question:\nTo check if text is unformatted (No bold, italic or underline), you may use:</p>\n\n<pre><code>If r.Font.FontStyle = \"Regular\" And r.Font.Underline = xlUnderlineStyleNone Then \n    getHTMLFormattedString = r.text\n    Exit Function\nEnd If\n</code></pre>\n\n<p>You may also check if text contains mix formatting using following code:</p>\n\n<pre><code>If IsNull(r.Font.Bold) Or IsNull(r.Font.Italic) Or IsNull(r.Font.Underline) Then \n'multiple format, check character-wise formatting here\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 3, "last_activity_date": 1570622244, "last_edit_date": 1570622244, "creation_date": 1570621360, "answer_id": 58303356, "question_id": 58298392, "link": "https://stackoverflow.com/questions/58298392/how-to-improve-performance-when-iterating-characters-in-excel-cell/58303356#58303356", "title": "How to improve performance when iterating characters in Excel cell", "body": "<p>As I suggested in my comments, I used <strong>Range.Value(Value.Type)</strong> to extract XML and then created a parser to extract the text in HTML format</p>\n\n<pre><code>Sub ConvertCellTextToHTML()\n\n    Dim oWS As Worksheet: Set oWS = ThisWorkbook.Worksheets(\"Sheet3\")                   '&lt; Change worksheet name\n    Dim iLastRow As Long: iLastRow = oWS.Range(\"A\" &amp; oWS.Rows.Count).End(xlUp).Row\n    Dim oRng As Range: Set oRng = oWS.Range(\"A1:A\" &amp; iLastRow)                          '&lt; Change range as required\n    Dim oCell As Range\n    Dim oXml As MSXML2.DOMDocument                                                      '&lt; Requires reference to Microsoft XML\n    Dim sCellXML As String, sHTMLString As String\n\n    ' Loop to go through all cells in the range\n    For Each oCell In oRng.Cells\n\n        ' Load XML for current cell\n        Set oXml = New MSXML2.DOMDocument\n        oXml.LoadXML (oCell.Value(xlRangeValueXMLSpreadsheet))\n\n        ' Capture the XML just for the cell\n        sCellXML = oXml.SelectSingleNode(\"/Workbook/Worksheet/Table/Row/Cell\").XML\n\n        ' Call the function to return HTML formated string\n        sHTMLString = ExtractTextWithFont(sCellXML)\n        Debug.Print sHTMLString\n    Next\n\nEnd Sub\n\nFunction ExtractTextWithFont(ByVal sXMLString As String) As String\n\n    Dim sRetVal As String\n    Dim aXML As Variant\n    Dim iC As Long\n\n    ' Split XML string\n    aXML = Split(sXMLString, \"&gt;\")\n\n    ' Loop to go through all elements in the array - starting from third element because first 2 are just headers from what i can see\n    For iC = LBound(aXML) + 2 To UBound(aXML)\n\n        ' Building string - this is based on strings that i tested. You might need to amend this bit to meet your needs\n        If Mid(Replace(Trim(LCase(aXML(iC))), \"/\", \"\"), 2, 4) &lt;&gt; \"font\" Then\n            If Left(LCase(Trim(aXML(iC))), 4) &lt;&gt; \"&lt;/ss\" And Left(LCase(Trim(aXML(iC))), 4) &lt;&gt; \"&lt;/ce\" Then\n                If Left(aXML(iC), 1) = \"&lt;\" Then\n                    sRetVal = sRetVal &amp; Replace(aXML(iC), \"&lt;/Font\", \"\") &amp; \"&gt;\"\n                Else\n                    sRetVal = sRetVal &amp; Replace(aXML(iC), \"&lt;/Font\", \"\")\n                End If\n                If LCase(Right(Trim(sRetVal), 6)) = \"&lt;/data\" Then\n                    sRetVal = Mid(Trim(aXML(iC)), 1, Len(Trim(aXML(iC))) - 6)\n                End If\n            End If\n        End If\n\n    Next\n\n    ' Set return value\n    ExtractTextWithFont = sRetVal\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 58300812, "answer_count": 3, "score": 2, "last_activity_date": 1570622244, "creation_date": 1570603241, "last_edit_date": 1570604412, "question_id": 58298392, "link": "https://stackoverflow.com/questions/58298392/how-to-improve-performance-when-iterating-characters-in-excel-cell", "title": "How to improve performance when iterating characters in Excel cell", "body": "<p>I'm working on a VBA routine to import stuff from Excel into Sparx Enterprise Architect.</p>\n\n<p>One of the challenges is to get the formatted text (bold, italic and underline) translated. EA uses some kind of html like formatting tags for it's text.\nSo this:</p>\n\n<blockquote>\n  <p>this text has <strong>bold</strong> and <em>italic</em></p>\n</blockquote>\n\n<p>has to be translated to this:</p>\n\n<pre><code>this text has &lt;b&gt;bold&lt;/b&gt; and &lt;i&gt;italic&lt;/i&gt;\n</code></pre>\n\n<p>If found this routine on in another question that I slightly modified to fit my need. It does exactly what I need, but it is excruciating slow</p>\n\n<pre><code>'-------------------------------------------------------------\n' Author:   Geert Bellekens (copied from stackoverflow: https://stackoverflow.com/questions/29916992/extract-text-content-from-cell-with-bold-italic-etc)\n' Date:     02/09/2019\n' Description: Returns a html formatted string for the (formatted) text in a cell\n'-------------------------------------------------------------\nPublic Function getHTMLFormattedString(r As range) As String\n Dim startTimeStamp As Double\n startTimeStamp = Timer\n Dim isBold As Boolean\n Dim isItalic As Boolean\n Dim isUnderlined As Boolean\n isBold = False\n isItalic = False\n isUnderlined = False\n Dim text As String\n text = \"\"\n Dim cCount As Integer\n cCount = 0\n Dim modifiers As New Collection\n On Error Resume Next\n cCount = r.Characters.Count\n On Error GoTo 0\n If cCount &gt; 0 Then\n    For i = 1 To cCount\n        Set c = r.Characters(i, 1)\n        If isBold And Not c.Font.Bold Then\n            isBold = False\n            text = removeModifier(\"b\", text, modifiers)\n        End If\n        If isItalic And Not c.Font.Italic Then\n            isItalic = False\n            text = removeModifier(\"i\", text, modifiers)\n        End If\n        If isUnderlined And c.Font.Underline = xlUnderlineStyleNone Then\n            isUnderlined = False\n             text = removeModifier(\"u\", text, modifiers)\n        End If\n        If c.Font.Bold And Not isBold Then\n            isBold = True\n            text = addModifier(\"b\", text, modifiers)\n        End If\n        If c.Font.Italic And Not isItalic Then\n            isItalic = True\n            text = addModifier(\"i\", text, modifiers)\n        End If\n        If Not (c.Font.Underline = xlUnderlineStyleNone) And Not isUnderlined Then\n            isUnderlined = True\n            text = addModifier(\"u\", text, modifiers)\n        End If\n        text = text &amp; c.text\n        If i = cCount Then\n            text = closeAllModifiers(text, modifiers)\n        End If\n    Next i\n Else\n    text = r.text\n    If r.Font.Bold Then\n        text = \"&lt;b&gt;\" &amp; text &amp; \"&lt;/b&gt;\"\n    End If\n    If r.Font.Italic Then\n        text = \"&lt;i&gt;\" &amp; text &amp; \"&lt;/i&gt;\"\n    End If\n    If Not (r.Font.Underline = xlUnderlineStyleNone) Then\n        text = \"&lt;u&gt;\" &amp; text &amp; \"&lt;/u&gt;\"\n    End If\n End If\n 'replace newline with CRLF\n text = Replace(text, Chr(10), vbNewLine)\n 'return\n getHTMLFormattedString = text\n 'get processingtime\n MsgBox \"processed \" &amp; Len(text) &amp; \" characters in \" &amp; Format(Timer - startTimeStamp, \"00.00\") &amp; \" seconds\"\nEnd Function\n</code></pre>\n\n<p>I tested this code with a lorem ipsum string of 1000 characters, without any formatting, and that processes in 4.89 seconds.</p>\n\n<p><strong>Question</strong>: What can I do to improve the performance?</p>\n\n<ul>\n<li>Is there a better way to loop all characters?</li>\n<li>Can I somehow detect if a cell has no formatting at all (and thus skip the whole routine)?</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1570602659, "post_id": 58298179, "comment_id": 102959180, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27802286/vba-getting-run-time-1004-method-range-of-object-worksheet-failed-when-us\">VBA: Getting run-time 1004: Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed when using cells</a>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1570602678, "post_id": 58298179, "comment_id": 102959191, "body": "Change: <code>wsCopy.range(Cell(i,2), Cell(i,4)).Copy</code> For: <code>wsCopy.range(wsCopy.Cells(i,2), wsCopy.Cells(i,4)).Copy</code> You missed a <code>s</code> in <code>Cells</code> plus you need to full quallify the ranges even there."}, {"owner": {"reputation": 33, "user_id": 12186192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDJ4kFfdE-I1YIHOqspCT49EkenzHlJyyO1aEVGDCo=k-s128", "display_name": "zen_4551", "link": "https://stackoverflow.com/users/12186192/zen-4551"}, "edited": false, "score": 0, "creation_date": 1570605207, "post_id": 58298179, "comment_id": 102960407, "body": "Hey Damian thanks! I forgot to add the s in my post. With the correct syntax, I still get the same error."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12186192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDJ4kFfdE-I1YIHOqspCT49EkenzHlJyyO1aEVGDCo=k-s128", "display_name": "zen_4551", "link": "https://stackoverflow.com/users/12186192/zen-4551"}, "edited": false, "score": 0, "creation_date": 1570605618, "post_id": 58298722, "comment_id": 102960629, "body": "Hi Louis thanks for the reply! I forgot to add the s in my post and with it it still gives me the same error."}, {"owner": {"reputation": 33, "user_id": 12186192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDJ4kFfdE-I1YIHOqspCT49EkenzHlJyyO1aEVGDCo=k-s128", "display_name": "zen_4551", "link": "https://stackoverflow.com/users/12186192/zen-4551"}, "edited": false, "score": 0, "creation_date": 1570625285, "post_id": 58298722, "comment_id": 102971140, "body": "Yup this is it. Thanks!"}], "tags": [], "owner": {"reputation": 3387, "user_id": 6248219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcdde87fb76a1bd9d3e079895abfbea7?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/6248219/louis"}, "is_accepted": true, "score": 1, "last_activity_date": 1570607872, "last_edit_date": 1570607872, "creation_date": 1570604703, "answer_id": 58298722, "question_id": 58298179, "link": "https://stackoverflow.com/questions/58298179/increasing-range-for-each-iteration/58298722#58298722", "title": "Increasing range for each iteration", "body": "<p>Try using this code:</p>\n\n<pre><code>Sub CopyData()\n    Dim wsCopy As Worksheet, wsDest As Worksheet\n    Dim iCopyLastRow As Long, iDestLastRow As Long\n\n    Set wsCopy = Workbooks(\"file1.xlsx\").Worksheets(\"trend\")\n    Set wsDest = Workbooks(\"file2.xlsx\").Worksheets(\"raw data\")\n\n    iCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 3 To iCopyLastRow\n        If wsCopy.Cells(i, 1).Value &lt;&gt; 0 Then\n            'A = 1, D = 4\n            wsCopy.Range(wsCopy.Cells(i, 1), wsCopy.Cells(i, 4)).Copy\n\n            iDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"B\").End(xlUp).Offset(1).Row\n\n            wsDest.Range(\"A\" &amp; iDestLastRow).PasteSpecial xlPasteValues\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Just make sure that <code>iCopyLastRow</code> and <code>iDestLastRow</code> are the values that you expect.</p>\n\n<p>I hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 12186192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDJ4kFfdE-I1YIHOqspCT49EkenzHlJyyO1aEVGDCo=k-s128", "display_name": "zen_4551", "link": "https://stackoverflow.com/users/12186192/zen-4551"}, "edited": false, "score": 0, "creation_date": 1570607342, "post_id": 58299303, "comment_id": 102961517, "body": "Thanks Michal! I&#39;ll try this out in a bit. The code seems neater! I&#39;ll let you know if it does work. But I&#39;m trying to figure out why my code isn&#39;t working. Also maybe I just need to get away from this. I&#39;ll be back in a bit"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1570607045, "creation_date": 1570607045, "answer_id": 58299303, "question_id": 58298179, "link": "https://stackoverflow.com/questions/58298179/increasing-range-for-each-iteration/58299303#58299303", "title": "Increasing range for each iteration", "body": "<p>Try below code, it's ready to use in a loop:</p>\n\n<pre><code>Sub CopyAndAppend()\n    Dim destSheet As Worksheet, srcSheet As Worksheet, lastRow As Long\n    Set destSheet = Worksheets(\"Sheet2\")\n    Set srcSheet = Worksheets(\"Sheet1\")\n    ' determine last row in Sheet2\n    lastRow = destSheet.Cells(destSheet.Rows.Count, 1).End(xlUp).Row\n\n    Dim i As Long\n    i = 3\n    ' copy range A3:D3 and paste it right after last row in Sheet2\n    srcSheet.Range(srcSheet.Cells(i, 1), srcSheet.Cells(i, 4)).Copy destSheet.Cells(lastRow + 1, 1)\n    ' increment row index\n    i = i + 1\n    ' do something else\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12186192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDJ4kFfdE-I1YIHOqspCT49EkenzHlJyyO1aEVGDCo=k-s128", "display_name": "zen_4551", "link": "https://stackoverflow.com/users/12186192/zen-4551"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 58298722, "answer_count": 2, "score": 3, "last_activity_date": 1570611621, "creation_date": 1570602398, "last_edit_date": 1570611621, "question_id": 58298179, "link": "https://stackoverflow.com/questions/58298179/increasing-range-for-each-iteration", "title": "Increasing range for each iteration", "body": "<p>I'm automating an Excel sheet for my work and I'm stuck in a problem. </p>\n\n<p>I'm trying to copy a specific range (A3:D3) and paste it to the ending row of another workbook. I'm trying to use an if statement to filter ranges that have the number 0 in cell B3.</p>\n\n<p>Please help. I'm a complete rookie and I'm just starting out. Sorry if there's a lot of questions. </p>\n\n<p>I've tried to change the range to a cell (i, 2) but it only copies B3 and not the rest (A3:D3).</p>\n\n<p>Edit: forgot to add the s in cells\nEdit2: I just need to copy four cells (A3:D3) and increment it on my next iteration so that the copied cell would be (A4:D4) </p>\n\n<pre><code>Sub CopyData()\n\nDim wsCopy As Worksheet, wsDest As Worksheet\nDim iCopyLastRow As Long, iDestLastRow As Long\n\nSet wsCopy = Workbooks(\"file1.xlsx\").Worksheets(\"trend\")\nSet wsDest = Workbooks(\"file2.xlsx\").Worksheets(\"raw data\")\n\niCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 3 To iCopyLastRow\n        If wsCopy.Cells(i, 2).Value = 0 Then\n\n        Else\n        wsCopy.range(Cell(i,2), Cell(i,4)).Copy\n        'wsCopy.Cells(i, 2). Copy ##this copies just one cell\n\n        iDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"B\").End(xlUp).Offset(1).Row\n        wsDest.range(\"A\" &amp; iDestLastRow).PasteSpecial xlPasteValues\n        End If\n\n    Next i\n\nError messages:\n</code></pre>\n\n<blockquote>\n  <p>Run-time error '1004':</p>\n  \n  <p>Method 'Range' of object '_Worksheet' failed</p>\n</blockquote>\n\n<p>and the debug highlights <code>wsCopy.range(Cell(i,2), Cell(i,4)).Copy</code>, the statement after else</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570602402, "post_id": 58297856, "comment_id": 102959054, "body": "Hi. U are crashing the value of finalArray every time that u iterate with i. U are only keeping Last iteration. I dont know the funci&#243;n PV, i dont know what it does, but to jeep all return finalArray must be a array or something like that. Good luck"}, {"owner": {"reputation": 3, "user_id": 4386943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08cf9e066282caeadb2055b3835cfe01?s=128&d=identicon&r=PG&f=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/4386943/vinci"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570613730, "post_id": 58297856, "comment_id": 102964927, "body": "I agree but when I try to write finalArray with an indice, it is consistently giving me an error"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1570615332, "post_id": 58297856, "comment_id": 102965835, "body": "can u update the code to see how do u call the function  Persistence_times_initiation, and tell wheres the error that occurs when u try with an array"}, {"owner": {"reputation": 3, "user_id": 4386943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08cf9e066282caeadb2055b3835cfe01?s=128&d=identicon&r=PG&f=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/4386943/vinci"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571028936, "post_id": 58297856, "comment_id": 103090260, "body": "hi @LuisCurado, sorry for the late reply. I have added your request to the current question! Cheers"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1571055228, "post_id": 58297856, "comment_id": 103101902, "body": "for what i see, the PV function doesnt accept matrix in parameters and the return is a double. also, the firt parameter is mandatory and u dont have it. i dont understant what are u trying to do.."}], "owner": {"reputation": 3, "user_id": 4386943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08cf9e066282caeadb2055b3835cfe01?s=128&d=identicon&r=PG&f=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/4386943/vinci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571028898, "creation_date": 1570600700, "last_edit_date": 1571028898, "question_id": 58297856, "link": "https://stackoverflow.com/questions/58297856/storing-data-matrix-in-two-dimensional-matrix-after-pv-function", "title": "Storing Data matrix in two dimensional matrix (after .PV function)", "body": "<p>In the code below, I am selecting two matrices from my Excel sheet, MatrixA and MatrixB</p>\n\n<blockquote>\n  <p>MatrixA = [ 100 95.6 81 63]</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>MatrixB  = [10 20 30 40]</p>\n</blockquote>\n\n<p>I am trying to multiple them using the Application.PV function in Excel and storing them as a single 2-D matrix, therefore getting something like : </p>\n\n<blockquote>\n  <p>MatrixC =<br>\n  Row 1 : 10 9.5 9.1 6.5 ; </p>\n  \n  <p>Row 2: 20 19.12 18.21 12.69 ; </p>\n  \n  <p>Row 3: 30 28 27 19 ; </p>\n  \n  <p>Row 4 : 40 38 36 25</p>\n</blockquote>\n\n<p>However, so far I manage to get only the first row. This is my code below</p>\n\n<pre><code>Public Function Persistence_times_initiation(MatrixA As Variant, MatrixB As Variant)\n\nDim finalArray As Variant\n\nFor i = 1 To 4\n   finalArray(1,i) = Application.PV(, 1, Application.PV(, MatrixA, MatrixB(1, i)))\nNext i\n\nPersistence_times_initiation = finalArray\n\nEnd Function\n</code></pre>\n\n<p>So the first instance would show </p>\n\n<blockquote>\n  <p>FinalArray = 1000 956 810 630</p>\n</blockquote>\n\n<p>Second instance </p>\n\n<blockquote>\n  <p>FinalArrat = 2000 1912 1620 1260 </p>\n</blockquote>\n\n<p>Third instance </p>\n\n<blockquote>\n  <p>FinalArrat = 3000 2868 2430 1890</p>\n</blockquote>\n\n<p>Fourth instance </p>\n\n<blockquote>\n  <p>FinalArrat = 4000 3824 3240 2520</p>\n</blockquote>\n\n<p>I am trying to store this into a matrix. Any help is welcome.</p>\n"}, {"tags": ["excel", "vba", "dictionary", "visibility"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1570598221, "post_id": 58297441, "comment_id": 102957759, "body": "1) Are you sure <code>print_dict()</code> gets called after the <code>Worksheet_Change</code> event has been triggered at least once? 2) See <a href=\"https://stackoverflow.com/q/7041138/4934172\">What is the lifetime of a global variable in excel vba?</a>."}, {"owner": {"reputation": 83, "user_id": 9145756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd436cc867bcbc3988f7718c791ac64?s=128&d=identicon&r=PG&f=1", "display_name": "mayool", "link": "https://stackoverflow.com/users/9145756/mayool"}, "reply_to_user": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1570598599, "post_id": 58297441, "comment_id": 102957843, "body": "yes pretty sure. I did the event in debug mode 2 times and added &quot;MsgBox dict(id)&quot; at the first line before the second run and it yield the correct &quot;current_status&quot; and id when running the event again. However, it breaks when changing the id or when trying to acces the dict in the different sub."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1570599512, "last_edit_date": 1570599512, "creation_date": 1570598428, "answer_id": 58297513, "question_id": 58297441, "link": "https://stackoverflow.com/questions/58297441/access-dictionary-in-different-subs-in-vba/58297513#58297513", "title": "Access Dictionary in Different Subs in VBA", "body": "<pre><code>dict(id).Exists \n</code></pre>\n\n<p>should be </p>\n\n<pre><code>dict.Exists(id)\n</code></pre>\n\n<p>When using an error handler it's worth making sure you're not just skipping over problems with your code syntax. </p>\n\n<p>I'm guessing <code>MsgBox dict(id)</code> fails because that sub is in a regular module and not in your sheet module.</p>\n\n<pre><code>MsgBox sheetCodename.id\n</code></pre>\n\n<p>should work though. </p>\n\n<p><code>MsgBox id</code> gives you an empty messagebox because you're not using <code>Option Explicit</code> in your regular code module: the variable <code>id</code> doesn't exist in a scope which can be accessed by your Sub , but without <code>Option Explicit</code> your code auto-creates a (blank) <code>id</code> variable for you.</p>\n"}], "owner": {"reputation": 83, "user_id": 9145756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd436cc867bcbc3988f7718c791ac64?s=128&d=identicon&r=PG&f=1", "display_name": "mayool", "link": "https://stackoverflow.com/users/9145756/mayool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 58297513, "answer_count": 1, "score": 0, "last_activity_date": 1570603185, "creation_date": 1570598030, "last_edit_date": 1570603185, "question_id": 58297441, "link": "https://stackoverflow.com/questions/58297441/access-dictionary-in-different-subs-in-vba", "title": "Access Dictionary in Different Subs in VBA", "body": "<p>I want to store some status in VBA (Excel) using a dictionary but got problems with accesing it in a different sub.</p>\n\n<p>in the end, I want a nested Dictionary containing ID's as primary keys and for each ID I want multiple status-messages with the matching timestamp:</p>\n\n<pre><code>Example: {ID_1: {status_1: 09.10.19 06:47, status_2: 09.10.19 07:00,...}, ID_2:{status_6: 09.10.19 06:30, status_1: 09.10.19 06:20}}\n</code></pre>\n\n<p>So far I was just trying to get a simple dictionary only containing the ID and the status:</p>\n\n<pre><code>Option Explicit  Public dict As Scripting.Dictionary  Public id As Integer\n\n\nPublic Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo Fin\n\n    Dim current_status As String\n\n    current_status = Tabelle4.Range(\"B11\").Value\n    id = Tabelle3.Cells(7, 6).Value\n\n    Application.EnableEvents = False\n    If Not Intersect(Target, Range(\"C12:G12\")) Is Nothing Then\n\n\n        If dict Is Nothing Then\n            Set dict = New Scripting.Dictionary\n\n            dict.Add (id), current_status\n\n        'Checks if inner dict exists\n        ElseIf Not dict(id).Exists Then\n\n            dict.Add (id), current_status\n\n        End If\n\n    End If\n\n    Fin:\n\n         Application.EnableEvents = True\n    End Sub\n</code></pre>\n\n<p>Please note that I change the ID manually and current_status will be generated in B11 by changing one of the values in C12 to G12 (that is why I used Change event).\nIn the End I want to keep a record of all the status updates that occur and track when they occur.</p>\n\n<p>My Problem is that this does work for 1 Entry. I am able to create one entry in the \"If dict is Nothing Then\"-part and can access it even after the event. (e.g. inserting MsgBox dict(ID) at the start before triggering the event again.)\nI also want to print the result using a Button on my Excel.\nHowever, when I call:</p>\n\n<pre><code>Public Sub print_dict()    \n\nMsgBox dict(id)\n\nEnd Sub\n</code></pre>\n\n<p>I get an error message that dict is not defined. \"MsgBox id\" yields an empty MsgBox. </p>\n\n<p>Maybe someone can help me out. I am pretty new to VBA and am still struggling with it :D</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1570591839, "post_id": 58296547, "comment_id": 102956514, "body": "What is the value of <code>filename</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 6, "creation_date": 1570591962, "post_id": 58296547, "comment_id": 102956538, "body": "Why do you have a backslash on the end of your filename?"}, {"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570600235, "post_id": 58296547, "comment_id": 102958307, "body": "@TimWilliams,  I read somewhere that the attachments object is very particular, and won&#39;t work unless you have the trailing slash.  I&#39;ll give it a try tomorrow without it, but I think I tried removing it, and it didn&#39;t make a difference."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570600613, "post_id": 58296547, "comment_id": 102958412, "body": "I\u2019ve never used a trailing slash and I\u2019ve not had any problems with attaching files"}, {"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570632659, "post_id": 58296547, "comment_id": 102975540, "body": "@TimWilliams that fixed it!   Gotta love programming.   Thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "edited": false, "score": 0, "creation_date": 1570632683, "post_id": 58303474, "comment_id": 102975549, "body": "Looks like the problem was the trailing slash.   Thanks for your help!"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1570621739, "creation_date": 1570621739, "answer_id": 58303474, "question_id": 58296547, "link": "https://stackoverflow.com/questions/58296547/vba-failing-to-add-attachment-to-email/58303474#58303474", "title": "VBA failing to add attachment to email", "body": "<p>The source of the attachment can be a file (represented by the full file system path with a file name) or an Outlook item that constitutes the attachment. See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.attachments.add\" rel=\"nofollow noreferrer\">Attachments.Add</a> for more information.</p>\n\n<p>Based on the code listed above you just need to make sure the file path is valid and doesn't contain forbidden symbols. Try to copy the actual file path at runtime and paste it into any windows explorer window. Following that way, you can be sure that a file can be found and read.</p>\n"}], "owner": {"reputation": 95, "user_id": 1262602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4869b67f0ed65f9deacfe1c7102f65c5?s=128&d=identicon&r=PG", "display_name": "the1gofer", "link": "https://stackoverflow.com/users/1262602/the1gofer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 58303474, "answer_count": 1, "score": 0, "last_activity_date": 1570632726, "creation_date": 1570590743, "last_edit_date": 1570632726, "question_id": 58296547, "link": "https://stackoverflow.com/questions/58296547/vba-failing-to-add-attachment-to-email", "title": "VBA failing to add attachment to email", "body": "<p>Not sure why this is failing with a </p>\n\n<blockquote>\n  <p>\"runtime error operation failed\"</p>\n</blockquote>\n\n<p>It seems to be crashing on the \".Attachments.Add fileName\" line.  I've read that you can run into issues if you are passing an object to the attachments, but I don't think I've done that. </p>\n\n<pre><code>Public Sub DraftEmailWithAttachment(strTo As String, strSubject As String, _\n                                    strBody As String, fileName As String)\n\n    Dim oApp As Object\n    Dim oEmail As Object\n\n    Set oApp = CreateObject(\"Outlook.Application\")\n    Set oEmail = oApp.CreateItem(0)\n\n    With oEmail\n        .To = strTo\n        .subject = strSubject\n        .Attachments.Add fileName\n        .display\n        .HTMLBody = strBody &amp; oEmail.HTMLBody\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Private Sub btnEmailActionItems_Click()\n\n    Dim fileName As String\n    Dim todayDate As String\n    Dim strTo As String\n    Dim strSubject As String\n    Dim strBody As String\n    Dim filter As String\n\n    Dim oApp As Object\n    Dim oEmail As Object\n\n    Set oApp = CreateObject(\"Outlook.Application\")\n    Set oEmail = oApp.CreateItem(0)\n\n    strTo = Nz(Me.cboUnderwriter.Column(2), \"\")\n    strSubject = Nz(Me.txtNamedInsured.Value, \"\") &amp; \" - \" &amp; _\n                 Nz(Me.txtSubmissionNumber.Value, \"\") &amp; \" - \" &amp; _\n                 Nz(Me.txtQuoteNumber.Value, \"\")\n\n    strBody = \"Hello \" &amp; Me.cboUnderwriter.Column(3) &amp; \", &lt;br/&gt;&lt;br/&gt;\"\n    todayDate = Format(Date, \"MM.DD.YYYY\")\n    fileName = \"C:\\Users\\crewsj3\\Desktop\\tmp\\Action Items Report -\" &amp; _\n                strSubject &amp; \" \" &amp; todayDate &amp; \".pdf\\\"\n\n    filter = \"submission_number=\" &amp; Nz(Me.txtSubmissionNumber.Value, \"\")\n\n    'generate filtered report\n    Call ExportFilteredReportToPDF(\"rptActionItemsForAllPolicies\", fileName, filter)\n\n    'generate email\n    Call DraftEmailWithAttachment(strTo, strSubject, strBody, fileName)\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Edit:</p>\n\n<p>It looks like the problem was the trailing slash.  works fine now.  Thanks for the help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1570595705, "post_id": 58296275, "comment_id": 102957192, "body": "Are those pairs coming from cell values? And which value has priority for pairing? Where the left value matches or where the pair is closer...?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1570596944, "post_id": 58296275, "comment_id": 102957460, "body": "unique duplicates is an oxymoron..."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11151545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837766d52d11d3c93257f06c93f93fa1?s=128&d=identicon&r=PG&f=1", "display_name": "J.Parker", "link": "https://stackoverflow.com/users/11151545/j-parker"}, "edited": false, "score": 0, "creation_date": 1572574939, "post_id": 58304158, "comment_id": 103611295, "body": "Sorry it took so long to reply to this and thank you. This is really helpful.  The next step for me is to create a new array of only the duplicate entries. For example, in the above set the new array would only include three entries:  final_array(0) = 343  final_array(1) = 282  final_array(2) = 112"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 21, "user_id": 11151545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837766d52d11d3c93257f06c93f93fa1?s=128&d=identicon&r=PG&f=1", "display_name": "J.Parker", "link": "https://stackoverflow.com/users/11151545/j-parker"}, "edited": false, "score": 0, "creation_date": 1572620032, "post_id": 58304158, "comment_id": 103625648, "body": "glad to hear that i help, if the answer if useful please up vote the answer. for the next step i you go through the code is very easy to identify were you should create an additional step to create an array to include unique values."}, {"owner": {"reputation": 21, "user_id": 11151545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837766d52d11d3c93257f06c93f93fa1?s=128&d=identicon&r=PG&f=1", "display_name": "J.Parker", "link": "https://stackoverflow.com/users/11151545/j-parker"}, "edited": false, "score": 0, "creation_date": 1572653637, "post_id": 58304158, "comment_id": 103637290, "body": "Thanks again! I can&#39;t up vote though since I don&#39;t have enough reputation yet :/"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1570624146, "creation_date": 1570624146, "answer_id": 58304158, "question_id": 58296275, "link": "https://stackoverflow.com/questions/58296275/collecting-list-of-common-points/58304158#58304158", "title": "Collecting list of common points", "body": "<p>You could use:</p>\n\n<pre><code>    Option Explicit\n\n    Sub test()\n\n        Dim arrIni As Variant, arrResult(1) As Variant\n        Dim valueIni_1 As String, valueIni_2 As String, valueRes_1 As String, valueRes_2 As String\n        Dim i As Long, j As Long, Counter As Long, LastRow As Long\n\n        arrIni = Array(\"343/494\", \"989/282\", \"343/112\", \"282/343\", \"282/9991\")\n\n        For i = LBound(arrIni) To UBound(arrIni)\n\n            Counter = 0\n\n            valueIni_1 = Split(arrIni(i), \"/\")(0)\n            valueIni_2 = Split(arrIni(i), \"/\")(1)\n\n            For j = LBound(arrIni) To UBound(arrIni)\n\n                valueRes_1 = Split(arrIni(j), \"/\")(0)\n                valueRes_2 = Split(arrIni(j), \"/\")(1)\n\n                If (valueIni_1 = valueRes_1) Or (valueIni_1 = valueRes_2) Or (valueIni_2 = valueRes_1) Or (valueIni_2 = valueRes_2) Then\n\n                    Counter = Counter + 1\n\n                    If Counter = 1 Then\n                        arrResult(Counter - 1) = arrIni(i)\n                    Else\n                        arrResult(Counter - 1) = arrIni(j)\n                    End If\n\n                    If Counter = 2 Then\n                        'Print result in sheet1\n                        With ThisWorkbook.Worksheets(\"Sheet1\")\n\n                            LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n                            .Range(\"A\" &amp; LastRow + 2 &amp; \":A\" &amp; LastRow + 3).Value = Application.WorksheetFunction.Transpose(arrResult)\n\n                        End With\n\n                        Exit For\n                    End If\n\n                End If\n\n            Next j\n\n        Next i\n\n    End Sub\n</code></pre>\n\n<p><strong>Result:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/VOt5U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VOt5U.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 11151545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837766d52d11d3c93257f06c93f93fa1?s=128&d=identicon&r=PG&f=1", "display_name": "J.Parker", "link": "https://stackoverflow.com/users/11151545/j-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570624146, "creation_date": 1570588370, "last_edit_date": 1570603178, "question_id": 58296275, "link": "https://stackoverflow.com/questions/58296275/collecting-list-of-common-points", "title": "Collecting list of common points", "body": "<p>I'm trying to do something that is probably simple, but I'm struggling to find a solution.\nI have a list of point number pairs (e.g. for point number 343 paired with point number 494 I have a list item named \"343/494\"). \nThe list could look something like this:</p>\n\n<pre><code>array(0) = \"343/494\"\narray(1) = \"989/282\"\narray(2) = \"343/112\"\narray(3) = \"282/343\"\narray(4) = \"282/9991\"\n</code></pre>\n\n<p>What I want to create is a new array with entries that share a common point number, but only have two entries. It would look like the below:</p>\n\n<pre><code>new_array(0,0) = \"343/494\"\nnew_array(0,1) =\"343/112\" \n</code></pre>\n\n<p>(note that \"282/343\" is omitted because there\n is already two entries sharing \"343\") </p>\n\n<pre><code>new_array(1,0) = \"989/282\"\nnew_array(1,1) = \"282/343\"\n</code></pre>\n\n<p>(like the above only two entries are needed containing something with \"282\") </p>\n\n<p>Since there aren't any unique duplicates of the other values, I don't create put them in the new_array</p>\n\n<p>That's most of what I'm trying to do. </p>\n\n<p>I'd very much appreciate any suggestions</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1570583119, "last_edit_date": 1570583119, "creation_date": 1570582790, "answer_id": 58295725, "question_id": 58295597, "link": "https://stackoverflow.com/questions/58295597/converting-match-array-formula-to-vba-code/58295725#58295725", "title": "Converting MATCH array formula to VBA code", "body": "<p>This array formula will take a long time to compute, since each column has over one million rows. Array formulas should not use whole column references. </p>\n\n<p>The same result can be returned with a non-array formula, which can be used in VBA without any special commands.</p>\n\n<pre><code>=IF(ISNA(MATCH($A8&amp;$B8&amp;$C8&amp;E$7,Index('Raw Data'!$E$1:$E$1000&amp;'Raw Data'!$D$1:$D$1000&amp;'Raw Data'!$C$1:$C$1000&amp;'Raw Data'!$G$1:$G$1000,0),0)),\"\",\"Yes\")\n</code></pre>\n\n<p>If you want to use an array formula in VBA, you will need <code>.FormulaArray</code> instead of <code>.Formula</code> or <code>.FormulaR1C1</code></p>\n\n<p>If you don't want to enter a formula into a worksheet cell, but perform the calculation in VBA, you can use <code>Worksheetfunction</code> (<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction</a>) to use the worksheet functions and their syntax.</p>\n"}], "owner": {"reputation": 3, "user_id": 12157030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d65cc5bfb39806c3bf9ecb695b2143c6?s=128&d=identicon&r=PG&f=1", "display_name": "sonyabee", "link": "https://stackoverflow.com/users/12157030/sonyabee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58295725, "answer_count": 1, "score": 0, "last_activity_date": 1570583119, "creation_date": 1570581242, "last_edit_date": 1570581424, "question_id": 58295597, "link": "https://stackoverflow.com/questions/58295597/converting-match-array-formula-to-vba-code", "title": "Converting MATCH array formula to VBA code", "body": "<p>I'm attempting to convert the formulas in a sheet into VBA code in a macro, and am stumped by the following:</p>\n\n<p><code>{=IF(ISNA(MATCH($A8&amp;$B8&amp;$C8&amp;E$7,'Raw Data'!$E:$E&amp;'Raw Data'!$D:$D&amp;'Raw Data'!$C:$C&amp;'Raw Data'!$G:$G,0)),\"\",\"Yes\")}</code></p>\n\n<p>It's trying to look at multiple columns in one sheet, compare them to another, and see if the value of the column header is in the fourth column \"G\" to return \"Yes\" or blank. I've attached a screenshot of the sheet it fills out:</p>\n\n<p><a href=\"https://i.stack.imgur.com/t7v0x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t7v0x.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "decimal", "comma"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1570578712, "post_id": 58295114, "comment_id": 102954267, "body": "Try <code>Sheets(&quot;Hoja3&quot;).Range(&quot;A&quot; &amp; i).Formula = Val(Replace(Sheets(&quot;Hoja3&quot;).Range(&quot;A&quot; &amp; i).Value, &quot;,&quot;, &quot;.&quot;))</code>  It&#39;s possible <code>Val</code> expectd the decimal separator to be <code>.</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570603445, "post_id": 58295114, "comment_id": 102959566, "body": "@TimWilliams Actually that&#39;s correct the <code>Val</code> function only accepts periods as decimal seperators. Just for your interest the documentation recommends to use <code>CDbl</code> if the decimal separator is different from a period."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1570602776, "creation_date": 1570602776, "answer_id": 58298276, "question_id": 58295114, "link": "https://stackoverflow.com/questions/58295114/vba-number-formatting-with-commas-as-decimal-separator/58298276#58298276", "title": "VBA number formatting (with commas as decimal separator)", "body": "<p>The issue is that you use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/val-function\" rel=\"nofollow noreferrer\">Val function</a> in combination with a non-us-english decimal separator, which is not a proper solution to your issue. </p>\n\n<blockquote>\n  <p><em>The <code>Val</code> function recognizes only the period ( <code>.</code>) as a valid decimal separator. When different decimal separators are used, as in international applications, use <code>CDbl</code> instead to convert a string to a number.</em>\n  <sup><br><br>\n  <em>Source: Microsoft documentation <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/val-function\" rel=\"nofollow noreferrer\">Val function</a>.</em></sup></p>\n</blockquote>\n\n<p>Since the <code>Val</code> function does not convert a text into a value but extracts\nThe <code>Val</code> function only works with a dot <code>.</code> as decimal separator.</p>\n\n<p>Example:</p>\n\n<pre><code>Val(\"2.55\") 'will return 2.55 as number\nVal(\"2,55\") 'will return 2 as number (because it cuts off all text and the comma is not considered as decimal separator)\n</code></pre>\n\n<p>To get rid of the green triangle and convert a number that is saved as text into a real number properly, use the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ConvertNumberAsTextIntoRealNumber()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Hoja3\")\n\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    With ws.Range(\"A1\", \"A\" &amp; LastRow)\n        .NumberFormat = \"# ##0.00\"  'set your desired number format\n        .Value = .Value  'this will in most cases already convert to real numbers.\n    End With\n\n    'But if your numbers are hard coded to text and begin with a `'` you need the following additionally:\n    Dim iRow As Long\n    For iRow = 1 To LastRow\n        With ws.Cells(iRow, \"A\")\n            If IsNumeric(.Value) Then  'can the value be interpreted as a number\n                If .Value &lt;&gt; 0 Then  'is the value not zero\n                    .Value = CDbl(.Value)  'then convert it into a real number\n                End If\n            End If\n        End With\n    Next iRow\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 1, "last_activity_date": 1570614623, "creation_date": 1570614623, "answer_id": 58301463, "question_id": 58295114, "link": "https://stackoverflow.com/questions/58295114/vba-number-formatting-with-commas-as-decimal-separator/58301463#58301463", "title": "VBA number formatting (with commas as decimal separator)", "body": "<p>I know you are looking for VBA solution, but here's a small Excel trick that you might find useful:</p>\n\n<ol>\n<li>Enter <code>1</code> (numeric value) somewhere in the file and copy it:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/M8C86.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M8C86.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"2\">\n<li>Select your range (A1:A6) and go to Paste > Paste Special > select Multiply:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/NKEox.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NKEox.png\" alt=\"enter image description here\"></a></p>\n\n<ol start=\"3\">\n<li>The final result is all your text values being converted to numbers:</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/dpbXt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dpbXt.png\" alt=\"enter image description here\"></a></p>\n\n<p>The same trick will work with other combinations, e.g. <code>Operation: Add</code> while having <code>0</code> copied, etc.</p>\n"}], "owner": {"reputation": 843, "user_id": 7507590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DxiIXxbtsQY/AAAAAAAAAAI/AAAAAAAAAcA/ZsFhmNP7dyY/photo.jpg?sz=128", "display_name": "Alvaro Morales", "link": "https://stackoverflow.com/users/7507590/alvaro-morales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4064, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570614623, "creation_date": 1570576648, "last_edit_date": 1570601616, "question_id": 58295114, "link": "https://stackoverflow.com/questions/58295114/vba-number-formatting-with-commas-as-decimal-separator", "title": "VBA number formatting (with commas as decimal separator)", "body": "<p>The main problem started when I wanted to \"convert to number\" by the green triangle (I know I can do it by hand, but there are a lot of cells like that and in the future I only want to use code).</p>\n\n<p><a href=\"https://i.stack.imgur.com/1jsVp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1jsVp.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I wanted to do it by code, and I came across with this code that helps, but I have a problem with the number format wich removes the decimal numbers.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7Zaqq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Zaqq.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Valor3()\n\nDim LastRow As Long, i As Long\n\nLastRow = Sheets(\"Hoja3\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'Sheets(\"Hoja3\").Range(\"A1:A\" &amp; LastRow).NumberFormat = \"# ##0,00\"\n\nFor i = 1 To LastRow\n    If Val(Sheets(\"Hoja3\").Range(\"A\" &amp; i).Value) &lt;&gt; 0 Then _\n    Sheets(\"Hoja3\").Range(\"A\" &amp; i).Formula = _\n    Val(Sheets(\"Hoja3\").Range(\"A\" &amp; i).Value)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I've been trying many formats but none of them seems to help.\nIt might be because here we use the comma as a decimal separator and there is no miles separator.\n\u00bfWhat number format should help me?</p>\n"}, {"tags": ["vba", "powershell", "batch-file", "zip", "7zip"], "comments": [{"owner": {"reputation": 29794, "user_id": 6738015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FYDxX.jpg?s=128&g=1", "display_name": "Compo", "link": "https://stackoverflow.com/users/6738015/compo"}, "edited": false, "score": 1, "creation_date": 1570583578, "post_id": 58295110, "comment_id": 102955151, "body": "Open any plain text editor, and type your code within it before saving it with a <code>ps1</code>/<code>.cmd</code> extension."}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 9596121, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c6GIo7QjrjU/AAAAAAAAAAI/AAAAAAAAABk/36oQCfCeQJo/photo.jpg?sz=128", "display_name": "Chris aa", "link": "https://stackoverflow.com/users/9596121/chris-aa"}, "is_accepted": true, "score": 0, "last_activity_date": 1570617119, "creation_date": 1570617119, "answer_id": 58302184, "question_id": 58295110, "link": "https://stackoverflow.com/questions/58295110/batch-or-powershell-script-to-zip-specific-files/58302184#58302184", "title": "Batch or Powershell Script to zip specific files", "body": "<p>After 2 weeks of research I managed to do it myself. Here's the answer for anyone with a similar situation:</p>\n\n<pre><code>@echo off\ncls\nset zip=\"C:\\Program Files (x86)\\7-Zip\\7z.exe\"\nset loc=C:\\User\\Downloads\\Videos\\UnConverted\n\ncd %loc%\n\nfor /d %%D in (%loc%\\*) do (\n    for /d %%I in (\"%%D\\*\") do (\n        cd %%I\n        %zip% a -t7z -mx9 \"%%~nxI.7z\" *.txt *.html *.vtt *.srt *.zip *.jpeg *.png\n        del /S *.txt *.html *.vtt *.srt *.zip *.jpeg *.png\n    )\n)\n\ncd %loc%\necho ----- Compression Complete! -----\npause\n</code></pre>\n\n<p>The first for loop iterates through the every subfolder of the root folder while the second for loop iterates through each subfolder of the root folders subfolders. After that</p>\n\n<pre><code>cd %%I - To enter the sub-sub-folder\n%zip% - To call the 7z cli\na - add files to archive\nt7z - using the .7z extension\nmx9 - with maximum compression\n%%~nxI.7z - to store the files using the sub-sub-folders name\n*.txt *.html *.vtt *.srt *.zip *.jpeg *.png - file extensions to archive\n</code></pre>\n\n<p>after that the del deletes the archived files.</p>\n"}], "owner": {"reputation": 54, "user_id": 9596121, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-c6GIo7QjrjU/AAAAAAAAAAI/AAAAAAAAABk/36oQCfCeQJo/photo.jpg?sz=128", "display_name": "Chris aa", "link": "https://stackoverflow.com/users/9596121/chris-aa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1570827582, "accepted_answer_id": 58302184, "answer_count": 1, "score": -1, "last_activity_date": 1570617119, "creation_date": 1570576618, "question_id": 58295110, "link": "https://stackoverflow.com/questions/58295110/batch-or-powershell-script-to-zip-specific-files", "closed_reason": "Needs more focus", "title": "Batch or Powershell Script to zip specific files", "body": "<p>I have the following folder structure:</p>\n\n<pre><code>-Videos\n  -1. Summer\n    summer.mp4\n    summer.srt\n    summer2.zip\n  -2. Winter\n    winter.mkv\n    winter.vtt\n  - ..\n</code></pre>\n\n<p>How can I create a batch or powershell script that results in the following folder structure: </p>\n\n<pre><code>-Videos\n  -1. Summer\n    summer.mp4\n    1. Summer.7z\n  -2. Winter\n    winter.mkv\n    2. Winter.7z\n  - ..\n</code></pre>\n\n<p>So basically iterate through all sub-folders, zip all the contents except video formats using 7zip and delete the original files that were zipped. I'm open to suggestions using VB!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1570574149, "post_id": 58294820, "comment_id": 102953432, "body": "<code>Range(&quot;A84:B&quot; &amp; LastRow &amp; &quot;,D84:E&quot; &amp; LastRow &amp; &quot;,H84:J&quot; &amp; LastRow).Select</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570578522, "post_id": 58294820, "comment_id": 102954241, "body": "<code>Range( Replace(&quot;A84:B&lt;r&gt;,D84:E&lt;r&gt;,H84:J&lt;r&gt;&quot;, &quot;&lt;r&gt;&quot;, LastRow) ).Select</code>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1570574102, "creation_date": 1570574102, "answer_id": 58294847, "question_id": 58294820, "link": "https://stackoverflow.com/questions/58294820/select-multiple-ranges-with-vba/58294847#58294847", "title": "Select multiple ranges with VBA", "body": "<p>Use UNION:</p>\n\n<pre><code>Dim rng as Range\nWith ActiveSheet\n    set rng = Union(.Range(\"A84:B\" &amp; LastRow),.Range(\"D84:E\" &amp; LastRow),.Range(\"H84:J\" &amp; LastRow))\nEnd With\nrng.select\n</code></pre>\n\n<p>But if you intend on doing something with that range then skip the <code>.Select</code> and just do what is wanted, ie <code>rng.copy</code></p>\n"}, {"comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 2, "creation_date": 1570588919, "post_id": 58294867, "comment_id": 102956049, "body": "this answer returns a compile error.  may due to the misplacing of double quotes.   Try modify to <code>Range(&quot;A84:B&quot; &amp; LastRow &amp; &quot;,&quot; &amp; &quot;D84:E&quot; &amp; LastRow &amp; &quot;,&quot; &amp; &quot;H84:J&quot; &amp; LastRow).Select</code>"}], "tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1570574290, "creation_date": 1570574290, "answer_id": 58294867, "question_id": 58294820, "link": "https://stackoverflow.com/questions/58294820/select-multiple-ranges-with-vba/58294867#58294867", "title": "Select multiple ranges with VBA", "body": "<p>Range(\"A84:B &amp; LastRow &amp; \",\" &amp; \"D84:E &amp; LastRow &amp; \",\" &amp; \"H84:J &amp; LastRow\").Select</p>\n"}, {"tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 1, "last_activity_date": 1570604700, "last_edit_date": 1570604700, "creation_date": 1570588689, "answer_id": 58296309, "question_id": 58294820, "link": "https://stackoverflow.com/questions/58294820/select-multiple-ranges-with-vba/58296309#58296309", "title": "Select multiple ranges with VBA", "body": "<p>Put your dis-continued range address in the first argument of <code>Range</code> object.</p>\n\n<p>For example, <code>Range(\"A:A,D:D\").Select</code> will select column A and column D.</p>\n\n<p>In your case, you may try:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim str As String, LastRow As Integer\n\nLastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\nstr = \"A84:B\" &amp; LastRow &amp; \",D84:E\" &amp; LastRow &amp; \",H84:J\" &amp; LastRow\nRange(str).Select\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 864, "favorite_count": 1, "accepted_answer_id": 58294847, "answer_count": 3, "score": 1, "last_activity_date": 1570604700, "creation_date": 1570573840, "question_id": 58294820, "link": "https://stackoverflow.com/questions/58294820/select-multiple-ranges-with-vba", "title": "Select multiple ranges with VBA", "body": "<p>I need to select multiple ranges in a worksheet to run various VBA code on them. The ranges will always begin on row 84 but the end depends on how far down the data goes. I've been selecting these ranges separately using code like this:</p>\n\n<pre><code>Sub SelectRange()\nDim LastRow As Integer\nLastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\nRange(\"A84:B\" &amp; LastRow).Select\nEnd Sub\n</code></pre>\n\n<p>That works fine, but I can't figure out how to select multiple ranges at once. I've tried everything I can think of:</p>\n\n<ul>\n<li>Range(\"A84:B\", \"D84:E\", \"H84:J\" &amp; LastRow).Select</li>\n<li>Range(\"A84:B,D84:E,H84:J\" &amp; LastRow).Select</li>\n<li>Range(\"A84:B &amp; LastRow,D84:E &amp; LastRow,H84:J &amp; LastRow\").Select</li>\n</ul>\n\n<p>Nothing works. I get a run-time error when running any of those.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570580618, "post_id": 58294623, "comment_id": 102954631, "body": "Is it always exactly the text &quot;RG&quot; or &quot;CB&quot; followed by 3 digits?"}, {"owner": {"reputation": 3, "user_id": 12184787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da18f144ad9d96433c934316d1f198d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robdoc", "link": "https://stackoverflow.com/users/12184787/robdoc"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570809699, "post_id": 58294623, "comment_id": 103044730, "body": "There are several identifiers, not just RG or CB, but it is always followed by three charachters. Sometimes the first number is a letter."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12184787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da18f144ad9d96433c934316d1f198d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robdoc", "link": "https://stackoverflow.com/users/12184787/robdoc"}, "edited": false, "score": 0, "creation_date": 1570827221, "post_id": 58346860, "comment_id": 103051758, "body": "Thank you so much for the code. It runs with no errors but unfortunately it does not seem to do anything.  In cell A of the analyser sheet is this whole string &quot;19280A021001   19280 G  CB374 AN/PRC-152A 56 DAY PMI&quot;  In case that could be an issue"}, {"owner": {"reputation": 3, "user_id": 12184787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da18f144ad9d96433c934316d1f198d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robdoc", "link": "https://stackoverflow.com/users/12184787/robdoc"}, "edited": false, "score": 0, "creation_date": 1570827735, "post_id": 58346860, "comment_id": 103051928, "body": "Another issue that may be a problem, The sheet &quot;380 Reference&quot; Pulls it&#39;s data from a different worksheet with a formula in each cell similar to &quot;=&#39;PRC&#39;!D4&quot;  If it would be easier to do this in Access or something and just pull the info from the worksheets on excell I could do that aswell but i&#39;ve got only a little bit of experience with Access"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 12184787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da18f144ad9d96433c934316d1f198d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robdoc", "link": "https://stackoverflow.com/users/12184787/robdoc"}, "edited": false, "score": 0, "creation_date": 1570831905, "post_id": 58346860, "comment_id": 103053028, "body": "Here&#39;s a working version: <a href=\"https://drive.google.com/file/d/1Xd4WS-ZM8HvLg9aXJpnpLXf7Kupi2wjy/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1Xd4WS-ZM8HvLg9aXJpnpLXf7Kupi2wjy/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 12184787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da18f144ad9d96433c934316d1f198d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robdoc", "link": "https://stackoverflow.com/users/12184787/robdoc"}, "edited": false, "score": 0, "creation_date": 1571259118, "post_id": 58346860, "comment_id": 103185254, "body": "Thank you very much! If you wanna email me at robdoc@live.com I&#39;ll send you a reward. I appreciate the work."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 12184787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da18f144ad9d96433c934316d1f198d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robdoc", "link": "https://stackoverflow.com/users/12184787/robdoc"}, "edited": false, "score": 0, "creation_date": 1571259735, "post_id": 58346860, "comment_id": 103185507, "body": "Thanks for the offer but I&#39;m good thanks - just here for practice..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1570832003, "last_edit_date": 1570832003, "creation_date": 1570819350, "answer_id": 58346860, "question_id": 58294623, "link": "https://stackoverflow.com/questions/58294623/vba-excel-search-for-matches-in-a-string-of-text-in-a-column-vs-a-different-colu/58346860#58346860", "title": "VBA EXCEL Search for matches in a string of text in a column vs a different column on a different sheet. If match found, Copy &amp; Paste", "body": "<p>This worked for me - I skipped some of the \"find last cell\" bits so you'll need to adjust for that</p>\n\n<pre><code>Sub Tester()\n\n    Dim c As Range, v, f\n    Dim ws380 As Worksheet, wsAn As Worksheet\n\n    Set ws380 = ThisWorkbook.Sheets(\"380 Reference\")\n    Set wsAn = ThisWorkbook.Sheets(\"analyser\")\n\n    For Each c In wsAn.Range(\"A1:A50\") 'for example\n        If Len(c.Value) &gt; 0 Then\n            v = GetMatch(c.Value)\n            Debug.Print c.Address, v\n\n            If Len(v) &gt; 0 Then\n                'got a value - look it up...\n                Set f = ws380.Range(\"A9:A5000\").Find(v, lookat:=xlWhole, _\n                                                    lookin:=xlValues)\n                If Not f Is Nothing Then\n                    f.Resize(1, 6).Copy c.EntireRow.Cells(1, \"L\") 'copy found row\n                End If\n            End If\n\n        End If\n    Next c\n\nEnd Sub\n\n\nFunction GetMatch(txt As String)\n\n    Dim re As Object, allMatches, m\n\n    Set re = CreateObject(\"VBScript.RegExp\")\n    'looking for two upper-case letters then 3 digits, or 3 letters plus 2 digits\n    ' with a word boundary on each end\n    re.Pattern = \"(\\b([A-Z]{2}\\d{3}\\b)|(\\b[A-Z]{3}\\d{2})\\b)\"\n    re.ignorecase = False\n    re.Global = True\n\n    Set allMatches = re.Execute(txt)\n    For Each m In allMatches\n        GetMatch = m.Value\n        Exit For\n    Next m\n\nEnd Function\n</code></pre>\n\n<p>Here's a good vbscript regexp reference:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/scripting-articles/ms974570(v=msdn.10)?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/scripting-articles/ms974570(v=msdn.10)?redirectedfrom=MSDN</a></p>\n"}], "owner": {"reputation": 3, "user_id": 12184787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da18f144ad9d96433c934316d1f198d1?s=128&d=identicon&r=PG&f=1", "display_name": "Robdoc", "link": "https://stackoverflow.com/users/12184787/robdoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58346860, "answer_count": 1, "score": -1, "last_activity_date": 1570832003, "creation_date": 1570572328, "last_edit_date": 1570573378, "question_id": 58294623, "link": "https://stackoverflow.com/questions/58294623/vba-excel-search-for-matches-in-a-string-of-text-in-a-column-vs-a-different-colu", "title": "VBA EXCEL Search for matches in a string of text in a column vs a different column on a different sheet. If match found, Copy &amp; Paste", "body": "<p>I'm trying desperately to learn Excel well enough to do this on my own but I can't figure this out. I really appreciate any help you can give me. I posted before with not nearly enough information, so this is the repost with more info.</p>\n\n<p>A document is pasted in cell A9.</p>\n\n<p>It fills every cell below it with lines of data, up to A200.</p>\n\n<p>The lines of data look like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>192800002001 19280 G RG474 56 DAY PMI COMPLETE\n19280A001001 19280 G CB359 AN/PRC-152A 56 DAY PMI\n19280A005001 19280 G CB360 AN/PRC-152A 56 DAY PMI\n</code></pre>\n\n<p>I need the program to search each cell in column A for the words that look like \"RG474\" or \"CB359\" and search in a reference table on a different sheet in the same book. The table on the reference table looks like this</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>RG474 | xxx474 0 | 0 | IN RACK | AF6\nCB915 | xxx359 0 | 0 | IN RACK | AF6\n</code></pre>\n\n<p>For every match found it pastes the row from the reference table into the row of the match next to the pasted document (columns L-Q).</p>\n\n<p>I've found some code online that I've tried to no avail, the two things I tried are here:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim lastRw1, lastRw2, nxtRw, m\n\n    'Determine last row with data, refrene\n    lastRw1 = Sheets(\"380 Refrence\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    'Determine last row with data, Import\n    lastRw2 = Sheets(\"analyser\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    'Loop through Import, Column A\n    For nxtRw = 9 To lastRw2\n        'Search Sheet1 Column C for value from Import\n        With Sheets(\"380 Refrence\").Range(\"A9:A\" &amp; lastRw1)\n            Set m = .Find(Sheets(\"analyser\").Range(\"A\" &amp; nxtRw), LookIn:=xlValues, lookat:=xlWhole)\n            'Copy Import row if match is found\n            If Not m Is Nothing Then\n                Sheets(\"analyser\").Range(\"A\" &amp; nxtRw &amp; \":F\" &amp; nxtRw).Copy _\n                Destination:=Sheets(\"380 Refrence\").Range(\"L\" &amp; m.Row)\n            End If\n        End With\n    Next\nEnd Sub\n\nSub CopyImportData()\n\n    Dim lastRw1, lastRw2, nxtRw, m\n    Dim code As String, RefRow As Integer\n    Dim rowValues\n\n    'Determine last row with data, 380 Refrencerene\n    lastRw1 = Sheets(\"380 Refrence\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    'Determine last row with data, Import\n    lastRw2 = Sheets(\"analyser\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For Row = 9 To lastRw2\n        With Sheets(\"analyser\").Cell(Row, 1)\n            'meet the laziest error handling ever to find your 380 Refrenceerence value\n            code = WorksheetFunction.Mid(.Value, WorksheetFunction.IfError(WorksheetFunction.IfError(WorksheetFunction.Search(\"CB??? \", .Value), WorksheetFunction.Search(\"RG??? \", .Value)), 1), 5)\n        End With\n\n        With Sheets(\"380 Refrence\")\n            'Use Excel Match to find the 380 Refrenceerence row, which is offset by 8\n            'I swear I'll stop using iferror\n    380         RefrenceRow = WorksheetFunction.IfError(WorksheetFunction.Match(code, .Range(\"A9:A\" &amp; lastRw1), 0) + 8, -1)\n\n            '-1 is our safeword, copy the range\n            If RefRow &lt;&gt; -1 Then\n                .Range(\"A\" &amp; RefRow &amp; \":F\" &amp; RefRow).Copy Destination:=Worksheets(\"analyser\").Range(\"L\" &amp; Row)\n            End If\n        End With\n    Next Row\nEnd Sub\n</code></pre>\n\n<p>I didn't write either of these and don't fully understand them, but I do get the Gist of it.</p>\n\n<p>Here's a <em>very</em> trimmed down duplicate of the workbook: <a href=\"https://drive.google.com/open?id=1qCz8DUCz6tA5-KbxKDnvRq_KiBDkl4W5\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1qCz8DUCz6tA5-KbxKDnvRq_KiBDkl4W5</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1570567781, "post_id": 58293883, "comment_id": 102951786, "body": "<code>If Cells(i, 1).IndentLevel = 1 Then</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1570568435, "creation_date": 1570568435, "answer_id": 58294013, "question_id": 58293883, "link": "https://stackoverflow.com/questions/58293883/copy-paste-loop-based-off-indent-level/58294013#58294013", "title": "Copy Paste Loop Based Off Indent Level", "body": "<p>Maybe a combination of something like below? I am assuming you have headers although your photo does not show any. You can also move <code>pr</code> (<em>paste row</em>) outside of this to a UDF.</p>\n\n<pre><code>Sub FindData()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Concur\") '&lt;-- Update\nDim lr As Long, i As Long, pr As Long\n\nws.Range(\"B1:B50\").ClearContents\nlr = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nFor i = 1 To lr\n    If ws.Cells(i, 1).IndentLevel = 1 Then\n        If InStr(ws.Cells(i, 1), \"|TE|\") Then\n            pr = ws.Range(\"C\" &amp; ws.Rows.Count).End(xlUp).Offset(1).Row\n            ws.Range(\"C\" &amp; pr) = Application.Trim(ws.Cells(i, 1))\n        ElseIf InStr(ws.Cells(i, 1), \"|Sub\") Then\n            pr = ws.Range(\"D\" &amp; ws.Rows.Count).End(xlUp).Offset(1).Row\n            ws.Range(\"D\" &amp; pr) = Application.Trim(ws.Cells(i, 1))\n        Else\n            pr = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Offset(1).Row\n            ws.Range(\"B\" &amp; pr) = Application.Trim(ws.Cells(i, 1))\n        End If\n    End If\nNext i\n\nws.Range(\"B:D\").IndentLevel = 0  \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11772181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0803fb18dbbbb71abeea86d2d74f747f?s=128&d=identicon&r=PG&f=1", "display_name": "Canaan Zeigler", "link": "https://stackoverflow.com/users/11772181/canaan-zeigler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58294013, "answer_count": 1, "score": 0, "last_activity_date": 1570568435, "creation_date": 1570567644, "question_id": 58293883, "link": "https://stackoverflow.com/questions/58293883/copy-paste-loop-based-off-indent-level", "title": "Copy Paste Loop Based Off Indent Level", "body": "<p>I cannot figure out how to get a loop to run through a set of data based on the indent level of each cell.</p>\n\n<p>Please see attached photo of what the result should look like. <a href=\"https://i.stack.imgur.com/mo2Kp.jpg\" rel=\"nofollow noreferrer\">Click Here</a> I have a source column with data (Column A). That data has some bold headers with an indent level of 0. Those values are worthless to me, they just come in that way as a way to make the data more clear. So we can ignore them. </p>\n\n<p>I would like to loop through the data in Column A, copy and paste into column B the value that have an indent level of 1, and do not have a a prefix inside the \"|\" characters.</p>\n\n<p>In Column C, I would like to loop through the data, copy and paste the data in column A that has an indent level of one AND the prefix |TE|, but I would like to also strip the prefix, and reset the indent level to 0.</p>\n\n<p>In Column D, I would like to loop through the data, copy and paste the data in column A that has an indent level of one AND the prefix |Sub|, again stripping the prefix, and resetting the indent level to 0.</p>\n\n<p>Ultimately this data will be going to separate tabs, but if I can figure out the indent level syntax, I think I can get it from there.</p>\n\n<p>Any help would be appreciated. Thank You</p>\n\n<pre><code>Sub FindData()\n\nDim LastRow As Integer\nDim i As Integer\n\nSheets(\"Sheet1\").Range(\"B1:B50\").ClearContents\n\nLastRow = Sheets(\"Sheet1\").Range(\"A1000\").End(xlUp).Row\n\n\nFor i = 1 To LastRow\n    If Cells(i, 1) = ActiveCell.IndentLevel = 0 Then\n    Cells(i, 1).Copy _\n    Range(\"B10\").End(xlUp).Offset(1, 0)\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "sql-server-2012"], "comments": [{"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 3, "creation_date": 1570566510, "post_id": 58293660, "comment_id": 102951315, "body": "The problem is you&#39;re injecting your values. Stop doing that. You <b><i>need</i></b> to use <code>Parameters.Add</code>. If you parametrise your query, then problem you have won&#39;t exist; as the data you have will be passed as the right data type."}, {"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 3, "creation_date": 1570566530, "post_id": 58293660, "comment_id": 102951323, "body": "<a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">Little Bobby Tables</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1570567191, "post_id": 58293660, "comment_id": 102951587, "body": "What is <code>Data_Backup_Modbus-001:tag001</code>? Is that a table name? Typically a qualified table name on SQL Server looks like <code>[DatabaseName].[SchemaName].[TableName]</code>."}, {"owner": {"reputation": 3, "user_id": 12184391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WFynh.jpg?s=128&g=1", "display_name": "Higa Lobo Pinheiro", "link": "https://stackoverflow.com/users/12184391/higa-lobo-pinheiro"}, "edited": false, "score": 0, "creation_date": 1570567633, "post_id": 58293660, "comment_id": 102951745, "body": "The database name in SQL Server is &quot;AdvantechDB&quot;. And the table I want to insert the data into is &quot;Data_Backup_Modbus-001: tag001&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1570567845, "post_id": 58293660, "comment_id": 102951809, "body": "Ok. Whoever named that table needs to get off whatever they&#39;re smoking... and you need to make that <code>[Data_Back_Modbus-001: tag001]</code> (<b>with</b> the square brackets). There are other problems though, answer is WIP."}, {"owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "edited": false, "score": 0, "creation_date": 1570567924, "post_id": 58293660, "comment_id": 102951827, "body": "One of your parameters have &#39; in the value so is breaking the Sql String"}, {"owner": {"reputation": 3630, "user_id": 594448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c81ad5b15d9353a11a0ac96faf0dcba?s=128&d=identicon&r=PG", "display_name": "pmbAustin", "link": "https://stackoverflow.com/users/594448/pmbaustin"}, "edited": false, "score": 0, "creation_date": 1570568178, "post_id": 58293660, "comment_id": 102951880, "body": "You should never ever name a table like &quot;Data_Back_Modbus-001: tag001&quot; -- that&#39;s pure insanity. Stop it. But if you HAVE to have a table with that horrific monstrosity of a name, you MUST enclose it in square brackets every time it&#39;s referenced. Hint: don&#39;t put dots or periods in table names either. Seriously, look up some naming standards and stick to them."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3630, "user_id": 594448, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7c81ad5b15d9353a11a0ac96faf0dcba?s=128&d=identicon&r=PG", "display_name": "pmbAustin", "link": "https://stackoverflow.com/users/594448/pmbaustin"}, "edited": false, "score": 0, "creation_date": 1570568387, "post_id": 58293660, "comment_id": 102951951, "body": "@pmbAustin to be fair the naming is likely out of OP&#39;s hands. Fully agree on the insanity of it though."}, {"owner": {"reputation": 3, "user_id": 12184391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WFynh.jpg?s=128&g=1", "display_name": "Higa Lobo Pinheiro", "link": "https://stackoverflow.com/users/12184391/higa-lobo-pinheiro"}, "edited": false, "score": 0, "creation_date": 1570568697, "post_id": 58293660, "comment_id": 102952057, "body": "I am using a device that when connecting to SQL Server automatically creates a table in my database. I agree with the insanity of this name. Better to change it."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1570569312, "last_edit_date": 1570569312, "creation_date": 1570568263, "answer_id": 58293987, "question_id": 58293660, "link": "https://stackoverflow.com/questions/58293660/incorrect-syntax-near/58293987#58293987", "title": "Incorrect Syntax Near &quot;-&quot;", "body": "\n\n<p>I believe the <code>-</code> in what appears to be the table name, is what's causing the problem you're seeing - but there are other issues in the SQL statement itself, and you will absolutely want to address them.</p>\n\n<p>Delete your <code>StrRs</code> declaration and assignment.</p>\n\n<p>Then have a local <code>Const</code>, and use <code>[</code> and <code>]</code> characters to delimit <em>quoted identifiers</em> - when your table name isn't a standard <code>PascalCase</code> identifier (why would you do this to yourself?!), you <em>must</em> quote it in queries (that is, enclose it in square brackets).</p>\n\n<p>Note the space between <code>)</code> and <code>VALUES</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Const sql As String = _\n    \"INSERT INTO [Data_Backup_Modbus-001:tag001](ID,DataValue,Quality,TimeStamp,TimeStamp2) VALUES(?, ?, ?, ?, ?)\"\n</code></pre>\n\n<p>The <code>sql</code> string will be the same for every row. What's going to change at each iteration, is the values of the <em>parameters</em> (each parameter is a literal <code>?</code> in the command text, without any quotes or concatenations).</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>For i = 2 To FinalLinha\n    Dim cmd As ADODB.Command '&lt;~ DO NOT declare this \"As New\"\n    Set cmd = New ADODB.Command\n    Set cmd.ActiveConnection = Cn\n    cmd.CommandText = sql\n\n    'the fun begins - append parameters in the same order they appear in the command string:\n    ID = Planilha1.Cells(i, 1)\n    DataValue = Planilha1.Cells(i, 2)\n    Quality = Planilha1.Cells(i, 3)\n    TimeStamp = Planilha1.Cells(i, 4)\n    TimeStamp2 = Planilha1.Cells(i, 5)\n\n    cmd.Parameters.Append cmd.CreateParameter(Value:=ID, Type:=adVarChar, Length:=Len(ID), Direction:=adParamInput)\n    cmd.Parameters.Append cmd.CreateParameter(Value:=DataValue, ...)\n    cmd.Parameters.Append ...\n    cmd.Parameters.Append ...\n    cmd.Parameters.Append ...\n\n    cmd.Execute '&lt;~ note: zero need for any recordset here\nNext\n</code></pre>\n\n<p>When you use parameterized commands, you never need to care about single quotes; your code gets much cleaner, and a side effect is that it's also more secure (see Bobby Tables XKCD link above), and as a bonus Mr. O'Connor won't break anything.</p>\n\n<hr>\n\n<p>Watch out here:</p>\n\n<blockquote>\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Cn As New ADODB.Connection\nDim Rs As New ADODB.Recordset\n</code></pre>\n</blockquote>\n\n<p>These are <em>auto-instantiated objects</em>, and the last thing you want is an object that magically respawns automatically.</p>\n\n<p>If this code doesn't output exactly what you expect, then avoid <code>As New</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub TestAndWeep()\n    Dim foo As New Collection\n    foo.Add 42\n    Debug.Print foo.Count\n    Set foo = Nothing\n    Debug.Print foo Is Nothing '&lt;~ expecting True, are you?\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 12184391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WFynh.jpg?s=128&g=1", "display_name": "Higa Lobo Pinheiro", "link": "https://stackoverflow.com/users/12184391/higa-lobo-pinheiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1570652406, "creation_date": 1570652406, "answer_id": 58311700, "question_id": 58293660, "link": "https://stackoverflow.com/questions/58293660/incorrect-syntax-near/58311700#58311700", "title": "Incorrect Syntax Near &quot;-&quot;", "body": "<p>My friends,</p>\n\n<p>Problem solved. The table name was the cause of the error \"Incorret Syntax Near\" - \". There were also other errors in the SQL statements, as mentioned by @Mathieu Guindon. I thank you infinitely for your help.</p>\n\n<p>Below is the result code (Disregard the values as they are random):</p>\n\n<pre><code>Sub InsertSQL()\n\nDim Cn As New ADODB.Connection\nDim Rs As New ADODB.Recordset\nDim StrCn As String\nDim cmd As ADODB.Command\nDim DateTime As Date\n\nStrCn = \"Provider=SQLOLEDB.1; Initial Catalog=AdvantechDB; Data Source=WIN-I2US3L4IBGJ\\HISTSQLSERVER;User Id=sa;Password=libra*123\"\n\nCn.Open StrCn\n\n    Set cmd = New ADODB.Command\n    Set cmd.ActiveConnection = Cn\n\n    cmd.Parameters.Append cmd.CreateParameter(DataValue, adInteger, adParamInput, Len(DataValue))\n    cmd.Parameters.Append cmd.CreateParameter(Quality, adInteger, adParamInput, Len(Quality))\n    cmd.Parameters.Append cmd.CreateParameter(TimeStamp, adDBTimeStamp, adParamInput, Len(TimeStamp))\n    cmd.Parameters.Append cmd.CreateParameter(TimeStamp2, adDBTimeStamp, adParamInput, Len(TimeStamp2))\n    cmd.Parameters.Append cmd.CreateParameter(DateTime, adDBDate, adParamInput, Len(DateTime))\n\nConst sql As String = _\n    \"INSERT INTO [ufvanta5](DataValue,Quality,TimeStamp,TimeStamp2,DateTime) VALUES(1,32772,1567998000,599147,'2019-10-09 17:30:00')\"\n\nRs.Open sql, Cn\n\nCn.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12184391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WFynh.jpg?s=128&g=1", "display_name": "Higa Lobo Pinheiro", "link": "https://stackoverflow.com/users/12184391/higa-lobo-pinheiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 58293987, "answer_count": 2, "score": 0, "last_activity_date": 1570652406, "creation_date": 1570566449, "last_edit_date": 1570566864, "question_id": 58293660, "link": "https://stackoverflow.com/questions/58293660/incorrect-syntax-near", "title": "Incorrect Syntax Near &quot;-&quot;", "body": "<p>My friends,</p>\n\n<p>I am running code via VBA to insert values into a table in SQL Server. However, the following error occurs: \"Incorret Syntax Near\" - \". Following all steps pressing F8, the error occurs in \"Rs.Open StrRs, Cn\". Help me find the error? </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub InsertSQL()    \n\nDim Cn As New ADODB.Connection\nDim Rs As New ADODB.Recordset\nDim StrCn, StrRs As String\nDim FinalLinha As Long\n\nFinalLinha = Planilha1.UsedRange.Rows.Count\n\nStrCn = \"Provider=SQLOLEDB.1; Initial Catalog=AdvantechDB; Data Source=WIN-I2US3L4IBGJ\\HISTSQLSERVER;User Id=sa;Password=libra*123\"\n\nCn.Open StrCn\n\nFor i = 2 To FinalLinha\n\n    ID = Planilha1.Cells(i, 1)\n    DataValue = Planilha1.Cells(i, 2)\n    Quality = Planilha1.Cells(i, 3)\n    TimeStamp = Planilha1.Cells(i, 4)\n    TimeStamp2 = Planilha1.Cells(i, 5)\n\nStrRs = \"INSERT INTO Data_Backup_Modbus-001:tag001(ID,DataValue,Quality,TimeStamp,TimeStamp2)\" &amp; _\n        \"VALUES('\" &amp; ID &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; DataValue &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; Quality &amp; \"','\" &amp; TimeStamp &amp; \"','\" &amp; TimeStamp2 &amp; \"')\"\n\n        Rs.Open StrRs, Cn\n\n        Next i\n\n Rs.Close\n Cn.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 0, "creation_date": 1570566721, "post_id": 58293604, "comment_id": 102951416, "body": "maybe with a few <code>else</code>?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570567764, "post_id": 58293604, "comment_id": 102951783, "body": "Problem with ElseIf is if all 5 are not yet approved, only Mfg_Engineer message will trigger. So exactly what do you want to do? If you want to check all five then issue a composite message that identifies which items are not yet approved, that will get a little more complicated."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6235970"}, "is_accepted": false, "score": 1, "last_activity_date": 1570567423, "last_edit_date": 1570567423, "creation_date": 1570566683, "answer_id": 58293701, "question_id": 58293604, "link": "https://stackoverflow.com/questions/58293604/combine-multiple-if-statements-into-one/58293701#58293701", "title": "Combine multiple if statements into one", "body": "<p>You can do this with <code>If.. ElseIf .. Else</code></p>\n\n<pre><code>If Me.Status_Mfg_Engineer &lt;&gt; \"Approved\" Then MsgBox \"MFG Engineer has not approved\"\nElseIf Me.Status_Quality &lt;&gt; \"Approved\" Then MsgBox \"Quality has not approved\"\nElseIf Me.Status_Production &lt;&gt; \"Approved\" Then MsgBox \"Production has not approved\"\nElseIf Me.Status_Product_Engineer &lt;&gt; \"Approved\" Then MsgBox \"Product Engineer has not approved\"\nElseIf Me.Status_Other &lt;&gt; \"Approved\" Then MsgBox \"Other has not approved\"\nEnd If \n</code></pre>\n\n<p>Edit 2:\nAh yes (@June7) - according to docs <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/if-then-else-statement\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1570568146, "creation_date": 1570568146, "answer_id": 58293963, "question_id": 58293604, "link": "https://stackoverflow.com/questions/58293604/combine-multiple-if-statements-into-one/58293963#58293963", "title": "Combine multiple if statements into one", "body": "<p>If you want to test all items then issue a single composite message, consider:</p>\n\n<pre><code>Dim strMsg As String\nIf Me.Status_Mfg_Engineer &lt;&gt; \"Approved\" Then strMsg = \"MFG Engineer\" &amp; vbCrLf\nIf Me.Status_Quality &lt;&gt; \"Approved\" Then strMsg = strMsg &amp; \"Quality\" &amp; vbCrLf\nIf Me.Status_Production &lt;&gt; \"Approved\" Then strMsg = strMsg &amp; \"Production\" &amp; vbCrLf\nIf Me.Status_Product_Engineer &lt;&gt; \"Approved\" Then strMsg = strMsg &amp; \"Product Engineer\" &amp; vbCrLf\nIf Me.Status_Other &lt;&gt; \"Approved\" Then strMsg = strMsg &amp; \"Other\" &amp; vbCrLf\nIf strMsg &lt;&gt; \"\" Then MsgBox \"Items not approved: \" &amp; vbCrLf &amp; strMsg\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 12080420, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220427798633962/picture?type=large", "display_name": "hotwatt", "link": "https://stackoverflow.com/users/12080420/hotwatt"}, "edited": false, "score": 0, "creation_date": 1570635504, "post_id": 58294002, "comment_id": 102977094, "body": "That is exactly what I was looking for! Thanks for the help!"}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 1, "last_activity_date": 1570568394, "creation_date": 1570568394, "answer_id": 58294002, "question_id": 58293604, "link": "https://stackoverflow.com/questions/58293604/combine-multiple-if-statements-into-one/58294002#58294002", "title": "Combine multiple if statements into one", "body": "<p>You want a single message box which summarises which agents have not approved.</p>\n\n<pre><code>Dim myPrompt as string\nmyPrompt=vbnullstring\n\nIf Me.Status_Mfg_Engineer &lt;&gt; \"Approved\" Then myPrompt= \"MFG Engineer has not approved\"\nIf Me.Status_Quality &lt;&gt; \"Approved\" Then myPrompt=myPrompt &amp; vbcrlf &amp; \"Quality has not approved\"\nIf Me.Status_Production &lt;&gt; \"Approved\" Then myPrompt=myPrompt &amp; vbcrlf &amp; \"Production has not approved\"\nIf Me.Status_Product_Engineer &lt;&gt; \"Approved\" Then myPrompt=myPrompt &amp; vbcrlf &amp; \"Product Engineer has not approved\"\nIf Me.Status_Other &lt;&gt; \"Approved\" Then myPrompt=myPrompt &amp; vbcrlf &amp; \"Other has not approved\" \n\nMsgBox _\n    Title:=\"Missing approvals\", _\n    Prompt:=myPrompt, _\n    Buttons:=vbOkOnly\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12080420, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220427798633962/picture?type=large", "display_name": "hotwatt", "link": "https://stackoverflow.com/users/12080420/hotwatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58294002, "answer_count": 3, "score": 0, "last_activity_date": 1570568394, "creation_date": 1570566231, "last_edit_date": 1570567278, "question_id": 58293604, "link": "https://stackoverflow.com/questions/58293604/combine-multiple-if-statements-into-one", "title": "Combine multiple if statements into one", "body": "<p>This is probably a simple solution but I am having trouble getting anything to work. Might just be the syntax. </p>\n\n<p>Basically I want to merge these together so that one message box will pop up instead of 5. </p>\n\n<pre><code>If Me.Status_Mfg_Engineer &lt;&gt; \"Approved\" Then MsgBox \"MFG Engineer has not approved\"\nIf Me.Status_Quality &lt;&gt; \"Approved\" Then MsgBox \"Quality has not approved\"\nIf Me.Status_Production &lt;&gt; \"Approved\" Then MsgBox \"Production has not approved\"\nIf Me.Status_Product_Engineer &lt;&gt; \"Approved\" Then MsgBox \"Product Engineer has not approved\"\nIf Me.Status_Other &lt;&gt; \"Approved\" Then MsgBox \"Other has not approved\" \n</code></pre>\n"}, {"tags": ["vba", "google-chrome", "imacros"], "comments": [{"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "edited": false, "score": 0, "creation_date": 1570951058, "post_id": 58293435, "comment_id": 103074576, "body": "For those interested, + Parallel Thread on the iMacros Forum: <a href=\"https://forum.imacros.net/viewtopic.php?f=7&amp;t=30582&amp;p=83736#p83682\" rel=\"nofollow noreferrer\">forum.imacros.net/&hellip;</a> - With more Info I would think but 1st Answer by @TL has already been accepted in the meantime... (And I don&#39;t completely understand why...)"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "edited": false, "score": 0, "creation_date": 1570951557, "post_id": 58293435, "comment_id": 103074647, "body": "Test-Test: SOF still buggy-buggy...!? =&gt; Yep it is, ah-ah...!!"}], "answers": [{"comments": [{"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "reply_to_user": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1570633581, "post_id": 58294182, "comment_id": 102976048, "body": "Good luck :) That isnt science anymore by MS <i>grin</i>"}, {"owner": {"reputation": 531, "user_id": 3799241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RbaFt.jpg?s=128&g=1", "display_name": "chivracq", "link": "https://stackoverflow.com/users/3799241/chivracq"}, "edited": false, "score": 0, "creation_date": 1570952088, "post_id": 58294182, "comment_id": 103074720, "body": "I don&#39;t think that&#39;s the correct Answer/Solution (in this Case), see my Reply on the iMacros Forum: <a href=\"https://forum.imacros.net/viewtopic.php?f=7&amp;t=30582&amp;p=83736#p83697\" rel=\"nofollow noreferrer\">forum.imacros.net/&hellip;</a> - but @OP is apparently happy with it... Hum, OK, even if I didn&#39;t really understand &quot;everything&quot;... (And yep, I&#39;m familiar with all IE-Emulation Values in Reg...)"}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1570964094, "post_id": 58294182, "comment_id": 103077064, "body": "I did not say that it work in every case. But that it might be worth to give it a try.  It is also a universal problem with this kind of IE DLL calling components which can be solved sometimes like that. And the basic Idea behind is, that the IE component might be in compabillity state. Usually IE11 is not as bad as most Peoples belive.So what is your problem ? Do you solve it ? Do you even try to solve it ?"}], "tags": [], "owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "is_accepted": true, "score": 0, "last_activity_date": 1570593658, "last_edit_date": 1570593658, "creation_date": 1570569370, "answer_id": 58294182, "question_id": 58293435, "link": "https://stackoverflow.com/questions/58293435/running-imacros-for-chrome-with-vba/58294182#58294182", "title": "Running iMacros for Chrome with VBA", "body": "<p>It might be an idea to check if your IE thing runs in compatibility mode. I've had same issues with the webbrowser control in VBA using Autocad. Even if IE was installed if I navigate to a website showing the browser version I got Stonehenge old IE6 shown.\nSo this might also happen in your case. I am quite sure they just utilize the  MS IE Engine. Here is a link which looks outdated but it's all the same:\n<a href=\"https://social.msdn.microsoft.com/Forums/en-US/e5615a22-60c5-457f-a5c7-1c39c2ed0bd6/browser-compatibilty-view-issue-from-within-access?forum=accessdev\" rel=\"nofollow noreferrer\">Same with Acces upgrade to IE 11</a> After I put acad.exe in the registry with the 11000 value Stonehenge was gone :)</p>\n\n<pre><code>Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_BROWSER_EMULATION\n</code></pre>\n\n<p>Add a key with the name of your running executable and the DWORD 11000.\nSo it just might be an idea to investigate in the same direction. </p>\n"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 58294182, "answer_count": 1, "score": 0, "last_activity_date": 1570593658, "creation_date": 1570565507, "question_id": 58293435, "link": "https://stackoverflow.com/questions/58293435/running-imacros-for-chrome-with-vba", "title": "Running iMacros for Chrome with VBA", "body": "<p>I've developed a number of macros that use VBA to open iMacros and scrape / update various websites.  Normally, I use the iMacros browser and occasionally the IE browser.  I'm working on a new macro but the website does respond well to either the iMacros or IE browser.  </p>\n\n<p>I'm trying to user iMacros for Chrome.  From what I have read, I should be able to open iMacros for Chrome like this:</p>\n\n<pre><code>Set iim1 = CreateObject(\"imacros\")\niret = iim1.iimOpen(\"-cr\", True)\n</code></pre>\n\n<p>However, it isn't working like I expect it to.  It opens Chrome and then after about 60 seconds, it shuts Chrome down without executing any other commands in my macro. </p>\n\n<p>Am I doing something wrong or is something not installed correctly?  Any suggestions would be appreciated.  This is the first macro I'm developing with Chrome.</p>\n\n<p>These are the settings I'm currently using:\nOffice 365 (Excel 2016)\niMacros for Chrome 12.0.501.6698\nWindows 10\n64 bit OS\nChrome version 77.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1570565382, "post_id": 58293373, "comment_id": 102950849, "body": "What is in those cells (text)? You most likely don&#39;t want the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/str-function\" rel=\"nofollow noreferrer\"><code>Str</code></a> function. The type mismatch is because <code>Range(&quot;A1:B2&quot;)</code> is a call to the default member, i.e. is <code>Range(&quot;A1:B2&quot;).Value</code>, which returns a 2D array (and you can&#39;t pass an array to <code>Str</code>)."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570565648, "post_id": 58293373, "comment_id": 102950949, "body": "Is there a benefit to dimming all of these variables just to to <code>.To = strTo</code> later down the road? Seems like you can just input these values when they are needed which would erase the need for just about all of the code you shared. It&#39;s not redundant, but very close to it. That is said without knowing the context so I could be wrong"}, {"owner": {"reputation": 56, "user_id": 10162440, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uNdUSJiAh_U/AAAAAAAAAAI/AAAAAAAAM08/cvnNrqZZWBU/photo.jpg?sz=128", "display_name": "BamBoys", "link": "https://stackoverflow.com/users/10162440/bamboys"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570566652, "post_id": 58293373, "comment_id": 102951388, "body": "@BigBen - I am hoping to post a table of data with data labels into the body of an email that will be sent daily.  I am using powerquery to automatically refresh the table each day.  I did not write this code, I am simply following a tutorial and modifying for my needs.  You can see the tutorial here: <a href=\"https://www.youtube.com/watch?v=zNGd_9jedbQ\" rel=\"nofollow noreferrer\">youtube.com/watch?v=zNGd_9jedbQ</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570566848, "post_id": 58293373, "comment_id": 102951480, "body": "Assuming that all four cells in the range <code>A1:B2</code> have values, are you positive that <code>Str(Sheet1.Cells(1, 1)) &amp; Str(Sheet1.Cells(1, 2))</code> actually returns all that data? AFAIK, It should just return what&#39;s in <code>A1</code> and <code>B2</code>, but leaves out anything in <code>A2</code> and <code>B1</code>..."}, {"owner": {"reputation": 56, "user_id": 10162440, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uNdUSJiAh_U/AAAAAAAAAAI/AAAAAAAAM08/cvnNrqZZWBU/photo.jpg?sz=128", "display_name": "BamBoys", "link": "https://stackoverflow.com/users/10162440/bamboys"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570567353, "post_id": 58293373, "comment_id": 102951639, "body": "@BruceWayne You are correct,      Str(Sheet1.Cells(1, 1)) &amp; Str(Sheet1.Cells(1, 2))  returns only the data in A1 and B2.  That&#39;s why I am trying to target a bigger range but not having any luck."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1570567465, "last_edit_date": 1592644375, "creation_date": 1570567465, "answer_id": 58293854, "question_id": 58293373, "link": "https://stackoverflow.com/questions/58293373/how-to-select-range-of-cells-instead-of-only-2-cells-for-strbody-variable/58293854#58293854", "title": "How to select range of cells instead of only 2 cells for strBody variable?", "body": "<p>Without seeing your data, you might consider building a UDF:</p>\n<pre><code>...\nstrBody = build_body(ActiveWorkbook.Sheets(&quot;Sheet1&quot;).Range(&quot;A1:B2&quot;))\nEnd Sub\n\nFunction build_body(rng As Range, Optional delimiter As String = &quot; &quot;) As String\nDim cel As Range\nDim tmpStr As String\nFor Each cel In rng.Cells\n    If tmpStr &lt;&gt; &quot;&quot; Then tmpStr = tmpStr &amp; delimiter &amp; cel.Value\n    If tmpStr = &quot;&quot; Then tmpStr = cel.Value\nNext cel\nDebug.Print tmpStr\nbuild_body = tmpStr\nEnd Function\n</code></pre>\n<p>With sample data:</p>\n<p><a href=\"https://i.stack.imgur.com/SuDl1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SuDl1.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Outputs: <code>A1, B1, A2, B2</code>.</p>\n<p>Doing just <code>Str(Sheet1.Cells(1, 1)) &amp; Str(Sheet1.Cells(1, 2))</code> would output <code>A1B1</code>.</p>\n"}], "owner": {"reputation": 56, "user_id": 10162440, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uNdUSJiAh_U/AAAAAAAAAAI/AAAAAAAAM08/cvnNrqZZWBU/photo.jpg?sz=128", "display_name": "BamBoys", "link": "https://stackoverflow.com/users/10162440/bamboys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570567465, "creation_date": 1570565215, "last_edit_date": 1570565446, "question_id": 58293373, "link": "https://stackoverflow.com/questions/58293373/how-to-select-range-of-cells-instead-of-only-2-cells-for-strbody-variable", "title": "How to select range of cells instead of only 2 cells for strBody variable?", "body": "<p>VBA watch window shows \"type mismatch\" and Empty for values <code>strBody</code> variable and value when running this script.  I've confirmed the email portion of this script works.  I simply cannot select the range of cells I want.  Help?</p>\n\n<p>I'd like to be able to select a range for the <code>strBody</code> variable.  </p>\n\n<p>If I replace the <code>strBody</code> variable with the following, everything works:</p>\n\n<p><code>strBody = Str(Sheet1.Cells(1, 1)) &amp; Str(Sheet1.Cells(1, 2))</code></p>\n\n<pre><code>Sub send_email()\nDim NewMail As Object\nDim MailConfig As Object\nDim SMTP_Config As Variant\nDim strSubject As String\nDim strFrom As String\nDim strTo As String\nDim strCc As String\nDim strBcc As String\nDim strBody As Variant\n\nstrSubject = \"Mail from Excel\"\nstrFrom = \"email@gmail.com\"\nstrTo = \"email@gmail.com\"\nstrCc = \"\"\nstrBcc = \"\"\nstrBody = Str(ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1:B2\"))\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1570605057, "creation_date": 1570605057, "answer_id": 58298826, "question_id": 58293242, "link": "https://stackoverflow.com/questions/58293242/pulling-data-from-an-access-subform-run-time-error-438/58298826#58298826", "title": "Pulling data from an Access subform: Run Time error 438", "body": "<p>You must address the controls via the subforms' <em>Form</em> property:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command91_Click()\n\nMe.Plates = Me.MealPlannerSubformsf.Form!TotalMeals\nMe.MealSubtotal = Me.Plates * Me.MealRate\nMe.Sleeps = Me.LodgingDetailsSubformsf.Form!TotSleepers\nMe.LodgingSubtotal = Me.Sleeps * Me.LodgingRate\nMe.ExpectedTotal = Me.MealSubtotal + Me.LodgingSubtotal + Me.ReservationFee\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12110228, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7maXYi9ppgI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfVqCYlQgvqz-BPB068hqtDMEGtuw/photo.jpg?sz=128", "display_name": "Chris Cornish", "link": "https://stackoverflow.com/users/12110228/chris-cornish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593676672, "creation_date": 1570564577, "last_edit_date": 1593676672, "question_id": 58293242, "link": "https://stackoverflow.com/questions/58293242/pulling-data-from-an-access-subform-run-time-error-438", "title": "Pulling data from an Access subform: Run Time error 438", "body": "<p>When I click on my \"Calculate Total\" button (which worked yesterday), I get</p>\n\n<blockquote>\n  <p>Run Time Error 438 Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>The code is on a button click event within a form and references a couple different subforms within that form. I tried rebuilding the code and main form. </p>\n\n<pre><code>Private Sub Command91_Click()\n\nMe.Plates = Me.MealPlannerSubformsf!TotalMeals\nMe.MealSubtotal = Me.Plates * Me.MealRate\nMe.Sleeps = Me.LodgingDetailsSubformsf!TotSleepers\nMe.LodgingSubtotal = Me.Sleeps * Me.LodgingRate\nMe.ExpectedTotal = Me.MealSubtotal + Me.LodgingSubtotal + Me.ReservationFee\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1570563336, "post_id": 58292881, "comment_id": 102950040, "body": "If you go into the VBE and select the Calculate event from the drop down you will see that it does not have any parameters, and sadly you can&#39;t just add them manually and hope it will work."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1570563421, "post_id": 58292881, "comment_id": 102950083, "body": "So maybe use an event based on a source cell. I&#39;m sure there are plenty of examples online."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1570563459, "post_id": 58292881, "comment_id": 102950106, "body": "Unrelated note: check out this cool <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenter</a> to clean up the indentation."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1570564237, "post_id": 58292881, "comment_id": 102950403, "body": "I&#39;m surprised it compiles at all. Event handler signatures can&#39;t be messed with - they have the parameters they are defined with, and tweaking the signature can only ever break things. <code>Worksheet.Calculate</code> is fired whenever <i>the worksheet</i> calculates."}, {"owner": {"reputation": 97, "user_id": 4509583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zda9x.jpg?s=128&g=1", "display_name": "Warren K", "link": "https://stackoverflow.com/users/4509583/warren-k"}, "edited": false, "score": 0, "creation_date": 1570601771, "post_id": 58292881, "comment_id": 102958819, "body": "Do you really mean <b>Range(&quot;C1401:I140&quot;)</b> in Line 6 of your code ?  I suspect you mean Range(&quot;C140:I140&quot;)."}, {"owner": {"reputation": 43, "user_id": 12170767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lGiwwdnsCiI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9em_ueK8qcUaKzUeqTsCu-7UtEg/photo.jpg?sz=128", "display_name": "Rina Tse", "link": "https://stackoverflow.com/users/12170767/rina-tse"}, "edited": false, "score": 0, "creation_date": 1570639412, "post_id": 58292881, "comment_id": 102978967, "body": "Ah thanks, you&#39;re right"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12170767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lGiwwdnsCiI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9em_ueK8qcUaKzUeqTsCu-7UtEg/photo.jpg?sz=128", "display_name": "Rina Tse", "link": "https://stackoverflow.com/users/12170767/rina-tse"}, "edited": false, "score": 0, "creation_date": 1570640068, "post_id": 58298131, "comment_id": 102979256, "body": "Thank you for your input and @BigBen for the indenter. However when I added the above line, MyMacro stopped responding (there was no error message, just nothing happened) after A1 changed and after A1 changed and I clicked Run Macro."}, {"owner": {"reputation": 97, "user_id": 4509583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zda9x.jpg?s=128&g=1", "display_name": "Warren K", "link": "https://stackoverflow.com/users/4509583/warren-k"}, "reply_to_user": {"reputation": 43, "user_id": 12170767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lGiwwdnsCiI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9em_ueK8qcUaKzUeqTsCu-7UtEg/photo.jpg?sz=128", "display_name": "Rina Tse", "link": "https://stackoverflow.com/users/12170767/rina-tse"}, "edited": false, "score": 0, "creation_date": 1570760524, "post_id": 58298131, "comment_id": 103024255, "body": "If you followed the instructions for where to add this code (in the Worksheet_Change event on the relevant worksheet) then you can easily verify that it indeed executes when cell A1 is changed simply by adding a Msgbox call or a breakpoint in the code where I had <b>&quot;[call your change routine]&quot;</b>. Then single-step (using [F8] key to see why your code is not doing what you expect."}, {"owner": {"reputation": 97, "user_id": 4509583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zda9x.jpg?s=128&g=1", "display_name": "Warren K", "link": "https://stackoverflow.com/users/4509583/warren-k"}, "reply_to_user": {"reputation": 43, "user_id": 12170767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lGiwwdnsCiI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9em_ueK8qcUaKzUeqTsCu-7UtEg/photo.jpg?sz=128", "display_name": "Rina Tse", "link": "https://stackoverflow.com/users/12170767/rina-tse"}, "edited": false, "score": 0, "creation_date": 1570760779, "post_id": 58298131, "comment_id": 103024299, "body": "It&#39;s also unclear whether you want your routine to execute when A1 changes, or a cell in Row 140 columns C to I.  If you call your (confusingly named) Worksheet_Calculate routine by passing the same <b>Target</b> passed into Worksheet_Change above then cell A1 will fail your intersect routine for row 140 and your routine will do nothing. :-)"}, {"owner": {"reputation": 97, "user_id": 4509583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zda9x.jpg?s=128&g=1", "display_name": "Warren K", "link": "https://stackoverflow.com/users/4509583/warren-k"}, "reply_to_user": {"reputation": 43, "user_id": 12170767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lGiwwdnsCiI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9em_ueK8qcUaKzUeqTsCu-7UtEg/photo.jpg?sz=128", "display_name": "Rina Tse", "link": "https://stackoverflow.com/users/12170767/rina-tse"}, "edited": false, "score": 0, "creation_date": 1571716448, "post_id": 58298131, "comment_id": 103322992, "body": "Hi Rina, I note that you didn&#39;t respond to any of my comments.  If you found the answer helpful please mark it as an answer. Thanks."}], "tags": [], "owner": {"reputation": 97, "user_id": 4509583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zda9x.jpg?s=128&g=1", "display_name": "Warren K", "link": "https://stackoverflow.com/users/4509583/warren-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1570602246, "creation_date": 1570602246, "answer_id": 58298131, "question_id": 58292881, "link": "https://stackoverflow.com/questions/58292881/automatically-run-macro-when-a-value-changes-as-the-result-of-vlookup/58298131#58298131", "title": "Automatically run macro when a value changes as the result of Vlookup", "body": "<p>If you want to do something when the value of your calculated Cell A1 changes then use the Worksheet<strong>_Change</strong> event on the relevant worksheet. </p>\n\n<p>(Find the worksheet in the VBA editor and right-click to select \"view code\")  </p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Application.Intersect(Range(\"$A$1\"), Target) Is Nothing Then\n         ... [call your change_routine]\n    end if\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 12170767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lGiwwdnsCiI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd9em_ueK8qcUaKzUeqTsCu-7UtEg/photo.jpg?sz=128", "display_name": "Rina Tse", "link": "https://stackoverflow.com/users/12170767/rina-tse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570602246, "creation_date": 1570562968, "question_id": 58292881, "link": "https://stackoverflow.com/questions/58292881/automatically-run-macro-when-a-value-changes-as-the-result-of-vlookup", "title": "Automatically run macro when a value changes as the result of Vlookup", "body": "<p>I want MyMacro to run automatically when the cell value in A1 changes according to a vlookup formula. MyMacro copies a row then pastes it to a different section of the worksheet when a condition dependant on the value of A1 is met.</p>\n\n<p>I have tried variations of Target.Address and the following, which have not worked:</p>\n\n<pre><code>Public Sub Worksheet_Calculate(ByVal Target As Range)\nStatic OldVal As Variant\n   If Range(\"A1\").Value &lt;&gt; OldVal Then\n      OldVal = Range(\"A1\").Value\n\nIf Not Intersect(Target(1), Range(\"C1401:I140\")) Is Nothing Then\nIf Range(\"A1\").Value &lt; ActiveSheet.Range(\"A1\").Value Then\n    Range(\"C140:I140\").Value = Range(\"B55:H55\").Value\n        ElseIf Range(\"B55\").Value &gt; ActiveSheet.Range(\"A1\").Value Then\n         Range(\"C140:I140\").Formula = \"\"\nEnd If\n  End If\n    End If\n\nEnd Sub\n\nPublic Sub MyMacro()\n\nWorksheet_Calculate ([C140])\n\nEnd Sub\n</code></pre>\n\n<p>With this, MyMacro only works when I manually hit Run Macro after each time A1 changes. How can I get this to be automatic? </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1570567571, "post_id": 58292021, "comment_id": 102951714, "body": "I was trying for quite some time (close to an hour). Just happened to be the last thing I tried while I was waiting for a response. Also, since I couldn&#39;t find a question with this answer, I thought it would be nice for anyone who runs into a similar issue to find a quick answer."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "is_accepted": false, "score": 1, "last_activity_date": 1570559234, "creation_date": 1570559234, "answer_id": 58292090, "question_id": 58292021, "link": "https://stackoverflow.com/questions/58292021/how-can-i-format-a-range-value-amount-in-an-outlook-body/58292090#58292090", "title": "How can I format a range value amount in an outlook body", "body": "<p>Figured it out. Use the format function as shown below.</p>\n\n<p>Format(sh.Range(\"P\" &amp; i + 3), \"Standard\")</p>\n\n<p>This website shows all the formats : <a href=\"https://www.excelfunctions.net/vba-format-function.html\" rel=\"nofollow noreferrer\">https://www.excelfunctions.net/vba-format-function.html</a></p>\n"}], "owner": {"reputation": 41, "user_id": 10095729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a677fa900a15f4e03f359986922508ab?s=128&d=identicon&r=PG&f=1", "display_name": "iLL-Army", "link": "https://stackoverflow.com/users/10095729/ill-army"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1570559259, "creation_date": 1570558962, "last_edit_date": 1570559259, "question_id": 58292021, "link": "https://stackoverflow.com/questions/58292021/how-can-i-format-a-range-value-amount-in-an-outlook-body", "title": "How can I format a range value amount in an outlook body", "body": "<p><code>sh.Range(\"P\" &amp; i + 3).Value</code> contains a number. In the HTML body of the email message it's formatted as plain text. How can I change this value to include commas? </p>\n\n<p>Currently: <code>10000</code> </p>\n\n<p>Desired Results: <code>10,000.00</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570557181, "post_id": 58291577, "comment_id": 102947550, "body": "<code>Rows(&quot;1:15&quot;)</code> shifts the first row down. Sounds like that should be a <code>2:16</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 6, "creation_date": 1570557259, "post_id": 58291577, "comment_id": 102947592, "body": "Also the <code>Shift</code> should be <code>xlShiftDown</code> instead of <code>xlDown</code> (doesn&#39;t change the performance, but that is the correct enum member)."}], "answers": [{"tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1570605632, "last_edit_date": 1570605632, "creation_date": 1570561401, "answer_id": 58292559, "question_id": 58291577, "link": "https://stackoverflow.com/questions/58291577/stop-insert-rows-from-clearing-first-line-of-data/58292559#58292559", "title": "Stop insert rows from clearing first line of data", "body": "<p>I made up an example since you didn't provide one. The animated gif (click to see better quality) first shows 2 sheets and then shows that stepping through the code causes the data from sheet 1 to be copied into the 15 rows inserted at the top of sheet 2 without loss of what was at row 1.  </p>\n\n<p>I suggest you verify that this works and then modify the code for your situation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uP2eE.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uP2eE.gif\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\nSub insertIntoFirst15rows()\nDim data_sh As Worksheet, data_r As Range\nDim sh As Worksheet, r As Range\nSet data_sh = Worksheets(\"1\")\nSet data_r = data_sh.Range(\"A1\")\nSet data_r = data_sh.Range(data_r, data_r.End(xlDown))\nSet sh = Worksheets(\"2\")\nsh.Activate\nSet r = sh.Rows(\"1:15\")\nr.Insert Shift:=xlShiftDown\nSet r = Range(\"A1\")\nr.Select\ndata_r.Copy\nsh.Paste\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12160609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bCQiauM2r7Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3red2L-6xXs3Cp8WoBxfuSh8mKC12A/photo.jpg?sz=128", "display_name": "Doupis", "link": "https://stackoverflow.com/users/12160609/doupis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570605632, "creation_date": 1570556860, "question_id": 58291577, "link": "https://stackoverflow.com/questions/58291577/stop-insert-rows-from-clearing-first-line-of-data", "title": "Stop insert rows from clearing first line of data", "body": "<p>I have code that adds 15 rows to a spreadsheet that is copied over to a new spreadsheet. When I insert the rows it looks like it is overriding the first row of data that is already there. I need the first row of data to still be there.</p>\n\n<p>I am using some code I probably found here or on a website. Prior to this I filter all the data and remove the extra categories of rows.</p>\n\n<pre><code>'prep for adding departments and department subtotals\nRows(\"1:15\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\ndata_sh.Range(\"G:G\").Copy Worksheets(\"IMPORT-WIP\").Range(\"A1\")\nWorksheets(\"IMPORT-WIP\").Range(\"A:A\").RemoveDuplicates 1, xlYes\n</code></pre>\n\n<p>The first line of the first category is not there.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1570557336, "post_id": 58291468, "comment_id": 102947621, "body": "&quot;if any of the cell values&quot; - whenever you&#39;re facing a situation where you&#39;re looking at &quot;a bunch of X&quot; and need to do something with &quot;each X&quot;, what you want is to introduce a loop. See what <code>For...Next</code>, <code>For Each...Next</code>, and <code>Do...Loop</code> can do for you."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1570558179, "post_id": 58291468, "comment_id": 102947987, "body": "Hi Edna, Right now there are no references to the full range you&#39;re talking about in your question. For <code>C7:C10</code>, are you trying to compare these all against <code>B4</code>? If so we can draft up a loop function that would work."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1570563471, "creation_date": 1570563471, "answer_id": 58292991, "question_id": 58291468, "link": "https://stackoverflow.com/questions/58291468/compare-values-from-a-range-of-cells-to-another-cell-and-display-msgbox-for-cert/58292991#58292991", "title": "Compare values from a range of cells to another cell and display msgbox for certain criteria?", "body": "<p>This doesn't look very useful to me, so am guessing you want more to happen but this should start you off.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim r As Range\n\nIf Not (Application.Intersect(Range(\"B1:D10\"), Target) Is Nothing) Then\n    For Each r In Range(\"C7:C10\")\n        If r.Value &gt; Range(\"B4\").Value Then MsgBox r.Address &amp; \" is bigger than B4\"\n        If r.Value = 20 Then MsgBox r.Address &amp; \" is 20\"\n    Next r\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12182702, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCbiH7lEesJ9P5sUJa5Xz8FSHCDyA49qhb4usWt=k-s128", "display_name": "Edna", "link": "https://stackoverflow.com/users/12182702/edna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570563471, "creation_date": 1570556484, "last_edit_date": 1570559061, "question_id": 58291468, "link": "https://stackoverflow.com/questions/58291468/compare-values-from-a-range-of-cells-to-another-cell-and-display-msgbox-for-cert", "title": "Compare values from a range of cells to another cell and display msgbox for certain criteria?", "body": "<p>I have a value in <code>B4</code> I need to pop a msgbox if the values in <code>C7:C10</code> are higher than the value in <code>B4</code>.  I also need a different msgbox to pop if the any of the cell values = 20.  I have it working in the first cell <code>C7</code> but I don't know how to get the range to work.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo ExitSub\n    Dim One As Long\n    Dim Two As Long\n\n    One = Range(\"B4\").Value\n    Two = Range(\"C7\").Value\n\n    If Not (Application.Intersect(Range(\"B1:D10\"), Target) Is Nothing) Then\n        If (Two = 20) Then\n            MsgBox \"This requires a SOW!\"\n        ElseIf (One &lt; Two) Then\n            MsgBox \"The Number Exceeds the Package!\" &amp; vbNewLine &amp; \"Change the package or decrease the number.\"\n        End If\n    End If\n\nExitSub:\n\nEnd Sub\n</code></pre>\n\n<p>I don't know how to modify the code to look at the range and not just the one cell.</p>\n"}, {"tags": ["excel", "vba", "type-mismatch"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 2, "creation_date": 1570555411, "post_id": 58291150, "comment_id": 102946763, "body": "On what line are you recieving run time error 13?"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 1, "creation_date": 1570555974, "post_id": 58291150, "comment_id": 102947006, "body": "Change <code>Columns(&quot;myRange&quot;).Select</code> to <code>Columns(MyRange).Select</code>"}, {"owner": {"reputation": 11, "user_id": 12183685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9a7f79aaaa1de79dbe845a1316f5df?s=128&d=identicon&r=PG&f=1", "display_name": "HalEve", "link": "https://stackoverflow.com/users/12183685/haleve"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1570697156, "post_id": 58291150, "comment_id": 102997215, "body": "thanks all. @MilesFett I have removed the quotation marks around the defined variables! this is the new code but getting a new error now! &quot;Application-defined or object-defined error, Run-time error &#39;1004&#39; &quot; and it doesn&#39;t show the place of the code mistake"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1570713827, "post_id": 58291150, "comment_id": 103006582, "body": "Take out the <code>LookIn:=xlFormulas</code>"}], "owner": {"reputation": 11, "user_id": 12183685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9a7f79aaaa1de79dbe845a1316f5df?s=128&d=identicon&r=PG&f=1", "display_name": "HalEve", "link": "https://stackoverflow.com/users/12183685/haleve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1570697492, "creation_date": 1570555175, "last_edit_date": 1592644375, "question_id": 58291150, "link": "https://stackoverflow.com/questions/58291150/excel-error-13-vba-type-mismatch-for-columns-advancemenet-macro", "title": "excel Error 13 vba type mismatch for columns advancemenet macro", "body": "<p>I have tried to run this code in order to advance certain columns</p>\n<h3>Sheet1</h3>\n<p><a href=\"https://i.stack.imgur.com/gZ6lV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gZ6lV.png\" alt=\"enter image description here\" /></a></p>\n<h3>Sheet2</h3>\n<p><a href=\"https://i.stack.imgur.com/WncHG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WncHG.png\" alt=\"enter image description here\" /></a></p>\n<p>But my code always produce the same <code>error 13</code> error:</p>\n<pre><code>Sub TEST_REPLACECOLUMNS_TEST()\n\n    Worksheets(&quot;Sheet2&quot;).Activate\n    \n    Dim NumofColumns As Long\n    Dim NumofMoveMortg As Long\n    Dim NumofMoveOth As Long\n    Dim AssetNum As Long\n    \n    Dim FirstColumn As String\n    Dim StartColumn As String\n    Dim EndColumn As String\n    Dim MyRange As String\n    Dim StartMortg As String\n\n    NumofColumns = 3\n    NumofMoveMort = 15\n    NumofMoveOth = 1\n    \n    AssetNum = Worksheets(&quot;Sheet1&quot;).Range(&quot;b3&quot;).End(xlToLeft).Row\n    \n    StartMortg = &quot;C&quot;\n    FirstColumn = &quot;A&quot;\n    \n    StartColumn = Chr(Asc(&quot;FirstColumn&quot;) + NumofColumns * (AssetNum - 1))\n    EndColumn = Chr(Asc(&quot;FirstColumn&quot;) + NumofColumns * (AssetNum - 1) + NumofColumns)\n    \n    Let MyRange = StartColumn &amp; &quot;:&quot; &amp; EndColumn\n    \n    Columns(&quot;myRange&quot;).Select\n    Selection.Replace What:=&quot;$A&quot;, Replacement:=&quot;$&quot; &amp; (Chr(Asc(&quot;StartMortg&quot;) + NumofMoveMortg * (AssetNum - 1))), LookAt:=xlPart, _\n        SearchOrder:=xlByColumns, MatchCase:=False\n\nEnd Sub\n</code></pre>\n<p>the new code after removal of the quotation marks around the variables that are being used in the formulaes. I have also added &quot;LookIn:=xlFormulas&quot;</p>\n<p>Sub TEST_REPLACECOLUMNS_TEST()</p>\n<pre><code>Dim NumofColumns As Long\nDim NumofMoveMortg As Long\nDim NumofMoveOth As Long\nDim AssetNum As Long\n\nDim FirstColumn As String\nDim StartColumn As String\nDim EndColumn As String\nDim MyRange As String\nDim StartMortg As String\n\nNumofColumns = 3\nNumofMoveMort = 15\nNumofMoveOth = 1\n\nStartMortg = &quot;C&quot;\nFirstColumn = &quot;A&quot;\n\nWorksheets(&quot;Sheet1&quot;).Activate\n \nAssetNum = Worksheets(&quot;Sheet1&quot;).Range(&quot;b3&quot;).End(xlToLeft).Row\n\nWorksheets(&quot;Sheet2&quot;).Activate\n\nStartColumn = Chr(Asc(FirstColumn) + NumofColumns * (AssetNum - 1))\nEndColumn = Chr(Asc(FirstColumn) + NumofColumns * (AssetNum - 1) + NumofColumns)\n\nLet MyRange = StartColumn &amp; &quot;:&quot; &amp; EndColumn\n\nColumns(MyRange).Select\nSelection.Replace What:=&quot;$A&quot;, Replacement:=&quot;$&quot; &amp; (Chr(Asc(StartMortg) + NumofMoveMort * (AssetNum - 1))), LookIn:=xlFormulas, LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1570555288, "post_id": 58291061, "comment_id": 102946705, "body": "I think it would be more instructional if you were able to show the actual slow function. VBA functions can be very fast but you do need to take care to make them fast (turn off automatic calculation while their executing, using arrays instead of manipulating cells directly..etc)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1570556241, "post_id": 58291061, "comment_id": 102947132, "body": "The answer is basically &quot;because native is native, and VBA isn&#39;t&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12183657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/286895c4e82c97afb5b9a6571902795b?s=128&d=identicon&r=PG&f=1", "display_name": "Fra92", "link": "https://stackoverflow.com/users/12183657/fra92"}, "edited": false, "score": 0, "creation_date": 1570608911, "post_id": 58291418, "comment_id": 102962292, "body": "Yes, I figured that the need for VBA code to be interpreted was the real issue. Thank u very much for your support!"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1590156147, "post_id": 58291418, "comment_id": 109581536, "body": "Don&#39;t you think perhaps the interop is actually the main culprit in simple functions like the example? That is - a UDF requires reading/writing to the sheet 10,000 times rather than once as with a macro, and that&#39;s the majority of the reason it&#39;s slow, not because of multithreading or compiled vs interpreted code. Quite a tricky thing to time I imagine, but I just have a feeling the overhead in calling a function is more significant than the actual execution time of the code it contains (or doesn&#39;t, in this case!)."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1570556265, "creation_date": 1570556265, "answer_id": 58291418, "question_id": 58291061, "link": "https://stackoverflow.com/questions/58291061/vba-why-vba-udfs-are-so-slow-compared-with-native-excel-functions/58291418#58291418", "title": "VBA - Why VBA UDFs are so slow compared with native Excel functions?", "body": "<p>Several reasons.</p>\n\n<p>VBA functions need to run sequentially, off the UI/main thread, and the compiled p-code needs to be interpreted by the VBA runtime.</p>\n\n<p>Native functions are <em>native</em>. They're (presumably - AFAIK they're written in C++) already compiled to machine code that's readily executable and doesn't need to be recompiled and/or interpreted. Some native functions can also leverage multithreaded and \"background\" computing.</p>\n\n<p>As for speeding up your UDFs, we'd need to see your UDFs for that. A function that does nothing other than assigning a literal return value, doesn't have much room for optimization does it?</p>\n\n<p>UDFs are great. But they're not a silver bullet. If I wanted to write the value <code>0</code> to <code>A1:A1000000</code>, I'd do <code>Sheet1.Range(\"A1:A1000000\").Value = 0</code> and that would be near-instant.</p>\n\n<p>Consider looking into macros rather than UDFs if you're going to have hundreds of thousands of them to calculate.</p>\n"}, {"comments": [{"owner": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1593176945, "post_id": 58296635, "comment_id": 110695838, "body": "Erm... No VBA isn&#39;t interpreted, it&#39;s compiled to <code>PCode</code> which is then interpreted at runtime. Formulas are still interpreted too, but may indeed be linked to compiled C functions."}, {"owner": {"reputation": 46, "user_id": 12026968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/822b40e3bf9a165278e846612f0f1654?s=128&d=identicon&r=PG&f=1", "display_name": "beyphy", "link": "https://stackoverflow.com/users/12026968/beyphy"}, "reply_to_user": {"reputation": 2017, "user_id": 6302131, "user_type": "registered", "accept_rate": 30, "profile_image": "https://lh5.googleusercontent.com/-upxNYfE-Cr4/AAAAAAAAAAI/AAAAAAAAAB8/FR6BaGFHNo8/photo.jpg?sz=128", "display_name": "Sancarn", "link": "https://stackoverflow.com/users/6302131/sancarn"}, "edited": false, "score": 0, "creation_date": 1593271287, "post_id": 58296635, "comment_id": 110723674, "body": "@Sancarn Compiled typically means that it&#39;s compiled into something like an EXE or a DLL, which VBA code never is. My statement was based on <a href=\"http://www.cpearson.com/Excel/CreatingCOMAddIn.aspx\" rel=\"nofollow noreferrer\">this comment</a> from Chip Pearson: &quot;Performance -- A CAI is an ActiveX DLL that is compiled into native machine code. A CAI runs considerably faster than the interpreted code of VBA.&quot;"}], "tags": [], "owner": {"reputation": 46, "user_id": 12026968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/822b40e3bf9a165278e846612f0f1654?s=128&d=identicon&r=PG&f=1", "display_name": "beyphy", "link": "https://stackoverflow.com/users/12026968/beyphy"}, "is_accepted": false, "score": 1, "last_activity_date": 1570591561, "creation_date": 1570591561, "answer_id": 58296635, "question_id": 58291061, "link": "https://stackoverflow.com/questions/58291061/vba-why-vba-udfs-are-so-slow-compared-with-native-excel-functions/58296635#58296635", "title": "VBA - Why VBA UDFs are so slow compared with native Excel functions?", "body": "<p>There are a number of different reasons for this.</p>\n\n<p>For one VBA UDFs are interpreted whereas native Excel worksheet functions are compiled. You would get big speed increases if you compiled your VBA code as VB6 for example. VBA and VB6 code are either the same or almost exactly the same. So the reason for the big speed increase would just be that the VB6 code is compiled rather than interpreted like VBA code is.</p>\n\n<p>VBA code also doesn't produce the same type of worksheet functions that Excel does. VBA UDFs lack worksheet intellisense for example. You can't get this in any way through VBA. You can get it through external add-ins elsewhere however (e.g. Excel DNA.)</p>\n\n<p>Another reason is that VBA isn't the best API for writing performant UDFs. That would be the C API. But the C API is harder to write UDFs in than in VBA.</p>\n\n<p>There are also a number of other things that could affect speed, like your underlying hardware, or the algorithm you're using in the UDF. It's hard to give you useful suggestions without seeing your code.</p>\n\n<p>Are you sure you need UDFs? The only advantages UDFs have over macros (that I'm aware of anyway) is that they don't delete the undostack after they're called whereas most macros do. And they can recalculate dynamically whereas you continuously have to rerun macros after they're called (unless you're using a worksheet event or something.)</p>\n\n<p>If you're doing a ton of calculations on a range of cells, it's probably better to just write the range to an array, manipulate it in VBA, and then just write it back to the range.</p>\n"}], "owner": {"reputation": 11, "user_id": 12183657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/286895c4e82c97afb5b9a6571902795b?s=128&d=identicon&r=PG&f=1", "display_name": "Fra92", "link": "https://stackoverflow.com/users/12183657/fra92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1570591561, "creation_date": 1570554794, "last_edit_date": 1570555625, "question_id": 58291061, "link": "https://stackoverflow.com/questions/58291061/vba-why-vba-udfs-are-so-slow-compared-with-native-excel-functions", "title": "VBA - Why VBA UDFs are so slow compared with native Excel functions?", "body": "<p>let's suppose I write the following VBA UDF:</p>\n\n<pre><code>Function TestFunction()\n    TestFunction = 0\nEnd Function\n</code></pre>\n\n<p>and then I use it for the first 100000 rows in my sheet. It takes several minutes to execute.</p>\n\n<p>Instead if i use TODAY() for the same number of rows it takes just 3-4 seconds to execute.</p>\n\n<p>Can anyone tell me why and if is there a way to speed up UDFs?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1570552393, "post_id": 58290378, "comment_id": 102945348, "body": "What happens if you step through the code? Side note: In general, you will want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using activate and select</a> in your code."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1570552785, "post_id": 58290378, "comment_id": 102945541, "body": "Drop the <code>.value</code> for starters, you are assigning an object variable, not a value of a cell."}, {"owner": {"reputation": 11, "user_id": 12183274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lkoU1WphxEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfP7KgG4m9CZmkiCCMTwo2Vo1qI6w/photo.jpg?sz=128", "display_name": "Andrew Brown", "link": "https://stackoverflow.com/users/12183274/andrew-brown"}, "edited": false, "score": 0, "creation_date": 1570552842, "post_id": 58290378, "comment_id": 102945571, "body": "I am F8-stepping through the code and this is all I am getting. this one Cells.Find highlighted in Debug, and the various error messages stated. It&#39;s not super helpful, I know."}, {"owner": {"reputation": 11, "user_id": 12183274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lkoU1WphxEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfP7KgG4m9CZmkiCCMTwo2Vo1qI6w/photo.jpg?sz=128", "display_name": "Andrew Brown", "link": "https://stackoverflow.com/users/12183274/andrew-brown"}, "edited": false, "score": 0, "creation_date": 1570552900, "post_id": 58290378, "comment_id": 102945599, "body": "The .value is replacing a .Activate. Should I drop both?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1570552980, "post_id": 58290378, "comment_id": 102945638, "body": "To declare both as <code>Range</code>, you need <code>Dim ProfitEn  As Range, ProfitFr As Range</code> etc."}, {"owner": {"reputation": 11, "user_id": 12183274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lkoU1WphxEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfP7KgG4m9CZmkiCCMTwo2Vo1qI6w/photo.jpg?sz=128", "display_name": "Andrew Brown", "link": "https://stackoverflow.com/users/12183274/andrew-brown"}, "edited": false, "score": 0, "creation_date": 1570554198, "post_id": 58290378, "comment_id": 102946220, "body": "SJR hit the nail on the head with the separate range declarations; I cannot believe this was all it needed to execute without errors."}, {"owner": {"reputation": 11, "user_id": 12183274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lkoU1WphxEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfP7KgG4m9CZmkiCCMTwo2Vo1qI6w/photo.jpg?sz=128", "display_name": "Andrew Brown", "link": "https://stackoverflow.com/users/12183274/andrew-brown"}, "edited": false, "score": 0, "creation_date": 1570554538, "post_id": 58290378, "comment_id": 102946382, "body": "Thanks everyone for the rapid responses and accurate diagnoses! This help is greatly appreciated. I have two other text strings to find per iteration of the macro so I&#39;ll apply what I&#39;ve learned here to them too."}, {"owner": {"reputation": 11, "user_id": 12183274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lkoU1WphxEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfP7KgG4m9CZmkiCCMTwo2Vo1qI6w/photo.jpg?sz=128", "display_name": "Andrew Brown", "link": "https://stackoverflow.com/users/12183274/andrew-brown"}, "edited": false, "score": 0, "creation_date": 1570566424, "post_id": 58290378, "comment_id": 102951272, "body": "Further to earlier, it was also removing both the &#39;.value&#39;  and the &#39;.activate&#39; that finally allowed everything to function fully again."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1570553814, "creation_date": 1570553814, "answer_id": 58290837, "question_id": 58290378, "link": "https://stackoverflow.com/questions/58290378/getting-multiple-errors-using-or-with-cells-find-rte424-object-required-rte13/58290837#58290837", "title": "Getting multiple errors using OR with Cells.Find - RTE424 Object Required, RTE13 Type Mismatch, E91 Block Variable not set", "body": "<p>Your code would benefit a lot from having parts of it factored into standalone Sub/Functions which encapsulate some specific functionality. </p>\n\n<p>Finding text in a range is one obvious candidate for that:</p>\n\n<pre><code>Sub Tester()\n\n    Dim f As Range\n\n    Set f = FindFirst(ActiveSheet.Columns(1), Array(\"PROFIT MENSUEL:\", \"Monthly Profit:\"))\n\n    If Not f Is Nothing Then\n        Debug.Print \"Found:\" &amp; f.Offset(0, 1).Value\n    Else\n        Debug.Print \"No match\"\n    End If\n\nEnd Sub\n\n\n'Find the first value in What in the range rngSearch\n'   Returns Nothing if not matches found\nFunction FindFirst(SearchWhere As Range, FindWhat) As Range\n    Dim f As Range, s\n    For Each s In FindWhat\n        Set f = SearchWhere.Find(What:=s, lookat:=xlPart, _\n                     SearchDirection:=xlNext, MatchCase:=False)\n        If Not f Is Nothing Then\n            Set FindFirst = f\n            Exit For\n        End If\n    Next s\nEnd Function\n</code></pre>\n\n<p>By pushing out common tasks into separate methods your main code becomes much easier to develop and maintain.</p>\n\n<p>Also, see if you can work the guidelines here into your code: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}], "owner": {"reputation": 11, "user_id": 12183274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lkoU1WphxEo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfP7KgG4m9CZmkiCCMTwo2Vo1qI6w/photo.jpg?sz=128", "display_name": "Andrew Brown", "link": "https://stackoverflow.com/users/12183274/andrew-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570582516, "creation_date": 1570551794, "last_edit_date": 1570582516, "question_id": 58290378, "link": "https://stackoverflow.com/questions/58290378/getting-multiple-errors-using-or-with-cells-find-rte424-object-required-rte13", "title": "Getting multiple errors using OR with Cells.Find - RTE424 Object Required, RTE13 Type Mismatch, E91 Block Variable not set", "body": "<p>This is my first ever S.O. question, so apologies if I go overboard with Wall of Text/Lack of Relevant Info'.</p>\n\n<p>I maintain Macro Excels built by a former employee for P&amp;L by Market and Sales Rep. They pull in data from other packages which now vary in format due to different versions in use. There is also a French-language market. Everything works for English-only (barely) but now they want the French-language market included.</p>\n\n<p>I'm pulling a value from a cell in multiple external files that are not fixed except by it's accompanying labeling text. Using <code>Cells.Find</code>, I am searching for an English phrase and activating the adjacent cell to copy that value into the main Excel. This works. </p>\n\n<p>Now they want the French language version included in this process, and I was attempting a parallel search for the English and French phrases to find which one it is and to take one OR the other, but I am getting successive and cyclic errors upon attempting the solutions found in StackOverflow.</p>\n\n<p>What is wrong with this code?</p>\n\n<pre><code>Sub FindMonthlyValues(ByVal varFile As String, ByRef MonthlyProfitLine As String, ByRef MonthlyTonnageLine As String, ByRef MonthlyTripNumberRange As String)\n\n    Dim CurrentPnL, CurrentPath As String\n    Dim k, FirstRow, LastRow As Integer\n    Dim ProfitEn, ProfitFr As Range    \n\n    'loop through excel files only\n    Application.ScreenUpdating = False\n\n    CurrentPnL = varFile\n\n    k = InStr(CurrentPnL, \"[\") 'find the end position of the default link\n    CurrentPath = Left(CurrentPnL, k - 1)\n    CurrentPnL = Replace(CurrentPnL, \"[\", \"\")\n    CurrentPnL = Replace(CurrentPnL, \"]\", \"\")\n\n    ChDir _\n        CurrentPath\n    Workbooks.Open FileName:= _\n        CurrentPnL\n\n    ' Find Monthly Profit Line in Initial sheet\n    Sheets(\"Initial\").Select\n    Range(\"A1:AK1\").Select\n    Set ProfitFr = Cells.Find(What:=\"PROFIT MENSUEL:\", After:=ActiveCell, LookIn:=xlFormulas _\n        , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Value\n\n    If ProfitFr Is Nothing Then\n        Set ProfitEn = Cells.Find(What:=\"Monthly Profit:\", After:=ActiveCell, LookIn:=xlFormulas _\n            , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).Value\n    End If\n\n    Cells.FindNext(After:=ActiveCell).Activate\n    ActiveCell.Offset(, 1).Select\n    MonthlyProfitLine = ActiveCell.Address\n</code></pre>\n\n<p>I've tried three different StackOverflow solutions but they lead to a circle of different errors as defined in the header.</p>\n\n<p>I don't see an <code>Option Explicit</code> in the code section I'm modifying.</p>\n\n<p>I've tried setting a Dim for new variables to hold the phrase found.</p>\n\n<p>I've tried <code>Set [DimName] = Cells.Find(BLAH).Value</code> from the original (and functional) <code>Cells.Find(BLAH).Activate</code>.</p>\n\n<p>I've tried an <code>If [DimName] Is Nothing Then</code> but it makes no difference to the errors, which happen at the first <code>Cells.Find</code>.</p>\n\n<p>I've tried changing the order of the English or French <code>Cells.Find</code>, but it makes no difference to the errors, which happen at the first <code>Cells.Find</code>.</p>\n\n<p>I've tried changing the Dim from <code>Range</code> to <code>String</code> but only get: </p>\n\n<blockquote>\n  <p>\"Object undefined.\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11434189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8069379432e5892c2cd515e5d8c4d84d?s=128&d=identicon&r=PG&f=1", "display_name": "90&#39;sProSkater", "link": "https://stackoverflow.com/users/11434189/90sproskater"}, "edited": false, "score": 0, "creation_date": 1570640855, "post_id": 58289896, "comment_id": 102979609, "body": "I attempted this and it did not work as intended. It ended up hiding rows that had values"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 11, "user_id": 11434189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8069379432e5892c2cd515e5d8c4d84d?s=128&d=identicon&r=PG&f=1", "display_name": "90&#39;sProSkater", "link": "https://stackoverflow.com/users/11434189/90sproskater"}, "edited": false, "score": 0, "creation_date": 1570641745, "post_id": 58289896, "comment_id": 102980023, "body": "@90&#39;sProSkater, that&#39;s strange. Works as intended on my end. Maybe update your question with some of your sample data/screenshot etc."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1570549849, "creation_date": 1570549849, "answer_id": 58289896, "question_id": 58289815, "link": "https://stackoverflow.com/questions/58289815/autofilter-macro-to-hide-0-and-blank-values/58289896#58289896", "title": "AutoFilter Macro to hide 0 and blank values", "body": "<p>You could try two criteria:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$16:$C$2106\").AutoFilter Field:=3, Criteria1:=\"&lt;&gt;0\", Operator:=xlAnd, Criteria2:=\"*\"\n</code></pre>\n\n<p><strong><em>Noteworthy:</strong> It's <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">recommended</a> to try and stay away from using <code>ActiveSheet</code> and the likes.</em></p>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "is_accepted": false, "score": 0, "last_activity_date": 1570550280, "creation_date": 1570550280, "answer_id": 58290015, "question_id": 58289815, "link": "https://stackoverflow.com/questions/58289815/autofilter-macro-to-hide-0-and-blank-values/58290015#58290015", "title": "AutoFilter Macro to hide 0 and blank values", "body": "<p>I totally agree with JvdV, two operators is the way to go.  For filtering out zero and blank (empty) you may want:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$16:$C$2106\").AutoFilter Field:=3, Criteria1:=\"&lt;&gt;0\", Operator:=xlAnd, Criteria2:\"&lt;&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11434189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8069379432e5892c2cd515e5d8c4d84d?s=128&d=identicon&r=PG&f=1", "display_name": "90&#39;sProSkater", "link": "https://stackoverflow.com/users/11434189/90sproskater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2439, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570550280, "creation_date": 1570549571, "last_edit_date": 1570550095, "question_id": 58289815, "link": "https://stackoverflow.com/questions/58289815/autofilter-macro-to-hide-0-and-blank-values", "title": "AutoFilter Macro to hide 0 and blank values", "body": "<p>I am trying to hide rows in a particular column with zero values and blank values after clicking a button. I have coded the following macro:</p>\n\n<p><code>ActiveSheet.Range(\"$A$16:$C$2106\").AutoFilter Field:=3, Criteria1:=\"&lt;&gt;0\", Operator:=xlFilterValues</code></p>\n\n<p>It correctly filters 0 values. However, it is not filtering about blank cells. Is this the correct code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 4, "creation_date": 1570549251, "post_id": 58289717, "comment_id": 102943925, "body": "Change <code>With ActiveSheet</code> for <code>With WS</code> in your second code :)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1570549272, "post_id": 58289717, "comment_id": 102943938, "body": "Try using <code>With WS</code> instead."}, {"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 0, "creation_date": 1570549958, "post_id": 58289717, "comment_id": 102944246, "body": "I tried to use With WS instead of With Actviesheet and the code is not working."}, {"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 0, "creation_date": 1570550006, "post_id": 58289717, "comment_id": 102944273, "body": "I think, the loop has to go and select through all the sheets to activate them each"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570550026, "post_id": 58289717, "comment_id": 102944281, "body": "No, you don&#39;t need to <code>Select</code> or <code>Activate</code> anything. Exactly what does &quot;is not working&quot; means?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 0, "creation_date": 1570552232, "post_id": 58289875, "comment_id": 102945278, "body": "Hi Wityaka, Thanks a lot for your time and answer. I tried the macro and once I have launched it the VBA error #1004 appared saying the password is not valid. If I start the code submitted (activesheet) it work for a single Excel sheet.  Does the code work in your case ?  Thanks again Naxos"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 0, "creation_date": 1570552376, "post_id": 58289875, "comment_id": 102945342, "body": "@Naxos - well, the code actually does a few useless stuff, but I thought that it works somehow for you. Anyway, the idea is to have only once <code>.Unprotect</code> and 0 times <code>.Protect</code>. And furthermore, make sure that the <code>vbNullString</code> is changed to some string, which is the actual password."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 1, "creation_date": 1570555229, "post_id": 58289875, "comment_id": 102946683, "body": "@Naxos worksheet passwords are pure annoyance and offer near-zero actual protection (infosec-wise). Consider protecting your sheets without a password - that way you don&#39;t have a hard-coded password anywhere in your code, <i>and</i> you don&#39;t get errors for getting the password wrong."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1570552467, "last_edit_date": 1570552467, "creation_date": 1570549775, "answer_id": 58289875, "question_id": 58289717, "link": "https://stackoverflow.com/questions/58289717/unlock-all-the-sheets-in-active-workbook/58289875#58289875", "title": "Unlock all the sheets in active workbook", "body": "<p>It is a good idea to loop through every worksheet and unlock it explicitly. In the code above, it always works with the <code>ActiveSheet</code> and although the looping is correct, the <code>ActiveSheet</code> is never changed. Thus, try like this:</p>\n\n<pre><code>Private Sub UnlockAll()\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        With ws\n            '.Protect vbNullString, userinterfaceonly:=True\n            '.Range(\"A1\").Copy .Range(\"A1\")\n            .Unprotect \"TheRealPasswordHere\"\n            '.Protect vbNullString, contents:=True, AllowUsingPivotTables:=True\n            '.Unprotect vbNullString\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>What is even a better idea is to use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/understanding-named-arguments-and-optional-arguments\" rel=\"nofollow noreferrer\">named arguments</a> to make the code understandable for maintenance. Thus, instead of:</p>\n\n<p><code>.Protect vbNullString, , True, , , , , , , , , , , , , True</code> </p>\n\n<p>try:</p>\n\n<p><code>.Protect vbNullString, contents:=True, AllowUsingPivotTables:=True</code></p>\n\n<p>To get the names of the named arguments correctly, just change a bit the commas in the VBEditor and these will show up:\n<a href=\"https://i.stack.imgur.com/aIcfs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aIcfs.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 58289875, "answer_count": 1, "score": 1, "last_activity_date": 1570552467, "creation_date": 1570549179, "last_edit_date": 1570549814, "question_id": 58289717, "link": "https://stackoverflow.com/questions/58289717/unlock-all-the-sheets-in-active-workbook", "title": "Unlock all the sheets in active workbook", "body": "<p>I would like to automate this quick code to loop through all the sheet in the active workbook.</p>\n\n<p>For the moment, the code only work on the <code>Activesheet</code>:</p>\n\n<pre><code>Private Sub Unlockone ()\nOn Error Resume Next\nWith ActiveSheet\n    .Protect vbNullString, , , , True\n    .Range(\"A1\").Copy .Range(\"A1\")\n    .Unprotect vbNullString\n    .Protect vbNullString, , True, , , , , , , , , , , , , True\n    .Unprotect vbNullString\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I tried to do it by myself but had some VBA warning issues and/or the desired output is not reached. Please find below an example of my tries:</p>\n\n<pre><code>Private Sub Unlockall()\n    Dim WS As Worksheet\n    For Each WS In ThisWorkbook.Worksheets\n        With ActiveSheet\n            .Protect vbNullString, , , , True\n            .Range(\"A1\").Copy .Range(\"A1\")\n            .Unprotect vbNullString\n            .Protect vbNullString, , True, , , , , , , , , , , , , True\n            .Unprotect vbNullString\n        End With\n    Next WS\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1570549355, "last_edit_date": 1570549355, "creation_date": 1570549023, "answer_id": 58289671, "question_id": 58289550, "link": "https://stackoverflow.com/questions/58289550/openning-workbook-with-filepicker-in-vba-throws-compile-error/58289671#58289671", "title": "Openning workbook with FilePicker in VBA throws compile error", "body": "<p>Compile error is the best error you may have - the compiler tells explicitly it does not work. In this case, <code>wipreport.Worksheets(\"1. WIP report\").Select</code> could not work, becase <code>wipreport</code> is of type <code>String</code> and it does not have <code>Worksheets</code> property.</p>\n\n<p>Probably try something like this, it will work if <code>wipreport</code> is the name of the opened Excel file:</p>\n\n<pre><code>Workbooks(wipreport).Worksheets(\"1. WIP report\").Select\n</code></pre>\n\n<p>If <code>wipreport</code> is a path of the file, then openning it is a better option:</p>\n\n<pre><code>Workbooks.Open wipreport\n</code></pre>\n\n<p>or even, setting a variable to it:</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = Workbooks.Open(Filename:=wipreport)\n</code></pre>\n\n<p><em>And while on the subject, there is a reason that this question has the highest number of votes in #VBA in StackOverflow - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</em></p>\n"}, {"tags": [], "owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "is_accepted": false, "score": 2, "last_activity_date": 1570549639, "last_edit_date": 1570549639, "creation_date": 1570549029, "answer_id": 58289673, "question_id": 58289550, "link": "https://stackoverflow.com/questions/58289550/openning-workbook-with-filepicker-in-vba-throws-compile-error/58289673#58289673", "title": "Openning workbook with FilePicker in VBA throws compile error", "body": "<p><code>FileDialog</code> returns the file name as <code>String</code> object, but you are trying to use it as <code>Workbook</code>.\nIf the user has selected the file, then you first need to open it and then try to select the sheet:</p>\n\n<pre><code>Set wb = Workbooks.Open(wipreport) 'open the file\nwb.Worksheets(\"1. WIP report\").Select ' your code\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1570549639, "creation_date": 1570548610, "last_edit_date": 1570549416, "question_id": 58289550, "link": "https://stackoverflow.com/questions/58289550/openning-workbook-with-filepicker-in-vba-throws-compile-error", "title": "Openning workbook with FilePicker in VBA throws compile error", "body": "<p>I define workbook as variable with FilePicker. At the top I defined my variable as public and string. I tried  to declare it as workbook but it doesnt work. Having it defined as string when I try to get into this workbook in another module I get the \nfollowing compile error: </p>\n\n<blockquote>\n  <p>Invalid qualifier.</p>\n</blockquote>\n\n<p>Any suggestions what is wrong?</p>\n\n<pre><code>Public wipreport As String\n\nsub wip()\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n        'Makes sure the user can select only one file\n        .AllowMultiSelect = False\n        .Title = \"Select WIP Report\"\n        .ButtonName = \"OK\"\n        'Filter to just the following types of files to narrow down selection options\n        .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n        'Show the dialog box\n        .Show\n\n        'Store in fullpath variable\n        wipreport = .SelectedItems.Item(1)\n    End With\n\nend sub\n</code></pre>\n\n<p>Line of code in another module, where I get this compile error:</p>\n\n<pre><code>wipreport.Worksheets(\"1. WIP report\").Select\n</code></pre>\n\n<p>Thank You for help.</p>\n\n<hr>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570550794, "post_id": 58289535, "comment_id": 102944648, "body": "Where &amp; how is <code>WorkFolder</code> defined?"}, {"owner": {"reputation": 115, "user_id": 11909839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494bb3f0e45ea9e72872d3aa47b01c29?s=128&d=identicon&r=PG&f=1", "display_name": "Kittmaster", "link": "https://stackoverflow.com/users/11909839/kittmaster"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570552446, "post_id": 58289535, "comment_id": 102945373, "body": "Sorry, should have mentioned that.... &gt; &#39; =====  GLOBALS  ===== Dim WorkFolder As Folder"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570552589, "post_id": 58289535, "comment_id": 102945445, "body": "That has no business being a global variable."}, {"owner": {"reputation": 115, "user_id": 11909839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494bb3f0e45ea9e72872d3aa47b01c29?s=128&d=identicon&r=PG&f=1", "display_name": "Kittmaster", "link": "https://stackoverflow.com/users/11909839/kittmaster"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570552734, "post_id": 58289535, "comment_id": 102945516, "body": "It was an open source that I built on, it was located there. I will work to fix this as an issue...TY."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11909839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494bb3f0e45ea9e72872d3aa47b01c29?s=128&d=identicon&r=PG&f=1", "display_name": "Kittmaster", "link": "https://stackoverflow.com/users/11909839/kittmaster"}, "edited": false, "score": 0, "creation_date": 1570552920, "post_id": 58290205, "comment_id": 102945607, "body": "Understood, I&#39;ll rework the variable names on that moto...and probably should have from the git go. I&#39;ll continue to work to see if I can sort this out..."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1570551032, "creation_date": 1570551032, "answer_id": 58290205, "question_id": 58289535, "link": "https://stackoverflow.com/questions/58289535/object-required-error-when-recalling-path-from-registry-to-reference-a-folder/58290205#58290205", "title": "Object required error when recalling path from registry to reference a folder", "body": "<p>Assuming <code>WorkFolder</code> is declared (somewhere?) as a <code>String</code>, then a <code>String</code> is not an object in VBA - you can't <code>Set</code> it.</p>\n\n<blockquote>\n<pre><code>Set WorkFolder = sResult\n</code></pre>\n</blockquote>\n\n<p>I doubt <code>WScript.Shell</code> returns an <code>Object</code> you can <code>Set</code>. If it's a <code>String</code>, then you want a simple <code>Let</code> assignment here:</p>\n\n<pre><code>WorkFolder = sResult '&lt;~ implicit: Let WorkFolder = sResult\n</code></pre>\n\n<p>Different story here:</p>\n\n<blockquote>\n<pre><code>Set WorkFolder = fs.GetFolder(fd.SelectedItems(1))\n</code></pre>\n</blockquote>\n\n<p>Where if I had to guess I'd think <code>fs</code> is a <code>Scripting.FileSystemObject</code> (where is that declared &amp; assigned, and why is it not in sight where it's used?), whose <code>GetFolder</code> method <em>does</em> return a <code>Scrpiting.Folder</code> object reference.</p>\n\n<p>You are reusing variables, giving them different meanings and responsibilities: that's how bugs happen.</p>\n\n<p>One variable, one purpose.</p>\n"}], "owner": {"reputation": 115, "user_id": 11909839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494bb3f0e45ea9e72872d3aa47b01c29?s=128&d=identicon&r=PG&f=1", "display_name": "Kittmaster", "link": "https://stackoverflow.com/users/11909839/kittmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 58290205, "answer_count": 1, "score": 1, "last_activity_date": 1574157401, "creation_date": 1570548551, "last_edit_date": 1574157401, "question_id": 58289535, "link": "https://stackoverflow.com/questions/58289535/object-required-error-when-recalling-path-from-registry-to-reference-a-folder", "title": "Object required error when recalling path from registry to reference a folder", "body": "<p>My existing userform requires a folder path to be selected, to save to. If not, then the output functionality is disabled.</p>\n\n<p>Note that the select folder and output functions work.</p>\n\n<p>I've set the system up to save the folder that the user has last used to the registry. I can recall it as a string from the registry. When I try to set the path string (Line: <code>Set WorkFolder</code>) to the returned folder string value as an object(?), it crashes as a 424 object required error.</p>\n\n<p>I found how to get things in and out of the registry. It's getting the Set WorkFolder to accept what is being pulled from the registry that is causing me grief.</p>\n\n<p>The text box is disabled and is updated once a valid file dialog selection is complete so the user knows what path is being used.</p>\n\n<p>I want to populate it with registry recall value (which works) and then set the WorkFolder to the path string value removing the \"nothing\".</p>\n\n<p>When debugging and hovering over sResult, I have the proper string in the tooltip, I just need to plug that into Set WorkFolder.</p>\n\n<pre><code>Private Sub BtnSelectFolder_Click()\n\n    ' ===== FOLDER SELECTION BY USER (MANDATORY) =====\n\nDim fd As FileDialog\nDim result As Long, errNum As Long\n\n\n'-------------------------------\n'Trouble section\n\nDim oWSH As Object\nDim sResult\nDim KeyId, Rootkey\n\nRootkey = \"HKCU\"\nKeyId = \"Software\\VB and VBA Program Settings\\MyApplication\\WorkbookPath\\SaveFolder\"\n\nIf oWSH Is Nothing Then\n    Set oWSH = CreateObject(\"WScript.Shell\")\nEnd If\n\nsResult = oWSH.RegRead(Rootkey &amp; \"\\\" &amp; KeyId)\n\nSet WorkFolder = sResult '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Why won't this work? Error 424 Object required, but path is pulled from Registry successfully\n\n'Trouble section\n'-------------------------------\n\n\n'All works below\n\nSet fd = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith fd\n    .AllowMultiSelect = False\n    .ButtonName = \"Select\"\n    .Title = \"Choose Output Folder\"\n    If InStr(UCase(.InitialFileName), \"SYSTEM32\") Then\n        .InitialFileName = Environ(\"USERPROFILE\") &amp; \"\\Documents\"\n    End If\n    result = .Show\nEnd With\n\n' Drop if box cancelled\nIf result = 0 Then Exit Sub\n\n' Made it here; try updating the linked folder, with error handling\nOn Error Resume Next\nSet WorkFolder = fs.GetFolder(fd.SelectedItems(1))\nerrNum = Err.Number: Err.Clear: On Error GoTo 0\n\nIf errNum &lt;&gt; 0 Then\n    MsgBox \"Invalid folder selection\", _\n      vbOKOnly + vbCritical, _\n      \"Error\"\n    Exit Sub\nEnd If\n\n' Update display textbox\nTxBxFolder.Value = WorkFolder.Path\n\n'Save path to registry\nSaveSetting \"MyApplication\", \"WorkbookPath\", \"SaveFolder\", WorkFolder.Path\n\n' Update the Export button\nsetExportEnabled\n\nCall CheckExportIsEnabled\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570546731, "post_id": 58289002, "comment_id": 102942624, "body": "What is wrong with your code?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570547104, "post_id": 58289002, "comment_id": 102942818, "body": "<code>LinteItems</code> - use <code>Option Explicit</code>  !"}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570547514, "post_id": 58289002, "comment_id": 102943027, "body": "@TimWilliams, i am already using option explicit."}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570547553, "post_id": 58289002, "comment_id": 102943051, "body": "@urdearboy, i modified my question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570547554, "post_id": 58289002, "comment_id": 102943053, "body": "Then why are you not seeing a compile error?"}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570547611, "post_id": 58289002, "comment_id": 102943076, "body": "@TimWilliams, I got an error on this part Open &quot;C:\\Users\\mestrivo\\Documents\\Files\\MyFirstProg\\test - 2.csv&quot; For Output As #1, it says that the file is already open."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570547651, "post_id": 58289002, "comment_id": 102943102, "body": "<code>strFile</code> only contains the content for the last line, since you overwrite it every time through the loop...  You need to open the output file before you enter the loop, then write out each modified line as the loop progresses."}, {"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570547750, "post_id": 58289002, "comment_id": 102943143, "body": "@TimWilliams may I know, what should I need to do?"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1570547912, "creation_date": 1570547912, "answer_id": 58289368, "question_id": 58289002, "link": "https://stackoverflow.com/questions/58289002/modifying-csv-file-using-vba/58289368#58289368", "title": "modifying csv file using vba", "body": "<p>NEVER hard-code file handles, they aren't for you to grab, they're for VBA to query what's available and <em>give you</em> a free, usable file handle. Use the <code>FreeFile</code> function to do this.</p>\n\n<pre><code>Dim fileHandle As Long\nfileHandle = FreeFile\n</code></pre>\n\n<p>Then replace all hard-coded <code>#1</code> handles with <code>#fileHandle</code>.</p>\n\n<p>You cannot open two different files using the same handle. You've already opened the file for input:</p>\n\n<pre><code>Open FilePath For Input As #1\n</code></pre>\n\n<p>So when you try to use the same handle for output...</p>\n\n<pre><code>Open \"C:\\Users\\mestrivo\\Documents\\Files\\MyFirstProg\\test - 2.csv\" For Output As #1\n</code></pre>\n\n<p>That's when you get an error; you haven't closed the <code>#1</code> handle yet, and now you're trying to reuse it to open another file - you can't do that.</p>\n\n<p>You're dealing with two files, so either you open the first one, read it, <em>then close it</em> before you open the second one, write to it and then close it - or, you open both, and write to one as you read the other, then close both.</p>\n\n<p>Either way, you shouldn't hard-code file handles. Use <code>FreeFile</code> to get a free file handle. Always.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1571754845, "post_id": 58289863, "comment_id": 103341404, "body": "Hi @Ferd, i just realized what if there is a comma in the input file? How do i ignore it if Im going to use the comma when splitting the data?"}, {"owner": {"reputation": 715, "user_id": 9281303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/075rM.png?s=128&g=1", "display_name": "Ferd", "link": "https://stackoverflow.com/users/9281303/ferd"}, "reply_to_user": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "edited": false, "score": 0, "creation_date": 1571810847, "post_id": 58289863, "comment_id": 103359170, "body": "Three options here: \u2022 Deal with those cases directly from <code>LineFromFile</code> variable, before splitting. \u2022 Make sure your files to not have that condition. \u2022 Use another separator, maybe <code>|</code>."}], "tags": [], "owner": {"reputation": 715, "user_id": 9281303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/075rM.png?s=128&g=1", "display_name": "Ferd", "link": "https://stackoverflow.com/users/9281303/ferd"}, "is_accepted": true, "score": 0, "last_activity_date": 1570550085, "last_edit_date": 1570550085, "creation_date": 1570549730, "answer_id": 58289863, "question_id": 58289002, "link": "https://stackoverflow.com/questions/58289002/modifying-csv-file-using-vba/58289863#58289863", "title": "modifying csv file using vba", "body": "<p>Try this:</p>\n\n<pre><code>Sub test()\n    Dim FilePath As String, LineFromFile As Variant, _\n    LineItems() As String, strFile As Variant\n\n    FilePath = \"mycsv.csv\"\n    Open FilePath For Input As #1\n\n    Do Until EOF(1)\n        Line Input #1, LineFromFile\n        LineItems() = Split(LineFromFile, \",\")\n\n        'I suggest to add the following 'If' statements\n        If LineItems(0) &lt;&gt; \"\" Then\n            LineItems(1) = LineItems(0) &amp; \" ProductName\"\n            LineItems(2) = LineItems(0) &amp; \" SupplierName\"\n        End If\n\n        If strFile &lt;&gt; \"\" Then strFile = strFile &amp; Chr(10)\n        '-------------------------------------------------\n\n        strFile = strFile &amp; Join(LineItems, \",\")\n    Loop\n\n    'In the next 'Open' statement you are trying to\n    'assign an object over another that's already opened,\n    'therefore you must close the previous object first\n    'and / or declare the second one with another name\n    Close #1\n    Open \"mycsv2.csv\" For Output As #1\n    Print #1, strFile\n    Close #1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 3999084, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e53b750ab7ecb6c53da2c698bdcb6b1a?s=128&d=identicon&r=PG&f=1", "display_name": "pinkpanther", "link": "https://stackoverflow.com/users/3999084/pinkpanther"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 58289863, "answer_count": 2, "score": 2, "last_activity_date": 1594421430, "creation_date": 1570546653, "last_edit_date": 1594421430, "question_id": 58289002, "link": "https://stackoverflow.com/questions/58289002/modifying-csv-file-using-vba", "title": "modifying csv file using vba", "body": "<p>I need help in modifying the CSV file using VBA. I did research and came up with this solution. However, I can't get the expected output. So, for example, I have a CSV file:</p>\n\n<pre><code>ProductID,ProductName,SupplierName,CategoryID,Unit,Price\n,,,,,\n1,Chais,John Ray,1,10 boxes x 20 bags,18.00093483\n2,Chang,Michael,1,24 - 12 oz bottles,19.66890343\n</code></pre>\n\n<p>I want to change all the values under the <code>productname</code> and <code>suppliername</code>. And change something like the combination of ProductID and the Column Name. My expected output should look like:</p>\n\n<pre><code>    ProductID,ProductName,SupplierName,CategoryID,Unit,Price\n,,,,,\n1,1 ProductName,1 SupplierName,1,10 boxes x 20 bags,18.00093483\n2,2 ProductName,2 SupplierName,1,24 - 12 oz bottles,19.66890343\n</code></pre>\n\n<p>It can occur multiple times and can change the column location. This is my code:</p>\n\n<pre><code>Sub test()\n\n    Dim FilePath As String, LineFromFile As Variant, LineItems() As String, strFile As Variant\n    FilePath = \"C:\\Users\\mestrivo\\Documents\\Files\\MyFirstProg\\test.csv\"\n    Open FilePath For Input As #1\n\n    Do Until EOF(1)\n        Line Input #1, LineFromFile\n        LinteItems = Split(LineFromFile, \",\")\n        LineItems(1) = LineItems(0) &amp; \" ProductName\"\n        LineItems(2) = LineItems(0) &amp; \" SupplierName\"\n        strFile = Join(LineItems, \",\")\n    Loop\n\n    Open \"C:\\Users\\mestrivo\\Documents\\Files\\MyFirstProg\\test - 2.csv\" For Output As #1\n\n    Print #1, strFile\n    Close #1\n\nEnd Sub\n</code></pre>\n\n<p>Please help me check my code. I got an error on this part:</p>\n\n<pre><code>Open \"C:\\Users\\mestrivo\\Documents\\Files\\MyFirstProg\\test - 2.csv\" For Output As #1\n</code></pre>\n\n<p>it says that the file is already open.</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1570546430, "post_id": 58288821, "comment_id": 102942471, "body": "I suspect <b>From_date</b> is the name of your column (i.e. in row 1) and not the name of your range. Even if you have that as a name for your range, you haven&#39;t specified which sheet the range belongs too. <code>ActiveSheet</code> might not have that range which is what it&#39;s attempting to do with your current code"}, {"owner": {"reputation": 1, "user_id": 10385147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31086f50ee80ac0868e818645fc5cb0?s=128&d=identicon&r=PG&f=1", "display_name": "MaraBiz", "link": "https://stackoverflow.com/users/10385147/marabiz"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570547028, "post_id": 58288821, "comment_id": 102942785, "body": "From_date is a cell defined in excel in which I have enter a specific date in order to get only the mails from that date from outlok"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10385147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31086f50ee80ac0868e818645fc5cb0?s=128&d=identicon&r=PG&f=1", "display_name": "MaraBiz", "link": "https://stackoverflow.com/users/10385147/marabiz"}, "edited": false, "score": 0, "creation_date": 1570547077, "post_id": 58289032, "comment_id": 102942807, "body": "so where do I put the &quot;If TypeOf OutlookMail Is MailItem Then&quot; in the macro?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1, "user_id": 10385147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31086f50ee80ac0868e818645fc5cb0?s=128&d=identicon&r=PG&f=1", "display_name": "MaraBiz", "link": "https://stackoverflow.com/users/10385147/marabiz"}, "edited": false, "score": 1, "creation_date": 1570547429, "post_id": 58289032, "comment_id": 102942978, "body": "@MaraBiz in the loop where you&#39;re iterating <code>Folder.Items</code>. Better yet, Rename that variable to <code>unknownItem</code>, and then declare an <code>outlookMailItem As Outlook.MailItem</code>, and when <code>TypeOf unknownItem Is Outlook.MailItem</code> then you can <code>Set outlookMailItem = unknownItem</code> and then from there all the member calls you make against <code>outlookMailItem</code> will be validated at compile-time, and then error 438 isn&#39;t going to happen (you&#39;ll get a compiler error instead of a run-time error, if you misspell a member name)."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1, "user_id": 10385147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31086f50ee80ac0868e818645fc5cb0?s=128&d=identicon&r=PG&f=1", "display_name": "MaraBiz", "link": "https://stackoverflow.com/users/10385147/marabiz"}, "edited": false, "score": 0, "creation_date": 1570548039, "post_id": 58289032, "comment_id": 102943310, "body": "@MaraBiz I have corrected the answer to show a possible place."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570609356, "post_id": 58289032, "comment_id": 102962535, "body": "Please accept the answer if it helped to resolve your query as this will close the query"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 3, "last_activity_date": 1570548004, "last_edit_date": 1570548004, "creation_date": 1570546770, "answer_id": 58289032, "question_id": 58288821, "link": "https://stackoverflow.com/questions/58288821/returning-mailitem-property-of-item-in-inbox-error-438-object-doesnt-support-t/58289032#58289032", "title": "Returning mailitem property of item in inbox: Error 438 object doesn&#39;t support this property or method", "body": "<p>An obvious fact is that Outlook folders may contain a different kind of items, so not every type provides the <code>ReceivedTime</code> property:</p>\n\n<pre><code>For Each OutlookMail In Folder.Items\n    If OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then\n</code></pre>\n\n<p>You must check the item type first before accessing any property or method to make sure such a member exists for the item:</p>\n\n<pre><code>For Each OutlookMail In Folder.Items\n   If TypeOf OutlookMail Is MailItem Then\n      If OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1570549188, "last_edit_date": 1570549188, "creation_date": 1570548878, "answer_id": 58289631, "question_id": 58288821, "link": "https://stackoverflow.com/questions/58288821/returning-mailitem-property-of-item-in-inbox-error-438-object-doesnt-support-t/58289631#58289631", "title": "Returning mailitem property of item in inbox: Error 438 object doesn&#39;t support this property or method", "body": "<p>Error 438 means you're trying to invoke a member that does not exist - that can only ever happen at run-time, against late-bound code.</p>\n\n<blockquote>\n  <p><strong>Late bound?</strong> VBA can't know what the actual type of a <code>Variant</code> or <code>Object</code> is going to be until the code is actually running - when members are bound at run-time, it's called <em>late binding</em>. When members are bound at compile-time, it's called <em>early binding</em>. You want as much of your code to be early-bound, so that you pick up such errors at compile-time rather than at run-time.</p>\n</blockquote>\n\n<p>But you're referencing the <code>Outlook</code> library - you have no valid reason to late-bind anything here.</p>\n\n<p><code>Folder.Items</code> contains many object types: the <code>OutlookMail</code> variable has a very misleading name:</p>\n\n<pre><code>For Each OutlookMail In Folder.Items\n</code></pre>\n\n<p>A better name could be <code>folderItem</code>, or <code>unknownItem</code> - because we know it's something that's in a folder, but we don't know what type of object that is. All we know of it, is that it's an <code>Object</code>:</p>\n\n<pre><code>Dim unknownItem As Object\nFor Each unknownItem In Folder.Items\n</code></pre>\n\n<p>Now if the type of <code>unknkownItem</code> is <code>Outlook.MailItem</code>, we can <em>cast</em> it to that interface:</p>\n\n<pre><code>    Dim emailItem As Outlook.MailItem\n    If TypeOf unknownItem Is Outlook.MailItem Then\n        Set emailItem = unknownItem\n</code></pre>\n\n<p>And now every single member call we make against <code>emailItem</code> will be validated at compile-time instead of run-time, because we <em>know</em> that inside this conditional block, we're looking at a <code>MailItem</code> object.</p>\n\n<pre><code>        Sheet1.Range(\"eMail_sender\").Offset(i, 0).Value = emailItem.SenderName\n</code></pre>\n\n<p>Note that <code>SenderName</code> will be in the names list when you type the <code>.</code> dot: that's how you know you're making an early-bound member call.</p>\n\n<p>Avoid implicit late binding wherever you can - that means working with object variables that have an explicit, declared type, and avoiding member calls against <code>Variant</code> and <code>Object</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10385147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31086f50ee80ac0868e818645fc5cb0?s=128&d=identicon&r=PG&f=1", "display_name": "MaraBiz", "link": "https://stackoverflow.com/users/10385147/marabiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1581828179, "creation_date": 1570546054, "last_edit_date": 1581828179, "question_id": 58288821, "link": "https://stackoverflow.com/questions/58288821/returning-mailitem-property-of-item-in-inbox-error-438-object-doesnt-support-t", "title": "Returning mailitem property of item in inbox: Error 438 object doesn&#39;t support this property or method", "body": "<p>I am trying to run the macro below in Excel.</p>\n\n<p>I get</p>\n\n<blockquote>\n  <p>error 438 object doesn't support this property or method</p>\n</blockquote>\n\n<p>on the line <code>If OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then</code></p>\n\n<pre><code>Option Explicit\n\nSub getDataFromOutlook()\n\n    Dim OutlookApp As Outlook.Application\n    Dim OutlookNamespace As Namespace\n    Dim Folder As MAPIFolder\n    Dim OutlookMail As Variant\n    Dim objOwner As Outlook.Recipient\n    Dim i As Integer\n\n    Set OutlookApp = New Outlook.Application\n\n    Set OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\n\n    Set objOwner = OutlookNamespace.CreateRecipient(\"SharedMailboxaddres@companyname.com\")\nobjOwner.Resolve\n\n    If objOwner.Resolved Then\n        Set Folder = OutlookNamespace.GetSharedDefaultFolder(objOwner, olFolderInbox)\n    End If\n\n    i = 1\n\n    For Each OutlookMail In Folder.Items\n        If OutlookMail.ReceivedTime &gt;= Range(\"From_date\").Value Then\n            Range(\"eMail_sender\").Offset(i, 0).Value = OutlookMail.SenderName\n            Range(\"eMail_subject\").Offset(i, 0).Value = OutlookMail.Subject\n            Range(\"eMail_date\").Offset(i, 0).Value = OutlookMail.ReceivedTime\n            Range(\"eMail_categories\").Offset(i, 0).Value = OutlookMail.Categories\n            Range(\"eMail_flag_status\").Offset(i, 0) = OutlookMail.FlagStatus\n\n            i = i + 1\n        End If\n    Next OutlookMail\n\n    Set Folder = Nothing\n    Set OutlookNamespace = Nothing\n    Set OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570545885, "post_id": 58288693, "comment_id": 102942139, "body": "see: <a href=\"http://www.siddharthrout.com/index.php/2018/09/17/vba-excelallow-paste-special-only/\" rel=\"nofollow noreferrer\">siddharthrout.com/index.php/2018/09/17/&hellip;</a>"}, {"owner": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570555606, "post_id": 58288693, "comment_id": 102946841, "body": "Thank you very much for that link, but I already knew it and couldn&#39;t get it to work. I will try again as soon as possible. Do you have any other idea for modifying my code?"}, {"owner": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570602921, "post_id": 58288693, "comment_id": 102959304, "body": "I tried it again... At first I set up a new file and only entered Code I of Siddharth Rout in &quot;ThisWorkbook&quot;. After that I tried Code II in &quot;Sheet1&quot;, also in a new file. Both of the options did not work. Maybe it&#39;s because of my Excel 2010. While debugging it stopped at <code>UndoList = Application.CommandBars(&quot;Standard&quot;).Controls(&quot;&amp;Undo&quot;).List(1&zwnj;&#8203;)</code>. Could you please help me getting it running?"}], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "is_accepted": true, "score": 0, "last_activity_date": 1571390391, "creation_date": 1571390391, "answer_id": 58447768, "question_id": 58288693, "link": "https://stackoverflow.com/questions/58288693/how-to-let-users-paste-cells-from-another-excel-instance-ctrlv-but-paste/58447768#58447768", "title": "How To: Let users paste cells from another excel instance (Ctrl+V,...) but paste only values", "body": "<p>After long hours of searching the internet, I found <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/how-do-you-lock-formats-but-allow-data-entry/afccc43e-e191-417f-826c-d10a464a1b9a?page=4\" rel=\"nofollow noreferrer\">the solution of Donna Landy (Bella_Donna)</a> in the microsoft forum. Her code is simple and works for CTRL+C / CTRL+V, Copy and Paste over Right Click Menu, Drag'n'Drop and even with two excel instances.</p>\n\n<p>Because it starts on every single cell change and goes back to the cell or range that was changed, I slightly optimized it for my needs. Now, users that enter a list manually won't have to press \"Enter\" two times every time, they want to get to the next line below.</p>\n\n<p>Assuming, the standard user will normally copy and paste, if there is a range of data, he or she does not want to retype, I changed the code, so the module sub only gets activated, if more than one cell has been changed (see below).</p>\n\n<p><strong>The solution:</strong></p>\n\n<p>In every worksheet, that has to be protected against formatting (modified):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'activates format protection when changing a range\n\n    If Target.Cells.Count &gt; 1 Then                      'If more than one cell has been changed...\n        Call Worksheet_Change_Protected(Target)         '...activating protection\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>In a module (unmodified):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Worksheet_Change_Protected(ByVal Target As Range)\n\n    'Prevents user blithely obliterating in-cell formatting by undoing their paste and pasting the value\n\n    'Donna Landy 26.11.2018\n\n    'May be freely copied - hat tip appreciated :)\n\n    Dim SavedVal As Variant\n\n    On Error GoTo ErrHan\n\n    'Save the pasted value for later\n\n    SavedVal = Target.Value\n\n    'Switch off events to prevent infinite loop\n\n    Application.EnableEvents = False\n\n    'Undo the user's paste\n\n    Application.Undo\n\n    'Set target value\n\n    Target.Value = SavedVal\n\nErrExit:\n\n    'Remember to re-enable events\n\n    Application.EnableEvents = True\n\n    Exit Sub\n\nErrHan:\n\n    Resume ErrExit\n\nEnd Sub\n</code></pre>\n\n<p><strong>Thank you very much, Donna Landy!</strong></p>\n"}], "owner": {"reputation": 100, "user_id": 9735478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UdL10.jpg?s=128&g=1", "display_name": "RaspiManu", "link": "https://stackoverflow.com/users/9735478/raspimanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 58447768, "answer_count": 1, "score": 0, "last_activity_date": 1571390391, "creation_date": 1570545690, "last_edit_date": 1571032412, "question_id": 58288693, "link": "https://stackoverflow.com/questions/58288693/how-to-let-users-paste-cells-from-another-excel-instance-ctrlv-but-paste", "title": "How To: Let users paste cells from another excel instance (Ctrl+V,...) but paste only values", "body": "<p><strong>EDITED WITH PROGRESS</strong></p>\n\n<p>Dear Stackoverflow community,</p>\n\n<p>I am working on a big excel file that does some calculations for me and my colleagues. Because the calculation data is a lot and is entered in Ranges (like \"A1:H8\"), not single cells (like \"A1\",\"C1\",...), I want the users to be able to copy data from the same or another excel instance to my file.</p>\n\n<p><strong>The problem (edited):</strong></p>\n\n<p>The problem is, that just pasting cells formats the target cells (even if they are protected against formatting) and this has to be avoided. I searched through a lot of online discussions and finally made my own code, that allows me to copy and paste between two excel files in the same excel instance. Sadly, it does not work, if I copied the cells from another instance.</p>\n\n<p><strong>The code:</strong></p>\n\n<p>This is the code I use in \"ThisWorkbook\":</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub PasteValuesOnly()\n'if cells are pasted in named worksheets, only values are pasted\n'is linked to Ctrl+V in options of macro menu\n\nOn Error GoTo err_handler\n\n    Dim Target As Range\n\n    Set Target = Selection\n\n    If Target.Parent.Name &lt;&gt; \"Table1\" Then\n\n        Selection.PasteSpecial\n\n    Else\n\n        Selection.PasteSpecial Paste:=xlPasteValues\n\n    End If\n\nerr_handler:\n    Exit Sub\nEnd Sub\n</code></pre>\n\n<p><strong>The system:</strong></p>\n\n<ul>\n<li>Windows 7</li>\n<li>Excel 2010</li>\n</ul>\n\n<p><strong>What I tried besides my code (new progress):</strong></p>\n\n<p>As mentioned in the comments, I know <a href=\"http://www.siddharthrout.com/index.php/2018/09/17/vba-excelallow-paste-special-only/\" rel=\"nofollow noreferrer\">Siddharth Rout's solution</a> for only letting the users paste values, but I can't get it to work (not even in a fresh file when copying and pasting inside one Excel instance). I tried it for the whole workbook and for one single sheet.</p>\n\n<p><strong>What would help (edited):</strong></p>\n\n<p>It would be very helpful, if you could tell me how to optimize my code, so it works for two instances as well. If you know what is to do when I have an error with <code>UndoList = Application.CommandBars(\u201cStandard\u201d).Controls(\u201c&amp;Undo\u201d).List(1)</code> in Siddharth Rout's solution with Excel 2010, this would be helpful, too.\nOtherwise I would like every solution, that let's my users paste like they ever do, but prevent them from formatting the cells while pasting.</p>\n\n<p>Thank you in advance</p>\n\n<p>RaspiManu</p>\n"}, {"tags": ["mysql", "excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570545632, "post_id": 58288512, "comment_id": 102941984, "body": "Looking at this <a href=\"https://www.connectionstrings.com/mysql-connector-odbc-5-2/\" rel=\"nofollow noreferrer\">connectionstrings.com/mysql-connector-odbc-5-2</a>, do you need to specify the option?"}, {"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570546324, "post_id": 58288512, "comment_id": 102942401, "body": "Tried writing the options but still has the same error. Thanks."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1570547355, "post_id": 58288512, "comment_id": 102942949, "body": "You&#39;re missing the concatenation and line continuation on the second to last line."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "edited": false, "score": 0, "creation_date": 1570632629, "post_id": 58290013, "comment_id": 102975511, "body": "Thanks for all the information! This will surely help me in the future!"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1570550603, "last_edit_date": 1570550603, "creation_date": 1570550263, "answer_id": 58290013, "question_id": 58288512, "link": "https://stackoverflow.com/questions/58288512/open-a-connection-where-there-is-a-password-run-time-error-2147221241-800401/58290013#58290013", "title": "Open a connection where there is a password: Run-time error &#39;-2147221241 (80040107) Automation error Unspecified error", "body": "<p>Consider the below best practices in VBA:</p>\n\n<ol>\n<li><p>Always <code>Debug\\Compile</code> code after code changes. In fact, VBA should have raised or highlighted or red-lettered the syntax issue of line continuation as soon as your cursor leaves the problem line. See added <code>&amp;_</code> below. But possibly this is a typo in your post.</p>\n\n<pre><code>\"Password=****;\"  &amp; _\n\"Option=3;\"\n</code></pre></li>\n<li><p>Use appropriate <a href=\"http://www.cpearson.com/excel/ErrorHandling.htm\" rel=\"nofollow noreferrer\">error handling</a> especially when interacting with APIs like ADO that can raise runtime exceptions for more informative messages:</p>\n\n <pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\nOn Error Goto ErrHandle\n\n      '...code...\n\nExitHandle:\n   Set con = Nothing  ' RELEASE ALL set OBJECTS\n   Exit Sub\n\nErrHandle:\n   Msgbox Err.Number &amp; \": \" &amp; Err.Description\n   Resume ExitHandle\nEnd Sub\n</code></pre></li>\n<li><p>Use the industry best practice standard of SQL parameterization whenever you import data between application layer (i.e., VBA) and database (i.e., MySQL). Among <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">security</a> reasons, it is more efficient, readable, and maintainable as you avoid messy quotes and concatenation. In fact, your current code misses a last single quote:</p>\n\n <pre class=\"lang-vb prettyprint-override\"><code>\" ... ' \" &amp; row.Cells(3).Value &amp; \" ',' \" &amp; row.Cells(5).Value &amp; \")\"\n</code></pre>\n\n<p>Most DB-APIs like ADO support <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/parameters-collection-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">parameterization</a>. Though implementation will differ beyond VBA to other languages and beyond MySQL to other databases, the core concept is the same involving a prepared statement with parameter placeholders that are later binded with literal values. Consider below adjustment:</p>\n\n <pre class=\"lang-vb prettyprint-override\"><code>Dim con As ADODB.Connection, cmd As ADODB.Command\nDim rng As Range, row As Range\n\nSet con = New ADODB.Connection\ncon.Open ...\n\n' PREPARED STATEMENT (NO DATA)\nsqlStr = \"INSERT INTO TestExperiment(Experiment_id, Experiment_Name, Experiment_Method, \" &amp; _\n         \"                           Experiment_Analyst, Experiment_NumSample) \" &amp; _\n         \" VALUES (?, ?, ?, ?, ?)\" \n\n' ITERATE THROUGH ROWS\nFor Each row In Application.Range(\"EXP\").Rows\n    Set cmd = New ADODB.Command\n\n    With cmd \n        .ActiveConnection = con\n        .CommandType = adCmdText\n        .CommandText = sqlStr\n\n        ' BIND PARAMS\n        .Parameters.Append .CreateParameter(\"id_param\", adVarChar, adParamInput, 255, row.Cells(1).Value)\n        .Parameters.Append .CreateParameter(\"name_param\", adVarChar, adParamInput, 255, row.Cells(2).Value)\n        .Parameters.Append .CreateParameter(\"method_param\", adVarChar, adParamInput, 255, row.Cells(3).Value)\n        .Parameters.Append .CreateParameter(\"analyst_param\", adVarChar, adParamInput, 255, row.Cells(4).Value)\n        .Parameters.Append .CreateParameter(\"sample_param\", adVarChar, adParamInput, 255, row.Cells(5).Value)\n\n        ' EXECUTE ACTION\n        .Execute\n    End With\n\n    Set cmd = Nothing\nNext row\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 57, "user_id": 12080565, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muEYIzSV9MI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4fhSRGjihFpMNGkTgvxeatOK0Kg/photo.jpg?sz=128", "display_name": "Rupesh Ghosh", "link": "https://stackoverflow.com/users/12080565/rupesh-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 58290013, "answer_count": 1, "score": 1, "last_activity_date": 1570550603, "creation_date": 1570545182, "last_edit_date": 1570547827, "question_id": 58288512, "link": "https://stackoverflow.com/questions/58288512/open-a-connection-where-there-is-a-password-run-time-error-2147221241-800401", "title": "Open a connection where there is a password: Run-time error &#39;-2147221241 (80040107) Automation error Unspecified error", "body": "<p>I have a database hosted on AWS RDS- MySQL database and I am trying to push the data from Excel to the database using VBA on clicking a button.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n  Dim con As ADODB.Connection\n\n  Set con = New ADODB.Connection\n  con.Open \"Driver={MySQL ODBC 5.2.2 Driver};\" &amp; _\n      \"Server=worksheetautomation.***************.rds.amazonaws.com;\" &amp; _\n      \"Database=worksheet;\" &amp; _\n      \"User=****;\" &amp; _\n      \"Password=****;\"\n      \"Option=3;\"\n\n  Dim rng As Range\n  Set rng = Application.Range(\"EXP\")\n  Dim row As Range\n  For Each row In rng.Rows\n       Sql = \"insert into TestExperiment(Experiment_id, Experiment_Name, Experiment_Method, Experiment_Analyst, Experiment_NumSample) values (' \" &amp; row.Cells(1).Value &amp; \" ' , ' \" &amp; row.Cells(1).Value &amp; \" ', ' \" &amp; row.Cells(2).Value &amp; \" ', ' \" &amp; row.Cells(3).Value &amp; \" ',' \" &amp; row.Cells(5).Value &amp; \")\"\n       con.Execute Sql\n  Next row\n\n  con.Close     \n  MsgBox \"Done\"\n\nEnd Sub\n\n</code></pre>\n\n<p>I am trying to execute this code and getting a run time error and when I try to debug the code:</p>\n\n<blockquote>\n  <p>Run-time error '-2147221241 (80040107)</p>\n</blockquote>\n\n<pre class=\"lang-vb prettyprint-override\"><code>con.Open \"Driver={MySQL ODBC 5.2.2 Driver};\" &amp; _\n\"Server=worksheetautomation.***************.rds.amazonaws.com;\" &amp; _\n\"Database=worksheet;\" &amp; _\n\"User=****;\" &amp; _\n\"Password=****;\"\n\"Option=3;\"\n</code></pre>\n\n<p>This part is marked in yellow with an arrow on the password line.</p>\n"}, {"tags": ["excel", "vba", "combobox", "activex"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1570545103, "post_id": 58288310, "comment_id": 102941688, "body": "Have you attempted to name the button in a way that captures the row it is tied to?  E.g., button &quot;cat_|1&quot; is on row 1 and &quot;cat_|30&quot; is on row 30, so you can use <code>instr(cell,&quot;_|&quot;)</code> to find the location of the row number and use that to loop through your activex controls and delete the one with the name of the row being deleted."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1570545485, "post_id": 58288310, "comment_id": 102941898, "body": "Try to qualify your sheet. Using <code>ActiveSheet</code> can cause issues like this. Saying that, where does the code to delete reside?"}, {"owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "edited": false, "score": 0, "creation_date": 1570545789, "post_id": 58288310, "comment_id": 102942075, "body": "Tried both the approaches with no noticeable success."}], "owner": {"reputation": 1282, "user_id": 4434202, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516d7a498b3dddcf29e46e5f7d121469?s=128&d=identicon&r=PG&f=1", "display_name": "Akinn", "link": "https://stackoverflow.com/users/4434202/akinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570544568, "creation_date": 1570544568, "question_id": 58288310, "link": "https://stackoverflow.com/questions/58288310/cannot-delete-line-and-the-combobox-upon-it", "title": "Cannot delete line and the combobox upon it", "body": "<p>I have a worksheet creating ActiveX Comboboxes when the user adds a text in a specific column.\nSpecifically, the user enters a string in a cell of column A and a macro then get the text and creates a combobox over the very same cell.</p>\n\n<p>Now, I would like to add a Delete button besides the newly created combobox in order to delete the same row.</p>\n\n<p>I managed to create the combobox and the button too but 'sometimes' I have an error in the row deletion: in particular the row is correctly deleted but the combobox still persists. I don't understand the issue since it does not occur every time.</p>\n\n<p>How I add the comboboxes and the delete button (in a Worksheet_change handler):</p>\n\n<pre><code>    Dim cb As OLEObject\n\n    Set cb = ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.ComboBox.1\", Link:=False, DisplayAsIcon:=False, Left:=targ.Left, Top:=targ.Top, Width:=targ.Width, Height:=targ.Height)\n    cb.LinkedCell = targ.Address\n\n    For Each cell In paramRange\n        cb.Object.AddItem cell.value\n    Next cell\n\n    Dim delBtn As Button\n    Set delBtn = ActiveSheet.Buttons.Add(ActiveSheet.Cells(targ.row, 13).Left, ActiveSheet.Cells(targ.row, 13).Top, ActiveSheet.Cells(targ.row, 13).Width, ActiveSheet.Cells(targ.row, 13).Height)\n\n    With delBtn\n        .OnAction = \"DeleteLine\"\n        .Caption = \"DELETE\"\n        .name = targ.row\n    End With\n</code></pre>\n\n<p>The macro related to the pression of the delete button:</p>\n\n<pre><code>For Each OleObj in ActiveSheet.Rows(CInt(Application.Caller.row)).OLEObjects \n   oleObj.Delete\nNext oleObj.Delete\n\nRows(CInt(ActiveSheet.Shapes(Application.Caller).name)).Delete\n</code></pre>\n\n<p>As I said, most of the times the related row AND the associated combobox is deleted nicely, but sometimes only the row is deleted while the combobox still hangs in its place.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570544082, "post_id": 58288066, "comment_id": 102941095, "body": "Can you be more specific as to which line throws the error? Also, FYI: VBA is not a scripting language. There is a <code>VB script</code> which is a scripting language"}, {"owner": {"reputation": 21, "user_id": 9811050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/968ab17dafd5516631d4c554999f9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Stoepsteen", "link": "https://stackoverflow.com/users/9811050/stoepsteen"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570545309, "post_id": 58288066, "comment_id": 102941802, "body": "I&#39;ve adjusted my question"}], "owner": {"reputation": 21, "user_id": 9811050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/968ab17dafd5516631d4c554999f9e6b?s=128&d=identicon&r=PG&f=1", "display_name": "Stoepsteen", "link": "https://stackoverflow.com/users/9811050/stoepsteen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570545283, "creation_date": 1570543710, "last_edit_date": 1570545283, "question_id": 58288066, "link": "https://stackoverflow.com/questions/58288066/adding-images-into-header-using-excel-vba", "title": "Adding images into header using excel VBA", "body": "<p>I'm trying to fit an image into a header of an excel worksheet using a VBA script that generates the plotted result. (fit to page, page numbering etc.).</p>\n\n<p>I already have a working script to generate the wanted result (all the text without the image). But it seems to fail when I try to add the linked image into the VBA code. </p>\n\n<p>edit: I deleted all the info and only have left the part where I added the image into the header.\nThe macro seems to work but when I look at the result, the expected image isn't included into the file.</p>\n\n<pre><code>Sub PlotPDF2()\n\n\nActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=1\nActiveSheet.Outline.ShowLevels RowLevels:=2\n\n\nApplication.PrintCommunication = True\nApplication.Dialogs(xlDialogPrinterSetup).Show\nWith ActiveSheet.PageSetup\n    ActiveWindow.View = xlPageBreakPreview\nActiveSheet.PageSetup.PrintArea = \"$A:$O\"\n    .PrintTitleRows = \"$1:$1\"\n    .PrintTitleColumns = \"\"\nEnd With\n\nApplication.PrintCommunication = True\nActiveSheet.PageSetup.PrintArea = \"\"\nApplication.PrintCommunication = True\nWith ActiveSheet.PageSetup\n    ActiveSheet.PageSetup.LeftHeaderPicture.Filename = _\n    \"\\\\SERVER\\image1.jpg\"\nEnd With\nWith ActiveSheet.PageSetup.LeftHeaderPicture\n    .Height = 1.2\n    .Width = 17\nEnd With\n\nApplication.PrintCommunication = True\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n    IgnorePrintAreas:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1570544871, "post_id": 58288015, "comment_id": 102941543, "body": "Would it be correct to guess that the first row of every text file ends up in the Excel sheet?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1570544924, "post_id": 58288015, "comment_id": 102941577, "body": "When you&#39;re referencing the destination range, you aren&#39;t specifying which worksheet, it defaults to the currently active sheet. So use <code>Destination:=Sheets(&quot;Log&quot;).Range(&quot;A&quot; &amp; LR)</code>"}], "owner": {"reputation": 99, "user_id": 11773981, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OnGEDcvsbgg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1AuAjXZZ7RXVh88t_z7a9cEec1g/photo.jpg?sz=128", "display_name": "khyati dedhia", "link": "https://stackoverflow.com/users/11773981/khyati-dedhia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570543509, "creation_date": 1570543509, "question_id": 58288015, "link": "https://stackoverflow.com/questions/58288015/csv-file-export", "title": "CSV file export", "body": "<p>I wanted to get multiple txt file into single sheet, I have tried below code but it is not coping data below exiting data in the sheet.</p>\n\n<p>data is over writing existing data.</p>\n\n<pre><code>Sub QueryImportText()\n    Dim sPath As String, sName As String\n    Dim LR As Long, qt As QueryTable\n\n    sPath = \"F:\\WIN7PROFILE\\Desktop\\New folder\\\"\n    sName = Dir(sPath &amp; \"*.txt\")\n    LR = Sheets(\"Log\").UsedRange.Rows.Count\n    Do While sName &lt;&gt; \"\"\n        LR = LR + 1\n'        Range(\"A\" &amp; LR).Value = sName\n        With Sheets(\"Log\").QueryTables.Add(Connection:= _\n            \"TEXT;\" &amp; sPath &amp; sName, Destination:=Range(\"A\" &amp; LR))\n        .Name = Left(sName, Len(sName) - 4)\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 1252\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileOtherDelimiter = \"|\"\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n        End With\n        sName = Dir()\n        For Each qt In ActiveSheet.QueryTables\n            qt.Delete\n        Next\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Can you help me with correct code so all the txt file pasted one below another in \"Log\" sheet</p>\n"}, {"tags": ["vba", "ms-access", "dcount"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1570543232, "post_id": 58287670, "comment_id": 102940578, "body": "IDK maybe its because I havent had enough caffiene yet but it looks like your check for 0 records looks for greater than 0 - should it be less than one? At least thats what I am to conclude based on the error message for it?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1570543555, "post_id": 58287670, "comment_id": 102940773, "body": "I also added Exit Subs to your validations. Most of the time you might want to stop executing unnecessary code if validations fail. But feel free to let me know fi this was intentional."}, {"owner": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1570543616, "post_id": 58287670, "comment_id": 102940809, "body": "Thank you!! when I changed to to &lt;1 it work."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1570543721, "post_id": 58287670, "comment_id": 102940873, "body": "Yay we did it! :D"}, {"owner": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1570546594, "post_id": 58287670, "comment_id": 102942551, "body": "I have other check boxes and if statements.  How do I keep it from showing a message for each query that is blank?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1570547157, "post_id": 58287670, "comment_id": 102942844, "body": "@hllary Just remove the message box part"}], "owner": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594421441, "creation_date": 1570542338, "last_edit_date": 1594421441, "question_id": 58287670, "link": "https://stackoverflow.com/questions/58287670/access-vba-if-check-box-true-open-query-but-give-message-if-empty", "title": "Access VBA If check box = true open query but give message if empty", "body": "<p>I've seen a number of post about not opening a query if the query is blank but not sure where to have the code to check the output of the query.  Before the query is run i have a number of conditions, if they are met then the query is opened.\nWhen i run the code below, the query opens and I do not get the message box.</p>\n\n<pre><code>Private Sub BetweenDates_Click()\n    If IsNull(Me.DateMin) Then\n        MsgBox \"Enter starting date\"\n        EXIT SUB\n    End If\n\n    If IsNull(Me.DateMax) Then\n        MsgBox \"Enter ending date\"\n        EXIT SUB\n    End If\n\n    If (Forms![2ndfrm_AddEditView]![CbCATracker1] = True) Then\n        DoCmd.OpenQuery \"SearchCaTrackerCLUpdatedOn_Bt_qry\"\n    end if \n\n    If DCount(\"*\", \"SearchCaTrackerCLUpdatedOn_Bt_qry\") &gt; 0 Then\n       MsgBox (\"No records for that date range\")\n       EXIT SUB\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570543524, "post_id": 58287580, "comment_id": 102940751, "body": "Can you provide the xPath to <code>Submit</code> button? For the table, can you not get table elements on the page?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1570563812, "post_id": 58287580, "comment_id": 102950242, "body": "what does stops mean? Is there an error?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1570563612, "creation_date": 1570563612, "answer_id": 58293029, "question_id": 58287580, "link": "https://stackoverflow.com/questions/58287580/how-to-submit-login-credentials/58293029#58293029", "title": "How to submit login credentials?", "body": "<p>Try using attribute = value css selector</p>\n\n<pre><code>ie.document.querySelector(\"[name=submit]\").click\n</code></pre>\n\n<p>For your table your best bet is to locate it by it's relationship to other elements/attributes. Impossible to advise further without seeing more html. Failing that if there is a unique attribute or attribute=value in that table (not present in other tables) then combine that to id the table</p>\n\n<p>e.g. </p>\n\n<pre><code>ie.document.querySelector(\"table[width='400']\")\n</code></pre>\n\n<p>This is a less robust method.</p>\n"}, {"tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1570600324, "creation_date": 1570600324, "answer_id": 58297800, "question_id": 58287580, "link": "https://stackoverflow.com/questions/58287580/how-to-submit-login-credentials/58297800#58297800", "title": "How to submit login credentials?", "body": "<p>I tested your code and I am able to produce the issue.</p>\n\n<p>As an alternative, you can try to loop through input elements and try to find the submit and click it.</p>\n\n<pre><code> Set objCollection = ieApp.document.getElementsByTagName(\"input\")\n\n    i = 0\n    While i &lt; objCollection.Length\n\n            If objCollection(i).Type = \"submit\" And _\n               objCollection(i).Name = \"submit\" Then\n\n\n                objCollection(i).Click\n\n            End If\n\n        i = i + 1\n    Wend\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11797904, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156023722201114/picture?type=large", "display_name": "mccarthy995", "link": "https://stackoverflow.com/users/11797904/mccarthy995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1581909548, "creation_date": 1570542051, "last_edit_date": 1581909548, "question_id": 58287580, "link": "https://stackoverflow.com/questions/58287580/how-to-submit-login-credentials", "title": "How to submit login credentials?", "body": "<p>This is relating to the submit button of the login screen</p>\n\n<p>HTML:</p>\n\n<pre><code>&lt;TD background=/frontend/images/greenback.gif width=302&gt;&lt;INPUT type=submit value=\"Login now\" name=submit&gt; &lt;/TD&gt;\n</code></pre>\n\n<p>I enter the username and password into the box but the script stops at <code>.Submit</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GetTable()\n\n'Kills any open IE windows.\nOn Error GoTo Ignore\nCall IE_Sledgehammer\nIgnore:\n\nDim ieApp As InternetExplorer\nDim ieDoc As Object\nDim ieTable As Object\nDim clip As DataObject\nDim UserName As String, Password As String\n\n'Create anew instance of ie\nSet ieApp = New InternetExplorer\n\n'Debugging\nieApp.Visible = True\n\n'Opening this page prompts login screen\nieApp.Navigate \"CANNOT SHARE, INTERNAL WORK SITE\"\n\n'When busy - wait\nDo While ieApp.Busy: DoEvents: Loop\nDo Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n'Pop up window\nOn Error GoTo skip_Popup\nieApp.Document.all.item(\"submitBn\").Focus\nSendKeys \"~\"\nskip_Popup:\n\n'Login script\nOn Error GoTo Skip_Login\nSet ieDoc = ieApp.Document\n\n'fill in the login form \u2013 View Source from your browser to get the control names\nWith ieDoc.forms(0)\n    .UserName.Value = \"test1\"\n    .Password.Value = \"test2\"\n    .Submit\nEnd With\n\nDo While ieApp.Busy: DoEvents: Loop\nDo Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\nSkip_Login:\n\n'Copy page Info\nSet ieDoc = ieApp.Document\nSet ieTable = ieDoc.all.item\n\n'Copy Paste the page\nIf Not ieTable Is Nothing Then\n    Set clip = New DataObject\n    clip.SetText \"\" &amp; ieTable.outerHTML &amp; \"\"\n    clip.PutInClipboard\n\n    'Location of data\n    Sheets(\"Raw Data\").Range(\"E2\").PasteSpecial \"text\"\nEnd If\n\n'Delete any form controls that make it into the sheet\nSheets(\"Raw Data\").DrawingObjects.Delete\n\n'Kills ALL IE windows\nCall IE_Sledgehammer\nSet ieApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Also this is not critical, how do I just select the table on the page and not everything else? It doesn't have a name so I am stuck with this one also. </p>\n\n<p>HTML:</p>\n\n<pre><code>&lt;table cellspacing=\"1\" cellpadding=\"2\" align=\"center\" border=\"0\" width=\"400\"&gt;\n</code></pre>\n"}, {"tags": ["vba", "cdo.message"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "edited": false, "score": 0, "creation_date": 1579171444, "post_id": 59695299, "comment_id": 105679664, "body": "The issues discussed here might stop a particular account working. My answer here will help you get that account working again. In another Thread,  <a href=\"https://stackoverflow.com/questions/58525487/excel-vba-cdo-message-email-sending-accounts-work-less-and-less/59756971#59756971\" title=\"excel vba cdo message email sending accounts work less and less\">stackoverflow.com/questions/58525487/&hellip;</a>  , I give a solution which will allow a macro to work by trying a number of accounts, so that you can get the job done, and then can later \u201crepair\u201d any failing accounts"}], "tags": [], "owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "is_accepted": true, "score": 1, "last_activity_date": 1578754811, "last_edit_date": 1578754811, "creation_date": 1578752691, "answer_id": 59695299, "question_id": 58286932, "link": "https://stackoverflow.com/questions/58286932/sending-gmail-using-cdo-some-accounts-produce-message-could-not-be-sent-to-smt/59695299#59695299", "title": "Sending gmail using CDO: Some accounts produce &quot;message could not be sent to SMTP server. transport error 0x80040217. server response not available&quot;", "body": "<p>I have the problem solved so I  am sharing the solution. </p>\n\n<p>I have now improved the situation from 3 out of 10 accounts working to 11 out of 11 accounts working. </p>\n\n<p>Here are the solution details for anyone else that has a similar problem. I would recommend starting with the solution _4)   , as that is the quickest. If that does not solve the problem you will need to look at the others. The others may involve some laborious work.</p>\n\n<p>_1 A strange thing in an old account, which was recently not working in my program and which  I had definitely checked many times for  Less Secure Apps On. </p>\n\n<p>This account still had in the InBox many old typical Email Warnings from when I had attempted to do things such as logging  in different places. ( Often this causes a temporary block, or resetting of Less Secure Apps Off , until you confirm something like \u201cyes, that was me\u201d ). All had been answered by me with \u201cyes it was me\u201d, at least I am 98% sure about that \u2013they all been read, so it is very unlikely that I had ignored them</p>\n\n<p>Never the less , I laboriously re read the Email warnings, and followed the link which almost always confirmed that I had answered, and any given link  to the  setting showed that it was indeed set to On.\nThere was one exception : the link showed that the Setting was off. Still looking at any other link or looking in that account settings showed it to be On. But I switched it on anyway, after which the account worked again in my program. </p>\n\n<p>I note that all links in warnings are unique, as they contain information specific to the occurrence which sets off the warning. One explanation of the possible bug is that somehow an answer warning  gets set back to unanswered, which blocks the account. The check for validation might be based for some reason on a dynamic process that has all the warnings in a chain, such that all must be answered with yes. This make sense since you can change your answer at a later date.  The work around is to re answer all old warnings. In some    old accounts I had trashed old Email warnings anymore, so I thought that I could not answer again answer, such that the account would remain blocked, despite showing that it isn\u2019t. But strangely, in the trash folder all old warnings were there despite the default setting of only holding trash for 30 days\u2026   <a href=\"https://imgur.com/thNdDaV\" rel=\"nofollow noreferrer\">https://imgur.com/thNdDaV</a>   \u2026 very strange, in that screenshot there are entries going back to early 2018, despite the fact that it clearly states there that trash is deleted after 30 days. Other stuff that I trashed is gone. \n  In future , to be on the safe side, I will archive rather than delete warning Emails, or at least store the link given in it for checking and re setting Less Secure Apps. </p>\n\n<p>_2  Setting suddenly showing (correctly) Off, allowing it to be set to On.  Another old account, which was recently not working in my program and which  I had definitely checked many times for  Less Secure Apps On, suddenly showed Less Secure Apps Off. I then switched it On, and the account worked in my program. This may have been caused indirectly by some of the \u201ccross wire\u201d effects whilst I was looking at effects in other accounts. The moral of this one is not to rely on checking the setting just once, as later it might change for no apparent reason. </p>\n\n<p>_ 3)  I mentioned in the original post that my personal telephone cant be used any more to verify a new account, (gmail only allow a few uses for SMS confirmation \u2013 they deliberately do not say how many).  Mostly that is still the case. On one random attempt during my experiments it worked. The new account then also worked in my program. \u2013 Hence I have 11 out of 11 now working, rather than 10 out of 10. </p>\n\n<p>Similar conclusion again here: Don\u2019t rely on the situation being static, some external thing  may have some effect giving you a short period to do something that is generally not possible.</p>\n\n<p>_4) Links going to wrong accounts. This mostly happens when I have other accounts open, but occasionally it also happens when I only have one account open.</p>\n\n<p>As example: I get a valid warning based on some activity that I do on an account: <a href=\"https://imgur.com/VTAJOWc\" rel=\"nofollow noreferrer\">https://imgur.com/VTAJOWc</a> , I give it the OK, <a href=\"https://imgur.com/mKskkzx\" rel=\"nofollow noreferrer\">https://imgur.com/mKskkzx</a>  , and I then see a notice informing me that the Less Secure Apps has been set to Off, <a href=\"https://imgur.com/9bNePXf\" rel=\"nofollow noreferrer\">https://imgur.com/9bNePXf</a> . So I follow the link for further info: <a href=\"https://imgur.com/LpGQYlj\" rel=\"nofollow noreferrer\">https://imgur.com/LpGQYlj</a> , and there after I follow  a link to turn Less Secure Apps back on, <a href=\"https://imgur.com/WuMjPml\" rel=\"nofollow noreferrer\">https://imgur.com/WuMjPml</a> . So far so good \u2013 note the account shown in the coloured ball top right is the correct one: <a href=\"https://imgur.com/yj09MsX\" rel=\"nofollow noreferrer\">https://imgur.com/yj09MsX</a></p>\n\n<p>Now it gets interesting: I end up at the wrong account: <a href=\"https://imgur.com/T050wP4\" rel=\"nofollow noreferrer\">https://imgur.com/T050wP4</a> </p>\n\n<p>That is easy to overlook. The solution here was to ignore links given and go directly to settings on the correct account, preferably soon after you get the warning. If you do not do that, then not only will you possibly not get to set the correct account, but also you possibly get another undesirable effect: sometimes the act of following the ( \u201ccrossed\u201d ) link seemed to set off sporadic warnings and setting changes on other accounts !!! </p>\n\n<p>This is all suggesting to me that there is some \u201ccross wire type\u201d bugs somewhere in Google. </p>\n\n<p>_  5 ) Rogue account getting other accounts warnings. This is related to _4) , but in particular one of my accounts not only got effected by following the \u201ccross  wired links\u201d , but also frequently gets  the warnings that should go to the other accounts. This happens even when I am not using that account anywhere. Once again this suggests some \u201ccross wiring / leakage\u201d caused by Google tracking what I , personally , am doing</p>\n\n<p>_.______________</p>\n\n<p>The short answer to what the problem was/is,  is  possibly that Less Safe App access was being blocked/ temporarily tuned Off, but for varied reasons it was not easy to switch it back On, since the obvious way to do that via settings was no use since it was often indicated as already On, and in some cases , just looking at it caused other account settings to change!!</p>\n\n<p>I am slightly put off using gmail in my  program. I have some concern that Google in its \u201cspying\u201d has got \u201ccross wires / leakage\u201d and it has grown into an uncontrollable monster that will probably break out of its server and appear  in front of me and try kill me \u2026\u2026 I actually registered the particular account discussed in _5) when I was away from home in India!!!  \u2026\u2026\u2026\u2026  \u201c\u2026You are experiencing a car accident \u2026 The hell I am..\u201d -- <a href=\"https://www.youtube.com/watch?v=L0Fw8TVYBKg\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=L0Fw8TVYBKg</a> </p>\n\n<p>_.__________________-</p>\n\n<p>I think we have all experienced at  one time or another that adverts seem to pop up which obviously have got some \u201cinside information\u201d about us, which amongst other sources, may come from some Google \u201cspying\u201d on you . I use the word \u201cspying\u201d loosely \u2013 most likely we have agreed to it when agreeing to something without fully reading all the small print.</p>\n\n<p>My recent experience is showing that I can follow links to change settings on one of my Google accounts, and then actually change settings on other accounts, even if I am not logged into these accounts. Further, I can change setting in one of my accounts, and it will cause changes in other accounts. I am not sure if that is supposed to happen. But it certainly does happen to me on some of my computers. </p>\n\n<p>The common thing  that is causing this cross wiring may be Google chrome browser.  I should say finally that I am using a very old version often , in Vista. Possibly these issues do not arise if you only use a newer version.. </p>\n\n<p>Alan</p>\n"}], "owner": {"reputation": 51, "user_id": 4031841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alan Elston", "link": "https://stackoverflow.com/users/4031841/alan-elston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2477, "favorite_count": 0, "accepted_answer_id": 59695299, "answer_count": 1, "score": 0, "last_activity_date": 1582693475, "creation_date": 1570539869, "last_edit_date": 1582693475, "question_id": 58286932, "link": "https://stackoverflow.com/questions/58286932/sending-gmail-using-cdo-some-accounts-produce-message-could-not-be-sent-to-smt", "title": "Sending gmail using CDO: Some accounts produce &quot;message could not be sent to SMTP server. transport error 0x80040217. server response not available&quot;", "body": "<p>I have a typical <em>\u201cCDO gmail Email send\u201d</em> macro. It has worked reliably for a couple of years now.</p>\n\n<p>I use a spare gmail account as the address it uses to send from. I want to share the macro with some people. So I will use a different gmail address as the sender.</p>\n\n<p>I have some other spare gmail accounts and also some of the people have registered an account and given me the Username and Password to add to the macro as the sending address.</p>\n\n<p>I have 10 accounts, seven of mine and three registered by others. All work in normal manual use. Three work with the macro, seven don\u2019t.</p>\n\n<p>As far as I can tell. all have identical settings. This includes the unsafe setting of On for <em>\u201cLess secure app access\u201d</em>.</p>\n\n<p>The accounts have been registered at different times over the last two years. </p>\n\n<p>One of the accounts that does not work was registered recently by someone having no previous accounts. One of the accounts that does work has been used almost daily for two years both manually and with the macro.</p>\n\n<p>Two accounts were registered at the same time by two people in my family. They have been used normally/ manually to approximately the same extent for two years, but not previously with my macro. One account works in the macro, the other doesn\u2019t.</p>\n\n<p>These facts suggest to me that the non working accounts have not been blocked for suspected spamming. It seems random which accounts work and which don\u2019t. </p>\n\n<p>Below is a simplified version of the macro.  (I can mostly use 465 or 25 as the smtpserverport. The results are almost always identical with either. Only very rarely, one will work whilst the other doesn\u2019t. This seems to depend on the location from which the attempt is made). </p>\n\n<p>The results I get are fairly consistent, including using the macro from different locations and different IP addresses.</p>\n\n<p>I occasionally get security warnings for all accounts when I use the accounts from new locations but I always confirm that <em>\u201cit was me\u201d</em>. After taking this action, I never get security warnings again when using the account at that location. Immediately after such a warning, the account is temporarily blocked but the block is removed after I confirm <em>\u201cit was me\u201d</em>.</p>\n\n<p>Three of the addresses almost always work with the macro. On the rare occasions that they don\u2019t work, a second attempt is usually successful. (Those working addresses have been registered by me sometime in the last two years.) </p>\n\n<p>Seven of the addresses never work with the macro. The error message at the .Send point is always the same:</p>\n\n<blockquote>\n  <p><em>-2147220975:<br>\n  Die Nachricht konnte nicht an den SMTP-Server gesendet werden. Der Transportfehlercode lautet 0x80040217. Die Serverantwort lautet not available</em></p>\n</blockquote>\n\n<p>An approximate English translation:</p>\n\n<blockquote>\n  <p><em>-2147220975:<br>\n  The message could not be sent to the SMTP server. The transport error code is 0x80040217. The server response is not available</em></p>\n</blockquote>\n\n<p>(To run the macro below, you must edit to give a real gmailAddress@gmail.com , a real gmailPassword , and real places to send the Email to at the .To and .cc)</p>\n\n<pre><code>Sub Run_gMail_Send_Simplified() ' Run this macro with a valid   gmailAddress@gmail.com   and    gmailPassword   and real places to send the Email to at the .To and .cc place\n Call gMail_Send_Simplified(\"gmailAddress@gmail.com \", \"gmailPassword\")\nEnd Sub\n\n\nSub gMail_Send_Simplified(ByVal UsrNme As String, ByVal PsWd As String) '\n   With CreateObject(\"CDO.Message\") '                  ' -------------------*  with LCDCW Library ( Linking Configuration Data Cods Wollups)  which are  used and items configured for the Exchange at Microsoft's protocol therof\n    Dim LCD_CW As String: Let LCD_CW = \"http://schemas.microsoft.com/cdo/configuration/\"\n     .Configuration(LCD_CW &amp; \"smtpusessl\") = True '\n     .Configuration(LCD_CW &amp; \"smtpauthenticate\") = 1\n    '  ' Sever info\n     .Configuration(LCD_CW &amp; \"smtpserver\") = \"smtp.gmail.com\" '\n    '  The mechanism to use to send messages.\n     .Configuration(LCD_CW &amp; \"sendusing\") = 2\n     .Configuration(LCD_CW &amp; \"smtpserverport\") = 25 ' or 465\n     .Configuration(LCD_CW &amp; \"sendusername\") = UsrNme   '\n     .Configuration(LCD_CW &amp; \"sendpassword\") = PsWd\n    ' Optional - How long to try                      ( End remote SMTP server configuration section )\n     .Configuration(LCD_CW &amp; \"smtpconnectiontimeout\") = 30 '\n    ' Intraction protocol is Set/ Updated\n     .Configuration.Fields.Update '\n    'End With                                          ' -------------------* End with LCDCW Library ( Linking Configuration Data Cods Wollups)  which are  used and items configured for the Exchange at Microsoft's protocol therof\n    ' Data to be sent\n    .To = \"mrlotus123@somemail.com\"\n    .cc = \"billandben@someuveremail.com\"\n    .BCC = \"\"\n    .from = \"\"\"gMail_Send_Simplified\"\" &lt;\"\"\" &amp; UsrNme &amp; \"\"\"&gt;\"\n    .Subject = \"Hello from  \" &amp; UsrNme &amp; \"   using  gMail_Send_Simplified\"     '\n    .TextBody = \"Hi\" &amp; vbNewLine &amp; vbNewLine &amp; \"Testing. Please ignore this EMail\"\n    ' Do it\n     On Error GoTo Bed                                                                             ' Intended to catch a possible predicted error in the next line when running the routine\n      .send\n     On Error GoTo 0\n    Debug.Print \"Done \" &amp; Format(Now(), \"hh mm\") &amp; \"    with Username:  \" &amp; UsrNme &amp; vbCr &amp; vbLf\n    End With '                                                       End With  CreateObject(\"CDO.Message\") (Rem 1 Library End =======#\nExit Sub\nBed:\n Debug.Print \"Fail \" &amp; Format(Now(), \"hh mm\") &amp; \"    with Username:  \" &amp; UsrNme &amp; vbCr &amp; vbLf &amp; \"  \" &amp; Err.Number &amp; \":  \" &amp; Err.Description &amp; vbCr &amp; vbLf\nEnd Sub\n</code></pre>\n\n<p>Any suggestions other than registering accounts and picking out the ones that work?</p>\n\n<p>Is there some setting I may have missed?</p>\n\n<p>Question also posted here:\n<a href=\"https://support.google.com/mail/thread/17437986?hl=en&amp;authuser=5\" rel=\"nofollow noreferrer\">https://support.google.com/mail/thread/17437986?hl=en&amp;authuser=5</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 3, "creation_date": 1570538626, "post_id": 58286559, "comment_id": 102937914, "body": "Are some of the max values too large for integer type or are decimals?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 3, "creation_date": 1570538769, "post_id": 58286559, "comment_id": 102937994, "body": "Also, you don&#39;t need <code>rng.Select</code>"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 3, "creation_date": 1570539022, "post_id": 58286559, "comment_id": 102938147, "body": "To add to the commentors above, you should qualify all of your ranges correctly."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1570539384, "post_id": 58286559, "comment_id": 102938349, "body": "change <code>Set rng = Range(&quot;$E$10:&quot; &amp; Range(&quot;E10&quot;).End(xlToRight).Address)</code> to <code>Set rng = Range(&quot;E10&quot;, Cells(10, Columns.Count).End(xlToLeft))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12181309, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220138349790874/picture?type=large", "display_name": "Wanda Alarcon Ferraguto", "link": "https://stackoverflow.com/users/12181309/wanda-alarcon-ferraguto"}, "edited": false, "score": 0, "creation_date": 1570545738, "post_id": 58287171, "comment_id": 102942038, "body": "This did the trick :) Thanks a lot for helping me. I am new to this and trying my best!!"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "reply_to_user": {"reputation": 3, "user_id": 12181309, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220138349790874/picture?type=large", "display_name": "Wanda Alarcon Ferraguto", "link": "https://stackoverflow.com/users/12181309/wanda-alarcon-ferraguto"}, "edited": false, "score": 0, "creation_date": 1570548565, "post_id": 58287171, "comment_id": 102943581, "body": "I&#39;m happy you were helped. As I said, this was just code to get you started and should be &quot;modified as needed&quot;.  For example, I assumed all rows were of the same length. So, I altered  slightly so that it can handle rows of different lengths"}], "tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1570559603, "last_edit_date": 1570559603, "creation_date": 1570540667, "answer_id": 58287171, "question_id": 58286559, "link": "https://stackoverflow.com/questions/58286559/deleting-all-but-the-max-of-a-row-is-inconsistent/58287171#58287171", "title": "Deleting all but the max of a row is inconsistent", "body": "<p>I suggest trying code like this instead (modified as needed):</p>\n\n<pre><code>Option Explicit\nSub deleteMax()\nDim r As Range, cell As Range, sh As Worksheet\nSet sh = ActiveSheet\nSet r = sh.Range(\"E10\")\nWhile r(1) &lt;&gt; \"\"\n    Set r = sh.Range(r, r.End(xlToRight))\n    For Each cell In r\n        'cell.Select\n        If cell &lt;&gt; Application.WorksheetFunction.Max(r) Then cell.Font.Color = vbRed\n    Next cell\n    Set r = r(1).Offset(1, 0)\nWend\nEnd Sub\n</code></pre>\n\n<p>It worked for me for both integers and real numbers, as shown below in 2 examples I tried. I just colored them red, but of course, you would want to delete them using cell = \"\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/7EYky.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7EYky.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/gMSKu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gMSKu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If there is a set of data that doesn't work with this code, let me know.</p>\n"}], "owner": {"reputation": 3, "user_id": 12181309, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220138349790874/picture?type=large", "display_name": "Wanda Alarcon Ferraguto", "link": "https://stackoverflow.com/users/12181309/wanda-alarcon-ferraguto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58287171, "answer_count": 1, "score": 0, "last_activity_date": 1574748840, "creation_date": 1570538425, "last_edit_date": 1574748840, "question_id": 58286559, "link": "https://stackoverflow.com/questions/58286559/deleting-all-but-the-max-of-a-row-is-inconsistent", "title": "Deleting all but the max of a row is inconsistent", "body": "<p>I have been working on a code that deletes cells that do not contain the max of that given row.</p>\n\n<p>This code would be used in files with a similar layout, just different data.</p>\n\n<p>It worked the first time. However, when I try it in other files with the same conditions and different data, the code sometimes deletes entire rows, even if there is an evident max. The deleted rows are random across files.</p>\n\n<p>I tried a less complicated condition by setting the rule to bold the max instead of deleting. However, the problem repeats (it does not highlight the max of some rows. The same ones that were not deleted before). This leads me to believe that the problem is with either the max itself or something in the cells.</p>\n\n<pre><code>Sub deletenonmax()\nDim rng As Range, cell As Range\nDim max As Integer\n\nSet rng = Range(\"$E$10:\" &amp; Range(\"E10\").End(xlToRight).Address) '&lt;-- first of my rows\nDo While rng(1) &lt;&gt; \"\" '&lt;-- If excel does not detect a blank cell on the first position\n    max = Application.WorksheetFunction.max(rng) '&lt;-- This is how I get the max of current row\n    For Each cell In rng '&lt;-- loop through the cells of the row\n        If cell.Value &lt;&gt; max Then '&lt;-- if the value of the cell is not the max\n            cell.Value = \"\" '&lt;-- set it to empty\n        End If\n    Next cell\n    Set rng = Range(rng(1).Offset(1, 0).Address &amp; \":\" &amp; rng(1).Offset(1, 0).End(xlToRight).Address) '&lt;-- Go to the line below\n    rng.Select\nLoop\nEnd Sub\n</code></pre>\n\n<p>In some cases it deletes everything BUT the max values of the row.</p>\n\n<p>In some cases the entire row ends up empty.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1570537720, "post_id": 58286341, "comment_id": 102937457, "body": "look at having all sheets hidden, then on workbook opening event, using an <code>inputbox</code> as the simplest, then based on what&#39;s entered use an <code>IF</code> decision to unhide the sheet.  Have a go, then ask for help here :o)"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 2, "creation_date": 1570537943, "post_id": 58286341, "comment_id": 102937571, "body": "A better way might be to create a list with access restrictions for every user, and then have a workbook-open event with <code>Environ(&quot;username&quot;)</code> as argument, and have it hide and show sheets based on the login name of the current user."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 1, "creation_date": 1570540744, "post_id": 58286701, "comment_id": 102939084, "body": "So after testing and trying I understood the code (again, im completly new to VBA, only have experience with java and powershell), but the problem is that there are probably around 30 or 40 different users, so is there a beautiful solution for adding every user or do i really have to hardcode every single one?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 1, "creation_date": 1570541335, "post_id": 58286701, "comment_id": 102939426, "body": "There is a way of creating a table with users and restrictions and looping through that, but it would be a completely different approach, and possibly much slower. For now if there is several users with the same restrictions, condense them like so: <code>Case is = &quot;Plutian&quot;, &quot;Hoesl&quot;, &quot;Randomguy&quot;</code> etc."}, {"owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570542614, "post_id": 58286701, "comment_id": 102940226, "body": "Ok thanks a lot, i&#39;ll see if that&#39;s enough for my case"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570608374, "post_id": 58286701, "comment_id": 102962038, "body": "@Hoesl since I was interested in getting the other method working, I&#39;ve updated my answer with a working version of that as well."}, {"owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570612950, "post_id": 58286701, "comment_id": 102964468, "body": "Really appreciate your help, thanks a lot for your fast and comprehensive answer"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570614026, "post_id": 58286701, "comment_id": 102965094, "body": "No problem. I was interested in how it would work so I enjoyed the challenge."}, {"owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570778589, "post_id": 58286701, "comment_id": 103028825, "body": "So apparently the case I&#39;m trying to use this for, every User in the same network has the same profile (there are only user and admin, no personalized user accounts). I didn&#39;t do that and i don&#39;t have the access to change it. So my idea was to set some Strings as &quot;passwords&quot; for every sheet and depending on what password is entered in the textbox, different sheets get visible. Is that possible to do in VBA?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570779185, "post_id": 58286701, "comment_id": 103029086, "body": "@Hoesl, it certainly is possible. It&#39;ll be a small modification to the designs above, and I&#39;ll update my answer in a bit when I&#39;ve got it working and tested. In the meantime, can you try putting <code>debug.print Environ$(&quot;username&quot;)</code> and <code>debug.print application.Username</code> in the project and see what the window comes back with? If both are just &quot;User&quot; or &quot;Admin&quot; you&#39;ll indeed need to go another route. If not this answer can still be used."}, {"owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570800954, "post_id": 58286701, "comment_id": 103039897, "body": "So I&#39;m actually pretty far with the code, the last thing i need to know now is how I can move different sheets in the foreground. Any idea? - Edit: After a quick google search, I&#39;m fine~"}, {"owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570802566, "post_id": 58286701, "comment_id": 103040880, "body": "so after doing everything else that was needed, the &quot;1004&quot; Error persists. As far as i can tell, it comes when I&#39;m trying to close every worksheet before opening another one, because you cant hide every sheet. After changing the order of vbaobjects hoping that would fix it, it still throws me the error. I dont know what to do"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "edited": false, "score": 0, "creation_date": 1570802909, "post_id": 58286701, "comment_id": 103041097, "body": "There is a part in above code <code>Sheets(Sheets.Count).Visible = xlSheetVisible</code> which will unhide the last sheet. If called before hiding any other sheet, it will unhide the last sheet, and will remain unhidden until the code re-hides it. This prevents the 1004 error of hiding all sheets at once. If that is in and you still get the error, update your question with your current code and I&#39;ll take a look."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 1, "last_activity_date": 1570779877, "last_edit_date": 1570779877, "creation_date": 1570538987, "answer_id": 58286701, "question_id": 58286341, "link": "https://stackoverflow.com/questions/58286341/restricting-viewing-and-editing-access-to-a-single-worksheet/58286701#58286701", "title": "Restricting viewing and editing access to a single worksheet", "body": "<p>Since I felt like experimenting, this should help you well underway:</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim sh As Worksheet\nSheets(Sheets.Count).Visible = xlSheetVisible\nSelect Case Environ(\"Username\")\n    Case Is = \"Plutian\"\n        For Each sh In Worksheets\n            If sh.Name = \"Naughty Stuff\" Then\n                sh.Visible = xlSheetVisible\n            Else\n                sh.Visible = xlSheetHidden\n            End If\n        Next sh\n    Case Else\n        MsgBox \"Insufficient access, see Hoesl for more info\"\nEnd Select\nEnd Sub\n</code></pre>\n\n<p>Please note the line <code>Sheets(Sheets.Count).Visible = xlSheetVisible</code> is important in this case. If the sheet being unhidden is after the currently visible sheet, it might occur that this sub attempts to hide the last visible sheet (to unhide another sheet later on). This isn't possible and throws an error, therefore this line will unhide the last sheet in any case, so it'll always be active and be hidden last after all other actions are done. This prevents all sheets being hidden at one time.</p>\n\n<p><strong>EDIT</strong> I suggested another method below, by adding a list of users and access restrictions in a hidden sheet. Since I was interested to get that working, I explored that method as well:</p>\n\n<pre><code>Private Sub workbk_Open()\nDim user As Integer, sh As Worksheet\n\nSheets(Sheets.Count).Visible = xlSheetVisible 'unhide last sheet to prevent all sheets being hidden at once\n\nuser = Application.IfError(Application.Match(Environ(\"username\"), ThisWorkbook.Sheets(\"Sheet3\").Range(\"A2:A5\"), 0), \"0\") 'check if user is present in access list\n\nIf user &gt; 0 Then\n    For Each sh In Worksheets 'loop through sheets\n        If Application.IfError(Application.Match(sh.Name, ThisWorkbook.Sheets(\"Sheet3\").Range(Cells(user + 1, 2), Cells(user + 1, 4)), 0), \"0\") &gt; 0 Then 'check if sheet is in access list for user\n            sh.Visible = xlSheetVisible 'if true, set sheet to visible\n            Else\n            sh.Visible = xlSheetHidden 'if false, hide sheet\n        End If\n    Next sh\n    Else\n    Workbook.Protect 'If user not found, protect workbook to prevent altering\n    MsgBox \"user not found, see admin for access\" 'display error message\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The access list would look like so, where the values represent sheet names. In my code this would be located in sheet3, and only runs from row 2 to 5 for users and column B to D for sheets, but this can be expanded nearly infinitely.</p>\n\n<pre><code>A             B             C\nUsername:     Access:\nPlutian       Data sheet    Maintenance sheet\nHoesl         Sheet2        Maintenance sheet\nRandomguy     Randomsheet   Sheet3\netc...\n</code></pre>\n\n<p>I hope the comments explain sufficiently, if not, let me know.</p>\n\n<p><strong>EDIT EDIT</strong>\nTo update either of these answers with a prompt box with either a password (or by just having the users input their name or a unique key) you can use an input box like so:</p>\n\n<pre><code>Dim pw as string\npw = InputBox(\"Please enter your name\", \"Access Required\", \"\")\n</code></pre>\n\n<p>And have the code search for the password/input box input in either case:</p>\n\n<pre><code>Select Case pw\n</code></pre>\n\n<p>or</p>\n\n<pre><code>user = Application.IfError(Application.Match(pw, ThisWorkbook.Sheets(\"Sheet3\").Range(\"A2:A5\"), 0), \"0\")\n</code></pre>\n\n<p>Just make sure you keep the sheet where you store your passwords hidden at all time when going the second route. And think about how you want to handle wrong passwords.</p>\n"}], "owner": {"reputation": 15, "user_id": 12182266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523dbd90a19315d8c3a0e707c0fdc816?s=128&d=identicon&r=PG&f=1", "display_name": "Hoesl", "link": "https://stackoverflow.com/users/12182266/hoesl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 58286701, "answer_count": 1, "score": 0, "last_activity_date": 1582052032, "creation_date": 1570537532, "last_edit_date": 1582052032, "question_id": 58286341, "link": "https://stackoverflow.com/questions/58286341/restricting-viewing-and-editing-access-to-a-single-worksheet", "title": "Restricting viewing and editing access to a single worksheet", "body": "<p>I have an Excel document that is accessed by many people.</p>\n\n<p>The data is not private but people get confused because different people need to view different sheets in the workbook.</p>\n\n<p>I want that every sheet has a different password, so when you type in that password, it redirects you to a specific worksheet.</p>\n\n<p>I would give out the different passwords to the corresponding persons or something like that.</p>\n\n<p>I can't save these sheets as single documents because they use each other for calculations.</p>\n\n<pre><code>Private Sub Workbook_Open()\nPwevaluation\nEnd Sub\n\n\nPublic Function Pwevaluation()\nDim sh As Worksheet\nDim pw As String\n\npw = InputBox(\"Please enter your name\", \"Access Required\", \"\")\nSelect Case pw\n    Case Is = \"hoesl\"\n        For Each sh In Worksheets\n            If sh.Name = \"Hinweis\" Then\n                sh.Visible = xlSheetVisible\n            Else\n            If sh.Name = \"Blatt 1\" Then\n                sh.Visible = xlSheetVisible\n            Else\n                sh.Visible = xlSheetHidden\n            End If\n\n            End If\n        Next sh\n    Case Is = \"\"\n    Case Else\n        For Each sh In Worksheets\n            If sh.Name = \"Deckblatt\" Then\n                sh.Visible = xlSheetVisible\n            Else\n                sh.Visible = xlSheetHidden\n            End If\n        Next sh\n        pw = InputBox(\"Wrong name, please try again\", \"Access Required\", \"\")\n        Pwevaluation\nEnd Select\nEnd Function\n</code></pre>\n\n<p>When the sheets I'm trying to call are already hidden, I get</p>\n\n<blockquote>\n  <p>runtime error \"1004\"</p>\n</blockquote>\n\n<p>If they are not hidden, everything works.</p>\n"}, {"tags": ["sql", "excel", "vba", "odbc", "ado"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1570537291, "post_id": 58286206, "comment_id": 102937252, "body": "It might be useful to post the completed SQL statement that you are producing. I&#39;m guessing that simply specifying a column alias will fix this (<code>SELECT xyz AS ColumnAlias</code>)."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1570537589, "post_id": 58286206, "comment_id": 102937390, "body": "@Martin as you can see i am specifying aliases e.g. splitting <code>1st column as [GVal],</code> and <code>1st column as [Pos]</code>. Not Working!!! Let me see if i can edit the post to share the SQL Query."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1570540437, "post_id": 58286206, "comment_id": 102938919, "body": "Have you tried doing <code>Debug.Print strSql</code> right before the problem line, so you can verify the string value is as expected?"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1570540729, "post_id": 58286206, "comment_id": 102939076, "body": "@Mistella, did you just delete your earlier comment? That was the <code>ANSWER</code>! It is working now. :-) Can you post your answer again, so that i can accept it as the Solution? Thanks a bunch! ....(Learning from my mistakes)"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1570541138, "post_id": 58286206, "comment_id": 102939298, "body": "@sifar I&#39;ll repost my comment as an answer"}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1570541442, "post_id": 58287303, "comment_id": 102939492, "body": "the Recordset already gives the <code>NoName</code> name to columns with no Header. As for the Solution, which was given by Mistella, it is to use single-quotes, instead of double-quotes, for the &#39;.&#39; , &#39;G&#39; , and &#39;&#39; . Hope this helps."}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": false, "score": 0, "last_activity_date": 1570541097, "creation_date": 1570541097, "answer_id": 58287303, "question_id": 58286206, "link": "https://stackoverflow.com/questions/58286206/splitting-noname-column-in-sql-query/58287303#58287303", "title": "Splitting NoName column in SQL Query", "body": "<p>when i try to replicate your code i get the following:\na) Not sure if it is the problem but you have two columns names [NoName] so you need to distinguish between the two. (b) Could you to put the NoName columns in square brackets and try single quotes instead of double quotes?</p>\n\n<pre><code>SELECT \n    CLng(Replace(Left(NoName, InStr(NoName, \".\") - 1), \"G\", \"\")) AS [GVal],\n    CLng(Right(NoName, Len(NoName) - InStr(NoName, \".\"))) AS [Pos], [SomeAggr] AS [Aggr],\n    NoName, \n    [Div1] AS [DV A], \n    [Div2] AS [DV B], \n    [Div3] AS [DV C] \nFROM \n    `C:\\Temp`\\Test.csv\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1570541519, "post_id": 58287380, "comment_id": 102939536, "body": "Thanks @Mistella for pointing out what i was doing wrong...learning from my mistakes... :-)"}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 1, "last_activity_date": 1570541349, "creation_date": 1570541349, "answer_id": 58287380, "question_id": 58286206, "link": "https://stackoverflow.com/questions/58286206/splitting-noname-column-in-sql-query/58287380#58287380", "title": "Splitting NoName column in SQL Query", "body": "<p>SQL code expects single quotes as string deliminators instead of double quotes. In the <code>For Each Fld In oRs.Fields</code> loop, there are two lines which use double quotes instead of single quotes while constructing <code>strSql</code>:</p>\n\n<pre><code>strSql = strSql &amp; \"CLng(Replace(Left(\" &amp; Fld.Name &amp; \", InStr(\" &amp; Fld.Name &amp; \", \"\".\"\") - 1), \"\"G\"\", \"\"\"\"))\" &amp; \" AS [GVal], \"\nstrSql = strSql &amp; \"CLng(Right(\" &amp; Fld.Name &amp; \", Len(\" &amp; Fld.Name &amp; \") - InStr(\" &amp; Fld.Name &amp; \", \"\".\"\")))\" &amp; \" AS [Pos], \"\n</code></pre>\n\n<p>These should be changed to:</p>\n\n<pre><code>strSql = strSql &amp; \"CLng(Replace(Left(\" &amp; Fld.Name &amp; \", InStr(\" &amp; Fld.Name &amp; \", '.') - 1), 'G', ''))\" &amp; \" AS [GVal], \"\nstrSql = strSql &amp; \"CLng(Right(\" &amp; Fld.Name &amp; \", Len(\" &amp; Fld.Name &amp; \") - InStr(\" &amp; Fld.Name &amp; \", '.')))\" &amp; \" AS [Pos], \"\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 58287380, "answer_count": 2, "score": 0, "last_activity_date": 1581781800, "creation_date": 1570537053, "last_edit_date": 1581781800, "question_id": 58286206, "link": "https://stackoverflow.com/questions/58286206/splitting-noname-column-in-sql-query", "title": "Splitting NoName column in SQL Query", "body": "<p>I want to use a CSV file <strong>Test1.csv</strong> to create a Recordset with customized column names.</p>\n\n<p>The CSV file format:</p>\n\n<pre>\n    (Blank)  |  SomeAggr |   (Blank) |   Div1  |  Div2  |  Div3\n    -----------------------------------------------------------\n    G0.1     |  1.23     |           |   ABC   |  DEF   |  GHI\n    G0.2     |  2.45     |           |   JKL   |  MNO   |  PQR\n    G0.3     |  9.02     |           |   STU   |  VWX   |  YZA\n    G1.1     |  3.32     |           |   ZYX   |  WVU   |  TSR\n    G1.2     |  5.53     |           |   QPO   |  NML   |  KJI\n    G1.3     |  1.15     |           |   HGF   |  EDC   |  BAZ\n    G1.4     |  4.65     |           |   FKJ   |  OTU   |  WKL\n</pre>\n\n<p>The 1st &amp; 3rd Columns have blank headers. The 1st column contains data I want to split it into two columns as shown in SQL Query. </p>\n\n<p>Note - I am creating a recordset and do not want to do any transformations using a WorkSheet.</p>\n\n<p>The final Recordset via SQL Query should look like this:</p>\n\n<pre>\n    GVal  |   Pos    |  Aggr     |   (Blank) |   DV A  |  DV B  |  DV C\n    --------------------------------------------------------------------\n    0     |    1     |  1.23     |           |   ABC   |  DEF   |  GHI\n    0     |    2     |  2.45     |           |   JKL   |  MNO   |  PQR\n    0     |    3     |  9.02     |           |   STU   |  VWX   |  YZA\n    1     |    1     |  3.32     |           |   ZYX   |  WVU   |  TSR\n    1     |    2     |  5.53     |           |   QPO   |  NML   |  KJI\n    1     |    3     |  1.15     |           |   HGF   |  EDC   |  BAZ\n    1     |    4     |  4.65     |           |   FKJ   |  OTU   |  WKL\n</pre>\n\n<p>I am running the following code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Testing()\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    Dim strDataSource$, strF1$, strFF1$, strSql$, oCon as Object, oRs as Object, i%, Fld\n    strFF1 = \"Test1.csv\"\n    strF1 = \"`C:\\Users\\adam\\Downloads\\Test Folder`\\\"\n    strDataSource = Thisworkbook.Path\n\n    Set oCon = CreateObject(\"ADODB.Connection\")\n    Set oRs = CreateObject(\"ADODB.Recordset\")\n\n    strCon = \"Driver=Microsoft Access Text Driver (*.txt, *.csv);Dbq=\" &amp; strDataSource &amp; \";Extensions=asc,csv,tab,txt;HDR=Yes;\"\n\n   'Getting Top 1 row to loop through fields and create SQL string accordingly.\n    strSql = \"SELECT TOP 1 * FROM \" &amp; strF1 &amp; strFF1\n    oCon.Open strCon\n    Set oRs = oCon.Execute(strSql)\n\n    i = 1\n    strSql = \"SELECT \"    \n    For Each Fld In oRs.Fields\n\n        Select Case True\n            Case Is = Fld.Name = \"NoName\"    '1st NoName column\n                If Fld.Value &lt;&gt; vbNullString Then\n                    strSql = strSql &amp; \"CLng(Replace(Left(\" &amp; Fld.Name &amp; \", InStr(\" &amp; Fld.Name &amp; \", \"\".\"\") - 1), \"\"G\"\", \"\"\"\"))\" &amp; \" AS [GVal], \"\n                    strSql = strSql &amp; \"CLng(Right(\" &amp; Fld.Name &amp; \", Len(\" &amp; Fld.Name &amp; \") - InStr(\" &amp; Fld.Name &amp; \", \"\".\"\")))\" &amp; \" AS [Pos], \"\n                Else\n                    strSql = strSql &amp; Fld.Name &amp; \", \"  '2nd NoName column\n                End If\n            Case Is = Fld.Name = \"SomeAggr\"\n                strSql = strSql &amp; \"[\" &amp; Fld.Name &amp; \"] AS [Aggr],\"\n            Case Is = InStr(1, Fld.Name, \"Div\") &gt; 0\n                strSql = strSql &amp; \"[\" &amp; Fld.Name &amp; \"] AS [DV \" &amp; Chr(i + 64) &amp; \"], \"\n                i = i + 1\n        End Select\n    Next Fld\n\n    If Right(Trim(strSql), 1) = \",\" Then strSql = Left(Trim(strSql), Len(Trim(strSql)) - 1)\n    strSql = strSql &amp; \" FROM \" &amp; strF1 &amp; strFF1\n\n    oRs.Close\n\n' &gt;&gt;&gt; getting error on below `Set oRs` line\n  [Microsoft][ODBC Text Driver] '' is not a valid name. Make sure that it does not include invalid characters or punctuation and that it is not too long.\n\n    Set oRs = oCon.Execute(strSql)\nStop\n\nExitSub:\n    oRs.Close\n    oCon.Close\n    Set oRs = Nothing\n    Set oCon = Nothing\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\nExit Sub\nErrorHandler:\n    MsgBox \"Error No: \" &amp; Err.Number &amp; vbCrLf &amp; \"Description: \" &amp; Err.Description, vbCritical + vbOKOnly, \"An Error occurred!\"\n    Err.Clear\n    On Error GoTo 0\n    Resume ExitSub\n\nEnd Sub\n</code></pre>\n\n<p>Here is the SQL Query.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT CLng(Replace(Left(NoName, InStr(NoName,\".\")-1), \"G\", \"\")) AS [GVal], \nCLng(Right(NoName, Len(NoName) - InStr(NoName,\".\"))) AS [Pos], \n[SomeAggr] AS [Aggr],\n[Div1] AS [DV A], \n[Div2] AS [DV B], \n[Div3] AS [DV C] \nFROM `\\C:\\Users\\Adam\\Downloads\\Test Folder`\\Test1.csv\n</code></pre>\n\n<p>The code gives me the following error:</p>\n\n<blockquote>\n  <p>[Microsoft][ODBC Text Driver] '' is not a valid name. Make sure that it does not include invalid characters or punctuation and that it is not too long.</p>\n</blockquote>\n\n<p>I don't know how to get a reference or select the 1st Blank Column to split it's values into two columns.</p>\n\n<p>The Query works in MSAccess and the <strong>1st NoName column</strong> is shown as <strong>Field1</strong> and <strong>2nd NoName column</strong> is shown as <strong>Field3</strong>.</p>\n"}, {"tags": ["excel", "vba", "data-modeling", "excel-tables"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572278837, "post_id": 58285739, "comment_id": 103501760, "body": "Allow me the question if you could try my solution to create a data base for a Pivot table - Feel free to mark my approach as correct if it was helpful. Acceptance is indicated by a <i>green colored checkmark</i> next to the answer - cf. <a href=\"https://stackoverflow.com/help/someone-answers\">Someone answers</a>.  And take the (tour)[<a href=\"https://stackoverflow.com/tour]\">stackoverflow.com/tour]</a>. Marking the answer will help other developers to not go into this question because it is resolved and to focus on other questions. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1570734533, "creation_date": 1570734533, "answer_id": 58329625, "question_id": 58285739, "link": "https://stackoverflow.com/questions/58285739/excel-how-to-transform-a-table-to-be-used-for-pivot-use-the-column-headers-in-a/58329625#58329625", "title": "Excel how to transform a table to be used for pivot: use the column headers in a field", "body": "<p><strong>Array Transformation via <code>Application.Index()</code></strong></p>\n\n<p>This approach assigns the table values to an array first and eventually transforms the same array to the wanted structure using the extended features of the <code>Application.Index()</code> function thus maintaining the product names. </p>\n\n<p>I don't pretend this to be the most efficient way, but it clearly demonstrates the possibilities of the cited function - c.f. <a href=\"https://stackoverflow.com/questions/51688593/excel-vba-insert-new-first-column-in-datafield-array-without-loops-or-api-call/51714153#51714153\">Some pecularaties of the Application.Index function</a></p>\n\n<p>Further note: I assume that all month data are included, i.e. even empty values. </p>\n\n<pre><code>Sub Table2PivotBase()\n' Purpose: Transform Table to Pivot base\n' Method:  reorganize Datafield array of table using advanced features of Application.Index in [2]d)\n' Note:    sheet references use the worksheet's CodeName property here\n'~~~~~~~~~~~~ [0] Reference to table (address) ~~~~~~\nConst MONTHSCOUNT&amp; = 12, COLUMNOFFSET&amp; = 1    ' number of months, column offset January = 1 (i.e. 2nd col)\nWith Sheet1\n'a) Refer to table using the sheet's CodeName\n    Dim rpt As ListObject\n    Set rpt = .ListObjects(\"Table1\")\nSheet1.CodeName\n' ~~~~~~~~~~~ [1] Get Data ~~~~~~~~~~~~~~~~~~~~~~~~\n'b) Assign table values in Sheet1 to 2-dim 1-based array\n    Dim arr As Variant, yr&amp;\n    arr = .Range(rpt.Range.Address).Value2\n'c) Extract current year from 1st month column in header (1+ coloffset 1 =&gt; 2nd column)\n    yr = Val(Split(arr(1, 1 + COLUMNOFFSET) &amp; \"-\", \"-\")(1))\nEnd With\n\n'~~~~~~~~~~~~~~ [2] Reorganize Data ~~~~~~~~~~~~~~~\n'd) Redimension array preserving 1st column\n    Dim arr2, ItemsCount&amp;\n    ItemsCount = UBound(arr) - IIf(rpt.ShowTotals, 1, 0)    ' exclude table totals from items count\n    arr2 = Application.Index(arr, Application.Transpose(getRowsArr(ItemsCount, MONTHSCOUNT)), Array(1, 1, 1, 2))\n\n'e) Redefine headers in 1st row\n    Dim no&amp;, headers\n    headers = Array(\"Product\", \"Year\", \"Month\", \"Data\")\n    For no = 1 To 4\n        arr2(1, no) = headers(no - 1)               ' headers are zerobased\n    Next no\n'f) Enter year, month &amp; month data in a loop\n    Const START&amp; = 2\n    Dim i&amp;, mon&amp;, ii&amp;\n    ii = START - 1\n    For i = START To UBound(arr2)\n            mon = (i - START) Mod MONTHSCOUNT + 1   ' 0 to 11 (omitting 1 caption row) + 1\n            If mon = 1 Then ii = ii + 1             ' increment data row of arr1 in January\n\n           'arr2(i, 1) has already been prefilled by section [2]d)\n            arr2(i, 2) = yr\n            arr2(i, 3) = Application.Text(DateSerial(yr, mon, 1), \"mmm\")\n            arr2(i, 4) = arr(ii, mon + COLUMNOFFSET)\n    Next i\n\n\n'~~~~~~~~~~~~ ~[3] Write back pivot base to any sheet (via CodeName) ~~~~~~~~~~~\nWith Sheet2\n    .Range(\"A:D\") = vbNullString\n    .Range(\"A1\").Resize(UBound(arr2), UBound(arr2, 2)) = arr2\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong>Helper function <code>getRowsArr()</code></strong></p>\n\n<pre><code>\nFunction getRowsArr(ByVal ItemsCount, Optional ByVal n&amp; = 12) As Variant()\n' Purpose: return 1-dim 0-based array containing n row numbers per item + title row no 1\n' Note:    allows restructuring the original array to contain all months data\n    Const START&amp; = 2                        ' data rang starts in 2nd row\n    Dim tmp(), i&amp;, ii&amp;\n    ReDim tmp(0 To (ItemsCount - 1) * n)    ' includes header row number 1 at tmp(0) - zerobound!\n'1) fill temporary array\n    tmp(0) = 1                              ' title row no equals 1\n    For i = START To ItemsCount             ' row no 2 to ...\n        For ii = 0 To n - 1                 ' repeat row number n times\n            tmp((i - START) * n + ii + 1) = i\n        Next ii\n    Next i\n'2) return Array(1,2,2,2,2,2,2,2,2,2,2,2,2,3,........3,4...,...) as function value\n    getRowsArr = tmp\n    'Debug.Print Left$(Join(tmp, \",\"), 65) &amp; \"...\"\nEnd Function\n\n\n\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8053051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c8c76510f96a632421fe3b2533cd4db?s=128&d=identicon&r=PG&f=1", "display_name": "Donats", "link": "https://stackoverflow.com/users/8053051/donats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570734533, "creation_date": 1570535210, "last_edit_date": 1570536238, "question_id": 58285739, "link": "https://stackoverflow.com/questions/58285739/excel-how-to-transform-a-table-to-be-used-for-pivot-use-the-column-headers-in-a", "title": "Excel how to transform a table to be used for pivot: use the column headers in a field", "body": "<p>I have a table in Excel that is filled as below </p>\n\n<pre><code>PROD         JAN-19     FEB-19    ...     ...\n\nproduct1      123        098      ...     ...\nproduct2      314        467      ...     ...\n</code></pre>\n\n<p>I would need to use the data in a pivot table so I suppose I should transform the datamodel in the following way using the MMM-YY header as data in the Year and Month field.</p>\n\n<pre><code> PROD          Year    Month     Data\n\n Product1       19      JAN       123\n Product1       19      FEB       098\n ...           ...      ...       ...\n</code></pre>\n\n<p>Below a screen of the actual table and what I would like to achieve:\n<a href=\"https://i.stack.imgur.com/GOtlb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GOtlb.png\" alt=\"screen\"></a></p>\n\n<p>Is there a practical way to do so either working on the Datamodel in which the table is uploaded or as last option VBA?.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1570535472, "post_id": 58285608, "comment_id": 102936397, "body": "When you call <code>.Style = objWrdDoc.Styles(&quot;S3&quot;)</code>, you&#39;re applying it to the whole selection including the first text that was entered."}, {"owner": {"reputation": 440, "user_id": 2665385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea775b318f987fca97e9ee58216a47db?s=128&d=identicon&r=PG", "display_name": "aspire89", "link": "https://stackoverflow.com/users/2665385/aspire89"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1570535682, "post_id": 58285608, "comment_id": 102936501, "body": "@jsheeran How to avoid this?"}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 2665385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea775b318f987fca97e9ee58216a47db?s=128&d=identicon&r=PG", "display_name": "aspire89", "link": "https://stackoverflow.com/users/2665385/aspire89"}, "edited": false, "score": 0, "creation_date": 1570539455, "post_id": 58286269, "comment_id": 102938405, "body": "The script is executed, but all the text is not bold."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 440, "user_id": 2665385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea775b318f987fca97e9ee58216a47db?s=128&d=identicon&r=PG", "display_name": "aspire89", "link": "https://stackoverflow.com/users/2665385/aspire89"}, "edited": false, "score": 0, "creation_date": 1570539630, "post_id": 58286269, "comment_id": 102938487, "body": "<i>All</i> the text should not be bold, only the first part @aspire89."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 440, "user_id": 2665385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea775b318f987fca97e9ee58216a47db?s=128&d=identicon&r=PG", "display_name": "aspire89", "link": "https://stackoverflow.com/users/2665385/aspire89"}, "edited": false, "score": 0, "creation_date": 1570544578, "post_id": 58286269, "comment_id": 102941351, "body": "@aspire89 Are you going to follow up on this?"}, {"owner": {"reputation": 440, "user_id": 2665385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea775b318f987fca97e9ee58216a47db?s=128&d=identicon&r=PG", "display_name": "aspire89", "link": "https://stackoverflow.com/users/2665385/aspire89"}, "edited": false, "score": 0, "creation_date": 1570594381, "post_id": 58286269, "comment_id": 102956957, "body": "I use Microsoft Word 2013 (15.0.5163.1000) MSO (15.0.5172.1000) !<a href=\"https://habrastorage.org/webt/ua/gs/0-/uags0-dca_fztvjibabgbpf_yhq.png\" rel=\"nofollow noreferrer\">screenshot</a>"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1570537304, "creation_date": 1570537304, "answer_id": 58286269, "question_id": 58285608, "link": "https://stackoverflow.com/questions/58285608/text-with-different-styles-in-one-paragraph-word-vba/58286269#58286269", "title": "Text with different styles in one paragraph Word VBA", "body": "<p>While working with the <code>Selection</code> object feels \"intuitive\", it's not as accurate for writing code to manipulate Word as using <code>Range</code> objects. You can think about a <code>Range</code> as being an invisible selection, with the important differences that</p>\n\n<ul>\n<li>code can work with multiple <code>Range</code> objects</li>\n<li>the user can't affect where a <code>Range</code> is (clicking on the screen or pressing arrow keys changes a <code>Selection</code>)</li>\n<li>tracking where a <code>Range</code> is at any given point in the code is reliable</li>\n</ul>\n\n<p>Changing the code in the question to work with a \"target\" <code>Range</code> could look as follows.</p>\n\n<p>(Note that I've also added <code>Style</code> objects for the styles being defined. It's much more reliable and a lot less typing to work with objects, rather than constructs such as <code>objWrdDoc.Styles(\"S3\")</code>.)</p>\n\n<pre><code>   Dim S2 as Word.Style, S3 as Word.Style 'As Object if using late-binding\n   With objWrdDoc\n        Set S2 = .Styles.Add(\"S2\")\n        Set S3 = .Styles.Add(\"S3\")\n        S2.Font.Bold = True\n        S3.Font.Bold = False\n    End With\n\n    Dim objRange as Word.Range 'As Object if using late-binding\n    Set objRange = objWrdApp.Selection.Range\n\n    With objRange\n        .Text = vbCr 'Chr(13) = paragraph mark\n        'The new text should follow the inserted paragraph mark\n        'Like pressing right-arrow to \"collapse\" a selection\n        .Collapse wdCollapseEnd\n\n        'When working with ranges, apply the formatting after writing the text\n        .Text = \"I want to have bold \"\n        .Style = S2\n\n        .Collapse wdCollapseEnd\n        .Text = \"and not bold text in one line.\"\n        .Style = S3\n    End With\n</code></pre>\n"}], "owner": {"reputation": 440, "user_id": 2665385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea775b318f987fca97e9ee58216a47db?s=128&d=identicon&r=PG", "display_name": "aspire89", "link": "https://stackoverflow.com/users/2665385/aspire89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570540478, "creation_date": 1570534659, "last_edit_date": 1570540478, "question_id": 58285608, "link": "https://stackoverflow.com/questions/58285608/text-with-different-styles-in-one-paragraph-word-vba", "title": "Text with different styles in one paragraph Word VBA", "body": "<p><b>I want to have bold</b> and not bold text in one line.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    With objWrdDoc\n        .Styles.Add (\"S2\")\n        .Styles.Add (\"S3\")\n        .Styles(\"S2\").Font.Bold = True\n        .Styles(\"S3\").Font.Bold = False\n    End With\n    With objWrdApp.Selection\n        .TypeParagraph\n        .Style = objWrdDoc.Styles(\"S2\")\n        .TypeText Text:=\"I want to have bold \"\n        .Style = objWrdDoc.Styles(\"S3\")\n        .TypeText Text:=\"and not bold text in one line.\"\n    End With\n</code></pre>\n\n<p>As a result, the entire text is not bold.</p>\n"}, {"tags": ["angular", "vba", "typescript", "powerpoint", "office-addins"], "comments": [{"owner": {"reputation": 310, "user_id": 11285395, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sAIv0qHKZA8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcn9YEjvFqYzz-5U5-wuuQqjOdl2g/mo/photo.jpg?sz=128", "display_name": "Altair312", "link": "https://stackoverflow.com/users/11285395/altair312"}, "edited": false, "score": 2, "creation_date": 1570534270, "post_id": 58285499, "comment_id": 102935888, "body": "Show the code, or some other attempts at what you&#39;ve tried to accomplish. Without that, we have no idea what exactly do you want."}, {"owner": {"reputation": 721, "user_id": 8409133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uOCYE.jpg?s=128&g=1", "display_name": "Iftifar Taz", "link": "https://stackoverflow.com/users/8409133/iftifar-taz"}, "edited": false, "score": 0, "creation_date": 1570534277, "post_id": 58285499, "comment_id": 102935892, "body": "Can you share  your code and where you are having issue in the code? you can make a minimum working <a href=\"https://stackblitz.com\" rel=\"nofollow noreferrer\">demo</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 12111810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1671483946d503dc27f9704aadf6b80?s=128&d=identicon&r=PG&f=1", "display_name": "Triable", "link": "https://stackoverflow.com/users/12111810/triable"}, "is_accepted": true, "score": 0, "last_activity_date": 1570608424, "creation_date": 1570608424, "answer_id": 58299661, "question_id": 58285499, "link": "https://stackoverflow.com/questions/58285499/how-to-add-an-image-to-a-slide/58299661#58299661", "title": "How to add an image to a slide", "body": "<p>I found an answer after some hardcore searching. I had to use a base64 string and add it in to the PowerPoint like this:</p>\n\n<pre><code>async addImage(imgHTML) {\n    console.log('addImage')\n\n    Office.context.document.setSelectedDataAsync('addBase64StringHere', \n      { \n        coercionType: Office.CoercionType.Image, \n      },\n      result =&gt; {\n        if (result.status === Office.AsyncResultStatus.Failed) {\n          console.error(result.error.message);\n        }\n      }\n    );\n\n  }\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 12111810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1671483946d503dc27f9704aadf6b80?s=128&d=identicon&r=PG&f=1", "display_name": "Triable", "link": "https://stackoverflow.com/users/12111810/triable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 58299661, "answer_count": 1, "score": 1, "last_activity_date": 1608327070, "creation_date": 1570534146, "last_edit_date": 1608327070, "question_id": 58285499, "link": "https://stackoverflow.com/questions/58285499/how-to-add-an-image-to-a-slide", "title": "How to add an image to a slide", "body": "<p>I'm working on a PowerPoint add-in. I want to add an image to a slide.</p>\n<p>I'm using the <strong>Angular</strong> framework with <strong>Typescript</strong> for the add-in and generated the add-in using the Yeoman Office generator.</p>\n<p>This is the function I call when a button is clicked.</p>\n<pre><code>async addImage() {\n    console.log('addImage')\n    \n    Office.context.document.setSelectedDataAsync(&quot;addImage&quot;,\n      {\n        coercionType: Office.CoercionType.Text,\n      },\n      result =&gt; {\n        if (result.status === Office.AsyncResultStatus.Failed) {\n          console.error(result.error.message);\n        }\n      }\n    );\n\n  }\n</code></pre>\n<p>It adds text. I want to replace this so it can add an image instead.</p>\n"}, {"tags": ["vba", "directory", "ms-word", "mailmerge"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570536192, "post_id": 58284282, "comment_id": 102936716, "body": "Could you please use the <a href=\"https://stackoverflow.com/posts/58284282/edit\">edit</a> link below the question to add a link to the tutorial?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570536419, "post_id": 58284282, "comment_id": 102936820, "body": "I&#39;m not familiar with this tutorial/code, but if <code>Set doc2 = ActiveDocument</code> is not picking up a <code>Document</code> object, that would be one explanation for the error. For example, if mail merge is not executing (or doesn&#39;t finish execution). 1) Comment out the line that turns off screen updating. 2) Use F8 to &quot;step&quot; through the code, line-by-line. When you see the yellow highlight jump from <code>Execute</code> to <code>Set doc2 = ActiveDocument</code> switch to the Word document(s) and see if there&#39;s a mail merge result <i>and</i> a main merge document..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570536494, "post_id": 58284282, "comment_id": 102936858, "body": "... When you go back to the VBA Editor, make sure the merge result is the active document. Continue pressing F8 and watch to go through the line you report as having the error. Does the error still occur?"}, {"owner": {"reputation": 11, "user_id": 12181565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4148fc56adf009bb904e1ecdc385b31e?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/12181565/laszlo"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570537835, "post_id": 58284282, "comment_id": 102937511, "body": "@CindyMeister I&#39;m out of the office where I have the files saved, but I will try it tomorrow!"}, {"owner": {"reputation": 11, "user_id": 12181565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4148fc56adf009bb904e1ecdc385b31e?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/12181565/laszlo"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570609749, "post_id": 58284282, "comment_id": 102962721, "body": "Hi, I thought I wasn&#39;t allowed to use external tools for word in the office, but it&#39;s allowed. So I&#39;ve downloaded the tool from doug robbins and now everything is going smooth. Thanks for helping anyway!"}], "owner": {"reputation": 11, "user_id": 12181565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4148fc56adf009bb904e1ecdc385b31e?s=128&d=identicon&r=PG&f=1", "display_name": "Laszlo", "link": "https://stackoverflow.com/users/12181565/laszlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570537642, "creation_date": 1570529375, "last_edit_date": 1570537642, "question_id": 58284282, "link": "https://stackoverflow.com/questions/58284282/run-time-error-91-object-variable-or-with-block-variable-not-set-catalogue-ma", "title": "Run Time Error &#39;91&#39;: Object variable or With block variable not set Catalogue Mailmerge", "body": "<p>I'm trying out the tutorial from macropod for using a directory for a mailmerge, but I keep getting an error which I don't understand. </p>\n\n<p>I've gotten to the last step in the tutorial and I wanted to try out the actual e-mail merge. I created a macro with  the code below in the Catalog/Directory mailmerge main document and saved the document in the same folder as the 'Email Merge Main Document'. But now when I run the macro <code>RunMerge</code> I get the error </p>\n\n<blockquote>\n  <p>Run Time Error '91': Object variable or With block variable not set</p>\n</blockquote>\n\n<p>When I click on debug it highlights the first <code>.Paragraphs(1).Range.Delete</code> in <code>Sub EmailMergeTableMaker(DocName As Document)</code>. This is the first time I've had to do anything with VBA and I have no idea how to solve this. </p>\n\n<p>What does the error mean? I'm guessing the line references a variable which isn't set right, but I just copied the code from the tutorial and I don't know which variable is being referenced.</p>\n\n<p>Edit: this is the link to the tutorial <a href=\"http://www.gmayor.com/Zips/Catalogue%20Mailmerge.zip\" rel=\"nofollow noreferrer\">http://www.gmayor.com/Zips/Catalogue%20Mailmerge.zip</a></p>\n\n<pre><code>Sub RunMerge()\nApplication.ScreenUpdating = False\nDim Doc1 As Document, Doc2 As Document, Doc3 As Document, StrDoc As String\nSet Doc1 = ThisDocument\nStrDoc = ThisDocument.Path &amp; \"\\EmailDataSource.doc\"\nIf Dir(StrDoc) &lt;&gt; \"\" Then Kill StrDoc\nWith Doc1.MailMerge\n  If .State = wdMainAndDataSource Then\n    .Destination = wdSendToNewDocument\n    .Execute\n    Set Doc2 = ActiveDocument\n  End If\nEnd With\nCall EmailMergeTableMaker(Doc2)\nWith Doc2\n  .SaveAs FileName:=StrDoc, AddToRecentFiles:=False, FileFormat:=wdFormatDocument\n  StrDoc = .FullName\n  .Close\nEnd With\nSet Doc2 = Nothing\nSet Doc3 = Documents.Open(FileName:=Doc1.Path &amp; \"\\Email Merge Main Document.doc\", _\n  AddToRecentFiles:=False)\nWith Doc3.MailMerge\n  .MainDocumentType = wdEMail\n  .OpenDataSource Name:=StrDoc, ConfirmConversions:=False, ReadOnly:=False, _\n    LinkToSource:=True, AddToRecentFiles:=False, Connection:=\"\", SQLStatement:=\"\", _\n    SQLStatement1:=\"\", SubType:=wdMergeSubTypeOther\n  If .State = wdMainAndDataSource Then\n    '.Destination = wdSendToNewDocument\n    .Destination = wdSendToEmail\n    .MailAddressFieldName = \"Recipient\"\n    .MailSubject = \"Monthly Sales Stats\"\n    .MailFormat = wdMailFormatPlainText\n    .Execute\n  End If\nEnd With\nDoc3.Close SaveChanges:=False\nSet Doc3 = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n\n\nSub EmailMergeTableMaker(DocName As Document)\nDim oTbl As Table, i As Integer, j As Integer, oRow As Row, oRng As Range, strTxt As String\nWith DocName\n  .Paragraphs(1).Range.Delete    &lt;---- this line\n  Call TableJoiner\n  For Each oTbl In .Tables\n  j = 2\n    With oTbl\n      i = .Columns.Count - j\n      For Each oRow In .Rows\n        Set oRng = oRow.Cells(j).Range\n        With oRng\n          .MoveEnd Unit:=wdCell, Count:=i\n          .Cells.Merge\n          strTxt = Replace(.Text, vbCr, vbTab)\n          On Error Resume Next\n          If Len(strTxt) &gt; 1 Then .Text = Left(strTxt, Len(strTxt) - 2)\n        End With\n      Next\n    End With\n  Next\n  For Each oTbl In .Tables\n    For i = 1 to j\n      oTbl.Columns(i).Cells.Merge\n    Next\n  Next\n  With .Tables(1)\n    .Rows.Add BeforeRow:=.Rows(1)\n    .Cell(1, 1).Range.Text = \"Recipient\"\n    .Cell(1, 2).Range.Text = \"Data\"\n  End With\n  .Paragraphs(1).Range.Delete\n  Call TableJoiner\nEnd With\nSet oRng = Nothing\nEnd Sub\n\n\nPrivate Sub TableJoiner()\nDim oTbl As Table\nFor Each oTbl In ActiveDocument.Tables\n  With oTbl.Range.Next\n    If .Information(wdWithInTable) = False Then .Delete\n  End With\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1570529086, "post_id": 58284186, "comment_id": 102933507, "body": "<code>I wrote the below macro</code> - what language is that?"}, {"owner": {"reputation": 33, "user_id": 12181181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd18230fbe04cb5fcfbd7018de55a43?s=128&d=identicon&r=PG&f=1", "display_name": "DevLearner", "link": "https://stackoverflow.com/users/12181181/devlearner"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1570529585, "post_id": 58284186, "comment_id": 102933721, "body": "macro as in VBA for excel"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1570529725, "post_id": 58284186, "comment_id": 102933779, "body": "How is VBA and excel related to embedded?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1570529801, "post_id": 58284186, "comment_id": 102933815, "body": "Edited your tags."}, {"owner": {"reputation": 33, "user_id": 12181181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd18230fbe04cb5fcfbd7018de55a43?s=128&d=identicon&r=PG&f=1", "display_name": "DevLearner", "link": "https://stackoverflow.com/users/12181181/devlearner"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1570530260, "post_id": 58284186, "comment_id": 102934053, "body": "@KamilCuk. Thats a long story. needed for testing purpose"}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1570552210, "post_id": 58284485, "comment_id": 102945259, "body": "shouldn&#39;t it be <code>For i = Cells(1,&quot;A&quot;).Value2 To 1 Step -1</code>?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1570552341, "post_id": 58284485, "comment_id": 102945327, "body": "BTW <code>ReDim Preserve arr(i)</code> can be simply <code>ReDim arr(i)</code>"}, {"owner": {"reputation": 33, "user_id": 12181181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd18230fbe04cb5fcfbd7018de55a43?s=128&d=identicon&r=PG&f=1", "display_name": "DevLearner", "link": "https://stackoverflow.com/users/12181181/devlearner"}, "edited": false, "score": 0, "creation_date": 1570596494, "post_id": 58284485, "comment_id": 102957350, "body": "When I run the macro it throws the runtime error &#39;9&#39;"}, {"owner": {"reputation": 33, "user_id": 12181181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd18230fbe04cb5fcfbd7018de55a43?s=128&d=identicon&r=PG&f=1", "display_name": "DevLearner", "link": "https://stackoverflow.com/users/12181181/devlearner"}, "edited": false, "score": 1, "creation_date": 1570607262, "post_id": 58284485, "comment_id": 102961480, "body": "I made the change ReDim Preserve arr(40). It works like charm now"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1570530522, "last_edit_date": 1570530522, "creation_date": 1570530190, "answer_id": 58284485, "question_id": 58284186, "link": "https://stackoverflow.com/questions/58284186/how-can-i-convert-an-array-assigment-in-for-loop-from-c-to-macro/58284485#58284485", "title": "How can I convert an array assigment in for loop from C to macro?", "body": "<p>You're referencing <code>Cells</code> and <code>Value</code> round the wrong way</p>\n\n<pre><code>Sub forloop()\n    Dim arr() As Long\n    Dim i As Integer, x As Integer\n    ReDim Preserve arr(i)\n\n    arr(0) = Cells(2,\"B\").Value2\n\n    For i = Cells(1,\"A\").Value2 To 2 Step -1\n        arr(i) = arr(i-1)\n    Next \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12181181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bd18230fbe04cb5fcfbd7018de55a43?s=128&d=identicon&r=PG&f=1", "display_name": "DevLearner", "link": "https://stackoverflow.com/users/12181181/devlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570530522, "creation_date": 1570528998, "last_edit_date": 1570529774, "question_id": 58284186, "link": "https://stackoverflow.com/questions/58284186/how-can-i-convert-an-array-assigment-in-for-loop-from-c-to-macro", "title": "How can I convert an array assigment in for loop from C to macro?", "body": "<p>What will be the macro for the below mentioned code in c?</p>\n\n<p>Code:</p>\n\n<pre><code>max  = 0.04/x;\narr[0] = y;\nfor(i = max; i &gt; 0; i-- )\n {\n  arr[i] = arr[i-1]; \n  printf(arr[i],%d);\n }\n</code></pre>\n\n<p>I wrote the below mentioned macro but its throwing me run time error: '9'</p>\n\n<pre><code>Sub forloop()\n\n Dim arr() As Long\n Dim i As Integer, x As Integer\n ReDim Preserve arr(i)\n\n arr(0) = Cell.Value(2,B)\n For i = Cell.value(1,A) To 2 Step -1\n   arr(i) = arr(i-1)\n\n Next \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1570527831, "post_id": 58283811, "comment_id": 102932900, "body": "Modify <code>Destination:=sh2.Range(&quot;C&quot; &amp; x)</code> to <code>sh2.Rows(x)</code>, he asked for whole row (additional data) :)"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1570528030, "post_id": 58283811, "comment_id": 102933007, "body": "Both approaches work. You could copy the entire row and paste it into the first column or just copy the subset of data that i dfferent beginning in the third column and paste it into the third column. But you cannot paste the entire row to column <code>C</code> since it will not fit."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1570528286, "post_id": 58283811, "comment_id": 102933114, "body": "In case <code>sh1.Range(&quot;A&quot; &amp; x).EntireRow.Copy sh2.Range(&quot;C&quot; &amp; x)</code> that line is not working, because of different size ( I assume that in one sheet he has more data than in second one)."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 1, "creation_date": 1570528473, "post_id": 58283811, "comment_id": 102933202, "body": "I just noticed I forgot to delete the <code>.EntireRow</code> in my code, that was not supposed to be there. That line you mentioned does not work because it is copying a range with <code>Rows.Count</code> number of rows and is trying to paste it to a range with <code>Rows.Count - 2</code> number of rows. The copied range does not fit into the destination range."}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 1, "creation_date": 1570530230, "post_id": 58283811, "comment_id": 102934033, "body": "I know that &#39;why&#39;, I just wanted to adjust code to <code>.EntireRow</code>, that&#39;s all :) But now You figured out that it is not needed, edited and everything is fine now :)"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1570532721, "post_id": 58283811, "comment_id": 102935170, "body": "Unfortunately I am getting Error 1004 on this line: sh1.Range(sh1.Cells(x, 1), sh1.Cells(x, Rows.Count).End(xlToLeft)).Copy Destination:=sh2.Range(&quot;C&quot; &amp; x)"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1570534164, "post_id": 58283811, "comment_id": 102935836, "body": "@Rhyfelwr Sorry, it should have been <code>Columns.Count</code>. I corrected the code above, please copy the entire code and try again."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 1, "last_activity_date": 1570534084, "last_edit_date": 1570534084, "creation_date": 1570527524, "answer_id": 58283811, "question_id": 58283599, "link": "https://stackoverflow.com/questions/58283599/find-matching-rows-across-two-sheets/58283811#58283811", "title": "Find matching rows across two sheets", "body": "<p>You are already pretty close, try this corrected code (corrections are in comments):</p>\n\n<pre><code>Sub Matchcountry()\n\nDim sh1 As Worksheet\nDim sh2 As Worksheet\nDim r As Long, r2 As Long 'we just need the row number, not the Range object\n\nSet sh1 = Sheets(\"Sheet1\")\nSet sh2 = Sheets(\"Sheet2\")\nr = sh1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row 'All the necessary parts were there, just the syntax was wrong\nr2 = sh2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nDim x As Long, y As Long 'It's good practice to declare all your variables\nFor x = 1 To r\n    For y = 1 To r2\n        If sh1.Cells(x, 1).Value2 = sh2.Cells(y, 1).Value2 And sh1.Cells(x, 2).Value2 = sh2.Cells(y, 2).Value2 Then 'Again, most necessary parts were already there\n            sh1.Range(sh1.Cells(x, 1), sh1.Cells(x, Columns.Count).End(xlToLeft)).Copy Destination:=sh2.Range(\"C\" &amp; y) 'We don't need the entire row, in fact we won't be able to copy it to the desired renage since it's too big\n            Exit For 'will stop the second loop once it's found a match\n        End If\n    Next y\n    'x = x + 1 Common mistake. Next x already iterates x, by doing it this way we skip every second step\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>The biggest change is the second <code>For</code> loop. We need the second loop since you you want to loop through <code>sh2</code> for <strong>every</strong> row of <code>sh1</code>, nut just once.</p>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 58283811, "answer_count": 1, "score": 0, "last_activity_date": 1576566390, "creation_date": 1570526823, "last_edit_date": 1576566390, "question_id": 58283599, "link": "https://stackoverflow.com/questions/58283599/find-matching-rows-across-two-sheets", "title": "Find matching rows across two sheets", "body": "<p>I have a sheet1 (sh1) where I have a country name in say (A2) and a direction in (B2).</p>\n\n<p>I would like to find a row on sheet2 (sh2) where column&nbsp;A contains the same city name and column&nbsp;B contains the same district and copy that entire row next to the row on sh1 that was matching. Then I would like to loop through all rows on sh1 and find the matching rows on sh2 and copy it in the same manner. </p>\n\n<p>It might seem I am duplicating data, but the matched row on sh2 contains other information I'd like to copy to sh1.</p>\n\n<p>To illustrate:</p>\n\n<blockquote>\n<pre><code>On Sheet1:\n\nColumn A               Column B\n(header)               (header)\nSan Diego              South\nNew York               North\nChicago                East\n\nOn Sheet2:\n\nColumn A              Column B\n(header)              (header)\nChicago               East              \nSan Diego             South\nNew York              North\n</code></pre>\n</blockquote>\n\n<p>The loop would first check for San Diego, then New York, then Chicago and so on until the end of the column. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Matchcountry()\n\n    Dim sh1 As Worksheet\n    Dim sh2 As Worksheet\n    Dim r As Range\n\n    Set sh1 = Sheets(\"Sheet1\")\n    Set sh2 = Sheets(\"Sheet2\")\n    r = lastrow = sh1.Range(\"A\" &amp; Rows.Count) + 2.End(xlUp).Row    \n\n    For x = 1 To r    \n        If sh1.Range(\"A\" &amp; x) = sh2.Range(\"A\" &amp; x) And sh1.Range(\"B\" &amp; x) = sh1.Range(\"A\" &amp; x) &amp; sh2.Range(\"B\" &amp; x) Then \n            sh1.Range(\"A\" &amp; x).EntireRow.Copy Destination:=sh2.Range(\"C\" &amp; x)    \n        x = x + 1    \n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 1, "creation_date": 1570525066, "post_id": 58283088, "comment_id": 102931595, "body": "Which line produces the error?"}, {"owner": {"reputation": 1, "user_id": 12088876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a076ea63920c28f78993e5a772f6a5c7?s=128&d=identicon&r=PG&f=1", "display_name": "user612881", "link": "https://stackoverflow.com/users/12088876/user612881"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570525139, "post_id": 58283088, "comment_id": 102931630, "body": "presentation. why doesnt it proccess it ?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570525500, "post_id": 58283088, "comment_id": 102931817, "body": "What type is <code>Presentation</code>? do you have a class?"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570525515, "post_id": 58283088, "comment_id": 102931828, "body": "<code>Dim oPres As Presentation</code>, you cannot declare a variable as a <code>Presentation</code> as far as I know."}, {"owner": {"reputation": 1, "user_id": 12088876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a076ea63920c28f78993e5a772f6a5c7?s=128&d=identicon&r=PG&f=1", "display_name": "user612881", "link": "https://stackoverflow.com/users/12088876/user612881"}, "edited": false, "score": 0, "creation_date": 1570525557, "post_id": 58283088, "comment_id": 102931841, "body": "no i dont. it is a vba built in, i tried to search on google they replaced object with presentation but still didnt work"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570525588, "post_id": 58283088, "comment_id": 102931852, "body": "Look at Dai&#39;s post!"}], "answers": [{"tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 2, "last_activity_date": 1570525525, "creation_date": 1570525525, "answer_id": 58283237, "question_id": 58283088, "link": "https://stackoverflow.com/questions/58283088/user-type-not-defined-macro-error-vba-in-method/58283237#58283237", "title": "User type not defined macro error vba in method", "body": "<p>You tagged the question with \"Excel\", so I assume you're trying to run this macro in Excel, which won't work because the <code>Presentation</code> type is not in Excel by default. </p>\n\n<p>It's in PowerPoint:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/overview/powerpoint/object-model\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/overview/powerpoint/object-model</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.presentation\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/powerpoint.presentation</a></p>\n\n<p>You need to run this macro in PowerPoint, not Excel.</p>\n\n<p>You <em>can</em> run it in Excel, but you need to import the PowerPoint type-library into your Excel VBA project, but that's a separate question.</p>\n"}], "owner": {"reputation": 1, "user_id": 12088876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a076ea63920c28f78993e5a772f6a5c7?s=128&d=identicon&r=PG&f=1", "display_name": "user612881", "link": "https://stackoverflow.com/users/12088876/user612881"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572550791, "creation_date": 1570524963, "last_edit_date": 1572550791, "question_id": 58283088, "link": "https://stackoverflow.com/questions/58283088/user-type-not-defined-macro-error-vba-in-method", "title": "User type not defined macro error vba in method", "body": "<p>I am trying to call a sub function, but fails with an error:</p>\n\n<blockquote>\n  <p>User type not defined on the saveas method at this line. Maybe presentation isn't being processed in vba</p>\n</blockquote>\n\n<p>The error is on the first line of <code>SavePDFAsPng</code>:</p>\n\n<pre><code>Dim oPres As Presentation\n</code></pre>\n\n<p>Here is the whole macro:</p>\n\n<pre><code>Sub Button1_Click()\n    Call SavePDFAsPng(\"C:\\Users\\gfas1\\Desktop\\ahm.pdf\", \"C:\\Users\\gfas1\\Desktop\\MyTest.PNG\")\nEnd Sub\n\nSub SavePDFAsPng(sPathToPDF As String, sPathToPNG As String)\n\n            Dim oPres As Presentation\n            Dim oSh As Shape\n\n            ' Height/Width are hardcoded here\n            ' You could get trickier and bring the PDF into any presentation\n            ' once to get its proportions, delete it, set the slide size to the same\n            ' proportions, then re-insert the PDF\n            Dim sngWidth As Single\n            Dim sngHeight As Single\n            sngWidth = 612\n            sngHeight = 792\n\n            Set oPres = Presentations.Add\n            With oPres\n                With .PageSetup ' set it to 8.5x11\n                    .SlideHeight = sngHeight  ' 11in * 72 points per inch\n                    .SlideWidth = sngWidth\n                End With\n                .Slides.AddSlide 1, .SlideMaster.CustomLayouts(1)\n                With .Slides(1)\n                    Set oSh = .Shapes.AddOLEObject(0, 0, sngWidth, sngHeight, , sPathToPDF)\n                    Call .Export(sPathToPNG, \"PNG\")\n                End With\n                .Saved = True\n                .Close\n\n            End With\n\n        End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1570523527, "post_id": 58282733, "comment_id": 102930918, "body": "You are probably looking for the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.union\" rel=\"nofollow noreferrer\">Application.Union method</a>."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1570525302, "post_id": 58282733, "comment_id": 102931721, "body": "Might be better to use filters to find your rows"}], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1570524540, "creation_date": 1570524540, "answer_id": 58282999, "question_id": 58282733, "link": "https://stackoverflow.com/questions/58282733/is-there-a-way-to-loop-rows-that-meet-condition-to-set-a-single-range/58282999#58282999", "title": "is there a way to loop rows that meet condition to set a single range", "body": "<p>Building a range from ranges is best done with Union. The small problem is that you can't union something with nothing. In that case (which is the first iteration), you will have to set the collected range to the first found range. After that, use union</p>\n\n<pre><code>Sub setrng()\n    Dim CollectedRange As Range\n    Dim AddedRange As Range\n\n    Set WkSht = Sheets(\"Main\")\n\n    For i = 1 To 335\n        If WkSht.Cells(i, 8).Value = \"Y\" And WkSht.Cells(i, 9).Value = \"ZC\" And WkSht.Cells(i, 10).Value = \"N\" Then\n\n\n            With Application.Intersect(WkSht.Rows(i), WkSht.UsedRange)\n                Set AddedRange = WkSht.Range(WkSht.Cells(i, 3), .Cells(.Cells.Count))\n            End With\n\n            If Not AddedRange Is Nothing Then\n                If CollectedRange Is Nothing Then\n                    Set CollectedRange = AddedRange\n                Else\n                    Set CollectedRange = Union(CollectedRange, AddedRange)\n                End If\n            End If\n        End If\n\n    Next\n    Debug.Print CollectedRange.Address\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58282999, "answer_count": 1, "score": 0, "last_activity_date": 1570524540, "creation_date": 1570523442, "last_edit_date": 1570523456, "question_id": 58282733, "link": "https://stackoverflow.com/questions/58282733/is-there-a-way-to-loop-rows-that-meet-condition-to-set-a-single-range", "title": "is there a way to loop rows that meet condition to set a single range", "body": "<p>I want the VBA to loop through rows in a worksheet and set a range based on the rows that meet a condition.</p>\n\n<p>At the moment my code only selects the first row where the condition is true and I want all of the rows that meet the condition to be included in the set range ...</p>\n\n<pre><code>Sub setrng()\n    Set WkSht = Sheets(\"Main\")\n    For i = 1 To 335\n        If WkSht.Cells(i, 8).Value = \"Y\" And WkSht.Cells(i, 9).Value = \"ZC\" And WkSht.Cells(i, 10).Value = \"N\" Then\n\n            Dim rng As Range\n            With Application.Intersect(WkSht.Rows(i), WkSht.UsedRange)\n                Set rng(i) = WkSht.Range(WkSht.Cells(i, 3), .Cells(.Cells.Count))\n            End With\n\n            If rng Is Nothing Then\n                Exit Sub\n            End If\n        End If\n    Next\n</code></pre>\n"}]