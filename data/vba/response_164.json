[{"tags": ["vba", "oop"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1519866064, "post_id": 49040244, "comment_id": 85087468, "body": "If the property <code>Things</code> has <code>Object</code> as return type then Intellisense isn&#39;t going to be much use: it has no way to predict what will be contained in Collection wrapped by objects of that type.  You get Intellisense in part by having Properties with <i>specific</i> return types."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519866176, "post_id": 49040244, "comment_id": 85087490, "body": "@TimWilliams - I&#39;m starting to realise that.  I don&#39;t think there is a way, about to post an answer explaining..."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1519882257, "post_id": 49040244, "comment_id": 85091392, "body": "<code>Documents(i)</code> is just a shortcut to the default property of Documents, which is <code>Documents.Items</code> whose return type id <code>Document</code>. But that has nothing to do with why you don&#39;t see intellisense, which is, as you&#39;ve pointed out yourself, because you are returning the type <code>Object</code>. Why not return a concrete type?"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1519884208, "post_id": 49040244, "comment_id": 85091960, "body": "@andrew ... but how? <code>Documents(i)</code> is a document whereas <code>Documents</code> is a document collection. I did play around with the default member, but to no avail."}, {"owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "edited": false, "score": 0, "creation_date": 1519884547, "post_id": 49040244, "comment_id": 85092071, "body": "@SlowLearner - Because Documents(i) is not the same property as Documents. Documents(i) is actually Documents.Item(i). Hence no need to have two members with the same name (&quot;overloading&quot;). I&#39;ve shown an example implementation as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1519893759, "last_edit_date": 1519893759, "creation_date": 1519866266, "answer_id": 49041109, "question_id": 49040244, "link": "https://stackoverflow.com/questions/49040244/how-to-get-intellisense-with-vba-overriding/49041109#49041109", "title": "How to get intellisense with VBA overriding", "body": "<p><strong>Edit:</strong> <strong><em>It is possible</em></strong> I was just going about it the wrong way. @andrew provided a way of setting things up that works exactly the way I wanted as per the images in the question. Nevertheless, this (incorrect) answer provides some useful background info and context to others who might also be struggling with this...</p>\n\n<hr>\n\n<h2>I think it is <s>not</s> possible <em>(see the accepted answer)</em></h2>\n\n<p>Reading here: <a href=\"https://hammondmason.wordpress.com/2015/06/23/object-oriented-vba-overloading/\" rel=\"nofollow noreferrer\">https://hammondmason.wordpress.com/2015/06/23/object-oriented-vba-overloading/</a> states that VBA is a dynamically typed language and to properly support overloading it would need to be statically typed, i.e. enforce more explicit variable types.</p>\n\n<p>And, as mentioned by @TimWilliams - returning an object will basically prevent intellisense...  </p>\n\n<p>That said, I <em>think</em> I improved <em>(simplified)</em> the overloading example (but still no intellisense):</p>\n\n<pre><code>Sub test()\n\n    Dim bar As IFoo\n\n    Set bar = New cFoo\n    Debug.Print bar.things.Count\n    Debug.Print bar.things(1).name\n    Set bar = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Revised cFoo:</p>\n\n<pre><code>Public Property Get things(Optional x As Integer) As Object\n        Set things = IFoo_Things\nEnd Property\n\nPrivate Function IFoo_Things(Optional x As Integer = -1) As Object\n    Select Case x\n\n        Case -1 ' Return Collection of Things\n            Set IFoo_Things = mFunctions.things\n\n        Case Else ' Return specific Thing\n            Dim tempThing As oThing\n            Set tempThing = New oThing\n            tempThing.name = \"FooBar\"\n            Set IFoo_Things = tempThing\n    End Select\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1519888737, "post_id": 49043528, "comment_id": 85093646, "body": "Thank you - I&#39;ll have a good look at this and get back to you :)"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1519893323, "post_id": 49043528, "comment_id": 85095721, "body": "Thank you - that is exactly what I was trying to achieve"}], "tags": [], "owner": {"reputation": 1172, "user_id": 4860688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a59f44c7afd1202f19aa69929c52d43?s=128&d=identicon&r=PG&f=1", "display_name": "andrew", "link": "https://stackoverflow.com/users/4860688/andrew"}, "is_accepted": true, "score": 1, "last_activity_date": 1519884266, "creation_date": 1519884266, "answer_id": 49043528, "question_id": 49040244, "link": "https://stackoverflow.com/questions/49040244/how-to-get-intellisense-with-vba-overriding/49043528#49043528", "title": "How to get intellisense with VBA overriding", "body": "<p>Intellisense requires a return type other than <code>Object</code> - you need to return your <code>oThing</code> type.</p>\n\n<p>There are various ways to get what you want and various questions about how you want to do it - namely - do you want to hide the internal Collection in the <code>cThings</code> class, or are you wanting to expose it like you do in your example (which IMO seems bad).</p>\n\n<p>I'll just answer the direct questions you have:</p>\n\n<blockquote>\n  <p>How do I get intellisense for Count on <code>bar.Things.count</code></p>\n</blockquote>\n\n<p>Answer: you set the return type on bar.Things to something. It could be your <code>cThings</code> collection type, or it could be the Collection you have inside the <code>cThings</code> collection type (IMO it is bad to return the internal Collection object). </p>\n\n<p>So type <code>Foo</code> needs a <code>Things</code> property that returns a <code>cThings</code>:</p>\n\n<pre><code>Property Get Things() As cThings\n    Set Things = myThings\nEnd Property\n</code></pre>\n\n<p>Also, <code>cThings</code> needs a <code>Count</code> property. You can just pass-through the internal collection's Count property:</p>\n\n<pre><code>Property Get Count() As Long\n    Count = myInternalCollection.Count\nEnd Property\n</code></pre>\n\n<blockquote>\n  <p>How do I get intellisense for Name on <code>bar.Things(1).name</code></p>\n</blockquote>\n\n<p>Answer: firstly, the MSWord example of <code>Documents(i)</code> is equivalent to <code>Documents.Item(i)</code> where <code>Item</code> is the default property of <code>Documents</code> which takes an index. Creating a default property is a pain in VBA. You have to edit the module as a text file and import it. Sucks.</p>\n\n<p>If you were to settle for having intellisense for Name on <code>bar.Things.Item(1).name</code> and forego the shortcut syntax for the default property then you can just add the following to <code>cThings</code>:</p>\n\n<pre><code>Property Get Item(index) As oThing\n    Set Items = myInternalCollection.Item(index)\nEnd Property\n</code></pre>\n\n<p>Now you'll have intellisense on <code>bar.Things.Item(1).name</code>.</p>\n\n<p>However, if you really want <code>bar.Things(1)</code> to work then you need to do this:</p>\n\n<p>Export your module and insert an attribute into the Item property:</p>\n\n<pre><code>Property Get Item(index) As oThing\n    Attribute Value.VB_UserMemId = 0\n    Set Items = myInternalCollection.Item(index)\nEnd Property\n</code></pre>\n\n<p>Then, import it back.</p>\n\n<p>Now, <code>bar.Things(1)</code> will translate to <code>bar.Things.Item(1)</code> which will return an item and be shown in intellisense.</p>\n"}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 49043528, "answer_count": 2, "score": 4, "last_activity_date": 1519893759, "creation_date": 1519859745, "last_edit_date": 1519864699, "question_id": 49040244, "link": "https://stackoverflow.com/questions/49040244/how-to-get-intellisense-with-vba-overriding", "title": "How to get intellisense with VBA overriding", "body": "<h1>Example of what I'm trying to do</h1>\n\n<p>In MS Office it is possible to get intellisense for <strong>both</strong> of these things: <code>Application.Documents(1).</code> and  <code>Application.Documents.</code> </p>\n\n<p>I'm trying to do the same for my own classes, I think this is called overriding?</p>\n\n<h2>I'm getting stuck with the intellisense...</h2>\n\n<p>The following images show what I'm trying to achieve for my own classes (i.e. get intellisense for both  <code>Things.</code> and <code>Things(i).</code> ...):</p>\n\n<p><strong>Image 1</strong> <em>(below)</em> shows intellisense for the documents collection, e.g. <code>.count</code> property.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zP6Dg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zP6Dg.png\" alt=\"intellisense for the documents collection\"></a></p>\n\n<p><strong>Image 2</strong>  <em>(below)</em> shows intellisense for a document, it's completely different.\n<a href=\"https://i.stack.imgur.com/19dGR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/19dGR.png\" alt=\"intellisense for a document\"></a></p>\n\n<h1>What I have</h1>\n\n<p>I started out by modifying code from this answer (a 'calculator' which provided the basic structure): <a href=\"https://stackoverflow.com/a/38704040/3451115\">https://stackoverflow.com/a/38704040/3451115</a></p>\n\n<p>The modified code has 2 new classes, they are the 'objects to be returned' (instead of a calculated value from the original code): </p>\n\n<ul>\n<li>a collection class (<code>cThings</code>) </li>\n<li>an object class (<code>oThing</code>)</li>\n</ul>\n\n<p>So, just like for <code>.Documents</code>, I want to be able to:</p>\n\n<p><code>Things.</code> or <code>Things(i).</code> and get intellisense...</p>\n\n<p>I figured that adding an index <code>(i)</code> <em>i.e. <code>item:=index</code></em> MUST be optional so I made the parameter optional. </p>\n\n<p>Although when working with the Documents collection I noticed that, when opening the parenthesis <code>(...</code>, the item parameter is NOT enclosed by [square brackets] <em>(which as far as I know normally indicates optional)</em>.</p>\n\n<p><strong>Question:</strong> Is it possible? How can it be achieved?</p>\n\n<hr>\n\n<h2>Here are the classes &amp; modules:</h2>\n\n<p>Standard module for testing <em>(works but does NOT have intellisense)</em>:</p>\n\n<pre><code>Attribute VB_Name = \"overrideExample\"\nSub test()\n    Dim bar As IFoo\n\n    Set bar = New cFoo\n    Debug.Print bar.Things.count     ' No intellisense for count\n\n    Set bar = New oFoo\n    Debug.Print bar.Things(1).name   ' No intellisense for name\n\nEnd Sub\n</code></pre>\n\n<p>Interface, IFoo</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"IFoo\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\n\nFunction Things(Optional index As Integer) As Object\nEnd Function\n</code></pre>\n\n<p>Collection of Foo, cFoo</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"cFoo\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\n\nImplements IFoo\n\nPrivate mFunctions As Foo\n\nPrivate Sub Class_Initialize()\n    Set mFunctions = New Foo\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set mFunctions = Nothing\nEnd Sub\n\nPrivate Function IFoo_Things(Optional x As Integer) As Object\n    Set IFoo_Things = mFunctions.Things ' Uses the standard aFunction\nEnd Function\n</code></pre>\n\n<p>Object of Foo, oFoo</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"oFoo\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\n\nImplements IFoo\n\nPrivate mFunctions As Foo\n\nPrivate Sub Class_Initialize()\n    Set mFunctions = New Foo\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set mFunctions = Nothing\nEnd Sub\n\nPrivate Function IFoo_Things(Optional x As Integer) As Object\n    Dim tempThing As oThing\n    Set tempThing = New oThing\n    tempThing.name = \"FooBar\"\n    Set IFoo_Things = tempThing\nEnd Function\n</code></pre>\n\n<p>Collection of Things, cThings</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"cThings\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\n\nPrivate Type TThings\n    m_objmyThings As Collection\nEnd Type\n\nPrivate this As TThings\n\nPublic Function count() As Integer\n    count = this.m_objmyThings.count\nEnd Function\n\nPublic Property Get myThings() As Collection\n    Set myThings = this.m_objmyThings\nEnd Property\n\nPublic Property Set myThings(ByVal objNewValue As Collection)\n    Set this.m_objmyThings = objNewValue\nEnd Property\n\nPrivate Sub Class_Initialize()\nSet this.m_objmyThings = New Collection\nEnd Sub\n</code></pre>\n\n<p>Object of Thing, oThing</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"oThing\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\n\nPrivate Type TThing\n    m_sName As String\nEnd Type\n\nPrivate this As TThing\n\nPublic Property Get name() As String\n    name = this.m_sName\nEnd Property\n\nPublic Property Let name(ByVal sNewValue As String)\n    this.m_sName = sNewValue\nEnd Property\n</code></pre>\n\n<p>Object Foo, Foo</p>\n\n<pre><code>VERSION 1.0 CLASS\nBEGIN\n  MultiUse = -1  'True\nEND\nAttribute VB_Name = \"Foo\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = False\nAttribute VB_Exposed = False\nOption Explicit\n\nFunction Things(Optional x As Integer) As cThings\n    Set Things = New cThings\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "ms-word", "bookmarks"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1519859531, "creation_date": 1519859531, "answer_id": 49040217, "question_id": 49040171, "link": "https://stackoverflow.com/questions/49040171/word-vba-loop-through-and-to-delete-bookmarks/49040217#49040217", "title": "Word VBA - Loop through &quot;AND&quot; to delete bookmarks", "body": "<p>Loop the array, and use a Boolean to keep track if found or not.</p>\n\n<pre><code>Dim arr As Variant\nDim bookmark As Bookmarks\nDim i As Long\nDim bln As Boolean\n\narr = Array(\"a\", \"b\", \"c\")\n\nFor Each bookmark In ActiveDocument.Bookmarks\n    bln = False\n    For i = LBound(arr) To UBound(arr)\n        If bookmark = arr(i) Then\n            bln = True\n            Exit For\n        End If\n    Next i\n    If Not bln Then bookmark.Delete\nNext bookmark\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9425684, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945475432146656/picture?type=large", "display_name": "Rodrigo Sassaki", "link": "https://stackoverflow.com/users/9425684/rodrigo-sassaki"}, "is_accepted": false, "score": 0, "last_activity_date": 1519872449, "creation_date": 1519872449, "answer_id": 49041849, "question_id": 49040171, "link": "https://stackoverflow.com/questions/49040171/word-vba-loop-through-and-to-delete-bookmarks/49041849#49041849", "title": "Word VBA - Loop through &quot;AND&quot; to delete bookmarks", "body": "<p>If you have just a few elements, instead o using \"If\" and a loop through the array you could just use a Select Case</p>\n\n<pre><code>Select bookmark\nCase Is &lt;&gt; \"a\",\"b\",\"c\"\nbookmark.Delete\nCase Else\n'Whatever code\nEnd Select\n</code></pre>\n\n<p>But depending on the size of the array the loop solution could be better.</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1519887601, "last_edit_date": 1519887601, "creation_date": 1519884133, "answer_id": 49043500, "question_id": 49040171, "link": "https://stackoverflow.com/questions/49040171/word-vba-loop-through-and-to-delete-bookmarks/49043500#49043500", "title": "Word VBA - Loop through &quot;AND&quot; to delete bookmarks", "body": "<p>You could use <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/join-function\" rel=\"nofollow noreferrer\">Join()</a> function to obtain a string from all bookmarks array values and then <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/instr-function\" rel=\"nofollow noreferrer\">Instr()</a> function to check for current bookmark to be there</p>\n\n<pre><code>Dim arr As Variant\nDim bookmark As Bookmark\n\narr = Array(\"a\", \"b\", \"c\")\n\nFor Each bookmark In ActiveDocument.Bookmarks\n    If Instr(Join(arr, \"|\"), bookmark) = 0 Then bookmark.Delete\nNext bookmark  \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9426130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8af178837a512a293e090ae0cfeda6f?s=128&d=identicon&r=PG&f=1", "display_name": "pa.lo", "link": "https://stackoverflow.com/users/9426130/pa-lo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1519887601, "creation_date": 1519859277, "question_id": 49040171, "link": "https://stackoverflow.com/questions/49040171/word-vba-loop-through-and-to-delete-bookmarks", "title": "Word VBA - Loop through &quot;AND&quot; to delete bookmarks", "body": "<p>I am writing a macro in VBA Word that is copying data from an excel file and pasting the data in the Word file using predefined bookmarks.\nI have two different groups of bookmarks in Word and, based on the action to perform, the macro is first deleting the bookmarks not needed for that specific action and then pasting the data where the remaining bookmarks are.</p>\n\n<p>The code so far works in both cases but, not being a proficient programmer, I had to write several lines for a specific task to work and I would like your help to \"clean\" this part of code, make it less \"intricate\" and also easier to amend in case future changes are needed. Below you will find the code that, as I said, works but it is not pretty.</p>\n\n<pre><code>Dim arr As Variant\nDim bookmark As Bookmarks\nDim i As Long\n\narr = Array(\"a\", \"b\", \"c\")\n\nFor Each bookmark In ActiveDocument.Bookmarks\n    If bookmark &lt;&gt; arr(0) And bookmark &lt;&gt; arr(1) _\n    And bookmark &lt;&gt; arr(2) Then\n    bookmark.Delete\n    Else\n    bookmark.Select 'this is just to give a \"useless\" alternative to vba\n    End If\nNext bookmark  \n</code></pre>\n\n<p>I only put 3 elements of the array here, while in reality there are many, but the idea is to automate the \"AND\" function and the scope is the following: if every single bookmark already present in the Word file is different than ANY element of the array \"arr\" then that bookmark has to be deleted, otherwise nothing happens to it.\nSo, instead of using one AND function for every element of the array I would like to loop through the array so that every bookmark is compared to ALL the elements of the array and only if different is removed. I do not know if there is a way to loop the \"AND\" function somehow, but adding more elements to the array would mean add the same number of \"AND\".</p>\n\n<p>Hope to have been exhaustiv and that you can help me.</p>\n\n<p>Thanks a lot in advance!</p>\n"}, {"tags": ["string", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519856540, "post_id": 49039545, "comment_id": 85084516, "body": "personally I would use MID, less typing <code>y = Mid(x,InStr(x,&quot;@&quot;)+1)</code>"}, {"owner": {"reputation": 545, "user_id": 7903466, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/76c21598230104abb0c60f24ff68998a?s=128&d=identicon&r=PG&f=1", "display_name": "M Waz", "link": "https://stackoverflow.com/users/7903466/m-waz"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519857356, "post_id": 49039545, "comment_id": 85084853, "body": "I think Right() is more intuitive. Anyway, there are many ways to accomplish this task, it&#39;s whichever one makes more sense to you."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1519858978, "post_id": 49039545, "comment_id": 85085525, "body": "more like<code>Mid(x, ((InStr(x, &quot;@&quot;) -1) And 65535) + 2)</code> in case <code>@</code> is missing"}, {"owner": {"reputation": 661, "user_id": 197089, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/49b9ab65bf50ff06ccbd0f4934f74a12?s=128&d=identicon&r=PG", "display_name": "Chasester", "link": "https://stackoverflow.com/users/197089/chasester"}, "edited": false, "score": 0, "creation_date": 1590092625, "post_id": 49039545, "comment_id": 109557813, "body": "This works good in an Access Query also like this <code>y: Right([access_field],Len([access_field])-InStr([access_field&zwnj;&#8203;],&quot;.&quot;))</code>"}], "tags": [], "owner": {"reputation": 545, "user_id": 7903466, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/76c21598230104abb0c60f24ff68998a?s=128&d=identicon&r=PG&f=1", "display_name": "M Waz", "link": "https://stackoverflow.com/users/7903466/m-waz"}, "is_accepted": false, "score": 3, "last_activity_date": 1519856261, "creation_date": 1519856261, "answer_id": 49039545, "question_id": 49039453, "link": "https://stackoverflow.com/questions/49039453/vba-how-to-find-the-values-after-a-symbol-in-a-string/49039545#49039545", "title": "VBA: How to find the values after a &quot;@&quot; symbol in a string", "body": "<p>You can do the following to get the substring after the @ symbol.</p>\n\n<pre><code>x = \"@BAL\"\n\ny = Right(x,len(x)-InStr(x,\"@\"))\n</code></pre>\n\n<p>Where x can be any string, with characters before or after the @ symbol.</p>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1520019126, "last_edit_date": 1592644375, "creation_date": 1519857711, "answer_id": 49039865, "question_id": 49039453, "link": "https://stackoverflow.com/questions/49039453/vba-how-to-find-the-values-after-a-symbol-in-a-string/49039865#49039865", "title": "VBA: How to find the values after a &quot;@&quot; symbol in a string", "body": "<p><code>Split()</code> in my opinion is the easiest way to do it:</p>\n<pre><code>Dim myStr As String\nmyStr = &quot;@BAL&quot;\nIf InStr(, myStr, &quot;@&quot;) &gt; 0 Then '&lt;-- Check for your string to not throw error\n    MsgBox Split(myStr, &quot;@&quot;)(1)\nEnd If\n</code></pre>\n<p>As wisely pointed out by <a href=\"https://stackoverflow.com/questions/49039453/vba-how-to-find-the-values-after-a-symbol-in-a-string/49039865#comment85085219_49039865\">Scott Craner</a>, you should check to ensure the string contains the value, which he checks in <a href=\"https://stackoverflow.com/questions/49039453/vba-how-to-find-the-values-after-a-symbol-in-a-string/49039865#comment85084285_49039453\">this comment</a> by doing: <code>y = Split(x,&quot;@&quot;)(ubound(Split(x,&quot;@&quot;))</code>. Another way you can do it is using <code>InStr()</code>: <code>If InStr(, x, &quot;@&quot;) &gt; 0 Then...</code></p>\n<p>The <code>(1)</code> will take everything <em>after</em> the <strong>first instance</strong> of the character you are looking for. If you were to have used <code>(0)</code>, then this would have taken everything before the <code>@</code>.</p>\n<hr />\n<p>Similar but different example:</p>\n<pre><code>Dim myStr As String\nmyStr = &quot;@BAL@TEST&quot;\n\nMsgBox Split(myStr, &quot;@&quot;)(2)\n</code></pre>\n<p>The message box would have returned <code>TEST</code> because you used <code>(2)</code>, and this was the second instance of your <code>@</code> character.</p>\n<hr />\n<p>Then you can even split them into an array:</p>\n<pre><code>Dim myStr As String, splitArr() As String\nmyStr = &quot;@BAL@TEST&quot;\n\nsplitArr = Split(myStr, &quot;@&quot;)   '&lt; -- don't append the collection number this time\n\nMsgBox SplitArr(1)  '&lt; -- This would return &quot;BAL&quot;\nMsgBox SplitArr(2)  '&lt; -- This would return &quot;TEST&quot;\n</code></pre>\n<hr />\n<p>If you are looking for additional reading, here is more from the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/split-function\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n<blockquote>\n<h1><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/split-function\" rel=\"nofollow noreferrer\">Split Function</a></h1>\n<p><strong>Description</strong> Returns a zero-based, one-dimensional array containing a specified number of substrings. <strong>SyntaxSplit</strong>( <strong>expression</strong> [ ,<strong>delimiter</strong> [ ,<strong>limit</strong> [ ,<strong>compare</strong> ]]] ) The <strong>Split</strong> function syntax has thesenamed arguments:</p>\n<p><strong>expression</strong></p>\n<blockquote>\n<p>Required. String expression containing substrings and delimiters. If expression is a zero-length string(&quot;&quot;), <strong>Split</strong> returns an empty array, that is, an array with no elements and no data.</p>\n</blockquote>\n<p><strong>delimiter</strong></p>\n<blockquote>\n<p>Optional. String character used to identify substring limits. If omitted, the space character (&quot; &quot;) is assumed to be the <em><strong>delimiter</strong></em>. If delimiter is a zero-length string, a single-element array containing the entire <em><strong>expression</strong></em> string is returned.</p>\n</blockquote>\n<p><strong>limit</strong></p>\n<blockquote>\n<p>Optional. Number of substrings to be returned; -1 indicates that all substrings are returned.</p>\n</blockquote>\n<p><strong>compare</strong></p>\n<blockquote>\n<p>Optional. Numeric value indicating the kind of comparison to use when evaluating substrings. See Settings section for values.</p>\n</blockquote>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 9335134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b419ea0ba4d7b992317b3110b9bf8fd4?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Bowden", "link": "https://stackoverflow.com/users/9335134/aaron-bowden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3622, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1520019126, "creation_date": 1519855866, "last_edit_date": 1519858752, "question_id": 49039453, "link": "https://stackoverflow.com/questions/49039453/vba-how-to-find-the-values-after-a-symbol-in-a-string", "title": "VBA: How to find the values after a &quot;@&quot; symbol in a string", "body": "<p>I am trying to set the letters after a @ symbol to a variable.</p>\n\n<p>For example, <code>x = @BAL</code></p>\n\n<p>I want to set <code>y  = BAL</code></p>\n\n<p>Or <code>x = @NE</code></p>\n\n<p>I want <code>y = NE</code>  </p>\n\n<p>I am using VBA. </p>\n"}, {"tags": ["vba", "excel", "srt"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1519853337, "post_id": 49038650, "comment_id": 85083055, "body": "Or you run a regex on the file with a good text editor, to turn it into a .csv, or tab delimited file then open in Excel"}, {"owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "edited": false, "score": 0, "creation_date": 1519857757, "post_id": 49038650, "comment_id": 85085045, "body": "The format of a SubRipText file looks like fixed width should work.  You could open Excel, go to the data tab, select open text file and then specify your file to open.  The import wizard will walk you through showing how the output will look with the selections you make."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1519858935, "post_id": 49038650, "comment_id": 85085511, "body": "Are you planning on importing multiple SRT&#39;s?  Reason I ask is, they can come in slightly different formats.  In fact, if your sample is <i>one record per line</i> like that, then it&#39;s non-standard."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1519859038, "post_id": 49038650, "comment_id": 85085559, "body": "ah ha , I see the problem... I fixed your formatting.  And I just happen to have something that should do the trick for you."}, {"owner": {"reputation": 760, "user_id": 209859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59dee8a3306722a0d13be6370770151?s=128&d=identicon&r=PG", "display_name": "jerclarke", "link": "https://stackoverflow.com/users/209859/jerclarke"}, "edited": false, "score": 0, "creation_date": 1598051954, "post_id": 49038650, "comment_id": 112342387, "body": "Just want to upvote this question because it&#39;s a really straightforward request to get SRT data into a spreadsheet. I wish the answers that were put in comments here were actual answers to the question with details. The one about using the import wizard seems especially promising."}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1519866486, "last_edit_date": 1519866486, "creation_date": 1519859806, "answer_id": 49040258, "question_id": 49038650, "link": "https://stackoverflow.com/questions/49038650/how-to-make-an-srt-file-into-a-dataset/49040258#49040258", "title": "How to make an SRT file into a dataset?", "body": "<p>The VBA procedure below loads a standard <code>.srt</code> (SubRip Movie Subtitle File) from a local file and splits it into rows/columns on the active Excel worksheet.</p>\n\n<h2>Import SRT subtitles from Local File:</h2>\n\n<pre><code>Sub importSRTfromFile(fName As String)\n'Loads SRT from local file and converts to columns in Active Worksheet\n\n    Dim sIn As String, sOut As String, sArr() As String, x As Long\n\n    'load file\n    Open fName For Input As #1\n        While Not EOF(1)\n            Line Input #1, sIn\n            sOut = sOut &amp; sIn &amp; vbLf\n        Wend\n    Close #1\n\n    'convert LFs to delimiters &amp; split into array\n    sOut = Replace(sOut, vbLf &amp; vbLf, vbCr)\n    sOut = Replace(Replace(sOut, vbLf, \"|\"), \" --&gt; \", \"|\")\n    sArr = Split(sOut, vbCr)\n\n    'check if activesheet is blank\n    If ActiveSheet.UsedRange.Cells.Count &gt; 1 Then\n        If MsgBox(UBound(sArr) &amp; \" rows found.\" &amp; vbLf &amp; vbLf &amp; _\n            \"Okay to clear worksheet '\" &amp; ActiveSheet.Name &amp; \"'?\", _\n            vbOKCancel, \"Delete Existing Data?\") &lt;&gt; vbOK Then Exit Sub\n        ActiveSheet.Cells.ClearContents\n    End If\n\n    'breakout into rows\n    For x = 1 To UBound(sArr)\n        Range(\"A\" &amp; x) = sArr(x)\n    Next x\n\n    'split into columns\n    Columns(\"A:A\").TextToColumns Destination:=Range(\"A1\"), _\n        DataType:=xlDelimited, Other:=True, OtherChar:=\"|\"\n\n    MsgBox \"Imported \" &amp; UBound(sArr) &amp; \" rows from:\" &amp; vbLf &amp; fName\n\nEnd Sub\n</code></pre>\n\n<p><strong>Example Usage:</strong></p>\n\n<pre><code>Sub test_FileImport()\n    importSRTfromFile \"c:\\yourPath\\yourFilename.srt\"\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Import SRT subtitles from Website URL:</h2>\n\n<p>Alternatively, you can import an <code>.srt</code> (or other similar text files) from a <strong>Website</strong> URL such as <a href=\"http://subtitle-index.org/\" rel=\"nofollow noreferrer\">https://subtitle-index.org/</a> with this:</p>\n\n<pre><code>Sub importSRTfromWeb(url As String)\n'Loads SRT from URL and converts to columns in Active Worksheet\n\n    Dim sIn As String, sOut As String, sArr() As String, rw As Long\n    Dim httpData() As Byte, XMLHTTP As Object\n\n    'load file from URL\n    Set XMLHTTP = CreateObject(\"MSXML2.XMLHTTP\")\n    XMLHTTP.Open \"GET\", url, False\n    XMLHTTP.send\n    httpData = XMLHTTP.responseBody\n    Set XMLHTTP = Nothing\n    sOut = StrConv(httpData, vbUnicode)\n\n    'convert LFs to delimiters &amp; split into array\n    sOut = Replace(sOut, vbLf &amp; vbLf, vbCr)\n    sOut = Replace(Replace(sOut, vbLf, \"|\"), \" --&gt; \", \"|\")\n    sArr = Split(sOut, vbCr)\n\n    'check if activesheet is blank\n    If ActiveSheet.UsedRange.Cells.Count &gt; 1 Then\n        If MsgBox(UBound(sArr) &amp; \" rows found.\" &amp; vbLf &amp; vbLf &amp; _\n            \"Okay to clear worksheet '\" &amp; ActiveSheet.Name &amp; \"'?\", _\n            vbOKCancel, \"Delete Existing Data?\") &lt;&gt; vbOK Then Exit Sub\n        ActiveSheet.Cells.ClearContents\n    End If\n\n    'breakout into rows\n    For rw = 1 To UBound(sArr)\n        Range(\"A\" &amp; rw) = sArr(rw)\n    Next rw\n\n    'split into columns\n    Columns(\"A:A\").TextToColumns Destination:=Range(\"A1\"), _\n        DataType:=xlDelimited, Other:=True, OtherChar:=\"|\"\n    MsgBox \"Imported \" &amp; UBound(sArr) &amp; \" rows from:\" &amp; vbLf &amp; url\n\nEnd Sub\n</code></pre>\n\n<h2><strong>Example Usage:</strong></h2>\n\n<pre><code>Sub testImport()\n    importSRTfromWeb _\n        \"https://subtitle-index.org/download/4670541854528212663953859964/SRT/Pulp+Fiction\"\nEnd Sub\n</code></pre>\n\n<p>Many sites host free <code>.srt</code>'s; you may have to right-click the download button to copy the link (which may have an <code>.srt</code> extension or might be a pointer, like the example above).  The procedure won't work on <code>.zip</code>'d files.</p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>Wikipedia : <a href=\"http://subrip/\" rel=\"nofollow noreferrer\">SubRip &amp; SRT</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/split-function\" rel=\"nofollow noreferrer\">Split Function (VBA)</a></p></li>\n<li><p>Wikipedia : <a href=\"https://en.wikipedia.org/wiki/Newline\" rel=\"nofollow noreferrer\">Newline characters</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/ubound-function\" rel=\"nofollow noreferrer\">UBound Function</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-texttocolumns-method-excel\" rel=\"nofollow noreferrer\">Range.TextToColumns Method (Excel)</a></p></li>\n<li><p><a href=\"http://zuggy.wz.cz/\" rel=\"nofollow noreferrer\">SubRip Official Website</a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9834945, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/38837f058d891f277047c81a327281b2?s=128&d=identicon&r=PG", "display_name": "Leo", "link": "https://stackoverflow.com/users/9834945/leo"}, "is_accepted": false, "score": 0, "last_activity_date": 1527085945, "last_edit_date": 1527085945, "creation_date": 1527083386, "answer_id": 50490140, "question_id": 49038650, "link": "https://stackoverflow.com/questions/49038650/how-to-make-an-srt-file-into-a-dataset/50490140#50490140", "title": "How to make an SRT file into a dataset?", "body": "<p>in the above code :</p>\n\n<p><code>'breakout into rows\n    For rw = 1 To UBound(sArr)\n        Range(\"A\" &amp; rw) = sArr(rw)\n    Next rw</code></p>\n\n<p>should be replaced with:</p>\n\n<p><code>'breakout into rows\n    For rw = 0 To UBound(sArr)\n        Range(\"A\" &amp; rw+1) = sArr(rw)\n    Next rw</code></p>\n\n<p>else the output will start from line 2</p>\n"}], "owner": {"reputation": 51, "user_id": 8151357, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/10209138165076476/picture?type=large", "display_name": "Dave", "link": "https://stackoverflow.com/users/8151357/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1770, "favorite_count": 1, "accepted_answer_id": 49040258, "answer_count": 2, "score": 1, "last_activity_date": 1582418627, "creation_date": 1519852372, "last_edit_date": 1530822121, "question_id": 49038650, "link": "https://stackoverflow.com/questions/49038650/how-to-make-an-srt-file-into-a-dataset", "title": "How to make an SRT file into a dataset?", "body": "<p>Is it possible to turn an <code>SRT</code> file, which is used for subtitles in videos <strong>into a dataset</strong>?</p>\n\n<p>When imported into Excel, the <code>SRT</code> file format looks like this:</p>\n\n<pre><code>1\n00:00:03,000 --&gt; 00:00:04,000\nOVERLAPS PURE COINCIDENCE THAT\n\n...\n</code></pre>\n\n<p>This pattern continues as time in the \"video\"/transcript goes on.  I'd like to format the <code>SRT</code> file this way:</p>\n\n<pre><code>number ; start ; end ; text\n\n1 ; 00:00:03,000 ; 00:00:04,000 ; OVERLAPS PURE COINCIDENCE THAT\n</code></pre>\n"}, {"tags": ["vba", "dynamic", "offset"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1519852752, "post_id": 49038606, "comment_id": 85082727, "body": "Set FoundCell = Cells(Target.Row,namecol.Column)"}, {"owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519853162, "post_id": 49038606, "comment_id": 85082952, "body": "Holy crap, what a quick reply, and it was perfect!!!  Scott, thank you so much!  Honestly, I sit here all day trying to figure this stuff out on my own.  Then I post here and get an answer that fixes everything in minutes!  You guys rock!  I did try the .row property earlier but at the time I had not defined my name columns.  So I kept getting errors.  Now, with your code it worked a treat, cheers!  Scott, can you please post your reply as an answer so I can mark it as answered and you get the credit?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1519855373, "post_id": 49038606, "comment_id": 85084015, "body": "<code>sAction = .Offset(0, 24).Value + 365</code> trying to add a year to a date? Check this <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dateadd-function\" rel=\"nofollow noreferrer\">DateAdd</a> function."}, {"owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "edited": false, "score": 0, "creation_date": 1520610860, "post_id": 49038606, "comment_id": 85399890, "body": "Hey, thanks Patrick, I am going to try that out!  More knowledge, I love this site!"}], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "is_accepted": true, "score": 0, "last_activity_date": 1520606049, "creation_date": 1520606049, "answer_id": 49196006, "question_id": 49038606, "link": "https://stackoverflow.com/questions/49038606/set-value-dynamically-based-on-column-header-and-intersection-of-target-row/49196006#49196006", "title": "Set Value Dynamically Based on Column Header and Intersection of Target Row", "body": "<p>This was the answer, given by the below:\nSet FoundCell = Cells(Target.Row,namecol.Column) --Scott Craner</p>\n"}], "owner": {"reputation": 89, "user_id": 8517515, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e455b59239d6aea71e8a009719a92e98?s=128&d=identicon&r=PG&f=1", "display_name": "learningthisstuff", "link": "https://stackoverflow.com/users/8517515/learningthisstuff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 49196006, "answer_count": 1, "score": 0, "last_activity_date": 1520606049, "creation_date": 1519852193, "question_id": 49038606, "link": "https://stackoverflow.com/questions/49038606/set-value-dynamically-based-on-column-header-and-intersection-of-target-row", "title": "Set Value Dynamically Based on Column Header and Intersection of Target Row", "body": "<p>the people on this site have been so helpful and I hope someone can help me figure out how to use dynamic column headers to assign a value in my code.  I have a sub set up as a Before Double Click Target, with all the targets in column A.  Right now I have it working fine, assigning values using the offset method.  I need to pull data from cells in the target row and so long as the columns do not get moved, it is great. However, users are now adding columns but the headers of the columns I need will not be changed.  I need to now change this to a dynamic lookup based on the intersection of the target row and a specific column based on their headers.  I can set values that find the columns I want, but have not been able to get the data to pull correctly based on the target row.  I thought that the Intersect property would work but it does not seem to, as that is based on finding the target itself within a range.  I need to find a cell relative to the target, intersecting with the column based on a header.  That value will be used elsewhere in the sub.  What step am I missing?</p>\n\n<p>This segment of the code is below, and you can see I have a hybrid right now, some with the straight up offsets based on column numbers, then the other where I am trying to use assigned column names nameCol and nameCol1.  The offset method works, but when I try to use the headers to define where to look on the target row, it does not work.  Thank you.</p>\n\n<pre><code>Set nameCol = Range(\"A1:Z1\").Find(\"Last\")\nSet nameCol1 = Range(\"A1:Z1\").Find(\"First\")\nSet nameCol2 = Range(\"A1:Z1\").Find(\"Name\")\nSet nameCol3 = Range(\"A1:Z1\").Find(\"Date\")\n\n\n 'Check active column is column 1 (Where you want the macro to be called from)\n  If Target.Column = 1 Then\n    With Target\n        sName = .Value\n        sAction = .Offset(0, 24).Value + 365\n        Set foundCell = .Offset(0, nameCol.Column)\n        Set foundcell1 = .Offset(0, nameCol1.Column)\n        Set foundcell3 = .Offset(0, 36)\n        Set foundcell4 = .Offset(0, 35)\n        sReason = .Offset(0, 6).Value\n        foundcell2 = .Offset(0, 6)\n</code></pre>\n"}, {"tags": ["vba", "excel", "merge", "reset"], "answers": [{"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1519855849, "last_edit_date": 1519855849, "creation_date": 1519850803, "answer_id": 49038250, "question_id": 49038056, "link": "https://stackoverflow.com/questions/49038056/merging-cells-in-column-command-button-reset/49038250#49038250", "title": "Merging Cells in Column Command Button Reset", "body": "<p>All you need before pasting is:</p>\n\n<pre><code>Sheets(\"TEST\").Cells.UnMerge\n</code></pre>\n\n<p>This will UnMerge all cells in <code>Sheet(\"TEST\")</code>. If you need to unmerge a specific range, then just use something like:</p>\n\n<pre><code>Sheets(\"TEST\").Range(\"A1:H586\").Unmerge\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9425684, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945475432146656/picture?type=large", "display_name": "Rodrigo Sassaki", "link": "https://stackoverflow.com/users/9425684/rodrigo-sassaki"}, "is_accepted": false, "score": 0, "last_activity_date": 1519851658, "creation_date": 1519851658, "answer_id": 49038470, "question_id": 49038056, "link": "https://stackoverflow.com/questions/49038056/merging-cells-in-column-command-button-reset/49038470#49038470", "title": "Merging Cells in Column Command Button Reset", "body": "<p>This TEST sheet of yours. Is it always gonna be a clean sheet?\nWhat is really the point of your routine?\nYou could always\nSomething like:</p>\n\n<pre><code>'This deletes te worksheet \"TEST\" and creates a new one with the same name\nSet sortSheet = ThisWorkbook.Worksheets(\"TEST\")\nsortSheet.Delete\nset sortSheet = ThisWorkbook.Worksheets.Add\nwsSheet.name = \"TEST\"\n</code></pre>\n\n<p>Or you could just unmerge everything:</p>\n\n<pre><code>sortSheet.Range(\"A2:D\" &amp; cStr(lastRowDescrip)).UnMerge\n</code></pre>\n\n<p>Unmerging cells should take care of your problem.\nNeedless to say but all the lines above should come before copyying the data.</p>\n"}], "owner": {"reputation": 15, "user_id": 8412842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec8e724bc5e170a08368433cb3292922?s=128&d=identicon&r=PG&f=1", "display_name": "micmc", "link": "https://stackoverflow.com/users/8412842/micmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 49038250, "answer_count": 2, "score": 0, "last_activity_date": 1519855849, "creation_date": 1519849986, "last_edit_date": 1519850072, "question_id": 49038056, "link": "https://stackoverflow.com/questions/49038056/merging-cells-in-column-command-button-reset", "title": "Merging Cells in Column Command Button Reset", "body": "<p>I am new to vba and running into a problem. My code works so far when I click the command button for the first time. It gets data from one sheet and pastes it into the \"TEST\" sheet, sorts it from A-Z, and then merges the similar cells in column A. However, when I click the button again, the data changes because of the merged cells and the format messes up. I know I need some type of reset so when the button is clicked again, the code executes like clicking it for the first time. I'm not sure how to implement that and any feedback would be great. I highlighted the merge code section because I think that's where the reset may need to go</p>\n\n<pre><code>Sub Button1_Click() ' Update Button\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nDim lastRowPart As Long\nDim lastRowCW As Long\nDim lastRowQty As Long\nDim lastRowDescrip As Long\n\n'1. Copies and formats data\nlastRowPart = Sheets(\"Inventory Overview\").Range(\"F\" &amp; Rows.count).End(xlUp).Row\nlastRowDescrip = Sheets(\"Inventory Overview\").Range(\"G\" &amp; Rows.count).End(xlUp).Row\nlastRowQty = Sheets(\"Inventory Overview\").Range(\"I\" &amp; Rows.count).End(xlUp).Row\nlastRowCW = Sheets(\"Inventory Overview\").Range(\"L\" &amp; Rows.count).End(xlUp).Row\n\nSheets(\"TEST\").Range(\"A2:A\" &amp; lastRowCW).Value = Sheets(\"Inventory Overview\").Range(\"L2:L\" &amp; lastRowCW).Value\nSheets(\"TEST\").Range(\"B2:B\" &amp; lastRowPart).Value = Sheets(\"Inventory Overview\").Range(\"F2:F\" &amp; lastRowPart).Value\nSheets(\"TEST\").Range(\"C2:C\" &amp; lastRowQty).Value = Sheets(\"Inventory Overview\").Range(\"I2:I\" &amp; lastRowQty).Value\nSheets(\"TEST\").Range(\"D2:D\" &amp; lastRowDescrip).Value = Sheets(\"Inventory Overview\").Range(\"G2:G\" &amp; lastRowDescrip).Value\nSheets(\"TEST\").Range(\"A1:A\" &amp; lastRowCW).Columns.AutoFit      \nSheets(\"TEST\").Range(\"B1:B\" &amp; lastRowPart).Columns.AutoFit     \nSheets(\"TEST\").Range(\"C1:C\" &amp; lastRowQty).Columns.AutoFit     \nSheets(\"TEST\").Range(\"D1:D\" &amp; lastRowDescrip).Columns.AutoFit \n\n'2. Sort Cells\nDim sortSheet As Worksheet\nSet sortSheet = ThisWorkbook.Worksheets(\"TEST\")\nDim LastRow As Long\n\nLastRow = sortSheet.Cells(Rows.count, 4).End(xlUp).Row\n\nWith sortSheet.Sort  ' sorts data from A to Z\n .SetRange sortSheet.Range(\"A2:D\" &amp; LastRow)\n .Header = xlGuess\n .MatchCase = False\n .Orientation = xlTopToBottom\n .SortMethod = xlPinYin\n .Apply\nEnd With\n\n***'3. Merge CW Cells\n   Dim rngMerge As Range, cell As Range, lastRowMerge As Long\n   lastRowMerge = Range(\"A1\").End(xlDown).Row\n   Set rngMerge = Range(\"A1:A\" &amp; lastRowMerge)\n  MergeAgain:\n   For Each cell In rngMerge\n    If cell.Value = cell.Offset(1, 0).Value And IsEmpty(cell) = False Then\n        Range(cell, cell.Offset(1, 0)).Merge\n        GoTo MergeAgain\n    End If\nNext***\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 4, "creation_date": 1519850077, "post_id": 49038054, "comment_id": 85081317, "body": "You can&#39;t <code>Set</code> an <code>Integer</code> because that&#39;s not an object.  Remove the <code>Set</code> keyword."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1519850219, "post_id": 49038054, "comment_id": 85081386, "body": "also I believe <code>CashFlows.Cells(Z, StepCounter).Value</code> should be <code>CashFlows.range(&quot;Z&quot; &amp; StepCounter).Value</code> (unless <code>Z</code> is a variable with an integer value assigned elsewhere in your code)"}, {"owner": {"reputation": 3, "user_id": 9425686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kenneth Han", "link": "https://stackoverflow.com/users/9425686/kenneth-han"}, "edited": false, "score": 0, "creation_date": 1519850262, "post_id": 49038054, "comment_id": 85081413, "body": "Thanks! but I still get an object required error when I do that."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1519850337, "post_id": 49038054, "comment_id": 85081451, "body": "It would be helpful to state the line which errors."}, {"owner": {"reputation": 3, "user_id": 9425686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kenneth Han", "link": "https://stackoverflow.com/users/9425686/kenneth-han"}, "edited": false, "score": 0, "creation_date": 1519850403, "post_id": 49038054, "comment_id": 85081481, "body": "I can F8 until I get to :StepCounter = StepCounter + 1"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519852374, "post_id": 49038054, "comment_id": 85082526, "body": "&quot;I can F8 until I get to <code>StepCounter = StepCounter + 1</code>&quot; - only if you skip the line that <code>Set</code>-assigns an <code>Integer</code> value..."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519853489, "post_id": 49038221, "comment_id": 85083120, "body": "Why advocate the depreciated <code>While Wend</code>?  Really should be using <code>Do Loop</code>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519854250, "post_id": 49038221, "comment_id": 85083521, "body": "@chrisneilsen  Thank you chris..................I trust your judgement on this and will avoid <code>While</code> in the future."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1519851513, "last_edit_date": 1519851513, "creation_date": 1519850683, "answer_id": 49038221, "question_id": 49038054, "link": "https://stackoverflow.com/questions/49038054/macro-step-counter/49038221#49038221", "title": "Macro step counter", "body": "<p>You need a <strong>loop</strong>:</p>\n\n<p>Consider:</p>\n\n<pre><code>Sub Breakeven()\n    Dim Total As Long\n    Dim StepCounter As Integer\n    Dim CashFlows As Worksheet\n    Set CashFlows = ActiveSheet\n\n\n    Total = Range(\"z13\").Value\n    StepCounter = 14\n\n    While Total &lt; 0\n            Total = Total + CashFlows.Cells(StepCounter, \"Z\").Value\n            StepCounter = StepCounter + 1\n    Wend\n    MsgBox \"The breakeven is \" &amp; Total\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTES:</strong></p>\n\n<ol>\n<li>we defined a <code>worksheet</code> object and <code>Set</code> it</li>\n<li>we created a <code>While</code> loop <em>(because <code>IF</code> will not loop by itself)</em></li>\n<li>we reversed the arguments in <code>Cells()</code></li>\n<li>we replaced the variable <code>Z</code> with the string constant</li>\n<li>we removed the <code>Set</code> for <code>StepCounter</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1519853284, "creation_date": 1519853284, "answer_id": 49038867, "question_id": 49038054, "link": "https://stackoverflow.com/questions/49038054/macro-step-counter/49038867#49038867", "title": "Macro step counter", "body": "<p>You can <em>collapse</em> the code to this:</p>\n\n<pre><code>Sub Main()\n    Dim StepCounter As Long\n\n    Do\n        StepCounter  = StepCounter + 1\n    Loop While WorkSheetFunction.Sum(Range(\"Z13\").Resize(StepCounter) ) &lt; 0\n    MsgBox \"The breakeven is \" &amp; WorkSheetFunction.Sum(Range(\"Z13\").Resize(StepCounter) )\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9425686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kenneth Han", "link": "https://stackoverflow.com/users/9425686/kenneth-han"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 49038221, "answer_count": 2, "score": 0, "last_activity_date": 1519853284, "creation_date": 1519849978, "last_edit_date": 1519850099, "question_id": 49038054, "link": "https://stackoverflow.com/questions/49038054/macro-step-counter", "title": "Macro step counter", "body": "<p>I am trying to do a simple VBA step counter that sums up a column until the column adds up to a positive number. Essentially these are cash flows that calculate when the cash becomes break even. I am simply trying to add the cells starting from Z13 until the Total becomes a positive number(the first year of cashflows are negative). I am getting an </p>\n\n<blockquote>\n  <p>\"Object required\"</p>\n</blockquote>\n\n<p>error when I run this code: </p>\n\n<pre><code>Sub Breakeven()\n\nDim Total As Long\nDim StepCounter As Integer\n\n\nTotal = Range(\"z13\").Value\nSet StepCounter = 14\n\nIf Total &lt; 0 Then\n\nTotal = Total + CashFlows.Cells(Z, StepCounter).Value\nStepCounter = StepCounter + 1\n\nEnd If\n\nMsgBox \"The breakeven is \" &amp; Total\n\nEnd Sub\n</code></pre>\n\n<p>Please help!</p>\n"}, {"tags": ["vba", "outlook", "addressbook"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1520006293, "post_id": 49037835, "comment_id": 85151168, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49061455/change-outlook-to-button-behaviour\">Change Outlook TO button behaviour</a>  <b><i>(Same O.P.)</i></b>"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519854414, "post_id": 49038000, "comment_id": 85083596, "body": "I only have access to Outlook and VBA. I have no admin privileges to install any &quot;extras&quot;. Appreciate anyway."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519854985, "post_id": 49038000, "comment_id": 85083845, "body": "You don&#39;t need admin privileges to install Redemption - it can install itself in HKCU when you register the dll with regsvr32.exe."}, {"owner": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519939762, "post_id": 49038000, "comment_id": 85122884, "body": "Ok. Didn&#39;t know that. Nevertheless it&#39;s not free right ?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519940038, "post_id": 49038000, "comment_id": 85123023, "body": "The free version shows a nag screen. The distributable version does not."}, {"owner": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519940651, "post_id": 49038000, "comment_id": 85123312, "body": "And still need admin privileges to register de DLL right ? :-("}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519941048, "post_id": 49038000, "comment_id": 85123472, "body": "No, regsvr32 &quot;full_path_to\\redemption.dll&quot; will be happy to install the dll in HKCU."}, {"owner": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519953247, "post_id": 49038000, "comment_id": 85127639, "body": "Ok. Thanks. I&#39;ll give it a try :-)"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1519849758, "creation_date": 1519849758, "answer_id": 49038000, "question_id": 49037835, "link": "https://stackoverflow.com/questions/49037835/how-to-open-contact-list-with-vba/49038000#49038000", "title": "How to open contact list with VBA", "body": "<p>You cannot do that in VBA - Outlook Object Model does not expose that functionality. </p>\n\n<p>In Extended MAPI (C++ or Delphi), use <a href=\"https://msdn.microsoft.com/en-us/library/cc839797%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">IAddrBook.SetDefaultDir</a> and set the <a href=\"https://blogs.msdn.microsoft.com/stephen_griffin/2010/09/13/you-chosewisely/\" rel=\"nofollow noreferrer\">PR_AB_CHOOSE_DIRECTORY_AUTOMATICALLY</a> property appropriately.</p>\n\n<p>If using <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> (any language) is an option, you can use the <a href=\"http://www.dimastr.com/redemption/rdoaddressbook.htm\" rel=\"nofollow noreferrer\">RDOAddressBook</a>.<code>DefaultAddressList</code> property:</p>\n\n<pre><code>set Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset AddrList = Session.AddressBook.AddressLists.Item(\"Contacts\")\nSession.AddressBook.DefaultAddressList = AddrList\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "edited": false, "score": 0, "creation_date": 1519939607, "post_id": 49040651, "comment_id": 85122808, "body": "Well ... Not yet but I&#39;m excited with the possibilities.. I want to do that but only when I&#39;m creating an email And I press the button &quot;TO&quot;. Does the &quot;TO&quot; Button have an event ? How can I use that function to replace that event ?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1519940392, "post_id": 49040651, "comment_id": 85123207, "body": "No, there is no way to modify the address book dialog shown when you click the To button. Namespace.GetSelectNamesDialog only works if it is your code showing the dialog."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 2, "last_activity_date": 1519862690, "creation_date": 1519862690, "answer_id": 49040651, "question_id": 49037835, "link": "https://stackoverflow.com/questions/49037835/how-to-open-contact-list-with-vba/49040651#49040651", "title": "How to open contact list with VBA", "body": "<p><em>Is this what your trying to do?</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim olDialog As SelectNamesDialog\n    Dim AL As AddressList\n\n    Set olDialog = Application.Session.GetSelectNamesDialog\n    Set AL = Application.GetNamespace(\"MAPI\").AddressLists(\"Contacts\")\n\n    Debug.Print AL.GetContactsFolder\n\n    With olDialog\n        .InitialAddressList = AL\n        .ShowOnlyInitialAddressList = True\n        .Display\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4377847, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001875240156/picture?type=large", "display_name": "Duarte Botelho", "link": "https://stackoverflow.com/users/4377847/duarte-botelho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "accepted_answer_id": 49038000, "answer_count": 2, "score": -1, "last_activity_date": 1592873112, "creation_date": 1519848971, "last_edit_date": 1592873112, "question_id": 49037835, "link": "https://stackoverflow.com/questions/49037835/how-to-open-contact-list-with-vba", "title": "How to open contact list with VBA", "body": "<p>How can I use VBA to do the same thing as <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>B</kbd>, Tools, Options, Custom and set a specific contact list as number one?</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1519848012, "post_id": 49037593, "comment_id": 85080227, "body": "what is the value of <code>FileOut</code> when the error appears?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9425492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5cd9278664278cdb2dbf973ef71459?s=128&d=identicon&r=PG&f=1", "display_name": "Jesedugal", "link": "https://stackoverflow.com/users/9425492/jesedugal"}, "edited": false, "score": 0, "creation_date": 1519853330, "post_id": 49038639, "comment_id": 85083053, "body": "Thanks for the point, I fixed earlier today another problem generated by the function Sort that I introduced today in the code.  The error I got at that time was:"}, {"owner": {"reputation": 36, "user_id": 9425684, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945475432146656/picture?type=large", "display_name": "Rodrigo Sassaki", "link": "https://stackoverflow.com/users/9425684/rodrigo-sassaki"}, "reply_to_user": {"reputation": 3, "user_id": 9425492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5cd9278664278cdb2dbf973ef71459?s=128&d=identicon&r=PG&f=1", "display_name": "Jesedugal", "link": "https://stackoverflow.com/users/9425492/jesedugal"}, "edited": false, "score": 0, "creation_date": 1519853980, "post_id": 49038639, "comment_id": 85083381, "body": "Hm, can&#39;t see the error message. Can you post again, please?  Did you check de fileOut string? Is it ok?"}, {"owner": {"reputation": 3, "user_id": 9425492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5cd9278664278cdb2dbf973ef71459?s=128&d=identicon&r=PG&f=1", "display_name": "Jesedugal", "link": "https://stackoverflow.com/users/9425492/jesedugal"}, "edited": false, "score": 0, "creation_date": 1519854758, "post_id": 49038639, "comment_id": 85083746, "body": "Thanks for the point, I fixed earlier today another problem generated by the function Sort that I introduced today in the code.  The error I got at that time was: <code>Excel found unreadable content in &#39;filename.xlsm&#39;. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.</code>  Then when I press yes, I got the message: <code>Removed Records: Sorting from &#47;xl&#47;worksheets&#47;sheet1.xml part</code>  I could fix this error just by adding the code          Sheet1.Sort.SortFields.Clear  file_OUT had the same problem.  I just fixed it.  THANKS A LOT!"}], "tags": [], "owner": {"reputation": 36, "user_id": 9425684, "user_type": "registered", "profile_image": "https://graph.facebook.com/1945475432146656/picture?type=large", "display_name": "Rodrigo Sassaki", "link": "https://stackoverflow.com/users/9425684/rodrigo-sassaki"}, "is_accepted": true, "score": 1, "last_activity_date": 1519852332, "creation_date": 1519852332, "answer_id": 49038639, "question_id": 49037593, "link": "https://stackoverflow.com/questions/49037593/run-time-error-1004-method-add-of-object-workbooks-failed/49038639#49038639", "title": "Run time error 1004 method &#39;add&#39; of object &#39;workbooks&#39; failed", "body": "<p>You probably have a problem with your fileOut string.\nThe \".Add\" receives only one parameter, which is a template file.\nIf it's failing, probably the parameter is incorrect (the file address could either be invalid or the file itself is not a template).</p>\n\n<p>Stop your code after assigning value to the fileOut string and check its value.</p>\n"}], "owner": {"reputation": 3, "user_id": 9425492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5cd9278664278cdb2dbf973ef71459?s=128&d=identicon&r=PG&f=1", "display_name": "Jesedugal", "link": "https://stackoverflow.com/users/9425492/jesedugal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1824, "favorite_count": 0, "accepted_answer_id": 49038639, "answer_count": 1, "score": 0, "last_activity_date": 1519852332, "creation_date": 1519847919, "last_edit_date": 1519848065, "question_id": 49037593, "link": "https://stackoverflow.com/questions/49037593/run-time-error-1004-method-add-of-object-workbooks-failed", "title": "Run time error 1004 method &#39;add&#39; of object &#39;workbooks&#39; failed", "body": "<p>I am writting a code for a stock register for input and output records.  I just finished after few days, and everytime I tested it it was working perfectly.  But, today after I finished the complete code, I had a problem just trying to open a file .xlsm to do register a modification.</p>\n\n<p>Error message:</p>\n\n<blockquote>\n  <p>run time error 1004 Method 'add' of object 'Workbooks' failed</p>\n</blockquote>\n\n<p>Here you have the subroutine where excel is showing me the error message.\nIn essence the highlighted line to debug is <code>Set book = app.Workbooks.Add(FileOUT)</code></p>\n\n<pre><code>    Sub Register_Deleted_Location(nData As Integer, DATA_ARRAY As Variant, User As String, PATH_HISTORY As String, HISTORY_FILE As String, TAB_HISTORY As String, RegError As Boolean)\n'\n    'Getting the number of columns for the data in the file\n    Call Definition_Columns\n    '\n    RegError = False\n    '\n    'Open HISTROY_FILE\n    Dim app As New Excel.Application\n    Dim book As Excel.Workbook\n    Dim FileOUT As String, PathOUT As String, TAB_OUT As String\n    '\n    app.Visible = False 'Visible is False by default, so this isn't necessary\n    '\n    FileOUT = PATH_HISTORY &amp; \"\\\" &amp; HISTORY_FILE\n    '\n    If (Not FileExists(FileOUT)) Then\n        MsgBox (\"File does not exist in the Path\" &amp; vbNewLine &amp; vbNewLine &amp; FileOUT &amp; vbNewLine &amp; vbNewLine &amp; \"Please contact your BSO.\")\n        RegError = True\n        GoTo End_Reg_Del\n    End If\n    If (FileLocked(FileOUT)) Then\n        MsgBox (\"File is locked, it is probably that another user is updating it, please try again in few seconds.\" &amp; vbNewLine &amp; vbNewLine &amp; FileOUT &amp; vbNewLine &amp; vbNewLine &amp; \"If the problem persists, please contact your BSO\")\n        RegError = True\n        GoTo End_Reg_Del\n    End If\n\n    Set book = app.Workbooks.Add(FileOUT)\n    '\n    TAB_OUT = TAB_HISTORY\n    '\n    'Unprotect sheet in HISTROY_FILE\n    book.Sheets(TAB_OUT).Unprotect\n    '\n    'Looking for the first empty row in order to add the new register\n    FER = First_Empty_Row_InColumn(book, TAB_OUT, \"A\", First_Row_For_Registers, 10000)\n    '\n    'Update information in HISTROY_FILE\n    For i = 1 To nData\n        book.Sheets(TAB_OUT).Cells(FER, i).Value = DATA_ARRAY(i)\n    Next i\n    '\n    'Register the Date/Time/User Deleted\n    book.Sheets(TAB_OUT).Cells(FER, Col_DTD).Value = Format(Now(), \"DD/MM/YYYY\")\n    book.Sheets(TAB_OUT).Cells(FER, Col_TID).Value = Format(Now(), \"HH:MM:SS\")\n    book.Sheets(TAB_OUT).Cells(FER, Col_USD).Value = User\n    '\n    'Fixing the problem with the date after copy the date from another file\n    book.Sheets(TAB_OUT).Cells(FER, Col_DTC).NumberFormat = \"DD/MM/YYYY\"\n    'book.Sheets(TAB_OUT).Cells(FER, Col_TIC).NumberFormat = \"HH:MM:SS\"\n    book.Sheets(TAB_OUT).Cells(FER, Col_DTM).NumberFormat = \"DD/MM/YYYY\"\n    'book.Sheets(TAB_OUT).Cells(FER, Col_TIM).NumberFormat = \"HH:MM:SS\"\n    '\n    'Update Date/Time of the last modification in HISTORY_FILE\n    book.Sheets(TAB_OUT).Cells(Row_DT_File, Col_DT_File).Value = Format(Now(), \"DD/MM/YYYY\") &amp; \"  \" &amp; Format(Now(), \"HH:MM:SS\")\n    '\n    Call Sorting_File(book, TAB_OUT, \"AX\", \"AY\")\n    '\n    'Protect sheet in STOCK OUT file\n    book.Sheets(TAB_OUT).Protect\n    '\n    'Save and close STOCK OUT File\n    app.DisplayAlerts = False\n    book.SaveAs Filename:=FileOUT, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n    app.DisplayAlerts = True\n    book.Close SaveChanges:=True\n    app.Quit\n    '\nEnd_Reg_Del:\nEnd Sub\n</code></pre>\n\n<p>Could somebody help me to understand this error and how to fix it?.\nI spent the wholde day trying to find an answer by google it, but nothing helps at this moment.</p>\n\n<p>I would appreciate any tip.</p>\n\n<p>Best regards,</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1519850311, "post_id": 49037542, "comment_id": 85081439, "body": "You can use <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">VBA Extensibility</a> to modify VBA code in Excel workbook."}, {"owner": {"reputation": 1, "user_id": 9425426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194eaafe08c763dcb5de579a9e8540e4?s=128&d=identicon&r=PG&f=1", "display_name": "Dashnir", "link": "https://stackoverflow.com/users/9425426/dashnir"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519910956, "post_id": 49037542, "comment_id": 85105824, "body": "@chrisneilsen This is exactly what I needed to get this moving. Thanks for the tip!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9425426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194eaafe08c763dcb5de579a9e8540e4?s=128&d=identicon&r=PG&f=1", "display_name": "Dashnir", "link": "https://stackoverflow.com/users/9425426/dashnir"}, "is_accepted": true, "score": 0, "last_activity_date": 1519918588, "creation_date": 1519918588, "answer_id": 49053249, "question_id": 49037542, "link": "https://stackoverflow.com/questions/49037542/export-a-vba-module-from-an-access-project-to-an-excel-project-using-vba/49053249#49053249", "title": "Export a VBA module from an Access project to an Excel project using VBA", "body": "<p>Thanks to the link provided by in the comment @chrisneilsen I have come up with a solution that accomplishes what we have set out to do. The solution is to create a module that is blank in the excel project and then import the VBE lines located in the access module to this new excel module as a string. </p>\n\n<p>Here's a snippet of the code in case anyone else runs into this:</p>\n\n<pre><code>Dim vbProj As VBIDE.VBProject\nDim VBComp As VBIDE.VBComponent\nDim codemod As VBIDE.CodeModule\n\nPublic Function InsertVADER(strTargetPath As String, ProgramType As String, strRunFunction As String) As Boolean\nif programtype = \"Excel\" then\n    '//Run Excel routine. This version is slightly more complex as the module cannot be transfered from Access to excel as a singluar object\n\n    '//Create an instance of an Excel application object\n    Set appExcel = CreateObject(\"Excel.Application\")\n\n    '//Open the target workbook\n    appExcel.workbooks.Open (strTargetPath)\n    appExcel.Visible = True\n\n    '//If there is an on load item for excel then it will need\n    Set vbProj = appExcel.ActiveWorkbook.VBProject\n\nRetryEX:        '//If the project is locked you will exit the error capture here for excel\n\n\n    Debug.Print appExcel.VBE.VBProjects(1).VBComponents.Count\n\n    '//Add modules to the excel project\n    Set VBComp = vbProj.VBComponents.Add(vbext_ct_StdModule)\n        VBComp.Name = \"VADER_TMP\"\n\n    Set VBComp = vbProj.VBComponents(\"VADER_TMP\")\n    Set codemod = VBComp.CodeModule\n\n    '//Capture the code in the VADER modules located in this project\n    Dim strVADER As String\n\n    LoopCount = 1\n    lngLineCount = 1\n    Do Until lngLineCount &gt; Application.VBE.VBProjects(1).VBComponents(\"VADER\").CodeModule.CountOfLines\n        strVADER = strVADER &amp; Application.VBE.VBProjects(1).VBComponents(\"VADER\").CodeModule.Lines(lngLineCount, 1) &amp; vbNewLine\n\n        lngLineCount = lngLineCount + 1\n    Loop\n\n    '//Insert the captured VADER code into the Excel module\n    codemod.InsertLines 1, strVADER\n\n    '//Do the same thing with runVADER\n    Set VBComp = vbProj.VBComponents.Add(vbext_ct_StdModule)\n        VBComp.Name = \"runVADER_TMP\"\n\n    Set VBComp = vbProj.VBComponents(\"runVADER_TMP\")\n    Set codemod = VBComp.CodeModule\n\n    strVADER = vbNullString\n    LoopCount = 1\n    lngLineCount = 1\n    Do Until lngLineCount &gt; Application.VBE.VBProjects(1).VBComponents(\"runVADER\").CodeModule.CountOfLines\n        strVADER = strVADER &amp; Application.VBE.VBProjects(1).VBComponents(\"runVADER\").CodeModule.Lines(lngLineCount, 1) &amp; vbNewLine\n\n        lngLineCount = lngLineCount + 1\n    Loop\n\n    codemod.InsertLines 1, strVADER\n\n    '//Call the function\n    appExcel.Run strRunFunction\n\nEnd If\n\n\n'//Indicate function sucess\nInsertVADER = True\n\nExit Function   'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\nerrjordan:\n\n'//Captured error\n\nIf Err.Number = 2501 Then\n    '//An access project locked for viewing\n    MsgBox \"Project cannot be locked for viewing. Please unlock the project and then press OK.\"\n    Err.Clear\n    Resume Next\n\nElseIf Err.Number = 50289 Then\n    '//An excel document locked for viewing\n    MsgBox \"Workbook cannot be locked for viewing. Please unlock the project and then press OK.\"\n    Err.Clear\n    GoTo RetryEX\n\nElseIf Err.Number = 29045 Or Err.Number = 7866 Then\n    '//Not excel or access\n    MsgBox \"This file is not compatible with VADER. Please convert the project to a useable format before using this tool.\"\n    Err.Clear\nElse\n    '//Some other error!\n    Err.Raise Err.Number\nEnd If\n\nInsertVADER = False '//If I'm here pass a failure code\n\nEnd Function\n</code></pre>\n\n<p>Removal remains very similar to that of access:</p>\n\n<pre><code>Public Function RemoveVADER(strTargetPath As String, ProgramType As String)\n'//Remove VADER from the project\n    '//Target path is not used in the function but has been left in in case of future issues/expandability\n\nIf ProgramType = \"Access\" Then\n    Set vbcom = appAccess.VBE.ActiveVBProject.VBComponents\n    vbcom.Remove VBComponent:=vbcom.Item(\"VADER_TMP\")\n    vbcom.Remove VBComponent:=vbcom.Item(\"runVADER_TMP\")\n\n    '//Close the target program and save changes\n    appAccess.Quit acQuitSaveAll\n\nElseIf ProgramType = \"Excel\" Then\n    Set vbProj = appExcel.ActiveWorkbook.VBProject\n    Set VBComp = vbProj.VBComponents(\"VADER_TMP\")\n    vbProj.VBComponents.Remove VBComp\n    Set VBComp = vbProj.VBComponents(\"runVADER_TMP\")\n    vbProj.VBComponents.Remove VBComp\n\n    '//Close the target program and save changes\n    appExcel.ActiveWorkbook.Save\n    appExcel.Quit\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9425426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194eaafe08c763dcb5de579a9e8540e4?s=128&d=identicon&r=PG&f=1", "display_name": "Dashnir", "link": "https://stackoverflow.com/users/9425426/dashnir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 49053249, "answer_count": 1, "score": 0, "last_activity_date": 1594637131, "creation_date": 1519847657, "last_edit_date": 1594637131, "question_id": 49037542, "link": "https://stackoverflow.com/questions/49037542/export-a-vba-module-from-an-access-project-to-an-excel-project-using-vba", "title": "Export a VBA module from an Access project to an Excel project using VBA", "body": "<p>I've been tasked with creating a VBA based system that will allow me to insert department specific documentation comment codes into a VBA based program and then later extract these later date.The program does this by temporarily inserting 2 VBA modules into the target project and then running the contained functions. This on it's own functions properly and the comments are inserted/extracted using VBA.</p>\n\n<p>However I find myself at a loss for inserting the modules into an excel based project from  my access based insertion project. I've been importing the module to the targeted access project using this function:</p>\n\n<pre><code>Public Function InsertVADER(strTestPath As String, ProgramType As String) As Boolean\n'//Insert VADER into the target program\nOn Error GoTo errjordan\n\nDim obj As AccessObject '//Create instance of Access Application object.\n\nIf ProgramType = \"Access\" Then\n\n\n    ''//Transfer Modules to target project.\n\n    For Each obj In CurrentProject.AllModules\n       DoCmd.TransferDatabase acExport, \"Microsoft Access\", strTestPath, acModule, obj.Name, obj.Name &amp; \"_TMP\", False\n    Next obj\n\n    '//Set and open target project\n    Set appAccess = CreateObject(\"Access.Application\")\n    appAccess.OpenCurrentDatabase strTestPath, False\n\n    '//SEt to visible. If the project has an auto exec that will usurp this project. You will\n    appAccess.Visible = True\n\n\n    '//Open the vader module. If there is an auto run macro this will cause it to show\n    appAccess.DoCmd.OpenModule (\"VADER_TMP\")\nElseIf ProgramType = \"Excel\" Then\n    '//Run Excel routine\n    For Each obj In CurrentProject.AllModules\n       'DoCmd.TransferDatabase acExport, \"Microsoft Excel\", strTestPath, acModule, obj.Name, obj.Name &amp; \"_TMP\", False\n\n    Next obj\n\n\n\n\n\nEnd If\n\n\n'//Indicate function sucess\nInsertVADER = True\n\nExit Function   'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\nerrjordan:\n\nIf Err.Number = 2501 Then\n    MsgBox \"Project cannot be locked for viewing. Please unlock and save project before using this tool\"\n    Err.Clear\n    InsertVADER = False\nElseIf Err.Number = 29045 Or Err.Number = 7866 Then\n    MsgBox \"This file is not compatible with VADER. Please convert the project to a useable format before using this tool.\"\n    Err.Clear\n    InsertVADER = False\nElse\n    Err.Raise Err.Number\nEnd If\n\n\nEnd Function\n</code></pre>\n\n<p>StrtestPath passes the file path of the target project and programtype specifies what kind of project I've selected. Both are set in an external project.</p>\n\n<p>Is there a VBA based solution that will allow me to: </p>\n\n<ol>\n<li>Import the modules defined by the CurrentProject.allModules into the targeted Excel project from access\n\n<ol start=\"2\">\n<li>Remove the modules from the target Excel Project once run</li>\n</ol></li>\n</ol>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1519848055, "post_id": 49037500, "comment_id": 85080246, "body": "are these each at different grouping levels?"}, {"owner": {"reputation": 1, "user_id": 9424297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joel impactor", "link": "https://stackoverflow.com/users/9424297/joel-impactor"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1519848520, "post_id": 49037500, "comment_id": 85080495, "body": "Not entirely sure what that means im stupid, the first is in &#39;detail&#39;, the second is &#39;orderID footer&#39; and the third is in &#39;page footer&#39; so i assume so"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1519848727, "post_id": 49037500, "comment_id": 85080592, "body": "If you have a  &#39;orderID footer&#39; , this means that you added a report group and those can be nested, i.e. have different levels."}, {"owner": {"reputation": 1, "user_id": 9424297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joel impactor", "link": "https://stackoverflow.com/users/9424297/joel-impactor"}, "edited": false, "score": 0, "creation_date": 1519849964, "post_id": 49037500, "comment_id": 85081263, "body": "How would i do that?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9424297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joel impactor", "link": "https://stackoverflow.com/users/9424297/joel-impactor"}, "edited": false, "score": 0, "creation_date": 1519986239, "post_id": 49037646, "comment_id": 85139342, "body": "But i already have one as =Sum([Price]*[Quantity]) i need another thats the sum of that"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 1, "user_id": 9424297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joel impactor", "link": "https://stackoverflow.com/users/9424297/joel-impactor"}, "edited": false, "score": 0, "creation_date": 1519998659, "post_id": 49037646, "comment_id": 85146057, "body": "If you have <code>=Sum([Price]*[Quantity])</code> on the report footer, it will automatically sum up the whole report. There is no need to make the sum of the sum because it is not any different from the simple sum of the whole."}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 2, "last_activity_date": 1520194783, "last_edit_date": 1520194783, "creation_date": 1519848106, "answer_id": 49037646, "question_id": 49037500, "link": "https://stackoverflow.com/questions/49037500/how-to-do-sum-of-a-sum-in-access-report/49037646#49037646", "title": "How to do sum of a sum in access report?", "body": "<p>You don't need to do that. Create nested group headers and footers and place the text boxes in the group headers or footers. Regardless of the nesting level, you can always use</p>\n\n<pre><code>=Sum([Price]*[Quantity])\n</code></pre>\n\n<p>as control source of the text box. Access knows what to sum up. The same works for the page footer as well.</p>\n\n<p>Note that you don't have to make a sum of sums because</p>\n\n<pre><code>sum( sum(a, b, c), sum(d, e), sum(f, g, h, i) ) = sum(a, b, c, d, e, f, g, h, i)\n</code></pre>\n\n<p>i.e., the sum in a higher level group or in the report footer does not make a sum of sums, instead, it makes a sum of all involved items of all lower level groups.</p>\n"}], "owner": {"reputation": 1, "user_id": 9424297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "joel impactor", "link": "https://stackoverflow.com/users/9424297/joel-impactor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520194783, "creation_date": 1519847516, "question_id": 49037500, "link": "https://stackoverflow.com/questions/49037500/how-to-do-sum-of-a-sum-in-access-report", "title": "How to do sum of a sum in access report?", "body": "<p>I have one textbox as </p>\n\n<pre><code>    =[Price]*[Quantity]\n</code></pre>\n\n<p>and another as </p>\n\n<pre><code>    =Sum([Price]*[Quantity])\n</code></pre>\n\n<p>i need a third as </p>\n\n<pre><code>    =Sum(Sum([Price]*[Quantity]))\n</code></pre>\n\n<p>But i cant do the third as I cant do a sum of a sum, how can i work around this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1519846730, "post_id": 49037215, "comment_id": 85079595, "body": "<code>CallByName newRel, &quot;defect&quot;, VbLet, curr</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519869132, "post_id": 49037215, "comment_id": 85088139, "body": "BTW in your first loop can you not <code>Exit For</code> as soon as you get bool = True?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9425365, "user_type": "registered", "profile_image": "https://graph.facebook.com/2020412264641229/picture?type=large", "display_name": "Nick Thalken", "link": "https://stackoverflow.com/users/9425365/nick-thalken"}, "edited": false, "score": 0, "creation_date": 1519853581, "post_id": 49037343, "comment_id": 85083155, "body": "I keep getting a type mismatch error even after changing my line of code to CallByName newRel, &quot;defect&quot;, VbLet, curr"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519869256, "post_id": 49037343, "comment_id": 85088184, "body": "Note: If <code>curr</code> (or the return type of another property) is an object type you&#39;d need to use <code>vbSet</code> in place of <code>vbLet</code>"}, {"owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 0, "creation_date": 1519889506, "post_id": 49037343, "comment_id": 85093974, "body": "If you have a type related error, you should post the declarations for <code>curr</code> and <code>defect</code>. (Btw, you pass <code>newRel</code> ByRef and then use it as loop variable (twice) which looks very odd...)"}], "tags": [], "owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "is_accepted": false, "score": 3, "last_activity_date": 1519846835, "creation_date": 1519846835, "answer_id": 49037343, "question_id": 49037215, "link": "https://stackoverflow.com/questions/49037215/callbyname-for-collection-of-created-class/49037343#49037343", "title": "CallByName for collection of created class", "body": "<p>You can use </p>\n\n<pre><code>CallByName(newRel, \"defect\", VbGet)\n</code></pre>\n\n<p>to get the value, but you can obviously not use this as an LValue (ie assign something to it).</p>\n\n<p>Try</p>\n\n<pre><code>CallByName newRel, \"defect\", VbLet, curr\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9425365, "user_type": "registered", "profile_image": "https://graph.facebook.com/2020412264641229/picture?type=large", "display_name": "Nick Thalken", "link": "https://stackoverflow.com/users/9425365/nick-thalken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519846835, "creation_date": 1519846263, "last_edit_date": 1531164843, "question_id": 49037215, "link": "https://stackoverflow.com/questions/49037215/callbyname-for-collection-of-created-class", "title": "CallByName for collection of created class", "body": "<p>So I have created the code below which is a function that takes in two different variables of the CReliability class (self made class in a class module). It also takes in two different collections that each are apart of. This function is designed to assign all unique items within each property of the rawRel variable (CReliability type) to the newRel variable (CReliability Type) within the newCol (Collection) and also count how many times each unique item occurs for each property. I would like to expand this idea so that I can implement this function for any property I would like to access, get unique items, and count. I am having issue using the VBA function CallByName to do this however. The line I am having issue with is only:</p>\n\n<pre><code>newRel.defect = curr 'This works but is not desired since it is a specific property\nCallByName(newRel, \"defect\", VbGet) = curr 'This does not work and I want to work so I can use any property\n</code></pre>\n\n<p>which is apart of the entire function:</p>\n\n<pre><code>Sub uniqueArr(ByRef newRel, ByRef rawRel, ByRef relCol, ByRef newCol, property As String)\nFor Each rawRel In relCol\ncurr = CallByName(rawRel, \"defect\", VbGet)\nbool = False\nFor Each newRel In newCol\n    If CallByName(newRel, \"defect\", VbGet) = curr Then\n        bool = True\n    End If\nNext\nIf Not bool Then\n    Set newRel = New CReliability\n    newRel.defect = curr 'This works but is not desired since it is a specific property\n    CallByName(newRel, \"defect\", VbGet) = curr 'This does not work and I want to work so I can use any property\n    newCol.Add newRel\nEnd If\nNext\nFor Each newRel In newCol\n    If newRel.defect = rawRel.defect Then\n        newRel.defectCount = newRel.defectCount + 1\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>If anyone could help me understand why the CallByName function does not work in this instance that would be great. I can also post the CReliability class code if that's useful.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519848005, "post_id": 49037188, "comment_id": 85080223, "body": "QHarr Yes, the last modified file as long as it&#39;s a .csv"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1519850454, "post_id": 49038026, "comment_id": 85081514, "body": "What does Compile error &quot;user-defined type not defined&quot; mean?"}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1519856363, "post_id": 49038026, "comment_id": 85084449, "body": "I&#39;m still getting a path not found error when I run the code. I&#39;m also not sure where I tell the code to pull the file from my Z: drive. I&#39;m sorry for being slow, I&#39;m still learning. Thank you for your time and help QHarr!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1519856708, "post_id": 49038026, "comment_id": 85084579, "body": "that&#39;s not a problem. so we have clered the initial error.  Now you should have replaced this  Const folderPath As String = &quot;C:\\Users\\User\\Desktop\\Test&quot; with  Const folderPath As String = &quot;yourfolderpath\\yourfolder&quot; to get to the folder containing the CSVs you are working with. Are you using a Windows machine btw as process is slightly different for mac. Don&#39;t be afraid to ask questions though tomorrow will now be the response timeframe."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1519858561, "post_id": 49038026, "comment_id": 85085385, "body": "Thanks. Take your time. I replaced &quot;yourfolderpath\\yourfolder&quot; with &quot;Z:/&quot; At this point the code runs properly but the only thing that happens is an empty message box pops up."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1519928153, "post_id": 49038026, "comment_id": 85116863, "body": "No I&#39;m using Windows on a PC. But I just copy the destination of my folder from the file explorer destination bar. and it gives me Z:\\"}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1519930082, "post_id": 49038026, "comment_id": 85117871, "body": "You&#39;re right my b. At this point I don&#39;t get any errors. The macro runs and a blank msg box pops up but no files open."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520005136, "post_id": 49038026, "comment_id": 85150441, "body": "No, I really appreciate all your time and help trying to figure this out. I&#39;m using the latest version of windows and excel. Version two opens the Windows explorer where I select my Z drive to open. But none of the files show up in the drive. The msg box is still empty."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520005262, "post_id": 49038026, "comment_id": 85150521, "body": "If I could attach screenshots I would... I feel like we are close to the solution but it&#39;s not recognizing .czv files when it looks for files to open."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520005900, "post_id": 49038026, "comment_id": 85150909, "body": "The longer route is to use the Dir function to produce the files in a loop and check for csv. I am guessing it makes no difference if you put .csv? It should be csv though. Did you try the loop I suggested of  putting debug.print currentFile.Name    as a line above For Each currentFile In myFolder.Files ....and then looking in the immediate windows (Ctrl &amp; G) to see if any files being processed by fso?"}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520022078, "post_id": 49038026, "comment_id": 85159340, "body": "Cool okay so now the message box displays the name of the file that I want to open but it does not open. Any suggestions?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520025862, "post_id": 49038026, "comment_id": 85161135, "body": "Why does it now display? Have you changed something? I didn&#39;t add the code for open sorry as I was just getting you the file! Is it my code as written above that is currently working? If so, I will add the open code."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520361295, "post_id": 49038026, "comment_id": 85280565, "body": "Hey sorry I was out sick yesterday and I have been playing catchup most of today. I added the open code and now when I try to run it says &#39;excel cannot find Z:\\&quot; Its in the same place as always tho so I don&#39;t know why excel cant find it."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520361384, "post_id": 49038026, "comment_id": 85280597, "body": "Debugging highlights the Workbooks.Open code I just imported"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520367945, "post_id": 49038026, "comment_id": 85283958, "body": "Is this a shared network drive? <a href=\"https://social.technet.microsoft.com/Forums/ie/en-US/db9d5bd8-2d30-432f-95cf-5c11bf95dd18/cant-open-word-or-excel-documents-on-mapped-network-drive-using-office-2013?forum=officeitpro\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/Forums/ie/en-US/&hellip;</a>"}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520368162, "post_id": 49038026, "comment_id": 85284079, "body": "Yes. Is that a problem?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520368294, "post_id": 49038026, "comment_id": 85284153, "body": "that is why my code, which is correct, is having problems for you! Mystery likely solved. This issue is discussed in the link i posted but may not be straightforward to resolve. Is this an issue you have an IT department that could look at? You could give them the link I mentioned?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520368365, "post_id": 49038026, "comment_id": 85284189, "body": "It discussed two things in particular: Allowed Trusted Locations on my network is checked  and Deleting and remapping the drive."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520441459, "post_id": 49038026, "comment_id": 85319192, "body": "My I.T. dept. doesn&#39;t know jack so I&#39;m ditching the automatic selection portion of this macro and switching to a manual selection. Where once you run the macro, a popup prompts you to select the file manually. The entire process involves opening a document, preforming simple formatting changes to the data, then saving and renaming the file. I had hopped the create a macro that automated all of this but it doesn&#39;t look possible for the macro to select the correct file reliably."}, {"owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520441581, "post_id": 49038026, "comment_id": 85319263, "body": "Do you foresee any problems with the code saving the updated file in my shared Z drive? In other words, will the code allow me to save in a shared drive or will it sketch out because of the shared file."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "edited": false, "score": 0, "creation_date": 1520448732, "post_id": 49038026, "comment_id": 85323555, "body": "it is difficult for me to say but it could be  related to this trusted location point. It might something you can do yourself same as with a drive re-map. If you run the code and select something from your desktop folder or local folder does it work fine?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1520253086, "last_edit_date": 1520253086, "creation_date": 1519849885, "answer_id": 49038026, "question_id": 49037188, "link": "https://stackoverflow.com/questions/49037188/open-most-recent-csv-file-in-a-folder/49038026#49038026", "title": "Open most recent .csv file in a folder", "body": "<p>Here you go. Version 1 I have simply used a msgbox to display the last modified csv in the folder. Version 2 opens the file and uses filedialog due to OP difficulties with file path from fso.GetFolder.</p>\n\n<p>Add reference to <a href=\"https://stackoverflow.com/questions/3233203/how-do-i-use-filesystemobject-in-vba\">MS Scripting runtime</a> (tool > references ) then</p>\n\n<pre><code>Sub GetLastModifiedCSV()\n\n   'Early binding code. Requires reference to MS Scripting Runtime\n    Dim fso As Scripting.FileSystemObject     \n    Set fso = New Scripting.FileSystemObject\n\n   'Late binding code. To be used instead of two lines above if \"user-defined type not defined\" /No reference added. You would uncomment line below.\n\n  'Dim fso As Object: Set fso = CreateObject(\"Scripting.FileSystemObject\") \n\n    Dim myFolder As Object\n\n    Set myFolder = fso.GetFolder(\"C:\\Users\\User\\Desktop\\Test\")\n\n    Dim currentFile As Object\n    Dim maxFileName As String\n    Dim maxDate As Date\n\n    For Each currentFile In myFolder.Files\n\n        If fso.GetExtensionName(currentFile) = \"csv\" Then\n\n            If currentFile.DateLastModified &gt; maxDate Then\n                 maxDate = currentFile.DateLastModified\n                 maxFileName = currentFile.Name\n            End If\n\n        End If\n\n    Next currentFile\n\n   Msgbox maxFileName\n\nEnd Sub\n</code></pre>\n\n<p>Additional references:</p>\n\n<p>1) <a href=\"https://stackoverflow.com/questions/6427081/how-to-get-the-last-modified-file-in-a-directory-using-vba-in-excel-2010\">How to get the last modified file in a directory using VBA in Excel 2010</a></p>\n\n<p>2) <a href=\"https://stackoverflow.com/questions/38354947/using-vba-filesystemobject-specific-file-file-extension\">Using VBA FileSystemObject, specific file File extension</a></p>\n\n<p>3) <a href=\"https://www.exceltrick.com/formulas_macros/filesystemobject-in-vba/\" rel=\"nofollow noreferrer\">File system object explained</a></p>\n\n<p>4) <a href=\"https://wellsr.com/vba/2016/excel/vba-select-folder-with-msoFileDialogFolderPicker/\" rel=\"nofollow noreferrer\">msoFileDialogFolderPicker</a></p>\n\n<p><strong>Version 2 Using FileDialog to get folderpath for GetFolder:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetLastModifiedCSV()\n\n    Const folderPath As String = \"C:\\Users\\User\\Desktop\\Test\"\n\n   'Early binding code. Requires reference to MS Scripting Runtime\n    Dim fso As FileSystemObject\n    Set fso = New FileSystemObject\n\n   'Late binding code. To be used instead of two lines above if \"user-defined type not defined\" /No reference added. You would uncomment line below.\n\n  'Dim fso As Object: Set fso = CreateObject(\"FileSystemObject\")\n\n    Dim myFolder As Object\n    Dim currentFile As Object\n    Dim maxFileName As String\n    Dim maxDate As Date\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n\n    If .Show Then\n      Set myFolder = fso.GetFolder(.SelectedItems(1))  ' &amp; \"\\\" \n    Else\n        Exit Sub\n    End If\n\n    End With\n\n    For Each currentFile In myFolder.Files\n\n        If fso.GetExtensionName(currentFile) = \"csv\" Then\n\n            If currentFile.DateLastModified &gt; maxDate Then\n                 maxDate = currentFile.DateLastModified\n                 maxFileName = currentFile.Name\n            End If\n\n        End If\n\n    Next currentFile\n\n    'MsgBox maxFileName\n\n    Workbooks.Open fso.BuildPath(myFolder, maxFileName) \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9392450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46cee9edbc25657a3d4bb7e26abad159?s=128&d=identicon&r=PG&f=1", "display_name": "The Dude MAN", "link": "https://stackoverflow.com/users/9392450/the-dude-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 49038026, "answer_count": 1, "score": 0, "last_activity_date": 1520253086, "creation_date": 1519846160, "last_edit_date": 1519846505, "question_id": 49037188, "link": "https://stackoverflow.com/questions/49037188/open-most-recent-csv-file-in-a-folder", "title": "Open most recent .csv file in a folder", "body": "<p>I'm pretty new to VBA but I am trying to learn a lot more. Right now I'm trying to code a macro to open the most recent file in my :Z drive that is a comma delimited file (.CSV). The below code doesn't work but I was wondering if anyone had any advice? \nthanks for you help! </p>\n\n<pre><code>Sub NewestFile()\nDim MyPath As String\nDim MyFile As String\nDim LatestFile As String\nDim LatestDate As Date\nDim LMD As Date\n\nMyPath = \"Z:\\\"\nIf Right(MyPath, 1) &lt;&gt; \u201c \\ \u201d Then MyPath = MyPath &amp; \u201c \\ \u201d\n  MyFile = Dir(MyPath &amp; \u201c * .csv\u201d, vbNormal)\n  If Len(MyFile) = 0 Then\n    MsgBox \u201cNo files were found\u2026\u201d, vbExclamation\n    Exit Sub\n  End If\n  Do While Len(MyFile) &gt; 0\n    LMD = FileDateTime(MyPath &amp; MyFile)\n    If LMD &gt; LatestDate Then\n      LatestFile = MyFile\n      LatestDate = LMD\n    End If\n    MyFile = Dir\n  Loop\n  Workbooks.Open MyPath &amp; LatestFile\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519847748, "post_id": 49036829, "comment_id": 85080075, "body": "I cannot follow your logic... But have you tried looking into the <code>TRANSPOSE</code> function?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519849105, "post_id": 49036829, "comment_id": 85080806, "body": "So you are copying a smaller and smaller subset of the original data? Until you are down to a single column?"}, {"owner": {"reputation": 11, "user_id": 9425215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "newtoVBA", "link": "https://stackoverflow.com/users/9425215/newtovba"}, "edited": false, "score": 0, "creation_date": 1519849812, "post_id": 49036829, "comment_id": 85081189, "body": "yes. each time just copy one column to the right."}, {"owner": {"reputation": 11, "user_id": 9425215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "newtoVBA", "link": "https://stackoverflow.com/users/9425215/newtovba"}, "edited": false, "score": 0, "creation_date": 1519849956, "post_id": 49036829, "comment_id": 85081258, "body": "Sorry I mean I want to do a loop, start with cell J6, copy a range of 100 rows and 16 columns. And transpose and paste at sheet 2 (B1:CW16). Then start with cell K6, copy another range of 100 rows and 16 columns and transpose and paste at sheet 2(B19:CW34). Then start with cell L6 (another 100 rows and 16 columns)....... I searched online and have the following code:"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519850256, "post_id": 49036829, "comment_id": 85081408, "body": "That&#39;s not the same as your original question. Please edit your question to accurately describe your problem."}, {"owner": {"reputation": 11, "user_id": 9425215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "newtoVBA", "link": "https://stackoverflow.com/users/9425215/newtovba"}, "edited": false, "score": 0, "creation_date": 1519851901, "post_id": 49036829, "comment_id": 85082257, "body": "I&#39;ve edited it."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519852283, "post_id": 49036829, "comment_id": 85082460, "body": "So you just want to paste it 3 times?"}, {"owner": {"reputation": 11, "user_id": 9425215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "newtoVBA", "link": "https://stackoverflow.com/users/9425215/newtovba"}, "edited": false, "score": 0, "creation_date": 1519852464, "post_id": 49036829, "comment_id": 85082573, "body": "for each range copied, I just want it to paste once at sheet 2"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519852499, "post_id": 49036829, "comment_id": 85082592, "body": "Yes but you want to repeat the process 3 times? J6, K6, L6?"}, {"owner": {"reputation": 11, "user_id": 9425215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "newtoVBA", "link": "https://stackoverflow.com/users/9425215/newtovba"}, "edited": false, "score": 0, "creation_date": 1519852596, "post_id": 49036829, "comment_id": 85082646, "body": "nope. J6,K6,L6 till DC6"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1519926954, "creation_date": 1519926954, "answer_id": 49055874, "question_id": 49036829, "link": "https://stackoverflow.com/questions/49036829/excel-loop-copy-a-range-in-sheet-1-and-paste-to-sheet-2/49055874#49055874", "title": "Excel loop copy a range in sheet 1 and paste to sheet 2", "body": "<p>Not the most elegant but this should help. I have tried to make the terms as descriptive as possible to help you understand what is going on at each stage.</p>\n\n<p>You can modify these to transpose different numbers of columns and rows from different ranges in the source sheet.</p>\n\n<p>Where to copy from:  <code>startCell</code> </p>\n\n<p>When to end copying from: <code>endCell</code></p>\n\n<p>Where to start pasting to: <code>targetStartCell</code> </p>\n\n<p>How much to transpose: <code>copyRowSize</code> , <code>copyColumnSize</code> </p>\n\n<p>Steps to govern next row destination for transpose: <code>rowStep</code></p>\n\n<pre><code>Option Explicit\n\nPublic Sub TransposeToOtherSheet()\n\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n    Dim ws As Worksheet\n    Set ws = wb.Worksheets(\"Sheet1\")             'change as appropriate\n\n    Const numberOfRows As Long = 105\n    Const numberOfColumns As Long = 120\n    Const copyRowSize As Long = 100\n    Const copyColumnSize As Long = 16\n    Const rowStep As Long = 18\n\n    Dim startCell As Range\n    Dim endCell As Range\n\n    Set startCell = ws.Range(\"J6\")\n    Set endCell = ws.Range(\"DY6\")\n\n    Dim targetSheet As Worksheet\n    Dim targetStartCell As Range\n    Dim targetRow As Long\n    Dim targetColumn As Long\n\n    Set targetSheet = wb.Worksheets(\"Sheet2\")   'change as appropriate\n    Set targetStartCell = targetSheet.Range(\"A1\")\n    targetRow = targetStartCell.Row\n    targetColumn = targetStartCell.Column\n\n    Dim currentColumn As Long\n    Dim headerRow As Long\n    headerRow = startCell.Row\n    Dim targetRowCounter As Long\n\n    For currentColumn = startCell.Column To endCell.Column\n\n        If targetRowCounter = 0 Then\n\n           targetStartCell.Resize(copyColumnSize, copyRowSize) = Application.WorksheetFunction.Transpose(ws.Cells(headerRow, currentColumn).Resize(copyRowSize, copyColumnSize))\n\n        Else\n\n         ' Debug.Print \"destination range \" &amp; targetSheet.Cells((targetRowCounter * rowStep) + targetRow, targetColumn).Resize(copyColumnSize, copyRowSize).Address\n          targetSheet.Cells((targetRowCounter * rowStep) + targetRow, targetColumn).Resize(copyColumnSize, copyRowSize) = Application.WorksheetFunction.Transpose(ws.Cells(headerRow, currentColumn).Resize(copyRowSize, copyColumnSize))\n\n        End If\n\n        targetRowCounter = targetRowCounter + 1\n\n    Next currentColumn\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9425215, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "newtoVBA", "link": "https://stackoverflow.com/users/9425215/newtovba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1519926954, "creation_date": 1519844841, "last_edit_date": 1519869212, "question_id": 49036829, "link": "https://stackoverflow.com/questions/49036829/excel-loop-copy-a-range-in-sheet-1-and-paste-to-sheet-2", "title": "Excel loop copy a range in sheet 1 and paste to sheet 2", "body": "<p>I'm not sure how the logic of loop works. \nI have a table at sheet 1 with 105 rows and 120 columns.\nI want to do a loop, start with cell J6, copy a range of 100 rows and 16 columns. And transpose and paste at sheet 2 (B1:CW16). Then start with cell K6, copy another range of 100 rows and 16 columns and transpose and paste at sheet 2(B19:CW34). Then start with cell L6 (another 100 rows and 16 columns)and paste at sheet 2. (paste at every 18 rows in sheet 2)</p>\n\n<p>I searched online and have the following code:</p>\n\n<pre><code>Sub transpose()\nDim ColNum As Long\nDim i as long\nFor ColNum = 10 To 108\n    LR = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n       Sheet1.Activate\n       Range((Cells(6, ColNum)), (Cells(105, ColNum + 15))).copy\n\n       'Transpose\n       Sheet2.Activate\n        For i = 1 To LR Step 18\n\n       Cells(i, 2).Select\n       Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, \nSkipBlanks:=False, transpose:=True\n   Next i\n  Next ColNum\nEnd Sub\n</code></pre>\n\n<p>This code does not give me what I want. this code copy a range in sheet 1 and paste multiple times in sheet 2 and then copy a second range in sheet 1 and replace everything in sheet 2. How do I modify the code so that I can copy the first range in sheet1, paste to sheet 2 range B1:CW16, then copy the second range in sheet1, and paste to sheet 2 range B19:CW34. (a step of 18 rows at sheet 2)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1519843938, "post_id": 49036555, "comment_id": 85078065, "body": "Should <code>marks</code> be the sum of the cells?  Or are you checking to see if each cell is <code>&gt;= 33</code> ?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1519843991, "post_id": 49036555, "comment_id": 85078100, "body": "range(&quot;B2:B7&quot;) doesn&#39;t return an integer, it returns a range."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1519844132, "post_id": 49036555, "comment_id": 85078181, "body": "I&#39;m also confused on why you need VBA for this.  This can be easily done with a formula.  Put this in cell C2 and copy down: <code>=IF(B2&gt;=33,&quot;pass&quot;,&quot;fail&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9425257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CIpgezgtn1U/AAAAAAAAAAI/AAAAAAAAAHo/koiKBJZ6arU/photo.jpg?sz=128", "display_name": "Deepak Raj", "link": "https://stackoverflow.com/users/9425257/deepak-raj"}, "edited": false, "score": 0, "creation_date": 1519906372, "post_id": 49036883, "comment_id": 85103084, "body": "yes thanks @sktneer"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1519845014, "creation_date": 1519845014, "answer_id": 49036883, "question_id": 49036555, "link": "https://stackoverflow.com/questions/49036555/whats-wrong-in-this-coding/49036883#49036883", "title": "whats wrong in this coding?", "body": "<p>Maybe you are trying to achieve this...</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Rng As Range, Cell As Range\nSet Rng = Range(\"B2:B7\")\nFor Each Cell In Rng\n    If Cell &gt;= 33 Then\n        Cell.Offset(0, 1) = \"Pass\"\n    Else\n        Cell.Offset(0, 1) = \"Fail\"\n    End If\nNext Cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9425257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CIpgezgtn1U/AAAAAAAAAAI/AAAAAAAAAHo/koiKBJZ6arU/photo.jpg?sz=128", "display_name": "Deepak Raj", "link": "https://stackoverflow.com/users/9425257/deepak-raj"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1519847338, "answer_count": 1, "score": -6, "last_activity_date": 1519845014, "creation_date": 1519843799, "question_id": 49036555, "link": "https://stackoverflow.com/questions/49036555/whats-wrong-in-this-coding", "closed_reason": "Not suitable for this site", "title": "whats wrong in this coding?", "body": "<p>Whats wrong in this coding ? it is working in single cell but not in multiple cells</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim marks As Integer, result As String\nmarks = range(\"B2:B7\")\nIf marks &gt;= 33 Then\nresult = \"pass\"\nElse\nresult = \"fail\"\nEnd If\nrange(\"C2:C7\").Value = result\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "barcode", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1519845769, "post_id": 49036488, "comment_id": 85079098, "body": "Just a note: but some people  have commented on other questions that using <code>.Value2</code> is usually more reliable than using <code>.Value</code>; because <code>.Value</code> sometimes gives unpredictable results."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1519845779, "post_id": 49036488, "comment_id": 85079104, "body": "Why are you using InputBox when you have a textbox set up to scan into?  The scan first enters &quot;R&quot;, which triggers the inputbox, which receives the rest of the characters: the terminating &quot;enter&quot; added by the scanner then triggers the entry to the sheet."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519888122, "post_id": 49036488, "comment_id": 85093377, "body": "@TimWilliams That is the actual answer to the question. Forget about the input box. And might as well abandon the use of  <code>Change</code> to <code>AfterUpdate</code> event especially for bar code scanners."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1519858157, "last_edit_date": 1519858157, "creation_date": 1519846064, "answer_id": 49037156, "question_id": 49036488, "link": "https://stackoverflow.com/questions/49036488/barcode-not-scanned-properly-in-inputbox-of-userform/49037156#49037156", "title": "Barcode not scanned properly in InputBox of UserForm", "body": "<p>In the Change event to need to look for \"enter\" at the end of the value, and act accordingly</p>\n\n<p>Untested:</p>\n\n<pre><code>Private Sub TextBoxRoom_Change()\n\n    RoomCode = TextBoxRoom.Text\n\n    If right(RoomCode, 1) = chr(10) Then\n        Cells(2, 13).Value = left(RoomCode, len(RoomCode)-1) '&lt; strip the chr(10)\n        Cells(2, 13).Interior.ColorIndex = 6\n        TextBoxShelf.SetFocus 'advances to next TextBox\n    End if\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> for any textbox you want to be able to scan a barcode to, you need to set these properties:</p>\n\n<ul>\n<li>EnterKeyBehavior: True</li>\n<li>Multiline:        True</li>\n</ul>\n\n<p>...in order to detect the terminating \"enter\" from the scanner</p>\n"}], "owner": {"reputation": 13, "user_id": 7086692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2840437188c4688b291ea5c7fdf499da?s=128&d=identicon&r=PG&f=1", "display_name": "MRomero", "link": "https://stackoverflow.com/users/7086692/mromero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1196, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543527228, "creation_date": 1519843515, "last_edit_date": 1543527228, "question_id": 49036488, "link": "https://stackoverflow.com/questions/49036488/barcode-not-scanned-properly-in-inputbox-of-userform", "title": "Barcode not scanned properly in InputBox of UserForm", "body": "<p>I am creating an internal chemical inventory app using a  usb barcode scanner to read code 39 encoded item barcodes.</p>\n\n<p>Note without any code the barcode insets the data correctly for a room number ie: RM240.</p>\n\n<p>MY porgram has a UserFormScanScreen where there are InputBox commands that save the barcode to a variable called RoomCode which is then displayed in Cells(2,13) of the spreadsheet before advancing to the next input Box.</p>\n\n<p>The scanner reads the correct data but  when it adds it to the cell it only adds  from the second character on ie.M240 and leaves the R displayed in the InputBox.</p>\n\n<p>I am learning so dont know what im doing wrong thanks for the help. \n<a href=\"https://i.stack.imgur.com/V3Jyb.png\" rel=\"nofollow noreferrer\">screen display inputbox</a> </p>\n\n<p>the code below is from the UserForm Code Screen</p>\n\n<pre><code>Private Sub TextBoxRoom_Change()\n\nRoomCode = InputBox(\"Scan or type product barcode...\", \"Room Barcode\") '\n\nCells(2, 13).Value = RoomCode ' Puts RMScan value into cell M2 \nCells(2, 13).Interior.ColorIndex = 6\n\nTextBoxShelf.SetFocus 'advances to next TextBox\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel", "xmlhttprequest"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519844563, "post_id": 49036470, "comment_id": 85078422, "body": "a server side change invalidating your existing set-up?"}, {"owner": {"reputation": 537, "user_id": 4750548, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1055877744440629/picture?type=large", "display_name": "Alex Watts", "link": "https://stackoverflow.com/users/4750548/alex-watts"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519846465, "post_id": 49036470, "comment_id": 85079464, "body": "This was something else I was wondering as well. I&#39;m currently trying to find some visibility into that but figured I&#39;d see what other suggestions might be available"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519847069, "post_id": 49036470, "comment_id": 85079754, "body": "You might  be able to use Postman or some such to do post and examine what is going on?"}, {"owner": {"reputation": 537, "user_id": 4750548, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1055877744440629/picture?type=large", "display_name": "Alex Watts", "link": "https://stackoverflow.com/users/4750548/alex-watts"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519849848, "post_id": 49036470, "comment_id": 85081207, "body": "Well, I didn&#39;t write the app, nor am I necessarily proficient in understanding exactly how to work with XML in VBA with these HTTP requests. Would it be possible for you to post an example of what you had in mind in an answer?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519882776, "post_id": 49036470, "comment_id": 85091540, "body": "It would be useful to post more of the code.  Kind of difficult to debug without more information though.  Try running an http debugging tool like Fiddler when you send the request and see what you get."}], "owner": {"reputation": 537, "user_id": 4750548, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1055877744440629/picture?type=large", "display_name": "Alex Watts", "link": "https://stackoverflow.com/users/4750548/alex-watts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 700, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519843460, "creation_date": 1519843460, "last_edit_date": 1592644375, "question_id": 49036470, "link": "https://stackoverflow.com/questions/49036470/msxml2-serverxmlhttp-6-0-cannot-send-in-excel-vba", "title": "MSXML2.SERVERXMLHTTP.6.0 cannot send in Excel VBA", "body": "<p>I have an Excel project that uses the following code:</p>\n<pre><code>Dim xDoc As DOMDocument60\nDim xHTTP As ServerXMLHTTP60\n\nSet xDoc = New DOMDocument60\nIf xDoc.loadXML(sSOAPRequest) Then\n    Set xHTTP = CreateObject(&quot;MSXML2.SERVERXMLHTTP.6.0&quot;)\n    xHTTP.Open &quot;POST&quot;, Login.sRequest, False\n    // - some xHTTP.setRequestHeader statements -\n    xHTTP.send xDoc.xml\n    // - other checks for responses from xHTTP object -\nEnd If\n</code></pre>\n<p>This project has been running for months, but the other day I began getting errors from it when it would hit the &quot;xHTTP.send&quot; command, stating</p>\n<blockquote>\n<p>Error number: -2147012894. The operation timed out.</p>\n<p>No response from server. Login information cleared.</p>\n<p>The XML string contains invalid character(s).</p>\n</blockquote>\n<p>I'm fairly certain the XML file (which gets made inside of the tool based on values entered into the Excel sheet) doesn't contain any invalid characters, as this runs the same process on the same-structured data day after day.</p>\n<p>At first I was thinking that perhaps a reference had fallen off of the project, but it is referencing the &quot;Microsoft XML 6.0&quot; library in Office 2013 on Windows10.</p>\n<p>Are there any suggestions for what else might cause this or other steps I can take to troubleshoot this kind of issue?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519843714, "post_id": 49036465, "comment_id": 85077933, "body": "What exactly is your question? What would you expect your function to return in this example?"}, {"owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519843924, "post_id": 49036465, "comment_id": 85078058, "body": "I think the function works up until closest = Application.Match(position, rng, False) - But I can&#39;t seem to make getclosest return the element of &#39;closest&#39; this is the issue. I am unsure if this is because I should be converting the ranges to arrays or how to do that."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519843992, "post_id": 49036465, "comment_id": 85078102, "body": "Well that doesn&#39;t really answer my question, but one problem is that your function is supposed to return a double but you want &quot;D&quot;. You could do this with an array formula."}, {"owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519844387, "post_id": 49036465, "comment_id": 85078336, "body": "The Double was all that needed to be changed! thank&#39;s a lot. It was driving me crazy."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1519851270, "post_id": 49036465, "comment_id": 85081915, "body": "Note that this function will fail if <code>rng</code> is all negative numbers.  Instead initialize <code>t</code> as max possible value: <code>t = 1.7976931348623E+308</code>"}], "owner": {"reputation": 235, "user_id": 5374245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fecb475bd50e5fe9c608cbba5bd767bf?s=128&d=identicon&r=PG&f=1", "display_name": "ChartProblems", "link": "https://stackoverflow.com/users/5374245/chartproblems"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519843439, "creation_date": 1519843439, "last_edit_date": 1531164843, "question_id": 49036465, "link": "https://stackoverflow.com/questions/49036465/ranges-and-excel-vba", "title": "Ranges and Excel VBA", "body": "<p>I am trying to create a function which takes an input of two ranges and one figure. For instance, first range includes the numbers [1, 2, 3, 4, 5] and the second range includes [A, B, C, D, E]. If the input figure is then 4.2 - I want the function to first figure out which figure this is closest to in range 1. In this case it is 4, which has a position of 4. I then want to lookup the fourth element in the second range and output that. In this case it should output \"D\".</p>\n\n<p>I am not sure if I should be converting the ranges to arrays since they are one-dimensional. And I am not sure how to do that and make it work either. Please have a look at the code below.</p>\n\n<pre><code>Function getclosest(ByVal rng As Range, ByVal rng2 As Range, tgt As Double) As Double\n    Dim position, closest As Double\n    t = WorksheetFunction.Max(rng)\n    For Each r In rng\n        u = Abs(r - tgt)\n        If u &lt; t Then\n            t = u\n            position = r\n        End If\n    Next\n    closest = Application.Match(position, rng, False)\n    getclosest = rng2(closest)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519843535, "post_id": 49036268, "comment_id": 85077864, "body": "It <i>sort of</i> makes sense.  Can you share an example of your data so we can see how it&#39;s laid out?  Also, <b><i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i></b>  Be sure to check out the <a href=\"https://stackoverflow.com/tour\">tour</a>, as well as <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>.  If you&#39;re having an issue with something <i>specific</i>, please <a href=\"https://stackoverflow.com/posts/49036268/edit\">edit</a> your questions to provide more information and examples (like described in here: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) and share what you&#39;ve tried &amp; where you&#39;ve looked so far. The goal is to make it as easy as possible for others to help you. :)"}, {"owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519844027, "post_id": 49036268, "comment_id": 85078122, "body": "<a href=\"https://imgur.com/a/33sEf\" rel=\"nofollow noreferrer\">imgur.com/a/33sEf</a>  Thats an example of the setup altough there will be a lot more people and more will get added overtime, and there are more categories.  So i want it to go through each person and then through each column for that person and if they have a BS it would be a 2 and if they have medium experience its a 3 and so on for each column. Then at the end I would add up the total column score and it would paste that in the very last column for that person.  Then i will use RANK.EQ() to rank each person based on their score"}, {"owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "edited": false, "score": 0, "creation_date": 1519912658, "post_id": 49036268, "comment_id": 85106892, "body": "Have you tried to make a code so far, and if so please add it to your question so we can se what you have or havn&#39;t done yet."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "edited": false, "score": 0, "creation_date": 1520004379, "post_id": 49065325, "comment_id": 85149881, "body": "Thanks so much! I knew thats what i needed to do but I just started out so I was unsure how to properly translate my thoughts into code."}], "tags": [], "owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "is_accepted": false, "score": 0, "last_activity_date": 1519979423, "creation_date": 1519979423, "answer_id": 49065325, "question_id": 49036268, "link": "https://stackoverflow.com/questions/49036268/using-case-in-loop-to-score-and-rank/49065325#49065325", "title": "Using case in loop to score and rank", "body": "<p>Well this is just to one way of doing what you want.. Scores need to be ajusted to what you want. Also the range and sheet name needs to be ajusted to your sheet.</p>\n\n<p><a href=\"https://imgur.com/a/9EoeD\" rel=\"nofollow noreferrer\">Sheet Preview</a></p>\n\n<p>Im using a <a href=\"https://support.office.com/en-us/article/ucase-function-0c9b8b77-dd3b-46ec-ac46-b034fef54224\" rel=\"nofollow noreferrer\">Ucase</a> when i loop the scoreboard so it don't matter if you input <code>High, high, HIGH, higH</code> ect. it get's converterd to <code>HIGH</code> in the code so you always match the criteria</p>\n\n<p>You can add more rows and columns, and the code will automaticly ajust the loops, just make sure that the last column is <code>Score</code>, unless you change the loops.</p>\n\n<pre><code>Private Sub Score()\n    '***********************\n    ' Declare variables\n    '***********************\n    Dim ws As Worksheet\n\n    Dim iPersons As Integer\n    Dim iScore As Integer\n    Dim iScoreBoard As Integer\n\n    '***********************\n    ' Initialize variables\n    '***********************\n    Set ws = Application.ThisWorkbook.Sheets(\"Sheet1\") '&lt;--- Change to your sheet name \n    iScore = 0\n    '***********************\n    ' Main\n    '***********************\n    For iPersons = 2 To ws.Cells(ws.Rows.Count, 1).End(xlUp).row\n        For iScoreBoard = 2 To ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column - 1\n            Select Case UCase(ws.Cells(iPersons, iScoreBoard).Value)\n                'Degrees\n                Case \"AS\"\n                    iScore = iScore + 1\n                Case \"BS\"\n                    iScore = iScore + 2\n                Case \"MS\"\n                    iScore = iScore + 3\n                Case \"PHD\"\n                    iScore = iScore + 4\n                'Experience\n                Case \"LOW\"\n                    iScore = iScore + 1\n                Case \"MEDIUM\"\n                    iScore = iScore + 2\n                Case \"HIGH\"\n                    iScore = iScore + 3\n                Case \"EXTREME\"\n                'Certified\n                Case \"N\"\n                    iScore = iScore + 1\n                Case \"Y\"\n                    iScore = iScore + 2\n            End Select\n            ws.Cells(iPersons, ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column).Value = iScore\n        Next iScoreBoard\n    iScore = 0\n    Next iPersons\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9329416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b3ae913503716fd9b3ade31a63e288?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/9329416/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1519979423, "creation_date": 1519842651, "last_edit_date": 1531164843, "question_id": 49036268, "link": "https://stackoverflow.com/questions/49036268/using-case-in-loop-to-score-and-rank", "title": "Using case in loop to score and rank", "body": "<p>I am attempting to score and rank X number of people based on several criterion.  Each row represents 1 person and they are ranked on several columns of criteria with set answers (i.e. level of education: AS, BS, MS, PhD... etc.).  I want to translate these answers into a score (1-5) using the CASE function.  (i.e. case1 education = BS, education_score = 2) and do that for each category.  Then i will add up all the scores (education_score + experience_score + ... etc.) and rank them based on that score.  I am unsure how to use a loop from 1 to i for all people on the sheet so that no matter how many people are entered it covers all of them.  I am also unsure how to use the CASE function properly to set the _score variables to the correct value based on the input for that criterion.  I hope that make sense!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519844093, "post_id": 49036011, "comment_id": 85078151, "body": "<b><i>Welcome to Stack Overflow!</i></b>  Just to understand, is the number a <code>Year+Week#</code> and you want to insert a new column each week?  What&#39;s the <i>short</i> version of what&#39;s wrong?  Just the formatting?  (Also FYI, <i>that&#39;s</i> why new users can&#39;t post images.  :-)  I edited it to make it legible and focus more on the important part, but the other one is still available by clicking.)"}, {"owner": {"reputation": 13, "user_id": 9402446, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t5ZIxVxzl5Q/AAAAAAAAAAI/AAAAAAAAC34/G9VMsF52OP8/photo.jpg?sz=128", "display_name": "Steven Beheshti", "link": "https://stackoverflow.com/users/9402446/steven-beheshti"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519844954, "post_id": 49036011, "comment_id": 85078631, "body": "Thanks Ashlee. Yes, it is a year+week#, and I want to insert a new column each week, on a separate tab. (for 10 different brands) The issue is that the pasting appears to be random. It doesn&#39;t copy into blank column to the right, each time. It copies 2 at a time, then backwards. I just want to build out a &#39;database&#39; to the right, saving down each week. Make sense?"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9402446, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t5ZIxVxzl5Q/AAAAAAAAAAI/AAAAAAAAC34/G9VMsF52OP8/photo.jpg?sz=128", "display_name": "Steven Beheshti", "link": "https://stackoverflow.com/users/9402446/steven-beheshti"}, "is_accepted": false, "score": 0, "last_activity_date": 1519852624, "creation_date": 1519852624, "answer_id": 49038705, "question_id": 49036011, "link": "https://stackoverflow.com/questions/49036011/trouble-copying-over-1-column-to-right-each-time-i-run-macro/49038705#49038705", "title": "Trouble copying over 1 column to right each time I run macro", "body": "<p>Figured out that I was doubling the work. When I eliminated the duplicate, the macro worked great. Here is the final result: </p>\n\n<pre><code>Sub ActualsAutomation()\n'\n' ActualsAutomation Macro\n'\n\n'\n    Application.Run \"PERSONAL.XLSB!AllSheets\"\n\n    Dim c As Long\n\n    c = Sheets(\"SS Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"SS Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"SS Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"All Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"All Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"All Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Base Specialties Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Base Specialties Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Base Specialties Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Combat Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Combat Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Combat Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Great Value Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Great Value Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Great Value Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Persil Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Persil Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Persil Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Purex Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Purex Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Purex Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Renuzit Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Renuzit Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Renuzit Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Snuggle Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Snuggle Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Snuggle Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Sun Cuddle Soft Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Sun Cuddle Soft Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Sun Cuddle Soft Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Sun Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Sun Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Sun Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Surf Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Surf Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Surf Lookup\").Range(\"F1:F498\").Value\n\n    c = Sheets(\"Uno Dos Tres Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n    Sheets(\"Uno Dos Tres Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Uno Dos Tres Lookup\").Range(\"F1:F498\").Value\nEnd Sub\n</code></pre>\n\n<p>Thanks for your help!</p>\n"}], "owner": {"reputation": 13, "user_id": 9402446, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-t5ZIxVxzl5Q/AAAAAAAAAAI/AAAAAAAAC34/G9VMsF52OP8/photo.jpg?sz=128", "display_name": "Steven Beheshti", "link": "https://stackoverflow.com/users/9402446/steven-beheshti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519852624, "creation_date": 1519841504, "last_edit_date": 1531164843, "question_id": 49036011, "link": "https://stackoverflow.com/questions/49036011/trouble-copying-over-1-column-to-right-each-time-i-run-macro", "title": "Trouble copying over 1 column to right each time I run macro", "body": "<p>I am new to VBA, attempting to copy values from one tab, named <code>lookup xxx</code> (the data will always be in <code>Column F</code>) and Paste into the associated <code>actuals xxx</code> tab. </p>\n\n<p>I do this for about 10 different lookup tabs. My goal is to paste <code>Week 50</code>, or <code>201750</code> into <code>Column F</code>, the first time I run the macro. </p>\n\n<p>The 2nd time I run it, I want to paste into <code>column G</code>, and the third time, <code>column H</code>, and so on; each time keeping the data in the previous columns.</p>\n\n<p>The built in Macro, or <code>Personal.xlsb!AllSheets</code> updates the data on the lookup tab, and updates the weeks. This is really a \"copy and paste over one column\" question. </p>\n\n<p><strong>What I want to happen is this:</strong></p>\n\n<ul>\n<li><p>the first time I run it, column F on <code>actuals xxx</code> tab is filled with <code>201750</code> data (from <code>lookup xxx</code> tab)</p></li>\n<li><p>The next time I run it, <code>column F</code> keeps <code>201750</code>, and <code>G=201751</code> data.</p></li>\n<li>The next time I run it,<code>F=201750, G=201751, H=201752</code> data</li>\n<li>and so on...</li>\n</ul>\n\n<p><strong>What actually happens, is:</strong></p>\n\n<ul>\n<li><p>the first time I run it, both <code>columns F</code> and <code>G</code> on <code>actuals xxx</code> are filled with <code>201750</code> data. </p></li>\n<li><p>The next time I run it, <code>F=201751, G=201750, and H=201751</code>.</p></li>\n<li><p>The next time I run it, <code>F=201750, G=201751, H=201752, I=201752.</code> </p></li>\n</ul>\n\n<p><strong>Here is the code I'm currently using:</strong></p>\n\n<pre><code>  Sub ActualsAutomation()\n    '\n    ' ActualsAutomation Macro\n    '\n\n    '\n        Application.Run \"PERSONAL.XLSB!AllSheets\"\n\n        Sheets(\"SS Actuals\").Range(\"F3:F500\").Value = Sheets(\"SS Lookup\").Range(\"F1:F498\").Value\n\n        Dim c As Long\n\n        c = Sheets(\"SS Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"SS Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"SS Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"All Actuals\").Range(\"F3:F500\").Value = Sheets(\"All Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"All Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"All Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"All Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Base Specialties Actuals\").Range(\"F3:F500\").Value = Sheets(\"Base Specialties Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Base Specialties Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Base Specialties Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Base Specialties Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Combat Actuals\").Range(\"F3:F500\").Value = Sheets(\"Combat Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Combat Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Combat Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Combat Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Great Value Actuals\").Range(\"F3:F500\").Value = Sheets(\"Great Value Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Great Value Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Great Value Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Great Value Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Persil Actuals\").Range(\"F3:F500\").Value = Sheets(\"Persil Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Persil Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Persil Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Persil Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Purex Actuals\").Range(\"F3:F500\").Value = Sheets(\"Purex Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Purex Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Purex Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Purex Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Renuzit Actuals\").Range(\"F3:F500\").Value = Sheets(\"Renuzit Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Renuzit Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Renuzit Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Renuzit Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Snuggle Actuals\").Range(\"F3:F500\").Value = Sheets(\"Snuggle Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Snuggle Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Snuggle Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Snuggle Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Sun Cuddle Soft Actuals\").Range(\"F3:F500\").Value = Sheets(\"Sun Cuddle Soft Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Sun Cuddle Soft Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Sun Cuddle Soft Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Sun Cuddle Soft Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Sun Actuals\").Range(\"F3:F500\").Value = Sheets(\"Sun Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Sun Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Sun Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Sun Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Surf Actuals\").Range(\"F3:F500\").Value = Sheets(\"Surf Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Surf Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Surf Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Surf Lookup\").Range(\"F1:F498\").Value\n\n        Sheets(\"Uno Dos Tres Actuals\").Range(\"F3:F500\").Value = Sheets(\"Uno Dos Tres Lookup\").Range(\"F1:F498\").Value\n\n        c = Sheets(\"Uno Dos Tres Actuals\").Cells(3, Columns.Count).End(xlToLeft).Column + 1\n        Sheets(\"Uno Dos Tres Actuals\").Cells(3, c).Resize(498).Value = Sheets(\"Uno Dos Tres Lookup\").Range(\"F1:F498\").Value\n    End Sub\n</code></pre>\n\n<p>And here is a picture of what happens after I have run the macro 3 times:</p>\n\n<p><sup>(Click image for full version.)</sup>\n<a href=\"https://i.stack.imgur.com/Gg1xO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BHmcP.png\" alt=\"screenshot (edited by ashleedawg)\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519840217, "post_id": 49035628, "comment_id": 85076256, "body": "Yes. Reference the <i>VBE Extensibility Library</i>, then figure out a specific question to ask about it - as it stands your question is too broad to be answerable... I&#39;ll just say that the VBIDE API will give you ways to modify the code in the project&#39;s modules, but nothing to parse it. So, locating <i>an object name or collection name</i> is going to be near-impossible to do. Depending on what you&#39;re <i>actually</i> trying to accomplish, <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> <i>may</i> be helpful. Disclaimer: I manage that open-source VBIDE add-in project."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1519840261, "post_id": 49035628, "comment_id": 85076275, "body": "Yes, it is possible, but you have to first change a setting in Excel to allow for it. &quot;Trust access to the VBA project object model&quot;"}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1519841196, "post_id": 49035628, "comment_id": 85076713, "body": "Thank you both! That&#39;s what I needed. But Mat, how do I mark your answer as &quot;the answer&quot;?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519841277, "post_id": 49035628, "comment_id": 85076760, "body": "It&#39;s not an answer, just a comment... I didn&#39;t understand the question, hence why I commented on it. I&#39;d just delete the question (and then read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> before posting the next one ;-)  ..glad it helped!"}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1519841592, "post_id": 49035628, "comment_id": 85076893, "body": "Oh, no, your answer was exactly what I needed (extensibility is the keyword I needed). So, you deserve the &quot;answered&quot; bump. All I needed was a starting point. (I&#39;ll probably ask more questions later, but not until after I&#39;ve at least tried some code.)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519841779, "post_id": 49035628, "comment_id": 85076999, "body": "<a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/vbe.aspx</a> explains what you need to do"}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1519842435, "post_id": 49035628, "comment_id": 85077344, "body": "Thanks, Tim! I found that right away once I knew the keyword &quot;extensibility&quot; that Mat provided. (Hence why I want to credit him with the answer.)  Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1519843182, "creation_date": 1519843182, "answer_id": 49036400, "question_id": 49035628, "link": "https://stackoverflow.com/questions/49035628/is-there-a-way-to-use-vba-to-modify-other-vba-code/49036400#49036400", "title": "Is there a way to use VBA to modify other VBA code?", "body": "<p>You're probably looking for the <em>VBE Extensibility Library</em>.</p>\n\n<p>However note that depending on what you're <em>actually</em> trying to do (\"modify other VBA code\"), it may be very hard, if not impossible to implement.</p>\n\n<p>The library will let you iterate modules, locate their members, pull the actual code into strings (from entire modules or just a given procedure)... but that's as granular as it gets.</p>\n\n<p>If you're trying to do anything that requires understanding of the code's semantics, the VBIDE API won't be enough: you need a lexer and a parser for that... and I've yet to see a successful lexer/parser for VBA, written in VBA.</p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1519847391, "accepted_answer_id": 49036400, "answer_count": 1, "score": -4, "last_activity_date": 1519843182, "creation_date": 1519839880, "question_id": 49035628, "link": "https://stackoverflow.com/questions/49035628/is-there-a-way-to-use-vba-to-modify-other-vba-code", "closed_reason": "Needs more focus", "title": "Is there a way to use VBA to modify other VBA code?", "body": "<p>I don't know where to start with this. If there is a way, all I need is an object name or collection name, so I can look up the feature on Microsoft's site, and go from there. But, searching there directly didn't turn anything up.</p>\n"}, {"tags": ["excel", "loops", "range", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1519840923, "post_id": 49035606, "comment_id": 85076583, "body": "Loop backwards using a counter."}], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "is_accepted": true, "score": 0, "last_activity_date": 1520016375, "creation_date": 1520016375, "answer_id": 49075470, "question_id": 49035606, "link": "https://stackoverflow.com/questions/49035606/how-to-update-range-for-test-in-loop-that-is-changing-range/49075470#49075470", "title": "How to update range for test in loop that is changing range", "body": "<p>For those interested I solved this by setting the found range as the entire column. Here is my working code:</p>\n\n<pre><code>Dim matchCounter As Integer\nDim foundRange As Range\nDim manualRng As Range\nDim lastRow As Long\nmatchCounter = 0\nOn Error Resume Next\nApplication.ScreenUpdating = False\n    For Each Rng2 In WorkRng2\n        If Rng2.Interior.Color = VBA.RGB(255, 0, 0) And Rng2.Value &gt; 0 Then\n                blkRow.Copy\n            lastRow = WorkRng1.SpecialCells(xlCellTypeLastCell).Row 'tests for last filled row in range 1\n            Set foundRange = Range(Cells(1, WorkRng1.Column), Cells(lastRow, WorkRng1.Column)).Find(Rng2.Offset(-1, 0).Value, LookIn:=xlValues)\n            If foundRange Is Nothing Then\n            Application.ScreenUpdating = True\n                MsgBox \"Cannot find where to put \" &amp; Rng2, vbInformation, \"OOPS!\"\n                Set manualRng = Application.InputBox(\"Please select the cell where you would like to add \" &amp; Rng2, \"LOCATION PLEASE\", Type:=8)\n                blkRow.Copy\n                manualRng.Select\n                Selection.EntireRow.Insert Shift:=xlDown\n                    Application.CutCopyMode = False\n            Application.ScreenUpdating = False\n                Else\n            WorkRng1.Find(Rng2.Offset(-1, 0).Value, LookIn:=xlValues).Select\n                ActiveCell.Offset(1, 0).Select\n                Selection.EntireRow.Insert Shift:=xlDown\n                    Application.CutCopyMode = False\n            End If\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49075470, "answer_count": 1, "score": 0, "last_activity_date": 1520016375, "creation_date": 1519839825, "last_edit_date": 1531161705, "question_id": 49035606, "link": "https://stackoverflow.com/questions/49035606/how-to-update-range-for-test-in-loop-that-is-changing-range", "title": "How to update range for test in loop that is changing range", "body": "<p>I want my loop to test for cell that is looking for a value. Problem is my range is changing because the loop is adding rows. How can I update my set range?</p>\n\n<p><code>WorkRng1</code> and <code>WorkRng2</code> are public variables set with an input box</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Dim foundRange As Range\nDim manualRng As Range\nDim LastRow As Long\nmatchCounter = 0\nOn Error Resume Next\nApplication.ScreenUpdating = False\n    For Each Rng2 In WorkRng2\n        If Rng2.Interior.Color = VBA.RGB(255, 0, 0) And Rng2.Value &gt; 0 Then\n                blkRow.Copy\n            LastRow = Range(WorkRng1.Column &amp; Rows.Count).End(xlUp).Row 'tests for last filled row in range 1\n            Set foundRange = WorkRng1.Find(Rng2.Offset(-1, 0).Value, LookIn:=xlValues)\n            If foundRange Is Nothing Then\n            Application.ScreenUpdating = True\n                MsgBox \"Cannot find where to put \" &amp; Rng2, vbInformation, \"OOPS!\"\n                Set manualRng = Application.InputBox(\"Please select the cell where you would like to add \" &amp; Rng2, \"LOCATION PLEASE\", Type:=8)\n                manualRng.Select\n                Selection.EntireRow.Insert Shift:=xlDown\n                    Application.CutCopyMode = False\n            Application.ScreenUpdating = False\n                Else\n            WorkRng1.Find(Rng2.Offset(-1, 0).Value, LookIn:=xlValues).Select\n                ActiveCell.Offset(1, 0).Select\n                Selection.EntireRow.Insert Shift:=xlDown\n                    Application.CutCopyMode = False\n            End If\n</code></pre>\n\n<p>I was thinking I would add a <code>lastRow</code> test to it but I'm stuck on the syntax for the range. Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9424892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arpan Patel", "link": "https://stackoverflow.com/users/9424892/arpan-patel"}, "edited": false, "score": 0, "creation_date": 1519855255, "post_id": 49035588, "comment_id": 85083968, "body": "yes it is similar to my issue, i want to know how to chose which columns i can extract and if i can extract multiple columns at the same time and put it into an array?"}, {"owner": {"reputation": 1, "user_id": 9424892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arpan Patel", "link": "https://stackoverflow.com/users/9424892/arpan-patel"}, "edited": false, "score": 0, "creation_date": 1520266269, "post_id": 49035588, "comment_id": 85234470, "body": "this macro that im building if for work. we have a spread sheet that had a tone of emails so wanted to build something that can help extract the emails. each row has a unique code and there are 3 columns that have emails (column E/G/I). I also want to have the emails be put into an array if possible  Not sure if im asking for to much"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 0, "last_activity_date": 1519839762, "creation_date": 1519839762, "answer_id": 49035588, "question_id": 49035463, "link": "https://stackoverflow.com/questions/49035463/i-want-to-extract-a-specific-string-from-another-excel-workbook/49035588#49035588", "title": "I want to extract a specific string from another excel workbook", "body": "<p>Try this code .. Similar to your issue</p>\n\n<pre><code>Sub VLOOKUP_Closed_Workbook()\nDim wbk         As Workbook\nDim ws          As Worksheet\nDim sh          As Worksheet\nDim i           As Integer\nDim sFolder     As String\nDim fName       As String\n\nApplication.ScreenUpdating = False\n    Set ws = ThisWorkbook.ActiveSheet\n    sFolder = ThisWorkbook.Path &amp; \"\\\"\n    fName = Dir(sFolder &amp; \"ClosedWB.xlsm\")\n    Set wbk = Workbooks.Open(sFolder &amp; fName)\n    Set sh = wbk.Worksheets(\"Sheet1\")\n\n    With ws.Range(\"B1:B\" &amp; ws.Cells(Rows.Count, 1).End(xlUp).Row)\n        .Formula = \"=IFERROR(VLOOKUP(A1,[ClosedWB.xlsm]Sheet1!$A:$B,2,FALSE),\"\"Not Found\"\")\"\n        .Value = .Value\n    End With\n\n    wbk.Close False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9424892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arpan Patel", "link": "https://stackoverflow.com/users/9424892/arpan-patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1520272346, "creation_date": 1520272346, "answer_id": 49116594, "question_id": 49035463, "link": "https://stackoverflow.com/questions/49035463/i-want-to-extract-a-specific-string-from-another-excel-workbook/49116594#49116594", "title": "I want to extract a specific string from another excel workbook", "body": "<p>This code helps a lot, i have a look up value but i need to extract 3 columns of information. but each time i use this code it keeps asking me to select folder but i want to do this only once. In addition i want to put the looked up value in an array if possible.</p>\n\n<pre><code>Set wsk = ThisWorkbook.ActiveSheet\n\nWith wsk.Range(\"B1:b\" &amp; wsk.Cells(Rows.Count, 1).End(xlUp).Row)\n    .Formula = \"=IFERROR(VLOOKUP(A1,[ClosedWB.xlsm]Sheet1!$A:$i,5,FALSE),\"\"Not Found\"\")\"\n    .Value = .Value\nEnd With\n\n\nWith wsk.Range(\"C1:c\" &amp; wsk.Cells(Rows.Count, 1).End(xlUp).Row)\n    .Formula = \"=IFERROR(VLOOKUP(A1,[ClosedWB.xlsm]Sheet1!$A:$i,9,FALSE),\"\"Not Found\"\")\"\n    .Value = .Value\nEnd With\n\nWith wsk.Range(\"D1:D\" &amp; wsk.Cells(Rows.Count, 1).End(xlUp).Row)\n    .Formula = \"=IFERROR(VLOOKUP(A1,[ClosedWB.xlsm]Sheet1!$A:$i,7,FALSE),\"\"Not Found\"\")\"\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9424892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arpan Patel", "link": "https://stackoverflow.com/users/9424892/arpan-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520272346, "creation_date": 1519839279, "last_edit_date": 1531164843, "question_id": 49035463, "link": "https://stackoverflow.com/questions/49035463/i-want-to-extract-a-specific-string-from-another-excel-workbook", "title": "I want to extract a specific string from another excel workbook", "body": "<p>I have this code, but I want to set it up so that, if cell A1 = apples, then it will go to the other workbook and find the word apple and copies that value to my original worksheet.\nEG.</p>\n\n<p>Workbook (1)           </p>\n\n<p>A1 = APPLES<br>\nA2 = PEARS              </p>\n\n<p>Workbook (2)</p>\n\n<p>A1 = APPLES __B1 = PIE</p>\n\n<p>A2 = PEARS ___B2= JUICE</p>\n\n<p>Workbook(1) will get the match the values from Workbook (2) and bring the values from column \"B\" over to Workbook (1) column \"B\"</p>\n\n<p>I hope that makes sen </p>\n\n<pre><code>If .SelectedItems.Count &gt; 0 Then\n    Application.Workbooks.Open .SelectedItems(1)\n\n    Set xAddWb = Application.ActiveWorkbook\n\n    Set xRng1 = Range(\"A4:E50\")\n    xWb.Activate\n\n    Set xRng2 = Range(\"A1\")\n    xRng1.Copy xRng2\n\n    xRng2.CurrentRegion.EntireColumn.AutoFit\n\n    xAddWb.Close False\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1519840927, "post_id": 49035411, "comment_id": 85076587, "body": "In Access, this is allowed by marking off the &quot;Triple State&quot; property for the control. In Word, this doesn&#39;t seem to be an option. What is the problem that you are trying to solve with the control?"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 2, "creation_date": 1519840990, "post_id": 49035411, "comment_id": 85076622, "body": "You can if you use an ActiveX checkbox. I found that object under the &quot;legacy tools&quot; menu on the developer tab with Word 2016. That&#39;s all I have access to at the moment. Do you have the ActiveX option?"}, {"owner": {"reputation": 2841, "user_id": 1920035, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cRK2R.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/1920035/david"}, "reply_to_user": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1519843170, "post_id": 49035411, "comment_id": 85077712, "body": "@PatJones - I am building a form for my business to do insurance reviews. When my employees ask the insured about different lines of insurance, I want them to be able to have a check mark for if it insured with us, an x mark for if it is insured elsewhere, or blank if there is no need."}, {"owner": {"reputation": 2841, "user_id": 1920035, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cRK2R.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/1920035/david"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1519843463, "post_id": 49035411, "comment_id": 85077834, "body": "@MoondogsMaDawg - That does seem to have the triple state option, do you know if I&#39;m able to change the tick mark like we&#39;re able to in the non-legacy version?"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1519843820, "post_id": 49035411, "comment_id": 85077990, "body": "I think your only option would be to build a customized activex control. You can learn how to briefly do that <a href=\"https://msdn.microsoft.com/en-us/library/aa239763(v=vs.60).aspx\" rel=\"nofollow noreferrer\">here at MSDN</a>. I don&#39;t see any relevant appearance capabilities within the standard properties."}, {"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 3, "creation_date": 1519843980, "post_id": 49035411, "comment_id": 85078094, "body": "For this need, I&#39;d use an option group control as it&#39;s more transparent to the end users and less of pain to program. It&#39;s just my opinion, but triple state check boxes are easily misinterpreted when in the third state."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1519844202, "post_id": 49035411, "comment_id": 85078227, "body": "@PatJones Ditto. The biggest issue I see is defining these states into three categories may not stand up to the chaos of reality. Option groups are scalable in that way, if you decide to add supplemental states down the road you can add the new selection to the group instead of replacing objects and possibly needing to refactor code."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1519853247, "post_id": 49035411, "comment_id": 85083015, "body": "Do be aware that ActiveX controls are not supported on Macs. IMHO you&#39;d do better to use a dropdown from which the desired option can be chosen. Note, too, that you shouldn&#39;t use formfields and content controls in the same document; they weren&#39;t deigned to work together and trying to use them that way can lead to inconsistent results."}], "owner": {"reputation": 2841, "user_id": 1920035, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cRK2R.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/1920035/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1447, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519840745, "creation_date": 1519839098, "question_id": 49035411, "link": "https://stackoverflow.com/questions/49035411/3-state-checkbox", "title": "3 State Checkbox", "body": "<p>I am using Microsoft Word 2013 and inserting a CheckBox from the developer tab. I want to have a 3-state CheckBox (checked, intermediate, and unchecked), but whenever I pull up the properties of the CheckBox, it only gives me the options for a 2-state CheckBox (checked and unchecked).</p>\n\n<p>Is there anyway to insert a 3-state CheckBox in Microsoft Word? I'm comfortable with using VBA if needed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1001, "user_id": 1849111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaddad50424688fe477e473dac45c3a6?s=128&d=identicon&r=PG", "display_name": "loopingz", "link": "https://stackoverflow.com/users/1849111/loopingz"}, "edited": false, "score": 0, "creation_date": 1519839351, "post_id": 49035318, "comment_id": 85075797, "body": "I would strongly advice to format your questions using this guide, the code block is better formatted : <a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1519839559, "post_id": 49035318, "comment_id": 85075916, "body": "<code>.UsedRange.Offset().Copy sh.Cells(Rows.Count, 1).End(xlUp)(2)</code> this line needs to be fixed, you don&#39;t need offset nor xlUp if using UsedRange. Also, the <code>ActiveCell.Offset(-34, -7)</code> and <code>ActiveCell.Offset(29, 0)</code> aren&#39;t really doing anything."}], "owner": {"reputation": 1, "user_id": 9424275, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216315099738487/picture?type=large", "display_name": "Jennife", "link": "https://stackoverflow.com/users/9424275/jennife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519844549, "creation_date": 1519838769, "last_edit_date": 1531161705, "question_id": 49035318, "link": "https://stackoverflow.com/questions/49035318/i-am-copying-multiple-excel-files-into-a-single-workbook-an-want-cell-a1-data-to", "title": "I am copying multiple excel files into a single workbook an want cell A1 data to be listed on all lines copied from that workbook", "body": "<pre><code>Sub Merger()\nDim wb As Workbook, sh As Worksheet, fPath As String, fName As String\nSet sh = ThisWorkbook.Sheets(1)\nfPath = ThisWorkbook.Path 'If files are in a different directory than master, replace path here\n    If Right(fPath, 1) &lt;&gt; \"\\\" Then fPath = fPath &amp; \"\\\" 'Make sure separator is on end of path\nfName = Dir(fPath &amp; \"*.xl*\") 'get all Excel files in directory\n    Do\n        If fName &lt;&gt; ThisWorkbook.Name Then\n            Set wb = Workbooks.Open(fPath &amp; fName)\n            With wb.Sheets(1)\n                If Application.CountA(.Rows(2)) &gt; 0 Then\n                    .UsedRange.Offset().Copy sh.Cells(Rows.Count, 1).End(xlUp)(2)\n                End If\n            End With\n            wb.Close False\n        End If\n        fName = Dir\n    Loop While fName &lt;&gt; \"\"\n    ActiveCell.Offset(-34, -7).Range(\"A1:T1\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"hb_golden_1154317527.txt)\"\n    ActiveCell.Offset(29, 0).Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Like I said I would to insert A1 into each Consecutive line of data not sure where to start.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sXzpq.png\" rel=\"nofollow noreferrer\">sample file for excel merged</a></p>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1519842282, "post_id": 49035298, "comment_id": 85077263, "body": "Do you mean a &quot;regex-like pattern&quot;?  Regular regex is for parsing, not for generating strings.  If you mean for us to help you build a generic function which takes a regex pattern and then generates &quot;random&quot; strings based on that pattern, then that&#39;s some amount of coding which would be required, and there&#39;s nothing suggesting you&#39;ve even <i>tried</i> to solve this so...   Recommending tools is off-topic for SO."}, {"owner": {"reputation": 79873, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "edited": false, "score": 0, "creation_date": 1519845738, "post_id": 49035298, "comment_id": 85079080, "body": "An example would be helpful. Please <a href=\"https://stackoverflow.com/posts/49035298/edit\">edit</a> your question."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1519851507, "post_id": 49035298, "comment_id": 85082030, "body": "This question boils down to your code comment: <code>Analize the pattern and create random string satisfying the pattern needs to be valid</code> This is   a huge undertaking. It&#39;s a novel idea what you are trying to do, but there isn&#39;t going to be a simple path to solving it (at least none that I&#39;m aware of). In fact... If I had to solve for this comment, I would probably download a javascript library for it (since there appear to be a few of <a href=\"https://github.com/fent/randexp.js?\" rel=\"nofollow noreferrer\">them</a>), make a quick form in HTML to use it, and then webscrape my local form through VBA."}, {"owner": {"reputation": 171, "user_id": 3830741, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1af884afd9893800ef49b9e64522d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Antonycx", "link": "https://stackoverflow.com/users/3830741/antonycx"}, "edited": false, "score": 0, "creation_date": 1519852427, "post_id": 49035298, "comment_id": 85082558, "body": "That sounds interesting, but since I do not have experience using VBA, it seems that I&#39;ll have to do research on how to connect html with VBA code. Another option that I have seen is to use Kutools, but I do not know if it is useful for what I need. I&#39;ll search and try to resolve this."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1519857858, "post_id": 49035298, "comment_id": 85085085, "body": "interesting you want to use a regex as a generator pattern instead of how they are normally used (as a matching pattern)"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 1, "creation_date": 1519862890, "post_id": 49035298, "comment_id": 85086712, "body": "@Antonycx - It seems to me that there are far easier ways to generate random text that matches a pattern than to create a &quot;reverse regex&quot; tool."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1519938079, "post_id": 49035298, "comment_id": 85122069, "body": "@Enigmativity Here, here."}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 3830741, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1af884afd9893800ef49b9e64522d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Antonycx", "link": "https://stackoverflow.com/users/3830741/antonycx"}, "is_accepted": false, "score": 1, "last_activity_date": 1520542116, "last_edit_date": 1520542116, "creation_date": 1520473416, "answer_id": 49164064, "question_id": 49035298, "link": "https://stackoverflow.com/questions/49035298/how-to-generate-random-text-from-regex-to-fill-an-excel-cell/49164064#49164064", "title": "How to generate random text from regex to fill an excel cell", "body": "<p><strong><em>Got it!</em> Using Java language + VBA Excel</strong> and based on these links:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11343769/microsoft-excel-macro-to-run-java-program#answer-11353148\">Microsoft Excel Macro to run Java program</a></p>\n\n<p><a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/142069-calling-and-executing-a-java-program-from-excel-vba-macro\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/help-forums/excel-general/142069-calling-and-executing-a-java-program-from-excel-vba-macro</a></p>\n\n<p><a href=\"http://www.linuxonly.nl/docs/69/168_Generating_random_strings_from_a_regular_expression.html\" rel=\"nofollow noreferrer\">Here</a> i found lots of libraries that already generate values based on a regex.</p>\n\n<p><strong>I chose <a href=\"https://github.com/mifmif/Generex\" rel=\"nofollow noreferrer\">this</a> to test.</strong> </p>\n\n<p><em>Why?</em>, I tested with Javascript libraries, but i found it very complicated to use along with VBA, Phyton libraries less complicated, but when i saw an example with Java was desicive.</p>\n\n<p>What i did was:</p>\n\n<p>1 - Download generex.jar version 1.0.2 with dependencies from <a href=\"https://jar-download.com/?search_box=generex\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>2 - Create a Java Project with a Main class, in my case <strong><em>RegexToValue</em></strong> with the following code:</p>\n\n<pre><code>import com.mifmif.common.regex.Generex;\n\n//args[0] receive regex to init Generex Object\npublic class RegexToValue {\n    public static Generex generex;\n    public static int attempts = 0;\n\n    public static void main(String[] args) {\n        if (args.length &gt; 0) {\n            generex = new Generex(args[0]);\n        } else {\n            generex = new Generex(\"[0-3]([a-c]|[e-g]{1,2})\"); //default init\n        }\n        generateValue();\n    }\n\n    public static void generateValue() {\n        try {\n            System.out.print(generex.random());\n        } catch(Error e) {\n            if (attempts &lt;= 3) {\n                attempts++;\n                generateValue();\n            } else {\n                System.out.print(\"Error\");\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>3 - Import the two .jars downloaded from step 1 into the project (Libraries -> Add JAR file)</p>\n\n<p>4 - Generate JAR file of the project with imported dependencies from step 3, all together</p>\n\n<p>5 - I put the generated JAR and the Lib folder into C:\\Generex\\ for simplicity</p>\n\n<p>6 - Create an Excel file enabled for Macros</p>\n\n<p>7 - Create a Module <strong><em>(Alt + F11) -> Menu Insert -> Module</em></strong> with the following code:</p>\n\n<pre><code>#If VBA7 Then\n    '64 Bits\n    Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n#Else\n    '32 Bits\n    Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#End If\n\nPublic Function fillCellWith(regxPattern As String)\n    Dim prog As Object\n\n    '// pass the program name to java on command line, and pass any arguments after.\n    Set prog = CreateObject(\"WScript.Shell\").exec(\"javaw -jar \"\"C:\\Generex\\RegexToValue.jar\"\" \" &amp; regxPattern)\n    While prog.Status = 0\n        Sleep 1000 '// put thread to sleep for 1 sec.\n    Wend\n    fillCellWith = prog.StdOut.ReadAll\nEnd Function\n</code></pre>\n\n<p>8 - Use a formula like this in a cell:</p>\n\n<pre><code>=fillCellWith(\"(blue|red|yellow|green)\\.(oak|cedar|willow)\\@(yahoo\\.co\\.uk|google\\.com|example\\.org)\")\n</code></pre>\n\n<p>9 - See results <em>=)</em></p>\n"}], "owner": {"reputation": 171, "user_id": 3830741, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1af884afd9893800ef49b9e64522d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "Antonycx", "link": "https://stackoverflow.com/users/3830741/antonycx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1520873119, "creation_date": 1519838690, "last_edit_date": 1531161705, "question_id": 49035298, "link": "https://stackoverflow.com/questions/49035298/how-to-generate-random-text-from-regex-to-fill-an-excel-cell", "title": "How to generate random text from regex to fill an excel cell", "body": "<p>I'm creating a large amount of Excel test files with different values in many columns.</p>\n\n<p>(Windows 7 - 64 bits system (if relevant)).</p>\n\n<p>These files are going to be imported into a database later using other unknown tool, so I just have to prepare only these files filled with valid data.</p>\n\n<p>Each file has different columns, so different ranges of valid characters are necessary per column.</p>\n\n<p><strong>What would I want to do?</strong></p>\n\n<blockquote>\n  <p>Use a Formula witch receive a regex and generate/and fill the cell\n  with a random string based on that regex and if possible specify how\n  many characters the string should be.</p>\n</blockquote>\n\n<p>Something like this site does: <a href=\"https://www.browserling.com/tools/text-from-regex\" rel=\"nofollow noreferrer\">https://www.browserling.com/tools/text-from-regex</a></p>\n\n<p>For example: For the next columns, I would like to populate cells with random text as follows:</p>\n\n<pre><code>&gt; \n&gt; -------------------------------------------------------------------\n&gt; | Name      | Email          | Date  | URL               | Price  |\n&gt; -------------------------------------------------------------------\n&gt; | AHygsyub  | xyz@uygsh.hyu  | 1956  | http://iadif.jyf  | 245.75 |\n&gt; -------------------------------------------------------------------\n</code></pre>\n\n<p><strong>Using something like this in the Formula bar:</strong></p>\n\n<pre><code>&gt; =fillCellWith('([a-z]{3,10} ){1,10}')              //For Name column\n&gt; =fillCellWith('\\d{4}')                             //For Date column\n&gt; =fillCellWith(RegexPattern)                        //Etc etc\n</code></pre>\n\n<p>Can someone guide me in the creation of a VBA Function to accomplish this purpose?</p>\n\n<p>I don't have any experience in VB programming, but I can imagine something like:</p>\n\n<pre><code>Public Function fillCellWith(MyRegex As String) As String\nDim regEx As New RegExp\nDim Rand As String\n\n'Analize the pattern and create random string satisfying the pattern needs to be valid\n'Merge all parts and return as a result in Rand\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1519838956, "post_id": 49034501, "comment_id": 85075553, "body": "My suspicion is that your Windows Regional Short Date settings are a variant of <code>MDY</code>, that the data in your workbook <code>Data.csv</code> is formatted as text; and that you <b>OPEN</b>&#39;d instead of <b>IMPORT</b>ing the original <code>csv</code> file so you never had the opportunity to properly format the dates.  If that is the case, we have to go back to the source <code>csv</code> file."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9390370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7638467d87fed49fbab82b4e31419165?s=128&d=identicon&r=PG&f=1", "display_name": "Woodhouse", "link": "https://stackoverflow.com/users/9390370/woodhouse"}, "edited": false, "score": 0, "creation_date": 1519837120, "post_id": 49034609, "comment_id": 85074402, "body": "Just tried this but the issue remains. I have a feeling there&#39;s an issue with the workbook as opposed to the data or VBA now."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 11, "user_id": 9390370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7638467d87fed49fbab82b4e31419165?s=128&d=identicon&r=PG&f=1", "display_name": "Woodhouse", "link": "https://stackoverflow.com/users/9390370/woodhouse"}, "edited": false, "score": 0, "creation_date": 1519837212, "post_id": 49034609, "comment_id": 85074460, "body": "At this point we would need more information.  Can you please edit your original post to provide sample data (both the &#39;x&#39; csv and the &#39;y&#39; workbook) and expected results?  We&#39;ll also need to see your autofilter code."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1519836411, "creation_date": 1519836411, "answer_id": 49034609, "question_id": 49034501, "link": "https://stackoverflow.com/questions/49034501/copy-and-pasting-with-vba-nullifies-formatting/49034609#49034609", "title": "Copy and pasting with VBA nullifies formatting", "body": "<p>Don't copy/paste, set the values directly:</p>\n\n<pre><code>Dim x As Workbook\nDim y As Workbook\nDim rCSVValues As Range\n\n' Open both workbooks\nSet y = ActiveWorkbook\nSet x = Workbooks.Open(\"Data.csv\")\n\n' Copy data from x\nWith x.Sheets(\"SourceData\")\n    Set rCSVValues = .Range(\"A1\", .Range(\"A1\").End(xlDown).End(xlToRight))\nEnd With\n\n' Paste to y\ny.Sheets(\"Destination\").Range(\"C4\").Resize(rCSVValues.Rows.Count, rCSVValues.Columns.Count).Value = rCSVValues.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1519837478, "creation_date": 1519837478, "answer_id": 49034935, "question_id": 49034501, "link": "https://stackoverflow.com/questions/49034501/copy-and-pasting-with-vba-nullifies-formatting/49034935#49034935", "title": "Copy and pasting with VBA nullifies formatting", "body": "<p>along the lines of @tigeravatar solution, but with a more concise code</p>\n\n<pre><code>Dim y As Workbook\n\nSet y = ActiveWorkbook\n\nWith Workbooks.Open(\"Data.csv\").Sheets(\"SourceData\") 'open source workbook and reference its \"SourceData\" sheet\n    With .Range(\"A1\").CurrentRegion 'reference referenced sheet range \"adjacent\" to cell A1\n        y.Sheets(\"Destination\").Range(\"C4\").Resize(.Rows.Count, .Columns.Count).value = .value\n    End With\n    .Close False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9390370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7638467d87fed49fbab82b4e31419165?s=128&d=identicon&r=PG&f=1", "display_name": "Woodhouse", "link": "https://stackoverflow.com/users/9390370/woodhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1519837478, "creation_date": 1519836035, "question_id": 49034501, "link": "https://stackoverflow.com/questions/49034501/copy-and-pasting-with-vba-nullifies-formatting", "title": "Copy and pasting with VBA nullifies formatting", "body": "<p>I've written some VBA to copy and paste some data from one workbook into another:</p>\n\n<pre><code>Dim x As Workbook\nDim y As Workbook\n\n' Open both workbooks\nSet y = ActiveWorkbook\nSet x = Workbooks.Open(\"Data.csv\")\n\n' Copy data from x\nx.Sheets(\"SourceData\").Range(\"A1\", _\n    x.Sheets(\"SourceData\").Range(\"A1\").End(xlDown).End(xlToRight)).Copy\n\n' Paste to y\ny.Sheets(\"Destination\").Range(\"C4\").PasteSpecial Paste:=xlPasteValues\ny.Sheets(\"Destination\").Range(\"C4\").PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n\n<p>This pastes the data in the correct location. </p>\n\n<p>The next step of the VBA is to filter the data table by the first column which contains a date. However, the paste of the data converts everything to general data type, but more importantly seems to lose the 'date value' behind the string in the field. For example, when I try to format the date column following the paste, no other format type will change what appears in the cell (i.e. converting to number will still show 01/01/2018 rather than 43101). This causes the filtering code to hide all rows because there are no dates that fall within the parameters (because there are no dates essentially). I can't even manually filter on the dates (i.e. without VBA).</p>\n\n<p><a href=\"https://i.stack.imgur.com/u6EPK.png\" rel=\"nofollow noreferrer\">This image shows how the preview for each data type is still 20/02/2018.</a></p>\n\n<p>Whenever I manually copy and paste the data it works fine and I can format the dates in any way. It's just when using VBA that the formatting issues crop up.</p>\n\n<p>Amongst other things I've tried:</p>\n\n<ul>\n<li>Using VBA to format the columns in the source sheet before copy/pasting </li>\n<li>Using VBA to format the columns in the destination sheet after copy/pasting</li>\n<li>Moving the whole sheet into the destination workbook and copying/pasting from within the workbook (loses formatting upon moving sheet)</li>\n<li>Pasting values &amp; then pasting format over the top</li>\n<li>Using different file formats for the data file</li>\n</ul>\n\n<p>I wonder if the issue could be due to a setting in Excel? Any help greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1519836964, "creation_date": 1519836964, "answer_id": 49034782, "question_id": 49034407, "link": "https://stackoverflow.com/questions/49034407/copy-and-paste-into-a-new-sheet-that-is-created-in-the-same-vba-code/49034782#49034782", "title": "Copy and paste into a new sheet that is created in the same VBA code", "body": "<p>When you create the new sheet, reference it - like so:</p>\n\n<pre><code>Set sourceSheet = ActiveSheet\nSet destSheet = Sheets.Add(After:=sourceSheet)\n</code></pre>\n\n<p>You can now reference either the source worksheet or destination using <code>sourceSheet</code> and <code>destSheet</code>.</p>\n\n<p>Then you can apply a name to your <code>destSheet</code>:</p>\n\n<pre><code>destSheet.Name = sheet_name_to_create\n</code></pre>\n\n<p>And then you can copy/paste from source <em>to</em> destination sheet:</p>\n\n<pre><code>sourceSheet.Range(\"A1:AM73\").Copy destSheet\n</code></pre>\n\n<hr>\n\n<p>So your code becomes:</p>\n\n<pre><code>sheet_name_to_create = Blad1.Range(\"e33\").Value\n\nFor rep = 1 To (Worksheets.Count)\n    If LCase(Sheets(rep).Name) = LCase(sheet_name_to_create) Then\n        MsgBox \"This sheet already exists!)\"\n        Exit Sub\n    End If\nNext\nSet sourceSheet = ActiveSheet\nSet destSheet = Sheets.Add(After:=sourceSheet)\n\ndestSheet.Name = sheet_name_to_create\nsourceSheet.Range(\"A1:AM73\").Copy destSheet\nActiveWindow.Zoom = 25\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4653454, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8f48128838e21a78927b8fae4d3b3129?s=128&d=identicon&r=PG&f=1", "display_name": "Elin", "link": "https://stackoverflow.com/users/4653454/elin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519836964, "creation_date": 1519835790, "last_edit_date": 1531161705, "question_id": 49034407, "link": "https://stackoverflow.com/questions/49034407/copy-and-paste-into-a-new-sheet-that-is-created-in-the-same-vba-code", "title": "Copy and paste into a new sheet that is created in the same VBA code", "body": "<p>I can't find the answer to this question anywhere in here or at else on the internet! So please help me:</p>\n\n<h2>Objective</h2>\n\n<p>1) I wan't to create a new sheet that I name, 2) thereafter I wan't to copy specific cells into this newly created sheet. </p>\n\n<h2>Background</h2>\n\n<p>I've seen thousands of videos explaining the code to create a new sheet and name it after what I write in a certain cell, so far so good. I've also seen thousands where you copy values into an already existing sheet, nice. But I can't find anyone describing how to create a new sheet, named as Idefine in a specific cell, and then copy values into it; and when I'm changing the name in the specific cell, I want to copy to that the new sheet.</p>\n\n<p>Here's the code I did for the first part (working fine) and the second part (working not so fine):</p>\n\n<pre><code>        sheet_name_to_create = Blad1.Range(\"e33\").Value\n\n        For rep = 1 To (Worksheets.Count)\n            If LCase(Sheets(rep).Name) = LCase(sheet_name_to_create) Then\n            MsgBox \"This sheet already exists!)\"\n            Exit Sub\n            End If\n\n        Next\n\n        ' b\u00f6rja kopieringen\n\n\n            Sheets.Add After:=ActiveSheet\n            Sheets(ActiveSheet.Name).Name = sheet_name_to_create\n\n    'Second part trying to copy and paste\n    'Now I want to copy values in \"Blad1\" to the newly made sheet (\"sheet_name_to_create\"). I know these codes are wrong, but it's what I got:\n\n     Range(\"A1:AM73\").Select\n        Selection.Copy\n        Sheets.Add After:=ActiveSheet\n        ActiveSheet.Paste\n        ActiveWindow.Zoom = 25\n\n' Or\n\n    WorksWorksheets(\"Blad1\").Range (\"A1:AF80\").Copy Worksheets(\"sheet_name_to_create\").Range (\"A1:AF80\")\n</code></pre>\n\n<p>Please help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1519833337, "post_id": 49033510, "comment_id": 85071888, "body": "I believe you want <code>.Range()</code>, instead of <code>.Cells()</code> in the first part: <code>thisBook.sSheet.Range(&quot;K2&quot;, ...</code>.  You can&#39;t do, say, <code>Cells(&quot;A1&quot;,&quot;A10&quot;)</code>, instead you want <code>Range(&quot;A1&quot;,&quot;A10&quot;)</code>."}, {"owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519833477, "post_id": 49033510, "comment_id": 85071972, "body": "@BruceWayne I&#39;ve tried both, same error."}, {"owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519833590, "post_id": 49033510, "comment_id": 85072053, "body": "@BruceWayne Also, changing all instances of .Cells to .Range gives a runtime error 1004."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519833712, "post_id": 49033510, "comment_id": 85072150, "body": "Have you included <code>Option Explicit</code> at the top of the module?  And @BruceWayne is correct - you need to use Range() here"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519833773, "post_id": 49033510, "comment_id": 85072187, "body": "If rSheet and sSheet are already assigned then you don&#39;t need (eg) <code>thisBook.rSheet</code> - just use <code>rSheet</code>"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "edited": false, "score": 0, "creation_date": 1519838112, "post_id": 49033787, "comment_id": 85075012, "body": "Testing this, getting a runtime 1004 on &quot; rSheetVal = rsheet.Range(i, &quot;S&quot;).Value2  &quot;. The value of that cell is &quot; 1/14/2018 &quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "edited": false, "score": 0, "creation_date": 1519839882, "post_id": 49033787, "comment_id": 85076069, "body": "@SamBasso - D&#39;oh! That should be <code>.... = rsheet.Cells(i,&quot;S&quot;).Value2</code> I&#39;ll edit my post.  Also, I think it&#39;d work better with <code>Dim rSheetVal as Date</code>, not <code>Long</code>. If <code>Date</code> isn&#39;t working try <code>as String</code>."}, {"owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "edited": false, "score": 0, "creation_date": 1519840118, "post_id": 49033787, "comment_id": 85076201, "body": "That worked for the outputRng and rSheetVal lines. But now I get the runtime 438 on &quot; With thisBook.sSheet &quot; and I don&#39;t know whats even real anymore."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "edited": false, "score": 0, "creation_date": 1519843061, "post_id": 49033787, "comment_id": 85077661, "body": "@SamBasso - Hahhaha...Since I don&#39;t know how you declared <code>sSheet</code>, maybe you just need <code>With sSheet</code>? (Assuming you did <code>Dim sSheet as Worksheet &#47;&#47; Set sSheet = thisBook.Sheets(&quot;whatever&quot;)</code>?  If you can edit your OP to include how you declared all the variables, it would help."}, {"owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "edited": false, "score": 0, "creation_date": 1519912448, "post_id": 49033787, "comment_id": 85106775, "body": "With sSheet did it. Don&#39;t know why, but its going now, only problem is that the statement fails to count anything and I get a table full of 0s. Thats probably another question."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1519839901, "last_edit_date": 1519839901, "creation_date": 1519833872, "answer_id": 49033787, "question_id": 49033510, "link": "https://stackoverflow.com/questions/49033510/countifs-statement-compiles-but-fails-with-runtime-error-438/49033787#49033787", "title": "Countifs statement compiles but fails with runtime error 438", "body": "<p>Try this, slightly tweaked to make it easier (I hope) to read/follow:</p>\n\n<pre><code>Dim outputRng As Range\nDim rSheetVal as Date \nSet outputRng = rsheet.Range(i, \"T\")\nrSheetVal = rsheet.Cells(i, \"S\").Value2   ' OR, rsheet.Range(\"S\"&amp;i).Value2\n\nWith thisBook.sSheet\n    outputRng = Application.WorksheetFunction.CountIfs( _\n                .Range(\"K2\", \"K\" &amp; .Cells(Rows.Count, \"K\").End(xlUp).Row), \"APPROVED\", _\n                .Range(\"M2\", \"M\" &amp; .Cells(Rows.Count, \"M\").End(xlUp).Row), \"&gt;=\" &amp; (rSheetVal-6), _\n                .Range(\"M2\", \"M\" &amp; .Cells(Rows.Count, \"M\").End(xlUp).Row), \"&lt;=\" &amp; (rSheetVal))\nEnd With\n</code></pre>\n\n<p>Assuming the <code>thisBook</code> and <code>rsheet</code> are set like:</p>\n\n<pre><code>Set thisBook = ActiveWorkbook\nSet rSheet = thisBook.Sheets(\"r Sheet\")\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 8819666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0cd5f1f28ef4fc25aa993981452f16f6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Basso", "link": "https://stackoverflow.com/users/8819666/sam-basso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 49033787, "answer_count": 1, "score": 0, "last_activity_date": 1519839901, "creation_date": 1519833033, "last_edit_date": 1519839261, "question_id": 49033510, "link": "https://stackoverflow.com/questions/49033510/countifs-statement-compiles-but-fails-with-runtime-error-438", "title": "Countifs statement compiles but fails with runtime error 438", "body": "<p>I have a macro that builds charts on one sheet from data in other sheets in the same book. Currently, it compiles but stops on a countifs statement that looks at dates on one of the other sheets.</p>\n\n<p>The offending line is:</p>\n\n<pre><code>thisBook.rSheet.Range(i, \"T\") = Application.WorksheetFunction.CountIfs( _\nthisBook.sSheet.Cells(\"K2\", \"K\" &amp; sSheet.Cells(Rows.Count, \"K\").End(xlUp).Row), \"APPROVED\", _\nthisBook.sSheet.Cells(\"M2\", \"M\" &amp; sSheet.Cells(Rows.Count, \"M\").End(xlUp).Row), \"&gt;=\" &amp; (rSheet.Range(i, \"S\").Value2 - 6), _\nthisBook.sSheet.Cells(\"M2\", \"M\" &amp; sSheet.Cells(Rows.Count, \"M\").End(xlUp).Row), \"&lt;=\" &amp; (rSheet.Range(i, \"S\").Value2))\n</code></pre>\n\n<p>The statement is intended to count rows on another sheet where the text in column K equals \"APPROVED\" and has a date in column M within a specific week . i loops through the 8 rows of this table. Column S is the date that week ends.</p>\n\n<p>Everything has been fully referenced to avoid </p>\n\n<blockquote>\n  <p>runtime error 1004</p>\n</blockquote>\n\n<p>thisBook is the workbook, rSheet is the sheet with the charts, sSheet is the sheet with the table to evaluate.</p>\n\n<p>Which object doesn't support the property or method here?</p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1519851139, "post_id": 49033498, "comment_id": 85081847, "body": "Concatenate string variables. Exactly what is the issue you are having? The second table code is not a complete procedure. Where is this code and how do you call it?"}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1519922683, "last_edit_date": 1519922683, "creation_date": 1519907452, "answer_id": 49049779, "question_id": 49033498, "link": "https://stackoverflow.com/questions/49033498/formatting-two-data-tables-in-outlook-mail/49049779#49049779", "title": "Formatting two data tables in Outlook mail", "body": "<p>I have not looked at your tables yet, but the code to build the Html document is faulty.</p>\n\n<pre><code>.HTMLBody = .HTMLBody &amp; gDCMBodyText\n\n.HTMLBody = .HTMLBody &amp; \"&lt;HTML&gt;&lt;BODY&gt;\" &amp; strFntNormal &amp; strTableBody &amp; \" &lt;/BODY&gt;&lt;/HTML&gt;\"\n\n.HTMLBody = .HTMLBody &amp; gDCMBodySig\n</code></pre>\n\n<p>I cannot find <code>gDCMBodyText</code> and no previous statement has placed anything in <code>HtmlBody</code> so why are you concatenating to it?</p>\n\n<p><code>&lt;HTML&gt;</code> must come first and <code>&lt;/HTML&gt;</code> must come last.</p>\n\n<p>You mention in your question you want to include text but I am unclear where.</p>\n\n<p>I suggest something like the following:</p>\n\n<pre><code>Dim Table1 As string    ' First table: &lt;table&gt; ... &lt;/table&gt;\nDim Table2 As string    ' Second table: &lt;table&gt; ... &lt;/table&gt;\nDim TextPre As string   ' Text to come before first table\nDim TextMid As string   ' Text to come between tables\nDim TextPost As string  ' Text to come after second table\n</code></pre>\n\n<p>Assign appropriate values to the above strings then</p>\n\n<pre><code>.HtmlBody = \"&lt;html&gt;&lt;body&gt;\" &amp; vbLf &amp; _\n            TextPre &amp; vbLf &amp; _\n            Table1 &amp; vbLf &amp; _\n            TextMid &amp; vbLf &amp; _\n            TextPost &amp; vbLf &amp; _ \n            \"&lt;/body&gt;&lt;/html&gt;\"\n</code></pre>\n\n<p><strong>Part 2</strong></p>\n\n<p>I would treat this as four different problems: (1) format table 1 correctly, (2) format table 2 correctly, (3) combine tables correctly and (4) create HtmlBody.</p>\n\n<p>For problems such as 1, 2 and 3, I use the routines below.  Macro HtmlDoc combines a Head and Body element into a simple Html document.  This is no big deal but it does make life a little simpler.  Macro PutTextFileUtf8 outputs a string as a UTF-8 file.  Note 1: UTF-8 is the default coding for Html files and allows any Unicode character within a file.  Note 2: This macro requires a reference to \"Microsoft ActiveX Data Objects n.n Library\".</p>\n\n<p>I would use these routines to (1) check Table 1 was being created correctly, (2) check Table 2 was being created correctly and (3) check the tables are being combined correctly.  If any of the files are not as I wish, I can look at the text file.  Looking at the Html body of a mis-formatted email is more difficult.  </p>\n\n<pre><code>Function HtmlDoc(ByVal Head As String, ByVal Body As String)\n\n  ' Returns a simple Hhml document created from Head and Body\n\n  HtmlDoc = \"&lt;!DOCTYPE html&gt;\" &amp; vbLf &amp; \"&lt;html&gt;\" &amp; vbLf\n  If Head &lt;&gt; \"\" Then\n    HtmlDoc = HtmlDoc &amp; \"&lt;head&gt;\" &amp; vbLf &amp; Head &amp; vbLf &amp; \"&lt;/head&gt;\" &amp; vbLf\n  End If\n  HtmlDoc = HtmlDoc &amp; \"&lt;body&gt;\" &amp; vbLf &amp; Body &amp; vbLf &amp; \"&lt;/body&gt;\" &amp; vbLf\n  HtmlDoc = HtmlDoc &amp; \"&lt;/html&gt;\"\n\nEnd Function\nPublic Sub PutTextFileUtf8(ByVal PathFileName As String, ByVal FileBody As String)\n\n  ' Outputs FileBody as a text file (UTF-8 encoding without leading BOM)\n  ' named PathFileName\n\n  ' Needs reference to \"Microsoft ActiveX Data Objects n.n Library\"\n  ' Addition to original code says version 2.5. Tested with version 6.1.\n\n  '  1Nov16  Copied from http://stackoverflow.com/a/4461250/973283\n  '          but replaced literals with parameters.\n  ' 15Aug17  Discovered routine was adding an LF to the end of the file.\n  '          Added code to discard that LF.\n\n  ' References: http://stackoverflow.com/a/4461250/973283\n  '             https://www.w3schools.com/asp/ado_ref_stream.asp\n\n  Dim BinaryStream As Object\n  Dim UTFStream As Object\n\n  Set UTFStream = CreateObject(\"adodb.stream\")\n\n  UTFStream.Type = adTypeText\n  UTFStream.Mode = adModeReadWrite\n  UTFStream.Charset = \"UTF-8\"\n  ' The LineSeparator will be added to the end of FileBody. It is possible\n  ' to select a different value for LineSeparator but I can find nothing to\n  ' suggest it is possible to not add anything to the end of FileBody\n  UTFStream.LineSeparator = adLF\n  UTFStream.Open\n  UTFStream.WriteText FileBody, adWriteLine\n\n  UTFStream.Position = 3 'skip BOM\n\n  Set BinaryStream = CreateObject(\"adodb.stream\")\n  BinaryStream.Type = adTypeBinary\n  BinaryStream.Mode = adModeReadWrite\n  BinaryStream.Open\n\n  UTFStream.CopyTo BinaryStream\n\n  ' Originally I planned to use \"CopyTo Dest, NumChars\" to not copy the last\n  ' byte.  However, NumChars is described as an integer whereas Position is\n  ' described as Long. I was concerned that by \"integer\" they mean 16 bits.\n  BinaryStream.Position = BinaryStream.Position - 1\n  BinaryStream.SetEOS\n\n  UTFStream.Flush\n  UTFStream.Close\n  Set UTFStream = Nothing\n\n  BinaryStream.SaveToFile PathFileName, adSaveCreateOverWrite\n  BinaryStream.Flush\n  BinaryStream.Close\n  Set BinaryStream = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><strong>Part 3</strong></p>\n\n<p>In <code>&lt;TD align = 'left'&gt;Card Type&lt;/TD&gt;</code>, <code>align = 'left'</code> is the default so can be omitted.</p>\n\n<p>More importantly, the align attribute was depreciated in Html 4 and I cannot find it in Html 5.  Use of CSS is recommended.</p>\n\n<p>I suggest you output a HEAD element like this:</p>\n\n<pre><code>  &lt;head&gt;\n    &lt;style&gt;\n      table {border-collapse:collapse;}\n      td {border-style:solid; border-width:1px; border-color:#BFBFBF;}\n       tr.bc-lb {background-color:lightblue;}\n       td.ha-c {text-align:center;}\n      td.ha-r {text-align:right;}\n    &lt;/style&gt;\n  &lt;head&gt;\n</code></pre>\n\n<p>and TR and TD elements like this:</p>\n\n<pre><code>&lt;tr class= \u201cbg-lb\u201d&gt;\n&lt;td&gt;Card Type&lt;/td&gt;\n&lt;td class=\u201cha-c\u201c&gt;Trans Date&lt;/td&gt;\"\n&lt;td class=\u201cha-r\u201c&gt;Trans Amt&lt;/td&gt;\"\n</code></pre>\n\n<p><code>table {border-collapse:collapse;}</code> specifies CSS collapse table model.  The difference between the collapse and separate models is only visible if you have cell borders.  With collapse the borders touch but with separate there is a small gap between them.</p>\n\n<p><code>td {border-style:solid; border-width:1px; border-color:#BFBFBF;}</code> specifies every cell is to have a solid, thin border that is coloured dark grey which I prefer to black.</p>\n\n<p><code>tr.bc-lb {background-color:lightblue;}</code> allows me to set the background colour for a row to light blue by including <code>class= \u201cbg-lb\u201d</code>within the TR start tag.</p>\n\n<p>I think the other styles and their use can be deduced from the above information.  </p>\n\n<p><strong>Summary</strong></p>\n\n<p>Without access to your system I cannot test any rewritten versions of your code.  I hope I have given you enough information to allow you to amend your own code.</p>\n"}], "owner": {"reputation": 105, "user_id": 9169197, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b589be7775ae21b764f01ff018cc066b?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/9169197/katie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593041462, "creation_date": 1519832983, "last_edit_date": 1593041462, "question_id": 49033498, "link": "https://stackoverflow.com/questions/49033498/formatting-two-data-tables-in-outlook-mail", "title": "Formatting two data tables in Outlook mail", "body": "<p>I am trying to put two data tables into an email.</p>\n\n<p>I have VBA code to include one table. The data for the second table is in tEmailData, which relates to the tDistinct_DCMs table as well on the DCM_Email field.</p>\n\n<p>I've provided my current VBA for the email, and the VBA format for the second table.</p>\n\n<p>How can I add that table after the first table and a short paragraph of text?</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Sub DCMEmailReviewVBA()\n\n    Dim rst As DAO.Recordset\n    Dim olApp As Outlook.Application\n    Dim objMail As Outlook.MailItem\n    Dim rst2 As DAO.Recordset\n    Dim strTableBeg As String\n    Dim strTableBody As String\n    Dim strTableEnd As String\n    Dim strFntNormal As String\n    Dim strTableHeader As String\n    Dim strFntEnd As String\n\n    Set rst2 = CurrentDb.OpenRecordset(\"select distinct DCM_email from tDistinct_DCMs\")\n    rst2.MoveFirst\n\n    'Create e-mail item\n    Set olApp = Outlook.Application\n    Set objMail = olApp.CreateItem(olMailItem)\n\n    'Do Until rst2.EOF\n\n    Set olApp = Outlook.Application\n    Set objMail = olApp.CreateItem(olMailItem)\n\n    'Define format for output\n    strTableBeg = \"&lt;table border=1 cellpadding=3 cellspacing=0&gt;\"\n    strTableEnd = \"&lt;/table&gt;\"\n    strTableHeader = \"&lt;font size=3 face=\" &amp; Chr(34) &amp; \"Calibri\" &amp; Chr(34) &amp; \"&gt;&lt;b&gt;\" &amp; _\n                        \"&lt;tr bgcolor=lightBlue&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;Status&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;First Name&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;Last Name&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;UIN&lt;/TD&gt;\" &amp; _\n                            \"&lt;/tr&gt;&lt;/b&gt;&lt;/font&gt;\"\n    strFntNormal = \"&lt;font color=black face=\" &amp; Chr(34) &amp; \"Calibri\" &amp; Chr(34) &amp; \" size=3&gt;\"\n    strFntEnd = \"&lt;/font&gt;\"\n\n    Set rst = CurrentDb.OpenRecordset(\"SELECT * FROM tFinalDCM_EmailList where DCM_Email='\" &amp; rst2!DCM_Email &amp; \"' Order by [Cardholder_UIN] asc\")\n    rst.MoveFirst\n\n\n\n    'Build HTML Output for the DataSet\n    strTableBody = strTableBeg &amp; strFntNormal &amp; strTableHeader\n\n\n\n    Do Until rst.EOF\n        strTableBody = strTableBody &amp; _\n                        \"&lt;tr&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst![Action] &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst![Cardholder First Name] &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst![Cardholder Last Name] &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst![Cardholder_UIN] &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;/tr&gt;\"\n\n        rst.MoveNext\n    Loop\n    'rst.MoveFirst\n\n    strTableBody = strTableBody &amp; strFntEnd &amp; strTableEnd\n\n\n    'rst.Close\n\n    'Set rst2 = CurrentDb.OpenRecordset(\"select distinct ch_email from t_TCard_CH_Email\")\n    'rst2.MoveFirst\n\n\n\nCall CaptureDCMBodyText\n\n    With objMail\n        'Set body format to HTML\n        .To = rst2!DCM_Email\n        .BCC = gDCMEmailBCC\n        .Subject = gDCMEmailSubject\n        .BodyFormat = olFormatHTML\n\n        .HTMLBody = .HTMLBody &amp; gDCMBodyText\n\n        .HTMLBody = .HTMLBody &amp; \"&lt;HTML&gt;&lt;BODY&gt;\" &amp; strFntNormal &amp; strTableBody &amp; \" &lt;/BODY&gt;&lt;/HTML&gt;\"\n\n        .HTMLBody = .HTMLBody &amp; gDCMBodySig\n\n        .SentOnBehalfOfName = \"...\"\n        .Display\n        '.Send\n    End With\n\n    rst2.MoveNext\n\n'Loop\n\nClean_Up:\n    rst.Close\n    rst2.Close\n\n    Set rst = Nothing\n    Set rst2 = Nothing\n    'Set dbs = Nothing\n\n\nEnd Sub\n\nFunction td(strIn As String) As String\n    td = \"&lt;TD nowrap&gt;\" &amp; strIn &amp; \"&lt;/TD&gt;\"\nEnd Function\n</code></pre>\n\n<p>VBA for desired second table:</p>\n\n<pre><code>strTableBeg = \"&lt;table border=1 cellpadding=3 cellspacing=0&gt;\"\n    strTableEnd = \"&lt;/table&gt;\"\n    strTableHeader = \"&lt;font size=3 face=\" &amp; Chr(34) &amp; \"Calibri\" &amp; Chr(34) &amp; \"&gt;&lt;b&gt;\" &amp; _\n                        \"&lt;tr bgcolor=lightblue&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;Card Type&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;Cardholder&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;ER or Doc No&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'center'&gt;Trans Date&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;Vendor&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'right'&gt;Trans Amt&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;TEM Activity Name or P-Card Log No&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;Status&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'right'&gt;Aging&lt;/TD&gt;\" &amp; _\n                           \"&lt;/tr&gt;&lt;/b&gt;&lt;/font&gt;\"\n\n    strFntNormal = \"&lt;font color=black face=\" &amp; Chr(34) &amp; \"Calibri\" &amp; Chr(34) &amp; \" size=3&gt;\"\n    strFntEnd = \"&lt;/font&gt;\"\n\n    Set rst = CurrentDb.OpenRecordset(\"SELECT * FROM tEmailData where DCM_email='\" &amp; rst2!DCM_Email &amp; \"' Order by Cardholder, Card_Type asc\")\n    rst.MoveFirst\n\n\n\n    'Build HTML Output for the DataSet\n    strTableBody = strTableBeg &amp; strFntNormal &amp; strTableHeader\n\n\n\n    Do Until rst.EOF\n        strTableBody = strTableBody &amp; _\n                        \"&lt;tr&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst!Card_Type &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst!Cardholder &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst!ERNumber_DocNumber &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'center'&gt;\" &amp; rst!Trans_Date &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst!Vendor &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'right'&gt;\" &amp; Format(rst!Trans_Amt, \"currency\") &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst!ACTIVITY_Log_No &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'left'&gt;\" &amp; rst!Status &amp; \"&lt;/TD&gt;\" &amp; _\n                            \"&lt;TD align = 'right'&gt;\" &amp; rst!Aging &amp; \"&lt;/TD&gt;\" &amp; _\n                        \"&lt;/tr&gt;\"\n\n        rst.MoveNext\n    Loop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519832569, "post_id": 49033300, "comment_id": 85071334, "body": "What exactly is your problem?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519832815, "post_id": 49033300, "comment_id": 85071514, "body": "What if there is more than 3 occurences of the date? Also what&#39;s the difference between <code>n&#47;a</code> and a blank space? Like what would you do for 13/04/2018, which occurs 4 times?"}, {"owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519833834, "post_id": 49033300, "comment_id": 85072228, "body": "@SJR - While I have the count output from the dictionary function, I would like to identify the cell so then I can print out the corresponding column header @ the row identifier, as shown in the screenshot."}, {"owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519833839, "post_id": 49033300, "comment_id": 85072237, "body": "@dwirony - Nothing, i just whipped up a basic one to show, I will amend it so they are all blank. And if the the date appears four times, as you have stated, i would like then to put put into the next columns, so k and l in the screenshot."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519833894, "post_id": 49033300, "comment_id": 85072277, "body": "@Infernez If it appears 4 times then it would be in I, J, K and L then, no?"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1519910795, "post_id": 49033940, "comment_id": 85105728, "body": "That is perfect.   Thank you.  Just one thing, How would I make the outputs ascend from earliest date to the latest date, in the VBA code.  Additionally if I had 5 events, Do i just add the next column along to your code?"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1519834372, "creation_date": 1519834372, "answer_id": 49033940, "question_id": 49033300, "link": "https://stackoverflow.com/questions/49033300/count-and-print-from-an-range/49033940#49033940", "title": "Count and Print from an range", "body": "<p>Took a shot at this. Just a couple nested loops testing against the dates, making sure that the date found isn't already listed under the date column. As I stated before, you never said what to do if more than 3 dates are found, so I had to add a fourth event column and assume that that's the max. Anything more than 4 dates won't be recorded anywhere, FYI.</p>\n\n<pre><code>Sub MoveDates()\n\nDim i As Long, j As Long, sht As Worksheet, lastrow As Long, lastrow2 As Long, refrow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\nlastrow = sht.Cells(sht.Rows.Count, \"B\").End(xlUp).Row\nlastrow2 = sht.Cells(sht.Rows.Count, \"H\").End(xlUp).Row + 1\n\nFor i = 4 To lastrow\n    For j = 3 To 6\n        If Cells(i, j).Value &lt;&gt; \"\" And Cells(i, j).Value &lt;&gt; \"n/a\" Then\n            If Not Application.WorksheetFunction.CountIf(Range(\"H4:H\" &amp; lastrow), Cells(i, j)) &gt; 0 Then\n                lastrow2 = sht.Cells(sht.Rows.Count, \"H\").End(xlUp).Row + 1\n                Range(\"H\" &amp; lastrow2).Value = Cells(i, j).Value\n\n                If Range(\"I\" &amp; lastrow2).Value = \"\" Then\n                    Range(\"I\" &amp; lastrow2).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                ElseIf Range(\"J\" &amp; lastrow2).Value = \"\" Then\n                    Range(\"J\" &amp; lastrow2).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                ElseIf Range(\"K\" &amp; lastrow2).Value = \"\" Then\n                    Range(\"K\" &amp; lastrow2).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                ElseIf Range(\"L\" &amp; lastrow2).Value = \"\" Then\n                    Range(\"L\" &amp; lastrow2).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                End If\n\n            Else\n                lastrow2 = sht.Cells(sht.Rows.Count, \"H\").End(xlUp).Row\n\n                For k = 4 To lastrow2\n                    If Range(\"H\" &amp; k).Value = Cells(i, j).Value Then\n                        refrow = k\n                        Exit For\n                    End If\n                Next k\n\n                If Range(\"I\" &amp; refrow).Value = \"\" Then\n                    Range(\"I\" &amp; refrow).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                ElseIf Range(\"J\" &amp; refrow).Value = \"\" Then\n                    Range(\"J\" &amp; refrow).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                ElseIf Range(\"K\" &amp; refrow).Value = \"\" Then\n                    Range(\"K\" &amp; refrow).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                ElseIf Range(\"L\" &amp; refrow).Value = \"\" Then\n                    Range(\"L\" &amp; refrow).Value = Cells(3, j).Value &amp; \" @ \" &amp; Cells(i, 2).Value\n                End If\n            End If\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rNNUy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rNNUy.png\" alt=\"Before After\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1519989439, "post_id": 49034715, "comment_id": 85140987, "body": "@ Displayname - I shall try this function now and report back."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1519990137, "post_id": 49034715, "comment_id": 85141268, "body": "@Infernez, What I meant in my other post comment is that you are supposed to select answers that solve your questions (if any) and mark them as accepted (you can accept one solution per question). Or you may upvote it if it was useful although wasn&#39;t the accepted one. Or you may do nothing, if any of those apply. But from your comments here and there I feel that you should accept and/or upvote many of the answers you received."}, {"owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1519990256, "post_id": 49034715, "comment_id": 85141332, "body": "Not enough &#39;rep&#39; to up vote yet, otherwise I would have."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1519990774, "post_id": 49034715, "comment_id": 85141594, "body": "Well, giving feedback is one of the ways to gain rep. As for this question, may I ask why did you choose the other answer?"}, {"owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1520054344, "post_id": 49034715, "comment_id": 85167468, "body": "It was in a language I understood better than yours, and I need to resolve the solution pronto. I will try your solution properly when I have more time."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1520060426, "post_id": 49034715, "comment_id": 85168581, "body": "I see. Well when you&#39;ll get there consider that loops and If-Then-Else are things you want to limit (if not avoid) for the sake of code speed and maintenance so: 1 loop is (much) better than three nested loops and 2 simple &quot;If-Then-End If&quot; are (much) better than 4 to 5 nested &quot;IF-Then-ElseiF-End IF&quot;. And, from a maintenance point of view again, a 10 lines code is (much) better than  a 40 lines one..."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1519836757, "creation_date": 1519836757, "answer_id": 49034715, "question_id": 49033300, "link": "https://stackoverflow.com/questions/49033300/count-and-print-from-an-range/49034715#49034715", "title": "Count and Print from an range", "body": "<p>you can go this way</p>\n\n<pre><code>Option Explicit\n\nSub Tasks()\n    Dim cell As Range, f As Range\n\n    With Worksheets(\"schools\") 'change \"schools\" to your actual sheet name\n        For Each cell In .Range(\"C4:F\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row) 'reference its column C:F from row 4 down to column B last not empty cell\n            If IsDate(cell.value) Then 'if current cell value is a valid date\n                Set f = .Range(\"H3\", .Cells(.Rows.Count, \"H\").End(xlUp)).Find(what:=cell.value, lookat:=xlWhole, LookIn:=xlValues) 'try finding the date in column H\n                If f Is Nothing Then Set f = .Cells(.Rows.Count, \"H\").End(xlUp).Offset(1) 'if date not already in column H then get its first empty cell after last not empty one \n                f.value = cell.value 'write the date (this is sometimes not necessary, but not to \"ruin\" the code)\n                .Cells(f.Row, .Columns.Count).End(xlToLeft).Offset(, 1).value = .Cells(3, cell.Column).value &amp; \" @\" &amp; .Cells(cell.Row, 2).value ' write the record in the first not empty cell in the \"date\" row\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 49034715, "answer_count": 2, "score": 0, "last_activity_date": 1519840544, "creation_date": 1519832360, "last_edit_date": 1531164843, "question_id": 49033300, "link": "https://stackoverflow.com/questions/49033300/count-and-print-from-an-range", "title": "Count and Print from an range", "body": "<p>I have an array of data, a screenshot of it will be linked at the bottom of this text. Row and column references are to the screenshot.</p>\n\n<p>I am trying to write a macro that will output all the dates that <strong>occur</strong> within the dynamic range (Column H). And then in column I I want the column <strong>header</strong> @ <strong>row</strong> i.e I4. </p>\n\n<p>But if there is more than 1 count at the date, I would like the second school to output into column J. As it would for the date 26/03/18, looking like this:</p>\n\n<p>h5 = 26/03/18 , i5(Event1) = Task 2 @ 1, j5(Event2) = task 2 @ 4</p>\n\n<p>I have tried many ways today and would like some assistance.</p>\n\n<p>Screenshot: <a href=\"https://ibb.co/cmiGSc\" rel=\"nofollow noreferrer\">https://ibb.co/cmiGSc</a></p>\n\n<p>My Code thus far(For the more complex sheet):</p>\n\n<pre><code>Sub Events()\n'How many schools there are\nDim sh As Worksheet\n' This needs to change for each sheets\nSet sh = ThisWorkbook.Sheets(\"Easter 18\")\nDim k As Long\n\nk = sh.Range(\"A3\").End(xlDown).Row 'Counts up from bottow - Number of schools attained\nRo = Range(\"M52\").value = k - 2 'Elimiates the two top rows as headers\n\n'Now I need to search the Range of dates\nDim TaskDates As Range\nDim StartCell  As Range 'First part of Array\nDim EndCell As Range 'End of Array\nSet EndCell = Range(\"J\" &amp; 2 + k) 'maybe 2 or 3\nSet StartCell = Range(\"G3\")\nSet TaskDates = Range(StartCell, EndCell) 'Dynamic Range\n\n'Within the range of data print out the most left row header (school name) - and task with @ in the middle - ascending\n' If Column has date (true) create a table with Date (col 1), Event (col 2), Event 2 (Col3) etc etc\nDim dict As Object\nSet dict = CreateObject(\"scripting.dictionary\")\nDim varray As Variant, element As Variant\nvarray = TaskDates.value\n\n'Generate unique list and count\nFor Each element In varray\nIf dict.exists(element) Then\n    dict.item(element) = dict.item(element) + 1\n   Else\n    dict.Add element, 1\n   End If\nNext\n\n   'Paste report somewhere -\n   'First line ouptuts the dates occured\n   sh.Range(\"M55\").Resize(dict.Count).value =     'Was working now saying syntax error for this line. \n       WorksheetFunction.Transpose (dict.keys)\n   ' The count works if cell format is correct\n   CDates = sh.Range(\"N55\").Resize(dict.Count, 1).value = _\n       WorksheetFunction.Transpose(dict.items)\nEnd Sub\n</code></pre>\n\n<p>Please feel free to redesign it if you see fit. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "edited": false, "score": 1, "creation_date": 1519832326, "post_id": 49033220, "comment_id": 85071159, "body": "What&#39;s the format you want to check?"}, {"owner": {"reputation": 37, "user_id": 9204595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21936e03e6d3dc7324e7dcc4776f9e6d?s=128&d=identicon&r=PG&f=1", "display_name": "enginer", "link": "https://stackoverflow.com/users/9204595/enginer"}, "reply_to_user": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "edited": false, "score": 0, "creation_date": 1519832453, "post_id": 49033220, "comment_id": 85071256, "body": "Alex Martinez,  the  format  that i want to check if there are spaces useless"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1519834604, "post_id": 49033220, "comment_id": 85072689, "body": "The trim function is going to remove leading and trailing spaces.  So you won&#39;t be checking for those any longer.  Do you mean too many spaces between strings in the case of a multiple word string or do you mean if the cell is empty.  You want to format before you delete those spaces?  I am not sure anyone knows what to do with this."}, {"owner": {"reputation": 37, "user_id": 9204595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21936e03e6d3dc7324e7dcc4776f9e6d?s=128&d=identicon&r=PG&f=1", "display_name": "enginer", "link": "https://stackoverflow.com/users/9204595/enginer"}, "edited": false, "score": 0, "creation_date": 1519835108, "post_id": 49033220, "comment_id": 85073030, "body": "Wookies-Will-Code I want to delete the spaces before and afther description not between words"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519833368, "post_id": 49033470, "comment_id": 85071908, "body": "@DisplayName - yup, otherwise the <code>With-End with</code> was quite useless, but it was working well w/o them :)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519833741, "post_id": 49033470, "comment_id": 85072169, "body": "you know the difference: <code>Worksheetfunction.Trim()</code> detects inner spaces also while VBA <code>Trim()</code> doesn&#39;t. So if OP&#39;s interested in detecting inner <i>useless</i> spaces, then that &quot;dot&quot; is mandatory"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519833803, "post_id": 49033470, "comment_id": 85072203, "body": "BTW I&#39;d move <code>With ... End With</code> outside the <code>For Each</code> loop"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519833872, "post_id": 49033470, "comment_id": 85072261, "body": "@DisplayName - inner useless spaces? Can you give an example, I am somehow missing your point?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519833965, "post_id": 49033470, "comment_id": 85072323, "body": "In <i>Immediate Window</i> <code>?len(&quot;| 1  2 |&quot;),len(worksheetfunction.trim(&quot;| 1  2 |&quot;)), len(trim(&quot;| 1  2 |&quot;))</code> would output ` 8             7             8 `"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519834084, "post_id": 49033470, "comment_id": 85072391, "body": "@DisplayName - great example,I suppose that you are away from keyboard now &amp; chatting from your phone?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1519834232, "post_id": 49033470, "comment_id": 85072486, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/165982/discussion-between-displayname-and-vityata\">continue this discussion in chat</a>."}, {"owner": {"reputation": 37, "user_id": 9204595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21936e03e6d3dc7324e7dcc4776f9e6d?s=128&d=identicon&r=PG&f=1", "display_name": "enginer", "link": "https://stackoverflow.com/users/9204595/enginer"}, "edited": false, "score": 0, "creation_date": 1519835197, "post_id": 49033470, "comment_id": 85073079, "body": "nothing happens with this code Vityata, I want to check if my columns are in good format (the good format that there are spaces neither before nor after not between words) if it is not the right format the bottom becomes red and the white writing"}, {"owner": {"reputation": 37, "user_id": 9204595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21936e03e6d3dc7324e7dcc4776f9e6d?s=128&d=identicon&r=PG&f=1", "display_name": "enginer", "link": "https://stackoverflow.com/users/9204595/enginer"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1519836539, "post_id": 49033470, "comment_id": 85074001, "body": "sorry i want  just none at the start/end (VBA TRIM) and only singles (Worksheet TRIM) elsewhere? @pnuts"}, {"owner": {"reputation": 37, "user_id": 9204595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21936e03e6d3dc7324e7dcc4776f9e6d?s=128&d=identicon&r=PG&f=1", "display_name": "enginer", "link": "https://stackoverflow.com/users/9204595/enginer"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1519837265, "post_id": 49033470, "comment_id": 85074495, "body": "i want just colour  the &#39;rogues&#39; can you help me please @pnuts"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1519834834, "last_edit_date": 1519834834, "creation_date": 1519832925, "answer_id": 49033470, "question_id": 49033220, "link": "https://stackoverflow.com/questions/49033220/color-a-column-with-vba-if-it-has-a-space-at-the-end/49033470#49033470", "title": "Color a column with VBA, if it has a space at the end", "body": "<p>Considering that you want to check only the cells in the Range(\"E:V\"), which are within the <code>UsedRange</code> judging from your code:</p>\n\n<pre><code>Sub DeleteSpaces()\n\n    Dim myCell          As Range\n    Dim checkIntersect  As Range\n    Dim ws              As Worksheet\n\n    Set ws = ActiveSheet\n    Set checkIntersect = ws.Range(\"E:V\")\n\n    With WorksheetFunction\n        For Each myCell In Intersect(ws.UsedRange, checkIntersect)\n            If Len(.Trim(myCell)) &lt;&gt; Len(myCell) Then myCell.Interior.Color = vbRed\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The idea is to compare <code>Len(.Trim(myCell))</code> with <code>Len(myCell)</code>, and if it is different to color the interior in <code>vbRed</code>. <code>myCell</code> is used as a variable, just for aesthetic reasons.</p>\n"}], "owner": {"reputation": 37, "user_id": 9204595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21936e03e6d3dc7324e7dcc4776f9e6d?s=128&d=identicon&r=PG&f=1", "display_name": "enginer", "link": "https://stackoverflow.com/users/9204595/enginer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49033470, "answer_count": 1, "score": 1, "last_activity_date": 1519836608, "creation_date": 1519832144, "last_edit_date": 1519836608, "question_id": 49033220, "link": "https://stackoverflow.com/questions/49033220/color-a-column-with-vba-if-it-has-a-space-at-the-end", "title": "Color a column with VBA, if it has a space at the end", "body": "<p>The purpose of the (program) macro is to check the data in the table columns to see if they are in the correct format. If they are not in the correct format, the line is marked in red (background color) and the writing of the badly formatted box (or boxes) is blank. So how can I color if the format ( the format that i want to check if there are spaces useless )is not good?\ncan someone konw how</p>\n\n<pre><code>Sub deletespace()\n'deleteespace_description Macro\n    Dim cell As Range\n    Range(\"E:V\").Select\n    For Each cell In ActiveSheet.UsedRange\n        cell = Application.WorksheetFunction.Trim(cell)\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "string"], "answers": [{"comments": [{"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 1, "creation_date": 1519839415, "post_id": 49035020, "comment_id": 85075833, "body": "Ok, thanks, thats a good idea. a work around. Every part of the cell will have to be compared character by character with the original one. I will probably need a step in between since I am separating a String into substrings keeping the colors. Another idea is to paste the whole range in several cells (with style) and then delete the part of the string not necesary."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1519840795, "post_id": 49035020, "comment_id": 85076518, "body": "Yes I see that using text to columns loses the formatting. What you could do is loop through the original string and store the position of bold etc characters in an array, then split your string and then apply the stored values in the array to the individual strings. If your formatting applies only to whole words you can also shorten the loop a little."}, {"owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1519897779, "post_id": 49035020, "comment_id": 85098245, "body": "yes the formating applies just to words. How would that shorten the loop? How would you loop word by word? thks"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "edited": false, "score": 0, "creation_date": 1519899729, "post_id": 49035020, "comment_id": 85099296, "body": "As soon as you find an e.g. bold character you know every successive character will also be bold until you find the next space (or full stop presumably), using Instr, so you don&#39;t need to check each one. In practice it might not be worth the bother but worth at least considering."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1519837736, "creation_date": 1519837736, "answer_id": 49035020, "question_id": 49033166, "link": "https://stackoverflow.com/questions/49033166/extract-part-of-a-string-of-a-cell-with-format-bold-and-color-and-underline/49035020#49035020", "title": "extract part of a string of a cell WITH format (bold and color and underline)", "body": "<p>This might help - I don't know of a shorter way. If formatted text in A1 is copied to B1 this is an illustration of how to capture the formatting of individual characters.</p>\n\n<pre><code>Sub x()\n\nDim i As Long\n\nRange(\"B1\").Value = Range(\"A1\").Value\n\nFor i = 1 To Len(Range(\"B1\"))\n    Range(\"B1\").Characters(i, 1).Font.Bold = Range(\"A1\").Characters(i, 1).Font.Bold\n    Range(\"B1\").Characters(i, 1).Font.Color = Range(\"A1\").Characters(i, 1).Font.Color\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zI2Ve.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zI2Ve.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "is_accepted": false, "score": 0, "last_activity_date": 1520961115, "creation_date": 1520961115, "answer_id": 49262037, "question_id": 49033166, "link": "https://stackoverflow.com/questions/49033166/extract-part-of-a-string-of-a-cell-with-format-bold-and-color-and-underline/49262037#49262037", "title": "extract part of a string of a cell WITH format (bold and color and underline)", "body": "<p>Thanks SJR here the code that\na) divide the string of a cell X into different parts\nb) copy the different parts INCLUDING THE ORIGINAL LAYOUT off every character in cell X</p>\n\n<pre><code>Private Sub copy_font()\n'purpose of this sub:\n'divide a string of a cell into parts and paste the parts into other cells\n'KEEPING THE FONT AND COLOR OF THE ORIGINAL CELL\n'WHEREIN IN THE ORIGINAL CELL ALL KIND OF MIX FONTS AND COLORS OCCUR\n\nDim MySht As Worksheet\nSet MySht = ThisWorkbook.Sheets(\"font\")\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim myString As String\nDim StartCharacter As Integer\nDim EndCharacter As Integer\nDim numberofSimbols As Integer\nDim myStr As String\n\n'any string value in a particular cell\nmyString = MySht.Cells(1, 1).Value\n'imagine I want to divide the text everytime a simbol \"&lt;&lt;\" appears\nnumberofSimbols = (Len(myString) - Len(Replace(myString, \"&lt;&lt;\", \"\"))) / 2\n\nStartCharacter = 1\nEndCharacter = InStr(StartCharacter, myString, \"&lt;&lt;\")\n\nFor j = 1 To numberofSimbols + 1\n    'copy the value string into another cell (I chose here the cells in the row where myString is\n    MySht.Cells(1, j + 1).Value = Mid(myString, StartCharacter, EndCharacter - StartCharacter)\n\n    Debug.Print j, StartCharacter, EndCharacter, Mid(myString, StartCharacter, EndCharacter - 1)\n    'loop to pass the font/color/underline...etc\n    k = 0\n    For i = StartCharacter To EndCharacter - 1\n        k = k + 1\n        MySht.Cells(1, j + 1).Characters(k, 1).Font.Bold = Range(\"a1\").Characters(i, 1).Font.Bold\n        MySht.Cells(1, j + 1).Characters(k, 1).Font.Color = Range(\"a1\").Characters(i, 1).Font.Color\n        MySht.Cells(1, j + 1).Characters(k, 1).Font.Bold = Range(\"a1\").Characters(i, 1).Font.Bold\n        MySht.Cells(1, j + 1).Characters(k, 1).Font.Italic = Range(\"a1\").Characters(i, 1).Font.Italic\n        MySht.Cells(1, j + 1).Characters(k, 1).Font.Underline = Range(\"a1\").Characters(i, 1).Font.Underline\n    Next i\n\n'now for the next loop advance in myString\nStartCharacter = EndCharacter + 2 '2 because \"&lt;&lt;\" is two characters long.\nEndCharacter = InStr(StartCharacter, myString, \"&lt;&lt;\")\n'MsgBox \"next\" &amp; Chr(10) &amp; StartCharacter &amp; Chr(10) &amp; EndCharacter\nIf EndCharacter = 0 Then\n    'The last loop hast to be done till the end of myString. but instr will evaluate Zero result in the last loop\n    'therefore in last loop:\n    EndCharacter = Len(myString)\nEnd If\n\nNext j\nEnd Sub\n</code></pre>\n\n<p>BE AWARE, RUNNING THIS CODE OVER A LOT OF CELLS WITH LONG TEXTS MIGHT TAKE AGES\n(I.E. SEVERAL LONG SECONDS)</p>\n"}], "owner": {"reputation": 1661, "user_id": 7168098, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10211116238159507/picture?type=large", "display_name": "JFerro", "link": "https://stackoverflow.com/users/7168098/jferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594205660, "creation_date": 1519832002, "last_edit_date": 1594205660, "question_id": 49033166, "link": "https://stackoverflow.com/questions/49033166/extract-part-of-a-string-of-a-cell-with-format-bold-and-color-and-underline", "title": "extract part of a string of a cell WITH format (bold and color and underline)", "body": "<p>I have in cell(x,y) of \"mytable\"\nmytable is a listobject of sheet(1)</p>\n\n<p>The user edited the cell 1,1 and added format with the result content of cell 1,1:\nImportant note: I can not reproduce here color, but assume some of the editing includes colors as well, not only <strong>bold</strong> and <em>cursive</em></p>\n\n<p>Lorem ipsum dolor <strong>sit amet</strong>, consectetur adipiscing elit. Etiam ultricies, leo quis euismod condimentum, Sed clamp|general <strong>term turpis nibh</strong> ullamcorper erat, nec finibus <em>ipsum nunc ut urna</em>. Proin a tortor ullamcorper, congue turpis eget, <strong>gravida lectus</strong>. Pellentesque habitant morbi</p>\n\n<p>Now I need to split the cell content by the symbol \"&lt;&lt;\" but keeping formating in the new cells</p>\n\n<p>Lorem ipsum dolor <strong>sit amet</strong>, consectetur &lt;term turpis nibh ullamcorper erat, nec finibus <em>ipsum nunc ut urna</em>. &lt;gravida lectus. Pellentesque habitant morbi</p>\n\n<p>I know how to operate with listobject\nI can put the range of the cell in a variable</p>\n\n<pre><code>dim myRange as range\n'first data of first column of first table that is also the only one in the sheet\nset mysheet=thisworkbook.sheets(\"whateversheet\")\nset myrange= mySheet.listobjects(1).listcolumns(1).databodyrange(1)\nset OtherRange=range(\"a3\")\nmySht.OtherRange.PasteSpecial Paste:=xlPasteAllExceptBorders\n</code></pre>\n\n<p>With this code I can paste the whole content of cell 1,1, into a3 font and colors included.\nbut as soon as I want to get the content (value) and the font and color of just PART of that cell  I dont know how to use listobject (or any other method).</p>\n\n<p>of course the following code do not preserve formatting:</p>\n\n<pre><code>dim myStr as string\nmyStr=mid(myrange.value,1,instr(1,myrange,\"&lt;&lt;\"))\n</code></pre>\n\n<p>So the question is: Is there any \"easy-effective\" way to do this? \nThe result would be used to split the content of the cell 1,1 into as many cells as simbols \"&lt;&lt;\" in cell 1,1 and paste the values with format (color and font bold and everything) into other cells.</p>\n\n<p>thanks a lot</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1253, "user_id": 4733879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5iiSX.png?s=128&g=1", "display_name": "Filnor", "link": "https://stackoverflow.com/users/4733879/filnor"}, "edited": false, "score": 0, "creation_date": 1519831696, "post_id": 49032895, "comment_id": 85070783, "body": "No need for using all-caps in the title."}, {"owner": {"reputation": 1253, "user_id": 4733879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5iiSX.png?s=128&g=1", "display_name": "Filnor", "link": "https://stackoverflow.com/users/4733879/filnor"}, "edited": false, "score": 0, "creation_date": 1519831706, "post_id": 49032895, "comment_id": 85070793, "body": "Welcome to Stack Overflow! Your question shows <a href=\"//idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">no attempt</a> of solving the problem. If you have made an attempt, you should edit our question to detail exactly what you did, researched for, and point to any links that were helpful but that did not answer your question. If you\u2019ve tried to code a solution, that should be added in an edit. Your attempts should be turned into a <a href=\"//stackoverflow.com/help/mcve\">MCVE</a> so it is clear to read and understand. Also read the <a href=\"//meta.stackoverflow.com/questions/260648\">Stack Overflow question checklist</a>"}, {"owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "reply_to_user": {"reputation": 1253, "user_id": 4733879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5iiSX.png?s=128&g=1", "display_name": "Filnor", "link": "https://stackoverflow.com/users/4733879/filnor"}, "edited": false, "score": 0, "creation_date": 1519835182, "post_id": 49032895, "comment_id": 85073072, "body": "Thanks for your input. I have updated accordingly @chade_"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519835184, "post_id": 49032895, "comment_id": 85073074, "body": "please see <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and don&#39;t forget to read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">I downvoted because no attempt was made</a>"}, {"owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519835356, "post_id": 49032895, "comment_id": 85073189, "body": "I have updated @FoxfireAndBurnsAndBurns. Can you help on the question?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "edited": false, "score": 0, "creation_date": 1520262513, "post_id": 49034525, "comment_id": 85231830, "body": "Thanks Foxfire And Burns And Burns"}, {"owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "edited": false, "score": 0, "creation_date": 1520262683, "post_id": 49034525, "comment_id": 85231937, "body": "Your solution was helpful. Can you please help with the below?  I am trying to sort certain columns of certain sheets of the final workbook."}, {"owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "edited": false, "score": 0, "creation_date": 1520262699, "post_id": 49034525, "comment_id": 85231953, "body": "I added the below code after the FOR loop :"}, {"owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "edited": false, "score": 0, "creation_date": 1520262746, "post_id": 49034525, "comment_id": 85231993, "body": "For Each wksCurSheet In wbkSrcBook.Sheets             If wksCurSheet.Name = &quot;ma_SMS%&quot; Then              Dim strDataRange As Range             Dim keyRange As Range             &#39;Assigning the target sort Range to strDataRange             Set strDataRange = Range(&quot;A1:S400&quot;)             Set keyRange = Range(&quot;A1&quot;)             &#39;Sorting the data using range objects and Sort method             strDataRange.Sort Key1:=keyRange, Header:=xlYes             Next"}, {"owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "edited": false, "score": 0, "creation_date": 1520262816, "post_id": 49034525, "comment_id": 85232031, "body": "But the above code is not helping... though the statements for sorting is right which I verified on another excel document"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "edited": false, "score": 0, "creation_date": 1520263682, "post_id": 49034525, "comment_id": 85232608, "body": "If my answer helped you in your first question, please, mark it as correct, so the question will be closed. And for your second question, please, do not use comments. Just open a new question and somebody will help for sure :)"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1519836129, "creation_date": 1519836129, "answer_id": 49034525, "question_id": 49032895, "link": "https://stackoverflow.com/questions/49032895/macro-vba-help-in-copying-specific-worksheets/49034525#49034525", "title": "Macro VBA Help in copying specific worksheets", "body": "<p>All worksheets in a Workbook got an <code>Index</code> property. Index 1 means first sheet, index 2 second one, and so on. So the last sheet will have an Index equal to <code>Sheets.Count</code>. Knowing this, try replacing this part:</p>\n\n<pre><code>For Each fnameCurFile In fnameList\n            countFiles = countFiles + 1\n            Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)\n            For Each wksCurSheet In wbkSrcBook.Sheets\n                countSheets = countSheets + 1\n                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n            Next\n            wbkSrcBook.Close SaveChanges:=False\n        Next\n</code></pre>\n\n<p>And use this code:</p>\n\n<pre><code>For Each fnameCurFile In fnameList\n            Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)\n             countFiles = countFiles + 1\n            countSheets = wbkSrcBook.Sheets.Count 'total sheets in this workbook\n            For Each wksCurSheet In wbkSrcBook.Sheets\n                'last sheet got an index equal to countSheets.\n                'the sheet before the last one will be then countSheets-1\n                If wksCurSheet.Index = countSheets Or wksCurSheet.Index = (countSheets - 1) Then wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n            Next\n            wbkSrcBook.Close SaveChanges:=False\n        Next\n</code></pre>\n\n<p>Also, replace line:</p>\n\n<pre><code>MsgBox \"Procesed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged \" &amp; countSheets &amp; \" worksheets\", Title:=\"Merge Excel files\"\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>MsgBox \"Procesed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged 2 worksheets\", Title:=\"Merge Excel files\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9424334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad53ecd508f4c1876430e9603bc70405?s=128&d=identicon&r=PG&f=1", "display_name": "dia", "link": "https://stackoverflow.com/users/9424334/dia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "closed_date": 1519928265, "accepted_answer_id": 49034525, "answer_count": 1, "score": -5, "last_activity_date": 1519836129, "creation_date": 1519831090, "last_edit_date": 1531164843, "question_id": 49032895, "link": "https://stackoverflow.com/questions/49032895/macro-vba-help-in-copying-specific-worksheets", "closed_reason": "Needs more focus", "title": "Macro VBA Help in copying specific worksheets", "body": "<p>I am extremely new to VBA.. tried it for first time today.</p>\n\n<p>I am looking for an Excel macro which copies the last two worksheets of 5 workbooks lying in a certain folder on desktop , into a new workbook named as output_DDMMYYHHMMSS.xlsx</p>\n\n<p>I am able to copy all the worksheets from all the 5 workbooks to the output workbook.\nBelow is the code used:\nSub MergeExcelFiles()</p>\n\n<pre><code>Dim fnameList, fnameCurFile As Variant\nDim countFiles, countSheets As Integer\nDim wksCurSheet As Worksheet\nDim wbkCurBook, wbkSrcBook As Workbook\n\nfnameList = Application.GetOpenFilename(FileFilter:=\"Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm\", Title:=\"Choose Excel files to merge\", MultiSelect:=True)\n\nPath = \"C:\\Users\\se\\Desktop\"\noutputName = \"output.xlsx\"\n\nIf (vbBoolean &lt;&gt; VarType(fnameList)) Then\n\n    If (UBound(fnameList) &gt; 0) Then\n        countFiles = 0\n        countSheets = 0\n        Application.ScreenUpdating = False\n        Application.Calculation = xlCalculationManual\n        Set wbkCurBook = ActiveWorkbook\n        For Each fnameCurFile In fnameList\n            countFiles = countFiles + 1\n            Set wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)\n            For Each wksCurSheet In wbkSrcBook.Sheets\n                countSheets = countSheets + 1\n                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)\n            Next\n            wbkSrcBook.Close SaveChanges:=False\n        Next\n        fName = Application.GetSaveAsFilename\n        wbkCurBook.SaveAs Filename:=fName\n        Application.ScreenUpdating = True\n        Application.Calculation = xlCalculationAutomatic\n\n        MsgBox \"Procesed \" &amp; countFiles &amp; \" files\" &amp; vbCrLf &amp; \"Merged \" &amp; countSheets &amp; \" worksheets\", Title:=\"Merge Excel files\"\n    End If\nElse\n    MsgBox \"No files selected\", Title:=\"Merge Excel files\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1519830687, "post_id": 49032740, "comment_id": 85070106, "body": "Do you have any merged cells in that range?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519830727, "post_id": 49032740, "comment_id": 85070130, "body": "@ScottCraner yes, that would be the cells in Column B. But they should not be part of my Selection that would start from E5"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1519830967, "post_id": 49032740, "comment_id": 85070297, "body": "Probably you have a hidden row, which is merged from <code>B</code> to <code>I</code>, thus it is happenning this way."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1519831172, "post_id": 49032740, "comment_id": 85070427, "body": "@Vityata yeah that would be the case. Is there a way to somehow ignore the merged cells without having to remove them?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1519831247, "post_id": 49032740, "comment_id": 85070475, "body": "@Rawrplus - if you want to select the range with the hidden merged cells - then no."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519832522, "post_id": 49032740, "comment_id": 85071306, "body": "You can always unmerge first then select."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519835494, "post_id": 49032740, "comment_id": 85073302, "body": "You said your range is dinamic. Just wondering... 100% dinamic?? or just E5:another cell?  or onecell:anothercell? I just want to know if, even dynamic, maybe some part of your range is going to be always the same. Your Range is (Cells(a,b),Cells(c,d)). Are a,b,c and d dymanic the 4 of them?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519996263, "post_id": 49032740, "comment_id": 85144606, "body": "@FoxfireAndBurnsAndBurns Fully dynamic. E5:FirstDynamicValue, DynamicValue2:DynamicValue3 etc etc. Only E5 is stable.  So in the example you provided, a would be static, rest dynamic. to put it simply, I&#39;m working with ever expanding and reducing pool of data. I coded a vba Inputbox where you have to manually enter the range of each part. Not the most elegant solution, but at least it works"}], "answers": [{"comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1519831393, "post_id": 49032898, "comment_id": 85070559, "body": "Yeah, the issue is being caused by hidden rows. Issue  is, I&#39;m working with a dynamic range, so I can&#39;t even split it into multiple ranges...I guess this will have to be changed by manual user input. Thanks for the help anyways"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1519831096, "creation_date": 1519831096, "answer_id": 49032898, "question_id": 49032740, "link": "https://stackoverflow.com/questions/49032740/selecting-an-area-with-exception-of-merged-cells-in-dynamic-range/49032898#49032898", "title": "Selecting an area with exception of merged cells in dynamic range", "body": "<p>Whenever something small like this is happening, simply try to simplify as much as you can. In your case, it would be this:</p>\n\n<pre><code>Sub TestMe()\n    Worksheets(\"Training_Planner\").Range(\"E5:H40\").Select\nEnd Sub\n</code></pre>\n\n<p>If it selects <code>E5:H40</code> then everything is ok. If not, try to select it manually. Probably you have a hidden row, which is merged from B to I, thus it is happenning this way.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "is_accepted": false, "score": 0, "last_activity_date": 1519890425, "last_edit_date": 1519890425, "creation_date": 1519831807, "answer_id": 49033105, "question_id": 49032740, "link": "https://stackoverflow.com/questions/49032740/selecting-an-area-with-exception-of-merged-cells-in-dynamic-range/49033105#49033105", "title": "Selecting an area with exception of merged cells in dynamic range", "body": "<p>Instead of this:\n<code>.Range(\"E5:H\" &amp; lastRow).Select</code></p>\n\n<p>Try going with this: \n<code>.Range(\"E5\", (Cells(Rows.Count, \"H\").End(xlUp))).Select</code></p>\n\n<p>It count all the rows \"H\" has and then goes up until it finds the first item. And it will then select from \"E1\" to last item in \"H\"</p>\n"}, {"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1520006232, "creation_date": 1520006232, "answer_id": 49072758, "question_id": 49032740, "link": "https://stackoverflow.com/questions/49032740/selecting-an-area-with-exception-of-merged-cells-in-dynamic-range/49072758#49072758", "title": "Selecting an area with exception of merged cells in dynamic range", "body": "<p>Ok, first of all, if your range is gonna start always as E5, your range is 50% dinamic, because it starts always in same column and same row. Your Range is (Cells(a,b),Cells(c,d)), this means a = 5 and b = 5 (Column E).</p>\n\n<p>Also, you say and Inputbox asks users for end cell of range (in your example is H40, but this is dynamic).</p>\n\n<p>So, my code checks EVERY SINGLE cell in the range formed, and then, using <code>Application.Union</code>I set a <em>final big range</em>. We cannot just use an array to select all of them, because your range is dynamic, and selecting ranges with arrays is limited to 30 args, so we need to update our FinalRange for each cell.</p>\n\n<pre><code>Dim MyCell As Range\nDim RangeWanted As Range\nDim MyFinalRange As Range\n\nSet RangeWanted = Range(\"E5:\" &amp; InputBox(\"Cell Address\")) 'User inputs Final Cell of Range. Start is always E5\n\n\n'let's get all invididual addresses of each cell inthat dynamic RangeWanted\nFor Each MyCell In RangeWanted\n\n    If MyCell.MergeCells = False Then 'If not merged, we add it to FinalRange\n\n        If MyFinalRange Is Nothing Then\n            Set MyFinalRange = MyCell\n        Else\n            Set MyFinalRange = Application.Union(MyFinalRange, MyCell)\n        End If\n\n    End If\nNext MyCell\n\nSet RangeWanted = Nothing\n\nMyFinalRange.Select\n</code></pre>\n\n<p>With this code, from Range(\"E5:H40\") in image,yellow cells are merged. I want to select only the not merged ones. And using this code, I get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UdfSC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UdfSC.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>My example is with Range(\"E5:H40\") but it works also with other ranges.</p>\n\n<p>Try it and adapt the code to your needs.</p>\n"}], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 0, "accepted_answer_id": 49072758, "answer_count": 3, "score": -1, "last_activity_date": 1520006232, "creation_date": 1519830598, "last_edit_date": 1531161705, "question_id": 49032740, "link": "https://stackoverflow.com/questions/49032740/selecting-an-area-with-exception-of-merged-cells-in-dynamic-range", "title": "Selecting an area with exception of merged cells in dynamic range", "body": "<hr>\n\n<p><strong>IMPORTANT EDIT:</strong> The main issue here is caused by <strong>hidden merged cells that are causing the entirity of their active range to be selected.</strong> Unless you know a way how to dynamically skip merged cells (in a dynamic range), the it most likely won't help. Have changed the entirity of question accordingly</p>\n\n<hr>\n\n<p>any idea what am I doing wrong?</p>\n\n<p>Got the following code, fyi  the function <code>find_last_row</code> returns the value of last active row as integer. In this case, the returned variable would be 40</p>\n\n<pre><code>Private Sub initalize_button_Click()\n\n    Dim lastRow As Integer\n    Dim ws As Worksheet: Set ws = Sheets(\"Training_Planner\")\n\n\n    lastRow = find_last_row\n\n    With ws\n        .Activate\n        .Range(\"E5:H\" &amp; lastRow).Select\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>Pretty basic code, should open the worksheet Training_Planner and select from E5 to HlastRow <strong>(in this case lastRow is 40)</strong> so the selected range should be E5:H40</p>\n\n<p>Here is the expected result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2Kg7g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Kg7g.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I get instead:</p>\n\n<p><a href=\"https://i.stack.imgur.com/S4DG5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S4DG5.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Curiously enough, it selects only active range, but it's as if it didn't pay attention to columns, instead of the expected E5:H40 i get B5:I40\nAny idea what's causing this?</strong></p>\n"}, {"tags": ["json", "vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519832597, "post_id": 49032724, "comment_id": 85071367, "body": "What about <code>myNest = &quot;{&quot;&quot;new_key&quot;&quot;:{&quot;&quot;value&quot;&quot;:1,&quot;&quot;foo&quot;&quot;:&quot;&quot;bar&quot;&quot;}}&quot;</code>"}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519832837, "post_id": 49032724, "comment_id": 85071535, "body": "Does not seem to do it...it will map the key to a string, and gives an error when trying to access individual values as Json(&quot;new_key&quot;)(&quot;value&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 0, "creation_date": 1519842427, "post_id": 49033890, "comment_id": 85077341, "body": "I just noticed I maybe mis-read your required output: @xuanhai266&#39;s solution is a better match."}, {"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 0, "creation_date": 1519853107, "post_id": 49033890, "comment_id": 85082924, "body": "Yes, but in fact all I really wanted was to understand the creation of a new nested key, and this line Json.Add &quot;new_key&quot;, CreateObject(&quot;scripting.dictionary&quot;) did the trick."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1519836954, "last_edit_date": 1519836954, "creation_date": 1519834215, "answer_id": 49033890, "question_id": 49032724, "link": "https://stackoverflow.com/questions/49032724/vba-json-create-nested-objects/49033890#49033890", "title": "VBA-JSON Create nested objects", "body": "<p>Something like this:</p>\n\n<pre><code>Set Json = JsonConverter.ParseJson(\"{}\")\n'or\n'Set Json = CreateObject(\"scripting.dictionary\")\n\nJson.Add \"new_key\", CreateObject(\"scripting.dictionary\")\nJson(\"new_key\")(\"value\") = 1\nJson(\"new_key\")(\"foo\") = \"bar\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 3456529, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f5eba6bbac034d0fd5cac751d60c5a5b?s=128&d=identicon&r=PG&f=1", "display_name": "xuanhai266", "link": "https://stackoverflow.com/users/3456529/xuanhai266"}, "is_accepted": true, "score": 10, "last_activity_date": 1519834356, "creation_date": 1519834356, "answer_id": 49033934, "question_id": 49032724, "link": "https://stackoverflow.com/questions/49032724/vba-json-create-nested-objects/49033934#49033934", "title": "VBA-JSON Create nested objects", "body": "<p>You can use Dictionary and Collection in VBA.\nAfter that convert them to Json.\nThis is an example:</p>\n\n<pre><code>Sub test()\n    Dim c As Collection\n    Dim d As Dictionary\n    Dim e As Dictionary\n    Dim f As Dictionary\n    Dim json As String\n\n    Set c = New Collection\n    Set d = New Dictionary\n    Set e = New Dictionary\n    Set f = New Dictionary\n\n    d.Add \"value\", 1\n    e.Add \"foo\", \"bar\"\n    c.Add d\n    c.Add e\n    f.Add \"new_key\", c\n\n    json = JsonConverter.ConvertToJson(ByVal f)\n\n    Debug.Print json\nEnd Sub\n</code></pre>\n\n<p>And this is output:</p>\n\n<pre><code>{\"new_key\":[{\"value\":1},{\"foo\":\"bar\"}]}\n</code></pre>\n"}], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9548, "favorite_count": 2, "accepted_answer_id": 49033934, "answer_count": 2, "score": 2, "last_activity_date": 1519836954, "creation_date": 1519830527, "question_id": 49032724, "link": "https://stackoverflow.com/questions/49032724/vba-json-create-nested-objects", "title": "VBA-JSON Create nested objects", "body": "<p>I have seen a lot of examples showing how to parse json strings with VBA-JSON, however I would like to know how to create a JSON object from scratch using this library.</p>\n\n<p>I have started with:</p>\n\n<pre><code>Set Json = JsonConverter.ParseJson(\"{}\")\nJson(\"key\") = \"value\"\n</code></pre>\n\n<p>And this works as expected. </p>\n\n<p>However, if I want to create a nested object, for example:</p>\n\n<pre><code>Json(\"new_key\")(1)(\"value\") = 1\nJson(\"new_key\")(2)(\"foo\") = \"bar\"\n</code></pre>\n\n<p>Does not output the expected: <code>{\"new_key\":[{\"value\": 1}, {\"foo\": \"bar\"}]}</code></p>\n\n<p>Is this possible to achieve with this library? Or is there another way to do it?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2016"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9424196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WB55A8Cux0U/AAAAAAAAAAI/AAAAAAAAGAo/bWKDo4LO5xk/photo.jpg?sz=128", "display_name": "Anthony Cornner", "link": "https://stackoverflow.com/users/9424196/anthony-cornner"}, "edited": false, "score": 0, "creation_date": 1519910965, "post_id": 49032613, "comment_id": 85105834, "body": "Andy G, thank you for your help, you definitely got me one step further. However, the percentage symbols are meant to search the entire field for one that includes what you&#39;ve typed. They aren&#39;t doing that even with my inclusion of the &quot;like&quot; operator:     &#39; StrSQL = &quot;Select * from tbl_Inventory where [Serial      Number/UDID/IMEI] like &#39;%&quot; &amp; vItem &amp; &quot;%&#39;&quot; &#39; This code is fine is I want to do a one-to-one search (Which I&#39;d do differently if that was the case) , but I want to search the fields for the string I type, even if there is a case difference and even if there are also numbers..."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 1, "user_id": 9424196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WB55A8Cux0U/AAAAAAAAAAI/AAAAAAAAGAo/bWKDo4LO5xk/photo.jpg?sz=128", "display_name": "Anthony Cornner", "link": "https://stackoverflow.com/users/9424196/anthony-cornner"}, "edited": false, "score": 0, "creation_date": 1519911267, "post_id": 49032613, "comment_id": 85106004, "body": "For MS Access the <a href=\"https://support.office.com/en-us/article/access-wildcard-character-reference-af00c501-7972-40ee-8889-e18abaad12d1\" rel=\"nofollow noreferrer\">wildcard character</a> is an asterisk * not a percent sign."}], "tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1519911296, "last_edit_date": 1519911296, "creation_date": 1519830233, "answer_id": 49032613, "question_id": 49032519, "link": "https://stackoverflow.com/questions/49032519/continually-getting-a-parameter-box-error-when-i-use-an-sql-query-to-grab-a-va/49032613#49032613", "title": "continually getting a parameter box &quot;error&quot; when I use an SQL query to grab a value?", "body": "<p>Access expects square brackets to denote a field (or table) name or a parameter. If you tested with <code>somefield = [anything]</code> you will see a parameter box appearing containing the text <code>anything</code>.</p>\n\n<p>Get rid of the square brackets and replace them with single quotes, which you need to surround a textual expression, <code>'%\" &amp; vItem &amp; \"%'\"</code>.</p>\n\n<p>However, the wildcard character for MS Access is an asterisk * not a percent sign.</p>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1520551545, "creation_date": 1520551545, "answer_id": 49184196, "question_id": 49032519, "link": "https://stackoverflow.com/questions/49032519/continually-getting-a-parameter-box-error-when-i-use-an-sql-query-to-grab-a-va/49184196#49184196", "title": "continually getting a parameter box &quot;error&quot; when I use an SQL query to grab a value?", "body": "<p>your code line: \nStrSQL = \"Select * from tbl_Inventory where [Serial Number/UDID/IMEI] like \n[%\" &amp; vItem &amp; \"%]\"</p>\n\n<p>Q: is the field name of the table actually &amp; exactly?: Serial Number/UDID/IMEI</p>\n\n<p>the code line must be this:</p>\n\n<p>StrSQL = \"Select * from tbl_Inventory where [TableFieldName] like \n\" * \" &amp; vItem &amp; \" * \"  \"</p>\n\n<p>note there should be no spaces around the asterisks - but without them in this post they didn't seem to display correctly: \"<em>\" &amp; vItem &amp; \"</em>\"\"</p>\n"}], "owner": {"reputation": 1, "user_id": 9424196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WB55A8Cux0U/AAAAAAAAAAI/AAAAAAAAGAo/bWKDo4LO5xk/photo.jpg?sz=128", "display_name": "Anthony Cornner", "link": "https://stackoverflow.com/users/9424196/anthony-cornner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594636928, "creation_date": 1519829962, "last_edit_date": 1594636928, "question_id": 49032519, "link": "https://stackoverflow.com/questions/49032519/continually-getting-a-parameter-box-error-when-i-use-an-sql-query-to-grab-a-va", "title": "continually getting a parameter box &quot;error&quot; when I use an SQL query to grab a value?", "body": "<p>I'm trying to create a button inside of a Microsoft Access 2016 database for inventory tracking that, on click, displays an InputBox asking for the Serial Number, UDID, and/or IMEI of the device in question. I have an SQL query embedded in the private sub, code below:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdInventoryItems_Click()\nOn Error Resume Next\n\nDim vItem As String\nvItem = InputBox(\"Type the Serial Number/UDID/IMEI of your device.\", \"Text \nSearch\")\n\nDim StrSQL As String\nStrSQL = \"Select * from tbl_Inventory where [Serial Number/UDID/IMEI] like \n[%\" &amp; vItem &amp; \"%]\"\nMe.RecordSource = StrSQL\n\nEnd Sub\n</code></pre>\n\n<p>The percentage signs inside the code are meant to allow the string to be compared to any piece of the Serial Number/UDID/IMEI field.</p>\n\n<p>Whenever I click cmdInventoryItems it throws an InputBox, as planned, but when a value is input into the textbox, access asks for a parameter value with the prompt being the value I just entered surrounded by percentage symbols. If I type nothing into the \"Enter parameter value\" box everything disappears on my main form.</p>\n\n<p>Can anyone explain what's going on, and how to fix it?\nThanks for any help I can get.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1519829408, "post_id": 49032254, "comment_id": 85069217, "body": "You don&#39;t put quotes around <code>xlDown</code> but you should be using <code>xlUp</code> anyway: <code>Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code>"}, {"owner": {"reputation": 111, "user_id": 9402306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c2425b2fddb519bdbceafba6f81f6d?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/9402306/samuel"}, "edited": false, "score": 0, "creation_date": 1519829634, "post_id": 49032254, "comment_id": 85069379, "body": "I think it is necessary to use xlDown since he wants the last row, not the first, right?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 111, "user_id": 9402306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c2425b2fddb519bdbceafba6f81f6d?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/9402306/samuel"}, "edited": false, "score": 0, "creation_date": 1519830021, "post_id": 49032254, "comment_id": 85069631, "body": "@Samuel No, the suggested code starts from the very last row of the worksheet going <code>xlUp</code> to the last used row. That is a usual practice to find the last used row if there are empty rows in between."}, {"owner": {"reputation": 111, "user_id": 9402306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c2425b2fddb519bdbceafba6f81f6d?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/9402306/samuel"}, "edited": false, "score": 0, "creation_date": 1519830120, "post_id": 49032254, "comment_id": 85069709, "body": "He says there are no blank cells in between, but makes sense to be safe."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519830191, "post_id": 49032254, "comment_id": 85069760, "body": "<code>Range(&quot;A4&quot;).Rows.Count</code> is always <code>1</code> because range <code>A4</code> has one row if you count them. You should have a look at the first comment here again."}, {"owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519831658, "post_id": 49032254, "comment_id": 85070755, "body": "@P\u1d07\u029c Right, oops. I switched to I set a cell value to Rows.Count and it returned 1048576, which is far more rows than I actually have."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519832084, "post_id": 49032254, "comment_id": 85071015, "body": "@J.Mill Of course <code>Rows.Count</code> obviously gives you the maximum row count of a worksheet. It is the same as <code>ActiveSheet.Rows.Count</code> which means count the rows of the active sheet. And that&#39;s what it does, it counts them, no matter if they are empty or not (because that was not specified). A code always does <b>precisely</b> what it says."}, {"owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519833433, "post_id": 49032254, "comment_id": 85071941, "body": "@P\u1d07\u029c Ok. This is my first time working in VBA, so I&#39;m still getting used to what everything means and how to reference everything. Thought I saw somewhere that Rows.Count gets you the number of nonempty rows, guess I remembered wrong. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519831565, "post_id": 49033006, "comment_id": 85070696, "body": "This is the proper answer - I was having issues getting <code>xlDown</code> to work but I wasn&#39;t specifying my range."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1519832354, "last_edit_date": 1519832354, "creation_date": 1519831454, "answer_id": 49033006, "question_id": 49032254, "link": "https://stackoverflow.com/questions/49032254/range-end-not-returning-long-going-to-end-of-spreadsheet-not-stopping-at-first/49033006#49033006", "title": "Range.End not returning Long; going to end of spreadsheet, not stopping at first blank cell", "body": "<p>This </p>\n\n<pre><code>Workbooks(JunxureFile).Sheets(\"Sheet1\").Range(\"A4\", \"A\" &amp; Range(\"A4\").End(xlDown).Row).Copy\n</code></pre>\n\n<p>might fail because you did not specify the correct worksheet for the second range like</p>\n\n<pre><code>Workbooks(JunxureFile).Worksheets(\"Sheet1\").Range(\"A4\", \"A\" &amp; Workbooks(JunxureFile).Worksheets(\"Sheet1\").Range(\"A4\").End(xlDown).Row).Copy\n</code></pre>\n\n<p>or in a shorter way</p>\n\n<pre><code>With Workbooks(JunxureFile).Worksheets(\"Sheet1\")\n    .Range(\"A4\", \"A\" &amp; .Range(\"A4\").End(xlDown).Row).Copy\nEnd With\n</code></pre>\n\n<p><strong>Explanation:</strong><br>\nIf you use <code>Range(\"A4\")</code> without specifying in which worksheet this range is, VBA guesses which sheet you mean and in most cases it is the same like writing <code>ActiveSheet.Range(\"A4\")</code> but this might be easily the wrong sheet. So <strong>always</strong> specify which worksheet you mean the range to be in like: <code>Workbooks(JunxureFile).Worksheets(\"Sheet1\").Range(\"A4\")</code></p>\n"}], "owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 49033006, "answer_count": 1, "score": 0, "last_activity_date": 1519832354, "creation_date": 1519829222, "last_edit_date": 1531164843, "question_id": 49032254, "link": "https://stackoverflow.com/questions/49032254/range-end-not-returning-long-going-to-end-of-spreadsheet-not-stopping-at-first", "title": "Range.End not returning Long; going to end of spreadsheet, not stopping at first blank cell", "body": "<p>I am using the following code to find the last row number in a column of data:</p>\n\n<pre><code>Dim LR as Long\nLR = Range(\"A4\").End(\"xlDown\").Row\n</code></pre>\n\n<p>There are no blank cells between data in the A column. I am getting a type mismatch error. When I try to select the last row, I get an object error.</p>\n\n<p>I am using the previous code because this code:</p>\n\n<pre><code>Workbooks(JunxureFile).Sheets(\"Sheet1\").Range(\"A4\", \"A\" &amp; \nRange(\"A4\").End(xlDown).Row).Copy\n</code></pre>\n\n<p>did not stop after the first blank cell, and instead copied the entire column (to the max rows Excel allows).</p>\n\n<p>Every example I've seen of Range.End implies it should not be acting this way, so I'm not sure what the problem is. I'm going to try just using rows.count for now, but I'd like to know what the issue with this code is. How do I change my code for it to work?</p>\n\n<p><strong>EDIT2:</strong></p>\n\n<p>I just tried</p>\n\n<pre><code>ActiveSheet.Range(\"E1\").Value = Rows.Count\n</code></pre>\n\n<p>to see that Rows.Count is getting me 1048576, so it's still selecting way too many rows. I'm going to try copy and pasting my data to a different workbook to see if that helps (EDIT3: it did not).</p>\n"}, {"tags": ["sql", "sql-server", "excel", "vba", "macos"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1519829048, "post_id": 49032108, "comment_id": 85068961, "body": "How do you expect us to help? Where is the procedure code? Table definitions would be a big plus also."}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1519829422, "post_id": 49032108, "comment_id": 85069229, "body": "@SeanLange didn&#39;t think the procedure code would be needed as it works perfectly fine."}, {"owner": {"reputation": 250, "user_id": 9149227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91251fe74b74f95d25403436468cbd61?s=128&d=identicon&r=PG&f=1", "display_name": "DimUser", "link": "https://stackoverflow.com/users/9149227/dimuser"}, "edited": false, "score": 2, "creation_date": 1519829594, "post_id": 49032108, "comment_id": 85069359, "body": "this could be classic <a href=\"http://www.sommarskog.se/query-plan-mysteries.html\" rel=\"nofollow noreferrer\">parameter sniffing</a>"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1519829736, "post_id": 49032108, "comment_id": 85069451, "body": "Well you did say that the procedure is slow right? That means that the procedure is the issue right? It could be parameter sniffing as already suggested (very likely) or it could be that the procedure has inefficient code. Without seeing the procedure we are guessing at best."}, {"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "reply_to_user": {"reputation": 250, "user_id": 9149227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91251fe74b74f95d25403436468cbd61?s=128&d=identicon&r=PG&f=1", "display_name": "DimUser", "link": "https://stackoverflow.com/users/9149227/dimuser"}, "edited": false, "score": 1, "creation_date": 1519830156, "post_id": 49032108, "comment_id": 85069736, "body": "Did you research this at all?   How did you not get @DimUser &#39;s link in the first search results?   This is almost certainly parameter sniffing.  <a href=\"https://www.google.com/search?q=procedure+slow+in+application+fast+in+ssms&amp;oq=procedure+slow+in+application+fast+in+ssms&amp;aqs=chrome..69i57j0.6631j0j4&amp;sourceid=chrome&amp;ie=UTF-8\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1519830615, "post_id": 49032108, "comment_id": 85070056, "body": "Yeah I didn&#39;t read the question title, I usually don&#39;t because they rarely have much to do with the question. And they almost never contain vital information like this one clearly does. Obviously parameter sniffing."}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 0, "creation_date": 1519832726, "post_id": 49032108, "comment_id": 85071451, "body": "@TabAlleman because this is the first time I have ever heard of parameter sniffing is probably why it didn&#39;t come up in my reasearch. Often easy and obvious when you know the answer. I&#39;m reading his link now and trying to understand it"}, {"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 0, "creation_date": 1519832906, "post_id": 49032108, "comment_id": 85071574, "body": "@mHelpMe but notice I didn&#39;t google &quot;parameter sniffing&quot; in my search either.  In fact, when I google the title of your question, the same link comes up in the first page of results."}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 0, "creation_date": 1519833165, "post_id": 49032108, "comment_id": 85071778, "body": "@TabAlleman ok I have to be honest when I google the title of my question the link DimUser provided is not returned no idea why"}], "owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593645075, "creation_date": 1519828797, "last_edit_date": 1593645075, "question_id": 49032108, "link": "https://stackoverflow.com/questions/49032108/stored-procedure-taking-a-long-time-when-called-from-vba-but-quick-in-sql-server", "title": "Stored procedure taking a long time when called from vba but quick in SQL Server", "body": "<p>I have 3 stored procedures in a database. They are very simple and similar. They all work in SQL Server and take approx 1/4 a second to run.</p>\n\n<p>These stored procedures are called by some VBA code from an Excel file. Two of the three stored procedures run fine and return data in about 1/4 a second, but one of them takes approx 30 seconds to run and I don't understand why.</p>\n\n<pre><code>Sub USPSectorExposure()\n\nDim cmd As New ADODB.Command\nDim rs As New ADODB.Recordset\nDim ctr As Integer\nDim sCode As String\nDim dtReport As Date\nDim tStart As Date\n\ntStart = Now()\n\nsCode = \"OENN\"\ndtReport = \"2018-02-22\"\n\nOpenDbConnection\n\ncmd.ActiveConnection = cn\ncmd.Parameters.Append cmd.CreateParameter(\"Code\", adVarWChar, adParamInput, 20, sFund)\ncmd.Parameters.Append cmd.CreateParameter(\"dateHld\", adDate, adParamInput, , dtReport)\ncmd.CommandText = \"uspMyTest\"\n\nSet rs = cmd.Execute(, , adCmdStoredProc)\n\nIf rs.EOF = False Then\n    MsgBox Format(Now() - tStart, \"hh:mm:ss\")\nEnd If\n\nCloseConnection\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 8489, "user_id": 5452365, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/MezjT.png?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5452365/rahul"}, "is_accepted": false, "score": 0, "last_activity_date": 1519826975, "creation_date": 1519826975, "answer_id": 49031507, "question_id": 49031418, "link": "https://stackoverflow.com/questions/49031418/include-line-of-text-in-html-e-mail-based-on-value-of-cell/49031507#49031507", "title": "Include line of text in HTML e-mail based on value of cell", "body": "<p>Vba if loop looks like this.</p>\n\n<pre><code>If condition\n    'if true\nElse\n    'if false\nEndIf\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1519827303, "creation_date": 1519827303, "answer_id": 49031611, "question_id": 49031418, "link": "https://stackoverflow.com/questions/49031418/include-line-of-text-in-html-e-mail-based-on-value-of-cell/49031611#49031611", "title": "Include line of text in HTML e-mail based on value of cell", "body": "<p>There are a few mistakes in your code and some things creates confusion. First, the if statements. Write them like this, instead:</p>\n\n<pre><code>If (Cells(cell.Row, \"F\").Value) = \"incomplete\" Then \n    .HTMLBody = \"&lt;p&gt; Your payment is incomplete&lt;p/&gt;\"\nElse \n    .HTMLBody = \"&lt;p&gt;  &lt;p/&gt;\" &amp; _\n                \"&lt;p&gt;Thank you&lt;/p&gt;\"\nEnd If\n</code></pre>\n\n<p>Second, your cell references are not correct. Columns are referenced by numbers in the Cells method (i.e F=6). It is also risky to expect that the active sheet is the expected sheet. Create a reference to it to make sure</p>\n\n<pre><code>Dim TargetSheet as WorkSheet\nSet TargetSheet = Worksheets(\"MySheet\")\nTargetSheet.Cells(cell.Row, 6).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 9423974, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Al Nikolaj", "link": "https://stackoverflow.com/users/9423974/al-nikolaj"}, "edited": false, "score": 0, "creation_date": 1519896857, "post_id": 49032415, "comment_id": 85097655, "body": "That is awesome! Thank you - that helped a lot!  But I have another small problem... if I want to add &amp; &quot;&lt;p&gt;The status of your invoice is&lt;/p&gt;&quot; &amp; Cells(cell.Row, &quot;F&quot;).Value it causing a problem because of the &quot; between the F.. Is there any other solution how to reference a cell?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 105, "user_id": 9423974, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Al Nikolaj", "link": "https://stackoverflow.com/users/9423974/al-nikolaj"}, "edited": false, "score": 0, "creation_date": 1519898695, "post_id": 49032415, "comment_id": 85098727, "body": "I&#39;m not getting you: please be more specific as to where  do you want to add  <code>&amp; &quot;&lt;p&gt;The status of your invoice is&lt;&#47;p&gt;&quot; &amp; Cells(cell.Row, &quot;F&quot;).Value</code>"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519829662, "creation_date": 1519829662, "answer_id": 49032415, "question_id": 49031418, "link": "https://stackoverflow.com/questions/49031418/include-line-of-text-in-html-e-mail-based-on-value-of-cell/49032415#49032415", "title": "Include line of text in HTML e-mail based on value of cell", "body": "<p>use <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/iif-function\" rel=\"nofollow noreferrer\">IIF()</a> function</p>\n\n<pre><code>With OutMail\n    .To = Cells(cell.Row, \"C\").value\n    .Subject = \"Request\" &amp; Cells(cell.Row, \"E\").value\n    .BodyFormat = olFormatHTML\n    .HTMLBody = Cells(cell.Row, \"A\").value &amp; Cells(cell.Row, \"B\").value _\n                &amp; \"&lt;p&gt;The status of your invoice is&lt;/p&gt;\" _\n                &amp; IIf(Cells(cell.Row, \"F\").value = \"incomplete\", \"&lt;p&gt; Your payment is incomplete&lt;p/&gt;\", \"&lt;p&gt;  &lt;p/&gt;&lt;p&gt;Thank you&lt;/p&gt;\")\nEnd With\n</code></pre>\n\n<p>just adjust the two <em>results</em> of the function to your needs: as it is now, it adds either <code>\"&lt;p&gt; Your payment is incomplete&lt;p/&gt;\"</code> or <code>\"&lt;p&gt;  &lt;p/&gt;&lt;p&gt;Thank you&lt;/p&gt;\"</code>, in relation of <code>Cells(cell.Row, \"F\").value</code>matching <em>\"incomplete\"</em> or not</p>\n"}], "owner": {"reputation": 105, "user_id": 9423974, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Al Nikolaj", "link": "https://stackoverflow.com/users/9423974/al-nikolaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1520196175, "creation_date": 1519826759, "last_edit_date": 1520196175, "question_id": 49031418, "link": "https://stackoverflow.com/questions/49031418/include-line-of-text-in-html-e-mail-based-on-value-of-cell", "title": "Include line of text in HTML e-mail based on value of cell", "body": "<p>I have a template with an HTML body. I want to include a line depending on the value of the Value of cell F.</p>\n\n<p>If in cell F it is written \"incomplete\" then it shall include the phrase \"Your payment is incomplete\" into the e-mail text.</p>\n\n<p>If in cell F it is written \"complete\" a space is added to the HMTL body. </p>\n\n<p>How can I achieve this? </p>\n\n<pre><code>With OutMail\n.To = Cells(cell.Row, \"C\").Value\n.Subject = \"Request\" &amp; Cells(cell.Row, \"E\").Value\n.BodyFormat = olFormatHTML\n.HTMLBody = Cells(cell.Row, \"A\").Value &amp; Cells(cell.Row, \"B\").Value _\n&amp; \"&lt;p&gt;The status of your invoice is&lt;/p&gt;\" _\n\nIf (Cells(cell.Row, \"F\").Value) = \"incomplete\" then: \n.HTMLBody = \"&lt;p&gt; Your payment is incomplete&lt;p/&gt;\"  _\n\nElse \n .HTMLBody = \"&lt;p&gt;  &lt;p/&gt;\" _\n&amp; \"&lt;p&gt;Thank you&lt;/p&gt;\" _\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "edited": false, "score": 0, "creation_date": 1519826611, "post_id": 49031304, "comment_id": 85067228, "body": "Try with <code>^[mno]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 639, "user_id": 5908729, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8f324dd3b2d7d3ec4a9c559d69f65cf0?s=128&d=identicon&r=PG&f=1", "display_name": "sql_dummy", "link": "https://stackoverflow.com/users/5908729/sql-dummy"}, "edited": false, "score": 0, "creation_date": 1519904390, "post_id": 49031791, "comment_id": 85101938, "body": "This looks great, thanks. But I observed that I am unable to perform undo using <code>ctrl+z</code>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 639, "user_id": 5908729, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8f324dd3b2d7d3ec4a9c559d69f65cf0?s=128&d=identicon&r=PG&f=1", "display_name": "sql_dummy", "link": "https://stackoverflow.com/users/5908729/sql-dummy"}, "edited": false, "score": 0, "creation_date": 1519907718, "post_id": 49031791, "comment_id": 85103793, "body": "As for running VBA macros there is no undo. You would make a reverse code that show all the data .. Notice the code and you can create such a  code"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 2, "last_activity_date": 1519827814, "creation_date": 1519827814, "answer_id": 49031791, "question_id": 49031304, "link": "https://stackoverflow.com/questions/49031304/filter-array-containing-regular-expression-or-multiple-critera/49031791#49031791", "title": "Filter array containing regular expression or multiple critera", "body": "<p>Try using advanced filter in that way (suppose the field is column A)</p>\n\n<pre><code>Sub Test()\nApplication.ScreenUpdating = False\n    With Sheets(\"Sheet1\")\n        If .FilterMode Then .ShowAllData\n        .Range(\"H2\").Formula = \"=OR(LEFT(A2,1)=\"\"m\"\",LEFT(A2,1)=\"\"n\"\",LEFT(A2,1)=\"\"o\"\")\"\n        .Range(\"A1\").CurrentRegion.AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=.Range(\"H1:H2\"), Unique:=False\n        .Range(\"H2\").ClearContents\n    End With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 639, "user_id": 5908729, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8f324dd3b2d7d3ec4a9c559d69f65cf0?s=128&d=identicon&r=PG&f=1", "display_name": "sql_dummy", "link": "https://stackoverflow.com/users/5908729/sql-dummy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 49031791, "answer_count": 1, "score": 0, "last_activity_date": 1519827814, "creation_date": 1519826387, "last_edit_date": 1531164843, "question_id": 49031304, "link": "https://stackoverflow.com/questions/49031304/filter-array-containing-regular-expression-or-multiple-critera", "title": "Filter array containing regular expression or multiple critera", "body": "<p>I am looking to filter a column with anything that starts with either m,n,o. Things work fine when I tried to filter with 2 items but does not work for more than 2 items.</p>\n\n<pre><code>Criteria1:=\"=m*\", Operator:=xlOr, Criteria2:=\"=n*\" \n</code></pre>\n\n<p>Works fine to filter anything that starts with m or n</p>\n\n<pre><code>//Criteria1:=\"=p*\", Operator:=xlOr, Criteria2:=\"=z*\", Operator:=xlOr, Criteria2:=\"=e*\"  \n</code></pre>\n\n<p>Throws error invalid criteria</p>\n\n<pre><code>Criteria1:=Array(\"=mab\", \"=nab\", \"oab\"), Operator:=xlFilterValues\n</code></pre>\n\n<p>Works fine to filter mab,nab,oab.</p>\n\n<pre><code>Criteria1:=Array(\"=m*\", \"=n*\", \"o*\"), Operator:=xlFilterValues\n</code></pre>\n\n<p>Works fine to filter literally ``m*<code>,</code>n*<code>,</code>o*` (it is not being considered as regular expression), what i am looking is to filter anything that starts with m or n or o</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519826981, "post_id": 49031302, "comment_id": 85067457, "body": "please show the code you have tried and where it errors."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519827555, "post_id": 49031302, "comment_id": 85067883, "body": "Added the code samples unsure on how to bring this together"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519827766, "post_id": 49031302, "comment_id": 85068044, "body": "Does the concatenation needs to be in increasing value order or the order the numbers are encountered?"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519827946, "post_id": 49031302, "comment_id": 85068186, "body": "The concatenation would be best to be smallest to largest Ie 123 before 456. This is not essential"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519828587, "post_id": 49031302, "comment_id": 85068653, "body": "Here are some example codes: <a href=\"https://stackoverflow.com/questions/28679758/concatenate-top-row-cells-if-column-below-has-1\" title=\"concatenate top row cells if column below has 1\">stackoverflow.com/questions/28679758/&hellip;</a>  they are horizontal, but similar."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519828637, "post_id": 49031302, "comment_id": 85068696, "body": "<a href=\"https://stackoverflow.com/questions/44706211/excel2011-vlookup-and-combine\" title=\"excel2011 vlookup and combine\">stackoverflow.com/questions/44706211/&hellip;</a> This is vertical."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519828727, "post_id": 49031302, "comment_id": 85068753, "body": "basically go through the <code>TextJoin</code> tag and you will find many examples of code."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519831381, "post_id": 49032553, "comment_id": 85070551, "body": "Hi, I have updated my data samples. How does your code then change to reflect these, do you mind please advising? The samples will not change again."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519832190, "post_id": 49032553, "comment_id": 85071077, "body": "You haven&#39;t made a decision on the last answer I gave yet.... <a href=\"https://stackoverflow.com/questions/49027250/finding-the-missing-values-based-on-criteria-in-column-c\" title=\"finding the missing values based on criteria in column c\">stackoverflow.com/questions/49027250/&hellip;</a>  . That code is doing pretty much the same thing as you are now asking."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519832657, "post_id": 49032553, "comment_id": 85071400, "body": "Hi, Thanks, I have accepted the answer that I used now on this question. Would it be possible to change the above code to reflect the new expected data please?"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519833612, "post_id": 49032553, "comment_id": 85072067, "body": "Hi, sorry I am new to Stack overflow so not sure how to do these type of things. I have accepted your answer."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519834101, "post_id": 49032553, "comment_id": 85072400, "body": "Just wondering how to change the cell values now so I can try this one"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519834237, "post_id": 49032553, "comment_id": 85072491, "body": "The solution to this would be based on the code I gave in <a href=\"https://stackoverflow.com/questions/49027250/finding-the-missing-values-based-on-criteria-in-column-c\">this</a> version which takes two far apart column and then output one filled column. Worth trying to understand what it is doing. It is the same principle as you need now."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519834324, "post_id": 49032553, "comment_id": 85072553, "body": "Would it be possible to add comments in the code please?"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519835091, "post_id": 49032553, "comment_id": 85073014, "body": "I am finding it a little bit hard to edit at the moment as I am wondering why the transactions sheet would not have been used first."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519836116, "post_id": 49032553, "comment_id": 85073713, "body": "The transactions sheet is what you wish to update. So it is your target. The roots sheet is where you are actually getting the values from."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519836581, "post_id": 49032553, "comment_id": 85074026, "body": "In Roots what you want to do is loop all the IDs and if the ID is the same you want to add the associated number to your concatenation string. After you have these strings, you want to deposit said strings, against the appropriate ID in the transactions sheet. I use the ID as a key to the dictionary to retrieve the value which is the concatenated string. There is the placeholder string &quot;?&quot; also for missing values for an ID."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519836790, "post_id": 49032553, "comment_id": 85074166, "body": "Hi, I have added the code in the problem description that I am using. It does not work as the subscript is out of range so one of numbers I have put must be incorrect."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519837090, "post_id": 49032553, "comment_id": 85074377, "body": "I keep saying, perhaps the hyperlink wasn&#39;t clear, structure your answer, potentially on my answer here <a href=\"https://stackoverflow.com/questions/49027250/finding-the-missing-values-based-on-criteria-in-column-c\" title=\"finding the missing values based on criteria in column c\">stackoverflow.com/questions/49027250/&hellip;</a> This is the answer which matches your problem statement in terms of having 2 disparate columns and needing to fill one column with return values."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1520242390, "post_id": 49032553, "comment_id": 85219333, "body": "Hi, sorry for the delay, this works for my proof of concept thankyou"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1519884594, "last_edit_date": 1519884594, "creation_date": 1519830086, "answer_id": 49032553, "question_id": 49031302, "link": "https://stackoverflow.com/questions/49031302/comma-delimitting-values-in-a-new-created-column-based-on-a-matching-condition/49032553#49032553", "title": "Comma Delimitting values in a new created column based on a matching condition", "body": "<p>This does an unordered, for the original posting . Assumes data starts in row 2 and has layout as shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cOok5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cOok5.png\" alt=\"Original data layout\"></a></p>\n\n<p>Column D being where the concatenated string is output.</p>\n\n<p>*Please note repeated edits to the original question may mean code will no longer fit the stated requirements.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n    Dim ws As Worksheet\n    Dim lastRow As Long\n    Set ws = ThisWorkbook.Worksheets(\"Roots\")\n    lastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim valuesArr()\n    valuesArr = ws.Range(\"A2:B\" &amp; lastRow)       ' 1 TO 4, 1 TO 2\n\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    Dim currValue As Long\n    Dim currRotation As Long\n    Dim index As String\n\n    For currRotation = LBound(valuesArr, 1) To UBound(valuesArr, 1)\n\n        index = valuesArr(currRotation, 1)\n        currValue = CStr(valuesArr(currRotation, 2))\n\n        If Not dict.exists(index) Then\n\n            dict.Add index, currValue\n\n        Else\n\n            dict(index) = dict(index) &amp; \";\" &amp; currValue\n\n        End If\n\n\n    Next currRotation\n\n    Dim wsTarget As Worksheet\n    Dim lastRowTarget As Long\n    Set wsTarget = ThisWorkbook.Worksheets(\"transactions\")\n    lastRow = wsTarget.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim valuesArr2()\n    valuesArr2 = wsTarget.Range(\"A2:D\" &amp; lastRow)\n\n    Dim testValue As String\n\n    For currRotation = LBound(valuesArr2, 1) To UBound(valuesArr2, 1)\n\n      testValue = dict(CStr(valuesArr2(currRotation, 1)))\n\n      If testValue = vbNullString Then testValue = \"?\"\n\n      valuesArr2(currRotation, 4) = testValue\n\n    Next currRotation\n\n    wsTarget.Range(\"A2\").Resize(UBound(valuesArr2, 1), UBound(valuesArr2, 2)) = valuesArr2\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519838488, "post_id": 49032831, "comment_id": 85075245, "body": "Hi, I have amended my expected result, how would your code then change to reflect this please?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519839638, "post_id": 49032831, "comment_id": 85075954, "body": "@GeorgeH, well that you should infer from my previous code explanations. anyhow see edited code. if this solves your question then please mark it as accepted. thank you"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519898495, "post_id": 49032831, "comment_id": 85098622, "body": "Hi, unfortunately this does not provide any result in column A when this is ran. Can you please advise?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519900715, "post_id": 49032831, "comment_id": 85099924, "body": "where did you ever say results were to be written in column A? actually the code processes sheet &quot;transactions&quot; column C cells, gets corresponding column A value, searches sheet &quot;Roots&quot; column &quot;C&quot; for all cells with that value, concatenates their column D corresponding values into a string and writes it to sheet &quot;transactions&quot; column AA."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519900995, "post_id": 49032831, "comment_id": 85100096, "body": "sorry, I  meant AA is where the results are to be put. This is currently not happening."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519901267, "post_id": 49032831, "comment_id": 85100254, "body": "does the description of  my last comment match exactly the expected behavior? if not, then please detail the exact expected behavior."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519839499, "last_edit_date": 1519839499, "creation_date": 1519830888, "answer_id": 49032831, "question_id": 49031302, "link": "https://stackoverflow.com/questions/49031302/comma-delimitting-values-in-a-new-created-column-based-on-a-matching-condition/49032831#49032831", "title": "Comma Delimitting values in a new created column based on a matching condition", "body": "<p><strong>Edited</strong> as per OP's amended input and output columns</p>\n\n<p>as per your examples, IDs are consecutive in Roots sheet\nso you may go as follows</p>\n\n<pre><code>Sub main()\n    Dim cell As Range\n\n    With Worksheets(\"transactions\") 'reference \"transaction\" sheet\n        For Each cell In .Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp)) 'loop through referenced sheet column A cells from row 2 down to last not empty one\n            cell.Offset(, 26).value = GetIDDeals(cell.value) 'write in current cell offset 26 columns (i.e. column AA) the value of the BID\n        Next\n    End With\n\nEnd Sub\n\nFunction GetIDDeals(ID As Variant) As String\n    With Worksheets(\"Roots\")\n        With .Range(\"C1\", .Cells(.Rows.Count, \"C\").End(xlUp)) 'reference its column C cells from row 1 (header) down to last not empty one\n            .AutoFilter Field:=1, Criteria1:=ID ' filter referenced cells on 1st column with passed ID content\n            Select Case Application.WorksheetFunction.Subtotal(103, .Columns(1)) 'let's see how many filtered cells\n                Case Is &gt; 2 'if more than 2, then we have more than 1 filtered value, since header gets always filtered\n                    GetIDDeals = Join(Application.Transpose(.Offset(1, 1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).value), \",\")\n                Case 2 'if two filtered cells, then we have 1 filtered value, since header gets always filtered\n                    GetIDDeals = .Offset(1, 1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).value\n            End Select\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 49032553, "answer_count": 2, "score": 0, "last_activity_date": 1519884594, "creation_date": 1519826376, "last_edit_date": 1531164843, "question_id": 49031302, "link": "https://stackoverflow.com/questions/49031302/comma-delimitting-values-in-a-new-created-column-based-on-a-matching-condition", "title": "Comma Delimitting values in a new created column based on a matching condition", "body": "<p>I have a value in column A on the transactions sheet which contains an Identifier for a Deal.</p>\n\n<p>To be able to find out the customer information for this Deal I look in another sheet called Deal Information. Here there is a value in Column F which matches a value in Column A on the transactions sheet. Although on the Deal Information sheet it lists all the customers who are part of this deal as well as a unique identifier for each of the customers.</p>\n\n<p>On the transactions sheet I have created a new column where by I want to display the list of ID's associated to a particular deal in comma delimited format if possible if not then a space will be good too.</p>\n\n<p>transactions data:</p>\n\n<p>Column A:ID      Column: AA: BID Multiple\n    1                       ?\n    2                        ?\n    3                        ?\n    4                         ?</p>\n\n<p>Roots data:</p>\n\n<p>Column C: ID    Column: D: BID\n    1             100\n    1              200\n    1              300\n    2              101</p>\n\n<p>Expected Result in transaction table based on example.</p>\n\n<pre><code>Column A ID    Column AA: BID Multiple\n1                 100,200,300\n2                  101\n3                    ?\n4                    ?\n\n Sub test()\n\n Dim wb As Workbook\n Set wb = ThisWorkbook\n Dim ws As Worksheet\n Dim lastRow As Long\n Set ws = ThisWorkbook.Worksheets(\"Roots\")\n lastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n Dim valuesArr()\n valuesArr = ws.Range(\"F2:G\" &amp; lastRow)       ' 1 TO 4, 1 TO 2\n\n Dim dict As Object\n Set dict = CreateObject(\"Scripting.Dictionary\")\n Dim valuesString As String\n Dim currValue As Long\n Dim currRotation As Long\n Dim index As String\n\n For currRotation = LBound(valuesArr, 1) To UBound(valuesArr, 1)\n    index = valuesArr(currRotation, 1)\n    currValue = CStr(valuesArr(currRotation, 2))\n    If Not dict.Exists(index) Then\n        dict.Add index, currValue\n    Else\n        dict(index) = dict(index) &amp; \";\" &amp; currValue\n    End If\n Next currRotation\n\n Dim wsTarget As Worksheet\n Dim lastRowTarget As Long\n Set wsTarget = ThisWorkbook.Worksheets(\"transactions\")\n lastRow = wsTarget.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n Dim valuesArr2()\n valuesArr2 = wsTarget.Range(\"A2:AA\" &amp; lastRow)\n\n Dim testValue As String\n\n For currRotation = LBound(valuesArr2, 1) To UBound(valuesArr2, 1)\n\n  testValue = dict(CStr(valuesArr2(currRotation, 1)))\n\n  If testValue = vbNullString Then testValue = \"?\"\n\n  valuesArr2(currRotation, 27) = testValue\n\n Next currRotation\n wsTarget.Range(\"A2\").Resize(UBound(valuesArr2, 1), UBound(valuesArr2, \n 27)) = valuesArr2\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519865521, "post_id": 49031267, "comment_id": 85087329, "body": "I&#39;m little confused? can you add some more detail info?"}, {"owner": {"reputation": 13, "user_id": 5623840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/964af61405872188229f498fb659ceda?s=128&d=identicon&r=PG&f=1", "display_name": "AlanGrant", "link": "https://stackoverflow.com/users/5623840/alangrant"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519921197, "post_id": 49031267, "comment_id": 85112814, "body": "Yes, problem is occasionally my work pc will restart overnight while emails are open. Not sure why yet but I&#39;d like a way to look up which emails may have been opened at the time. I envision this &quot;look up&quot; as a scheduled written text file listing the Subject fields of open emails. Another way could be to schedule an export of the opened emails at 4 PM when I leave work. The /restore switch in Outlook startup won&#39;t reopen the emails because it appears the pc goes through a graceful shutdown, not a crash. Dmitry has a solution I could try but I&#39;d welcome anything you may suggest as well."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1519826958, "creation_date": 1519826958, "answer_id": 49031496, "question_id": 49031267, "link": "https://stackoverflow.com/questions/49031267/tracking-open-outlook-2010-emails/49031496#49031496", "title": "Tracking open Outlook 2010 emails", "body": "<p>Trap the <code>Application.Inspectors.NewInspector</code> event an read the <code>Inspector.CurrenmtItem.Subject</code> property. Reading pane needs to be handled separately.</p>\n"}], "owner": {"reputation": 13, "user_id": 5623840, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/964af61405872188229f498fb659ceda?s=128&d=identicon&r=PG&f=1", "display_name": "AlanGrant", "link": "https://stackoverflow.com/users/5623840/alangrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593041194, "creation_date": 1519826280, "last_edit_date": 1593041194, "question_id": 49031267, "link": "https://stackoverflow.com/questions/49031267/tracking-open-outlook-2010-emails", "title": "Tracking open Outlook 2010 emails", "body": "<p>I'm looking for a programmatic way (eg: using VBA) to write the Subject texts of emails which are open, or otherwise export opened emails to a file system folder.</p>\n"}, {"tags": ["excel", "acrobat-sdk", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519826051, "post_id": 49030918, "comment_id": 85066864, "body": "The backslash is missing in the end here <code>&quot;C:\\temp\\ocopy&quot;</code> and therefore <code>s = Dir(f &amp; &quot;*.pdf&quot;)</code> fails, because there is no backslash between the path and the filename. It must be ` <code>&quot;C:\\temp\\ocopy\\&quot;</code>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1519826072, "post_id": 49030918, "comment_id": 85066875, "body": "Can you upload sample of a PDF file?"}, {"owner": {"reputation": 41, "user_id": 3657047, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f877003bac61da45e49073656aa2cfb?s=128&d=identicon&r=PG&f=1", "display_name": "rylaughlin", "link": "https://stackoverflow.com/users/3657047/rylaughlin"}, "edited": false, "score": 0, "creation_date": 1519826580, "post_id": 49030918, "comment_id": 85067199, "body": "I am so dumb. That&#39;s exactly what was wrong. Thank you!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519827900, "post_id": 49030918, "comment_id": 85068143, "body": "@rylaughlin such things happen to everyone. But next time just debug your code by going through step-by-step (eg with F8) and check the values of your variables in every step. Then you will see such effects immediately on your own, and it saves you time asking a long question. <b>Just another thing:</b> <code>Dim text1, text2 As String</code> defines <code>text1</code> as variant and <code>text2</code> as string. You need to specify a type for every variable: <code>Dim text1 As String, text2 As String</code> to make them both of type <code>String</code>."}], "owner": {"reputation": 41, "user_id": 3657047, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6f877003bac61da45e49073656aa2cfb?s=128&d=identicon&r=PG&f=1", "display_name": "rylaughlin", "link": "https://stackoverflow.com/users/3657047/rylaughlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1062, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519825117, "creation_date": 1519825117, "last_edit_date": 1531164843, "question_id": 49030918, "link": "https://stackoverflow.com/questions/49030918/looping-through-pdf-files", "title": "Looping Through PDF Files", "body": "<p>I have a working VBA script that pulls specific form fields from a specified PDF file into a spreadsheet. However I have several hundred PDFs that I need to do this for, so I'd like to loop through files in a directory and perform the same action.</p>\n\n<p>Conveniently I have an old VBA script that loops through Word files in a directory and imports the content of each just how I'd like.</p>\n\n<p>I hardly know VBA but I've adapted scripts in several language including VBA to meet my needs. I thought this would take 10 minutes but its taken several hours. Can somebody please look at my script below and tell me where I'm going wrong? I assume it has something to do with the Word and Acrobat libraries having different requirements, but even my loop isn't displaying the test message.</p>\n\n<p>PS I have Acrobat Pro installed.</p>\n\n<p><strong>My Script (Non-Working)</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim f As String: f = \"C:\\temp\\ocopy\"\n    Dim s As String: s = Dir(f &amp; \"*.pdf\")\n    Dim AcroApp As Acrobat.CAcroApp\n    Dim theForm As Acrobat.CAcroPDDoc\n    Dim jso As Object\n    Dim text1, text2 As String\n    Dim col As Integer: col = 1\n\n    Do Until s = \"\"\n        Set AcroApp = CreateObject(\"AcroExch.App\")\n        Set theForm = CreateObject(\"AcroExch.PDDoc\")\n\n        theForm.Open (f &amp; s)\n        Set jso = theForm.GetJSObject\n\n        text1 = jso.getField(\"Name of serviceRow1\").Value\n        text2 = jso.getField(\"Who are the key contacts?\").Value\n        MsgBox text1\n        MsgBox \"text1\"\n        Sheet1.Cells(col, 1).Value = text1\n        Sheet1.Cells(col, 2).Value = text2\n        col = col + 1: s = Dir\n        theForm.Close\n\n        AcroApp.Exit\n        Set AcroApp = Nothing\n        Set theForm = Nothing\n    Loop\nEnd Sub\n</code></pre>\n\n<p><strong>Word Script - Works at Looping and Importing</strong></p>\n\n<pre><code>Sub fromWordDocsToMultiCols()\n    Dim f As String: f = \"C:\\temp\\Test\\\"\n    Dim s As String: s = Dir(f &amp; \"*.docx\")\n    Dim wdApp As New Word.Application, wdDoc As Word.Document\n    Dim col As Integer: col = 1\n\n    On Error GoTo errHandler\n    Do Until s = \"\"\n        Set wdDoc = wdApp.Documents.Open(f &amp; s)\n        wdDoc.Range.Copy\n        Sheet1.Cells(1, col).Value = s\n        Sheet1.Cells(2, col).PasteSpecial xlPasteValues\n        wdDoc.Close False: col = col + 1: s = Dir\n    Loop\n\nerrHandler:\n    If Err.Number &lt;&gt; 0 Then MsgBox Err.Description\n    If Not wdApp Is Nothing Then wdApp.Quit False\nEnd Sub\n</code></pre>\n\n<p><strong>Acrobat Script - Works as Importing One-by-One</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()        \n    Dim AcroApp As Acrobat.CAcroApp\n    Dim theForm As Acrobat.CAcroPDDoc\n    Dim jso As Object\n    Dim text1, text2 As String\n\n    Set AcroApp = CreateObject(\"AcroExch.App\")\n    Set theForm = CreateObject(\"AcroExch.PDDoc\")\n    theForm.Open (\"C:\\temp\\ocopy\\Minerals asset management.pdf\")\n    Set jso = theForm.GetJSObject\n\n    ' get the information from the form fiels Text1 and Text2\n    text1 = jso.getField(\"Name of serviceRow1\").Value\n    text2 = jso.getField(\"Who are the key contacts within the team for this service? Please provide one contact per region\").Value\n\n\n\n    Sheet1.Cells(1, 1).Value = text1\n    Sheet1.Cells(1, 2).Value = text2\n    theForm.Close\n\n    AcroApp.Exit\n    Set AcroApp = Nothing\n    Set theForm = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1519825425, "post_id": 49030643, "comment_id": 85066421, "body": "It all depends upon what you are trying to accomplish.  For example, it is much easier to move blocks of cells to and from arrays."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 3, "creation_date": 1519825693, "post_id": 49030643, "comment_id": 85066626, "body": "<a href=\"https://stackoverflow.com/questions/32479842/comparison-of-dictionary-collections-and-arrays\">Related question, also includes Dictionaries</a>"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 1, "creation_date": 1519826468, "post_id": 49030643, "comment_id": 85067124, "body": "One factor is how the collection or array is created. Reading a range of cells into an array is very efficient with the built in method. Creating a collection then populating it is probably less efficient, again depending on the method used. The most inefficient aspect of strings is their immutability, if you&#39;re concatenating you&#39;ll probably want to make a string builder. I&#39;ve posted one on my site here: (warning to be clear: this is my own site, no advertising intended!) <a href=\"https://excelpro.tech/free-downloads.php\" rel=\"nofollow noreferrer\">excelpro.tech/free-downloads.php</a>"}, {"owner": {"reputation": 105, "user_id": 8979433, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/04e5e06a2e114961b5fa604dfc2d0c1c?s=128&d=identicon&r=PG&f=1", "display_name": "TimRicta", "link": "https://stackoverflow.com/users/8979433/timricta"}, "edited": false, "score": 0, "creation_date": 1519826504, "post_id": 49030643, "comment_id": 85067144, "body": "Why is it much easier to move blocks of cells to and from arrays than arrays?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1519827302, "post_id": 49030643, "comment_id": 85067692, "body": "When in doubt -- benchmark."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1519827560, "post_id": 49030643, "comment_id": 85067886, "body": "@Absinthe linking to your own site in the comments when relevant is fine. That seems like an interesting site."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1519827926, "post_id": 49030643, "comment_id": 85068161, "body": "A key question is if you need to dynamically grow your data structure. If you find yourself using <code>ReDim Preserve</code> in a loop -- switch to a collection ASAP.  Otherwise, stick to an array unless you have good reasons not to. In some cases you might want to consider using an <code>ArrayList</code> from VB.Net (but usable in VBA via <code>CreateObject()</code>)"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1519829240, "post_id": 49030643, "comment_id": 85069112, "body": "@John Coleman, the most efficient way is always the array. A Collection uses and grows multiple arrays internally. Thus the choice should depend on the number of entries and not if it needs to grow."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1519829242, "post_id": 49030643, "comment_id": 85069115, "body": "Looking at the code in your edit, if you wanted to merge an array of string arrays rather than a collection of string collections, you can <i>quickly</i> (bu using <code>UBound()</code> appropriately) determine ahead of time how big the final array needs to be and <code>Dim</code> it just once rather than using <code>ReDim Preserve</code>. One advantage of sticking with arrays is that you can use <code>Join</code> on arrays if you want to e.g. write it all to a text file in 1 line of code."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1519829480, "post_id": 49030643, "comment_id": 85069272, "body": "@JohnColeman Thanks, it&#39;s a work in progress but I&#39;m hoping to grow it as i find useful info that&#39;s not well known. Good point about growing the arrays."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1519830376, "post_id": 49030643, "comment_id": 85069894, "body": "@FlorentB. <code>Collection.Add</code> is <code>O(1)</code> (albeit not in a super-efficient way) but a naive use of <code>ReDim Preserve</code> is <code>O(n)</code>, so I am not sure what you mean when you say that a need to grow the data isn&#39;t relevant in the decision. The accepted answer to this question suggests that the implementation of a VBA collection is a weird cross between a doubly-linked list and a hash table: <a href=\"https://stackoverflow.com/q/2548526/4996248\">stackoverflow.com/q/2548526/4996248</a>"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1519833569, "post_id": 49030643, "comment_id": 85072044, "body": "@John Coleman, <code>Collection.Add</code> is O(1) but ` Collection.Item` is always O(n) (unless a key is is provided). With an array you can simply double the size when required to keep a complexity of O(1) for the getter and setter. Note that I wrongly assumed that the inner structure was based on an hashtable, which is as you pointed out a double linked list when the key is not provided. Bottom line is that a collection should not be used to store a large amount of data and should not access entries by index."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1519833943, "post_id": 49030643, "comment_id": 85072303, "body": "@FlorentB. I agree that arrays are almost always better. Collections are basically stunted dictionaries. The only real use case that I see is when you are building up something item by item and only intend to ever use them in a <code>for each</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 2, "last_activity_date": 1519826972, "creation_date": 1519826972, "answer_id": 49031505, "question_id": 49030643, "link": "https://stackoverflow.com/questions/49030643/do-collections-need-more-computer-power-than-arrays/49031505#49031505", "title": "Do Collections need more computer power than arrays?", "body": "<p>Probably the most efficient way is to list the strings in cells on a worksheet then read the range of those cells into an array. This is a very quick method (ranges of 100k cells read in milliseconds on a reasonably fast PC):</p>\n\n<pre><code>Sub test()\n\nDim a() As Variant\n\na = Range(\"A1:A1000\").Value\n\nEnd Sub\n</code></pre>\n\n<p><code>a</code> will now contain those strings.</p>\n\n<p>Note that this method produces a multidimensional base 1 array, not base zero, so for example the first string in the above example would be at index 1,1.</p>\n"}], "owner": {"reputation": 105, "user_id": 8979433, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/04e5e06a2e114961b5fa604dfc2d0c1c?s=128&d=identicon&r=PG&f=1", "display_name": "TimRicta", "link": "https://stackoverflow.com/users/8979433/timricta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519827945, "creation_date": 1519824213, "last_edit_date": 1531164843, "question_id": 49030643, "link": "https://stackoverflow.com/questions/49030643/do-collections-need-more-computer-power-than-arrays", "title": "Do Collections need more computer power than arrays?", "body": "<p>Are Collections in vba not as efficient as arrays when it comes to long lists of strings?</p>\n\n<p>My vba-Tool is not as fast as i want it to be. I use a lot of collections because i don't have to REDIM and also i don't have to use additionally counting-variables.</p>\n\n<p>For example (I want to unite the array a and the collection col in one list, but the tricky part is, that to every array element, there are a certain number of col-elements):</p>\n\n<pre><code>For i = 1 To col.count\n        colSave.Add \"===========================\"\n        colSave.Add a(i - 1)\n        colSave.Add \"===========================\"\n        For k = 1 To colFilter.Item(i).count\n            colSave.Add col.Item(i).Item(k)\n        Next k\nNext i\n</code></pre>\n\n<p>Is more efficient to use an array in this case with a third counting variable?</p>\n"}, {"tags": ["excel", "vba", "search"], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1519825621, "creation_date": 1519825621, "answer_id": 49031072, "question_id": 49030465, "link": "https://stackoverflow.com/questions/49030465/find-word-in-excel/49031072#49031072", "title": "Find word in excel", "body": "<p>Not sure I understand your question, does the following provide a solution:</p>\n\n<pre><code>Sub SampleCelle()\nDim myCell As String\n\nmyCell = 'whatever word you're looking for\nSet myRange = Worksheets(\"Data\").Range(\"A:A\").Find(myCell, , xlValues, xlWhole, , MatchCase:=False, searchformat:=False)\nCells(\"A2\") = myRange.Address\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519840590, "creation_date": 1519840590, "answer_id": 49035784, "question_id": 49030465, "link": "https://stackoverflow.com/questions/49030465/find-word-in-excel/49035784#49035784", "title": "Find word in excel", "body": "<p>you can use</p>\n\n<pre><code>Selection.Formula = \"=CELL(\"\"Address\"\", OFFSET(A2,,MATCH(A1,B2:AD2,0)))\"\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 5595128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10207810805730539/picture?type=large", "display_name": "Mikkel Astrup", "link": "https://stackoverflow.com/users/5595128/mikkel-astrup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519840590, "creation_date": 1519823627, "last_edit_date": 1519823659, "question_id": 49030465, "link": "https://stackoverflow.com/questions/49030465/find-word-in-excel", "title": "Find word in excel", "body": "<p>Im trying to find a word in my excel sheet and write the address of that word in a cell (A2). </p>\n\n<p>My code looks like this </p>\n\n<pre><code>Sub SampleCelle()\n\nWorksheets(\"Data\").Select\nRange(\"A2\").Select\nSelection.Formular = \"=CELL(\"\"Address\"\";INDEX($B$2:$AD$2;MATCH($A$1;$B$2:$AD$2;0)))\"\n\n\nEnd Sub\n</code></pre>\n\n<p>So Im trying to find the address of the word written in A1, but I get </p>\n\n<blockquote>\n  <p>run time error 438</p>\n</blockquote>\n\n<p>when I run it. The \";\" are due to local language in excel. \nI hope someone can help me figure out how to get past the error </p>\n"}, {"tags": ["excel", "vba", "key", "enter"], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519841325, "post_id": 49030547, "comment_id": 85076775, "body": "this is VB.NET. For VBA see my answer"}], "tags": [], "owner": {"reputation": 128, "user_id": 9261208, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7b4e9b02073596fd46e9d0bd05f271c6?s=128&d=identicon&r=PG&f=1", "display_name": "Christian T", "link": "https://stackoverflow.com/users/9261208/christian-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1519823892, "creation_date": 1519823892, "answer_id": 49030547, "question_id": 49030347, "link": "https://stackoverflow.com/questions/49030347/user-form-with-combobox-enter-key-behaviour/49030547#49030547", "title": "User form with combobox - enter key behaviour", "body": "<p>You could use a KeyDown event, providing the userform is activated it would look something like:</p>\n\n<pre><code>Private Sub UserForm1_KeyDown(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles UserForm1.KeyDown\n        If e.KeyCode.Equals(Keys.Enter) Then\n            'Do Stuff\n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519841290, "creation_date": 1519841290, "answer_id": 49035956, "question_id": 49030347, "link": "https://stackoverflow.com/questions/49030347/user-form-with-combobox-enter-key-behaviour/49035956#49035956", "title": "User form with combobox - enter key behaviour", "body": "<p>you have to:</p>\n\n<ul>\n<li><p>set all your UserForm controls \"TabStop\" property to <code>False</code></p>\n\n<p>this to prevent them \"stealing\" focus from Userform itself</p></li>\n<li><p>add the following <code>UserForm_KeyDown</code> event handler</p>\n\n<pre><code>Private Sub UserForm_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = vbKeyReturn Then CommandButton1_Click 'change \"CommandButton1\" to actual name of your button you want to mimic behavior of\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 5048, "user_id": 68348, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5bf50e2e9914ce342c80377f77051300?s=128&d=identicon&r=PG", "display_name": "tintincutes", "link": "https://stackoverflow.com/users/68348/tintincutes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2777, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586711759, "creation_date": 1519823272, "last_edit_date": 1586711759, "question_id": 49030347, "link": "https://stackoverflow.com/questions/49030347/user-form-with-combobox-enter-key-behaviour", "title": "User form with combobox - enter key behaviour", "body": "<p>I have a user form which has a combobox drop down where user can select data and then click on the button, to search for an equivalent based on the entered/selected data. </p>\n\n<p>Is is possible that they can also hit the \"Enter\" key from the keyboard and that it will behave the same as when they click on the search button? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519824167, "post_id": 49030298, "comment_id": 85065522, "body": "<code>hyperlinkSubaddress</code> is defined as array so you need to give an index like <code>hyperlinkSubaddress(index)</code>. You cannot set an array for <code>.SubAddress</code> it awaits a string (<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/hyperlink-subaddress-property-excel\" rel=\"nofollow noreferrer\">see documentation</a>) If you want to set a different hyperlink for each cell in a range then you would need to loop through that range."}, {"owner": {"reputation": 1107, "user_id": 916278, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38d6c5aafe48db8271601ae25a3a8049?s=128&d=identicon&r=PG", "display_name": "Sai Nikhil", "link": "https://stackoverflow.com/users/916278/sai-nikhil"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519824700, "post_id": 49030298, "comment_id": 85065874, "body": "@P\u1d07\u029c: We have those stored in an array. Is there a way to do it in single line by using some excel functions instead of a loop?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519825021, "post_id": 49030298, "comment_id": 85066102, "body": "No. As I wrote you will need to loop because the <code>.SubAddress</code> only accepts a string as parameter and no array."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1519827454, "post_id": 49030298, "comment_id": 85067805, "body": "@saint1729 Agree with PEH, you&#39;ll have to loop through the cells"}, {"owner": {"reputation": 1107, "user_id": 916278, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38d6c5aafe48db8271601ae25a3a8049?s=128&d=identicon&r=PG", "display_name": "Sai Nikhil", "link": "https://stackoverflow.com/users/916278/sai-nikhil"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519886144, "post_id": 49030298, "comment_id": 85092651, "body": "@P\u1d07\u029c , absinthe It&#39;s taking 3-4 seconds for the loop get executed for populating links to 10000 rows in Validation Report. I followed something like the one mentioned here. <a href=\"https://niallflynn.com/news/convert-urls-to-clickable-links-in-excel/\" rel=\"nofollow noreferrer\">niallflynn.com/news/convert-urls-to-clickable-links-in-excel</a> Can this be optimized?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519889138, "post_id": 49030298, "comment_id": 85093821, "body": "If your code works and doesn&#39;t show any errors and you just ask &quot;<i>Can this be optimized?</i>&quot; then this might be a question for <a href=\"https://codereview.stackexchange.com/\">CodeReview</a>. But let me just say: A loop is a loop and it needs it&#39;s time to loop through and populate 10000 rows with links. What you can try is turn of screen updating before the task <code>Application.ScreenUpdating = False</code> and turn on again after the task."}], "owner": {"reputation": 1107, "user_id": 916278, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38d6c5aafe48db8271601ae25a3a8049?s=128&d=identicon&r=PG", "display_name": "Sai Nikhil", "link": "https://stackoverflow.com/users/916278/sai-nikhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519824496, "creation_date": 1519823062, "last_edit_date": 1519824496, "question_id": 49030298, "link": "https://stackoverflow.com/questions/49030298/set-hyperlink-address-for-a-range-of-cells", "title": "Set Hyperlink Address for a range of cells", "body": "<p>I have two sheets in my workbook. Names are as follows:</p>\n\n<pre><code>1) Temp\n2) Validation Report\n</code></pre>\n\n<p>Sheet \"Temp\" contains 10000 rows in column 'A'.</p>\n\n<p>Sheet \"Validation Report\" contains 3 columns 'A', 'B' and 'C', for error reporting. Error rows are populated for empty cell values present in Sheet \"Temp\". Column 'A' contains 'Name of Sheet \"Temp\"', Column 'B' contains value of empty cell of sheet \"Temp\" with a hyperlink to the appropriate cell, Column 'C' contains the error message.</p>\n\n<p>I am using following macro to detect empty cells in sheet \"Temp\" and show error message for those cells in sheet \"Validation Report\" and provide hyperlinks to the appropriate cells of sheet \"Temp\".</p>\n\n<pre><code>Dim validationErrors(1 To 20000, 1 To 3) As Variant\nDim hyperlinkSubaddress(1 To 20000) As Variant\ndat = Range(\"A1:A10000\").Value\n\nvalidationSheetStartRow = 0\nc = 1\n\nstartTime = Timer\n\nDo While (c &lt; 10000)\n\n    num = dat(c, 1)\n\n    errorMsg = \"Value is not present.\"\n    If (IsEmpty(Sheets(\"Temp\").Cells(c, 1))) Then\n        validationSheetStartRow = validationSheetStartRow + 1\n        validationErrors(validationSheetStartRow, 1) = \"Temp\"\n        validationErrors(validationSheetStartRow, 2) = num\n        validationErrors(validationSheetStartRow, 3) = errorMsg\n        hyperlinkSubaddress(validationSheetStartRow) = \"Temp!\" &amp; Sheets(\"Temp\").Cells(c, 1).Address\n    End If\n\n    c = c + 1\nLoop\n\n\nSheets(validationErrorSheet).Range(\"A1:C\" &amp; validationSheetStartRow) = validationErrors\nSheets(validationErrorSheet).Range(\"A1:A\" &amp; validationSheetStartRow).Hyperlink.SubAddress = hyperlinkSubaddress\n\nendTime = Timer\n\nMsgBox endTime - startTime\n</code></pre>\n\n<p>The following line in the above code is written to set the sub-address for hyperlinks:</p>\n\n<pre><code>Sheets(validationErrorSheet).Range(\"A1:A\" &amp; validationSheetStartRow).Hyperlink.SubAddress = hyperlinkSubaddress\n</code></pre>\n\n<p>It gives the following error:</p>\n\n<blockquote>\n  <p>Run-Time error '438':</p>\n  \n  <p>Object doesn't support this property or method</p>\n</blockquote>\n\n<p>Is there a way we can set the hyperlinks to a range in a fast way?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519876376, "post_id": 49029932, "comment_id": 85089845, "body": "Is this the data your trying to pull? <a href=\"https://regex101.com/r/S4JTTP/1\" rel=\"nofollow noreferrer\">regex101.com/r/S4JTTP/1</a>"}, {"owner": {"reputation": 21, "user_id": 9423666, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m056GeW8AUc/AAAAAAAAAAI/AAAAAAAADZo/ArVDLN8M-Ec/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/9423666/alex-b"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519899902, "post_id": 49029932, "comment_id": 85099387, "body": "Looks like it is. I only require one instance of the amount to be captured. As the amount can be duplicated in the body of the email."}, {"owner": {"reputation": 21, "user_id": 9423666, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m056GeW8AUc/AAAAAAAAAAI/AAAAAAAADZo/ArVDLN8M-Ec/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/9423666/alex-b"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519900100, "post_id": 49029932, "comment_id": 85099513, "body": "The only one thing to note the match criteria you have pointed out is that the amount can be made up of two to three digits, the Match function is looking to a three character string."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519912998, "post_id": 49029932, "comment_id": 85107128, "body": "\\s(\\d{1,3}\\.\\d{2,3})\\s|\\s(\\d{15})\\s    You can specify ranges in the regex @0m3r gave..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519913963, "post_id": 49029932, "comment_id": 85107728, "body": "Is  000001017660912 the invoice? So for every e-mail you want the amount and this long invoice number? Is the length of the invoice number fixed?"}, {"owner": {"reputation": 21, "user_id": 9423666, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m056GeW8AUc/AAAAAAAAAAI/AAAAAAAADZo/ArVDLN8M-Ec/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/9423666/alex-b"}, "edited": false, "score": 0, "creation_date": 1519915351, "post_id": 49029932, "comment_id": 85108656, "body": "indeed , the invoice number will always stay the same number of digits. The bad thing about all this is the fact that i have no idea how to implement this using regex. Even the most clued up person on VBA in the company is not that proficient using regex."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519916847, "post_id": 49029932, "comment_id": 85109717, "body": "the regex @0m3r gave and the variation I mentioned is a starter. For the other, as it is 15 digits with a gap either side you are looking for something like \\d{15}\\s   Tbh, I haven&#39;t tried VBA regex with range but imagine you can do {1,3}"}], "owner": {"reputation": 21, "user_id": 9423666, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m056GeW8AUc/AAAAAAAAAAI/AAAAAAAADZo/ArVDLN8M-Ec/photo.jpg?sz=128", "display_name": "Alex B", "link": "https://stackoverflow.com/users/9423666/alex-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1593041443, "creation_date": 1519821955, "last_edit_date": 1593041443, "question_id": 49029932, "link": "https://stackoverflow.com/questions/49029932/string-extraction-from-body-of-email", "title": "String extraction from body of email", "body": "<p>I would like to extract information from the body of an email. </p>\n\n<p>The email is not consistent in format. The code is returning ZERO values in certain cases.</p>\n\n<p>Here is the current iteration of code.</p>\n\n<pre><code>Sub CopyToExcel()\n     Dim xlApp As Object\n     Dim xlWB As Object\n     Dim xlSheet As Object\n     Dim olItem As Outlook.MailItem\n     Dim vText As Variant\n     Dim sText As String\n     Dim vItem As Variant\n     Dim oText As Variant\n     Dim oItem As String\n\n     Dim i As Long\n     Dim rCount As Long\n     Dim bXStarted As Boolean\n     enviro = CStr(Environ(\"USERPROFILE\"))\n     'the path of the workbook\n     strPath = enviro &amp; \"\\Documents\\TEST.xlsx\"\n\n     If Application.ActiveExplorer.Selection.Count = 0 Then\n        MsgBox \"No Items selected!\", vbCritical, \"Error\"\n        Exit Sub\n       End If\n        On Error Resume Next\n        Set xlApp = GetObject(, \"Excel.Application\")\n     If Err &lt;&gt; 0 Then\n       Application.StatusBar = \"Please wait while Excel source is opened ... \"\n     Set xlApp = CreateObject(\"Excel.Application\")\n     bXStarted = True\n       End If\n     On Error GoTo 0\n    'Open the workbook to input the data\n     Set xlWB = xlApp.Workbooks.Open(strPath)\n     Set xlSheet = xlWB.Sheets(\"Sheet1\")\n\n     'Process each selected record\n       rCount = xlSheet.UsedRange.Rows.Count + 1\n        For Each olItem In Application.ActiveExplorer.Selection\n        oText = Split(olItem.Subject, \":\")\n        sText = olItem.Body\n        vText = Split(sText, Chr(13))\n       'Find the next empty line of the worksheet\n\n          oItem = Trim(oText(1))\n          If Len(oText(1)) = 0 Then oText(1) = \"\"\n          'Check each line of text in the message body\n          For i = UBound(vText) To 0 Step -1\n\n\n\n         If InStr(1, vText(i), \"-\") &gt; 0 Then\n                     vItem = Split(vText(i), Chr(45))\n                     xlSheet.Range(\"A\" &amp; rCount) = oText(1)\n                     xlSheet.Range(\"B\" &amp; rCount) = Trim(vItem(0))\n                     xlSheet.Range(\"C\" &amp; rCount) = Trim(vItem(1))\n\n            End If\n          Next i\n       xlWB.Save\n         rCount = rCount + 1\n       Next olItem\n       xlWB.Close SaveChanges:=True\n       If bXStarted Then\n          xlApp.Quit\n      End If\n      Set xlApp = Nothing\n      Set xlWB = Nothing\n      Set xlSheet = Nothing\n      Set olItem = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The code works with this email.</p>\n\n<blockquote>\n  <p><em>\"Dear Sir/Madam,We wish to confirm that <strong>107.34</strong> STG will be lodged to your nominated bank account. This is in full and final settlement of your claim.\n  <strong>107.34 - 000001017660912</em></strong><br>\n  <em>John Smith On behalf of the Company.\"</em></p>\n</blockquote>\n\n<p>It finds the amount paid and the invoice number and adds it to an Excel spreadsheet. I have bolded the data required.</p>\n\n<p>In the example below the <strong><code>\"-\"</code></strong> character that helps the Split function is not present and the If function returns False.</p>\n\n<blockquote>\n  <p><em>\"Dear Sir/Madam,We wish to confirm that <strong>143.81</strong> STG will be lodged to your nominated bank account. This is in full and final settlement of your claim.\n  <strong>000001017671676</strong><br>\n  JOHN SMITH On behalf of the Company.\"</em></p>\n</blockquote>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1519821136, "creation_date": 1519821136, "answer_id": 49029693, "question_id": 49029650, "link": "https://stackoverflow.com/questions/49029650/writing-into-new-email-change-the-date-1-if-date-vbmonday-to-text/49029693#49029693", "title": "Writing into new email: change the Date -1 if Date = vbMonday to &quot;text&quot;", "body": "<p>Try like this with the weekdays:</p>\n\n<pre><code>Public Sub TestMe()    \n    If Weekday(Date) = vbWednesday Then\n        Debug.Print \"It is Wednesday!\"\n    End If    \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "edited": false, "score": 0, "creation_date": 1519822067, "post_id": 49029750, "comment_id": 85064094, "body": "Splendid, thank you. I thought it was the easiest [best] way of approaching it. I tried with &quot;If&quot; but it didn&#39;t work, can you advise why it is &quot;IIf&quot; and not &quot;If&quot; ? Thanks again"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "edited": false, "score": 0, "creation_date": 1519827801, "post_id": 49029750, "comment_id": 85068071, "body": "IIf() function is sort of a shortened version of If-Then-Else construct, the most relevant difference from this latter being that it evaluates both conditions so that if one of them errors then the function does, too. But in this case it\u2019s safe."}, {"owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "edited": false, "score": 0, "creation_date": 1519827869, "post_id": 49029750, "comment_id": 85068125, "body": "Much Obliged. Regards"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1519821337, "creation_date": 1519821337, "answer_id": 49029750, "question_id": 49029650, "link": "https://stackoverflow.com/questions/49029650/writing-into-new-email-change-the-date-1-if-date-vbmonday-to-text/49029750#49029750", "title": "Writing into new email: change the Date -1 if Date = vbMonday to &quot;text&quot;", "body": "<pre><code>strbody = \"Hi,\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"No events: \" &amp; IIf(Weekday(Date) = vbMonday, \"weekend\", Date - 1) &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"Thanks\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"Thomas\"\n</code></pre>\n"}], "owner": {"reputation": 519, "user_id": 9245245, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mcgHy.jpg?s=128&g=1", "display_name": "Wheeliam", "link": "https://stackoverflow.com/users/9245245/wheeliam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 49029750, "answer_count": 2, "score": 1, "last_activity_date": 1593002916, "creation_date": 1519820974, "last_edit_date": 1593002916, "question_id": 49029650, "link": "https://stackoverflow.com/questions/49029650/writing-into-new-email-change-the-date-1-if-date-vbmonday-to-text", "title": "Writing into new email: change the Date -1 if Date = vbMonday to &quot;text&quot;", "body": "<p>I have developed the code which allows me to send an email with predefined text, which I set to change only where the date is <code>Date -1</code> </p>\n\n<p>I need to add another functionality: If the current day is <code>vbMonday</code> insert \"weekend\" instead of <code>Date - 1</code></p>\n\n<p>I was thinking about something along the lines of: <code>If Date = vbMonday then instead of Date - 1 enter \"weekend\"</code></p>\n\n<p>This is the part:</p>\n\n<pre><code>Sub Email_Outlook()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    strbody = \"Hi,\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"No events: \" &amp; Date - 1 &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"Thanks\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"Thomas\"\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "macos", "pdf", "export"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519819865, "post_id": 49029182, "comment_id": 85062683, "body": "Your problem might be with the start / . Have you tried saving a file in this location and then using GetOpenFileName to see what the actual folder path is that you need?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519820065, "post_id": 49029182, "comment_id": 85062799, "body": "See my answer here <a href=\"https://stackoverflow.com/questions/48693411/error-53-when-opening-csv-file-on-mac/48735319#48735319\" title=\"error 53 when opening csv file on mac\">stackoverflow.com/questions/48693411/&hellip;</a> and make sure you have a valid path to the file."}, {"owner": {"reputation": 11, "user_id": 9423574, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0XRmUv6HTmE/AAAAAAAAAAI/AAAAAAAAASg/8ZvlMjvQvHk/photo.jpg?sz=128", "display_name": "Vallier Adam", "link": "https://stackoverflow.com/users/9423574/vallier-adam"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519824561, "post_id": 49029182, "comment_id": 85065779, "body": "@QHarr unfortunately this doesn&#39;t help. I am trying to export a worksheet to pdf, and I derived the path from the terminal"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519827523, "post_id": 49029182, "comment_id": 85067861, "body": "the terminal path won&#39;t necessarily be the same as the path you need for your code to run. This you get as per my link. Are you saying you have no other way to get the path? Apologies if being dense."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 9493718, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tvwalsh", "link": "https://stackoverflow.com/users/9493718/tvwalsh"}, "is_accepted": false, "score": 0, "last_activity_date": 1522111396, "creation_date": 1522111396, "answer_id": 49502745, "question_id": 49029182, "link": "https://stackoverflow.com/questions/49029182/vba-export-worksheet-as-pdf-mac-2016-error/49502745#49502745", "title": "VBA export worksheet as PDF (Mac 2016) error", "body": "<p>The problem comes from Apple's sandboxing rules.  You can no longer save or open directly from VBA to any folder that you want.  You may only write to a folder that Excel has rights to.  This probably includes exporting a PDF, although I have not tested.</p>\n\n<p>Here is an excellent page by Ron de Bruin detailing how to deal with Apple's sandboxing issues in VBA.</p>\n\n<p><a href=\"https://www.rondebruin.nl/mac/mac034.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/mac/mac034.htm</a></p>\n"}], "owner": {"reputation": 11, "user_id": 9423574, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0XRmUv6HTmE/AAAAAAAAAAI/AAAAAAAAASg/8ZvlMjvQvHk/photo.jpg?sz=128", "display_name": "Vallier Adam", "link": "https://stackoverflow.com/users/9423574/vallier-adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1746, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593644932, "creation_date": 1519819505, "last_edit_date": 1593644932, "question_id": 49029182, "link": "https://stackoverflow.com/questions/49029182/vba-export-worksheet-as-pdf-mac-2016-error", "title": "VBA export worksheet as PDF (Mac 2016) error", "body": "<p>I am struggling to export my worksheet as PDF.</p>\n\n<p>Here is my code, FYI I am using Office 2016 for MAC</p>\n\n<pre><code>Sub saveactiveworkbook()\n\nDim FileName As String\nDim FolderName As String\nDim Folderstring As String\nDim FilePathName As String\n\n\nActiveSheet.PageSetup.Orientation = xlLandscape\n\n\n\nFolderName = \"TestVBA\"\nFileName = \"DV\" &amp; \".pdf\"\n\n  Folderstring = \"/Users/Vallier/Documents/Test/TestVBA\"\n  FilePathName = Folderstring &amp; Application.PathSeparator &amp; FileName\n\n  ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, FileName:= _\n  FilePathName, Quality:=xlQualityStandard, _\n  IncludeDocProperties:=True, IgnorePrintAreas:=False\n\nMsgBox FilePathName\n\nEnd Sub\n</code></pre>\n\n<p>When I launch the program I have a warning box that says: \n\"Run-time Error '1004':</p>\n\n<p>Application-Defined or object-defined error\"</p>\n\n<p>I try to remedy to this by defining active sheet by \"ws\" upfront but I then have another error saying:</p>\n\n<blockquote>\n  <p>\"ExportAsFormat of object_ worksheet failed\"</p>\n</blockquote>\n\n<p>Any ideas? </p>\n\n<p>Many Thanks,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1519819454, "post_id": 49029129, "comment_id": 85062425, "body": "InStr() returns the first position which wont help you here, instead use InStrRev() which returns the last position, then mid() to read from that point"}, {"owner": {"reputation": 33, "user_id": 4677708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffdbe43c4c590c570cf5cd942d87d940?s=128&d=identicon&r=PG&f=1", "display_name": "Job", "link": "https://stackoverflow.com/users/4677708/job"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1519819904, "post_id": 49029129, "comment_id": 85062701, "body": "@AlexK. Thankyou! This only returns &quot;t_file_name.csv&quot; and not the entire file name."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1519819975, "post_id": 49029129, "comment_id": 85062737, "body": "Or, you can test if the file exists at the same time with <code>strFile = Dir(strLocation)</code>"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1519820069, "post_id": 49029129, "comment_id": 85062802, "body": "<code>file = mid$(strLocation, InStrRev(strLocation, &quot;\\&quot;) + 1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4677708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffdbe43c4c590c570cf5cd942d87d940?s=128&d=identicon&r=PG&f=1", "display_name": "Job", "link": "https://stackoverflow.com/users/4677708/job"}, "edited": false, "score": 0, "creation_date": 1519820399, "post_id": 49029231, "comment_id": 85063005, "body": "Option 1) cuts the name short but options 2) &amp; 3) work perfectly! Thankyou!!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 33, "user_id": 4677708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffdbe43c4c590c570cf5cd942d87d940?s=128&d=identicon&r=PG&f=1", "display_name": "Job", "link": "https://stackoverflow.com/users/4677708/job"}, "edited": false, "score": 0, "creation_date": 1519821081, "post_id": 49029231, "comment_id": 85063478, "body": "You are welcome. But can&#39;t understand the issue with option 1"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1519819673, "creation_date": 1519819673, "answer_id": 49029231, "question_id": 49029129, "link": "https://stackoverflow.com/questions/49029129/vba-cutting-a-web-location-address/49029231#49029231", "title": "VBA cutting a Web/Location Address", "body": "<p>some ways</p>\n\n<p>1)</p>\n\n<pre><code>Dim strLocation As String\nDim strFile As String\n\nstrLocation = \"TEST\\test\\TEST\\test_file_name.csv\"    \nstrFile = Right$(strLocation, Len(strLocation) - InStrRev(strLocation, \"\\\"))\n</code></pre>\n\n<p>2)</p>\n\n<pre><code>Dim strLocation As String\nDim strFile As String  \n\nstrLocation = \"TEST\\test\\TEST\\test_file_name.csv\"\nstrFile = Split(strLocation, \"\\\")(UBound(Split(strLocation, \"\\\")))\n</code></pre>\n\n<p>3)</p>\n\n<pre><code>Dim strLocation As String\nDim strFile As String\n\nstrLocation = \"TEST\\test\\TEST\\test_file_name.csv\"\nWith CreateObject(\"Scripting.FileSystemObject\")\n    strFile = .GetFileName(strLocation)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4677708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffdbe43c4c590c570cf5cd942d87d940?s=128&d=identicon&r=PG&f=1", "display_name": "Job", "link": "https://stackoverflow.com/users/4677708/job"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 49029231, "answer_count": 1, "score": 0, "last_activity_date": 1519819673, "creation_date": 1519819321, "last_edit_date": 1531164843, "question_id": 49029129, "link": "https://stackoverflow.com/questions/49029129/vba-cutting-a-web-location-address", "title": "VBA cutting a Web/Location Address", "body": "<p>I am having abit of trouble with some VBA code for cutting a file location.</p>\n\n<pre><code>Option Explicit\nPrivate Sub TESTING()\n\n Dim strLocation as string\n Dim strFile as string\n\n strLocation = \"TEST\\test\\TEST\\test_file_name.csv\"\n\n strFile = Right$(strLocation, InStr(strLocation, \"\\\") - 1)\n MsgBox strFile\n\nEnd Sub\n</code></pre>\n\n<p>I wish to implement code so that \"test_file_name.csv\" is returned as my strFile. The file names will vary hence I am attemping to cut from the right to the first backslash. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1462, "user_id": 4623533, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/18ca3490d43119d6713e08b71fad0f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Syntax Error", "link": "https://stackoverflow.com/users/4623533/syntax-error"}, "edited": false, "score": 0, "creation_date": 1519822057, "post_id": 49029543, "comment_id": 85064082, "body": "I already tried <code>Address</code> but it&#39;s bringing back results like this: <code>&#47;o=domain&#47;ou=First Administrative Group&#47;cn=Recipients&#47;cn=name</code> rather than email addresses"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 1462, "user_id": 4623533, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/18ca3490d43119d6713e08b71fad0f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Syntax Error", "link": "https://stackoverflow.com/users/4623533/syntax-error"}, "edited": false, "score": 0, "creation_date": 1519823070, "post_id": 49029543, "comment_id": 85064795, "body": "@MrJF Since that is just bringing back the Exchange User rather than the full domain path, you can use <code>.GetExchangeUser</code>.  Sometimes you get something like &quot;smtp:forename.surname@domain.com&quot; from <code>.Address</code> instead, depending on how it&#39;s set up.  Answer updated"}, {"owner": {"reputation": 1462, "user_id": 4623533, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/18ca3490d43119d6713e08b71fad0f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Syntax Error", "link": "https://stackoverflow.com/users/4623533/syntax-error"}, "edited": false, "score": 0, "creation_date": 1519827424, "post_id": 49029543, "comment_id": 85067780, "body": "Sorry - that hasnt worked either. When i used <code>.GetExchangeUser</code> it stopped the code from running again like when I had the smtp address thing earlier."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1519822841, "last_edit_date": 1519822841, "creation_date": 1519820678, "answer_id": 49029543, "question_id": 49028555, "link": "https://stackoverflow.com/questions/49028555/get-email-address-from-outlook-gal/49029543#49029543", "title": "Get email address from Outlook GAL?", "body": "<p>Looking at the <a href=\"https://msdn.microsoft.com/en-us/VBA/outlook-vba/articles/addressentry-object-outlook\" rel=\"nofollow noreferrer\">AddressEntry Object (Outlook)</a> page on MSDN, the property you want is <code>AddressEntry.Address</code></p>\n\n<pre><code>Sheets(\"Emails\").Cells(intCounter, 2) = objAddressEntry.Address\n</code></pre>\n\n<p>Also, if you early-bind Outlook from the <strong>Tools</strong> > <strong>References...*</strong> then you will get Intellisense.  Or, you can hit [Alt]+[F11] in Outlook and use the Intellisense there.</p>\n\n<p><strong>{EDIT}</strong> <em>Since this is giving the path on the Exchange Server rather than as a full e-mail address</em>\nIf the Contact is in an Exchange Address List, then you can use <code>.GetExchangeUser.PrimarySmtpAddress</code> to get the Primary Smtp Address for the user on the Exchange Server.  (For local contacts on your account, use the <code>GetContact.Email1Address</code> instead)</p>\n\n<pre><code>Sheets(\"Emails\").Cells(intCounter, 2) = objAddressEntry.GetExchangeuser.PrimarySmtpAddress\n</code></pre>\n"}], "owner": {"reputation": 1462, "user_id": 4623533, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/18ca3490d43119d6713e08b71fad0f0c?s=128&d=identicon&r=PG&f=1", "display_name": "Syntax Error", "link": "https://stackoverflow.com/users/4623533/syntax-error"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2015, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593057391, "creation_date": 1519817475, "last_edit_date": 1593057391, "question_id": 49028555, "link": "https://stackoverflow.com/questions/49028555/get-email-address-from-outlook-gal", "title": "Get email address from Outlook GAL?", "body": "<p>I have the following code to try and grab the GAL from Outlook and drop the person's name + their email address into another sheet. </p>\n\n<p>It gets the first name (but not email address) then stops. If I comment out <code>Sheets(\"Emails\").Cells(intCounter, 2) = objAddressEntry.PrimarySmtpAddress</code>, it lists all the names succesfully, which suggests I might be using the wrong type to get the email address. VBA has no intellisense though so I'm not sure what to use instead!</p>\n\n<pre><code>Private Sub UpdateEmails()\n\n' Need to add reference to Outlook\n' Adds addresses to existing Sheet called Emails and\n' defines name NamesAndEmailAddresses containing this list\n\nOn Error GoTo error\n\nDim objOutlook As Outlook.Application\nDim objAddressList As Outlook.AddressList\nDim objAddressEntry As Outlook.AddressEntry\nDim intCounter As Integer\n\nApplication.ScreenUpdating = False\n\n' Setup connection to Outlook application\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objAddressList = objOutlook.Session.AddressLists(\"Global Address List\")\n\nApplication.EnableEvents = False\n\n' Clear existing list\nSheets(\"Emails\").Range(\"A:A\").Clear\n\n'Step through each contact and list each that has an email address\nFor Each objAddressEntry In objAddressList.AddressEntries\n    If objAddressEntry.Address &lt;&gt; \"\" Then\n        intCounter = intCounter + 1\n        Application.StatusBar = \"Processing no. \" &amp; intCounter &amp; \" ... \" &amp; objAddressEntry.Address\n        Sheets(\"Emails\").Cells(intCounter, 1) = objAddressEntry.Name\n        Sheets(\"Emails\").Cells(intCounter, 2) = objAddressEntry.PrimarySmtpAddress\n        DoEvents\n    End If\nNext objAddressEntry\n\n' Define range called \"NamesAndEmailAddresses\" to the list of emails\nSheets(\"Emails\").Cells(1, 2).Resize(intCounter, 1).Name = \"NamesAndEmailAddresses\"\nerror:\nSet objOutlook = Nothing\nApplication.StatusBar = False\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "sockets", "networking", "tcp", "winsock"], "comments": [{"owner": {"reputation": 402, "user_id": 2876648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1eafa258fdef4807837d95a28f6b5a?s=128&d=identicon&r=PG&f=1", "display_name": "ManuelJE", "link": "https://stackoverflow.com/users/2876648/manuelje"}, "edited": false, "score": 1, "creation_date": 1604572013, "post_id": 49028281, "comment_id": 114389438, "body": "Thanks for sharing this! I found your code very useful (with the fixes in the answer). Exactly what I was looking for.  Have you published a final version of this code elsewhere?"}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "reply_to_user": {"reputation": 402, "user_id": 2876648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1eafa258fdef4807837d95a28f6b5a?s=128&d=identicon&r=PG&f=1", "display_name": "ManuelJE", "link": "https://stackoverflow.com/users/2876648/manuelje"}, "edited": false, "score": 0, "creation_date": 1604679347, "post_id": 49028281, "comment_id": 114429434, "body": "@ManuelJE Hi, no. I used this case for early-stage testing/benchmarking of different IPC approaches, but eventually went down the route of c++ addin for my purpose. So that should indeed be more or less the most recent code I had!"}], "answers": [{"comments": [{"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "edited": false, "score": 0, "creation_date": 1519819152, "post_id": 49028850, "comment_id": 85062261, "body": "Wow, I can&#39;t thank you enough!! I was going crazy on this one - THANK YOU."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1519818461, "creation_date": 1519818461, "answer_id": 49028850, "question_id": 49028281, "link": "https://stackoverflow.com/questions/49028281/vba-with-winsock2-send-sends-wrong-data/49028850#49028850", "title": "VBA with WinSock2: send() sends wrong data", "body": "<p>You need to pass the address of the data within the array - i.e. the address of the first element (because the address of the variable itself is the address of the enclosing SAFEARRAY)</p>\n\n<ul>\n<li><p>Change the <code>send</code> argument to <code>ByRef buf As Any</code></p></li>\n<li><p>Pass in the address of the first array element:</p>\n\n<p><code>RetVal = Send(m_ConnSocket, SendBuf(0), buflen, 0)</code></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 3984, "user_id": 541591, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74eceb067d98fe7fe1b047a70e06cc7b?s=128&d=identicon&r=PG", "display_name": "James Wong", "link": "https://stackoverflow.com/users/541591/james-wong"}, "edited": false, "score": 0, "creation_date": 1573097615, "post_id": 58740907, "comment_id": 103772738, "body": "Welcome to SO, can you explain or give some comment how your proposed solution is supposed to help?"}], "tags": [], "owner": {"reputation": 1, "user_id": 12335219, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a7b6d91dd026ef8818183b6714c9d2db?s=128&d=identicon&r=PG", "display_name": "fireheadchaos", "link": "https://stackoverflow.com/users/12335219/fireheadchaos"}, "is_accepted": false, "score": 0, "last_activity_date": 1573119569, "last_edit_date": 1573119569, "creation_date": 1573091989, "answer_id": 58740907, "question_id": 49028281, "link": "https://stackoverflow.com/questions/49028281/vba-with-winsock2-send-sends-wrong-data/58740907#58740907", "title": "VBA with WinSock2: send() sends wrong data", "body": "<pre class=\"lang-vb prettyprint-override\"><code> Dim arrBuffers(1 To MAX_BUFFER_LENGTH)   As Byte\n Dim lngBytesReceived                    As Long\n Dim strTempBuffer                       As String\n\nlngBytesReceived = recv(s1, arrBuffers(1), MAX_BUFFER_LENGTH, 0&amp;)\n\nIf lngBytesReceived &gt; 0 Then\n     '\n     ' If we have received some data, convert it to the Unicode\n     ' string that is suitable for the Visual Basic String data type\n     '\n     strTempBuffer = StrConv(arrBuffers, vbUnicode)\n\n     '\n     ' Remove unused bytes\n     '\n     strBuffer = Left$(strTempBuffer, lngBytesReceived)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1029, "user_id": 12063370, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Br6hpbePu-g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdI1Wreh0-N0-45kKfVPhaQygUL0A/photo.jpg?sz=128", "display_name": "Marina Aguilar", "link": "https://stackoverflow.com/users/12063370/marina-aguilar"}, "edited": false, "score": 0, "creation_date": 1573094098, "post_id": 58740955, "comment_id": 103772065, "body": "Hi! Welcome to Stack Overflow. You can improve your answer a bit by editing it and explaining your code."}], "tags": [], "owner": {"reputation": 1, "user_id": 12335219, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a7b6d91dd026ef8818183b6714c9d2db?s=128&d=identicon&r=PG", "display_name": "fireheadchaos", "link": "https://stackoverflow.com/users/12335219/fireheadchaos"}, "is_accepted": false, "score": 0, "last_activity_date": 1573092329, "creation_date": 1573092329, "answer_id": 58740955, "question_id": 49028281, "link": "https://stackoverflow.com/questions/49028281/vba-with-winsock2-send-sends-wrong-data/58740955#58740955", "title": "VBA with WinSock2: send() sends wrong data", "body": "<pre><code> Const MAX_BUFFER_LENGTH As Long = 8192\n Dim arrBuffers(1 To MAX_BUFFER_LENGTH)   As Byte\n Dim lngBytesReceived                    As Long\n Dim strTempBuffer                       As String\n\n lngBytesReceived = recv(s1, arrBuffers(1), MAX_BUFFER_LENGTH, 0&amp;)\n strTempBuffer = StrConv(arrBuffers, vbUnicode)         \n strBuffer = Left$(strTempBuffer, lngBytesReceived)\n</code></pre>\n"}], "owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2756, "favorite_count": 1, "accepted_answer_id": 49028850, "answer_count": 3, "score": 2, "last_activity_date": 1573119569, "creation_date": 1519816577, "question_id": 49028281, "link": "https://stackoverflow.com/questions/49028281/vba-with-winsock2-send-sends-wrong-data", "title": "VBA with WinSock2: send() sends wrong data", "body": "<p>I'm trying to use WinSock2 in VBA to send (and later on, receive) data from a localhost TCP Stream.</p>\n\n<p>For now, I've mostly been trying to replicate the client sample from here,<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms738630(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms738630(v=vs.85).aspx</a></p>\n\n<p>My code \"almost\" works; I can create a socket &amp; establish a connection to my server.\nSending data (e.g. invoking the send() function of ws2_32.dll) is odd, though..</p>\n\n<p>In the example below, the server would indeed receive a byte array of length 10, but its contents are odd. The first 4 bytes of the array are set (but vary with each call), the last 6 bytes are always 0.</p>\n\n<p>I'm not really sure what's going on; given I run this in 32bit Excel = pointers would be 4 bytes long, it almost seems a bit like only the address of some variable is being sent.</p>\n\n<p>When I try to call this function passing an explicit address of the data (the SendWithPtr() call that is commented out), same issue occurs, so that doesn't help either.</p>\n\n<p>Does anyone know what's going on there? Do I need to call the send() function different in any way?!</p>\n\n<p>Thanks</p>\n\n<hr>\n\n<p>VBA Code:</p>\n\n<pre><code>Option Explicit\n\n' Constants ----------------------------------------------------------\nConst INVALID_SOCKET = -1\nConst WSADESCRIPTION_LEN = 256\nConst SOCKET_ERROR = -1\n\n' Typ definitions ----------------------------------------------------\n\nPrivate Type WSADATA\nwVersion As Integer\nwHighVersion As Integer\nszDescription(0 To WSADESCRIPTION_LEN) As Byte\nszSystemStatus(0 To WSADESCRIPTION_LEN) As Byte\niMaxSockets As Integer\niMaxUdpDg As Integer\nlpVendorInfo As Long\nEnd Type\n\nPrivate Type ADDRINFO\n    ai_flags As Long\n    ai_family As Long\n    ai_socktype As Long\n    ai_protocol As Long\n    ai_addrlen As Long\n    ai_canonName As LongPtr 'strptr\n    ai_addr As LongPtr 'p sockaddr\n    ai_next As LongPtr 'p addrinfo\nEnd Type\n\n\n' Enums ---------------------------------------------------------------\n\nEnum AF\nAF_UNSPEC = 0\nAF_INET = 2\nAF_IPX = 6\nAF_APPLETALK = 16\nAF_NETBIOS = 17\nAF_INET6 = 23\nAF_IRDA = 26\nAF_BTH = 32\nEnd Enum\n\nEnum sock_type\nSOCK_STREAM = 1\nSOCK_DGRAM = 2\nSOCK_RAW = 3\nSOCK_RDM = 4\nSOCK_SEQPACKET = 5\nEnd Enum\n\n' External functions --------------------------------------------------\n\nPublic Declare Function WSAStartup Lib \"ws2_32.dll\" (ByVal wVersionRequested As Integer, ByRef data As WSADATA) As Long\nPublic Declare Function connect Lib \"ws2_32.dll\" (ByVal socket As Long, ByVal SOCKADDR As Long, ByVal namelen As Long) As Long\nPublic Declare Sub WSACleanup Lib \"ws2_32.dll\" ()\nPrivate Declare PtrSafe Function GetAddrInfo Lib \"ws2_32.dll\" Alias \"getaddrinfo\" (ByVal NodeName As String, ByVal ServName As String, ByVal lpHints As LongPtr, lpResult As LongPtr) As Long\nPublic Declare Function ws_socket Lib \"ws2_32.dll\" Alias \"socket\" (ByVal AF As Long, ByVal stype As Long, ByVal Protocol As Long) As Long\nPublic Declare Function closesocket Lib \"ws2_32.dll\" (ByVal socket As Long) As Long\nPrivate Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (Destination As Any, Source As Any, ByVal length As Long)\nPublic Declare Function Send Lib \"ws2_32.dll\" Alias \"send\" (ByVal s As Long, ByRef buf() As Byte, ByVal buflen As Long, ByVal flags As Long) As Long\nPublic Declare Function SendWithPtr Lib \"ws2_32.dll\" Alias \"send\" (ByVal s As Long, ByVal bufPtr As Long, ByVal buflen As Long, ByVal flags As Long) As Long\nPrivate Declare PtrSafe Function WSAGetLastError Lib \"ws2_32.dll\" () As Long\nPrivate Declare Function VarPtrArray Lib \"VBE7\" Alias \"VarPtr\" (var() As Any) As Long\n\nSub TestWinsock()\n    Dim m_wsaData As WSADATA\n    Dim m_RetVal As Integer\n    Dim m_Hints As ADDRINFO\n    Dim m_ConnSocket As Long: m_ConnSocket = INVALID_SOCKET\n    Dim Server As String\n    Dim port As String\n    Dim pAddrInfo As LongPtr\n    Dim RetVal As Long\n    Dim lastError As Long\n\n    RetVal = WSAStartup(MAKEWORD(2, 2), m_wsaData)\n    If (RetVal &lt;&gt; 0) Then\n        LogError \"WSAStartup failed with error \" &amp; RetVal, WSAGetLastError()\n        Call WSACleanup\n        Exit Sub\n    End If\n\n    m_Hints.ai_family = AF.AF_UNSPEC\n    m_Hints.ai_socktype = sock_type.SOCK_STREAM\n    Server = \"localhost\"\n    port = \"5001\"\n\n    RetVal = GetAddrInfo(Server, port, VarPtr(m_Hints), pAddrInfo)\n    If (RetVal &lt;&gt; 0) Then\n        LogError \"Cannot resolve address \" &amp; Server &amp; \" and port \" &amp; port &amp; \", error \" &amp; RetVal, WSAGetLastError()\n        Call WSACleanup\n        Exit Sub\n    End If\n\n    m_Hints.ai_next = pAddrInfo\n    Dim connected As Boolean: connected = False\n    Do While m_Hints.ai_next &gt; 0\n        CopyMemory m_Hints, ByVal m_Hints.ai_next, LenB(m_Hints)\n\n        m_ConnSocket = ws_socket(m_Hints.ai_family, m_Hints.ai_socktype, m_Hints.ai_protocol)\n\n        If (m_ConnSocket = INVALID_SOCKET) Then\n            LogError \"Error opening socket, error \" &amp; RetVal\n        Else\n            Dim connectionResult As Long\n\n            connectionResult = connect(m_ConnSocket, m_Hints.ai_addr, m_Hints.ai_addrlen)\n\n            If connectionResult &lt;&gt; SOCKET_ERROR Then\n                connected = True\n                Exit Do\n            End If\n\n            LogError \"connect() to socket failed\"\n            closesocket (m_ConnSocket)\n        End If\n    Loop\n\n    If Not connected Then\n        LogError \"Fatal error: unable to connect to the server\", WSAGetLastError()\n        Call WSACleanup\n        Exit Sub\n    End If\n\n    Dim SendBuf() As Byte\n    SendBuf = StrConv(\"Message #1\", vbFromUnicode)\n\n    Dim buflen As Integer\n    buflen = UBound(SendBuf) - LBound(SendBuf) + 1\n\n    ' !!!!!!!!!!!\n    ' !! Send() does not seem to send the right bytes !!\n    ' !!!!!!!!!!!\n    RetVal = Send(m_ConnSocket, SendBuf, buflen, 0)\n\n    ' The following does not work either:\n    ' RetVal = SendWithPtr(m_ConnSocket, VarPtrArray(SendBuf), buflen, 0)\n    If RetVal = SOCKET_ERROR Then\n        LogError \"send() failed\", WSAGetLastError()\n        Call WSACleanup\n        Exit Sub\n    Else\n        Debug.Print \"sent \" &amp; RetVal &amp; \" bytes\"\n    End If\n\n    RetVal = closesocket(m_ConnSocket)\n    If RetVal &lt;&gt; 0 Then\n    LogError \"closesocket() failed\", WSAGetLastError()\n    Call WSACleanup\n    Else\n        Debug.Print \"closed socket\"\n    End If\nEnd Sub\n\nPublic Function MAKEWORD(Lo As Byte, Hi As Byte) As Integer\nMAKEWORD = Lo + Hi * 256&amp; Or 32768 * (Hi &gt; 127)\nEnd Function\n\nPrivate Sub LogError(msg As String, Optional ErrorCode As Long = -1)\n    If ErrorCode &gt; -1 Then\n        msg = msg &amp; \" (error code \" &amp; ErrorCode &amp; \")\"\n    End If\n\n    Debug.Print msg\nEnd Sub\n</code></pre>\n\n<p>Server code, just for reference:</p>\n\n<pre><code>using System;\nusing System.Net;\nusing System.Net.Sockets;\nusing System.Text;\nusing System.Threading;\n\nnamespace Server\n{\nclass Program\n{\n    static void Main(string[] args)\n    {\n        var address = Dns.GetHostEntry(\"localhost\").AddressList[0];\n        var addressBytes = address.GetAddressBytes();\n        var port = 5001;\n        var ipEndpoint = new IPEndPoint(address, port);\n\n        var listener = new TcpListener(ipEndpoint);\n        listener.Start();\n\n        bool done = false;\n\n        TcpClient tcpClient = null;\n\n        try\n        {\n            while (!done)\n            {\n                Thread.Sleep(10);\n                Console.WriteLine(\"Waiting for broadcast\");\n\n                tcpClient = listener.AcceptTcpClient();\n\n                byte[] bytes = new byte[10];\n                NetworkStream stream = tcpClient.GetStream();\n\n                var bytesRead = stream.Read(bytes, 0, bytes.Length);\n                // when called via the VBA sample, \"bytes\" will contain odd values.\n                // when called through Microsoft's C++ sample, everything works fine\n            }\n        }\n    finally {\n            tcpClient?.Close();\n        }\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1519825590, "post_id": 49028178, "comment_id": 85066528, "body": "You should do a Loop to print ALL &quot;a&quot; tags. you can print a list of them using <code>a.href</code>. Then try to be more precise to check what of those refs you want and then you can open each one of them"}, {"owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519826447, "post_id": 49028178, "comment_id": 85067109, "body": "can you please clarify a bit more. I am not actually professional on this but would highly appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519831516, "post_id": 49032533, "comment_id": 85070662, "body": "Thank you for your time.  what I did initially, actually changed my second part of the code and pasted yours but id doesn&#39;t work. It returns empty table."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519832286, "post_id": 49032533, "comment_id": 85071137, "body": "Debug line by line. I tested it  combined with your <code>Sub GetData()</code> and it worked perfectly. It does loops 9 times and get all data"}, {"owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519832823, "post_id": 49032533, "comment_id": 85071519, "body": "yes, you are right it loops 9 times but the result is as in the picture :( <a href=\"http://imagizer.imageshack.us/a/img924/5554/C4yhEZ.png\" rel=\"nofollow noreferrer\">imagizer.imageshack.us/a/img924/5554/C4yhEZ.png</a>                              I just combined mine and yours, maybe I do mistake in somewhere .."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519833141, "post_id": 49032533, "comment_id": 85071761, "body": "How is now your full code? Edit your question and Add the new one. Don&#39;t remove the old one from question"}, {"owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519833895, "post_id": 49032533, "comment_id": 85072279, "body": "Edited the first post , now you can see the full code view either old one and new one."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519834290, "post_id": 49032533, "comment_id": 85072531, "body": "mmm. I copied the code and pasted it into a new Excel and it worked perfectly for me. Check image <a href=\"https://i.stack.imgur.com/rWCiE.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/rWCiE.jpg</a> . Make sure you got references to <b>Microsoft HTML Object Library</b> and <b>Microsoft Internet Controls</b>."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519834533, "post_id": 49032533, "comment_id": 85072654, "body": "Updated my answer with a screenshot of the references you need to activate"}, {"owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519836219, "post_id": 49032533, "comment_id": 85073776, "body": "Found the issue , deleted the www from the beggining of the url and it worked now. the case is that It does not return me for required table :) I need to retrieve the table for each link in the first column in your screenshot."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519836434, "post_id": 49032533, "comment_id": 85073923, "body": "But you got the link. Is jut doing the same sub you have but with every link. Besides, I cannot access those links because it asks for User and Password,"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519837426, "post_id": 49032533, "comment_id": 85074606, "body": "What you are asking is almost a full develop of code. You are now in the right path! :) . I suggest you to make secondary subs like <code>Sub GetData()</code>and <code>Sub GetAllTables(doc As Object)</code> adapted to get those tables for each link and combine them with your code. You got the links, you know how to get tables, just design how do you want to combine those tables with your data and you&#39;ll have it."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519837486, "post_id": 49032533, "comment_id": 85074650, "body": "@OrkhanOrkhan Besides, I suggest you to not share your username and password here in a comment, somebody can make bad use of it."}, {"owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519837524, "post_id": 49032533, "comment_id": 85074672, "body": "you are right :) I just tried already to do that but the case is that I am having some difficulties with that links because of the logging in processes. The web page requires login action in order to show us the data. that is the most difficult part for me .."}, {"owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519837571, "post_id": 49032533, "comment_id": 85074702, "body": "Thank you I deleted the credential information , thank you for warning :)"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "edited": false, "score": 0, "creation_date": 1519847780, "post_id": 49032533, "comment_id": 85080098, "body": "For login part, you can find several examples here in stack overflow: <a href=\"https://stackoverflow.com/questions/32364185/excel-vba-login-to-ie-site\" title=\"excel vba login to ie site\">stackoverflow.com/questions/32364185/excel-vba-login-to-ie-s&zwnj;&#8203;ite</a> or <a href=\"https://stackoverflow.com/questions/38334028/using-vba-to-log-in-to-a-website-and-clear-previous-login-credentials\" title=\"using vba to log in to a website and clear previous login credentials\">stackoverflow.com/questions/38334028/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/32364185/excel-vba-login-to-ie-site\" title=\"excel vba login to ie site\">stackoverflow.com/questions/32364185/excel-vba-login-to-ie-s&zwnj;&#8203;ite</a> or <a href=\"https://stackoverflow.com/questions/20470634/web-login-using-vba\">stackoverflow.com/questions/20470634/web-login-using-vba</a>. If you have problems, then design some code and ask a new question here in SO. About this question, if it&#39;s already answered, then please mark the answer as right, so the question will be closed."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1519834508, "last_edit_date": 1519834508, "creation_date": 1519830005, "answer_id": 49032533, "question_id": 49028178, "link": "https://stackoverflow.com/questions/49028178/greyhound-data-import-to-excel-macro-formula/49032533#49032533", "title": "Greyhound data import to excel macro formula", "body": "<p>This code, after you get all your data, will check every race from end of list to start of list. And it will add in column A the related link to race.</p>\n\n<pre><code>Sub GetAllTables(doc As Object)\n\nDim ws As Worksheet\nDim rng As Range\nDim tbl As Object\nDim rw As Object\nDim cl As Object\nDim tabno As Long\nDim nextrow As Long\nDim I As Long\nDim ThisLink As Object 'variable for &lt;a&gt; tags\nSet ws = Worksheets.Add\n\nFor Each tbl In doc.getElementsByTagName(\"TABLE\")\n    tabno = tabno + 1\n    nextrow = nextrow + 1\n    Set rng = ws.Range(\"B\" &amp; nextrow)\n\n    rng.Offset(, -1) = \"Table \" &amp; tabno\n    For Each rw In tbl.Rows\n        For Each cl In rw.Cells\n            rng.Value = cl.outerText\n            Set rng = rng.Offset(, 1)\n            I = I + 1\n        Next cl\n    nextrow = nextrow + 1\n    Set rng = rng.Offset(1, -I)\n    I = 0\n    Next rw\nNext tbl\n\nI = Range(\"B\" &amp; Rows.Count).End(xlUp).Row 'last row with data\n\nDo While Cells(I, 1).Value = \"\" 'will loop until first not blank found in column A (starting from last row of data, from end to start)\n    For Each ThisLink In doc.getElementsByTagName(\"a\") 'we check all &lt;a&gt; tags\n        If ThisLink.innerText = Cells(I, 2).Value Then Cells(I, 1).Value = ThisLink.href 'If the innertext is the name of the race, in column A we add link\n    Next ThisLink\n    I = I - 1 'we decrease row position\nLoop\nEnd Sub\n</code></pre>\n\n<p>In HTML all <code>&lt;a&gt;</code> tags are like this:</p>\n\n<blockquote>\n<pre><code>&lt;a href=\"d?r=4269456&amp;z=F0K9jn\"&gt;Henlow 26 Feb 2018 HT 5&lt;/a&gt;\n</code></pre>\n</blockquote>\n\n<p>The <strong>href</strong> attribute contains the link related to text between <code>&lt;a&gt;</code> and <code>&lt;/a&gt;</code>. You can get it with <code>a.href</code> in VBA</p>\n\n<p>To know the text between <code>&lt;a&gt;</code> and <code>&lt;/a&gt;</code> you can use <code>a.InnerText</code></p>\n\n<p>What i did is just a simple loop to check every <code>&lt;a&gt;</code> tag. If the InnerText matchs the value in the cell, then I get the <code>href</code> attribute.</p>\n\n<p>This code will get you all the links you want in your question. Just adapt the code to your needs (I pasted them in column A, but maybe you want to do something else with them).</p>\n\n<p>You need 2 references for this code to work; </p>\n\n<ol>\n<li><strong>Microsoft HTML Object Library</strong></li>\n<li><strong>Microsoft Internet Controls</strong></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/1q999.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1q999.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And this is the final result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rWCiE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rWCiE.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 73, "user_id": 6057012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/46b963ea69a7d0d40f4c89fd4d1f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Orkhan", "link": "https://stackoverflow.com/users/6057012/orkhan-orkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 49032533, "answer_count": 1, "score": 1, "last_activity_date": 1519834508, "creation_date": 1519816220, "last_edit_date": 1519833572, "question_id": 49028178, "link": "https://stackoverflow.com/questions/49028178/greyhound-data-import-to-excel-macro-formula", "title": "Greyhound data import to excel macro formula", "body": "<p>as part of a research project i need to extract as much data as possible from a webpage. The problem is to access each table i have to follow lots of links which I can't get to work automatically. </p>\n\n<p>Its from a greyhound-data.com. So an example would be I want to extract all the racing stats for every dog that raced in swindon between 1st Jan 2017- 28th Feb 2018. When i put it in the search engine I get 57236 races in a table. I have to follow the link on name of race for each race..</p>\n\n<p><a href=\"http://www.greyhound-data.com/d?racename=&amp;country=13000&amp;startmonth=3&amp;endmonth=2&amp;startdate=2017&amp;enddate=2018&amp;maxdist=unlimitied&amp;class=any&amp;order=dateD&amp;x=2\" rel=\"nofollow noreferrer\">http://www.greyhound-data.com/d?racename=&amp;country=13000&amp;startmonth=3&amp;endmonth=2&amp;startdate=2017&amp;enddate=2018&amp;maxdist=unlimitied&amp;class=any&amp;order=dateD&amp;x=2</a></p>\n\n<p>My biggest problem is I don't know how to say follow the various links. And I don't know how to loop multiple times - once for each of the races in the original list.</p>\n\n<p>I have created the simple Macro query : </p>\n\n<pre><code>Sub GetData()\n\nDim IE As Object\nDim doc As Object\nDim strURL As String\nDim I As Integer\n\nFor I = 1 To 9\nstrURL = \"http://www.greyhound-data.com/d?racename=&amp;country=13000&amp;startmonth=3&amp;endmonth=2&amp;startdate=2017&amp;enddate=2018&amp;maxdist=unlimitied&amp;class=any&amp;order=dateD&amp;x=\" + Trim(Str(I))\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n\n.navigate strURL\nDo Until .ReadyState = 4: DoEvents: Loop\nDo While .Busy: DoEvents: Loop\nSet doc = IE.Document\nGetAllTables doc\n\n.Quit\n\nEnd With\nNext I\n\nEnd Sub\n\nSub GetAllTables(doc As Object)\n\nDim ws As Worksheet\nDim rng As Range\nDim tbl As Object\nDim rw As Object\nDim cl As Object\nDim tabno As Long\nDim nextrow As Long\nDim I As Long\n\nSet ws = Worksheets.Add\n\nFor Each tbl In doc.getElementsByTagName(\"TABLE\")\ntabno = tabno + 1\nnextrow = nextrow + 1\nSet rng = ws.Range(\"B\" &amp; nextrow)\nrng.Offset(, -1) = \"Table \" &amp; tabno\nFor Each rw In tbl.Rows\nFor Each cl In rw.Cells\nrng.Value = cl.outerText\nSet rng = rng.Offset(, 1)\nI = I + 1\nNext cl\nnextrow = nextrow + 1\nSet rng = rng.Offset(1, -I)\nI = 0\nNext rw\nNext tbl\n\nEnd Sub\n</code></pre>\n\n<p>it retrieves the all races data from the url automatically. But can not make the next step. on each page there is a \"name of the race\" tab and I need to get all the data on each page for each row. It is because I need to get the information of 1st place, 2nd place and third place. </p>\n\n<p>Thanks for your time I know its a bit garbled!!</p>\n\n<p>My new code after changes is looking like this: </p>\n\n<pre><code>Sub GetData()\n\nDim IE As Object\nDim doc As Object\nDim strURL As String\nDim I As Integer\n\nFor I = 1 To 9\nstrURL = \"http://www.greyhound-data.com/d?racename=&amp;country=13000&amp;startmonth=3&amp;endmonth=2&amp;startdate=2017&amp;enddate=2018&amp;maxdist=unlimitied&amp;class=any&amp;order=dateD&amp;x=\" + Trim(Str(I))\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nWith IE\n\n.navigate strURL\nDo Until .ReadyState = 4: DoEvents: Loop\nDo While .Busy: DoEvents: Loop\nSet doc = IE.Document\nGetAllTables doc\n\n.Quit\n\nEnd With\nNext I\n\nEnd Sub\n\n\nSub GetAllTables(doc As Object)\n\nDim ws As Worksheet\nDim rng As Range\nDim tbl As Object\nDim rw As Object\nDim cl As Object\nDim tabno As Long\nDim nextrow As Long\nDim I As Long\nDim ThisLink As Object 'variable for &lt;a&gt; tags\nSet ws = Worksheets.Add\n\nFor Each tbl In doc.getElementsByTagName(\"TABLE\")\n    tabno = tabno + 1\n    nextrow = nextrow + 1\n    Set rng = ws.Range(\"B\" &amp; nextrow)\n\n    rng.Offset(, -1) = \"Table \" &amp; tabno\n    For Each rw In tbl.Rows\n        For Each cl In rw.Cells\n            rng.Value = cl.outerText\n            Set rng = rng.Offset(, 1)\n            I = I + 1\n        Next cl\n    nextrow = nextrow + 1\n    Set rng = rng.Offset(1, -I)\n    I = 0\n    Next rw\nNext tbl\n\nI = Range(\"B\" &amp; Rows.Count).End(xlUp).Row 'last row with data\n\nDo While Cells(I, 1).Value = \"\" 'will loop until first not blank found in column A (starting from last row of data, from end to start)\n    For Each ThisLink In doc.getElementsByTagName(\"a\") 'we check all &lt;a&gt; tags\n        If ThisLink.innerText = Cells(I, 2).Value Then Cells(I, 1).Value = ThisLink.href 'If the innertext is the name of the race, in column A we add link\n    Next ThisLink\n    I = I - 1 'we decrease row position\nLoop\nEnd Sub\n</code></pre>\n\n<p>but the case is that it returns the empty table as in this link : <a href=\"https://imageshack.us/i/poC4yhEZp\" rel=\"nofollow noreferrer\">https://imageshack.us/i/poC4yhEZp</a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519817957, "post_id": 49028527, "comment_id": 85061580, "body": "d&#39;oh, you <i>just</i> beat me to it! I&#39;m gonna post mine anyway, it goes the opposite way, pulling from Outlook into Excel, the last x items sent."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519819661, "post_id": 49028527, "comment_id": 85062553, "body": "@ashleedawg Note ScreenToGif  now in production :-)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519819798, "post_id": 49028527, "comment_id": 85062641, "body": "haha, no that&#39;s saved for &quot;click this, then click this...&quot; kind of answers :)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519820098, "post_id": 49028527, "comment_id": 85062819, "body": "so, your sub is triggered by an items being sent, correct?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1519820167, "post_id": 49028527, "comment_id": 85062861, "body": "That is the idea. I didn&#39;t want to capture if the mail didn&#39;t actually go. It was a minimal effort job, but hopefully useful, as OP could have shown more sens de l&#39;effort. You are so polishing a masterpiece aren&#39;t you? :-)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519823975, "post_id": 49028527, "comment_id": 85065390, "body": "OMG I give up on my second half.  Yours is better anyway!  ...I can get the last mail item in a folder with <code>.GetLast</code> but neither <code>.GetPrevious</code> nor <code>.GetNext</code> are giving me the item before that, and <code>.Sort &quot;[SentOn]&quot;</code> doesn&#39;t seem to make a difference whether ascending or descending.  I could loop through the collection... but I&#39;m tired of staring at it, so I won&#39;t!  (The privileged of working for free!)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519824464, "post_id": 49028527, "comment_id": 85065731, "body": "I guess, but conveying the right code at the right time is half the battle. :)    ...besides nobody really &quot;writes&quot; code anymore, do they?  I consider more of &quot;reworking existing solutions&quot;.  Get the ol&#39; <a href=\"https://en.wikipedia.org/wiki/Punched_card#/media/File:IBM_card_storage.NARA.jpg\" rel=\"nofollow noreferrer\">punchcards</a> out, now <b>that&#39;s</b> coding. (except it probably wasn&#39;t called that at the time.)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1519855720, "last_edit_date": 1519855720, "creation_date": 1519817346, "answer_id": 49028527, "question_id": 49027827, "link": "https://stackoverflow.com/questions/49027827/retroactive-link-between-outlook-and-vba/49028527#49028527", "title": "Retroactive link between outlook and vba", "body": "<p>Yes. A simple case is shown below. This is bare bones demonstrating the actions you requested. </p>\n\n<p>Public variable, <code>addressSent</code>, holds the To address. A boolean test on mail sent (by @Rory) tests for the mail item having been sent and calls a function, by @Dwipayan Das, that opens a specified Excel file, and writes the <code>addressSent</code> to cell A1 in sheet1.</p>\n\n<p>You can tinker with this to fit your purposes. E.g. Adapt the function to accept a file name as parameter.....</p>\n\n<p>Taking a note from @ashleedawg's book: remember to include a  xlApp.Quit line so Excel is not left hanging. </p>\n\n<p>I believe your question wanted to go from Outlook to Excel so this is the application that you will have created that needs closing.</p>\n\n<p>So in Outlook goes the following code:</p>\n\n<p>Put this in a standard module:</p>\n\n<pre><code>Option Explicit\nPublic addressSent As String\nDim itmevt As New CMailItemEvents\n\nPublic Sub CreateNewMessage()\n\n    Dim objMsg As MailItem\n\n    Set objMsg = Application.CreateItem(olMailItem)\n\n    Set itmevt.itm = objMsg\n\n    With objMsg\n\n        .Display\n        .To = \"somebody@mail.com\"\n        .Subject = \"Blah\"\n\n        addressSent = .To\n\n        .Send\n\n    End With\n\nEnd Sub\n\nPublic Function openExcel() As Boolean 'Adapted from @Dwipayan Das\n\n    Dim xlApp As Object\n    Dim sourceWB As Object\n    Dim sourceWS As Object\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n    With xlApp\n\n        .Visible = True\n        .EnableEvents = False\n\n    End With\n\n    Dim strFile As String\n\n    strFile = \"C:\\Users\\User\\Desktop\\Delete.xlsb\" 'Put your file path.\n\n    Set sourceWB = xlApp.Workbooks.Open(strFile, , False, , , , , , , True)\n\n    sourceWB.Activate\n\n    sourceWB.Worksheets(1).Range(\"A1\") = addressSent\n\nEnd Function\n</code></pre>\n\n<p>Then in a class module called <code>CMailItemEvents</code>, code from <a href=\"https://www.mrexcel.com/forum/excel-questions/326733-check-see-if-outlook-email-sent-excel-vba.html\" rel=\"nofollow noreferrer\">@Rory</a>, put the following:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents itm As Outlook.MailItem\nPrivate Sub itm_Close(Cancel As Boolean)\n   Dim blnSent As Boolean\n   On Error Resume Next\n   blnSent = itm.Sent\n   If Err.Number = 0 Then\n      Debug.Print \"not sent\"\n   Else\n      openExcel\n   End If\nEnd Sub\n</code></pre>\n\n<p>References:</p>\n\n<ol>\n<li><a href=\"https://www.mrexcel.com/forum/excel-questions/326733-check-see-if-outlook-email-sent-excel-vba.html\" rel=\"nofollow noreferrer\">Check to see if an Outlook Email was sent from Excel VBA</a></li>\n<li><a href=\"https://stackoverflow.com/questions/14985261/how-can-i-use-outlook-to-send-email-to-multiple-recipients-in-excel-vba\">How can I use Outlook to send email to multiple recipients in Excel VBA</a></li>\n<li><a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/4e84f0de-2270-4176-a46f-c6891b45d693/how-to-open-an-excel-file-in-outlook-vba-code?forum=exceldev\" rel=\"nofollow noreferrer\">How to open an excel file in Outlook vba code</a></li>\n<li><a href=\"https://www.slipstick.com/developer/create-a-new-message-using-vba/\" rel=\"nofollow noreferrer\">Create a new Outlook message using VBA</a> </li>\n<li><a href=\"http://www.vbaexpress.com/forum/archive/index.php/t-21349.html\" rel=\"nofollow noreferrer\">Run code after item sent</a></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1520588974, "last_edit_date": 1520588974, "creation_date": 1519822447, "answer_id": 49030096, "question_id": 49027827, "link": "https://stackoverflow.com/questions/49027827/retroactive-link-between-outlook-and-vba/49030096#49030096", "title": "Retroactive link between outlook and vba", "body": "<p>Just a quick 'n dirty function that will run in Excel/Access/Word and returns the email address from the most recent item in the <code>Sent Items</code> folder (no error handling, etc):</p>\n\n<pre><code>Function LastSentEmailAddress() As String\n'Requires reference: \"Microsoft Outlook xx.x Object Library\"\n\n    Dim olApp As Outlook.Application, olMail As Object\n    Set olApp = New Outlook.Application 'create Outlook object\n    Set olMail = olApp.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderSentMail).Items.GetLast\n\n    LastSentEmailAddress = olMail.Recipients(1).PropertyAccessor.GetProperty( _\n            \"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\") 'get email addy\n\n    olApp.Quit 'close Outlook\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong><em>A Note about working with Outlook objects from Excel:</em></strong></p>\n\n<p>When working with applications such as Excel it's important to make sure the application object is properly <code>.Quit</code> / <code>.Close</code>'d when finished with them, (and to <code>Set</code> all objects to <code>Nothing</code>), otherwise there's a risk of inadvertently having multiple instances running, which can lead to memory leaks, which leads to crashes and potential data loss.</p>\n\n<p>To check if there is an existing instance of Outlook, use this function:</p>\n\n<pre><code>Function IsOutlookOpen()\n'returns TRUE if Outlook is running\n\n    Dim olApp As Outlook.Application\n\n    On Error Resume Next\n    Set olApp = GetObject(, \"Outlook.Application\")\n    On Error GoTo 0\n\n    If olApp Is Nothing Then\n        IsOutlookOpen= False\n    Else\n        IsOutlookOpen= True\n    End If\n\nEnd Function\n</code></pre>\n\n<p><sub>(Source: <strong><a href=\"https://www.rondebruin.nl/win/s1/outlook/openclose.htm\" rel=\"nofollow noreferrer\">Rob de Bruin</a></strong>)</sub></p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869214(v=office.14).aspx\" rel=\"nofollow noreferrer\">Items.GetLast Method (Outlook)</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/VBA/Outlook-VBA/articles/items-object-outlook\" rel=\"nofollow noreferrer\">Items Object (Outlook)</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/obtain-the-e-mail-address-of-a-recipient\" rel=\"nofollow noreferrer\">Obtain the E-mail Address of a Recipient</a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/i-get-warnings-about-a-program-accessing-email-address-information-or-sending-email-on-my-behalf-86cc5ece-379e-45e3-b8eb-3fefba09946b?NS=OUTLOOK&amp;Version=16&amp;SysLcid=1033&amp;UiLcid=1033&amp;AppVer=ZOL160&amp;HelpId=olmain11.chm553714171&amp;ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">How to disable warnings about programmatic access to Outlook</a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/dd492012(v=office.12).aspx\" rel=\"nofollow noreferrer\">Chapter 17: Working with Item Bodies</a> (Book Excerpt)</p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/check-or-add-an-object-library-reference\" rel=\"nofollow noreferrer\">Check or Add an Object Library Reference</a></p></li>\n<li><p>Stack Overflow : <a href=\"https://stackoverflow.com/a/41565313/8112776\">VBA to search an Outlook 2010 mail in Sent Items from Excel</a></p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9423306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uME-Z464jqA/AAAAAAAAAAI/AAAAAAAAAJI/ZH3AMwKr_hM/photo.jpg?sz=128", "display_name": "gregaud", "link": "https://stackoverflow.com/users/9423306/gregaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1520588974, "creation_date": 1519815189, "question_id": 49027827, "link": "https://stackoverflow.com/questions/49027827/retroactive-link-between-outlook-and-vba", "title": "Retroactive link between outlook and vba", "body": "<p>I\u2019m currently working on an access Vba program in order to automatically write mails to people. However we chose to still press \u2018Send\u2019 in Outlook manually (in case there are possible issues, so we can control the mail beforehand).</p>\n\n<p>Is there a way to have a link in the other direction, as in, when pressing the Send button in Outlook, getting the email address of the person back in excel? (The goal would be to make a \u2018history\u2019 sheet in order to keep track of which mails were actually sent and to whom)</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1519816025, "post_id": 49027462, "comment_id": 85060445, "body": "Can you explain the overall purpose of this? What are you trying to achieve with that? Why don&#39;t you just copy that file instead of <i>open</i> and <i>save as</i>?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1519826877, "creation_date": 1519826877, "answer_id": 49031470, "question_id": 49027462, "link": "https://stackoverflow.com/questions/49027462/open-other-application-from-vba/49031470#49031470", "title": "Open other application from vba", "body": "<p>You can use GetObject(\"Filename\") to open a file directly in its application. So something like this can open any file that has its extension in the Windows Registry. That will be most file types; certainly the Office applications. Whether you'll be able to use SaveAs will depend on whether those applications support OLE Server (meaning they have a coding interface exposed). Again, all the Office applications do support this.</p>\n\n<p>You'll probably want to put in some error-handling for the case the application for the file extension can't be found in the Registry. And of course in case the file name doesn't exist.</p>\n\n<p>My example is for Excel and Word, only - you should be able to fill in others. My code makes sure the file is visible and available to the user as that makes it easier to trouble-shoot. You can, of course, change that once you have everything working satisfactorily.</p>\n\n<pre><code>Sub OpenFileInUnknownApp()\n    Dim objFile As Object\n    Dim objApp As Object\n    Dim sPath As String, sExt As String\n    Dim sFileName As String\n    Dim sAppName As String\n    Dim snewfilename As String\n\n    sPath = \"C:\\Test\\\"\n    sFileName = sPath &amp; \"Quote.docx\" 'RngNames.xlsx\"\n    snewfilename = sPath &amp; \"NewName\"\n\n    '''Open the file in its application\n    Set objFile = GetObject(sFileName)\n    Set objApp = objFile.Application\n    sAppName = objApp.Name\n\n    Select Case sAppName\n        Case Is = \"Microsoft Excel\"\n            Dim wb As Excel.Workbook\n            sExt = \"xlsx\"\n            objApp.Visible = True\n            Set wb = objFile\n            wb.Activate\n            wb.Windows(1).Visible = True\n            objApp.UserControl = True 'so that it \"lives\" after the code ends\n            objApp.Activate\n            wb.SaveAs \"sNewFileName\" &amp; sExt\n        Case Is = \"Microsoft Word\"\n            Dim doc As word.Document\n            sExt = \"docx\"\n            objApp.Visible = True\n            Set doc = objFile\n            objApp.Activate\n            doc.SaveAs2 \"sNewFileName\" &amp; sExt\n        Case Else\n    End Select\n    Set objFile = Nothing\n    Set objApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3077, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1519826877, "creation_date": 1519814157, "last_edit_date": 1531164843, "question_id": 49027462, "link": "https://stackoverflow.com/questions/49027462/open-other-application-from-vba", "title": "Open other application from vba", "body": "<p>I am working on a macro to open a file(might already be open) and save with new name and then open the new file from vba in excel.</p>\n\n<p>This file can Powerpoint,mathcad,visio, word etc..(can also be template files such as dotx etc..)</p>\n\n<p>So my idea is that:</p>\n\n<ol>\n<li>I first need to figure out if the application is open or not, </li>\n<li>then I somehow need to figure if the file is open or not, </li>\n<li>then save it with the new filename.</li>\n<li>Open the new document </li>\n<li>Go through the document and dumps custom variables into the database, populate custom variables from database(Not shown in code below, seperate module)</li>\n<li><p>Activate the new document so that the user can edit it.</p>\n\n<pre><code>Public Sub saveAsVBADocument(filenameNew As String, fileNameOld As String, applicationType As String)\nDim objectApplication As Object\nDim documentApplication As Object\n\nOn Error Resume Next\nSet objectApplication = GetObject(, applicationType)\nOn Error GoTo 0\n\nIf objectApplication Is Nothing Then\n    Set objectApplication = CreateObject(applicationType)\nEnd If\n\n\nobjectApplication.Visible = True\n\n\nOn Error Resume Next\nSet documentApplication = objectApplication.Workbooks(FileHandling.GetFilenameFromPath(fileNameOld)) 'Excel\nSet documentApplication = objectApplication.Documents(FileHandling.GetFilenameFromPath(fileNameOld)) 'Word\nSet documentApplication = objectApplication.WorkSheets(FileHandling.GetFilenameFromPath(fileNameOld)) 'Mathcad\nSet documentApplication = objectApplication.Presentations(FileHandling.GetFilenameFromPath(fileNameOld)) 'PowerPoint\nSet documentApplication = objectApplication.Projects(FileHandling.GetFilenameFromPath(fileNameOld)) 'MS Project \"Msproject.Application\"\nSet documentApplication = objectApplication.Documents(FileHandling.GetFilenameFromPath(fileNameOld)) 'MS Visio \"Visio.Application\"\n\n\nIf documentApplication Is Nothing Then\n    Set documentApplication = objectApplication.FileOpen(fileNameOld) ' add  read only\nEnd If\n\ndocumentApplication.SaveAs filename:=filenameNew\n\nSet objectApplication = Nothing\nSet documentApplication = Nothing\n\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>What is a possible solution to handle all vba acceptable document types?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1519821256, "post_id": 49028381, "comment_id": 85063582, "body": "Writing a <code>Workbook_Close()</code> Routine, it seems to be preferable to omit the second <code>OnKey</code> parameter completely to revert the key to its normal result - see <a href=\"https://stackoverflow.com/questions/48552588/application-onkey-fails-to-reset-properly\" title=\"application onkey fails to reset properly\">stackoverflow.com/questions/48552588/&hellip;</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1519821422, "post_id": 49028381, "comment_id": 85063692, "body": "@T.M. - true. And if you take a look here - <a href=\"https://github.com/Vitosh/VBA_personal/search?utf8=%E2%9C%93&amp;q=onkey&amp;type=\" rel=\"nofollow noreferrer\">github.com/Vitosh/VBA_personal/&hellip;</a>, you would see how much I have learned between March and June 2017 :D"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1519821335, "last_edit_date": 1519821335, "creation_date": 1519816909, "answer_id": 49028381, "question_id": 49027268, "link": "https://stackoverflow.com/questions/49027268/setting-up-procedures-in-excel-for-hotkey-use/49028381#49028381", "title": "Setting up procedures in Excel for hotkey use", "body": "<ol>\n<li>Put the procedure <code>Sub SaveWorksheetsAsCSV()</code> in a module.</li>\n<li>Write the word <code>Public</code> in front of it <code>Public Sub SaveWorksheetsAsCSV()</code></li>\n<li>Make sure that you write it only <strong>once</strong>.</li>\n</ol>\n\n<p>Then it will work from any worksheet, independently. \nThis is quite ok, let it stay:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.OnKey \"+%s\", \"SaveWorksheetsAsCSV\"\nEnd Sub\n</code></pre>\n\n<p>Depending on the way how you (user users) use Excel, it might be a good idea to write a similar <code>Workbook_Close()</code> procedure:</p>\n\n<pre><code>Private Sub Workbook_Close()\n    Application.OnKey \"+%s\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1519817689, "creation_date": 1519817689, "answer_id": 49028628, "question_id": 49027268, "link": "https://stackoverflow.com/questions/49027268/setting-up-procedures-in-excel-for-hotkey-use/49028628#49028628", "title": "Setting up procedures in Excel for hotkey use", "body": "<p>Set the <code>Application.MacroOptions</code><br>\n<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-macrooptions-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-macrooptions-method-excel</a>  </p>\n\n<pre><code>Public Sub SetMacroOptions()\n\n    Application.MacroOptions _\n        Macro:=\"SaveWorksheetsAsCSV\", _\n        Description:=\"Saves the sheet as a CSV\", _\n        HasShortCutKey:=True, _\n        ShortcutKey:=\"s\"\n\nEnd Sub\n</code></pre>\n\n<p>Not sure if you can set it with <em>Alt</em> using this method though.</p>\n"}], "owner": {"reputation": 658, "user_id": 467083, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e32852b0ba8af2d90ca9de291e6a8150?s=128&d=identicon&r=PG", "display_name": "oaklodge", "link": "https://stackoverflow.com/users/467083/oaklodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 49028381, "answer_count": 2, "score": 1, "last_activity_date": 1519821335, "creation_date": 1519813657, "last_edit_date": 1531161705, "question_id": 49027268, "link": "https://stackoverflow.com/questions/49027268/setting-up-procedures-in-excel-for-hotkey-use", "title": "Setting up procedures in Excel for hotkey use", "body": "<p>I want the procedure below embedded in a macro-enabled Excel (xlsm) file.</p>\n\n<pre><code>Sub SaveWorksheetsAsCSV()\nDim WS As Excel.Worksheet\nDim CurrentWorkbook As String\nDim CurrentFormat As Long\nCurrentWorkbook = ThisWorkbook.FullName\nCurrentFormat = ThisWorkbook.FileFormat\nApplication.DisplayAlerts = False\nFor Each WS In ThisWorkbook.Worksheets\n    WS.Copy\n    ActiveWorkbook.SaveAs Filename:=CurrentWorkbook &amp; \"-\" &amp; WS.Name &amp; \".csv\", FileFormat:=xlCSV\n    ActiveWorkbook.Close savechanges:=False\n    ThisWorkbook.Activate\nNext\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I want the procedure to be assigned to a hotkey (Shift+Alt+S), so I also embed this procedure.</p>\n\n<pre><code>Private Sub Workbook_Open()\nApplication.OnKey \"+%s\", \"SaveWorksheetsAsCSV\"\nEnd Sub\n</code></pre>\n\n<p>I put both of these procedures in the \u201cThisWorkbook\u201d of the \u201cMicrosoft Excel Objects\u201d folder, because I want the hotkey\u2019ed save as CSV procedure to be usable from any sheet after the file is opened.</p>\n\n<p>I can bring up the macro list with Alt+F8 and run ThisWorkbook.SaveWorksheetsAsCSV and all sheets are saved as CSV files as expected. But when I use the hotkey (Shift+Alt+S), I get the error message \u201cCannot run macro...\u201d I'm fairly certain it\u2019s not a permission thing, for testing I\u2019ve turn on \u201cEnable all macros\u201d in Macro Security settings.</p>\n\n<p>Can someone help me set this up properly? This XLSM file will be used as a template that people will copy and modify and then convert to CSV for import into another tool.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519814478, "post_id": 49027250, "comment_id": 85059481, "body": "Your array doesn&#39;t have 24 dimensions, it has 2."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519814670, "post_id": 49027250, "comment_id": 85059601, "body": "I have changed the code and ran and receiving no result"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519815185, "post_id": 49027250, "comment_id": 85059904, "body": "Have you stepped through the code and checked what is going on? I think you are confusing the number of dimensions of an array and its size. Your array has 2 dimensions but you are only considering the 1st <code>dataArr(currentRow, 1)</code> and 2nd columns <code>dataArr(currentRow, 2)</code>. If you want to look at Z you need to refer to the 24th column (not 24th dimension)."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519816030, "post_id": 49027910, "comment_id": 85060450, "body": "Hi, Thank you for this. The ID is in column C and the value I want to find is in Column Z. There is data in between, this unfortunately did not return a result."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519816140, "post_id": 49027910, "comment_id": 85060509, "body": "Worked for me. Filled in the blank in Z1."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519816343, "post_id": 49027910, "comment_id": 85060609, "body": "I have just amended the test data slightly as its not working for me :("}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519816393, "post_id": 49027910, "comment_id": 85060644, "body": "Are you definitely using the right worksheet? I just put 4 values in C1:C4 and three values in Z2:Z4. Is that what you envisaged?"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519816552, "post_id": 49027910, "comment_id": 85060730, "body": "In some cases in column Z there will be no ID for a value in Column C"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519816582, "post_id": 49027910, "comment_id": 85060747, "body": "Yes, hence Z1 is blank. Please post a screenshot of your sample data."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519816944, "post_id": 49027910, "comment_id": 85060974, "body": "Hi, I have added a screen shot, it seems to be putting the ID in column C instead of in column Z."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519817113, "post_id": 49027910, "comment_id": 85061074, "body": "I may have messed up! Back later."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519817635, "post_id": 49027910, "comment_id": 85061394, "body": "I can return the Customer Numbers to as they were that&#39;s no problem"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519820854, "post_id": 49027910, "comment_id": 85063334, "body": "On reflection, I don&#39;t think there is a problem with the code, although I think there are better ways to solve this problem. Are you sure those values in C are the same - no trailing or leading spaces?"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519822877, "post_id": 49027910, "comment_id": 85064648, "body": "Yes no trailing spaces. Can I not just swap the result from C to Z? as it looks as though its just putting result in C. IE where there is an ID of 11764... This use to be 45978."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519823003, "post_id": 49027910, "comment_id": 85064742, "body": "Can you post a small screenshot (only needs a few rows) of your data before the macro and after the macro? Meanwhile I will post an alternative approach,"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519823496, "post_id": 49027910, "comment_id": 85065054, "body": "I have added the before photo which is the first one now."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519823588, "post_id": 49027910, "comment_id": 85065123, "body": "The problem is that none of your customer values 45519 has an ID. I have posted another solution but it will hit the same problem."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519823773, "post_id": 49027910, "comment_id": 85065246, "body": "Yes, this can be the case where the customer values may not have an ID at all."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519827450, "post_id": 49027910, "comment_id": 85067804, "body": "As it stands that code cannot be putting col Z entries in col C so something else must be going on. Did you try the other code?"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519827662, "post_id": 49027910, "comment_id": 85067965, "body": "The alternative code seemed to work and then went to an unresponsive state"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519827973, "post_id": 49027910, "comment_id": 85068206, "body": "Think I&#39;ve sorted that now."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1519827965, "last_edit_date": 1519827965, "creation_date": 1519815421, "answer_id": 49027910, "question_id": 49027250, "link": "https://stackoverflow.com/questions/49027250/finding-the-missing-values-based-on-criteria-in-column-c/49027910#49027910", "title": "Finding the missing values based on criteria in Column C", "body": "<p>Try this. Amended column references as per comments, plus I think your first loop was unnecessarily long. You'll need to change the 24s if your array is actually of a different size.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nDim wb As Workbook\nSet wb = ThisWorkbook\nDim ws As Worksheet\nDim lastRow As Long\nSet ws = ThisWorkbook.Worksheets(\"transactions\")\nlastRow = ws.Cells(ws.Rows.Count, \"C\").End(xlUp).Row\nDim dataArr()\ndataArr = ws.Range(\"C1:Z\" &amp; lastRow).Value\nDim currentRow As Long\nDim dict As Object\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nFor currentRow = LBound(dataArr, 1) To UBound(dataArr, 1)\n    If Not IsEmpty(dataArr(currentRow, 24)) And Not dict.Exists(dataArr(currentRow, 1)) Then\n        dict.Add dataArr(currentRow, 1), dataArr(currentRow, 24)\n    End If\nNext currentRow\n\nFor currentRow = LBound(dataArr, 1) To UBound(dataArr, 1)\n    If IsEmpty(dataArr(currentRow, 24)) Then\n        dataArr(currentRow, 24) = dict(dataArr(currentRow, 1))\n    End If\nNext currentRow\n\nws.Range(\"C1\").Resize(UBound(dataArr, 1), UBound(dataArr, 2)) = dataArr\n\nEnd Sub\n</code></pre>\n\n<p><strong>Alternative method</strong></p>\n\n<pre><code>Sub test()\n\nDim wb As Workbook\nSet wb = ThisWorkbook\nDim ws As Worksheet\nDim lastRow As Long\nSet ws = ThisWorkbook.Worksheets(\"transactions\")\nlastRow = ws.Cells(ws.Rows.Count, \"C\").End(xlUp).Row\n\nDim r As Range, r1 As Range, s As String\n\nFor Each r In ws.Range(\"Z1:Z\" &amp; lastRow).SpecialCells(xlCellTypeBlanks)\n    Set r1 = ws.Range(\"C1:C\" &amp; lastRow).Find(ws.Cells(r.Row, \"C\"), , , xlWhole)\n    If Not r1 Is Nothing Then\n        s = r1.Address\n        Do Until r1.Row &lt;&gt; r.Row\n            Set r1 = ws.Range(\"C1:C\" &amp; lastRow).FindNext(r1)\n            If r1.Address = s Then Exit Do\n        Loop\n        r.Value = ws.Cells(r1.Row, \"Z\")\n    End If\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1519819411, "creation_date": 1519819411, "answer_id": 49029156, "question_id": 49027250, "link": "https://stackoverflow.com/questions/49027250/finding-the-missing-values-based-on-criteria-in-column-c/49029156#49029156", "title": "Finding the missing values based on criteria in Column C", "body": "<p>There is some tidying up to do. Currently assumes data starts in row 2.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"transactions\")\n    Dim lastRow As Long\n\n    lastRow = ws.Cells(ws.Rows.Count, \"C\").End(xlUp).Row\n\n    Dim unionRng As Range\n    Set unionRng = Union(ws.Range(\"C2:C\" &amp; lastRow), ws.Range(\"Z2:Z\" &amp; lastRow))\n\n    Dim dataArray()\n    Dim numberOfColumns As Long\n    numberOfColumns = unionRng.Areas.Count\n\n    ReDim dataArray(1 To lastRow, 1 To numberOfColumns) '1 could come out into variable startRow\n    Dim currRow As Range\n\n    Dim columnToFill As Long\n\n    For columnToFill = 1 To numberOfColumns\n\n        For Each currRow In unionRng.Areas(columnToFill)\n\n            dataArray(currRow.Row - 1, columnToFill) = currRow 'assume data starts in row 1 otherwise if 2 then currRow.Row -1 etc\n\n        Next currRow\n\n    Next columnToFill\n\n\n    Dim currentRow As Long\n    Dim dict As Object\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    For currentRow = LBound(dataArray, 1) To UBound(dataArray, 1)\n\n        If Not IsEmpty(dataArray(currentRow, 2)) And Not dict.Exists(dataArray(currentRow, 1)) Then\n            dict.Add dataArray(currentRow, 1), dataArray(currentRow, 2)\n        End If\n\n    Next currentRow\n\n    For currentRow = LBound(dataArray, 1) To UBound(dataArray, 1)\n\n        If IsEmpty(dataArray(currentRow, 2)) Then\n\n            dataArray(currentRow, 2) = dict(dataArray(currentRow, 1))\n        End If\n\n    Next currentRow\n\n    ws.Range(\"Z2\").Resize(UBound(dataArray, 1), 1) = Application.Index(dataArray, 0, 2)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1519838332, "creation_date": 1519838332, "answer_id": 49035193, "question_id": 49027250, "link": "https://stackoverflow.com/questions/49027250/finding-the-missing-values-based-on-criteria-in-column-c/49035193#49035193", "title": "Finding the missing values based on criteria in Column C", "body": "<p>you could very simply go like follows</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cell As Range, IdsRng As Range\n\n    With Worksheets(\"transactions\") 'reference wanted sheet\n        Set IdsRng = .Range(\"Z2\", .Cells(.Rows.Count, \"Z\").End(xlUp)).SpecialCells(XlCellType.xlCellTypeConstants, xlNumbers) 'get all IDs from its column Z cells with constant numeric value\n\n        With .Range(\"C1\", .Cells(.Rows.Count, \"C\").End(xlUp)) 'reference referenced sheet column C cells from row 1 (header) down to last not empty one\n            For Each cell In IdsRng 'loop through all IDs\n                .AutoFilter Field:=1, Criteria1:=cell.Offset(, -23).value ' filter referenced cells on 1st column with passed ID content 'filter referenced range with current ID\n                .Offset(1, 23).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).value = IdsRng.value 'write all filtered cells corresponding values in column Z with current ID\n            Next\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 49029156, "answer_count": 3, "score": -1, "last_activity_date": 1519838332, "creation_date": 1519813616, "last_edit_date": 1531164843, "question_id": 49027250, "link": "https://stackoverflow.com/questions/49027250/finding-the-missing-values-based-on-criteria-in-column-c", "title": "Finding the missing values based on criteria in Column C", "body": "<p>I have a value in column C which in some cases are duplicated, where there are duplicates I want it to look in column Z for the corresponding ID if none exist I want it to check where whether any other values in column C have a value in Column Z and then add the missing values into column Z accordingly:</p>\n\n<pre><code>Column C         Column Z   \n45519            Blank*\n45519            1 \n456              2\n456              *Blank\n</code></pre>\n\n<p>Expected result:</p>\n\n<pre><code>Column C:        Column Z\n45519                1\n45519                1\n456                  2\n456                  2\n</code></pre>\n\n<p>Stackoverflow Code I have adapted to use 1 and 24 respectively.</p>\n\n<pre><code> Sub test()\n\n Dim wb As Workbook\n Set wb = ThisWorkbook\n Dim ws As Worksheet\n Set ws = ThisWorkbook.Worksheets(\"transactions\")\n lastRow = ws.Cells(ws.Rows.Count, \"C\").End(xlUp).Row\n Dim dataArr()\n dataArr = ws.Range(\"C1:Z\" &amp; lastRow).Value\n Dim currentRow As Long\n Dim dict As Object\n\n Set dict = CreateObject(\"Scripting.Dictionary\")\n For currentRow = LBound(dataArr, 1) To UBound(dataArr, 2)\n If Not IsEmpty(dataArr(currentRow, 2)) And Not dict.Exists(dataArr\n (currentRow, 1)) Then\n    dict.Add dataArr(currentRow, 1), dataArr(currentRow, 2)\nEnd If\nNext currentRow\nFor currentRow = LBound(dataArr, 1) To UBound(dataArr, 1)\n\nIf IsEmpty(dataArr(currentRow, 2)) Then\n\n    dataArr(currentRow, 2) = dict(dataArr(currentRow, 1))\n End If\n\nNext currentRow\n\nws.Range(\"C1\").Resize(UBound(dataArr, 1), UBound(dataArr, 2)) = dataArr\n\nEnd Sub\n</code></pre>\n\n<p>I am receiving no result in column Z as a result of this</p>\n\n<p><a href=\"https://i.stack.imgur.com/wB0Ok.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wB0Ok.png\" alt=\"Before Macro\"></a>\n<a href=\"https://i.stack.imgur.com/06Ki8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/06Ki8.png\" alt=\"After Macro\"></a></p>\n"}, {"tags": ["vba", "selenium", "firefox", "xpath", "xpath-1.0"], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 9208302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c35d63bc17c24906d4d88921fd1c31b?s=128&d=identicon&r=PG&f=1", "display_name": "saransh", "link": "https://stackoverflow.com/users/9208302/saransh"}, "edited": false, "score": 1, "creation_date": 1519819085, "post_id": 49028684, "comment_id": 85062220, "body": "Wow, I got a quick response. Amazing! Hi DebanjanB, Thank you for your reply - much appreciated.Awesome it work like a charm, Perfect!!!! Thanks so much for your assistance."}], "tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": true, "score": 2, "last_activity_date": 1519818306, "last_edit_date": 1519818306, "creation_date": 1519817884, "answer_id": 49028684, "question_id": 49027188, "link": "https://stackoverflow.com/questions/49027188/vba-selenium-code-to-get-data-from-li-class/49028684#49028684", "title": "Vba selenium code to get data from Li class", "body": "<p>To get the text from the <code>&lt;li&gt;</code> tags you can use the following <a href=\"https://stackoverflow.com/questions/48369043/official-locator-strategies-for-the-webdriver/48376890#48376890\"><em>Locator Strategies</em></a> :</p>\n\n<ul>\n<li><p><code>Abhay 28566207</code> :</p>\n\n<pre><code>dd = driver.FindElementByXPath(\"//ul[@class='oas_columnsWrapper']//following::li[2]\").Text\n//or\ndd = driver.FindElementByXPath(\"//ul[@class='oas_columnsWrapper']//following::li[2]\").Attribute(\"innerHTML\") \n</code></pre></li>\n<li><p><code>Brick Field Shelters</code> :</p>\n\n<pre><code>dd = driver.FindElementByXPath(\"//ul[@class='oas_columnsWrapper']//following::li[3]\").Text\n//or\ndd = driver.FindElementByXPath(\"//ul[@class='oas_columnsWrapper']//following::li[3]\").Attribute(\"innerHTML\")\n</code></pre></li>\n<li><p><code>2018-02-12</code> :</p>\n\n<pre><code>dd = driver.FindElementByXPath(\"//ul[@class='oas_columnsWrapper']//following::li[4]\".Text\n//or\ndd = driver.FindElementByXPath(\"//ul[@class='oas_columnsWrapper']//following::li[4]\".Attribute(\"innerHTML\")\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 180, "user_id": 9208302, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9c35d63bc17c24906d4d88921fd1c31b?s=128&d=identicon&r=PG&f=1", "display_name": "saransh", "link": "https://stackoverflow.com/users/9208302/saransh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 49028684, "answer_count": 1, "score": 1, "last_activity_date": 1563738760, "creation_date": 1519813411, "last_edit_date": 1563738760, "question_id": 49027188, "link": "https://stackoverflow.com/questions/49027188/vba-selenium-code-to-get-data-from-li-class", "title": "Vba selenium code to get data from Li class", "body": "<p>I am trying to get data from li having same Class below is the code which i have tried but did not received any output.</p>\n\n<p>Please correct me where i am wrong.</p>\n\n<p>My VBA code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Class_Initialize()\r\nSet driver = CreateObject(\"Selenium.FirefoxDriver\")\r\ndriver.get \"url\"\r\ndriver.Window.Maximize\r\nDim dd As Variant\r\ndd = driver.findElementsByClass(\"oas_columns ng-binding\")(2).Text\r\nRange(\"A\" &amp; Rows.Count).End(xlUp).Offset(1) = dd\r\n\r\n'In column A i require output Abhay 28566207\r\n\r\ndd = driver.findElementsByClass(\"oas_columns ng-binding\")(3).Text\r\nRange(\"B\" &amp; Rows.Count).End(xlUp).Offset(1) = dd\r\n\r\n'In column B i require output Brick Field Shelters\r\n\r\ndd = driver.findElementsByClass(\"oas_columns ng-binding\")(4).Text\r\nRange(\"C\" &amp; Rows.Count).End(xlUp).Offset(1) = dd\r\n\r\n'In column C i require output 2018-02-12\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My HTML code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;ul class=\"oas_columnsWrapper\"&gt;\r\n&lt;li class=\"oas_columns ng-binding\" ng-show=\"vm.data\"&gt;1.&lt;/li&gt;\r\n&lt;li class=\"oas_columns ng-binding\"&gt;Abhay 28566207&lt;/li&gt;\r\n&lt;li class=\"oas_columns ng-binding\"&gt;Brick Field Shelters&lt;/li&gt;\r\n&lt;li class=\"oas_columns ng-binding\"&gt;2018-02-12&lt;/li&gt;\r\n&lt;li class=\"oas_columns ng-binding\"&gt;3,868&lt;/li&gt;\r\n&lt;li class=\"oas_columns ng-binding\"&gt;33&lt;/li&gt;\r\n&lt;li class=\"oas_columns ng-binding\"&gt;0.85%&lt;/li&gt;\r\n&lt;li class=\"oas_columns semiBold active\"&gt;ACTIVE&lt;/li&gt;\r\n&lt;div class=\"oas_columns\" ng-show=\"x['responseCount']\"&gt;&lt;a href=\"/do/my99acres/homepage/route/all_responses/ITOA-8157\" ng-click=\"trackGA('Manage Listings', 'OnClick', 'ML_ShowResponse', '');\" ui-sref=\"root.response({filter:'ITOA' + '-' + 8157})\" ui-sref-opts=\"{reload:true}\" class=\"ng-binding\"&gt;4 Responses&lt;/a&gt;&lt;/div&gt;&lt;li class=\"oas_columns oas_viewReportBtn\" id=\"oas_viewReportBtn0\" ng-click=\"vm.viewReport($index,$event);\"&gt;View Report&lt;/li&gt;&lt;/ul&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1519813552, "post_id": 49027155, "comment_id": 85058944, "body": "You can use <code>Autofilter</code> through VBA or manually. What have you worked out so far? On stack overflow you won&#39;t get custom written code to suit your needs."}, {"owner": {"reputation": 639, "user_id": 8282103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71ad01e7729a22c4ab2c96ff8c9f022f?s=128&d=identicon&r=PG&f=1", "display_name": "Gen Tan", "link": "https://stackoverflow.com/users/8282103/gen-tan"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1519813700, "post_id": 49027155, "comment_id": 85059023, "body": "Ok will check out <code>autofilter</code>. Currently my difficulty is I do not know of a method or function to split by categorical variable."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1519827649, "last_edit_date": 1519827649, "creation_date": 1519824023, "answer_id": 49030587, "question_id": 49027155, "link": "https://stackoverflow.com/questions/49027155/how-to-split-categorical-data-in-excel-using-vba/49030587#49030587", "title": "How to split categorical data in Excel (using VBA)", "body": "<p>Here is a start for 10. I will add more commentary after meeting. \nNote: Does require .Net framework.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FruitItems()\n\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"fruitData\")\n    Dim lastRow As Long\n\n    lastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim fruitDataArray()\n    fruitDataArray = ws.Range(\"A1:C\" &amp; lastRow)\n\n    Dim fruitSortedList As Object\n    Set fruitSortedList = CreateObject(\"System.Collections.Sortedlist\")\n\n    Dim currentFruit As Long\n\n    On Error Resume Next\n\n    For currentFruit = LBound(fruitDataArray, 1) + 1 To UBound(fruitDataArray, 1)\n\n        fruitSortedList.Add fruitDataArray(currentFruit, 1), fruitDataArray(currentFruit, 1)\n\n    Next currentFruit\n\n    On Error GoTo 0\n\n    Dim i As Long\n\n    For i = 0 To fruitSortedList.Count - 1\n        'Debug.Print fruitSortedList.GetKey(i) &amp; vbTab &amp; fruitSortedList.GetByIndex(i)\n\n    For currentFruit = LBound(fruitDataArray, 1) + 1 To UBound(fruitDataArray, 1)\n\n        If fruitDataArray(currentFruit, 1) = fruitSortedList.GetKey(i) Then 'sorted order\n\n            Dim newSheet As Worksheet\n            Dim fruitName As String\n            fruitName = fruitDataArray(currentFruit, 1)\n\n            If SheetExists(fruitName) Then\n\n                 Set newSheet = wb.Worksheets(fruitName)\n\n            Else\n\n                Set newSheet = wb.Worksheets.Add(After:=wb.Worksheets(Worksheets.Count))\n                newSheet.Name = fruitName\n\n            End If\n\n            Dim counter As Long\n\n            counter = GetLast(newSheet, True) + 1\n\n            With newSheet\n\n                .Cells(counter, 1) = fruitDataArray(currentFruit, 1)\n                .Cells(counter, 2) = fruitDataArray(currentFruit, 2)\n                .Cells(counter, 3) = fruitDataArray(currentFruit, 3)\n                counter = counter + 1\n            End With\n\n            Set newSheet = Nothing\n\n        End If\n\n    Next currentFruit\n\n    Next i\n\nEnd Sub\n\n'@TimWilliams\nFunction SheetExists(shtName As String, Optional wb As Workbook) As Boolean\n    Dim sht As Worksheet\n\n    If wb Is Nothing Then Set wb = ThisWorkbook\n    On Error Resume Next\n    Set sht = wb.Sheets(shtName)\n    On Error GoTo 0\n    SheetExists = Not sht Is Nothing\nEnd Function\n'@Raystafarian\nPrivate Function GetLast(ByVal targetSheet As Worksheet, ByVal isRow As Boolean) As Long\n    If isRow Then\n        GetLast = targetSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    Else\n        GetLast = targetSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n    End If\nEnd Function\n</code></pre>\n\n<p>References:</p>\n\n<ol>\n<li><a href=\"https://codereview.stackexchange.com/questions/187246/reorder-columns-in-array\">https://codereview.stackexchange.com/questions/187246/reorder-columns-in-array</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/system.collections.sortedlist(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.collections.sortedlist(v=vs.110).aspx</a></li>\n<li><a href=\"http://www.robvanderwoude.com/vbstech_data_sortedlist.php\" rel=\"nofollow noreferrer\">http://www.robvanderwoude.com/vbstech_data_sortedlist.php</a></li>\n<li><a href=\"https://stackoverflow.com/questions/11456157/adding-sheets-to-end-of-workbook-in-excel-normal-method-not-working\">Adding sheets to end of workbook in Excel (normal method not working?)</a></li>\n<li><a href=\"https://stackoverflow.com/questions/6688131/test-or-check-if-sheet-exists\">Test or check if sheet exists</a></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520145150, "post_id": 49036311, "comment_id": 85190600, "body": "@JamesSoh, any feedback?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1519842815, "creation_date": 1519842815, "answer_id": 49036311, "question_id": 49027155, "link": "https://stackoverflow.com/questions/49027155/how-to-split-categorical-data-in-excel-using-vba/49036311#49036311", "title": "How to split categorical data in Excel (using VBA)", "body": "<p>you may try this (explanations in comments):</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim cell As Range, dict As Object, key As Variant\n    Dim targetSht As Worksheet\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    With Worksheets(\"fruits\") 'reference data sheet (change \"fruits\" to your actual data sheet name)\n        With .Range(\"A1\", .Cells(.Rows.Count, \"A\").End(xlUp)) 'reference its column A cells from row 1 (header) down to last not empty one\n            For Each cell In .Offset(1).Resize(.Rows.Count - 1) 'loop through referenced cells skipping first row (header)\n                dict.Item(cell.value) = cell.value 'fill dictionary keys with unique fruit names\n            Next\n            For Each key In dict.Keys 'loop through dictionary keys\n                Set targetSht = GetOrCreateSheet(key) 'get or create the sheet corresponding to current key (i.e.: fruit)\n                .AutoFilter Field:=1, Criteria1:=key ' filter referenced cells on 1st column with current fruit\n                .Offset(1).Resize(.Rows.Count - 1, 3).SpecialCells(xlCellTypeVisible).Copy Destination:=targetSht.Cells(Rows.Count, 1).End(xlUp).Offset(1) 'copy filtered cells skipping headers and paste them to target sheet starting from its column A first not empty row\n            Next\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n\nFunction GetOrCreateSheet(shtName As Variant) As Worksheet\n    On Error Resume Next\n    Set GetOrCreateSheet = Worksheets(shtName)\n    If GetOrCreateSheet Is Nothing Then\n        Worksheets.Add.name = shtName\n        Set GetOrCreateSheet = ActiveSheet\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 639, "user_id": 8282103, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71ad01e7729a22c4ab2c96ff8c9f022f?s=128&d=identicon&r=PG&f=1", "display_name": "Gen Tan", "link": "https://stackoverflow.com/users/8282103/gen-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1519842815, "creation_date": 1519813318, "question_id": 49027155, "link": "https://stackoverflow.com/questions/49027155/how-to-split-categorical-data-in-excel-using-vba", "title": "How to split categorical data in Excel (using VBA)", "body": "<p>Some sample data:</p>\n\n<pre><code>Fruit Type | Price | Weight\nApple | $1 | 0.5\nPear | $2 | 0.3\nApple | $1.2 | 0.4\nBanana | $1.1 | 0.2\n</code></pre>\n\n<p>I need a macro that does this:</p>\n\n<p>Sort the data by Fruit Type (a categorical variable). Then, for all the Apples, copy and paste them somewhere. For all the Bananas, copy and paste them somewhere. For all the Pears, copy and paste them somewhere.</p>\n\n<p>However, the solution needs to fit any Fruit Type (I won't know in advance what my categories are). </p>\n\n<p>How can I solve this? I am open to using VBA. I cannot figure out how to split the data by categories.</p>\n"}, {"tags": ["vba", "class"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519814462, "post_id": 49027065, "comment_id": 85059471, "body": "what in your link is quite self explaining : have you tried it? In any case you need to post your entire code attempt to make your question more likely to get answers"}, {"owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519814710, "post_id": 49027065, "comment_id": 85059621, "body": "Ok, I&#39;m figuring it out slowly."}, {"owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519815096, "post_id": 49027065, "comment_id": 85059845, "body": "I&#39;m just learning so no complex code, trying to get hold of for me new concept. Example what I wanted to do was object.property(string).property(string). Now that I&#39;m thinking about this I cannot find any such example in VBA. all the time you go object.object.property. And with examples in that link it is the same."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519817240, "post_id": 49027065, "comment_id": 85061141, "body": "a <code>String</code> typed property is not an <code>Object</code> so cannot have a property itself. You&#39;d better depict your scenario"}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 0, "last_activity_date": 1519924119, "last_edit_date": 1519924119, "creation_date": 1519923477, "answer_id": 49054920, "question_id": 49027065, "link": "https://stackoverflow.com/questions/49027065/vba-chaining-custom-classes-properties/49054920#49054920", "title": "VBA chaining custom classes properties", "body": "<p>When a class has a property of a type which has another properties then you can use them like a box which contains another box which contains another box which contains ... and so on. When the property doesn't contain any properties then it is <code>atomic</code> and contains just a value like e.g. <code>string</code> or <code>long</code>. Example</p>\n\n<blockquote>\n  <p>Top level class named <code>Pivottable</code>. Contains reference to object of type <code>Pivotcache</code></p>\n</blockquote>\n\n<pre><code>Private m_pivotcache As Pivotcache\n\nPrivate Sub Class_Initialize()\n    Set m_pivotcache = New Pivotcache\nEnd Sub\n\nPublic Property Get Pivotcache() As Pivotcache\n    Set Pivotcache = m_pivotcache\nEnd Property\n\nPublic Property Let Pivotcache(ByVal vNewPivotcache As Pivotcache)\n    Set m_pivotcache = vNewPivotcache\nEnd Property\n</code></pre>\n\n<blockquote>\n  <p>Another class named <code>Pivotcache</code>. It has atomic property <code>MemoryUsed</code> of type <code>Long</code>.</p>\n</blockquote>\n\n<pre><code>Private m_memoryused As Long\n\nPrivate Sub Class_Initialize()\n    m_memoryused = 0\nEnd Sub\n\nPublic Property Get MemoryUsed() As Long\n    MemoryUsed = m_memoryused\nEnd Property\n\nPublic Property Let MemoryUsed(ByVal vNewMemoryUsed As Long)\n    m_memoryused = vNewMemoryUsed\nEnd Property\n</code></pre>\n\n<blockquote>\n  <p>Test in standard module</p>\n</blockquote>\n\n<pre><code>Sub test()\n    Dim pvt As Pivottable\n    Set pvt = New Pivottable\n    pvt.Pivotcache.MemoryUsed = 123456789\n    Debug.Print pvt.Pivotcache.MemoryUsed\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 49054920, "answer_count": 1, "score": 1, "last_activity_date": 1519924119, "creation_date": 1519813068, "question_id": 49027065, "link": "https://stackoverflow.com/questions/49027065/vba-chaining-custom-classes-properties", "title": "VBA chaining custom classes properties", "body": "<p>I'm playing around (learning) with VBA custom classes and I cannot figure out one thing, or I do not even know if it is possible to do (inheritance limitation in VBA)</p>\n\n<p>I gathered something about chaining from this post\n<a href=\"https://stackoverflow.com/questions/17764917/vba-class-method-chaining\">VBA Class Method Chaining</a></p>\n\n<p>Within the example in link above you can write</p>\n\n<pre><code>obj.Borders.Color '-&gt; this will return long type of color value\n</code></pre>\n\n<p>but you cannot use <code>obj.Borders</code> because <code>Borders</code> is declared as derived class, declared within main class <code>obj</code> and color is property of this derived class.</p>\n\n<p>What I'm trying to figure out is how to chain properties/methods in custom classes</p>\n\n<p>Something like</p>\n\n<pre><code>dim pvt as pivottable\n\nset pvt = ....\n\npvt.pivotcache '-&gt; method returns pivotcache object\npvt.pivotcache.memoryused '-&gt; returns property of pivotcache object\n</code></pre>\n\n<p>any simple example how to do this with custom classes. I seem not to be able to wrap my head around this. </p>\n\n<p>Thank you in advance for any example</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519812239, "post_id": 49026683, "comment_id": 85058072, "body": "How are we supposed to know? What are the values d and Mx?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519812317, "post_id": 49026683, "comment_id": 85058130, "body": "d will be in pattern &quot;MG000&quot; and Mx will be Long. Invoice no will be like MG00981"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1519812519, "post_id": 49026683, "comment_id": 85058270, "body": "There&#39;s a lot of undeclared variables in your code.  I&#39;ve not seen a range referenced as <code>&quot;WIP[Key]&quot;</code> before - is that valid?  What is the value of <code>Num_Key</code>?  <code>c</code>, <code>r</code>, <code>l</code> and <code>s</code> should be <code>Long</code> I take it?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519812534, "post_id": 49026683, "comment_id": 85058280, "body": "I didn&#39;t ask what they will be, but what they ARE. When it errors what are their values?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1519812895, "post_id": 49026683, "comment_id": 85058522, "body": "Please refer the attached updated code.."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519812973, "post_id": 49026683, "comment_id": 85058569, "body": "@SJR during error d = MG00 and MX 981"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1519813242, "post_id": 49026683, "comment_id": 85058744, "body": "@DarrenBartrup-Cook yes"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519813905, "post_id": 49026683, "comment_id": 85059147, "body": "Not sure. Inside your Select Case try using a different string variable than l which you have previously used as an integer."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519816220, "post_id": 49026683, "comment_id": 85060555, "body": "I would recommend another name for a <code>cell</code> variable.. if certain references are added it can be confused with <code>Word</code> object <code>Cell</code> which is an object of <code>Word</code> <code>Table</code> cell."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1519827521, "post_id": 49026683, "comment_id": 85067858, "body": "Sry tired different name already and still not working :("}], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1519813036, "post_id": 49026739, "comment_id": 85058617, "body": "Still getting the same error :( Thank you for your help :P"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1519812154, "creation_date": 1519812154, "answer_id": 49026739, "question_id": 49026683, "link": "https://stackoverflow.com/questions/49026683/run-time-error-1004-application-defined-object-defined-error/49026739#49026739", "title": "Run time Error 1004 Application defined/object defined error", "body": "<p>Write <code>Option Explicit</code> on top.\nThen declare all the variables.</p>\n\n<p>Eg. <code>Dim d as String</code>. It would work.</p>\n\n<p>Or quick and dirty:</p>\n\n<pre><code>cell.Value = CStr(d) &amp; CStr(Mx)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1519827711, "post_id": 49030718, "comment_id": 85067998, "body": "Sorry to hear that. Then I don&#39;t know either."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9412677"}, "is_accepted": false, "score": 0, "last_activity_date": 1519825265, "last_edit_date": 1519825265, "creation_date": 1519824466, "answer_id": 49030718, "question_id": 49026683, "link": "https://stackoverflow.com/questions/49026683/run-time-error-1004-application-defined-object-defined-error/49030718#49030718", "title": "Run time Error 1004 Application defined/object defined error", "body": "<p>This worked for me.</p>\n\n<p>Try changing the name of <code>cell As Range</code> to something like <code>myCell As Range</code>. Because <code>cell</code> is an object in VBA so you can't use that name.</p>\n"}], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519827649, "creation_date": 1519811983, "last_edit_date": 1531164843, "question_id": 49026683, "link": "https://stackoverflow.com/questions/49026683/run-time-error-1004-application-defined-object-defined-error", "title": "Run time Error 1004 Application defined/object defined error", "body": "<p>I'm generating unique keys for invoice by using the below code and im getting <strong>Run time Error 1004 Application defined or object defined error</strong> in line </p>\n\n<pre><code>cell.Value = CStr(d &amp; Mx) \n</code></pre>\n\n<p>Why I'm getting it?</p>\n\n<pre><code>Private Sub Key_Gen()\n\nDim WIP_rng As Range\nDim d As String, c As Long, r As Long, s As Integer, p As Integer\n\n\nSet WIP_rng = Range(\"WIP[Key]\")\n\nMx = WorksheetFunction.Max(keynum)\nc = 1\np = 0\n    For Each col In WIP_rng\n    r = col.Row\n        If col.Value = \"\" And Cells(r, 3).Value &lt;&gt; \"\" And Cells(r, 4).Value &lt;&gt; \"\" And Cells(r, 5).Value &lt;&gt; \"\" And Cells(r, 6).Value &lt;&gt; \"\" And Cells(r, 7).Value &lt;&gt; \"\" Then\n            s = Val(Len(Trim(Mx)))\n            Debug.Print s\n            t = 5\n            p = t - s\n            Debug.Print p\n               If p = 1 Then\n               p = \"0\"\n               ElseIf p = 2 Then\n                p = \"00\"\n               ElseIf p = 3 Then\n                p = \"000\"\n               ElseIf p = 4 Then\n                p = \"0000\"\n                ElseIf p = 0 Then\n                p = \"\"\n               End If\n                Mx = CStr(Mx + c)\n                d = CStr(\"MG\" &amp; p)\n                d = d &amp; Mx\n                col.Value = d\n        c = c + 1\n        End If\n    Next\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1519811170, "post_id": 49026339, "comment_id": 85057366, "body": "This might help <a href=\"https://stackoverflow.com/questions/30848609/how-to-automate-find-replace-code-in-vba-modules-in-ms-office-2013\" title=\"how to automate find replace code in vba modules in ms office 2013\">stackoverflow.com/questions/30848609/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519811562, "post_id": 49026339, "comment_id": 85057632, "body": "What is more automatic than by code?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1519811485, "last_edit_date": 1525816189, "creation_date": 1519811485, "answer_id": 49026512, "question_id": 49026339, "link": "https://stackoverflow.com/questions/49026339/how-to-mass-replace-contents-inside-the-excel-vba-itself-not-in-cells-contents/49026512#49026512", "title": "How to mass replace contents inside the Excel VBA itself (not in cells contents)?", "body": "<p>This would check for the words <code>Option Private Module</code> and if it does not find them, it would insert them everywhere (defined as a constant)\n - <a href=\"https://stackoverflow.com/questions/41612140/automatically-add-option-private-moule-to-all-modules-in-vba\">Automatically add `Option Private Module` to all modules in VBA</a>) If you switch a few lines it would do what you need.</p>\n\n<pre><code>Sub AddOptionPrivate()\n\n    Const UP_TO_LINE = 5\n    Const PRIVATE_MODULE = \"Option Private Module\"\n\n    Dim objXL               As Object\n\n    Dim objPro              As Object\n    Dim objComp             As Variant\n    Dim strText             As String\n\n    Set objXL = GetObject(, \"Excel.Application\")\n    Set objPro = objXL.ActiveWorkbook.VBProject\n\n    For Each objComp In objPro.VBComponents\n        If objComp.Type = 1 Then\n            strText = objComp.CodeModule.Lines(1, UP_TO_LINE)\n\n            If InStr(1, strText, PRIVATE_MODULE) = 0 Then\n                objComp.CodeModule.InsertLines 2, PRIVATE_MODULE\n            End If\n\n        End If\n    Next objComp\n\nEnd Sub\n</code></pre>\n\n<p>In general, this is a must read - <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a> see the <code>SearchCodeModule</code> from there:</p>\n\n<pre><code>Sub SearchCodeModule()\n    Dim VBProj As VBIDE.VBProject\n    Dim VBComp As VBIDE.VBComponent\n    Dim CodeMod As VBIDE.CodeModule\n    Dim FindWhat As String\n    Dim SL As Long ' start line\n    Dim EL As Long ' end line\n    Dim SC As Long ' start column\n    Dim EC As Long ' end column\n    Dim Found As Boolean\n\n    Set VBProj = ActiveWorkbook.VBProject\n    Set VBComp = VBProj.VBComponents(\"Module1\")\n    Set CodeMod = VBComp.CodeModule        \n    FindWhat = \"findthis\"        \n    With CodeMod\n        SL = 1\n        EL = .CountOfLines\n        SC = 1\n        EC = 255\n        Found = .Find(target:=FindWhat, StartLine:=SL, StartColumn:=SC, _\n            EndLine:=EL, EndColumn:=EC, _\n            wholeword:=True, MatchCase:=False, patternsearch:=False)\n        Do Until Found = False\n            Debug.Print \"Found at: Line: \" &amp; CStr(SL) &amp; \" Column: \" &amp; CStr(SC)\n            EL = .CountOfLines\n            SC = EC + 1\n            EC = 255\n            Found = .Find(target:=FindWhat, StartLine:=SL, StartColumn:=SC, _\n                EndLine:=EL, EndColumn:=EC, _\n                wholeword:=True, MatchCase:=False, patternsearch:=False)\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7531126, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DzTWk.jpg?s=128&g=1", "display_name": "KaloyanGeorgiev", "link": "https://stackoverflow.com/users/7531126/kaloyangeorgiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519815623, "creation_date": 1519810926, "last_edit_date": 1531161705, "question_id": 49026339, "link": "https://stackoverflow.com/questions/49026339/how-to-mass-replace-contents-inside-the-excel-vba-itself-not-in-cells-contents", "title": "How to mass replace contents inside the Excel VBA itself (not in cells contents)?", "body": "<p>I have more than 500 excel files in a folder, each one containing the same version of a VBA which has errors. The errors can be easily fixed by commenting out a few lines of the VBA.\nAll I could find is how to mass replace data inside the sheets but not inside the macro itself..</p>\n\n<p>Is there a way to mass replace the contents of the VBA inside all files from \"sometext_inside_vba\" to \"'sometext_inside_vba\"? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel", "filesystems"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1519812182, "post_id": 49026176, "comment_id": 85058034, "body": "You say that date is always the same but you have 2 different dates in the name (<code>2018_02_26</code> and <code>200180228</code>). Is one of these static? also any of these dates todays date? or are they just random dates?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519812836, "post_id": 49026176, "comment_id": 85058483, "body": "So is it just one file which has _GDW_Audit_CView_Report.txt in that you are trying to find?"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1519812911, "post_id": 49026176, "comment_id": 85058533, "body": "The dates are today&#39;s dates. We receive the reports daily and the filename is generated by the feed like this. Yeah for starters I am trying to identify one file that contains _GDW_Audit_CView_Report.txt and the given day&#39;s date."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519813252, "post_id": 49026176, "comment_id": 85058750, "body": "you are actually trying to rename a file called C:\\Users\\bf91955\\SourceFldr\\2018_02_28_20180228*_GDW_Audit_C&zwnj;&#8203;View_Report.txt*    is this what you meant? Unless you have * in the name you should get a file not found error or some such?"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1519813340, "post_id": 49026176, "comment_id": 85058829, "body": "the file looks like this: 2018_02_28_20180228_614712_GDW_Audit_CView_Report.txt where 614712 is a random number different every day, so I cannot define an exact filename for the code. I get wrong file number/folder access error."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1519814025, "post_id": 49027238, "comment_id": 85059226, "body": "I tried the Dir version, but I couldn&#39;t add the date variable as an identifier, as I&#39;d need it too for weekend reports (3 different files received on Monday). Would it work if I do something like this: <code>fname = Dir(&quot;C:\\Users\\User\\Desktop\\Test\\ &amp; myDate1 &amp; *_GDW_Audit_CView_Report.txt&quot;)</code>"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1519814483, "post_id": 49027238, "comment_id": 85059482, "body": "Thank you so much for the help, I&#39;ll adapt the Dir/Wildcard method then. Just curious: what is the benefit of using <code>Application.PathSeparator</code> instead of just putting <code>&amp; &quot;&#47;&quot; &amp;</code> or something? Clarity?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1519814722, "post_id": 49027238, "comment_id": 85059629, "body": "Is a compatibility thing."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1519830327, "last_edit_date": 1519830327, "creation_date": 1519813593, "answer_id": 49027238, "question_id": 49026176, "link": "https://stackoverflow.com/questions/49026176/trying-to-identify-and-rename-a-file-with-an-original-name-that-contains-a-rando/49027238#49027238", "title": "Trying to identify and rename a file with an original name that contains a random number", "body": "<p>I am not sure if this is what you mean but you can use the Dir function with wildcards to try and get the filename.</p>\n\n<p>So say I had a file called </p>\n\n<p>2018_02_28_20180228_XXXXXX_GDW_Audit_CView_Report.txt</p>\n\n<p>I can retrieve the actual name as follows. First match. No real error handling if not found just test that string is assigned a value other than that which it was initialized with. You can pass the folder path as a variable.</p>\n\n<pre><code>Sub TEST()\n\n    Dim fname As String\n\n    fname = Dir(\"C:\\Users\\User\\Desktop\\Test\\*_GDW_Audit_CView_Report.txt\")\n\n    If fname &lt;&gt; vbNullString Then\n\n        Debug.Print fname\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Example passing a folder variable and date1 (note date1  = \"2018_02_28\" as of this moment) :</p>\n\n<pre><code>Sub TEST()\n\n    Dim myDate1 As String\n\n    myDate1 = Format$(Date, \"yyyy_mm_dd\")\n\n    'Debug.Print myDate1\n\n    Dim fname As String\n    Dim folderPath As String\n\n    folderPath = \"C:\\Users\\User\\Desktop\\Test\"\n\n    fname = Dir(folderPath &amp; Application.PathSeparator &amp; myDate1 &amp; \"*_GDW_Audit_CView_Report.txt\")\n\n    If fname &lt;&gt; vbNullString Then\n\n        Debug.Print fname\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>And why did I use <code>Application.PathSeparator</code> ?  You should really test for the presence of a separator before trying to add one. In this case I used it for compatibility reasons. This will use the correct separator across Mac and Windows. </p>\n\n<p>For info see here:</p>\n\n<p><a href=\"http://apprize.info/microsoft/excel_2/22.html\" rel=\"nofollow noreferrer\">Excel 2016 Power Programming with VBA (2016)\nPart IV. Developing Excel Applications , Chapter 21. Understanding Compatibility Issues</a></p>\n\n<p>Quote:</p>\n\n<blockquote>\n  <p>If your code deals with paths and filenames, you need to construct\n  your path with the appropriate path separator (a colon for the Mac, a\n  backslash for Windows). A better approach is to avoid hard-coding the\n  path separator character and use VBA to determine it. The following\n  statement assigns the path separator character to a variable named\n  PathSep:</p>\n  \n  <p>PathSep = Application.PathSeparator</p>\n</blockquote>\n\n<p>Reference:</p>\n\n<p><a href=\"http://www.excelfunctions.net/vba-dir-function.html\" rel=\"nofollow noreferrer\">http://www.excelfunctions.net/vba-dir-function.html</a></p>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 49027238, "answer_count": 1, "score": 0, "last_activity_date": 1519830327, "creation_date": 1519810467, "last_edit_date": 1519813809, "question_id": 49026176, "link": "https://stackoverflow.com/questions/49026176/trying-to-identify-and-rename-a-file-with-an-original-name-that-contains-a-rando", "title": "Trying to identify and rename a file with an original name that contains a random number", "body": "<p>Hi there I am trying to rename a file in a folder (with multiple similar files), but I have a hard time identifying it even with the wildcard method. The original file name looks like this: \"2018_02_26_20180228_XXXXXX_GDW_Audit_CView_Report.txt\" so my only way of identifying it is knowing parts of the name (\"_GDW_Audit_CView_Report.txt\") as the date is the same across multiple files. I wrote the following code which gives Path/File Access error when I try to run it. Any help would be appreciated.</p>\n\n<pre><code>Option Explicit\nSub HGDW_WKD()\n\n    Dim myDateTemp As String\n    Dim myDate1 As String\n    Dim myDate2 As String\n    Dim HGDW_CV1 As String\n    Dim HGDW_CV2 As String\n\n    myDateTemp = Format(Date, \"yyyy-mm-dd\")\n    myDate1 = Replace(myDateTemp, \"-\", \"_\")\n    myDate2 = Format(Date, \"yyyymmdd\")\n\n    HGDW_CV1 = myDate1 &amp; \"_\" &amp; myDate2 &amp; \"*_GDW_Audit_CView_Report.txt*\"\n    HGDW_CV2 = \"35999_HR_Global_Data_Warehouse_CView_PROD_\" &amp; myDate2 &amp; \".txt\"\n\n    Name \"C:\\Users\\bf91955\\SourceFldr\\\" &amp; HGDW_CV1 As _ \n    \"C:\\Users\\bf91955\\SourceFldr\\\" &amp; HGDW_CV2\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "datepicker", "activex"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519812423, "post_id": 49026130, "comment_id": 85058210, "body": "You probably actually have 2 with the same name?  If you don&#39;t think so, I&#39;d be interested to take a look at the actual file if you wanted to share it...  it&#39;s indeed a little strange that one of them is on top of the row/column headings."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519814398, "post_id": 49026130, "comment_id": 85059434, "body": "Excel always had some strange behavior with ActiveX, I won&#39;t wonder if this is just a bug of the ActiveX at all."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519815267, "post_id": 49026130, "comment_id": 85059955, "body": "And are you sure there is a <code>.Right</code> parameter for a range and the picker at all? I cannot find only <code>.Left</code> and <code>.Top</code>, I&#39;m pretty sure there is no <code>.Right</code>. Is there any <code>On Error Resume Next</code> in your code? If so remove it! This will only suppress errors so you can&#39;t see them but they still occur. Instead of setting the right try setting the left <code>.Left = Target.Left + Target.Width</code>"}, {"owner": {"reputation": 165, "user_id": 1194396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b8813689b4a973e952074f08529dacc?s=128&d=identicon&r=PG&f=1", "display_name": "ositra", "link": "https://stackoverflow.com/users/1194396/ositra"}, "edited": false, "score": 0, "creation_date": 1519818242, "post_id": 49026130, "comment_id": 85061716, "body": "Thank you, PEH! You are right about the fact that there is no &quot;.Right&quot; and the &quot;.Left = Target.Left + Target.Width&quot; is a good replacement for it. However, unfortunately, it has not fixed the duplicate picker problem.  ashleedawg, I have no problem sharing my code, but what would be the best way? Just putting it in the comment would make it unviewable..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1519820938, "post_id": 49026130, "comment_id": 85063386, "body": "@ashleedawg since we talk about ActiveX controls there is no possibility to have 2 controls with the same name. It would not let you name the second if there is already one with that name."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519821373, "post_id": 49026130, "comment_id": 85063661, "body": "@ositra can you figure out if there is a pattern when this happens and when not? I mean you say it happens &quot;from time to time&quot;, but does this always happen on the same cell? Or does it sometimes work on a cell and sometimes on that same cell it doesn&#39;t? Can you probably share the full code of that sub? You can <a href=\"https://stackoverflow.com/posts/49026130/edit\">edit</a> your original question to add code in a formatted way."}, {"owner": {"reputation": 165, "user_id": 1194396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b8813689b4a973e952074f08529dacc?s=128&d=identicon&r=PG&f=1", "display_name": "ositra", "link": "https://stackoverflow.com/users/1194396/ositra"}, "edited": false, "score": 0, "creation_date": 1519823859, "post_id": 49026130, "comment_id": 85065311, "body": "Looking at this article, it seems that it truly is an ActiveX problem, but I haven&#39;t found a 100% confirmation on this: <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-msoffice_custom-mso_2010/datepicker-doesnt-lookact-the-same-after-closing/8657c238-f0eb-40dd-b9e0-cb37289dfee6\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519825845, "post_id": 49026130, "comment_id": 85066729, "body": "@ositra That is why I recommend to stay away from ActiveX at all whenever possible. They often have strange effects on Excel and sometimes cause more issues than they solve. You might have a look if you can update Office and if this might solve your issue."}, {"owner": {"reputation": 165, "user_id": 1194396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b8813689b4a973e952074f08529dacc?s=128&d=identicon&r=PG&f=1", "display_name": "ositra", "link": "https://stackoverflow.com/users/1194396/ositra"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519829411, "post_id": 49026130, "comment_id": 85069219, "body": "@P\u1d07\u029c, I added the code to the original post. Not much there."}], "answers": [{"comments": [{"owner": {"reputation": 21448, "user_id": 1839439, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/agMKZ.png?s=128&g=1", "display_name": "Dharman", "link": "https://stackoverflow.com/users/1839439/dharman"}, "edited": false, "score": 0, "creation_date": 1614119028, "post_id": 66341908, "comment_id": 117287062, "body": "I assume this is a solution. I removed the first part of your solution as it was completely redundant."}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1614972554, "post_id": 66341908, "comment_id": 117558019, "body": "I&#39;ve seen several posts around the web about this problem, and no one seems to have a real solution. It seems to work fine for most people, so maybe we&#39;re just unlucky. Anyway, I tried turning the checkbox property on and off, saving between settings, and the control still pops up to the upper left for me."}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1614973412, "post_id": 66341908, "comment_id": 117558334, "body": "I just found this discussion that points out that scrolling down and back up causes the &quot;floating&quot; calendar control to go away. Also, Freeze Top Row or Freeze Panes (if you include a row) makes it go away (you see it for a second when opening but it goes away immediately). If you freeze the first column, the floater stays until you scroll down and up. <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_win10-mso_o365b/excel-date-picker-buggy-unreliable-does-not-copy/cc02548a-5a8f-4ffc-af83-220cd8f25d54?auth=1\" rel=\"nofollow noreferrer\">Discussion</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 15270572, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/bee0cfc4648c2f0f258ae635a3fd9b55?s=128&d=identicon&r=PG", "display_name": "Tasky", "link": "https://stackoverflow.com/users/15270572/tasky"}, "is_accepted": false, "score": 0, "last_activity_date": 1614118991, "last_edit_date": 1614118991, "creation_date": 1614118523, "answer_id": 66341908, "question_id": 49026130, "link": "https://stackoverflow.com/questions/49026130/excel-displays-duplicate-calendar-picker-control-macros-vba/66341908#66341908", "title": "Excel displays duplicate calendar picker control (Macros VBA)", "body": "<p>Just now I tried changing the Checkbox (in the Calendar Properties) to True. Then when I went back, the duplicate one was gone. Changed it back to False and it didn't return.</p>\n"}], "owner": {"reputation": 165, "user_id": 1194396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b8813689b4a973e952074f08529dacc?s=128&d=identicon&r=PG&f=1", "display_name": "ositra", "link": "https://stackoverflow.com/users/1194396/ositra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 849, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1614118991, "creation_date": 1519810312, "last_edit_date": 1519829355, "question_id": 49026130, "link": "https://stackoverflow.com/questions/49026130/excel-displays-duplicate-calendar-picker-control-macros-vba", "title": "Excel displays duplicate calendar picker control (Macros VBA)", "body": "<p>I've created a macros-enabled Excel file where, when clicking into a specific cell, a pop-up calendar appears. It is an ActiveX control (Microsoft Date and Time Picker Control 6.0 (SP4)). From time to time the calendar control appears next to the clicked cell and is unclickable and a duplicate control appears in the left top corner of the worksheet and this one is clickable.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ymIbt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymIbt.png\" alt=\"duplicate controls appear\"></a></p>\n\n<p>I would like it to appear just next to the clicked cell. What could be wrong?</p>\n\n<pre><code>Sub Worksheet_SelectionChange(ByVal Target As Range)\n    With Sheet1.startPicker\n        If Not Intersect(Target, Range(\"E2:E10000\")) Is Nothing Then\n            .Visible = True\n            .Top = Target.Top\n            .Right = Target.Offset(0, 1).Right\n        Else\n            .Visible = False\n        End If\n    End With\nEnd Sub\nPrivate Sub startPicker_Change()\n    ActiveCell.Value = Me.startPicker.Value\nEnd Sub\n</code></pre>\n\n<p>When I click on the date picker control in Design Mode, then the name is set to startpicker and in the formula bar it says \"=EMBED(\"MSComCtl2.DTPicker.1\";\"\")\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519810203, "post_id": 49025919, "comment_id": 85056741, "body": "Can&#39;t you call both subs in separate sub?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519813528, "post_id": 49025919, "comment_id": 85058931, "body": "Do you run <code>Macro1</code>, followed by <code>Marco2</code>, or the other way around?"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1519814496, "creation_date": 1519814496, "answer_id": 49027579, "question_id": 49025919, "link": "https://stackoverflow.com/questions/49025919/combine-2-codes-with-loops-into-1-single-code/49027579#49027579", "title": "Combine 2 codes with loops into 1 single code", "body": "<p>Without explanation, it's unclear what this code is supposed to do, but I cleaned it up a little bit anyhow.</p>\n\n<p>Create a separate procedure to run these two sub's in whichever order you need them to run.  For example:</p>\n\n<pre><code>Sub runMyThings()\n    Call Macro1\n    Call Macro2\nEnd Sub\n</code></pre>\n\n<p>Note that I changed the name of <code>Marco2</code> to <code>Macro2</code>, but you should probably give them more meaningful names than that.  (Otherwise it's like having all your files called <code>File</code>.)</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n\n    Dim i As Integer\n\n    For i = 1 To ActiveWorkbook.Worksheets.Count\n        Sheets(i).Range(\"B11\").Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Insert Shift:=xlToRight\n        Selection.Insert Shift:=xlToRight\n        Selection.Insert Shift:=xlToRight\n        Selection.Insert Shift:=xlToRight\n        Range(\"B11\").FormulaR1C1 = \"Outlet name\"\n        Range(\"C11\").FormulaR1C1 = \"PO Number\"\n        Range(\"D11\").FormulaR1C1 = \"PO Date\"\n        Range(\"E11\").FormulaR1C1 = \"Delivery Date\"\n\n        ' Copy outlet name\n        Range(\"B1\").Copy\n        Range(\"A12\").End(xlDown).Offset(0, 1).Select\n        Range(Selection, Selection.End(xlUp).Offset(1)).Paste\n\n        '   Copy PO number\n        Range(\"B2\").Copy\n        Range(\"A12\").End(xlDown).Offset(0, 2).Select\n        Range(Selection, Selection.End(xlUp).Offset(1)).Paste\n\n        '   Copy PO date\n        Range(\"B3\").Copy\n        Range(\"A12\").End(xlDown).Offset(0, 3).Select\n        Range(Selection, Selection.End(xlUp).Offset(1)).Paste\n\n        '   Copy DO date\n        Range(\"B4\").Copy\n        Range(\"A12\").End(xlDown).Offset(0, 4).Select\n        Range(Selection, Selection.End(xlUp).Offset(1)).Paste\n    Next i\n\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\n\nSub Macro2()\n\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .DisplayAlerts = False\n    End With\n\n    On Error Resume Next 'this will delete the Sheet WITHOUT WARNING.\n    Application.DisplayAlerts = False\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    Application.DisplayAlerts = True\n    On Error GoTo 0\n\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"RDBMergeSheet\"\n\n    For Each sh In ActiveWorkbook.Worksheets\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n            Last = LastRow(DestSh)\n\n            Set CopyRng = sh.Range(\"A12\").Offset(1).CurrentRegion\n            Set CopyRng = CopyRng.Offset(1, 0)\n            Set CopyRng = CopyRng.Resize(CopyRng.Rows.Count - 1)\n            CopyRng.Copy\n\n            'Test if there enough rows in the DestSh to copy all the data\n            If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            CopyRng.Copy\n            With DestSh.Cells(Last + 1, \"A\")\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n\n            'Optional: This will copy the sheet name in the H column\n            DestSh.Cells(Last + 1, \"H\").Resize(CopyRng.Rows.Count).Value = sh.Name\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n\n    'AutoFit the column width in the DestSh sheet\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>I'm not proud of leaving the code like this but without a better idea of what you're trying to do, I can't do anything more.  (And if it doesn't work now, revert to your previous code.)</p>\n"}, {"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 0, "last_activity_date": 1519915351, "creation_date": 1519915351, "answer_id": 49052120, "question_id": 49025919, "link": "https://stackoverflow.com/questions/49025919/combine-2-codes-with-loops-into-1-single-code/49052120#49052120", "title": "Combine 2 codes with loops into 1 single code", "body": "<p>I attempted to refactor your code some to eliminate most of the select statements and combine various offsets and endup's and enddown's. (You should check that the combined results are still what you expect.)</p>\n\n<pre><code>Sub Macro1()\n    Dim WS_Count As Integer\n    Dim I As Integer\n\n    WS_Count = ActiveWorkbook.Worksheets.Count  'ThisWorkbook (?)\n\n    For I = 1 To WS_Count\n        with Sheets(I)\n            .Range(.Range(\"B11\"), .Range(\"B11\").End(xlDown).Offset(0,4)).Insert Shift:=xlToRight\n            .Range(\"B11\").FormulaR1C1 = \"Outlet name\"\n            .Range(\"C11\").FormulaR1C1 = \"PO Number\"\n            .Range(\"D11\").FormulaR1C1 = \"PO Date\"\n            .Range(\"E11\").FormulaR1C1 = \"Delivery Date\"\n\n            ' Copy outlet name\n            .Range(\"B1\").Copy\n            .Range(.Range(\"A12\").End(xlDown).Offset(0, 1), .Range(\"A12\").Offset(1, 1).End(xlUp)).Paste\n\n            '   Copy PO number\n            .Range(\"B2\").Copy\n            .Range(.Range(\"A12\").End(xlDown).Offset(0, 2), .Range(\"A12\").Offset(1, 2).End(xlUp)).Paste\n\n            '   Copy PO date\n            .Range(\"B3\").Copy\n            .Range(.Range(\"A12\").End(xlDown).Offset(0, 3), .Range(\"A12\").Offset(1, 3).End(xlUp)).Paste\n\n            '   Copy DO date\n            .Range(\"B4\").Copy\n            .Range(.Range(\"A12\").End(xlDown).Offset(0, 4), .Range(\"A12\").Offset(1, 4).End(xlUp)).Paste\n        end with\n    Next I\nEnd Sub\n</code></pre>\n\n<p>I added some commentary to the following sub as well:</p>\n\n<pre><code>Function LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", After:=sh.Range(\"A1\"), Lookat:=xlPart, _\n        LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\n\nSub Marco2()\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    'If the sheet is always being deleted from the workbook which holds this code, the following line should be:\n\n    'ThisWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n\n    'That way, if multiple books are open, it won't try to delete from the wrong workbook\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    Set DestSh = ActiveWorkbook.Worksheets.Add  'ThisWorkbook (?)\n    DestSh.Name = \"RDBMergeSheet\"\n\n    For Each sh In ActiveWorkbook.Worksheets    'ThisWorkbook (?)\n        If sh.Name &lt;&gt; DestSh.Name Then\n            Last = LastRow(DestSh)\n\n            Set CopyRng = sh.Range(\"A12\").Offset(1).CurrentRegion\n            Set CopyRng = CopyRng.Offset(1, 0).Resize(CopyRng.Rows.Count - 1)\n            CopyRng.Copy\n\n            'Test if there enough rows in the DestSh to copy all the data\n            If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            CopyRng.Copy\n\n            With DestSh.Cells(Last + 1, \"A\")\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n\n            'Optional: This will copy the sheet name in the H column\n            DestSh.Cells(Last + 1, \"H\").Resize(CopyRng.Rows.Count).Value = sh.Name\n\n            End If\n        Next sh 'added sh to be more explicit on which loop this is for\n\nExitTheSub:\n\n        Application.Goto DestSh.Cells(1)\n\n        'AutoFit the column width in the DestSh sheet\n        DestSh.Columns.AutoFit\n\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n        End With\nEnd Sub\n</code></pre>\n\n<p><strong>Answer</strong>\nI noticed that both subs loop through the worksheets in the workbook, so you should be able to combine the two by taking the code from within one sheet-loop and inserting it into the other, like so:</p>\n\n<pre><code>Function LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", After:=sh.Range(\"A1\"), Lookat:=xlPart, _\n        LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\n\nSub Marco2()\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    'If the sheet is always being deleted from the workbook which holds this code, the following line should be:\n\n    'ThisWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n\n    'That way, if multiple books are open, it won't try to delete from the wrong workbook\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    Set DestSh = ActiveWorkbook.Worksheets.Add  'ThisWorkbook (?)\n    DestSh.Name = \"RDBMergeSheet\"\n\n    For Each sh In ActiveWorkbook.Worksheets    'ThisWorkbook (?)\n\n    -------------------------------------------------------------\n    |   'From Macro1\n    |   with sh\n    |       .Range(.Range(\"B11\"), .Range(\"B11\").End(xlDown).Offset(0,4)).Insert Shift:=xlToRight\n    |       .Range(\"B11\").FormulaR1C1 = \"Outlet name\"\n    |       .Range(\"C11\").FormulaR1C1 = \"PO Number\"\n    |       .Range(\"D11\").FormulaR1C1 = \"PO Date\"\n    |       .Range(\"E11\").FormulaR1C1 = \"Delivery Date\"\n    |\n    |       ' Copy outlet name\n    |       .Range(\"B1\").Copy\n    |       .Range(.Range(\"A12\").End(xlDown).Offset(0, 1), .Range(\"A12\").Offset(1, 1).End(xlUp)).Paste\n    |       \n    |       '   Copy PO number\n    |       .Range(\"B2\").Copy\n    |       .Range(.Range(\"A12\").End(xlDown).Offset(0, 2), .Range(\"A12\").Offset(1, 2).End(xlUp)).Paste\n    |       \n    |       '   Copy PO date\n    |       .Range(\"B3\").Copy\n    |       .Range(.Range(\"A12\").End(xlDown).Offset(0, 3), .Range(\"A12\").Offset(1, 3).End(xlUp)).Paste\n    |\n    |       '   Copy DO date\n    |       .Range(\"B4\").Copy\n    |       .Range(.Range(\"A12\").End(xlDown).Offset(0, 4), .Range(\"A12\").Offset(1, 4).End(xlUp)).Paste\n    |   End With\n    |   'End of from Macro1\n    ----------------------------------------------------------\n\n        If sh.Name &lt;&gt; DestSh.Name Then\n            Last = LastRow(DestSh)\n\n            Set CopyRng = sh.Range(\"A12\").Offset(1).CurrentRegion\n            Set CopyRng = CopyRng.Offset(1, 0).Resize(CopyRng.Rows.Count - 1)\n            CopyRng.Copy\n\n            'Test if there enough rows in the DestSh to copy all the data\n            If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            CopyRng.Copy\n\n            With DestSh.Cells(Last + 1, \"A\")\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n\n            'Optional: This will copy the sheet name in the H column\n            DestSh.Cells(Last + 1, \"H\").Resize(CopyRng.Rows.Count).Value = sh.Name\n\n            End If\n        Next sh 'added sh to be more explicit on which loop this is for\n\nExitTheSub:\n\n        Application.Goto DestSh.Cells(1)\n\n        'AutoFit the column width in the DestSh sheet\n        DestSh.Columns.AutoFit\n\n        With Application\n            .ScreenUpdating = True\n            .EnableEvents = True\n        End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9410921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John Wu", "link": "https://stackoverflow.com/users/9410921/john-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519915351, "creation_date": 1519809616, "last_edit_date": 1531164843, "question_id": 49025919, "link": "https://stackoverflow.com/questions/49025919/combine-2-codes-with-loops-into-1-single-code", "title": "Combine 2 codes with loops into 1 single code", "body": "<p>After various trial and errors and helps from this forum, I managed to come out with the following codes to achieve what I want but it's two vba loops. I am hit with bottleneck on how to combine these two vba with loops into 1 single vba.\nHere is my code. </p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n\nDim WS_Count As Integer\nDim I As Integer\n\n\nWS_Count = ActiveWorkbook.Worksheets.Count\n\n\nFor I = 1 To WS_Count\n\n\nSheets(I).Select \n\nRange(\"B11\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Insert Shift:=xlToRight\nSelection.Insert Shift:=xlToRight\nSelection.Insert Shift:=xlToRight\nSelection.Insert Shift:=xlToRight\nRange(\"B11\").Select\nActiveCell.FormulaR1C1 = \"Outlet name\"\nRange(\"C11\").Select\nActiveCell.FormulaR1C1 = \"PO Number\"\nRange(\"D11\").Select\nActiveCell.FormulaR1C1 = \"PO Date\"\nRange(\"E11\").Select\nActiveCell.FormulaR1C1 = \"Delivery Date\"\n\n\n\n' Copy outlet name\nRange(\"B1\").Select\nSelection.Copy\nRange(\"A12\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(0, 1).Select\nRange(Selection, Selection.End(xlUp).Offset(1)).Select\nActiveSheet.Paste\n'   Copy PO number\nRange(\"B2\").Select\nSelection.Copy\nRange(\"A12\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(0, 2).Select\nRange(Selection, Selection.End(xlUp).Offset(1)).Select\nActiveSheet.Paste\n'   Copy PO date\nRange(\"B3\").Select\nSelection.Copy\nRange(\"A12\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(0, 3).Select\nRange(Selection, Selection.End(xlUp).Offset(1)).Select\nActiveSheet.Paste\n'   Copy DO date\nRange(\"B4\").Select\nSelection.Copy\nRange(\"A12\").Select\nSelection.End(xlDown).Select\nActiveCell.Offset(0, 4).Select\nRange(Selection, Selection.End(xlUp).Offset(1)).Select\nActiveSheet.Paste\n\n\n\nNext I\nExit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Here is the second vba.</p>\n\n<pre><code>Function LastRow(sh As Worksheet)\nOn Error Resume Next\nLastRow = sh.Cells.Find(What:=\"*\", _\n                        After:=sh.Range(\"A1\"), _\n                        Lookat:=xlPart, _\n                        LookIn:=xlFormulas, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\nOn Error GoTo 0\nEnd Function\n\n\nSub Marco2()\n\nDim sh As Worksheet\nDim DestSh As Worksheet\nDim Last As Long\nDim CopyRng As Range\n\nWith Application\n.ScreenUpdating = False\n.EnableEvents = False\nEnd With\n\n\nApplication.DisplayAlerts = False\nOn Error Resume Next\nActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\nOn Error GoTo 0\nApplication.DisplayAlerts = True\n\nSet DestSh = ActiveWorkbook.Worksheets.Add\nDestSh.Name = \"RDBMergeSheet\"\n\n\nFor Each sh In ActiveWorkbook.Worksheets\nIf sh.Name &lt;&gt; DestSh.Name Then\n\nLast = LastRow(DestSh)\n\n\nSet CopyRng = sh.Range(\"A12\").Offset(1).CurrentRegion\nSet CopyRng = CopyRng.Offset(1, 0)\nSet CopyRng = CopyRng.Resize(CopyRng.Rows.Count - 1)\nCopyRng.Copy\n\n'Test if there enough rows in the DestSh to copy all the data\nIf Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\nMsgBox \"There are not enough rows in the Destsh\"\nGoTo ExitTheSub\nEnd If\n\n\nCopyRng.Copy\nWith DestSh.Cells(Last + 1, \"A\")\n.PasteSpecial xlPasteValues\n.PasteSpecial xlPasteFormats\nApplication.CutCopyMode = False\nEnd With\n\n'Optional: This will copy the sheet name in the H column\nDestSh.Cells(Last + 1, \"H\").Resize(CopyRng.Rows.Count).Value = sh.Name\n\nEnd If\nNext\n\nExitTheSub:\n\nApplication.Goto DestSh.Cells(1)\n\n'AutoFit the column width in the DestSh sheet\nDestSh.Columns.AutoFit\n\nWith Application\n.ScreenUpdating = True\n.EnableEvents = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thank you for your valuable time to read through this.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1519810327, "post_id": 49025841, "comment_id": 85056836, "body": "<code>ThisWorkbook</code> always referes to the <code>Workbook</code> object where code is executed."}, {"owner": {"reputation": 3, "user_id": 9401754, "user_type": "registered", "profile_image": "https://graph.facebook.com/1948080568554026/picture?type=large", "display_name": "Bruce Lee", "link": "https://stackoverflow.com/users/9401754/bruce-lee"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519811132, "post_id": 49025841, "comment_id": 85057345, "body": "@AntiDrondert Yes that worked for me, thank you so much"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1519813099, "post_id": 49025841, "comment_id": 85058652, "body": "Tangentially -- you seldom need to use things like <code>Activate</code> and <code>Select</code> in well-written VBA. You don&#39;t need to activate a workbook to work with it."}], "owner": {"reputation": 3, "user_id": 9401754, "user_type": "registered", "profile_image": "https://graph.facebook.com/1948080568554026/picture?type=large", "display_name": "Bruce Lee", "link": "https://stackoverflow.com/users/9401754/bruce-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519812831, "creation_date": 1519809365, "last_edit_date": 1531164843, "question_id": 49025841, "link": "https://stackoverflow.com/questions/49025841/how-to-activate-the-excel-from-where-i-run-my-vba-but-not-by-windowsfilename-a", "title": "How to activate the excel from where I run my vba but not by Windows(filename).activate", "body": "<p>I have an Excel workbook called <code>Book1</code> with VBA code that opens another workbook and gets data from it to add it to <code>Book1</code>.</p>\n\n<p>In my code it is written that:</p>\n\n<pre><code>Windows(\"Book1.xlsm\").Activate\n</code></pre>\n\n<p>When VBA gets back to the workbook where my code is starting, I want to make a reference to my workbook so that it won't matter whether the workbook will be named <code>Book2</code> or any other name and won't matter where it will be located. How can I do this please?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519808744, "post_id": 49025499, "comment_id": 85055863, "body": "Might sound like a silly request, but what version of Excel are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 9349023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf42568110d17ff12c698bbd3641622?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby Harris", "link": "https://stackoverflow.com/users/9349023/ruby-harris"}, "edited": false, "score": 2, "creation_date": 1519809254, "post_id": 49025557, "comment_id": 85056169, "body": "It worked although I had to also &#39;clear all Trusted documents&#39; in Trust Center settings."}, {"owner": {"reputation": 362, "user_id": 8524164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab00e77dd48c6a8b73686b9842d29039?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Ampilogov", "link": "https://stackoverflow.com/users/8524164/andrey-ampilogov"}, "reply_to_user": {"reputation": 67, "user_id": 9349023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf42568110d17ff12c698bbd3641622?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby Harris", "link": "https://stackoverflow.com/users/9349023/ruby-harris"}, "edited": false, "score": 0, "creation_date": 1519809668, "post_id": 49025557, "comment_id": 85056417, "body": "Thank you for sharing it!"}], "tags": [], "owner": {"reputation": 362, "user_id": 8524164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab00e77dd48c6a8b73686b9842d29039?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Ampilogov", "link": "https://stackoverflow.com/users/8524164/andrey-ampilogov"}, "is_accepted": true, "score": 2, "last_activity_date": 1519808460, "creation_date": 1519808460, "answer_id": 49025557, "question_id": 49025499, "link": "https://stackoverflow.com/questions/49025499/how-to-open-a-file-with-application-close/49025557#49025557", "title": "How to open a file with Application.Close?", "body": "<p>Simply disable macros in Excel, open the file and erase the line :)</p>\n\n<p>More information on disabling macros:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6</a></p>\n"}], "owner": {"reputation": 67, "user_id": 9349023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf42568110d17ff12c698bbd3641622?s=128&d=identicon&r=PG&f=1", "display_name": "Ruby Harris", "link": "https://stackoverflow.com/users/9349023/ruby-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 1, "accepted_answer_id": 49025557, "answer_count": 1, "score": 1, "last_activity_date": 1519808460, "creation_date": 1519808247, "question_id": 49025499, "link": "https://stackoverflow.com/questions/49025499/how-to-open-a-file-with-application-close", "title": "How to open a file with Application.Close?", "body": "<p>I stupidly put <code>Application.Close</code> to run when WB is opening and now I can't get to my own file and code. What do I do?</p>\n\n<p>Macro in <em>ThisWorkbook</em>:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519807563, "post_id": 49025188, "comment_id": 85055210, "body": "is Personal.xlsb  the name of a workbook that you want to run the code above in? And on which line does the error occur?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519808908, "post_id": 49025617, "comment_id": 85055955, "body": "That was what I was thinking!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519809351, "post_id": 49025617, "comment_id": 85056225, "body": "Didn&#39;t think he&#39;d want it in the Personal workbook as that&#39;s usually hidden.  Handy place to keep code and lookup lists for personal use only though."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519809608, "post_id": 49025617, "comment_id": 85056380, "body": "I don&#39;t know why I haven&#39;t yet explored doing that. I am still with the dinosaurs and &quot;GoTo&quot;"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519811379, "post_id": 49025617, "comment_id": 85057504, "body": "Think the last time I used &quot;GoTo&quot; was Sinclair Basic back in the 80&#39;s :D"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1519808644, "creation_date": 1519808644, "answer_id": 49025617, "question_id": 49025188, "link": "https://stackoverflow.com/questions/49025188/excel-vba-creating-pivot-table-from-personal-xlsb/49025617#49025617", "title": "Excel VBA. Creating Pivot Table from Personal.xlsb", "body": "<p><code>Thisworkbook</code> always references the workbook holding the code - in this case your Personal workbook.  Instead you probably want to reference the <code>Activeworkbook</code>.</p>\n\n<p>In the code below I've set a reference to the ActiveWorkbook just after variable declaration. The PivotCache, PivotTable and any formula all reference the ActiveWorkbook.  </p>\n\n<pre><code>Sub Test()\n\n    Dim wrkBk As Workbook\n    Dim wrkSht As Worksheet\n    Dim wrkSht2 As Worksheet\n    Dim pc As PivotCache\n    Dim pt As PivotTable\n\n    Set wrkBk = ActiveWorkbook\n\n    Set wrkSht = wrkBk.Worksheets(\"Sheet1\")\n\n    Set pc = wrkBk.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=wrkSht.Range(\"A1\").CurrentRegion.Address, _\n    Version:=xlPivotTableVersion15)\n\n    Debug.Print wrkBk.PivotCaches.Count\n\n    Set wrkSht2 = wrkBk.Worksheets.Add\n    wrkSht2.Name = \"PivotTable\"\n\n    Set pt = pc.CreatePivotTable( _\n        TableDestination:=wrkSht2.Range(\"A3\"), _\n        TableName:=\"ReportPivot\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 8499182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xmP0UFJkpeE/AAAAAAAAAAI/AAAAAAAAAAs/GkZSQVzBo00/photo.jpg?sz=128", "display_name": "AmirA", "link": "https://stackoverflow.com/users/8499182/amira"}, "is_accepted": false, "score": 0, "last_activity_date": 1519815497, "creation_date": 1519815497, "answer_id": 49027934, "question_id": 49025188, "link": "https://stackoverflow.com/questions/49025188/excel-vba-creating-pivot-table-from-personal-xlsb/49027934#49027934", "title": "Excel VBA. Creating Pivot Table from Personal.xlsb", "body": "<p>Thanks. This code worked out. \n- I replaced ThisWorkbook with ActiveWorkbook\n- I replaced Sheet1.Name with ActiveSheet.Name\n- I replaced Sheet1.Range with ActiveSheet.Range</p>\n\n<p>'\n    Worksheets(\"Sheet1\").Activate</p>\n\n<pre><code>Set pc = ActiveWorkbook.PivotCaches.Create( _\nSourceType:=xlDatabase, _\nSourceData:=ActiveSheet.Name &amp; \"!\" &amp; \nActiveSheet.Range(\"A1\").CurrentRegion.Address, _\nVersion:=xlPivotTableVersion15)\n\nDebug.Print ActiveWorkbook.PivotCaches.Count\n\nWorksheets.Add\nActiveSheet.Name = \"PivotTable\"\nRange(\"A3\").Select\n\nSet pt = pc.CreatePivotTable( _\n    TableDestination:=ActiveCell, _\n    TableName:=\"ReportPivot\")'\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8499182, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xmP0UFJkpeE/AAAAAAAAAAI/AAAAAAAAAAs/GkZSQVzBo00/photo.jpg?sz=128", "display_name": "AmirA", "link": "https://stackoverflow.com/users/8499182/amira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 49025617, "answer_count": 2, "score": 0, "last_activity_date": 1519815497, "creation_date": 1519807024, "last_edit_date": 1519807828, "question_id": 49025188, "link": "https://stackoverflow.com/questions/49025188/excel-vba-creating-pivot-table-from-personal-xlsb", "title": "Excel VBA. Creating Pivot Table from Personal.xlsb", "body": "<p>Code works perfectly fine, when module is imported directly to the workbook. \nTrying to launch VBA code from Personal.xlsb - gives an error. </p>\n\n<blockquote>\n  <p>Run-time error '5'<br>\n  Invalid procedure call or argument.)</p>\n</blockquote>\n\n<p><code>Debug.Print ThisWorkbook.PivotCaches.Count</code> gives zero, meaning there is no data in the cache. </p>\n\n<p>Need help in defining data source from <code>personal.xlsb</code></p>\n\n<pre><code>Worksheets(\"Sheet1\").Activate\n\nSet pc = ThisWorkbook.PivotCaches.Create( _\nSourceType:=xlDatabase, _\nSourceData:=Sheet1.Name &amp; \"!\" &amp; Sheet1.Range(\"A1\").CurrentRegion.Address, _\nVersion:=xlPivotTableVersion15)\n\nDebug.Print ThisWorkbook.PivotCaches.Count\n\nWorksheets.Add\nActiveSheet.Name = \"PivotTable\"\nRange(\"A3\").Select\n\nSet pt = pc.CreatePivotTable( _\n    TableDestination:=ActiveCell, _\n    TableName:=\"ReportPivot\")'\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts", "excel-charts"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1519807644, "post_id": 49025072, "comment_id": 85055246, "body": "Write a macro that hides the source table rows where y = 0 then these will disappear from the chart."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9358182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a0f7703f8ada5ba9ac7783c603710?s=128&d=identicon&r=PG&f=1", "display_name": "Anson Tang", "link": "https://stackoverflow.com/users/9358182/anson-tang"}, "edited": false, "score": 0, "creation_date": 1519810345, "post_id": 49025650, "comment_id": 85056853, "body": "I cannot do this because I have to keep the data format and I can only change the graph. Anyway, thanks for your help."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 9358182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a0f7703f8ada5ba9ac7783c603710?s=128&d=identicon&r=PG&f=1", "display_name": "Anson Tang", "link": "https://stackoverflow.com/users/9358182/anson-tang"}, "edited": false, "score": 0, "creation_date": 1519830834, "post_id": 49025650, "comment_id": 85070204, "body": "You can actually have the chart plotted off a duplicate table in a hidden sheet so the visible table has all the data shown."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 9358182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a0f7703f8ada5ba9ac7783c603710?s=128&d=identicon&r=PG&f=1", "display_name": "Anson Tang", "link": "https://stackoverflow.com/users/9358182/anson-tang"}, "edited": false, "score": 0, "creation_date": 1519835957, "post_id": 49025650, "comment_id": 85073590, "body": "I have given an alternative solution."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1519835942, "last_edit_date": 1519835942, "creation_date": 1519808737, "answer_id": 49025650, "question_id": 49025072, "link": "https://stackoverflow.com/questions/49025072/questions-about-hiding-the-zero-value-in-the-chart/49025650#49025650", "title": "Questions about hiding the zero value in the chart", "body": "<p>So if you hide rows in the source data where Y = 0 then these points will not be plotted on the chart.</p>\n\n<p>This is easy if your data is set-up as an Excel table and you use the macro-recorder whilst performing the filter. This would give you starting code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JffKl.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JffKl.gif\" alt=\"Creating chart and filtering whilst using macro recorder\"></a></p>\n\n<p>Then will a little research into:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-autofilter-method-excel\" rel=\"nofollow noreferrer\">Autofilter</a>  </p>\n\n<p>and</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/listobject-object-excel\" rel=\"nofollow noreferrer\">ListObject</a></p>\n\n<p>You could have tweaked the code and had something like:</p>\n\n<pre><code>Option Explicit\n\nSub HideCharts()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim targetTable As ListObject\n\n    Set wb = ThisWorkbook\n    Set wsData = wb.Worksheets(\"Sheet1\")\n    Set targetTable = wsData.ListObjects(\"Table1\")\n\n    'Check that there are other values apart from 0 so don't try to filter to nothing\n    If Application.WorksheetFunction.CountIf(targetTable.DataBodyRange.Columns(2), \"&gt;\" &amp; 0) &gt; 0 Then ' DataBodyRange.Columns(2) = y column\n\n        With targetTable.Range\n\n           .AutoFilter Field:=2 'remove filter\n           .AutoFilter Field:=2, Criteria1:=\"&lt;&gt;0\", Operator:=xlFilterValues\n\n        End With\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>Version 2 Plotting chart series to ignore zeroes (needs some refining).</strong></p>\n\n<p>Existing chart and then adding series to it (X and Y) using data from sheet.</p>\n\n<p>Load sheet data into array, loop and concatenate non zero values. Split these strings to create arrays using a function by <a href=\"https://stackoverflow.com/questions/27313524/split-cell-value-into-numeric-array\">@Aiken</a>, which I have adapted, to ensure that the arrays plotted as series sources are integer, rather than text. Using <code>Split$</code> returns strings which won't plot in the desired way. With more time I would further adapt this to use Long to avoid overflow. If of use, I will do this. For now, this illustrates the principle you are after, I believe.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddSeriesWithoutZero()\n\n    Dim myChart As Chart\n\n    Set myChart = ActiveSheet.ChartObjects(\"Chart 1\").Chart\n\n    Dim sourceData()\n\n    sourceData = ActiveSheet.Range(\"A2:B5\").Value\n\n    Dim currRow As Long\n    Dim textStringY As String\n    Dim textStringX As String\n\n    For currRow = LBound(sourceData, 1) To UBound(sourceData, 1)\n\n        If Not sourceData(currRow, 2) = 0 Then\n\n            textStringY = textStringY &amp; CStr(sourceData(currRow, 2)) &amp; \";\"\n            textStringX = textStringX &amp; CStr(sourceData(currRow, 1)) &amp; \";\"\n\n        End If\n\n    Next currRow\n\n    Dim arrayY() As Integer\n    arrayY = SplitIntegers(textStringY, \";\")\n\n    Dim arrayX() As Integer\n    arrayX = SplitIntegers(textStringX, \";\")\n\n\n    With myChart.SeriesCollection.NewSeries\n             .XValues = arrayX  'xaxis\n             .Values = arrayY  'yaxis\n    End With\n\nEnd Sub\n\nPublic Function SplitIntegers(ByVal StringToSplit As String, ByVal Sep As String) As Variant\n\n    Dim arrStrings() As String\n    Dim arrIntegers() As Integer\n    Dim i As Long\n\n    On Error GoTo Err_SplitIntegers\n    arrStrings = Split$(StringToSplit, Sep)\n    ReDim arrIntegers(LBound(arrStrings) To UBound(arrStrings) - 1)\n\n    For i = LBound(arrStrings) To UBound(arrStrings) - 1 \n        arrIntegers(i) = CInt(arrStrings(i))\n    Next i\n\n    SplitIntegers = arrIntegers\n    Exit Function\n\nErr_SplitIntegers:\n    Select Case Err.Number\n        Case 13 'Type Mismatch Error: StringToSplit contains non-numeric substrings\n            On Error GoTo 0\n            Err.Raise 9114, \"SplitIntegers\", _\n                      \"SplitIntegers failed: substring '\" &amp; arrStrings(i) &amp; \"' of string '\" &amp; StringToSplit &amp; \"' is not numeric\"\n        Case Else 'Unhandled error, return to calling code\n            Dim iErrNum As Integer, strErrDesc As String\n            iErrNum = Err.Number\n            strErrDesc = Err.Description\n            On Error GoTo 0\n            Err.Raise iErrNum, \"SplitIntegers\", strErrDesc\n    End Select\nEnd Function\n</code></pre>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zvZgK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zvZgK.png\" alt=\"Chart in sheet\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 9358182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25a0f7703f8ada5ba9ac7783c603710?s=128&d=identicon&r=PG&f=1", "display_name": "Anson Tang", "link": "https://stackoverflow.com/users/9358182/anson-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519835942, "creation_date": 1519806619, "last_edit_date": 1519808116, "question_id": 49025072, "link": "https://stackoverflow.com/questions/49025072/questions-about-hiding-the-zero-value-in-the-chart", "title": "Questions about hiding the zero value in the chart", "body": "<p>This time I write my macro. But it still did not work. I would like to design a macro that can detect any zero value(in y-axis) in the graph and then hide the correlated x-axis point. Here is the Macro.</p>\n\n<pre><code>Sub Delete0()\n\n    ActiveSheet.ChartObjects(\"YYY\").Activate\n    For x = 1 To ActiveChart.SeriesCollection(1).Points.Count\n        If ActiveChart.FullSeriesCollection(1).Points(x).DataLabels.Count = 0 Then\n            ActiveChart.ChartGroups(1).FullCategoryCollection(x).IsFiltered = True\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "edited": false, "score": 0, "creation_date": 1519816500, "post_id": 49026194, "comment_id": 85060697, "body": "Thank you very much for your analysis and code! You were absolutly right And I now I got the code to run!"}, {"owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "edited": false, "score": 0, "creation_date": 1519816660, "post_id": 49026194, "comment_id": 85060795, "body": "Since I read that the Sendkeys method should be avoided in general and I am eager to always imorove my skills I was wondering if there was a solution without using the sendkeys method."}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "reply_to_user": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "edited": false, "score": 0, "creation_date": 1519819102, "post_id": 49026194, "comment_id": 85062228, "body": "In this instance, sendkeys is not too much of an issue, as the focus is already on the input text box but it still can glitch. If you where to use sendkeys as keyboard navigation through a page, then it would be less reliable. There are also issues when using IE7 (who uses that now a days anyway) and also can be slow in some other versions of IE. To help anyone else viewing this question looking for a similar answer, then you can accept it as answered, this does not have to be my answer but any answer you think is the best solution for you."}], "tags": [], "owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "is_accepted": true, "score": 1, "last_activity_date": 1519811323, "last_edit_date": 1519811323, "creation_date": 1519810516, "answer_id": 49026194, "question_id": 49024926, "link": "https://stackoverflow.com/questions/49024926/excel-vba-text-entered-in-searchbox-doesnt-cause-page-to-show-results-search/49026194#49026194", "title": "Excel VBA - Text entered in searchbox doesn&#39;t cause page to show results (Search without Submit button)", "body": "<p>Looking at the  way the search for this web page works, is that it requires one letter at a time to complete the search.</p>\n\n<p>You can set the focus to the 'input' tag name and then use send keys to complete the search:</p>\n\n<pre><code>objIE.document.getElementsByTagName(\"input\")(0).Focus\nApplication.SendKeys \"s\"\nApplication.SendKeys \"e\"\nApplication.SendKeys \"a\"\nApplication.SendKeys \"r\"\nApplication.SendKeys \"c\"\nApplication.SendKeys \"h\"\n</code></pre>\n\n<p>Now you know how it works, you can use this code so that it will work with the keyword value:</p>\n\n<pre><code>objIE.document.getElementsByTagName(\"input\")(0).Focus\nDim i As Integer\nDim EachLetter As Variant\n     EachLetter = Split(Keyword, \" \")\nFor i = 0 To UBound(EachLetter)\n    Application.SendKeys EachLetter(i)\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "edited": false, "score": 0, "creation_date": 1519816654, "post_id": 49026314, "comment_id": 85060791, "body": "Since I read that the Sendkeys method should be avoided in general and I am eager to always imorove my skills I was wondering if there was a solution without using the sendkeys method."}], "tags": [], "owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "is_accepted": false, "score": 0, "last_activity_date": 1519810853, "creation_date": 1519810853, "answer_id": 49026314, "question_id": 49024926, "link": "https://stackoverflow.com/questions/49024926/excel-vba-text-entered-in-searchbox-doesnt-cause-page-to-show-results-search/49026314#49026314", "title": "Excel VBA - Text entered in searchbox doesn&#39;t cause page to show results (Search without Submit button)", "body": "<p>To trigger the <code>fireEvent</code> on the field, you have to type your string (you've already figured that out). Before you type, set the focus to the field:</p>\n\n<pre><code>objIE.document.getElementsByTagName(\"input\")(0).Focus\n</code></pre>\n\n<p>I would add a click in there as well just to be safe</p>\n\n<pre><code>objIE.document.getElementsByTagName(\"input\")(0).Click\n</code></pre>\n\n<p>Now all you have to do is send the keys:</p>\n\n<pre><code>Dim sMyString As String: sMyString = \"#mystring\"\nDim iC As Integer\nFor iC = 1 To Len(sMyString)\n    Application.SendKeys Mid(sMyString, iC, 1)\nNext\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 9422626, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Websitewichtel", "link": "https://stackoverflow.com/users/9422626/websitewichtel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 1, "accepted_answer_id": 49026194, "answer_count": 2, "score": 2, "last_activity_date": 1519811323, "creation_date": 1519806057, "last_edit_date": 1519806751, "question_id": 49024926, "link": "https://stackoverflow.com/questions/49024926/excel-vba-text-entered-in-searchbox-doesnt-cause-page-to-show-results-search", "title": "Excel VBA - Text entered in searchbox doesn&#39;t cause page to show results (Search without Submit button)", "body": "<p>I am quite new to coding and have the following issue:\nI want to write a macro, that goes to the website: <a href=\"https://displaypurposes.com/\" rel=\"nofollow noreferrer\">https://displaypurposes.com/</a>\ninserts a keyword and copy the results into my excel sheet.</p>\n\n<p>This is how my code looks at the moment:</p>\n\n<pre><code>Sub DisplayPurposes()\n\n\nDim objIE As InternetExplorer\nDim aEle As HTMLLinkElement\nDim Url As String\nDim Keyword As String\n\nUrl = \"https://displaypurposes.com/\"\nKeyword = \"skiing\"\n\n'initiating a new instance of Internet Explorer and assigning it to objIE\nSet objIE = New InternetExplorer\n\n'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate (Url)\n\n'Wait for IE to load page\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n'BOTH OF THESE INSERT THE KEYWORD\n'Insert Version 01\nobjIE.document.getElementsByTagName(\"input\")(0).innerText = \"Keyword\"\n'Insert Version\nobjIE.document.getElementsByTagName(\"input\")(0).Value = \"Keyword\"\n\n'NOW I DON'T KNOW HOW TO MAKE THE PAGE UPDATE ITSELF\n\nEnd Sub\n</code></pre>\n\n<p>I figured out that I might be able to solve the problem with .fireEvent(), Sendkeys or the solution posted by <a href=\"https://stackoverflow.com/questions/35246876/text-entered-into-webpage-search-box-via-excel-vba-is-not-detected-when-clicking/35248485#35248485\">dyanisis2</a></p>\n\n<pre><code>Set evt = objIE.Document.createEvent(\"keyboardevent\")\n    evt.initEvent \"change\", True, False\n    PW.all(0).dispatchEvent evt\n</code></pre>\n\n<p>However, I didn't manage to make the page show the searchresults for the keyword so I could scrape them. Since I am quite new to the community I hope I posted everything according to the guidelines and answered everything you need to know!  </p>\n"}, {"tags": ["sql", "vba", "ms-access", "iif"], "comments": [{"owner": {"reputation": 13129, "user_id": 1587819, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TpBdj.jpg?s=128&g=1", "display_name": "HoneyBadger", "link": "https://stackoverflow.com/users/1587819/honeybadger"}, "edited": false, "score": 0, "creation_date": 1519805240, "post_id": 49024452, "comment_id": 85053963, "body": "Why is <code>Gender</code> a string if it only contains integers?"}, {"owner": {"reputation": 189, "user_id": 6898455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AJBRO.jpg?s=128&g=1", "display_name": "Salam.MSaif", "link": "https://stackoverflow.com/users/6898455/salam-msaif"}, "reply_to_user": {"reputation": 13129, "user_id": 1587819, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TpBdj.jpg?s=128&g=1", "display_name": "HoneyBadger", "link": "https://stackoverflow.com/users/1587819/honeybadger"}, "edited": false, "score": 0, "creation_date": 1519807858, "post_id": 49024452, "comment_id": 85055380, "body": "I think vba tries to compare literally like this &quot;Gender&quot; = 0, which is always false, and thus my Gender field all returns 2, does that make sense?"}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 6898455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AJBRO.jpg?s=128&g=1", "display_name": "Salam.MSaif", "link": "https://stackoverflow.com/users/6898455/salam-msaif"}, "edited": false, "score": 0, "creation_date": 1519808055, "post_id": 49024975, "comment_id": 85055486, "body": "I tried this, and I got an error saying &#39;Circular reference caused by alias &#39;Gender&#39; in query definition&#39;s SELECT list. (Error 3103)&#39;"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 189, "user_id": 6898455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AJBRO.jpg?s=128&g=1", "display_name": "Salam.MSaif", "link": "https://stackoverflow.com/users/6898455/salam-msaif"}, "edited": false, "score": 0, "creation_date": 1519808095, "post_id": 49024975, "comment_id": 85055510, "body": "change alias to Gen or something."}, {"owner": {"reputation": 189, "user_id": 6898455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AJBRO.jpg?s=128&g=1", "display_name": "Salam.MSaif", "link": "https://stackoverflow.com/users/6898455/salam-msaif"}, "edited": false, "score": 0, "creation_date": 1519808799, "post_id": 49024975, "comment_id": 85055896, "body": "Oh my god, so simple. This worked. One advice I can give to myself and all the non-native speaker, read the error message, dont discard it...It seems like by making the IIF a string, VBA register it into its sql conditional object."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1519806232, "creation_date": 1519806232, "answer_id": 49024975, "question_id": 49024452, "link": "https://stackoverflow.com/questions/49024452/dynamically-change-sql-statement-with-iif/49024975#49024975", "title": "Dynamically change SQL statement with IIF", "body": "<p>I think you have omitted two quotation marks. The line after if in object loop should be:</p>\n\n<pre><code>sql = sql &amp; \" IIf([Gender] = 0, 1, 2) \" &amp; \" AS Gender, \"\n</code></pre>\n\n<p>now sql variable is </p>\n\n<pre><code>SELECT [Name],  IIf([Gender] = 0, 1, 2)  AS Gender, [Age] FROM T_Customer \n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 6898455, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AJBRO.jpg?s=128&g=1", "display_name": "Salam.MSaif", "link": "https://stackoverflow.com/users/6898455/salam-msaif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 49024975, "answer_count": 1, "score": 0, "last_activity_date": 1519893041, "creation_date": 1519804268, "last_edit_date": 1519893041, "question_id": 49024452, "link": "https://stackoverflow.com/questions/49024452/dynamically-change-sql-statement-with-iif", "title": "Dynamically change SQL statement with IIF", "body": "<p>Very simple question but kept me stuck for hours now.</p>\n\n<p>I want to change the 'Gender' field to like this\nIf Gender is 0, then 1\nIf Gender is 1, then 2</p>\n\n<p>This is my code:</p>\n\n<pre><code>Private Sub Run_Click()\n    Dim db As DAO.Database\n    Dim queryDef As DAO.queryDef\n    Dim sql As String\n    Dim fields As Variant\n\n    Set db = CurrentDb\n    sql = \"\"\n\n    fields = Array(\"Name\", \"Gender\", \"Age\")\n\n    For Each queryDef In db.QueryDefs\n        If queryDef.Name = \"Q_List\" Then\n            db.QueryDefs.Delete \"Q_List\"\n            Exit For\n        End If\n    Next\n\n    sql = sql &amp; \"SELECT \"\n    For Each field In fields\n        If field = \"Gender\" Then\n            sql = sql &amp; IIf([Gender] = 0, 1, 2) &amp; \" AS Gender, \"\n        Else\n            sql = sql &amp; \"[\" &amp; field &amp; \"]\" &amp; \", \"\n        End If\n    Next\n    sql = Left(sql, Len(sql) - 2)\n    sql = sql &amp; \" FROM T_Customer\"\n    Set queryDef = db.CreateQueryDef(\"Q_List\", sql)\n\n    DoCmd.TransferText acExportDelim, , \"Q_List\", \"C:\\customerdata\\data.txt\", True, , 65001\n\n    MsgBox \"Done!\"\n\nEnd Sub\n</code></pre>\n\n<p>The problem is, the IIF does not apply to all the rows of data but it literally compare if Gender which is a string equals to 0 integer, and all my Gender rows becomes 2...\nSql generated is as follow:</p>\n\n<pre><code>SELECT T_Customer.[Name], 2 AS Gender, T_Customer.[Age] FROM T_Customer\n</code></pre>\n\n<p>Need Help Please</p>\n\n<blockquote>\n  <p><strong>SOLVED!!!</strong></p>\n</blockquote>\n\n<p>By writing IIF in sql statement IN STRING, and to use the same field name, write as so:\n    IIf([tablemame].[Gender] = 0, 1, 2) &amp; \" AS Gender, \"</p>\n"}, {"tags": ["excel", "vba", "macos", "declaration", "libc"], "answers": [{"tags": [], "owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "is_accepted": true, "score": 0, "last_activity_date": 1520317828, "last_edit_date": 1520317828, "creation_date": 1520317415, "answer_id": 49124566, "question_id": 49024241, "link": "https://stackoverflow.com/questions/49024241/vba-trouble-with-strerror-strncpy-on-osx/49124566#49124566", "title": "VBA trouble with strerror / strncpy on OSX", "body": "<p>This declaration is wrong for the way it is used:</p>\n\n<pre><code>Public Declare Function osx_strncpy Lib \"libc.dylib\" Alias \"strncpy\" _\n    (ByVal strDestination As String, ByVal strSource As String, destlen As Long) As Long\n</code></pre>\n\n<p>\"strSource\" is declared as a ByVal String.  That means that a pointer to a null terminated string will be passed to the libc function (good).  But it also means that the <em>VBA code will be accepting and requiring a BSTR parameter</em> (bad).</p>\n\n<p>Where the function is called:</p>\n\n<pre><code>lngptr2 = osx_strncpy(ErrorText, longpointer, nLen)\n</code></pre>\n\n<p>... the longpointer value is first implicitly converted to a BSTR. Then the value of that bSTR (the <sub> address of the null terminated string containing a </sub> textual representation of the pointer value) is passed to the libc function.</p>\n\n<p>So strncpy is copying from a local temporary memory area to the destination, not copying from the error string to the destination.  Why this causes Excel to crash is unknown: in the same situation, strlcpy doesn't crash. But that's not important: even if did work, it's not what was wanted.</p>\n\n<p>Note that the declaration isn't \"wrong\", it would work correctly for</p>\n\n<pre><code>text1 = \"A\"\ntext2 = String(2,chr(0))\nosx_strncpy(text2, text1, Len(text1))\n</code></pre>\n\n<p>--  it's just not what is wanted. The requirement is for a function that accepts a pointer value:</p>\n\n<pre><code>Public Declare Function osx_strncpy_lp Lib \"libc.dylib\" Alias \"strncpy\" _\n    (ByVal strDestination As String, ByVal strSource_lp As Long, destlen As Long) As Long\n</code></pre>\n\n<p><sub> And you could even make the original declaration work, by declaring a string object, then overwriting it's internal value with the pointer value you want to use.  But if you did that, you could just use a VBA assignment statement to copy the kludged string object</sub></p>\n"}], "owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 49124566, "answer_count": 1, "score": 1, "last_activity_date": 1593645030, "creation_date": 1519803461, "last_edit_date": 1593645030, "question_id": 49024241, "link": "https://stackoverflow.com/questions/49024241/vba-trouble-with-strerror-strncpy-on-osx", "title": "VBA trouble with strerror / strncpy on OSX", "body": "<p>My Excel spreadsheet is locking up everytime I use this code. Normally that means a declaration or call error of some sort, (an error of ignorance) but I haven't identified it yet.</p>\n\n<p>This example VBA function SystemErrorText is supposed to return the text of the system error message for errno 2: file not found. It doesn't: it never returns from the call to strncpy</p>\n\n<pre><code>'char *strerror(int errnum);\nPublic Declare Function osx_strErrorlp Lib \"libc.dylib\" Alias \"strerror\" _\n    (ByVal errnum As Long) As Long\n\n'char *strncpy(char * restrict dst, const char * restrict src, size_t len);\nPublic Declare Function osx_strncpy Lib \"libc.dylib\" Alias \"strncpy\" _\n    (ByVal strDestination As String, ByVal strSource As String, destlen As Long) As Long\n\nPublic Function SystemErrorText() As String\nDim ErrorText As String\nDim nLen As Long\nDim longpointer As Long\nDim lngptr2 As Long\n\nlongpointer = osx_strErrorlp(2)\nErrorText = String(256, Chr(0))\nnLen = 255\nlngptr2 = osx_strncpy(ErrorText, longpointer, nLen)\nSystemErrorText = ErrorText\n\nEnd Function\n</code></pre>\n\n<p>Can anyone see what I've done wrong? I'm getting a pointer from strerror, which I assume is correct (perhaps the error is there?), but I'm not sure if that matters: I'm only trying to copy some bytes from that location.</p>\n\n<p>I can't guarantee that the c declarations I've included as comments are valid for OS X: I've been given them, but I don't have a source that guarantees they are valid for OS X.  I'm using a 32 bit version of Excel for Mac: pointers are 32 bit, as are longs. Unlike the Windows version of Excel, the Mac version does not protect against stack errors on calls to library functions: it just crashes. And for some reason, err.LastDLLerror isn't connected to errno (not that it matters for this example).</p>\n"}, {"tags": ["excel", "ms-office", "vba"], "comments": [{"owner": {"reputation": 8605, "user_id": 814050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5108da17d6cb05e7ea1ef3f73211a2a7?s=128&d=identicon&r=PG", "display_name": "Husein Roncevic", "link": "https://stackoverflow.com/users/814050/husein-roncevic"}, "edited": false, "score": 3, "creation_date": 1519802803, "post_id": 49024066, "comment_id": 85052800, "body": "So... What have you tried so far?"}, {"owner": {"reputation": 25, "user_id": 9422511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T2JwmdPz4g4/AAAAAAAAAAI/AAAAAAAAABg/aW4xAGGlGl4/photo.jpg?sz=128", "display_name": "Madhurjya Sharma", "link": "https://stackoverflow.com/users/9422511/madhurjya-sharma"}, "reply_to_user": {"reputation": 8605, "user_id": 814050, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5108da17d6cb05e7ea1ef3f73211a2a7?s=128&d=identicon&r=PG", "display_name": "Husein Roncevic", "link": "https://stackoverflow.com/users/814050/husein-roncevic"}, "edited": false, "score": 0, "creation_date": 1519802937, "post_id": 49024066, "comment_id": 85052880, "body": "Thanks for the response. I am confused how to start. I know basics of excel only."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519803351, "post_id": 49024066, "comment_id": 85053056, "body": "Do you need multiple receipts in one document or separate document for each customer? The latter is easier as you can use Word Document Template. Start with creating a template, add bookmarks where information will be added. Form an array with information of paid customers, loop through it and create a Word Document for each customer, modifying bookmarks&#39; text with relevant customer data."}, {"owner": {"reputation": 25, "user_id": 9422511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T2JwmdPz4g4/AAAAAAAAAAI/AAAAAAAAABg/aW4xAGGlGl4/photo.jpg?sz=128", "display_name": "Madhurjya Sharma", "link": "https://stackoverflow.com/users/9422511/madhurjya-sharma"}, "edited": false, "score": 0, "creation_date": 1519803568, "post_id": 49024066, "comment_id": 85053163, "body": "I need in one document as I want to save pages. The receipt in very small."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1519803853, "post_id": 49024066, "comment_id": 85053308, "body": "How much receipts will Document hold?"}, {"owner": {"reputation": 25, "user_id": 9422511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T2JwmdPz4g4/AAAAAAAAAAI/AAAAAAAAABg/aW4xAGGlGl4/photo.jpg?sz=128", "display_name": "Madhurjya Sharma", "link": "https://stackoverflow.com/users/9422511/madhurjya-sharma"}, "edited": false, "score": 0, "creation_date": 1519804092, "post_id": 49024066, "comment_id": 85053395, "body": "Maybe 8-10 as it fits."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1519878528, "creation_date": 1519878528, "answer_id": 49042639, "question_id": 49024066, "link": "https://stackoverflow.com/questions/49024066/how-can-i-create-an-excel-macro-that-puts-data-from-specific-rows-into-a-word-fi/49042639#49042639", "title": "How can I create an excel macro that puts data from specific rows into a word file?", "body": "<p>You can use this method to do that.</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\n'On Error Resume Next\n\nobjWord.ActiveDocument.variables(\"BrokerFirstName\").Value = Range(\"BrokerFirstName\").Value\nobjWord.ActiveDocument.variables(\"BrokerLastName\").Value = Range(\"BrokerLastName\").Value\n\n\nobjWord.ActiveDocument.Fields.Update\n\n'On Error Resume Next\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>Add two DocVariables to Word, and run the Macro from Excel, not Word.  If you don't know what a DocVariable is, Google it...</p>\n"}], "owner": {"reputation": 25, "user_id": 9422511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T2JwmdPz4g4/AAAAAAAAAAI/AAAAAAAAABg/aW4xAGGlGl4/photo.jpg?sz=128", "display_name": "Madhurjya Sharma", "link": "https://stackoverflow.com/users/9422511/madhurjya-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1519878528, "creation_date": 1519802754, "last_edit_date": 1531161705, "question_id": 49024066, "link": "https://stackoverflow.com/questions/49024066/how-can-i-create-an-excel-macro-that-puts-data-from-specific-rows-into-a-word-fi", "title": "How can I create an excel macro that puts data from specific rows into a word file?", "body": "<p>I have an Excel sheet with monthly fees of hostel, the columns are name, date, month for which paid, amount, status, and some remarks. </p>\n\n<p>I have to provide receipt to each who paid. So how can I automate the task of who paid to provide them a receipt? </p>\n\n<p>Lets say 10 guys I marked paid, then I need to run some macro which will generate receipts for each of them, preferably in a single Word file. Eg: <code>{name} has paid {amount} for the month of {month} {year} Signature.jpg</code></p>\n\n<p>Later I can print the document and cut them and provide to whoever paid.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519801126, "post_id": 49023482, "comment_id": 85052000, "body": "What do you need to do with them after they&#39;re selected? Copy?"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1519803713, "creation_date": 1519803713, "answer_id": 49024309, "question_id": 49023482, "link": "https://stackoverflow.com/questions/49023482/dynamically-select-number-of-filtered-rows-in-current-column-in-excel/49024309#49024309", "title": "Dynamically Select Number of Filtered Rows In Current Column in Excel", "body": "<p>The following are just examples (no ready to use copy-paste-solution), but they should give you the right hint to solve your issue:</p>\n\n<p>To select only visible cells of a specific range you can use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel\" rel=\"nofollow noreferrer\"><code>Range.SpecialCells</code> method</a>.</p>\n\n<ul>\n<li><p>The following selects only the visible cells out of range \"A1:A200\"</p>\n\n<pre><code>Range(\"A1:A200\").SpecialCells(xlCellTypeVisible).Select\n</code></pre></li>\n<li><p>To e.g. select all visible entire rows of the active column you could use something like</p>\n\n<pre><code>ActiveCell.EntireColumn.SpecialCells(xlCellTypeVisible).EntireRow.Select\n</code></pre></li>\n<li><p>or to select only rows that are visible and also have a constant value you can combine them like</p>\n\n<pre><code>ActiveCell.EntireColumn.SpecialCells(xlCellTypeConstants).SpecialCells(xlCellTypeVisible).EntireRow.Select\n</code></pre></li>\n</ul>\n\n<p>Read the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel\" rel=\"nofollow noreferrer\">documentation</a> for further options of <code>SpecialCells</code>.</p>\n\n<hr>\n\n<p><em>Note that I recommend not to use <code>.Select</code> at all if you want to do any further actions beside selecting. I recommend to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> for a good practice and better, faster more reliable code.</em></p>\n"}], "owner": {"reputation": 1, "user_id": 9422270, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/9422270/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519803713, "creation_date": 1519800357, "last_edit_date": 1531161705, "question_id": 49023482, "link": "https://stackoverflow.com/questions/49023482/dynamically-select-number-of-filtered-rows-in-current-column-in-excel", "title": "Dynamically Select Number of Filtered Rows In Current Column in Excel", "body": "<p>Is there a way (maybe a VBA) in Excel to select a set number of filtered rows based upon the current column? Current work flows regularly require us to select 25 or 100 filtered rows of the active column at a time. </p>\n\n<p>Most macros I've come across during research appear to </p>\n\n<ol>\n<li>Select all data in a table or column</li>\n<li>Involve a pre-defined column. </li>\n</ol>\n\n<p>I initially thought this would be a strait-forward macro to develop but have had difficulty. The code I found during research moves down a set number of rows but does not appear to factor in filtered rows when counting. </p>\n\n<pre><code>Sub MoveOneCellDownAFilteredList()\n    ActiveCell.Select\n    Range(Selection, Selection.Offset(2, 0)).Select\n    Do Until ActiveCell.EntireRow.Hidden = False\n        ActiveCell.Offset(2, 0).Select\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["excel", "hyperlink", "summarization", "vba"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1519808549, "post_id": 49024618, "comment_id": 85055776, "body": "Thank you for the reply and solution suggestion, I&#39;ve got about 43 workbooks I need to add, and more will be added, however the workbooks will always be in this folder."}, {"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1519809899, "post_id": 49024618, "comment_id": 85056545, "body": "I&#39;ve added the code as I believe it is supposed to, however it still doesn&#39;t create links between the two workbooks. Am I misunderstanding, how this works or have I used your suggested codesnippet wrongly?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 1, "creation_date": 1519813553, "post_id": 49024618, "comment_id": 85058945, "body": "@FoolzRailer Oh my snippet is 2 lines you did it in one line that is something completely different. You cannot strip out line breaks where you want to. That changes the logic of the code completely."}, {"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1519886438, "post_id": 49024618, "comment_id": 85092742, "body": "Lesson 101 in coding VBA just learned, appreciated that :) Changed it to the above, but when I run it now, it opens the first workbook which it is supposed to copy from and the first cell in the code (C14) is marked, but it just stops there."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 1, "creation_date": 1519888500, "post_id": 49024618, "comment_id": 85093540, "body": "@FoolzRailer &quot;<i>just stops there</i>&quot; with which error message? Code never just stops without an error message unless you are in step-by-step mode."}, {"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1519900059, "post_id": 49024618, "comment_id": 85099478, "body": "There is no error message popping up, it just opens up the first workbook, copies the cell and pauses with that workbook open and cell copied. Is there anyway I give you more information from when the code is running?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1519903364, "post_id": 49024618, "comment_id": 85101367, "body": "Ok obviously there is an error, and because of <code>On Error GoTo errHandler</code> it jumps to <code>errHandler</code> but there you just end without validating which error occurred, so it keeps silent and you are blind. So either rise the error again at the <code>errHandler</code> section with eg <code>Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext</code> or give at least a custom message like <code>MsgBox &quot;Import canceled due to Error: &quot; &amp; Err.Description, vbCritical, &quot;Error &quot; &amp; Err.Number, Err.HelpFile, Err.HelpContext</code> If you use error handling always make sure you give a message, or you are blind."}, {"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1520321006, "post_id": 49024618, "comment_id": 85255445, "body": "Well right you are Peh, I removed the error handler, and when I run the code I get a Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method. When I hit debug it refers to the line:  <code>.Range(&quot;A&quot; &amp; rowTarget).Paste Link:=True</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 1, "creation_date": 1520321557, "post_id": 49024618, "comment_id": 85255703, "body": "I didn&#39;t expect that, as that&#39;s very odd but for pasting links the target range needs to be selected first (probably you need to activate the sheet too after line <code>With wsTarget</code> insert one <code>.Activate</code>) and then we have to use <code>ActiveSheet.Paste Link:=True</code>. It looks like links cannot be pasted on a direct reference. See my updated answer."}, {"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1520328042, "post_id": 49024618, "comment_id": 85259043, "body": "This works, though occasionally it says it doesn&#39;t have a link to paste, even though it has marked a cell. Would it work putting in a small pause between copy-paste bit? Or would that be a terrible idea? I&#39;m thinking it can&#39;t open the excel-workbooks fast enough perhaps?"}, {"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1520329054, "post_id": 49024618, "comment_id": 85259671, "body": "Forgot the error code. Run-time error &#39;1004&#39;: No link to paste: When I debug it selects different lines <code>wsSource.Range(&quot;I11&quot;).Copy</code> and <code>wsSource.Range(&quot;I10&quot;).Copy</code> . Which is why i propose the pause. I&#39;ve also changed rowtarget I think I did it correctly so it now takes the first empty cell. Is there any way to check for duplicates as I&#39;ve added in my question as well?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1520332407, "post_id": 49024618, "comment_id": 85261818, "body": "The error 1004 means that it lost the copy mode, why ever. Are there any selection change events in <code>wsTarget</code> that might kill the copy mode? Checking duplicates is not possible with paste link. If you want to do that you need to write your own paste link and cannot use the one of Excel (this would be a completely other question)."}, {"owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 0, "creation_date": 1520333747, "post_id": 49024618, "comment_id": 85262617, "body": "Doesn&#39;t appear so, the source workbook is opened and the cell is copied. It works for the first 5-6 workbooks (varies) and stopswith the I11 or I10 cell bit. It seems random which of the workbooks it stops at. Have I put in the <code>.activate</code> correctly?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "edited": false, "score": 1, "creation_date": 1520342839, "post_id": 49024618, "comment_id": 85268559, "body": "yes code looks ok for me. But just in case your sheet looses activation try what I showed in my edit (activate before every select, remove activesheet and reorder). This could help to stabilize it."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1520342766, "last_edit_date": 1520342766, "creation_date": 1519804900, "answer_id": 49024618, "question_id": 49023435, "link": "https://stackoverflow.com/questions/49023435/copy-data-from-all-workbooks-in-a-folder-to-a-summary-list-with-links-to-the-dat/49024618#49024618", "title": "Copy data from all workbooks in a folder to a summary list with links to the data", "body": "<p>You could copy the source range and then use <em>Special Paste \u203a Paste Link</em> in the destination workbook. It pastes a formula linking to the source workbooks copied range.<br>\n<a href=\"http://youtube.com/watch?v=_YgCJb2FF-4\" rel=\"nofollow noreferrer\">This short YouTube video</a> should illustrate it best.</p>\n\n<p>You could also do that with VBA if necessary e.g:</p>\n\n<pre><code>wsSource.Range(\"C14\").Copy\n.Range(\"A\" &amp; rowTarget).Select\nActiveSheet.Paste Link:=True\n</code></pre>\n\n<p>It seems like we need to <code>.Select</code> first and use <code>ActiveSheet.Paste</code> otherwise the link pasting fails, even if that looks like a bad practice, but the below direct referencing the range won't work!</p>\n\n<pre><code>wsSource.Range(\"C14\").Copy\n.Range(\"A\" &amp; rowTarget).Paste Link:=True 'fails with error 438\n</code></pre>\n\n<p>But because you are linking the values now with a formula you probably need to do that only once and therefore don't need the VBA solution anymore, because it is easier to do it <strong>once</strong> by hand.</p>\n\n<p><strong>Note:</strong><br>\nbe aware that these workbooks are linked by a formula then. If you move the source workbook into another location the link will break (if the destination workbook is not within the same location and copied as well). This comes with all the downsides of linked workbooks.</p>\n\n<hr>\n\n<p>//edit</p>\n\n<pre><code>With wsTarget\n    .Activate\n    .Range(\"A\" &amp; rowTarget).Select\n    wsSource.Range(\"C14\").Copy \n    .Paste Link:=True\n    .Activate\n    .Range(\"B\" &amp; rowTarget).Select\n    wsSource.Range(\"C15\").Copy        \n    .Paste Link:=True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1519878799, "creation_date": 1519878799, "answer_id": 49042674, "question_id": 49023435, "link": "https://stackoverflow.com/questions/49023435/copy-data-from-all-workbooks-in-a-folder-to-a-summary-list-with-links-to-the-dat/49042674#49042674", "title": "Copy data from all workbooks in a folder to a summary list with links to the data", "body": "<p>Try this AddIn.  It will do exactly what you want.</p>\n\n<p><a href=\"https://i.stack.imgur.com/P3hUs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P3hUs.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://www.rondebruin.nl/win/addins/rdbmerge.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/addins/rdbmerge.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "is_accepted": false, "score": 0, "last_activity_date": 1520866423, "creation_date": 1520866423, "answer_id": 49238206, "question_id": 49023435, "link": "https://stackoverflow.com/questions/49023435/copy-data-from-all-workbooks-in-a-folder-to-a-summary-list-with-links-to-the-dat/49238206#49238206", "title": "Copy data from all workbooks in a folder to a summary list with links to the data", "body": "<p>Alternative solution to the one suggested by Peh, both work, though the one below is not as flexible but hardcoded instead. Thought I would share. </p>\n\n<pre><code>Option Explicit\n\n\nConst FOLDER_PATH = \"Folderpath\\\"  'REMEMBER END BACKSLASH\n\nSub ImportWorksheets()\n   '=============================================\n   'Process all Excel files in specified folder\n   '=============================================\n   Dim sFile As String           'file to process\n   Dim wsTarget As Worksheet\n   Dim wbSource As Workbook\n   Dim wsSource As Worksheet\n   Dim rowTarget As Long         'output row\n\n   rowTarget = Sheets(\"Status\").Cells(Rows.Count, \"AK\").End(xlUp).Row + 1\n\n   'check the folder exists\n   If Not FileFolderExists(FOLDER_PATH) Then\n      MsgBox \"Specified folder does not exist, exiting!\"\n      Exit Sub\n   End If\n\n   'reset application settings in event of error\n   'On Error GoTo errHandler\n   'Application.ScreenUpdating = False\n\n   'set up the target worksheet\n   Set wsTarget = Sheets(\"Status\")\n\n   'loop through the Excel files in the folder\n   sFile = Dir(FOLDER_PATH &amp; \"*.xls*\")\n   Do Until sFile = \"\"\n\n      'import the data\n      With wsTarget\n\n         'optional source filename in the last column\n         .Range(\"AK\" &amp; rowTarget).Value = sFile\n         .Range(\"A\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$C$14\"\n         .Range(\"B\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$C$15\"\n         .Range(\"C\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$C$13\"\n         .Range(\"J\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$I$11\"\n         .Range(\"K\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$I$10\"\n         .Range(\"L\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$C$40\"\n         .Range(\"M\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$E$40\"\n         .Range(\"H\" &amp; rowTarget).Value = \"=\" &amp; \"'\" &amp; FOLDER_PATH &amp; \"[\" &amp; .Range(\"AK\" &amp; rowTarget).Value &amp; \"]\" &amp; \"Side 1-Forside\" &amp; \"'\" &amp; \"!$I$9\"\n\n      End With\n\n      'close the source workbook, increment the output row and get the next file\n      rowTarget = rowTarget + 1\n      sFile = Dir()\n   Loop\n\n'errHandler:\n   'On Error Resume Next\n   'Application.ScreenUpdating = True\n\n   'tidy up\n   Set wsSource = Nothing\n   Set wbSource = Nothing\n   Set wsTarget = Nothing\nEnd Sub\n\n\nPrivate Function FileFolderExists(strPath As String) As Boolean\n    If Not Dir(strPath, vbDirectory) = vbNullString Then FileFolderExists = True\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4648996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1622a53e00c95bbc524eb86e41d6b4af?s=128&d=identicon&r=PG&f=1", "display_name": "FoolzRailer", "link": "https://stackoverflow.com/users/4648996/foolzrailer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 49024618, "answer_count": 3, "score": 0, "last_activity_date": 1520866423, "creation_date": 1519800153, "last_edit_date": 1531164843, "question_id": 49023435, "link": "https://stackoverflow.com/questions/49023435/copy-data-from-all-workbooks-in-a-folder-to-a-summary-list-with-links-to-the-dat", "title": "Copy data from all workbooks in a folder to a summary list with links to the data", "body": "<p>I'm trying to copy a lot of workbooks into a summary workbook, I've gotten the below code to do the job so far. </p>\n\n<pre><code>Option Explicit\n\n\nConst FOLDER_PATH = \"Folderpath\\\"  'REMEMBER END BACKSLASH\n\nSub ImportWorksheets()\n   '=============================================\n   'Process all Excel files in specified folder\n   '=============================================\n   Dim sFile As String           'file to process\n   Dim wsTarget As Worksheet\n   Dim wbSource As Workbook\n   Dim wsSource As Worksheet\n   Dim rowTarget As Long         'output row\n\n   rowTarget = Sheets(\"Status\").Cells(Rows.Count, \"AK\").End(xlUp).Row + 1\n\n   'check the folder exists\n   If Not FileFolderExists(FOLDER_PATH) Then\n      MsgBox \"Specified folder does not exist, exiting!\"\n      Exit Sub\n   End If\n\n   'reset application settings in event of error\n   'On Error GoTo errHandler\n   'Application.ScreenUpdating = False\n\n   'set up the target worksheet\n   Set wsTarget = Sheets(\"Status\")\n\n   'loop through the Excel files in the folder\n   sFile = Dir(FOLDER_PATH &amp; \"*.xls*\")\n   Do Until sFile = \"\"\n\n      'open the source file and set the source worksheet - ASSUMED WORKSHEET(1)\n      Set wbSource = Workbooks.Open(FOLDER_PATH &amp; sFile)\n      Set wsSource = wbSource.Worksheets(\"Side 1-Forside\") 'EDIT IF NECESSARY\n\n      'import the data\n      With wsTarget\n         .Activate\n         wsSource.Range(\"C14\").Copy\n         .Range(\"A\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         wsSource.Range(\"C15\").Copy\n         .Range(\"B\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         wsSource.Range(\"C13\").Copy\n         .Range(\"C\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         wsSource.Range(\"I11\").Copy\n         .Range(\"J\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         wsSource.Range(\"I10\").Copy\n         .Range(\"K\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         wsSource.Range(\"C40\").Copy\n         .Range(\"L\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         wsSource.Range(\"E40\").Copy\n         .Range(\"M\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         wsSource.Range(\"I9\").Copy\n         .Range(\"H\" &amp; rowTarget).Select\n         ActiveSheet.Paste Link:=True\n         'optional source filename in the last column\n\n            .Range(\"AK\" &amp; rowTarget).Value = sFile\n      End With\n\n      'close the source workbook, increment the output row and get the next file\n      wbSource.Close SaveChanges:=False\n      rowTarget = rowTarget + 1\n      sFile = Dir()\n   Loop\n\n'errHandler:\n   'On Error Resume Next\n   'Application.ScreenUpdating = True\n\n   'tidy up\n   Set wsSource = Nothing\n   Set wbSource = Nothing\n   Set wsTarget = Nothing\nEnd Sub\n\n\nPrivate Function FileFolderExists(strPath As String) As Boolean\n    If Not Dir(strPath, vbDirectory) = vbNullString Then FileFolderExists = True\nEnd Function\n</code></pre>\n\n<p>However is it possible to  grab the data as a link instead of a \"dead\" value? So if it gets changed in one of the many workbooks, I just have to refresh the summary workbook? </p>\n\n<p>Bonusquestion: Is it possible to check for duplicates in this bit: <code>.Range(\"AK\" &amp; rowTarget).Value = sFile</code> and only add if the values isn't there already and the new values should add from the last empty row below row 5?</p>\n"}, {"tags": ["vba", "canvas", "ms-word", "shapes"], "owner": {"reputation": 11, "user_id": 2445710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2f61bc26e7d10a8b63cc4488fc795bb?s=128&d=identicon&r=PG", "display_name": "user2445710", "link": "https://stackoverflow.com/users/2445710/user2445710"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519800130, "creation_date": 1519800130, "question_id": 49023428, "link": "https://stackoverflow.com/questions/49023428/change-location-of-a-shape-inside-canvas-in-word-2013-using-vba", "title": "Change location of a shape inside canvas in word 2013 using VBA", "body": "<p>I have a shape (rectangle) created inside a canvas in Microsoft word 2013, with Left:=100\nBut when I read the left property of the shape, I get a number different from the one I have set in creation phase!</p>\n\n<pre><code>Sub DRTEXT()\n  Dim shp1 As Shape, shpCanvas As Shape\nSet shpCanvas = ActiveDocument.Shapes.AddCanvas(Left:=0, Top:=0, Width:=400, Height:=400)\nSet shp1 = shpCanvas.CanvasItems.AddShape(Type:=msoShapeRectangle, _\n        Left:=100, Top:=100, Width:=100, Height:=100)\n\n\n      MsgBox shp1.Left '(shows the number 5!)\n      shp1.Left = 200\n      MsgBox shp1.Left\nEnd Sub\n</code></pre>\n\n<p>I feel this might be of the shape being inside a canvas which wont let me to move the shape as I want.\nAny clues?\nMany thanks</p>\n"}, {"tags": ["c#", "sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 6088, "user_id": 1270725, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dcd587470f1896d43243bd0856ecd06d?s=128&d=identicon&r=PG", "display_name": "mcalex", "link": "https://stackoverflow.com/users/1270725/mcalex"}, "edited": false, "score": 0, "creation_date": 1519798561, "post_id": 49022649, "comment_id": 85050973, "body": "Maybe try &#39;\\r\\n&#39;."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519800107, "post_id": 49022649, "comment_id": 85051546, "body": "Characters used to indicate a newline typcally vary between operating systems: on Windows it usually carriage return + line feed.   <a href=\"https://en.wikipedia.org/wiki/Newline\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Newline</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6292069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8540dcffb7ff293a6c2f3176625a624?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Ohrenberg", "link": "https://stackoverflow.com/users/6292069/samuel-ohrenberg"}, "edited": false, "score": 0, "creation_date": 1520987732, "post_id": 49025865, "comment_id": 85539481, "body": "This did it! Thanks for your help"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 0, "last_activity_date": 1519809835, "last_edit_date": 1519809835, "creation_date": 1519809433, "answer_id": 49025865, "question_id": 49022649, "link": "https://stackoverflow.com/questions/49022649/line-breaks-not-found-when-opening-file-in-access-vba/49025865#49025865", "title": "Line Breaks Not Found when Opening File in Access VBA", "body": "<h2>Newline Control Characters:</h2>\n\n<ul>\n<li><p><code>\\n</code> = <strong>\"Line Feed\"</strong> (LF) = ASCII Code <code>10</code> = VBA Constant: <code>vbLf</code></p></li>\n<li><p><code>\\r</code> = <strong>\"Carriage Return\"</strong> (CR) = ASCII Code <code>13</code> = VBA Constant: <code>vbCr</code></p></li>\n</ul>\n\n<p><em>or, Windows prefers a combination of both:</em></p>\n\n<ul>\n<li><code>\\r\\n</code> = <strong>\"CR + LF\"</strong> = ASCII Codes <code>13</code> + <code>10</code> = VBA Constant: <strong><code>vbCrLf</code></strong></li>\n</ul>\n\n<hr>\n\n<p>Since you have existing <code>LF</code>'s, there are a number of simple ways to change them to <code>CRLF</code>'s.  I can't think of any way that the additional character would be a problem.</p>\n\n<p>The best plan would be to change the source application that's creating the files, so use both characters instead of one.</p>\n\n<p>If your main concern is the data that you're importing with VBA, you could make a small change to your code, to replace the characters:</p>\n\n<pre><code>Open csvLoc For Input As #1\nDo While Not EOF(1)\n    Line Input #1, csvLine\n    csvLine = Replace(csvLine, vbLf, vbCrLf)\n    Debug.Print csvLine\n    lineArray = Split(csvLine, \",\")\n    &lt;-- Code handling the now split line array --&gt;\nLoop\nClose #1\n</code></pre>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>Wikipedia : <strong><a href=\"https://en.wikipedia.org/wiki/Newline#Representations_in_different_character_encoding_specifications\" rel=\"nofollow noreferrer\">Newline representations in different character encoding specifications</a></strong></p></li>\n<li><p>MSDN : <strong><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/replace-function\" rel=\"nofollow noreferrer\">Replace Function (VBA)</a></strong></p></li>\n<li><p>MSDN : <strong><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/miscellaneous-constants\" rel=\"nofollow noreferrer\">Miscellaneous Constants</a></strong></p></li>\n<li><p>Stack Overflow : <strong><a href=\"https://stackoverflow.com/q/1552749/8112776\">Difference between CR LF, LF and CR line break types?</a></strong></p></li>\n<li><p>Wikipedia : <strong><a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">ASCII</a></strong></p></li>\n<li><p><a href=\"https://en.wikipedia.org/wiki/Newline#History\" rel=\"nofollow noreferrer\">History of the Newline Character</a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1520552051, "creation_date": 1520552051, "answer_id": 49184278, "question_id": 49022649, "link": "https://stackoverflow.com/questions/49022649/line-breaks-not-found-when-opening-file-in-access-vba/49184278#49184278", "title": "Line Breaks Not Found when Opening File in Access VBA", "body": "<p>You do not mention having an Access link to the CSV file.</p>\n\n<p>If Access' built in import recognizes the line breaks natively - then relying on a linked method would be easier than a vba based import.</p>\n"}], "owner": {"reputation": 51, "user_id": 6292069, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8540dcffb7ff293a6c2f3176625a624?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Ohrenberg", "link": "https://stackoverflow.com/users/6292069/samuel-ohrenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 49025865, "answer_count": 2, "score": 1, "last_activity_date": 1593955797, "creation_date": 1519796431, "last_edit_date": 1593955797, "question_id": 49022649, "link": "https://stackoverflow.com/questions/49022649/line-breaks-not-found-when-opening-file-in-access-vba", "title": "Line Breaks Not Found when Opening File in Access VBA", "body": "<p>I have a program that writes to a text file with the \"\\n\" character. I have it write this to a .csv file so that I can then take that information and import it into an Access database. The issue that I am running into is that Microsoft Access VBA and Notepad are not recognizing the line breaks within the file. Wordpad, Access's built in Import, and Excel <strong>DO</strong> recognize the line breaks. If I open the .csv file in Excel or WordPad, make no changes, and save the file as a .csv file again, then it will show up right.</p>\n\n<p><a href=\"https://i.stack.imgur.com/asFd8.png\" rel=\"nofollow noreferrer\">The file opened in Notepad</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/4Vhxy.png\" rel=\"nofollow noreferrer\">The file opened in Excel</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Fs4l9.png\" rel=\"nofollow noreferrer\">The file importing in Access</a></p>\n\n<p>I have a VBA script to import the data from the file, since data is repeatedly added to a master sheet. I want it to take each line from a .csv file and either insert it as a new row if the ID isn't already present OR update the existing row if there is one. This is tested and working for file where they are blatantly on different rows (showing in notepad as different rows), but it is just the files generated by my program (using \\n as new line).</p>\n\n<p>The other program is built in C# ... So, i guess my question is: is there is a better line break character or sequence to use in C# to make it more universally recognized when a line break is present?</p>\n\n<p>For posterity, here is the code that my VBA script is using that is reading the file as one line and missing the line breaks:</p>\n\n<pre><code>'Now read the file\nOpen csvLoc For Input As #1\nDo While Not EOF(1)\n    Line Input #1, csvLine\n    Debug.Print csvLine\n    lineArray = Split(csvLine, \",\")\n    &lt;-- Code handling the now split line array --&gt;\nLoop\nClose #1\n</code></pre>\n"}, {"tags": ["html", "vba", "outlook", "hyperlink"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519791845, "post_id": 49021467, "comment_id": 85048978, "body": "You can use VBA within outlook to do this, but a question like this is too broad for SO.  Try something out, then post back with code if you run into problems."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1519794894, "post_id": 49021467, "comment_id": 85049813, "body": "You can create a Sub in a normal module, to initiate when an Outlook rule for certain conditions are met. In that Sub, process the mail body for the link(s). Depends on where it links to, you may need different approaches for each site. The requirement is that you need to keep the Outlook running."}, {"owner": {"reputation": 49, "user_id": 8754722, "user_type": "registered", "profile_image": "https://graph.facebook.com/894402230714636/picture?type=large", "display_name": "Janet  Zheng", "link": "https://stackoverflow.com/users/8754722/janet-zheng"}, "edited": false, "score": 0, "creation_date": 1519807543, "post_id": 49021467, "comment_id": 85055198, "body": "Do you know how to search for key words in the email body by VBA"}, {"owner": {"reputation": 49, "user_id": 8754722, "user_type": "registered", "profile_image": "https://graph.facebook.com/894402230714636/picture?type=large", "display_name": "Janet  Zheng", "link": "https://stackoverflow.com/users/8754722/janet-zheng"}, "edited": false, "score": 0, "creation_date": 1519816756, "post_id": 49021467, "comment_id": 85060860, "body": "OK. Search for key word, this problem is solved. Current problem is about how to find a hyperlink in the emai."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519822916, "post_id": 49021467, "comment_id": 85064676, "body": "To use Word from other applications you have to either set a reference to Word or use late binding. <a href=\"https://stackoverflow.com/a/24263432\">stackoverflow.com/a/24263432</a>"}, {"owner": {"reputation": 49, "user_id": 8754722, "user_type": "registered", "profile_image": "https://graph.facebook.com/894402230714636/picture?type=large", "display_name": "Janet  Zheng", "link": "https://stackoverflow.com/users/8754722/janet-zheng"}, "edited": false, "score": 0, "creation_date": 1519830787, "post_id": 49021467, "comment_id": 85070169, "body": "Thank you!! I will try this. Do you know how to search a key word and only open the hyperlink after the key word? What method I can use to achieve this."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1519866982, "post_id": 49021467, "comment_id": 85087663, "body": "Can you show example of the hyperlink ?"}, {"owner": {"reputation": 49, "user_id": 8754722, "user_type": "registered", "profile_image": "https://graph.facebook.com/894402230714636/picture?type=large", "display_name": "Janet  Zheng", "link": "https://stackoverflow.com/users/8754722/janet-zheng"}, "edited": false, "score": 0, "creation_date": 1519871738, "post_id": 49021467, "comment_id": 85088768, "body": "I have updated the email example. Please see the question description"}], "owner": {"reputation": 49, "user_id": 8754722, "user_type": "registered", "profile_image": "https://graph.facebook.com/894402230714636/picture?type=large", "display_name": "Janet  Zheng", "link": "https://stackoverflow.com/users/8754722/janet-zheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 590, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1593041479, "creation_date": 1519788186, "last_edit_date": 1593041479, "question_id": 49021467, "link": "https://stackoverflow.com/questions/49021467/how-to-download-pdf-from-a-hyperlink-requiring-login-information-in-outlook-by-v", "title": "How to download pdf from a hyperlink requiring login information in outlook by VBA", "body": "<p>I use outlook to receive my emails(cannot change this...), I want to find a way in windows to automatically process one kind of my emails which have download links. </p>\n\n<p>I want to find a way to selectively download files from the emails with key words.</p>\n\n<p>The procedures I can think of to achieve this is:</p>\n\n<ol>\n<li>search my emails with key words </li>\n<li>find the hyperlink in the emails with the key words</li>\n<li>download the files and save them in a folder.</li>\n</ol>\n\n<p>My current code is :</p>\n\n<pre><code>Sub Search_Inbox()\n\nDim olFolder As Outlook.Folder\nDim myitems As Outlook.Items\n\nDim bodyString As String\nDim bodyStringLines\nDim splitLine\n\nDim hyperlink As String\nDim i As Integer\nDim found As Integer  \n\nSet olFolder = Application.GetNamespace(\"MAPI\").Folders(\"lll@163.com\").Folders(\"Inbox\").Folders(\"abc\")\nSet myitems = olFolder.Items\n\ni = 0\nfound = 0\n\n'find the hyperlink in the emails\"\nFor Each myitem In myitems\n    If InStr(1, myitem.Body, \"passed\", vbTextCompare) &gt; 0 Then            \n        If InStr(1, myitem.Body, \"tested\", vbTextCompare) &gt; 0 Then\n        'inside the target email, search for the key word\n        bodyString = myitem.Body\n        bodyStringLines = Split(bodyString, vbCrLf)\n        For Each splitLine In bodyStringLines\n            i = i + 1\n            keyStart = InStr(splitLine, \"keyword\")\n            keyEnd = keyStart + Len(\"keyword\") - 1\n            If found = 0 Then\n                If keyStart &gt; 0 Then\n                    If keyEnd = Len(splitLine) Then\n                        found = 1\n                    End If\n                End If\n            Else\n                hyperlink = splitLine\n                found = 0\n                Exit For\n            End If\n        Next\n        Debug.Print \"hyperlink is\"\n        Debug.Print hyperlink           \n        'DownloadFile1 (hyperlink)\n        'DownloadFile2 (hyperlink)\n        End If\n\n    Else\n        Found = False\n    End If\nNext\n\nSet olFolder = Nothing\nSet myitems = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>But I have a problem at the downloading part. The access to the hyperlink requires filling the login information. I tried the following two methods but failed...</p>\n\n<pre><code>Sub DownloadFile1(myURL As String)\n\n    Dim saveDirectoryPath As String\n\n    '*******************************\n    ' Intitial setup\n    '*******************************\n    saveDirectoryPath = \"C:\\testfile.pdf\" 'where your files will be stored\n    '*******************************\n\n    Dim fileNameArray() As String\n    Dim fileName As String\n    Dim arrayLength As Integer\n    Dim DateString As String\n    DateString = Format(Now, \"yyyy-mm-dd hh-mm-ss\")\n\n    fileNameArray = Split(myURL, \"/\")\n    arrayLength = UBound(fileNameArray)\n    fileName = fileNameArray(arrayLength)\n\n    'Add date to the file incase there are duplicates comment out these lines if you do not want the date added\n    fileName = Replace(fileName, \".pdf\", \"_\" &amp; DateString &amp; \".pdf\")\n    fileName = Replace(fileName, \".PDF\", \"_\" &amp; DateString &amp; \".PDF\")\n\n    Dim WinHttpReq As Object\n    Set WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\n    WinHttpReq.Open \"GET\", myURL, False, \"username\", \"password\"\n    WinHttpReq.Send\n\n    myURL = WinHttpReq.responseBody\n    If WinHttpReq.Status = 200 Then\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.responseBody\n        oStream.SaveToFile saveDirectoryPath &amp; fileName, 2 ' 1 = no overwrite, 2 = overwrite\n        oStream.Close\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I failed (Access is denied) in line :</p>\n\n<pre><code> WinHttpReq.Send\n</code></pre>\n\n<hr>\n\n<p>I also tried the following code.</p>\n\n<pre><code>Sub DownloadFile2(myURL As String)\n\nDim strCookie As String, strResponse As String, _\n  strUrl As String\n  Dim xobj As Object\n  Dim WinHttpReq As Object\n  Set xobj = New WinHttp.WinHttpRequest\n\n  UN = \"username\"\n  PW = \"password\"\n\n  strUrl = \"https://www.jedec.org/user/login\"\n  xobj.Open \"POST\", strUrl, False\n  xobj.SetRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36\"\n  xobj.SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n  xobj.Send \"username=\" &amp; UN &amp; \"&amp;password=\" &amp; PW &amp; \"&amp;login=login\"\n  strResponse = xobj.ResponseText\n\n  strUrl = myURL \n  xobj.Open \"GET\", strUrl, False\n\n  xobj.SetRequestHeader \"Connection\", \"keep-alive\"\n  xobj.SetRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36\"\n  xobj.Send\n\n  strCookie = xobj.GetResponseHeader(\"Set-Cookie\")\n  strResponse = xobj.ResponseBody\n\n If xobj.Status = 200 Then\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write xobj.ResponseBody\n    oStream.SaveToFile \"C:\\testfile.pdf\", 1\n    oStream.Close\nEnd If\nEnd Sub\n</code></pre>\n\n<p>2018/03/01 problem (solved ): User-defined type not defined, at line:</p>\n\n<pre><code>Set xobj = New WinHttp.WinHttpRequest\n</code></pre>\n\n<p>Solved: Here is a trick that you should include the reference of Microsoft WinHTTP Service. </p>\n\n<p>2018/03/02 problem (unsolved): The URL does not use a recognized protocol, at line:\nxobj.Open \"GET\", strUrl, False</p>\n\n<hr>\n\n<h2>Anyone has any ideas about how to fix this?</h2>\n\n<p>reference for extracting information from email body:</p>\n\n<p><a href=\"https://www.datanumen.com/blogs/extract-show-hyperlink-addresses-email-via-outlook-vba/\" rel=\"nofollow noreferrer\">https://www.datanumen.com/blogs/extract-show-hyperlink-addresses-email-via-outlook-vba/</a></p>\n\n<p><a href=\"http://www.vbaexpress.com/forum/showthread.php?49021-Download-File-from-Hyperlink-in-Body-of-Emailhttp://www.vbaexpress.com/forum/showthread.php?49021-Download-File-from-Hyperlink-in-Body-of-Email\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?49021-Download-File-from-Hyperlink-in-Body-of-Emailhttp://www.vbaexpress.com/forum/showthread.php?49021-Download-File-from-Hyperlink-in-Body-of-Email</a></p>\n\n<hr>\n\n<p>reference for downloading file from hyperlink which requires login info. :</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44679448/how-to-download-a-pdf-that-is-in-a-hyperlink-using-vb-in-outlook-2016/44686511#44686511\">How to download a PDF that is in a hyperlink using VB in Outlook 2016</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/22863408/vba-download-file-from-internet-winhttpreq-with-login-not-working\">Vba download file from internet WinHttpReq with login not working</a></p>\n"}, {"tags": ["vba", "excel", "listobject"], "comments": [{"owner": {"reputation": 41, "user_id": 9421694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sean Leisk", "link": "https://stackoverflow.com/users/9421694/sean-leisk"}, "edited": false, "score": 0, "creation_date": 1519787253, "post_id": 49021264, "comment_id": 85047911, "body": "I run the procedure from a form control button if that matters..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519806189, "post_id": 49021264, "comment_id": 85054453, "body": "can you show up in your question what <code>AppendRlLmTbl</code> is?"}, {"owner": {"reputation": 41, "user_id": 9421694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sean Leisk", "link": "https://stackoverflow.com/users/9421694/sean-leisk"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519826728, "post_id": 49021264, "comment_id": 85067299, "body": "It&#39;s a listobject variable, set to a specific table in my workbook  Set AppendRlLmWS = WB.Sheets(&quot;AppendRelLimTbl&quot;)      Set AppendRlLmTbl = AppendRlLmWS.ListObjects(&quot;AppendRlLimTbl&quot;)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519828702, "post_id": 49021264, "comment_id": 85068732, "body": "I don&#39;t see anything wrong here with the <code>.Add</code>. Just to make sure is there any error handling (<code>On Error Resume Next</code>) in that sub? Can you additionally to the existing code in your question add the original complete sub to see if there is something odd before that? Is there a <code>Worksheet_Change</code> event (or any other event) in that particular worksheet that might interfere?"}, {"owner": {"reputation": 41, "user_id": 9421694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sean Leisk", "link": "https://stackoverflow.com/users/9421694/sean-leisk"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519830448, "post_id": 49021264, "comment_id": 85069933, "body": "You asked for it, I&#39;m available for questions checking periodically. I appreciate any insight you can provide"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519830926, "post_id": 49021264, "comment_id": 85070272, "body": "Turning off alerts/screenupdating makes you blind during debugging <code>Application.DisplayAlerts = False</code>. Turn them on and see if that changes anything. Can you also answer the questions about the events (one comment before)? Turn all worksheet protections off before debugging to see if that changes anything (if so we have a protection issue)."}, {"owner": {"reputation": 41, "user_id": 9421694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sean Leisk", "link": "https://stackoverflow.com/users/9421694/sean-leisk"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519834661, "post_id": 49021264, "comment_id": 85072722, "body": "I just tested the sub with the screen updates off no debug was thrown when running the full routine, as well the same issue (no values printed to the table)... as well I have no error handling in the sub at all, but good question"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519889386, "post_id": 49034461, "comment_id": 85093928, "body": "Note, you can accept your own answer as solution after a while."}], "tags": [], "owner": {"reputation": 41, "user_id": 9421694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sean Leisk", "link": "https://stackoverflow.com/users/9421694/sean-leisk"}, "is_accepted": true, "score": 1, "last_activity_date": 1519835938, "creation_date": 1519835938, "answer_id": 49034461, "question_id": 49021264, "link": "https://stackoverflow.com/questions/49021264/listrows-add-doesnt-appear-to-work/49034461#49034461", "title": "ListRows.Add doesn&#39;t appear to work", "body": "<p>I stupidly had an enable background refresh for that specific table. An early call to refresh all data triggered the refresh, code would execute and the refresh would finally complete shortly after the code finished executing... in break mode the refresh would complete prior too. Thanks PEH for helping me look into this.</p>\n"}], "owner": {"reputation": 41, "user_id": 9421694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sean Leisk", "link": "https://stackoverflow.com/users/9421694/sean-leisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 49034461, "answer_count": 1, "score": 3, "last_activity_date": 1519835938, "creation_date": 1519786624, "last_edit_date": 1531164843, "question_id": 49021264, "link": "https://stackoverflow.com/questions/49021264/listrows-add-doesnt-appear-to-work", "title": "ListRows.Add doesn&#39;t appear to work", "body": "<p>I've got a really odd case\u2026 hopefully someone is able to help me out, I've search many forums looking for a solution, the closest I could find related to it (kinda) is <a href=\"https://stackoverflow.com/questions/3167893/excel-vba-listrows-add-fails\">here</a>, though I've tried all the suggestions to no avail\u2026</p>\n\n<p>I'm trying to run a function to return a data list in a string delimitated by a semicolon from an oracle stored function. (This value function call seems to work fine).<br>\nI then loop through the string for each data value and print it to a blank table (0 rows) declared in my subroutine. which I use to load into an access data base. (just trust it make sense in the big picture\u2026). </p>\n\n<p>The issue, fundamentally is that no information is printed into the table. However when I step through the code it works fine. </p>\n\n<p>After troubleshooting I THINK (see my test scenarios below code) the issue comes up after the <code>listrows.add</code> line... though not obviously.\nI don't think this line is executed by the time the first value is trying to print to the table. </p>\n\n<p>The most confusing part is I'm running through 2 nearly identical procedures (call function -> Return value -> print values to table) immediately before this portion of the code and they work without fail.</p>\n\n<p>Code Excerpt:</p>\n\n<pre><code>'run function to get string ... this works\nDoEvents ' not in original design\nRelRtnStr = Prnt(Cat, \"A Third Oracle Function Name\")\nDoEvents ' not in original design\nRelChopVar = RelRtnStr\n\nStrFldCnt = 0\nChecking = True ''' CodeBreak Test 1\n\nDoEvents ' not in original design\nAppendRlLmTbl.ListRows.Add ''''''''This isn't appearing to work...\nDoEvents ' not in original design\nDebug.Print Now ' not in original design\nApplication.Wait (Now + TimeValue(\"0:00:3\")) ' not in original design\nDebug.Print Now ' not in original design\nWhile StrFldCnt &lt; 80 And (Len(RelChopVar) - Len(Replace(RelChopVar, \";\", \"\"))) &gt; 0 And Checking\n'## Count String Position\n    StrFldCnt = StrFldCnt + 1\n'## Find Current String Value &amp; Remainder String\n    If InStr(RelChopVar, \";\") &lt;&gt; 0 Then\n    'Multiple Values Left\n        FldVal = Replace(Left(RelChopVar, InStr(RelChopVar, \";\")), \";\", \"\")\n        RelChopVar = Right(RelChopVar, Len(RelChopVar) - InStr(RelChopVar, \";\"))\n    Else\n    'Last Value\n        FldVal = RelChopVar\n        Checking = False\n    End If\n'## Get Field Name For Current Value &amp; Print to Table\n    FldNm = CStr(RefRtrn(2, CStr(StrFldCnt))) ''' CodeBreak Test 2\n    AppendRlLmTbl.ListColumns(FldNm).DataBodyRange.Value = FldVal  '''CodeBreak 2 error thrown\n    Debug.Print StrFldCnt &amp; FldNm &amp; FldVal\nWend\nAppendRlLmTbl.ListColumns(\"Catalogue\").DataBodyRange.Value = Cat\n</code></pre>\n\n<p>So far I've tested a ton of options suggested online, not necessarily understanding each test... This is what I've gleaned.</p>\n\n<ol>\n<li><p>If I step through the code, it works</p></li>\n<li><p>If I set a breakpoint at \"CodeBreak Test 1\" and \"F5\" the rest, it works \u2026</p></li>\n<li><p>If I set a breakpoint at \"CodeBreak Test 2\" I get an \"<em>Object with variable not set</em>\" error thrown \u2026 </p></li>\n</ol>\n\n<p>Things I've tried \u2026</p>\n\n<ol>\n<li><p>Wrapping anything and everything with <code>DoEvents</code></p></li>\n<li><p>setting a wait time after the <code>listObjects.add</code> row</p></li>\n<li><p>Validated the code performs the While loop when running the \"full procured\" (as opposed to stepping through)</p></li>\n</ol>\n\n<p>The worst part, I have no idea why the object won't declare properly when setting a break point after the add row line but sets properly when break point is set before and has no error thrown when running the full procedure (I have no on error declarations.)... </p>\n\n<p>It of course must be related in my mind but I can't find any information online and unfortunately have no formal VBA background and 1 undergrad course as a programming background in general. Aka I'm out of my depth and super frustrated. </p>\n\n<p>PS. first post, so please be nice :p</p>\n\n<p>Full Code Below:</p>\n\n<pre><code> Option Explicit\n '## Here's my attempt to clean up and standardize the flow\n '## Declare my public variables\n ' WorkBook\n Public WB As Workbook\n ' Sheets\n Public Req2ByWS As Worksheet\n Public ReqSpecsWS As Worksheet\n Public ReqInstrcWS As Worksheet\n Public ConfigReqWS As Worksheet\n Public AppendReqWS As Worksheet\n Public AppendRlLmWS As Worksheet\n ' Objects (tables)\n Public ReqConfigTbl As ListObject\n Public SpecConfigTbl As ListObject\n Public CurrRegIDTbl As ListObject\n Public AppendReqTbl As ListObject\n Public AppendRlLmTbl As ListObject\n\n '## ##\n '## Get Data from Tom's Functions ##\n Sub GetSpotBuyData()\n\n '## Preliminary Config ##\n '## Turn OFF Warnings &amp; Screen Updates\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n '## Set global Referances to be used in routine\n    ' WorkBooks\n    Set WB = Workbooks(\"MyWb.xlsm\")\n    ' WorkSheets\n    Set Req2ByWS = WB.Sheets(\"MyWb Pg1\")\n    Set ReqSpecsWS = WB.Sheets(\"MyWb Pg2\")\n    Set ConfigReqWS = WB.Sheets(\"MyWb Pg3\")\n    Set AppendReqWS = WB.Sheets(\"MyWb Pg4\")\n    Set AppendRlLmWS = WB.Sheets(\"MyWb Pg5\")\n    ' Tables\n    Set ReqConfigTbl = ConfigReqWS.ListObjects(\"MyWS Tbl1\")\n    Set SpecConfigTbl = ConfigReqWS.ListObjects(\"MyWS Tbl2\")\n    Set CurrRegIDTbl = ConfigReqWS.ListObjects(\"MyWS Tbl3\")\n    Set AppendReqTbl = AppendReqWS.ListObjects(\"MyWS Tbl4\")\n    Set AppendRlLmTbl = AppendRlLmWS.ListObjects(\"MyWS Tbl5\")\n '## Declare Routine Specefic Variables\n    Dim Doit As Variant\n    Dim Checking As Boolean\n    Dim Cat As String\n    Dim CatRtnStr As String\n    Dim CatChopVar As String\n    Dim SpecRtnStr As String\n    Dim SpecChopVar As String\n    Dim RelRtnStr As String\n    Dim RelChopVar As String\n    Dim FldVal As String\n    Dim FldNm As String\n    Dim StrFldCnt As Integer\n\n '## 1) General Set-Up ##\n '## Unprotect tabs (loop through All Tabs Unprotect)\n    Doit = Protct(False, WB, \"Mypassword\")\n '## Refresh Data\n    Doit = RunUpdateAl(WB)\n\n '## 2) Find the Catalgue we are playing with ##\n '## Grab Catalogue input from ISR\n    If [Catalogue].Value = \"\" Then\n        MsgBox (\"Please Enter a Catalogue\")\n        GoTo ExitSub\n    Else\n        Cat = [Catalogue].Value\n    End If\n\n '## 3) Run Toms Function and print the results to the form &amp; Append Table ##\n '## 3a) Do it for Cat Info Function\n '## Get Cat Info String From Function\n    CatRtnStr = Prnt(Cat, \"An Oracle Functions Name\")\n    CatChopVar = CatRtnStr\n    If CatChopVar = \"No Info\" Then\n        MsgBox (\"No Info Found in Catalogue Data Search.\")\n        GoTo SkipCatInfoPrint\n    End If\n '## Loop Through Data String &amp; Write to Form\n    StrFldCnt = 0\n    Checking = True\n    AppendReqTbl.ListRows.Add\n    While Checking\n    '## Count String Position\n        StrFldCnt = StrFldCnt + 1\n    '## Find Current String Value &amp; Remainder String\n        If InStr(CatChopVar, \";\") &lt;&gt; 0 Then\n        'Multiple Values Left\n            FldVal = Replace(Left(CatChopVar, InStr(CatChopVar, \";\")), \";\", \"\")\n            CatChopVar = Right(CatChopVar, Len(CatChopVar) - InStr(CatChopVar, \";\"))\n        Else\n        'Last Value\n            FldVal = CatChopVar\n            Checking = False\n        End If\n    '## Get Field Name For Current Value &amp; Print to Form\n        FldNm = CStr(RefRtrn(1, CStr(StrFldCnt)))\n        If FldNm &lt;&gt; \"CustomerSpecification\" And FldNm &lt;&gt; \"ShiptoAddress\" Then\n        'Take Value as is\n            Req2ByWS.Range(FldNm).Value = FldVal\n            AppendReqTbl.ListColumns(FldNm).DataBodyRange.Value = FldVal\n        ElseIf FldNm = \"CustomerSpecification\" Then\n        'Replace : with New Line\n            FldVal = Replace(FldVal, \" : \", vbLf)\n            Req2ByWS.Range(FldNm).Value = FldVal\n            AppendReqTbl.ListColumns(FldNm).DataBodyRange.Value = FldVal\n        ElseIf FldNm = \"ShiptoAddress\" Then\n        'Replace - with New Line\n            FldVal = Replace(FldVal, \" - \", vbLf)\n            Req2ByWS.Range(FldNm).Value = FldVal\n            AppendReqTbl.ListColumns(FldNm).DataBodyRange.Value = FldVal\n        End If\n    Wend\n '## 3b) Do it for Spec Function\n SkipCatInfoPrint:\n '## Get Spec Info String From Function\n    SpecRtnStr = Prnt(Cat, \"Another Oracle Functions Name\")\n    SpecChopVar = SpecRtnStr\n    If SpecChopVar = \"No Info\" Then\n        MsgBox (\"No Info Found in  Data Search.\")\n        GoTo SkipSpecInfoPrint\n    End If\n '## Loop Through Data String &amp; Write to Form\n    StrFldCnt = 0\n    Checking = True\n    While StrFldCnt &lt; 80 And (Len(SpecChopVar) - Len(Replace(SpecChopVar, \";\", \"\"))) &gt; 0 And Checking\n    '## Count String Position\n        StrFldCnt = StrFldCnt + 1\n    '## Find Current String Value &amp; Remainder String\n        If InStr(SpecChopVar, \";\") &lt;&gt; 0 Then\n        'Multiple Values Left\n            FldVal = Replace(Left(SpecChopVar, InStr(SpecChopVar, \";\")), \";\", \"\")\n            SpecChopVar = Right(SpecChopVar, Len(SpecChopVar) - InStr(SpecChopVar, \";\"))\n        Else\n        'Last Value\n            FldVal = SpecChopVar\n            Checking = False\n        End If\n    '## Get Field Name For Current Value &amp; Print to Form\n        FldNm = CStr(RefRtrn(2, CStr(StrFldCnt)))\n        ReqSpecsWS.Range(FldNm).Value = FldVal\n        AppendReqTbl.ListColumns(FldNm).DataBodyRange.Value = FldVal\n    Wend\n '## 3c) Do it for Rel Limits Function\n SkipSpecInfoPrint:\n '## Get Rel Limits String From Function\n    RelRtnStr = Prnt(Cat, \"A Third Functions Name\")\n    RelChopVar = RelRtnStr\n    If RelChopVar = \"No Info\" Then\n        MsgBox (\"No Info Found in Data Search.\")\n        GoTo ExitSub\n    End If\n '## Loop Through Data String &amp; Write to Form\n    StrFldCnt = 0\n    Checking = True\n\n    AppendRlLmTbl.ListRows.Add\n    While StrFldCnt &lt; 80 And (Len(RelChopVar) - Len(Replace(RelChopVar, \";\", \"\"))) &gt; 0 And Checking\n    '## Count String Position\n        StrFldCnt = StrFldCnt + 1\n    '## Find Current String Value &amp; Remainder String\n        If InStr(RelChopVar, \";\") &lt;&gt; 0 Then\n        'Multiple Values Left\n            FldVal = Replace(Left(RelChopVar, InStr(RelChopVar, \";\")), \";\", \"\")\n            RelChopVar = Right(RelChopVar, Len(RelChopVar) - InStr(RelChopVar, \";\"))\n        Else\n        'Last Value\n            FldVal = RelChopVar\n            Checking = False\n        End If\n    '## Get Field Name For Current Value &amp; Print to Form\n        FldNm = CStr(RefRtrn(2, CStr(StrFldCnt)))\n        AppendRlLmTbl.ListColumns(FldNm).DataBodyRange.Value = FldVal\n    Wend\n    AppendRlLmTbl.ListColumns(\"SpecificFieldName\").DataBodyRange.Value = Cat\n '## 4) Re-Format and Clean Up Program ##\n ExitSub:\n '## Clean-Up Formatting\n    Req2ByWS.Range(\"F:F\", \"C:C\").ColumnWidth = 30\n    Req2ByWS.UsedRange.Rows.AutoFit\n    Req2ByWS.UsedRange.Columns.AutoFit\n    Req2ByWS.Range(\"G:G\").ColumnWidth = 15\n    Req2ByWS.Range(\"J:R\").ColumnWidth = 12\n    Req2ByWS.Range(\"D:D\").ColumnWidth = 12\n '## Protect tabs (loop through All Tabs Protect)\n    'Doit = Protct(True, WB, \"Mypassword\", Req2ByWS.Name)\n    'Req2ByWS.Unprotect (\"Mypassword\")\n    'Application.Wait (Now + TimeValue(\"0:00:10\"))\n    Req2ByWS.Select\n '## Turn ON Warnings &amp; Screen Updates\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1519787136, "post_id": 49021229, "comment_id": 85047881, "body": "what&#39;s wrong with your pivot table, filter or advanced filter command?"}, {"owner": {"reputation": 11, "user_id": 9421765, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "DBR138", "link": "https://stackoverflow.com/users/9421765/dbr138"}, "edited": false, "score": 0, "creation_date": 1519787305, "post_id": 49021229, "comment_id": 85047921, "body": "This piece is going to fit in to a more complex macro that I have already built. The goal is to produce the report I do now with a single button so that I can push it off onto the end users (who wouldn&#39;t even know what a pivot table was) and eliminate myself from the process."}, {"owner": {"reputation": 11, "user_id": 9421765, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "DBR138", "link": "https://stackoverflow.com/users/9421765/dbr138"}, "edited": false, "score": 0, "creation_date": 1519787922, "post_id": 49021229, "comment_id": 85048056, "body": "I might be over complicating it. Can you set a range based on a variable? If I could set my range as lines where &quot;U&quot; is null then I can reduce it to a single variable."}, {"owner": {"reputation": 11, "user_id": 9421765, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "DBR138", "link": "https://stackoverflow.com/users/9421765/dbr138"}, "edited": false, "score": 0, "creation_date": 1519790617, "post_id": 49021229, "comment_id": 85048669, "body": "Thank you Qharr. I have added my current code which I don&#39;t know will be particularly helpful since I don&#39;t have anything regarding this part in there yet. I am trying to find a way to post my data but I am restricted at work."}, {"owner": {"reputation": 11, "user_id": 9421765, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "DBR138", "link": "https://stackoverflow.com/users/9421765/dbr138"}, "edited": false, "score": 0, "creation_date": 1519792564, "post_id": 49021229, "comment_id": 85049153, "body": "I got the data file added via my google drive."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519793595, "post_id": 49021229, "comment_id": 85049451, "body": "Probably worth having a read of <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> which details how to write a question that helps us target your specific problem."}, {"owner": {"reputation": 11, "user_id": 9421765, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "DBR138", "link": "https://stackoverflow.com/users/9421765/dbr138"}, "edited": false, "score": 0, "creation_date": 1519797038, "post_id": 49021229, "comment_id": 85050446, "body": "Thank you again QHarr. I have attempted to modify it so that it fits within that directive."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519799532, "post_id": 49021229, "comment_id": 85051320, "body": "Your attempt before was closer to be honest. But you are responding. What I had meant was post enough code that demonstrates your efforts to filter, copy and paste. @Jeeped mentioned filtering and I have posted an answer along the same lines that does an all in one copy and paste."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1519802390, "last_edit_date": 1519802390, "creation_date": 1519799430, "answer_id": 49023268, "question_id": 49021229, "link": "https://stackoverflow.com/questions/49021229/super-macro-for-each-item-where-h-is-not-and-u-is-null/49023268#49023268", "title": "Super Macro For each item where H is not and U is null", "body": "<p>Try the following.</p>\n\n<h2><strong>Process:</strong></h2>\n\n<p><strong>A) Define the filter range</strong></p>\n\n<p>I define the range to work with by finding the last used row and column, based on row 1 and column A, and store this in the <code>filterRange</code> variable.</p>\n\n<p><strong>B) Clear any existing filter</strong></p>\n\n<p>I make sure there is no existing filter:</p>\n\n<pre><code>wsSource.AutoFilterMode = False\n</code></pre>\n\n<p>Notice that I have put the source and target sheets into worksheet variables for ease of reference?</p>\n\n<p><strong>C) Apply filter criteria</strong></p>\n\n<p>I then work with that range to apply the two criteria:</p>\n\n<pre><code>With filterRange\n\n        .AutoFilter\n        .AutoFilter Field:=filterField1, Criteria1:=\"&lt;&gt;\" criterion1, Operator:=xlFilterValues\n        .AutoFilter Field:=filterField2, Criteria1:=criterion2\n</code></pre>\n\n<p>Notice here that I have used constants to hold the columns of interest, and the filter criteria to work with e.g. <code>filterField1</code> and <code>criterion1</code>. This means you can easily adjust these at the top of your code if you decide to change how you are applying filters. Obviously still limited to two columns but easy to see how you would extend this.</p>\n\n<p><strong>D) Extract the columns of interest and order them</strong></p>\n\n<p>Now, as we don't want all the filtered data we are going to need to do 3 things:</p>\n\n<p>1) Get all the filtered data </p>\n\n<p>So, the following makes use of the  <code>.AutoFilter.Range</code> object, to get the filtered range, and then uses a Resize to exclude the header row. We already have a header in the other sheet. This is dumped into an array, which as it is read in from the sheet is Option Base 1, not 0. 0 is the normal lower bound for an array.</p>\n\n<pre><code>With wsSource.AutoFilter.Range\n\n    dataArray = .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count) 'exclude header\n\nEnd With\n</code></pre>\n\n<p>2) Reduce this to the columns of interest</p>\n\n<p>3) Have those columns in the specified order <code>S,AD,B,C,E,H,L</code></p>\n\n<p>2 &amp; 3 are achieved by using an array specifying the columns to keep, in the desired order. </p>\n\n<pre><code> Dim columnsToKeep() As Variant\n columnsToKeep = Array(19, 30, 2, 3, 5, 8, 12)\n</code></pre>\n\n<p>You then create an array to hold the results you want to write out to the sheet, <code>resultArray</code>, which you know will have the same number of rows as the array you already have, <code>dataArray</code>, and will have the same number of columns as items in the <code>columnsToKeep</code> array i.e. <code>UBound(columnsToKeep) + 1</code>. Notice the + 1 as that array uses the default base 0 option.</p>\n\n<p>We loop the rows of the <code>dataArray</code> and then, inside this loop, we loop the columns specified by <code>columnsToKeep</code>. This means we can use <code>columnsToKeep(currentColumn)</code> to return the value, from the specified column, in the source array, <code>dataArray</code>, in the order presented in <code>columnsToKeep</code>. To make sure this is loaded into the <code>resultArray</code>, with a column numbering going from 1 onwards, an additional <code>columnCounter</code> variable is used to specify the output column.</p>\n\n<pre><code>For currentRow = LBound(dataArray, 1) To UBound(dataArray, 1)\n\n        columnCounter = 0\n\n        For currentColumn = LBound(columnsToKeep) To UBound(columnsToKeep)\n\n            columnCounter = columnCounter + 1\n            resultArray(currentRow, columnCounter) = dataArray(currentRow, columnsToKeep(currentColumn))\n\n        Next currentColumn\n\n    Next currentRow\n</code></pre>\n\n<p><strong>E) Write results out to second sheet</strong> </p>\n\n<p>Finally, we write everything out to the other sheet below the header:</p>\n\n<pre><code>  wsTarget.Range(\"A2\").Resize(UBound(resultArray, 1), UBound(resultArray, 2)) = resultArray\n</code></pre>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyData()\n\n    'Range(\"H1\").Select\n    Dim wb As Workbook\n    Dim wsSource As Worksheet\n    Dim wsTarget As Worksheet\n    Const filterField1 As Long = 8               'Column H\n    Const filterField2 As Long = 21              'Column U\n    Const criterion1 As String = \"QC-Completed\"\n    Const criterion2 As String = vbNullString\n\n    Set wb = ThisWorkbook\n    Set wsSource = wb.Worksheets(\"Data\")\n    Set wsTarget = wb.Worksheets(\"Pass On\")\n\n    Dim lastRowSource As Long\n    lastRowSource = wsSource.Cells(wsSource.Rows.Count, \"A\").End(xlUp).Row\n\n    Dim lastColumnSource As Long\n    lastColumnSource = wsSource.Range(\"A1\").SpecialCells(xlCellTypeLastCell).Column\n\n    Dim filterRange As Range\n    Set filterRange = wsSource.Range(wsSource.Cells(1, 1), wsSource.Cells(lastRowSource, lastColumnSource))\n\n    wsSource.AutoFilterMode = False\n    Dim dataArray As Variant\n\n    With filterRange\n\n        .AutoFilter\n        .AutoFilter Field:=filterField1, criteria1:=\"&lt;&gt;\" &amp; criteria1, Operator:=xlFilterValues\n        .AutoFilter Field:=filterField2, criteria1:=criteria2\n\n        With wsSource.AutoFilter.Range\n\n             dataArray = .Offset(1, 0).Resize(.Rows.Count - 1, .Columns.Count) 'exclude header\n\n        End With\n\n    End With\n\n    Application.CutCopyMode = False              'Clear clipboard\n\n    Dim columnsToKeep() As Variant\n    columnsToKeep = Array(19, 30, 2, 3, 5, 8, 12) 'determine output columns to keep and their orser\n\n    Dim currentRow As Long\n    Dim currentColumn As Long\n    Dim resultArray() As Variant\n    ReDim resultArray(1 To UBound(dataArray, 1), 1 To UBound(columnsToKeep) + 1)\n    Dim columnCounter As Long\n\n    For currentRow = LBound(dataArray, 1) To UBound(dataArray, 1)\n\n        columnCounter = 0\n\n        For currentColumn = LBound(columnsToKeep) To UBound(columnsToKeep)\n\n            columnCounter = columnCounter + 1\n            resultArray(currentRow, columnCounter) = dataArray(currentRow, columnsToKeep(currentColumn))\n\n        Next currentColumn\n\n    Next currentRow\n\n    wsTarget.Range(\"A2\").Resize(UBound(resultArray, 1), UBound(resultArray, 2)) = resultArray\n\nEnd Sub\n</code></pre>\n\n<p>References:</p>\n\n<ol>\n<li><a href=\"http://datapigtechnologies.com/blog/index.php/a-better-way-to-copy-filtered-rows-using-vba/\" rel=\"nofollow noreferrer\">A Better Way to Copy Filtered Rows Using VBA</a></li>\n<li><a href=\"https://www.mrexcel.com/forum/excel-questions/271528-autofilter-macro-does-not-contain.html\" rel=\"nofollow noreferrer\">AutoFilter macro for \"does not contain\"</a></li>\n<li><a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">Find last row, column or last cell</a></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 9421765, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "DBR138", "link": "https://stackoverflow.com/users/9421765/dbr138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1519802390, "creation_date": 1519786395, "last_edit_date": 1519797255, "question_id": 49021229, "link": "https://stackoverflow.com/questions/49021229/super-macro-for-each-item-where-h-is-not-and-u-is-null", "title": "Super Macro For each item where H is not and U is null", "body": "<p><a href=\"https://docs.google.com/file/d/0B6qTKfuEA6y6ZkxLdTdvX293aHN6VnAxNTNuSjkybGRWX3E4/edit?usp=docslist_api&amp;filetype=msexcel\" rel=\"nofollow noreferrer\">Example data</a>\nI am trying to come up with a macro that will populate the \"Pass On\" tab with the corresponding data in the \"Data\" tab for each item that does not have \"QC-Completed\" in column H or a container in column U. </p>\n\n<p>I have not even come close yet.  </p>\n"}, {"tags": ["vba", "ms-word", "filenames"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "edited": false, "score": 0, "creation_date": 1520059354, "post_id": 49022713, "comment_id": 85168311, "body": "Hi, I tried this out and it is still creating the 31st of February and won&#39;t create the 31st of December. Not sure why?"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "reply_to_user": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "edited": false, "score": 0, "creation_date": 1520059919, "post_id": 49022713, "comment_id": 85168445, "body": "Arrays in VBA start from 0, not from 1, so this might be the issue. To fix it, add Option Base 1 to the top of your module"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "reply_to_user": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "edited": false, "score": 0, "creation_date": 1520060384, "post_id": 49022713, "comment_id": 85168567, "body": "Alternatively, you can add 1 to your function call: endOfMonth = DAY(dhLastDayInMonth(DateSerial(myYear, (currentMonth+1) + 1, 0)))"}, {"owner": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "edited": false, "score": 0, "creation_date": 1520060544, "post_id": 49022713, "comment_id": 85168608, "body": "you&#39;ll have to excuse my lack of knowledge as I am relatively new to this but what to you mean by the the above?"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "reply_to_user": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "edited": false, "score": 0, "creation_date": 1520060671, "post_id": 49022713, "comment_id": 85168638, "body": "When you wrote this: For currentMonth = LBound(monthsArray) To UBound(monthsArray) You probably meant &quot;For Month = 1 to Month = 12 .....&quot; But what is actually happening is &quot;For Month = 0 to Month = 11 ... &quot;"}, {"owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "reply_to_user": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "edited": false, "score": 0, "creation_date": 1520060932, "post_id": 49022713, "comment_id": 85168689, "body": "Because arrays in VBA start from 0, not from 1. I.e, monthArray(0) = &quot;Jan&quot;, monthArray(1) = &quot;Feb&quot;. So LBound(monthsArray) means 0. When you put 0 as a month number into DateSerial, it gives you wrong result (month 0 does not exist)"}, {"owner": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "edited": false, "score": 0, "creation_date": 1520061078, "post_id": 49022713, "comment_id": 85168716, "body": "thank you this has now fixed it and is running as I need it to. thanks for your help."}], "tags": [], "owner": {"reputation": 6572, "user_id": 3679147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XBky0.jpg?s=128&g=1", "display_name": "RADO", "link": "https://stackoverflow.com/users/3679147/rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1519796732, "creation_date": 1519796732, "answer_id": 49022713, "question_id": 49021037, "link": "https://stackoverflow.com/questions/49021037/vba-returning-incorrect-month-dates-word/49022713#49022713", "title": "VBA returning incorrect month dates word", "body": "<p>In this line:</p>\n\n<pre><code>ActiveDocument.SaveAs2 FileName:=folderName &amp; Application.PathSeparator &amp; monthsArray(currentMonth) &amp; \" \" &amp; currentDay, FileFormat:=wdFormatXMLDocument\n</code></pre>\n\n<p>currentDay is Long, while you are trying to use it as string. I'd code it as follows:</p>\n\n<pre><code>Dim documentName as string\ndocumentName = monthsArray(currentMonth) &amp; \" \" &amp; CStr(currentDay)\nActiveDocument.SaveAs2 FileName:=folderName &amp; Application.PathSeparator &amp; documentName, FileFormat:=wdFormatXMLDocument\n</code></pre>\n\n<p>Also, I'd re-write this line:</p>\n\n<pre><code>endOfMonth = CLng(Format$(dhLastDayInMonth(DateSerial(myYear, currentMonth + 1, 0)), \"dd\"))\n</code></pre>\n\n<p>as:</p>\n\n<pre><code>endOfMonth = DAY(dhLastDayInMonth(DateSerial(myYear, currentMonth + 1, 0)))\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9406017, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Nick Freeman", "link": "https://stackoverflow.com/users/9406017/nick-freeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 49022713, "answer_count": 1, "score": 0, "last_activity_date": 1519797092, "creation_date": 1519784734, "last_edit_date": 1519797092, "question_id": 49021037, "link": "https://stackoverflow.com/questions/49021037/vba-returning-incorrect-month-dates-word", "title": "VBA returning incorrect month dates word", "body": "<p>I have an issue with the following code for some reason when creating the files it only goes the 30th not the 31st on the correct months and in February it creates up to the 30th. The code is designed to create folder for each month then create a months worth of files from 1 master document. The original code I used worked but did not create the folders.</p>\n\n<p>This is the code returning the error</p>\n\n<pre><code> Sub Folder()\n\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    'Dim fso As FileSystemObject     ' ''early binding. Requires reference to MS Scripting runtime\n    'Set fso = New FileSystemObject     ''early binding\n\n    Dim myYear As Long\n    Dim endOfMonth As Long\n    Dim filePathStub As String\n\n    filePathStub = \"c:\\user\\test briefing sheet\\2019\\\" ' path to create folders at\"\n\n    myYear = 19\n\n    Dim monthsArray() As Variant\n\n    monthsArray = Array(\"Jan\", \"Feb\", \"Mar\", \"April\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sept\", \"Oct\", \"Nov\", \"Dec\")\n\n   Dim currentMonth As Long\n\n   For currentMonth = LBound(monthsArray) To UBound(monthsArray)\n\n       Dim folderName As String\n\n       folderName = monthsArray(currentMonth) &amp; \" \" &amp; CStr(myYear)\n\n       folderName = fso.CreateFolder(folderName)\n\n       endOfMonth = CLng(Format$(dhLastDayInMonth(DateSerial(myYear, currentMonth + 1, 0)), \"dd\"))\n\n       Dim currentDay As Long\n\n       For currentDay = 1 To endOfMonth\n\n           ActiveDocument.SaveAs2 FileName:=folderName &amp; Application.PathSeparator &amp; monthsArray(currentMonth) &amp; \" \" &amp; currentDay, FileFormat:=wdFormatXMLDocument\n\n       Next currentDay\n\n   Next currentMonth\n\nEnd Sub\n\nFunction dhLastDayInMonth(Optional dtmDate As Date = 0) As Date\n    ' Return the last day in the specified month.\n    If dtmDate = 0 Then\n        ' Did the caller pass in a date? If not, use\n        ' the current date.\n        dtmDate = Date\n    End If\n    dhLastDayInMonth = DateSerial(Year(dtmDate), _\n     Month(dtmDate) + 1, 0)\n\nEnd Function\n</code></pre>\n\n<p>This was the original code</p>\n\n<pre><code>    Sub Mine()\n     Dim DateStr, FileStr As String\n      DateStr = Format$(Date, \"DD\")\n      FileStr = DateStr &amp; \".docx\"\n\n      ActiveDocument.Save\n      ChangeFileOpenDirectory \"c:\\user\\test briefing sheet\\2019\\\"\n      ActiveDocument.SaveAs2 FileName:=FileStr, FileFormat:=wdFormatXMLDocument\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["arrays", "excel", "range", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1519776915, "post_id": 49019983, "comment_id": 85045225, "body": "Are you calling this as a UDF ( ie from as formula in a cell)?  If so, you can&#39;t change range values.  Better approach is to copy values to variant arrays and process those"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1519806863, "post_id": 49019983, "comment_id": 85054793, "body": "Note that you should not use <code>Integer</code> for row counting because Excel has more rows than <code>Integer</code> can handle. I recommend always to use <code>Long</code> instead of <code>Integer</code> as there is no benefit in using <code>Integer</code> at all."}, {"owner": {"reputation": 468, "user_id": 7797210, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-dDOWSggVg8M/AAAAAAAAAAI/AAAAAAAAHdM/auCfDcG2GuY/photo.jpg?sz=128", "display_name": "Kiann", "link": "https://stackoverflow.com/users/7797210/kiann"}, "edited": false, "score": 0, "creation_date": 1519843813, "post_id": 49019983, "comment_id": 85077986, "body": "Hi Chris, yes. The values pulled in are from formulae; and I am using an UDF. So, you mean I have to pull in the values, and re-copy the values into another range internally within the function?"}, {"owner": {"reputation": 468, "user_id": 7797210, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-dDOWSggVg8M/AAAAAAAAAAI/AAAAAAAAHdM/auCfDcG2GuY/photo.jpg?sz=128", "display_name": "Kiann", "link": "https://stackoverflow.com/users/7797210/kiann"}, "edited": false, "score": 0, "creation_date": 1519843859, "post_id": 49019983, "comment_id": 85078016, "body": "hi Peh, I thought for &#39;For/next&#39; loop, the values have to be integer.. but let me try &#39;Long&#39;."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519889850, "post_id": 49019983, "comment_id": 85094126, "body": "@Kiann <code>Long</code> is a kind of integer, but a &quot;long integer&quot;. <code>Integer</code> can handle numbers from <code>-32768</code> to <code>32767</code> but Excel has <code>1048576</code> rows. Therefore you need to use <code>Long</code> (which is also an integer type) that can handle numbers from <code>-2147483648</code> to <code>2147483647</code>. We can conclude that we can <a href=\"https://stackoverflow.com/a/26409520/3219613\">always use <code>Long</code> instead of <code>Integer</code> in VBA</a>. There is no benefit in using <code>Integer</code> in VBA at all."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1519890112, "post_id": 49019983, "comment_id": 85094233, "body": "@Kiann What Chris said, if you use <code>Kian_CurveInterp</code> as a UDF in your sheet like <code>=Kian_CurveInterp(\u2026)</code> you can only read from cells but cannot write to them, because this is not allowed in UDFs. If you need to do change values of cells you need to do that anywhere but NOT in a UDF. So you will eg. need another procedure to change the values (which eg. can be called by a button)."}], "owner": {"reputation": 468, "user_id": 7797210, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-dDOWSggVg8M/AAAAAAAAAAI/AAAAAAAAHdM/auCfDcG2GuY/photo.jpg?sz=128", "display_name": "Kiann", "link": "https://stackoverflow.com/users/7797210/kiann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519806773, "creation_date": 1519776452, "last_edit_date": 1531164843, "question_id": 49019983, "link": "https://stackoverflow.com/questions/49019983/vba-calculate-values-to-range-within-function", "title": "VBA Calculate values to Range within Function", "body": "<p>I am trying to generate a simplistic Excel VBA function to calculate different types of interpolation. One difficulty I have is that, I don't seem to be able to re-assign the Y-range of values within the function.</p>\n\n<p>When my VBA function reaches the following line, it doesn't seem to be able to change/re-calculate the <code>YRange</code> value according to the formula:</p>\n\n<pre><code> YRange(rowCount) = -Log(YRange(rowCount)) / XRange(rowCount)\n</code></pre>\n\n<p>Can anyone advise/help?</p>\n\n<pre><code>Public Function Kian_CurveInterp(XRange As Range, YRange As Range, XFrac As Double, InterpMode As Integer)\n    Select Case InterpMode\n        Case 1 'step-straight\n            Kian_CurveInterp = Linterp2(XRange, YRange, XFrac)\n\n        Case 2 'zero-rate interp\n            Dim rowCount As Integer\n            For rowCount = 1 To XRange.Count\n                YRange(rowCount) = -Log(YRange(rowCount)) / XRange(rowCount) 'convert discountFactors to zero-rates\n            Next rowCount\n            Kian_CurveInterp = Linterp2(XRange, YRange, XFrac)\n            Kian_CurveInterp = Exp(-Kian_CurveInterp * XFrac)\n    End Select\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519783902, "post_id": 49019894, "comment_id": 85047110, "body": "You will have to bring Word into it. <a href=\"https://stackoverflow.com/questions/11719754/how-can-i-identify-the-display-language-i-e-toolbars-menus-used-by-ms-office\">How can I identify the display language</a> and <a href=\"https://stackoverflow.com/questions/35390848/detect-language-of-word-document\">Detect language of Word document</a>. Word reference - <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/document-languagedetected-property-word\" rel=\"nofollow noreferrer\">Document.LanguageDetected Property</a> . You may be able to either update the question to narrow the focus or submit an answer."}, {"owner": {"reputation": 9, "user_id": 9421379, "user_type": "registered", "profile_image": "https://graph.facebook.com/194353694663796/picture?type=large", "display_name": "Karthik Parthasarathy", "link": "https://stackoverflow.com/users/9421379/karthik-parthasarathy"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1520888527, "post_id": 49019894, "comment_id": 85492597, "body": "thank you for answer,  I did not think the community will react soon, exporting the text into word and detecting  the language, can be a good idea. i will try to work on it"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9421379, "user_type": "registered", "profile_image": "https://graph.facebook.com/194353694663796/picture?type=large", "display_name": "Karthik Parthasarathy", "link": "https://stackoverflow.com/users/9421379/karthik-parthasarathy"}, "edited": false, "score": 0, "creation_date": 1520888806, "post_id": 49034203, "comment_id": 85492729, "body": "i have one thing in mind , the way google translator works, it can detect the language, if there is two languages ,translator  will say the language which have more words in the translator box. thank you for quick response"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 9, "user_id": 9421379, "user_type": "registered", "profile_image": "https://graph.facebook.com/194353694663796/picture?type=large", "display_name": "Karthik Parthasarathy", "link": "https://stackoverflow.com/users/9421379/karthik-parthasarathy"}, "edited": false, "score": 0, "creation_date": 1520890796, "post_id": 49034203, "comment_id": 85493612, "body": "Yes, if you have access to an API like that, I would love to access it too :-)"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1519835164, "creation_date": 1519835164, "answer_id": 49034203, "question_id": 49019894, "link": "https://stackoverflow.com/questions/49019894/how-determine-in-which-language-an-email-is-written-using-vba/49034203#49034203", "title": "How determine in which language an email is written using VBA", "body": "<p>You can't. You might be able to detect the code page (as specified in the email headers - see <code>MailItem.InternetCodepage</code> property), but that tells you nothing about the language. And what do you do if there are multiple languages or code pages in the same email?</p>\n\n<p>You can try to use <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa740773(v=vs.85)\" rel=\"nofollow noreferrer\">IMultiLanguage3::DetectOutboundCodePage</a>, but I don't think you can access <code>IMultiLanguage</code> in VBA.</p>\n"}], "owner": {"reputation": 9, "user_id": 9421379, "user_type": "registered", "profile_image": "https://graph.facebook.com/194353694663796/picture?type=large", "display_name": "Karthik Parthasarathy", "link": "https://stackoverflow.com/users/9421379/karthik-parthasarathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593042592, "creation_date": 1519775947, "last_edit_date": 1593042592, "question_id": 49019894, "link": "https://stackoverflow.com/questions/49019894/how-determine-in-which-language-an-email-is-written-using-vba", "title": "How determine in which language an email is written using VBA", "body": "<p>In My project, I would like to automate The following task in my work place :</p>\n\n<ul>\n<li>Mails Triaging\nthis task consist to read the email , detect the language of the email and send the email in particular folder in Outlook.\nlets say the <strong>Inbox</strong> have two emails one <strong>English</strong> and another in <strong>French</strong> .</li>\n</ul>\n\n<p>the program should send the email for example to <strong>Jack EN</strong> for English emails and  <strong>Julie FR</strong> For french emails.</p>\n\n<p>So far I have this what I have  :</p>\n\n<pre><code>Sub TriageEmails()\n    Dim myolApp As Outlook.Application\n    Dim aItem As Object \n\n    Set myolApp = CreateObject (\"Outlook.Application\")\n    Set mail = myolApp.ActiveExplorer.CurrentFolder\n\n    For Each AItem In mail.Items    \n        `i guess the code will be here \n    Next aItem\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "checkbox", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1519779900, "post_id": 49019683, "comment_id": 85046084, "body": "<code>Concatenate(IF(E4=TRUE; &quot;YaY&quot;; &quot;Nope&quot;),IF(E5=TRUE; &quot;Woo!&quot;; &quot;Boo!&quot;))</code> (of course, this can get very long, perhaps too long if you are trying to do it for 23 different cells)"}, {"owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "edited": false, "score": 0, "creation_date": 1519798230, "post_id": 49019683, "comment_id": 85050860, "body": "Where are the words that you need to concatenate in B7?"}], "answers": [{"comments": [{"owner": {"reputation": 1959, "user_id": 652535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BeEuU.png?s=128&g=1", "display_name": "Patrick R", "link": "https://stackoverflow.com/users/652535/patrick-r"}, "edited": false, "score": 0, "creation_date": 1519786544, "post_id": 49020434, "comment_id": 85047752, "body": "I dont see how this can be used for my setup? I need the answer in B27, but if i go by your solution, i need two Col&#39;s for both true and false answers? or maybe im understanding your solution wrong?"}], "tags": [], "owner": {"reputation": 62, "user_id": 9377130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nWb3g.jpg?s=128&g=1", "display_name": "choufrise", "link": "https://stackoverflow.com/users/9377130/choufrise"}, "is_accepted": true, "score": 1, "last_activity_date": 1519818419, "last_edit_date": 1519818419, "creation_date": 1519779973, "answer_id": 49020434, "question_id": 49019683, "link": "https://stackoverflow.com/questions/49019683/excel-2016-how-to-fill-one-cell-with-data-from-multiply-checkboxes/49020434#49020434", "title": "Excel 2016 - How to fill one cell with data from multiply checkboxes?", "body": "<p>Based on your description I would solve it as follows:</p>\n\n<ul>\n<li>Col. D: Checkboxes</li>\n<li>Col. E: TRUE/FALSE statements (based on used checkbox)</li>\n<li>Col. F: Answer if statement is TRUE (e.g. YAY!)</li>\n<li>Col. G: Answer if statement is FALSE (e.g. Nope!)</li>\n</ul>\n\n<p>Then you can use the following formula in B27: </p>\n\n<pre><code>=IF(E4,F4,G4)&amp;\" \" &amp; IF(E5,F5,G5) &amp;\" \" &amp; IF(E..,F..,G..)\n</code></pre>\n\n<p>Based on the logical result in E, you get the desired answer in cell B27. Using the \"&amp;\" you can combine all if statements.</p>\n"}], "owner": {"reputation": 1959, "user_id": 652535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BeEuU.png?s=128&g=1", "display_name": "Patrick R", "link": "https://stackoverflow.com/users/652535/patrick-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 49020434, "answer_count": 1, "score": 1, "last_activity_date": 1519818419, "creation_date": 1519774446, "last_edit_date": 1531161705, "question_id": 49019683, "link": "https://stackoverflow.com/questions/49019683/excel-2016-how-to-fill-one-cell-with-data-from-multiply-checkboxes", "title": "Excel 2016 - How to fill one cell with data from multiply checkboxes?", "body": "<p>For starters, im not very great or smart when it comes to Excel. So forgive me my question, since it might be really easy, but i just cant get it to work. </p>\n\n<p>I have look though google and cant seem to find a solution for this, or anything that can help me in the right direction.  </p>\n\n<p>I have a list of checkboxes in excel, from <code>D4</code> to <code>D27</code>.<br>\nI have every value of the checkboxes on <code>E4</code> to <code>E27</code> (<code>TRUE</code> or <code>FALSE</code>).</p>\n\n<p>Then i have a cell that should get the data from the checkboxes, when they are TRUE. This is <code>B27</code>.  </p>\n\n<p><code>B27</code> have a <code>=IF(E4=TRUE; \"YaY\"; \"Nope\")</code> script at the moment. And this is working. BUT, i cant get anymore <code>IF statements</code> in there, or nest them when it comes to text. I might be doing it wrong though, i dont know. -Yes i did try and look it but, but cant get it to work.  </p>\n\n<p>Every checkbox has diffrent data linked to it, so if <code>D4</code> is checked, then the value need to be sent to <code>B27</code>, with text <code>YAY!</code>. And then if <code>D5</code> is checked, it sends the data to <code>B27</code> with some other data, lets say <code>WOO!</code>. So <code>B27</code> should be looking like this : <code>YAY!; WOO!;</code>  </p>\n\n<p>|------------------------------------------------------|<br>\n|-------D4---------|----------E4--------------------|<br>\n|-------X-----------|---------TRUE----------------|<br>\n|-------X-----------|---------TRUE----------------|<br>\n|-------B27--------|---------YAY!; WOO!;-------|<br>\n|------------------------------------------------------|  </p>\n\n<p>How can i get this done?  </p>\n\n<p>I have tried to look at Macro scripting as well, but that was a great failure.  </p>\n\n<p>Can someone show me in the right direction, or help me out how this can be done?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519773150, "post_id": 49019426, "comment_id": 85044114, "body": "Are you using global variables?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519773222, "post_id": 49019426, "comment_id": 85044139, "body": "Are you using constants?"}, {"owner": {"reputation": 818, "user_id": 754444, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0038c1b35cc1b2138ae2eba34bdf21d5?s=128&d=identicon&r=PG", "display_name": "zaza", "link": "https://stackoverflow.com/users/754444/zaza"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1519773436, "post_id": 49019426, "comment_id": 85044218, "body": "@K.D\u1d00\u1d20\u026as The only code i have in the Macro is above, I&#39;m using &quot;Public NewDataFilePath As String&quot; but as per the screenshots the value in it doesn&#39;t persist when i re run the macro."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "edited": false, "score": 0, "creation_date": 1519774514, "post_id": 49019426, "comment_id": 85044543, "body": "I think you are missing the path (from the debug screenshots you posted). A  file name is not enough, you cannot invoke Dir function on a file name without a path."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519774790, "post_id": 49019426, "comment_id": 85044611, "body": "You say <i>then I stop debugging...</i>  if by that you mean you click the stop button on the VBA toolbar, that will clear the Public variables."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "edited": false, "score": 0, "creation_date": 1519775010, "post_id": 49019426, "comment_id": 85044678, "body": "Use TxtFilePath = fdlg.FileName"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1519802763, "post_id": 49019426, "comment_id": 85052780, "body": "just to say that you can simply code <code>If Dir(NewDataFilePath) = &quot;&quot; Then</code> instead of <code>If Not Dir(NewDataFilePath) &lt;&gt; &quot;&quot; Then</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 0, "last_activity_date": 1519774452, "creation_date": 1519774452, "answer_id": 49019686, "question_id": 49019426, "link": "https://stackoverflow.com/questions/49019426/file-name-presists-in-dir-function-over-multiple-sessions/49019686#49019686", "title": "File name presists in Dir() function over multiple sessions", "body": "<p>Try this code</p>\n\n<pre><code>Public NewDataFilePath As String\n\nPrivate Sub BtnFileBrowse_Click()\nDim fdlg As FileDialog\n\nSet fdlg = Application.FileDialog(msoFileDialogOpen)\nfdlg.Title = \"Select New Dataset\"\nfdlg.Filters.Clear\nfdlg.Filters.Add \"Excel Files Only\", \"*.xls; *.xlsx\"\nfdlg.Show\n\nIf fdlg.SelectedItems.Count &lt;&gt; 0 Then\n    NewDataFilePath = fdlg.SelectedItems(1)\nEnd If\nEnd Sub\n\nPrivate Sub BtnUpdate_Click()\nDim a As String\n\na = Dir(NewDataFilePath)\n\nIf DoesFileExist(NewDataFilePath) And NewDataFilePath &lt;&gt; \"\" Then\n    MsgBox NewDataFilePath &amp; \" is a valid file path\"\nElse\n    MsgBox NewDataFilePath &amp; \" NOT a valid file path\"\nEnd If\nEnd Sub\n\nFunction DoesFileExist(filePath) As Boolean\nDoesFileExist = Dir(filePath) &lt;&gt; \"\"\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1519804301, "creation_date": 1519804301, "answer_id": 49024463, "question_id": 49019426, "link": "https://stackoverflow.com/questions/49019426/file-name-presists-in-dir-function-over-multiple-sessions/49024463#49024463", "title": "File name presists in Dir() function over multiple sessions", "body": "<p>Of course there is no persistence of any variable value once you stop a macro </p>\n\n<p>While the observed behavior is due to the following:</p>\n\n<p>1) <code>FileDialog</code> object keeps the last path chosen in its <code>IntialFileName</code> property</p>\n\n<p>2) <code>Dir(path)</code> function with an empty string as \"path\" would return the first file in the <code>IntialFileName</code> path stored by last <code>FileDialog</code> run</p>\n\n<p>so when you re-run the macro:</p>\n\n<ul>\n<li><p><code>NewDataFilePath</code> is an empty string</p></li>\n<li><p><code>a = Dir(NewDataFilePath)</code>, would return the first file in the <code>IntialFileName</code> path matching the filters (if any)</p></li>\n</ul>\n\n<p>What above as the answer to your question</p>\n\n<p>While you could consider the following \"nuance\" of your code:</p>\n\n<pre><code>Private Sub BtnUpdate_Click()\n    If NewDataFilePath &lt;&gt; \"\" Then 'if 'NewDataFilePath' has been set\n        Dim a As String\n        a = Dir(NewDataFilePath)\n\n        If Not Dir(NewDataFilePath) &lt;&gt; \"\" Then  MsgBox \"\"\" &amp; NewDataFilePath &amp; \"\" is not a valid file path\"\n\n    Else 'otherwise\n            MsgBox \"No file path specified!\", vbCritical ' inform the user to do so\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 818, "user_id": 754444, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0038c1b35cc1b2138ae2eba34bdf21d5?s=128&d=identicon&r=PG", "display_name": "zaza", "link": "https://stackoverflow.com/users/754444/zaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 49024463, "answer_count": 2, "score": 0, "last_activity_date": 1519804301, "creation_date": 1519772908, "last_edit_date": 1531164843, "question_id": 49019426, "link": "https://stackoverflow.com/questions/49019426/file-name-presists-in-dir-function-over-multiple-sessions", "title": "File name presists in Dir() function over multiple sessions", "body": "<p>I have some code in a Excel VBA macro and it seems like its persisting values between sessions. The issue is with the BtnUpdate_Click event, the message box doesnt trigger even if the file path in NewDataFilePath is invalid. </p>\n\n<pre><code>Public NewDataFilePath As String\n\nPrivate Sub BtnFileBrowse_Click()\n    Dim fdlg As FileDialog\n    Set fdlg = Application.FileDialog(msoFileDialogOpen)\n    fdlg.Title = \"Select New Dataset\"\n    fdlg.Filters.Clear\n    fdlg.Filters.Add \"Excel Files Only\", \"*.xls; *.xlsx\"\n    fdlg.Show\n\n    If fdlg.SelectedItems.Count &lt;&gt; 0 Then\n        TxtFilePath = fdlg.SelectedItems(1)\n    End If\n    NewDataFilePath = TxtFilePath.Text\n\nEnd Sub\n\nPrivate Sub BtnUpdate_Click()\n    Dim a As String\n    a = Dir(NewDataFilePath)\n\n    If Not Dir(NewDataFilePath) &lt;&gt; \"\" Then\n        MsgBox \"\"\" &amp; NewDataFilePath &amp; \"\" is not a valid file path\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I added the string a in the event handler to try and debug the code and its showing me some interesting results:</p>\n\n<p><em>I have a breakpoint on the if statement in BtnUpdate_Click.</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/hpTx4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hpTx4.png\" alt=\"File path is selected\"></a></p>\n\n<p>Then i stop debugging the macro and re-run it. if i invoke BtnUpdate_Click without selecting another file the Dir() function seems to keep the last file name:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gx2Qg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gx2Qg.png\" alt=\"File path is blank\"></a></p>\n\n<p>Any ideas why this could happen?</p>\n"}, {"tags": ["excel", "function", "oop", "user-defined-functions", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519773177, "post_id": 49019213, "comment_id": 85044124, "body": "You should be able to pass <code>Me</code> from the class to other code.  And to call <code>affectedArea</code> use <code>ClassInstanceName.affectedArea</code> (provided affectedArea is public)"}, {"owner": {"reputation": 350, "user_id": 3825495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/526158124/picture?type=large", "display_name": "Michael James", "link": "https://stackoverflow.com/users/3825495/michael-james"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519788090, "post_id": 49019213, "comment_id": 85048105, "body": "Thanks!  I thought I tried to pass \u201cMe\u201d, but maybe I didn\u2019t properly type it in the called function. I will try again in the morning."}, {"owner": {"reputation": 350, "user_id": 3825495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/526158124/picture?type=large", "display_name": "Michael James", "link": "https://stackoverflow.com/users/3825495/michael-james"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1519851230, "post_id": 49019213, "comment_id": 85081892, "body": "chris neilsen - Passing &quot;Me&quot; as an argument worked well.  How do I pass reference to the ClassInstanceName.affectedArea method so that it can be run in the called function?"}], "answers": [{"comments": [{"owner": {"reputation": 350, "user_id": 3825495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/526158124/picture?type=large", "display_name": "Michael James", "link": "https://stackoverflow.com/users/3825495/michael-james"}, "edited": false, "score": 0, "creation_date": 1519853917, "post_id": 49038695, "comment_id": 85083348, "body": "Thank you.  In solverSecant, you explicitly call obj.affectedArea.  How do I pass reference to solverSecant of the &quot;affectedArea&quot; method?  I&#39;m looking to have solverSecant run any provided method of an instantiated class without having to explicitly state the name of the method in solverSecant."}, {"owner": {"reputation": 350, "user_id": 3825495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/526158124/picture?type=large", "display_name": "Michael James", "link": "https://stackoverflow.com/users/3825495/michael-james"}, "edited": false, "score": 0, "creation_date": 1519874764, "post_id": 49038695, "comment_id": 85089436, "body": "Thank you!  I didn\u2019t know about CallByName."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1519855029, "last_edit_date": 1519855029, "creation_date": 1519852587, "answer_id": 49038695, "question_id": 49019213, "link": "https://stackoverflow.com/questions/49019213/excel-vba-pass-name-of-class-method-to-another-subroutine-to-call-the-method/49038695#49038695", "title": "Excel VBA - pass name of class method to another subroutine to call the method", "body": "<p>You can pass <code>Me</code> from the class to other code. And to call <code>affectedArea</code> use <code>ClassInstanceName.affectedArea</code> (provided <code>affectedArea</code> is public)</p>\n\n<p>To Demonstrate, create class <code>ChemicalRelease</code> as</p>\n\n<pre><code>Option Explicit\n\nPrivate pVar As Variant\n\nProperty Get affectedArea() As Variant\n    affectedArea = pVar\nEnd Property\n\nSub Init(v As Variant)\n    pVar = v\nEnd Sub\n\nSub varyMassRateForTargArea()\n    Module1.solverSecant Me\nEnd Sub\n\nSub Method1(v As Variant)\n    Debug.Print \"Method 1\", v\nEnd Sub\n\nSub Method2(v As Variant)\n    Debug.Print \"Method 2\", v\nEnd Sub\n</code></pre>\n\n<p>In <code>Module1</code> code this</p>\n\n<pre><code>Option Explicit\n\nSub solverSecant(obj As ChemicalRelease)\n    Dim NameOfMethod As String\n    Debug.Print \"solverSecant\", obj.affectedArea\n\n    NameOfMethod = \"Method1\"\n    CallByName obj, NameOfMethod, VbMethod, \"Parameter passed to Method 1\"\n    NameOfMethod = \"Method2\"\n    CallByName obj, NameOfMethod, VbMethod, \"Parameter passed to Method 2\"\nEnd Sub\n</code></pre>\n\n<p>Run this Test code to demonstarte actions</p>\n\n<pre><code>Sub Test()\n    Dim Instance1OfClass As ChemicalRelease, Instance2OfClass As ChemicalRelease\n    Dim v\n\n    Set Instance1OfClass = New ChemicalRelease\n    Set Instance2OfClass = New ChemicalRelease\n\n    Instance1OfClass.Init \"A\"\n    Instance2OfClass.Init \"B\"\n\n    ' Get Property\n    v = Instance1OfClass.affectedArea\n    Debug.Print \"Instance1OfClass\", v\n\n    v = Instance2OfClass.affectedArea\n    Debug.Print \"Instance2OfClass\", v\n\n    ' Call method\n    Instance1OfClass.varyMassRateForTargArea\n    Instance2OfClass.varyMassRateForTargArea\nEnd Sub\n</code></pre>\n\n<p>Output in immediate window should be</p>\n\n<blockquote>\n  <p>Instance1OfClass            A<br>\n  Instance2OfClass            B<br>\n  solverSecant  A<br>\n  Method 1      Parameter passed to Method 1<br>\n  Method 2      Parameter passed to Method 2<br>\n  solverSecant  B<br>\n  Method 1      Parameter passed to Method 1<br>\n  Method 2      Parameter passed to Method 2  </p>\n</blockquote>\n"}], "owner": {"reputation": 350, "user_id": 3825495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/526158124/picture?type=large", "display_name": "Michael James", "link": "https://stackoverflow.com/users/3825495/michael-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 49038695, "answer_count": 1, "score": 0, "last_activity_date": 1519855029, "creation_date": 1519771676, "last_edit_date": 1531161705, "question_id": 49019213, "link": "https://stackoverflow.com/questions/49019213/excel-vba-pass-name-of-class-method-to-another-subroutine-to-call-the-method", "title": "Excel VBA - pass name of class method to another subroutine to call the method", "body": "<p>I have an add-in file named \"MyFunctions.xlam\".  This contains several helper functions, including custom solvers, etc.  </p>\n\n<p>In MyFunctions, I have a Class named \"ChemicalRelease\".  This class has a property of massRate and a public function named \"affectedArea\".  The \"affectedArea\" method goes thru several calculations and method calls to determine the affected area size of a chemical release, based on a provided mass rate and several other factors.  I have a target affected area size, and am looking to use a solver to back calculate an appropriate mass rate that would result in the target affected area size.</p>\n\n<p>Inside of the ChemicalRelease Class Module, a method named \"varyMassRateForTargArea\" attempts to solve for massRate using the secant solver, targeting a specified affected area:</p>\n\n<p>massRate = solverSecant(massRate, \"ChemicalRelease.affectedArea\", targArea, 0, False)</p>\n\n<p>\"solverSecant\" is in \"Module1\" of \"MyFunctions\", and is meant to be generic enough to be used by any class method.</p>\n\n<p>Here is some code for \"solverSecant\":</p>\n\n<pre><code>Function solverSecant(ByRef varyingProperty, methodToRun, Optional yTarget = 0#, Optional dx = 0, Optional dDebug As Boolean = False)\n\nx0 = varyingProperty\n\nIf dx &lt;= 0 Then dx = x0 / 1000\n\nmaxIter = 1000\n\ncurrIter = 0\n\nxTol = dx / 10\n\nx1 = x0 + dx\n\nx0 = varyingProperty\ny0 = Application.Run(methodToRun) - yTarget\n...\n</code></pre>\n\n<p>the \"solverSecant\" method needs to do the following:</p>\n\n<ol>\n<li>update the property value for massRate in the instantiated ChemicalRelease object.</li>\n<li>run the object's \"affectedArea\" method with the updated property value from step #1.</li>\n<li>do the rest of the solver algorithm, but that part should work ok, given that the other two requirements are met.</li>\n</ol>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>Once an instance of \"ChemicalRelease\" is initialized, and the \"varyMassRateForTargArea\" method is called, is it possible to pass the reference to the instantiated \"ChemicalRelease\" object from \"varyMassRateForTargArea\" to \"solverSecant\" in \"Module1\"?  This would be equivalent of sending \"self\" as an argument in every other language I can think of.</p></li>\n<li><p>Is there some way to run the \"ChemicalRelease.affectedArea\" method from \"Module1\"?  I can't seem to get it to work with \"Application.Run\", but I may not have the syntax correct.</p></li>\n</ol>\n\n<p>Thank you for your help.  I understand that I can have the solver as part of a method in the class object, but I'd rather develop a solver in the \"MyFunctions\" that can apply it to any other method/property of other classes.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519771129, "post_id": 49018951, "comment_id": 85043445, "body": "There is no one correct answer here, but if the arrangement of the items you&#39;re modelling with your classes is actually hierarchical then there&#39;s no obvious problem with mirroring that in your implementation.  Devil&#39;s in the details though as always."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1519771293, "post_id": 49018951, "comment_id": 85043512, "body": "Thanks, I also started to wonder if I should do both or a mixture of the two..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1519772094, "post_id": 49018951, "comment_id": 85043791, "body": "@SlowLearner Perhaps a better question for SuperUser/Code Review?"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1519772303, "post_id": 49018951, "comment_id": 85043857, "body": "Yeah, I realise it doesn&#39;t quite fit the SE mould... CR requires working code and I think all the VBA gurus hang out here \ud83d\ude11"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1519775169, "post_id": 49018951, "comment_id": 85044723, "body": "As Tim said, it really depends if you have something like the contract manager have another contract manager under him/her. You may want to add a variable to link this &quot;Manager&quot; in the class."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1519777538, "post_id": 49018951, "comment_id": 85045414, "body": "The contract manager is <i>supposed to be</i> a singleton..."}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519771350, "creation_date": 1519770273, "last_edit_date": 1592644375, "question_id": 49018951, "link": "https://stackoverflow.com/questions/49018951/am-i-creating-an-anti-pattern-vba-arrangement-of-objects-in-a-contractmanager-c", "title": "Am I creating an anti-Pattern? VBA arrangement of objects in a ContractManager class?", "body": "<h1>Structure for contract manager class</h1>\n<h2>Original approach - nested arrangement</h2>\n<p>In VBA I'm trying to build a contract manager class (e.g. to build contracts in MS Word) and I set out to do something like this:</p>\n<p><code>manager.contracts(cKey).specialConditions(sKey).markForReview</code></p>\n<p><em>OR</em></p>\n<p><code>Set foo = manager.contracts(cKey).specialConditions.Add</code></p>\n<p>But... it seems that in order to achieve this my arrangement of class objects is becoming nested in an increasingly complex way, e.g:</p>\n<pre><code>manager\n |-collectionClass1\n    |-itemClassA\n       |-collectionClass2\n          |-itemClassB\n\n\n'... and so on.\n</code></pre>\n<p>Is this optimal?</p>\n<h2>Revised approach - flat structure</h2>\n<p>I'm wondering if it wold be better to flatten the arrangement of classes like this:</p>\n<pre><code>manager\n |-collectionClass1\n |-itemClassA\n |-collectionClass2\n |-itemClassB\n</code></pre>\n<p>... and do something like this instead:</p>\n<p><code>manager.markForReview(objSpecialCondition)</code></p>\n<p><em>OR</em></p>\n<p><code>Set foo = manager.specialConditionAdd(objContract)</code></p>\n<hr />\n<h1>Advantages &amp; best practice?</h1>\n<p>I'm really looking for guidance, are there any specific pitfalls to be aware of?</p>\n<p>It now seems to me that the flatter structure may have some advantages, (although I'm not sure if these are real or imagined):</p>\n<ul>\n<li>code reuse / flexibility</li>\n<li>easier to refactor / modify / maintain</li>\n<li>faster with less memory overhead</li>\n</ul>\n<p>I think there are some disadvantages to a flatter structure, specifically it might become more difficult to see relationships between classes. The hierarchical structure of classes provides intuitive intellisense... and I think it makes it harder to introduce bugs? Although that could be addressed with <em>(additional?)</em> validation and use of descriptive variable / object names:</p>\n<p>e.g. <code>contract</code> instead of <code>var1</code></p>\n<p>And I think a flatter structure that uses <code>keys</code> to find items in various collections would be workable, for example:</p>\n<pre><code>If reviewItems.Exists(specialCondition.ID) Then\n    review(specialCondition)\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel", "dependencies", "logic"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1519772204, "post_id": 49018934, "comment_id": 85043831, "body": "You really should use data validation, though - see <a href=\"http://www.contextures.com/xlDataVal02.html\" rel=\"nofollow noreferrer\">here</a> on how to use named ranges to achieve what you&#39;re trying to accomplish."}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1519790677, "last_edit_date": 1519790677, "creation_date": 1519772490, "answer_id": 49019344, "question_id": 49018934, "link": "https://stackoverflow.com/questions/49018934/userform-listbox-that-depends-on-another-listbox/49019344#49019344", "title": "Userform listbox that depends on another listbox", "body": "<p>Data validation is the way to go. You would want to leverage some combination of VBA to adjust the range listbox2 is using after Listbox1 is updated. This is <em>relatively</em> easy if only 1 selection is used on listbox1.</p>\n\n<p>Hopefully you just have one selection, so you could do the following code:</p>\n\n<pre><code>Private Sub ListBox1_Click()\n\nIf ListBox1.Selected(0) = True Then\n    'Selection is apple. Adjust DynamicRange name for A1:A3\n    ThisWorkbook.Names(\"DynamicRange\").RefersTo = Range(\"A1:A3\")\n\nElseIf ListBox1.Selected(1) = True Then\n    ThisWorkbook.Names(\"DynamicRange\").RefersTo = Range(\"B1:B3\")\n\nElseIf ListBox1.Selected(2) = True Then\n    ThisWorkbook.Names(\"DynamicRange\").RefersTo = Range(\"C1:C3\")\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This is based on a setup that looks like this:<a href=\"https://i.stack.imgur.com/X4qbk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X4qbk.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here's what both listbox properties would look like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oeYfG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oeYfG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to download this classy template, <a href=\"https://drive.google.com/file/d/1TIeuIeQNdKay5rABa2Y-p7QN5WPAZIfn/view?usp=sharing\" rel=\"nofollow noreferrer\">click here.</a></p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1519813048, "creation_date": 1519813048, "answer_id": 49027058, "question_id": 49018934, "link": "https://stackoverflow.com/questions/49018934/userform-listbox-that-depends-on-another-listbox/49027058#49027058", "title": "Userform listbox that depends on another listbox", "body": "<p>you could use something like follows (adapt it as per your needs):</p>\n\n<pre><code>Private Sub ListBox1_Click()\n    With Me.ListBox2\n        .Clear\n        .List = Application.Transpose(GetColorItemsRange(Me.ListBox1.value)) 'fill referenced listbox with values from the range returned by GetColorItemsRange function\n    End With\nEnd Sub\n\nFunction GetColorItemsRange(colorValue As String) As Range\n    With Worksheets(\"ColorItames\") ' change \"ColorItames\" with actual name of your worksheet with items associated to colors\n        With .Range(\"A1\", .Cells(1, .Columns.Count).End(xlToLeft)).Find(what:=colorValue, LookIn:=xlValues, lookat:=xlWhole) 'find and reference the referenced sheet row 1 cell matching the passed value\n            Set GetColorItemsRange = .Parent.Range(.Cells.Offset(1), .Cells.End(xlDown)) 'return the range ranging from referenced range down to last not empty cell before first empty cell\n        End With\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5095784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TS4hV.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5095784/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1035, "favorite_count": 0, "accepted_answer_id": 49027058, "answer_count": 2, "score": 1, "last_activity_date": 1519813048, "creation_date": 1519770206, "last_edit_date": 1519802373, "question_id": 49018934, "link": "https://stackoverflow.com/questions/49018934/userform-listbox-that-depends-on-another-listbox", "title": "Userform listbox that depends on another listbox", "body": "<p>I have been looking in the internet for the answer to this, but mostly people say to use data validation, which doesn't really solve my problem. What I'm trying to do is, lets say that I have ListBox1, which has 3 values (red, blue, green) and there's another listbox (ListBox2) where I want value of a list from a worksheet to appear depending on the answer of the first ListBox. For example: I select red from listbox1 and then I want to have the options from the list \"red\" (apple, coke,fire) in listbox2.\nI would greatly appreciate some help in this. Thanks</p>\n"}, {"tags": ["vba", "excel", "function", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519768204, "post_id": 49018450, "comment_id": 85042207, "body": "Do you mean to do <code>NPSCOMPUTE = PourcentagePromoters - PourcentageDetractors</code>?  You never end up giving your <code>NPSCOMPUTE</code> function a value."}, {"owner": {"reputation": 13, "user_id": 9352388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DYyDyOb4cQ0/AAAAAAAAAAI/AAAAAAAAAaA/165osNz-2Bk/photo.jpg?sz=128", "display_name": "Liriscia Savegna", "link": "https://stackoverflow.com/users/9352388/liriscia-savegna"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1519768499, "post_id": 49018450, "comment_id": 85042330, "body": "Right, thanks for your comment ! I have tried to edit my code but it still does not work, I have the same #VALUE issue ..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519768500, "post_id": 49018450, "comment_id": 85042332, "body": "Not sure what you are intending with <code>Promoters = WorksheetFunction.Count(Cell.Value &gt; 8)</code> COUNT does not allow criteria.  I think you need to get rid of both those lines.  Infact I think you can get rid of the loop entirely and use <code>Promoters =Application.WorksheetFunction.Countif(rng,&quot;&gt;=8&quot;)</code> and change to &quot;&lt;=6&quot; for detractors."}, {"owner": {"reputation": 13, "user_id": 9352388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DYyDyOb4cQ0/AAAAAAAAAAI/AAAAAAAAAaA/165osNz-2Bk/photo.jpg?sz=128", "display_name": "Liriscia Savegna", "link": "https://stackoverflow.com/users/9352388/liriscia-savegna"}, "edited": false, "score": 0, "creation_date": 1519768874, "post_id": 49018450, "comment_id": 85042515, "body": "My intention was to count the numbers of values above 8 in order to compute the pourcentage of promoters afterwards. Yet again, even when I get rid the loop I still have this VALUE issue ..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1519769160, "post_id": 49018450, "comment_id": 85042626, "body": "You cannot have the <code>Range(&quot;D1&quot;).Value = &quot;Net Promotor Score&quot;</code> line in a UDF called from the worksheet."}, {"owner": {"reputation": 1654, "user_id": 1793332, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/41e09c9c0f4bb3417737464d90ca709d?s=128&d=identicon&r=PG", "display_name": "MattClarke", "link": "https://stackoverflow.com/users/1793332/mattclarke"}, "edited": false, "score": 0, "creation_date": 1519786366, "post_id": 49018450, "comment_id": 85047721, "body": "You might also want to review your definition of NPS. I believe the standard definition defines promoters as those answering only 9 or 10, not 8. See for instance <a href=\"http://www.npscalculator.com/en\" rel=\"nofollow noreferrer\">npscalculator.com/en</a> and <a href=\"https://www.surveymonkey.com/mp/net-promoter-score-calculation/\" rel=\"nofollow noreferrer\">surveymonkey.com/mp/net-promoter-score-calculation</a>"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519768913, "post_id": 49018653, "comment_id": 85042524, "body": "detractors are not the difference as 7 is nuetral."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519768966, "post_id": 49018653, "comment_id": 85042552, "body": "Oops. Thanks. I will amend."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1519769013, "post_id": 49018653, "comment_id": 85042570, "body": "And if this is being called from the worksheet the <code>Range(&quot;D1&quot;).Value = &quot;Net Promotor Score&quot;</code> will cause an issue."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519769080, "post_id": 49018653, "comment_id": 85042597, "body": "I was assuming not. But yes you can&#39;t have a UDF alter another cell."}, {"owner": {"reputation": 13, "user_id": 9352388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DYyDyOb4cQ0/AAAAAAAAAAI/AAAAAAAAAaA/165osNz-2Bk/photo.jpg?sz=128", "display_name": "Liriscia Savegna", "link": "https://stackoverflow.com/users/9352388/liriscia-savegna"}, "edited": false, "score": 0, "creation_date": 1519770293, "post_id": 49018653, "comment_id": 85043107, "body": "I think you were right regarding <code>Range(&quot;D1&quot;).Value = &quot;Net Promotor Score&quot;</code> line code ! I just have a question regarding the code you wrote : <code>(Rng, &quot;&lt;&gt;&quot; &amp; 7)</code>. It asks excel to count the number of values in the range that are equal, superior and inferior to 7 ? Because the total is supposed to be the total amount of values (including 7) in the range."}, {"owner": {"reputation": 13, "user_id": 9352388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DYyDyOb4cQ0/AAAAAAAAAAI/AAAAAAAAAaA/165osNz-2Bk/photo.jpg?sz=128", "display_name": "Liriscia Savegna", "link": "https://stackoverflow.com/users/9352388/liriscia-savegna"}, "edited": false, "score": 0, "creation_date": 1519771200, "post_id": 49018653, "comment_id": 85043486, "body": "Yes exactly ! Thanks a lot I wasn&#39;t actually aware I could do it without a loop !"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1519788766, "post_id": 49018653, "comment_id": 85048235, "body": "@pnuts  absolutely! Guessing ARange is dynamic named range."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1519789912, "last_edit_date": 1519789912, "creation_date": 1519768840, "answer_id": 49018653, "question_id": 49018450, "link": "https://stackoverflow.com/questions/49018450/vba-function-that-compute-a-formula-net-promoter-score-from-a-list-of-scores/49018653#49018653", "title": "(VBA) Function that compute a formula (Net Promoter Score) from a list of scores", "body": "<p>You didn't correctly name the function return value <code>NPSCOMPUT</code>. But you could also simplify and avoid the loop which doesn't work as you expect.</p>\n\n<p>This</p>\n\n<pre><code>Promoters = WorksheetFunction.Count(Cell.Value &gt; 8)\n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>Promoters = Application.WorksheetFunction.CountIf(Rng, \"&gt;=\" &amp; 8)\n</code></pre>\n\n<p>And so on.</p>\n\n<p>As spotted by @ScottCraner : you can't have a UDF alter another cell with the line</p>\n\n<pre><code> Range(\"D1\").Value = \"Net Promotor Score\"\n</code></pre>\n\n<p>This is listed along with other udf limitations here:</p>\n\n<p><a href=\"https://support.microsoft.com/en-gb/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">Description of limitations of custom functions in Excel</a></p>\n\n<p>Depending on whether blank rows can be present:</p>\n\n<p><code>Total = Rng.Cells.Count</code>  or <code>Application.WorksheetFunction.CountIf(Rng, \"&gt;\" &amp; 0)</code></p>\n\n<pre><code>Public Sub test()\n\nWith ActiveSheet\n\n    MsgBox NPSCOMPUTE(.Range(\"A1:A10\"))\n\nEnd With\n\n\nEnd Sub\n\nPrivate Function NPSCOMPUTE(ByVal Rng As Range) As Double\n\nDim Cell As Range\nDim PourcentagePromoters As Double\nDim PourcentageDetractors As Double\nDim Total As Long\nDim Promoters As Long\nDim Detractors As Long\n\n'Range(\"D1\").Value = \"Net Promotor Score\"\n\nDetractors = 0\nPromoters = 0\n\nTotal = Rng.Cells.Count ' or Application.WorksheetFunction.CountIf(Rng, \"&gt;\" &amp; 0)\nPromoters = Application.WorksheetFunction.CountIf(Rng, \"&gt;=\" &amp; 8)\nDetractors = Application.WorksheetFunction.CountIf(Rng, \"&lt;=\" &amp; 6)\n\nPourcentagePromoters = Promoters / Total\nPourcentageDetractors = Detractors / Total\n\nNPSCOMPUTE = 100 * (PourcentagePromoters - PourcentageDetractors)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9352388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DYyDyOb4cQ0/AAAAAAAAAAI/AAAAAAAAAaA/165osNz-2Bk/photo.jpg?sz=128", "display_name": "Liriscia Savegna", "link": "https://stackoverflow.com/users/9352388/liriscia-savegna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 49018653, "answer_count": 1, "score": 0, "last_activity_date": 1519789912, "creation_date": 1519767963, "question_id": 49018450, "link": "https://stackoverflow.com/questions/49018450/vba-function-that-compute-a-formula-net-promoter-score-from-a-list-of-scores", "title": "(VBA) Function that compute a formula (Net Promoter Score) from a list of scores", "body": "<p>I am currently trying to create a function that compute the Net Promotor Score from a list of score ranked between 0 and 10. You can compute the NPS with this formula (the formula I am trying to code) : </p>\n\n<ul>\n<li>the pourcentage of scores above 8 (so 8, 9, 10) - the pourcentage of scores below 6 (so 6, 5, 4, 3, 2, 1 and 0)</li>\n</ul>\n\n<p>So I created this code below (with Rng as the range of cells I will choose when writing my formula) which does not seem to work. I have defined every values and still, the #VALUE error appears. Could someone please explain me where my mistakes are ?</p>\n\n<pre><code>Function NPSCOMPUTE(Rng As Range)\n\nDim Cell As Range\nDim NPS As Integer\nDim PourcentagePromoters As Integer\nDim PourcentageDetractors As Integer\nDim Total As Integer\nDim Promoters As Integer\nDim Detractors As Integer\n\nRange(\"D1\").Value = \"Net Promotor Score\"\nDetractors = 0\nPromoters = 0\n\nTotal = WorksheetFunction.Sum(Rng)\n\nFor Each Cell In Rng\n    If Cell.Value &gt;= 8 Then\n    Promoters = WorksheetFunction.Count(Cell.Value &gt; 8)\n    Promoters = Promoters + 1\n    ElseIf Cell.Value &lt;= 6 Then\n    Detractors = WorksheetFunction.Count(Cell.Value &lt; 6)\n    Detractors = Detractors + 1\n    End If\nNext Cell\n\nPourcentagePromoters = (Promoters * 100) / Total\nPourcentageDetractors = (Detractors * 100) / Total\nNPS = PourcentagePromoters - PourcentageDetractors\n\nEnd Function\n</code></pre>\n\n<p>I hope someone will be able to help me out, thanks a lot !</p>\n"}, {"tags": ["mysql", "vba", "excel", "datatables"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519767137, "post_id": 49018165, "comment_id": 85041675, "body": "Basically you want to flatten everything according to matching engagement ID, but the result could still be &quot;ragged&quot; edged if there isn&#39;t a nice neat compression by ID? So there is no real relation for reading across a row except that it is information for the ID for that column header? i.e. each row does not constitute a record."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519767212, "post_id": 49018165, "comment_id": 85041706, "body": "Are IDs always sequential or can they be spaced out?"}, {"owner": {"reputation": 47, "user_id": 8120930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65e6a60398ac8e46b6c898f08b1fdae6?s=128&d=identicon&r=PG&f=1", "display_name": "Matt G", "link": "https://stackoverflow.com/users/8120930/matt-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519939002, "post_id": 49018165, "comment_id": 85122529, "body": "I&#39;m not sure I know what you mean by IDs being spaced out? As far as your initial questions, I think you have it right- one row does not constitute a record (unless that row only has information for one phase). Instead, one row is created for each instance of a phase, and one record would be formed by taking the information from each phase for a given ID (two records would be formed for the same ID if there were two instances from one or more of the phases). hope this helps answer your questions"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519939072, "post_id": 49018165, "comment_id": 85122570, "body": "i meant is it always 201, 201,202... or  can it be 201,202,203,204,201,201..."}, {"owner": {"reputation": 47, "user_id": 8120930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65e6a60398ac8e46b6c898f08b1fdae6?s=128&d=identicon&r=PG&f=1", "display_name": "Matt G", "link": "https://stackoverflow.com/users/8120930/matt-g"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520004179, "post_id": 49018165, "comment_id": 85149751, "body": "Oh ok. No, they will all be chunked together- the system I am using to export this data has the option to sort Engagement ID asc/desc"}], "answers": [{"tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": false, "score": 1, "last_activity_date": 1519768082, "creation_date": 1519768082, "answer_id": 49018482, "question_id": 49018165, "link": "https://stackoverflow.com/questions/49018165/how-do-i-use-vba-to-flatten-a-table-in-excel-where-data-is-split-between-rows/49018482#49018482", "title": "How do I use VBA to flatten a table in Excel where data is split between rows?", "body": "<p>You can use <strong>Power Query</strong> to handle this easily. It is an add-inn you can get for free and activate in Excel 2010+ (by default in Excel 2016 known as Get &amp; Transform). There you can connect directly your source and edit your data as you want. For your particular case follow this steps:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TFM1Z.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TFM1Z.gif\" alt=\"\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2iTz4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2iTz4.png\" alt=\"\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 8120930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65e6a60398ac8e46b6c898f08b1fdae6?s=128&d=identicon&r=PG&f=1", "display_name": "Matt G", "link": "https://stackoverflow.com/users/8120930/matt-g"}, "edited": false, "score": 0, "creation_date": 1519834656, "post_id": 49027099, "comment_id": 85072721, "body": "Hey thanks for the response. Unfortunately, this did not work- using the example in my original post (3rd table), the code you&#39;ve posted shifts the B columns up correctly so that the first record with a B value is on the same row as the first record with an A value (and the second record with a B value is on the 2nd row), but the C columns only shift up 1 relative to the B columns, so that the 5/20-Pending record is on the 2nd row and the 5/15-Submitted record is on the 3rd row (the first occurrence of a value for any of the columns should be on the first row). Again, thanks anyways."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1519892996, "last_edit_date": 1519892996, "creation_date": 1519813170, "answer_id": 49027099, "question_id": 49018165, "link": "https://stackoverflow.com/questions/49018165/how-do-i-use-vba-to-flatten-a-table-in-excel-where-data-is-split-between-rows/49027099#49027099", "title": "How do I use VBA to flatten a table in Excel where data is split between rows?", "body": "<p><strong>EDITED</strong></p>\n\n<pre><code>Option Explicit\n\nSub test()\n\nDim i As Long               ' loop\nDim iRow As Long            ' actual row to process\nDim i1stEmpy As Long        ' 1st empty cell\nDim iBlkStart As Long       ' this block starts here\n\nConst colEngID = 2\nConst colAdate = colEngID + 1\nConst colAstat = colAdate + 1\nConst colBdate = colAstat + 1\nConst colBstat = colBdate + 1\nConst colCdate = colBstat + 1\nConst colCstat = colCdate + 1\n\niRow = 2        ' skip header row\nDo While Trim$(Cells(iRow, 1)) &lt;&gt; vbNullString\n    iBlkStart = iRow        ' 1st row of block of the same engagement\n    For i = 0 To 2\n        iRow = iBlkStart\n        i1stEmpy = 0           ' next data comes here\n        Do While Cells(iRow, colEngID) = Cells(iBlkStart, colEngID)\n            If Trim$(Cells(iRow, colAdate + 2 * i)) = vbNullString Then\n               If i1stEmpy = 0 Then i1stEmpy = iRow        ' set 1st empty cell\n            Else\n                If iRow &lt;&gt; iBlkStart And iRow &lt;&gt; i1stEmpy And i1stEmpy &gt; 0 Then ' some data found\n                    Cells(i1stEmpy, colAdate + 2 * i) = Cells(iRow, colAdate + 2 * i)  ' copy cell from below\n                    Cells(i1stEmpy, colAstat + 2 * i) = Cells(iRow, colAstat + 2 * i)  ' copy cell from below\n                    Cells(iRow, colAdate + 2 * i).Clear  ' clear cell\n                    Cells(iRow, colAstat + 2 * i).Clear  ' clear cell\n                    i1stEmpy = i1stEmpy + 1         ' set to next empty\n                End If\n            End If\n            iRow = iRow + 1\n        Loop\n    Next i\n    ' delete empty rows\n    iRow = iBlkStart\n    Do While Cells(iRow, colEngID) = Cells(iBlkStart, colEngID)\n        If Trim$(Cells(iRow, colAdate)) = vbNullString And Trim$(Cells(iRow, colBdate)) = vbNullString And Trim$(Cells(iRow, colCdate)) = vbNullString Then    ' all cells are empty\n            Cells(iRow, 1).EntireRow.Delete\n        Else\n            iRow = iRow + 1\n        End If\n    Loop\nLoop ' irow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8120930, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/65e6a60398ac8e46b6c898f08b1fdae6?s=128&d=identicon&r=PG&f=1", "display_name": "Matt G", "link": "https://stackoverflow.com/users/8120930/matt-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1519892996, "creation_date": 1519766659, "question_id": 49018165, "link": "https://stackoverflow.com/questions/49018165/how-do-i-use-vba-to-flatten-a-table-in-excel-where-data-is-split-between-rows", "title": "How do I use VBA to flatten a table in Excel where data is split between rows?", "body": "<p>I currently have a raw data table in Excel that summarizes the status of Phases A, B, and C for a given Engagement. Some Engagements may not have data for all 3 phases.</p>\n\n<pre><code>Row| EngagementID | A_date | A_status | B_date | B_status | C_date | C_status\n1  |      201     |   2/2  | Approved |        |          |        |          \n2  |      201     |        |          |  3/5   | Approved |        |          \n3  |      201     |        |          |        |          |  4/1   |  Pending  \n4  |      203     |   2/12 | Submitted|        |          |        |          \n5  |      203     |        |          |  2/20  | Approved |        |          \n6  |      207     |   2/5  | Approved |        |          |        |          \n</code></pre>\n\n<p>I am trying to flatten the table to look like this:</p>\n\n<pre><code>Row| EngagementID | A_date | A_status | B_date | B_status | C_date | C_status\n1  |      201     |   2/2  | Approved |  3/5   | Approved |  4/1   |  Pending \n2  |      203     |   2/12 | Submitted|  2/20  | Approved |        |         \n3  |      207     |   2/5  | Approved |        |          |        |          \n</code></pre>\n\n<hr>\n\n<h2>The Issue: Multiple Instances</h2>\n\n<p>There are, however, circumstances where the same EngagementID has multiple instances. For example, it may have the following:</p>\n\n<pre><code>    Row| EngagementID | A_date | A_status | B_date | B_status | C_date | C_status\n    1  |      201     |   2/2  | Approved |        |          |        |          \n    2  |      201     |        |          |  3/5   | Approved |        |          \n    3  |      201     |        |          |  3/18  | Pending  |        |           \n    4  |      201     |        |          |        |          |  5/20  |  Pending  \n    5  |      201     |        |          |        |          |  5/15  |  Submitted\n</code></pre>\n\n<p>I am trying to make the VBA flexible enough so that, in these cases, the table would be transformed to </p>\n\n<pre><code>Row| EngagementID | A_date | A_status | B_date | B_status | C_date | C_status\n1  |      201     |   2/2  | Approved |  3/5   | Approved |  5/20  |  Pending \n2  |      201     |   2/2  | Approved |  3/18  | Pending  |  5/15  |  Submitted\n</code></pre>\n\n<p>I am able to solve the single instance aspect with the following VBA code:</p>\n\n<pre><code>Private Sub test()\nDim R As Long\nDim i As Integer\ni = 1\nR = 2\nCount = 0\nDo While Not IsEmpty(Range(\"A\" &amp; R))\n    If Cells(R, 1).Value = Cells(R + 1, 1).Value Then\n        Count = Count + 1\n    Else\n        i = 1\n        Do While i &lt;= Count\n            Cells(R - Count, 2 + (2 * i)).Value = Cells(R - Count + i, 2 + (2 * i))\n            Cells(R - Count, 3 + (2 * i)).Value = Cells(R - Count + i, 3 + (2 * i))\n            i = i + 1\n        Loop\n            i = 1\n            Do While i &lt;= Count\n                Rows(R - Count + i).Delete\n                i = i + 1\n                R = R - 1\n            Loop\n        Count = 0\n    End If\nR = R + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>However, this does not account for the multiple instances.\nAny ideas as to where I might be able to adjust the VBA to accommodate for this \"multiple-instance\" scenario would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519767449, "post_id": 49018164, "comment_id": 85041823, "body": "The suggested alternative is not suitable for me unfortunately"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519767514, "post_id": 49018164, "comment_id": 85041852, "body": "Why not?  Please put what you have tried so we can help overcome the specific problem."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519768499, "post_id": 49018164, "comment_id": 85042331, "body": "Hi, I have added some code which I have tried to adapt for my needs."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1519768613, "post_id": 49018164, "comment_id": 85042387, "body": "Why not sort the two columns first on F then on G and use the load from above?  It will be quicker than looping."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1519768868, "post_id": 49018164, "comment_id": 85042510, "body": "I have tried this when I tried originally and the excel goes into a none responsive state."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1519769307, "post_id": 49018164, "comment_id": 85042689, "body": "Post the code you used which was non responsive."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519769360, "post_id": 49018164, "comment_id": 85042717, "body": "I am unable to do fill from above because some of the values will be 0 and they will not have a matching value in the column to the left. Sub split()     Dim columnValues  As Range, i As Long      Set columnValues = Selection      For i = 1 To columnValues.Rows.Count         If columnValues.Cells(i, 1).Value = &quot;&quot; Then             columnValues.Cells(i, 1).Value = columnValues.Cells(i - 1, 1).Value         End If     Next End Sub"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519769915, "post_id": 49018164, "comment_id": 85042943, "body": "Is this not a duplicate? I am sure i basically answered this question already though I deleted my answer when the question started to be changed. This question: <a href=\"https://stackoverflow.com/questions/49015763/lookup-function-for-matching-ids-and-then-populating-an-additional-value-vloo\" title=\"lookup function for matching ids and then populating an additional value vloo\">stackoverflow.com/questions/49015763/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519770161, "post_id": 49018164, "comment_id": 85043054, "body": "Your title says A &amp; B then you refer to F &amp; G. You changed the requirements in the last question so I am not posting my answer again (or making the minor amendment) unless this is clarified as what you actually want with the final columns."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519770570, "post_id": 49018164, "comment_id": 85043214, "body": "Hi, I have just changed the question to reflect what I am looking for. In regards to the other question, I went with the other answer as it was easier to interpret. I am new to VBA, so looking to learn skills that I can use with other things."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519809652, "post_id": 49019095, "comment_id": 85056407, "body": "Hi, with this I get subscript out of range when I run the program on line:       If Not IsEmpty(dataArr(currentRow, 4)) And Not dict.Exists  (dataArr  (currentRow, 1)) Then"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519809684, "post_id": 49019095, "comment_id": 85056430, "body": "on which line is it?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519810067, "post_id": 49019095, "comment_id": 85056643, "body": "Did you check the code above? Sorry, I updated almost immediately after posting and the 4 become a 2.  I should have made clearer. My bad."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1519810324, "post_id": 49019095, "comment_id": 85056834, "body": "Hi, I have accepted your answer it has worked very well. Thank you for your patience!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1519771015, "creation_date": 1519771015, "answer_id": 49019095, "question_id": 49018164, "link": "https://stackoverflow.com/questions/49018164/checking-a-value-in-column-f-and-checking-in-column-g-for-a-value-existing/49019095#49019095", "title": "checking a value in column F and checking in Column G for a value existing", "body": "<p>Something like as follows? I need to do a quick syntax check on other machine.</p>\n\n<pre><code>Sub test()\n\nDim wb As Workbook\nSet wb = ThisWorkbook\n\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Roots data\")\n\nlastRow = ws.Cells(ws.Rows.Count, \"F\").End(xlUp).Row\n\nDim dataArr()\n\ndataArr = ws.Range(\"F1:G\" &amp; lastRow).Value\nDim currentRow As Long\nDim dict As Object\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nFor currentRow = LBound(dataArr, 1) To UBound(dataArr, 1)\n\n    If Not IsEmpty(dataArr(currentRow, 2)) And Not dict.exists(dataArr(currentRow, 1)) Then\n        dict.Add dataArr(currentRow, 1), dataArr(currentRow, 2)\n    End If\n\nNext currentRow\n\nFor currentRow = LBound(dataArr, 1) To UBound(dataArr, 1)\n\n    If IsEmpty(dataArr(currentRow, 2)) Then\n\n        dataArr(currentRow, 2) = dict(dataArr(currentRow, 1))\n\n    End If\n\nNext currentRow\n\nws.Range(\"F1\").Resize(UBound(dataArr, 1), UBound(dataArr, 2)) = dataArr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 49019095, "answer_count": 1, "score": 0, "last_activity_date": 1519771015, "creation_date": 1519766654, "last_edit_date": 1531164843, "question_id": 49018164, "link": "https://stackoverflow.com/questions/49018164/checking-a-value-in-column-f-and-checking-in-column-g-for-a-value-existing", "title": "checking a value in column F and checking in Column G for a value existing", "body": "<p>I am in the process of automating a day to day process. I have ID's in column F and ID2's in column G. How could I write a VBA for filling in the blanks if the IDs in column F are the same? IE ID 123 will always have the ID of 1. In some cases the ID to be used is not the one from above.</p>\n\n<p>Test data:</p>\n\n<pre><code>ID       ID2\n123      1\n123      *Blank*\n456      56\n456      *Blank*\n456      *Blank*\n789      23\n</code></pre>\n\n<p>I have utilized some existing stackoverflow code and tried to adapt it for my needs.\nCode:\n     Sub FindingtheBID()</p>\n\n<pre><code> Dim sht As Worksheet, lastrow As Long, i As Long, j As Long\n\n Set sht = ThisWorkbook.Worksheets(\"Roots data\")\n lastrow = sht.Cells(sht.Rows.Count, \"F\").End(xlUp).Row\n\n  For i = 1 To lastrow\n  If Range(\"G\" &amp; i).Value = \"\" Then\n    For j = 1 To lastrow\n        If Range(\"C\" &amp; i).Value = Range(\"F\" &amp; j).Value And Range(\"G\" &amp; \n     j).Value &lt;&gt; \"\" Then\n            Range(\"H\" &amp; i).Value = Range(\"G\" &amp; j).Value\n            Exit For\n        End If\n    Next j\n End If\n Next i\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "object", "textbox", "userform"], "answers": [{"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 0, "last_activity_date": 1519767108, "creation_date": 1519767108, "answer_id": 49018266, "question_id": 49018107, "link": "https://stackoverflow.com/questions/49018107/unhiding-textboxes/49018266#49018266", "title": "Unhiding textboxes", "body": "<p>You were very close!  Try this:</p>\n\n<pre><code>For i = 13 To 100\n   Me.Controls(\"tb\" &amp; i).Visible = True\nNext\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7427591, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/696233257221022/picture?type=large", "display_name": "Martin", "link": "https://stackoverflow.com/users/7427591/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 49018266, "answer_count": 1, "score": 0, "last_activity_date": 1519767108, "creation_date": 1519766365, "question_id": 49018107, "link": "https://stackoverflow.com/questions/49018107/unhiding-textboxes", "title": "Unhiding textboxes", "body": "<p>I would like to ask you to help me with textboxes in userform. I have 3 multipgaes, first one is used to enter input data. Second one is to insert invoice number and amounts for each invoice. I have there 200 textboxes, but only 24 are visible (12 for invoice number and 12 for amount). \nThis page contains checkbox in case somebody wants to enter more than 12 invoices. How can I unhide all those invoices with VBA code? I don't want to copy paste the same code almost 200 times: <code>me.tb1.visible = true, me.tb2.visible = true</code> ...\nI tried it with cycle but doesn't work:</p>\n\n<pre><code>for i = 13 to 100\n   me.tb(i).visible = true\nnext i\n</code></pre>\n\n<p>I was trying to find something like </p>\n\n<pre><code>dim Utextbox as textbox\n\nfor each Utextbox in VBA.userforms\n    [code]\nnext \n</code></pre>\n\n<p>Please help me to solve this issue. Thank you</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 1, "creation_date": 1519766835, "post_id": 49018178, "comment_id": 85041536, "body": "You are absolutely right.  I completely overlooked that :/ Thanks!!"}], "tags": [], "owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "is_accepted": true, "score": 0, "last_activity_date": 1519766695, "creation_date": 1519766695, "answer_id": 49018178, "question_id": 49017953, "link": "https://stackoverflow.com/questions/49017953/access-weirdness-when-converting-filtering-user-entered-text/49018178#49018178", "title": "Access Weirdness when converting / filtering user entered text", "body": "<p>I think you're not returning a value properly.</p>\n\n<pre><code>Function gUC(ByVal gKey As Integer) As Integer\n    Select Case gKey\n        Case 47 To 57\n            gUC= gKey\n        Case 97 To 122\n            gUC= gKey - 32\n        Case Else\n            gUC= 0\n    End Select\nEnd Function \n</code></pre>\n"}], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12, "favorite_count": 0, "accepted_answer_id": 49018178, "answer_count": 1, "score": 0, "last_activity_date": 1519766695, "creation_date": 1519765660, "question_id": 49017953, "link": "https://stackoverflow.com/questions/49017953/access-weirdness-when-converting-filtering-user-entered-text", "title": "Access Weirdness when converting / filtering user entered text", "body": "<p>Can someone explain why this works:</p>\n\n<pre><code>Private Sub PartNum_KeyPress(KeyAscii As Integer)\n    Select Case KeyAscii\n        Case 47 To 57\n            KeyAscii = KeyAscii\n        Case 97 To 122\n            KeyAscii = KeyAscii - 32\n        Case Else\n            KeyAscii = 0\n    End Select\nEnd Sub\n</code></pre>\n\n<p>but why this doesn't work:</p>\n\n<pre><code>Function gUC(ByVal gKey As Integer) As Integer\n    Select Case gKey\n        Case 47 To 57\n            gKey = gKey\n        Case 97 To 122\n            gKey = gKey - 32\n        Case Else\n            gKey = 0\n    End Select\nEnd Function\n\nPrivate Sub PartNum_KeyPress(KeyAscii As Integer)\n    KeyAscii = gUC(KeyAscii)\nEnd Sub\n</code></pre>\n\n<p>I have multiple fields on my form that I'd like to filter like this and would rather just one function to call rather than re-writing the code for every field</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519767368, "post_id": 49017911, "comment_id": 85041781, "body": "p_Month would have to be a named range to work in that way (if your actual cell says that) and that named range would need to contain &quot;February&quot;"}, {"owner": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "edited": false, "score": 0, "creation_date": 1519768120, "post_id": 49017911, "comment_id": 85042160, "body": "I feel like there has to be a better way. Why does it need to be the variable name? How is the rest of this structured/functioning?"}, {"owner": {"reputation": 11, "user_id": 9366933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TggjbRVTZY4/AAAAAAAAAAI/AAAAAAAABYE/AfAfB2KwA6Y/photo.jpg?sz=128", "display_name": "Peter Reiser", "link": "https://stackoverflow.com/users/9366933/peter-reiser"}, "edited": false, "score": 0, "creation_date": 1519815079, "post_id": 49017911, "comment_id": 85059838, "body": "Sorry I was not clear in my example: p_month is a VBA variable I use in the code. e.g. p_month is a variable from a dropdown value if a form"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1519767901, "last_edit_date": 1519767901, "creation_date": 1519767546, "answer_id": 49018366, "question_id": 49017911, "link": "https://stackoverflow.com/questions/49017911/store-text-and-variable-in-a-cell-and-assign-it-to-variable/49018366#49018366", "title": "Store text and variable in a cell and assign it to variable", "body": "<p>p_Month would have to be a <a href=\"http://www.contextures.com/xlNames01.html\" rel=\"nofollow noreferrer\">named range</a> to work in that way (if your actual cell says that) and that named range would need to contain \"February\"</p>\n\n<p>so create a named range called p_Month using Name Manager. Then in that named range (single cell will do) put the text \"January\".</p>\n\n<p>Then in A1 put </p>\n\n<pre><code>=\"Current Month: \" &amp; p_Month\n</code></pre>\n\n<p><strong>Example named range</strong> (see name box top left) </p>\n\n<p><a href=\"https://i.stack.imgur.com/lR0N5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lR0N5.png\" alt=\"Named Range\"></a></p>\n\n<p><strong>Testing code</strong> (Change sheet name as appropriate):</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Testing()\n\nDim Mail_Subject As String\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nMail_Subject = ws.Range(\"A1\").Value\n\nMsgBox Mail_Subject\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9366933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TggjbRVTZY4/AAAAAAAAAAI/AAAAAAAABYE/AfAfB2KwA6Y/photo.jpg?sz=128", "display_name": "Peter Reiser", "link": "https://stackoverflow.com/users/9366933/peter-reiser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 654, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519822001, "creation_date": 1519765468, "last_edit_date": 1531164843, "question_id": 49017911, "link": "https://stackoverflow.com/questions/49017911/store-text-and-variable-in-a-cell-and-assign-it-to-variable", "title": "Store text and variable in a cell and assign it to variable", "body": "<p>I am storing Text and Variable in a cell \ne.g.   Cell A1 contains \"Current Month: \" &amp;   p_Month </p>\n\n<pre><code>Mail_Subject = WS.Range(\"A1\").value\n</code></pre>\n\n<p>but <code>MsgBox (Mail_Subject)</code> shows <strong>\"Current Month: \" &amp;   p_Month</strong> </p>\n\n<p>instead <strong>Current Month: February</strong> </p>\n\n<p>How can I get the variable interpreted ? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1847, "user_id": 4821032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-6FsncWlTseQ/AAAAAAAAAAI/AAAAAAAAACg/aRL-ouiTMog/photo.jpg?sz=128", "display_name": "Xan-Kun Clark-Davis", "link": "https://stackoverflow.com/users/4821032/xan-kun-clark-davis"}, "edited": false, "score": 0, "creation_date": 1519769901, "post_id": 49017742, "comment_id": 85042939, "body": "What exactly does not work?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1519766252, "last_edit_date": 1519766252, "creation_date": 1519765887, "answer_id": 49018007, "question_id": 49017742, "link": "https://stackoverflow.com/questions/49017742/replicate-a-tab-in-excel/49018007#49018007", "title": "Replicate a tab in excel", "body": "<p>You are overwriting the range for one thing here:</p>\n\n<pre><code>Set MyRange = Sheets(\"List\").Range(\"A2\") 'Must change tab name\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n</code></pre>\n\n<p>When I think you want to actually create the range to loop over. Note  <code>MyRange.End(xlDown)</code> will take you down to the last non-blank cell in the range rather than the last used row.</p>\n\n<p>So, I have changed your syntax to find the last row, stored in a variable, and use that to define the loop range.</p>\n\n<pre><code>    lastRow = ws.Range(\"A2\").End(xlDown).Row\n\n    Set MyRange = ws.Range(\"A2:A\" &amp; lastRow)\n</code></pre>\n\n<p>Then I have put the List worksheet in a variable so you don't need to go backwards and forward selecting sheets.</p>\n\n<pre><code>   Dim ws As Worksheet\n   Set ws = ThisWorkbook.Worksheets(\"List\")\n</code></pre>\n\n<p>This means that whenever you add a sheet, which will become the activesheet, you  can simply refer access the MyCell value as it is qualified by the sheet name it came from.</p>\n\n<p>This,</p>\n\n<pre><code>Sheets(Sheets.Count).Name = MyCell.Value &amp; \"-\"\n</code></pre>\n\n<p>Looks a bit dodgy in terms of naming. Sort of looks unfinished. However, that should be enough to get you going.</p>\n\n<pre><code>Option Explicit\n\nSub CreateNewSheet()\n\n   Dim MyCell As Range\n   Dim MyRange As Range\n   Dim ws As Worksheet\n   Dim lastRow As Long\n\n   Set ws = ThisWorkbook.Worksheets(\"List\")\n   lastRow = ws.Range(\"A2\").End(xlDown).Row\n\n    Set MyRange = ws.Range(\"A2:A\" &amp; lastRow)\n    Dim counter\n\n    For Each MyCell In MyRange\n\n        Sheets(\"Template\").Copy After:=Sheets(Sheets.Count) 'creates a new worksheet\n        ActiveSheet.Range(\"E5\") = MyCell\n        Sheets(Sheets.Count).Name = MyCell.Value &amp; \"-\" ' renames the new worksheet\n\n    Next MyCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9420917, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215277818928867/picture?type=large", "display_name": "Shane Russell", "link": "https://stackoverflow.com/users/9420917/shane-russell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 49018007, "answer_count": 1, "score": 0, "last_activity_date": 1519766252, "creation_date": 1519764653, "last_edit_date": 1519764684, "question_id": 49017742, "link": "https://stackoverflow.com/questions/49017742/replicate-a-tab-in-excel", "title": "Replicate a tab in excel", "body": "<p>I have a template (named template in the code) and a list of store numbers ( named list in the code).  I want to create a new worksheet identical to the template, but replace one cell (E5) with the next number in the list.  I have this code but it doesn't seem to work.  Any ideas? :</p>\n\n<pre><code>Sub CreateNewSheet()\n    Dim MyCell As Range, MyRange As Range\n\n    Set MyRange = Sheets(\"List\").Range(\"A2\") 'Must change tab name\n    Set MyRange = Range(MyRange, MyRange.End(xlDown))\n\n    For Each MyCell In MyRange\n        Sheets(\"Template\").Copy After:=Sheets(Sheets.Count) 'creates a new worksheet\n        Sheets(\"List\").Select\n        MyCell.Select\n        Selection.Copy\n        Sheets(Sheets.Count).Select\n        Range(\"E5\").Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Sheets(Sheets.Count).Name = MyCell.Value &amp; \"-\" ' renames the new worksheet\n            Range(\"E5\").Select 'Puts driver name in cell\n\n\n    Next MyCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sap"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519764168, "post_id": 49017515, "comment_id": 85040262, "body": "You&#39;re going to need a loop <i>somewhere</i>... Have you tried looking up things like &quot;vba excel loop range&quot;?"}, {"owner": {"reputation": 17, "user_id": 9205849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/098d200f387dc25d9e27fb641601c90a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/9205849/ryan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1519764584, "post_id": 49017515, "comment_id": 85040481, "body": "I&#39;ve tried to loop it a few times either using For row = 2 To numRows Do Until IsEmpty(ActiveCell) but I have not been successful"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1519764839, "post_id": 49017515, "comment_id": 85040602, "body": "See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - we can&#39;t know what you&#39;ve tried and whether you&#39;ve put any effort researching the problem if you don&#39;t include it in your post."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519764842, "post_id": 49017515, "comment_id": 85040606, "body": "Why not include the code with the loop? Not working is why you are here and what we can help with. If you share the code and explain the problem."}, {"owner": {"reputation": 17, "user_id": 9205849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/098d200f387dc25d9e27fb641601c90a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/9205849/ryan"}, "edited": false, "score": 0, "creation_date": 1519915463, "post_id": 49017515, "comment_id": 85108749, "body": "Sorry for not adding the loop code initially, I just sent the part that had been working for at least one of the records. Thanks for the help everyone!"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1519766635, "post_id": 49018117, "comment_id": 85041458, "body": "if possible avoid redim preserve, certainly within a loop. You can oversize at start, use a counter variable in the loop and resize the array at the end."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1519766813, "post_id": 49018117, "comment_id": 85041528, "body": "Thanks a lot. I have added another option"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 1, "last_activity_date": 1519766795, "last_edit_date": 1519766795, "creation_date": 1519766411, "answer_id": 49018117, "question_id": 49017515, "link": "https://stackoverflow.com/questions/49017515/insert-a-row-after-every-instance-of-specific-text/49018117#49018117", "title": "Insert a Row after every instance of specific text", "body": "<p>Try this code</p>\n\n<pre><code>Sub Test()\nDim a()         As Variant\nDim found       As Range\nDim fStr        As String\nDim fAdd        As String\nDim i           As Long\n\nfStr = \"HDR\"\nSet found = Cells.Find(What:=fStr, After:=Range(\"A1\"), LookIn:=xlValues, LookAt:=xlWhole)\n\nIf Not found Is Nothing Then\n    fAdd = found.Address\n\n    Do\n        ReDim Preserve a(i)\n        a(i) = found.Offset(1).Address\n        i = i + 1\n        Set found = Cells.FindNext(found)\n    Loop Until found.Address = fAdd\nEnd If\n\nIf i = 0 Then Exit Sub\nFor i = UBound(a) To LBound(a) Step -1\n    Range(a(i)).EntireRow.Insert\nNext i\nEnd Sub\n</code></pre>\n\n<p>Another option</p>\n\n<pre><code>Sub Test()\nDim a()         As Variant\nDim oRange      As Range\nDim found       As Range\nDim fStr        As String\nDim fAdd        As String\n\nfStr = \"HDR\"\nSet found = Cells.Find(What:=fStr, After:=Range(\"A1\"), LookIn:=xlValues, LookAt:=xlWhole)\n\nIf Not found Is Nothing Then\n    fAdd = found.Address\n\n    Do\n        If oRange Is Nothing Then Set oRange = found.Offset(1) Else Set oRange = Union(oRange, found.Offset(1))\n        Set found = Cells.FindNext(found)\n    Loop Until found.Address = fAdd\nEnd If\n\nIf Not oRange Is Nothing Then oRange.EntireRow.Insert\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1519767467, "creation_date": 1519767467, "answer_id": 49018351, "question_id": 49017515, "link": "https://stackoverflow.com/questions/49017515/insert-a-row-after-every-instance-of-specific-text/49018351#49018351", "title": "Insert a Row after every instance of specific text", "body": "<pre><code>Sub NewRowInsert()\n\n    Dim SearchText As String\n    Dim GCell As Range\n    Dim NumSearches As Integer\n    Dim i As Integer\n\n    SearchText = \"HDR\"\n    NumSearches = WorksheetFunction.CountIf(Cells, SearchText)\n    Set GCell = Cells(1, 1)\n\n    For i = 1 To NumSearches\n\n        Set GCell = Cells.Find(SearchText, After:=GCell, SearchOrder:=xlByRows, SearchDirection:=xlNext).Offset(1)\n        GCell.EntireRow.Insert\n\n    Next i\n\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9205849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/098d200f387dc25d9e27fb641601c90a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/9205849/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 49018117, "answer_count": 2, "score": 0, "last_activity_date": 1519767467, "creation_date": 1519763818, "last_edit_date": 1531164843, "question_id": 49017515, "link": "https://stackoverflow.com/questions/49017515/insert-a-row-after-every-instance-of-specific-text", "title": "Insert a Row after every instance of specific text", "body": "<p>I'm looking to insert a new blank row after every instance of HDR in the sheet. I cannot figure out how to make the code move beyond the first instance to continue through the rest of the sheet.</p>\n\n<pre><code> Sub NewRowInsert()\n\n    Dim SearchText As String\n    Dim GCell As Range\n\n    SearchText = \"HDR\"\n    Set GCell = Cells.Find(SearchText).Offset(1)\n    GCell.EntireRow.Insert\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "connection-string", "ms-jet-ace", "vba"], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519802339, "creation_date": 1519762390, "last_edit_date": 1531164843, "question_id": 49017167, "link": "https://stackoverflow.com/questions/49017167/vba-machine-info-and-or-drivers-available", "title": "VBA machine info and/or drivers available", "body": "<p>We have some code in VBA that uses a connection string to open an MDB.</p>\n\n<p>We have found that the connection string has to change depending on the machine - it <em>seems</em> that .Jet.4 is no longer available on modern OS's (?) and that we need to use ACE.12 instead. But other machines support Jet.4 fine.</p>\n\n<p>Great, so how do we write VBA that knows which string to use? Is there a way to get a list of installed drivers, or some other solution to this problem?</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1519766929, "post_id": 49016990, "comment_id": 85041587, "body": "For non-default folder try ItemAdd. You will need to know how to reference a non-default folder. Search and you will find many results."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1519792261, "creation_date": 1519792261, "answer_id": 49022013, "question_id": 49016990, "link": "https://stackoverflow.com/questions/49016990/event-listener-for-inbox-of-second-account/49022013#49022013", "title": "Event listener for inbox of second account", "body": "<p><em>You will need to access your second account by folder name via <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/application-session-property-outlook\" rel=\"nofollow noreferrer\">Application.Session.Folders</a></em></p>\n\n<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/aa220100(v=office.11).aspx\" rel=\"nofollow noreferrer\">GetDefaultFolder</a> will not work for other stores, or mailboxes.</em></p>\n\n<p><em>Or you could use <code>For Each oAccount In Application.Session.Accounts</code> to get the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa220100(v=office.11).aspx\" rel=\"nofollow noreferrer\">GetDefaultFolder</a> but if you already know the account name <strong><code>fakeemail@outlook.com</code></strong> then not use it.</em></p>\n\n<p><em>Example</em></p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\nPrivate Sub Application_Startup()\n    Dim olNs As Outlook.NameSpace\n    Dim Inbox  As Outlook.Folder\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.Folders(\"fakeemail@outlook.com\") _\n                    .Folders(\"Inbox\")\n    Set Items = Inbox.Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n    If TypeOf Item Is Outlook.mailitem Then\n        Debug.Print Item.Subject\n    End If    \nEnd Sub\n</code></pre>\n\n<p><strong><em>FYI Code goes to <code>ThisOutlookSession</code></em></strong></p>\n"}], "owner": {"reputation": 11, "user_id": 8933949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18898fd1fd6a926494a2cb4a57bd9afa?s=128&d=identicon&r=PG&f=1", "display_name": "BrownShugguh", "link": "https://stackoverflow.com/users/8933949/brownshugguh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 49022013, "answer_count": 1, "score": 0, "last_activity_date": 1593041062, "creation_date": 1519761659, "last_edit_date": 1593041062, "question_id": 49016990, "link": "https://stackoverflow.com/questions/49016990/event-listener-for-inbox-of-second-account", "title": "Event listener for inbox of second account", "body": "<p>I'm trying to create an event listener:</p>\n\n<ul>\n<li>I have two accounts on my Outlook session.</li>\n<li>I want to monitor account (2) for new emails. </li>\n<li>When a new email is received in the inbox of account (2), I want to copy the email's subject &amp; body and send it to another person.</li>\n</ul>\n\n<p>I tried something similar to:  </p>\n\n<pre><code>For Each oAccount In Application.Session.Accounts\n\n    If oAccount = \"fakeemail@outlook.com\" Then\n</code></pre>\n"}]