[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1487203399, "post_id": 42262236, "comment_id": 71682331, "body": "You mean the IDE will not open?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1487207609, "post_id": 42262236, "comment_id": 71683567, "body": "Have you tried open it in <i>safe</i> mode? In command prompt, go the path of <i>EXCEL.EXE</i> and then <code>EXCEL.EXE &#47;safe</code>. Also try open a copy of the file from different folder."}, {"owner": {"reputation": 41, "user_id": 3797014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2862c38148bdf2a44c0045b39ff8d51?s=128&d=identicon&r=PG&f=1", "display_name": "A. Miguel", "link": "https://stackoverflow.com/users/3797014/a-miguel"}, "edited": false, "score": 0, "creation_date": 1487329990, "post_id": 42262236, "comment_id": 71747718, "body": "Didn&#39;t work either. Check my answer below. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3797014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2862c38148bdf2a44c0045b39ff8d51?s=128&d=identicon&r=PG&f=1", "display_name": "A. Miguel", "link": "https://stackoverflow.com/users/3797014/a-miguel"}, "edited": false, "score": 0, "creation_date": 1487330019, "post_id": 42263640, "comment_id": 71747734, "body": "Thanks. This didn&#39;t wok for me. Check my answer below."}], "tags": [], "owner": {"reputation": 71, "user_id": 6491327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3f0de27bb8852b8f67a5159e2fe09d?s=128&d=identicon&r=PG&f=1", "display_name": "CoderM", "link": "https://stackoverflow.com/users/6491327/coderm"}, "is_accepted": false, "score": 0, "last_activity_date": 1487233852, "last_edit_date": 1487233852, "creation_date": 1487211537, "answer_id": 42263640, "question_id": 42262236, "link": "https://stackoverflow.com/questions/42262236/cant-access-excel-vba-code/42263640#42263640", "title": "Can&#39;t access Excel VBA Code", "body": "<p>Pressing shift and break key, should open up the code and then you can click the stop button and edit as you like. This has worked for me several times where I have auto_open method with a user form. The other alternative would be to change the trust settings to always ask, that would stop any macro running. You could then access code in usual way.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 3797014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2862c38148bdf2a44c0045b39ff8d51?s=128&d=identicon&r=PG&f=1", "display_name": "A. Miguel", "link": "https://stackoverflow.com/users/3797014/a-miguel"}, "is_accepted": true, "score": 1, "last_activity_date": 1487329921, "creation_date": 1487329921, "answer_id": 42296471, "question_id": 42262236, "link": "https://stackoverflow.com/questions/42262236/cant-access-excel-vba-code/42296471#42296471", "title": "Can&#39;t access Excel VBA Code", "body": "<p>Here's the way I managed this:</p>\n\n<p>Rather than double-clicking the file in Windows I did:</p>\n\n<ol>\n<li>Opened Excel</li>\n<li>File -> Open</li>\n<li>Browsed the file and hold the \"shift\" key while clicking on \"Open\". (continue holding it until the workbook finishes loading)</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1079, "user_id": 5461798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rINgP.jpg?s=128&g=1", "display_name": "Light", "link": "https://stackoverflow.com/users/5461798/light"}, "edited": false, "score": 0, "creation_date": 1602859133, "post_id": 64390090, "comment_id": 113861872, "body": "This is not an answer to this question."}], "tags": [], "owner": {"reputation": 1, "user_id": 14462811, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2efa700015b34dcd58936e075f06360f?s=128&d=identicon&r=PG", "display_name": "Lois", "link": "https://stackoverflow.com/users/14462811/lois"}, "is_accepted": false, "score": 0, "last_activity_date": 1602855075, "last_edit_date": 1602855075, "creation_date": 1602854765, "answer_id": 64390090, "question_id": 42262236, "link": "https://stackoverflow.com/questions/42262236/cant-access-excel-vba-code/64390090#64390090", "title": "Can&#39;t access Excel VBA Code", "body": "<p>My situation was all of the procedures appeared on different sheets, no matter what I did I could not bring them over to one sheet. I studied the screen and my solution is as follows.</p>\n<p><strong>SOLUTION FOR PROCEDURES BEING ON DIFFERENT SHEETS:</strong>\nIn the lower left corner of the code sheet you will see <strong>two</strong> icons with lines. One is for &quot;<strong>Procedure</strong>&quot; view and the other is for &quot;<strong>Full Module</strong>&quot; view.</p>\n<p>I always use the &quot;Full Module&quot; view but at some point I clicked &quot;procedure&quot;.</p>\n"}], "owner": {"reputation": 41, "user_id": 3797014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2862c38148bdf2a44c0045b39ff8d51?s=128&d=identicon&r=PG&f=1", "display_name": "A. Miguel", "link": "https://stackoverflow.com/users/3797014/a-miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5555, "favorite_count": 0, "accepted_answer_id": 42296471, "answer_count": 3, "score": 3, "last_activity_date": 1602855075, "creation_date": 1487202275, "question_id": 42262236, "link": "https://stackoverflow.com/questions/42262236/cant-access-excel-vba-code", "title": "Can&#39;t access Excel VBA Code", "body": "<p>I have an Excel file with some VBA code. That code also includes a Form that is displayed on auto_open() call.</p>\n\n<p>I never had problems opening VBA code form developers tab before. But now when I open that file it automatically calls the auto_open() (the form is displayed) and I can't access the code anymore. If I close the form the file is closed as well.</p>\n\n<p>This problem started when I shut down Excel from the task manager because the VBA code was hanging. Since then I couldn't access the VBA for ANY other file containing forms loaded from auto_open().</p>\n\n<p>NOTE: I already tried opening the file with the Shift key hold.</p>\n\n<p>What is the problem? How can I access to the VBA macros as I used to do?</p>\n\n<p>Thanks\nMiguel</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 390, "user_id": 4748475, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/700368296752338/picture?type=large", "display_name": "M. Fawad Surosh", "link": "https://stackoverflow.com/users/4748475/m-fawad-surosh"}, "edited": false, "score": 0, "creation_date": 1487201046, "post_id": 42261782, "comment_id": 71681566, "body": "Provide a sample of your table with a few records along with the expected output."}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1487247780, "last_edit_date": 1487247780, "creation_date": 1487201656, "answer_id": 42262129, "question_id": 42261782, "link": "https://stackoverflow.com/questions/42261782/calculating-change-between-duplicate-rows/42262129#42262129", "title": "Calculating change between duplicate rows", "body": "<p>Assuming your data are in columns A to B and start from row 1, you could try this code:</p>\n\n<pre><code>Sub Main2()\n    Dim cell As Range\n\n    With CreateObject(\"Scripting.Dictionary\")\n        For Each cell In Range(\"A1\").CurrentRegion.Columns(1).Cells\n            If .Exists(cell.Value) Then\n                .Item(cell.Value) = .Item(cell.Value) - cell.Offset(, 1).Value\n            Else\n                .Item(cell.Value) = cell.Offset(1).Value\n            End If\n        Next cell\n        Range(\"C1\").Resize(.Count).Value = Application.Transpose(.Keys)\n        Range(\"D1\").Resize(.Count).Value = Application.Transpose(.Items)\n    End With\nEnd Sub\n</code></pre>\n\n<p>that outputs in columns C and D</p>\n"}], "owner": {"reputation": 1, "user_id": 7571408, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kai1oXEmcrI/AAAAAAAAAAI/AAAAAAAAAKA/4cRwjWCJj08/photo.jpg?sz=128", "display_name": "Mihai Baltatescu", "link": "https://stackoverflow.com/users/7571408/mihai-baltatescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487247780, "creation_date": 1487199902, "last_edit_date": 1487205861, "question_id": 42261782, "link": "https://stackoverflow.com/questions/42261782/calculating-change-between-duplicate-rows", "title": "Calculating change between duplicate rows", "body": "<p>I have data that is exported from a third party program. The data is always in the form of a range and always a fresh unsaved excel file every time it's exported.</p>\n\n<p>The data essentially contains this type of format. </p>\n\n<pre><code>169 31.0\n169 29.0\n12 01.31\n03 22.0\n12 1.09\n03 21.5\n</code></pre>\n\n<p>Sorry I am new at this website. Essentially one column is a code associated with ingredients, and the second column is their weights. You're going to see duplicates as the bakery is weight them before and after. I would like to have to calculate to see how much of each ingredient is used. So the final output would be a table with a list of unique ingredient codes in one column and difference between the before and after in the other column.</p>\n\n<p>I have tried using a pivot table but that sums them up. The difference formula needs a separate column to compare itself against. I don't have that unfortunately.</p>\n\n<p>Is there a simpler way to do this? I want essentially the same functionality of a pivot table but with difference instead of sum.</p>\n"}, {"tags": ["sql-server", "vba", "excel", "sql-server-2008", "adodb"], "comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487199288, "post_id": 42261508, "comment_id": 71680934, "body": "Is your <code>exceldestinationrangename</code> a single cell or a multi-cell range? If I recall correctly, the range needs to be the top left cell <i>only</i>."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487199717, "post_id": 42261508, "comment_id": 71681106, "body": "@ThunderFrame - Thanks, but that is not the issue. The range is single cell. Also, as my question states this is running perfectly when pointed to QA DB."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1493321496, "post_id": 42261508, "comment_id": 74379797, "body": "What do you get if you loop through the recordet and output to the immediate window? Same thing?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1493329565, "post_id": 42261508, "comment_id": 74383731, "body": "@Absinthe - It&#39;s been a while, but I believe the immediate window showed the correct results for each record when I looped through it. I ended up doing just that in my final solution (but never answered this question as it went out of my mind). Thanks for comment. Now I can clean this question up and provide a sustainable answer)."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1493367413, "post_id": 42261508, "comment_id": 74396681, "body": "@ScottHoltzman Sorry, didn&#39;t notice the post date, was just going through the unanswered section. For future reference I was going to suggest looking at the text encoding of the table. Glad you worked around the problem."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1493384906, "post_id": 42261508, "comment_id": 74408093, "body": "@Absinthe - Thanks for that suggestion too. I was thinking of that route, but since it&#39;s a production table and would require the db team to look into and make possible changes we we&#39;re trying to avoid that route."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 9605728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81754427bb7396706be2bc01d03ccf2f?s=128&d=identicon&r=PG&f=1", "display_name": "Akshit A.", "link": "https://stackoverflow.com/users/9605728/akshit-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1571027456, "creation_date": 1571027456, "answer_id": 58370128, "question_id": 42261508, "link": "https://stackoverflow.com/questions/42261508/copyfromrecordset-returning-strange-characters/58370128#58370128", "title": "CopyFromRecordset Returning Strange Characters", "body": "<p>I faced a similar problem too and I strongly suspect the number of records returned in your RecordSet is quite large. Therefore, <code>CopyFromRecordSet</code> is not working.</p>\n\n<p>I would suggest using the follwoing approach:<br></p>\n\n<ol>\n<li><p>Populating a 2-D Array in VBA with the RecordSet data.</p>\n\n<p>Dim arr as Variant\narr=rs.GetRows()\nrs.close\nconn.close</p></li>\n<li><p>Transpose the Array (Since this results into an inverted Array)</p>\n\n<p>arr=Application.WorksheetFunction.Transpose(arr)</p></li>\n<li><p>Once, the Array is transposed, you can write the Array to the worksheet Range.</p>\n\n<p>testWS.Range(\"A1\").Resize(UBound(arr, 1) + 1, UBound(arr, 2)</p></li>\n</ol>\n\n<p>This worked for me. Hope that works for you well! <br><br>\nHappy coding!</p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1571072166, "creation_date": 1571072166, "answer_id": 58381079, "question_id": 42261508, "link": "https://stackoverflow.com/questions/42261508/copyfromrecordset-returning-strange-characters/58381079#58381079", "title": "CopyFromRecordset Returning Strange Characters", "body": "<p>I ended up looping through the recordset and placing each value one-by-one. That said, the array answer provided probably will work faster for large data sets. At the time, this fit my needs and worked.</p>\n\n<pre><code>If bDownload Then 'if download switch is on, dump into Excel named range\n\n            If ws Is Nothing Then\n                Set DestinationRange = Range(exceldestinationrangename)\n            Else\n                Set DestinationRange = ws.Range(exceldestinationrangename)\n            End If\n\n            r = 0\n\n            DestinationRange.ClearContents\n            '.CopyFromRecordset rsPubs 'this is breaking on PDLOBList download (last column not showing up) 'PAQPT-488\n\n            If .RecordCount &gt; 0 Then\n                .MoveFirst\n                Do Until .EOF\n                    For c = 0 To .Fields.Count - 1\n                        DestinationRange.Offset(r, c).value = .Fields(c)\n                    Next\n                    .MoveNext\n                    r = r + 1\n                Loop\n</code></pre>\n\n<p><em>(I left out the rest of the <code>if</code> blocks as they are not relevant to this answer.)</em></p>\n"}], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 1, "accepted_answer_id": 58381079, "answer_count": 2, "score": 4, "last_activity_date": 1571072166, "creation_date": 1487198620, "question_id": 42261508, "link": "https://stackoverflow.com/questions/42261508/copyfromrecordset-returning-strange-characters", "title": "CopyFromRecordset Returning Strange Characters", "body": "<p>I have the following code below:</p>\n\n<pre><code>Function downloadsqltoexcel(conn As ADODB.Connection, sSQL As String, exceldestinationrangename As String, sqltablename As String, bDownload As Boolean, Optional ws As Worksheet) As Variant\n\n'================================================================================================================================\n'== Procedure Name: downloadsqltoexcel\n'== Purpose: downloads SQL table data (or query data) to Excel named range or grabs a specific value from an SQL table\n'== Notes: ensure that SQL table or query name and Excel named range are identical\n'================================================================================================================================\n\nDim rsPubs As ADODB.Recordset\nSet rsPubs = New ADODB.Recordset\n\nDim DestinationRange As Range\n\nWith rsPubs\n\n    .ActiveConnection = conn\n    .Open sSQL, conn, adOpenStatic, adLockReadOnly, adCmdText\n\n    If bDownload Then 'if download switch is on, dump into Excel named range\n\n        If ws Is Nothing Then\n            Set DestinationRange = Range(exceldestinationrangename)\n        Else\n            Set DestinationRange = ws.Range(exceldestinationrangename)\n        End If\n\n        With DestinationRange\n            .ClearContents\n            .CopyFromRecordset rsPubs\n        End With\n\n   .... more code follows, but not relevant\n</code></pre>\n\n<p>The code itself executes well. However, the <code>.CopyFromRecordset rsPubs</code> line returns very strange character data when I point to newly created Prod SQLServer database, which was copied directly from QA database in SQLServer as well.. When I say very strange, I mean like blank spaces mixed with Japanese style characters or some font set that I don't even recognize.</p>\n\n<p><code>rsPubs</code> returns exact record count as expected, so I know i am getting results I  want. Also confirmed that data is written into SQLServer DB as needed. </p>\n\n<p>Any ideas how to fix it so values return as expected from call to Prod SQLServer DB?</p>\n"}, {"tags": ["ms-access", "outlook", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1487197473, "post_id": 42261227, "comment_id": 71680152, "body": "Pretty sure you got the wrong tag.  VB.NET doesnt do scripts or macros"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1487212504, "post_id": 42261227, "comment_id": 71684816, "body": "Add <code>Option Explicit</code> at the very top of the form&#39;s module as a variable/ object may be referenced but is not initialized or declared or is misspelled or missing altogether. Then compile (Debug \\ Compile) the VBA code."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1487224681, "post_id": 42261227, "comment_id": 71688706, "body": "Have you compacted &amp; repaired and decompiled? Are all your references good? BTW you need to check the runtime version is higher than your compile version in some cases."}], "owner": {"reputation": 91, "user_id": 4676957, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rAqnB.png?s=128&g=1", "display_name": "phfb", "link": "https://stackoverflow.com/users/4676957/phfb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487205000, "creation_date": 1487197372, "last_edit_date": 1487205000, "question_id": 42261227, "link": "https://stackoverflow.com/questions/42261227/how-can-i-ensure-access-runtime-with-scripts-runs-successfully-for-different-use", "title": "How can I ensure access runtime with scripts runs successfully for different users?", "body": "<p>I've built an .accde front end in Access 2013 that calls up Outlook to send emails.  I've tested it, and it works for my profile.  I need it to work on the same machine with a different profile.  I've ensured that all required locations are trusted, and all vb environment references are included in Outlook.  </p>\n\n<p>When I run it on a different user's profile, I get the following message:</p>\n\n<pre><code>The expression On Load you entered as the event property setting produced\nthe following error:.\n*The expression may not result in the name of a macro, the name of a user-defined functino, or [Event Procedure].\n*There may have been an error evaluating the function, event, or macro.  \n</code></pre>\n\n<p>My other user's got access to the database backend, access to Outlook, and has the Access 2013 Runtime.  Where else could I look to figure out what's missing?  </p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 61, "user_id": 7043384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kEiiQwcbE3M/AAAAAAAAAAI/AAAAAAAAGpc/oNccSOSOsGw/photo.jpg?sz=128", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/7043384/benjamin"}, "edited": false, "score": 0, "creation_date": 1487194627, "post_id": 42260359, "comment_id": 71678689, "body": "If you import the CSV directly into Excel (no VBA) do you have the same issues? If you don&#39;t have problems, you might just try and record the macro and modify it to meet your needs. If that doesn&#39;t work, I could probably help with the second issue. But you&#39;ll really need to figure out when #1 happens to determine why it&#39;s happening."}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 1597648, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a950c9570036005af0094f4d955419e0?s=128&d=identicon&r=PG", "display_name": "Resurgent", "link": "https://stackoverflow.com/users/1597648/resurgent"}, "edited": false, "score": 0, "creation_date": 1487353290, "post_id": 42260576, "comment_id": 71763232, "body": "How do I apply logical operators to the data that is being copied? What if its non-linear, so I only want to copy certain cells rather than all cells between a1 and E for all rows. I&#39;d rather iterate through the rows on a line by line basis. Is that possible?"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1487194751, "creation_date": 1487194751, "answer_id": 42260576, "question_id": 42260359, "link": "https://stackoverflow.com/questions/42260359/excel-vba-error-parsing-dates-handling-strings/42260576#42260576", "title": "Excel VBA - Error Parsing Dates, Handling Strings", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsDest As Worksheet\n    Dim sFilePath As String\n    Dim aData As Variant\n\n    sFilePath = Application.GetOpenFilename(\"CSV Files, *.csv\", MultiSelect:=False)\n    If sFilePath = \"False\" Then Exit Sub    'Pressed cancel\n\n    Set wb = ActiveWorkbook\n    Set wsDest = wb.Sheets(\"Sheet2\")\n\n    Application.ScreenUpdating = False\n    With Workbooks.Open(sFilePath)\n        aData = .Sheets(1).Range(\"A1\", .Sheets(1).Cells(.Sheets(1).Rows.Count, \"E\").End(xlUp)).Value\n        .Close False\n    End With\n    Application.ScreenUpdating = True\n\n    With wsDest.Range(\"B11\").Resize(UBound(aData, 1), UBound(aData, 2))\n        .Value = aData\n        .Resize(, 1).NumberFormat = \"mm/dd/yyyy\"    'Can set date format here, change to dd/mm/yyyy if needed\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1487213043, "creation_date": 1487213043, "answer_id": 42263890, "question_id": 42260359, "link": "https://stackoverflow.com/questions/42260359/excel-vba-error-parsing-dates-handling-strings/42263890#42263890", "title": "Excel VBA - Error Parsing Dates, Handling Strings", "body": "<p>Most likely, the issue is a mismatch between the date format of your data and your Windows Regional Settings.  Several ways to handle this</p>\n\n<ul>\n<li>Change your Windows Regional Settings so they match</li>\n<li>Change the file type to a <code>*.txt</code> file.  Then use the <code>Workbooks.OpenText</code> method which allows you to specify the date column data type.</li>\n<li>Create a Data Connection which will also allow you to do the same.  Just be sure that you don't keep creating QueryTables.  It the table is already there, either delete and recreate, or refresh.</li>\n</ul>\n\n<p>Here is some code demonstrating the QueryTable method.  In the Excel GUI this would be the Data \u25ba Get External Data \u25ba From text option</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub OpenCSV()\nDim filePath As String\nDim intChoice As Integer\nDim WS As Worksheet\n\nApplication.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\nintChoice = Application.FileDialog(msoFileDialogOpen).Show\n\nIf intChoice &lt;&gt; 0 Then\n\n    filePath = Application.FileDialog( _\n      msoFileDialogOpen).SelectedItems(1)\n\n    Set WS = Worksheets(\"sheet2\")\n    With WS.QueryTables\n\n    'If it exists, either delete and re-import or refresh\n    If .Count &gt; 0 Then\n        Range(.Item(1).Destination.Address).CurrentRegion.Delete\n        .Item(1).Delete\n    End If\n    End With\n'\n    With WS.QueryTables.Add(Connection:=\"TEXT;\" &amp; filePath, Destination:=WS.Range(\"$B$11\"))\n        .Name = \"New Text Document\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n\n        'make sure format argument matches format in the csv file\n        .TextFileColumnDataTypes = Array(xlDMYFormat)\n\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd If\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": [], "owner": {"reputation": 395, "user_id": 1597648, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a950c9570036005af0094f4d955419e0?s=128&d=identicon&r=PG", "display_name": "Resurgent", "link": "https://stackoverflow.com/users/1597648/resurgent"}, "is_accepted": true, "score": 0, "last_activity_date": 1487854772, "creation_date": 1487854772, "answer_id": 42416458, "question_id": 42260359, "link": "https://stackoverflow.com/questions/42260359/excel-vba-error-parsing-dates-handling-strings/42416458#42416458", "title": "Excel VBA - Error Parsing Dates, Handling Strings", "body": "<pre><code>  Dim arr() As String\n  Dim newDate As Date\n\n  arr = Split(LineItem(0), \"/\")\n  newDate = DateSerial(Year:=arr(2), Month:=arr(1), Day:=arr(0))\n</code></pre>\n\n<p>Then use </p>\n\n<pre><code>Sheets(\"Sheet2\").Cells(11, 2).Offset(rowIndex, 0).Value = newDate\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 1597648, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/a950c9570036005af0094f4d955419e0?s=128&d=identicon&r=PG", "display_name": "Resurgent", "link": "https://stackoverflow.com/users/1597648/resurgent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 42416458, "answer_count": 3, "score": 2, "last_activity_date": 1487854772, "creation_date": 1487193971, "last_edit_date": 1487270894, "question_id": 42260359, "link": "https://stackoverflow.com/questions/42260359/excel-vba-error-parsing-dates-handling-strings", "title": "Excel VBA - Error Parsing Dates, Handling Strings", "body": "<p>The problem I have concerns a CSV file that I am seeking to parse into an excel spreadsheet.</p>\n\n<p>An example of the data is as follows:-</p>\n\n<pre><code>01/02/2015,MXP,0.4,150.00,Producing design document, 64111258\n02/06/2015,IHM,0.8,210.00,\"Maximilian dolce, lorem ipsum\", 64111258\n02/06/2015,AXSP,0.6,250.00,\"Magnificent, thanks very much\", 64111258\n</code></pre>\n\n<p>Currently, this is the code I am using to parse the data:-</p>\n\n<pre><code>Sub OpenCSV()\n\n    Dim filePath As String\n\n    Dim intChoice As Integer \n\n    Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n\n    intChoice = Application.FileDialog(msoFileDialogOpen).Show\n\n    rowIndex = 0\n\n    If intChoice &lt;&gt; 0 Then  \n\n        filePath = Application.FileDialog( _ msoFileDialogOpen).SelectedItems(1) \n\n        Open filePath For Input As #1\n\n        Do Until EOF(1)\n\n            Line Input #1, LineFromFile\n\n            LineItem = Split(LineFromFile, \",\")\n\n            Sheets(\"Sheet2\").Cells(11, 2).Offset(rowIndex, 0).Value = LineItem(0) ' Date\n            Sheets(\"Sheet2\").Cells(11, 2).Offset(rowIndex, 1).Value = LineItem(1) ' Code\n            Sheets(\"Sheet2\").Cells(11, 2).Offset(rowIndex, 2).Value = LineItem(2) ' Hours\n            Sheets(\"Sheet2\").Cells(11, 2).Offset(rowIndex, 3).Value = LineItem(3) ' Cost\n            Sheets(\"Sheet2\").Cells(11, 2).Offset(rowIndex, 4).Value = LineItem(4) ' Description\n\n            rowIndex = rowIndex + 1\n\n        Loop\n\n        Close #1\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The issues are as follows:-</p>\n\n<ol>\n<li>Dates such as 02/06/2015 which are parsed and transposed to the excel cell will end up as 06/02/2015. This will not happen consistently, but happens randomly to various dates within the dataset.</li>\n<li>CSV delimiter 4 will end up being parsed incorrectly where \"\" are in the data, as well as comma; Consequently the data is not transposed correctly to the relevant cell.</li>\n</ol>\n\n<p>How can I go about correcting these errors?</p>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1487196276, "post_id": 42260292, "comment_id": 71679530, "body": "use a for x = maxTasks to 1 step -1 that way your counter doesn&#39;t lose it&#39;s place"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7571404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c478da770144519cf7ee49af14b2211a?s=128&d=identicon&r=PG&f=1", "display_name": "M. Koz", "link": "https://stackoverflow.com/users/7571404/m-koz"}, "edited": false, "score": 0, "creation_date": 1487385942, "post_id": 42264217, "comment_id": 71775763, "body": "That was it. Thank you"}, {"owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "reply_to_user": {"reputation": 35, "user_id": 7571404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c478da770144519cf7ee49af14b2211a?s=128&d=identicon&r=PG&f=1", "display_name": "M. Koz", "link": "https://stackoverflow.com/users/7571404/m-koz"}, "edited": false, "score": 0, "creation_date": 1487540399, "post_id": 42264217, "comment_id": 71818785, "body": "if that answer worked for you could please accept it as the answer, it helps others who have similar questions to find a working solution."}], "tags": [], "owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "is_accepted": true, "score": 1, "last_activity_date": 1487215244, "creation_date": 1487215244, "answer_id": 42264217, "question_id": 42260292, "link": "https://stackoverflow.com/questions/42260292/microsoft-project-use-vba-to-delete-tasks/42264217#42264217", "title": "Microsoft Project, use vba to delete tasks", "body": "<p>this is how I have done it in the past, check through all tasks in the project.</p>\n\n<p>I'm not 100% sure on the syntax as it's been a while since I've worked with project and i copied this from vb.net</p>\n\n<pre><code>Dim T as Task\n\nFor Each T In Application.Tasks\n    If T.Text10 = \"1\" Or T.Text10 = \"2\" Then\n        T.Delete\n    End If\nNext\n</code></pre>\n\n<p>after looking at your code again it looks like you just need to change</p>\n\n<pre><code>.... Then\n    j.Delete\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7571404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c478da770144519cf7ee49af14b2211a?s=128&d=identicon&r=PG&f=1", "display_name": "M. Koz", "link": "https://stackoverflow.com/users/7571404/m-koz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1635, "favorite_count": 0, "accepted_answer_id": 42264217, "answer_count": 1, "score": 2, "last_activity_date": 1487215244, "creation_date": 1487193641, "last_edit_date": 1487197833, "question_id": 42260292, "link": "https://stackoverflow.com/questions/42260292/microsoft-project-use-vba-to-delete-tasks", "title": "Microsoft Project, use vba to delete tasks", "body": "<p>Sorry if this is an easy question, I just started using vba with MS Project.</p>\n\n<p>I am trying to cycle through all the tasks in a MS Project file and delete a task if it meets a certain criteria.  The problem happens after a task is deleted, it seems like the j task variable gets set to Nothing, which screws everything up.  Any idea how I can do this?  </p>\n\n<pre><code>For Each j In prj.Tasks\n\n    If j.Text10 = \"1\" Or j.Text10 = \"2\" Then ' If criteria is met\n\n        SelectRow Row:=j ' Select the row\n        EditDelete        ' Delete the row\n\n    End If\nNext j\n</code></pre>\n"}, {"tags": ["vba", "replace", "ms-word", "find"], "owner": {"reputation": 43, "user_id": 6596634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1992d252384a6a375d5ed46570bb63?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/6596634/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1496411516, "creation_date": 1487193314, "last_edit_date": 1487307615, "question_id": 42260199, "link": "https://stackoverflow.com/questions/42260199/vba-word-find-and-replace-with-wildcards-getting-section-contents-into-a-vari", "title": "VBA Word Find and Replace with Wildcards -- Getting section contents into a variable", "body": "<p>I am trying to find and replace a string using wildcards and then use the contents of the section labels of the search string in another find and replace command. Here is the portion of the code that does not work; the variables RT and Part do not get assigned the contents of the sections but rather the section label itself.  I also tried setting the variables RT and Part after the Selection.Find.Execute command.  I am a novice VBA programmer so this may be obvious but forgive me.  </p>\n\n<pre><code>Dim RT, Part As String\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \"(:)([RV][0-9]{1,2})( )(*)(:)\"\n        .Replacement.Text = \"\\4\"\n        RT = .Replacement.Text\n        Part = \"\\2\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = True\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\nWith Selection\n    If .Find.Forward = True Then\n        .Collapse Direction:=wdCollapseStart\n    Else\n        .Collapse Direction:=wdCollapseEnd\n    End If\n    .Find.Execute Replace:=wdReplaceOne\n    If .Find.Forward = True Then\n        .Collapse Direction:=wdCollapseEnd\n    Else\n        .Collapse Direction:=wdCollapseStart\n    End If\nEnd With\n</code></pre>\n\n<p>I then want to use the variables from above in another find and replace that starts out as follows (I haven't included all the code below).</p>\n\n<pre><code>With Selection.Find\n    .Text = \"(:)(\"&amp;Part&amp;\")( :)\"\n    .Replacement.Text = RT\n</code></pre>\n\n<p>Ultimately I have an initial text definition in the document that looks like this:</p>\n\n<p>:R1 XYZ:</p>\n\n<p>:R2 ABC:</p>\n\n<p>These initial text definitions get replaced with just XYZ or ABC, then later in the document are the tokens:</p>\n\n<p>:R1 : &lt;-- which I want to replace with XYZ.<br>\n:R2 : &lt;-- which I want to replace with ABC.</p>\n"}, {"tags": ["vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6394519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-X8eF88pEGkQ/AAAAAAAAAAI/AAAAAAAAAI0/Xumz9RbbKXk/photo.jpg?sz=128", "display_name": "G.K", "link": "https://stackoverflow.com/users/6394519/g-k"}, "edited": false, "score": 0, "creation_date": 1487201726, "post_id": 42261991, "comment_id": 71681788, "body": "Final code I&#39;m now successfully using is       Sub hg() Dim i As Long Range(&quot;D13&quot;).Select Do Until i = 10 i = i + 1 ActiveCell.FormulaR1C1 = &quot;=AVERAGE(R[-10]C:R[-1]C)&quot; Selection.Copy     Range(Selection, Selection.End(xlToRight)).Select     Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _         SkipBlanks:=False, Transpose:=False     Cells(ActiveCell.Row, ActiveCell.Column + 1).Select Cells(ActiveCell.Row + 15, 4).Select Loop End Sub"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 47, "user_id": 6394519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-X8eF88pEGkQ/AAAAAAAAAAI/AAAAAAAAAI0/Xumz9RbbKXk/photo.jpg?sz=128", "display_name": "G.K", "link": "https://stackoverflow.com/users/6394519/g-k"}, "edited": false, "score": 0, "creation_date": 1487202024, "post_id": 42261991, "comment_id": 71681892, "body": "You are warmly encouraged to avoid avoid Select/Selection/ActiveXXX pattern and use fully qualified range references. Furthermore Copy/Paste is an expensive operation: you may not perceive it with little data or operations but you may want to get into the habit of using Value property to copy values between ranges or write formulas directly.  Try my code and let me know"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1487200930, "creation_date": 1487200930, "answer_id": 42261991, "question_id": 42260087, "link": "https://stackoverflow.com/questions/42260087/vba-horizontal-and-vertical-movement-using-loops-for-dynamic-ranges/42261991#42261991", "title": "VBA: Horizontal and vertical movement using loops for dynamic ranges", "body": "<p>You can use Offset() and loop stepping 15 rows at every iteration</p>\n\n<pre><code>Sub hg()\n    Dim i As Long`enter code here`\n\n    For i = 13 To 43 Step 15 '&lt;--| change 43 to your actual last row to populate with formula\n        Range(\"D1:Z1\").Offset(i-1).FormulaR1C1 = \"=AVERAGE(R[-10]C:R[-1]C)\"\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6394519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-X8eF88pEGkQ/AAAAAAAAAAI/AAAAAAAAAI0/Xumz9RbbKXk/photo.jpg?sz=128", "display_name": "G.K", "link": "https://stackoverflow.com/users/6394519/g-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1484, "favorite_count": 1, "accepted_answer_id": 42261991, "answer_count": 1, "score": 1, "last_activity_date": 1533246832, "creation_date": 1487192941, "last_edit_date": 1533246832, "question_id": 42260087, "link": "https://stackoverflow.com/questions/42260087/vba-horizontal-and-vertical-movement-using-loops-for-dynamic-ranges", "title": "VBA: Horizontal and vertical movement using loops for dynamic ranges", "body": "<p>I've to calculate average or sum or standard deviation or.. of 10 entries in a column say D3:D12 and populate row till Z column.\n<a href=\"https://i.stack.imgur.com/mr6E2.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>part 1:-</p>\n\n<pre><code>Sub hg()\nDim i As Long\nRange(\"D13\").Select\nDo Until i = 20\ni = i + 1\nActiveCell.FormulaR1C1 = \"=AVERAGE(R[-10]C:R[-1]C)\"\nCells(ActiveCell.Row, ActiveCell.Column + 1).Select\nLoop\nEnd Sub\n</code></pre>\n\n<p>This I've coded. Is there any method easy to drag side ways ?</p>\n\n<p>I need to continue this again in 28th row, 43rd row &amp; so on with 15 rows difference. </p>\n\n<p>What I could think of is adding \nPart two:- </p>\n\n<pre><code>Sub hg()\nDim i As Long\nRange(\"D13\").Select\nDo Until i = 20\ni = i + 1\nActiveCell.FormulaR1C1 = \"=AVERAGE(R[-10]C:R[-1]C)\"\nCells(ActiveCell.Row, ActiveCell.Column + 1).Select\nLoop\nCells(ActiveCell.Row + 15, ActiveCell.Column - 20).Select\nEnd Sub\n</code></pre>\n\n<p>Which is directing to 28th row but not working to populate along this row. I'm unable to direct vertical movement. </p>\n\n<p>I'm no serious coder but very interested to learn. Please help to populate along the vertical direction.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487193118, "post_id": 42260058, "comment_id": 71677913, "body": "Word of advice, I would not use <code>Value = &quot;&quot;</code> that does not clear the cells just puts a blank string in it. Use <code>Value = vbNullString</code>"}, {"owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487193200, "post_id": 42260058, "comment_id": 71677960, "body": "Also, you could use a loop to clear each cell and add in <code>If</code> statements to skip over W and X"}, {"owner": {"reputation": 15, "user_id": 7571343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/651d8535c750d9aa08b36711526b599e?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7571343/andy"}, "reply_to_user": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487195112, "post_id": 42260058, "comment_id": 71678930, "body": "Thanks for the advice!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487212081, "post_id": 42260058, "comment_id": 71684697, "body": "@SnWhte - can you provide some sort of test to show the difference of a cell that has had its <code>Value</code> set to <code>&quot;&quot;</code> versus one that has had its <code>Value</code> set to <code>vbNullString</code>.  (I&#39;m struggling to find one - all the tests I have tried in both VBA and Excel think they are both <code>Empty</code>.)"}, {"owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487257755, "post_id": 42260058, "comment_id": 71711601, "body": "You won&#39;t see a difference it is more so for optimization and efficiency. If you use &quot;&quot; more rows will be in &quot;use&quot; than if you use <code>vbNullString</code>. Check out the answer <a href=\"http://stackoverflow.com/questions/32435320/is-there-any-difference-between-vbnullstring-and\">here</a> and the link they provide in the answer <a href=\"http://www.aivosto.com/vbtips/stringopt.html\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487264203, "post_id": 42260058, "comment_id": 71716849, "body": "@YowE3K see comment above, didn&#39;t realize you weren&#39;t OP"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1487270463, "post_id": 42260058, "comment_id": 71720803, "body": "@SnWhte - I can understand the efficiency issues (the compiler can point to a constant null string instead of creating a new instance of one), but using <code>&quot;&quot;</code> or <code>vbNullString</code> seems to give exactly the same effect on <code>UsedRange</code> (and everything else as far as Excel is concerned).  I admit to being surprised when I saw the behaviour - I expected <b>both</b> methods would leave a null string in the cell, and was not expecting it to be the same as doing a <code>ClearContents</code> - but that appears to be exactly what it is doing."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7571343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/651d8535c750d9aa08b36711526b599e?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7571343/andy"}, "edited": false, "score": 0, "creation_date": 1487195066, "post_id": 42260252, "comment_id": 71678910, "body": "Thanks, this helped a lot."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1487193507, "creation_date": 1487193507, "answer_id": 42260252, "question_id": 42260058, "link": "https://stackoverflow.com/questions/42260058/excel-vba-target-entirerow-excluding-two-columns/42260252#42260252", "title": "Excel VBA - Target.EntireRow excluding two columns", "body": "<p>To clear all cells in a row except for columns W and X:</p>\n\n<pre><code>With Target.Parent\n    Union(.Range(.Cells(Target.Row, \"A\"), .Cells(Target.Row, \"V\")), _\n          .Range(.Cells(Target.Row, \"Y\"), .Cells(Target.Row, .Columns.Count))).ClearContents\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7571343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/651d8535c750d9aa08b36711526b599e?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/7571343/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 42260252, "answer_count": 1, "score": 1, "last_activity_date": 1487193507, "creation_date": 1487192838, "question_id": 42260058, "link": "https://stackoverflow.com/questions/42260058/excel-vba-target-entirerow-excluding-two-columns", "title": "Excel VBA - Target.EntireRow excluding two columns", "body": "<p>I am working on a spreadsheet that utilizes columns A:AV. I have it set to automatically copy and paste the entire row when a cell in column D has the text \"Closed\". I couldn't cut the row due to formatting that the sheet has, so instead I'm using this to clear the row      <code>Target.EntireRow.Value = \"\"</code>.  My question is, is it possible to set the values of the entire row to \"\" while skipping over columns W and X? I have formulas in those columns that I don't want to be erased. Thanks for the help.</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "edited": false, "score": 0, "creation_date": 1487281846, "post_id": 42281284, "comment_id": 71727347, "body": "(assuming you are the same ferdo from catiav5forum.de, hello hope you are doing well)..   im not sure if that will tell me anything. thats is just what the update mode is set to.  i am more concerned with if someone has there update mode set to manual makes a change on a sketch but does not update the body. how to detect if the body isnt uptodate."}, {"owner": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "reply_to_user": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "edited": false, "score": 0, "creation_date": 1487449238, "post_id": 42281284, "comment_id": 71793652, "body": "Hello, yes, same guy here, :-) , thanks, you are right, now I understood what is your concern. Anyway, first you have to check how your settings are set so your CATIA will not update automatically something without let you know (even if you will get an alert when closing). So, indeed, problem not solved but frankly speaking I didn&#39;t see anything in documentation. Are your users using Q-Checker or something similar?"}, {"owner": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "edited": false, "score": 0, "creation_date": 1487455133, "post_id": 42281284, "comment_id": 71795485, "body": "no, and frankly i get so much rubbish, unupdated bodies, broken links, ghost links, not adhering to naming and numbering standards (i see files called Part1.CATPart quite a lot from my colleagues and customers) am just trying to make some tools to rapidly scan for problems."}, {"owner": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "edited": false, "score": 0, "creation_date": 1487455501, "post_id": 42281284, "comment_id": 71795562, "body": "basically am writing a cad management system -its actually going quite well, this is just another test in a long line of things to prevent my users putting dodgy data into it - been trying to get my bosses to buy one for years, given up and am writing my own."}, {"owner": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "reply_to_user": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "edited": false, "score": 0, "creation_date": 1487570585, "post_id": 42281284, "comment_id": 71827214, "body": "In my opinion, you can do a macro to be run by each of the users/customers to fulfill your design rules before saving and warn users what is wrong. The only problem is to implement this, but each company should have some formal design rules...."}, {"owner": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "edited": false, "score": 0, "creation_date": 1487582997, "post_id": 42281284, "comment_id": 71833544, "body": "&#39;should have&#39; being the operative statement."}, {"owner": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "edited": false, "score": 0, "creation_date": 1487583256, "post_id": 42281284, "comment_id": 71833710, "body": "and unless its automatically part of the storing the data process they probably wont use it (they will say they dont have time) do you know of a &#39;save&#39; event in  catia i could use to automatically run the macro (or would i need caa rade)?"}], "tags": [], "owner": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "is_accepted": false, "score": 0, "last_activity_date": 1487267489, "creation_date": 1487267489, "answer_id": 42281284, "question_id": 42259468, "link": "https://stackoverflow.com/questions/42259468/catvba-how-to-determine-if-catpart-needs-to-be-updated/42281284#42281284", "title": "catvba how to determine if catpart needs to be updated", "body": "<p>Check CATIA Settings</p>\n\n<pre><code>Set mySettControlers = CATIA.SettingControllers\nSet myPartInfraSetting = mySettControlers.Item(\"CATMmuPartInfrastructureSettingCtrl\")\n</code></pre>\n\n<p>Check how is set myPartInfraSetting.UpdateMode and see if is catManualUpdate or catAutomaticUpdate</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "is_accepted": true, "score": 1, "last_activity_date": 1487761570, "last_edit_date": 1487761570, "creation_date": 1487759935, "answer_id": 42388841, "question_id": 42259468, "link": "https://stackoverflow.com/questions/42259468/catvba-how-to-determine-if-catpart-needs-to-be-updated/42388841#42388841", "title": "catvba how to determine if catpart needs to be updated", "body": "<p>I worked out a solution (see below)\n'@@@@@@@@@@@@@@@@@@@@@</p>\n\n<pre><code>Function func_CheckNoModsSinceLastSaved() As Boolean\n\nfunc_CheckNoModsSinceLastSaved = False\n\nDim flg_NoModsSinceLastSaved As Boolean\n\nflg_NoModsSinceLastSaved = False\n\nIf Right(CATIA.ActiveDocument.FullName, 11) = \".CATProduct\" Then\n    Dim productDocument1 As ProductDocument\n    Set productDocument1 = CATIA.ActiveDocument\n\n    Dim product1 As Product\n    Set product1 = productDocument1.Product\n\n    flg_NoModsSinceLastSaved = productDocument1.Saved\n    If flg_NoModsSinceLastSaved Then\n        func_CheckNoModsSinceLastSaved = True\n    Else\n        func_CheckNoModsSinceLastSaved = False\n        MsgBox \"Modified Since Last Saved\"\n    End If\n\n    product1.Update\n\n    flg_NoModsSinceLastSaved = productDocument1.Saved\n    If flg_NoModsSinceLastSaved Then\n        func_CheckNoModsSinceLastSaved = True\n    Else\n        func_CheckNoModsSinceLastSaved = False\n        MsgBox \"Modified Since Last Saved\"\n    End If\n\n    Set productDocument1 = Nothing\n\n\nElseIf Right(CATIA.ActiveDocument.FullName, 8) = \".CATPart\" Then\n    Dim partDocument1 As PartDocument\n    Set partDocument1 = CATIA.ActiveDocument\n\n\n    flg_NoModsSinceLastSaved = partDocument1.Saved\n    If flg_NoModsSinceLastSaved Then\n        func_CheckNoModsSinceLastSaved = True\n    Else\n        func_CheckNoModsSinceLastSaved = False\n        MsgBox \"Modified Since Last Saved\"\n    End If\n\n    partDocument1.Part.Update\n\n    flg_NoModsSinceLastSaved = partDocument1.Saved\n    If flg_NoModsSinceLastSaved Then\n        func_CheckNoModsSinceLastSaved = True\n    Else\n        func_CheckNoModsSinceLastSaved = False\n        MsgBox \"Modified Since Last Saved\"\n    End If\n    Set partDocument1 = Nothing\n\n\nElseIf Right(CATIA.ActiveDocument.FullName, 11) = \".CATDrawing\" Then\n    Dim drawingDocument1 As DrawingDocument\n    Set drawingDocument1 = CATIA.ActiveDocument\n\n    flg_NoModsSinceLastSaved = drawingDocument1.Saved\n     If flg_NoModsSinceLastSaved Then\n        func_CheckNoModsSinceLastSaved = True\n    Else\n        func_CheckNoModsSinceLastSaved = False\n        MsgBox \"Modified Since Last Saved\"\n    End If\n\n    drawingDocument1.Update\n\n    flg_NoModsSinceLastSaved = drawingDocument1.Saved\n    If flg_NoModsSinceLastSaved Then\n        func_CheckNoModsSinceLastSaved = True\n    Else\n        func_CheckNoModsSinceLastSaved = False\n        MsgBox \"Modified Since Last Saved\"\n    End If\n    Set drawingDocument1 = Nothing\n\nElse\n    MsgBox \"ERROR: Unidentified File Type!\", vbCritical + vbOKOnly, \"\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>'@@@@@@@@@@@@@@@@@@@@@</p>\n"}], "owner": {"reputation": 11, "user_id": 7571194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027fee1ec1971e49b37d735bd2fc206a?s=128&d=identicon&r=PG&f=1", "display_name": "tink", "link": "https://stackoverflow.com/users/7571194/tink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "accepted_answer_id": 42388841, "answer_count": 2, "score": 0, "last_activity_date": 1487761570, "creation_date": 1487190765, "last_edit_date": 1487193886, "question_id": 42259468, "link": "https://stackoverflow.com/questions/42259468/catvba-how-to-determine-if-catpart-needs-to-be-updated", "title": "catvba how to determine if catpart needs to be updated", "body": "<p>I want to determine if something has changed in a catpart that would drive a change in a body, but the change hasnt been done because update is set to manual.</p>\n\n<p>I have tried:</p>\n\n<pre><code>if part.product.update = true then\n    'do something\nelse\n  'do something else\nendif\n</code></pre>\n\n<p>However this just forces an update and doesnt tell me if one was required.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487192242, "post_id": 42259204, "comment_id": 71677432, "body": "@YowE3K no it doesn&#39;t because it says invalid qualifier but it works in <code>format</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487192888, "post_id": 42259204, "comment_id": 71677787, "body": "Actually, the whole methodology is flawed, because you are going to find the first occurrence of the strings over and over again.  You will need to at least change the code to perform a find <code>After</code> a certain row.  Is your intended outcome to set columns A:C of any row which has &quot;Member Number&quot; in column A of the row below equal to columns A:C of the row above the next &quot;Member Number&quot;?"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487192975, "post_id": 42259204, "comment_id": 71677836, "body": "@YowE3K yes I understand but I am not sure how to add the <code>after</code> feature..."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487193134, "post_id": 42259204, "comment_id": 71677917, "body": "@YowE3K my intended outcomes is to have <code>Department..</code> in place of the  previous <code>Department..</code> but for the very first <code>Department..</code> there is no <code>Department..</code> above it so that is confusing how would I write to code that includes all of these conditions."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487193251, "post_id": 42259204, "comment_id": 71677986, "body": "Is the last record in column A always a &quot;Department&quot;?"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487193358, "post_id": 42259204, "comment_id": 71678053, "body": "@YowE3K yes sir, however it appears in the picture."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487193436, "post_id": 42259204, "comment_id": 71678101, "body": "Your picture doesn&#39;t show the last record in column A.  (Unless the &quot;------&quot; is the last record, and that isn&#39;t a &quot;Department&quot;.)"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487193565, "post_id": 42259204, "comment_id": 71678168, "body": "@YowE3K no sir, it is always a <code>Department...</code> on everysheet"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487191780, "post_id": 42259732, "comment_id": 71677184, "body": "You will need to remove the <code>.</code> in front of <code>.frstDept</code> and <code>.lastDept</code> - those are variables (objects) in the code, not Methods or Properties of the <code>ws</code> worksheet object.  (And, IIRC, you will need to select the worksheet before selecting a range within that worksheet.)"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487192022, "post_id": 42259732, "comment_id": 71677302, "body": "Thank you for the reply. I had updated my code just before you posted your answer. I found another issue, my iVal isn&#39;t counting the departments."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1487192052, "post_id": 42259732, "comment_id": 71677322, "body": "Good catch YowE3k, I completely missed those."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487192095, "post_id": 42259732, "comment_id": 71677347, "body": "And your <code>Resize(-1)</code> won&#39;t work - you can&#39;t have a range with <code>-1</code> row in it."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1487192210, "post_id": 42259732, "comment_id": 71677410, "body": "Yeah, I wasn&#39;t sure about that one, so I didnt touch it. Changed it to work better."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1487192410, "post_id": 42259732, "comment_id": 71677516, "body": "Edited the iVal  code to properly count instances of department within a ws."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487192792, "post_id": 42259732, "comment_id": 71677736, "body": "it still is not counting departments because <code>Debug.Print iVal</code> displays <code>0</code> Would it have to with departments not being on its own? it&#39;s usually department 32 adult crop"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1487193276, "post_id": 42259732, "comment_id": 71677999, "body": "I added wildcards &quot;*&quot; around department, try that."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487193798, "post_id": 42259732, "comment_id": 71678272, "body": "lol it iVal works, may i know what a wildcard does? @BrandonBarney"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1487194572, "post_id": 42259732, "comment_id": 71678671, "body": "A wildcard basically tells the code that anything can exist there. By putting it on both sides the code is just checking that the string between the wildcards exists."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 1, "last_activity_date": 1487193246, "last_edit_date": 1487193246, "creation_date": 1487191676, "answer_id": 42259732, "question_id": 42259204, "link": "https://stackoverflow.com/questions/42259204/vba-how-to-find-the-department-and-replace-it-with-another-department/42259732#42259732", "title": "VBA: How to find the department and replace it with another department?", "body": "<p>You are setting frstDept to a row, same with lastDept. I believe you intend to instead set these to a range. Try this:</p>\n\n<pre><code>Sub format()\n\n   Dim ws As Worksheet\n   Dim frstDept As Range\n   Dim lastDept As Range\n   Dim rng As Long\n   Dim n As Long\n   Dim nlast As Long\n   Dim rw As Range\n   Dim i As Integer\n   Dim iVal As Integer\n\n\n    Set rw = ActiveWorkbook.ActiveSheet.UsedRange.Rows\n    nlast = rw.Count\n\n    For Each ws In Sheets\n        ws.Activate\n\n        iVal = Application.WorksheetFunction.CountIf(ws.Range(\"A:A\"), \"*Department*\") \n        Debug.Print iVal\n        On Error GoTo NextWS\n        For i = iVal To 1 Step -1 ' You dont have a next statement closing this for loop.\n            With ws\n                    Set frstDept = Range(\"A:A\").Find(What:=\"Department\", LookIn:=xlValues, LookAt:=xlPart)\n                    Set lastDept = Range(\"A:A\").Find(What:=\"Department\", LookIn:=xlValues, LookAt:=xlPart)\n                        If .frstDept.Value = .lastDept.Value Then\n                            lastDept.Offset(-1, 0).Value = frstDept.Offset(1, 0).Value\n\n                        End If\n                    End If\n            End With\n NextWS:\n            Err.Clear\n\n            Next ' This should close the for loop for your iVal iteration.\n        Next ws\n\n   End Sub\n</code></pre>\n\n<p>Also, both of your find statements are the same, and in theory should return the same range. I can't make sense of why you are using the same find statement from your question, so I don't have a suggestion on how to improve it.</p>\n\n<p>The code above likely won't solve your problem, but it should get you closer. My best bet is that your On Error statement has been activating every time you tried to get the vale of your firstdept and lastdept variables, and so it hasn't been doing anything.</p>\n\n<p>I hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487194949, "post_id": 42260421, "comment_id": 71678850, "body": "It works but there is a small issue. One sheet has a big account and it is <code>department 75</code>. its accounts last until <code>department 70</code>. It is hundreds of lines in between. So <code>department 70</code> has to go all the way at the top and <code>department 75</code> needs to go to the place where <code>department 70</code> was."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195025, "post_id": 42260421, "comment_id": 71678894, "body": "@MTBthePRO Let me guess - there are multiple &quot;MEMBER NUMBER&quot; lines within the one department?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195218, "post_id": 42260421, "comment_id": 71678993, "body": "Is the first &quot;MEMBER NUMBER&quot; always in row 2?  Or can that first one be identified because it is the only &quot;MEMBER NUMBER&quot; with a blank cell above it?"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195298, "post_id": 42260421, "comment_id": 71679049, "body": "Yes it is always in row 2 and column a. there is always space above it."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195466, "post_id": 42260421, "comment_id": 71679132, "body": "Question. Does the <code>lastDept</code> contain <code>department</code> or is <code>nextDept</code>"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195658, "post_id": 42260421, "comment_id": 71679218, "body": "Is possible that you can briefly summarize what&#39;s going on..I am having a hard time reading it."}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195675, "post_id": 42260421, "comment_id": 71679225, "body": "Thank you very much like always :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195694, "post_id": 42260421, "comment_id": 71679236, "body": "@MTBthePRO <code>lastDept</code> contains the department.  So does <code>nextDept</code>.  But <code>nextDept</code> is just a temporary variable so that we can hold the current value of row <code>r</code> while we clear it and write <code>lastDept</code> into the row.  If we just wrote <code>lastDept</code> in without first saving the current value, we would end up with the same department in all sections."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195761, "post_id": 42260421, "comment_id": 71679272, "body": "@MTBthePRO - I have to go to a meeting now - I will try to add a bit more in the way of explanation later this morning (or maybe when I get home from work - about 8 hours time)"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487195881, "post_id": 42260421, "comment_id": 71679338, "body": "Interesting. great that would be awesome."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1487208719, "post_id": 42260421, "comment_id": 71683846, "body": "@MTBthePRO - Second part of answer now includes more comments than code.  Hope that helps you to understand it."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1487208622, "last_edit_date": 1487208622, "creation_date": 1487194162, "answer_id": 42260421, "question_id": 42259204, "link": "https://stackoverflow.com/questions/42259204/vba-how-to-find-the-department-and-replace-it-with-another-department/42260421#42260421", "title": "VBA: How to find the department and replace it with another department?", "body": "<p>I believe the following code will work:</p>\n\n<pre><code>Sub format()\n    Dim ws As Worksheet\n    Dim r As Long\n    Dim lastDept As String\n    Dim nextDept As String\n    Dim rw As Long\n\n    For Each ws In Worksheets ' Changed from \"Sheets\" to \"Worksheets\" to avoid\n                              ' problems if any \"Charts\" exist\n        With ws\n            rw = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            'Grab the details of the last \"Department\" and then clear the cells\n            lastDept = RTrim(.Cells(rw, \"A\") &amp; .Cells(rw, \"B\") &amp; .Cells(rw, \"C\"))\n            .Range(\"A\" &amp; rw &amp; \":C\" &amp; rw).ClearContents\n\n            For r = rw To 2 Step -1\n                If Trim(.Cells(r, \"A\").Value) = \"MEMBER NUMBER\" Then\n                    nextDept = RTrim(.Cells(r - 1, \"A\") &amp; .Cells(r - 1, \"B\") &amp; .Cells(r - 1, \"C\"))\n                    .Range(\"A\" &amp; r - 1 &amp; \":C\" &amp; r - 1).ClearContents\n                    .Cells(r - 1, \"A\").Value = lastDept\n                    lastDept = nextDept\n                End If\n            Next\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>Every time it finds \"MEMBER NUMBER\" in column A, it grabs the information from columns A:C of the row above, then clears those cells, and replaces column A with the concatenated values from the previous time it had encountered a \"MEMBER NUMBER\".  (I'm assuming that concatenating columns A:C into one string is a good thing.  If not, I can edit it so that the values are kept as separate strings.)</p>\n\n<hr>\n\n<p>Edited to search for \"Department\" (with a reliance on row 1 always being blank).</p>\n\n<pre><code>Sub format()\n    Dim ws As Worksheet\n    Dim r As Long\n    Dim lastDept As String\n    Dim nextDept As String\n    Dim rw As Long\n\n    'Initialise \"lastDept\" to blank so that the first replacement we make\n    '(i.e. the one on the last row) is to an empty value        \n    lastDept = \"\"\n    'Loop through every worksheet\n    'Use \"Worksheets\" collection rather than \"Sheets\" collection so that\n    'we don't try to do any processing on Charts (\"Sheets\" contains both\n    'Worksheet and Chart objects)\n    For Each ws In Worksheets\n        'Use a \"With\" block so that we don't have to constantly write\n        '\"ws.Cells\", \"ws.Range\", \"ws.Rows\", etc - we can just use\n        '\".Cells\", \".Range\", \".Rows\", etc instead\n        With ws\n            'Find the end of the data by finding the last non-empty cell in column A\n            rw = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            'Loop (backwards) through each row in the worksheet\n            For r = rw To 1 Step -1\n                'We only need to process something when Column A starts with\n                '\"Department\", or if this is row 1 (which will be empty)\n                If Left(.Cells(r, \"A\").Value, 10) = \"Department\" Or r = 1 Then\n                    'Temporarily store the current values of this row's columns A:C\n                    'Join all three cells into one string to make it look \"nicer\"\n                    nextDept = RTrim(.Cells(r, \"A\").Value &amp; _\n                                     .Cells(r, \"B\").Value &amp; _\n                                     .Cells(r, \"C\").Value)\n                    'Clear out what was in A:C\n                    .Range(\"A\" &amp; r &amp; \":C\" &amp; r).ClearContents\n                    'Write the contents of \"lastDept\" into column A\n                    .Cells(r, \"A\").Value = lastDept\n                    'Change \"lastDept\" to be the value which we stored in our\n                    'temporary variable \"nextDept\" (The temporary variable was\n                    'needed because, by the time we get to this line, we have\n                    'written over the top of the information in the worksheet\n                    'cells.)\n                    lastDept = nextDept\n                End If\n            Next ' end of processing of a row\n        End With\n    Next ws ' end of processing of a Worksheet\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 42260421, "answer_count": 2, "score": 0, "last_activity_date": 1487208622, "creation_date": 1487189905, "last_edit_date": 1487191649, "question_id": 42259204, "link": "https://stackoverflow.com/questions/42259204/vba-how-to-find-the-department-and-replace-it-with-another-department", "title": "VBA: How to find the department and replace it with another department?", "body": "<p>I am having difficulty find a solution to this problem. I am trying to find the string <code>department</code> and replace it with some another department. There are <strong>16-10 sheets</strong> in each workbook that needs formatting. One of the formats requires moving/copying the <code>first department string</code> (which reaches out to into <code>columns B,C</code> in some rows) and pasting it where the <code>last department</code> was but the first department in some sheet in <code>columnA</code> doesn't have a department above it but <code>member number</code>. The reason is for this it to make the department a title.</p>\n\n<p>The picture in the bottom should provide more information.<a href=\"https://i.stack.imgur.com/W9zoJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W9zoJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is what I have so far but doesn't comply. I would appreciate some help on this.\nPlease ask questions and give suggestions. Thank you.</p>\n\n<pre><code>    Sub format()\n\n       Dim ws As Worksheet\n       Dim frstDept As Long\n       Dim lastDept As Long\n       Dim rng As Long\n       Dim n As Long\n       Dim nlast As Long\n       Dim rw As Range\n       Dim i As Integer\n       Dim iVal As Integer\n       iVal = Application.WorksheetFunction.CountIf(Range(\"A1:A20000\"), \"Department\")\n       Debug.Print iVal\n\n        Set rw = ActiveWorkbook.ActiveSheet.UsedRange.Rows\n        nlast = rw.Count\n\n        For Each ws In Sheets\n            On Error GoTo NextWS\n            For i = iVal To 1 Step -1\n                With ws\n                        frstDept = Range(\"A:A\").Find(What:=\"Department\", LookIn:=xlValues, LookAt:=xlPart).Row\n                        lastDept = Range(\"A:A\").Find(What:=\"Member Number\", LookIn:=xlValues, LookAt:=xlPart).Row\n                            If .frstDept.Value = .lastDept.Value Then\n                            frstDept.Selection.Offset(0, 2).Cut Destination:=Range(\"lastDept\" + 1).Resize(1)\n                            End If\n                        End If\n                    End With\n     NextWS:\n                Err.Clear\n\n                Next ws\n\n       End Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "multidimensional-array"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 1, "creation_date": 1487189886, "post_id": 42259156, "comment_id": 71676174, "body": "Dim and ReDim aren&#39;t interchangeable, they do different things."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487190063, "post_id": 42259156, "comment_id": 71676269, "body": "You &quot;dimmed&quot; <code>companyArray</code> already so you have to use <code>redim</code>. The alternative is not to <code>Dim</code> the variable in the upper part of your code and then immediately use <code>Dim</code> where you are currently using <code>ReDim</code>. You can <code>Dim</code> a variable only once and from there on you have to use <code>Redim</code>. (At least that&#39;s the theory. In actually its this: <a href=\"http://stackoverflow.com/questions/12907050/redim-without-dim\">stackoverflow.com/questions/12907050/redim-without-dim</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487190124, "post_id": 42259235, "comment_id": 71676305, "body": "&quot;coding time&quot;, aka &quot;compile-time&quot; ;-)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1487190205, "post_id": 42259235, "comment_id": 71676343, "body": "@Mat&#39;sMug, Visual very Basic for Applications. :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 5, "last_activity_date": 1496428931, "last_edit_date": 1496428931, "creation_date": 1487189986, "answer_id": 42259235, "question_id": 42259156, "link": "https://stackoverflow.com/questions/42259156/is-there-any-reason-to-use-redim-when-creating-a-dynamic-array-instead-of-dim/42259235#42259235", "title": "Is there any reason to use &quot;redim&quot; when creating a dynamic array instead of &quot;dim&quot; in excel VBA?", "body": "<p><code>Dim companyArray(1 to 5)</code> is static sizing: needs that the bounds are constants known at the time you write the code.</p>\n\n<p><code>Redim companyArray(1 to x)</code> is dynamic sizing, required when the bounds are computed while the program is running.</p>\n\n<p>When any of the bounds (on any dimension) is not known at coding time, <code>Redim</code> is the only option.</p>\n\n<hr>\n\n<p><strong>A word of caution</strong></p>\n\n<p><code>Redim</code> does not need that the variable be dimmed before, you can just declare and redim a dynamic array. <strong>However</strong>, There is some risk in doing so. Consider this</p>\n\n<pre><code>' Module\nDim X as variant ' some module-level (or global) variable\n''''''''''''''''''\n' Some code\n'''''''''''''''''\nSub foo()\n   Redim X(1 to 3) as long ' &lt;-- Will redim the global X\n   ....\nEnd Sub\n</code></pre>\n\n<p>If the intent of the programmer when writing <code>foo</code> was to declare a <em>local variable</em> and <code>Redim it</code> in one shot, then this will fail, because the <code>Redim</code> statement will operate on the global X because it is within scope.</p>\n\n<p>The bottom line is that <code>Redim</code> declares and redims the variable, <strong>but</strong> if a variable with the same name exists in its scope, it will redim that variable instead of creating a new variable. For this reason, even though it is not strictly necessary, it is safer to use <code>Dim</code> before <code>Redim</code>, by rules of good practice.</p>\n\n<pre><code>Sub foo()\n   Dim X() as Long\n   Redim X(1 to 3) as long ' &lt;-- Will now refer to the local variable X\n   ....\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3672936, "user_type": "registered", "profile_image": "https://graph.facebook.com/710992317/picture?type=large", "display_name": "cemattis", "link": "https://stackoverflow.com/users/3672936/cemattis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 42259235, "answer_count": 1, "score": 1, "last_activity_date": 1496428931, "creation_date": 1487189698, "last_edit_date": 1531164843, "question_id": 42259156, "link": "https://stackoverflow.com/questions/42259156/is-there-any-reason-to-use-redim-when-creating-a-dynamic-array-instead-of-dim", "title": "Is there any reason to use &quot;redim&quot; when creating a dynamic array instead of &quot;dim&quot; in excel VBA?", "body": "<p>I'm creating a two-dimensional dynamic array in Excel VBA. Most of the code examples I can find are like the following:</p>\n\n<pre><code>Dim companyArray() As Variant\nDim height, width As Integer\nwidth = 2\nheight = WorksheetFunction.CountA(Worksheets(1).Columns(1))\nReDim companyArray(height, width)\n</code></pre>\n\n<p>Is there a reason I wouldn't want to declare the array after I've gotten a value for the <code>height</code> variable? Would I not want to avoid using ReDim if it's possible?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487189561, "post_id": 42258935, "comment_id": 71675988, "body": "What is this trying to achieve? <code>.Range(&quot;C:C&quot; &amp; counter1 + 1 &amp; &quot;F:F&quot; &amp; counter1 + 1)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1487189810, "post_id": 42258935, "comment_id": 71676124, "body": "Are you after the two lines <code>Sheets(&quot;Sheet1&quot;).Cells(counter1 + 1, &quot;C&quot;).Copy Destination:=Sheets(&quot;Sheet1&quot;).Cells(counter2 + 1,&quot;P&quot;)</code> and <code>Sheets(&quot;Sheet1&quot;).Cells(counter1 + 1,&quot;F&quot;).Copy Destination:=Sheets(&quot;Sheet1&quot;).Cells(counter2 + 1,&quot;R&quot;)</code>?  (Or, if you are only wanting the <b>data</b> copied, <code>Sheets(&quot;Sheet1&quot;).Cells(counter2 + 1, &quot;P&quot;).Value = Sheets(&quot;Sheet1&quot;).Cells(counter1 + 1,&quot;C&quot;).Value</code> and <code>Sheets(&quot;Sheet1&quot;).Cells(counter2 + 1,&quot;R&quot;).Value = Sheets(&quot;Sheet1&quot;).Cells(counter1 + 1,&quot;F&quot;)</code>)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1487190408, "post_id": 42258935, "comment_id": 71676448, "body": "And you should update the comment in <code>array1 = rng1.Offset(0, 4).Resize(, 5).Value &#39;creating an array by taking rng1 (column B) and offsetting it by 4 (to include up to column F), then resizing to include columns B through F (5 columns total)</code> - the comment should actually read <code>&#39;creating an array by taking rng1 (column B) and offsetting it by 4 (to refer to column F), then resizing to include columns F through J (5 columns total)</code>"}, {"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487190788, "post_id": 42258935, "comment_id": 71676634, "body": "@YowE3K Yea so I just want to copy the value of C and place it in P and the value of F and place it in Column R...then move onto the next row. It looks like your code is exactly what I want, but I keep getting a &quot;mismatch&quot; error"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487190994, "post_id": 42258935, "comment_id": 71676748, "body": "Is the mismatch on the <code>If</code> statement line?  Are you really wanting to compare column R with column F, and column V with column I?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487191071, "post_id": 42258935, "comment_id": 71676807, "body": "@Ralph - I didn&#39;t want to post an answer until I knew that that was what the OP was after.  I&#39;ll do that now.  (But I&#39;m worried whether my code is the code causing the new mismatch error :S)"}, {"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487191104, "post_id": 42258935, "comment_id": 71676832, "body": "@YowE3K nvm it worked I just had to delete the &quot;and&quot; I had in their accidently"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487191297, "post_id": 42258935, "comment_id": 71676942, "body": "OK - I have posted it as an answer.  But you really need to look at your comment as well.  (Which is my sarcastic way of saying &quot;you probably need to get rid of the <code>.Offset</code> part of that code&quot;.)"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1487191173, "creation_date": 1487191173, "answer_id": 42259586, "question_id": 42258935, "link": "https://stackoverflow.com/questions/42258935/copy-values-in-columns-c-and-f-in-range1-to-columns-p-and-r-in-range2/42259586#42259586", "title": "Copy values in columns C and F in range1 to columns P and R in range2?", "body": "<p>I believe that instead of</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(\"C:C\" &amp; counter1 + 1 &amp; \"F:F\" &amp; counter1 + 1).Copy Destination:=Sheets(\"Sheet1\").Range(\"P:P\" &amp; counter2 + 1 &amp; \"R:R\" &amp; counter2 + 1)\n</code></pre>\n\n<p>you are really after</p>\n\n<pre><code>Sheets(\"Sheet1\").Cells(counter1 + 1, \"C\").Copy Destination:=Sheets(\"Sheet1\").Cells(counter2 + 1, \"P\")\nSheets(\"Sheet1\").Cells(counter1 + 1, \"F\").Copy Destination:=Sheets(\"Sheet1\").Cells(counter2 + 1, \"R\")\n</code></pre>\n\n<p>Or, if you are only wanting the data copied:</p>\n\n<pre><code>Sheets(\"Sheet1\").Cells(counter2 + 1, \"P\").Value = Sheets(\"Sheet1\").Cells(counter1 + 1, \"C\").Value\nSheets(\"Sheet1\").Cells(counter2 + 1, \"R\").Value = Sheets(\"Sheet1\").Cells(counter1 + 1, \"F\")\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 42259586, "answer_count": 1, "score": 1, "last_activity_date": 1487191173, "creation_date": 1487188923, "last_edit_date": 1531164843, "question_id": 42258935, "link": "https://stackoverflow.com/questions/42258935/copy-values-in-columns-c-and-f-in-range1-to-columns-p-and-r-in-range2", "title": "Copy values in columns C and F in range1 to columns P and R in range2?", "body": "<p>I am having issues with the bolded line of code below: I get an error that states, \"Application-defined or object-defined error\"</p>\n\n<p>I sort of morphed this code from a previous code of mine...</p>\n\n<pre><code>Option Explicit\n\nSub BringDownSNs()\nCall OptimizeCode_Begin\n\nDim cell1 As Range, rng1 As Range, cell2 As Range, rng2 As Range\nDim array1, array2, counter1 As Long, counter2 As Long\nDim StartTime As Double\nDim MinutesElapsed As String\n\nSet rng1 = Sheets(\"Sheet1\").Range(\"B2:B\" &amp; Sheets(\"Sheet1\").Cells(Sheets(\"Sheet1\").Rows.Count, \"B\").End(xlUp).row)\nSet rng2 = Sheets(\"Sheet1\").Range(\"M2:M\" &amp; Sheets(\"Sheet1\").Cells(Sheets(\"Sheet1\").Rows.Count, \"M\").End(xlUp).row)\n\narray1 = rng1.Offset(0, 4).Resize(, 5).Value 'creating an array by taking rng1 (column B) and offsetting it by 4 (to include up to column F), then resizing to include columns B through F (5 columns total)\narray2 = rng2.Offset(0, 5).Resize(, 6).Value 'same as above but using rng2\n\nFor counter2 = 1 To UBound(array2) 'for each row in array2 - from row 1 in array 2 to upper bound of array 2 (row 3865)\n    For counter1 = 1 To UBound(array1) 'for each row in array1 - from row 1 in array 1 to upper bound of array 1 (row 2390)\n\n    'if array 2 -&gt; sheet 1, current row (starting with row 1 of the array), column 1 of the array (Column M, NHA Part Number) equals array 1 -&gt; sheet 1, current row, column 1 of the array (Column B, NHA Part Number) _\n     AND if array 2 -&gt; sheet 1, current row, column 5 of the array (Column Q , Part Number) equals array 1 -&gt; sheet 1, current row, column 4 of the array (Column E, Part Number) THEN _\n     copy data from current row in array 1 (columns C &amp; F) into current row in array 2 (columns P &amp; R)\n\n        If array2(counter2, 1) = array1(counter1, 1) And array2(counter2, 5) = array1(counter1, 4) Then\n            **Sheets(\"Sheet1\").Range(\"C:C\" &amp; counter1 + 1 &amp; \"F:F\" &amp; counter1 + 1).Copy Destination:=Sheets(\"Sheet1\").Range(\"P:P\" &amp; counter2 + 1 &amp; \"R:R\" &amp; counter2 + 1)**\n        Exit For\n        End If\n    Next\nNext\n\nCall OptimizeCode_End\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487187825, "post_id": 42258498, "comment_id": 71674985, "body": "Try <code>xlApp.DisplayAlerts = False</code>"}, {"owner": {"reputation": 8187, "user_id": 975243, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/HUTso.gif?s=128&g=1", "display_name": "Matthew Colley", "link": "https://stackoverflow.com/users/975243/matthew-colley"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1487187914, "post_id": 42258498, "comment_id": 71675024, "body": "that worked, can you post this as an answer and i will accept it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1487188966, "post_id": 42258498, "comment_id": 71675637, "body": "Protip: you know you&#39;re working with an <code>Excel.Workbook</code> object, and you know from the error message that it doesn&#39;t have a <code>DisplayAlerts</code> member. The next step should have been to google up &quot;Excel VBA DisplayAlerts&quot; (first hit &quot;Application.DisplayAlerts&quot; on MSDN), not ask on Stack Overflow."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487189677, "post_id": 42258498, "comment_id": 71676046, "body": "The fact the error says &quot;Object doesn&#39;t support this property or method&quot; tells you that <code>DisplayAlerts</code> isn&#39;t a property of <code>xlBook</code>. Like @Mat&#39;sMug says a quick Google with that knowledge to hand would have sorted it."}], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1487187899, "creation_date": 1487187899, "answer_id": 42258666, "question_id": 42258498, "link": "https://stackoverflow.com/questions/42258498/vbs-refresh-and-save-data-excel/42258666#42258666", "title": "VBS Refresh and Save Data Excel", "body": "<p><code>DisplayAlerts</code> is a property of the <code>Application</code> object</p>\n\n<pre><code>xlApp.DisplayAlerts = False\n</code></pre>\n"}], "owner": {"reputation": 8187, "user_id": 975243, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/HUTso.gif?s=128&g=1", "display_name": "Matthew Colley", "link": "https://stackoverflow.com/users/975243/matthew-colley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "closed_date": 1487236387, "accepted_answer_id": 42258666, "answer_count": 1, "score": -2, "last_activity_date": 1487188373, "creation_date": 1487187282, "last_edit_date": 1487188373, "question_id": 42258498, "link": "https://stackoverflow.com/questions/42258498/vbs-refresh-and-save-data-excel", "closed_reason": "Not suitable for this site", "title": "VBS Refresh and Save Data Excel", "body": "<p>I have a VBS script that when executed it will refresh data in an excel(2013) file. However it is giving an error on </p>\n\n<pre><code>xlBook.DisplayAlerts = False\n</code></pre>\n\n<p>The error message states 'object doesn't support this property or method' 'DisplayAlerts'</p>\n\n<p>Here is the VBS script</p>\n\n<pre><code>Option Explicit\nDim xlApp, xlBook, xlSheet\nSet xlApp = CreateObject(\"Excel.Application\")\nSet xlBook = xlApp.Workbooks.Open(\"C:\\Users\\me\\Desktop\\\"&amp; \"Book1.xlsx\")\nSet xlSheet = xlBook.worksheets.item(1)\nxlBook.DisplayAlerts = False\nxlBook.RefreshAll\nxlBook.Save\nxlBook.Close\nxlApp.Quit\nSet xlSheet = Nothing\nSet xlBook = Nothing\nSet xlApp = Nothing\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "multidimensional-array"], "comments": [{"owner": {"reputation": 2019, "user_id": 73749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYp0N.png?s=128&g=1", "display_name": "gbianchi", "link": "https://stackoverflow.com/users/73749/gbianchi"}, "edited": false, "score": 3, "creation_date": 1487184811, "post_id": 42257783, "comment_id": 71673361, "body": "the first redim is inside the for???"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1487186688, "post_id": 42257783, "comment_id": 71674378, "body": "Are these going to be hard-coded values that you are placing into the array (i.e. is the code in the question just a MCVE, or is that actually the data you want to use)?  Or are you going to set the values from a range in a worksheet?  Or are they calculated values?"}], "answers": [{"comments": [{"owner": {"reputation": 2019, "user_id": 73749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYp0N.png?s=128&g=1", "display_name": "gbianchi", "link": "https://stackoverflow.com/users/73749/gbianchi"}, "edited": false, "score": 1, "creation_date": 1487185587, "post_id": 42257852, "comment_id": 71673802, "body": "in fact row +1 will make the iteration 2 step shorter"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 2019, "user_id": 73749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYp0N.png?s=128&g=1", "display_name": "gbianchi", "link": "https://stackoverflow.com/users/73749/gbianchi"}, "edited": false, "score": 0, "creation_date": 1487185627, "post_id": 42257852, "comment_id": 71673823, "body": "Thanks - I didn&#39;t explain that well!"}, {"owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "edited": false, "score": 0, "creation_date": 1487185733, "post_id": 42257852, "comment_id": 71673875, "body": "Hi thanks, but the second dimension 0 to 3 is not fixed and it is dynamic how can i change it?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487186025, "post_id": 42257852, "comment_id": 71674046, "body": "No problem, I updated the code. Get the limit at the beginning of the code and that will update the size of array"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 2, "last_activity_date": 1487187175, "last_edit_date": 1487187175, "creation_date": 1487184889, "answer_id": 42257852, "question_id": 42257783, "link": "https://stackoverflow.com/questions/42257783/vba-redim-preserve/42257852#42257852", "title": "VBA Redim Preserve", "body": "<p>Try this:</p>\n\n<pre><code>Sub test()\n    Dim limit As Integer\n    limit = 3 'get limit from somewhere\n\n    Dim Arr1 as Variant        \n    Redim Arr1(0 To 9, 0 To limit) As Variant\n\n    Dim Row As Long\n    For Row = 0 To 3            \n        Arr1(0, Row) = \"Zero\"\n        Arr1(1, Row) = \"One\"\n        Arr1(2, Row) = \"Two\"\n        Arr1(3, Row) = \"Three\"\n        Arr1(4, Row) = \"Four\"\n        Arr1(5, Row) = \"Five\"\n        Arr1(6, Row) = \"Six\"\n        Arr1(7, Row) = \"Seven\"\n        Arr1(8, Row) = \"Eight\"\n        Arr1(9, Row) = \"Nine\"        \n    Next Row\n    MsgBox Arr1(0, 0)\nEnd Sub\n</code></pre>\n\n<p>You already know the limits you want your array have so just define the limits at the start. You don't need to redefine these at any further point.</p>\n\n<p>Also, <code>Next Row</code> does the same thing as <code>Row=Row+1</code> so you don't want both</p>\n\n<p><strong>Update</strong></p>\n\n<p>If you like you can also put your strings in an array</p>\n\n<pre><code>Sub test()\n    Dim limit As Integer\n    limit = 3 'get limit from somewhere\n\n    Dim Arr1 as Variant        \n    Redim Arr1(0 To 9, 0 To limit) As Variant\n\n    Dim numbers As Variant\n    numbers = Array(\"Zero\", \"One\", \"Two\", \"Three\", \"Four\", \"Five\", \"Six\", \"Seven\", \"Eight\", \"Nine\")\n\n    Dim Row As Integer, Col As Integer\n    For Row = 0 To 3\n        For Col = 0 To 9\n            Arr1(Col, Row) = numbers(Col)\n        Next Col\n    Next Row\n    MsgBox Arr1(0, 0)\nEnd Sub\n</code></pre>\n\n<p><strong>Update 2</strong> </p>\n\n<p><em>There really are so many ways to skin a cat...</em> How about using collections:</p>\n\n<pre><code>Sub test()\n    Dim numbers As Variant\n    numbers = Array(\"Zero\", \"One\", \"Two\", \"Three\", \"Four\", \"Five\", \"Six\", \"Seven\", \"Eight\", \"Nine\")\n\n    Dim col As Collection\n    Set col = New Collection\n\n    Dim i As Integer\n    For i = 0 To 3 'get limit from somewhere\n        col.Add numbers\n    Next i\n\n    MsgBox col(1)(0)  'col(1 to 4)(0 to 9)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487186286, "post_id": 42258189, "comment_id": 71674176, "body": "Wizardry!.. Nice answer"}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1487265849, "post_id": 42258189, "comment_id": 71717999, "body": "Wizardry? Hardly. Beautifully elegant - yes :)"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 2, "last_activity_date": 1487186112, "creation_date": 1487186112, "answer_id": 42258189, "question_id": 42257783, "link": "https://stackoverflow.com/questions/42257783/vba-redim-preserve/42258189#42258189", "title": "VBA Redim Preserve", "body": "<p>Range can be used to repeat them without a loop:</p>\n\n<pre><code>Dim r As Range, Arr1\nSet r = Cells.Resize(10, 4)\n\nr = [{\"Zero\";\"One\";\"Two\";\"Three\";\"Four\";\"Five\";\"Six\";\"Seven\";\"Eight\";\"Nine\"}]     \nArr1 = r           ' Arr1 is now (1 To 10, 1 To 4) As Variant\nr.ClearContents\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 4011878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1d78babefd9a85be90d609807f361d7?s=128&d=identicon&r=PG&f=1", "display_name": "Shan", "link": "https://stackoverflow.com/users/4011878/shan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1488284312, "creation_date": 1487184656, "last_edit_date": 1488284312, "question_id": 42257783, "link": "https://stackoverflow.com/questions/42257783/vba-redim-preserve", "title": "VBA Redim Preserve", "body": "<p>I dont know how to populate a multidimensional array. Here is my code i just started to understand but i dont know what is wrong, it is not working except for one loop. </p>\n\n<pre><code>Sub test()\n    Dim Arr1 As Variant\n    Dim Row As Long\n    For Row = 0 To 3            \n        ReDim Arr1(9, Row)\n        Arr1(0, Row) = \"Zero\"\n        Arr1(1, Row) = \"One\"\n        Arr1(2, Row) = \"Two\"\n        Arr1(3, Row) = \"Three\"\n        Arr1(4, Row) = \"Four\"\n        Arr1(5, Row) = \"Five\"\n        Arr1(6, Row) = \"Six\"\n        Arr1(7, Row) = \"Seven\"\n        Arr1(8, Row) = \"Eight\"\n        Arr1(9, Row) = \"Nine\"    \n        Row = Row + 1\n        ReDim Preserve Arr1(9, Row)        \n    Next Row\n    MsgBox Arr1(0, 0)\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "similarity", "fuzzy-logic", "fuzzy"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1487186986, "post_id": 42257760, "comment_id": 71674546, "body": "If you can create an array with the acronyms and their definition (maybe in another sheet?), you can use a check that checks if the value refers to an index/match from the table.  This could be part of a Select Case where the first Case is your typical check, the second Case is this index/match check, and your third Case would be &#39;is not similar.&#39;  Just an idea."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7563955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/978f1d17c8c0899fa29a12a0dd270813?s=128&d=identicon&r=PG&f=1", "display_name": "jonv", "link": "https://stackoverflow.com/users/7563955/jonv"}, "edited": false, "score": 1, "creation_date": 1487256576, "post_id": 42258585, "comment_id": 71710590, "body": "Think I got it - Thanks so much!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 43, "user_id": 7563955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/978f1d17c8c0899fa29a12a0dd270813?s=128&d=identicon&r=PG&f=1", "display_name": "jonv", "link": "https://stackoverflow.com/users/7563955/jonv"}, "edited": false, "score": 0, "creation_date": 1487259931, "post_id": 42258585, "comment_id": 71713257, "body": "@jonv Welcome, please keep us updated if implementing this idea (which is actually yours, I only suggested a technical implementation) significantly improved your similarity checker. I&#39;m highly interested ;)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 4, "last_activity_date": 1487197349, "last_edit_date": 1487197349, "creation_date": 1487187625, "answer_id": 42258585, "question_id": 42257760, "link": "https://stackoverflow.com/questions/42257760/define-acronyms-when-running-vb-code-calculating-similarity/42258585#42258585", "title": "Define acronyms when running vb code calculating similarity", "body": "<p>Without much involvement into your solution, that is your own responsibility, I can suggest some way to incorporate those <em>Abbreviations</em>. However. <strong>Please</strong> be aware that this method is not guaranteed 100% success, but you are in the fuzzy world already.</p>\n\n<p>Suppose that we have a <code>Dictionary</code> where:</p>\n\n<ul>\n<li>The keys are the long phrases</li>\n<li>The values are the abbreviations</li>\n</ul>\n\n<p>Before comparing two strings, we <em>minimize</em> both of them, by replacing each occurring long phrase by its abbreviation. Then we can compare them with the rest of your method <code>Similarity</code> (or by any other method).</p>\n\n<pre><code>' Fills an abbreviation dictionary\nSub InitializeDict(ByRef abbrev As Scripting.Dictionary)\n    abbrev(\"limited liability company\") = \"LLC\"\n    abbrev(\"United Kingdom\") = \"U.K.\"\n    '... Add all abbreviations into dict\n\n    ' Instead of harcoding, you can better load the key/value\n    ' pairs from a dedicated worksheet... \n\nEnd Sub\n\n' Minimizes s by putting abbreviations\nSub Abbreviate(ByRef s As String)\n    Static abbrev As Scripting.Dictionary ' &lt;-- static, inititlized only once\n    If abbrev Is Nothing Then\n        Set abbrev = CreateObject(\"Scripting.Dictionary\")\n        abbrev.CompareMode = vbTextCompare\n        InitializeDict abbrev\n    End If\n\n    Dim phrase\n    For Each phrase In abbrev.Keys\n        s = Replace(s, phrase, abbrev(phrase), vbTextCompare)\n    Next\nEnd Sub\n\n' A small amendment to this function: abbreviate strings before comparing\nPublic Function Similarity(ByVal String1 As String, _\n                       ByVal String2 As String, _\n                       Optional ByRef RetMatch As String, _\n                       Optional min_match = 1) As Single\n\n    Abbreviate String1\n    Abbreviate String2\n    ' ... Rest of the routine\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1487197746, "creation_date": 1487197746, "answer_id": 42261314, "question_id": 42257760, "link": "https://stackoverflow.com/questions/42257760/define-acronyms-when-running-vb-code-calculating-similarity/42261314#42261314", "title": "Define acronyms when running vb code calculating similarity", "body": "<p>It might be easier to check if strings are <code>Like</code> each other. For example</p>\n\n<pre><code>If \"ABC limited liability company\" Like \"ABC L*L*C*\" Then\n</code></pre>\n\n<p>is True as <code>*</code> matches any 0 or more characters.</p>\n\n<pre><code>Option Compare Text    ' makes string comparisons case insensitive\n\nFunction areLike(str1 As String, str2 As String) As Single\n\n    If str1 = str2 Then areLike = 1: Exit Function\n\n    Dim pattern As String, temp As String\n\n    If LenB(str1) &lt; LenB(str2) Then \n        pattern = str1\n        temp = str2\n    Else\n        pattern = str2\n        temp = str1\n    End If\n\n    pattern = StrConv(pattern, vbUnicode)       ' \"ABC LLC\" to \"A\u2400B\u2400C\u2400 \u2400L\u2400L\u2400C\u2400\"   \n    pattern = Replace(pattern, vbNullChar, \"*\") ' \"A*B*C* *L*L*C*\"\n    pattern = Replace(pattern, \" *\", \" \")       ' \"A*B*C* L*L*C*\"\n\n    If temp Like pattern Then areLike = 1: Exit Function\n\n    ' else areLike = some other similarity function\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7563955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/978f1d17c8c0899fa29a12a0dd270813?s=128&d=identicon&r=PG&f=1", "display_name": "jonv", "link": "https://stackoverflow.com/users/7563955/jonv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 42258585, "answer_count": 2, "score": 2, "last_activity_date": 1487197746, "creation_date": 1487184597, "question_id": 42257760, "link": "https://stackoverflow.com/questions/42257760/define-acronyms-when-running-vb-code-calculating-similarity", "title": "Define acronyms when running vb code calculating similarity", "body": "<p>I am utilizing the following vb code in excel to calculate the degree similarity between column A and column B. It runs great. </p>\n\n<p>The next step for me is to define acronyms so the calculated degree of similarity is not impacted. IE: If I have in column A, \"ABC LLC\" and in column B, \"ABC limited liability company\", the current vb code will return that the two columns are not very similar. However, I want them to return as 100% similar by defining that \"LLC\" and \"Limited Liability Company\" are really the same thing. What can I do and where can I put it in the code to accomplish this? Thanks!</p>\n\n<p>Disclaimer - yes I know there are add-ins to do this. However, my data set is too large to utilize them. </p>\n\n<pre><code>Public Function Similarity(ByVal String1 As String, _\n                           ByVal String2 As String, _\n                           Optional ByRef RetMatch As String, _\n                           Optional min_match = 1) As Single\n\n'Returns percentile of similarity between 2 strings (ignores case)\n\n'\"RetMatch\"  returns the characters that match(in order)\n'\"min_match\" specifies minimum number af char's in a row to match\n\n\nDim b1() As Byte, b2() As Byte\nDim lngLen1 As Long, lngLen2 As Long\nDim lngResult As Long\n\n  If UCase(String1) = UCase(String2) Then       '..Exactly the same\n    Similarity = 1\n\n  Else                                          '..one string is empty\n    lngLen1 = Len(String1)\n    lngLen2 = Len(String2)\n    If (lngLen1 = 0) Or (lngLen2 = 0) Then\n      Similarity = 0\n\n    Else                                        '..otherwise find similarity\n      b1() = StrConv(UCase(String1), vbFromUnicode)\n      b2() = StrConv(UCase(String2), vbFromUnicode)\n      lngResult = Similarity_sub(0, lngLen1 - 1, _\n                                 0, lngLen2 - 1, _\n                                 b1, b2, _\n                                 String1, _\n                                 RetMatch, _\n                                 min_match)\n      Erase b1\n      Erase b2\n      If lngLen1 &gt;= lngLen2 Then\n        Similarity = lngResult / lngLen1\n      Else\n        Similarity = lngResult / lngLen2\n      End If\n    End If\n  End If\n\nEnd Function\n\nPrivate Function Similarity_sub(ByVal start1 As Long, ByVal end1 As Long, _\n                                ByVal start2 As Long, ByVal end2 As Long, _\n                                ByRef b1() As Byte, ByRef b2() As Byte, _\n                                ByVal FirstString As String, _\n                                ByRef RetMatch As String, _\n                                ByVal min_match As Long, _\n                                Optional recur_level As Integer = 0) As Long\n'* CALLED BY: Similarity *  (RECURSIVE)\n\nDim lngCurr1 As Long, lngCurr2 As Long\nDim lngMatchAt1 As Long, lngMatchAt2 As Long\nDim i As Long\nDim lngLongestMatch As Long, lngLocalLongestMatch As Long\nDim strRetMatch1 As String, strRetMatch2 As String\n\n  If (start1 &gt; end1) Or (start1 &lt; 0) Or (end1 - start1 + 1 &lt; min_match) _\n  Or (start2 &gt; end2) Or (start2 &lt; 0) Or (end2 - start2 + 1 &lt; min_match) Then\n    Exit Function     '(exit if start/end is out of string, or length is too short)\n  End If\n\n  For lngCurr1 = start1 To end1        '(for each char of first string)\n    For lngCurr2 = start2 To end2        '(for each char of second string)\n      i = 0\n      Do Until b1(lngCurr1 + i) &lt;&gt; b2(lngCurr2 + i)   'as long as chars DO match..\n        i = i + 1\n        If i &gt; lngLongestMatch Then     '..if longer than previous best, store starts &amp; length\n          lngMatchAt1 = lngCurr1\n          lngMatchAt2 = lngCurr2\n          lngLongestMatch = i\n        End If\n        If (lngCurr1 + i) &gt; end1 Or (lngCurr2 + i) &gt; end2 Then Exit Do\n      Loop\n    Next lngCurr2\n  Next lngCurr1\n\n  If lngLongestMatch &lt; min_match Then Exit Function 'no matches at all, so no point checking for sub-matches!\n\n  lngLocalLongestMatch = lngLongestMatch                   'call again for BEFORE + AFTER\n  RetMatch = \"\"\n                              'Find longest match BEFORE the current position\n  lngLongestMatch = lngLongestMatch _\n                  + Similarity_sub(start1, lngMatchAt1 - 1, _\n                                   start2, lngMatchAt2 - 1, _\n                                   b1, b2, _\n                                   FirstString, _\n                                   strRetMatch1, _\n                                   min_match, _\n                                   recur_level + 1)\n  If strRetMatch1 &lt;&gt; \"\" Then\n    RetMatch = RetMatch &amp; strRetMatch1 &amp; \"*\"\n  Else\n    RetMatch = RetMatch &amp; IIf(recur_level = 0 _\n                              And lngLocalLongestMatch &gt; 0 _\n                              And (lngMatchAt1 &gt; 1 Or lngMatchAt2 &gt; 1) _\n                              , \"*\", \"\")\n  End If\n\n                              'add local longest\n  RetMatch = RetMatch &amp; Mid$(FirstString, lngMatchAt1 + 1, lngLocalLongestMatch)\n\n                              'Find longest match AFTER the current position\n  lngLongestMatch = lngLongestMatch _\n                  + Similarity_sub(lngMatchAt1 + lngLocalLongestMatch, end1, _\n                                   lngMatchAt2 + lngLocalLongestMatch, end2, _\n                                   b1, b2, _\n                                   FirstString, _\n                                   strRetMatch2, _\n                                   min_match, _\n                                   recur_level + 1)\n\n  If strRetMatch2 &lt;&gt; \"\" Then\n    RetMatch = RetMatch &amp; \"*\" &amp; strRetMatch2\n  Else\n    RetMatch = RetMatch &amp; IIf(recur_level = 0 _\n                              And lngLocalLongestMatch &gt; 0 _\n                              And ((lngMatchAt1 + lngLocalLongestMatch &lt; end1) _\n                                   Or (lngMatchAt2 + lngLocalLongestMatch &lt; end2)) _\n                              , \"*\", \"\")\n  End If\n                             'Return result\n  Similarity_sub = lngLongestMatch\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "edited": false, "score": 0, "creation_date": 1487272398, "post_id": 42282024, "comment_id": 71721919, "body": "Hi Tim,   Many thanks, this code helps me a lot in my thinking process. I thought about creating each &quot;watch&quot; in a loop, but I was wondering whether this is possible in VBA and if you could give a hint in how to make this? As the AddItem &quot;watch&quot; is part of a sub/function name and as far as I know it it&#39;s not possible to create functions on the fly in VBA, how can I create new &quot;watch&quot; functions as I loop through e.g. an array?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "edited": false, "score": 0, "creation_date": 1487294415, "post_id": 42282024, "comment_id": 71731848, "body": "I updated my answer to show creating watches in a loop.  Note you don&#39;t need to create a new sub to export each folder: you can either add the full export code in the class module, so each object can perform its own exporting (based on the arguments passed to <code>Init</code>), or you can add an &quot;ExportItem&quot; Sub in a regular module which you can call from the class instances, passing the item to be exported and the destination folder path."}, {"owner": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "edited": false, "score": 0, "creation_date": 1487320943, "post_id": 42282024, "comment_id": 71741574, "body": "Great thanks!  One more thing I was wondering: in this code we use the syntax <code>Set inboxParent = Ns.GetDefaultFolder(olFolderInbox).Parent</code> Next, in the array we pass this to the GetFolderObject function. If I use this code,  this only works if the folder is a direct sister (i.e. not a subfolder) of the inbox folder. Is there any way to make this dynamic so that every folder can be choosen? I was able to do this by e.g. letting the user select a folder, and then passing that folder as an argument to GetFolderObject, but this can&#180;t be written (and subsequently read from) a text file."}, {"owner": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "edited": false, "score": 0, "creation_date": 1487337857, "post_id": 42282024, "comment_id": 71752571, "body": "I believe I found a solution but please correct me if I&#180;m not being efficient. Steps: -&gt; Let user select a folder -&gt; save as String with FolderPath property -&gt; save to text file -&gt; read from text file (upon loading Outlook) -&gt; Convert FolderPath String to Folder Object using a function -&gt; Pass Folder Object as argument to GetFolderObject function.  I haven&#39;t written the code yet, but systematically this should work right?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "edited": false, "score": 0, "creation_date": 1487346896, "post_id": 42282024, "comment_id": 71759016, "body": "Yes that sounds like a reasonable approach"}, {"owner": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "edited": false, "score": 0, "creation_date": 1488271540, "post_id": 42282024, "comment_id": 72145781, "body": "Just wanted to note that I completed the macro. It works like a charm :) Thank you once again!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "edited": false, "score": 0, "creation_date": 1488296220, "post_id": 42282024, "comment_id": 72162937, "body": "Good to hear you figured it all out!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1487294277, "last_edit_date": 1487294277, "creation_date": 1487270039, "answer_id": 42282024, "question_id": 42257360, "link": "https://stackoverflow.com/questions/42257360/loop-to-set-up-watches-on-a-selection-of-outlook-folders/42282024#42282024", "title": "Loop to set up watches on a selection of Outlook folders", "body": "<p>This doesn't address how you collect or store the various folders, but shows how to manage a collection of \"watched\" folders with separate \"save to\" paths.</p>\n\n<p>First, create a class to manage each folder:</p>\n\n<pre><code>Option Explicit\n\nPrivate OlFldr As Folder\nPrivate SavePath As String\nPublic WithEvents Items As Outlook.Items\n\n'called to set up the object\nPublic Sub Init(f As Folder, sPath As String)\n    Set OlFldr = f\n    Set Items = f.Items\n    SavePath = sPath\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n  If TypeOf Item Is Outlook.MailItem Then\n       'Just a simple message to show what's going on.\n       'You can add code here to save the item, or you can pass\n       '  arguments to a common sub defined in a regular module\n       MsgBox \"Mail '\" &amp; Item.Subject &amp; \"' was added to Folder '\" &amp; OlFldr.Name &amp; _\n              \"' and will be saved to '\" &amp; SavePath &amp; \"'\"\n  End If\nEnd Sub\n</code></pre>\n\n<p>Here's how you'd use that class to set up  your watched folders:</p>\n\n<pre><code>Option Explicit\n\nDim colFolders As Collection '&lt;&lt; holds the clsFolder objects\n\nPrivate Sub SetupFolderWatches()\n\n    'This could be called on application startup, or from the code which collects\n    '  user selections for folders/paths\n\n    Dim Ns As Outlook.NameSpace, inboxParent, arrFolders, f, arr\n    Set Ns = Application.GetNamespace(\"MAPI\")\n\n    Set colFolders = New Collection\n    Set inboxParent = Ns.GetDefaultFolder(olFolderInbox).Parent\n\n    'you'd be reading this info from a file or some other storage...\n    arrFolders = Array(\"Test1|C:\\Test1_Files\\\", \"Test2|C:\\Test2_Files\\\")\n\n    For Each f In arrFolders\n        arr = Split(f, \"|\")\n        colFolders.Add GetFolderObject(inboxParent.Folders(arr(0)), CStr(arr(1)))\n    Next f\n\nEnd Sub\n\n\n'\"factory\" function to create folder objects\nFunction GetFolderObject(foldr As Folder, sPath As String)\n    Dim rv As New clsFolder\n    rv.Init foldr, sPath\n    Set GetFolderObject = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 7430925, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c4da6027cc08017cc814d5bb96b65f75?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Spar", "link": "https://stackoverflow.com/users/7430925/jack-spar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 42282024, "answer_count": 1, "score": -1, "last_activity_date": 1593414381, "creation_date": 1487183344, "last_edit_date": 1593414381, "question_id": 42257360, "link": "https://stackoverflow.com/questions/42257360/loop-to-set-up-watches-on-a-selection-of-outlook-folders", "title": "Loop to set up watches on a selection of Outlook folders", "body": "<p>I'm doing the following in VBA in Outlook. Upon dragging an Outlook item to a specified folder, I save this Outlook item to my computer (i.e. a filing system).</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\nPrivate WithEvents Items2 As Outlook.Items\n\nPrivate Sub Application_Startup()\n  Dim Ns As Outlook.NameSpace\n  Set Ns = Application.GetNamespace(\"MAPI\")\n  Set Items = Ns.GetDefaultFolder(olFolderInbox).Parent.Folders(\"Hello\").Items\n  Set Items2 = Ns.GetDefaultFolder(olFolderInbox).Parent.Folders(\"Bye\").Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal Item As Object)\n  If TypeOf Item Is Outlook.MailItem Then\n\n  Dim sPath As String\n  Dim dtDate As Date\n  Dim sName As String\n  Dim enviro As String\n\n  enviro = CStr(Environ(\"USERPROFILE\"))\n\n  sName = Item.Subject\n  ReplaceCharsForFileName sName, \"_\"\n\n  dtDate = Item.ReceivedTime\n  sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n    vbUseSystem) &amp; Format(dtDate, \" - hhnn \", _\n    vbUseSystemDayOfWeek, vbUseSystem) &amp; \"- \" &amp; sName &amp; \".msg\"\n\n  sPath = \"Y:\\BM_Clientenmap\\D\\Hello\\emails\\\"\n  Debug.Print sPath &amp; sName\n  Item.SaveAs sPath &amp; sName, olMSG\n\n  End If\n\nEnd Sub\n\nPrivate Sub Items2_ItemAdd(ByVal Item As Object)\n  If TypeOf Item Is Outlook.MailItem Then\n\n  Dim sPath As String\n  Dim dtDate As Date\n  Dim sName As String\n  Dim enviro As String\n\n  enviro = CStr(Environ(\"USERPROFILE\"))\n\n  sName = Item.Subject\n  ReplaceCharsForFileName sName, \"_\"\n\n  dtDate = Item.ReceivedTime\n  sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n    vbUseSystem) &amp; Format(dtDate, \" - hhnn \", _\n    vbUseSystemDayOfWeek, vbUseSystem) &amp; \"- \" &amp; sName &amp; \".msg\"\n\n  sPath = \"Y:\\BM_Clientenmap\\D\\Bye\\emails\\\"\n  Debug.Print sPath &amp; sName\n  Item.SaveAs sPath &amp; sName, olMSG\n\n  End If\n\nEnd Sub\n\nPrivate Sub ReplaceCharsForFileName(sName As String, _\n  sChr As String)\n  sName = Replace(sName, \"/\", sChr)\n  sName = Replace(sName, \"\\\", sChr)\n  sName = Replace(sName, \":\", sChr)\n  sName = Replace(sName, \"?\", sChr)\n  sName = Replace(sName, Chr(34), sChr)\n  sName = Replace(sName, \"&lt;\", sChr)\n  sName = Replace(sName, \"&gt;\", sChr)\n  sName = Replace(sName, \"|\", sChr)\nEnd Sub\n</code></pre>\n\n<p>This code saves an Outlook item to the computer in directory sPath (Sub Items/Items2_AddItem), if the user adds a file to the directory specified in the variable Items/Items2 declared at the top.</p>\n\n<p>The problem is it requires me to manually add in VBA which folders VBA should \"watch\" when an item is added, and where to save these files. As a result, it requires me to write a new Items variable and new Items_ItemAdd sub for every folder I have. </p>\n\n<p>I want to do the following:</p>\n\n<ul>\n<li>Select the folder that should be \"watched\" for an item added, and the folder to which it should be saved, through user interface in Outlook instead of VBA. Users should select multiple folders (I don't care if they have to select them one at a time), with multiple save folders on the computer. </li>\n<li>I want Outlook to remember the choices that the user made upon closing Outlook. </li>\n</ul>\n\n<p>To make it more user friendly, I thought about the following. </p>\n\n<ul>\n<li><p>User selects folder in Outlook. Code that I found that does this: </p>\n\n<pre><code>Set FSO = CreateObject(\"Scripting.FileSystemObject\")\nSet myOlApp = Outlook.Application\nSet iNameSpace = myOlApp.GetNamespace(\"MAPI\")\nSet ChosenFolder = iNameSpace.PickFolder\nIf ChosenFolder Is Nothing Then\nGoTo ExitSub:\nEnd If\n</code></pre></li>\n<li><p>User then selects the folder the item should be saved to on computer. Code that I found that allows you to set a variable to an input filepath:</p>\n\n<pre><code>Function BrowseForFolder(StrSavePath As String, Optional OpenAt As String) As String\nDim objShell As Object\nDim objFolder '  As Folder\n\nDim enviro\nenviro = CStr(Environ(\"USERPROFILE\"))\nSet objShell = CreateObject(\"Shell.Application\")\nSet objFolder = objShell.BrowseForFolder(0, \"Please choose a folder\", 0, \nenviro &amp; \"\\Computer\\\")\nStrSavePath = objFolder.self.Path\n\nOn Error Resume Next\nOn Error GoTo 0\n\nExitFunction:\nSet objShell = Nothing\n\nEnd Sub\n</code></pre></li>\n</ul>\n\n<p>I want the above code to run when the user presses a button in the ribbon to which my macro would be set.</p>\n\n<p>I want Outlook to watch these folders that the user has selected (i.e. what Sub Items_ItemAdd does). This is where I get stuck. I want the choices of the user to be remembered (i.e. so the user doesn't have to select his folders every time he opens Outlook) after Outlook is closed. </p>\n\n<p>Now my questions are as follows: </p>\n\n<ul>\n<li><p>I imagined one way to make this work is to create a new variable <em>Items(i)</em> and a new Sub <em>Items(i)_ItemAdd</em> directly in the VBA code every time the user selects the folder and save folder. However, I read this is impossible to do in Outlook, unlike in Excel. Is this true? If not: how to create VBA code using VBA in Outlook? </p></li>\n<li><p>Another way I can imagine is the following. I save the input that the user made to a text file, and I read from the text file and save that to an array. However, I do not know how to use the array in the rest of my code. I do not think it's possible to create a Sub with a variable name, or run a sub with \"ItemAdd\" 'watcher' included in a for-loop that runs through the array and creates Sub functions based on the index in the Array or something like that.  </p></li>\n</ul>\n\n<p>Hope anyone can help me. Or knows any other ideas on how to make my idea work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487184310, "post_id": 42257355, "comment_id": 71673042, "body": "Are you looking for the <a href=\"https://support.office.com/en-us/article/LINEST-function-84D7D0D9-6E50-4101-977A-FA7ABF772B6D\" rel=\"nofollow noreferrer\">LINEST function</a>?"}, {"owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487184760, "post_id": 42257355, "comment_id": 71673326, "body": "Yes but i don&#39;t know how to make it work between my two points"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487185312, "post_id": 42257355, "comment_id": 71673647, "body": "Can you recuperate the <code>Range</code> of values between those two points?"}, {"owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487185593, "post_id": 42257355, "comment_id": 71673804, "body": "If i can get the x value of this point yes i will look at the data sheet and it will be good. But can i get the coordinates of the point because i have only the index of the point ?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487188195, "post_id": 42257355, "comment_id": 71675193, "body": "I think so, since you know the range from which you created the series in the graph"}, {"owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487190051, "post_id": 42257355, "comment_id": 71676262, "body": "I can t find out how to get the coordinates of the the point. It s something like ...serieCollection(1).Points(X).x i guess"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487271637, "post_id": 42257355, "comment_id": 71721498, "body": "I really don&#39;t understand the reason of closing this question !? (@Mat&#39;sMug &amp; other guys). Too broad? not at all, it is very specific and the problem is stated clearly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487272313, "post_id": 42257355, "comment_id": 71721866, "body": "@A.S.H too broad, indeed - at face value the question has a yes/no answer (&quot;is it possible to...&quot;), and IMO while the problem is stated clearly indeed, the OP&#39;s attempts aren&#39;t. I don&#39;t see how it&#39;s very much different from other &quot;how do I do X?&quot; questions that describe exactly what they need.. which routinely get closed as <i>too broad</i>."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487272933, "post_id": 42257355, "comment_id": 71722217, "body": "@Mat&#39;sMug you&#39;re probably right, just a bit disappointed that the problem seemed interesting to me and took me some amount of time to answer."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487273696, "post_id": 42257355, "comment_id": 71722646, "body": "@A.S.H eh, <i>too broad</i> questions often demand a significan amount of effort to answer... OP can still mark it as <i>accepted</i>, and you got my upvote =)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487275320, "post_id": 42257355, "comment_id": 71723670, "body": "@Mat&#39;sMug I could guess that, thanks :). My disappointment was more related to the <i>originality</i> (to my own taste) of the question itself and its potential usefulness. But I don&#39;t oppose the reason of closing anymore, it was &quot;on the edge&quot; of having this fate, in the best case."}, {"owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "edited": false, "score": 0, "creation_date": 1487276427, "post_id": 42257355, "comment_id": 71724267, "body": "I found a solution : I used the Arg2 parameter of the select event on the chart. It returned me the X value of the point. Thank&#39;s to everyone"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487276695, "post_id": 42257355, "comment_id": 71724421, "body": "Ooops, we thought you already did that! <i>&quot;Je r&#233;cup&#232;re donc l&#39;index des points et les stoque dans des variables&quot;</i>.. .*&quot;J&#39;aimerai savoir s&#39;il est possible de faire une droite de r&#233;gression lineaire&quot;*.Do you think that your comment above answers your initial question???"}, {"owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "edited": false, "score": 0, "creation_date": 1487278453, "post_id": 42257355, "comment_id": 71725508, "body": "I was able to get the index of the point in the serie but not the x value but as I said before i fixed it this morning."}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "edited": false, "score": 0, "creation_date": 1487202994, "post_id": 42260686, "comment_id": 71682197, "body": "I will try this tomorrow morning and will tell you about that. Thank&#39;s a lot for trying to fix my problem (and sorry for my english)"}, {"owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "edited": false, "score": 0, "creation_date": 1489501706, "post_id": 42260686, "comment_id": 72691615, "body": "Thank&#39;s for the help"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "edited": false, "score": 0, "creation_date": 1489502564, "post_id": 42260686, "comment_id": 72692293, "body": "@K.Fanedoul You are welcome."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1487195920, "last_edit_date": 1487195920, "creation_date": 1487195215, "answer_id": 42260686, "question_id": 42257355, "link": "https://stackoverflow.com/questions/42257355/line-estimation-between-two-points-on-a-graph-vba-excel/42260686#42260686", "title": "Line estimation between two points on a graph VBA Excel", "body": "<p>The following function calculates the least-squares line given two points on a series in a chart object.</p>\n\n<pre><code>' Calculates the \"a\" and \"b\" of the least squares line\n' given a series and two indexes on the series\n' returns an array(1 to 2) where a is (1) and b is (2)\nFunction linest(s As Series, idx1 As Long, idx2 As Long)\n    ReDim Xs(idx1 To idx2) ' The X values\n    ReDim Ys(idx1 To idx2) ' The Y values\n    Dim i As Long\n    For i = idx1 To idx2\n        Xs(i) = s.XValues(i)\n        Ys(i) = s.values(i)\n    Next\n    linest = WorksheetFunction.linest(Ys, Xs)\nEnd Function\n</code></pre>\n\n<p><strong>Usage</strong></p>\n\n<p>This test creates a chart from sheet1 columns A (X's) and B (Y's).\nThen it calculates, using the function above, the least-squares line for the values between the 5th and the 15th points.</p>\n\n<pre><code>Sub Test()\n    ' first let us create a chart object and a series\n    Dim ch As ChartObject, s As Series\n    Set ch = Sheet1.ChartObjects.Add(10, 10, 500, 250)\n    Set s = ch.Chart.SeriesCollection.NewSeries\n    s.XValues = Sheet1.Range(\"A1:A20\")\n    s.values = Sheet1.Range(\"B1:B20\")\n\n    ' calculate the least-squares line between 5th and 15th points\n    Dim eq: eq = linest(s, 5, 15)\n\n    ' display the results\n    Debug.Print \" The least squares line is:\" &amp; vbCrLf &amp; vbCrLf &amp; _\n                \" Y = \" &amp; eq(1) &amp; \"*X + \" &amp; eq(2)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "closed_date": 1487225296, "accepted_answer_id": 42260686, "answer_count": 1, "score": 0, "last_activity_date": 1489998186, "creation_date": 1487183330, "last_edit_date": 1489998186, "question_id": 42257355, "link": "https://stackoverflow.com/questions/42257355/line-estimation-between-two-points-on-a-graph-vba-excel", "closed_reason": "Needs more focus", "title": "Line estimation between two points on a graph VBA Excel", "body": "<p>My problem is this: I process data in an excel macro, this process generates charts and makes it possible to select two points on one of the charts.</p>\n\n<p>I'm picking up the index of the selected points and storing them in variables. I would like to know if it is possible to make a linear regression line in order to regain the direct coefficients of the regression line between these two points.</p>\n\n<hr>\n\n<p>(original French question)</p>\n\n<p>Mon probl\u00e8me est le suivant : Je traite des donn\u00e9es dans une macro excel, ce traitement g\u00e9n\u00e8re des graphiques. De plus la macro permet de s\u00e9lectionner deux points sur un des graphiques. Je r\u00e9cup\u00e8re donc l'index des points et les stoque dans des variables. J'aimerai savoir s'il est possible de faire une droite de r\u00e9gression lineaire pour pouvoir r\u00e9cuperer le coefficient directeur de la droite de r\u00e9gression entre ces deux points.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1487183692, "post_id": 42257305, "comment_id": 71672644, "body": "not sure if I understand, but maybe something like <code>Application.Paragraphs.Add().Paste</code> before <code>OutMail.Display</code> (I think the signature is added when it&#39;s displayed)"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487185686, "post_id": 42257305, "comment_id": 71673849, "body": "If you don&#39;t add the picture as an attachment to the email then the email will not contain the picture and the picture cannot be shown (as it is not part of the email). The <b>only</b> other way is to upload the picture to a server (which will be available to the recipient) and include a link to the picture on said server to the email. To attach the picture to the email use the following solution / code: <a href=\"http://stackoverflow.com/questions/32223633/vba-excel-how-can-i-send-an-image-saved-in-excel-on-my-hard-drive-in-an-email/32224724#32224724\" title=\"vba excel how can i send an image saved in excel on my hard drive in an email\">stackoverflow.com/questions/32223633/&hellip;</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1487186202, "post_id": 42257305, "comment_id": 71674133, "body": "Note that (in the above provided solution) Outlook neglects to show the attached picture as an attachment just because the picture is shown in the email body. Yet, this is just Outlooks deranged way of showing things. Other email clients will show the picture (correctly) as an attachment. Otherwise, the picture couldn&#39;t be shown in the email body. Reading through the VBA code you will also note that the picture gets actually attached to the email. Yet again, Outlook will not show the picture as such (for whichever reason)."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 5119891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9f287c72bebfbf3d6d1e5c5bbb643b?s=128&d=identicon&r=PG&f=1", "display_name": "Mariana", "link": "https://stackoverflow.com/users/5119891/mariana"}, "is_accepted": true, "score": 0, "last_activity_date": 1488982986, "creation_date": 1488982986, "answer_id": 42673881, "question_id": 42257305, "link": "https://stackoverflow.com/questions/42257305/add-signature-and-clipboard-image-to-email-body-vba/42673881#42673881", "title": "Add signature and clipboard image to email body VBA", "body": "<p>I was actually able to find a workaround, just by making some adjustments to my code:</p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body()\n\n'Variables\nDim r1 As Range\nDim r2 As Range\nDim s1 As String\nDim s2 As String\nDim wordDoc As Word.Document\nDim OutApp As Object\nDim OutMail As Object\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\n'Get the text that will go on the mail body\ns1 = ActiveWorkbook.Sheets(\"Plan2\").Range(\"A1\")\ns2 = ActiveWorkbook.Sheets(\"Plan2\").Range(\"A2\")\nSet r1 = Sheets(\"Plan1\").Range(\"A1:D4\")\n\nWith OutMail\n    Set wordDoc = OutMail.GetInspector.WordEditor\n\n    .To = \"example@test.com\"\n    .Subject = \"test\"\n    .HTMLbody = s1 &amp; RangetoHTML(r1) &amp; .HTMLbody\n\n    'Set the range that will be pasted as an image\n    Set r2 = Sheets(\"Plan1\").Range(\"A5:J22\")\n    r2.CopyPicture Format:=xlPicture\n    OutMail.Display\n\n    'Set the position to paste the image\n    wordDoc.Application.Selection.Start = currentPosition\n    wordDoc.Application.Selection.End = wordDoc.Application.Selection.Start\n\n    'Paste the image\n    wordDoc.Application.Selection.Paste\n\n    .HTMLbody = s2 &amp; .HTMLbody\n\n    .Close olSave\n\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This way I'm still able to avoid pasting the image through an attachment.</p>\n\n<p>Note: in order to place the text that goes after the picture in a new line, I just add a <code>\"&lt;br&gt;\"</code> before the text inside the reference cell (in this case, \"A1\" of \"Plan2\").</p>\n"}], "owner": {"reputation": 81, "user_id": 5119891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9f287c72bebfbf3d6d1e5c5bbb643b?s=128&d=identicon&r=PG&f=1", "display_name": "Mariana", "link": "https://stackoverflow.com/users/5119891/mariana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2263, "favorite_count": 0, "accepted_answer_id": 42673881, "answer_count": 1, "score": 1, "last_activity_date": 1488982986, "creation_date": 1487183194, "last_edit_date": 1531164843, "question_id": 42257305, "link": "https://stackoverflow.com/questions/42257305/add-signature-and-clipboard-image-to-email-body-vba", "title": "Add signature and clipboard image to email body VBA", "body": "<p>I'm trying to create an Outlook message through VBA, in which I want to add an string of text, some tables (using a RangetoHTML function), a picture and then the mail signature.</p>\n\n<p>I wish to avoid saving a file with the picture and adding it through an attachment (more often than not it doesn't display the image correctly), i.e. using the command:</p>\n\n<p><code>img src= 'img_name'.jpg</code></p>\n\n<p>I was hoping it could be done using the following code but, so far, I can't get the image to be placed after the text and before the signature:</p>\n\n<pre><code>Sub Mail_Selection_Range_Outlook_Body()\n\n    'Variables\n    Dim r1 As Range\n    Dim r2 As Range\n    Dim s As String\n    Dim wordDoc As Word.Document\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    'Get the text that will go on the mail body\n    s = ActiveWorkbook.Sheets(\"Plan2\").Range(\"A1\")\n    Set r1 = Sheets(\"Plan1\").Range(\"A1:D4\")\n\n    With OutMail\n        Set wordDoc = OutMail.GetInspector.WordEditor\n\n        .To = \"example@test.com\"\n        .Subject = \"test\"\n        .HTMLbody = s &amp; RangetoHTML(r1) &amp; .HTMLbody\n\n        'Set the range that will be pasted as an image\n        Set r2 = Sheets(\"Plan1\").Range(\"A5:D9\")\n        r2.CopyPicture Format:=xlPicture\n        OutMail.Display\n\n        'Set the position to paste the image\n        wordDoc.Application.Selection.Start = currentPosition\n        wordDoc.Application.Selection.End = wordDoc.Application.Selection.Start\n\n        'Paste the image\n        wordDoc.Application.Selection.Paste\n        .Close olSave\n\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<ol>\n<li>If I use the command <code>wordDoc.Application.Selection.Start = currentPosition</code> the image goes before the text;</li>\n<li>Same if I place the command <code>.SendKeys \"{END}\"</code> just before <code>wordDoc.Application.Selection.Start = currentPosition</code>;</li>\n<li>And if I use <code>wordDoc.Application.Selection.Start = Len(.Body)</code> the image is placed after the signature!</li>\n</ol>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1487184782, "creation_date": 1487184782, "answer_id": 42257819, "question_id": 42256879, "link": "https://stackoverflow.com/questions/42256879/error-on-insert-into-statement/42257819#42257819", "title": "Error on INSERT INTO statement", "body": "<p>Access SQL != T-SQL.</p>\n\n<p>You either need to run this SQL string as a <strong>Pass-Through query</strong>, then it's the same as running it in SSMS.</p>\n\n<p>Or translate it into Access SQL.</p>\n\n<p>At the very most you must change the table names into the names of the linked tables in Access (which certainly aren't <code>[database].[dbo].[table]</code>)</p>\n\n<p>If you need more help with option 2, please post the formatted result of <code>Debug.Print sqlstr</code></p>\n"}], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487197392, "creation_date": 1487181725, "last_edit_date": 1487197392, "question_id": 42256879, "link": "https://stackoverflow.com/questions/42256879/error-on-insert-into-statement", "title": "Error on INSERT INTO statement", "body": "<p>I have the following and getting the <code>error in INSERT INTO statement</code>.  I've done a <code>debug.print</code> and pasted back into SSMS and it works just fine so I'm really stumped.  The syntax looks fine to me but I know sometimes going from straight SQL to VBA SQL can be tricky. I had a feeling it was the <code>EXISTS</code> section and I took that out and made the appropriate edits and still got the error msg.  Any suggetions?</p>\n\n<pre><code>sqlstr = \"INSERT INTO [database.[dbo].[table]\" &amp; _\n    \"(\" &amp; _\n        \"User_name\" &amp; _\n        \",Client_Id\" &amp; _\n        \",Client_Name\" &amp; _\n        \",UserAccess\" &amp; _\n        \",UserId\" &amp; _\n    \")\" &amp; _\n    \"SELECT \" &amp; _\n        \"User_name = '\" &amp; UserName &amp; \"'\" &amp; _\n        \",Client_Id = \" &amp; Me.ClientList.ItemData(ClientID) &amp; \"\" &amp; _\n        \",Client_Name = '\" &amp; Me.ClientList.Column(1, ClientID) &amp; \"'\" &amp; _\n        \",UserAccess = 0\" &amp; _\n        \",UserId = \" &amp; UserId &amp; \"\" &amp; _\n  \" WHERE NOT EXISTS (SELECT 1 FROM [database].[dbo].[table] where UserID = \" &amp; UserId &amp; \" and Client_Id = \" &amp; Me.ClientList.ItemData(ClientID) &amp; \")\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487179885, "post_id": 42256164, "comment_id": 71670273, "body": "Do you mean different interest and deposit values?"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487188864, "post_id": 42256403, "comment_id": 71675578, "body": "Thank you for this solution. The only problem, it goes through Deposit Range for every number in Interest_Range as many times as there are numbers in Deposit_Range whilst the Interest_Range stays the same, resulting in outcome: A: Interest Rate 1.2% B: Deposit 1000, C: Result for A and B, instead of moving to the next number in the Interest Range and Deposit Range, it uses the same Interest Rate but different Deposit, outputting: A: Interest Rate 1.2%, B: Deposit 2000, C: Result for A and B. - I am trying to achieve the following result: A: 1.2% B: 1000 C:3200, (NEW ROW) A:2.5% B:2000, C:4200."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487191414, "post_id": 42256403, "comment_id": 71676992, "body": "Ok, so you don&#39;t want every combination of interest and deposit?  Will there ever be a time when the number of cells in the Interest_Range and the number of cells in the Deposit range are different?"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1487180146, "creation_date": 1487180146, "answer_id": 42256403, "question_id": 42256164, "link": "https://stackoverflow.com/questions/42256164/loop-through-two-or-more-range-of-cells-to-show-next-number-in-the-sequence-as-c/42256403#42256403", "title": "Loop through two or more range of cells to show next number in the sequence as cell&#39;s new value", "body": "<p>Something like this should work for you.  Note that it outputs in \"Formula Results\" sheet in columns A, B, and C.  Column A result is the interest cell value used, column B result is the Deposit cell value used, and column C result is the formula result based on those two values.</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rInterestCell As Range\n    Dim rDepositCell As Range\n    Dim rDest As Range\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(\"Sheet1\")\n    Set wsDest = wb.Sheets(\"Formula Results\")\n\n    For Each rInterestCell In Range(\"Interest_Range\").Cells\n        wsData.Range(\"A7\").Value = rInterestCell.Value  'Put the interest cell value in range A7, which is used by the formula in A6\n        For Each rDepositCell In Range(\"Deposit\").Cells\n            wsData.Range(\"A8\").Value = rDepositCell.Value   'Put the deposit cell value in range A8, which is used by the formula in A6\n            wsData.Calculate    'Update the formula result based on the new values in A7 and A8\n\n            'Guarantee that A6 is the starting cell for the results\n            Set rDest = wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1)\n            If rDest.Row &lt; 6 Then Set rDest = wsDest.Range(\"A6\")\n\n            'Output the interest cell value used, the deposit cell value used, and the formula result with those values\n            rDest.Resize(, 3).Value = Array(rInterestCell.Value, rDepositCell.Value, wsData.Range(\"A6\").Value)\n        Next rDepositCell\n    Next rInterestCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 42256403, "answer_count": 1, "score": 0, "last_activity_date": 1487180146, "creation_date": 1487179363, "last_edit_date": 1531161705, "question_id": 42256164, "link": "https://stackoverflow.com/questions/42256164/loop-through-two-or-more-range-of-cells-to-show-next-number-in-the-sequence-as-c", "title": "Loop through two or more range of cells to show next number in the sequence as cell&#39;s new value", "body": "<p>I have an Excel formula which is dependent on two defined ranges, Interest_Range and Deposit, and I have two cells which hold value for the Formula to use, A7(Interest_Range) and A8(Deposit). The formula '=SUM(B3/Interest_Range*Deposit' is located in A6. Once the formula is executed for each number in both ranges, the result is recorded in another Sheet. I now know how to achieve it with a <a href=\"https://stackoverflow.com/questions/42233706/loop-through-a-range-of-cells-on-cell-change-to-show-next-number-in-the-sequence/42234599?noredirect=1#comment71665757_42234599\">single range</a>, but looking for a solution to allow for multiple ranges.</p>\n\n<p>Solution for a single range:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rInterestCell As Range\n    Dim rDest As Range\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(\"Sheet1\")\n    Set wsDest = wb.Sheets(\"Formula Results\")\n\n    For Each rInterestCell In Range(\"Interest_Range\").Cells\n        wsData.Range(\"A7\").Value = rInterestCell.Value  'Put the interest cell value in range A7, which is used by the formula in A6\n        wsData.Calculate    'Update the formula result based on the new value in A7\n        Set rDest = wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1)\n        If rDest.Row &lt; 6 Then Set rDest = wsDest.Range(\"A6\")    'Guarantee that A6 is the starting cell for the results\n        rDest.Value = wsData.Range(\"A6\").Value   'Put the value only in a new row in the destination sheet\n    Next rInterestCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1487178799, "post_id": 42255846, "comment_id": 71669533, "body": "Perhaps you have a blank row somewhere. In any case I would use the Find method or AutoFilter."}, {"owner": {"reputation": 21, "user_id": 7570303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a0ebae679fa7d99c3a89d8b21488d8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Es", "link": "https://stackoverflow.com/users/7570303/adam-es"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487178972, "post_id": 42255846, "comment_id": 71669647, "body": "No blank rows, the CurrentRegion.Rows.Count (z) is 1601, which is the last line. The searched for result is in row 1600 (and 1601 as well).   Find is way to slow, autofilter cannot be used because the order of the rows cannot be changed."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1487179078, "post_id": 42255846, "comment_id": 71669726, "body": "Find isn&#39;t slow and I don&#39;t follow your objection to AF. Step through your code and check the value of variables and you will no doubt find one which is not as you expect."}, {"owner": {"reputation": 21, "user_id": 7570303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a0ebae679fa7d99c3a89d8b21488d8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Es", "link": "https://stackoverflow.com/users/7570303/adam-es"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487179081, "post_id": 42255846, "comment_id": 71669728, "body": "Tim Williams - no, because loopback goes up only when the next result is found. This is not the problem anyway."}, {"owner": {"reputation": 21, "user_id": 7570303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a0ebae679fa7d99c3a89d8b21488d8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Es", "link": "https://stackoverflow.com/users/7570303/adam-es"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487179188, "post_id": 42255846, "comment_id": 71669810, "body": "@SJR: there are tests of match vs find vs variant array, find is the slowest.  <a href=\"https://fastexcel.wordpress.com/2011/10/26/match-vs-find-vs-variant-array-vba-performance-shootout/\" rel=\"nofollow noreferrer\">fastexcel.wordpress.com/2011/10/26/&hellip;</a>  As for the autofilter, it would require a massive overhead to change the solution I have now. Anyway, can anyone tell me WHY that last value is not found?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487179785, "post_id": 42255846, "comment_id": 71670215, "body": "May be for many reasons... blancs, case sensitiveness, etc. <code>If Cells(adresik + loopback, x) = country</code> ... Try <code>If LCase(Trim(Cells(adresik + loopback, x))) = LCase(Trim(country))</code> ?"}, {"owner": {"reputation": 21, "user_id": 7570303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a0ebae679fa7d99c3a89d8b21488d8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Es", "link": "https://stackoverflow.com/users/7570303/adam-es"}, "edited": false, "score": 0, "creation_date": 1487180114, "post_id": 42255846, "comment_id": 71670437, "body": "Hey ASH, thanks for comment.  The code fails at the application.match, meaning it doesn&#39;t even find the GGID.  Please note that the GGID is a long variable, so no spaces or casing is taken into account. Just to make sure, I do convert the ggid into long   If Not IsError(Application.Match(CLng(ggid), ..."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1487181059, "post_id": 42255846, "comment_id": 71671042, "body": "what are the values of <code>loopback</code>, <code>z</code> and <code>y</code> when <code>If Not IsError(Application.Match(CLng(ggid), sheet.range(Cells(loopback, y), Cells(z, y)), 0))</code> returns the unexpected error?"}, {"owner": {"reputation": 21, "user_id": 7570303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a0ebae679fa7d99c3a89d8b21488d8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Es", "link": "https://stackoverflow.com/users/7570303/adam-es"}, "edited": false, "score": 0, "creation_date": 1487181842, "post_id": 42255846, "comment_id": 71671519, "body": "So I made a test array to illustrate this easier:  row1: GGID\tPays  row2:499455\tDjibouti row3:499455\tItalie row4:13\tPologne row5:499455\tAfrique du Sud row6:499455\tAfrique du Sud"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487182072, "post_id": 42255846, "comment_id": 71671651, "body": "I&#39;m not sure that converting to long solves the problem. For instance, comparing numbers with an <code>exact match</code> (parameter 0)... the cell has a number formatted as double. I have a feeling that it may have to do with some <code>epsilon</code> difference."}, {"owner": {"reputation": 21, "user_id": 7570303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a0ebae679fa7d99c3a89d8b21488d8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Es", "link": "https://stackoverflow.com/users/7570303/adam-es"}, "edited": false, "score": 1, "creation_date": 1487182420, "post_id": 42255846, "comment_id": 71671880, "body": "A.S.H. you were right. It was the format of the cell in the range. Man application.match SUCKS! Thank you for your patience!"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1487182741, "post_id": 42255846, "comment_id": 71672066, "body": "<code>.AutoFilter</code> doesn&#39;t change the order. Maybe you can look into Power Query/Microsoft Query or ADODB to query the data"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1487182857, "post_id": 42255846, "comment_id": 71672136, "body": "@AdamEs I am not sure it&#39;s only <code>Match</code>.. Any other method such as VLookup should&#39;ve faced the same issue, IMO."}], "answers": [{"comments": [{"owner": {"reputation": 2946, "user_id": 1430057, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Tbizp.jpg?s=128&g=1", "display_name": "Subash", "link": "https://stackoverflow.com/users/1430057/subash"}, "edited": false, "score": 1, "creation_date": 1522012246, "post_id": 49480394, "comment_id": 85964833, "body": "Just giving some code is not a good answer, its better to explain what you are doing or point out if there were any mistakes in OP&#39;s approach"}], "tags": [], "owner": {"reputation": 11, "user_id": 9268872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfdc16e88067bd717f6a14f4be2a1f1?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Kumar", "link": "https://stackoverflow.com/users/9268872/varun-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1522009441, "last_edit_date": 1522009441, "creation_date": 1522008222, "answer_id": 49480394, "question_id": 42255846, "link": "https://stackoverflow.com/questions/42255846/vba-application-match-does-not-find-all-values-in-lookup-range/49480394#49480394", "title": "VBA application.match does not find all values in lookup range", "body": "<pre><code>'Find the cells having formulas in sheet and add it to dictionaries\nFunction FindAllInSheet() As Scripting.Dictionary\n\n    Dim sFormulaKey As String\n    Dim wks As Worksheet\n    Dim formulaDict As New Scripting.Dictionary\n    Dim fRange As Range, strFirstAdd As String\n\n\n    Set wks = ActiveSheet\n    sFormulaKey = \"=TEST\"\n    Set formulaDict = New Scripting.Dictionary\n\n    'find the project name\n    Set fRange = wks.Cells.Find(what:=sFormulaKey, SearchDirection:=xlNext, LookAt:=xlPart)\n\n    If Not fRange Is Nothing Then\n\n        'get the address of the first occurence\n        strFirstAdd = fRange.Address\n        If Not formulaDict.Exists(fRange.Address) Then\n            formulaDict.Add fRange.Address, fRange.Formula\n        End If\n\n        'loop till  project name range is not found or first address is reached\n        Do\n            Set fRange = wks.Cells.Find(what:=sFormulaKey, After:=fRange, SearchDirection:=xlNext, LookAt:=xlPart)\n\n            If fRange Is Nothing Then\n                Exit Do\n            End If\n\n            If fRange.Address = strFirstAdd Then\n                Exit Do\n            End If\n\n            If Not formulaDict.Exists(fRange.Address) Then\n                formulaDict.Add fRange.Address, fRange.Formula\n            End If\n\n        Loop While Not fRange Is Nothing\n\n        'Return the Dictionary\n        Set FindAllInSheet = formulaDict\n\n    End If\n\nEnd Function\n\n\n'Find the cell having formulas in selected range and add it to dictionaries\nFunction FindAllInSelection() As Scripting.Dictionary\n\n    Dim sFormulaKey As String\n    Dim wks As Worksheet\n    Dim formulaDict As New Scripting.Dictionary\n    Dim fRange As Range, strFirstAdd As String\n\n\n    Set wks = ActiveSheet\n    sFormulaKey = \"=TEST\"\n    Set formulaDict = New Scripting.Dictionary\n\n    For Each fRange In Selection\n        If InStr(LCase(fRange.Formula), LCase(sFormulaKey)) &gt; 0 Then\n            If Not formulaDict.Exists(fRange.Address) Then\n                formulaDict.Add fRange.Address, fRange.Formula\n            End If\n        End If\n    Next fRange\n\n    'Return the Dictionary\n    Set FindAllInSelection = formulaDict\n\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7570303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a0ebae679fa7d99c3a89d8b21488d8?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Es", "link": "https://stackoverflow.com/users/7570303/adam-es"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 703, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1522009441, "creation_date": 1487178446, "last_edit_date": 1531164843, "question_id": 42255846, "link": "https://stackoverflow.com/questions/42255846/vba-application-match-does-not-find-all-values-in-lookup-range", "title": "VBA application.match does not find all values in lookup range", "body": "<p>I've looked around but no posts about a peculiar problem I am having. I am trying to find a combination of GGID (id) and country in a row. In my sheet, there are 4 rows with a given GGID but with different countries, then over 1000 rows with other ggids and then the correct GGID and correct country.</p>\n\n<p>The function looks like this:</p>\n\n<pre><code>Function rangefinder2(ByVal ggid As Long, ByRef sheet As Worksheet, ByVal country) As Object\n\nDim wbMain As Workbook\nSet wbMain = ThisWorkbook\nDim loopback As Long\nDim x As Integer, y As Integer, z As Long\nDim adresik As Long\nloopback = 1\n\n    For x = 1 To 15\n        If sheet.Cells(1, x) = \"Pays\" Then Exit For\n    Next x\n    For y = 1 To 15\n        If sheet.Cells(1, y) = \"GGID\" Then Exit For\n    Next y\n\n    z = sheet.range(\"A1\").CurrentRegion.Rows.Count\n    sheet.Activate      'AST: if you remove this, next line throws an error\n\n    Do\n\n        If Not IsError(Application.Match(CLng(ggid), _\n                       sheet.range(Cells(loopback, y), Cells(z, y)), 0)) Then\n\n            adresik = Application.Match(ggid, _\n                      sheet.range(Cells(loopback, y), Cells(z, y)), 0)\n\n            If Cells(adresik + loopback, x) = country Then\n                Set rangefinder2 = Cells(adresik + loopback, y)\n                Exit Function\n            End If\n        Else\n            Set rangefinder2 = Nothing\n            Exit Function\n        End If\n\n        If loopback = 1 Then\n            loopback = adresik\n        Else\n            loopback = loopback + adresik\n        End If\n    Loop\n\nEnd Function\n</code></pre>\n\n<p>Comment: the sheet is passed correctly (I checked with sheet.name), values x, y and z are calculated correctly.  The match finds first four rows (67 -71) but then fails to find the last one (1600). Value z(representing end of range) is 1601. I don't get it :/ Your help will be appreciated.</p>\n\n<p>So I made a test array to illustrate this easier:</p>\n\n<p>GGID    |s Pays \n499455  |s Djibouti \n499455  |s Italie\n13  |s Pologne\n499455  |s Afrique du Sud\n499455  |s Afrique du Sud</p>\n"}, {"tags": ["vba", "winforms", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1487179137, "post_id": 42255695, "comment_id": 71669771, "body": "I have seen this error when people have Excel versions that are older and try to do work in Win7 or newer.  I believe it has to do with how the UserForm you are calling is being called.  UserForm1.Show (or similar) should be how the UserForm is called.  Anything else, in the newer Excel versions, has been known to give error 80010007."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1487180011, "post_id": 42255695, "comment_id": 71670364, "body": "Not sure what gives, but something is wrong. If you remove the Hide code from the Queryclose event, the form closes anyway."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1487180109, "post_id": 42255695, "comment_id": 71670434, "body": "@Cyril: Never heard of that. I always call userforms by using object variables, never have trouble like you suggest. In any Excel version as of &#39;97 up to and including 2016."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487180654, "post_id": 42255695, "comment_id": 71670772, "body": "Try commenting out the line <code>Set objSummaryForm = Nothing</code>.  I&#39;m guessing that this is related to your event handling, not the form close."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1487182821, "post_id": 42255695, "comment_id": 71672115, "body": "@jkpieterse it doesn&#39;t only <i>close</i>, it <i>destroys the object</i> - which means if the form contains state that the calling code needed to use, that state is gone now: that&#39;s basically <code>Unload Me</code> and leaves the caller with having to check if the form object they created <code>Is Nothing</code>, because the form has been allowed to destroy itself. Handling <code>QueryClose</code> is specifically meant to prevent that. It&#39;s the code that <i>creates</i> an object that should be responsible for <i>destroying</i> that object. A self-destructing object is a rather annoying thing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1487183280, "post_id": 42255695, "comment_id": 71672368, "body": "I copied your form, its controls, the code-behind, the presenter class and the module, ran <code>ShowMainForm</code> and closed it with the red &quot;X&quot; button, and got no error - no repro, everything works as expected. Excel 2010 x64. I&#39;d suggest you delete the form and re-create it - <i>something</i> might have got corrupted with it. Or try reproducing the problem in a brand new workbook/project."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1487185403, "post_id": 42255695, "comment_id": 71673694, "body": "@jkpieterse I have only received that on Win7 and Win10, or others who have asked me about that error have received it while using Win7 or Win10.  The fix I&#39;ve used is to ensure that UserForm#.Show is the command used.  I have seen it on 2003-2013 versions of Excel, only.  The rationalize I can try to stumble through is speculative; this is just how I&#39;ve circumvented the problem as I&#39;ve seen it.  I would say I&#39;ve seen this a handful of times, and not on the computer the code was created on (someone writes a macro/userform and another user runs it).  Hopefully that gives a little more insight."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1487185656, "post_id": 42255695, "comment_id": 71673833, "body": "@Cyril - That just side-steps the problem.  The mechanics of using the default instance of the form is completely different from holding an instance reference."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487235485, "post_id": 42255695, "comment_id": 71694481, "body": "@Mat&#39;s Mug It destroys the object indeed. I think this is a VBA bug where the cascade of using a userform from a class this way somehow confuses the compiler. If I use a routine where I instantiate the form from within a sub in a normal module using a module-level object variable for the form all is well. This is the way I work usually. So I guess dumping the intermediate class is the way to go here."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1487235490, "post_id": 42255695, "comment_id": 71694486, "body": "@Cyril: I use Win 7 64 bit and Excel 2010 32 bit, I replicate the problem of the OP. Using my method (no intermediate class between calling code and form, but using a module or sub level form object variable) I&#39;ve never encountered this problem."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487235856, "post_id": 42255695, "comment_id": 71694748, "body": "@Mat&#39;sMug - I have just recreated the form in a blank Excel 2010, x32 bits. Same error, same place. Can you share your file somewhere e.g. in GitHub?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1487236113, "post_id": 42255695, "comment_id": 71694952, "body": "@jkpieterse - thanks for the efforts for the replication, indeed! I have flawless experience with <code>no intermediate class between code and form</code> for about 4 years, but I have decided to do something new :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487238577, "post_id": 42255695, "comment_id": 71696817, "body": "@Mat&#39;sMug - just read your comment and realized something - the error appears when you try to open the form after closing it from the red <code>x</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1487260091, "post_id": 42255695, "comment_id": 71713410, "body": "Ok I get a repro now. The error is an automation error on <code>If Not objSummaryForm.Visible</code> in <code>clsSummaryPresenter.Show</code>. You get an earlier failure if you change <code>vbModeless</code> to <code>vbModal</code>, too."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487235982, "post_id": 42269159, "comment_id": 71694840, "body": "Can you share the rest of the code? What is ufMain? Is it the <code>frmMain</code> blueprint?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1487237585, "post_id": 42269159, "comment_id": 71696041, "body": "ufMain is the name of the forms desiger object in the VBA Editor."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": -1, "last_activity_date": 1487235561, "creation_date": 1487235561, "answer_id": 42269159, "question_id": 42255695, "link": "https://stackoverflow.com/questions/42255695/an-instance-of-an-excel-vba-form-opens-with-an-error-if-it-was-closed-from-the/42269159#42269159", "title": "An instance of an Excel-VBA form opens with an error, if it was closed from the top right red `X`", "body": "<p>Calling the form like so works just fine for me:</p>\n\n<pre><code>Option Explicit\ndim mfrmMain as ufMain\n\nSub ShowMainForm2()\n    If ufMain Is Nothing Then\n        Set ufMain = New mfrmMain\n    End If\n    mfrmMain.Show vbModeless\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487261854, "post_id": 42278968, "comment_id": 71714940, "body": "It works now! The swaping of the two integers was really something I have disregarded."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487262094, "post_id": 42278968, "comment_id": 71715125, "body": "And yes, using the automatic <code>QueryClose</code> with the correct signature is a must do."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1487262843, "post_id": 42278968, "comment_id": 71715764, "body": "@Vityata thanks for that - <a href=\"https://github.com/rubberduck-vba/Rubberduck/issues/2695\" rel=\"nofollow noreferrer\">Rubberduck issue #2695: Signature mismatch inspection</a> is up for grabs!"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1487274705, "post_id": 42278968, "comment_id": 71723306, "body": "If you&#39;re ever in doubt about an event signature, you can use the Object Browser to locate the event, and then copy the signature from the Object Browser&#39;s bottom pane. That&#39;s particularly useful for events marked as hidden, that will <i>never</i> appear in the codepane&#39;s drodown."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1487334594, "post_id": 42278968, "comment_id": 71750542, "body": "Well spotted. I never thought about checking the order of the queryclose arguments. As I NEVER type events myself I just assumed the OP also didn&#39;t do that and that hence the event arguments would be correct."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1487261129, "creation_date": 1487261129, "answer_id": 42278968, "question_id": 42255695, "link": "https://stackoverflow.com/questions/42255695/an-instance-of-an-excel-vba-form-opens-with-an-error-if-it-was-closed-from-the/42278968#42278968", "title": "An instance of an Excel-VBA form opens with an error, if it was closed from the top right red `X`", "body": "<p>Changing the form's mode from <code>vbModeless</code> to <code>vbModal</code> gives you an earlier and more informative failure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rpzls.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rpzls.png\" alt=\"run-time error: &quot;automation error; connection to type library or object library for remote process has been lost.&quot;\"></a></p>\n\n<p>The problem seems to be because the <code>Cancel = True</code> assignment in the <code>QueryClose</code> handler, isn't working for some reason.</p>\n\n<p>The signature for the <code>QueryClose</code> handler is as follows:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n</code></pre>\n\n<p>Yours is:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(CloseMode As Integer, Cancel As Integer)\n</code></pre>\n\n<p>You should <strong>never type these handler signatures manually</strong> yourself - instead, use the drop-down in the codepane's top-right corner, and have the VBE generate the handler stubs for you:</p>\n\n<p><img src=\"https://i.stack.imgur.com/7YcG9.png\" alt=\"QueryClose event in the dropdown\"></p>\n\n<p>That way your handler signatures will <strong>always</strong> match the interface they're for.</p>\n\n<p>VBA doesn't really care about parameter names in handlers: the way the runtime matches a handler signature is by matching the parameter indices and their types, against the expected ones. Since both <code>QueryClose</code> parameters are <code>Integer</code> values, inverting them compiles just fine - except when you set <code>Cancel = True</code>, what the runtime sees is that you've assigned <code>CloseMode = -1</code> <strong>and left the Cancel parameter alone</strong>.</p>\n\n<p>Which means your form <em>doesn't</em> cancel its close, and thus the object gets destroyed every time.</p>\n\n<p>Invert the parameters in your <code>QueryClose</code> handler, and everything works perfectly fine and exactly as intended.</p>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "accepted_answer_id": 42278968, "answer_count": 2, "score": 2, "last_activity_date": 1506028817, "creation_date": 1487178016, "last_edit_date": 1531164843, "question_id": 42255695, "link": "https://stackoverflow.com/questions/42255695/an-instance-of-an-excel-vba-form-opens-with-an-error-if-it-was-closed-from-the", "title": "An instance of an Excel-VBA form opens with an error, if it was closed from the top right red `X`", "body": "<p><strong>Prehistory</strong> </p>\n\n<p>I have read the best practises for creating a form, concerning the fact that one should always refer to an object of the form and not the form itself. Thus, I have decided to build a boiler-plate form for myself.</p>\n\n<p><strong>The problem</strong> </p>\n\n<p>Everything ran smoothly, until the moment I have decided to close the form with the top right red <code>X</code>. It closes ok. But then, when I try to open the form again, I get this runtime error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XKH0h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XKH0h.png\" alt=\"enter image description here\"></a></p>\n\n<p>The error is on <code>objPresenter.Show</code> (see the code below). Obviously, it does not enter in the <code>if</code> above. But the problem is that the closing from the <code>X</code> does not work fine. When I close the form from the <code>End</code> button, anything works. And even, if I copy the code for the closing from the btnEnd to  <code>UserForm_QueryClose</code> it still does not work the same.</p>\n\n<p><strong>The form</strong></p>\n\n<p>Thus, I have a <code>modMain</code>, <code>frmMain</code> and <code>clsSummaryPresenter</code>, which all take care of the form. I start the code from <code>modMain</code></p>\n\n<p>My form looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/n3N01.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n3N01.png\" alt=\"enter image description here\"></a></p>\n\n<p>It has <code>btnRun</code>, <code>btnExit</code>, <code>lblInfo</code>. The name of the class is <code>frmMain</code>.</p>\n\n<p><strong>The code</strong></p>\n\n<p>In <code>frmMain</code>:</p>\n\n<pre><code>Option Explicit\n\nPublic Event OnRunReport()\nPublic Event OnExit()\n\nPublic Property Get InformationText() As String\n\n    InformationText = lblInfo.Caption\n\nEnd Property\n\nPublic Property Let InformationText(ByVal value As String)\n\n    lblInfo.Caption = value\n\nEnd Property\n\nPublic Property Get InformationCaption() As String\n\n    InformationCaption = Caption\n\nEnd Property\n\nPublic Property Let InformationCaption(ByVal value As String)\n\n    Caption = value\n\nEnd Property\n\nPrivate Sub btnRun_Click()\n\n    RaiseEvent OnRunReport\n\nEnd Sub\n\nPrivate Sub btnExit_Click()\n\n    RaiseEvent OnExit\n\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(CloseMode As Integer, Cancel As Integer)\n\n    If CloseMode = vbFormControlMenu Then\n        Cancel = True\n        Hide\n        'Even if I change the two lines above with this the error happens:\n        'RaiseEvent OnExit\n        'However, if I simply write END in stead of those two lines\n        'anything works quite ok...\n        'but that is a bit brutal.\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>In <code>clsSummaryPresenter</code></p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents objSummaryForm As frmMain\n\nPrivate Sub Class_Initialize()\n\n    Set objSummaryForm = New frmMain\n\nEnd Sub\n\nPrivate Sub Class_Terminate()\n\n    Set objSummaryForm = Nothing\n\nEnd Sub\n\nPublic Sub Show()\n\n    If Not objSummaryForm.Visible Then\n        objSummaryForm.Show vbModeless\n        Call ChangeLabelAndCaption(\"Press Run to Start\", \"Starting\")\n    End If\n\n    With objSummaryForm\n        .Top = CLng((Application.Height / 2 + Application.Top) - .Height / 2)\n        .Left = CLng((Application.Width / 2 + Application.Left) - .Width / 2)\n    End With\n\nEnd Sub\n\nPublic Sub Hide()\n\n    If objSummaryForm.Visible Then objSummaryForm.Hide\n\nEnd Sub\n\nPublic Sub ChangeLabelAndCaption(strLabelInfo As String, strCaption As String)\n\n    objSummaryForm.InformationText = strLabelInfo\n    objSummaryForm.InformationCaption = strCaption\n    objSummaryForm.Repaint\n\nEnd Sub\n\nPrivate Sub objSummaryForm_OnRunReport()\n\n    MainGenerateReport\n    Refresh\n\nEnd Sub\n\nPrivate Sub objSummaryForm_OnExit()\n\n    Hide\n\nEnd Sub\n\nPublic Sub Refresh()\n\n    With objSummaryForm\n        .lblInfo = \"Ready\"\n        .Caption = \"Task performed\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>In <code>modMain</code></p>\n\n<pre><code>Option Explicit\n\nPrivate objPresenter   As clsSummaryPresenter\n\nPublic Sub MainGenerateReport()\n\n    objPresenter.ChangeLabelAndCaption \"Starting and running...\", \"Running...\"\n    GenerateNumbers\n\nEnd Sub\n\nPublic Sub GenerateNumbers()\n\n    Dim lngLong         As Long\n    Dim lngLong2        As Long\n\n    tblMain.Cells.Clear\n\n    For lngLong = 1 To 4\n        For lngLong2 = 1 To 1\n            tblMain.Cells(lngLong, lngLong2) = lngLong * lngLong2\n        Next lngLong2\n    Next lngLong\n\nEnd Sub\n\nPublic Sub ShowMainForm()\n\n    If (objPresenter Is Nothing) Then\n        Set objPresenter = New clsSummaryPresenter\n    End If\n\n    objPresenter.Show\n\nEnd Sub\n</code></pre>\n\n<p><strong>The question</strong></p>\n\n<p>Once again, why I cannot close the form with the red <code>X</code>? I can substitute the code in <code>UserForm_QueryClose</code> with <code>End</code> but that is a bit brutal. Any ideas?</p>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1487179446, "post_id": 42256010, "comment_id": 71669990, "body": "Thank you! I never heard of the OnTime function before."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 2, "last_activity_date": 1487178879, "creation_date": 1487178879, "answer_id": 42256010, "question_id": 42255672, "link": "https://stackoverflow.com/questions/42255672/call-worksheet-event-change-when-user-doesnt-deselect-cell/42256010#42256010", "title": "call worksheet event change when user doesn&#39;t deselect cell", "body": "<p>Use two routines like so (rename Sheet1.Reallysave to your sheet's codename and routine name):</p>\n\n<pre><code>Sub SaveData()\nApplication.Ontime Now, \"Sheet1.ReallySave\"\nEnd Sub\n\nSub ReallySave()\n'Your current code\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 666, "user_id": 6811216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aed6b5487b54ae72de8ac6272a0a64c1?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib_Ibradzic", "link": "https://stackoverflow.com/users/6811216/hasib-ibradzic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 42256010, "answer_count": 1, "score": 1, "last_activity_date": 1487178897, "creation_date": 1487177979, "last_edit_date": 1487178897, "question_id": 42255672, "link": "https://stackoverflow.com/questions/42255672/call-worksheet-event-change-when-user-doesnt-deselect-cell", "title": "call worksheet event change when user doesn&#39;t deselect cell", "body": "<p>I have a very simple <code>Worksheet_Change</code> event running so that if any cell on the worksheet changes a cell on another sheet changes to 1.  I am using that cell as a flag to know if any changes have been made to the worksheet.  I have a shape that I assigned a macro to when selected.  The macro checks to see if any changes have been made (if that cell is set to 1), and if it is my code fires.  </p>\n\n<p>The problem is if for example</p>\n\n<ul>\n<li>cell <code>A1</code> contains the name Bob.</li>\n<li>A user selects cell <code>A1</code> and changes the name from Bob to Steve</li>\n<li>but then instead of first clicking out of the cell and then clicking the shape they directly hit the shape without deselecting the cell.</li>\n</ul>\n\n<p>The problem with this is that the <code>worksheet_change</code> event doesn't trigger until after my macro completes.  So while the macro runs the flag is set to 0, but once it's done the flag gets set to 1.</p>\n\n<p>Any ideas on how to stop this?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    sheets(\"Cond For\").Range(\"A1\").Value = 1\nEnd Sub\n\nSub saveData()\n\nif sheets(\"Cond For\").Range(\"A1\").Value = 1 Then\n    'my code\nEnd if\n\nEnd Sub  \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1487177705, "post_id": 42255316, "comment_id": 71668697, "body": "Try something like: <code>myStr = rs.Fields(&quot;MyField&quot;).value</code> Then use myStr it in your MsgBox."}, {"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1487177977, "post_id": 42255316, "comment_id": 71668930, "body": "I get the same error when I assign the value to <code>myStr</code>, but <code>debug.print</code> works with your code FWIW."}], "answers": [{"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 1, "last_activity_date": 1487178979, "last_edit_date": 1495535379, "creation_date": 1487178662, "answer_id": 42255926, "question_id": 42255316, "link": "https://stackoverflow.com/questions/42255316/access-vba-sql-character-to-vba-string/42255926#42255926", "title": "Access VBA: sql character to VBA string", "body": "<p>I think I see the issue. <code>Null</code> isn't the same thing as <code>vbNullString</code>. See <a href=\"https://stackoverflow.com/questions/16620354/difference-between-null-and-empty-string\">here</a> for more information. It's Java, but the idea holds.</p>\n\n<p>You have to handle the <code>Null</code> occurrence with an if statement like this:</p>\n\n<pre><code>Sub test()\n    Dim rs    As DAO.Recordset: Set rs = CurrentDb.OpenRecordset(\"myTable\")\n    Dim MyStr As String\n    If Not (rs.EOF And rs.BOF) Then rs.MoveFirst\n\n    Do Until rs.EOF\n        If IsNull(rs!MyField) Then\n            MyStr = vbNullString\n        Else\n            MyStr = rs!MyField\n        End If\n        MsgBox (MyStr)\n        rs.MoveNext\n    Loop\n\n    rs.Close\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1487179806, "creation_date": 1487179806, "answer_id": 42256303, "question_id": 42255316, "link": "https://stackoverflow.com/questions/42255316/access-vba-sql-character-to-vba-string/42256303#42256303", "title": "Access VBA: sql character to VBA string", "body": "<p>If you have nullable fields and want to treat them as text in VBA, you can \"coalesce\" them by appending <code>vbNullString</code>:  </p>\n\n<pre><code>MsgBox rs!myField &amp; vbNullString \n</code></pre>\n\n<p>Concatenation changes the value of the expression to <code>String</code> before it wraps it's passed to <code>MsgBox</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 1, "last_activity_date": 1487240302, "creation_date": 1487240302, "answer_id": 42270989, "question_id": 42255316, "link": "https://stackoverflow.com/questions/42255316/access-vba-sql-character-to-vba-string/42270989#42270989", "title": "Access VBA: sql character to VBA string", "body": "<p>You can also simply do MsgBox nz(rs!myField,\"Value if null\")</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 42255926, "answer_count": 3, "score": 0, "last_activity_date": 1487240302, "creation_date": 1487177158, "question_id": 42255316, "link": "https://stackoverflow.com/questions/42255316/access-vba-sql-character-to-vba-string", "title": "Access VBA: sql character to VBA string", "body": "<p>I would like to loop through a recordset in Access VBA and extract the values of a variable as a string in VBA. This won't work:</p>\n\n<pre><code>Sub test()\nDim rs As DAO.Recordset\nDim m As String\n\nSet rs = CurrentDb.openrecordset(\"myTable\")\n\nIf Not (rs.EOF And rs.bof) Then\nrs.movefirst\n\nDo Until rs.EOF\ndebug.print rs!myField 'works\nMsgBox rs!myField 'doesn't work\n\nrs.movenext\nLoop\n\nEnd If\n\nrs.Close\n\nEnd Sub\n</code></pre>\n\n<p>It gives me an error with the msgbox about nulls, but it works fine for debug.print. I can't seem to extract the <code>rs!myField</code> into a VBA string variable. The character variable in the table contains null values, but I should be able to still work with it.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 27, "user_id": 3217660, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1187995807944634/picture?type=large", "display_name": "Atul Kant Godiyal", "link": "https://stackoverflow.com/users/3217660/atul-kant-godiyal"}, "edited": false, "score": 0, "creation_date": 1487223265, "post_id": 42255286, "comment_id": 71688163, "body": "i tried editing the code using with statement for other sheets but the problem is that code is again working very slow"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3217660, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1187995807944634/picture?type=large", "display_name": "Atul Kant Godiyal", "link": "https://stackoverflow.com/users/3217660/atul-kant-godiyal"}, "edited": false, "score": 0, "creation_date": 1487184557, "post_id": 42256804, "comment_id": 71673200, "body": "thanks this codes works fine for one sheet in worksheet. How to extend the same code for all the sheets in worksheet"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 27, "user_id": 3217660, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1187995807944634/picture?type=large", "display_name": "Atul Kant Godiyal", "link": "https://stackoverflow.com/users/3217660/atul-kant-godiyal"}, "edited": false, "score": 0, "creation_date": 1487186453, "post_id": 42256804, "comment_id": 71674252, "body": "@AtulKantGodiyal try the edited code to do this for all sheets"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1487186433, "last_edit_date": 1487186433, "creation_date": 1487181492, "answer_id": 42256804, "question_id": 42255286, "link": "https://stackoverflow.com/questions/42255286/merge-dynamic-range-using-vba-code-and-then-loop/42256804#42256804", "title": "merge dynamic range using vba code and then loop", "body": "<p>The code below will merge ranges according to your post in <code>Worksheets(\"Employee Data\")</code>, the code runs in less than a second.  </p>\n\n<pre><code>Option Explicit\n\nSub MergeCells()\n\nDim ws As Worksheet\nDim lCol As Long, lRow As Long\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nFor Each ws In ThisWorkbook.Worksheets\n    With ws\n        For lRow = 3 To 33 Step 5 ' you can increase beyond row 33\n            For lCol = 1 To 25\n                .Range(.Cells(lRow, lCol), .Cells(lRow + 4, lCol)).Merge\n            Next lCol\n            For lCol = 30 To 40\n                .Range(.Cells(lRow, lCol), .Cells(lRow + 4, lCol)).Merge\n            Next lCol\n        Next lRow\n    End With\nNext ws\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3217660, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1187995807944634/picture?type=large", "display_name": "Atul Kant Godiyal", "link": "https://stackoverflow.com/users/3217660/atul-kant-godiyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1294, "favorite_count": 0, "accepted_answer_id": 42256804, "answer_count": 1, "score": 0, "last_activity_date": 1487186433, "creation_date": 1487177102, "question_id": 42255286, "link": "https://stackoverflow.com/questions/42255286/merge-dynamic-range-using-vba-code-and-then-loop", "title": "merge dynamic range using vba code and then loop", "body": "<p>i need help to create a code to merge five cells in a column from column 1 to 25 then from column 30 to 40 and then looping down the rows for merging again five cells.</p>\n\n<p>For example i have a sheet containing data from A3 to au3. Here i want that every cell in range A3:A7, B3:B7, C3:C7 and so on up to Y3:Y7 should merge then leaving the range Z3:AD3 as it is and merge next range from AE3:AE7 to AN3:AN7.</p>\n\n<p>Then loop down the rows to merge again five cells</p>\n\n<p>i am using this code but it is too complex and works very slow and is not working \" For each worksheet in wks\"</p>\n\n<p>any prompt help...................</p>\n\n<pre><code>Sub mergecells()\nApplication.DisplayAlerts = False\nDim Wks As Worksheet\nDim i As Integer, j As Integer, x As Integer\nOn Error Resume Next\nWith Wks(\"Employee Data\")\nFor each Worksheet In Wks\nFor i = 1 To 24\n\nRange(Cells(3, i), Cells(7, i)).Merge\nRange(Cells(8, i), Cells(12, i)).Merge\nRange(Cells(13, i), Cells(17, i)).Merge\nRange(Cells(18, i), Cells(22, i)).Merge\nRange(Cells(23, i), Cells(27, i)).Merge\nRange(Cells(28, i), Cells(32, i)).Merge\nRange(Cells(33, i), Cells(37, i)).Merge\nRange(Cells(38, i), Cells(42, i)).Merge\nRange(Cells(43, i), Cells(47, i)).Merge\nRange(Cells(48, i), Cells(52, i)).Merge\nRange(Cells(53, i), Cells(57, i)).Merge\nRange(Cells(58, i), Cells(62, i)).Merge\nRange(Cells(63, i), Cells(67, i)).Merge\nRange(Cells(68, i), Cells(72, i)).Merge\nRange(Cells(73, i), Cells(77, i)).Merge\nRange(Cells(78, i), Cells(82, i)).Merge\nRange(Cells(83, i), Cells(87, i)).Merge\nRange(Cells(88, i), Cells(92, i)).Merge\nRange(Cells(93, i), Cells(97, i)).Merge\nRange(Cells(98, i), Cells(102, i)).Merge\n\nFor j = 33 To 37\n\nRange(Cells(3, j), Cells(7, j)).Merge\nRange(Cells(8, j), Cells(12, j)).Merge\nRange(Cells(13, j), Cells(17, j)).Merge\nRange(Cells(18, j), Cells(22, j)).Merge\nRange(Cells(23, j), Cells(27, j)).Merge\nRange(Cells(28, j), Cells(32, j)).Merge\nRange(Cells(33, j), Cells(37, j)).Merge\nRange(Cells(38, j), Cells(42, j)).Merge\nRange(Cells(43, j), Cells(47, j)).Merge\nRange(Cells(48, j), Cells(52, j)).Merge\nRange(Cells(53, j), Cells(57, j)).Merge\nRange(Cells(58, j), Cells(62, j)).Merge\nRange(Cells(63, j), Cells(67, j)).Merge\nRange(Cells(68, j), Cells(72, j)).Merge\nRange(Cells(73, j), Cells(77, j)).Merge\nRange(Cells(78, j), Cells(82, j)).Merge\nRange(Cells(83, j), Cells(87, j)).Merge\nRange(Cells(88, j), Cells(92, j)).Merge\nRange(Cells(93, j), Cells(97, j)).Merge\nRange(Cells(98, j), Cells(102, j)).Merge\n\nFor x = 41 To 48\n\nRange(Cells(3, x), Cells(7, x)).Merge\nRange(Cells(8, x), Cells(12, x)).Merge\nRange(Cells(13, x), Cells(17, x)).Merge\nRange(Cells(18, x), Cells(22, x)).Merge\nRange(Cells(23, x), Cells(27, x)).Merge\nRange(Cells(28, x), Cells(32, x)).Merge\nRange(Cells(33, x), Cells(37, x)).Merge\nRange(Cells(38, x), Cells(42, x)).Merge\nRange(Cells(43, x), Cells(47, x)).Merge\nRange(Cells(48, x), Cells(52, x)).Merge\nRange(Cells(53, x), Cells(57, x)).Merge\nRange(Cells(58, x), Cells(62, x)).Merge\nRange(Cells(63, x), Cells(67, x)).Merge\nRange(Cells(68, x), Cells(72, x)).Merge\nRange(Cells(73, x), Cells(77, x)).Merge\nRange(Cells(78, x), Cells(82, x)).Merge\nRange(Cells(83, x), Cells(87, x)).Merge\nRange(Cells(88, x), Cells(92, x)).Merge\nRange(Cells(93, x), Cells(97, x)).Merge\nRange(Cells(98, x), Cells(102, x)).Merge\n\nNext         \nNext\nNext\nNext\nColumns.VertxcalAlxgnment = xlVAlxgnCenter\nApplxcatxon.DxsplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1487177001, "post_id": 42255169, "comment_id": 71668174, "body": "This is why you don&#39;t use unstructured flow control."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487177238, "post_id": 42255169, "comment_id": 71668366, "body": "Why do you <code>Dim</code> <i>line labels</i> as local variables?"}, {"owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "edited": false, "score": 0, "creation_date": 1487177390, "post_id": 42255169, "comment_id": 71668469, "body": "I have been coding for approx one &amp; a half days, &amp; am trying to fix a program which was coded for me &amp; has many bugs. Any solution to the above would be appreciated greatly."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1487177746, "post_id": 42255169, "comment_id": 71668735, "body": "5x <code>GoSub</code> calls, and 0x <code>Return</code> keywords - every gosub should have a corresponding return statement. You need to shred this code and extract each subroutine into its own actual scope/procedure/function, and replace all <code>GoSub</code> jumps with procedure calls. Sorry to say, IMO the only hope is a complete rewrite."}, {"owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "edited": false, "score": 0, "creation_date": 1487177952, "post_id": 42255169, "comment_id": 71668911, "body": "Okay, thank you for the pointers. You have given me a jumping off point."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 4, "creation_date": 1487181859, "post_id": 42255169, "comment_id": 71671529, "body": "You may also want to consider never, ever talking to the sadist who &quot;kindly&quot; wrote this code for you ever, ever again."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "edited": false, "score": 0, "creation_date": 1487178875, "post_id": 42255770, "comment_id": 71669578, "body": "Thank you for your input, I now know where to look."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 5, "last_activity_date": 1487178228, "creation_date": 1487178228, "answer_id": 42255770, "question_id": 42255169, "link": "https://stackoverflow.com/questions/42255169/getting-out-of-stack-space-error-not-sure-why-where-i-have-recursion-in-my-co/42255770#42255770", "title": "Getting &quot;Out of Stack Space error&quot;, not sure why/where I have recursion in my code", "body": "<p>As mentioned in the comments, this is why you should <em>always</em> avoid <code>GoTo</code> and <code>GoSub</code> like the plague.  The immediate cause of your stack overflow is that you are calling <code>GoSub</code> and don't have any <code>Return</code> statements.  That means in this section of code (the first infinite recursion I noticed, but probably not the only one)...</p>\n\n<pre><code>Aboverow:\n        If ActiveCell.Column = Range(\"J79\") Then\n            Range(\"J75\").Select\n            Selection.Copy\n        End If\n\n        Dim Belowrow As Variant\n\nBelowrow:\n        If Range(\"I79\") = Reg Then\n            Range(\"I80\").Select\n        End If\n\nMyprocess:\n        GoSub Aboverow\n        For Each Reg In Rainj\n            GoSub Belowrow\n            Selection.Paste\n        Next Reg\n</code></pre>\n\n<p>...your exceution jumps from the line with <code>GoSub Belowrow</code>, then it falls right back into the code below the <code>Myprocess:</code> label, which jumps <em>above</em> the <code>Belowrow:</code> label, which falls back into the code below the <code>Belowrow:</code> label, which...you get the idea.</p>\n\n<hr>\n\n<p>While you could experiment with using <code>Return</code> to exit your \"Subs\", that style of coding died sometime in the 1970s for this exact reason.  If you need a subroutine, you should make a sub-routine.  Note that this is just an example - the flow control is convoluted enough that I have no idea what the code is supposed to do:</p>\n\n<pre><code>Sub AboveRow()\n    If ActiveCell.Column = Range(\"J79\") Then\n        Range(\"J75\").Select\n        Selection.Copy\n    End If\nEnd Sub\n\nSub BelowRow()\n    If Range(\"I79\") = Reg Then\n        Range(\"I80\").Select\n    End If\nEnd Sub\n\nSub Myprocess()\n    AboveRow\n    For Each Reg In Rainj\n        BelowRow\n        Selection.Paste\n    Next Reg\nEnd Sub\n</code></pre>\n\n<p>Then the code quoted above would become just:</p>\n\n<pre><code>    AboveRow\n    BelowRow\n    Myprocess\n</code></pre>\n\n<p>Note that there are many other issues around relying on <code>Select</code> and tracking the active cell, but that should at least get you closer to a point that you can start doing some more meaningful debugging on this.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "edited": false, "score": 0, "creation_date": 1487199766, "post_id": 42256824, "comment_id": 71681123, "body": "Thanks for this Mat, I have plenty to sink my teeth into now."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1487181545, "creation_date": 1487181545, "answer_id": 42256824, "question_id": 42255169, "link": "https://stackoverflow.com/questions/42255169/getting-out-of-stack-space-error-not-sure-why-where-i-have-recursion-in-my-co/42256824#42256824", "title": "Getting &quot;Out of Stack Space error&quot;, not sure why/where I have recursion in my code", "body": "<p>In addition to what was already said...</p>\n\n<ul>\n<li>Don't declare line labels as local variables.</li>\n<li>Declare actual variables with actual data types. Using <code>Variant</code> when you mean <code>Long</code> can cost you some performance.</li>\n<li>Avoid working for nothing: if there's no code in an <code>Else</code> block, then there's no reason to have an <code>Else If</code> condition at all.</li>\n<li>Avoid working off the current <code>Selection</code> and <code>ActiveCell</code>. Use <code>Range</code> object references and work against that.</li>\n<li>Avoid implementing logic in click handlers - often you'll need more click handlers and you'll end up duplicating logic everywhere: that means you can have one bug, and twelve places to fix it.</li>\n</ul>\n\n<p>So execution starts and assigns an undeclared <code>Checkcol</code> variable in a <code>For</code> loop that runs from 3 to 801.</p>\n\n<pre><code>For Checkcol = 3 To 801\n</code></pre>\n\n<p>That should probably be reworded to eliminate the hard-coded magic numbers:</p>\n\n<pre><code>Dim targetSheet As Worksheet\nSet targetSheet = ActiveSheet 'ideally something more robust than that\n\nDim firstColumn As Long\nfirstColumn = FindFirstColumn(targetSheet) 'function that returns the first column with a heading in a specified worksheet\n\nDim lastColumn As Long\nlastColumn = FindLastColumn(targetSheet) 'function that returns the last column with a heading in a specified worksheet\n\nDim currentColumn As Long\nFor currentColumn = firstColumn To LastColumn\n</code></pre>\n\n<p>Next instruction declares an <code>Isnote</code> variable, but that variable is really just a line label and shouldn't be declared at all.</p>\n\n<p>Next we have a <code>GoSub</code> jump, that's redundant because it jumps to the line that would be executing next anyway - except here's the thing with <code>GoSub</code>: the VBA interpreter uses a mechanism called the <em>call stack</em> to track where it's at in the program. Because there is no <code>Return</code> statement, after that <code>GoSub</code> jump this is what the call stack might look like:</p>\n\n<pre><code>at label:Isnote\nat sub:commandButton12_Click\n</code></pre>\n\n<p>Now, say <code>Cells(78, Checkcol) &lt;&gt; \"o\"</code>. The call stack becomes this:</p>\n\n<pre><code>at label:Myprocess\nat label:Isnote\nat sub:commandButton12_Click\n</code></pre>\n\n<p>Now the <code>MyProcess</code> label starts by jumping to <code>Aboverow</code>, so the call stack grows again:</p>\n\n<pre><code>at label:Aboverow\nat label:Myprocess\nat label:Isnote\nat sub:commandButton12_Click\n</code></pre>\n\n<p><code>AboveRow</code> completes, but doesn't <code>Return</code> to the caller, so the last \"frame\" on the call stack is never \"popped\". Execution continues into <code>Belowrow</code> (without pushing the label to the stack) and then back into <code>Myprocess</code> (again without pushing it to the stack), and jumps back to <code>Aboverow</code> because that's what <code>Myprocess</code> does:</p>\n\n<pre><code>at label:Aboverow\nat label:Aboverow\nat label:Myprocess\nat label:Isnote\nat sub:commandButton12_Click\n</code></pre>\n\n<p>At that point execution is stuck: the stack will eventually fill up completely with <code>at label:Aboverow</code> stack frames, until it overflows its capacity and the runtime raises the run-time error you're seeing - \"Out of stack space\".</p>\n\n<p>Let's rewind to here:</p>\n\n<pre><code>at label:Isnote\nat sub:commandButton12_Click\n</code></pre>\n\n<p>If <code>Cells(78, Checkcol)</code> <em>does</em> contain an <code>o</code>, then we don't jump and everything is great, no?</p>\n\n<p>Execution resumes into <code>Isap</code> (without pushing it to the call stack), and then conditionally jumps to <code>Myprocess</code> which we know is going to get us stuck. The <code>ElseIf</code> condition is otherwise evaluated... for nothing, because nothing happens anyway.</p>\n\n<p>We assign <code>Reg</code> to a string value of <code>\"r\"</code>, then <code>Rainj</code> to an interesting concatenated value of whatever string is found in <code>Range(\"J79\")</code>, with the <em>string literal</em> value <code>\"C79\"</code>, so if <code>J79</code> contains <code>Hello</code> then that makes <code>Rainj</code> contain <code>HelloC79</code> - I very much doubt that this is the intended behavior.</p>\n\n<p>Anyway we eventually reach <code>MyProcess</code>, where we get stuck in that loop again.</p>\n\n<p>This code is therefore unreacheable, there's no way it can ever get executed:</p>\n\n<pre><code>For Each Reg In Rainj\n    GoSub Belowrow\n    Selection.Paste\nNext Reg\n</code></pre>\n\n<p>...which is a good thing, because it's trying to iterate what we now know is a string that ends with <code>\"C79\"</code>. Even if <code>Range(\"J79\")</code> contained something clever, e.g. <code>\"Sheet12!\"</code> so <code>Rainj</code> would be <code>\"Sheet12!C79\"</code>, it would still be a string literal at that point, and that loop is trying to iterate it.</p>\n\n<p>Looks like the intent was something like:</p>\n\n<pre><code>For Each Reg In Range(Rainj)\n</code></pre>\n\n<p>But what's <code>Reg</code> anyway? <code>Reg</code> contains the string literal value <code>\"r\"</code>, and we're not doing anything with it... except in the <code>BelowRow</code> label, where we compare it against <code>Range(\"I79\")</code>:</p>\n\n<pre><code>If Range(\"I79\") = Reg Then\n</code></pre>\n\n<p>So when <code>Range(\"I79\").Value</code> is <code>\"r\"</code> then we <code>.Select</code> cell <code>I80</code>... right? Except, that <code>For Each</code> loop is using <code>Reg</code> as an iterator, which <em>in theory</em> only has a meaningful value inside the body of the loop - and this is where my brain explodes and gives up trying to figure out what this is supposed to be doing: it looks like it wants to <code>.Paste</code> something in <code>I80</code> when <code>I79</code> has <em>some hard-to-figure-out-without-a-debugger</em> value... but then, the only thing that ever gets copied is <code>J75</code> - so everything is constant here, except the value of <code>J79</code>.</p>\n\n<p>Seems a very, <em>very</em> convoluted way to do:</p>\n\n<pre><code>ActiveSheet.Range(\"J75\").Copy ActiveSheet.Range(\"I80\")\n</code></pre>\n\n<p>...800 times over (well, not really, since execution can never reach the <code>Next</code> statement before overflowing the call stack).</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "is_accepted": false, "score": 1, "last_activity_date": 1487455104, "creation_date": 1487455104, "answer_id": 42321145, "question_id": 42255169, "link": "https://stackoverflow.com/questions/42255169/getting-out-of-stack-space-error-not-sure-why-where-i-have-recursion-in-my-co/42321145#42321145", "title": "Getting &quot;Out of Stack Space error&quot;, not sure why/where I have recursion in my code", "body": "<p>Just thought I would post the working answer for my question, having fixed the code given to me:</p>\n\n<pre><code>Sub Macro1()\n\nDim targetSheet As Worksheet\nSet targetSheet = ActiveSheet\n\nFor I = ActiveCell.Column - 1 To 1 Step -1\nIf Cells(78, I).Value2 = \"r\" Then\nCells(80, I).Value = Cells(75, ActiveCell.Column).Value\nElseIf Cells(78, I).Value2 = \"p\" Then\nCells(80, I).Value = Cells(75, ActiveCell.Column).Value\nExit For\nEnd If\nNext I\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks again for the replies.</p>\n"}], "owner": {"reputation": 35, "user_id": 7570076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf16a663c8fe8d1bfc617202ebc5e654?s=128&d=identicon&r=PG&f=1", "display_name": "DK92", "link": "https://stackoverflow.com/users/7570076/dk92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 42256824, "answer_count": 3, "score": 2, "last_activity_date": 1487455104, "creation_date": 1487176775, "last_edit_date": 1531164843, "question_id": 42255169, "link": "https://stackoverflow.com/questions/42255169/getting-out-of-stack-space-error-not-sure-why-where-i-have-recursion-in-my-co", "title": "Getting &quot;Out of Stack Space error&quot;, not sure why/where I have recursion in my code", "body": "<p>I have an Excel/Vba program which \"inputs\" a \"point\" via command button on a grid in excel, all the rows in the column that the \"point\" is inputted in are then used to score the \"suitability\" of that point's place in the grid (for reasons which I will not get into now). </p>\n\n<p>I am trying to write another command button code which say:</p>\n\n<p>If I input a \"point\" &amp; (due to other criteria etc), the [row 79] of that column = \"p\", copy the value in [row 75] of that column. (Let's call this \"Aboverow\"</p>\n\n<p>Then search backwards (to column C) along [row 79] for all cells/columns with \"r\" present in them. </p>\n\n<p>For every column with \"r\" present in it, paste \"Aboverow's\" value into [row 80] of that column.</p>\n\n<p>I have written the code for this but I keep getting \"out of stack space error\", I have tried to debug it, but am not sure where I am going wrong. The code is below. Any help will be very much appreciated.</p>\n\n<pre><code>Private Sub commandButton12_Click()\n\n    For Checkcol = 3 To 801\n\n        Dim Isnote As Variant\n\n        GoSub Isnote\n\nIsnote:\n        If Cells(78, Checkcol) &lt;&gt; \"o\" Then\n            GoSub Isap\n        Else\n        End If\n\n        Dim Isap As Variant        \nIsap:\n        If Cells(80, Checkcol) = \"p\" Or Cells(80, Checkcol) = \"pf\" Or Cells(80, Checkcol) = \"ps\" Then\n            GoSub Myprocess\n        ElseIf Cells(80, Checkcol) = \"r\" Or Cells(80, Checkcol) = \"rf\" Or Cells(80, Checkcol) = \"rs\" Then\n        End If\n\n        Dim Myprocess As Variant\n\n        Dim Reg As Variant    \n        Reg = \"r\"        \n\n        Dim Rainj As Variant\n\n        If ActiveCell.Column = Range(\"J79\") Then\n            Rainj = Range(\"J79\") &amp; (\"C79\")\n        End If\n\n        Dim Aboverow As Variant\n\nAboverow:\n        If ActiveCell.Column = Range(\"J79\") Then\n            Range(\"J75\").Select\n            Selection.Copy\n        End If\n\n        Dim Belowrow As Variant    \nBelowrow:\n        If Range(\"I79\") = Reg Then\n            Range(\"I80\").Select\n        End If\n\nMyprocess:\n        GoSub Aboverow\n        For Each Reg In Rainj\n            GoSub Belowrow\n            Selection.Paste\n        Next Reg\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "filtering", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3371977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3760405c2accff17c8532fa1cdc8f080?s=128&d=identicon&r=PG&f=1", "display_name": "user3371977", "link": "https://stackoverflow.com/users/3371977/user3371977"}, "is_accepted": false, "score": 0, "last_activity_date": 1487177768, "creation_date": 1487177768, "answer_id": 42255562, "question_id": 42255130, "link": "https://stackoverflow.com/questions/42255130/filter-pivot-table-using-2-cell-values/42255562#42255562", "title": "Filter pivot table using 2 cell values", "body": "<p>After further thought I figured my problem out.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'This line stops the worksheet updating on every change, it only updates when cell\n'H6 or H7 is touched\nIf Intersect(Target, Range(\"H6:H7\")) Is Nothing Then Exit Sub\n\n'Set the Variables to be used\nDim pt As PivotTable\nDim Field1 As PivotField\nDim Field2 As PivotField\nDim NewCat1 As String\nDim NewCat2 As String\n\n'Here you amend to suit your data\nSet pt = Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\")\nSet Field1 = pt.PivotFields(\"Category1\")\nSet Field1 = pt.PivotFields(\"Category2\")\nNewCat1 = Worksheets(\"Sheet1\").Range(\"H6\").Value\nNewCat2 = Worksheets(\"Sheet1\").Range(\"H7\").Value\n\n'This updates and refreshes the PIVOT table\nWith pt\nField1.ClearAllFilters\nField1.CurrentPage = NewCat1\nField2.ClearAllFilters\nField2.CurrentPage = NewCat2\npt.RefreshTable\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3371977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3760405c2accff17c8532fa1cdc8f080?s=128&d=identicon&r=PG&f=1", "display_name": "user3371977", "link": "https://stackoverflow.com/users/3371977/user3371977"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1780, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554580643, "creation_date": 1487176684, "question_id": 42255130, "link": "https://stackoverflow.com/questions/42255130/filter-pivot-table-using-2-cell-values", "title": "Filter pivot table using 2 cell values", "body": "<p>I'm trying to filter a pivot table based on two cell values for two different filters. I have found code I'm able to adapt for one of the cells I have, I'm unsure how to go about integrate a second one which is in the cell below (See code I'm adapting below)</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n'This line stops the worksheet updating on every change, it only updates when cell\n'H6 or H7 is touched\nIf Intersect(Target, Range(\"H6:H7\")) Is Nothing Then Exit Sub\n\n'Set the Variables to be used\nDim pt As PivotTable\nDim Field As PivotField\nDim NewCat As String\n\n'Here you amend to suit your data\nSet pt = Worksheets(\"Sheet1\").PivotTables(\"PivotTable1\")\nSet Field = pt.PivotFields(\"Category\")\nNewCat = Worksheets(\"Sheet1\").Range(\"H6\").Value\n\n'This updates and refreshes the PIVOT table\nWith pt\nField.ClearAllFilters\nField.CurrentPage = NewCat\npt.RefreshTable\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1487175761, "post_id": 42254704, "comment_id": 71667255, "body": "I&#39;ll have a guess at: <code>Set wsData = ActiveWorkbook.Sheets(1)</code>"}, {"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487176111, "post_id": 42254704, "comment_id": 71667549, "body": "Mismatch at:        For Each cel2 In  Workbooks(importwb).Worksheets(wsData).UsedRange.Columns(&quot;Z&quot;&zwnj;&#8203;).Cells"}, {"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487176944, "post_id": 42254704, "comment_id": 71668124, "body": "Also, if I dim wsData as string I get object required on set wsData"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487177130, "post_id": 42254704, "comment_id": 71668274, "body": "it&#39;s very difficult to interpret your code without seeing all of it. For example -- we see <code>wsData</code> and assume your intention is to use it as a <code>Worksheet</code> object (note the <code>ws</code> at the beginning of the variable name), however it becomes clear that&#39;s not the case when you use it in this way: <code>Worksheets(wsData)</code>. Please update your question to include the full code."}, {"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487177349, "post_id": 42254704, "comment_id": 71668430, "body": "added entire code"}], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 0, "last_activity_date": 1487178050, "creation_date": 1487178050, "answer_id": 42255711, "question_id": 42254704, "link": "https://stackoverflow.com/questions/42254704/vba-set-sheet-to-active-sheet-name/42255711#42255711", "title": "VBA Set sheet to active sheet name", "body": "<p>Most of this is guesswork. Take a look at the changes and try to understand them. That way you can probably correct the code yourself to make it work:</p>\n\n<pre><code>Sub Something()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Dim newFile As String\n    newFile = Application.GetOpenFilename(\"Excel CSV Files (*.csv*),*.csv*\", , \"Select Sequenced APT Parts and Tools Report\")\n\n    'Check if file selected\n    If newFile = \"False\" Then\n      MsgBox \"No file was selected. Please try again.\", vbExclamation\n      Exit Sub\n    End If\n\n    'Open wb\n    Set wb = Workbooks.Open(Filename:=newFile, ReadOnly:=True)\n    'Check for matching part and paste data to col k\n\n    Set ws = wb.Sheets(1)\n    For Each cel1 In ThisWorkbook.Sheets(\"Limited Warranty     Data\").UsedRange.Columns(\"H\").Cells\n        Dim offs As Long: offs = 3 ' &lt;-- Initial offset, will increase by 2 after each match\n        For Each cel2 In ws.UsedRange.Columns(\"Z\").Cells\n            If cel1.Value = cel2.Value Then\n                cel1.Offset(, offs).Value = cel2.Offset(, -22).Value ' &lt;- wb2(d) to wb1(K)\n                cel1.Offset(, offs + 1).Value = cel2.Offset(, -20).Value ' &lt;- wb2(f) to wb1(L)\n                offs = offs + 2 ' &lt;-- now shift the destination column by 2 for next match\n            End If\n        Next\n    Next\n    wb.Close savechanges:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2823, "favorite_count": 0, "accepted_answer_id": 42255711, "answer_count": 1, "score": 0, "last_activity_date": 1506100937, "creation_date": 1487175590, "last_edit_date": 1531164843, "question_id": 42254704, "link": "https://stackoverflow.com/questions/42254704/vba-set-sheet-to-active-sheet-name", "title": "VBA Set sheet to active sheet name", "body": "<p>I keep getting an error on ActiveWorkbook.Sheets(1) = wsData. What happens is user will select a csv file, find matches then take csv file matches in column 4 &amp; 6 and place cell value in ThisWorkbook column 11 &amp; 12 (additional matches will be offset into next two columns).</p>\n\n<p>How can I set the sheet name without knowing it? I thought this would work as it was mentioned in previous threads.</p>\n\n<pre><code>  Dim wb As Workbook\n  Dim ws As Worksheet\n  Dim cel1 As Range, cel2 As Range\n\n\n  Dim mywb As String, wsData As String\n\n  thiswb = ActiveWorkbook.Name\n\n\n  NewFile = Application.GetOpenFilename(\"Excel CSV Files (*.csv*),*.csv*\", ,            \"Select Report\")\n\n  'Check if file selected\n  If NewFile = \"False\" Then\n    MsgBox \"No file was selected. Please try again.\", vbExclamation\n    GoTo WalkOut\n  End If\n\n 'Open wb\n  Workbooks.Open Filename:=NewFile, ReadOnly:=True\n  Application.ScreenUpdating = False\n  'Check for matching part and paste data to col k\n  With NewFile\n   importwb = ActiveWorkbook.Name\n  Set wsData = ActiveWorkbook.Sheets(1)\n  'Set wsData = ActiveWorkbook.Sheets(1)\n  For Each cel1 In ThisWorkbook.Sheets(\"Limited Data\").UsedRange.Columns(\"H\").Cells\n    Dim offs As Long: offs = 3 ' &lt;-- Initial offset, will increase by 2 after each match\n    For Each cel2 In Workbooks(importwb).Worksheets(wsData).UsedRange.Columns(\"Z\").Cells\n        If cel1.Value = cel2.Value Then\n            cel1.Offset(, offs).Value = cel2.Offset(, -22).Value ' &lt;- wb2(d) to wb1(K)\n            cel1.Offset(, offs + 1).Value = cel2.Offset(, -20).Value ' &lt;- wb2(f) to wb1(L)\n            offs = offs + 2 ' &lt;-- now shift the destination column by 2 for next match\n        End If\n       Next\n       Next\n     End With\n\n\n     Workbooks(importwb).Close savechanges:=False\n     WalkOut:\n     End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487176396, "post_id": 42254788, "comment_id": 71667739, "body": "Beat me to it. Took me a while to figure out that ShapeRange was causing errors."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1487180755, "post_id": 42254788, "comment_id": 71670838, "body": "@user3598756, yes, starting from row 3. I added that detail, thanks."}, {"owner": {"reputation": 11, "user_id": 7569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5dd78ed1708a5411d57498f81a0c3?s=128&d=identicon&r=PG&f=1", "display_name": "OB2013", "link": "https://stackoverflow.com/users/7569888/ob2013"}, "edited": false, "score": 0, "creation_date": 1487263664, "post_id": 42254788, "comment_id": 71716425, "body": "These solutions both worked out very nicely. Much appreciated!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1487180798, "last_edit_date": 1487180798, "creation_date": 1487175850, "answer_id": 42254788, "question_id": 42254375, "link": "https://stackoverflow.com/questions/42254375/excel-vba-loop-through-a-range-of-cells-to-insert-a-shape-based-on-an-if-stateme/42254788#42254788", "title": "Excel VBA Loop Through a Range of Cells to Insert a Shape Based on an If Statement", "body": "<p>This will add your triangle shape to every cell in <code>B5:M5</code> where the cell two rows above has negative value. You can apply it to any range actually (starting from row 3).</p>\n\n<pre><code>Sub Add_negative_Triangle()\n    Dim ss As Range, shp As Shape\n    For Each ss In ActiveSheet.Range(\"B5:M5\")\n        If ss.offset(-2).value &lt; 0 Then\n            Set shp = ss.Parent.Shapes.AddShape(msoShapeIsoscelesTriangle, ss.Left, ss.Top, 11, 13)\n            With shp.Fill\n                .Visible = msoTrue\n                .ForeColor.RGB = RGB(205, 0, 0)\n                .Transparency = 0\n                .Solid\n            End With\n            With shp.line\n                .Visible = msoTrue\n                .ForeColor.RGB = RGB(205, 0, 0)\n                .Transparency = 0\n            End With\n            shp.Rotation = 180\n            shp.IncrementLeft 1.5\n            shp.IncrementTop 1.5\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1487176250, "creation_date": 1487176250, "answer_id": 42254963, "question_id": 42254375, "link": "https://stackoverflow.com/questions/42254375/excel-vba-loop-through-a-range-of-cells-to-insert-a-shape-based-on-an-if-stateme/42254963#42254963", "title": "Excel VBA Loop Through a Range of Cells to Insert a Shape Based on an If Statement", "body": "<p>Try this</p>\n\n<pre><code>Sub Add_negative_Triangle()\n\n'Adds Red Triangle to a Cell to indicate a decrease when corresponding cell if of a certain value\n\n    Dim SSLeft As Double\n    Dim SSRight As Double\n    Dim SSTop As Double\n    Dim SSWidth As Double\n    Dim SSHeight As Double\n    Dim SS As Range, N As Long\n    Dim z As Integer\n    Dim shpIsoscelesTriangle As Shape\n    Dim r As Range\n    Dim s As Shape\n\n    Set SS = Range(\"B3:M3\")\n    z = 0\n\n    For Each r In SS\n        SSLeft = r.Left\n        SSTop = r.Top\n        SSHeight = r.Height\n        SSWidth = r.Width\n\n        If r.Offset(2) &lt;= z Then\n            Set s = ActiveSheet.Shapes.AddShape(msoShapeIsoscelesTriangle, SSLeft, SSTop, 11, 13)\n            With s.Fill\n               .Visible = msoTrue\n               .ForeColor.RGB = RGB(205, 0, 0)\n               .Transparency = 0\n               .Solid\n            End With\n            With s.Line\n                .Visible = msoTrue\n                .ForeColor.RGB = RGB(205, 0, 0)\n                .Transparency = 0\n            End With\n            s.Rotation = 180\n            s.IncrementLeft 1.5\n            s.IncrementTop 1.5\n        End If\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd5dd78ed1708a5411d57498f81a0c3?s=128&d=identicon&r=PG&f=1", "display_name": "OB2013", "link": "https://stackoverflow.com/users/7569888/ob2013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1487180798, "creation_date": 1487174684, "last_edit_date": 1531164843, "question_id": 42254375, "link": "https://stackoverflow.com/questions/42254375/excel-vba-loop-through-a-range-of-cells-to-insert-a-shape-based-on-an-if-stateme", "title": "Excel VBA Loop Through a Range of Cells to Insert a Shape Based on an If Statement", "body": "<p>I'm trying to add an upside down red triangle to a cell to indicate a decrease in performance. For instance whenever cell B5 is less than 0, insert the upside down red triangle into cell B3.\nI've managed to get the shape to insert into B3 if B5 is less than zero, but I now need to do this for cells C3 &amp; C5, D3 &amp; D5, E3 &amp; E5, all the way through column M, possibly more. Not only that but it is likely I'll need to do this for more rows further down my spreadsheet as well.\nHow can I make my Macro loop through each row and column so that it checks if a cell is less than zero then it will add an upside down red triangle to cell (row,column)?</p>\n\n<pre><code> Sub Add_negative_Triangle()\n\n\n'Adds Red Triangle to a Cell to indicate a decrease when corresponding cell if of a certain value\n\n    Dim SSLeft As Double\n    Dim SSRight As Double\n    Dim SSTop As Double\n    Dim SSWidth As Double\n    Dim SSHeight As Double\n    Dim SS As Range, N As Long\n    Dim z As Integer\n    Dim shpIsoscelesTriangle As Shape\n    Set SS = Range(\"B3:M3\")\n    z = 0\n    SSLeft = SS.Left\n    SSTop = SS.Top\n    SSHeight = SS.Height\n    SSWidth = SS.Width\n\n\n\n  If Range(\"B5:M5\") &lt;= z Then\n        ActiveSheet.Shapes.AddShape(msoShapeIsoscelesTriangle, SSLeft, SSTop, 11, 13).Select\n\n    End If\n\n\n If Range(\"B5:M5\") &lt;= z Then\n With Selection.ShapeRange.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(205, 0, 0)\n        .Transparency = 0\n        .Solid\n End With\n\n\n\n                                            End If\n\nIf Range(\"B5:M5\") &lt;= z Then\n\n\nWith Selection.ShapeRange.Line\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(205, 0, 0)\n        .Transparency = 0\n    End With\n                                            End If\n\n\nSelection.ShapeRange.Rotation = 180\nSelection.ShapeRange.IncrementLeft 1.5\nSelection.ShapeRange.IncrementTop 1.5\n\n\n\n\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1487174727, "post_id": 42254353, "comment_id": 71666429, "body": "Take a look here: <a href=\"http://www.cpearson.com/excel/TimeZoneAndDaylightTime.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/TimeZoneAndDaylightTime.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1487177156, "post_id": 42254765, "comment_id": 71668294, "body": "Even better! Nice one."}, {"owner": {"reputation": 1514, "user_id": 4056736, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb80113bb3b5cd54c8358680fd56bafc?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Narendra", "link": "https://stackoverflow.com/users/4056736/prateek-narendra"}, "edited": false, "score": 0, "creation_date": 1487222524, "post_id": 42254765, "comment_id": 71687902, "body": "@DmitryStreblechenko Can you give an example of usage? like initializing a Dim and printing it in a msgbox"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1487229912, "post_id": 42254765, "comment_id": 71691272, "body": "What kind of example? Msgbox Application.Timezones.CurrentTimezone.Name"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1487175775, "creation_date": 1487175775, "answer_id": 42254765, "question_id": 42254353, "link": "https://stackoverflow.com/questions/42254353/get-time-zone-information-in-outlook/42254765#42254765", "title": "Get Time Zone Information in Outlook", "body": "<p>Use <code>Application.Timezones.CurrentTimezone</code>.</p>\n"}], "owner": {"reputation": 1514, "user_id": 4056736, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb80113bb3b5cd54c8358680fd56bafc?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Narendra", "link": "https://stackoverflow.com/users/4056736/prateek-narendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592896703, "creation_date": 1487174634, "last_edit_date": 1592896703, "question_id": 42254353, "link": "https://stackoverflow.com/questions/42254353/get-time-zone-information-in-outlook", "title": "Get Time Zone Information in Outlook", "body": "<p>Is there a way that Outlook Macro can detect the time zone to which the computer's time is configured to?</p>\n\n<p>I would like to use this in querying for mails in a time range</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1487174077, "post_id": 42254051, "comment_id": 71665869, "body": "can you post the website link?"}, {"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1487174143, "post_id": 42254051, "comment_id": 71665926, "body": "unfortunately I cannot post the website link and you would not have access anyways but I could share some of the HTML if this is needed"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487174444, "post_id": 42254186, "comment_id": 71666208, "body": "Thanks a lot for this ! Do I understand it right that this will list all the element values from the site ? How can I get only the value from the p element with my class and how can I return this to Excel, e.g. in a variable ?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 1, "creation_date": 1487174770, "post_id": 42254186, "comment_id": 71666468, "body": "this returns all object from the page with the class name you specify and puts it in cell A1."}, {"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487175003, "post_id": 42254186, "comment_id": 71666671, "body": "Thanks again ! This would be good too but when I run it then the Debugger starts on this line: Set doc = objIE.document - How do I have to define (Dim) doc here ?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487175076, "post_id": 42254186, "comment_id": 71666716, "body": "Yes, declare it as object."}, {"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487175187, "post_id": 42254186, "comment_id": 71666812, "body": "Still the same problem"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487175400, "post_id": 42254186, "comment_id": 71666982, "body": "what problem are you having?"}, {"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487175442, "post_id": 42254186, "comment_id": 71667013, "body": "the Debugger starts and highlights this line: Set doc = objIE.document"}], "tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1487175489, "last_edit_date": 1487175489, "creation_date": 1487174274, "answer_id": 42254186, "question_id": 42254051, "link": "https://stackoverflow.com/questions/42254051/open-website-find-specific-value-and-return-value-to-excel-in-vba/42254186#42254186", "title": "Open website, find specific value and return value to Excel in VBA", "body": "<pre><code>Dim objIE As Object\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n\nWith objIE\n    .Navigate varUrl\n    Do While .Busy\n          Application.Wait Now + TimeValue(\"0:00:01\")\n    Loop\n    .Visible = True\nEnd With\n\n'HTML document\nDim doc As Object\nSet doc = objIE.document\n\nDim el As Object\nDim myText as string\nFor Each el In doc.GetElementsByClassName(\"myClass\")\n    'put paragrah text in cell A1\n    Cells(1, 1).Value = el.innerText\n\n    'put your paragraph text in a variable string\n    myText = el.innerText\nNext el\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487174513, "post_id": 42254254, "comment_id": 71666272, "body": "This is exactly what I had in mind - thanks so much ! How can I return the resulting value to Excel, e.g. for use in a variable etc. ?"}, {"owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487174721, "post_id": 42254254, "comment_id": 71666421, "body": "I defined (Dim) sUrl as string and assigned my URL to it. How do I have to define oRequest here ?"}, {"owner": {"reputation": 5322, "user_id": 7411852, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10210681797466386/picture?type=large", "display_name": "Matt Spinks", "link": "https://stackoverflow.com/users/7411852/matt-spinks"}, "reply_to_user": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "edited": false, "score": 0, "creation_date": 1487179260, "post_id": 42254254, "comment_id": 71669856, "body": "oRequest is a <code>WinHttp.WinHttpRequest</code>. Do you have that library installed? Also, Is this inside an Excel program? If so, you should be able to do something like <code>Cells(row, col).Value = text</code>"}], "tags": [], "owner": {"reputation": 5322, "user_id": 7411852, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10210681797466386/picture?type=large", "display_name": "Matt Spinks", "link": "https://stackoverflow.com/users/7411852/matt-spinks"}, "is_accepted": false, "score": 2, "last_activity_date": 1487185061, "last_edit_date": 1487185061, "creation_date": 1487174408, "answer_id": 42254254, "question_id": 42254051, "link": "https://stackoverflow.com/questions/42254051/open-website-find-specific-value-and-return-value-to-excel-in-vba/42254254#42254254", "title": "Open website, find specific value and return value to Excel in VBA", "body": "<p>Instead of opening IE, use a web request:</p>\n\n<pre><code>Set oRequest = New WinHttp.WinHttpRequest\nWith oRequest\n    .Open \"GET\", sUrl, True\n    .SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded; charset=UTF-8\"\n    .Send \"{range:9129370}\"\n    .WaitForResponse\n    Set index = .ResponseText.IndexOf(\"&lt;p class=\"\"myClass\"\"&gt;\")\n    Set text = .ResponseText.Substring(index,3)\n    Cells(row, col).Value = text\nEnd With\n</code></pre>\n\n<p>If you don't know the length of the string you are looking for, you could also do a loop after <code>index</code> until you hit a \"<code>&lt;</code>\" character.</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1487175889, "creation_date": 1487175889, "answer_id": 42254805, "question_id": 42254051, "link": "https://stackoverflow.com/questions/42254051/open-website-find-specific-value-and-return-value-to-excel-in-vba/42254805#42254805", "title": "Open website, find specific value and return value to Excel in VBA", "body": "<p>That is a tricky and interesting question. Let's say that you want to obtain the title of this current website, which is in class <code>question-hyperlink</code> within StackOverflow. Thus, using the idea of the solution of @Matt Spinks you may come up with something like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim oRequest    As Object\n    Dim strOb       As String\n    Dim strInfo     As String: strInfo = \"class=\"\"question-hyperlink\"\"&gt;\"\n    Dim lngStart    As Long\n    Dim lngEnd      As Long\n\n    Set oRequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\n    With oRequest\n        .Open \"GET\", \"http://stackoverflow.com/questions/42254051/vba-open-website-find-specific-value-and-return-value-to-excel#42254254\", True\n        .SetRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded; charset=UTF-8\"\n        .Send \"{range:9129370}\"\n        .WaitForResponse\n        strOb = .ResponseText\n\n    End With\n\n    lngStart = InStr(1, strOb, strInfo)\n    lngEnd = InStr(lngStart, strOb, \"&lt;\")\n\n    Debug.Print Mid(strOb, lngStart + Len(strInfo), lngEnd - lngStart - Len(strInfo))\n\nEnd Sub\n</code></pre>\n\n<p>Instead of <code>Debug.print</code> you may get the Title in a string and work further.</p>\n"}], "owner": {"reputation": 155, "user_id": 7505330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4d4e2dc261270635a8b583674b51ba1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7505330/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3679, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1497786420, "creation_date": 1487173945, "last_edit_date": 1531164843, "question_id": 42254051, "link": "https://stackoverflow.com/questions/42254051/open-website-find-specific-value-and-return-value-to-excel-in-vba", "title": "Open website, find specific value and return value to Excel in VBA", "body": "<p>I would like to use VBA to open a website, look for a certain paragraph in the HTML code of this website (<code>&lt;p class=\"myClass\"&gt;XYZ&lt;/p&gt;</code>) and return this value to Excel, in my example <code>\"XYZ\"</code>. </p>\n\n<p>The website has only one paragraph (p element) with the above class. </p>\n\n<p>I know that this is possible but don't know where to start here. </p>\n\n<p>My code:</p>\n\n<pre><code>Dim objIE As Object\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n\nWith objIE\n    .Navigate varUrl\n    Do While .Busy\n          Application.Wait Now + TimeValue(\"0:00:01\")\n    Loop\n    .Visible = True\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "events", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1487173793, "creation_date": 1487173793, "answer_id": 42253987, "question_id": 42253833, "link": "https://stackoverflow.com/questions/42253833/combobox-linked-cell-value-change-does-not-fire-worksheet-change-event/42253987#42253987", "title": "Combobox linked cell value change does not fire worksheet change event", "body": "<p>If you want to trigger the ChangeEvent in a worksheet, without doing anything, here is a way to do it:</p>\n\n<p>In a module:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CheckMe()\n    Application.Run \"tblDB.Worksheet_Change\", tblDB.Cells(1, 1)\nEnd Sub\n</code></pre>\n\n<p>In a workbook, named <code>tblDB</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Debug.Print \"triggered\"\nEnd Sub\n</code></pre>\n\n<p>Now, whenever you run the <code>CheckMe</code>, the <code>Worksheet_Change</code> event would be triggered.</p>\n"}], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1143, "favorite_count": 0, "accepted_answer_id": 42253987, "answer_count": 1, "score": 2, "last_activity_date": 1518801486, "creation_date": 1487173366, "last_edit_date": 1531164843, "question_id": 42253833, "link": "https://stackoverflow.com/questions/42253833/combobox-linked-cell-value-change-does-not-fire-worksheet-change-event", "title": "Combobox linked cell value change does not fire worksheet change event", "body": "<p>As per the question: selecting a new value in an ActiveX combobox linked to a cell by it's <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196712.aspx\" rel=\"nofollow noreferrer\">.LinkedCell</a> property does not fire the worksheet change event.</p>\n\n<p>I know there are various events for combo boxes like it's own change event but none of them are really suitable for what I need to do (custom data validation on the changed cell). </p>\n\n<p>As a workaround I pass the .LinkedCell to my validation code on the combobox mouse up and key up events (I can't use lost focus... long story, and on change fires on every character change which is too much).</p>\n\n<p>Does anyone know of a cleaner way to pass the value around at the event level once the user has finished using the control?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7569945, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/deabdb64a2010eb9893297e7abea402e?s=128&d=identicon&r=PG", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7569945/jihel"}, "is_accepted": false, "score": 0, "last_activity_date": 1487174726, "last_edit_date": 1487174726, "creation_date": 1487174044, "answer_id": 42254090, "question_id": 42253824, "link": "https://stackoverflow.com/questions/42253824/excel-vba-code-to-set-x-axis-to-minimum-and-maximum-value-in-plotted-range/42254090#42254090", "title": "Excel VBA code to set x-axis to minimum and maximum value in plotted range", "body": "<p>You could add a <code>dim count as long</code> and put your min / max values in adjacent columns. Then increment your <code>count</code> in your <code>For each</code> loop and use <code>Cells([row], [n+] count).value</code> to get the cell value.\nBy the way, You can use: </p>\n\n<pre><code>With cht.Chart \n    [...]\nEnd with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487176066, "post_id": 42254120, "comment_id": 71667507, "body": "What if I want to look through each chart in a sheet such that I do column 2, then column 2+9, etc. I want to do that the same for all my charts in every sheet."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487178654, "post_id": 42254120, "comment_id": 71669434, "body": "You can have these set up using With statements, where With Sht.Cht.Chart is used.  That should allow, when going through the For Each sections, it to apply to all loops."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487178842, "post_id": 42254120, "comment_id": 71669554, "body": "Regarding the additional columns, you should be able to use a range such as .Min(Range(Columns(2),Columns(9)))."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1487174122, "creation_date": 1487174122, "answer_id": 42254120, "question_id": 42253824, "link": "https://stackoverflow.com/questions/42253824/excel-vba-code-to-set-x-axis-to-minimum-and-maximum-value-in-plotted-range/42254120#42254120", "title": "Excel VBA code to set x-axis to minimum and maximum value in plotted range", "body": "<p>Try using the WorksheetFunction.Min for this. </p>\n\n<pre><code>    Cht.Chart.Axes(xlCategory).MinimumScale = WorksheetFunction.Min(Columns(2))\n    Cht.Chart.Axes(xlCategory).MaximumScale = WorksheetFunction.Max(Columns(2))\n</code></pre>\n\n<p>This assumes the x-axis values are in column 2.  </p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487175296, "post_id": 42254316, "comment_id": 71666899, "body": "What if the range I want the x-axis is not all in column B, but is spaced out in a pattern. For example, on one sheet I have x-axis values in column B, K, P, U, Z, AE, AJ, AT, etc. so column B + 9. I would want a loop that goes through one sheet, then starts over again at the next sheet. Then the next sheet is the same pattern. How do I write that loop?"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1487174524, "creation_date": 1487174524, "answer_id": 42254316, "question_id": 42253824, "link": "https://stackoverflow.com/questions/42253824/excel-vba-code-to-set-x-axis-to-minimum-and-maximum-value-in-plotted-range/42254316#42254316", "title": "Excel VBA code to set x-axis to minimum and maximum value in plotted range", "body": "<p>If the min and max are always within the range <code>B14:B15</code> on <code>Sht</code> you can use:</p>\n\n<pre><code>Cht.Chart.Axes(xlCategory).MinimumScale = worksheetfunction.Min(Sht.Range(\"B4:B15\"))\nCht.Chart.Axes(xlCategory).MaximumScale = worksheetfunction.Max(Sht.Range(\"B4:B15\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1487175602, "last_edit_date": 1487175602, "creation_date": 1487174746, "answer_id": 42254395, "question_id": 42253824, "link": "https://stackoverflow.com/questions/42253824/excel-vba-code-to-set-x-axis-to-minimum-and-maximum-value-in-plotted-range/42254395#42254395", "title": "Excel VBA code to set x-axis to minimum and maximum value in plotted range", "body": "<p>Try to use the <code>With Cht.Chart</code> statement, it will shorten and clear your coding style.</p>\n\n<p>When looking for the <code>Min</code> and <code>Max</code> values in Column B, you need to make sure you fully qualify the <code>Range</code>, by adding <code>Sht.Range</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub Resize_Fonts()\n\nDim Sht As Worksheet\nDim Cht As ChartObject\n\nFor Each Sht In ActiveWorkbook.Sheets\n    For Each Cht In Sht.ChartObjects\n        With Cht.Chart\n            .ChartArea.Font.SIZE = 9\n            .ChartArea.Font.Name = \"Cambria\"\n            .cartArea.Border.LineStyle = xlNone\n            .Axes(xlValue).MinimumScale = 0\n            .Axes(xlCategory).MinimumScale = WorksheetFunction.Min(Sht.Range(\"B1:B\" &amp; Sht.Cells(Sht.Rows.Count, \"B\").End(xlUp).Row))\n            .Axes(xlCategory).MaximumScale = WorksheetFunction.Max(Sht.Range(\"B1:B\" &amp; Sht.Cells(Sht.Rows.Count, \"B\").End(xlUp).Row))\n        End With\n    Next Cht\nNext Sht\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487182041, "post_id": 42255380, "comment_id": 71671633, "body": "This seems exactly what I want. However, when I run this, I get a Type Mismatch error occurring in the line .Axes(xlCategory).MinimumScale = Sht.Cells(4, count).Value"}, {"owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "reply_to_user": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487234377, "post_id": 42255380, "comment_id": 71693814, "body": "Can you give me an example of your used values? B4 and B15. Is it for the first chart, second one, or more? First sheet, second sheet or more?"}, {"owner": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487254679, "post_id": 42255380, "comment_id": 71709093, "body": "So I have count defined as a long, then count = 5. I moved my columns to that each column I want to grab is a multiple of 5 to make it easier. then I have these lines in the code:               .Axes(xlCategory).MinimumScale = Sht.Cells(4, count).Value             .Axes(xlCategory).MaximumScale = Sht.Cells(23, count).Value"}, {"owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "reply_to_user": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "edited": false, "score": 0, "creation_date": 1487257267, "post_id": 42255380, "comment_id": 71711183, "body": "Okay, so what values do you put in your cells E4 and E23? Can you check in which sheet and which chart your error comes from? (first chart of first sheet, second chart of first sheet, first chart of second sheet, ...) Did you change the parameter &quot;n&quot;?"}], "tags": [], "owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "is_accepted": false, "score": 0, "last_activity_date": 1487178454, "last_edit_date": 1487178454, "creation_date": 1487177354, "answer_id": 42255380, "question_id": 42253824, "link": "https://stackoverflow.com/questions/42253824/excel-vba-code-to-set-x-axis-to-minimum-and-maximum-value-in-plotted-range/42255380#42255380", "title": "Excel VBA code to set x-axis to minimum and maximum value in plotted range", "body": "<p>After reading your comments, as I first said with my other unregistered account, you can use this method:</p>\n\n<pre><code>Sub Resize_Fonts()\nDim Sht As Worksheet\nDim Cht As ChartObject\nDim count as Long \n\ncount = 2 ' For column B\nFor Each Sht In ActiveWorkbook.Sheets\n    For Each Cht In Sht.ChartObjects\n        With Cht.Chart\n            .ChartArea.Font.Size = 9\n            .ChartArea.Font.Name = \"Cambria\"\n            .ChartArea.Border.LineStyle = xlNone\n            .Axes(xlValue).MinimumScale = 0\n            .Axes(xlCategory).MinimumScale = Sht.Cells(4, count).Value\n            .Axes(xlCategory).MaximumScale = Sht.Cells(15, count).Value\n        End with\n        count = count + n ' with n your \"pattern\"\n    Next Cht\n    count = 2 ' reset the count when changing sheet\nNext Sht\n\nEnd Sub\n</code></pre>\n\n<p>This assume values are always row 4 and row 15.</p>\n\n<p>Comment if you have any other queries</p>\n"}], "owner": {"reputation": 11, "user_id": 6242490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c151f3cac7753995cf95d4cc85d7aa2?s=128&d=identicon&r=PG&f=1", "display_name": "Kate", "link": "https://stackoverflow.com/users/6242490/kate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36708, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1617426210, "creation_date": 1487173350, "last_edit_date": 1593764147, "question_id": 42253824, "link": "https://stackoverflow.com/questions/42253824/excel-vba-code-to-set-x-axis-to-minimum-and-maximum-value-in-plotted-range", "title": "Excel VBA code to set x-axis to minimum and maximum value in plotted range", "body": "<p>I have a VBA code (below) that sets the min and max x-axis values to a specified cell (B4 and B15). However, I have many plots in my workbook, and all need a different min and max x-axis range. I want a VBA code that goes to the plotted x-axis range and then finds the min and max value in that range and sets the axis to those values. How can I alter the code below to do that?</p>\n\n<pre><code>Sub Resize_Fonts()\nDim Sht As Worksheet\nDim Cht As ChartObject\n\nFor Each Sht In ActiveWorkbook.Sheets\n    For Each Cht In Sht.ChartObjects\n        Cht.Chart.ChartArea.Font.Size = 9\n        Cht.Chart.ChartArea.Font.Name = \"Cambria\"\n        Cht.Chart.ChartArea.Border.LineStyle = xlNone\n        Cht.Chart.Axes(xlValue).MinimumScale = 0\n        Cht.Chart.Axes(xlCategory).MinimumScale = Range(\"B4\").Value\n        Cht.Chart.Axes(xlCategory).MaximumScale = Range(\"B15\").Value\n\n\n    Next Cht\nNext Sht\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1487173558, "post_id": 42253703, "comment_id": 71665466, "body": "<i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</i> - you haven&#39;t described any specific problem or error; what&#39;s the question?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7569758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d04def7fd3080ec2eaaad4fe7e304a1?s=128&d=identicon&r=PG&f=1", "display_name": "cory", "link": "https://stackoverflow.com/users/7569758/cory"}, "edited": false, "score": 0, "creation_date": 1487174229, "post_id": 42253953, "comment_id": 71666006, "body": "i pokemon_man the your modify code not run. The problem is on the Get button and search objIE.Document.getElementsByClassName(&quot;button progress-button--button&quot;)(0).Click"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1487174234, "post_id": 42253953, "comment_id": 71666009, "body": "Perhaps explain a little exactly what the difference is between that code dump and the OP&#39;s code? Readers usually don&#39;t have a built-in diff viewer.. and code dumps make quite poor answers, prompting copy+paste without understanding what&#39;s happening, or learning anything new."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 3, "user_id": 7569758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d04def7fd3080ec2eaaad4fe7e304a1?s=128&d=identicon&r=PG&f=1", "display_name": "cory", "link": "https://stackoverflow.com/users/7569758/cory"}, "edited": false, "score": 0, "creation_date": 1487174351, "post_id": 42253953, "comment_id": 71666122, "body": "@cory what you mean it does not run, runs perfectly fine on my end. The reason your code did not run is because you did not specify the &quot;(0)&quot; after setting your object element."}, {"owner": {"reputation": 3, "user_id": 7569758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d04def7fd3080ec2eaaad4fe7e304a1?s=128&d=identicon&r=PG&f=1", "display_name": "cory", "link": "https://stackoverflow.com/users/7569758/cory"}, "edited": false, "score": 0, "creation_date": 1487174886, "post_id": 42253953, "comment_id": 71666574, "body": "I tried to run the code on Excel, and fails to click on search and then perform the search."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1487174972, "post_id": 42253953, "comment_id": 71666649, "body": "put a break point or type &quot;stop&quot; before the get button and search code and see."}, {"owner": {"reputation": 3, "user_id": 7569758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d04def7fd3080ec2eaaad4fe7e304a1?s=128&d=identicon&r=PG&f=1", "display_name": "cory", "link": "https://stackoverflow.com/users/7569758/cory"}, "edited": false, "score": 0, "creation_date": 1487175887, "post_id": 42253953, "comment_id": 71667359, "body": "Many thanks pokemon_man.the code run You&#39;re great!!. I need still to learn well the code vba for web scrape hmtl page. Many thanks- Domenico"}, {"owner": {"reputation": 3, "user_id": 7569758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d04def7fd3080ec2eaaad4fe7e304a1?s=128&d=identicon&r=PG&f=1", "display_name": "cory", "link": "https://stackoverflow.com/users/7569758/cory"}, "edited": false, "score": 0, "creation_date": 1487249064, "post_id": 42253953, "comment_id": 71704648, "body": "Dear pokemon_Man. I tried to copy entire content table after press button but  i can not to copy the contents on the worksheet. Can you help me?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1487253398, "post_id": 42253953, "comment_id": 71707985, "body": "which contents?"}, {"owner": {"reputation": 3, "user_id": 7569758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d04def7fd3080ec2eaaad4fe7e304a1?s=128&d=identicon&r=PG&f=1", "display_name": "cory", "link": "https://stackoverflow.com/users/7569758/cory"}, "edited": false, "score": 0, "creation_date": 1487270897, "post_id": 42253953, "comment_id": 71721050, "body": "for example the price on the table  or time table"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1487271510, "post_id": 42253953, "comment_id": 71721425, "body": "You should ask a new question."}], "tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1487174990, "last_edit_date": 1487174990, "creation_date": 1487173692, "answer_id": 42253953, "question_id": 42253703, "link": "https://stackoverflow.com/questions/42253703/click-website-button-and-scrape-the-result/42253953#42253953", "title": "Click website button and scrape the result", "body": "<p>Specify the \"0\" at the end of your object element.  </p>\n\n<pre><code>Sub ESTRAI()\nDim objIE As Object\nDim objElement As Object\n\n' Create InternetExplorer Object\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n\n' Make sure the Internet Explorer window is visible\nobjIE.Visible = True\n\n' Navigate to your URL\nobjIE.Navigate \"https://www.trainline.eu/search/milano/roma/2017-02-16-06:00\"\n\n' Wait while IE loading...\nDo While objIE.Busy\n    Application.Wait DateAdd(\"s\", 3, Now)\nLoop\n\nWhile objIE.Busy\n    DoEvents\nWend\nDo Until objIE.readyState = 4\n    DoEvents\nLoop\nstop\n'Get button and search\nobjIE.Document.getElementsByClassName(\"button progress-button--button\")(0).Click\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7569758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d04def7fd3080ec2eaaad4fe7e304a1?s=128&d=identicon&r=PG&f=1", "display_name": "cory", "link": "https://stackoverflow.com/users/7569758/cory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1700, "favorite_count": 1, "accepted_answer_id": 42253953, "answer_count": 1, "score": -1, "last_activity_date": 1487174990, "creation_date": 1487173041, "last_edit_date": 1531164843, "question_id": 42253703, "link": "https://stackoverflow.com/questions/42253703/click-website-button-and-scrape-the-result", "title": "Click website button and scrape the result", "body": "<p>I am writing where I can execute a form on a website through a macro. I am able to open up internet explorer and pass all the variables correctly however when it comes time to submit, I am a bit lost.</p>\n\n<pre><code>Sub ESTRAI()\n    Dim objIE As Object\n    Dim objElement As Object\n\n    ' Create InternetExplorer Object\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n\n    ' Make sure the Internet Explorer window is visible\n    objIE.Visible = True\n\n    ' Navigate to your URL\n    objIE.Navigate \"https://www.trainline.eu/search/milano/roma/2017-02-16-06:00\"\n\n    ' Wait while IE loading...\n    Do While objIE.Busy\n        Application.Wait DateAdd(\"s\", 3, Now)\n    Loop\n\n    ' Get the button\n    Set objElement = objIE.Document.getElementsByClassName(\"search__button ember-view progress-button\")\n    ' Click the button\n    objElement.Click        \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1487173942, "post_id": 42253673, "comment_id": 71665752, "body": "Sorry I can&#39;t give you the answer but for what it&#39;s worth, Excel for mac crashes on me all the time when I&#39;m testing perfectly fine VBA code"}, {"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1487176182, "post_id": 42253673, "comment_id": 71667594, "body": "I don&#39;t do MAC VBA, so this is all just a guess.  <code>[NSAlert runModal] may not be invoked inside of transaction commit (usually this means it was invoked inside of a view&#39;s -drawRect: method.)</code> implies to me that the problem may be the displaying of the message box ( a modal dialog) while the screen is being updated.  Try either removing the message box code or trying applying <code>Application.ScreenUpdating = False</code> if it is supported."}], "owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1593679021, "creation_date": 1487172975, "last_edit_date": 1593679021, "question_id": 42253673, "link": "https://stackoverflow.com/questions/42253673/unknown-error-causes-excel-crash", "title": "Unknown Error causes Excel Crash", "body": "<p>I have an OSX operating system, and I am running Microsoft Excel for Mac. </p>\n\n<p>Either <a href=\"https://stackoverflow.com/q/42248504/4628637\">my macro or worksheet_change event</a> (which has no syntax errors or bugs) causes excel to quit unexpectedly with</p>\n\n<blockquote>\n  <p>'Microsoft Error Reporting'</p>\n</blockquote>\n\n<p>when I try to change the value in Target range I've specified in worksheet_change event. </p>\n\n<p>Here is the detailed log of occurred error. Can someone explain what causes the crash by looking at the log? </p>\n\n<pre><code>Microsoft Error Reporting log version: 2.0\n\nError Signature:\nException: EXC_BAD_INSTRUCTION\nException Code: 0x00000001 (0x0000000111ba94c1)\nDate/Time: 2017-02-15 15:30:02 +0000\nApplication Name: Microsoft Excel\nApplication Bundle ID: com.microsoft.Excel\nApplication Signature: XCEL\nApplication Bitness: x64\nApplication Version: 15.30.0.170107\nCrashed Module Name: CoreFoundation\nCrashed Module Version: 6.9.0\nCrashed Module Offset: 0x000000000011148b\nBlame Module Name: CocoaUI\nBlame Module Version: 1.0.0.0\nBlame Module TimeStamp: 0x5870d060\nBlame Module Offset: 0x000000000005d1ad\nStackHash: ffffbecc\nApplication LCID: 1033\nExtra app info: Reg=en Loc=0x0409\nCrashed thread: 0\nuncaught ObjC exception, reason: -[NSAlert runModal] may not be invoked inside of transaction commit (usually this means it was invoked inside of a view's -drawRect: method.)\n\nLast Exception Backtrace:\n0   CoreFoundation                      0x00007fffad88748b __exceptionPreprocess + 171 \n1   libobjc.A.dylib                     0x00007fffc1fe9cad objc_exception_throw + 48 \n2   CoreFoundation                      0x00007fffad90596d +[NSException raise:format:] + 205 \n3   AppKit                              0x00007fffabca29da _NSRunModal + 266 \n4   AppKit                              0x00007fffab7509b9 -[NSAlert runModal] + 270 \n5   CocoaUI                             0x0000000112dec1ad CUIAlertRunModal + 78 \n6   MicrosoftOffice                     0x00000001103f2952 \n...etc.\n\nOperating System Information\nOperating System: Mac OS X 10.12.1 (Build 16B2555)\nCPU: Intel x86, Logical CPU Count: 4, Frequency: 2600 MHz\nPhysical Memory: 8192 MB\nDevice: x86_64\nScreen: 1680.000000 x 1050.000000, bitsPerPixel = 24, frame = 0.000000, 0.000000, 1680.000000, 1050.000000\n\nMicrosoft Application Information:\nError Reporting UUID: 063833AD-3543-4B60-8823-2F16D072A69E\nULS UUID: 726769E8-C159-4489-8556-54B791CFCFCD\nRules Engine Session ID: 726769E8-C159-4489-8556-54B791CFCFCD\nTime from launch: 0 hours, 52 minutes, 5 seconds\nTotal errors on this client: 42\nCrashed App Virtual Memory Size: 4173.132\nCrashed App Resident Memory Size: 447.5742\n</code></pre>\n"}, {"tags": ["database", "visual-studio", "ms-access", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "reply_to_user": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1487172109, "post_id": 42253198, "comment_id": 71664316, "body": "Now it&#39;s fine ?"}, {"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1487172519, "post_id": 42253198, "comment_id": 71664661, "body": "Yes that&#39;s the correct way to post code. Now back to your problem. As I have said. Password is a reserved keyword. If you use it from ADO.NET you need to put it between square brackets."}, {"owner": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "reply_to_user": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1487172649, "post_id": 42253198, "comment_id": 71664759, "body": "You can write the code, I&#39;m not quite sure what you&#39;re saying."}, {"owner": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "reply_to_user": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1487172794, "post_id": 42253198, "comment_id": 71664874, "body": "Is my ID_User field of auto increment set to be null ??"}, {"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1487172917, "post_id": 42253198, "comment_id": 71664961, "body": "If the field is an AutoNumber then do not write anything for it (no fieldname no null value) simply ignore it."}, {"owner": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "reply_to_user": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1487174090, "post_id": 42253198, "comment_id": 71665877, "body": "How do I make an if to see if the user I created already exists and if it does not give error msg"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1487173338, "post_id": 42253539, "comment_id": 71665291, "body": "I&#39;ve seen similar but not a duplicate."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1487172587, "creation_date": 1487172587, "answer_id": 42253539, "question_id": 42253198, "link": "https://stackoverflow.com/questions/42253198/visual-basic-create-users-in-database-access/42253539#42253539", "title": "Visual basic Create Users in database access", "body": "<p>It should read:</p>\n\n<pre><code>sqlQry = \"INSERT INTO Usernames (ID_User, Username, [Password]) VALUES (Null,'\" + TextBox2.Text + \"','\" + TextBox3.Text + \"')\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "edited": false, "score": 0, "creation_date": 1487173406, "post_id": 42253767, "comment_id": 71665346, "body": "Do not miss Dim sqlQry as string"}, {"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "edited": false, "score": 0, "creation_date": 1487173566, "post_id": 42253767, "comment_id": 71665475, "body": "Corrected. Really there is no need to <i>as String</i> when the compiler can see from the context the type of the variable to be assigned. (But Dim yes)"}, {"owner": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "edited": false, "score": 0, "creation_date": 1487174079, "post_id": 42253767, "comment_id": 71665872, "body": "i got more How do I make an if to see if the user I created already exists and if it does not give error msg"}, {"owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "edited": false, "score": 0, "creation_date": 1487175208, "post_id": 42253767, "comment_id": 71666826, "body": "@JorgePereira please one problem at time. If questions here help to solve your problem please accept one then post a new question with the new details"}], "tags": [], "owner": {"reputation": 202712, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": false, "score": 1, "last_activity_date": 1487173512, "last_edit_date": 1487173512, "creation_date": 1487173211, "answer_id": 42253767, "question_id": 42253198, "link": "https://stackoverflow.com/questions/42253198/visual-basic-create-users-in-database-access/42253767#42253767", "title": "Visual basic Create Users in database access", "body": "<p>There are at least three problems in your code:<br>\n1) Password is a reserved keyword. Needs to be between square brackets<br>\n2) String values when passed to a database need to be between single quotes, but.. see point 3<br>\n3) Use parameters instead of string concatenation (what if password contains a single quote?)<br>\n4) Dispose the disposable object like the connection and the command.</p>\n\n<p>So rewriting it </p>\n\n<pre><code>Dim constring = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=E:\\Software_Simples\\Software\\DataBase.accdb\"\nDim sqlQry = \"INSERT INTO Usernames(Username, [Password]) VALUES(@name, @pwd)\"\nTry\n    Using myconnection = New OleDbConnection(constring)\n    Using cmd As New OleDbCommand(sqlQry, myconnection)\n        myconnection.Open()\n        cmd.Parameters.Add(\"@name\", OleDbType.VarWChar).Value = TextBox2.Text\n        cmd.Parameters.Add(\"@pwd\", OleDbType.VarWChar).Value = TextBox3.Text\n        cmd.ExecuteNonQuery()\n    End Using\n    End Using\nCatch ex As Exception\n    MessageBox.Show(ex.Message)\nEnd Try\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7568520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eced00a7c995007114b5e3cf81c8a17?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Pereira", "link": "https://stackoverflow.com/users/7568520/jorge-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594640467, "creation_date": 1487171620, "last_edit_date": 1594640467, "question_id": 42253198, "link": "https://stackoverflow.com/questions/42253198/visual-basic-create-users-in-database-access", "title": "Visual basic Create Users in database access", "body": "<p>I'm doing a program and I'm in a part that I need to create users in the database in access. But after entering the data and clicking the create user button it gives me an error. If you add users to the database it works but if you try to add it by the program's the result is a syntax error</p>\n\n<pre><code>Else\n    Try\n        Dim myconnection As OleDbConnection\n        Dim constring As String = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=E:\\Software_Simples\\Software\\DataBase.accdb\"\n        myconnection = New OleDbConnection(constring)\n        myconnection.Open()\n        Dim sqlQry As String\n\n        'sqlQry = \"INSERT INTO Usernames(Username, Password) VALUES(\" &amp; TextBox2.Text &amp; \",\" &amp; TextBox3.Text &amp; \")\"\n        sqlQry = \"INSERT INTO Usernames(ID_User, Username, Password) VALUES(Null,TextBox2.Text,TextBox3.Text )\"\n\n        Dim cmd As New OleDbCommand(sqlQry, myconnection)\n        cmd.ExecuteNonQuery()\n\n        myconnection.Close()\n    Catch ex As Exception\n        MessageBox.Show(ex.Message)\n    End Try\n    'Fechar\n    Me.Close()\n    MessageBox.Show(\"Utilizador criado com suecesso: \" &amp; username_create, \"Aviso\", MessageBoxButtons.OK)\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "comparison", "range", "findall"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487171802, "post_id": 42253191, "comment_id": 71664047, "body": "you could try findformat and then check the value?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "edited": false, "score": 0, "creation_date": 1487707907, "post_id": 42254322, "comment_id": 71903085, "body": "Thank you. But I modified my logic. I am not using findall now . What I do is, 1) sort file1.copy range into array 1 2) sort file 2 . copy range into array2. 3) I loop through the array to find common rows and filter rows as per the required criteria. Its way more faster and doesn&#39;t require added modules too. Thank you so much for you help."}], "tags": [], "owner": {"reputation": 1, "user_id": 7569945, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/deabdb64a2010eb9893297e7abea402e?s=128&d=identicon&r=PG", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7569945/jihel"}, "is_accepted": false, "score": 0, "last_activity_date": 1487175643, "last_edit_date": 1487175643, "creation_date": 1487174549, "answer_id": 42254322, "question_id": 42253191, "link": "https://stackoverflow.com/questions/42253191/range-findall-is-very-slow-any-alternatives/42254322#42254322", "title": "range.findall is very slow.any alternatives", "body": "<p>\"for all rows which have same value in column1\" -> this means you HAVE to make an <code>.Autofilter</code> (much faster than <code>.Find</code>)</p>\n\n<p>\"check the font color for other fields. if it is red, copy column1 to new result sheet\" -> then you loop through the filtered cells as you did OR before or after the previous <code>.Autofilter</code>, you add a column (with let's say 0 or 1) and loop through the cells to get the font color as you want and then <code>.Autofilter</code> again with 2 conditions this time (value + 0 or 1).</p>\n\n<p>After that, feel free to copy the filtered range and paste it to the new result sheet.</p>\n\n<p>I think this should be faster.</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1489623357, "last_edit_date": 1489623357, "creation_date": 1487708012, "answer_id": 42377055, "question_id": 42253191, "link": "https://stackoverflow.com/questions/42253191/range-findall-is-very-slow-any-alternatives/42377055#42377055", "title": "range.findall is very slow.any alternatives", "body": "<p>I modified my logic. I am not using <code>findall</code> now . What I did was, </p>\n\n<p>1) sort file1. copy range into array 1 </p>\n\n<p>2) sort file2. copy range into array2. </p>\n\n<p>3) I loop through the array to find common rows and filter rows as per the required criteria. </p>\n\n<p>Its way more faster and doesn't require added modules too.</p>\n"}], "owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489623357, "creation_date": 1487171609, "last_edit_date": 1525816150, "question_id": 42253191, "link": "https://stackoverflow.com/questions/42253191/range-findall-is-very-slow-any-alternatives", "title": "range.findall is very slow.any alternatives", "body": "<p>Here is what i am doing with huge data in sheet 1 and sheet 2:</p>\n\n<ol>\n<li><p>compare sheet1.columnnames (based on multiple comparisons) to all the matching rows in sheet2. Highlight differences and paste it to result sheet.</p></li>\n<li><p>In the result sheet, for all rows which have same value in column1 , check the font color for other fields. if it is red, copy column1 to new result sheet.</p></li>\n</ol>\n\n<p>I am done with (1). For (2) I am using findall function for range from (<a href=\"http://www.cpearson.com/excel/findall.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/findall.aspx</a>) to get subset of all duplicates in column1. The code is working but it is very very slow. Is there any other way i can do it?</p>\n\n<p>I could have done it using arrays but i am not able to touch font colors using arrays.  I tried Application.Calculation = xlCalculationManual and Application.ScreenUpdating = False. It did not make any difference.</p>\n\n<p>Following is the code snippet for find all.  Can you please suggest any other method?</p>\n\n<pre><code>    Dim foundRange As Range\nDim SearchRange As Range\nDim FindWhat As Variant\nDim irowcount, icount, iMaxCount As Long\nDim bFlag As Boolean\nWith XL_Ws_Result\n    'range with column header\n    Set rowRangeHeaderA = .Range(.Cells(1, 1), .Cells(Last_Row_Base, Last_Col_Base))\n    'range in result sheet without column header\n    Set SearchRange = rowRangeHeaderA.Offset(1, 0).Resize(rowRangeHeaderA.Rows.count - 1, Last_Col_Base)\nEnd With\n\nFor irowcount = 1 To SearchRange.Rows.count\n    'search string\n    FindWhat = SearchRange.Cells(irowcount, 1)\n\n    Set foundRange = FindAll(SearchRange:=SearchRange, _\n                            FindWhat:=FindWhat, _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByColumns, _\n                            MatchCase:=False, _\n                            BeginsWith:=vbNullString, _\n                            EndsWith:=vbNullString, _\n                            BeginEndCompare:=vbTextCompare)\n\n    If Not foundRange Is Nothing Then\n        iMaxCount = foundRange.Rows.count\n        For icount = 1 To iMaxCount\n            'check font color\n            If foundRange.Cells(icount, 9).Font.ColorIndex = 3 And foundRange.Cells(icount, 9).Font.ColorIndex = 3 Then\n                bFlag = True\n            Else\n                'if any cell is not red i want to skip entire found range. not need for further processing\n                bFlag = False\n                Set foundRange = Nothing\n                Exit For\n            End If\n\n            If bFlag = True Then\n                XL_Mismatch.Cells(i, 1) = foundRange.Cells(1, 1).Value\n            End If\n        Next icount\n\n        irowcount = irowcount + iMaxCount - 1\n    End If\nNext irowcount\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1487169781, "post_id": 42252392, "comment_id": 71662453, "body": "FYI - If <code>newWS</code> isn&#39;t the ActiveSheet, then the <code>Rows.Count</code> will run on another sheet. You should (assuming you want to count the rows in <code>NewWS</code>) change the line to <code>i = newWs.Cells(newWS.Rows.Count, 1).End(xlUp).Row</code>.  Are you able to get the Date cell? And want to see how to get the same row&#39;s cell, in Column B?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1487169983, "post_id": 42252392, "comment_id": 71662598, "body": "Is your code erroring or doing the wrong thing? @BruceWayne - agree it&#39;s good practice but does that actually matter given that each sheet has the same number of rows?"}, {"owner": {"reputation": 81, "user_id": 6192787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb3e6b79051237c2c0dc9cefbcb4c727?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6192787/david"}, "edited": false, "score": 0, "creation_date": 1487170532, "post_id": 42252392, "comment_id": 71663045, "body": "Yes exactly, I managed to get the Date cell and I would like to get the same row&#39;s cell."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1487170765, "post_id": 42252392, "comment_id": 71663201, "body": "@David you could use <code>Range([date cell])Offset(0,-5)</code>, no?"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1487170450, "creation_date": 1487170450, "answer_id": 42252734, "question_id": 42252392, "link": "https://stackoverflow.com/questions/42252392/vba-get-first-cell-when-comment-cell-is-selected/42252734#42252734", "title": "VBA - get first cell when comment cell is selected", "body": "<p>Perhaps just change this line?</p>\n\n<pre><code>newWs.Cells(i, 1).Resize(1, 5).Value = Array(ws.Name, rng.Address, rng.Value, rng.Comment.Text, ws.Cells(rng.Row, 2))\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6192787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb3e6b79051237c2c0dc9cefbcb4c727?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6192787/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 42252734, "answer_count": 1, "score": 0, "last_activity_date": 1487170450, "creation_date": 1487169607, "last_edit_date": 1531161705, "question_id": 42252392, "link": "https://stackoverflow.com/questions/42252392/vba-get-first-cell-when-comment-cell-is-selected", "title": "VBA - get first cell when comment cell is selected", "body": "<p>I have few sheet that i would like to read all comments from each sheet.\nI managed to get the comments but what i could get is the first cell of the same row and column of the commented cell.( attached photo)</p>\n\n<p>red - commented cell.</p>\n\n<p>green - required cell value.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wmLmh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wmLmh.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    Sub ShowCommentsAllSheets()\n    'Update 20140508\n    Dim commrange As Range\n    Dim rng As Range\n    Dim ws As Worksheet\n    Dim newWs As Worksheet\n    Set newWs = Application.Worksheets(\"CRs\")\n    newWs.Range(\"A1\").Resize(1, 4).Value = Array(\"Sheet\", \"A\", \"Value\", \"Comment\")\n    Application.ScreenUpdating = False\n    On Error Resume Next\n    For Each ws In Application.ActiveWorkbook.Worksheets\n        Set commrange = ws.Cells.SpecialCells(xlCellTypeComments)\n        If Not commrange Is Nothing Then\n            i = newWs.Cells(Rows.Count, 1).End(xlUp).Row\n            For Each rng In commrange\n                i = i + 1\n                newWs.Cells(i, 1).Resize(1, 4).Value = Array(ws.Name, rng.Address, rng.Value, rng.Comment.Text)\n            Next\n        End If\n        Set commrange = Nothing\n    Next\n    newWs.Cells.WrapText = False\n    Application.ScreenUpdating = True\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1487170276, "post_id": 42252366, "comment_id": 71662856, "body": "Of course this can all be done with a formula: <code>IF(ISERROR(MATCH(Sheet1!A1,Sheet2!A:A,0)),&quot;Not Found&quot;,&quot;Found&quot;)</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487570965, "post_id": 42252366, "comment_id": 71827364, "body": "@Joel have you checked into the answers you got below ? find the time to provide feedback to people who spent their time helping you"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487170365, "post_id": 42252485, "comment_id": 71662923, "body": "I cheated, I had answered something similar yesterday, not close enough to be a duplicate but I had this part already prepared, only needed to change the outputs.  So a quick copy and paste."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487170449, "post_id": 42252485, "comment_id": 71662982, "body": "@ShaiRado btw, I was told by Mat&#39;sMug that using early binding like mine is a little quicker than the late binding like yours.  Not sure if it is true and it definitely would not matter with a one off like this.  But just for your information."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487174515, "post_id": 42252485, "comment_id": 71666273, "body": "thanks for the info. I made an experiment, tested both answers, had searched in a loop 1000 items in column A, within a range of 26 (columns) x 5000 (rows), <b>both ran under a second !</b>. I wonder how large the loop and range need to be for the differences to be noticeable ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487174668, "post_id": 42252485, "comment_id": 71666383, "body": "@ShaiRado hence the reason I stated who told me and that I was not sure it was true, but good to know."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1487169833, "creation_date": 1487169833, "answer_id": 42252485, "question_id": 42252366, "link": "https://stackoverflow.com/questions/42252366/how-to-match-search-the-value-of-sheet1-rangea1-in-sheet2-rangea1a10-in/42252485#42252485", "title": "How to match/search the value of Sheet1.Range(&quot;A1&quot;) in Sheet2.Range(&quot;A1:A10&quot;) in excel VBA", "body": "<p>try this:</p>\n\n<pre><code>Sub foo()\n    Dim t As Long\n        On Error Resume Next\n        t = Application.WorksheetFunction.Match(Worksheets(\"Sheet1\").Range(\"A1\"), Worksheets(\"Sheet2\").Range(\"A:A\"), 0)\n        On Error GoTo 0\n        If t &gt; 0 Then\n            MsgBox \"Found\"\n        Else\n            MsgBox \"Not found\"\n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1487170007, "creation_date": 1487170007, "answer_id": 42252567, "question_id": 42252366, "link": "https://stackoverflow.com/questions/42252366/how-to-match-search-the-value-of-sheet1-rangea1-in-sheet2-rangea1a10-in/42252567#42252567", "title": "How to match/search the value of Sheet1.Range(&quot;A1&quot;) in Sheet2.Range(&quot;A1:A10&quot;) in excel VBA", "body": "<p>Try using the <code>Match</code> function below (you will get the row number found):</p>\n\n<pre><code>Option Explicit\n\nSub MatchTest()\n\nDim MatchRes As Variant\n\nMatchRes = Application.Match(Worksheets(\"Sheet1\").Range(\"A1\").Value, Worksheets(\"Sheet2\").Range(\"A1:A10\"), 0)\nIf IsError(MatchRes) Then\n    MsgBox \"Not found\"\nElse\n    MsgBox \"Found at row \" &amp; MatchRes\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 6336529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2164425d161fc55bd24efc251e28b8b?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/6336529/joel"}, "edited": false, "score": 0, "creation_date": 1487180241, "post_id": 42252622, "comment_id": 71670510, "body": "Thanks a lot Shai Rado"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1487170148, "creation_date": 1487170148, "answer_id": 42252622, "question_id": 42252366, "link": "https://stackoverflow.com/questions/42252366/how-to-match-search-the-value-of-sheet1-rangea1-in-sheet2-rangea1a10-in/42252622#42252622", "title": "How to match/search the value of Sheet1.Range(&quot;A1&quot;) in Sheet2.Range(&quot;A1:A10&quot;) in excel VBA", "body": "<p>Consider:</p>\n\n<pre><code>Sub dural()\n    Dim s As String, r1 As Range, r2 As Range, r3 As Range\n\n    Set r1 = Sheet1.Range(\"A1\")\n    Set r2 = Sheet2.Range(\"A1:A10\")\n    s = r1.Value\n\n    Set r3 = r2.Find(what:=s, after:=r2(1))\n    If r3 Is Nothing Then\n        MsgBox \"not found\"\n    Else\n        MsgBox \"Found\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1487181518, "creation_date": 1487181518, "answer_id": 42256813, "question_id": 42252366, "link": "https://stackoverflow.com/questions/42252366/how-to-match-search-the-value-of-sheet1-rangea1-in-sheet2-rangea1a10-in/42256813#42256813", "title": "How to match/search the value of Sheet1.Range(&quot;A1&quot;) in Sheet2.Range(&quot;A1:A10&quot;) in excel VBA", "body": "<p>just playing around a little bit with Scott's solution:</p>\n\n<pre><code>Sub foo2()\n    Dim t As Long\n    On Error GoTo NotFound\n    t = Application.WorksheetFunction.Match(Worksheets(\"Sheet1\").Range(\"A1\"), Worksheets(\"Sheet2\").Range(\"A:A\"), 0)\n    MsgBox \"Found\n    Exit Sub      \nNotFound:\n    MsgBox \"Not found\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 6336529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2164425d161fc55bd24efc251e28b8b?s=128&d=identicon&r=PG&f=1", "display_name": "Joel", "link": "https://stackoverflow.com/users/6336529/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1487181518, "creation_date": 1487169561, "last_edit_date": 1531164843, "question_id": 42252366, "link": "https://stackoverflow.com/questions/42252366/how-to-match-search-the-value-of-sheet1-rangea1-in-sheet2-rangea1a10-in", "title": "How to match/search the value of Sheet1.Range(&quot;A1&quot;) in Sheet2.Range(&quot;A1:A10&quot;) in excel VBA", "body": "<p>Let's say i have this value \"ABC123\" in <code>Sheet1.Range(\"A1\")</code></p>\n\n<p>I want to search for/ match this value in Sheet2.Range(\"A1:A10\") // or the column</p>\n\n<pre><code>If the value is found\n      //msgbox \"Found\"\nelse\n     //msgbox \"Not found\"\nend if\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1487169177, "post_id": 42252103, "comment_id": 71661996, "body": "Don&#39;t use <code>.Select</code>, just refer to the cell directly e.g. <code>Sheets(&quot;Cost Gained SelfBill&quot;).Range(&quot;A1&quot;)</code>. Also, don&#39;t <code>Copy</code>/<code>Paste</code>. Set the values of the cells to what you want e.g. <code>Range(&quot;A1&quot;).Value = Range(&quot;A2&quot;).Value</code>"}, {"owner": {"reputation": 25, "user_id": 6948495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/701e5a060dfdba3f9fe83e6d92fe07b7?s=128&d=identicon&r=PG&f=1", "display_name": "J Junior", "link": "https://stackoverflow.com/users/6948495/j-junior"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1487169680, "post_id": 42252103, "comment_id": 71662365, "body": "Thanks Jordan, Some cells are filtered out, so I wasnt sure how to get around that, with Setting a value. I will take your advice, and use it for the last line of &#39;1 Range(&quot;C6&quot;) etc."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1487174001, "post_id": 42252103, "comment_id": 71665808, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Here&#39;s a good SO thread</a> on how to avoid using <code>.Select</code>/<code>.Activate</code> as well."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1487175533, "creation_date": 1487175533, "answer_id": 42254686, "question_id": 42252103, "link": "https://stackoverflow.com/questions/42252103/alternative-to-activecell-copy-and-paste/42254686#42254686", "title": "Alternative to activecell copy and paste", "body": "<p>I've looked through a bit of the first half of the code (from note '8 at G9 to note '16 at G15) and figure you could clean this up with a loop to save you some time... you keep going down rows, so a For statement would work:</p>\n\n<pre><code>Dim i as Integer\n\nFor i = 9 to 15\n\n    Sheets(\"Cost Gained Self Bill\").Cells(,).Copy 'Hard to tell which cell\n    Sheets(\"Debit Note\").Cells(i,7).PasteSpecial xlValues 'Column G = column 7\n\nNext i\n</code></pre>\n\n<p>You would probably be able to do similar for some of the other items, too.  In the copy part, you can use something similar to Cells(i+5,2) which describes an offset of 5 rows and allows in column 2, which will go for each row i to last i.</p>\n"}], "owner": {"reputation": 25, "user_id": 6948495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/701e5a060dfdba3f9fe83e6d92fe07b7?s=128&d=identicon&r=PG&f=1", "display_name": "J Junior", "link": "https://stackoverflow.com/users/6948495/j-junior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3803, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487175533, "creation_date": 1487168880, "question_id": 42252103, "link": "https://stackoverflow.com/questions/42252103/alternative-to-activecell-copy-and-paste", "title": "Alternative to activecell copy and paste", "body": "<p>I have a simple macro, which looks at A1, then copy and paste into a specific range into another sheet, goes back to original sheet then offsets each column, (copy and paste procedure) until column T, then this moves down 1 row and repeats, it then saves the sheet as a PDF and this process repeats about 100 times.  </p>\n\n<p>How can I improve the speed of this macro, I will add a Dim rng as worksheet. \nThen Set rng as Worksheet(\"Cost Gained\") etc. But I'm after taking off the activecell and offset part and replacing it with ...?</p>\n\n<p>The two sheets are in the same workbook which is already open when the macro is run. </p>\n\n<p>Please help! </p>\n\n<pre><code>Sub Input_Template()\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.DisplayStatusBar = False\n\nDim E26val As String\n\n'Go to A1 in Cost Gained sheet, look for next available cell.\nSheets(\"Cost Gained SelfBill\").Select\nRange(\"A1\").Select\nActiveCell.Offset(1, 0).Select\nDo Until ActiveCell.EntireRow.Hidden = False\nActiveCell.Offset(1, 0).Select\nLoop\n\nDo\n'1\nActiveCell.Offset(0, 0).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"G8,C6\").Select\nActiveSheet.PasteSpecial\nRange(\"C6\").Select\nActiveCell.FormulaR1C1 = \"=CONCATENATE(R[2]C[4], \"\"Q-DN\"\")\"\n'2\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"G11\").Select\nActiveSheet.PasteSpecial\n'3\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 2).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"G16,C22\").Select\nActiveSheet.PasteSpecial\n'4\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 2).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"G9,G22,G24,G26\").Select\nActiveSheet.PasteSpecial\n'5\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 2).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"G10\").Select\nActiveSheet.PasteSpecial\n'6\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 2).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"G7\").Select\nActiveSheet.PasteSpecial\n'7\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"G15\").Select\nActiveSheet.PasteSpecial\n'8\n Sheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C9\").Select\nActiveSheet.PasteSpecial\n'9\n Sheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C10\").Select\nActiveSheet.PasteSpecial\n'10\n Sheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C11\").Select\nActiveSheet.PasteSpecial\n'11\n Sheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C12\").Select\nActiveSheet.PasteSpecial\n'12\n Sheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C13\").Select\nActiveSheet.PasteSpecial\n'13\n Sheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C14\").Select\nActiveSheet.PasteSpecial\n'14\n Sheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C15\").Select\nActiveSheet.PasteSpecial\n'15\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 1).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"E26\").Select\nActiveSheet.PasteSpecial\n'16\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Offset(0, 8).Select\nSelection.Copy\nSheets(\"Debit Note\").Select\nRange(\"C16\").Select\nActiveSheet.PasteSpecial\n\nWith Sheets(\"Debit Note\")\nE26val = .Range(\"E26\").Value\nWith .Range(\"G9,G22,G24,G26\")\n    Select Case E26val\n        Case Is = \"GBP\"\n            .NumberFormat = \"$#,##0.00\"\n        Case Is = \"EUR\"\n            .NumberFormat = \"[$\u20ac-2] #,##0.00\"\n        Case Is = \"USD\"\n            .NumberFormat = \"[$$-409]#,##0.00\"\n        Case Else\n            'Nothing\n    End Select 'E26val\nEnd With '.Range(\"G9,G22,G24,G26\")\nEnd With 'Sheets(\"Sheet1\")\n\nRange(\"B22,G16\").Select\nSelection.NumberFormat = \"General\"\nRange(\"G15\").Select\nSelection.Style = \"Hyperlink 2\"\n\n    Sheets(\"Debit Note\").Select\n    ChDir \"P:\\Feb\\\"\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"P:\\Feb\\\" &amp; Range(\"G8\").Value\n    'Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=False\n\n\nSheets(\"Cost Gained SelfBill\").Select\nActiveCell.Select\nActiveCell.Offset(1, -26).Select\nDo Until ActiveCell.EntireRow.Hidden = False\nActiveCell.Offset(1, 0).Select\nLoop\nLoop Until ActiveCell.Row = \"20000\"\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.DisplayStatusBar = True\n\nEnd Sub\n</code></pre>\n\n<p>Also this will help with reducing the Lines of my macro too. </p>\n\n<p>Thanks for looking</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1487170695, "post_id": 42252184, "comment_id": 71663158, "body": "Thank you! I will try this approach today and see how well it turns out."}, {"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1487180616, "post_id": 42252184, "comment_id": 71670746, "body": "Access worked great at first. But now my problem is that I can&#39;t get all of my fields to fit onto one sheet so when I try to out it into a report or PDF, it spreads out over multiple pages. I love that it let me select which criteria I wanted on the query, then before running it select to make a new table in a new database that I could name. If there was a way to do that in excel then that would be prefect"}], "tags": [], "owner": {"reputation": 71, "user_id": 1858096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c70e5bde533bbea82d9a0905aa26e68?s=128&d=identicon&r=PG", "display_name": "AON", "link": "https://stackoverflow.com/users/1858096/aon"}, "is_accepted": false, "score": 0, "last_activity_date": 1487175687, "last_edit_date": 1487175687, "creation_date": 1487169103, "answer_id": 42252184, "question_id": 42252044, "link": "https://stackoverflow.com/questions/42252044/excel-macros-and-vba/42252184#42252184", "title": "Excel Macros and VBA", "body": "<p>I think it would be easier to do in Access. </p>\n\n<p>The roster and classes already acts much like a database, and you have a unique identifier in that section number. Doing so with access or any kind of database would allow you to execute something like </p>\n\n<pre><code>select studentName from rosterDatabase where classId = 12345\n</code></pre>\n\n<p>and that would result in all the students in said class would populate the list. </p>\n"}], "owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1487175687, "creation_date": 1487168753, "last_edit_date": 1531161705, "question_id": 42252044, "link": "https://stackoverflow.com/questions/42252044/excel-macros-and-vba", "title": "Excel Macros and VBA", "body": "<p>I'm extremely new to excel's VBA and to the idea of macros. My boss has asked me to try to figure out a way to figure out a solution to this problem:</p>\n\n<p>\"Each semester we are given an excel sheet with rows upon rows containing a students name, the class name (ACC, FIN, BIO...), course number (101 or 102...) and the section number 5162 (a unique identifier). Each semester teachers request the roster sheets for their classes. We typically have to create a new workbook with that professors name, then by hand copy and paste each row of one section of their class onto one sheet naming it accordingly ex BIO 102-5623, then the next section of that class into the next sheet and so on. We would like for you to figure out a way to automate this process so that we spend less time creating whole new workbooks and sheets and then copying and pasting all of the rows.\"</p>\n\n<p>I figure that excel's VBA feature would be a good way to do this, but I've never used it before. I've done a lot of research on the tool since I started the project and have been watching a ton of tutorials, but I'm not sure if this will take several different macros to perform or if maybe this would be better to do in something like Access, or if this is possible at all? </p>\n"}, {"tags": ["string", "vba", "if-statement", "numeric"], "comments": [{"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487168990, "post_id": 42251930, "comment_id": 71661847, "body": "You&#39;re wanting to sort the numeric portion numerically, but if those are equal, sort the balance alphabetically, correct?"}, {"owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "reply_to_user": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487169171, "post_id": 42251930, "comment_id": 71661991, "body": "Yes. Unless there is a better way to do it. I basically just want it to show up as. 69,69A,69B,70A,99A,100,100A. ( or any variation of numbers and letters). The issue i was having is that 69 appears larger than 100 for the first little bit but somehow the code won&#39;t recognize it now that it is indeed larger."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1487172388, "post_id": 42251930, "comment_id": 71664550, "body": "You&#39;ll need to cast the numeric portion to numeric types before you use equity comparisons on them.  See <a href=\"http://stackoverflow.com/documentation/vba/5813/operators/20479/comparison-operators#t=201702151525369696781\">Comparison Operators</a> in documentation."}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 1, "creation_date": 1487173552, "post_id": 42251930, "comment_id": 71665463, "body": "If the values are strings, you can do a Val() on them, and that will compare leading numeric portions only, eg &quot;1000A&quot; and &quot;1000B&quot; with both return 1000. The problem is you&#39;re code is targeting very specific string prefixes and in order to really solve the problem you&#39;re going to have to solve the comparison more generically..."}, {"owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "edited": false, "score": 0, "creation_date": 1487174435, "post_id": 42251930, "comment_id": 71666200, "body": "Very nice. Thanks for the help. I have a few ideas I will test out and get back to you on if they work. Namely I will check the values. If the values are equal. Only then will i go through the sorting process to see which value is greater."}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487174570, "post_id": 42251930, "comment_id": 71666312, "body": "@TimSwingle I&#39;ve posted some code to give you an idea of where I&#39;m heading. Hope it helps."}, {"owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "edited": false, "score": 0, "creation_date": 1487179512, "post_id": 42251930, "comment_id": 71670038, "body": "I have &#39;lennew = Right(&quot;Str100A&quot;, Len(Val(&quot;Str100A&quot;)) + 1)&#39; and am getting an error on the Val() function saying &quot;Variable required-can-t assign to this expression.&quot; Any thoughts?"}, {"owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "edited": false, "score": 0, "creation_date": 1487180085, "post_id": 42251930, "comment_id": 71670427, "body": "I changed the created a variable to store the val() and used that inside the len(). Which allowed it to compile."}, {"owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "reply_to_user": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487598563, "post_id": 42251930, "comment_id": 71843804, "body": "@DavidW , Good morning. I have a slightly new issue I was wondering if you could help me with. I have a mid function used to find the value between 2 sections. <code>ltrOAS = Mid(CStr(70A.01a-01)), 7, 8 - 1)</code>. Now this should return &quot;a&quot; but it&#39;s returning &quot;a-01&quot;. Thoughts?"}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487599715, "post_id": 42251930, "comment_id": 71844653, "body": "Hi @TimSwingle - I think your third parameter (8-1) is telling the Mid function to return 7 characters at the starting position  defined by the 2nd parameter - 7. Since the string isn&#39;t long enough to provide that many characters starting at that position, it merely returns the rest of the string. Now, this may be left-field, but I infer you mean the argument to CSTr to be the <i>quoted</i> string &quot;70A.01a-01&quot;, correct?"}, {"owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "reply_to_user": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487602404, "post_id": 42251930, "comment_id": 71846487, "body": "@DavidW Yea the CStr was taken above earlier, I just can&#39;t use some of my variables so I replaced that on this with copy/pasting from VBA. I have the same code written above in my code for the comparison that works like a charm, but for some reason it will not work for this part. I thought that the 7 to 7 character issue might be causing the problem as well, so I just did <code>ltrOAS = Mid(CStr(&quot;70A.01a-01&quot;), 7)</code> and it still returned &quot;a-01&quot; instead of &quot;a&quot;."}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487603317, "post_id": 42251930, "comment_id": 71847061, "body": "@TimSwingle Without a length specification, I believe Mid will return the rest of the string at the specified character position. If you just need the one character, supply 1 as the third parameter - but can you rely on that generically? I mean, these kinds of specific situations can get a little hairy to maintain..."}, {"owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "reply_to_user": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487610768, "post_id": 42251930, "comment_id": 71851961, "body": "@DavidW OH! I see where I went wrong though. I was assuming that the mid function was basing itself on the number of characters in the string and not the number of characters I wanted returned. Thank you for your help."}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1487615257, "post_id": 42251930, "comment_id": 71854491, "body": "@TimSwingle You&#39;re welcome!"}], "answers": [{"tags": [], "owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "is_accepted": true, "score": 0, "last_activity_date": 1487174378, "creation_date": 1487174378, "answer_id": 42254239, "question_id": 42251930, "link": "https://stackoverflow.com/questions/42251930/vba-greater-than-function-not-working/42254239#42254239", "title": "VBA Greater Than Function Not Working", "body": "<p>The problem is that you're trying to solve the comparison problem by attacking specific values, and that's going to be a problem to maintain. I'd make the problem more generic by creating a function that supplies takes two values returns -1 if the first operand is \"before\" the second, 0 if they are the same, and 1 if the first operand is \"after\" the second per your rules. </p>\n\n<p>You could then restructure your code to eliminate the specific hardcoded prefix testing and then just call the comparison function directly, eg (and this is COMPLETELY untested, off-the-cuff, and my VBA is VERRRRRY stale :) but the idea is there: (it also assumes the existence of a simple string function called StripPrefix that just takes a string and strips off any leading digits, which I suspect you can spin up fairly readily yourself)</p>\n\n<pre><code>Function CompareCell(Cell1 as String, Cell2 as String) as Integer\n\n    Dim result as integer\n    Dim suffix1 as string\n    Dim suffix2 as string \n\n    if val(cell1)&lt; val(cell2) Then\n       result = -1\n    else if val(cell1)&gt;val(cell2) then\n       result = 1\n    else if val(cell1)=val(cell2) then\n       if len(cell1)=len(cell2) then\n          result =0\n       else\n         ' write code to strip leading numeric prefixes\n         ' You must supply StripPrefix, but it's pretty simple\n         ' I just omitted it here for clarity\n         suffix1=StripPrefix(cell1) ' eg returns \"ABC\" for \"1000ABC\"\n         suffix2=StripPrefix(cell2)\n         if suffix1 &lt; suffix2 then\n            result = -1\n         else if suffix1 &gt; suffix2 then\n            result = 1\n         else\n            result = 0\n         end if\n   end if\n\n   return result\n\nend function\n</code></pre>\n\n<p>A function like this then allows you to take <em>any</em> two cell references and compare them directly to make whatever decision you need:</p>\n\n<pre><code>if CompareCell(enteredval,newval)&gt;=0 then\n   newrow=newrow+1\nend if\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7238223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4da20c61831db78c32de35bb647e961?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Swingle", "link": "https://stackoverflow.com/users/7238223/tim-swingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 0, "accepted_answer_id": 42254239, "answer_count": 1, "score": 0, "last_activity_date": 1487174378, "creation_date": 1487168463, "last_edit_date": 1487169443, "question_id": 42251930, "link": "https://stackoverflow.com/questions/42251930/vba-greater-than-function-not-working", "title": "VBA Greater Than Function Not Working", "body": "<p>I have an issue where I am trying to compare a values that can be alphanumeric, only numeric, or only alphabetic. </p>\n\n<p>The code originally worked fine for comparing anything within the same 100s group (IE 1-99 with alphabetic components). However when I included 100+ into it, it malfunctioned. </p>\n\n<p>The current part of the code reads:</p>\n\n<pre><code>            For j = 1 To thislength\n                If lennew &lt; j Then\n                    enteredval = Left(\"100A\", lennew)\n                ElseIf lennew &gt;= j Then\n                    enteredval = Left(\"100A\", j)\n                End If\n                If lenold &lt; j Then\n                    cellval = Left(\"67\", lenold)\n                ElseIf lenold &gt;= j Then\n                    cellval = Left(\"67\", j)\n                End If \n                'issue occurs here\n                If enteredval &gt;= cellval Then\n                    newrow = newrow+1\n                End If\n            Next j\n</code></pre>\n\n<p>The issue occurs in the last <code>if</code> statement. \nWhen cycling through the 100 is greater than the 67 but still skips over. I tried to declare them both as strings (above this part of code) to see if that would help but it didn't.</p>\n\n<p>What I am trying to accomplish is to sort through a bunch of rows and find where it should go. IE the 100A should go between 100 and 100B. </p>\n\n<p>Sorry <code>lennew=len(\"100A\")</code> and <code>lennold=len(\"67\")</code>. And <code>thislength=4</code>or whatever is larger of the two lengths.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 97, "user_id": 3493476, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/722ed706a48a38cc730756d06db85bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mansour", "link": "https://stackoverflow.com/users/3493476/mansour"}, "edited": false, "score": 0, "creation_date": 1487169396, "post_id": 42251934, "comment_id": 71662151, "body": "@Mansour see edited code, put it inside the <code>ThisWorkbook</code> module, adjust the <code>Case &quot;Sheet1&quot;, &quot;Sheet2&quot;, &quot;Sheet4&quot;</code> to fit the worksheet names you want to include"}, {"owner": {"reputation": 97, "user_id": 3493476, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/722ed706a48a38cc730756d06db85bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mansour", "link": "https://stackoverflow.com/users/3493476/mansour"}, "edited": false, "score": 0, "creation_date": 1487169750, "post_id": 42251934, "comment_id": 71662426, "body": "Thanks a lot ,sorry I don&#39;t know how to thanks  by tags here"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 97, "user_id": 3493476, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/722ed706a48a38cc730756d06db85bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mansour", "link": "https://stackoverflow.com/users/3493476/mansour"}, "edited": false, "score": 0, "creation_date": 1487169783, "post_id": 42251934, "comment_id": 71662456, "body": "@Mansour you did, when you accept as &quot;ANSWER&quot; :) you&#39;re welcome"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1487168995, "last_edit_date": 1487168995, "creation_date": 1487168483, "answer_id": 42251934, "question_id": 42251900, "link": "https://stackoverflow.com/questions/42251900/go-to-specific-cell-when-a-worksheet-is-selected/42251934#42251934", "title": "go to specific cell when a worksheet is selected", "body": "<p>You need to use the <code>Worksheet_Activate</code> event of the relevant worksheet:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\nRange(\"D5\").Select\n\nEnd Sub\n</code></pre>\n\n<p>To use for several worksheets in a Workbook, move the code to <code>Workbook_SheetActivate</code> evenrt (inside the <code>Workbook</code> level):</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n\nSelect Case Sh.Name\n    Case \"Sheet1\", \"Sheet2\", \"Sheet4\" '&lt;-- run it only for sheet's with these names\n        Range(\"D5\").Select\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "is_accepted": false, "score": 0, "last_activity_date": 1487168522, "creation_date": 1487168522, "answer_id": 42251950, "question_id": 42251900, "link": "https://stackoverflow.com/questions/42251900/go-to-specific-cell-when-a-worksheet-is-selected/42251950#42251950", "title": "go to specific cell when a worksheet is selected", "body": "<pre><code>Application.Goto ActiveSheet.Range(\"D5\")\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3493476, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/722ed706a48a38cc730756d06db85bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mansour", "link": "https://stackoverflow.com/users/3493476/mansour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7171, "favorite_count": 0, "accepted_answer_id": 42251934, "answer_count": 2, "score": 1, "last_activity_date": 1487168995, "creation_date": 1487168388, "last_edit_date": 1531164843, "question_id": 42251900, "link": "https://stackoverflow.com/questions/42251900/go-to-specific-cell-when-a-worksheet-is-selected", "title": "go to specific cell when a worksheet is selected", "body": "<p>I want to go to specific cell when a worksheet is selected </p>\n\n<pre><code>Private Sub Worksheet_Cellselection()\nActiveSheet Goto:=\"D5\"\nEnd Sub\n</code></pre>\n\n<p>That one does not work</p>\n"}, {"tags": ["excel", "statistics", "vba"], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487168022, "creation_date": 1487168022, "last_edit_date": 1531161705, "question_id": 42251751, "link": "https://stackoverflow.com/questions/42251751/excel-correl-function-with-unequal-length", "title": "Excel CORREL Function With Unequal Length", "body": "<p>I have a list of data from A3 to AA3, containing a time series of 25 years and associated data points. It is formatted as below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UCg5T.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UCg5T.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I want to see if the data is autocorrelated. So I want to take the correlation of data points 1 to 25 and data 1 to 24, then 1 to 25 / 1 to 23, 1 to 25 / 1 to 22, and so on to see the correlation for different lags. </p>\n\n<p>Since these arrays aren't going to be equal length for the CORREL function, I'll need to include empty cells. However, since the data is in increasing order, there won't be empty cells to the left. </p>\n\n<p>The data extends for several hundred thousand rows and takes output from another program so it wouldn't be practical to re-organize the data. I am doing the formulas in another sheet that references this sheet with the data. </p>\n\n<p>Given the above constraints, what would be the best way to make the CORREL function work?</p>\n"}, {"tags": ["vba", "excel", "datediff"], "comments": [{"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 2, "creation_date": 1487167133, "post_id": 42251359, "comment_id": 71660515, "body": "can you post some start and end dates that you&#39;re using?  A representative sample would go a long way in identifying your issue."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1487167241, "post_id": 42251359, "comment_id": 71660593, "body": "Start Date  |\tEnd Date  | 13-Feb-17  |\t28-Feb-17 | 14-Feb-17  |\t28-Feb-17|  02-Mar-17  |\t04-Mar-17| 13-Feb-17  |\t15-Feb-17| 13-Feb-17\t13-Feb-17 15-Jan-17\t15-Feb-17 01-Feb-17\t12-Feb-17"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487167269, "post_id": 42251359, "comment_id": 71660608, "body": "what format are the cells they reside in?"}, {"owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "edited": false, "score": 3, "creation_date": 1487167366, "post_id": 42251359, "comment_id": 71660687, "body": "Why is a function/procedure even needed for this?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1487167459, "post_id": 42251359, "comment_id": 71660748, "body": "They are formatted as date."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487167478, "post_id": 42251359, "comment_id": 71660764, "body": "then use excel, to say end-start+1 or DATEDIF ws function"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487167539, "post_id": 42251359, "comment_id": 71660812, "body": "why do you have <code>Dim Days As Single</code> ?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1487167547, "post_id": 42251359, "comment_id": 71660815, "body": "I am a novice at VBA so am trying to understand how DateDiff works."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1487167698, "post_id": 42251359, "comment_id": 71660930, "body": "Changed Days to long and I still have the problem!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "edited": false, "score": 0, "creation_date": 1487167717, "post_id": 42251359, "comment_id": 71660949, "body": "@RyanL : I was thinking the same thing, and I&#39;m stunned but I don&#39;t find <code>DATEDIF</code> function in my Excel 2013... I don&#39;t get why though..."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487167815, "post_id": 42251359, "comment_id": 71661017, "body": "@Anthony : What is <code>Debug.Print StartDate - EndDate</code>?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1487169147, "post_id": 42251359, "comment_id": 71661977, "body": "Will Have to figure out how to use Debug.Print"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487169883, "post_id": 42251359, "comment_id": 71662531, "body": "<a href=\"https://support.office.com/en-gb/article/DATEDIF-function-25dba1a4-2812-480b-84dd-8b32a451b35c\" rel=\"nofollow noreferrer\">support.office.com/en-gb/article/&hellip;</a>  Date diff, should be about in &quot;Applies To:  Excel 2016, Excel 2013, Excel 2010, Excel 2007, Excel 2016 for Ma&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1487168079, "post_id": 42251749, "comment_id": 71661192, "body": "Also using the cdate approach you may wish to check for errors and handle that, as text of 31/02/2017 would fail cdate."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1487168699, "post_id": 42251749, "comment_id": 71661623, "body": "Hi Robin Mackenzie. Thanks for your advice. I tried running your code with the same results. I am using Excel For Mac 2011."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487168913, "post_id": 42251749, "comment_id": 71661777, "body": "Just so you know, I tried <code>CDate(&quot;13-Feb-17&quot;)</code> and it gives a Type Mismatch error!"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487169125, "post_id": 42251749, "comment_id": 71661966, "body": "@R3uK - no problem when I run that in the immediate window (Excel 2013). What happens if you do <code>CDate(&quot;13-Fev-17&quot;)</code> i.e. for F&#233;vrier?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1487169187, "post_id": 42251749, "comment_id": 71661999, "body": "@Anthony - what region are you in? Obviously makes a difference with this question if you are running Excel in a non-English locale."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1487169424, "post_id": 42251749, "comment_id": 71662177, "body": "@RobinMackenzie : God damn it! Indeed <b>horrific</b> Regional Settings impact <code>CDate</code> too... <code>&quot;13-Fev-17&quot;</code> was error but <code>&quot;13-F&#233;v-17&quot;</code> passed easily... I hate these Regional Settings!"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1487169555, "post_id": 42251749, "comment_id": 71662283, "body": "@R3uK - yup - total pain. Everything would be easier if there was only Esperanto right ;) ?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487169956, "post_id": 42251749, "comment_id": 71662582, "body": "@RobinMackenzie : Jes, tute!^^"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 2, "last_activity_date": 1487170473, "last_edit_date": 1487170473, "creation_date": 1487168009, "answer_id": 42251749, "question_id": 42251359, "link": "https://stackoverflow.com/questions/42251359/why-is-my-datediff-returning-0/42251749#42251749", "title": "Why Is My DateDiff Returning 0?", "body": "<p>Your code actually runs fine for me - but I am <em>sure</em> that the values in columns A and B are actually dates. If you are <em>not sure</em> about this then use the <code>CDate</code> function to ensure that the value in the cells is converted to a date before passing to the <code>DateDiff</code> function e.g.</p>\n\n<p><code>StartDate = CDate(.Cells(i, 1).Value)</code></p>\n\n<p>Your code with this added in:</p>\n\n<pre><code>Option Explicit\n\nSub CalculateDays()\n    Dim LastRow As Long\n    Dim StartDate As Date\n    Dim EndDate As Date\n    Dim Days As Single\n    Dim i As Long\n\n    With Worksheets(\"Sheet1\")\n        'Determine last Row in Column A\n         LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n         'Calculate Difference between Start Date And End Date in Days\n         For i = 2 To LastRow\n             StartDate = CDate(.Cells(i, 1).Value)\n             EndDate = CDate(.Cells(i, 2).Value)\n             Days = DateDiff(\"d\", StartDate, EndDate)\n             .Cells(i, 3) = Days + 1\n             Days = 0\n         Next i\n     End With\n\n End Sub\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>I just read <a href=\"https://social.technet.microsoft.com/Forums/office/en-US/242b2057-d3e2-4a1a-8684-63efe62b2585/excel-2013-ignores-regional-settings-for-date-format?forum=excel\" rel=\"nofollow noreferrer\">this</a> where it states a problem with South African date formats:</p>\n\n<blockquote>\n  <p>.. my region was \"English (South Africa)\") and I had the date separator as \"/\", however Excel kept changing this to a \"-\". ...</p>\n</blockquote>\n\n<p>So maybe it's worth checking on your regional settings and maybe reformat your dates as <code>dd/mmm/yyyy</code> instead of <code>dd-mmm-yyyy</code> and checking the output. </p>\n\n<p>Maybe the <code>CDATE</code> function will not be required after all (as I mentioned your code ran fine for me in an Australian English regional setting context).</p>\n"}, {"tags": [], "owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "is_accepted": false, "score": 0, "last_activity_date": 1487168080, "creation_date": 1487168080, "answer_id": 42251776, "question_id": 42251359, "link": "https://stackoverflow.com/questions/42251359/why-is-my-datediff-returning-0/42251776#42251776", "title": "Why Is My DateDiff Returning 0?", "body": "<p>Alternatively, instead of a function just write a formula:</p>\n\n<pre><code>=ROUND(B2-A2+1,0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1487170188, "post_id": 42251831, "comment_id": 71662781, "body": "I am novice at VBA and I decided to figure out how DateDiff works but it is not working for me!"}], "tags": [], "owner": {"reputation": 117, "user_id": 7558258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07e523b30515002f1b318336c0cb4d62?s=128&d=identicon&r=PG", "display_name": "Deb", "link": "https://stackoverflow.com/users/7558258/deb"}, "is_accepted": false, "score": -1, "last_activity_date": 1489171258, "last_edit_date": 1489171258, "creation_date": 1487168213, "answer_id": 42251831, "question_id": 42251359, "link": "https://stackoverflow.com/questions/42251359/why-is-my-datediff-returning-0/42251831#42251831", "title": "Why Is My DateDiff Returning 0?", "body": "<p>why do you need datediff function. to get the days difference use</p>\n\n<p>days=enddays - startdate</p>\n\n<p>your code is working fine in excel 2016 in widows. As mentioned by @RobinMackenzie you have some problem with regional date settings.</p>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1819, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1489171258, "creation_date": 1487167001, "last_edit_date": 1487167618, "question_id": 42251359, "link": "https://stackoverflow.com/questions/42251359/why-is-my-datediff-returning-0", "title": "Why Is My DateDiff Returning 0?", "body": "<p>Column A is StartDate </p>\n\n<p>Column B is EndDate </p>\n\n<p>When I run the Macro it returns the answer 1 for all my dates as I am adding 1 to my DateDiff, then DateDiff must be 0.</p>\n\n<p>What is wrong with my <code>DateDiff</code> ?</p>\n\n<pre><code>Sub CalculateDays()\n    Dim LastRow As Long\n    Dim StartDate As Date\n    Dim EndDate As Date\n    Dim Days As Single\n\n    With Worksheets(\"Sheet1\")\n        'Determine last Row in Column A\n         LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n         'Calculate Difference between Start Date And End Date in Days\n         For i = 2 To LastRow\n             StartDate = .Cells(i, 1)\n             EndDate = .Cells(i, 2)\n             Days = DateDiff(\"d\", StartDate, EndDate)\n             .Cells(i, 3) = Days + 1\n             Days = 0\n         Next i\n     End With\n\n End Sub\n</code></pre>\n\n<p>Sample data:</p>\n\n<pre><code>Start Date |    End Date  \n=========================\n13-Feb-17  |    28-Feb-17 \n14-Feb-17  |    28-Feb-17 \n02-Mar-17  |    04-Mar-17 \n13-Feb-17  |    15-Feb-17 \n13-Feb-17  |    13-Feb-17 \n15-Jan-17  |    15-Feb-17 \n01-Feb-17  |    12-Feb-17 \n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1487166937, "post_id": 42251284, "comment_id": 71660372, "body": "This should answer your question <a href=\"http://stackoverflow.com/questions/4649000/retrieve-column-values-of-the-selected-row-of-a-multicolumn-access-listbox\" title=\"retrieve column values of the selected row of a multicolumn access listbox\">stackoverflow.com/questions/4649000/&hellip;</a>  You might have more google success by search for listbox, not listfield."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487167825, "post_id": 42251284, "comment_id": 71661021, "body": "LIST and LISTINDEX will assist you.  But for a listbox as Minty says."}], "owner": {"reputation": 371, "user_id": 6408703, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14a76cb4e2295d91b2da38f1a585b9a3?s=128&d=identicon&r=PG&f=1", "display_name": "rel0aded0ne", "link": "https://stackoverflow.com/users/6408703/rel0aded0ne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487166782, "creation_date": 1487166782, "question_id": 42251284, "link": "https://stackoverflow.com/questions/42251284/passing-value-of-listfield-to-textfield", "title": "passing value of listfield to textfield", "body": "<p>Im looking for a way to pass the values from my listfield to a textfield.</p>\n\n<p>The listfield looks like this: </p>\n\n<pre><code>SID       HID         CENTRAL          DATE            TIME\n\nABC       AB          YES              15.02.2017      15:00\nDEF       DE          NO               15.02.2017      17:00\n...       ..          ..               ..........      .....\n</code></pre>\n\n<p>Is there any way to pass a value of the selected entry into a textfield? \nI need to pass the <code>HID</code> value of the selected entry into a textfield of my form. </p>\n\n<p>if i select the first entry \"<code>AB</code>\" should be send the value to the textfield \"<code>hid2</code>\"</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6899239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06f3301ce84c9dd603ba93e386ccdee?s=128&d=identicon&r=PG&f=1", "display_name": "La82", "link": "https://stackoverflow.com/users/6899239/la82"}, "edited": false, "score": 0, "creation_date": 1487168122, "post_id": 42251407, "comment_id": 71661223, "body": "That was exactly what I needed :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1487167112, "creation_date": 1487167112, "answer_id": 42251407, "question_id": 42251247, "link": "https://stackoverflow.com/questions/42251247/adding-data-to-chart/42251407#42251407", "title": "Adding data to chart", "body": "<p>Not sure what is the delvat value between your row number and <code>i</code>, but you could use something like the code below:</p>\n\n<pre><code>With ActiveChart\n    Do Until i = LotAmount\n        .SeriesCollection.NewSeries\n        .SeriesCollection(i).Name = Sheets(\"Data\").Range(\"A\" &amp; i)\n        .SeriesCollection(i).XValues = Sheets(\"Data\").Range(\"B7:F7\")\n        .SeriesCollection(i).Values = Sheets(\"Data\").Range(\"B\" &amp; i &amp; \":F\" &amp; i)\n        i = i + 1\n    Loop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6899239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06f3301ce84c9dd603ba93e386ccdee?s=128&d=identicon&r=PG&f=1", "display_name": "La82", "link": "https://stackoverflow.com/users/6899239/la82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 42251407, "answer_count": 1, "score": 0, "last_activity_date": 1487167112, "creation_date": 1487166689, "question_id": 42251247, "link": "https://stackoverflow.com/questions/42251247/adding-data-to-chart", "title": "Adding data to chart", "body": "<p>I am trying to make a dynamic chart taking in a number of series depending on the amount that I have loaded into the workbook. I load the data into one sheet called Data, and I plot the chart in one sheet called Plots. I tried recording a macro to get a better understanding as to how to do this, and ended up with something like this. My problem is that I would like \"=Data!$A$15\" etc to be a cell.value so that I can use \"i\" to determine the number of series needed. How do I do this elegantly (like the below sheet). </p>\n\n<pre><code>Do Until i = LotAmount\nActiveChart.SeriesCollection.NewSeries\nActiveChart.FullSeriesCollection(i).Name = \"=Data!$A$15\"\nActiveChart.FullSeriesCollection(i).XValues = \"=Data!$B$7:$F$7\"\nActiveChart.FullSeriesCollection(i).Values = \"=Data!$B$15:$F$15\"\ni = i + 1\nLoop\n</code></pre>\n\n<p>I hope you can help me :)</p>\n\n<p>Best Regards</p>\n\n<p>Lonnie</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5444764, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-coNyzHSwvh4/AAAAAAAAAAI/AAAAAAAAAB8/2rpiGIC9tlA/photo.jpg?sz=128", "display_name": "Jonorl", "link": "https://stackoverflow.com/users/5444764/jonorl"}, "edited": false, "score": 0, "creation_date": 1487167231, "post_id": 42251164, "comment_id": 71660585, "body": "Amazing, it worked! I don&#39;t know why I thought that autofilter would result in an error if any of the values were missing, but seems to be working fine. Many thanks for your help!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1487179599, "last_edit_date": 1487179599, "creation_date": 1487166440, "answer_id": 42251164, "question_id": 42251018, "link": "https://stackoverflow.com/questions/42251018/vba-loop-through-an-string-array-of-variants-and-delete-rows-if-matching-value/42251164#42251164", "title": "VBA: Loop through an string array of variants and delete rows if matching value", "body": "<p>you could use <code>AutoFiter()</code>:</p>\n\n<pre><code>Sub FixAll()\n    Dim Fruits As Variant\n\n    Fruits = Array(\"Apple\", \"Banana\", \"Pear\") '&lt;--| list your fruits\n    With Range(\"R:R\") '&lt;--| reference your range\n        .AutoFilter Field:=1, Criteria1:=Fruits, Operator:=xlFilterValues '&lt;--| filter referenced column with 'Fruits'\" content\n        If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete '&lt;--| if any cell found other than header one then delete its corresponding row\n    End With\n    ActiveSheet.AutoFilterMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1487169057, "creation_date": 1487169057, "answer_id": 42252163, "question_id": 42251018, "link": "https://stackoverflow.com/questions/42251018/vba-loop-through-an-string-array-of-variants-and-delete-rows-if-matching-value/42252163#42252163", "title": "VBA: Loop through an string array of variants and delete rows if matching value", "body": "<p>If you don't need the first row deleted:</p>\n\n<pre><code>Dim r As Range\nSet r = ActiveSheet.UsedRange\n\nr.AutoFilter 19 - r.Column, Array(\"Apple\", \"Orange\"), xlFilterValues \nr.Offset(1).Delete xlShiftUp                               ' deletes the non-filtered rows\nr.AutoFilter                                               ' hide the filter\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5444764, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-coNyzHSwvh4/AAAAAAAAAAI/AAAAAAAAAB8/2rpiGIC9tlA/photo.jpg?sz=128", "display_name": "Jonorl", "link": "https://stackoverflow.com/users/5444764/jonorl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 42251164, "answer_count": 2, "score": 0, "last_activity_date": 1487179599, "creation_date": 1487166080, "question_id": 42251018, "link": "https://stackoverflow.com/questions/42251018/vba-loop-through-an-string-array-of-variants-and-delete-rows-if-matching-value", "title": "VBA: Loop through an string array of variants and delete rows if matching value", "body": "<p>I've got multiple text variables (fruits) that when and if they appear on column R I need to delete the entire row. I've got the following code, but as I have 15 variables of \"Fruit\" (and may need to add more in the future) I was wondering how I could make this is a single subroutine with a loop. I tried many ways failing miserably. Possibly with a string array including all the names?</p>\n\n<p>Thanks in advance,</p>\n\n<pre><code>Sub Fix1()\nDim Fruit As String\n\nFruit = \"Apple\"\n\nDo\nOn Error GoTo ByeBye\nRange(\"R:R\").Find(Fruit).EntireRow.Delete\nLoop\nByeBye:\nExit Sub\nEnd Sub\n\n\n\nSub Fix2()\nDim Fruit As String\n\nFruit = \"Orange\"\nDo\nOn Error GoTo ByeBye\nRange(\"R:R\").Find(Fruit).EntireRow.Delete\nLoop\nByeBye:\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "indentation", "ms-project"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487746745, "post_id": 42250726, "comment_id": 71917794, "body": "have you read my answer and code below ? did you mean something like that ?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5263145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwuZ3Drde8k/AAAAAAAAAAI/AAAAAAAAcGE/2G9cIFKvby0/photo.jpg?sz=128", "display_name": "vineeth vp", "link": "https://stackoverflow.com/users/5263145/vineeth-vp"}, "edited": false, "score": 0, "creation_date": 1487856150, "post_id": 42267977, "comment_id": 71979161, "body": "Thank you Shai Rado, it was very help full."}, {"owner": {"reputation": 43, "user_id": 5263145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwuZ3Drde8k/AAAAAAAAAAI/AAAAAAAAcGE/2G9cIFKvby0/photo.jpg?sz=128", "display_name": "vineeth vp", "link": "https://stackoverflow.com/users/5263145/vineeth-vp"}, "edited": false, "score": 0, "creation_date": 1487856208, "post_id": 42267977, "comment_id": 71979199, "body": "to add, how can i get the column names and value of the columns fields."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1487231691, "creation_date": 1487231691, "answer_id": 42267977, "question_id": 42250726, "link": "https://stackoverflow.com/questions/42250726/indenting-the-tasks-in-mpp-file-ms-project-file-in-vba-excel-to-mpp-file/42267977#42267977", "title": "Indenting the tasks in mpp file (Ms project file) in vba (excel to mpp file)", "body": "<p>To read the Indent level of each MSP tasks, and to be able to Indent inside (or outside), try something like the code below:</p>\n\n<pre><code>Option Explicit\n\nSub IndentTasks()\n\nDim Tsk As Task\n\nFor Each Tsk In ThisProject.Tasks            \n    Select Case Tsk.OutlineLevel '&lt;-- read the current taks Outline Level\n        Case 1\n            If Tsk.ID &lt;&gt; 1 Then\n                Tsk.OutlineIndent '&lt;-- indent inside (to the right)\n            End If\n\n        Case Is &gt; 6 '&lt;-- don;t want your Project to be too indented inside\n            Tsk.OutlineOutdent '&lt;-- indent outside (to the left)\n\n    End Select\nNext Tsk\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5263145, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwuZ3Drde8k/AAAAAAAAAAI/AAAAAAAAcGE/2G9cIFKvby0/photo.jpg?sz=128", "display_name": "vineeth vp", "link": "https://stackoverflow.com/users/5263145/vineeth-vp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1499, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1593557448, "creation_date": 1487165280, "last_edit_date": 1593557448, "question_id": 42250726, "link": "https://stackoverflow.com/questions/42250726/indenting-the-tasks-in-mpp-file-ms-project-file-in-vba-excel-to-mpp-file", "title": "Indenting the tasks in mpp file (Ms project file) in vba (excel to mpp file)", "body": "<p>I am a VB developer working with MPP files for the first time.</p>\n\n<p>My code reads data from Excel and writes to the mpp file successfully for some set of columns and rows.</p>\n\n<p>1) How to select the single cell in the MPP file, because I have a scenario where I compare with next row cell and do some operation </p>\n\n<p>2) Why can't we have customized  columns in mpp file (Like Computer name, Disc name etc) its giving an error</p>\n\n<p>3) How to indent the cells keep one cell as master others underneath it and it should traverse through loop</p>\n\n<p><strong>code to delete the all tasks</strong></p>\n\n<pre><code>For Each oSubTasks In oTasks\n    If Not oSubTasks Is Nothing Then\n        oSubTasks.Delete\n    End If\nNext oSubTasks\n</code></pre>\n\n<p><strong>code to get the column value</strong></p>\n\n<pre><code>For Each oSubTasks In oTasks\n'if the frist row is blank\n    If oSubTasks.GetField(FieldNameToFieldConstant(\"Duration\")) = \"\" Then Exit For\n    If oSubTasks.GetField(FieldNameToFieldConstant(\"Duration\")) &lt;&gt; \"\" Then\n         Mpplastrow = Mpplastrow + 1\n    End If\nNext oSubTasks\n</code></pre>\n\n<p><strong>code for customized column</strong> getting error </p>\n\n<pre><code>If oSubTasks.GetField(FieldNameToFieldConstant(\"computer name\")) = sh1.Cells(rw, primecol).Value Then\n'    oTask.SetField FieldID:=oApp.FieldNameToFieldConstant(\"computer name\"), Value:=sh1.Cells(rw, primecol).Value\n'Else\n'    oTask.SetField FieldID:=oApp.FieldNameToFieldConstant(\"computer name\"), Value:=sh1.Cells(rw, primecol).Value\n'End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487165539, "post_id": 42250720, "comment_id": 71659365, "body": "Did you add a reference to the <code>Solver</code> library?"}, {"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 0, "creation_date": 1487166203, "post_id": 42250720, "comment_id": 71659848, "body": "This may help <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839427.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839427.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 7969162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1b16e545f07a08f06cb2b94c7d2f42?s=128&d=identicon&r=PG&f=1", "display_name": "Mehmet Yusuf &#199;akmak", "link": "https://stackoverflow.com/users/7969162/mehmet-yusuf-%c3%87akmak"}, "is_accepted": false, "score": 2, "last_activity_date": 1511702270, "creation_date": 1511702270, "answer_id": 47496562, "question_id": 42250720, "link": "https://stackoverflow.com/questions/42250720/using-solver-in-excel-vba-on-mac/47496562#47496562", "title": "Using solver in Excel VBA on mac", "body": "<p>You should add solver to references.</p>\n\n<p>To do so, open visual basic editor. There is \"Add References ....\" button on bottom left of the editor. Click it, check the box for Solver, then click OK. This should work.</p>\n"}], "owner": {"reputation": 21, "user_id": 7569023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2904c3465ad5a14d680a89c3d32bfff0?s=128&d=identicon&r=PG&f=1", "display_name": "dr. Zins", "link": "https://stackoverflow.com/users/7569023/dr-zins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2234, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511702270, "creation_date": 1487165267, "last_edit_date": 1487316457, "question_id": 42250720, "link": "https://stackoverflow.com/questions/42250720/using-solver-in-excel-vba-on-mac", "title": "Using solver in Excel VBA on mac", "body": "<p>I want to automate a series of solver operations in a VBA macro in Excel 2016 for mac. However, when I run the macro an error keeps popping up. The error I get is \"Sub of function not defined\". The code I use is the following.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Sub test_test_test()\r\n'\r\n' test_test_test Macro\r\n'\r\n    SolverOk SetCell:=\"$K$3\", MaxMinVal:=3, ValueOf:=-20, ByChange:=\"$K$3\", Engine:=1, EngineDesc:=\"GRG Nonlinear\"\r\n    SolverSolve\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Thanks a lot! Lennart</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 876, "user_id": 2728287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86f40e848c0fdbca4411bddd5831d134?s=128&d=identicon&r=PG&f=1", "display_name": "lionel", "link": "https://stackoverflow.com/users/2728287/lionel"}, "edited": false, "score": 0, "creation_date": 1487166294, "post_id": 42250662, "comment_id": 71659896, "body": "So your problem is: the second spreadsheet may be open in Excel and the macro wants to forcibly open it again?"}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 0, "creation_date": 1487166669, "post_id": 42250662, "comment_id": 71660150, "body": "problem is not clear. please develop on what you actually need to achieve."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1487167854, "post_id": 42250662, "comment_id": 71661044, "body": "Is <code>Sheets(&quot;Dashboard&quot;)</code> in x or y?"}, {"owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "edited": false, "score": 0, "creation_date": 1487168160, "post_id": 42250662, "comment_id": 71661253, "body": "What is the error that you get? I tried running your code and its working for me. Could you please provide us more details?"}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "is_accepted": false, "score": 0, "last_activity_date": 1487177185, "last_edit_date": 1487177185, "creation_date": 1487176788, "answer_id": 42255173, "question_id": 42250662, "link": "https://stackoverflow.com/questions/42250662/copy-data-from-other-sheet-to-current-open-sheet/42255173#42255173", "title": "Copy Data from Other sheet to current open Sheet?", "body": "<pre><code>Sheets(\"Dashboard\").Select\nActiveWorkbook.RefreshAll\nSheets(\"My Data\").Select\n</code></pre>\n\n<p>This is ambiguous. The <code>ActiveWorkbook</code> is <code>y</code>. If the sheet \"Dashboard\" doesn't exist in <code>y</code> then you will have an error. If it's this problem then use :</p>\n\n<pre><code>x.Sheets(\"Dashboard\").Select\n</code></pre>\n\n<p>Just as you did previously with the other sheets !</p>\n\n<p>By the way, if you don't want any screen updating as file opening can be long (and maybe cause errors), use</p>\n\n<pre><code>Application.ScreenUpdating = false 'at the beginning of sub\n' code here\nApplication.ScreenUpdating = true ' at the end of sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7568973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28492d91663664f93ed0205e36527cb?s=128&d=identicon&r=PG&f=1", "display_name": "Tushar Kotwal", "link": "https://stackoverflow.com/users/7568973/tushar-kotwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487316486, "creation_date": 1487165108, "last_edit_date": 1487316486, "question_id": 42250662, "link": "https://stackoverflow.com/questions/42250662/copy-data-from-other-sheet-to-current-open-sheet", "title": "Copy Data from Other sheet to current open Sheet?", "body": "<p>I am trying to copy data from one excel to another and then refreshing all the pivot tables in open sheet. facing issue here that below Macro telling me to open the sheet always where i need to copy my data. please help me as i dont want to open again my second file.</p>\n\n<pre><code>Sub UReport()\n'\n' UReport Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+T\n'\n    Dim x As Workbook\n    Dim y As Workbook\n\n'## Open both workbooks first:\n    Set x = Workbooks.Open(\"C:\\Reports\\HC Report.xlsx\")\n    Set y = Workbooks.Open(\"C:\\Reports\\Main Tracker.xlsx\")\n\n'Now, copy what you want from x:\n    x.Sheets(\"HC Report\").Range(\"A2:FI7004\").Copy\n\n'Now, paste to y worksheet:\n    y.Sheets(\"My Data\").Range(\"A2:FI7004\").PasteSpecial\n\n    Sheets(\"Dashboard\").Select\n    ActiveWorkbook.RefreshAll\n    Sheets(\"My Data\").Select\n\n'Close x:\n    x.Close\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "consolidation"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7568915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYlGR.jpg?s=128&g=1", "display_name": "Granado", "link": "https://stackoverflow.com/users/7568915/granado"}, "edited": false, "score": 0, "creation_date": 1487185526, "post_id": 42251770, "comment_id": 71673770, "body": "Thanks, Mark. You&#39;re right  I&#39;ve put this code in the beggining:      Dim region As Range     Set region = Sheets(&quot;Total&quot;).Cells(2, 1).CurrentRegion     region.ClearContents  And it works fine. So every click, I need to clear all and paste the current or new students&#39; list.  Thanks again"}, {"owner": {"reputation": 761, "user_id": 5130078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/PPNLC.png?s=128&g=1", "display_name": "Mark_Anderson", "link": "https://stackoverflow.com/users/5130078/mark-anderson"}, "reply_to_user": {"reputation": 13, "user_id": 7568915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYlGR.jpg?s=128&g=1", "display_name": "Granado", "link": "https://stackoverflow.com/users/7568915/granado"}, "edited": false, "score": 0, "creation_date": 1487249553, "post_id": 42251770, "comment_id": 71704998, "body": "Great, glad you got it working. From a pure VBA code standpoint that works well.   However, I&#39;d advise thinking about how your Excel project could evolve in future.  If I recall correctly <code>.CurrentRegion</code> selects everything around a cell until it hits blank rows and BLANK COLUMNS.  So if you ever added some analysis to an adjacent column in the &quot;Total&quot; sheet, that would get deleted too.  That might be a totally irrelevant user case, but I thought I&#39;d mention it just in case.  If all else fails, you can just add a note to the sheet saying to leave blank cols/rows!"}], "tags": [], "owner": {"reputation": 761, "user_id": 5130078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/PPNLC.png?s=128&g=1", "display_name": "Mark_Anderson", "link": "https://stackoverflow.com/users/5130078/mark-anderson"}, "is_accepted": true, "score": 0, "last_activity_date": 1487168064, "creation_date": 1487168064, "answer_id": 42251770, "question_id": 42250635, "link": "https://stackoverflow.com/questions/42250635/how-can-i-consolidate-data-between-2-different-workbooks/42251770#42251770", "title": "How can I consolidate data between 2 different Workbooks?", "body": "<p>This part of the code navigates to the end of the data in the sheet</p>\n\n<pre><code>'Select the last row with value\n    Selection.End(xlDown).Select\n    k = ActiveCell.Row + 1\n\nCells(k, 1).Activate\n</code></pre>\n\n<p>Then you paste in <code>\"reserva filial.xlsm\"</code> data.</p>\n\n<p>It works fine on the first pass, but the second time you run the code, you (correctly) paste in the first workbook data, LEAVING THE SECOND WORKBOOK DATA BENEATH IT, navigate to the end of the data, and repaste in the second workbook data.</p>\n\n<p>Depending on how your Excel project fits together you might wish to clear the entire contents of <code>Sheets(\"Total\")</code> or a subset of it using the <code>.ClearContents</code> method.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 7568915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYlGR.jpg?s=128&g=1", "display_name": "Granado", "link": "https://stackoverflow.com/users/7568915/granado"}, "is_accepted": false, "score": 0, "last_activity_date": 1487351335, "creation_date": 1487351335, "answer_id": 42303630, "question_id": 42250635, "link": "https://stackoverflow.com/questions/42250635/how-can-i-consolidate-data-between-2-different-workbooks/42303630#42303630", "title": "How can I consolidate data between 2 different Workbooks?", "body": "<p>It works as the Ctrl + Shift + Down (arrow) and Ctrl + Shift + Right (arrow) in Excel. For now it's ok and it will be used only as a list. I really appreciatte your advise. I am a new VBA and Stack Overflow user, and this community is very useful because all of your contribution. </p>\n"}], "owner": {"reputation": 13, "user_id": 7568915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYlGR.jpg?s=128&g=1", "display_name": "Granado", "link": "https://stackoverflow.com/users/7568915/granado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 42251770, "answer_count": 2, "score": 1, "last_activity_date": 1487351335, "creation_date": 1487165033, "question_id": 42250635, "link": "https://stackoverflow.com/questions/42250635/how-can-i-consolidate-data-between-2-different-workbooks", "title": "How can I consolidate data between 2 different Workbooks?", "body": "<p>I need to consolidate 2 students\u2019 registrations between different workbooks (holding and subsidiary). So when I click the button \u201cGenerate Graphic\u201d, the data are consolidated in the sheet \u201cTotal\u201d and then, the number of courses (Excel, Word, Access\u2026) are counted and the graphic is generated in the sheet \u201cGraphic\u201d. The first test is ok, but when I click again, the list is increasing with the same data of the subsidiary\u2019s workbook. There\u2019s something in the code I need to change but I don\u2019t know what. \nCould you help me?\nMy code is:</p>\n\n<pre><code>Sub GerarGrafico()\nDim k As Long\n\n'copying data of the \u201cCourse Booking\u201d Sheet\n\nSheets(\"Course Booking\").Select\nRange(\"A1\").Select\nlinini = 2\n'Select the last row\nSelection.End(xlDown).Select\nlinfin = Selection.Row\n'Select the last column\nSelection.End(xlToRight).Select\ncolfin = Selection.Column\nRange(Cells(linini, 1), Cells(linfin, colfin)).Select\nSelection.Copy\n</code></pre>\n\n<p>\u2018copying data in the sheet \"Total\"</p>\n\n<pre><code>Sheets(\"Total\").Select\nCells(linini, 1).Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\n\n\u2018Copying data of the  \u201creserva filial.xlsm\u201d\ncaminho = ThisWorkbook.Path\nWorkbooks.Open caminho &amp; \"\\\" &amp; \"reserva filial.xlsm\"\n\n'copying data\nRange(\"A1\").Select\nlinini2 = 2\n'Select the last row\nSelection.End(xlDown).Select\nlinfin2 = Selection.Row\n'Select the last column\nSelection.End(xlToRight).Select\ncolfin2 = Selection.Column\nRange(Cells(linini2, 1), Cells(linfin2, colfin2)).Select\nSelection.Copy\nWindows(\"Trabalho_Felipe Granado_v8.xlsm\").Activate\nSheets(\"Total\").Select\n\n'Select the last row with value\n    Selection.End(xlDown).Select\n    k = ActiveCell.Row + 1\n\nCells(k, 1).Activate\n\n\nApplication.Windows(\"reserva filial.xlsm\").Visible = False\n\n'pasting data \"reserva filial.xlsm\" in the sheet \"Total\"\n\nActiveSheet.Paste\nApplication.CutCopyMode = False\n\n   Columns.HorizontalAlignment = xlCenter\n</code></pre>\n"}, {"tags": ["ms-access", "sharepoint", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487164726, "post_id": 42249941, "comment_id": 71658779, "body": "Is that the correct range name?"}, {"owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1487165327, "post_id": 42249941, "comment_id": 71659218, "body": "@Jordan Thanks for the edit of the mess i created."}, {"owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487165363, "post_id": 42249941, "comment_id": 71659251, "body": "@Nathan_Sav yes i dont have any problem running this code"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487165791, "post_id": 42249941, "comment_id": 71659532, "body": "So what&#39;s your question?  How to correct the path to sp location?"}, {"owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487166166, "post_id": 42249941, "comment_id": 71659827, "body": "@Nathan_Sav : I would like to know how to use &quot;DoCmd.Transferspreadsheet&quot; if Excel is in SP"}, {"owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "edited": false, "score": 0, "creation_date": 1487167021, "post_id": 42249941, "comment_id": 71660429, "body": "I&#39;d suggest navigating to the excel document within SharePoint, then copying the link directly from there -- unless there are permission issues you should be able to use this link regardless of whether or not it&#39;s on SharePoint."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487167976, "post_id": 42249941, "comment_id": 71661127, "body": "or just set up a link to it?"}, {"owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "edited": false, "score": 0, "creation_date": 1487168337, "post_id": 42249941, "comment_id": 71661366, "body": "So you mean to say to add the SP link of excel file to strXLS = CurrentProject.Path &amp; chr(92) &amp; &quot;............&quot;    ???"}, {"owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487168565, "post_id": 42249941, "comment_id": 71661522, "body": "@Nathan_sav Since the Excel is inside the sub groups within the SP so i am unable to link the file with access. Access only links the main grps of SP and not the files within the sub grp"}, {"owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "edited": false, "score": 0, "creation_date": 1487195010, "post_id": 42249941, "comment_id": 71678887, "body": "@AdityaIyer I mean when you see the file within the SP window, can you right click--&gt;copy shortcut then use that as the reference?"}, {"owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "reply_to_user": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "edited": false, "score": 0, "creation_date": 1487255829, "post_id": 42249941, "comment_id": 71710026, "body": "@RyanL Access was not able to reference the copy shortcut link from SP, hence i had to find a workaround instead"}], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 4774521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/nlLAj.jpg?s=128&g=1", "display_name": "michaelf", "link": "https://stackoverflow.com/users/4774521/michaelf"}, "edited": false, "score": 0, "creation_date": 1588796427, "post_id": 42276914, "comment_id": 109041304, "body": "May go without saying, but if you use the &quot;Get Link&quot; on SharePoint it will have a bunch of other stuff in the direct file URL. You may have to remove everything after the &quot;.xlsx&quot; (or whatever the file extension is) for it to open properly."}], "tags": [], "owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "is_accepted": true, "score": 1, "last_activity_date": 1487255714, "creation_date": 1487255714, "answer_id": 42276914, "question_id": 42249941, "link": "https://stackoverflow.com/questions/42249941/access-vba-to-get-data-from-excel-file-stored-in-sharepoint/42276914#42276914", "title": "Access VBA - To get data from Excel file stored in Sharepoint", "body": "<p>Finally I did find a workaround for this issue.</p>\n\n<p>I Created a private function in access to download the Excel file from SP and then used the Transferspread sheet function to retrieve the data into access table.</p>\n\n<p>Below is the code i used to download the Excel file in SP using access Vba</p>\n\n<pre><code> Private Sub Command2_Click()\n  Dim Ex As Object\n  Dim Acc As Object\n  Dim strXls As String\n\n\n    Set Ex = CreateObject(\"Excel.Application\")\n    Set Acc = Ex.Workbooks.Open(\"https://Sharepoint File link\")\n\n    Ex.Visible = False\n\n    Acc.SaveAs \"C:\\Users\\.......\\test.xlsx\"\n\n    Acc.Close\n    Ex.Quit\n\n    strXls = CurrentProject.Path &amp; Chr(92) &amp; \"C:\\Users\\.......\\test.xlsx\"\n    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"Tablename\", _\n    strXls, True, \"Sheet(1)!\"\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7285794, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154255925253391/picture?type=large", "display_name": "Aditya Iyer", "link": "https://stackoverflow.com/users/7285794/aditya-iyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2585, "favorite_count": 0, "accepted_answer_id": 42276914, "answer_count": 1, "score": 0, "last_activity_date": 1487255714, "creation_date": 1487163090, "last_edit_date": 1487201668, "question_id": 42249941, "link": "https://stackoverflow.com/questions/42249941/access-vba-to-get-data-from-excel-file-stored-in-sharepoint", "title": "Access VBA - To get data from Excel file stored in Sharepoint", "body": "<p>I have the below code working for me provided the \"Model_data.xlsm\" file is stored in my hard drive. Is it possible if Access can get the data from \"model_data.xlsm\" stored in Sharepoint?</p>\n\n<pre><code>Private Sub Update_manu_data_Click()\n\nDim strXls As String\n\n strXls = CurrentProject.Path &amp; Chr(92) &amp; \"Model_data.xlsm\"\n DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12,   \"Manufacturing_data\", _\n strXls, True, \"Combined!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "edited": false, "score": 0, "creation_date": 1487167174, "post_id": 42250422, "comment_id": 71660547, "body": "unfortunately I receive another run time error 1004: Unable to get the PivotTables property of the Worksheet class on line 9 of your code (Set PvtTbl...)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "edited": false, "score": 0, "creation_date": 1487167365, "post_id": 42250422, "comment_id": 71660686, "body": "@alex do you have the <code>PivotTable</code> set-up ? what is the worksheet name ? make sure the name of the <code>Worksheets</code> and PivotTable` match the code"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "edited": false, "score": 0, "creation_date": 1487168044, "post_id": 42250422, "comment_id": 71661166, "body": "@alex i&#39;ve edited the code to match your <code>Worksheet</code> name"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1487168022, "last_edit_date": 1487168022, "creation_date": 1487164444, "answer_id": 42250422, "question_id": 42249880, "link": "https://stackoverflow.com/questions/42249880/can-you-make-a-pivot-table-by-column-index-as-opposed-to-column-name-in-vba/42250422#42250422", "title": "Can you make a pivot table by column index as opposed to column name in VBA", "body": "<p>Try the code below (explanations are inside the code comments).</p>\n\n<p>You need to make sure that the formatting of Cell \"B3\" is identical to the one in the <code>PivotTable</code>, otherwise you will get a run-time error at the following line:</p>\n\n<pre><code>.AddDataField PvtTbl.PivotFields(PvtFlfVal), \"Count of \" &amp; PvtFlfVal, xlCount\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub DynamicPivotTableCountField()\n\nDim PvtTbl As Pivottable\nDim PvtFlfVal '   As String\n\n' set the Pivot Table, replace \"Sheet1\" with your sheet's name (don't use ActiveSheet)\nSet PvtTbl = Worksheets(\"Practitioners\").PivotTables(\"PivotTable8\")\n\n' get the value from Cell B3, make sure it's formatted the way you need it for the Pivot Table later\nPvtFlfVal = Format(Worksheets(\"Practitioners\").Range(\"B3\").Value, \"dd-mmm-yyyy\")\n\nWith PvtTbl\n    .AddDataField PvtTbl.PivotFields(PvtFlfVal), \"Count of \" &amp; PvtFlfVal, xlCount\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 42250422, "answer_count": 1, "score": 0, "last_activity_date": 1487168022, "creation_date": 1487162913, "last_edit_date": 1487167900, "question_id": 42249880, "link": "https://stackoverflow.com/questions/42249880/can-you-make-a-pivot-table-by-column-index-as-opposed-to-column-name-in-vba", "title": "Can you make a pivot table by column index as opposed to column name in VBA", "body": "<p>I have a table composed of 400 rows and 35 columns, and made a VBA script to make a pivot table comparing 2 columns vs 12 separate columns successfully.</p>\n\n<p>While generating the pivot table, column headers are used (to avoid confusion). I am new with VBA, and this is how I called everything up to my errors</p>\n\n<pre><code>ActiveCell.Select\nRange(\"AA3\").Select\nSelection.CurrentRegion.Select\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    \"Practitioners!R3C1:R246C27\", Version:=xlPivotTableVersion15). _\n    CreatePivotTable TableDestination:=\"Practitioners!R3C29\", TableName:= _\n    \"PivotTable8\", DefaultVersion:=xlPivotTableVersion15\nSheets(\"Practitioners\").Select\nCells(3, 29).Select\nActiveWorkbook.ShowPivotTableFieldList = False\nWith ActiveSheet.PivotTables(\"PivotTable8\").PivotFields(\"Capability\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith ActiveSheet.PivotTables(\"PivotTable8\").PivotFields(\"Sub-Capability\")\n    .Orientation = xlRowField\n    .Position = 2\nEnd With\nActiveSheet.PivotTables(\"PivotTable8\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable8\").PivotFields(\"Grade\"), \"Count of Grade\", xlCount\nActiveSheet.PivotTables(\"PivotTable8\").AddDataField ActiveSheet.PivotTables( _\n    \"PivotTable8\").PivotFields(\"06-Feb-2017\"), \"Count of 06-Feb-2017\", xlCount\n</code></pre>\n\n<p>but my column headers will change every week, and altering the name of the header means the VBA code will not work because it is no longer \"06-Feb-2017\".</p>\n\n<p>I tried making a reference to an absolute cell in my code, but came up with an error</p>\n\n<blockquote>\n  <p>Run-time error '1004, Unable to get the PivotFields property of the\n  PivotTable class</p>\n</blockquote>\n\n<p>Is there a way to refer to the <code>PivotFields</code> as an absolute cell reference (ie B3)?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1487165245, "creation_date": 1487165245, "answer_id": 42250716, "question_id": 42249848, "link": "https://stackoverflow.com/questions/42249848/query-user-to-choose-path/42250716#42250716", "title": "Query user to choose path", "body": "<p>Use <code>FileDialog</code> with <code>FolderPicker</code>, here it's wrap in a function :</p>\n\n<pre><code>Function GetFolder(Optional strPath As String = \"C:\\\") As String\n    Dim fldr As FileDialog\n    Dim sItem As String\n    GetFolder = vbNullString\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = strPath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFolder = sItem\n    Set fldr = Nothing\nEnd Function\n</code></pre>\n\n<p>And your code, you can set the default path in <code>GetFolder(ThisWorkbook.Path &amp; \"\\\")</code> :</p>\n\n<pre><code>Sub distribuire_foldere()\nDim objFSO As Object\nDim objFolder As Object\nDim objSubFolder As Object\nDim i As Integer\n    'CLEARS ALL PREVIOUS CONTENT\n    Sheets(\"DISTRIBUIRE foldere\").Range(\"A2:A2000\").ClearContents\n\n    'INSERTS IN CELL THE PATH WHERE THE SCRIPT IS READING\n    Sheets(\"DISTRIBUIRE foldere\").Range(\"$E$1\").Value = ThisWorkbook.Path &amp; \"\\CtrExtrase\"\n\n    ' LISTS THE CONTENT OF THE CHOOSEN FOLDER\n    Application.StatusBar = \"\"\n    'Create an instance of the FileSystemObject\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    'Get the folder object\n    On Error GoTo nuexistafolderul\n    'THIS IS THE PROBLEM, AS I NEED THE USER TO CHOOSE THE PATH:\n\n    Set objFolder = objFSO.GetFolder(GetFolder(ThisWorkbook.Path &amp; \"\\\"))\n\n    i = 1\n    'loops through each folder in the directory and prints their names\n    On Error GoTo handleCancel\n    Application.EnableCancelKey = xlErrorHandler\n    For Each objSubFolder In objFolder.SubFolders\n        Application.StatusBar = objSubFolder.Path &amp; \" \" &amp; objSubFolder.Name\n        'OUTPUTS THE FOLDERS NAME\n        Cells(i + 1, 1) = objSubFolder.Name\n        i = i + 1\n    Next objSubFolder\n\nhandleCancel:\nIf Err = 18 Then\n    MsgBox \"Ai anulat procesul inainte de finalizare! Reia procedura!\"\nnuexistafolderul:\n    MsgBox \"Nu exista folderul pentru extractia contractelor! Extrage intai contractele!\"\nEnd If\n'CALLS A MODULE THAT INSERTS CERTAIN TEXT INTO A BATCH FILE\nCall Module1.batchfile2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7271887, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/676cb06e2d1e62a5bb2c38a5371f9511?s=128&d=identicon&r=PG&f=1", "display_name": "MisterA", "link": "https://stackoverflow.com/users/7271887/mistera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 42250716, "answer_count": 1, "score": 1, "last_activity_date": 1487165245, "creation_date": 1487162820, "last_edit_date": 1487164681, "question_id": 42249848, "link": "https://stackoverflow.com/questions/42249848/query-user-to-choose-path", "title": "Query user to choose path", "body": "<p>I have a code that reads a folder contents (only other folders) and lists them into excel in a certain range.<br>\nThe problem is that the path where the code reads contents (/CtrExtrase) is given in the code.</p>\n\n<p>I need the path to be choosen by the user. Tried and failed totally.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub distribuire_foldere()\nDim objFSO As Object\nDim objFolder As Object\nDim objSubFolder As Object\nDim i As Integer\n\n\n'CLEARS ALL PREVIOUS CONTENT\n   Sheets(\"DISTRIBUIRE foldere\").Range(\"A2:A2000\").ClearContents\n\n'INSERTS IN CELL THE PATH WHERE THE SCRIPT IS READING\nSheets(\"DISTRIBUIRE foldere\").Range(\"$E$1\").Value = ThisWorkbook.path &amp; \"\\CtrExtrase\"\n\n' LISTS THE CONTENT OF THE CHOOSEN FOLDER\nApplication.StatusBar = \"\"\n'Create an instance of the FileSystemObject\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n'Get the folder object\nOn Error GoTo nuexistafolderul\n</code></pre>\n\n<p><strong>'THIS IS THE PROBLEM, AS I NEED THE USER TO CHOOSE THE PATH:</strong></p>\n\n<pre><code>Set objFolder = objFSO.GetFolder(Application.ThisWorkbook.path &amp; \"\\CtrExtrase\")\n\ni = 1\n'loops through each folder in the directory and prints their names   \nOn Error GoTo handleCancel\nApplication.EnableCancelKey = xlErrorHandler\nFor Each objSubFolder In objFolder.subfolders\n\nApplication.StatusBar = objSubFolder.path &amp; \" \" &amp; objSubFolder.Name\n    'OUTPUTS THE FOLDERS NAME\n    Cells(i + 1, 1) = objSubFolder.Name\n    i = i + 1\nNext objSubFolder\nhandleCancel:\nIf Err = 18 Then\n MsgBox \"Ai anulat procesul inainte de finalizare! Reia procedura!\"\nnuexistafolderul:\n MsgBox \"Nu exista folderul pentru extractia contractelor! Extrage intai contractele!\"\n\n\nEnd If\n'CALLS A MODULE THAT INSERTS CERTAIN TEXT INTO A BATCH FILE\n Call Module1.batchfile2\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 1, "creation_date": 1487162898, "post_id": 42249685, "comment_id": 71657615, "body": "The looks like it should do what you need it to do.  Are you able to specify what it is that you&#39;re not happy with?"}, {"owner": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "reply_to_user": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 0, "creation_date": 1487163154, "post_id": 42249685, "comment_id": 71657767, "body": "I guess my initial complaint would be that it does not yield any results... I had a version of the code that could do one folder at a time, but I need it to do nearly 400 and that&#39;s just not sustainable."}, {"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 0, "creation_date": 1487165600, "post_id": 42249685, "comment_id": 71659412, "body": "Sorry, The way I read your question, it didn&#39;t sound that serious.  I see now that you&#39;re not looping through the files and subfolders properly so hopefully Vityata&#39;s answer get that part sorted."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1487163353, "last_edit_date": 1495542846, "creation_date": 1487163353, "answer_id": 42250034, "question_id": 42249685, "link": "https://stackoverflow.com/questions/42249685/list-all-worksheets-in-workbooks-stored-in-various-folders-and-subfolders-excel/42250034#42250034", "title": "List all worksheets in workbooks stored in various folders and subfolders- Excel, VBA", "body": "<p>Here is something from <a href=\"https://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\">Loop Through All Subfolders Using VBA</a>, that would work for you:</p>\n\n<pre><code>Option Explicit\n\nSub LoopThroughFiles()\n\n    Dim FileSystem As Object\n    Dim HostFolder As String\n\n    HostFolder = \"C:\\Users\\\"\n\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n\n    DoFolder FileSystem.GetFolder(HostFolder)\n\nEnd Sub\n\n\nSub DoFolder(Folder)\n\n    Dim SubFolder\n\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n    Dim File\n    For Each File In Folder.Files\n        Debug.Print File.name\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Just make sure that you run <code>LoopThroughFiles()</code> and change the <code>HostFolder</code> to something meaningful. Then work with <code>File.name</code> in the <code>debug.print</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487316495, "creation_date": 1487162359, "last_edit_date": 1487316495, "question_id": 42249685, "link": "https://stackoverflow.com/questions/42249685/list-all-worksheets-in-workbooks-stored-in-various-folders-and-subfolders-excel", "title": "List all worksheets in workbooks stored in various folders and subfolders- Excel, VBA", "body": "<p>I have been trying to write a macro that will list the sheet names of every workbook in my directory. These files are stored in various folders and subfolders, so I would like for it to pull out everything and I can extrapolate the information I need from the whole output. This code is something I've put together with the help of users from this site, but I still am not getting the desired result. Someone please help! </p>\n\n<pre><code>Sub machinegun()\n    FileType = \"*.xls*\"\n    OutputRow = 2\n Set fso = CreateObject(\"Scripting.FileSystemObject\")\n Set Folder = fso.GetFolder(\"G:\")\n Set Curr_File = (filepath &amp; FileType)\n For Each Subfolder In Folder.Subfolders\n    Do Until Curr_File = \"\"\n        Set Fldr.wkbk = Workbooks.Open(filepath &amp; Curr_File, False, True)\n        ThisWorkbook.ActiveSheet.Range(\"A\" &amp; OutputRow) = Curr_File\n        ThisWorkbook.ActiveSheet.Range(\"B\" &amp; OutputRow).ClearContents\n        OutputRow = OutputRow + 1\n\n        For Each Sht In FldrWkbk.Sheets\n            ThisWorkbook.ActiveSheet.Range(\"B\" &amp; OutputRow) = Sht.Name\n            ThisWorkbook.ActiveSheet.Range(\"A\" &amp; OutputRow).ClearContents\n            OutputRow = OutputRow + 1\n        Next Sht\n        FldrWkbk.Close SaveChanges:=False\n      Loop\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "edited": false, "score": 1, "creation_date": 1487162746, "post_id": 42249521, "comment_id": 71657499, "body": "I think that you could build a loop that open each sheet and each file you need. Then you look for a column with specifica header and copy it into a new file. Try with macro recorder and the parametrize the code. If you&#39;ll find specific problem ask here."}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 0, "creation_date": 1487168636, "post_id": 42249521, "comment_id": 71661578, "body": "please post what you have so we can work with that."}, {"owner": {"reputation": 51, "user_id": 3119542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CXMLx.jpg?s=128&g=1", "display_name": "masterofimps", "link": "https://stackoverflow.com/users/3119542/masterofimps"}, "reply_to_user": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "edited": false, "score": 0, "creation_date": 1487171434, "post_id": 42249521, "comment_id": 71663743, "body": "Thanks for that @Nicolaesse  I&#39;ve just added an edit showing progress so far.  If I could figure out why the header is also included Id be a lot of the way there.  Thanks."}], "owner": {"reputation": 51, "user_id": 3119542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CXMLx.jpg?s=128&g=1", "display_name": "masterofimps", "link": "https://stackoverflow.com/users/3119542/masterofimps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487170638, "creation_date": 1487161905, "last_edit_date": 1487170638, "question_id": 42249521, "link": "https://stackoverflow.com/questions/42249521/excel-vba-merge-columns-sequentially-from-all-tabs-by-column-name", "title": "Excel/VBA Merge columns sequentially from all tabs by column name", "body": "<p>I need to merge certain columns by header from each excel workbook tab into one.</p>\n\n<p>I have 52 tabs, each with a different number of columns, but the 6 columns i need all have the same header.  I need to extract each of these columns and place them sequentially so 52 tabs would look like this for example </p>\n\n<p><a href=\"https://i.stack.imgur.com/jRz63.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jRz63.png\" alt=\"Excel example\"></a></p>\n\n<p>but if I want to select just 'Column1' from each tab and display sequentially like this </p>\n\n<p><a href=\"https://i.stack.imgur.com/Sttiz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sttiz.png\" alt=\"Excel Merged Example\"></a></p>\n\n<p>How would I do this ? I've been able to find some examples on SO but none that fit this case, and so far I've been unable to piece together a solution on my own.  Any help would be very much appreciated!</p>\n\n<p><em>EDIT</em></p>\n\n<p>This is what I currently have, however this is also printing the header as well</p>\n\n<pre><code>Sub Combine()\n\nDim J As Integer\nOn Error Resume Next\nSheets(1).Select\nWorksheets.Add\nSheets(1).Name = \"Combined\"\nSheets(2).Activate\n\nFor J = 2 To Sheets.Count\n    Sheets(J).Activate\n    Dim rng1 As Range\n    Set rng1 = Range(Range(\"A1:Z1\").Find(\"Customer\"), Range(\"A1:Z1\").Find(\"Customer\").End(xlDown))\n    rng1.Select\n    rng1.CurrentRegion.Select\n    'Selection.CurrentRegion.Select\n    rng1.Offset(1, 0).Resize(Selection.Rows.Count - 1).Select\n    rng1.Copy Destination:=Sheets(1).Range(\"A65536\").End(xlUp)(2)\n\nNext\n\nSheets(1).Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1487162113, "post_id": 42249484, "comment_id": 71657047, "body": "Regex is not necessary here, you can use Left, with InStr looking for @"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487162137, "post_id": 42249484, "comment_id": 71657067, "body": "@ShaiRado : Damn, I was typing!^^"}], "answers": [{"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 1, "creation_date": 1487577110, "post_id": 42250059, "comment_id": 71830326, "body": "Better than <code>Regexp</code>. But would suggest the string function Left$ over its variant cousin Left"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1487163445, "creation_date": 1487163445, "answer_id": 42250059, "question_id": 42249484, "link": "https://stackoverflow.com/questions/42249484/outlook-vba-regex-to-extract-username-in-email-address/42250059#42250059", "title": "Outlook VBA regex to extract username in email address", "body": "<p>Try the code below, insread of <code>RegEx</code> you could use <code>Left</code> combined with <code>Instr</code>.</p>\n\n<pre><code>Dim usern   As String\n\n'emailAddress = \"prateek@gmail.com\" ' &lt;-- for debug\n\nusern = Left(emailAddress, InStr(emailAddress, \"@\") - 1)\nMsgBox \"UserName is \" &amp; usern\n</code></pre>\n"}], "owner": {"reputation": 1514, "user_id": 4056736, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb80113bb3b5cd54c8358680fd56bafc?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Narendra", "link": "https://stackoverflow.com/users/4056736/prateek-narendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 42250059, "answer_count": 1, "score": 1, "last_activity_date": 1593043070, "creation_date": 1487161809, "last_edit_date": 1593043070, "question_id": 42249484, "link": "https://stackoverflow.com/questions/42249484/outlook-vba-regex-to-extract-username-in-email-address", "title": "Outlook VBA regex to extract username in email address", "body": "<p>How do I extract the username out of an email address in VBA?</p>\n\n<p>For example - if my email ID is \"prateek@gmail.com\", then the username is \"prateek\"</p>\n\n<p>So far - I wrote this - </p>\n\n<pre><code>Set Reg1 = New RegExp\n\n' \\s* = invisible spaces\n' \\d* = match digits\n' \\w* = match alphanumeric\n\nWith Reg1\n    .Pattern = \"\\w+@gmail\\.com\"\n    .Global = True\nEnd With\nIf Reg1.Test(emailAddress) Then\n\n    Set M1 = Reg1.Execute(emailAddress)\n    For Each M In M1\n        ' M.SubMatches(1) is the (\\w*) in the pattern\n        ' use M.SubMatches(2) for the second one if you have two (\\w*)\n        Debug.Print M.SubMatches(1)            \n    Next\nEnd If\n</code></pre>\n\n<p>But it doesnt look like it go any submatch</p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1487161663, "post_id": 42249259, "comment_id": 71656733, "body": "Add If e.Value&lt;&gt;&quot;&quot; Then before checking If Not .Exists(e)..."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487161962, "post_id": 42249259, "comment_id": 71656936, "body": "<code>If Not .Exists(e) And e&lt;&gt;vbNullString Then .Add e, Nothing</code> as @ShaiRado said"}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487163168, "post_id": 42249259, "comment_id": 71657780, "body": "@R3uK This code from you working, but If range has only one value there is error (&quot;Application-defined or object-deffined error&quot;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487165566, "post_id": 42249259, "comment_id": 71659385, "body": "@Nataniell : Yeah, on the line <code>v = .Value</code>, try my answer to see if it works"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1487165639, "post_id": 42250413, "comment_id": 71659433, "body": "Hmm still same error. My data in range looks like: empty, empty, TEST, empty, empty, TEST,"}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1487165969, "post_id": 42250413, "comment_id": 71659679, "body": "This line  <code>ThisWorkbook.Worksheets(&quot;DICTIONARY&quot;).Range(&quot;B2&quot;).Resize(UBo&zwnj;&#8203;und(.Keys), 1).Value = _     Application.Transpose(.Keys)</code> error (&quot;Application-defined or object-deffined error&quot;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1487166267, "post_id": 42250413, "comment_id": 71659883, "body": "@Nataniell : Try the edit, it&#39;s probably because there is not keys! ;)"}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1487166722, "post_id": 42250413, "comment_id": 71660198, "body": "Now error:Object requierd on the line <code>If .Keys.Count &gt; 0 Then </code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1487167293, "post_id": 42250413, "comment_id": 71660625, "body": "@Nataniell : give it another try! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1487167857, "post_id": 42250413, "comment_id": 71661048, "body": "@Nataniell : Glad I could help! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1487167280, "last_edit_date": 1487167280, "creation_date": 1487164422, "answer_id": 42250413, "question_id": 42249259, "link": "https://stackoverflow.com/questions/42249259/vba-scripting-dictionary-exclude-blank/42250413#42250413", "title": "VBA - scripting.dictionary exclude blank", "body": "<pre><code>Dim v, e\n\nWith Sheets(\"DATA\").Range(\"NAMED_RANGE\")\n    If Application.WorksheetFunction.CountA(.Cells) &gt; 1 Then\n        v = .Value\n    Else\n        v = .Cells(1, 1).Value\n    End If\nEnd With\n\nWith CreateObject(\"scripting.dictionary\")\n    .CompareMode = 1\n    For Each e In v\n        If Not .Exists(e) And e &lt;&gt; vbNullString Then .Add e, Nothing\n    Next\n    If .Count Then Me.TextBox121.List = Application.Transpose(.Keys)\n\n    If .Count And UBound(.Keys)&gt;0 Then ThisWorkbook.Worksheets(\"DICTIONARY\").Range(\"B2\").Resize(UBound(.Keys), 1).Value = _\n        Application.Transpose(.Keys)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "accepted_answer_id": 42250413, "answer_count": 1, "score": 1, "last_activity_date": 1545834511, "creation_date": 1487161224, "last_edit_date": 1545834511, "question_id": 42249259, "link": "https://stackoverflow.com/questions/42249259/vba-scripting-dictionary-exclude-blank", "title": "VBA - scripting.dictionary exclude blank", "body": "<p>It is possible with <code>scripting.dictionary</code> exclude blank from range?\nI am using this code to find special values from range. I don\u00b4t need excel formula for range, but solution in VBA (if exist).</p>\n\n<p>With this code I have in listbox always one blank item.</p>\n\n<pre><code>Dim v, e\n\nWith Sheets(\"DATA\").Range(\"NAMED_RANGE\")\n    v = .Value\nEnd With\n\nWith CreateObject(\"scripting.dictionary\")\n    .CompareMode = 1\n    For Each e In v\n        If Not .Exists(e) Then .Add e, Nothing\n    Next\n    If .Count Then Me.TextBox121.List = Application.Transpose(.keys)\n\n    ThisWorkbook.Worksheets(\"DICTIONARY\").Range(\"B2\").Resize(UBound(.keys), 1).Value = _\n    Application.Transpose(.keys)\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 6372785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc8c3987229edf961d0be546ee253557?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6372785/josh"}, "edited": false, "score": 0, "creation_date": 1487163307, "post_id": 42249821, "comment_id": 71657869, "body": "I am still getting a file already exists error. It almost seems like its not even getting to the point where Windows would ask to overwrite the file and instead failing in the code because it already exists."}, {"owner": {"reputation": 127, "user_id": 6372785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc8c3987229edf961d0be546ee253557?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6372785/josh"}, "edited": false, "score": 2, "creation_date": 1487163711, "post_id": 42249821, "comment_id": 71658125, "body": "Going off of your line of thought I commented out the section that renamed the file and then deletes the original. This correctly overwrites the file so I am able to proceed from there. Thanks!"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1487189940, "post_id": 42249821, "comment_id": 71676203, "body": "Are you sure this code would even run? Application does not have a property or function named Namespace. The GetNamespace function only allows &quot;MAPI&quot; as its argument. No Outlook object has CopyHere method."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1487193928, "post_id": 42249821, "comment_id": 71678335, "body": "@DmitryStreblechenko Like I said, I tested in Word but not Outlook, so I can&#39;t argue with you :) .  The <code>Shell.Application</code> object comes from the <code>Microsoft Shell Controls and Automation</code> TLB - add it in Tools | References and you should be able to see <code>Folder.CopyHere</code> in the <code>Shell32</code> library."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1487195759, "post_id": 42249821, "comment_id": 71679270, "body": "Ok then, the OP does it in Outlook Object Model, which has absolutely nothing in common with the Word Object Model."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1487253281, "post_id": 42249821, "comment_id": 71707866, "body": "@DmitryStreblechenko Yes.  Also, I should have said earlier --- <code>Application</code> in Outlook is <code>Outlook.Application</code>, which is a different interface from <code>Shell.Application</code>.  Both are listed separately under <code>HKEY_CLASSES_ROOT</code> in the registry (as is <code>Word.Application</code>)."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 3, "last_activity_date": 1487164558, "last_edit_date": 1487164558, "creation_date": 1487162729, "answer_id": 42249821, "question_id": 42249226, "link": "https://stackoverflow.com/questions/42249226/outlook-vba-overwriting-existing-file-on-disk/42249821#42249821", "title": "Outlook VBA overwriting existing file on disk", "body": "<p>Based on my tests, changing the <code>CopyHere</code> to</p>\n\n<pre><code>oApp.NameSpace(\"C:\\Report\\\").CopyHere _\n       oApp.NameSpace(saveFolder &amp; dName).Items, _\n       4 + 16\n</code></pre>\n\n<p>should do it.  </p>\n\n<p>Per <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb787866(v=vs.85).aspx\" rel=\"nofollow noreferrer\">the docs</a>, flag <code>4</code> suppresses the progress dialog and flag <code>16</code> forces \"Yes to All\" responses.  </p>\n\n<p>In older versions of Windows (as I recall), \"Yes to All\" was the \"overwrite\" response, and that seems to hold true for me.</p>\n\n<p><sup>Tested in Word 2013 VBA on Windows 8.1 Pro.  I checked this with static filenames, not with the <code>.Items</code> collection.</sup></p>\n"}], "owner": {"reputation": 127, "user_id": 6372785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc8c3987229edf961d0be546ee253557?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6372785/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "accepted_answer_id": 42249821, "answer_count": 1, "score": 3, "last_activity_date": 1592946367, "creation_date": 1487161137, "last_edit_date": 1592946367, "question_id": 42249226, "link": "https://stackoverflow.com/questions/42249226/outlook-vba-overwriting-existing-file-on-disk", "title": "Outlook VBA overwriting existing file on disk", "body": "<p>I have the following that currently extracts an .xls from a .zip and then saves it with a new name into a specified directory</p>\n\n<pre><code>Public Sub saveAttachmentZip(itm As Outlook.MailItem)\n\nConst saveFolder = \"C:\\Temp\\\"\nConst fileFolder = \"C:\\Report\\\"\n\nDim objAtt As Outlook.Attachment\nDim oApp As Object\nDim dName As Variant\n\nFor Each objAtt In itm.Attachments\n    dName = objAtt.DisplayName\n    objAtt.SaveAsFile saveFolder &amp; dName\n    Set oApp = CreateObject(\"Shell.Application\")\n    oApp.NameSpace(\"C:\\Report\\\").CopyHere _\n           oApp.NameSpace(saveFolder &amp; dName).Items\n           Name fileFolder &amp; \"Report.xls\" As fileFolder &amp; \"NewReport.xls\"\n           Kill saveFolder &amp; dName\nNext\n\nEnd Sub\n</code></pre>\n\n<p>My only issue is that this works once and then fails due to the file already existing. Is there a different way I need to save it in order for it to overwrite the existing file?</p>\n\n<p><em>Bonus info</em></p>\n\n<p>I also have the following which does the same thing but for emails that don't have a zipped extension and this one correctly overwrites the existing file on disk</p>\n\n<pre><code>Public Sub saveAttach(itm As Outlook.MailItem)\n\n    Const fileFolder = \"C:\\Report\\\"\n\n    Dim objAtt As Outlook.Attachment\n\n    For Each objAtt In itm.Attachments\n        objAtt.SaveAsFile fileFolder &amp; \"\\\" &amp; \"OldReport.csv\"\n        Set objAtt = Nothing\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "export"], "comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1487161239, "post_id": 42249122, "comment_id": 71656411, "body": "<code>I don&#39;t understand exactly what the code does</code> - well you need to figure it out! ;) Start by stepping through the code line by line by setting the cursor in <code>SaveWorksheetsAsCsv</code> and pressing F8. You&#39;ll be a coder in no time!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7568484, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290276567705254/picture?type=large", "display_name": "Marco", "link": "https://stackoverflow.com/users/7568484/marco"}, "is_accepted": false, "score": 0, "last_activity_date": 1487340184, "creation_date": 1487340184, "answer_id": 42299843, "question_id": 42249122, "link": "https://stackoverflow.com/questions/42249122/creating-a-form-to-submit-a-csv-file-with-content/42299843#42299843", "title": "Creating a form to submit a csv file with content", "body": "<p>I found the solution using a step-by-step method with F8. Finding the last row was where the error was. Now I'm using:</p>\n\n<pre><code>Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7568484, "user_type": "registered", "profile_image": "https://graph.facebook.com/1290276567705254/picture?type=large", "display_name": "Marco", "link": "https://stackoverflow.com/users/7568484/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487340184, "creation_date": 1487160851, "question_id": 42249122, "link": "https://stackoverflow.com/questions/42249122/creating-a-form-to-submit-a-csv-file-with-content", "title": "Creating a form to submit a csv file with content", "body": "<p>I havethe following problem:</p>\n\n<p>To be able to deploy multiple devices, I have edited some VBA code I found here and there and I'm lost at the moment... Because I'm not a coder, and I don't understand exactly what the code does, I can't figure out the solution.</p>\n\n<p>The problem is: when I add 1 device, the .csv file is cluttered with data:</p>\n\n<pre><code>HOSTNAMEHQ,COUNTRYCRE,HARDWARECRE,MAC,UUID,DESCRIPTION,PLATFORM\nLPAB00000013293,,,28:F1:0E:30:81:C1,,STOCK, \n#N/A,,,#N/A,,STOCK, \n#N/A,,,#N/A,,STOCK, \n#N/A,,,#N/A,,STOCK, \n#N/A,,,#N/A,,STOCK, \n#N/A,,,#N/A,,STOCK, \n(etc)\n</code></pre>\n\n<p>When I add 2 or more devices, the .csv file is OK:</p>\n\n<pre><code>HOSTNAMEHQ,COUNTRYCRE,HARDWARECRE,MAC,UUID,DESCRIPTION,PLATFORM\nLPAB00000013293,,,28:F1:0E:30:81:C1,,STOCK, \nLPAB00000013293,,,28:F1:0E:30:81:C1,,STOCK, \n</code></pre>\n\n<p>The code I'm using is:</p>\n\n<pre><code>    Sub Button_Click()\n    Call SaveWorksheetsAsCsv\n    End Sub\n\n    Sub SaveWorksheetsAsCsv()\n    On Error Resume Next\n    Dim i As Long\n    Errorknop = vbCritical + vbOKOnly\n    ThisWorkbook.Sheets(\"Export\").Visible = xlSheetVisible\n    ThisWorkbook.Sheets(\"Export\").Activate\n    Range(\"A1\").Select\n    Selection.End(xlDown).Select\n    LaRo = ActiveCell.Row\n    Range(\"A1\").Select\n\n\n\n\n    Range(\"A2\").Select\n    Selection.End(xlDown).Select\n    LR = ActiveCell.Row\n    LC = Last(4, ActiveSheet.Cells)\n    LCR = LC &amp; LR\n    Range(\"B1:\" &amp; LCR).Copy\n    ThisWorkbook.Sheets(\"Export\").Visible = xlSheetHidden\n    ThisWorkbook.Sheets(\"Export_2\").Visible = xlSheetVisible\n    ThisWorkbook.Sheets(\"Export_2\").Activate\n    Range(\"A1\").Select\n    Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n    Dim LValue As Date\n\n    LValue = Now\n\n    Dim SaveToDirectory As String\n\n    Dim CurrentWorkbook As String\n    Dim CurrentFormat As Long\n\n    Dim strbody As String\n        Dim SigString As String\n        Dim Signature As String\n\n\n    CurrentWorkbook = ThisWorkbook.FullName\n    CurrentFormat = ThisWorkbook.FileFormat\n\n\n     SaveToDirectory = \"D:\\Testmap\\Formulieren\\\"\n    Worksheets(\"Export_2\").SaveAs Filename:=SaveToDirectory &amp; Day(LValue) &amp; Month(LValue) &amp; Year(LValue) &amp; Hour(LValue) &amp; Minute(LValue) &amp; Second(LValue) &amp; \"_1IMPORT_TEMPLATE_NN_AD_SCCM_HP\", FileFormat:=xlCSV\n    ThisWorkbook.Saved = True\n\n\n\n    Application.Quit\n    End Sub\n\n    Function Last(choice As Integer, rng As Range)\n    ' 1 = last row\n    ' 2 = last column (R1C1)\n    ' 3 = last cell\n    ' 4 = last column (A1)\n        Dim lrw As Long\n        Dim lcol As Integer\n\n        Select Case choice\n        Case 1:\n            On Error Resume Next\n            Last = rng.Find(What:=\"*\", _\n                            After:=rng.Cells(1), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n            On Error GoTo 0\n\n        Case 2:\n            On Error Resume Next\n            Last = rng.Find(What:=\"*\", _\n                            After:=rng.Cells(1), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n            On Error GoTo 0\n\n        Case 3:\n            On Error Resume Next\n            lrw = rng.Find(What:=\"*\", _\n                           After:=rng.Cells(1), _\n                           LookAt:=xlPart, _\n                           LookIn:=xlFormulas, _\n                           SearchOrder:=xlByRows, _\n                           SearchDirection:=xlPrevious, _\n                           MatchCase:=False).Row\n            lcol = rng.Find(What:=\"*\", _\n                            After:=rng.Cells(1), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n            Last = Cells(lrw, lcol).Address(False, False)\n            If Err.Number &gt; 0 Then\n                Last = rng.Cells(1).Address(False, False)\n                Err.Clear\n            End If\n            On Error GoTo 0\n        Case 4:\n            On Error Resume Next\n            Last = rng.Find(What:=\"*\", _\n                            After:=rng.Cells(1), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n            On Error GoTo 0\n            Last = R1C1converter(\"R1C\" &amp; Last, 1)\n            For i = 1 To Len(Last)\n                s = Mid(Last, i, 1)\n                If Not s Like \"#\" Then s1 = s1 &amp; s\n            Next i\n            Last = s1\n\n        End Select\n\n    End Function\n\n\n\n\n    Function GetBoiler(ByVal sFile As String) As String\n    'Dick Kusleika\n        Dim fso As Object\n        Dim ts As Object\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n        Set ts = fso.GetFile(sFile).OpenAsTextStream(1, -2)\n        GetBoiler = ts.readall\n        ts.Close\n    End Function\n\n\n\n    Function R1C1converter(Address As String, Optional R1C1_output As Integer, Optional RefCell As Range) As String\n        'Converts input address to either A1 or R1C1 style reference relative to RefCell\n        'If R1C1_output is xlR1C1, then result is R1C1 style reference.\n        'If R1C1_output is xlA1 (or missing), then return A1 style reference.\n        'If RefCell is missing, then the address is relative to the active cell\n        'If there is an error in conversion, the function returns the input Address string\n        Dim x As Variant\n        If RefCell Is Nothing Then Set RefCell = ActiveCell\n        If R1C1_output = xlR1C1 Then\n            x = Application.ConvertFormula(Address, xlA2, xlR1C1, , RefCell) 'Convert A2 to R1C1\n        Else\n            x = Application.ConvertFormula(Address, xlR1C1, xlA2, , RefCell) 'Convert R1C1 to A2\n        End If\n        If IsError(x) Then\n            R1C1converter = Address\n        Else\n            'If input address is A1 reference and A1 is requested output, then Application.ConvertFormula\n            'surrounds the address in single quotes.\n            If Right(x, 1) = \"'\" Then\n                R1C1converter = Mid(x, 2, Len(x) - 2)\n            Else\n                x = Application.Substitute(x, \"$\", \"\")\n                R1C1converter = x\n            End If\n        End If\n    End Function\n</code></pre>\n\n<p>For a coder this might be completely logical or even a big mess, but I really hope someone can give me the solution so the script runs, get's the information for the cells, and then stops when it finds an empty cell. At that moment, write the .csv file and close.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 2, "creation_date": 1487159358, "post_id": 42248504, "comment_id": 71655189, "body": "Have you done as it asks and turned on background error checking? The issue could well be in your Macro1, have you stepped through it with F8 to see on which line it quits?"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1487159421, "post_id": 42248504, "comment_id": 71655226, "body": "Try to add <code>Application.EnableEvents = False</code> at the first and <code>Application.EnableEvents = True</code> at end."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487159790, "post_id": 42248504, "comment_id": 71655478, "body": "Why do you have <code>Range(Target.Address)</code> , just use <code>Target</code>. No need to have <code>Call Macro1</code> just write <code>Macro1</code>. For debug part, write <code>MsgBox &quot;Start&quot;</code> before <code>Macro1</code>, and  <code>MsgBox &quot;Finish&quot;</code> after. This way you&#39;ll know where the error is coming from"}, {"owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487159968, "post_id": 42248504, "comment_id": 71655603, "body": "If I remove .Address from Target, it results in &quot;Run-time error &#39;1004&#39;: Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed&quot; error. Adding debug part, didn&#39;t show any errors, all Macros are executing as intended. The error seems to be random, one time, everything will function with no errors, then suddenly, Excel quits on you."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487160219, "post_id": 42248504, "comment_id": 71655754, "body": "@zafira.404 can u share Macro1 ?"}, {"owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487160793, "post_id": 42248504, "comment_id": 71656124, "body": "I&#39;ve added Macro1 to the question."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487168888, "post_id": 42249271, "comment_id": 71661763, "body": "Sadly, this didn&#39;t help. Could it be my second macro? It worked fine for a few times, and then I changed a cell value under specified Target range and it caused Excel to crash (quit unexpectedly)."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487169112, "post_id": 42249271, "comment_id": 71661958, "body": "@zafira.404 : It probably is, as the <code>Worksheet_Change</code> is pretty neat. Do you have an error or does Excel just crash? Is <code>Before Macro1</code> message displayed? Is <code>After Macro1</code> message displayed?"}, {"owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487169349, "post_id": 42249271, "comment_id": 71662123, "body": "It hasn&#39;t shown any of MsgBox&#39;, just quits with &#39;There was a problem and Microsoft Excel was closed. We apologize for the inconvenience&#39; with &#39;More Information&#39; button with the following log:  &quot; Error Signature: Exception: EXC_BAD_INSTRUCTION   and &quot;Crashed thread: 0 uncaught ObjC exception, reason: -[NSAlert runModal] may not be invoked inside of transaction commit (usually this means it was invoked inside of a view&#39;s -drawRect: method.)&quot;"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487169788, "post_id": 42249271, "comment_id": 71662461, "body": "@zafira.404 : If it didn&#39;t show any MsgBox, then the issue is coming from the <code>Worksheet_Change</code> or another event that is triggered. I&#39;d suggest that you ask another question with this detailed message, specifying that you have <a href=\"https://stackoverflow.com/questions/tagged/osx\">osx</a> and <a href=\"https://stackoverflow.com/questions/tagged/excel-vba-mac\">excel-vba-mac</a>"}, {"owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "edited": false, "score": 0, "creation_date": 1487170202, "post_id": 42249271, "comment_id": 71662792, "body": "Thank you for your help, R3uK. :)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1487161249, "creation_date": 1487161249, "answer_id": 42249271, "question_id": 42248504, "link": "https://stackoverflow.com/questions/42248504/excel-quits-on-worksheet-change-event/42249271#42249271", "title": "Excel quits on Worksheet_Change Event", "body": "<p>You'd better turn off events with <code>Application.EnableEvents = False</code> before doing so much calculation in <code>Macro1</code>.</p>\n\n<p>If this works, just comment <code>MsgBox \"Before Macro1\"</code> and <code>MsgBox \"After Macro1\"</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Me.Range(\"A1:B6\")\n\n    If Not Application.Intersect(KeyCells, Target) Is Nothing Then\n        MsgBox \"Before Macro1\"\n        Macro1\n        MsgBox \"After Macro1\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Macro1:</p>\n\n<pre><code>Sub Macro1()\n    Dim wB As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rInterestCell As Range\n    Dim rDest As Range\n\n    Set wB = ActiveWorkbook\n    Set wsData = wB.Sheets(\"Sheet1\")\n    Set wsDest = wB.Sheets(\"Formula Results\")\n\n    Application.EnableEvents = False\n\n    For Each rInterestCell In Range(\"Interest_Range\").Cells\n        wsData.Range(\"A7\").Value = rInterestCell.Value\n        wsData.Calculate\n        DoEvents\n        Set rDest = wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1)\n        If rDest.Row &lt; 6 Then Set rDest = wsDest.Range(\"A6\")\n        rDest.Value = wsData.Range(\"A6\").Value\n    Next rInterestCell\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 1175777, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/399b3c5f92dbe9a879500d1e1ff7240c?s=128&d=identicon&r=PG&f=1", "display_name": "zafira.404", "link": "https://stackoverflow.com/users/1175777/zafira-404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 42249271, "answer_count": 1, "score": 0, "last_activity_date": 1488363013, "creation_date": 1487159186, "last_edit_date": 1488363013, "question_id": 42248504, "link": "https://stackoverflow.com/questions/42248504/excel-quits-on-worksheet-change-event", "title": "Excel quits on Worksheet_Change Event", "body": "<p>Can someone please point out what's wrong with this snippet of code? Every time a value is changed in the specified range (A1:B6), Excel simply quits with Microsoft Error Reporting dialogue. <em>I am not allowed to uncheck 'Error Checking (Turn on background error checking)' in Excel Preferences.</em></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"A1:B6\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n        Call Macro1\n        MsgBox \"Test\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Macro1:</p>\n\n<pre><code>Sub Macro1()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rInterestCell As Range\n    Dim rDest As Range\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(\"Sheet1\")\n    Set wsDest = wb.Sheets(\"Formula Results\")\n\n    For Each rInterestCell In Range(\"Interest_Range\").Cells\n        wsData.Range(\"A7\").Value = rInterestCell.Value  \n        wsData.Calculate    \n        Set rDest = wsDest.Cells(wsDest.Rows.Count, \"A\").End(xlUp).Offset(1)\n        If rDest.Row &lt; 6 Then Set rDest = wsDest.Range(\"A6\")   \n        rDest.Value = wsData.Range(\"A6\").Value   \n    Next rInterestCell\n\nEnd Sub\n</code></pre>\n\n<p>Second Macro</p>\n\n<pre><code>  Sub Macro2()\nDim FLrange As Range\nSet FLrange = Range(\u201cInitial_Rate\u201d)\n\nFor Each cell In FLrange\ncell.Offset(0, 5).Formula = \"=SUM(B3/100*A7)\u201d\n\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6585677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/029a0b2c043d42d3024d00f10ab5bcd3?s=128&d=identicon&r=PG&f=1", "display_name": "h.barry", "link": "https://stackoverflow.com/users/6585677/h-barry"}, "edited": false, "score": 0, "creation_date": 1487160048, "post_id": 42248636, "comment_id": 71655655, "body": "Hello Thank you so much for this quick reply, when i ran the code an error occured: &quot;No data was selected to parse&quot;. Kindly help"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 27, "user_id": 6585677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/029a0b2c043d42d3024d00f10ab5bcd3?s=128&d=identicon&r=PG&f=1", "display_name": "h.barry", "link": "https://stackoverflow.com/users/6585677/h-barry"}, "edited": false, "score": 0, "creation_date": 1487160416, "post_id": 42248636, "comment_id": 71655893, "body": "@h.barry : try the edit! I guess that it found an empty sheet, so I&#39;ve added a test! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 27, "user_id": 6585677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/029a0b2c043d42d3024d00f10ab5bcd3?s=128&d=identicon&r=PG&f=1", "display_name": "h.barry", "link": "https://stackoverflow.com/users/6585677/h-barry"}, "edited": false, "score": 0, "creation_date": 1487166829, "post_id": 42248636, "comment_id": 71660287, "body": "@h.barry : Glad I could help! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1487160388, "last_edit_date": 1487160388, "creation_date": 1487159540, "answer_id": 42248636, "question_id": 42248455, "link": "https://stackoverflow.com/questions/42248455/text-to-column-many-excel-workbooks/42248636#42248636", "title": "text to column many excel workbooks", "body": "<p>In your code <code>Columns(\"A:A\")</code> implicitly reference <code>ActiveWorkbook.ActiveSheet.Columns(\"A:A\")</code>,<br>\nThat's why it was working on only one sheet!</p>\n\n<p>Here is the code to do it in all opened workbooks, on all sheets :</p>\n\n<p>Note that I have commented the part that deletes the column (which seems strange after putting the data there), so just uncomment it if you need! ;)</p>\n\n<pre><code>Sub sdptest()\nDim w As Workbook\nDim wS As Worksheet\n\nFor Each w In Workbooks\n    If InStr(1, LCase(w.Name), \"testmac\") Then\n    Else\n        For Each wS In w.Sheets\n            With wS.Columns(\"A:A\")\n                If Application.WorksheetFunction.CountA(.Cells) &gt; 0 Then\n                    .TextToColumns Destination:=Range(\"A1\"), _\n                                DataType:=xlDelimited, _\n                                TextQualifier:=xlDoubleQuote, _\n                                ConsecutiveDelimiter:=False, _\n                                Tab:=False, _\n                                Semicolon:=False, _\n                                Comma:=True, _\n                                Space:=False, _\n                                Other:=False, _\n                                FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n                    '.Delete Shift:=xlToLeft\n                Else\n                End If\n            End With 'wS.Columns(\"A:A\")\n        Next wS\n    End If\nNext w\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6585677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/029a0b2c043d42d3024d00f10ab5bcd3?s=128&d=identicon&r=PG&f=1", "display_name": "h.barry", "link": "https://stackoverflow.com/users/6585677/h-barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 42248636, "answer_count": 1, "score": 1, "last_activity_date": 1487160388, "creation_date": 1487159066, "last_edit_date": 1487159144, "question_id": 42248455, "link": "https://stackoverflow.com/questions/42248455/text-to-column-many-excel-workbooks", "title": "text to column many excel workbooks", "body": "<p>I would like to perform text to column on many workbooks using vba.</p>\n\n<p>I tried the below code but it's working on only one workbook while i want all of them to be modified except the \"Testmac\" wb.</p>\n\n<pre><code>Sub sdptest()\n\nDim w As Workbook\n\nFor Each w In Workbooks\nIf w.Name &lt;&gt; \"testmac\" Then\n\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n        Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 1)), TrailingMinusNumbers:=True\n    Selection.Delete Shift:=xlToLeft\n    Range(\"A1\").Select\n\nEnd If\nNext w    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1487158769, "post_id": 42247950, "comment_id": 71654799, "body": "This may also give you some ideas for further script improvements: <a href=\"http://www.excelitems.com/2010/12/optimize-vba-code-for-faster-macros.html\" rel=\"nofollow noreferrer\">excelitems.com/2010/12/optimize-vba-code-for-faster-macros.h&zwnj;&#8203;tml</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1487158029, "post_id": 42248027, "comment_id": 71654312, "body": "also, as you type them, wait for the arguments to show, the defaults will have = and the default"}, {"owner": {"reputation": 831, "user_id": 7542390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkBke.jpg?s=128&g=1", "display_name": "BenShelton", "link": "https://stackoverflow.com/users/7542390/benshelton"}, "edited": false, "score": 0, "creation_date": 1487158160, "post_id": 42248027, "comment_id": 71654415, "body": "Exactly this. Note that for methods such as find there are a lot of optional arguments but only a few have defaults. That&#39;s because VBA will either try to guess what you want or will use the last parameter you specified for these optional arguments so be careful if you start to omit them and strange things start to happen."}, {"owner": {"reputation": 55, "user_id": 4248947, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/86c8a18d0ddd322a8fa37154c1663003?s=128&d=identicon&r=PG&f=1", "display_name": "hannof", "link": "https://stackoverflow.com/users/4248947/hannof"}, "edited": false, "score": 0, "creation_date": 1487163298, "post_id": 42248027, "comment_id": 71657865, "body": "Thanks! It&#39;s true that msdn shows you the parameters, but not always the default values. For <code>Range.Find</code>, it is mentioned that <code>MatchCases</code> has a default, but for <code>SearchDirection</code> it isn&#39;t (although <code>xlNext</code> is the default). An extra Column with the default values in case there are any would in my humble opinion be quite helpful."}], "tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 4, "last_activity_date": 1487157929, "creation_date": 1487157929, "answer_id": 42248027, "question_id": 42247950, "link": "https://stackoverflow.com/questions/42247950/what-are-the-default-values-of-vba-method-parameters/42248027#42248027", "title": "What are the default values of VBA Method Parameters?", "body": "<p>MSDN is your friend. Just search for \"Range.Find\" on Google.</p>\n\n<p>For example:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff839746.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 4, "last_activity_date": 1487158579, "creation_date": 1487158579, "answer_id": 42248270, "question_id": 42247950, "link": "https://stackoverflow.com/questions/42247950/what-are-the-default-values-of-vba-method-parameters/42248270#42248270", "title": "What are the default values of VBA Method Parameters?", "body": "<p><code>Ctrl+I</code> is the shortcut, that you need, if you want to avoid going to MSDN every time.\nThis is what you get, when you select <code>Replace</code> and press <code>Ctrl+I</code>:\n<a href=\"https://i.stack.imgur.com/hPrFZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hPrFZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 55, "user_id": 4248947, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/86c8a18d0ddd322a8fa37154c1663003?s=128&d=identicon&r=PG&f=1", "display_name": "hannof", "link": "https://stackoverflow.com/users/4248947/hannof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1379, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1487158579, "creation_date": 1487157777, "question_id": 42247950, "link": "https://stackoverflow.com/questions/42247950/what-are-the-default-values-of-vba-method-parameters", "title": "What are the default values of VBA Method Parameters?", "body": "<p>I'm quite new to vba, and somehow I can't figure this one out. I'm trying to find out what the default values of vba method parameters are, because I would like to shorten my script (and not having to define it all the time).</p>\n\n<p>As an example </p>\n\n<pre><code>Sheets(ComboBox1.Value).Columns(2).Find(What:=\"Example\", _\n LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _ \n SearchDirection:=xlNext, MatchCase:=False)\n</code></pre>\n\n<p>I'm using these same parameters quite a lot in a subroutine, and would like to spare myself the hassle of writing them out every time. If they were the default values anyway I could just drop them. But I can't find what the default values for this method are anywhere.</p>\n\n<p>So I've come up with defining my own</p>\n\n<pre><code>Public Function FindVal(What As Variant, Optional After As Variant, _ \n   Optional LookIn As Variant = xlValues, Optional LookAt As Variant = _     \n   xlPart, Optional SearchOrder As Variant, Optional SearchDirection As _ \n   Variant = xlNext, Optional MatchCase As Boolean = False, Optional _ \n   MatchByte As Boolean, Optional SearchFormat As Variant)\nFindVal = Find(What=What, After=After, LookIn=LookIn, LookAt=LookAt, _ \n   SearchOrder=SearchOrder, SearchDirection=SearchDirection, _\n   MatchCase=MatchCase, MatchByte=MatchByte, SearchFormat=SearchFormat)\nEnd Function\n</code></pre>\n\n<p>But I'm sure there's an easier way, right?</p>\n\n<p>Much obliged for any help!</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1487159232, "post_id": 42247925, "comment_id": 71655114, "body": "Have you read this? <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837670.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff837670.aspx</a>"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1487160734, "post_id": 42247925, "comment_id": 71656091, "body": "You code can&#39;t work since <code>wdApp</code> is a new Word Application with a totally empty document. There cannot be a Bookmark &quot;tableplace&quot;. And <code>.Selection.GoTo what:=-1 Name:=&quot;tableplace&quot;</code> lacks a comma between the parameters. So it will not compile."}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1487161437, "post_id": 42247925, "comment_id": 71656575, "body": "@AxelRichter,  I&#39;ve left out a line where I open a template. The template has a bookmark named &quot;tablespace&quot;. I&#39;ve used the <code>.Selection.GoTo what:=-1 Name:=&quot;tableplace&quot;</code> format for copying charts to other bookmarks in the word doc and that works fine."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487195804, "post_id": 42250000, "comment_id": 71679305, "body": "it kind of works. I need to paste in 3 tables in three different locations. For the first two I get the Runtime error &#39;4605&#39;: method &#39;pasteasnestedtable&#39; of object &#39;range&#39; failed. But when I hit debug and F5 it pastes it correctly and continues on. However for the third one it says Run-time error &#39;5941&#39;: The requested member of the collection does not exist.  I have no idea hot to fix this"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487196430, "post_id": 42250000, "comment_id": 71679623, "body": "@JoshD Please post the exact line where the error happens. Sheet unknown? Cell range out of bounds? Bookmark name typo or deleted before insert? So many possibilities."}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487196642, "post_id": 42250000, "comment_id": 71679719, "body": "Ha, was just in the middle of typing. The third paste RE 5941 was my typo. Apologies. The RE 4605 occurs at the line: <code>wdDoc.Bookmarks(&quot;tablespace&quot;).Range.PasteAsNestedTable</code>"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487196838, "post_id": 42250000, "comment_id": 71679803, "body": "Alright. Bookmarks &quot;tableplace&quot;, &quot;tablespace&quot; exist? You speak of 3 paste operations. Got 3 different bookmarks? Addressing them all properly? Let&#39;s see code."}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487197039, "post_id": 42250000, "comment_id": 71679927, "body": "Yeah all good, sheets are labelled correctly, as is the range and there are three different bookmarks, i.e. &quot;tablespace2&quot; and &quot;tablespace3&quot;"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487197496, "post_id": 42250000, "comment_id": 71680163, "body": "Code or it didn&#39;t happen! :-} Plus line of error please."}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487197781, "post_id": 42250000, "comment_id": 71680305, "body": "<code>Sheets(1).Range(&quot;A1:F10&quot;).Copy Set wdDoc = wdApp.ActiveDocument wdDoc.Bookmarks(&quot;tableplace&quot;).Range.PasteAsNestedTable</code> . The error occurs on the final line for all three pastes saying Run-time error &#39;4605&#39;: method&#39;pasteasnestedtable&#39;of object&#39;range&#39;failed"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1487237690, "post_id": 42250000, "comment_id": 71696125, "body": "Please edit your post to reflect the current code situation. The error could be with any of <code>Sheet()</code>, <code>Range()</code>, or <code>Bookmarks()</code> and cannot be identified without context."}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1488104505, "post_id": 42250000, "comment_id": 72075763, "body": "SO currently I have it set as: `Dim wdApp As Word.Application"}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1488520732, "post_id": 42250000, "comment_id": 72276756, "body": "Ok now I get the RT error: 4605 This command is not available. When coping the first chart in. IE at the <code>.wdDoc. Bookmarks (......</code> row. I can&#39;t overide it like the old error. However if I drag the fellow arrow past the charts to the table it will past no problem."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1488528919, "post_id": 42250000, "comment_id": 72280658, "body": "No-brainer: a chart is not a table and can therefore not be pasted as a nested table. Paste it as something else instead: normal paste, bitmap..."}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": true, "score": 1, "last_activity_date": 1488533249, "last_edit_date": 1488533249, "creation_date": 1487163269, "answer_id": 42250000, "question_id": 42247925, "link": "https://stackoverflow.com/questions/42247925/vba-excel-nesting-data-from-excel-into-a-table-in-word-copying-excel-data-into/42250000#42250000", "title": "VBA excel nesting data from excel into a table in word (copying excel data into Word table)", "body": "<p>Don't use Selection.\nThis here works for me (Word with correct document already opened):</p>\n\n<pre><code>Dim wdApp As Word.Application\nDim wdDoc As Word.Document\n\nSet wdApp = GetObject(, \"Word.Application\")\nSheets(1).Range(\"A1:F10\").Copy\nSet wdDoc = wdApp.ActiveDocument\nwdDoc.Bookmarks(\"tableplace\").Range.PasteAsNestedTable\n</code></pre>\n\n<p>You can of course replace <code>GetObject(, \"Word.Application\")</code> with your <code>new Word.Application</code> and set wdDoc as <code>wdApp.Documents.Open(pathtoyourdoc)</code>.\nThen combine with my answer from your other thread, replace <code>wd</code>there with <code>wdDoc</code> and you should be good to go.</p>\n\n<p><strong>Edit</strong> I have changed my code to reflect your current variables and bookmark names:</p>\n\n<pre><code>Dim wdApp As Word.Application\nDim wdDoc As Word.Document\nDim tabl1 As Table, tabl2 As Table\n\nSet wdApp = New Word.Application\n\nWith wdApp\n     .Visible = True\n     .Activate\n    Set wdDoc = .Documents.Open(Location)\nEnd With\n\nCharts(\"chart1\").ChartArea.Copy\nwdDoc.Bookmarks(\"chart1\").Range.Paste\n\nSheets(\"Sheet1\").Range(\"A1:F10\").Copy\nwdDoc.Bookmarks(\"table\").Range.PasteAsNestedTable\n\n'(Continue like this for other charts + tables)\n</code></pre>\n\n<p>Note: </p>\n\n<ul>\n<li>Do not use Doument<strong>s</strong>.Add, as this will add a new <strong><em>empty</em></strong> document based on a template. This will not have your bookmarks. Use <code>.Open</code> instead.</li>\n<li>Close <code>With</code> blocks properly</li>\n<li>Do not set the same object over and over again. Set it once and work with that object</li>\n<li>Do not use <code>Selection</code> unless absolutely necessary. Not necessary in this case.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1487737491, "creation_date": 1487737491, "answer_id": 42382695, "question_id": 42247925, "link": "https://stackoverflow.com/questions/42247925/vba-excel-nesting-data-from-excel-into-a-table-in-word-copying-excel-data-into/42382695#42382695", "title": "VBA excel nesting data from excel into a table in word (copying excel data into Word table)", "body": "<p>You can set DocVariables in Word.  Google this if you don't know how to do this.  Then, run the script below, from Excel.</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\n'On Error Resume Next\n\nobjWord.ActiveDocument.variables(\"FirstName\").Value = Range(\"FirstName\").Value\nobjWord.ActiveDocument.variables(\"LastName\").Value = Range(\"LastName\").Value\nobjWord.ActiveDocument.variables(\"Another\").Value = Range(\"Another\").Value\n\n\nobjWord.ActiveDocument.Fields.Update\n\n'On Error Resume Next\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 947, "favorite_count": 0, "accepted_answer_id": 42250000, "answer_count": 2, "score": 0, "last_activity_date": 1488533249, "creation_date": 1487157704, "last_edit_date": 1488105511, "question_id": 42247925, "link": "https://stackoverflow.com/questions/42247925/vba-excel-nesting-data-from-excel-into-a-table-in-word-copying-excel-data-into", "title": "VBA excel nesting data from excel into a table in word (copying excel data into Word table)", "body": "<p>I'm trying to paste a table into word from excel with VBA Excel. </p>\n\n<p>I'm pasting it into a cell in a single column table of 4 rows I created in Word. So it is essentially a nested table. </p>\n\n<p>I keep getting, </p>\n\n<blockquote>\n  <p>Run-time error 4605: Method 'PasteAsNestedTable' of object Selection failed</p>\n</blockquote>\n\n<p>I'm trying to use PastAsNestedTable because otherwise I get the Run-time error about cells not matching as it is trying to merge the two tables. </p>\n\n<p>So I get it is saying <code>PasteAsNestedTable</code> isn't a method of selection but how do I get around this issue? </p>\n\n<p>My updated code goes:</p>\n\n<pre><code>Dim wdApp As Word.Application\nDim wdDoc as Word.Document\nDim tabl1 as Table, tabl2 as Table\nSet wdApp = new Word.Application\nWith wdApp\n     .visible = True\n     .Activate\n     .Document.Add(location)\n\nSet wdDoc=wdApp.ActiveDocument\nWith wdApp\n   Charts(\"chart1\").ChartArea.Copy\n     .Selection.GoTo what:=-1,Name:=\"chart1\"\n     .selection.Paste\n(Then add some more charts)\n\nEnd With \n\nSheets(\"Sheet1\").Range(\"A1:F10\").Copy\n    Set wdDoc=wdApp.ActiveDocument\n    wdDoc.Bookmarks(\"table\").Range.PasteAsNestedTable\n\nWith wdApp\n(Then repeat above pasting charts + tables)\n</code></pre>\n\n<p>`</p>\n\n<p>If I made the Range a <code>ListObjects</code> could I somehow copy it in that way?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1487155720, "post_id": 42247067, "comment_id": 71652663, "body": "You converted RC[-22] to I2 so you have to convert the remainder in the same way. Just follow the same principle."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487155924, "post_id": 42247067, "comment_id": 71652800, "body": "@SJR So I have to convert all the codes?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487156029, "post_id": 42247067, "comment_id": 71652878, "body": "Actually I think R3uK has done it for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1487156069, "post_id": 42247067, "comment_id": 71652904, "body": "Yep, Thanks. Got it :)"}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 1, "creation_date": 1487156263, "post_id": 42247067, "comment_id": 71653043, "body": "Since your <code>Activecell</code>is <code>AE</code>, then <code>C[-30]:C[-29]</code> means that your looking up in <code>A:B</code> columns."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487157867, "post_id": 42247067, "comment_id": 71654205, "body": "@ramedju : Btw, please don&#39;t use the tag <a href=\"https://stackoverflow.com/questions/tagged/macros\">macros</a> read the info about it, you&#39;ll that it isn&#39;t for <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a>! ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487209384, "post_id": 42247067, "comment_id": 71684024, "body": "@R3uK I&#39;m sorry. I&#39;ve accidentally clicked it :) Thanks for the heads-up."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "edited": false, "score": 0, "creation_date": 1487156257, "post_id": 42247264, "comment_id": 71653036, "body": "Thanks for your detailed answer. It makes me understand more the <code>VLookUp</code> function in Excel. :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1487156337, "post_id": 42247264, "comment_id": 71653100, "body": "@ramedju : See the edit! You didn&#39;t even have to convert your formula to use it in VBA! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487233530, "post_id": 42247264, "comment_id": 71693334, "body": "@ramedju : First, you are obviously missing a <code>.Formula</code>, then built it manually and you&#39;ll see that you need to have both the Workbook.FullName (path + name) and the name of the sheet! Try it and if it doesn&#39;t work, post a new question and then you can come back here to poke me with the link of the new question! ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "edited": false, "score": 0, "creation_date": 1487233942, "post_id": 42247264, "comment_id": 71693556, "body": "It worked but it opens an OpenFile Dialog box. But the workbook is already open, my <code>wbSLW </code> variable in my above question opens the workbook. Thanks"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487234194, "post_id": 42247264, "comment_id": 71693714, "body": "@ramedju : Like I said, construct the formula MANUALLY to see how it should be! Then use <code>wbSLW.FullName</code>! I won&#39;t comment more on that new issue in this question."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1487156302, "last_edit_date": 1487156302, "creation_date": 1487155935, "answer_id": 42247264, "question_id": 42247067, "link": "https://stackoverflow.com/questions/42247067/converting-recorded-vlookup-formula-in-r1c1-into-vba-formula-using-a1-reference/42247264#42247264", "title": "Converting Recorded VLookUp formula in R1C1 into VBA formula using A1 reference", "body": "<p>Cleaned recorded code :</p>\n\n<pre><code>With ActiveSheet.Range(\"AE2\")\n    .FormulaR1C1 = \"=VLOOKUP(RC[-22],Temp!C[-30]:C[-29],2,0)\"\n    .AutoFill Destination:=Range(\"AE2:AE182\"), Type:=xlFillDefault\nEnd With 'ActiveSheet\n</code></pre>\n\n<hr>\n\n<p><code>RC[-22]</code> refers to a cell that is 22 columns before the cell in which you have the formula<br> here <code>AE2</code> is the initial cell, so <code>RC[-22]</code>=<code>I2</code></p>\n\n<p><code>C[-30]</code> and <code>C[-29]</code>  refers respectively to columns that are 30 and 29 columns before the cell in which you have the formula<br>\nhere <code>AE2</code>, so <code>C[-30]</code>=<code>A</code> and <code>C[-29]</code>=<code>B</code></p>\n\n<p>Changed formula :</p>\n\n<pre><code>Sheets(1).Range(perNum &amp; 2).Formula = \"=VLOOKUP(I2,Temp!A:B,2,0)\"\n</code></pre>\n\n<p>or without converting the formula :</p>\n\n<pre><code>Sheets(1).Range(perNum &amp; 2).FormulaR1C1 = \"=VLOOKUP(RC[-22],Temp!C[-30]:C[-29],2,0)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487156245, "post_id": 42247321, "comment_id": 71653027, "body": "With that you&#39;ll only have the value in there and not the formula!"}], "tags": [], "owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "is_accepted": false, "score": 0, "last_activity_date": 1487156321, "last_edit_date": 1487156321, "creation_date": 1487156081, "answer_id": 42247321, "question_id": 42247067, "link": "https://stackoverflow.com/questions/42247067/converting-recorded-vlookup-formula-in-r1c1-into-vba-formula-using-a1-reference/42247321#42247321", "title": "Converting Recorded VLookUp formula in R1C1 into VBA formula using A1 reference", "body": "<p>Assuming that Active Sheet name is <code>Sheet1</code></p>\n\n<pre><code>ActiveCell.Value = Application.WorksheetFunction.VLookup(Sheets(\"Sheet1\").Range(\"I2\"), Sheets(\"Temp\").Range(\"A:B\"), 2, 0)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7541072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gUKCy.jpg?s=128&g=1", "display_name": "Teoanadech", "link": "https://stackoverflow.com/users/7541072/teoanadech"}, "is_accepted": false, "score": 2, "last_activity_date": 1487156298, "creation_date": 1487156298, "answer_id": 42247412, "question_id": 42247067, "link": "https://stackoverflow.com/questions/42247067/converting-recorded-vlookup-formula-in-r1c1-into-vba-formula-using-a1-reference/42247412#42247412", "title": "Converting Recorded VLookUp formula in R1C1 into VBA formula using A1 reference", "body": "<p>Change your settings so that it does not use R1C1 format by going to (Excel 2010)  Settings / Formulas and then unchecking the R1C1 reference style. Rerecord your macro and then edit it. You should not have any \"RC\" references, but if you do then change all references that have \"RC\" in them to the the same style as in \"I2\".</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13612152, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gib6P9Hyc8TeP6N160owXOPDBW2YkwJ61R8cW0X=k-s128", "display_name": "Rishabh Jaiswal", "link": "https://stackoverflow.com/users/13612152/rishabh-jaiswal"}, "is_accepted": false, "score": 0, "last_activity_date": 1590410991, "last_edit_date": 1590410991, "creation_date": 1590396913, "answer_id": 61998989, "question_id": 42247067, "link": "https://stackoverflow.com/questions/42247067/converting-recorded-vlookup-formula-in-r1c1-into-vba-formula-using-a1-reference/61998989#61998989", "title": "Converting Recorded VLookUp formula in R1C1 into VBA formula using A1 reference", "body": "<p>If i understood correctly, you want to replace name of the workbook in below line in <code>vba</code> code :</p>\n\n<pre><code>=VLOOKUP(RC[-22],'[**test.xlsx**]Sheet3'!C5:C6,2,0)\n</code></pre>\n\n<p>Simplest way to do that without changing any other code is : </p>\n\n<pre><code>=VLOOKUP(RC[-22],'[**\" &amp; wbSLW.Name &amp; \"**]Sheet3'!C5:C6,2,0)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13623, "favorite_count": 0, "accepted_answer_id": 42247264, "answer_count": 4, "score": 0, "last_activity_date": 1594189175, "creation_date": 1487155365, "last_edit_date": 1594189175, "question_id": 42247067, "link": "https://stackoverflow.com/questions/42247067/converting-recorded-vlookup-formula-in-r1c1-into-vba-formula-using-a1-reference", "title": "Converting Recorded VLookUp formula in R1C1 into VBA formula using A1 reference", "body": "<p>I have this recorded macro that I want to convert to plain VBA macro code and copy the formula from <code>AE2</code> to lastrow.</p>\n\n<pre><code>\"=VLOOKUP(RC[-22],'[test.xlsx]Sheet3'!C5:C6,2,0)\" ' this is from another workbook\n</code></pre>\n\n<p>Trying to convert to VBA.</p>\n\n<pre><code>dim wbSLW as workbook\ndim wbSLWDir as String\n\nwbSLWDir = \"C\\Documents\\test.xlsx\" 'this is not the constant directory or file name\nset wbSLW  = workbooks.open(wbSLWDir)\n\nThisWorkbook.Activate\nWith Thisworkbook.Sheets(1)\n   .Range(\"AE2\") = \"=VLOOKUP(I2,\" &amp; wbSLW &amp; \"!E:F,2,0)\" ' error line\nend with\n</code></pre>\n\n<p>When I've converted it, it returns <code>Object does not support this property or method</code>.</p>\n"}, {"tags": ["ms-access", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1487157103, "post_id": 42247010, "comment_id": 71653662, "body": "can you change  &quot;  &#39;  &quot;  to &quot;&#39;&quot; ? e.g without the space."}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1487157131, "post_id": 42247010, "comment_id": 71653684, "body": "The statement <code>&quot;Within10 = &#39;&quot; &amp; Me.cboSite.Value &amp; &quot; &#39; &quot;</code> will add a blank space after the value, because of <code>&quot; &#39; &quot;</code>, if the value of <code>Me.cboSite.Value</code> is <code>&quot;foo&quot;</code>, it will become <code>&quot;foo &quot;</code>. I think you should remove the spaces here (<code>&quot;&#39;&quot;</code>)"}, {"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1487157525, "post_id": 42247010, "comment_id": 71653968, "body": "Plus, your <code>DateDiff(&quot;hm&quot;, 0, 8, [Date Fault Lodged])</code> doesn&#39;t seem like a valid syntax for me. I don&#39;t know much about <code>access-vba</code>, only worked with <code>excel-vba</code> so I might be wrong here, but I think you cannot use <code>&quot;hm&quot;</code> as interval, plus <code>[Date Fault Lodged]</code> doesn&#39;t seem like a valid argument."}, {"owner": {"reputation": 3, "user_id": 7568171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9187be4c5129d03034367e78db930fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Joy Mani", "link": "https://stackoverflow.com/users/7568171/joy-mani"}, "edited": false, "score": 0, "creation_date": 1487279946, "post_id": 42247010, "comment_id": 71726361, "body": "yes thanks for pointing that out i was an error should have been &quot;n&quot; instead of m i have a few changes and edited it into my post"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7568171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9187be4c5129d03034367e78db930fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Joy Mani", "link": "https://stackoverflow.com/users/7568171/joy-mani"}, "edited": false, "score": 0, "creation_date": 1487278375, "post_id": 42248459, "comment_id": 71725457, "body": "seems i have my code wrong what i am trying to achieve is to check if the value in Me.cboSite is in the column Within 10 in the Table"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1487161473, "last_edit_date": 1487161473, "creation_date": 1487159074, "answer_id": 42248459, "question_id": 42247010, "link": "https://stackoverflow.com/questions/42247010/run-time-error-3464-mismatch-in-crietria-expression/42248459#42248459", "title": "run time error 3464 mismatch in crietria expression", "body": "<p>Regardless of what you want to display in <code>txtRTF</code>, the current <code>type mismatch</code> error is in the <code>IF</code> statement: you are checking a <code>Variant/String</code>, which is not a Boolean. What you want is to check if the result of the lookup is empty:</p>\n\n<pre><code>If DLookup(\"[Within10]\", \"SLA\", \"[Within10] = '\" &amp; Me.cboSite.Value &amp; \"'\") &lt;&gt; Empty Then\n    Me.txtRTF.Value = \"...\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7568171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9187be4c5129d03034367e78db930fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Joy Mani", "link": "https://stackoverflow.com/users/7568171/joy-mani"}, "edited": false, "score": 0, "creation_date": 1487278525, "post_id": 42250094, "comment_id": 71725555, "body": "I fairly new on Access and i was trying to experiment with equations i will be using this instead  Me.txtRTF = DateAdd(&quot;h&quot;, 2, [Date Fault Lodged])"}, {"owner": {"reputation": 3, "user_id": 7568171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9187be4c5129d03034367e78db930fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Joy Mani", "link": "https://stackoverflow.com/users/7568171/joy-mani"}, "edited": false, "score": 0, "creation_date": 1487279228, "post_id": 42250094, "comment_id": 71725968, "body": "I am fairly new on Access and i was trying to experiment with equations Diff2dates(&quot;hn&quot;, 0, 8, [Date Fault Lodged]) i just changed the diff2dates with the datediff statement the 8 in this case is adding 8 hours instead it equated  days, so changed the 8 to (0.334) the reason i put a 0 was because without the zero i was getting a result of over a million hours however i will be using this instead after i can correct my if statement Me.txtRTF = DateAdd(&quot;h&quot;, 2, [Date Fault Lodged])"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 7568171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9187be4c5129d03034367e78db930fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Joy Mani", "link": "https://stackoverflow.com/users/7568171/joy-mani"}, "edited": false, "score": 0, "creation_date": 1487318831, "post_id": 42250094, "comment_id": 71740533, "body": "There is no <i>Diff2Dates</i> function in VBA."}, {"owner": {"reputation": 3, "user_id": 7568171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9187be4c5129d03034367e78db930fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Joy Mani", "link": "https://stackoverflow.com/users/7568171/joy-mani"}, "edited": false, "score": 0, "creation_date": 1487542372, "post_id": 42250094, "comment_id": 71819424, "body": "yes there isnt it was i was provided a module code that used diff2dates however for the purpose of the current equation i will be using dateadd"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1487163531, "creation_date": 1487163531, "answer_id": 42250094, "question_id": 42247010, "link": "https://stackoverflow.com/questions/42247010/run-time-error-3464-mismatch-in-crietria-expression/42250094#42250094", "title": "run time error 3464 mismatch in crietria expression", "body": "<p>Check for <em>Null</em>:</p>\n\n<pre><code>Private Sub txtRTF_Click()\n\n    If Not IsNull(DLookup(\"Within10\", \"SLA\", \"Within10 = '\" &amp; Me.cboSite.Value &amp; \"'\")) Then\n        Me.txtRTF = \"Something\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Your: </p>\n\n<pre><code>DateDiff(\"hm\", 0, 8, [Date Fault Lodged])\n</code></pre>\n\n<p>doesn't make sense at all, so read up on the syntax; it is not to guess what you are trying to do with this.</p>\n"}], "owner": {"reputation": 3, "user_id": 7568171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9187be4c5129d03034367e78db930fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Joy Mani", "link": "https://stackoverflow.com/users/7568171/joy-mani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594640450, "creation_date": 1487155196, "last_edit_date": 1594640450, "question_id": 42247010, "link": "https://stackoverflow.com/questions/42247010/run-time-error-3464-mismatch-in-crietria-expression", "title": "run time error 3464 mismatch in crietria expression", "body": "<p>I am trying to verify if a site selected from a cascading combobox (named cboSite) matches any of the various site names in the column \"within 10\" in the table named SLA. if so i want it to calculate a function i have come up with the code. The first bit of the expression is executed however if i choose a site that is not in the within 10 column in SLA then my elseif statement is not excuted. </p>\n\n<pre><code>Private Sub txtRTF_Click()\nIf Not ISNull (DLookup(\"Within10\", \"SLA\", \"Within10 = '\" &amp; Me.cboSite.Value &amp; \" '\")) Then\nMe.txtRTF = DateAdd(\"h\", 2, [Date Fault Lodged])\nElseIf Not ISNull (DLookup(\"10_50\", \"SLA\", \"10_50 = '\" &amp; Me.cboSite.Value &amp; \" ' \")) Then\nMe.txtRTF = DateAdd(\"h\", 4, [Date Fault Lodged])\nElseIf Not ISNull (DLookup(\"50_80\", \"SLA\", \"50_80 = '\" &amp; Me.cboSite.Value &amp; \" ' \")) Then\nMe.txtRTF = DateAdd(\"h\", 8, [Date Fault Lodged])\nElseIf Not ISNull (DLookup(\"80_100\", \"SLA\", \"80_100 = '\" &amp; Me.cboSite.Value &amp; \" ' \")) Then\nMe.txtRTF = DateAdd(\"d\", 2, [Date Fault Lodged])\nElseIf Not ISNull (DLookup(\"Over100\", \"SLA\", \"Over100 = '\" &amp; Me.cboSite.Value &amp; \" ' \")) Then\nMe.txtRTF = DateAdd(\"d\", 10, [Date Fault Lodged])\nEnd If\nEnd Sub\n</code></pre>\n\n<p>What i am trying to achieve is very similar to when creating login access in ms access. when someone enters the username and password it checks in the table to see if the username and password are correct then allow use of forms etc.</p>\n\n<p>I am not trying to check if the value is Null or empty or incorrect. I am trying to verify that the value selected is in the table SLA in the column Within10 if so execute <code>Me.txtRTF = DateAdd(\"h\", 2, [Date Fault Lodged])</code>or else check in the next column in the table SLA.</p>\n"}, {"tags": ["excel", "vba", "shortcut"], "comments": [{"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 0, "creation_date": 1487157707, "post_id": 42246989, "comment_id": 71654094, "body": "Are you trying to create a shortcut file that could be on the user&#39;s desktop or do you want a hyperlink that will open a file by clicking on a cell?"}, {"owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "edited": false, "score": 0, "creation_date": 1487158073, "post_id": 42246989, "comment_id": 71654350, "body": "You&#39;ll find the code to craete a windows shortcut here <a href=\"http://stackoverflow.com/questions/12711040/create-a-shortcut-to-current-folder-on-users-desktop\" title=\"create a shortcut to current folder on users desktop\">stackoverflow.com/questions/12711040/&hellip;</a> Now all you need is to lookup the code to loop through a range of cells in excel."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1487161119, "creation_date": 1487161119, "answer_id": 42249214, "question_id": 42246989, "link": "https://stackoverflow.com/questions/42246989/how-to-create-shorts-in-windows-using-spreadsheet-input/42249214#42249214", "title": "How to Create Shorts in Windows , using spreadsheet input", "body": "<p>Assuming your paths are in column <code>A</code> and the file names in column <code>B</code>, you can type this formula in cell <code>C1</code> and copy/paste it in all cells of the column. Formula for <code>C1</code>:</p>\n\n<pre><code>=HYPERLINK(A1 &amp; \"\\\" &amp; B1)\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 4469722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/800779453/picture?type=large", "display_name": "Jack Walker", "link": "https://stackoverflow.com/users/4469722/jack-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1503297985, "creation_date": 1487155128, "last_edit_date": 1503297985, "question_id": 42246989, "link": "https://stackoverflow.com/questions/42246989/how-to-create-shorts-in-windows-using-spreadsheet-input", "title": "How to Create Shorts in Windows , using spreadsheet input", "body": "<p>I like to create some short cuts in windows. The short cuts are going to link to a file saved in a directory somewhere.</p>\n\n<p>In Excel I have a list of file path and in the next column contains the name I like to call the link. I was wondering if anyone could point me to an example of this </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487155636, "post_id": 42246931, "comment_id": 71652597, "body": "Might be that there isn&#39;t enough time between the two line when run normally, try to add <code>DoEvents</code> just before <code>popup.Click</code>"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487155967, "post_id": 42246931, "comment_id": 71652828, "body": "@R3uK Sir, I have Tried the same.I add the code <b>Do While appIE.Busy Or appIE.readyState &lt;&gt; 4 :DoEvents:Loop</b> code but still the error not get rectified."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487156628, "post_id": 42246931, "comment_id": 71653317, "body": "Yeah I saw that you used it there (there, it is used to wait for the page to load), but I&#39;m suggesting that you <b>add it in between <code>Set popup = ap...</code> and <code>popup.Click</code>.</b>"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487159262, "post_id": 42246931, "comment_id": 71655135, "body": "@R3uK Sir, I have tried that as well Sir but I got same error.am I supposed to define different variable for popup other the <b>Dim popup As Object</b>"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1487160937, "creation_date": 1487160937, "answer_id": 42249156, "question_id": 42246931, "link": "https://stackoverflow.com/questions/42246931/run-time-error-91-object-variable-or-with-block-variable-not-set-while-url-da/42249156#42249156", "title": "Run Time Error &#39;91&#39;: Object variable or With block variable not set while URL data Scripting in VBA", "body": "<p>Try this and let me know if you have the MsgBox or if it works :</p>\n\n<pre><code>Sub GoToWebsiteTest()\n    Dim appIE As InternetExplorerMedium\n    Dim tags As Object\n    Dim tagx As Object\n    Dim repo As Object\n    Dim popup As Object\n    Dim Element As HTMLButtonElement\n    Dim MyHTML_Element As IHTMLElement\n    Dim HTMLdoc As HTMLDocument\n\n    i = 0\n    Set appIE = New InternetExplorerMedium\n    sURL = \"https://oneview.myurl.in/\"\n    With appIE\n        .navigate sURL\n        .Visible = True\n    End With\n\n    Do While appIE.Busy Or appIE.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n    appIE.document.getElementById(\"Username\").Value = \"xxx\"\n    appIE.document.getElementById(\"Password\").Value = \"xxxx\"\n\n    i = InputBox(\"type\")\n\n    appIE.document.getElementById(\"txtcaptcha\").Value = i\n\n    Set tags = appIE.document.getElementsByTagName(\"input\")\n\n    For Each tagx In tags\n    If tagx.Type = \"submit\" Then\n       tagx.Click\n    End If\n    Next\n\n    Do While appIE.Busy Or appIE.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n\n\n    Set popup = appIE.document.getElementById(\"ctl00_MainContent_gridUser_ctl00_ctl04_lnkG2\")\n\n    DoEvents\n    If Not popup Is Nothing Then\n        popup.Click\n    Else\n        MsgBox \"popup is not defined!\", vbOKOnly + vbCritical\n    End If\n\n    '''rest of your code\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "is_accepted": false, "score": 0, "last_activity_date": 1487220173, "creation_date": 1487220173, "answer_id": 42265143, "question_id": 42246931, "link": "https://stackoverflow.com/questions/42246931/run-time-error-91-object-variable-or-with-block-variable-not-set-while-url-da/42265143#42265143", "title": "Run Time Error &#39;91&#39;: Object variable or With block variable not set while URL data Scripting in VBA", "body": "<p>I have noticed the issue with <strong>Do event</strong> So I have change the same and tried this below code which is working fine.</p>\n\n<pre><code>Sub GoToWebsiteTest()\nDim appIE As InternetExplorerMedium\nDim tags As Object\nDim tagx As Object\nDim repo As Object\n\nDim Element As HTMLButtonElement\nDim MyHTML_Element As IHTMLElement\nDim HTMLdoc As HTMLDocument\n\ni = 0\nSet appIE = New InternetExplorerMedium\nsURL = \"https://oneview.myurl.in/\"\nWith appIE\n    .navigate sURL\n    .Visible = True\nEnd With\n\nDo While appIE.Busy Or appIE.readyState &lt;&gt; 4\n    DoEvents\nLoop\n\nappIE.document.getElementById(\"Username\").Value = \"xxx\"\nappIE.document.getElementById(\"Password\").Value = \"xxxx\"\n\ni = InputBox(\"type\")\n\nappIE.document.getElementById(\"txtcaptcha\").Value = i\n\nSet tags = appIE.document.getElementsByTagName(\"input\")\n\nFor Each tagx In tags\nIf tagx.Type = \"submit\" Then\n   tagx.Click\nEnd If\nNext\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\nDim popup As Object\nSet popup = appIE.document.getElementById(\"ctl00_MainContent_gridUser_ctl00_ctl04_lnkG2\")\n\npopup.Click \n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1487220173, "creation_date": 1487154997, "last_edit_date": 1487155544, "question_id": 42246931, "link": "https://stackoverflow.com/questions/42246931/run-time-error-91-object-variable-or-with-block-variable-not-set-while-url-da", "title": "Run Time Error &#39;91&#39;: Object variable or With block variable not set while URL data Scripting in VBA", "body": "<p>I am getting </p>\n\n<blockquote>\n  <p>Run Time Error '91': Object variable or With block variable not set </p>\n</blockquote>\n\n<p>while URL data Scripting </p>\n\n<p>I am getting this error at the end of my code where I supposed to execute my code i.e. popup.click. </p>\n\n<p>One thing I noticed if I run this below code step by step with the help of <kbd>F8</kbd> i was not facing such error but I am facing this error if I execute the code with the help of <strong>Run Button</strong>.</p>\n\n<p>One More thing I just want to mention that when I execute the code with <strong>Run Button</strong> popup value shows nothing as i check.</p>\n\n<pre><code>        Sub GoToWebsiteTest()\n        Dim appIE As InternetExplorerMedium\n        Dim tags As Object\n        Dim tagx As Object\n        Dim repo As Object\n        Dim popup As Object\n        Dim Element As HTMLButtonElement\n        Dim MyHTML_Element As IHTMLElement\n        Dim HTMLdoc As HTMLDocument\n\n        i = 0\n        Set appIE = New InternetExplorerMedium\n        sURL = \"https://oneview.myurl.in/\"\n        With appIE\n            .navigate sURL\n            .Visible = True\n        End With\n\n        Do While appIE.Busy Or appIE.readyState &lt;&gt; 4\n            DoEvents\n        Loop\n\n        appIE.document.getElementById(\"Username\").Value = \"xxx\"\n        appIE.document.getElementById(\"Password\").Value = \"xxxx\"\n\n        i = InputBox(\"type\")\n\n        appIE.document.getElementById(\"txtcaptcha\").Value = i\n\n        Set tags = appIE.document.getElementsByTagName(\"input\")\n\n        For Each tagx In tags\n        If tagx.Type = \"submit\" Then\n           tagx.Click\n        End If\n        Next\n\n        Do While appIE.Busy Or appIE.readyState &lt;&gt; 4\n            DoEvents\n        Loop\n\n        Set popup = appIE.document.getElementById(\"ctl00_MainContent_gridUser_ctl00_ctl04_lnkG2\")\n\n' Here I am getting Object variable or With block variable not set error\n\n    popup.Click \n</code></pre>\n"}, {"tags": ["vba", "vsto", "ms-word", "ole"], "answers": [{"comments": [{"owner": {"reputation": 28755, "user_id": 303685, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/uXNpf.jpg?s=128&g=1", "display_name": "Water Cooler v2", "link": "https://stackoverflow.com/users/303685/water-cooler-v2"}, "edited": false, "score": 0, "creation_date": 1487159214, "post_id": 42248072, "comment_id": 71655101, "body": "I understand that. The thing is: saving a file, for example, is one atomic operation as per the current synchronous API. It is done via a call to the <code>Document.SaveAs</code> method. I do not see how I can turn it into an asynchronous call. The only thing I can do is queue the saving of the file on the task pool, which, anyways, is a bad idea since it is an I/O bound / threadless operation. I was wondering if there was an async API with cancellation tokens and progress and all, I could take finer grained control over the file saving operation."}], "tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1487158047, "creation_date": 1487158047, "answer_id": 42248072, "question_id": 42246574, "link": "https://stackoverflow.com/questions/42246574/is-there-an-async-api-for-ms-office-vba-word-object-model/42248072#42248072", "title": "Is there an async API for MS Office /VBA Word object model?", "body": "<p>You can only do one thing at a time per Word.Application via Interop, but depending on your scenario, you can use several application objects and the multithreading capabilities of .NET</p>\n"}], "owner": {"reputation": 28755, "user_id": 303685, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/uXNpf.jpg?s=128&g=1", "display_name": "Water Cooler v2", "link": "https://stackoverflow.com/users/303685/water-cooler-v2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487158047, "creation_date": 1487154099, "question_id": 42246574, "link": "https://stackoverflow.com/questions/42246574/is-there-an-async-api-for-ms-office-vba-word-object-model", "title": "Is there an async API for MS Office /VBA Word object model?", "body": "<p>I'd like to export a Word document to an HTML file. There are methods (<code>SaveAs</code> and <code>ExportAsFixedFormat</code>) on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822963.aspx\" rel=\"nofollow noreferrer\">Document object</a> in the Microsoft Word object model to do that but they are all synchronous API.</p>\n\n<p>I can't find an <code>async</code> version for the Word API. Is there one?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1487154902, "last_edit_date": 1487154902, "creation_date": 1487154577, "answer_id": 42246760, "question_id": 42246446, "link": "https://stackoverflow.com/questions/42246446/not-repeating-vba-code/42246760#42246760", "title": "Not repeating VBA code", "body": "<p>Try to do something like this:</p>\n\n<pre><code>dim wks     as worksheet\n\nset wks = ActiveWorkbook.Worksheets(\"Sheet1\")\nWith wks\n\n    call LoopMe(\"Block\", wks)\n    .Range(Cells(2, intBB), Cells(LastRow, intBB)).Value = BlockBox.Value\n\n    call LoopMe(\"HPL\", wks)\n    .Range(Cells(2, intBB), Cells(LastRow, intBB)).Value = HPLBox.Value\n\nEnd with \n\n\n\nPublic Sub LoopMe(strString as string, wks as worksheet)\n\n    dim intBB as long : intBB = 1\n\n    with wks\n        Do While .Cells(1, intBB) &lt;&gt; \"\"\n        If .Cells(1, intBB).Value = \"Block\" Then\n            Set rngBB = .Range(.Cells(1, intBB), .Cells(1, intBB))\n             Exit Do\n        End If\n          intBB = intBB + 1\n        Loop\n    end with\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487155122, "post_id": 42246914, "comment_id": 71652221, "body": "Good for referring the controls in an array and reading them from there! :) I was too lazy to do it :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1487155235, "post_id": 42246914, "comment_id": 71652312, "body": "@Vityata - thanks, I know that feeling! If the controls are all just the search term + &#39;Box&#39; then can dispense with second array but didn&#39;t want to assume."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 5, "last_activity_date": 1487154957, "creation_date": 1487154957, "answer_id": 42246914, "question_id": 42246446, "link": "https://stackoverflow.com/questions/42246446/not-repeating-vba-code/42246914#42246914", "title": "Not repeating VBA code", "body": "<p>Maybe this? Adjust w1 and w2 accordingly.</p>\n\n<pre><code>Sub x()\n\nDim rngBB As Range\nDim v, w1, w2, i As Long\n\nw1 = Array(\"Block\", \"HPL\")\nw2 = Array(\"Blockbox\", \"HPLBox\")\n\nFor i = LBound(w1) To UBound(w1)\n    With ActiveWorkbook.Worksheets(\"Sheet1\")\n        v = Application.Match(w1(i), .Rows(1), 0)\n        If IsNumeric(v) Then\n            Set rngBB = .Cells(1, v)\n            .Range(.Cells(2, v), .Cells(LastRow, v)).Value = Me.Controls(w2(i)).Value\n        End If\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 2, "last_activity_date": 1487155094, "creation_date": 1487155094, "answer_id": 42246971, "question_id": 42246446, "link": "https://stackoverflow.com/questions/42246446/not-repeating-vba-code/42246971#42246971", "title": "Not repeating VBA code", "body": "<p>Here is how to do it properly, by refactoring your code so that it's reusable easily :</p>\n\n<pre><code>Sub test_tombata()\n    Dim wSh As Worksheet\n    Set wSh = ActiveWorkbook.Sheets(\"Sheet1\")\n\n    Fill_Column_From_Header wSh, \"Block\", BlockBox.Value\n    Fill_Column_From_Header wSh, \"HPL\", HPLBox.Value\nEnd Sub\n</code></pre>\n\n<p>Using a sub to fill the column with the value :</p>\n\n<pre><code>Sub Fill_Column_From_Header(wS As Worksheet, HeaderName As String, ValueToFill As String)\n    Dim LastRow As Double\n    With wS\n        LastRow = .Cells(.Rows.Count, intBB).End(xlUp).Row\n        wSh.Range(Cells(2, intBB), Cells(LastRow, intBB)).Value = ValueToFill\n    End With 'wS\nEnd Sub\n</code></pre>\n\n<p>Which use a function that gives you the column number from the Header Name :</p>\n\n<pre><code>Function Get_Column_From_Header(wS As Worksheet, HeaderName As String) As Integer\n    Dim intBB As Integer\n    intBB = 1\n    Get_Column_From_Header = 0\n    With wS\n        Do While .Cells(1, intBB) &lt;&gt; \"\"\n            If .Cells(1, intBB).Value &lt;&gt; HeaderName Then\n            Else\n                Get_Column_From_Header = intBB\n                Exit Function\n            End If\n            intBB = intBB + 1\n        Loop\n    End With 'wS\nEnd Function\n</code></pre>\n\n<p>I'd only add that if this code is in a regular module, you'd have to use :<br>\n<code>USERFORMNAME.BlockBox.Value</code> instead of just <code>BlockBox.Value</code></p>\n"}], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 42246914, "answer_count": 3, "score": 2, "last_activity_date": 1487155094, "creation_date": 1487153756, "last_edit_date": 1487154351, "question_id": 42246446, "link": "https://stackoverflow.com/questions/42246446/not-repeating-vba-code", "title": "Not repeating VBA code", "body": "<p>I have a VBA code, which is connected to a userform</p>\n\n<p>The code searches the column headlines and fills in the columns with these headlines by taking the values from the userform</p>\n\n<p>My question is: How can I avoid the repetition of the code? </p>\n\n<pre><code>Dim intBB As Integer\nDim rngBB As Range\n\nintBB = 1\n\nDo While ActiveWorkbook.Worksheets(\"Sheet1\").Cells(1, intBB) &lt;&gt; \"\"\n        If ActiveWorkbook.Worksheets(\"Sheet1\").Cells(1, intBB).Value = \"Block\" Then\n            With ActiveWorkbook.Worksheets(\"Sheet1\")\n                Set rngBB = .Range(.Cells(1, intBB), .Cells(1, intBB))\n\n             End With\n         Exit Do\n\n        End If\n          intBB = intBB + 1\n    Loop\n\nActiveWorkbook.Worksheets(\"Sheet1\").Range(Cells(2, intBB), Cells(LastRow, intBB)).Value = BlockBox.Value\n\nintBB = 1\n\nDo While ActiveWorkbook.Worksheets(\"Sheet1\").Cells(1, intBB) &lt;&gt; \"\"\n        If ActiveWorkbook.Worksheets(\"Sheet1\").Cells(1, intBB).Value = \"HPL\" Then\n            With ActiveWorkbook.Worksheets(\"Sheet1\")\n                Set rngBB = .Range(.Cells(1, intBB), .Cells(1, intBB))\n\n             End With\n         Exit Do\n\n        End If\n          intBB = intBB + 1\n    Loop\n\nActiveWorkbook.Worksheets(\"Sheet1\").Range(Cells(2, intBB), Cells(LastRow, intBB)).Value = HPLBox.Value\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3456401, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/832776998ff800ced60d048787c63d65?s=128&d=identicon&r=PG&f=1", "display_name": "user3456401", "link": "https://stackoverflow.com/users/3456401/user3456401"}, "edited": false, "score": 0, "creation_date": 1487156696, "post_id": 42247235, "comment_id": 71653367, "body": "Hi, Thanks for the suggestion however I cannot use this solution as the data is not always in the same format. There may be different types of record in the file which I need to account for. i.e.   <code>Record115022017ABCDRecord216022017DCBARecord315022017ABCD230&zwnj;&#8203;42016</code>  Where the third record contains an extra value. There is also no defined structure on which record will come after another. I was hoping there is some way to open the file again starting at a specific character"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 71, "user_id": 3456401, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/832776998ff800ced60d048787c63d65?s=128&d=identicon&r=PG&f=1", "display_name": "user3456401", "link": "https://stackoverflow.com/users/3456401/user3456401"}, "edited": false, "score": 0, "creation_date": 1487157695, "post_id": 42247235, "comment_id": 71654085, "body": "There is. Read it as binary and not line by line. But that is only useful if you know how many bytes (characters) you want to read. So your only option is to read line by line and then parse these to split them into multiple records."}, {"owner": {"reputation": 71, "user_id": 3456401, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/832776998ff800ced60d048787c63d65?s=128&d=identicon&r=PG&f=1", "display_name": "user3456401", "link": "https://stackoverflow.com/users/3456401/user3456401"}, "edited": false, "score": 0, "creation_date": 1487253513, "post_id": 42247235, "comment_id": 71708085, "body": "Hi @Gustav I managed to get it working using a binary read of the file using the Seek command.   I could have explained better the contents of the file but I have got a solution thanks to your suggestion above.  Basically there are a number of different record types in the file however each record type has a defined length. I was able to use an IF statement to check the first two characters(which define the record type) and a new variable j which I increment by the record length to successfully read the file.  Many thanks"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 71, "user_id": 3456401, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/832776998ff800ced60d048787c63d65?s=128&d=identicon&r=PG&f=1", "display_name": "user3456401", "link": "https://stackoverflow.com/users/3456401/user3456401"}, "edited": false, "score": 0, "creation_date": 1487259269, "post_id": 42247235, "comment_id": 71712720, "body": "Great! Thanks for the feedback."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1487155825, "creation_date": 1487155825, "answer_id": 42247235, "question_id": 42246222, "link": "https://stackoverflow.com/questions/42246222/custom-skipline-whilst-reading-a-file-vba/42247235#42247235", "title": "Custom SkipLine whilst reading a file vba", "body": "<p>You can split the line into two using Mid:</p>\n\n<pre><code>s = \"Record115022017ABCDRecord216022017DCBA\"\nl1 = \"Line\" &amp; Str(i) &amp; \": \" &amp; Mid(s, 1, 6) &amp; \" \" &amp; Mid(s, 7, 1) &amp; \" \" &amp; Mid(s, 8, 8) &amp; \" \" &amp; Mid(s, 16, 4) \nl2 = \"Line\" &amp; Str(i + 1) &amp; \": \" &amp; Mid(s, 20, 6) &amp; \" \" &amp; Mid(s, 26, 1) &amp; \" \" &amp; Mid(s, 27, 8) &amp; \" \" &amp; Mid(s, 35, 4)\n</code></pre>\n\n<p>which will output two lines:</p>\n\n<pre><code>Line 0: Record 1 15022017 ABCD\nLine 1: Record 2 16022017 DCBA\n</code></pre>\n\n<p>Adjust your loop to let i Step 2.</p>\n"}], "owner": {"reputation": 71, "user_id": 3456401, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/832776998ff800ced60d048787c63d65?s=128&d=identicon&r=PG&f=1", "display_name": "user3456401", "link": "https://stackoverflow.com/users/3456401/user3456401"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 42247235, "answer_count": 1, "score": 0, "last_activity_date": 1487155825, "creation_date": 1487153190, "last_edit_date": 1487153327, "question_id": 42246222, "link": "https://stackoverflow.com/questions/42246222/custom-skipline-whilst-reading-a-file-vba", "title": "Custom SkipLine whilst reading a file vba", "body": "<p>I have written some vba code to read in a text file however there are no carriage returns or tab's to delimit the file I am reading. </p>\n\n<p>I am using MS Access and inserting each line of the file into my database which works when I manually put a carriage return in my text file however when the data is received it is not in this required format.</p>\n\n<p>For Instance the data is currently like</p>\n\n<pre><code>Record115022017ABCDRecord216022017DCBA\n</code></pre>\n\n<p>I want the data to be :</p>\n\n<ul>\n<li>Line 1 : Record1 15022017 ABCD </li>\n<li>Line 2 : Record2 16022017 DCBA </li>\n</ul>\n\n<p>Code :</p>\n\n<pre><code>Dim file As String\n\nfile = (\"C:\\data.txt\")\n\nOpen file For Input As #1\n\ni = 1\n\nWhile EOF(1) = False\n\nLine Input #1, strLine\n\n\nDATABASE INSERT STATEMENT\n\n**Start reading New Line of File**\n\ni = i + 1\n\n\nWend\nClose #1\n</code></pre>\n\n<p>So I just need help to replace the text <strong>Start reading New Line of File</strong> with valid code. Any help is much appreciated</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1487154047, "post_id": 42246456, "comment_id": 71651362, "body": "This isn&#39;t what the OP asked for, it will fill all blank cells with a pre set value, not with the correct value for that ID."}, {"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487154329, "post_id": 42246456, "comment_id": 71651553, "body": "Yes, this is not actually what I have asked for."}, {"owner": {"reputation": 36, "user_id": 7434314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d32b3ce9b9ec749b6997288494a259?s=128&d=identicon&r=PG&f=1", "display_name": "Artemi A.", "link": "https://stackoverflow.com/users/7434314/artemi-a"}, "edited": false, "score": 0, "creation_date": 1487155282, "post_id": 42246456, "comment_id": 71652354, "body": "oh, you mean, that if ID7777 has value &quot;1&quot; in third row for example, all other rows with ID7777 must have value &quot;1&quot;? There s no problem, if you use vba, but there one question for optimization issue: Is all same IDs sorted and arranged one by one?"}, {"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487155667, "post_id": 42246456, "comment_id": 71652618, "body": "@ArtemiA. Yes, that&#39;s what I meant. As you said, this only value has to be copied in other rows with the same ID. And yes the are sorted and arranged one by one."}, {"owner": {"reputation": 36, "user_id": 7434314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d32b3ce9b9ec749b6997288494a259?s=128&d=identicon&r=PG&f=1", "display_name": "Artemi A.", "link": "https://stackoverflow.com/users/7434314/artemi-a"}, "edited": false, "score": 0, "creation_date": 1487159162, "post_id": 42246456, "comment_id": 71655069, "body": "Edited my answer. That will works, if you have problems with speed of alghoritm, use arrays instead of cells"}], "tags": [], "owner": {"reputation": 36, "user_id": 7434314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d32b3ce9b9ec749b6997288494a259?s=128&d=identicon&r=PG&f=1", "display_name": "Artemi A.", "link": "https://stackoverflow.com/users/7434314/artemi-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1487159138, "last_edit_date": 1487159138, "creation_date": 1487153793, "answer_id": 42246456, "question_id": 42246219, "link": "https://stackoverflow.com/questions/42246219/how-to-fill-up-empty-lines-in-excel-table-with-one-existing-value/42246456#42246456", "title": "How to fill up empty lines in Excel Table with one existing value?", "body": "<pre><code>Sub fillerv2()\nrowscnt = 1000\ntmi = 1\ntm = \"\"\nFor i = 1 To rowscnt\nIf tm &lt;&gt; Cells(i, 1).Value Then\n    For o = tmi To i - 1\n        If IsEmpty(Cells(o, 2).Value) = False Then\n            Pattern = Cells(o, 2).Value\n            Exit For\n        End If\n    Next o\n    For o = tmi To i - 1\n        Cells(o, 2).Value = Pattern\n    Next o\n    tm = Cells(i, 1).Value\n    tmi = i\nEnd If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487156827, "post_id": 42247424, "comment_id": 71653458, "body": "See this for finding last row <code>xlDown</code> is not the best option! ;) <a href=\"http://stackoverflow.com/a/11169920/4628637\">stackoverflow.com/a/11169920/4628637</a> and <a href=\"http://stackoverflow.com/documentation/excel-vba/918/methods-for-finding-the-last-used-row-or-column-in-a-worksheet#t=201702151106496482673\">stackoverflow.com/documentation/excel-vba/918/&hellip;</a>"}, {"owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1487157273, "post_id": 42247424, "comment_id": 71653811, "body": "Wow, i was doing it the entire time at work using the xlDown method. You just make me recode a lot of stuff hahaha"}, {"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487157403, "post_id": 42247424, "comment_id": 71653898, "body": "@AngelMdez I have tried this code, it gives me an error &quot;Next without for&quot;. Maybe I should add End If anywhere?"}, {"owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "reply_to_user": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487157473, "post_id": 42247424, "comment_id": 71653937, "body": "@Izzy Schneider Yeah i missclick and delete an &quot;End If&quot; just before &quot;Index = i&quot; and edited in the code. You can just put the End If there or copy the new edited code. Let me know how it goes!"}, {"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487157992, "post_id": 42247424, "comment_id": 71654289, "body": "@AngelMdez well, it worked only with the first ID with empty rows, then I have checked if Macro, filled other IDs up, but it didn&#39;t. I also deleted again some of the values in other ID, so it&#39;s the first ID with empty values, and it worked again, but after that it doesn&#39;t work."}, {"owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "reply_to_user": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487158779, "post_id": 42247424, "comment_id": 71654804, "body": "@Izzy Schneider Add this:          Else                 ID = .Cells(i, 1).Value                 Filler = .Cells(i, 2).Text  Just before the &quot;End If&quot;. I edit the new code."}, {"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487159073, "post_id": 42247424, "comment_id": 71655004, "body": "@AngelMdez nice, now it works exactly as I expected. Thanks for your effort."}, {"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487166138, "post_id": 42247424, "comment_id": 71659807, "body": "@AngelMdez could you please tell me, what should i change in code, if for example my data not in column B but in column F. Everything what is 2 I have to change it to 6?"}, {"owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "reply_to_user": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1487241189, "post_id": 42247424, "comment_id": 71698855, "body": "@Izzy Schneider yeah,numers &quot;1&quot; and &quot;2&quot; reference collums. Change 1 if you change your &quot;ID&quot;, change &quot;2&quot; if  you change your &quot;29:28:12&quot; data. (Fe)  In your case if you change 2 for 6 it should work."}], "tags": [], "owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "is_accepted": true, "score": 1, "last_activity_date": 1487158852, "last_edit_date": 1487158852, "creation_date": 1487156317, "answer_id": 42247424, "question_id": 42246219, "link": "https://stackoverflow.com/questions/42246219/how-to-fill-up-empty-lines-in-excel-table-with-one-existing-value/42247424#42247424", "title": "How to fill up empty lines in Excel Table with one existing value?", "body": "<pre><code>    Public Sub FillEmpty()\n       Dim finded As Range\n       Dim Sheet As Worksheet\n       Set Sheet = ActiveSheet 'or any other sheet -&gt; .Sheets(\"\")\n       With Sheet\n          lastrow = .Cells(1, 1).End(xlDown).Row\n          For i = 1 To lastrow\n          If StrComp(.Cells(i, 2).Value, \"\") = 0 Then\n            Set finded = .Columns(2).Find(\"*\", after:=.Cells(i, 2), LookIn:=xlValues)\n            ID = .Cells(finded.Row, 1).Value\n            Filler = .Cells(finded.Row, 2).Text\n            Else\n                 ID = .Cells(i, 1).Value\n                 Filler = .Cells(i, 2).Text\n          End If\n          Index = i\n          While ID = .Cells(Index, 1).Value\n            .Cells(Index, 2).Value = Filler\n            Index = Index + 1\n          Wend\n          Next i\n      End With\nEnd Sub\n</code></pre>\n\n<p>Made it real quick so not the most optimal solution. I tested it with your example and it works. Not sure with many more rows. Check it and let me know if it works for you.</p>\n"}], "owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 42247424, "answer_count": 2, "score": 0, "last_activity_date": 1487159138, "creation_date": 1487153182, "last_edit_date": 1487153256, "question_id": 42246219, "link": "https://stackoverflow.com/questions/42246219/how-to-fill-up-empty-lines-in-excel-table-with-one-existing-value", "title": "How to fill up empty lines in Excel Table with one existing value?", "body": "<p>I have an Excel Table, with some columns. But at the moment a have a problem with column Duration.</p>\n\n<p>When I scrolled down the table, i have unexpectedly noticed, that many IDs have empty lines, and only one line of this ID has an actual value. </p>\n\n<p>Is it possible to fill up other empthy lines with this only one existing value using VBA? That means, that all empty values for ID6979960 should be filled up with a value 42:15:56, and so on.</p>\n\n<p>Without that, my other calculations in my table, don't work properly.</p>\n\n<p>I don't know exactly how copying of values works in VBA.</p>\n\n<p><a href=\"https://i.stack.imgur.com/36gCI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/36gCI.png\" alt=\"Table Example:ID,Duration\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27, "user_id": 7562948, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/457932c1ac9c560f5a254e493ee0a1df?s=128&d=identicon&r=PG&f=1", "display_name": "Mcnanny", "link": "https://stackoverflow.com/users/7562948/mcnanny"}, "edited": false, "score": 0, "creation_date": 1487153256, "post_id": 42246202, "comment_id": 71650711, "body": "@Shai Rado you can see it here"}, {"owner": {"reputation": 27, "user_id": 7562948, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/457932c1ac9c560f5a254e493ee0a1df?s=128&d=identicon&r=PG&f=1", "display_name": "Mcnanny", "link": "https://stackoverflow.com/users/7562948/mcnanny"}, "edited": false, "score": 0, "creation_date": 1487154025, "post_id": 42246202, "comment_id": 71651351, "body": "@ShaiRado here it is"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487156683, "post_id": 42246202, "comment_id": 71653357, "body": "you got a good answer below"}], "answers": [{"tags": [], "owner": {"reputation": 831, "user_id": 7542390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkBke.jpg?s=128&g=1", "display_name": "BenShelton", "link": "https://stackoverflow.com/users/7542390/benshelton"}, "is_accepted": false, "score": 0, "last_activity_date": 1487154769, "creation_date": 1487154769, "answer_id": 42246839, "question_id": 42246202, "link": "https://stackoverflow.com/questions/42246202/how-do-i-go-to-a-cell-found-with-index-match-to-change-the-value/42246839#42246839", "title": "How do I go to a cell (found with index match) to change the value?", "body": "<p>You can make 'behandel' a range and then use Set to get the reference of the formula to that range. Then you can simply select that cell:</p>\n\n<pre><code>Dim behandel As Range\n\nSet behandel = Application.WorksheetFunction.Index(Sheets(\"bestand totaal\").Range(\"E2:E996\"), Application.WorksheetFunction.Match(Sheets(\"Gegevens\").Range(\"B3\"), Sheets(\"Bestand totaal\").Range(\"J2:J996\"), 0), 1)\nbehandel.Select\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7562948, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/457932c1ac9c560f5a254e493ee0a1df?s=128&d=identicon&r=PG&f=1", "display_name": "Mcnanny", "link": "https://stackoverflow.com/users/7562948/mcnanny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487158205, "creation_date": 1487153125, "last_edit_date": 1487158205, "question_id": 42246202, "link": "https://stackoverflow.com/questions/42246202/how-do-i-go-to-a-cell-found-with-index-match-to-change-the-value", "title": "How do I go to a cell (found with index match) to change the value?", "body": "<p>I have made some 'change' buttons that need to go to the cell which has been found with Index as shown down here.</p>\n\n<pre><code>Private Sub CommandButton16_Click()\n\n    Dim behandel As Variant\n\n    behandel = Application.WorksheetFunction.Index(Sheets(\"bestand totaal\").Range(\"E2:E996\"), Application.WorksheetFunction.Match(Sheets(\"Gegevens\").Range(\"B3\"), Sheets(\"Bestand totaal\").Range(\"J2:J996\"), 0), 1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487153034, "post_id": 42246139, "comment_id": 71650550, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/42245780/copying-data-through-date-range\">Copying data through date range</a>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1487153146, "post_id": 42246139, "comment_id": 71650622, "body": "Hmmm... Nice use of previously (other question asked 15min ago...) given code. Maybe a bit of your own? This not a free coding site! There are TONS of questions/answers on copy/paste rows on different sheets, you should have enough to get started"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1487156785, "post_id": 42246139, "comment_id": 71653425, "body": "@R3uK LOL, I&#39;ve just noticed this as well :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487157441, "post_id": 42246139, "comment_id": 71653917, "body": "@ShaiRado : Can&#39;t blame him for trying as people still answer (especially on the previous question...), but he updated the question with a bit more of code, so he read my comment!^^"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1487153527, "post_id": 42246297, "comment_id": 71650941, "body": "Does this copy the entire row and paste it in different sheet?"}, {"owner": {"reputation": 52, "user_id": 7524986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/281f326aa6b6a02e2281c56acc660393?s=128&d=identicon&r=PG&f=1", "display_name": "Rick de Gier", "link": "https://stackoverflow.com/users/7524986/rick-de-gier"}, "reply_to_user": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 1, "creation_date": 1487153676, "post_id": 42246297, "comment_id": 71651074, "body": "this compares the date this how to copy:  <a href=\"http://www.ozgrid.com/forum/showthread.php?t=31461\" rel=\"nofollow noreferrer\">ozgrid.com/forum/showthread.php?t=31461</a>."}], "tags": [], "owner": {"reputation": 52, "user_id": 7524986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/281f326aa6b6a02e2281c56acc660393?s=128&d=identicon&r=PG&f=1", "display_name": "Rick de Gier", "link": "https://stackoverflow.com/users/7524986/rick-de-gier"}, "is_accepted": false, "score": 1, "last_activity_date": 1487153398, "creation_date": 1487153398, "answer_id": 42246297, "question_id": 42246139, "link": "https://stackoverflow.com/questions/42246139/copying-rows-and-pasting-in-differnt-sheet-using-vba-code-edited/42246297#42246297", "title": "Copying rows and pasting in differnt sheet using VBA (code edited)", "body": "<p>find smaller date pseudo code</p>\n\n<pre><code>Dim rng As Range, cell As Range\nSet rng = Range(\"K2:K200\")\nFor Each cell In rng\n  if cell.value &lt; userdate then\n    //TODO copy to previous\n  end if\nNext cell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487157366, "post_id": 42247789, "comment_id": 71653876, "body": "Seriously ? even after your comment ? Just ask him to send us his entire project scope, and we will do it for him (without doing it chunk by chunk every hour ). At least use <code>DateDiff</code> :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487157620, "post_id": 42247789, "comment_id": 71654032, "body": "@ShaiRado : Yup, I&#39;m still rushing to the 10k reps! And as said in the other comment, he tried a bit more, which is a good start! Still, I was lazy not to add <code>DateDiff</code> indeed but I&#39;d have to convert it to a date too, 2 steps, so long!^^"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487157675, "post_id": 42247789, "comment_id": 71654067, "body": "here&#39;s my aid to help you get to that milestone :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487157955, "post_id": 42247789, "comment_id": 71654268, "body": "@ShaiRado : thx mate! I saw that you passed it recently! ;) Congrats!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1487158031, "post_id": 42247789, "comment_id": 71654314, "body": "thanks :) I was looking for a check in my email from SO , but there was none :) just a boost to the ego"}, {"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1487158059, "post_id": 42247789, "comment_id": 71654341, "body": "You guys have been of tremendous help..I have learned a lot in fact :D...I&#39;m almost close in completing my project :D"}, {"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1487158204, "post_id": 42247789, "comment_id": 71654441, "body": "I need to copy the rows from sheet &quot;Latency&quot;, but the code does it for the active sheet that is open at run time. I modified a line to this <code>For Each CeLL In Sheets(&quot;Latency&quot;).Range(&quot;K2:K200&quot;).Cells</code>..But this doesn&#39;t work..any idea?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487158207, "post_id": 42247789, "comment_id": 71654444, "body": "@ShaiRado : Yup a mail when hitting the 10k milestone would be nice! :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 1, "creation_date": 1487158344, "post_id": 42247789, "comment_id": 71654533, "body": "@stackmark : Are you pasting in the same workbook? Did it worked before changing the sheet?"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1487158290, "last_edit_date": 1487158290, "creation_date": 1487157300, "answer_id": 42247789, "question_id": 42246139, "link": "https://stackoverflow.com/questions/42246139/copying-rows-and-pasting-in-differnt-sheet-using-vba-code-edited/42247789#42247789", "title": "Copying rows and pasting in differnt sheet using VBA (code edited)", "body": "<p>Just change <strong>Previous</strong> in <code>With ThisWorkbook.Sheets(\"Previous\")</code><br>\nto the name of the sheet you want to paste the data in!</p>\n\n<pre><code>Sub Previousweek()\n    Dim UserDate As String\n    Dim CeLL As Range\n    UserDate = InputBox(\"Enter the date\", \"Enter Date\", Date)\n\n    If IsDate(UserDate) Then\n        With ThisWorkbook.Sheets(\"Previous\")\n            For Each CeLL In ThisWorkbook.Sheets(\"Latency\").Range(\"K2:K200\").Cells\n                If CeLL.Value &lt; UserDate Then\n                    CeLL.EntireRow.Copy .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0)\n                End If\n            Next CeLL\n        End With 'ThisWorkbook.Sheets(\"Previous\")\n    Else\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 42247789, "answer_count": 2, "score": 0, "last_activity_date": 1487158290, "creation_date": 1487152951, "last_edit_date": 1487155270, "question_id": 42246139, "link": "https://stackoverflow.com/questions/42246139/copying-rows-and-pasting-in-differnt-sheet-using-vba-code-edited", "title": "Copying rows and pasting in differnt sheet using VBA (code edited)", "body": "<p>I have the below code that gets the date input from the user. What I want to do is:</p>\n\n<ul>\n<li>To find all the dates before the entered date in COl K of sheet \"Latency\"</li>\n<li>To copy the entire row and paste it in a different sheet named \"Previous\".</li>\n</ul>\n\n<p>My code:</p>\n\n<pre><code>Sub Previousweek()\nDim userdate\n\nuserdate = InputBox(\"Enter the date\", \"Enter Date\", Date)\n If IsDate(userdate) Then\n  'logic here\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Updated Code:</p>\n\n<pre><code>Sub Previousweek()\nDim userdate\n\nuserdate = InputBox(\"Enter the date\", \"Enter Date\", Date)\nDim rng As Range, cell As Range\nSet rng = Range(\"K2:K200\")\nFor Each cell In rng\n  If cell.Value &lt; userdate Then\n    cell.EntireRow.Copy\n    Sheets(\"Previous\").Range(\"A65536\").End(xlUp).Offset(1, 0).Select\n            Sheets(\"Previous\").Paste\n        End If\n     Next cell\n   End Sub\n</code></pre>\n\n<p>This is showing error in below line as Subscript out of range :</p>\n\n<pre><code>Sheets(\"Previous\").Range(\"A65536\").End(xlUp).Offset(1, 0).Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1487152471, "creation_date": 1487152471, "answer_id": 42245959, "question_id": 42245780, "link": "https://stackoverflow.com/questions/42245780/getting-user-input-through-vba/42245959#42245959", "title": "Getting user input through vba", "body": "<p>Here is how to get input from the user:</p>\n\n<pre><code>Range(\"A1\").Value = InputBox(\"Give me some input\")\n</code></pre>\n\n<p>Read more here:\n<a href=\"http://www.excel-easy.com/vba/examples/inputbox-function.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/vba/examples/inputbox-function.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 831, "user_id": 7542390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dkBke.jpg?s=128&g=1", "display_name": "BenShelton", "link": "https://stackoverflow.com/users/7542390/benshelton"}, "is_accepted": true, "score": 1, "last_activity_date": 1487152477, "creation_date": 1487152477, "answer_id": 42245963, "question_id": 42245780, "link": "https://stackoverflow.com/questions/42245780/getting-user-input-through-vba/42245963#42245963", "title": "Getting user input through vba", "body": "<p>You could use an input box to get the user to input a date, check that what is entered is actually a date, and then run the code you want:</p>\n\n<pre><code>Sub test()\nDim userdate\n\nuserdate = InputBox(\"Please enter a date\", \"Enter Date\", Date)\nIf IsDate(userdate) Then\n  'Do stuff here\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1487152985, "last_edit_date": 1487152985, "creation_date": 1487152652, "answer_id": 42246024, "question_id": 42245780, "link": "https://stackoverflow.com/questions/42245780/getting-user-input-through-vba/42246024#42246024", "title": "Getting user input through vba", "body": "<p>You could try something like the code below (added some basic error-handling)</p>\n\n<pre><code>Sub InputDateBox()\n\nDim myDateString As String\nDim myDate As Date\n\nmyDateString = InputBox(\"Please enter a date\", \"Enter Date\", Format(Date, \"dd/mm/yyyy\"))\n\nIf IsDate(myDateString) Then\n    myDate = myDateString  \n    'Do the rest of your coding here\nElse\n    MsgBox \"Not a valid date format!\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4377, "favorite_count": 0, "accepted_answer_id": 42245963, "answer_count": 3, "score": 0, "last_activity_date": 1519503409, "creation_date": 1487151964, "last_edit_date": 1519503409, "question_id": 42245780, "link": "https://stackoverflow.com/questions/42245780/getting-user-input-through-vba", "title": "Getting user input through vba", "body": "<p>I have a set of dates in Col K in sheet \"Latency\". I need the user to input the current date and then the code should find all the dates before the entered date, copy the entire row and paste it in a different sheet named \"Previous\".</p>\n\n<p>I'm stuck with how to get input from user and integrate it in code and execute the above. Any suggestions are welcome.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1487150408, "post_id": 42244958, "comment_id": 71648582, "body": "Which column in Sheet &quot;Data&quot; you want to check the last row? I think that T  but can you confirm it?"}, {"owner": {"reputation": 851, "user_id": 439448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3d25fc721190e5edd1bc4dcd7ccf150f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/439448/bob"}, "reply_to_user": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1487150740, "post_id": 42244958, "comment_id": 71648808, "body": "Typo, it shd be D. I hv corrected the macro. The column to check is D."}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1487150838, "post_id": 42244958, "comment_id": 71648875, "body": "Alright! Now another question... Which formulas you want to autofill? Formulas in both B2 and B3 cells?"}, {"owner": {"reputation": 851, "user_id": 439448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3d25fc721190e5edd1bc4dcd7ccf150f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/439448/bob"}, "reply_to_user": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1487151122, "post_id": 42244958, "comment_id": 71649071, "body": "Autofill column A &amp; B in Convert sheet."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1487151270, "post_id": 42244958, "comment_id": 71649198, "body": "Check the answer from CLR. The range you start from (before <code>.AutoFill</code>) must be the top of <code>Destination</code> range."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1487152007, "post_id": 42244958, "comment_id": 71649738, "body": "Also, I don&#39;t know if you are aware of this, but here <code>Sheets(&quot;Data&quot;).Range(&quot;D&quot; &amp; Rows.Count)</code> you actually get rows count from selected sheet, which is <code>Convert</code>. It&#39;s not a problem in this case, but may be in another."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487152399, "post_id": 42245384, "comment_id": 71650039, "body": "don&#39;t forget to fully qualify the <code>Rows.Count</code> inside <code>Range(&quot;T&quot; &amp; Rows.Count)</code> with the worksheet"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 5, "last_activity_date": 1487150920, "creation_date": 1487150920, "answer_id": 42245384, "question_id": 42244958, "link": "https://stackoverflow.com/questions/42244958/autofill-destination-vba/42245384#42245384", "title": "Autofill Destination VBA", "body": "<p>I'd advise against using <code>Selection</code> in this way, but if you've recorded a macro then you're going to get them in your recording.</p>\n\n<p>You could change this part:</p>\n\n<pre><code>Range(\"B3\").Select\nSelection.AutoFill Destination:=Range(\"A2:B\" &amp; Sheets(\"Data\").Range(\"T\" &amp; Rows.Count).End(xlUp).Row)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Range(\"A2:B2\").Select  '&lt;-- only part being changed\nSelection.AutoFill Destination:=Range(\"A2:B\" &amp; Sheets(\"Data\").Range(\"T\" &amp; Rows.Count).End(xlUp).Row)\n</code></pre>\n\n<p>Or, without <code>Selection</code> you would just need to replace those two lines with:</p>\n\n<pre><code>Range(\"A2:B2\").AutoFill Destination:=Range(\"A2:B\" &amp; Sheets(\"Data\").Range(\"T\" &amp; Rows.Count).End(xlUp).Row)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1487151054, "creation_date": 1487151054, "answer_id": 42245435, "question_id": 42244958, "link": "https://stackoverflow.com/questions/42244958/autofill-destination-vba/42245435#42245435", "title": "Autofill Destination VBA", "body": "<p>I'm not sure if this will be the exact answer you need, but I hope it helps you get the answer! I avoided using \"select\"s as they are useless. Then I checked which is the last cell with data on column D and autofilled B3 formula until the calculated value.</p>\n\n<pre><code>Public Sub Call_Generate_Data()\n\nSheets(\"Convert\").Range(\"B2\").FormulaR1C1 = \"=VLOOKUP(Data!RC[4],Links!R1C1:R14C2,2,FALSE)\"\n\nSheets(\"Convert\").Range(\"B3\").FormulaR1C1 = \"=IF(Data!RC[12]=\"\"\"\",\"\"1/1/2014\"\",Data!RC[12])\"\n\nLastRow = Sheets(\"Data\").Cells(Rows.Count, 4).End(xlUp).Row\n\n\nRange(\"A2:B2\").AutoFill Destination:=Range(\"A2:B\" &amp; LastRow &amp; \"\")\n\nEND sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12724792, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/28d967447492fb66a03757e371bc1a15?s=128&d=identicon&r=PG", "display_name": "Tomcat.88", "link": "https://stackoverflow.com/users/12724792/tomcat-88"}, "is_accepted": false, "score": 1, "last_activity_date": 1579179900, "creation_date": 1579179900, "answer_id": 59770330, "question_id": 42244958, "link": "https://stackoverflow.com/questions/42244958/autofill-destination-vba/59770330#59770330", "title": "Autofill Destination VBA", "body": "<p>Try this. </p>\n\n<pre><code>Sub Autofill()\n'universal autofill \n'suggested shortcut Ctrl+Shift+D\n\nDim col As Long\nDim row As Long\nDim myrange As Range\n\ncol = ActiveCell.Column\nIf ActiveCell.Column &lt;&gt; 1 Then\n    row = Cells(Rows.Count, ActiveCell.Column - 1).End(xlUp).row\n    Else\n    row = Cells(Rows.Count, ActiveCell.Column + 1).End(xlUp).row\nEnd If\n\nIf ActiveCell.row &gt;= row Then Exit Sub\n\nSet myrange = Range(Cells(ActiveCell.row, ActiveCell.Column), Cells(row, col))\nActiveCell.Autofill Destination:=myrange\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 851, "user_id": 439448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3d25fc721190e5edd1bc4dcd7ccf150f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/439448/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9906, "favorite_count": 0, "accepted_answer_id": 42245384, "answer_count": 3, "score": 2, "last_activity_date": 1579179900, "creation_date": 1487149729, "last_edit_date": 1487316505, "question_id": 42244958, "link": "https://stackoverflow.com/questions/42244958/autofill-destination-vba", "title": "Autofill Destination VBA", "body": "<p>I have 2 worksheets, Data &amp; Convert.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Brm7q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Brm7q.png\" alt=\"enter image description here\"></a></p>\n\n<p>Trying to do an autofill in \"Convert\" based on \"Data\" last row (can be longer than 100 rows) by using this macro:-</p>\n\n<pre><code>Public Sub Call_Generate_Data()\n\n\n    Sheets(\"Convert\").Select\n    ActiveCell.FormulaR1C1 = \"=VLOOKUP(Data!RC[4],Links!R1C1:R14C2,2,FALSE)\"\n    Range(\"B2\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(Data!RC[12]=\"\"\"\",\"\"1/1/2014\"\",Data!RC[12])\"\n    Range(\"B3\").Select\n    Selection.AutoFill Destination:=Range(\"A2:B\" &amp; Sheets(\"Data\").Range(\"D\" &amp; Rows.Count).End(xlUp).Row)\n    Sheets(\"Data\").Select\n    Range(\"B3\").Select\n\nEnd Sub\n</code></pre>\n\n<p>However, I failed:-</p>\n\n<p><a href=\"https://i.stack.imgur.com/GpNSC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GpNSC.png\" alt=\"enter image description here\"></a></p>\n\n<p>Error msg:-</p>\n\n<p><a href=\"https://i.stack.imgur.com/dgEZ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dgEZ8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Debugged:-</p>\n\n<p><a href=\"https://i.stack.imgur.com/sUqfa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sUqfa.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can someone help me out?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487149090, "post_id": 42244614, "comment_id": 71647665, "body": "Try writing <code>Debug.print wsParam.Name, tableau_scores.Address</code> before the error line and see what happens in the immediate window."}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487149664, "post_id": 42244614, "comment_id": 71648053, "body": "It says <code>Param         $A$3:$A$7</code> which are the good sheet name and the good range for the list"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487149729, "post_id": 42244614, "comment_id": 71648092, "body": "does it fail at I=0 or any other value within the loop"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487149808, "post_id": 42244614, "comment_id": 71648155, "body": "also, why not apply to the whole range?"}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "edited": false, "score": 0, "creation_date": 1487149942, "post_id": 42244614, "comment_id": 71648255, "body": "At any value. I just edited my post, it works when I&#39;m on the sheet &quot;Param&quot; but not on the sheet &quot;Scores&quot;. What do you mean by apply to the whole range ?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487150052, "post_id": 42244614, "comment_id": 71648330, "body": "what is <code>nombre_sousclasse_actif</code>"}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "edited": false, "score": 0, "creation_date": 1487150431, "post_id": 42244614, "comment_id": 71648596, "body": "It&#39;s a (n,2) matrix which memorizes, for each family, how many sub_families there are"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487150590, "post_id": 42244614, "comment_id": 71648696, "body": "By any chance, is the sheet locked or something?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1487150668, "post_id": 42244614, "comment_id": 71648753, "body": "And write <code>Debug.print range_liste.address</code> exactly before the error line."}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "edited": false, "score": 0, "creation_date": 1487151814, "post_id": 42244614, "comment_id": 71649595, "body": "The sheet &quot;Param&quot; is protected but with the mode &quot;UserInterfaceOnly:=True&quot; and i unprotected it before my test. the debug.print says <code>$B$9</code>which is the good range where i want my list for the first iteration of the loop."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487153184, "post_id": 42244614, "comment_id": 71650647, "body": "does hard coding <code>&#39;Param&#39;!$A$3:$A$7</code> go through?"}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "edited": false, "score": 0, "creation_date": 1487154105, "post_id": 42244614, "comment_id": 71651401, "body": "Unfortunately not !"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1487155858, "post_id": 42244614, "comment_id": 71652759, "body": "set up a new sheet with just 1,2,3 or what ever and use this as the list, hardcoded, see if that works, then try this is a newly created worksheet, but with the same param references.  It&#39;s hard to debug, non screen-side :)"}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "edited": false, "score": 0, "creation_date": 1487177762, "post_id": 42244614, "comment_id": 71668749, "body": "So with 1,2,3 in another new sheet it doesnt work. But if i create a new module, a new sheet and i try to create a list on a cell of this new sheet with value from &quot;Param&quot;, it works hardcoded and with <code>Formula1:=&quot;=&#39;&quot; &amp; wsParam.Name &amp; &quot;&#39;!&quot; &amp; tableau_scores.Address</code>. Thanks for trying to help btw !"}, {"owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "edited": false, "score": 0, "creation_date": 1487240395, "post_id": 42244614, "comment_id": 71698193, "body": "I edit my main post, i put the same part of code on a new module and it works"}], "owner": {"reputation": 470, "user_id": 6621137, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/119540b14a0eb937bcf57be99ccf9daa?s=128&d=identicon&r=PG&f=1", "display_name": "TmSmth", "link": "https://stackoverflow.com/users/6621137/tmsmth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1489056709, "creation_date": 1487148774, "last_edit_date": 1531164843, "question_id": 42244614, "link": "https://stackoverflow.com/questions/42244614/1004-error-for-validation-range-with-normally-good-referencing", "title": "1004 Error for Validation range with (normally) good referencing", "body": "<p>Already read some others questions with 1004 error and problem of referencing. I tried to apply it to my code but I still have this error. It works when I activate the sheet first and I select <code>range_list</code>but i would like to avoid this. Error is on line <code>.Add</code> </p>\n\n<pre><code>Set tableau_scores = wsParam.Range(wsParam.Cells(3, 1), wsParam.Cells(derniere_ligne_scores, 1))\n\nFor i = 0 To nombre_sousclasse_actif(numero_actif - 1, 0) - 1\n    Set range_liste = wsScores.Range(wsScores.Cells(derniere_ligne + 1, 2 + i), wsScores.Cells(derniere_ligne + 1, 2 + i))    \n    With range_liste.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=\"='\" &amp; wsParam.Name &amp; \"'!\" &amp; tableau_scores.Address\n    End With\n    range_liste.Value = 0    \nNext i\n</code></pre>\n\n<p>Thanks !</p>\n\n<p><strong>EDIT</strong> : It works when I am on the sheet \"Param\" but not on the sheet \"Scores\"</p>\n\n<p><strong>EDIT 2 :</strong>  I really don't understand, i create a new module, i put this code and it works...</p>\n\n<pre><code>Sub testliste()\n    Dim tableau_scores As Range\n    Dim range_liste As Range\n\n    Set tableau_scores = ThisWorkbook.Worksheets(\"Param\").Range(ThisWorkbook.Worksheets(\"Param\").Cells(3, 1), ThisWorkbook.Worksheets(\"Param\").Cells(7, 1))\n    Set range_liste = ThisWorkbook.Worksheets(\"Scores\").Range(ThisWorkbook.Worksheets(\"Scores\").Cells(9, 2), ThisWorkbook.Worksheets(\"Scores\").Cells(9, 2))\n\n    With range_liste.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=\"='\" &amp; ThisWorkbook.Worksheets(\"Param\").Name &amp; \"'!\" &amp; tableau_scores.Address\n    End With\n    range_liste.Value = 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "amazon-web-services", "amazon", "amazon-product-api"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1487160691, "post_id": 42244094, "comment_id": 71656063, "body": "As you note, the signing process is documented, and as I&#39;ll mention, it&#39;s not an especially complicated task... except that you have to generate a SHA256 HMAC... which I seem to have found <a href=\"http://stackoverflow.com/a/28453704/1695906\">here on SO</a> before noticing that it also appears to be the 2nd hit when googling &quot;hmac sha256&quot;... so, &quot;yes, it&#39;s possible.&quot; Unless &quot;pure VBA&quot; means no dependencies at all, in which case you&#39;d have to write HMAC in VBA.  Not impossible, but not pleasant."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1487160927, "post_id": 42244094, "comment_id": 71656205, "body": "But if you&#39;re just going to click these, why not write a web microservice that generates the signed URLs and either redirects you or proxies the request through to the real endpoint.  Then you would avoid having your secret key in the spreadsheet (cells or VBA code), which would be a pretty bad idea depending on who has access to the spreadsheet."}, {"owner": {"reputation": 199, "user_id": 2688690, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XycS1.jpg?s=128&g=1", "display_name": "gdolenc", "link": "https://stackoverflow.com/users/2688690/gdolenc"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1487170113, "post_id": 42244094, "comment_id": 71662708, "body": "Thanks for the answer. I have found sha256 class for VBA also. But the thing is, that signature does not match - Amazon returns an error. I would like to hear a feedback of someone who has a working solution, not from someone, who just think it is possible."}, {"owner": {"reputation": 8924, "user_id": 726802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/29612ad642297b12269c494306e3e177?s=128&d=identicon&r=PG", "display_name": "Pankaj", "link": "https://stackoverflow.com/users/726802/pankaj"}, "edited": false, "score": 0, "creation_date": 1528423330, "post_id": 42244094, "comment_id": 88512682, "body": "Can you please share that class which create signature for the request ?"}], "owner": {"reputation": 199, "user_id": 2688690, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XycS1.jpg?s=128&g=1", "display_name": "gdolenc", "link": "https://stackoverflow.com/users/2688690/gdolenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487148294, "creation_date": 1487147168, "last_edit_date": 1487148294, "question_id": 42244094, "link": "https://stackoverflow.com/questions/42244094/sign-amazon-product-advertising-api-request-with-excel-vba", "title": "Sign Amazon Product Advertising API Request with Excel/VBA", "body": "<p>My question is very clear. Is it possible to sign Amazon product advertising API request with VBA in Excel or is this not possible? There are so many discussions on this topic open on the web, but I couldn't find a working example or a clear answer. So, Amazon experts, I am challanging you.</p>\n\n<p>The functionality should return the same result as this online module: \n<a href=\"http://associates-amazon.s3.amazonaws.com/signed-requests/helper/index.html\" rel=\"nofollow noreferrer\">http://associates-amazon.s3.amazonaws.com/signed-requests/helper/index.html</a></p>\n\n<p>And here is some help about hot to do it: \n<a href=\"http://docs.aws.amazon.com/AWSECommerceService/latest/DG/rest-signature.html\" rel=\"nofollow noreferrer\">http://docs.aws.amazon.com/AWSECommerceService/latest/DG/rest-signature.html</a></p>\n\n<p>But it looks like nobody has yet been able to accomplish this taks with pure VBA.</p>\n\n<p>Anybody?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1487150600, "post_id": 42243965, "comment_id": 71648705, "body": "Could you please also post the codes for <code>.BuiltInDocmementProperties</code> and       <code>Shell.Application</code> you already tried, and output or errors. If you want to get an answer for PDF also, IMO better you to add it to title, and both add to tags."}], "answers": [{"tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": 0, "last_activity_date": 1487165230, "creation_date": 1487165230, "answer_id": 42250710, "question_id": 42243965, "link": "https://stackoverflow.com/questions/42243965/get-file-author-of-word-document-vba/42250710#42250710", "title": "Get File Author of Word Document, VBA", "body": "<p>You can do this quite easily in .NET, so I wrote a small dll with unmanaged exports:</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.Linq;\nusing System.Runtime.InteropServices;\nusing RGiesecke.DllExport;\nusing System.IO.Compression;\nusing System.Xml.Linq;\n\nnamespace DocxProperties\n{\n    public class DocxPropertyGetter\n    {\n        [DllExport(nameof(GetDocxProp), CallingConvention.StdCall)]\n        [return: MarshalAs(UnmanagedType.AnsiBStr)]\n        public static string GetDocxProp([MarshalAs(UnmanagedType.AnsiBStr)] string wordPath, [MarshalAs(UnmanagedType.AnsiBStr)] string propName)\n        {\n            try\n            {\n                using (var fileStream = File.Open(wordPath, FileMode.Open))\n                using (var parentArchive = new ZipArchive(fileStream))\n                {\n                    return GetPropName(parentArchive, propName);\n                }\n            }\n            catch (Exception ex)\n            {\n                return ex.ToString();\n            }\n        }\n\n        private static string GetPropName(ZipArchive parentArchive, string propName)\n        {\n            var core = parentArchive.Entries.FirstOrDefault(e =&gt; e.FullName == \"docProps/core.xml\");\n\n            using (var coreStream = core.Open())\n            {\n                var doc = XDocument.Load(coreStream);\n\n                foreach (var descendant in doc.Descendants())\n                {\n                    if (descendant.Name.LocalName.Equals(propName, StringComparison.InvariantCultureIgnoreCase))\n                    {\n                        return descendant.Value;\n                    }\n                }\n            }\n\n            return string.Empty;\n        }\n\n    }\n}\n</code></pre>\n\n<p>The code is slightly more verbose than necessary in order to avoid some curious errors in RGiesecke.DllExport if I used .FirstOrDefault() or .GetEntry();</p>\n\n<p>This DLL can in turn be called from VBA like this:</p>\n\n<pre><code>Option Explicit\n\n#If Win64 Then\n    Private Declare PtrSafe Function LoadLibraryA Lib \"kernel32\" (ByVal lpLibFileName As String) As Long\n    Private Declare PtrSafe Function GetDocxProp Lib \"DocxProperties64.dll\" (ByVal wordPath As String, ByVal propName As String) As String\n#Else\n    Private Declare Function LoadLibraryA Lib \"kernel32\" (ByVal lpLibFileName As String) As Long\n    Private Declare Function GetDocxProp Lib \"DocxProperties64.dll\" (ByVal wordPath As String, ByVal propName As String) As String\n#End If\n\nSub TestAuthorName()\n    Dim dllPath As String\n\n    #If Win64 Then\n        dllPath = \"DocxProperties64.dll\"\n    #Else\n        dllPath = \"DocxProperties32.dll\"\n    #End If\n\n    Call LoadLibrary(dllPath)\n\n    Debug.Print GetDocxProp(ThisWorkbook.path &amp; \"\\EmptyDoc.docx\", \"creator\")\n\nEnd Sub\n\nPrivate Function LoadLibrary(dllName As String) As Long\n    Dim path As String\n    path = ThisWorkbook.path &amp; \"\\\" &amp; dllName\n    LoadLibrary = LoadLibraryA(path)\nEnd Function\n</code></pre>\n\n<p>Sorry if I got the Declares wrong for 32 bit... I don't have any 32 version of MS Office to test with.</p>\n"}], "owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 617, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1593956616, "creation_date": 1487146783, "last_edit_date": 1593956616, "question_id": 42243965, "link": "https://stackoverflow.com/questions/42243965/get-file-author-of-word-document-vba", "title": "Get File Author of Word Document, VBA", "body": "<p>my Question is how to get a the author name of a specific Word Document.</p>\n\n<p>My function is:</p>\n\n<pre><code>Public Function GetFileOwner(pFile As String) As String\n\nGetFileOwner = pFile.Owner\n\nEnd Function\n</code></pre>\n\n<p>i get here about 100 documents through, i already tried <code>.BuiltInDocmementProperties.</code>, but this was much too slow...</p>\n\n<p>also the Shell.Application function doesn't work for me, because this only works with all files in a folder, but i need it for specific Files..</p>\n\n<p>Does somebody know a other faster solution? And is there also a way for PDF - documents?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487145440, "post_id": 42243561, "comment_id": 71645563, "body": "where does it stop ? what line ?"}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1487145575, "post_id": 42243561, "comment_id": 71645629, "body": "try <code>Do While Len(buf)&gt; 0</code>"}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487145821, "post_id": 42243561, "comment_id": 71645778, "body": "it stops after open the first file. Btw, thank you for editing the post."}, {"owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "edited": false, "score": 0, "creation_date": 1487146255, "post_id": 42243561, "comment_id": 71646005, "body": "you code works for me. I commented everything between the open and close lines..... so probably there&#39;s  where the problem is"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487147851, "post_id": 42244000, "comment_id": 71646887, "body": "I tried your code but it still has the same problem. It just opens the target file and then stops there, doesn&#39;t do the action."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487147953, "post_id": 42244000, "comment_id": 71646953, "body": "@Tuan  do you have a worksheet with the name you specified above ? For every workbook in the folder ??"}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487148359, "post_id": 42244000, "comment_id": 71647232, "body": "yes, every files in the folder have the worksheet i specified. The worksheet is the second sheet in the file, but the macro just stops at the first sheet after opened the workbook"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487148574, "post_id": 42244000, "comment_id": 71647366, "body": "@Tuan  can u add a breakpoint inside? Put it at the line with With(openWB)... and see where the code stops"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1487148765, "post_id": 42244000, "comment_id": 71647457, "body": "Your code doesn&#39;t just stop, it gives you an Error number and message. <b>A)</b> Output the error code and error message with <code>Debug.Print Err &amp; &quot; | &quot; &amp; Error</code>  <b>B)</b> make yourself familiar with the concept of error handling. I add a simple example to my code"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1487148879, "post_id": 42244000, "comment_id": 71647532, "body": "@MartinDreher not for me, and I tested it. Where is it failing ? What did you test ?"}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1487149596, "post_id": 42244000, "comment_id": 71648003, "body": "@MartinDreher Didn&#39;t have any Error message show up. :("}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487149986, "post_id": 42244000, "comment_id": 71648282, "body": "@Shai Rado I put breakpoint like you said, but it run to the breakpoint without stopping."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487150806, "post_id": 42244000, "comment_id": 71648848, "body": "@Tuan  if it not stopping, when you run in debug, with F8 , what does it do? Does it copy &gt;&gt; paste the first time before exiting the loop ?"}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487151650, "post_id": 42244000, "comment_id": 71649475, "body": "@Shai Rado if i run it in debug, then it run to the end without any problem. :( Update: I dont know why but it&#39;s working now."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487151754, "post_id": 42244000, "comment_id": 71649552, "body": "@Tuan when you run it in debug it runs for all files in the folder ? it copies them correctly to your worksheet ?"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1487151960, "post_id": 42244000, "comment_id": 71649706, "body": "@ShaiRado miscommunication on my behalf, i didn&#39;t mean <b>your</b> code stops. ;) What i wanted to say was: if the OP&#39;s code stops like he mentioned, there will be an error number and message, which gives a lead"}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1487152672, "post_id": 42244000, "comment_id": 71650244, "body": "@Martin Dreher It really didn&#39;t showed any error messages at all. :("}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487152763, "post_id": 42244000, "comment_id": 71650314, "body": "@ShaiRado yes, it run to the end and correctly copies all data to my worksheet. And after i run it in debug now it run correctly in normal mode as well."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487152834, "post_id": 42244000, "comment_id": 71650372, "body": "@Tuan strange, try Restarting Excel, then try to run it a few times, and see if it works withut issues. If it does, feel free to mark as &quot;Asnwer&quot; (click on the <b>V</b> next to my answer)"}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487153183, "post_id": 42244000, "comment_id": 71650645, "body": "@ShaiRado it really was strange. I tried to run it a few times to see if any issues occur but i think it run correctly now. Thank you so much for you help!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487153226, "post_id": 42244000, "comment_id": 71650688, "body": "@Tuan but you gave the &quot;Answer&quot; not to my answer ? Why did u have the other answer the mark ? Out of curiosity"}, {"owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "edited": false, "score": 0, "creation_date": 1487203423, "post_id": 42244000, "comment_id": 71682341, "body": "@Shai Rado my mistake. :). i &#39;ve just changed it."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1487146879, "creation_date": 1487146879, "answer_id": 42244000, "question_id": 42243561, "link": "https://stackoverflow.com/questions/42243561/vba-open-file-from-a-specific-folder-and-do-action/42244000#42244000", "title": "VBA - Open file from a specific folder and do action", "body": "<p>The error is not coming from your <code>Do While buf &lt;&gt; \"\"</code> loop, but from what you are trying to achieve inside (copy >> paste between workbooks).</p>\n\n<p>Inside your loop, you have too many <code>Select</code>, <code>Selection</code> and <code>Activate</code>, instead use fully qualifed <code>Range</code> and <code>Cells</code>.</p>\n\n<p>You can use <code>With openWB.Worksheets(\"\u30c7\u30fc\u30bf\u30bb\u30c3\u30c81\")</code>, and below it nest your range with <code>.Range(.Cells(2, \"A\"), .Cells(LastRow, LastCol)).Copy</code>. </p>\n\n<p><strong>Code</strong>    </p>\n\n<pre><code>Sub ExtractData\u2460()\n\n' ExtractData? Macro\n' Keyboard Shortcut: Ctrl+Shift+Q\n'\nDim buf As String\nDim dlg As FileDialog\nDim fold_path As String\nDim openWB As Workbook\nDim LastRow As Long, LastCol As Long\n\nApplication.ScreenUpdating = False\n\nSet dlg = Application.FileDialog(msoFileDialogFolderPicker)\nIf dlg.Show = False Then Exit Sub\n\nfold_path = dlg.SelectedItems(1)\nbuf = Dir(fold_path &amp; \"\\*.xlsx\")\n\nApplication.DisplayAlerts = False\nDo While buf &lt;&gt; \"\"\n    Set openWB = Workbooks.Open(fold_path &amp; \"\\\" &amp; buf)  '&lt;-- set open workbook to object\n\n    With openWB.Worksheets(\"\u30c7\u30fc\u30bf\u30bb\u30c3\u30c81\") '&lt;-- not sure about this name (I don't have this font)\n        ' set the range from A2 to last cell with data in sheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        .Range(.Cells(2, \"A\"), .Cells(LastRow, LastCol)).Copy\n    End With\n\n    ' if \"Workbook.xlsm\" is this workbook with the code, could be repalced with ThisWorkbook\n    With Workbooks(\"Workbook.xlsm\").Worksheets(\"GE\")\n        .Range(\"A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1).PasteSpecial Paste:=xlPasteValues, _\n                                                        Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    End With\n\n    openWB.Close False\n    buf = Dir()\nLoop\n\n' restore settings\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1487160473, "last_edit_date": 1487160473, "creation_date": 1487147636, "answer_id": 42244248, "question_id": 42243561, "link": "https://stackoverflow.com/questions/42243561/vba-open-file-from-a-specific-folder-and-do-action/42244248#42244248", "title": "VBA - Open file from a specific folder and do action", "body": "<p>While your code works for me, using <code>Select</code>, <code>Selection</code> and <code>Activate</code> is pretty prone to error, especially when used in loops or when working in several workbooks.</p>\n\n<p>Using nested <code>With Objects</code> makes it saver, faster and readable without forcing you to <code>Dim</code> and <code>Set</code> a ton of object variables. Try this:</p>\n\n<pre><code>On Error Goto catch:\ntry:\nWith Workbooks.Open(fold_path &amp; \"\\\" &amp; buf)\n\n    With .Sheets(\"\u30c7\u30fc\u30bf\u30bb\u30c3\u30c81\").Range(\"A2\")\n        Range(.Cells(1, 1).End(xlToRight), .End(xlDown)).Copy\n    End With\n\n    With ThisWorkbook.Sheets(\"GE\")\n        .Cells(Range(\"A65536\").End(xlUp).Row + 1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n    End With\nfinally:            \n    .Close SaveChanges:=False\nEnd With\n\n' rest of your code\n\nExit Sub\n\ncatch:\nDebug.Print \"Err at File \" &amp; buf &amp; vbCrLf &amp; Err &amp; vbTab &amp; Error\nGoTo finally\n</code></pre>\n\n<p>Addidional notes: </p>\n\n<ul>\n<li><p><code>.End(...)</code> will get wrong results if there is an empty cell on the left or top border of your data range.</p></li>\n<li><p>above is a simple example of an error handling routine, using pseudo <code>try, catch, finally</code>. Make sure you don't create any infinite loops (meaning: only execute bullet-proof code after the <code>finally</code> and add <code>Exit Sub</code> above the <code>catch:</code></p></li>\n<li><p>there are rare cases where the use of <code>.Copy</code> and <code>.PasteSpecial</code> makes sense.</p>\n\n<p>However, in your case it's save to assume that there are simpler, faster and more fail proof options:</p>\n\n<ul>\n<li><code>Range1.Value = Range2.Value</code>, which writes the data in one step (therefore it's not simply screwed by user interactions, like <code>.Copy + .Paste</code> is</li>\n<li>Read the data into an <code>Array</code> or better a <code>Recordset</code>, which allows additional processing, like filtering out empty rows</li>\n<li>pull data with an <code>ADO.Connection</code> and SQL, which, you guessed it, allows even simpler processing and doesnt need the <code>.Open + .Close</code> and switching between workbooks</li>\n</ul></li>\n</ul>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 15, "user_id": 7567320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06c0b35663868e0d628253efac6a89be?s=128&d=identicon&r=PG&f=1", "display_name": "Tuan", "link": "https://stackoverflow.com/users/7567320/tuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3574, "favorite_count": 1, "accepted_answer_id": 42244000, "answer_count": 2, "score": 0, "last_activity_date": 1487160473, "creation_date": 1487145318, "last_edit_date": 1487148663, "question_id": 42243561, "link": "https://stackoverflow.com/questions/42243561/vba-open-file-from-a-specific-folder-and-do-action", "title": "VBA - Open file from a specific folder and do action", "body": "<p>I want to open files from a specific folder and do the actions with my code below.\nBut when VBA opens the first file, it stops.\nPlease help me!</p>\n\n<pre><code>Sub ExtractData?()\n    '\n    ' ExtractData? Macro\n    '\n    ' Keyboard Shortcut: Ctrl+Shift+Q\n    '\n    Dim buf As String\n    Dim dlg As FileDialog\n    Dim fold_path As String\n\n\n\n    Application.ScreenUpdating = False\n\n    Set dlg = Application.FileDialog(msoFileDialogFolderPicker)\n\n    If dlg.Show = False Then Exit Sub\n\n    fold_path = dlg.SelectedItems(1)\n\n    buf = Dir(fold_path &amp; \"\\*.xlsx\")\n\n    Do While buf &lt;&gt; \"\"\n\n        Workbooks.Open fold_path &amp; \"\\\" &amp; buf\n\n\n        Sheets(\"\u30c7\u30fc\u30bf\u30bb\u30c3\u30c81\").Select\n        Range(\"A2\").Select\n        Range(Selection, Selection.End(xlToRight)).Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n\n        Windows(\"Workbook.xlsm\").Activate\n        Sheets(\"GE\").Select\n        Cells(Range(\"A65536\").End(xlUp).Row + 1, 1).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n        Workbooks(buf).Close SaveChanges:=False\n        buf = Dir()\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "is_accepted": false, "score": 0, "last_activity_date": 1487145648, "creation_date": 1487145648, "answer_id": 42243669, "question_id": 42243377, "link": "https://stackoverflow.com/questions/42243377/macro-for-printing-of-excel-sheet-with-different-value-in-one-cell-for-each-copy/42243669#42243669", "title": "Macro for printing of excel sheet with different value in one cell for each copy", "body": "<p>try something like:</p>\n\n<pre><code>Option Explicit\nSub test()\n    Dim i As Integer\n    i = 1\n    While Sheets(2).Cells(i, 1).Value &lt;&gt; \"\"\n        Sheets(1).Cells(1, 1).Value = Sheets(2).Cells(i, 1).Value\n        Sheets(1).PrintOut\n        i = i + 1\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7536628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5EaZi.jpg?s=128&g=1", "display_name": "Mr. N3rd", "link": "https://stackoverflow.com/users/7536628/mr-n3rd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1436, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487316563, "creation_date": 1487144785, "last_edit_date": 1487316563, "question_id": 42243377, "link": "https://stackoverflow.com/questions/42243377/macro-for-printing-of-excel-sheet-with-different-value-in-one-cell-for-each-copy", "title": "Macro for printing of excel sheet with different value in one cell for each copy", "body": "<p>I am searching for Excel macro which will change the value in specified cell for each copy while printing. It can be used for example to print 20 school assignments with different student names on it. These names are stored in the second sheet in column A in range A1:A20. Thank you very much!!!</p>\n"}, {"tags": ["vba", "excel", "solver"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5021638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82906325a6cb3079e532854bc2e7d996?s=128&d=identicon&r=PG&f=1", "display_name": "MSshadX", "link": "https://stackoverflow.com/users/5021638/msshadx"}, "edited": false, "score": 0, "creation_date": 1487145848, "post_id": 42243521, "comment_id": 71645793, "body": "Thank you, that&#39;s what i needed"}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": true, "score": 1, "last_activity_date": 1487145215, "creation_date": 1487145215, "answer_id": 42243521, "question_id": 42243312, "link": "https://stackoverflow.com/questions/42243312/enter-a-formula-that-shows-on-clicking-in-a-cell-using-vba-then-use-it-in-solver/42243521#42243521", "title": "enter a formula that shows on clicking in a cell using vba then use it in solver", "body": "<p>use something like this</p>\n\n<pre><code>Set srange1 = Range(\"B2:B\" &amp; n + 1)\nSheets(\"Portfolio\").Cells(2, 3 + n).Formula = \"=SUM(\" &amp; srange1 .Address &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5021638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82906325a6cb3079e532854bc2e7d996?s=128&d=identicon&r=PG&f=1", "display_name": "MSshadX", "link": "https://stackoverflow.com/users/5021638/msshadx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 42243521, "answer_count": 1, "score": 0, "last_activity_date": 1487145215, "creation_date": 1487144456, "last_edit_date": 1487144515, "question_id": 42243312, "link": "https://stackoverflow.com/questions/42243312/enter-a-formula-that-shows-on-clicking-in-a-cell-using-vba-then-use-it-in-solver", "title": "enter a formula that shows on clicking in a cell using vba then use it in solver", "body": "<p>Usually when i enter a formula on  excel it shows when i click on the cell, but when i use vba it only shows the value even when i click. I need to show the formula so i can use it as a target cell for a solver. The solver won't work if it's just a value.</p>\n\n<p>Like for example i use</p>\n\n<pre><code> Set srange1 = Range(\"B2:B\" &amp; n + 1)\n Sheets(\"Portfolio\").Cells(2, 3 + n).Value = Application.Sum(srange1)\n</code></pre>\n\n<p>The cell contains only a value so i can't use a solver on it since it requires a formula. </p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487144212, "post_id": 42243139, "comment_id": 71644918, "body": "is your VBA code run from Excel ? or from PowerPoint itself ?"}, {"owner": {"reputation": 12296, "user_id": 1948860, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7f0b71281b4619cd084794b9654d227e?s=128&d=identicon&r=PG", "display_name": "richie", "link": "https://stackoverflow.com/users/1948860/richie"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487144431, "post_id": 42243139, "comment_id": 71645029, "body": "@ShaiRado I&#39;m running it from Excel"}, {"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487146018, "post_id": 42243139, "comment_id": 71645888, "body": "Hey @Richie , Would resizing the image so that it has the same Height/Width proportion as the slide background does work?"}, {"owner": {"reputation": 12296, "user_id": 1948860, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7f0b71281b4619cd084794b9654d227e?s=128&d=identicon&r=PG", "display_name": "richie", "link": "https://stackoverflow.com/users/1948860/richie"}, "reply_to_user": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487147409, "post_id": 42243139, "comment_id": 71646609, "body": "@TheSilkCode Is it the same thing (height/width proportion) that happens when we set the background image manually?"}, {"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487147853, "post_id": 42243139, "comment_id": 71646888, "body": "So basically what&#39;s happening is the Height/Width ratio of the slide is different than the image- so when you try and apply the image to the background one aspect, either the Height or Width, gets stretched out further which is what gives it the distorted look... but if the image is already the correct H/W ratio, then when it gets stretched out to cover the background it will already be in the correct H/W ratio and wont get distorted..."}], "owner": {"reputation": 12296, "user_id": 1948860, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7f0b71281b4619cd084794b9654d227e?s=128&d=identicon&r=PG", "display_name": "richie", "link": "https://stackoverflow.com/users/1948860/richie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487144469, "creation_date": 1487143897, "last_edit_date": 1531164843, "question_id": 42243139, "link": "https://stackoverflow.com/questions/42243139/adjust-size-of-background-image-automatically-in-powerpoint-using-vba-running-f", "title": "Adjust size of background image automatically in Powerpoint using VBA (running from Excel)", "body": "<p>While manually setting an image as background in Powerpoint, the resizing is taken care of automatically and appears properly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WeCsa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WeCsa.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I do it through VBA the image gets distorted;</p>\n\n<p><a href=\"https://i.stack.imgur.com/N7R27.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N7R27.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the VBA code I have;</p>\n\n<pre><code>With oSlide.Background.Fill\n     .UserPicture \"C:\\Images\\sample.jpg\"\nEnd With\n</code></pre>\n\n<p>How do I get the image fit right?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 1, "creation_date": 1487139781, "post_id": 42241747, "comment_id": 71642708, "body": "Please share the part of your code where you open and try to save the file."}, {"owner": {"reputation": 862, "user_id": 3454860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d8d587bb86f0014ebfb3c1f208f074?s=128&d=identicon&r=PG&f=1", "display_name": "Han Soalone", "link": "https://stackoverflow.com/users/3454860/han-soalone"}, "edited": false, "score": 1, "creation_date": 1487139842, "post_id": 42241747, "comment_id": 71642730, "body": "And also part where you set the pointer to the workbook will be helpful."}], "answers": [{"comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1487140944, "post_id": 42242136, "comment_id": 71643211, "body": "Using Excel Objects requires a reference to <code>Microsoft Excel XX.X Object Library</code>"}, {"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1487142215, "post_id": 42242136, "comment_id": 71643859, "body": "Yes, like @gizlmo said, make sure you include any necessary object libraries."}, {"owner": {"reputation": 1, "user_id": 3426335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/281d89fd3cba22a9cf4fd0c4eab14f94?s=128&d=identicon&r=PG&f=1", "display_name": "user3426335", "link": "https://stackoverflow.com/users/3426335/user3426335"}, "edited": false, "score": 0, "creation_date": 1487147284, "post_id": 42242136, "comment_id": 71646545, "body": "Thanks so much! I&#39;m getting the error &quot;argument not optional&quot; at Set targetRange = excelApp.Range. Any idea what this is?"}, {"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1487147584, "post_id": 42242136, "comment_id": 71646702, "body": "On which line? Set TargetRange doesn&#39;t use excelApp so can you please clarify-"}], "tags": [], "owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "is_accepted": false, "score": 2, "last_activity_date": 1487140160, "creation_date": 1487140160, "answer_id": 42242136, "question_id": 42241747, "link": "https://stackoverflow.com/questions/42241747/vba-for-ms-access-write-to-an-excel-file-without-opening-write-to-last-row-sa/42242136#42242136", "title": "VBA for MS Access: write to an excel file without opening, write to last row, save and close", "body": "<p>First of all, in order to update and save a file like you want to, you have to open it first- so it is a little confusing/contradictory when you say that you don't want to 'actually open' an excel file... I took it to meant that you just don't want the excel application showing- which you would want something like this:</p>\n\n<pre><code>Public Sub demoCode()\nDim excelApp As Excel.Application\nDim targetWB As Workbook\nDim targetRange As Range\n\n'Create new Excel Application\nSet excelApp = New Excel.Application\n'Keep hidden\nexcelApp.Visible = False\n\n'Have new Excel App open workbook\nSet targetWB = excelApp.Workbooks.Open(\"C:\\Filename.xlsm\")\n\n'Set targetRange to 1 row past the first sheet's usedrange\nSet targetRange = targetWB.Sheets(1).Range(targetWB.Sheets(1).UsedRange.address)(targetWB.Sheets(1).UsedRange.Rows.Count + 1, 1)\n\n'Paste @ targetRange\n\n'Close and save workbook\ntargetWB.Close (True)\n'Close Excel App\nexcelApp.Quit\nEnd Sub\n</code></pre>\n\n<p>Hope this helps,\nTheSilkCode</p>\n"}], "owner": {"reputation": 1, "user_id": 3426335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/281d89fd3cba22a9cf4fd0c4eab14f94?s=128&d=identicon&r=PG&f=1", "display_name": "user3426335", "link": "https://stackoverflow.com/users/3426335/user3426335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6583, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1487140160, "creation_date": 1487138373, "question_id": 42241747, "link": "https://stackoverflow.com/questions/42241747/vba-for-ms-access-write-to-an-excel-file-without-opening-write-to-last-row-sa", "title": "VBA for MS Access: write to an excel file without opening, write to last row, save and close", "body": "<p>I am using VBA in MS Access for the first time and cannot get the following right:\n<strong>Launch an excel file</strong> (without actually opening the file), then <strong>write to the last row</strong> in the excel file, and then <strong>save</strong> the file (with the same path and name as before, essentially replace the previous file), then <strong>close</strong> the excel file.</p>\n\n<p>Please assist! So far I can write to an excel file, but cannot save and close without closing the whole MS Access application.\nIf you could please give a sample of working code to do the above, I will tailor it for my requirements.</p>\n\n<p>Thanks!\nChristine</p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1487142779, "post_id": 42241533, "comment_id": 71644173, "body": "your narrative doesn&#39;t match your code:  I took the former as the valid one and posted an answer"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1487143024, "post_id": 42242778, "comment_id": 71644294, "body": "Just what I needed!! Thanks"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487143180, "post_id": 42242778, "comment_id": 71644375, "body": "congrats on reaching 20K !"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487143398, "post_id": 42242778, "comment_id": 71644498, "body": "@user3598756 LOL, no, you and I jave been answering on the 50% of the same posts here, so I can see your points (too frequently :)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1487142594, "creation_date": 1487142594, "answer_id": 42242778, "question_id": 42241533, "link": "https://stackoverflow.com/questions/42241533/using-dic-to-find-match-and-updating-columns-in-vba/42242778#42242778", "title": "Using Dic to find match and updating columns in VBA", "body": "<p>following your description:</p>\n\n<blockquote>\n  <ul>\n  <li><p>Check Col AE in sheet \"DRG\" for the string \"TRUE\". </p></li>\n  <li><p>If that is found,then compare values in Col E of sheet \"DRG\" with Col R of sheet \"Latency\".</p></li>\n  <li>If a match is found in Sheet \"Latency\" and if it has the\n  value \"TRUE\" in sheet DRG, then update the text \"IP\" in Col S in\n  \"Latency\" sheet.</li>\n  </ul>\n</blockquote>\n\n<p>the code should be adjusted as follows (see comments):</p>\n\n<pre><code>Option Explicit\n\nSub IPFinder()\n    Dim cl As Range, Dic As Object\n\n    Set Dic = CreateObject(\"Scripting.Dictionary\"): Dic.Comparemode = vbTextCompare\n\n    With Sheets(\"Latency\")\n        For Each cl In .Range(\"R2:R\" &amp; .Cells(Rows.Count, \"C\").End(xlUp).Row)\n            If Not Dic.exists(cl.Value) Then Dic.Add cl.Value, cl.Row\n        Next cl\n    End With\n\n    With Sheets(\"DRG\")\n        With .Range(\"AE1:AE\" &amp; .Cells(Rows.Count, \"A\").End(xlUp).Row) '&lt;--| reference its column AE range from row 1 (header) down to the one corresponding to last column A not empty row\n            .AutoFilter Field:=1, Criteria1:=\"TRUE\" '&lt;--| filter column AE cells with \"TRUE\" content\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then '&lt;--| if any cell found\n                For Each cl In .Resize(.Rows.Count - 1).Offset(1, -26).SpecialCells(xlCellTypeVisible) '&lt;--| loop through column \"E\" cells correesponding to filtered ones in column \"AE\" (skipping headers)\n                    If Dic.exists(cl.Value) Then Sheets(\"Latency\").Cells(Dic(cl.Value), \"S\") = \"IP\" '&lt;--| if cirrent column E cell value matches any \"Latency\" sheet column R one then write \"IP\" in \"Latency\" sheet corresponding column S cell\n                Next\n            End If\n        End With\n        .AutoFilterMode = False\n    End With\n    Set Dic = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 42242778, "answer_count": 1, "score": 0, "last_activity_date": 1487142594, "creation_date": 1487137433, "last_edit_date": 1487139325, "question_id": 42241533, "link": "https://stackoverflow.com/questions/42241533/using-dic-to-find-match-and-updating-columns-in-vba", "title": "Using Dic to find match and updating columns in VBA", "body": "<p>I'm trying to accomplish the below task using <code>Dictionary</code> : (don't ask why :P, I just found this method and started using it and didn't look out for other possibilities, any better method is welcomed)</p>\n\n<ul>\n<li><p>Check Col AE in sheet \"DRG\" for the string \"TRUE\".</p></li>\n<li><p>If that is found, then compare values in Col E of sheet \"DRG\" with Col R of sheet \"Latency\".</p></li>\n<li><p>If a match is found in Sheet \"Latency\" and if it has the value \"TRUE\" in sheet DRG, then update the text \"IP\" in Col S in \"Latency\" sheet.</p></li>\n</ul>\n\n<p>I have the below code and not sure where to include the line that compares Col R of Sheet \"Latency\" and Col E of sheet \"DRG\"</p>\n\n<p><strong>My Code</strong> </p>\n\n<pre><code>Sub IPFinder()\n\nDim cl As Range, Dic As Object\n\nSet Dic = CreateObject(\"Scripting.Dictionary\"): Dic.Comparemode = vbTextCompare\n\nWith Sheets(\"Latency\")\n    For Each cl In .Range(\"R2:R\" &amp; .Cells(Rows.Count, \"C\").End(xlUp).Row)\n        If Not Dic.exists(cl.Value) Then Dic.Add cl.Value, cl.Row\n    Next cl\nEnd With\n\nWith Sheets(\"DRG\")\n    For Each cl In .Range(\"AE2:AE\" &amp; .Cells(Rows.Count, \"A\").End(xlUp).Row)\n        If Dic.exists(cl.Value) = \"TRUE\" Then\n            Sheets(\"Latency\").Cells(Dic(cl.Value), 19) = \"IP\"\n        End If\n        If Dic.exists(cl.Value) Then\n            Sheets(\"Latency\").Cells(Dic(cl.Value), 19) = \"IP\"\n            Dic.Remove (cl.Value)\n        End If\n    Next cl\nEnd With\nSet Dic = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1487139040, "last_edit_date": 1487139040, "creation_date": 1487137462, "answer_id": 42241545, "question_id": 42240855, "link": "https://stackoverflow.com/questions/42240855/getting-a-value-from-combobox/42241545#42241545", "title": "Getting a value from ComboBox", "body": "<p>Try the code below, try to replace <code>ActiveSheet</code> with a qualifed <code>Worksheet</code>, like <code>Worksheets(\"YoutSheetName\")</code>.</p>\n\n<pre><code>Sub ComboBox1_Change()\n\nDim ws As Worksheet\nDim MyDropDown As DropDown\n\n' try not to use ActiveSheet, replace \"Sheet1\" with your sheet's name\nSet ws = Worksheets(\"Sheet1\") ' ActiveSheet\nSet MyDropDown = ws.Shapes(\"ComboBox1\").OLEFormat.Object ' &lt;-- set my Object with \"ComboBo1\" drop-down\n\nMsgBox MyDropDown.List(MyDropDown.ListIndex) '&lt;-- display the value of the selected item \n\nEnd Sub\n</code></pre>\n\n<p>Below is a \"cleaner\" way to add a new <code>DropDown</code> to a <code>Worksheet</code> without using <code>ActiveSheet</code>, <code>Select</code> and <code>Selection</code> (just use fully qualified objects).</p>\n\n<p><strong><em>Sub CreateFormControl</em> Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub CreateFormControl()\n\nDim MyDropDown As DropDown\nDim i As Long\n\n' set the drop-down object to the new created drop-down (replace \"Sheet1\" with your sheet's name)\nSet MyDropDown = Worksheets(\"Sheet1\").DropDowns.Add(0, 0, 100, 15)\n\n' modify the drop-down properties\nWith MyDropDown\n    .Name = \"ComboBox1\"\n\n    .RemoveAllItems\n    For i = 1 To 25\n        .AddItem i\n    Next i\n\n    .OnAction = \"ComboBox1_Change\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4482687, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/19e592bd46894c7409d804d7d2adad3c?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/4482687/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5561, "favorite_count": 0, "accepted_answer_id": 42241545, "answer_count": 1, "score": 0, "last_activity_date": 1487139040, "creation_date": 1487133520, "last_edit_date": 1487138570, "question_id": 42240855, "link": "https://stackoverflow.com/questions/42240855/getting-a-value-from-combobox", "title": "Getting a value from ComboBox", "body": "<p>I have created a combo-box via VBA code.</p>\n\n<pre><code>Sub CreateFormControl()\n\nActiveSheet.DropDowns.Add(0, 0, 100, 15).Name = \"ComboBox1\"\nActiveSheet.Shapes(\"ComboBox1\").ControlFormat.RemoveAllItems\n\nDim i As Integer\nWith ActiveSheet.Shapes(\"ComboBox1\").ControlFormat\n    For i = 1 To 25\n        .AddItem i\n    Next i\nEnd With\nActiveSheet.Shapes.Range(Array(\"ComboBox1\")).Select\nSelection.OnAction = \"ComboBox1_Change\"\nRange(\"B2\").Select\n\nEnd Sub\n</code></pre>\n\n<p>The problem here is, when I select an item in the <code>ComboBox</code>, it gives me a </p>\n\n<blockquote>\n  <p>Run-time error 424. Object required</p>\n</blockquote>\n\n<p>It doesn't show the value selected. I also tried to change my declaration, <code>Sub CreateFormControl()</code> to Public <code>Sub CreateFormControl()</code>, but it's still not working.</p>\n\n<pre><code>Sub ComboBox1_Change()\n\nMsgBox (ComboBox1.Value) 'The error is here\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1487131899, "creation_date": 1487131899, "answer_id": 42240607, "question_id": 42240391, "link": "https://stackoverflow.com/questions/42240391/adding-multiple-if-conditions-in-vba/42240607#42240607", "title": "Adding multiple If conditions in vba", "body": "<p>You can add the new <code>If</code> in 2 options:</p>\n\n<p><strong>Option 1</strong>: In an new line, before the <code>Select Case</code> (my preference).</p>\n\n<pre><code>Sub Test()\n    Dim r As Long, LastRow As Long\n    Dim RemainingDay As Double '&lt;--|\n\n    With Worksheets(\"Latency\") '&lt;--| reference worksheet \"Latency\"\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row '&lt;--| get row index of its column A last not empty cell\n        Application.ScreenUpdating = False\n        For r = 2 To LastRow\n            RemainingDay = 0 '&lt;--|\n\n            If Weekday(.Range(\"K\" &amp; r).Value, vbSaturday) &gt; 2 Then '&lt;--| having 'Weekday()' function starting from \"Saturday\",\n                If .Range(\"o\" &amp; r).Value Like \"Fail\" Then '&lt;-- ****** add the If here ******\n                    Select Case True\n                        Case InStr(.Range(\"P\" &amp; r).Text, \"Moved to SA (Compatibility Reduction)\") &gt; 0, _\n                             InStr(.Range(\"P\" &amp; r).Text, \"Moved to SA (Failure)\") &gt; 0, _\n                             InStr(Range(\"P\" &amp; r).Text, \"Gold framing\") &gt; 0\n                            If .Range(\"M\" &amp; r) - RemainingDay &gt;= 1 Then\n                                .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n                            Else\n                                .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n                            End If\n                    End Select\n                End If\n            End If\n        Next r\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Option 2</strong>: add it to an existing line with an <code>If</code> in it, using an <code>And</code></p>\n\n<pre><code>Sub Test()\n    Dim r As Long, LastRow As Long\n    Dim RemainingDay As Double '&lt;--|\n\n    With Worksheets(\"Latency\") '&lt;--| reference worksheet \"Latency\"\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row '&lt;--| get row index of its column A last not empty cell\n        Application.ScreenUpdating = False\n        For r = 2 To LastRow\n            RemainingDay = 0 '&lt;--|\n\n            ' ****** add the extra if at the line below with an And *****\n            If Weekday(.Range(\"K\" &amp; r).Value, vbSaturday) &gt; 2 And .Range(\"o\" &amp; r).Value Like \"Fail\" Then   '&lt;--| having 'Weekday()' function starting from \"Saturday\",\n                Select Case True\n                    Case InStr(.Range(\"P\" &amp; r).Text, \"Moved to SA (Compatibility Reduction)\") &gt; 0, _\n                         InStr(.Range(\"P\" &amp; r).Text, \"Moved to SA (Failure)\") &gt; 0, _\n                         InStr(Range(\"P\" &amp; r).Text, \"Gold framing\") &gt; 0\n                        If .Range(\"M\" &amp; r) - RemainingDay &gt;= 1 Then\n                            .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n                        Else\n                            .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n                        End If\n                End Select\n            End If\n        Next r\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 42240607, "answer_count": 1, "score": 0, "last_activity_date": 1487131899, "creation_date": 1487130634, "last_edit_date": 1487131065, "question_id": 42240391, "link": "https://stackoverflow.com/questions/42240391/adding-multiple-if-conditions-in-vba", "title": "Adding multiple If conditions in vba", "body": "<p>I have the below code that Checks Col P for certain text , then check for Col M for numbers >1, if it matches then the number in Col M will be colored.</p>\n\n<p>I just want to add one condition here:</p>\n\n<p>-Additionally check Col O for the text \"Fail\", if it matches then check Col P for the string mentioned, then check Col M, if the number in COl M is > 3 , then color it in read (only if it has the string in Col P) or else do not color it.</p>\n\n<pre><code>Sub Test()\n    Dim r As Long, LastRow As Long\n    Dim RemainingDay As Double '&lt;--|\n\n    With Worksheets(\"Latency\") '&lt;--| reference worksheet \"Latency\"\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).row '&lt;--| get row index of its column A last not empty cell\n        Application.ScreenUpdating = False\n        For r = 2 To LastRow\n            RemainingDay = 0 '&lt;--|\n\n            If Weekday(.Range(\"K\" &amp; r).value, vbSaturday) &gt; 2 Then '&lt;--| having 'Weekday()' function starting from \"Saturday\",\n                Select Case True\n                    Case InStr(.Range(\"P\" &amp; r).text, \"Moved to SA (Compatibility Reduction)\") &gt; 0, _\n                         InStr(.Range(\"P\" &amp; r).text, \"Moved to SA (Failure)\") &gt; 0, _\n                         InStr(Range(\"P\" &amp; r).text, \"Gold framing\") &gt; 0\n                        If .Range(\"M\" &amp; r) - RemainingDay &gt;= 1 Then\n                            .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n                        Else\n                            .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n                        End If\n                End Select\n            End If\n        Next r\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487129882, "post_id": 42240138, "comment_id": 71639537, "body": "<code>Worksheets(&quot;Sheet1&quot;).Range(&quot;F2&quot;).NumberFormat = &quot;mm&#47;dd&#47;yy;@&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1487131775, "post_id": 42240266, "comment_id": 71640037, "body": "@Om3r that&#39;s not a problem, good answers always add value, especially when they provide an alternative :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1487129884, "creation_date": 1487129884, "answer_id": 42240266, "question_id": 42240138, "link": "https://stackoverflow.com/questions/42240138/excel-writing-to-text-file-with-formatdate/42240266#42240266", "title": "Excel - Writing to text file with Format(date)", "body": "<p>You can format the date in VBA before outputting it:</p>\n\n<pre><code>datetext = Worksheets(\"Sheet1\").Range(\"C2\").Value &amp; _ \n    Format(Worksheets(\"Sheet1\").Range(\"F2\").Value, \"mm/dd/yyyy\") &amp; _ \n    \"Hello World\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 1, "creation_date": 1487130499, "post_id": 42240318, "comment_id": 71639680, "body": "Thank you. This is extra info"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1487130262, "creation_date": 1487130262, "answer_id": 42240318, "question_id": 42240138, "link": "https://stackoverflow.com/questions/42240138/excel-writing-to-text-file-with-formatdate/42240318#42240318", "title": "Excel - Writing to text file with Format(date)", "body": "<p>Try this after <strong><code>Dim Fileout1 As Object</code></strong></p>\n\n<pre><code>With Worksheets(\"Sheet1\").Range(\"F2\")\n    .NumberFormat = \"mm/dd/yy;@\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 42240266, "answer_count": 2, "score": 2, "last_activity_date": 1487130262, "creation_date": 1487129035, "last_edit_date": 1487129926, "question_id": 42240138, "link": "https://stackoverflow.com/questions/42240138/excel-writing-to-text-file-with-formatdate", "title": "Excel - Writing to text file with Format(date)", "body": "<p>I have a code that can create and write text file. Below is the code:</p>\n\n<pre><code>Public Sub createFil()\n\n\nDim fso As Object\nDim datetext As String\n\nConst FLDR_NAME As String = \"C:\\testing\"\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nfso.CreateFolder (FLDR_NAME)\n\nDim Fileout1 As Object\n\nSet Fileout1 = fso.CreateTextFile(\"C:\\testing\\test.txt\", True, False)\ndatetext = Worksheets(\"Sheet1\").Range(\"C2\").Value &amp; Worksheets(\"Sheet1\").Range(\"F2\").Value &amp; \"Hello World\"\nFileout1.Write datetext\nFileout1.Close\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, C2 value is \"HI\" and F2 value is current date which is \"=today()\".</p>\n\n<p>At the result file, the date format i get is \"2/15/2017\". but the format that I want is \"02/15/17\". </p>\n\n<p>I have changed the format at Excel sheet for the F2. Am i missing something here?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487126164, "post_id": 42239670, "comment_id": 71638592, "body": "What is the runtime error that you see?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487126915, "post_id": 42239670, "comment_id": 71638756, "body": "Also, have a look at <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this</a>. Generally, relying on <code>ActiveSheet</code>, <code>ActiveWindow</code>, <code>Select</code>, etc., leads to code which is very difficult to interpret. Better to scope appropriate object variables and use them instead -- easier to read, easier to debug, easier to fix in the future :)"}, {"owner": {"reputation": 19, "user_id": 7566124, "user_type": "registered", "profile_image": "https://graph.facebook.com/1400221683330156/picture?type=large", "display_name": "Tyler Serino", "link": "https://stackoverflow.com/users/7566124/tyler-serino"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487133629, "post_id": 42239670, "comment_id": 71640534, "body": "Run-time error &#39;1004&#39; It&#39;s telling me to paste values to the first cell, which i&#39;ve tried but I still get that error"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487133702, "post_id": 42239670, "comment_id": 71640553, "body": "it&#39;s not telling you that. what <i>exactly</i> is the error message?"}, {"owner": {"reputation": 19, "user_id": 7566124, "user_type": "registered", "profile_image": "https://graph.facebook.com/1400221683330156/picture?type=large", "display_name": "Tyler Serino", "link": "https://stackoverflow.com/users/7566124/tyler-serino"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1487175835, "post_id": 42239670, "comment_id": 71667319, "body": "&quot;Run-time error &#39;1004&#39;: To copy cells from another worksheet to this worksheet, make sure you paste them into the first cell (A1 or R1C1).&quot; ...as a matter of fact."}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1487126541, "creation_date": 1487126541, "answer_id": 42239790, "question_id": 42239670, "link": "https://stackoverflow.com/questions/42239670/excel-creating-additional-vba-projects-when-importing-file/42239790#42239790", "title": "Excel creating additional VBA projects when importing file", "body": "<p>The ghost projects in the VBE typically come about because of global variables holding references to the workbooks. If you're certain it's not your own code that's holding the variable references, it could be a COM add-in.</p>\n\n<p>Try disabling all of your COM add-ins in Excel (Developer Tab, COM Add-ins button) and then running your code. Then add back COM add-ins until you replicate the problem.</p>\n\n<p>In my experience, it has been the MS Power Query Add-in that causes the problem.</p>\n"}], "owner": {"reputation": 19, "user_id": 7566124, "user_type": "registered", "profile_image": "https://graph.facebook.com/1400221683330156/picture?type=large", "display_name": "Tyler Serino", "link": "https://stackoverflow.com/users/7566124/tyler-serino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487126832, "creation_date": 1487125621, "last_edit_date": 1487126832, "question_id": 42239670, "link": "https://stackoverflow.com/questions/42239670/excel-creating-additional-vba-projects-when-importing-file", "title": "Excel creating additional VBA projects when importing file", "body": "<p>I'm currently working on a project, that grabs a csv file from a website, and puts it in a pre-defined page in my workbook. It works...to an extent, but it keeps creating new VBA projects that I'm not really understanding, and eventually stops workings. Note, for the particular website I'm extracting this from I cannot use internet explorer.  </p>\n\n<p>The Code I'm Using:</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n On Error Resume Next\n Kill \"C:\\Users\\Me\\Downloads\\products.csv\"\n On Error GoTo 0\n Shell (\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe -url url-string-here\")\n Application.Wait (Now + TimeValue(\"00:00:25\"))\n sCSVLink = \"C:\\Users\\Me\\Downloads\\file.csv\"\n sfile = \"file.csv\"\n ssheet = \"CurrentListings\"\n Set wnd = ActiveWindow\n Application.ScreenUpdating = False\n Sheets(ssheet).Cells.ClearContents\n Workbooks.Open Filename:=sCSVLink\n Windows(sfile).Activate\n ActiveSheet.Cells.Copy\n wnd.Activate\n Sheets(\"CurrentListings\").Paste\n Application.DisplayAlerts = False\n Windows(sfile).Close False\n Application.DisplayAlerts = True\n Application.ScreenUpdating = True\n Sheets(\"CurrentListings\").Range(\"E:E\").WrapText = False\nEnd Sub\n</code></pre>\n\n<p>Like I said, it will work a few times but this happens each time:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FPN63.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FPN63.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Eventually it gives me a runtime error, any suggestions?</p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "edited": false, "score": 0, "creation_date": 1487443696, "post_id": 42239417, "comment_id": 71791690, "body": "V5? V6? 3DEx? Expand how many levels? There are several known limitations depending on what are you using....  I would delete nyself what I wrote as answer but I can&#39;t see how to do it :-)"}, {"owner": {"reputation": 25, "user_id": 3530277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67eec291c32beab4b6cfe3f94e083152?s=128&d=identicon&r=PG&f=1", "display_name": "CRCarpenter", "link": "https://stackoverflow.com/users/3530277/crcarpenter"}, "reply_to_user": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "edited": false, "score": 0, "creation_date": 1487534925, "post_id": 42239417, "comment_id": 71816949, "body": "V5 R22. Expand all levels on a single node, not the entire tree. Is that enough info?"}, {"owner": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "edited": false, "score": 0, "creation_date": 1487570309, "post_id": 42239417, "comment_id": 71827075, "body": "Yes. First ,you need to search the node by name and select (in your code), then use CATIA.StartCommand(&quot;Expand Selection&quot;), then use SendKeys &quot;{TAB how many times is need it}&quot; to be sure you will write the level need it (also with SendKeys) , use again SendKeys &quot;TAB&quot; to go to OK button, hit Enter with SendKeys again. As far as I know, there is no other way to do it in V5. Usually, I&#39;m using just first part of what I described here, search and select the node, run Expand Selection and let the user do the rest of the job, SendKeys is not one of my preferences."}, {"owner": {"reputation": 25, "user_id": 3530277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67eec291c32beab4b6cfe3f94e083152?s=128&d=identicon&r=PG&f=1", "display_name": "CRCarpenter", "link": "https://stackoverflow.com/users/3530277/crcarpenter"}, "reply_to_user": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "edited": false, "score": 0, "creation_date": 1487612678, "post_id": 42239417, "comment_id": 71853063, "body": "OK, I guess I better find another way. SendKeys will not work at all. For some reason, the SendKeys have no effect on the dialog. I&#39;m guessing that Catia is lacking any proper way of manipulating the tree, where I don&#39;t see that SendKeys are a good method of doing this even if it did work. Anyway, thanks for the response, but I have tried this method and was not able to get anywhere with it."}], "owner": {"reputation": 25, "user_id": 3530277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67eec291c32beab4b6cfe3f94e083152?s=128&d=identicon&r=PG&f=1", "display_name": "CRCarpenter", "link": "https://stackoverflow.com/users/3530277/crcarpenter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1076, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520931024, "creation_date": 1487123659, "last_edit_date": 1520931024, "question_id": 42239417, "link": "https://stackoverflow.com/questions/42239417/catia-macro-scripting-expand-single-tree-node", "title": "CATIA Macro Scripting - Expand Single Tree Node", "body": "<p>Is it possible to expand a single node in the tree all levels, using macro code. I see that you can expand all nodes, but I don't want to do that. Also, I see you can expand selected, but I don't want the user to have to make a choice, additionally I can't even get this StartCommand working properly. Just wondering if it's possible to expand a single node using only macro code, and if so, HOW? I'm using V5 R22.</p>\n\n<p>The node has been selected already, Here is my code using SendKeys...</p>\n\n<p><code>CATIA.StartCommand (\"Expand Selection\")\nAppActivate \"CATIA V5\"\nSendKeys \"{UP}\"\nSendKeys \"{TAB}\"\nSendKeys \"{ENTER}\"</code></p>\n\n<p>This has no effect on the Expand Selection dialog</p>\n"}, {"tags": ["excel", "outlook", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1487143811, "post_id": 42239387, "comment_id": 71644705, "body": "You could also replace your code concept to <b>Late Binding</b>"}, {"owner": {"reputation": 55, "user_id": 7382229, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2183f5ae1cd92ea69711bf69eac1bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nadal Mir", "link": "https://stackoverflow.com/users/7382229/nadal-mir"}, "edited": false, "score": 0, "creation_date": 1487148309, "post_id": 42239387, "comment_id": 71647192, "body": "how to do it. please help"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7382229, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2183f5ae1cd92ea69711bf69eac1bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nadal Mir", "link": "https://stackoverflow.com/users/7382229/nadal-mir"}, "edited": false, "score": 0, "creation_date": 1487148327, "post_id": 42242746, "comment_id": 71647209, "body": "i already tick that. same error"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 55, "user_id": 7382229, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2183f5ae1cd92ea69711bf69eac1bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nadal Mir", "link": "https://stackoverflow.com/users/7382229/nadal-mir"}, "edited": false, "score": 0, "creation_date": 1487174357, "post_id": 42242746, "comment_id": 71666130, "body": "What precisely is the error?"}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1487142489, "creation_date": 1487142489, "answer_id": 42242746, "question_id": 42239387, "link": "https://stackoverflow.com/questions/42239387/run-excel-macro-from-outlook-based-on-email-subject/42242746#42242746", "title": "Run Excel Macro from Outlook, Based on Email Subject", "body": "<p>Select Tools, References and set a reference to the Microsoft Excel xx.x library.</p>\n"}], "owner": {"reputation": 55, "user_id": 7382229, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2183f5ae1cd92ea69711bf69eac1bfd6?s=128&d=identicon&r=PG&f=1", "display_name": "Nadal Mir", "link": "https://stackoverflow.com/users/7382229/nadal-mir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "closed_date": 1489323843, "answer_count": 1, "score": -1, "last_activity_date": 1487142489, "creation_date": 1487123407, "last_edit_date": 1531164843, "question_id": 42239387, "link": "https://stackoverflow.com/questions/42239387/run-excel-macro-from-outlook-based-on-email-subject", "closed_reason": "Needs details or clarity", "title": "Run Excel Macro from Outlook, Based on Email Subject", "body": "<p>I'm trying to set up an automated process for when I receive a email in Outlook containing \"subject\" it automatically fires off a macro<br>\nin Excel and run a macro I have set up in Excel. How can this be accomplished?</p>\n\n<p>Can provide more information if necessary - thanks!</p>\n\n<p>this is the code I used</p>\n\n<pre><code>Public Sub Main_function_Auto(Item As Outlook.MailItem)\n\n\nDim ExApp As Excel.Application\n Dim ExWbk As Workbook\n Set ExApp = New Excel.Application\nSet ExWbk = ExApp.Workbooks.Open(\"C:\\Users\\x\\Desktop\\CRAWLER\\zxc crawler\\xx zz - Production.xlsm\")\n ExApp.Visible = True\n\nExWbk.Application.Run \"mainFun.Main_function_Auto\"\n\n ExWbk.Close SaveChanges:=True\n</code></pre>\n\n<p>the error start at </p>\n\n<pre><code>Dim ExApp As Excel.Application\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "row"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1487121563, "post_id": 42239111, "comment_id": 71637452, "body": "<code>myVariable = loopRow.Cells(4).Value</code>"}, {"owner": {"reputation": 73, "user_id": 4083891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p9Yzw.png?s=128&g=1", "display_name": "Jotter", "link": "https://stackoverflow.com/users/4083891/jotter"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1487121939, "post_id": 42239111, "comment_id": 71637555, "body": "that&#39;s it.  thank you."}], "answers": [{"tags": [], "owner": {"reputation": 9010, "user_id": 313121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40ab07b47ae721c553a6df93452a5902?s=128&d=identicon&r=PG", "display_name": "Tahbaza", "link": "https://stackoverflow.com/users/313121/tahbaza"}, "is_accepted": false, "score": 0, "last_activity_date": 1487122044, "creation_date": 1487122044, "answer_id": 42239233, "question_id": 42239111, "link": "https://stackoverflow.com/questions/42239111/vba-loop-thru-rows-in-range-return-column-value/42239233#42239233", "title": "vba Loop thru rows in range return column value", "body": "<p>It's not clear exactly what you're trying to do, but here's how I normally prefer to traverse rows and columns in Excel with VBA, with row and column offset counter variables.  This sample will print the cells in column D to the immediate window.</p>\n\n<p>Given this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8qua1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8qua1.png\" alt=\"\"></a></p>\n\n<p>This code identifies the values of interest:</p>\n\n<pre><code>Public Sub GetCol4()\nDim Rng As Excel.Range, rowOffset As Long\n    Set Rng = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\")\n    Do Until IsEmpty(Rng.Offset(rowOffset, 0).Value)\n        Debug.Print Rng.Offset(rowOffset, 3).Value\n        rowOffset = rowOffset + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>...and results in this being left in the Immediate Window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1l2Nn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1l2Nn.png\" alt=\"\"></a></p>\n"}], "owner": {"reputation": 73, "user_id": 4083891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p9Yzw.png?s=128&g=1", "display_name": "Jotter", "link": "https://stackoverflow.com/users/4083891/jotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 801, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487122044, "creation_date": 1487121128, "question_id": 42239111, "link": "https://stackoverflow.com/questions/42239111/vba-loop-thru-rows-in-range-return-column-value", "title": "vba Loop thru rows in range return column value", "body": "<p>At wits end here.  Just trying to return the value of specific column(4) while looping thru rows in range.  Here's what I have so far.</p>\n\n<pre><code> With sht\n       'Iterate over rows in used range        \n        For Each loopRow In workRange.Rows:            \n           myVariable = .Cells(loopRow, 4).Value                \n           MsgBox myVariable\n\n        Next loopRow\n\nEnd With\n</code></pre>\n"}, {"tags": ["regex", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 514070, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a5c622fcba2973916d96712abc8c9944?s=128&d=identicon&r=PG&f=1", "display_name": "pablo808", "link": "https://stackoverflow.com/users/514070/pablo808"}, "edited": false, "score": 0, "creation_date": 1487123030, "post_id": 42239327, "comment_id": 71637860, "body": "No joy with that but I added extract brackets on my original expression and it appears to match the full IP now.  Thanks for your input."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1487123146, "last_edit_date": 1487123146, "creation_date": 1487122803, "answer_id": 42239327, "question_id": 42239050, "link": "https://stackoverflow.com/questions/42239050/extract-ip-addresses-in-microsoft-outlook-using-macros/42239327#42239327", "title": "Extract IP Addresses in Microsoft Outlook using macros", "body": "<pre><code>^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$\n</code></pre>\n\n<p><a href=\"http://www.regextester.com/22\" rel=\"nofollow noreferrer\">http://www.regextester.com/22</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address\">Regular expression to match DNS hostname or IP Address?</a></p>\n"}], "owner": {"reputation": 593, "user_id": 514070, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a5c622fcba2973916d96712abc8c9944?s=128&d=identicon&r=PG&f=1", "display_name": "pablo808", "link": "https://stackoverflow.com/users/514070/pablo808"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 42239327, "answer_count": 1, "score": 4, "last_activity_date": 1592943692, "creation_date": 1487120653, "last_edit_date": 1592943692, "question_id": 42239050, "link": "https://stackoverflow.com/questions/42239050/extract-ip-addresses-in-microsoft-outlook-using-macros", "title": "Extract IP Addresses in Microsoft Outlook using macros", "body": "<p>I am trying to extract <strong>ALL</strong> IP addresses in the body of an Outlook message from the following example <a href=\"https://www.slipstick.com/developer/vba-copy-outlook-email-excel-workbook/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I have tried replacing the regex from:</p>\n\n<pre><code>With Reg1\n    .Pattern = \"((P130\\w*)\\s*(\\w*)\\s*(\\w*)\\s*(\\w*)\\s*([\\d-\\.]*))\"\nEnd With\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>With Reg1\n    .Pattern = \"((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\"\nEnd With\n</code></pre>\n\n<p><strike>But it only matches one octet.</strike></p>\n\n<p>Sample Text: </p>\n\n<pre><code>The IP from 192.168.10.2 needs attention.\nThe IP from 192.168.11.3 needs attention.\nThe IP from 192.168.12.4 needs attention.\n</code></pre>\n\n<p><strike>Currently it only matches <strong>168</strong></strike></p>\n\n<p>Added extra brackets and now matches the <strong>first</strong> IP in the body of the message but not the rest.  </p>\n\n<p><strong>Full code below:</strong></p>\n\n<p><pre></p>\n\n<p>Option Explicit\n Private Const xlUp As Long = -4162</p>\n\n<p>Sub CopyToExcel(olItem As Outlook.MailItem)\n Dim xlApp As Object\n Dim xlWB As Object\n Dim xlSheet As Object\n Dim vText, vText2, vText3, vText4, vText5 As Variant\n Dim sText As String\n Dim rCount As Long\n Dim bXStarted As Boolean\n Dim enviro As String\n Dim strPath As String\n Dim Reg1 As Object\n Dim M1 As Object\n Dim M As Object</p>\n\n<p>enviro = CStr(Environ(\"USERPROFILE\"))\n'the path of the workbook\n strPath = enviro &amp; \"\\Documents\\test.xlsx\"\n     On Error Resume Next\n     Set xlApp = GetObject(, \"Excel.Application\")\n     If Err &lt;> 0 Then\n         Application.StatusBar = \"Please wait while Excel source is opened ... \"\n         Set xlApp = CreateObject(\"Excel.Application\")\n         bXStarted = True\n     End If\n     On Error GoTo 0\n     'Open the workbook to input the data\n     Set xlWB = xlApp.Workbooks.Open(strPath)\n     Set xlSheet = xlWB.Sheets(\"Sheet1\")</p>\n\n<code>'Find the next empty line of the worksheet\n rCount = xlSheet.Range(\"B\" &amp; xlSheet.Rows.Count).End(xlUp).Row\n rCount = rCount + 1\n\n sText = olItem.Body\n\n Set Reg1 = CreateObject(\"VBScript.RegExp\")\n' \\s* = invisible spaces\n' \\d* = match digits\n' \\w* = match alphanumeric\n\nWith Reg1\n    ' .Pattern = \"((P130\\w*)\\s*(\\w*)\\s*(\\w*)\\s*(\\w*)\\s*([\\d-\\.]*))\"\n     .Pattern = \"((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\"\n    '.Pattern = \"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$\"\n\nEnd With\nIf Reg1.Test(sText) Then\n\n' each \"(\\w*)\" and the \"(\\d)\" are assigned a vText variable\n    Set M1 = Reg1.Execute(sText)\n    For Each M In M1\n       vText = Trim(M.SubMatches(1))\n       vText2 = Trim(M.SubMatches(2))\n       vText3 = Trim(M.SubMatches(3))\n       vText4 = Trim(M.SubMatches(4))\n       ' vText5 = Trim(M.SubMatches(5))\n    Next\nEnd If\n\nxlSheet.Range(\"B\" &amp; rCount) = vText\nxlSheet.Range(\"c\" &amp; rCount) = vText2\nxlSheet.Range(\"d\" &amp; rCount) = vText3\nxlSheet.Range(\"e\" &amp; rCount) = vText4\nxlSheet.Range(\"f\" &amp; rCount) = vText5\n\n xlWB.Close 1\n If bXStarted Then\n     xlApp.Quit\n End If\n Set M = Nothing\n Set M1 = Nothing\n Set Reg1 = Nothing\n Set xlApp = Nothing\n Set xlWB = Nothing\n Set xlSheet = Nothing\nEnd Sub\n</code></pre>\n\n<p></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "edited": false, "score": 0, "creation_date": 1487142275, "post_id": 42238902, "comment_id": 71643901, "body": "This data1 is the base quantity right?"}], "answers": [{"tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": false, "score": 0, "last_activity_date": 1487143787, "last_edit_date": 1487143787, "creation_date": 1487143453, "answer_id": 42243021, "question_id": 42238902, "link": "https://stackoverflow.com/questions/42238902/excel-macro-to-get-data-in-specifc-format-from-an-excel-table/42243021#42243021", "title": "excel macro to get data in specifc format from an excel table", "body": "<p>Here is the macro -</p>\n\n<pre><code>Sub perform()\nApplication.ScreenUpdating = False\n\nSheets(\"Sheet2\").Range(\"A2:D50000\").ClearContents\n\nDim rowcount, datacount, lastrow As Integer\nrowcount = Sheets(\"Sheet1\").Range(\"A500000\").End(xlUp).Row\ndatacount = Sheets(\"Sheet1\").Range(Sheets(\"Sheet1\").Range(\"H5\"), Sheets(\"Sheet1\").Range(\"H5\").End(xlToRight)).Count\n\nSheets(\"Sheet2\").[A2] = \"Code\"\nSheets(\"Sheet2\").[B2] = \"Ref\"\nSheets(\"Sheet2\").[C2] = \"Amount\"\nSheets(\"Sheet2\").[D2] = \"Quantity\"\n\n\nFor i = 5 To rowcount\n\nlastrow = Sheets(\"Sheet2\").Range(\"A500000\").End(xlUp).Row + 1\nSheets(\"Sheet2\").Range(\"A\" &amp; lastrow &amp; \":A\" &amp; lastrow + datacount - 1).Value = Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value\nSheets(\"Sheet1\").Range(\"H4:L4\").Copy\nSheets(\"Sheet2\").Range(\"B\" &amp; lastrow &amp; \":B\" &amp; lastrow + datacount - 1).PasteSpecial Transpose:=True\nSheets(\"Sheet1\").Range(\"H\" &amp; i &amp; \":L\" &amp; i).Copy\nSheets(\"Sheet2\").Range(\"C\" &amp; lastrow &amp; \":C\" &amp; lastrow + datacount - 1).PasteSpecial Transpose:=True\n\nSheets(\"Sheet1\").Range(\"G\" &amp; i).Copy Sheets(\"Sheet2\").Range(\"D\" &amp; lastrow)\n\nNext i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7565878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8e4609c2ced0f1ea760e49f4ddd1f6?s=128&d=identicon&r=PG&f=1", "display_name": "ilham", "link": "https://stackoverflow.com/users/7565878/ilham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1487316677, "creation_date": 1487119661, "last_edit_date": 1531161705, "question_id": 42238902, "link": "https://stackoverflow.com/questions/42238902/excel-macro-to-get-data-in-specifc-format-from-an-excel-table", "title": "excel macro to get data in specifc format from an excel table", "body": "<p>I would appreciate your help with a macro that can make my life easier.</p>\n\n<p>I have data in this format:</p>\n\n<p><img src=\"https://i.stack.imgur.com/C6jlt.jpg\" alt=\"source table\"></p>\n\n<p>and need to have a macro to transform it in another table like this: </p>\n\n<p><img src=\"https://i.stack.imgur.com/tNbHZ.jpg\" alt=\"output table\"></p>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1487120555, "post_id": 42238752, "comment_id": 71637125, "body": "You don&#39;t &quot;delete&quot; a field in a record - you set its value to null.  Delete is for full records only."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1487121773, "post_id": 42238752, "comment_id": 71637520, "body": "Actually @TimWilliams, attachment types in MS Access tables are really join tables with pointer to main table. To remove all meta data, one must delete the underlying linked records."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1487131076, "post_id": 42238752, "comment_id": 71639839, "body": "@Parfait - thanks for the correction: that&#39;s a new one for me."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4179406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aee1ea9e4da7e04d8fb33f5a69574b95?s=128&d=identicon&r=PG&f=1", "display_name": "Terry S", "link": "https://stackoverflow.com/users/4179406/terry-s"}, "edited": false, "score": 0, "creation_date": 1487171196, "post_id": 42239279, "comment_id": 71663548, "body": "I did the same thing with the SQL statement (posted) that I executed, but I tried your idea with the recordset.  I still have the problem the attachments do not delete.  I can delete everything and it will appear to be deleted but as soon as I try to load new attachments the old attachments reappear as if they were never deleted.  The old attachments have a different file location than the new .  If I step through the code the only attachment that shows in the variables is the new attachment, but when I look at the table the old attachment has reappeared.  This is incredibly frustrating."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 31, "user_id": 4179406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aee1ea9e4da7e04d8fb33f5a69574b95?s=128&d=identicon&r=PG&f=1", "display_name": "Terry S", "link": "https://stackoverflow.com/users/4179406/terry-s"}, "edited": false, "score": 0, "creation_date": 1487188509, "post_id": 42239279, "comment_id": 71675361, "body": "I&#39;m afraid I cannot recreate your <i>reappearing</i> issue. To be sure, i just re-ran this code. I added two attachments to an attachment field (from different folders) across three records. Ran my posted code here and ALL attachments from ALL records were removed. And when going to add new attachments, no previous ones appeared. How are you <i>loading</i>? From form or table?"}, {"owner": {"reputation": 31, "user_id": 4179406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aee1ea9e4da7e04d8fb33f5a69574b95?s=128&d=identicon&r=PG&f=1", "display_name": "Terry S", "link": "https://stackoverflow.com/users/4179406/terry-s"}, "edited": false, "score": 0, "creation_date": 1487270706, "post_id": 42239279, "comment_id": 71720940, "body": "It is loading attachments from a file in a folder.  It seems to only be with certain attachments that are loaded.  Any others are deleted if I use the SQL statement or the recordset."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 31, "user_id": 4179406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aee1ea9e4da7e04d8fb33f5a69574b95?s=128&d=identicon&r=PG&f=1", "display_name": "Terry S", "link": "https://stackoverflow.com/users/4179406/terry-s"}, "edited": false, "score": 0, "creation_date": 1487305303, "post_id": 42239279, "comment_id": 71734927, "body": "My question is <i>how</i> are you loading? Directly using table or on a developed form? See bottom of <a href=\"https://support.office.com/en-us/article/Attach-files-and-graphics-to-the-records-in-your-database-d40a09ad-a753-4a14-9161-7f15baad6dbd#bm9\" rel=\"nofollow noreferrer\">MS article</a> for supported types."}, {"owner": {"reputation": 31, "user_id": 4179406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aee1ea9e4da7e04d8fb33f5a69574b95?s=128&d=identicon&r=PG&f=1", "display_name": "Terry S", "link": "https://stackoverflow.com/users/4179406/terry-s"}, "edited": false, "score": 0, "creation_date": 1487698422, "post_id": 42239279, "comment_id": 71897669, "body": "The attachments are loaded to a table using vba.  The attachments can viewed on a form and are included in reports.  There is not a problem with the supported types.  The attachments show on the form and the report as they should.  The problem has been deleting and that is only happening with certain attachments.  I can tell when it will happen.  I can look at the access file size after deleting all attachments and doing compact and repair.  The access file will be larger  matching the size of the attachments that should have been deleted."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1487122481, "creation_date": 1487122481, "answer_id": 42239279, "question_id": 42238752, "link": "https://stackoverflow.com/questions/42238752/delete-data-in-attachment-field/42239279#42239279", "title": "Delete data in attachment field", "body": "<p>Because MS Access Attachment Types are actually linked tables of meta data (<em>filename, filedata, fileflag, filetype,</em> etc.), you need to delete these underlying linked records. So consider nesting another recordset loop on the attachment field value from main table:</p>\n\n<pre><code>strSQL = \"SELECT * FROM tblSpecsPics WHERE Not (tblSpecsPics.Pic.FileData) Is Null;\"\n\nSet rst = db.OpenRecordset(strSQL, dbOpenDynaset, dbSeeChanges)\n\nIf Not rst.BOF And Not rst.EOF Then\n    rst.MoveFirst\nEnd If\n\nDo Until rst.EOF\n\n    Set childrst = rst.Fields(4).Value\n    Do Until childrst.EOF\n       childrst.Delete\n       childrst.MoveNext\n    Loop\n\n    rst.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4179406, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/aee1ea9e4da7e04d8fb33f5a69574b95?s=128&d=identicon&r=PG&f=1", "display_name": "Terry S", "link": "https://stackoverflow.com/users/4179406/terry-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487122481, "creation_date": 1487118695, "question_id": 42238752, "link": "https://stackoverflow.com/questions/42238752/delete-data-in-attachment-field", "title": "Delete data in attachment field", "body": "<p>I have a local table with an attachment field.  I have tried deleting with vba and manually and the previous attachments keep coming back.  In vba I have tried it with a recordset and with SQL.\nThe SQL </p>\n\n<pre><code>Let strSQL = \"DELETE tblSpecsPics.PicID,tblSpecsPics.SpecID,tblSpecsPics.SpecDetailID,tblSpecsPics.PicNum,tblSpecsPics.Pic.FileData,tblSpecsPics.Pic.FileName,tblSpecsPics.Pic.FileType,tblSpecsPics.ImageDesc FROM tblSpecsPics;\"\n\ndb.Execute strSQL, dbSeeChanges\n</code></pre>\n\n<p>The recordset</p>\n\n<pre><code>Set rst = db.OpenRecordset(\"SELECT * FROM tblSpecsPics WHERE Not (tblSpecsPics.Pic.FileData) Is Null;\", dbOpenDynaset, dbSeeChanges)\n\nIf Not rst.BOF And Not rst.EOF Then\nrst.MoveFirst\nDo Until rst.EOF\n    rst.Edit\n    Set rsv = rst.Fields(4).Value\n    rsv.Delete\n    rst.Update\n    rst.MoveNext\nLoop\n</code></pre>\n\n<p>End If</p>\n\n<p>When I add new records the old attachments reappear without fail.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 4, "creation_date": 1487118882, "post_id": 42238566, "comment_id": 71636606, "body": "<code>wkbk.Sheets(&quot;All Data&quot;)</code> not <code>wkbk.Sheet(&quot;All Data&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 0, "last_activity_date": 1487142598, "creation_date": 1487142598, "answer_id": 42242779, "question_id": 42238566, "link": "https://stackoverflow.com/questions/42238566/copy-one-worksheet-to-multiple-workbooks-and-remove-external-references/42242779#42242779", "title": "Copy one worksheet to multiple workbooks and remove external references", "body": "<p>Replace the entire for-next loop with:</p>\n\n<pre><code>wkbk.Worksheets(\"All Data\").UsedRange.Value = wkbk.Worksheets(\"All Data\").UsedRange.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1487911200, "creation_date": 1487911200, "answer_id": 42430908, "question_id": 42238566, "link": "https://stackoverflow.com/questions/42238566/copy-one-worksheet-to-multiple-workbooks-and-remove-external-references/42430908#42430908", "title": "Copy one worksheet to multiple workbooks and remove external references", "body": "<p>What, exactly, are you trying to do?  Are you copying unique values in a column to different workbooks?  If so, run the script below.  This will do that thing.</p>\n\n<p>The range for the code example below looks like this</p>\n\n<pre><code>Column A : Header in A1 = Country, A2:A? = Country names\nColumn B : Header in B1 = Name, B2:B? = Names\nColumn C : Header in C1 = Gender, C2:C? = F or M\nColumn D : Header in D1 = Birthday, D2:D? = Dates\n</code></pre>\n\n<p>This example will create a new folder for you with a new workbook for every unique value in the first column of the range.The workbooks will be saved with the Unique value in the name into the newly created folder. It will also add a worksheet to your workbook named \"RDBLogSheet\" with hyperlinks to the newly created workbooks so it is easy to open the workbooks. Every time you run the macro it delete this worksheet first so the information is up to date.</p>\n\n<p>Check if the information in these lines in the macro is correct before you run the macro</p>\n\n<p>1: Set filter range on ActiveSheet: A1 is the top left cell of your filter range and the header of the first column, D is the last column in the filter range. You can also add the sheet name to the code like this :\nWorksheets(\"Sheet1\").Range(\"A1:D\" &amp; LastRow(Worksheets(\"Sheet1\")))\nNo need that the sheet is active then when you run the macro when you use this.\nSet My_Range = Range(\"A1:D\" &amp; LastRow(ActiveSheet))</p>\n\n<p>2: Set the Filter field:This example filter on the first column in the range (change the field if needed). In this case the range starts in A so Field 1 is </p>\n\n<pre><code>column A, 2 = column B, ......\nFieldNum = 1\n</code></pre>\n\n<p>3:Important:This macro call a function named LastRow\nYou find this function below the macro, copy this function together with the macro in a standard module</p>\n\n<pre><code>Sub Copy_To_Workbooks()\n'Note: This macro use the function LastRow\n    Dim My_Range As Range\n    Dim FieldNum As Long\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim ws2 As Worksheet\n    Dim MyPath As String\n    Dim foldername As String\n    Dim Lrow As Long\n    Dim cell As Range\n    Dim CCount As Long\n    Dim WSNew As Worksheet\n    Dim ErrNum As Long\n\n    'Set filter range on ActiveSheet: A1 is the top left cell of your filter range\n    'and the header of the first column, D is the last column in the filter range.\n    'You can also add the sheet name to the code like this :\n    'Worksheets(\"Sheet1\").Range(\"A1:D\" &amp; LastRow(Worksheets(\"Sheet1\")))\n    'No need that the sheet is active then when you run the macro when you use this.\n    Set My_Range = Range(\"A1:D\" &amp; LastRow(ActiveSheet))\n    My_Range.Parent.Select\n\n    If ActiveWorkbook.ProtectStructure = True Or _\n       My_Range.Parent.ProtectContents = True Then\n        MsgBox \"Sorry, not working when the workbook or worksheet is protected\", _\n               vbOKOnly, \"Copy to new workbook\"\n        Exit Sub\n    End If\n\n    'This example filters on the first column in the range(change the field if needed)\n    'In this case the range starts in A so Field:=1 is column A, 2 = column B, ......\n    FieldNum = 1\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    'Set the file extension/format\n    If Val(Application.Version) &lt; 12 Then\n        'You use Excel 97-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007-2013\n        If ActiveWorkbook.FileFormat = 56 Then\n            FileExtStr = \".xls\": FileFormatNum = 56\n        Else\n            FileExtStr = \".xlsx\": FileFormatNum = 51\n        End If\n    End If\n\n    'Change ScreenUpdating, Calculation, EnableEvents, ....\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    ViewMode = ActiveWindow.View\n    ActiveWindow.View = xlNormalView\n    ActiveSheet.DisplayPageBreaks = False\n\n    'Delete the sheet RDBLogSheet if it exists\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Sheets(\"RDBLogSheet\").Delete\n    Application.DisplayAlerts = True\n    On Error GoTo 0\n\n    ' Add worksheet to copy/Paste the unique list\n    Set ws2 = Worksheets.Add(After:=Sheets(Sheets.Count))\n    ws2.Name = \"RDBLogSheet\"\n\n    'Fill in the path\\folder where you want the new folder with the files\n    'you can use also this \"C:\\Users\\Ron\\test\"\n    MyPath = Application.DefaultFilePath\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'Create folder for the new files\n    foldername = MyPath &amp; Format(Now, \"yyyy-mm-dd hh-mm-ss\") &amp; \"\\\"\n    MkDir foldername\n\n    With ws2\n        'first we copy the Unique data from the filter field to ws2\n        My_Range.Columns(FieldNum).AdvancedFilter _\n                Action:=xlFilterCopy, _\n                CopyToRange:=.Range(\"A3\"), Unique:=True\n\n        'loop through the unique list in ws2 and filter/copy to a new sheet\n        Lrow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        For Each cell In .Range(\"A4:A\" &amp; Lrow)\n\n            'Filter the range\n            My_Range.AutoFilter Field:=FieldNum, Criteria1:=\"=\" &amp; _\n             Replace(Replace(Replace(cell.Value, \"~\", \"~~\"), \"*\", \"~*\"), \"?\", \"~?\")\n\n            'Check if there are no more then 8192 areas(limit of areas)\n            CCount = 0\n            On Error Resume Next\n            CCount = My_Range.Columns(1).SpecialCells(xlCellTypeVisible) _\n                     .Areas(1).Cells.Count\n            On Error GoTo 0\n            If CCount = 0 Then\n                MsgBox \"There are more than 8192 areas for the value : \" &amp; cell.Value _\n                     &amp; vbNewLine &amp; \"It is not possible to copy the visible data.\" _\n                     &amp; vbNewLine &amp; \"Tip: Sort your data before you use this macro.\", _\n                       vbOKOnly, \"Split in worksheets\"\n            Else\n                'Add new workbook with one sheet\n                Set WSNew = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n                'Copy/paste the visible data to the new workbook\n                My_Range.SpecialCells(xlCellTypeVisible).Copy\n                With WSNew.Range(\"A1\")\n                    ' Paste:=8 will copy the columnwidth in Excel 2000 and higher\n                    ' Remove this line if you use Excel 97\n                    .PasteSpecial Paste:=8\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                    .Select\n                End With\n\n                'Save the file in the new folder and close it\n                On Error Resume Next\n                WSNew.Parent.SaveAs foldername &amp; _\n                                    cell.Value &amp; FileExtStr, FileFormatNum\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    ErrNum = ErrNum + 1\n\n                    WSNew.Parent.SaveAs foldername &amp; _\n                     \"Error_\" &amp; Format(ErrNum, \"0000\") &amp; FileExtStr, FileFormatNum\n\n                    .Cells(cell.Row, \"B\").Formula = \"=Hyperlink(\"\"\" &amp; foldername &amp; _\n                      \"Error_\" &amp; Format(ErrNum, \"0000\") &amp; FileExtStr &amp; \"\"\")\"\n\n                    .Cells(cell.Row, \"A\").Interior.Color = vbRed\n                Else\n                    .Cells(cell.Row, \"B\").Formula = _\n                    \"=Hyperlink(\"\"\" &amp; foldername &amp; cell.Value &amp; FileExtStr &amp; \"\"\")\"\n                End If\n\n                WSNew.Parent.Close False\n                On Error GoTo 0\n            End If\n\n            'Show all the data in the range\n            My_Range.AutoFilter Field:=FieldNum\n\n        Next cell\n        .Cells(1, \"A\").Value = \"Red cell: can't use the Unique name as file name\"\n        .Cells(1, \"B\").Value = \"Created Files (Click on the link to open a file)\"\n        .Cells(3, \"A\").Value = \"Unique Values\"\n        .Cells(3, \"B\").Value = \"Full Path and File name\"\n        .Cells(3, \"A\").Font.Bold = True\n        .Cells(3, \"B\").Font.Bold = True\n        .Columns(\"A:B\").AutoFit\n\n    End With\n\n    'Turn off AutoFilter\n    My_Range.Parent.AutoFilterMode = False\n\n    If ErrNum &gt; 0 Then\n        MsgBox \"Rename every WorkSheet name that start with \"\"Error_\"\" manually\" _\n             &amp; vbNewLine &amp; \"There are characters in the name that are not allowed\" _\n             &amp; vbNewLine &amp; \"in a sheet name or the worksheet already exist.\"\n    End If\n\n    'Restore ScreenUpdating, Calculation, EnableEvents, ....\n    My_Range.Parent.Select\n    ActiveWindow.View = ViewMode\n    ws2.Select\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\nEnd Sub\n\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlValues, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win006_3.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s3/win006_3.htm</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7565809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f528deea9d48bbab9a3387f2d6d888?s=128&d=identicon&r=PG&f=1", "display_name": "lil_fitzg", "link": "https://stackoverflow.com/users/7565809/lil-fitzg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487911200, "creation_date": 1487117393, "last_edit_date": 1487143669, "question_id": 42238566, "link": "https://stackoverflow.com/questions/42238566/copy-one-worksheet-to-multiple-workbooks-and-remove-external-references", "title": "Copy one worksheet to multiple workbooks and remove external references", "body": "<p>I am trying to copy one worksheet <strong>All Data</strong> to around 140 other workbooks. None of the other workbooks have a worksheet with the same name. </p>\n\n<p>The code I am using is below</p>\n\n<pre><code>Sub DataAllSheet()\n\nDim path As String\nDim file As String\nDim wkbk As Workbook\nDim rCell As Range\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\npath = \"I:test\\\"\nfile = Dir(path)\n\nApplication.DisplayAlerts = False\n\nDo While Not file = \"\"\n    Workbooks.Open (path &amp; file)\n    Set wkbk = ActiveWorkbook\n    Sheets.Add After:=Sheets(Sheets.Count)\n\n    On Error GoTo Sheet_exists\n    ActiveSheet.Name = \"All Data\"\n    On Error GoTo 0\n    ThisWorkbook.Sheets(\"All Data\").Range(\"A2:DH2\").Copy    Destination:=wkbk.Sheets(\"All Data\").Range(\"A2\")\n\n    For Each rCell In wkbk.Sheet(\"All Data\").UsedRange\n        If InStr(rCell.Formula, ThisWorkbook.Name) &gt; 0 Then\n            rCell.Replace what:=\"[*]\", replacement:=\"\"\n        End If        \n    Next\n\n    wkbk.Save\n    wkbk.Close\n    file = Dir        \nLoop\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nExit Sub\n\nSheet_exists:\nSheets(\"All Data\").Delete\nResume\n\nEnd Sub\n</code></pre>\n\n<p>When I click run I get a Run-Time error 424 Object Required. When I click debug it highlights-  </p>\n\n<pre><code> For Each rCell In wkbk.Sheet(\"All Data\").UsedRange\n</code></pre>\n\n<p>I am not sure what object is required?</p>\n\n<p>I have just realized that some of the other workbooks in the I:test\\ folder are saved as .xlsx  would this cause the error?</p>\n"}, {"tags": ["forms", "vba", "ms-word", "save-as"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487116872, "post_id": 42238390, "comment_id": 71636049, "body": "So you don&#39;t want to save as template? then what type file you want to SaveAs?"}, {"owner": {"reputation": 21, "user_id": 7565726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iIItz.jpg?s=128&g=1", "display_name": "ThunderJ", "link": "https://stackoverflow.com/users/7565726/thunderj"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1487124804, "post_id": 42238390, "comment_id": 71638272, "body": "The template will be central, with many users opening a Document1.docx from it.  I&#39;d like the Document1.docx to be saved as in a specific location with a filename taken from the form."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1487207125, "post_id": 42238390, "comment_id": 71683431, "body": "You need to Save it including the path: <code>Doc.SaveAs2 StrPath &amp; &quot;\\&quot; &amp; strFilename</code>. Better to check if folder <i>StrPath</i> exists beforehand. Also consider a few UNC paths instead of <code>V:</code> like <code>\\\\FileServerNAS\\Documents\\ </code> or <code>\\\\YourWorkDomain.com\\DFSroot\\Site\\Documents\\ </code>. Alternatively, add <i>CustomDocumentProperties</i> to store this path."}, {"owner": {"reputation": 21, "user_id": 7565726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iIItz.jpg?s=128&g=1", "display_name": "ThunderJ", "link": "https://stackoverflow.com/users/7565726/thunderj"}, "edited": false, "score": 0, "creation_date": 1487385865, "post_id": 42238390, "comment_id": 71775744, "body": "That worked for including the path, thanks!  I&#39;d love to use a UNC path but for this application the company isn&#39;t set up that way."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7565726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iIItz.jpg?s=128&g=1", "display_name": "ThunderJ", "link": "https://stackoverflow.com/users/7565726/thunderj"}, "is_accepted": false, "score": 0, "last_activity_date": 1487386772, "last_edit_date": 1495540807, "creation_date": 1487386772, "answer_id": 42310590, "question_id": 42238390, "link": "https://stackoverflow.com/questions/42238390/ms-word-2013-form-create-a-save-as-and-submit-button-with-macro/42310590#42310590", "title": "MS Word 2013 Form, create a Save as and Submit Button with macro", "body": "<p>I was able to dig some more and solve the last part of my issue, thanks to this helpful link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/25242301/excel-reference-cell-value-to-get-email-recipient-for-selected-row\">excel: reference cell value to get email recipient for selected row?</a></p>\n\n<p>I ended up referencing the field value appended with &amp; \"example.com\" and then .CC the string, worked like a charm!</p>\n\n<p>Here's the code in total, I'm a very shallow end vba user so I'm sure there are cleaner ways, but this seems to work for what I need.</p>\n\n<pre><code>Private Sub CommandButton21_Click()\nDim OL              As Object\nDim EmailItem       As Object\nDim Doc             As Document\nDim strTagNum As String, strNTID As String, strDate As String\n\nstrTagNum = ActiveDocument.SelectContentControlsByTitle(\"TagNum\")(1).Range.Text\nstrNTID = ActiveDocument.SelectContentControlsByTitle(\"NTID\")(1).Range.Text\nstrDate = ActiveDocument.SelectContentControlsByTitle(\"Date\")(1).Range.Text\nDim strFilename As String\nstrFilename = strTagNum &amp; \"_\" &amp; strNTID &amp; \"_\" &amp; Format(strDate, \"ddmmyyyy\") &amp; \".docx\"\nEmail_Send_To = strNTID &amp; \"@example.com\"\n\nApplication.ScreenUpdating = False\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.CreateItem(olMailItem)\nSet Doc = ActiveDocument\n\nDoc.SaveAs2 StrPath &amp; \"V:\\Central\\Shared\\ARM\\ALERT\\SubmittedForms\\\" &amp; strFilename\n\n\nWith EmailItem\n.Subject = \"Continuous Improvement\"\n.Body = \"Please Review this Alert for Continuous Improvement\"\n.To = \"john.doe@example.com; onsiteengr@example.com; chrip@example.com\"\n.CC = Email_Send_To\n.Importance = olImportanceNormal\n.Attachments.Add Doc.FullName\n.Send\nEnd With\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Alert Record Submitted\"\n\nSet Doc = Nothing\nSet OL = Nothing\nSet EmailItem = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks to everyone who took a look and for the helpful code and comments!</p>\n"}], "owner": {"reputation": 21, "user_id": 7565726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iIItz.jpg?s=128&g=1", "display_name": "ThunderJ", "link": "https://stackoverflow.com/users/7565726/thunderj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2473, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1487386772, "creation_date": 1487116363, "last_edit_date": 1495541361, "question_id": 42238390, "link": "https://stackoverflow.com/questions/42238390/ms-word-2013-form-create-a-save-as-and-submit-button-with-macro", "title": "MS Word 2013 Form, create a Save as and Submit Button with macro", "body": "<p>I have a simple form (from a template) in Word 2013 and have a 'Submit' button that will:<br>\n1. Gather information from fields in the document, name the document, and saveAs.<br>\n2. Email the form to pre-set email addresses.  </p>\n\n<p>Multiple people will open a document from the template</p>\n\n<pre><code>Private Sub CommandButton21_Click()\nDim OL              As Object\nDim EmailItem       As Object\nDim Doc             As Document\nDim strTagNum As String, strNTID As String, strDate As String\n\nstrTagNum = ActiveDocument.SelectContentControlsByTitle(\"TagNum\")(1).Range.Text\nstrNTID = ActiveDocument.SelectContentControlsByTitle(\"NTID\")(1).Range.Text\nstrDate = ActiveDocument.SelectContentControlsByTitle(\"Date\")(1).Range.Text\nDim strFilename As String\nstrFilename = strTagNum &amp; \"_\" &amp; strNTID &amp; \"_\" &amp; Format(strDate, \"ddmmyyyy\") &amp; \".docx\"\nStrPath = \"V:\\OPS\\Central\\Shared\\ARM\\ALERT\"\n\nApplication.ScreenUpdating = False\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.CreateItem(olMailItem)\nSet Doc = ActiveDocument\n\nDoc.SaveAs2 strFilename\n\n\nWith EmailItem\n.Subject = \"CGF ARM - ALERT ADD/DROP/CHANGE\"\n.Body = \"Please Review this Alert for Continuous Improvement\"\n.To = \"john.doe@example.com\"\n.Importance = olImportanceNormal\n.Attachments.Add Doc.FullName\n.Send\nEnd With\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Alert Record Submitted\"\n\nSet Doc = Nothing\nSet OL = Nothing\nSet EmailItem = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>(Credit to Neil Malek at knacktraining.com)<br>\nand this topic<br>\n<a href=\"https://stackoverflow.com/questions/32047917/microsoft-word-2013-macro-save-file-name-from-form-content?answertab=votes#tab-top\">Microsoft Word 2013 macro save file name from form content</a></p>\n\n<p>My questions are:<br>\n1. How do I specify the filepath for the saveAs?  I have the code in the Macro but the document is being saved in the individual users' Documents folder.</p>\n\n<ol start=\"2\">\n<li>How to I tell the Macro to pull the username from the form and send it to \"username\"@example.com?</li>\n</ol>\n\n<p>The rest of the macro works, when the 'Submit' button is pushed, the document is renamed, saved, and sent as an email to pre-set email addresses.</p>\n\n<p>I've updated this from the original question, I was able to answer some of my prevous questions through trial and error.</p>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1487117266, "post_id": 42238310, "comment_id": 71636151, "body": "<code>Me.Controls(butName)</code>..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1487121042, "post_id": 42238310, "comment_id": 71637272, "body": "You are calling <code>tableList.MoveFirst</code> on every iteration through the recordset loop"}, {"owner": {"reputation": 55, "user_id": 5104210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a42c805a037c5fe0221b24cda6e7d974?s=128&d=identicon&r=PG&f=1", "display_name": "AJK", "link": "https://stackoverflow.com/users/5104210/ajk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1487169392, "post_id": 42238310, "comment_id": 71662146, "body": "@TimWilliams Yes, thank you. I just quickly jotted out the code and was trying to see if I could figure out how to address the control name. Fixed and annotated the sample code to reflect your correction."}, {"owner": {"reputation": 55, "user_id": 5104210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a42c805a037c5fe0221b24cda6e7d974?s=128&d=identicon&r=PG&f=1", "display_name": "AJK", "link": "https://stackoverflow.com/users/5104210/ajk"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487170026, "post_id": 42238310, "comment_id": 71662639, "body": "@Comintern <code>Me.Controls.(butName)</code> worked beautifully. Thank you! :) The community may appreciate it if you post that as an answer, so that I may mark it as such."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1487170293, "post_id": 42238310, "comment_id": 71662877, "body": "<code>Me(butName).Enabled = False</code> while you&#39;re at it. :p"}, {"owner": {"reputation": 55, "user_id": 5104210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a42c805a037c5fe0221b24cda6e7d974?s=128&d=identicon&r=PG&f=1", "display_name": "AJK", "link": "https://stackoverflow.com/users/5104210/ajk"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1487172347, "post_id": 42238310, "comment_id": 71664519, "body": "@Andre Haha. Yeah. VBA messes me up when I don&#39;t touch it for a month, and then have to go back and adjust something. I&#39;m still not quite sure on when it wants<code>()</code> and when it does not. Apparently fatigue makes me also leave out <code>=</code> now and then.  xD"}, {"owner": {"reputation": 55, "user_id": 5104210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a42c805a037c5fe0221b24cda6e7d974?s=128&d=identicon&r=PG&f=1", "display_name": "AJK", "link": "https://stackoverflow.com/users/5104210/ajk"}, "edited": false, "score": 0, "creation_date": 1487192399, "post_id": 42238310, "comment_id": 71677509, "body": "I ended up not using <code>Me.Controls.(butName)</code> in the final code, but that did help to get the preliminary code running quickly to test some stuff. Also, it&#39;s good to know that it can be done."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5104210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a42c805a037c5fe0221b24cda6e7d974?s=128&d=identicon&r=PG&f=1", "display_name": "AJK", "link": "https://stackoverflow.com/users/5104210/ajk"}, "edited": false, "score": 0, "creation_date": 1487173780, "post_id": 42238433, "comment_id": 71665639, "body": "This concept looks useful. It would allow me to code the enabled/disabled logic separately and call it at will, so that it would be called again after a button is pressed. I recently thought that perhaps the buttons should actively disable themselves after verifying a successful data transaction. The nature of the operator&#39;s job causes much distraction, so any kind of progress indication would be helpful."}, {"owner": {"reputation": 55, "user_id": 5104210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a42c805a037c5fe0221b24cda6e7d974?s=128&d=identicon&r=PG&f=1", "display_name": "AJK", "link": "https://stackoverflow.com/users/5104210/ajk"}, "edited": false, "score": 0, "creation_date": 1487192343, "post_id": 42238433, "comment_id": 71677486, "body": "There are more buttons on the form than the ones to be iterated, so instead of <code>If TypeName(ctrl) = &quot;Button&quot; Then</code> I ended up tagging all the buttons to be handled and then selected them with <code>If ctrl.Tag = &quot;tagName&quot; Then</code>. Separating the iteration code from the enable/disable code has made the project a bit more flexible. Thank you very much."}], "tags": [], "owner": {"reputation": 487, "user_id": 1602286, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05396893155418a0a93052cb05f64a3f?s=128&d=identicon&r=PG", "display_name": "Michael Daniloff", "link": "https://stackoverflow.com/users/1602286/michael-daniloff"}, "is_accepted": true, "score": 1, "last_activity_date": 1487116617, "creation_date": 1487116617, "answer_id": 42238433, "question_id": 42238310, "link": "https://stackoverflow.com/questions/42238310/is-there-a-way-in-vba-to-iterate-through-specific-objects-on-a-form/42238433#42238433", "title": "Is there a way in VBA to iterate through specific objects on a form?", "body": "<p>I'm not an expert on VBA, but I would re-arrange the code to take advantage of the fact that you can iterate through the control collection in the user form</p>\n\n<p>Something like this:</p>\n\n<pre><code>Dim ctrl as Control\n\nFor Each ctrl in UserForm1.Controls\n\n  If TypeName(ctrl) = \"Button\" Then\n    ctrl.Enabled = True\n  End If\nNext\n</code></pre>\n\n<p>You can pass the button name to some other function (from this loop) to determine whether the button in  question should be enabled / disabled.</p>\n"}], "owner": {"reputation": 55, "user_id": 5104210, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a42c805a037c5fe0221b24cda6e7d974?s=128&d=identicon&r=PG&f=1", "display_name": "AJK", "link": "https://stackoverflow.com/users/5104210/ajk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 42238433, "answer_count": 1, "score": 0, "last_activity_date": 1487169286, "creation_date": 1487115943, "last_edit_date": 1487169286, "question_id": 42238310, "link": "https://stackoverflow.com/questions/42238310/is-there-a-way-in-vba-to-iterate-through-specific-objects-on-a-form", "title": "Is there a way in VBA to iterate through specific objects on a form?", "body": "<p>I would like to have a subroutine in VBA that conditionally changes the <code>Enabled</code> property of each of 20+ buttons on a form via iteration rather than code them all by hand. These buttons are named similar to tables that they process. For example: A table to process is called \"CUTLIST\"; its corresponding button is called \"but_CUTLIST\". There is another table that holds the list of tables to be processed (used for iteration purposes in other subs).</p>\n\n<p><strong>What I have so far...</strong></p>\n\n<pre><code>Private Sub txt_DataSet_GotFocus()\n\nDim sqlQry as String\nDim butName As String\nDim tableList As Recordset\nDim tempTable As Recordset\n\nSet tableList = CurrentDb.OpenRecordset(\"TableList\") 'names of tables for user to process\ntableList.MoveFirst 'this line was corrected by moving out of the loop\n\nDo Until tableList.EOF\n    sqlQry = 'SQL query that determines need for the button to be enabled/disabled\n    Set tempTable = CurrentDb.OpenRecordset(sqlQry)\n    If tempTable.RecordCount &gt; 0 Then \n        'begin code that eludes me\n        butName = \"but_\" &amp; tableList!tName\n        Me(butName).Enabled False\n        'end code that eludes me\n    End If\n    tableList.MoveNext\nLoop  \n\nEnd Sub\n</code></pre>\n\n<p>If I remember correctly, JavaScript is capable of calling upon objects through a variable by handling them as elements of the document's object \"array.\" Example: <code>this[objID]=objVal</code> Is such a thing possible with VBA or am I just going about this all wrong?</p>\n\n<p>Viewing other questions... is this what's called \"reflection\"? If so, then this can't be done in VBA. :(</p>\n\n<p><em>In case more explanation helps to answer the question better...</em> I have a utility that runs SQL queries against a pre-defined set of tables. Each table has its own button, so that the user may process a query against any of the tables as needed. Depending on circumstances happening to data beforehand, any combination of the tables may need to be queried via pressing of said buttons. Constantly referring to the log, to see what was already done, gets cumbersome after processing several data sets. So, I'd like to have the buttons individually disable themselves if they are not needed for the currently focused data set. I have another idea on how to make that happen, but making this code work would be faster and I would learn something.</p>\n"}]