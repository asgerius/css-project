[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559174200, "post_id": 56369928, "comment_id": 99342375, "body": "As always, if you&#39;re getting an error, please include the text of the error and let folks know on which line it occurs."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559174313, "post_id": 56369928, "comment_id": 99342399, "body": "<code>PartGroupSheet.Range(Cell1:=2, Cell2:=1)</code> is not a valid table reference.  VLookup is not that good with partial matches, so it may not even be useful here.  If you add some sample data showing the types of values you&#39;re trying to match that would be useful."}, {"owner": {"reputation": 31, "user_id": 10102274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NNiJYRQ5sfY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pX1UzzhfVtiQOKpW2UTquoHgzMxg/mo/photo.jpg?sz=128", "display_name": "Adrian Hudson", "link": "https://stackoverflow.com/users/10102274/adrian-hudson"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559174939, "post_id": 56369928, "comment_id": 99342543, "body": "@TimWilliams I updated the post with the relevant info - thanks for the help I apologize about my sloppy posting. Hope the pictures help"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10102274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NNiJYRQ5sfY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pX1UzzhfVtiQOKpW2UTquoHgzMxg/mo/photo.jpg?sz=128", "display_name": "Adrian Hudson", "link": "https://stackoverflow.com/users/10102274/adrian-hudson"}, "edited": false, "score": 0, "creation_date": 1559178457, "post_id": 56370101, "comment_id": 99343215, "body": "Tim, you are a legend. Thank you very much, I can&#39;t seem to wrap my head around the syntax coming from Python but I digress.  Cheers,"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1559175460, "creation_date": 1559175460, "answer_id": 56370101, "question_id": 56369928, "link": "https://stackoverflow.com/questions/56369928/indexing-by-row-on-a-column-and-finding-partial-matches-in-a-string/56370101#56370101", "title": "Indexing by ROW on a Column and finding partial matches in a string", "body": "<p>Something like this should work:</p>\n\n<pre><code>Sub JoinGroupOnPN()\n    Dim PartGroupSheet As Worksheet\n    Dim v, c As Range, rngSrch As Range\n\n    Set PartGroupSheet = ActiveWorkbook.Worksheets(\"PartGroup\")\n\n    With ActiveWorkbook.Worksheets(\"OEE Report\")\n        Set rngSrch = .Range(.Range(\"B2\"), .Cells(.Rows.Count, \"B\").End(xlUp))\n    End With\n\n    For Each c In rngSrch.Cells\n        If Len(c.Value) &gt; 0 Then\n            'do not use WorksheetFunction here\n            v = Application.VLookup(c.Value, PartGroupSheet.Range(\"B:C\"), 2, False)\n            c.Offset(0, 1).Value = IIf(IsError(v), \"No match\", v)\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10102274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NNiJYRQ5sfY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pX1UzzhfVtiQOKpW2UTquoHgzMxg/mo/photo.jpg?sz=128", "display_name": "Adrian Hudson", "link": "https://stackoverflow.com/users/10102274/adrian-hudson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 56370101, "answer_count": 1, "score": 0, "last_activity_date": 1566016328, "creation_date": 1559173806, "last_edit_date": 1566016328, "question_id": 56369928, "link": "https://stackoverflow.com/questions/56369928/indexing-by-row-on-a-column-and-finding-partial-matches-in-a-string", "title": "Indexing by ROW on a Column and finding partial matches in a string", "body": "<p>I am having issues developing a for loop that incorporates a partial match feature.</p>\n\n<p>To breakdown the problem:</p>\n\n<p>I have two sheets that are going to be compared - one exists on sheet1 column b and the other sheet2 column c.</p>\n\n<p>The for loop will iterate through column B on Sheet1 and then extract the current string at each row - this current string is then passed <em>I tried vlookup</em> and compared to the ENTIRE column C on sheet 2 to find a match: if there is a match it will then return the ADJACENT column to the right of Column C and then Deposit this value to the ADJACENT Column to the right of Column B.</p>\n\n<p>I have currently tried implementing a for if statement that iterates through Column b and if the current string of Column B is equal to a Vlookup of Column C for the match on Current string then return the value.</p>\n\n<pre><code>Sub JoinGroupOnPN()\nDim PartGroupSheet As Worksheet\nDim OEEPartSheet As Worksheet    \nDim OEERowRange As Long    \nDim OEEColumnRange As Long    \nDim PGRowRange As Long    \nDim PGColumnRange As Long    \nDim OEEArray As Variant    \nDim PGArray As Variant    \nDim i As Long, j As Long\n\nSet PartGroupSheet = ActiveWorkbook.Worksheets(\"PartGroup\")    \nSet OEEPartSheet = ActiveWorkbook.Worksheets(\"OEE Report\")    \nOEERowRange = OEEPartSheet.Cells(Rows.Count, 1).End(xlUp).Row    \nOEEColumnRange = OEEPartSheet.Cells(1,Columns.Count).End(xlToLeft).Row    \nPGRowRange = PartGroupSheet.Cells(Columns.Count, 1).End(xlUp).Row    \nPGColumnRange = PartGroupSheet.Cells(1,Columns.Count).End(xlToLeft).Row\nReDim OEEArray(OEERowRange, OEEColumnRange)    \nReDim PGArray(PGRowRange, PGColumnRange)    \nDim StringToMatch As String    \nDim MatchingString As String\n\nFor i = 2 To OEERowRange\nStringToMatch = OEEPartSheet.Cells(i, 1).Text\nMatchingString = Application.WorksheetFunction.VLookup(Arg1:=StringToMatch, Arg2:=PartGroupSheet.Range(Cell1:=2, Cell2:=1), Arg3:=2, Arg4:=True)\n\n    For j = 2 To PGRowRange\n\n        If StringToMatch = MatchingString Then\n\n            Debug.Print StringToMatch\n\n        End If\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I keep getting an error that says the range object failed and I have tried converting it to a range type but still same error.</p>\n\n<p>The Error happens at</p>\n\n<pre><code>MatchingString = Application.WorksheetFunction.VLookup(Arg1:=StringToMatch, Arg2:=PartGroupSheet.Range(Cell1:=2, Cell2:=1), Arg3:=2, Arg4:=True)\n</code></pre>\n\n<p>and the error message is Method 'Range' of 'Object'_WorkSheet Failed</p>\n\n<p>I cant post any pictures yet</p>\n\n<p><a href=\"https://i.stack.imgur.com/4GOqP.png\" rel=\"nofollow noreferrer\">Sheet 1</a>\n<a href=\"https://i.stack.imgur.com/WwhER.png\" rel=\"nofollow noreferrer\">Sheet 2</a></p>\n\n<p>Any help would be appreciated thanks !!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15, "user_id": 11542013, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Se72Hp6l7cQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTi-WPEqvsZk_ue-1HdSF2CiOesA/mo/photo.jpg?sz=128", "display_name": "Tom Foley", "link": "https://stackoverflow.com/users/11542013/tom-foley"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559171077, "post_id": 56369469, "comment_id": 99341729, "body": "Can I add a column which is a count of each date so that will identify them as unique? My issue would be implementing a loop with this @alowflyingpig"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559171658, "post_id": 56369469, "comment_id": 99341842, "body": "Just want clarity on your wanted outcome - Search Reporting(Sht) for a date and match that date on Source(Sht), if found, copy entire(?) row from Source(Sht) to Reporting(Sht). Is this right? If so what col are the dates in?"}, {"owner": {"reputation": 15, "user_id": 11542013, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Se72Hp6l7cQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTi-WPEqvsZk_ue-1HdSF2CiOesA/mo/photo.jpg?sz=128", "display_name": "Tom Foley", "link": "https://stackoverflow.com/users/11542013/tom-foley"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559171945, "post_id": 56369469, "comment_id": 99341906, "body": "@alowflyingpig no- if match, i dont want to copy the entire column, instead, I want to copy a single cell which is the same row as the matched date from Source(Sht) to a cell in the same row as the corresponding date in the Reporting(Sht)."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559177232, "post_id": 56369469, "comment_id": 99342954, "body": "what cols are your data in? and what col is the data you want copied in and copied to?"}, {"owner": {"reputation": 15, "user_id": 11542013, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Se72Hp6l7cQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTi-WPEqvsZk_ue-1HdSF2CiOesA/mo/photo.jpg?sz=128", "display_name": "Tom Foley", "link": "https://stackoverflow.com/users/11542013/tom-foley"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559245796, "post_id": 56369469, "comment_id": 99369651, "body": "@alowflyingpig I want data copied from sheet 2 column 1 to sheet 1 column 2"}, {"owner": {"reputation": 15, "user_id": 11542013, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Se72Hp6l7cQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTi-WPEqvsZk_ue-1HdSF2CiOesA/mo/photo.jpg?sz=128", "display_name": "Tom Foley", "link": "https://stackoverflow.com/users/11542013/tom-foley"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559262224, "post_id": 56369469, "comment_id": 99374239, "body": "@alowflyingpig dates are in sheet 1 column 1 sheet 2 column 2"}], "owner": {"reputation": 15, "user_id": 11542013, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Se72Hp6l7cQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdTi-WPEqvsZk_ue-1HdSF2CiOesA/mo/photo.jpg?sz=128", "display_name": "Tom Foley", "link": "https://stackoverflow.com/users/11542013/tom-foley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559170309, "creation_date": 1559169976, "last_edit_date": 1559170309, "question_id": 56369469, "link": "https://stackoverflow.com/questions/56369469/how-to-match-dates-then-copy-respective-data-from-one-spreadsheet-to-another-if", "title": "How to match dates then copy respective data from one spreadsheet to another if the dates are repeated but the data is unique?", "body": "<p>I would like to search a reporting spreadsheet(1) for a date and then search for that date in a data source spreadsheet(2). Once found, I would like to copy and paste data (from the same row as the date in (2)) into the corresponding date in the reporting spreadsheet(1).</p>\n\n<p>However, there are multiple repetitions of each date (in both 1 and 2) but all the data corresponding to respective dates (in spreadsheet 2) is unique, so I would like to search for a matching date and then copy and paste the data to the corresponding row, but then not use this same row again, and move on to the next match... </p>\n\n<p>Currently, my macro copies data from (2) to (1) according to matching date, but if there are 6 repetitions of the date, only the 6th match of the dates (with corresponding data) is used for all rows. </p>\n\n<pre><code>Sub Macroturnip()\n'\n' Macroturnip Macro\n'\n\nDim Row As Double 'row is the row variable for the destination spreadsheet\nDim i As Date\nDim x As Long 'x is the row variable for the source spreadsheet\n\n\nFor Row = 1 To 825\n\n    i = Sheets(\"1\").Cells(Row, 1)\n\n      If i &lt;&gt; DateSerial(1900, 1, 0) Then\n        'DateSerial(1900, 1, 0) --&gt; this is the default for no data in the field, i.e. i want to skip these\n\n            For x = 1 To 450\n\n                If Sheets(\"2\").Cells(x, 2) = Sheets(\"1\").Cells(Row, 1) Then\n                Sheets(\"2\").Select\n                Cells(x, 1).Select\n                Selection.Copy\n                Sheets(\"1\").Select\n                Cells(Row, 2).Select\n                ActiveSheet.Paste\n\n                End If\n\n            Next x\n\n\n\n     End If\n\n\n\nNext Row\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1559184196, "post_id": 56369071, "comment_id": 99344256, "body": "so the pink rows are where the id should be repeated and the others leave column D blank?"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "reply_to_user": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "edited": false, "score": 0, "creation_date": 1559229489, "post_id": 56369071, "comment_id": 99362337, "body": "that is correct."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1559240588, "post_id": 56382868, "comment_id": 99367492, "body": "Thank you Jeremy, but this is not an option as the lists are not a 1 to 1 match. meaning if A is 300 total rows and C is 2600 I need to find the matching row. so lets say &quot;A300&quot; is the same as &quot;C1400&quot; if I do 1 to 1 matching then it is not going to be equal"}, {"owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "reply_to_user": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1559244478, "post_id": 56382868, "comment_id": 99369095, "body": "Oh, because I thought that&#39;s what the pinks in the example were showing. So let me try to restate this better. I read the value in column C. Then I look down the whole A column for a match. If I find one, I put  its neighbor from column B next to the current C row I&#39;m looking at, in column D.  What if I find more than one match? Take the first? (Should never happen?)"}, {"owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "edited": false, "score": 0, "creation_date": 1559254487, "post_id": 56382868, "comment_id": 99372619, "body": "Thank you Jeremy, this is just what I was looking for."}], "tags": [], "owner": {"reputation": 3129, "user_id": 6656050, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMh8v.jpg?s=128&g=1", "display_name": "Jeremy Kahan", "link": "https://stackoverflow.com/users/6656050/jeremy-kahan"}, "is_accepted": true, "score": 1, "last_activity_date": 1559245391, "last_edit_date": 1559245391, "creation_date": 1559237023, "answer_id": 56382868, "question_id": 56369071, "link": "https://stackoverflow.com/questions/56369071/match-column-a-to-d-and-use-column-b-id-and-place-it-in-front-of-the-match/56382868#56382868", "title": "match column &quot;A&quot; to &quot;D&quot; and use Column &quot;B&quot; id and place it in front of the matching value on &quot;D&quot;", "body": "<p>Your \"IF\" logic can be captured by the IF function. So you put this formula in D2 and drag it down as far as you wish.</p>\n\n<pre><code>=if(A2=C2,B2,\"\")\n</code></pre>\n\n<p>Revision: The above would work if the match were to be checked for in the same row. But I now understand we are supposed to look in the entire column A. In that case, we can do the following in D2 and drag,</p>\n\n<pre><code>=iferror(indirect(address(1+match(C2,A$2:A,0),2)),\"\")\n</code></pre>\n\n<p>The iferror lets the thing stay empty if match fails. If match succeeds, 1+match is the row, and 2 is column B. We make an address of that and find what is at that address.</p>\n"}], "owner": {"reputation": 53, "user_id": 11223347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/995dcf05b496ba37c3965d07e8dde4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Spock", "link": "https://stackoverflow.com/users/11223347/spock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 56382868, "answer_count": 1, "score": 0, "last_activity_date": 1565956738, "creation_date": 1559167053, "last_edit_date": 1565956738, "question_id": 56369071, "link": "https://stackoverflow.com/questions/56369071/match-column-a-to-d-and-use-column-b-id-and-place-it-in-front-of-the-match", "title": "match column &quot;A&quot; to &quot;D&quot; and use Column &quot;B&quot; id and place it in front of the matching value on &quot;D&quot;", "body": "<p>I am fairly new to Excel and VBA.</p>\n\n<p>Column \"A\" has an ID listed on \"B\" and column C has the total list not included on \"A\" what I am trying to do is (<code>if \"A\"=\"C</code>) then use the ID from \"B\" and place it/copy in front of \"D\" </p>\n\n<pre><code>=INDEX(B2,MATCH(A2,C2))\n</code></pre>\n\n<p>I am thinking to create a macro where I can just copy the list of test to another sheet then match the values, as column \"A\" and \"C\" are not the same then copy the value from \"B\" to \"D\" if \"A\" is found on \"C\"\nI have more than 2500 values that will be part of column \"C\" but column \"A\" will never have the same number of rows as \"C\"\nI know it looks simple from the screenshot but the naming convention is different.</p>\n\n<p>I hope it make sense what I am trying to explain here. if not please let me know\n<a href=\"https://i.stack.imgur.com/bFtyF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bFtyF.png\" alt=\"Screenshot of Excel sheet\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula", "pivot-table", "slicers"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559165818, "post_id": 56368839, "comment_id": 99340355, "body": "Are you getting an error? Please add  more detail to your question."}, {"owner": {"reputation": 49, "user_id": 11049128, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156252663502686/picture?type=large", "display_name": "Shobi", "link": "https://stackoverflow.com/users/11049128/shobi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559165916, "post_id": 56368839, "comment_id": 99340382, "body": "@BigBen No, I&#39;m not getting any error. It&#39;s just doesn&#39;t do anything."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559170107, "post_id": 56368839, "comment_id": 99341507, "body": "Does it just hit the <code>Exit Sub</code> line?  Have you added some breakpoints and tried triggering the code?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559170886, "post_id": 56368839, "comment_id": 99341700, "body": "This works for me."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559175687, "post_id": 56368839, "comment_id": 99342684, "body": "Check you haven&#39;t somehow disabled events - restarting excel will fix that, or put <code>Application.EnableEvents = True</code> in the Immediate pane and hit enter"}], "owner": {"reputation": 49, "user_id": 11049128, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156252663502686/picture?type=large", "display_name": "Shobi", "link": "https://stackoverflow.com/users/11049128/shobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1589408708, "creation_date": 1559165693, "last_edit_date": 1566044996, "question_id": 56368839, "link": "https://stackoverflow.com/questions/56368839/hide-entire-column-based-on-slicer-selection", "title": "Hide entire column based on Slicer selection", "body": "<p>I have a pivot table(PivotTable1) and slicer called Team. Slicer has 4 options, what I want is, when a user selects Re-issue from slicer only then column G pops-up otherwise it should be hidden for the other three options. </p>\n\n<p>Below code does not do anything when I make the Re-issue selection on the slicer. I'm not getting any errors neither the required result. </p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate (ByVal Target As PivotTable)\n    If Target.Name &lt;&gt; \"PivotTable1\" Then\n        Exit Sub\n    Else\n       If Parent.SlicerCaches(\"Team\").SlicerItems(\"Re-issue\").Selected = True Then\n        Columns(\"G:G\").EntireColumn.Hidden = False\n       Else\n        Columns(\"G:G\").EntireColumn.Hidden = True\n       End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7, "user_id": 11574967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5514b8438a2b5368bd3a08dcf0430f6a?s=128&d=identicon&r=PG&f=1", "display_name": "J.Sutter", "link": "https://stackoverflow.com/users/11574967/j-sutter"}, "edited": false, "score": 0, "creation_date": 1567605227, "post_id": 56368682, "comment_id": 102013056, "body": "I used the Macro solution and it works great.  Very good answer."}], "answers": [{"tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 1, "last_activity_date": 1559236213, "last_edit_date": 1559236213, "creation_date": 1559165384, "answer_id": 56368787, "question_id": 56368682, "link": "https://stackoverflow.com/questions/56368682/can-i-run-a-vba-macro-to-run-sql-queries-i-have-saved-in-a-ms-access-database/56368787#56368787", "title": "Can I run a VBA macro to run SQL queries I have saved in a MS Access database?", "body": "<p>You can do something like this to run saved queries:</p>\n\n<pre><code>Dim db As DAO.Database, qry As DAO.QueryDef\n\nSet db = CurrentDb\n\nDebug.Print \"-- Start --\"\nFor Each qry In db.QueryDefs\n    If qry.Name Like pattern Then\n        Debug.Print qry.Name,\n        qry.Execute\n        Debug.Print \"(\" &amp; qry.RecordsAffected &amp; \")\"\n    End If\nNext\nDebug.Print \"-- End --\"\n\ndb.Close()\n</code></pre>\n\n<p>Name the queries so that the alphabetical order matches the the expected execution order, e.g., <code>01_deleteCustomers</code>, <code>02_appendCustomers</code>, <code>03_etc</code>.</p>\n\n<p>Specify a <code>pattern</code> string or remove the <code>If</code> alltogether if you want to run all the queries.</p>\n\n<p>Note that in the Visual Basic editor under menu <code>Tools</code> > <code>References...</code> I have selected <code>Microsoft DAO 3.6 Object Library</code>. (You might have another version)</p>\n"}, {"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1559230379, "post_id": 56368870, "comment_id": 99362848, "body": "BTW - MS Access has the <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/querydefs-collection-dao\" rel=\"nofollow noreferrer\">QueryDefs collection</a> and can be iterated on instead of listing all manually in an array."}], "tags": [], "owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "is_accepted": false, "score": 1, "last_activity_date": 1559165830, "creation_date": 1559165830, "answer_id": 56368870, "question_id": 56368682, "link": "https://stackoverflow.com/questions/56368682/can-i-run-a-vba-macro-to-run-sql-queries-i-have-saved-in-a-ms-access-database/56368870#56368870", "title": "Can I run a VBA macro to run SQL queries I have saved in a MS Access database?", "body": "<p>Here is another method if you don't have specific naming conventions utilizing an array for the query names in execution order:</p>\n\n<pre><code>Public Sub RunMasterUpdate()\n\n    Dim qryList As Variant\n    Dim i As Long\n\n    qryList = Array(\"QueryName1\", \"QueryName2\", \"QueryName3\")\n\n    For i = LBound(qryList) To UBound(qryList)\n        CurrentDb.Execute qryList(i)\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 3, "last_activity_date": 1559166261, "creation_date": 1559166261, "answer_id": 56368944, "question_id": 56368682, "link": "https://stackoverflow.com/questions/56368682/can-i-run-a-vba-macro-to-run-sql-queries-i-have-saved-in-a-ms-access-database/56368944#56368944", "title": "Can I run a VBA macro to run SQL queries I have saved in a MS Access database?", "body": "<p>In its very simplest form, you can define a <code>Sub</code> such as: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ExecuteQueries()\n    With CurrentDb\n        .Execute \"MyQuery1\"\n        .Execute \"MyQuery2\"\n        '...\n        .Execute \"MyQueryN\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Or define this as a <code>Function</code> in a public module if you intend to invoke this from an MS Access Macro.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 3, "last_activity_date": 1559226404, "creation_date": 1559226404, "answer_id": 56380204, "question_id": 56368682, "link": "https://stackoverflow.com/questions/56368682/can-i-run-a-vba-macro-to-run-sql-queries-i-have-saved-in-a-ms-access-database/56380204#56380204", "title": "Can I run a VBA macro to run SQL queries I have saved in a MS Access database?", "body": "<p>To clear a few terminologies:</p>\n\n<ol>\n<li><p>MS Access GUI comprises of five main object types: tables, queries, forms, macros, and modules. Technically, there is no such thing as <em>VBA macros</em> in MS Access. This is a terminology from MS Excel where each subroutine is defined as a macro. </p>\n\n<p>In MS Access there is a physical object known as a <a href=\"https://support.office.com/en-us/article/introduction-to-macros-a39c2a26-e745-4957-8d06-89e0b435aac3\" rel=\"nofollow noreferrer\">macro</a> which is divorced from VBA (though can call VBA code). Coded routines which includes all functions and subroutines in MS Access are encapsulated in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.module\" rel=\"nofollow noreferrer\">module</a> (object) usually behind forms, reports, or standalone modules. </p></li>\n<li><p>Do remember each Microsoft Office application maintains its own object library and should not be conflated with one another. VBA itself is a separate component installed by default (see Tools \\ References in IDE). <em>Any</em> language (Java, PHP, Python, etc.) that can run COM-interfacing can connect and run each Office app's object library. VBA is simply one type that does this.</p></li>\n<li><p>MS Access maintains stored queries (as another object) which can be actions queries (<code>UPDATE</code>, <code>INSERT</code> even <code>CREATE TABLE</code> or <code>ALTER TABLE</code>) or recordset queries (<code>SELECT</code>). You do not have to copy all of SQL code inside VBA to run these saved query objects. In fact, stored queries run more efficiently than string queries called in code since the MS Access engine compiles the best execution plan with stored queries.</p></li>\n</ol>\n\n<hr>\n\n<p>Having said that, consider a macro calling multiple <a href=\"https://support.office.com/en-us/article/openquery-macro-action-d3f1eed8-9cc4-4962-9039-f4ae5966ccf5\" rel=\"nofollow noreferrer\">OpenQuery</a> actions or coded subroutine inside a module calling multiple <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.openquery\" rel=\"nofollow noreferrer\"><code>DoCmd.OpenQuery</code></a> commands</p>\n\n<p><strong>Macro</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>OpenQuery    \n   QueryName: myfirstActionQuery\n        View: Datasheet\n   Data Mode: Edit\n\nOpenQuery    \n   QueryName: mySecondActionQuery\n        View: Datasheet\n   Data Mode: Edit\n\nOpenQuery    \n   QueryName: myThirdActionQuery\n        View: Datasheet\n   Data Mode: Edit\n\n...\n</code></pre>\n\n<p>For action queries you do not have to close the query as <code>OpenQuery</code> runs process without physically opening anything to screen. You may want to incorporate the <code>SetWarnings</code> to <code>False</code> action in order to avoid the message prompt of how much records will be updated or inserted which is a default setting in Access. Because this is a potentially hazardous action, click <code>Show All Actions</code> to see this specific action.</p>\n\n<p><strong>Module</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub RunQueries()    \n     DoCmd.SetWarnings False\n\n     DoCmd.OpenQuery \"myfirstSavedQuery\"\n     DoCmd.OpenQuery \"mySecondSavedQuery\"\n     DoCmd.OpenQuery \"myThirdSavedQuery\"\n     ...\n\n     DoCmd.SetWarnings True\nEnd Sub\n</code></pre>\n\n<p>Similar to macros, you do not have to close action queries and can call the <code>DoCmd.SetWarnings</code> to suppress the message prompts with each update, insert, or make-table action. </p>\n\n<p>The alternative to turning <code>SetWarnings</code> off and on is <a href=\"https://stackoverflow.com/a/56368944/1422451\">@LeeMac's solution</a> which runs queries using the DAO's <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/database-execute-method-dao\" rel=\"nofollow noreferrer\">Database.Execute()</a> command. In fact, because DAO is part of the MS Access object library, the above method can be run outside VBA as mentioned above.</p>\n\n<p><strong>Python</strong></p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import os\nimport win32com.client\n\naccess_file = r'C:\\Path\\To\\MyDatabase.accdb'\n\ntry:\n    oApp = win32com.client.Dispatch(\"Access.Application\")\n    oApp.OpenCurrentDatabase(access_file)\n\n    db = oApp.Currentdb()\n    db.Execute(\"myFirstSavedQuery\")\n    db.Execute(\"mySecondSavedQuery\")\n    db.Execute(\"myThirdSavedQuery\")\n    ...   \n\nexcept Exception as e:\n    print(e)\n\nfinally:\n    oApp.Quit()\n    db = None; oApp = None\n    del db; del oApp\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11574967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5514b8438a2b5368bd3a08dcf0430f6a?s=128&d=identicon&r=PG&f=1", "display_name": "J.Sutter", "link": "https://stackoverflow.com/users/11574967/j-sutter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1559236213, "creation_date": 1559164818, "question_id": 56368682, "link": "https://stackoverflow.com/questions/56368682/can-i-run-a-vba-macro-to-run-sql-queries-i-have-saved-in-a-ms-access-database", "title": "Can I run a VBA macro to run SQL queries I have saved in a MS Access database?", "body": "<p>I spent alot of time to create 24 different separate MS Access queries that I have saved in the MS Access database.  They have to be run in a specific order.  </p>\n\n<p>I want to run a macro that will just execute them one after another.</p>\n\n<p>I know I can do this using VBA but I have copy all the SQL into VBA one at a time.</p>\n\n<p>is there a way I can just have VBA run the saved queries in the MS Access database without copying them into VBA?  </p>\n\n<p>I am very good with SQL. 15+ years doing Oracle work,  Code writing, DB Tuning, Data DBA work.</p>\n\n<p>I am new to using SQL and VBA to run against MS Access DB.</p>\n"}, {"tags": ["excel", "vba", "rest", "sharepoint"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559166704, "post_id": 56368674, "comment_id": 99340617, "body": "<code>URL</code> would be the URL you sent the HTTP GET request to (i.e. the REST API endpoint); if the document URI is in the XML payload you&#39;ll have to query that <code>objXML</code> object to retrieve it. But, since &quot;it returns nothing&quot;, I take it that <code>Err.Raise</code> is where your procedure stops? If so, what&#39;s the error code &amp; message? If not, are you getting any errors? If not, remove any <code>On Error Resume Next</code> that might be in the code you haven&#39;t posted, make sure <code>Option Explicit</code> is specified at the top (declare any missing variables)."}, {"owner": {"reputation": 15, "user_id": 2877042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4286b597ae606d016c45c0ea742a91a?s=128&d=identicon&r=PG&f=1", "display_name": "RayArc", "link": "https://stackoverflow.com/users/2877042/rayarc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559169099, "post_id": 56368674, "comment_id": 99341255, "body": "Thanks Mathieu, I think you&#39;ve helped get me going. I didn&#39;t realize you need to query the objXML. I&#39;m going to investigate further."}], "owner": {"reputation": 15, "user_id": 2877042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4286b597ae606d016c45c0ea742a91a?s=128&d=identicon&r=PG&f=1", "display_name": "RayArc", "link": "https://stackoverflow.com/users/2877042/rayarc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 737, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559164790, "creation_date": 1559164790, "question_id": 56368674, "link": "https://stackoverflow.com/questions/56368674/using-vba-and-rest-to-get-sharepoint-document-url", "title": "Using VBA and REST to get Sharepoint document URL", "body": "<p>I manage inspection data for my company. We receive many inspection reports via a standardized excel template and I use a macro to gather all the relevant data from these reports. The data is compiled into a master sheet where each record is an inspection, and feeds into Power BI so the results can be shared to the rest of my team.</p>\n\n<p>These reports are submitted via Sharepoint, and are then automatically downloaded to a local drive on my computer. My macro then scans the synced local receiving folder, processes any new inspections, and moves them to another local folder which syncs them to a secure, read-only Sharepoint folder. Below is a diagram to explain.</p>\n\n<pre><code>-----------------------------------------------------------------------------\n                                  SHAREPOINT\nExcel Reports submitted online by                         Reports synced back\ninspectors through Sharepoint                             up to online secure \n            |                                             read-only Sharepoint \n            |                                             folder\n            |                                                      ^\n            v                                                      |\n------------------------------------------------------------------------------\n                                   ON MY PC\n\nReports are synced to local -------&gt; VBA macro      ------&gt; Reports moved to\n\"receiving\" folder on my PC          processes files        local \"hosting\"\n                                                            file on my pc which \n                                                            syncs to Sharepoint\n------------------------------------------------------------------------------\n</code></pre>\n\n<p>This is where it gets tricky:</p>\n\n<p>I want to be able to add a link in my master excel file to the individual reports on Sharepoint (url not local address), so that someone on my team viewing the Power BI report can click to open the inspection report through excel online. I can't seem to figure out how to set up the REST API in my code to get the URL.</p>\n\n<p>I've tried the code below but it returns nothing and I am sure it is way off:</p>\n\n<pre><code>URL = \"http://lab/_vti_bin/listdata.svc/Library()?$filter=FileLeafRef eq '\" &amp; oFile.Name &amp; \"'&amp;$select=Title\"\n\n        Set req = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n        req.Open \"GET\", URL, False\n        req.SetRequestHeader \"Content-Type\", \"application/xml\"\n        req.SetCredentials \"myEmail\", \"myPass\", 0\n        req.Send\n\n        Set objXML = CreateObject(\"Msxml2.DomDocument.6.0\")\n        If Not objXML.LoadXML(req.ResponseText) Then\n            Err.Raise objXML.parseError.ErrorCode, , objXML.parseError.reason\n        End If\n\n        mws.Range(\"AJ\") = URL\n</code></pre>\n\n<p>Could anyone help point me in the right direction? Thanks in advance for your time and assistance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559164684, "post_id": 56368465, "comment_id": 99340048, "body": "What&#39;s the logic behind the ranking? How is Orange 3 and Apple 1?"}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559165969, "post_id": 56368465, "comment_id": 99340393, "body": "By counting the negative values, orange has -3, -3, -1 so 3 Apple has -4 so 1"}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559166064, "post_id": 56368465, "comment_id": 99340420, "body": "I followed all posting rules and tagged them correctly but why people down arrowing my post? This is very valid question that you can&#39;t Google or digging through the previous posts..."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559166081, "post_id": 56368465, "comment_id": 99340426, "body": "And this ranking, is it a reordering of the cells, or just another column with the rank?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559166152, "post_id": 56368465, "comment_id": 99340452, "body": "Do you need VBA? This can be done with a simple formula"}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559166334, "post_id": 56368465, "comment_id": 99340510, "body": "Yes VBA only. I know this is very simple with formula but unfortunately that&#39;s not an option :("}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559166440, "post_id": 56368465, "comment_id": 99340537, "body": "Please see my last question. Also you can record a macro. If you answer the last question, I can work up an answer"}, {"owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559166765, "post_id": 56368465, "comment_id": 99340628, "body": "Orange is 3 because there are 3 negative values (-3, -3 and -1) in that row Apple is 1 because there is 1 negative value (-4)"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1559166939, "post_id": 56368465, "comment_id": 99340678, "body": "I&#39;m curious why a formula is not allowed, but you can use VBA for some reason?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1559167082, "post_id": 56368465, "comment_id": 99340724, "body": "Generally, Stack Overflow is not a code for me site.  Please show more than two lines of code.  Show how you have attempted to do what you are asking.  You basically are asking us to do your work for you."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 1, "creation_date": 1559167181, "post_id": 56368465, "comment_id": 99340750, "body": "@TylerH, I already tried, this is the second time the OP has asked this question(<a href=\"https://stackoverflow.com/questions/56350988/vba-ranking-highest-to-lowest-by-counting-negative-values/56351106#56351106\">first now deleted</a>).  He tagged it with excel-formula last time and I gave him a formula."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1559170600, "last_edit_date": 1559170600, "creation_date": 1559170283, "answer_id": 56369501, "question_id": 56368465, "link": "https://stackoverflow.com/questions/56368465/counting-negative-values-and-ranking-them/56369501#56369501", "title": "Counting Negative Values and Ranking Them", "body": "<p>use Evaluate with the formula I gave the first time you asked:</p>\n\n<pre><code>With Worksheets(\"Sheet3\") 'change to your worksheet\n    Dim lstRow As Long\n    lstRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n    Dim i As Long\n    For i = 1 To lstRow\n        .Cells(i, 7).Value = .Evaluate(\"=SUMPRODUCT(--(COUNTIF(OFFSET($B$1,(ROW($1:$\" &amp; lstRow &amp; \")-1),0,1,5),\"\"&lt;0\"\")&lt;COUNTIF(B\" &amp; i &amp; \":F\" &amp; i &amp; \",\"\"&lt;0\"\")))+1\")\n    Next i\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/49Bgk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/49Bgk.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 56369501, "answer_count": 1, "score": 0, "last_activity_date": 1559170600, "creation_date": 1559163744, "last_edit_date": 1559166882, "question_id": 56368465, "link": "https://stackoverflow.com/questions/56368465/counting-negative-values-and-ranking-them", "title": "Counting Negative Values and Ranking Them", "body": "<p>Trying to count the negative values and rank them from highest count to lowest</p>\n\n<pre><code>Banana  -1   2  -3   2   1\nOrange   4  -3  -3  -1   2\nApple    1  -4   1   1   2\n</code></pre>\n\n<p>I was going to use the worksheet function like this</p>\n\n<pre><code>Set CountRng = range(\"B1:F1\") \nCountBanana = Application.WorksheetFunction.CountIf(CountRng, \"&lt;0\") \n</code></pre>\n\n<p>But not sure how I can rank them. Maybe I need to use array here?</p>\n\n<p>Result should rank Orange (3), Banana (2) and Apple (1)<br>\nOutput in cell G1:G3</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1559164647, "post_id": 56368314, "comment_id": 99340038, "body": "Are the numbers rounded when you view the CSV file in a plain text editor, such as Windows Notepad?"}, {"owner": {"reputation": 99, "user_id": 9882663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c856665289a09e51c0a33616fc426040?s=128&d=identicon&r=PG&f=1", "display_name": "Danchat", "link": "https://stackoverflow.com/users/9882663/danchat"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1559166544, "post_id": 56368314, "comment_id": 99340564, "body": "It was a different issue, but the solution suggested by June7 worked out because the custom function prevents the default rounding and text specifications at the same time. @LeeMac The numbers were rounded by the export, so no matter what viewer I used they were rounded (Notepad ++ confirmed this)."}], "owner": {"reputation": 99, "user_id": 9882663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c856665289a09e51c0a33616fc426040?s=128&d=identicon&r=PG&f=1", "display_name": "Danchat", "link": "https://stackoverflow.com/users/9882663/danchat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1559166377, "answer_count": 0, "score": 1, "last_activity_date": 1594743614, "creation_date": 1559163038, "last_edit_date": 1594743614, "question_id": 56368314, "link": "https://stackoverflow.com/questions/56368314/docmd-transfertext-rounds-text-to-integer", "closed_reason": "Duplicate", "title": "DoCmd.TransferText Rounds Text to Integer", "body": "<p>I've been using Access vba's <code>DoCmd.TransferText</code> command to convert a table of mine to a <code>.csv</code> file, and it's worked rather well, but I've realized I'm coming across an issue with the export. </p>\n\n<p>I have an <code>hours</code> field that stores text, however, when the table is exported, any text like <code>1.5</code> or <code>3.75</code> are rounded up to <code>2</code> and <code>4</code>. </p>\n\n<p>I think I know why this is the case - I am using a specification that changes the Text Qualifier to <code>{none}</code>. </p>\n\n<p>It appears that when the quotations are removed, any value that looks like a number is automatically rounded up or down to the nearest integer (I've already tried changing <code>hours</code> to a Number with type <code>Double</code> and that didn't do the trick). </p>\n\n<p>I need to have the quotations removed, so is there a way to get these hour values with up to two decimal places to stay as they are? </p>\n\n<p>Here's what the command looks like:</p>\n\n<pre><code>DoCmd.TransferText acExportDelim, \"TimecardExportSpecification\", \n\"TimecardExport\", \"\\timecards\\\" &amp; timecardName &amp; \".csv\", False\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 1, "creation_date": 1559164628, "post_id": 56368148, "comment_id": 99340031, "body": "It might have updated the record. You must requery the form or control displaying the data to make the changes visible."}], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1559226114, "last_edit_date": 1559226114, "creation_date": 1559225790, "answer_id": 56380017, "question_id": 56368148, "link": "https://stackoverflow.com/questions/56368148/how-can-i-update-an-existing-field-in-a-table-using-vba/56380017#56380017", "title": "How can i update an existing field in a table using VBA", "body": "<p>Make sure the <code>Bound Column</code> property of <code>TrailersOnProperty</code> is set to <code>0</code> and then try this:</p>\n\n<pre><code>Private Sub Outbound_Click()\n    Set mydb = DBEngine(0)(0)\n    Set Sitelog = mydb.OpenRecordset(\"SELECT * FROM T_Sitelog WHERE ID = \" &amp; Me!TrailersOnProperty)\n    Sitelog.MoveFirst\n    Sitelog.Edit\n    Sitelog![T/D_OUT] = Me![TDStamp_OUT]\n    Sitelog![Outbound_Comments] = Me![Comments_OUT]\n    Sitelog.Update\nEnd Sub\n</code></pre>\n\n<p>You can either use a table/query name or a proper SQL query for recordsets. A table name followed by a <code>WHERE</code> clause is neither. Also there is no guarantee that when you open the recordset the cursor will be at the first record. It could easily be at <code>EOF</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8341358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6fa443908f3824ab6f826d0d61d1ca5?s=128&d=identicon&r=PG&f=1", "display_name": "CodeForDayz", "link": "https://stackoverflow.com/users/8341358/codefordayz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559226114, "creation_date": 1559162141, "last_edit_date": 1559164466, "question_id": 56368148, "link": "https://stackoverflow.com/questions/56368148/how-can-i-update-an-existing-field-in-a-table-using-vba", "title": "How can i update an existing field in a table using VBA", "body": "<p>The program i'm working on in a simple <code>inbound/outbound</code> <code>date/timestamp</code>. An entry is added to the table for an <strong>inbound truck</strong> then when when the truck leaves an outbound entry is added. In the outbound form is a drop down list of everything that has come inbound but not outbound. This allows the user to select which entry needs to be updated. I'm stuck trying to get the information for the outbound portion into the already created field. I was trying to edit the table only if the selected entry is equal to the id in the table. Is there something i am missing? or is there a better way to approach this?</p>\n\n<p>I got the information into the table using but it doesn't update the selected record. </p>\n\n<pre><code>Private Sub Inbound_Click()\n    Set mydb = DBEngine(0)(0)\n    Set Sitelog = mydb.OpenRecordset(\"T_Sitelog\")\n\n    Sitelog.AddNew\n    Sitelog![Trailer_Type] = Me![TrailerType]\n    Sitelog![Trailer_Num] = Me![TrailerNum]\n    Sitelog![Carrier] = Me![Carrier]\n    Sitelog![T/D_IN] = Me![TDStamp_IN]\n    Sitelog![Inbound_Comments] = Me![Comments_IN]\n    Sitelog.Update\nEnd Sub\n\nPrivate Sub Outbound_Click()\n    Set mydb = DBEngine(0)(0)\n    Set Sitelog = mydb.OpenRecordset(\"T_Sitelog Where ID = \" &amp; _\n        Me!TrailersOnProperty.Column(0))\n\n    Sitelog.Edit\n    Sitelog![T/D_OUT] = Me![TDStamp_OUT]\n    Sitelog![Outbound_Comments] = Me![Comments_OUT]\n    Sitelog.Update\nEnd Sub\n</code></pre>\n\n<p>I except the result to update the already existing record added in the inbound portion. A date/timestamp and comments should be updated into the table.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1559161930, "post_id": 56367895, "comment_id": 99339114, "body": "i think the answer will be found if you were to debug.print; CurrentProject.pat"}, {"owner": {"reputation": 97, "user_id": 7247091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153072147051971/picture?type=large", "display_name": "Natalia Fontiveros", "link": "https://stackoverflow.com/users/7247091/natalia-fontiveros"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1559163116, "post_id": 56367895, "comment_id": 99339534, "body": "Thank Doug Let me try that"}], "owner": {"reputation": 97, "user_id": 7247091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153072147051971/picture?type=large", "display_name": "Natalia Fontiveros", "link": "https://stackoverflow.com/users/7247091/natalia-fontiveros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594621581, "creation_date": 1559160946, "last_edit_date": 1594621581, "question_id": 56367895, "link": "https://stackoverflow.com/questions/56367895/copy-data-from-a-table-in-access-to-an-existing-excel-file", "title": "copy data from a table in access to an existing excel file", "body": "<p>I would like to copy records from a table or a query into an existing excel file on my folder </p>\n\n<p>my code exports the data into a new excel file. it won't work with the current file  that i have define here path = CurrentProject.path &amp; \"\\\"&amp; \"BTO Export.xlsx\"</p>\n\n<pre><code>Private Sub cmdGetIDs_Click()\n\nDoCmd.SetWarnings False\n\nDim db As Database\nDim rs As Recordset\nSet db = CurrentDb\n\nDim path As String\n\npath = CurrentProject.path &amp; \"\\\"&amp; \"BTO Export.xlsx\"\n\nDim mySql As String\n\n On Error GoTo HandleError\n\nmySql = \"SELECT DISTINCT TABLEDD.[Code] as [ID] From TABLEDD\"\n\n On Error Resume Next\n     CurrentDb.QueryDefs.Delete \"temp2\"\n On Error GoTo 0\n\ndb.CreateQueryDef \"temp2\", mySql\n\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"temp2\", CurrentProject.path &amp; \"\\\" &amp; \" IDS Generated\" &amp; Format(Now(), \" mm dd yyyy hh mm\"), True\n\n\nCurrentDb.QueryDefs.Delete \"temp2\"\nSet db = Nothing\n\n\nDoCmd.SetWarnings True\n\n\nMsgBox \"List of IDS processed successfully\"\n\n\n\nExit Sub\n\nHandleError:\n    MsgBox Err.Description\n\nEnd Sub\n</code></pre>\n\n<p>Im trying to copy a List of IDs from a table on access into an specific Excel file on the first sheet call \"Data\" from cell A2 up to A101 if I have 100 ids, if i have 50 ids it would be from a2 to a51. I have no clue how to accomplish this. If anyone can point me in the right direction I would appreciate it</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1559164484, "post_id": 56367804, "comment_id": 99339979, "body": "just to verify, you want to loop A2, A3..... until you get to an empty cell in Column A? Also, are there any blanks rows between non-empty ones?"}, {"owner": {"reputation": 1, "user_id": 11574923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4b0302619102099ea15c30643d2e3f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyA", "link": "https://stackoverflow.com/users/11574923/jennya"}, "edited": false, "score": 0, "creation_date": 1559221202, "post_id": 56367804, "comment_id": 99357794, "body": "AAA- Yes I would like to loop through A2,A3...until it reaches a blank row and I want it to stop. There are no empty rows between the non-empty ones."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11574923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4b0302619102099ea15c30643d2e3f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyA", "link": "https://stackoverflow.com/users/11574923/jennya"}, "edited": false, "score": 0, "creation_date": 1559223561, "post_id": 56369730, "comment_id": 99359126, "body": "Hiya! so I tried the code above and unfortunately it&#39;s not picking up the value in cell A2 here:                                                                                                       Do While ThisWorkbook.Sheets(&quot;StarsID&quot;).Range(&quot;A&quot; &amp; y).Value &lt;&gt; &quot;&quot;"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1559172234, "creation_date": 1559172234, "answer_id": 56369730, "question_id": 56367804, "link": "https://stackoverflow.com/questions/56367804/looping-through-excel-cells/56369730#56369730", "title": "Looping through Excel cells", "body": "<p>try</p>\n\n<pre><code>y = 2\n    Do While ThisWorkbook.Sheets(\"StarsID\").Range(\"A\" &amp; y).Value &lt;&gt; \"\"\n    IE.document.getElementById(\"caseId\").Value = ThisWorkbook.Sheets(\"StarsID\").Range(\"A\" &amp; y).Value\n    IE.document.getElementById(\"_eventId_search\").Click\n    Do While IE.Busy = True Or IE.readyState &lt;&gt; 4: DoEvents: Loop\n    currentQueue = IE.document.getElementById(\"results\").Children(1).Children(0).Children(3).Children(0).innerText\n    ThisWorkbook.Sheets(\"StarsID\").Cells(y, 3).Value = currentQueue\n    ActiveCell.Offset(1, 0).Select\n    y = y + 1\n    Loop\n</code></pre>\n\n<p>may add some wait time depending of the response of the website.</p>\n"}], "owner": {"reputation": 1, "user_id": 11574923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4b0302619102099ea15c30643d2e3f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyA", "link": "https://stackoverflow.com/users/11574923/jennya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "closed_date": 1559221487, "answer_count": 1, "score": 0, "last_activity_date": 1559201906, "creation_date": 1559160600, "last_edit_date": 1559201906, "question_id": 56367804, "link": "https://stackoverflow.com/questions/56367804/looping-through-excel-cells", "closed_reason": "Duplicate", "title": "Looping through Excel cells", "body": "<p>I have an excel spreadsheet - First column contain ID numbers, 2nd column contains the name that the specific ID number should be assigned to. </p>\n\n<p>The intention of my macro is to copy the ID number from A2, enter it into a web application, scrape the name associated with the ID number off of the web application and enter that name into the 3rd column.</p>\n\n<p>I have successfully accomplished this with the very first value in A2. </p>\n\n<p>My problem is that I can not for the life of me figure out how to use a loop so that the macro cycles through each cell in column A until it reaches a blank cell. I'm very new to VBA so forgive my ignorance. \nThe code below is the piece of my macro that must loop. </p>\n\n<pre><code>  IE.document.getElementById(\"caseId\").Value = ThisWorkbook.Sheets(\"StarsID\").Range(\"A2\").Value\n\n'Tells macro to click on 'Search Cases' Button\n       IE.document.getElementById(\"_eventId_search\").Click\n\n'Tells macro to wait for browser to load completely\n       Do While IE.Busy = True Or IE.readyState &lt;&gt; 4: DoEvents: Loop\n\n'Tells macro that first search result will be entered into row 2\n       y = 2\n        currentQueue = IE.document.getElementById(\"results\").Children(1).Children(0).Children(3).Children(0).innerText\n        Sheets(\"StarsID\").Cells(y, 3).Value = currentQueue\n         ActiveCell.Offset(1, 0).Select\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1559160448, "post_id": 56367519, "comment_id": 99338558, "body": "If you&#39;re using Windows, I think the keystroke is <code>Alt</code> + <code>F11</code> to get to the VBA editor. You&#39;ll want to paste your sample code into there, probably within a module.  Or possibly within a sheet&#39;s &quot;Load&quot; method?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559161135, "post_id": 56367519, "comment_id": 99338821, "body": "Bring up the VBE (Alt+F11), then paste the code in a new standard (.bas) module. You&#39;ll want to change <code>.xlsx</code> to <code>.xlsm</code>, and replace <code>xlOpenXMLWorkbook</code> with <code>xlOpenXMLWorkbookMacroEnabled</code>... but, what&#39;s the use of saving as a macro-enabled workbook if there aren&#39;t any macros in it? An HTML file won&#39;t have macros to save. This looks like an X-Y problem, i.e. you need X but you&#39;re solving Y. Please clarify what you&#39;re trying to do."}, {"owner": {"reputation": 17, "user_id": 11574817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52123288721158640656760d7b559dd9?s=128&d=identicon&r=PG&f=1", "display_name": "LotusEater", "link": "https://stackoverflow.com/users/11574817/lotuseater"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559314694, "post_id": 56367519, "comment_id": 99393326, "body": "@MathieuGuindon, thank you and you have a point. I was hoping to not only save the html as a excel workbook, but also into an existing .xlsm which would automate the process of analysing the data. That may or may not be possible. However, since my goal is to take 50 button clicks and reduce it to 10, the code I provided just might work for me. So, I have created a blank excel and a module in VBA and imputed the code. How do I run it? Within the VBA, I have tried the Run Sub/User Form, F5 and have successfully opened it as a .xlsx. How can I run this command without opening VBA?"}], "owner": {"reputation": 17, "user_id": 11574817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52123288721158640656760d7b559dd9?s=128&d=identicon&r=PG&f=1", "display_name": "LotusEater", "link": "https://stackoverflow.com/users/11574817/lotuseater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559160681, "creation_date": 1559159161, "last_edit_date": 1559160681, "question_id": 56367519, "link": "https://stackoverflow.com/questions/56367519/how-can-i-use-vba-code-to-convert-a-html-file-to-an-existing-xlsm-file", "title": "How can I use VBA code to convert a .html file to an existing .xlsm file?", "body": "<p>I have software that generates a 2x 25,000 table of numbers in an .html format. My current process is opening the <strong>.html</strong>, saving as Excel workbook, etc. </p>\n\n<p>The goal is to automate the process, import the data to Excel, and generate graphs and box charts. I have used macros to accomplish the latter but I am struggling with getting the .html data into the existing <strong>.xlsm</strong>.</p>\n\n<p>I have found this code, from a helpful thread on Stack Overflow:</p>\n\n<pre><code>Sub Open_HTML_Save_XLSX()\n    Workbooks.Open Filename:=\"C:\\Temp\\Example.html\"\n    ActiveWorkbook.SaveAs \"C:\\Temp\\Example.xlsx\", xlOpenXMLWorkbook\nEnd Sub\n</code></pre>\n\n<p>However, I'm not sure how to use it. I've been using custom made keyboard shortcuts to access my macros such as <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Q</kbd>. I also don't know how to edit it to suit <strong>.xlsm</strong>. </p>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1559160778, "creation_date": 1559160778, "answer_id": 56367846, "question_id": 56367508, "link": "https://stackoverflow.com/questions/56367508/how-do-i-find-a-value-in-column-g-of-another-sheet-using-vlookup/56367846#56367846", "title": "How do i find a value in column G of another sheet using vlookup?", "body": "<p>Try using <code>Index/Match</code> to be make exact references... </p>\n\n<pre><code>Application.Index(OutputRange, Application.Match(LookupVal, LookupRange,0))\n</code></pre>\n\n<p>With your data, assuming I get the correct <code>Match</code> range (assuming you find your AcctNb in column A):</p>\n\n<pre><code>AcctNb = Worksheets(\"Master Filtered\").Cells(G, 3).Value\nWith Worksheets(\"Ndex Positions\")\n    Application.Index(.Range(\"G:G\"), Application.Match(AcctNb, .Range(\"A:A\"),0))\nEnd With\n</code></pre>\n\n<p>Note the <code>0</code> in the Match means \"exact match\"</p>\n"}], "owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559160778, "creation_date": 1559159135, "question_id": 56367508, "link": "https://stackoverflow.com/questions/56367508/how-do-i-find-a-value-in-column-g-of-another-sheet-using-vlookup", "title": "How do i find a value in column G of another sheet using vlookup?", "body": "<p>I am working on a sheet called \"Master Filtered\" in which the values of column K should be filled with a lookup value from sheet \"Ndex Positions\" column G. </p>\n\n<p>This is the piece of code I wrote</p>\n\n<pre><code>Sub MTL_OR_TOR()\nDim AcctNb As String\nDim result As String\nDim myRange As Range\n\n\nDim lastrow As Long\nlastrow = Worksheets(\"Master Filtered\").Cells(Rows.Count, 1).End(xlUp).Row\n\nWorksheets(\"Master Filtered\").Range(\"K3\").Value = \"MTL OR TOR\"\n\nSet myRange = Worksheets(\"Ndex Positions\").Range(\"A2:G9000\") 'Range in which the table MTL or TOR should be entered\n\n\nFor G = 4 To lastrow\n\nAcctNb = Worksheets(\"Master Filtered\").Cells(G, 3).Value\nresult = Application.WorksheetFunction.VLookup(AcctNb, myRange, 7, False)\n\nWorksheets(\"Master Filtered\").Range(\"K\" &amp; G).Value = result\nNext\n\nEnd Sub\n</code></pre>\n\n<p>But this does not seem to work (\"Unable to get the Vlookup property of the WorksheetFucntion class\") </p>\n\n<p>I don't know what is my error. If that helps, when I substitues the number 7 by the number 2 in the following line: \"result = Application.WorksheetFunction.VLookup(AcctNb, myRange, 7, False) \" everything works perfectly. But it is taking values from column B rather than column G. That's why I replaced the 2 by a 7 (index of letter  G in the alphabet). However, this does not seem to work. </p>\n\n<p>Please let me know if you have any idea where my error could possibly be. </p>\n\n<p>Thanks :) </p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7658, "user_id": 3195477, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/PK4P1.jpg?s=128&g=1", "display_name": "StayOnTarget", "link": "https://stackoverflow.com/users/3195477/stayontarget"}, "edited": false, "score": 0, "creation_date": 1559160369, "post_id": 56367466, "comment_id": 99338529, "body": "I don&#39;t think you mean VB6  which was for standalone programs, but VBA."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1559161768, "post_id": 56367466, "comment_id": 99339053, "body": "Where is <code>xlwbook</code> declared?  Start by adding <code>Option Explicit</code> at the top of every module, and fix anything flagged by that."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1559162456, "post_id": 56367466, "comment_id": 99339298, "body": "xlSheet isnt declare either."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 8709545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62f1d5a4b3975a5459586f1f7441c71?s=128&d=identicon&r=PG&f=1", "display_name": "MerdeNoms", "link": "https://stackoverflow.com/users/8709545/merdenoms"}, "is_accepted": false, "score": 0, "last_activity_date": 1559178226, "creation_date": 1559178226, "answer_id": 56370354, "question_id": 56367466, "link": "https://stackoverflow.com/questions/56367466/build-excel-from-visual-ms-access-from-function/56370354#56370354", "title": "Build Excel from visual ms access from function", "body": "<p>Finally i resolve it, the solution was do this: </p>\n\n<p><strong>First declare this</strong></p>\n\n<pre><code>Option Compare Database\n\nDim ba As Excel.Application\nDim xlwsheet As Excel.Worksheet\n</code></pre>\n\n<p>Second initialize the object in the second line:</p>\n\n<pre><code> Sub ConstruyeTablayCampo(ByRef sHoja As String, ByRef sTexto As String, ByRef col1 As String, ByRef sRango1 As String, ByRef col2 As String, ByRef sRango2 As String, ByRef ba As Excel.Application, ByRef color1 As String, ByRef color2 As String, ByRef color3 As String, ByRef nHoja As Integer)\n\n        Set xlwsheet = ba.Worksheets.Item(nHoja)\n        xlwsheet.Name = sHoja\n        xlwsheet.Range(\"B:B,D:D,H:H,J:J,N:N,Q:Q\").ColumnWidth = 1\n\n        With xlwsheet.Cells.Range(col1 &amp; \"11\" &amp; \":\" &amp; col2 &amp; \"12\")\n                .HorizontalAlignment = xlCenter\n                .VerticalAlignment = xlCenter\n                .WrapText = True\n                .Select\n                .Font.Bold = True\n                .MergeCells = True\n                .Interior.Color = RGB(color1, color2, color3)\n        End With\n\n        xlwsheet.Range(col1 &amp; \"11:\" &amp; col2 &amp; \"12\").Cells = sTexto\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help!</p>\n"}], "owner": {"reputation": 3, "user_id": 8709545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62f1d5a4b3975a5459586f1f7441c71?s=128&d=identicon&r=PG&f=1", "display_name": "MerdeNoms", "link": "https://stackoverflow.com/users/8709545/merdenoms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594549675, "creation_date": 1559158956, "last_edit_date": 1594549675, "question_id": 56367466, "link": "https://stackoverflow.com/questions/56367466/build-excel-from-visual-ms-access-from-function", "title": "Build Excel from visual ms access from function", "body": "<p>I am trying to build a document in Excel from Visual Basic 6 of MS-Access with the following code, which calls the function <strong>TraeDatosCorteAnterior</strong>, which performs a query in the Database, generates the Excel application and adds a Worksheet. Work, however, by continuing to generate the document from the function ** ConstruyeTablayCampo **, the application of an error 424 with the following message ** \"An object is required\" **:</p>\n\n<p>** Excel object declaration **</p>\n\n<pre><code>Option Compare Database\nDim ba As Excel.Application\n</code></pre>\n\n<p><strong>Initial Funcion</strong></p>\n\n<pre><code>  Public Sub TraeDatosCorteAnterior()\n\n    RstName = \"SELECT conc.CP, conc.etapa, conc.total FROM t_conclusion as conc;\"\n    Dim dbs As Database\n    Set dbs = CurrentDb\n    Dim iRec As Long\n    Dim i As Long\n    Dim RstOrig As Recordset\n    Dim nTotalReg As Integer\n    Dim nCP As Integer\n    Dim nEtapa As Integer \n    Dim nTotal As Integer\n\n    Set RstOrig = CurrentDb.OpenRecordset(RstName, dbOpenDynaset)\n    RstOrig.Sort = fldName\n    Dim RstSorted As Recordset\n    Set RstSorted = RstOrig.OpenRecordset()\n    RstOrig.Sort = fldName\n    Dim RstSorted As Recordset\n    Set RstSorted = RstOrig.OpenRecordset()\n    RstSorted.MoveLast\n    RstSorted.MoveFirst\n\n    nTotalReg = RstSorted.RecordCount\n\n    nCP = RstSorted(\"CP\")\n\n    nEtapa = IIf(IsNull(RstSorted(\"etapa\")) = True, 0, RstSorted(\"etapa\"))\n    nTotal = IIf(IsNull(RstSorted(\"Total\")) = True, 0, RstSorted(\"Total\"))\n\n    RstSorted.MoveNext\n\n\n    Set ba = New Excel.Application\n    Set xlwbook = ba.Workbooks.Add\n    ba.Visible = True\n\n    ConstruyeTablayCampo \"Cuadro I\", \"Cuenta P\u00fablica\", \"A\", \"A\", ba, False, 1\n\n  End Sub\n</code></pre>\n\n<p>** Function that builds the document **, from the first line marks the error.</p>\n\n<p>** Excel object declaration **</p>\n\n<pre><code> Sub ConstruyeTablayCampo(ByRef sHoja As String, ByRef sTexto As String, ByRef col1 As String, ByRef col2 As String, ByRef ba As Excel.Application, Optional bCreaHoja As Boolean, Optional nHoja As Integer)\n\n        Set xlsheet = xlwbook.Sheets.Item(nHoja)\n        xlwbook.Sheets.Item(nHoja).Name = sHoja\n\n        xlsheet.Cells.Range(\"A11:A11\") = sTexto\n        Worksheets(\"Cuadro I\").Range(\"B:B,D:D,H:H,J:J,N:N,Q:Q\").ColumnWidth = 1\n\n        With xlsheet.Cells.Range(col1 &amp; \"11:\" &amp; col2 &amp; \"12\")\n                .HorizontalAlignment = xlCenter\n                .VerticalAlignment = xlCenter\n                .WrapText = True\n                .Select\n                .Font.Bold = True\n                .MergeCells = True\n                .Interior.Color = RGB(244, 244, 244)\n        End With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance, I hope you can help me!</p>\n"}, {"tags": ["excel", "vba", "combobox", "textbox", "userform"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1559163288, "post_id": 56368262, "comment_id": 99339600, "body": "Thanks Garrett I will try it out. I think this line of code stores the row. ColB.Add C.Offset(0, 1).Value, C.Row. Could I somehow incorporate that?"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1559220399, "post_id": 56368262, "comment_id": 99357392, "body": "I added in the .range function that you provided. Now where would I place the .row?"}, {"owner": {"reputation": 56, "user_id": 7281608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f053f995cc8e582b19adee4526f29b9?s=128&d=identicon&r=PG&f=1", "display_name": "GarrettS1", "link": "https://stackoverflow.com/users/7281608/garretts1"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1559224919, "post_id": 56368262, "comment_id": 99359904, "body": "Assuming you have the code working as you would like it to, you would probably create a variable and set it equal to <code>C.Row</code>. Then you could do something like, <code>.Range(&quot;AE&quot; &amp; R).Value = Textbox1.Value</code>. &quot;R&quot; would be the variable you create to store the row. Keep in mind that your textboxes and variables and such might not match what I just typed exactly. Also, your code shows that you set <code>C.Value</code> to something else. I haven&#39;t tried it myself, but I would think that would override the value that you just found... Good Luck!"}], "tags": [], "owner": {"reputation": 56, "user_id": 7281608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f053f995cc8e582b19adee4526f29b9?s=128&d=identicon&r=PG&f=1", "display_name": "GarrettS1", "link": "https://stackoverflow.com/users/7281608/garretts1"}, "is_accepted": false, "score": 0, "last_activity_date": 1559162754, "creation_date": 1559162754, "answer_id": 56368262, "question_id": 56367391, "link": "https://stackoverflow.com/questions/56367391/in-a-userform-link-textbox-to-the-same-row-as-the-combobox-but-different-column/56368262#56368262", "title": "In a Userform, Link Textbox to the same row as the combobox but different Column", "body": "<p>One way to find which row you need based on the value in \"combobox2\" would be to use the Range.Find Method. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Here</a> is the documentation from Microsoft on how to use the method. You would pass in the value in \"combobox2\" as the value to find. It also shows you how to catch an error when you don't find the value you are looking for (which in my experience can happen quite often). </p>\n\n<p>The Range.Find method returns a Range Object, which is basically an address for a cell. From there you could use something like <code>.Row</code> to find the row you need and then reference it in combination with your column \"AE\". </p>\n\n<p>Let me know if this helps! Good Luck!</p>\n"}], "owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559220363, "creation_date": 1559158589, "last_edit_date": 1559220363, "question_id": 56367391, "link": "https://stackoverflow.com/questions/56367391/in-a-userform-link-textbox-to-the-same-row-as-the-combobox-but-different-column", "title": "In a Userform, Link Textbox to the same row as the combobox but different Column", "body": "<p>I have created a userform with 2 comboboxes, a textbox and a button that will link the comboboxes/textbox depending on the scenario.</p>\n\n<p>For one of the scenarios, if combobox 2, displays the same text/value currently in the worksheet MRFGLR Range Column A change the value of column AE with the textbox value in the same row as the combobox 2 value in Worksheet MFGLR.\nIn a Userform, Link Textbox to the same row as the combobox but different Column</p>\n\n<p>I'm having trouble having the code find the same row as combobox2 value and then pasting the textbox1 value 31 columns to the right as that. This is what I have so far. </p>\n\n<pre><code>With Worksheets(\"MFGLR\").Range(\"a1:a500\")\nSet C = .Find(ComboBox2.Value, LookIn:=xlValues)\nIf Not C Is Nothing Then\n    firstAddress = C.Address\n    Do\n        C.Value = TextBox1.Value\n        Set C = .FindNext(C)\n    Loop While Not C Is Nothing\nEnd If\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "textbox", "backcolor"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559158491, "post_id": 56367306, "comment_id": 99337773, "body": "Tried it, but I&#39;m having the same problem...once yellow, stays yellow."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559158808, "post_id": 56367306, "comment_id": 99337905, "body": "Do <i>any</i> of the cells in column CL have the word &quot;yes&quot; in them?  If so, the box will be yellow.  If this is not what you are after you will have to describe what you are trying to achieve."}, {"owner": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559158916, "post_id": 56367306, "comment_id": 99337948, "body": "Yes, some cells in CL have &quot;yes&quot; and depending on the code I mentioned above, it will change to yellow for the first one it finds, but then it stays yellow from that point on whether it has &quot;yes&quot; or not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159004, "post_id": 56367306, "comment_id": 99337986, "body": "So what are you expecting it to do?"}, {"owner": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159092, "post_id": 56367306, "comment_id": 99338039, "body": "turn yellow when it finds yes, turn white when it is blank."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159214, "post_id": 56367306, "comment_id": 99338083, "body": "But you are looping through a number of rows.  In your original code it will keep changing colour and end up with the colour matching what is on the last row.  Are you expecting it to flash between yellow and white?"}, {"owner": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159574, "post_id": 56367306, "comment_id": 99338225, "body": "When it changes the text in the textbox, it is on a specific row.  I would like it to color the textbox based on what is in column CL of that row.  if the row does not have the word &quot;yes&quot; in CL of that row, I don&#39;t want it to have a color.  what the previous row shows shouldn&#39;t reflect anything as I advance through the loop.  Or at least that&#39;s my intent."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159753, "post_id": 56367306, "comment_id": 99338291, "body": "In that case you don&#39;t want the For Next at all!  You need a variable that represents whichever row you are on and just look at the value on that row.  How does the form know which row you are looking at?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 0, "last_activity_date": 1559158113, "creation_date": 1559158113, "answer_id": 56367306, "question_id": 56367188, "link": "https://stackoverflow.com/questions/56367188/how-can-i-change-the-color-of-a-textbox-based-on-the-cell-value-in-a-loop/56367306#56367306", "title": "How can I change the color of a textbox based on the cell value in a loop?", "body": "<p>Your code will work, but it will be matched to whatever is in the last row (ie yellow if the last row is \"yes\").</p>\n\n<p>If you want it to be yellow if any of the values are \"yes\" and white if none are \"yes\" then</p>\n\n<pre><code>Me.TextBox10.BackColor = vbWhite\nFor i = 2 To Lastrow\n    If ActiveSheet.Range(\"CL\" &amp; i) = \"yes\" Then\n        Me.TextBox10.BackColor = vbYellow    \n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 0, "creation_date": 1559159429, "post_id": 56367554, "comment_id": 99338175, "body": "You can see that from the behaviour when you remove the else statement. It changes to yellow the first time it meets the condition, and never changes back since there is no statement telling it to."}, {"owner": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159769, "post_id": 56367554, "comment_id": 99338299, "body": "Yes, I would like it to cycle one row at a time.  But as I click the &quot;next&quot; button, it does cycle one row at a time.  but it doesn&#39;t update the color based on what&#39;s in CL of that row."}, {"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "reply_to_user": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159799, "post_id": 56367554, "comment_id": 99338312, "body": "Do you have one text box or multiple text boxes?"}, {"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "reply_to_user": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559159993, "post_id": 56367554, "comment_id": 99338379, "body": "If its that you have a different text box for every row, then your code needs to increment the text box name as well when you loop through the rows"}, {"owner": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "edited": false, "score": 0, "creation_date": 1559160004, "post_id": 56367554, "comment_id": 99338384, "body": "I have 23 textboxes in the userform.  I have different textboxes for columns, not different textboxes for every row."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559161142, "post_id": 56367554, "comment_id": 99338824, "body": "OK.  In that case you need to set the TextBoxes individually.  You keep changing the same one."}], "tags": [], "owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "is_accepted": false, "score": 0, "last_activity_date": 1559159339, "creation_date": 1559159339, "answer_id": 56367554, "question_id": 56367188, "link": "https://stackoverflow.com/questions/56367188/how-can-i-change-the-color-of-a-textbox-based-on-the-cell-value-in-a-loop/56367554#56367554", "title": "How can I change the color of a textbox based on the cell value in a loop?", "body": "<p>The way it is written, it will only display a color change for the textbox, based on the value of CL in the last row, Did you want for it to cycle through one row at a time?</p>\n"}], "owner": {"reputation": 1, "user_id": 11574665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35831b8252dafa7bb8aa6e10a52138d?s=128&d=identicon&r=PG&f=1", "display_name": "Linda P", "link": "https://stackoverflow.com/users/11574665/linda-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559159339, "creation_date": 1559157558, "last_edit_date": 1559158595, "question_id": 56367188, "link": "https://stackoverflow.com/questions/56367188/how-can-i-change-the-color-of-a-textbox-based-on-the-cell-value-in-a-loop", "title": "How can I change the color of a textbox based on the cell value in a loop?", "body": "<p>On my userform, I have a \"next\" button which loops through a worksheet.  If cell in column CL = \"yes\", then change color of textbox10 to Yellow, otherwise leave it white.  Problem is, it will only change to yellow if I don't have an \"Else\" statement, and  then it won't turn back to white.  </p>\n\n<p>I've tried changing Private Sub TextBox10_Change() to Private Sub TextBox10_Enter() and then also added a ...Textbox10_Exit() but still the same results.  </p>\n\n<pre><code>Private Sub TextBox10_change()\n\nDim i As Integer\n\nDim Lastrow As Integer\n\nLastrow = Cells(rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To Lastrow\n\nIf ActiveSheet.Range(\"CL\" &amp; i) = \"yes\" Then\n    Me.TextBox10.BackColor = vbYellow\nElse\n    Me.TextBox10.BackColor = vbWhite\nEnd If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Basically, nothing happens unless I remove:</p>\n\n<pre><code>Else\n\n  Me.Textbox10.BackColor = vbWhite\n</code></pre>\n\n<p>and even then it turns yellow but never turns back to white.</p>\n"}, {"tags": ["excel", "vba", "gantt-chart"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1559156717, "post_id": 56366907, "comment_id": 99337075, "body": "I think this is doable with conditional formatting. What are the hour cutoffs for the shifts?"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1559160085, "post_id": 56367172, "comment_id": 99338414, "body": "Note that the date in question is &quot;always the day before the current day.&quot;"}, {"owner": {"reputation": 1, "user_id": 11574616, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuR7u8_v-YI/AAAAAAAAAAI/AAAAAAAAOY0/2SRWeaxveTE/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11574616/andrew"}, "edited": false, "score": 0, "creation_date": 1559641642, "post_id": 56367172, "comment_id": 99476150, "body": "The problem I am having with using conditional formatting is that all of the correlating shifts cells then highlight, and not just the shift for the current date. The day before reference in VBA is to open the workbook up to the day before the current, so the schedule for the prior day is still visable."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 1, "last_activity_date": 1559157438, "creation_date": 1559157438, "answer_id": 56367172, "question_id": 56366907, "link": "https://stackoverflow.com/questions/56366907/vba-to-highlight-cells-based-on-current-time-of-day/56367172#56367172", "title": "VBA to highlight cells based on current time of day", "body": "<p>Since your VBA mentions <code>1700</code>, I will assume your shifts start at 1:00, 9:00 and 17:00 respectively.</p>\n\n<p>You can use conditional formatting with the following formulas:</p>\n\n<p>1st shift:</p>\n\n<pre><code>=AND(NOW()-TODAY()&gt;1/24,NOW()-TODAY()&lt;9/24)\n</code></pre>\n\n<p>2nd shift:</p>\n\n<pre><code>=AND(NOW()-TODAY()&gt;9/24,NOW()-TODAY()&lt;17/24)\n</code></pre>\n\n<p>3rd shift: </p>\n\n<pre><code>=OR(NOW()-TODAY()&gt;17/24,NOW()-TODAY()&lt;1/24)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11574616, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iuR7u8_v-YI/AAAAAAAAAAI/AAAAAAAAOY0/2SRWeaxveTE/photo.jpg?sz=128", "display_name": "Andrew", "link": "https://stackoverflow.com/users/11574616/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559157775, "creation_date": 1559156235, "last_edit_date": 1559157775, "question_id": 56366907, "link": "https://stackoverflow.com/questions/56366907/vba-to-highlight-cells-based-on-current-time-of-day", "title": "VBA to highlight cells based on current time of day", "body": "<p>I have a row of cells repeating \"1st shift\", \"2nd shift\", and \"3rd shift\". The top row on the sheet is the dates throughout the year. I already have code to open the file to a specific date (always the day before the current day) and highlight the current day in a blue. I am trying to get the current shift to also highlight the same shade of blue. So if the sheet were being viewed at 7am, the cell with \"1st shift\" only under the current date would highlight, if viewed at 3pm the cell with \"2nd shift\" under the current date would highlight, and so on. </p>\n\n<p>Any help is appreciated.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_Open()\n    For I = 1 To 1700\n        If Cells(1, I).Value = Date - 1 Then\n            ActiveWindow.ScrollColumn = I\n        End If\n    Next\n    For I = 1 To 1700\n        If Cells(1, I).Value = Date Then\n            Cells(1, I).Interior.ColorIndex = 28\n            Cells(2, I).Interior.ColorIndex = 28\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "sharepoint"], "comments": [{"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 2, "creation_date": 1559156904, "post_id": 56366669, "comment_id": 99337156, "body": "Maybe you should change your column headers to prevent such errors from happening. Using spaces and most special (non alphanumeric) characters in fields is a recipe for disaster. The notable exception is _"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1559159722, "post_id": 56366669, "comment_id": 99338280, "body": "The source Excel file were the list is located is generated by a third party system.  I am trying to match as much as possible the excel file to to the share point list.  My current work around is <code>REPLACE(Headers(ncounter),&quot;.&quot;,&quot;#&quot;)</code> and it seemed to work. but it seems like an ugly solution."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1559161255, "post_id": 56366669, "comment_id": 99338854, "body": "My condolences, that sounds like a really ugly situation."}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559155048, "creation_date": 1559155048, "question_id": 56366669, "link": "https://stackoverflow.com/questions/56366669/sharepoint-list-column-title-with-in-title-gets-listed-as-in-the-record", "title": "Sharepoint List Column Title with &quot;.&quot; in title gets listed as &quot;#&quot; in the record set", "body": "<p>In SharePoint I have manually created a list and I gave one of the columns the title \"Impl. Date\" to match a heading in the excel sheet that the list will be populated from.</p>\n\n<p>In SharePoint it looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/faBQm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/faBQm.png\" alt=\"SharePoint header\"></a></p>\n\n<p>when I look at the field name for the record set, the \".\" is replaced with \"#\" as seen here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vTUDg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vTUDg.png\" alt=\"rst name\"></a></p>\n\n<p>The portion of the code where I am replacing the existing SharePoint table looks like like the following and the error occurs during the 5th iteration of nCounter loop. This is when Headers(nCounter) = \"Impl. Date\".</p>\n\n<pre><code>Set cnt = New ADODB.Connection\nSet rst = New ADODB.Recordset\n\nWith cnt\n    .ConnectionString = _\n    \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=0;RetrieveIds=Yes;DATABASE=http://my.company.com/SubSite/;LIST=\" &amp; GUID(Foldername) &amp; \";\"\n    .Open\nEnd With\n\n'set SQL string to filter the list to match what is to be done.\nmySQL = \"DELETE * FROM [\" &amp; SharepointListName &amp; \"];\"\n'activate SQL command\ncnt.Execute mySQL, , adCmdText\n\nmySQL = \"SELECT * FROM [\" &amp; SharepointListName &amp; \"];\"\n\nrst.Open mySQL, cnt, adOpenDynamic, adLockOptimistic\n\nFor lCounter = Headerrow + 1 To LastRow\n    rst.AddNew\n    For nCounter = 1 To LastCol + 1\n        rst.Fields(Headers(nCounter)) = Sheets(\"Sheet1\").Cells(lCounter, nCounter).Value\n    Next nCounter\n\n    '    Select Case SharepointListName\n    '        Case \"NSP Index\"\n    '            rst.Fields(\"Region\") = Sheets(\"Sheet1\").Range(\"A\" &amp; lCounter).Text\n    '            rst.Fields(\"NSP\") = Sheets(\"Sheet1\").Range(\"B\" &amp; lCounter).Text\n    '            rst.Fields(\"Title\") = Sheets(\"Sheet1\").Range(\"C\" &amp; lconter).Text\n    '            rst.Fields(\"Version\") = Sheets(\"Sheet1\").Range(\"D\" &amp; lconter).Text\n    '            rst.Fields(\"Impl. Date\") = Sheets(\"Sheet1\").Range(\"E\" &amp; lconter).Text\n    '            rst.Fields(\"Issue Date\") = Sheets(\"Sheet1\").Range(\"F\" &amp; lconter).Text\n    '            rst.Fields(\"Link\") = Sheets(\"Sheet1\").Range(\"D\" &amp; lconter).Text\n    '        Case \"OPSD Index\", \"SSD Index\", \"MTOD Index\"\n    '\n    '        Case \"OPSS Index\", \"SSP Index\"\n    '\n    '    End Select\n\n    '    rst.Fields(\"FileLink\") = filecaption &amp; filelink\n    rst.Update\nNext lCounter\n</code></pre>\n\n<p>The error box I am getting is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JFwOx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JFwOx.png\" alt=\"error box\"></a></p>\n\n<p>right now I am assuming the reason \"The item cannot be found in the collection corresponding to the requested nam or ordinal\" is being caused by the # not matching .</p>\n\n<p>Am I wrong in my assumption?  <strong>Is there a way to change the SharePoint field name to match the Excel Name?  Different methodology I should be using?</strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11573673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kR8Pp0RaRhE/AAAAAAAAAAI/AAAAAAAAMuw/Z7_PrAdQLGk/photo.jpg?sz=128", "display_name": "Yolanda Singletary", "link": "https://stackoverflow.com/users/11573673/yolanda-singletary"}, "edited": false, "score": 0, "creation_date": 1559159940, "post_id": 56367477, "comment_id": 99338360, "body": "data_sh.UsedRange.AutoFilter 1 - the number corresponds with the column that the data is sorted by.  When I change that number, I still get the same error."}], "tags": [], "owner": {"reputation": 348, "user_id": 11035142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f4f223eae490e5b4a4504a1606271d?s=128&d=identicon&r=PG&f=1", "display_name": "FFFffff", "link": "https://stackoverflow.com/users/11035142/fffffff"}, "is_accepted": false, "score": 0, "last_activity_date": 1559158991, "creation_date": 1559158991, "answer_id": 56367477, "question_id": 56366559, "link": "https://stackoverflow.com/questions/56366559/run-time-error-1004-autofilter-method-of-range-class-failed/56367477#56367477", "title": "Run-time error 1004 - Autofilter Method of Range Class Failed", "body": "<p>You are probably passing incorrect arguments to the <code>data_sh.UsedRange.AutoFilter</code> method. First argument must not be larger than the number of fields - try 1 instead of 2. Description of the second argument from the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofilter\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>The criteria (a string; for example, \"101\"). Use \"=\" to find blank\n  fields, \"&lt;>\" to find non-blank fields, and \">&lt;\" to select (No Data)\n  fields in data types. If this argument is omitted, the criteria is\n  All. If Operator is xlTop10Items, Criteria1 specifies the number of\n  items (for example, \"10\").</p>\n</blockquote>\n\n<p>Try this line and then play with different arguments' values. Make sure you know what argument values are you passing to the function:</p>\n\n<pre><code>data_sh.UsedRange.AutoFilter 1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11573673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kR8Pp0RaRhE/AAAAAAAAAAI/AAAAAAAAMuw/Z7_PrAdQLGk/photo.jpg?sz=128", "display_name": "Yolanda Singletary", "link": "https://stackoverflow.com/users/11573673/yolanda-singletary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559158991, "creation_date": 1559154477, "last_edit_date": 1559154631, "question_id": 56366559, "link": "https://stackoverflow.com/questions/56366559/run-time-error-1004-autofilter-method-of-range-class-failed", "title": "Run-time error 1004 - Autofilter Method of Range Class Failed", "body": "<p>When I run my vba, I get the </p>\n\n<blockquote>\n  <p>Run-time error'1004; AutoFilter method of Range Class failed</p>\n</blockquote>\n\n<p>I tried changing the worksheet as sheet 1 as it was recommended in a previous answer and it did not work</p>\n\n<pre><code>Sub Split_Data_in_workbooks()\n\nApplication.ScreenUpdating = False\n\nDim data_sh As Worksheet\nSet data_sh = ThisWorkbook.Sheets(\"Working File\")\n\nDim setting_Sh As Worksheet\nSet setting_Sh = ThisWorkbook.Sheets(\"Setting\")\n\nDim nwb As Workbook\nDim nsh As Worksheet\n\n''''''Get unique districts\n\n\nsetting_Sh.Range(\"A:A\").Clear\ndata_sh.AutoFilterMode = False\ndata_sh.Range(\"b:b\").Copy setting_Sh.Range(\"A1\")\n\nsetting_Sh.Range(\"A:A\").RemoveDuplicates 1, xlYes\n\nDim I As Integer\n\nFor I = 2 To Application.CountA(setting_Sh.Range(\"A:A\"))\n\n   data_sh.UsedRange.AutoFilter 2, setting_Sh.Range(\"A\" &amp; I).Value\n\n   Set nwb = Workbooks.Add\n   Set nsh = nwb.Sheets(1)\n\n   data_sh.UsedRange.SpecialCells(xlCellTypeVisible).Copy nsh.Range(\"A1\")\n\n   nwb.SaveAs setting_Sh.Range(\"H6\").Value &amp; \"/\" &amp; setting_Sh.Range(\"A\" &amp; \nI).Value &amp; \".xlsx\"\n   nwb.Close False\n   data_sh.AutoFilterMode = False\nNext I\n\nsetting_Sh.Range(\"A:A\").Clear\n\nMsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>The code is supposed to take each district's information (which could be multiple lines), which from one workbook and save it into separate workbooks and save them in a designated file.  The code will not run pass this line </p>\n\n<pre><code>data_sh.UsedRange.AutoFilter 2, setting_Sh.Range(\"A\" &amp; I).Value\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 109, "user_id": 11208356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y4lld48G_jQ/AAAAAAAAAAI/AAAAAAAACRA/4BaQJ29sVjY/photo.jpg?sz=128", "display_name": "Mark Fernandes", "link": "https://stackoverflow.com/users/11208356/mark-fernandes"}, "edited": false, "score": 0, "creation_date": 1559153695, "post_id": 56366029, "comment_id": 99335848, "body": "I think you should edit your question to clarify what you mean by &#39;..but doesn&#39;t autofill like it should...&#39;"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 1, "last_activity_date": 1559154069, "creation_date": 1559154069, "answer_id": 56366472, "question_id": 56366029, "link": "https://stackoverflow.com/questions/56366029/how-can-i-get-these-values-and-text-strings-added-in-during-my-for-next-loop/56366472#56366472", "title": "How can I get these values and text strings added in during my for/next loop?", "body": "<p>You have told the formula to use AX6, AY6 and AZ6 so it will put this on every row.  You should change this to</p>\n\n<pre><code>wsA.Cells(x, 40).Formula = \"=\"\"TSR: \"\"&amp;AX\" &amp; x &amp; \"&amp;\"\" - \"\"&amp;AY\" &amp; x &amp; \"&amp;\"\" - \"\"&amp;AZ\" &amp; x &amp; \"&amp;\"\" USD Annual\"\"\" \n</code></pre>\n\n<p>or slightly easier to read</p>\n\n<pre><code>wsA.Cells(x, 40).FormulaR1C1 =\"TSR: \"&amp;RC[49]&amp;\" - \"&amp;RC[50]&amp;\" - \"&amp;RC[51]&amp;\" USD Annual\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1559221701, "post_id": 56366532, "comment_id": 99358065, "body": "I wasn&#39;t the one who downvoted, but I want to say thanks. I wish this was like reddit where you can comment <code>Solution Verified</code> in order to credit multiple answers."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1559154361, "creation_date": 1559154361, "answer_id": 56366532, "question_id": 56366029, "link": "https://stackoverflow.com/questions/56366029/how-can-i-get-these-values-and-text-strings-added-in-during-my-for-next-loop/56366532#56366532", "title": "How can I get these values and text strings added in during my for/next loop?", "body": "<p>No loop needed:</p>\n\n<pre><code>wsA.Range(wsA.Cells(6, 40),wsA.Cells(FinalRow, 40)).Formula = \"=\"\"TSR: \"\"&amp;AX6&amp;\"\" - \"\"&amp;AY6&amp;\"\" - \"\"&amp;AZ6&amp;\"\" USD Annual\"\n</code></pre>\n\n<p>Same with other formula:</p>\n\n<pre><code>wsA.Range(wsA.Cells(6, 49),wsA.Cells(FinalRow, 49)).FormulaR1C1 = \"=RC[-1]-RC[-3]\"\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56366472, "answer_count": 2, "score": 1, "last_activity_date": 1559154361, "creation_date": 1559152047, "last_edit_date": 1559152631, "question_id": 56366029, "link": "https://stackoverflow.com/questions/56366029/how-can-i-get-these-values-and-text-strings-added-in-during-my-for-next-loop", "title": "How can I get these values and text strings added in during my for/next loop?", "body": "<p>I have a series of numbers that get updated to a master sheet based on their own separate tabs. I enter a set of numbers in <code>rngB</code> and they populate based on the dimensions of the for/next loop based on the multipliers in the array <code>multplr</code>.</p>\n\n<p>Everything works as it should, but I'm trying to also have a range <code>(x,40)</code> populate with this: <code>wsA.Cells(x, 40).Formula = \"=\"\"TSR: \"\"&amp;AX6&amp;\"\" - \"\"&amp;AY6&amp;\"\" - \"\"&amp;AZ6&amp;\"\" USD Annual\"</code></p>\n\n<p>Loop:</p>\n\n<pre><code>        For x = 6 To FinalRow\n            wsA.Cells(x, 40).Formula = \"=\"\"TSR: \"\"&amp;AX6&amp;\"\" - \"\"&amp;AY6&amp;\"\" - \"\"&amp;AZ6&amp;\"\" USD Annual\"\n        Next x\n</code></pre>\n\n<p>it populates the formula, but doesn't autofill like it should, it just repeats the save thing in <code>Cells(6,40)</code></p>\n\n<p>I know there's the autofill/destination method, but my prior for/next formula loop works as it should, so I'm confused what's going on here. </p>\n\n<p>Rest of script: </p>\n\n<pre><code>Sub UpdateTSRS()\n\nDim wbk As Workbook\nDim wsA As Worksheet, wsB As Worksheet\nDim rngA As Range, rngB As Range, rngC As Range\nDim rIterator As Range, c As Range, spread As Range\nDim fndRow As Long, i As Long, j As Long, x As Long\nDim multplr As Variant\nDim FinalRow\nmultplr = Array(1, 1.1, 1.15, 1.2, 1.3)\n\nSet wbk = ThisWorkbook\nSet wsA = wbk.Sheets(\"Annual\")\nSet wsB = wbk.Sheets(\"New Annual\")\nSet rngA = wsA.Range(wsA.Range(\"E6\"), wsA.Range(\"E6\").End(xlDown))\nSet rngB = wsB.Range(wsB.Range(\"A2\"), wsB.Range(\"A2\").End(xlDown))\nSet rngC = wsA.Range(wsA.Range(\"AW6\"), wsA.Range(\"AW6\").End(xlDown))\n\nFinalRow = wsA.Cells(Rows.Count, 49).End(xlUp).Row\n\nFor Each rIterator In rngB\n        On Error Resume Next\n        fndRow = Application.Match(rIterator.Value, rngA, 0) + _\n            rngA.Range(\"E1\").Row - 1\n        If Err.Number &lt;&gt; 0 Then\n        Else\n        For i = 0 To 4\n            For j = 3 To 9\n                If j &lt;&gt; 6 Then\n                Set c = wsA.Cells(fndRow + i, j + 43)\n                c.Interior.Color = VBA.RGB(255, 255, 0)\n                wsA.Cells(fndRow + i, j + 43).Value = rIterator.Offset(, j - 1).Value * multplr(i)\n            End If\n            Next j\n        Next i\n        End If\n        Err.Clear\n    Next rIterator\n\n\n\n        For x = 6 To FinalRow\n            wsA.Cells(x, 49).FormulaR1C1 = \"=RC[-1]-RC[-3]\"\n        Next x\n\n        For x = 6 To FinalRow\n            wsA.Cells(x, 40).Formula = \"=\"\"TSR: \"\"&amp;AX6&amp;\"\" - \"\"&amp;AY6&amp;\"\" - \"\"&amp;AZ6&amp;\"\" USD Annual\"\n        Next x\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10265312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oiCAMn_4u3Q/AAAAAAAAAAI/AAAAAAAAEmE/bfViZhDfxl4/photo.jpg?sz=128", "display_name": "Irina", "link": "https://stackoverflow.com/users/10265312/irina"}, "edited": false, "score": 0, "creation_date": 1559153952, "post_id": 56366188, "comment_id": 99335961, "body": "Thank you very much Cyril for helping me again! I have this row highlighted <code>Set rng = Cells(row, &quot;H&quot;)</code> with a comment &quot;app defined or object defined error&quot;  - can you please advise what I can correct in a code?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 29, "user_id": 10265312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oiCAMn_4u3Q/AAAAAAAAAAI/AAAAAAAAEmE/bfViZhDfxl4/photo.jpg?sz=128", "display_name": "Irina", "link": "https://stackoverflow.com/users/10265312/irina"}, "edited": false, "score": 0, "creation_date": 1559156718, "post_id": 56366188, "comment_id": 99337077, "body": "@Irina weird that i just got your comment now, despite you sending 44 min ago and i updated my response 24 min ago.  Please see my update, utilizing the loops for <code>i</code> and <code>j</code>"}, {"owner": {"reputation": 29, "user_id": 10265312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oiCAMn_4u3Q/AAAAAAAAAAI/AAAAAAAAEmE/bfViZhDfxl4/photo.jpg?sz=128", "display_name": "Irina", "link": "https://stackoverflow.com/users/10265312/irina"}, "edited": false, "score": 0, "creation_date": 1559157534, "post_id": 56366188, "comment_id": 99337411, "body": "Thank you Cyril! Code stumbles over this <code>lrj = last(1, Range(Columns(&quot;B&quot;), Columns(&quot;D&quot;)))</code> saying that ~last~ is not defined here"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 29, "user_id": 10265312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oiCAMn_4u3Q/AAAAAAAAAAI/AAAAAAAAEmE/bfViZhDfxl4/photo.jpg?sz=128", "display_name": "Irina", "link": "https://stackoverflow.com/users/10265312/irina"}, "edited": false, "score": 0, "creation_date": 1559160254, "post_id": 56366188, "comment_id": 99338477, "body": "@Irina Take a look at the update to lrj... i used <code>.Find(&quot;*&quot;, , , , xlByRows, xlPrevious).Row</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 29, "user_id": 10265312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oiCAMn_4u3Q/AAAAAAAAAAI/AAAAAAAAEmE/bfViZhDfxl4/photo.jpg?sz=128", "display_name": "Irina", "link": "https://stackoverflow.com/users/10265312/irina"}, "edited": false, "score": 0, "creation_date": 1559162210, "post_id": 56366188, "comment_id": 99339208, "body": "@Irina Glad that worked for you... was looking out for your other post after the issues with formulae not working.  hopefully this fit the bill (ill rated at time of accept).  let me know if there is anything else wrong with this reponse"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": -1, "last_activity_date": 1559167088, "last_edit_date": 1559167088, "creation_date": 1559152740, "answer_id": 56366188, "question_id": 56365931, "link": "https://stackoverflow.com/questions/56365931/how-to-compare-two-arrays-by-multiple-columns-row-with-row/56366188#56366188", "title": "How to compare two arrays by multiple columns (row with row)", "body": "<p>Adding some indents so we can read this:</p>\n\n<pre><code>Sub Compare()\n    Dim firstColumn As String, lastColumn As String, resultsColumn As String, isFoundText As String, isNotFoundText As String, \n    Dim row As Integer, startChar As Integer, endChar As Integer, i As Integer\n    Dim hasMatch As Boolean\n    row = 2\n    firstColumn = \"H\"\n    lastColumn = \"J\"\n    resultsColumn = \"M\"\n    isFoundText = \"YES\"\n    isNotFoundText = \"NO\"\n    Do While Range(\"B\" &amp; row).Value &lt;&gt; \"\"\n        startChar = Asc(firstColumn)\n        endChar = Asc(lastColumn)\n        hasMatch = False\n        For i = startChar To endChar\n            If Range(Chr(i) &amp; row).Value = Range(Chr(i + 1) &amp; row).Value Then\n                hasMatch = True\n            End If\n            If Range(Chr(startChar) &amp; row).Value = Range(Chr(i + 1) &amp; row).Value Then\n                hasMatch = True\n            End If\n        Next i\n        If (hasMatch) Then\n            Range(resultsColumn &amp; row).Value = isFoundText\n        Else\n            Range(resultsColumn &amp; row).Value = isNotFoundText\n        End If\n        row = row + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Now, to start making changes... Looks like you can clean up your code with a simpler loop, such that (untested):</p>\n\n<pre><code>Dim lri as long, lrj as long, i as long, j as long\nlri = cells(rows.count,\"H\").end(xlup).row\nlrj = range(columns(\"B\"),columns(\"D\")).Find(\"*\", , , , xlByRows, xlPrevious).Row\nFor i = 2 to lri\n    For j = 2 to lrj\n        If Cells(j,\"B\").Value = cells(i,\"J\").Value AND Cells(j,\"C\").Value = Cells(i,\"I\").Value AND Cells(j,\"D\").Value = Cells(i,\"H\").Value Then\n        Cells(i,\"M\").Value = \"Yes\" 'don't need variables for these anymore\n        'may want to put an exit to j loop if True\n    Else \n        Cells(i,\"M\").Value = \"No\"\n    End If\n    row = row + 1\nLoop\n</code></pre>\n\n<p>This compares the values in each of the cells with their respective section (B to J, C to I, and D to H).</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1559166410, "last_edit_date": 1559166410, "creation_date": 1559166048, "answer_id": 56368899, "question_id": 56365931, "link": "https://stackoverflow.com/questions/56365931/how-to-compare-two-arrays-by-multiple-columns-row-with-row/56368899#56368899", "title": "How to compare two arrays by multiple columns (row with row)", "body": "<p>For this type of task it's better to move that data to <em>Variant Arrays</em> and do the looping over those (<em>much</em> faster). Also, the the pattern matching can be generalised away from the data, making for a more reusable solution and seperation of concerns</p>\n\n<p>The Compare Function</p>\n\n<pre><code>Private Function CompareColumns(Table1 As Range, Table2 As Range, ColPairs() As Variant, Optional IsMatch As Variant = True, Optional NoMatch As Variant = False) As Variant\n    Dim Table1Data As Variant\n    Dim Table2Data As Variant\n    Dim OutputData As Variant\n    Dim rw1 As Long, rw2 As Long\n    Dim Col As Long\n    Dim FoundMatch As Boolean\n\n    ' Move data to variant arrays\n    Table1Data = Table1.Value2\n    Table2Data = Table2.Value2\n\n    ' Size return array\n    ReDim OutputData(1 To UBound(Table1Data, 1), 1 To 1)\n\n    ' Loop the arrays\n    For rw2 = 1 To UBound(Table2Data, 1)\n        OutputData(rw2, 1) = NoMatch ' initialise\n        For rw1 = 1 To UBound(Table1Data, 1)\n            FoundMatch = True\n            For Col = LBound(ColPairs, 1) To UBound(ColPairs)\n                If Table1Data(rw1, ColPairs(Col, 1)) &lt;&gt; Table2Data(rw2, ColPairs(Col, 2)) Then\n                    FoundMatch = False ' column not a match, move to next row\n                    Exit For\n                End If\n            Next\n            If FoundMatch Then ' found a match\n                OutputData(rw2, 1) = IsMatch\n                Exit For ' exit Table2 loop when match found\n            End If\n        Next\n    Next\n    ' Return result to caller\n    CompareColumns = OutputData\nEnd Function\n</code></pre>\n\n<p>Use it like this</p>\n\n<pre><code>Sub Compare()\n    Dim ws As Worksheet\n    Dim Table1 As Range\n    Dim Table2 As Range\n    Dim Output As Range\n    Dim OutputTable As Variant\n    Dim ColPairs() As Variant\n\n    Set ws = ActiveSheet ' update to suit your needs\n\n    ' Set up ranges by any means you choose\n    With ws\n        Set Table1 = .Range(.Cells(2, 1), .Cells(.Rows.Count, 3).End(xlUp))\n        Set Table2 = .Range(.Cells(2, 10), .Cells(.Rows.Count, 8).End(xlUp))\n        Set Output = .Cells(2, 13).Resize(Table2.Rows.Count, 1)\n    End With\n\n    'Specify columns to compare\n    ReDim ColPairs(1 To 3, 1 To 2)\n    ColPairs(1, 1) = 1: ColPairs(1, 2) = 3\n    ColPairs(2, 1) = 2: ColPairs(2, 2) = 2\n    ColPairs(3, 1) = 3: ColPairs(3, 2) = 1\n\n    ' Call Match function\n    OutputTable = CompareColumns(Table1, Table2, ColPairs, \"Yes\", \"No\")\n\n    ' Place Output on sheet\n    Output = OutputTable\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10265312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oiCAMn_4u3Q/AAAAAAAAAAI/AAAAAAAAEmE/bfViZhDfxl4/photo.jpg?sz=128", "display_name": "Irina", "link": "https://stackoverflow.com/users/10265312/irina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 56368899, "answer_count": 2, "score": 0, "last_activity_date": 1559316726, "creation_date": 1559151663, "last_edit_date": 1559316726, "question_id": 56365931, "link": "https://stackoverflow.com/questions/56365931/how-to-compare-two-arrays-by-multiple-columns-row-with-row", "title": "How to compare two arrays by multiple columns (row with row)", "body": "<p>I have two tables in one spreadsheet. both have the same columns - Name, City, Province. My goal is to compare both and if three out of three values in a row match, then pull \"Yes\", if not, pull \"No\". I compare rows with rows in these two tables (not random cells).  </p>\n\n<p>I have not found a proper formula, so probably need to code it.</p>\n\n<p>I have found a good code, but it works only for looking at the same values in one array. I hope it could be adapted to my problem. Or maybe I need another one.  </p>\n\n<pre><code>Sub Compare()\n    Dim row As Integer\n    row = 2\n    Dim firstColumn As String\n    firstColumn = \"H\"\n    Dim lastColumn As String\n    lastColumn = \"J\"\n    Dim resultsColumn As String\n    resultsColumn = \"M\"\n    Dim isFoundText As String\n    isFoundText = \"YES\"\n    Dim isNotFoundText As String\n    isNotFoundText = \"NO\"\n\n    Do While Range(\"B\" &amp; row).Value &lt;&gt; \"\"\n\n        Dim startChar As Integer\n        startChar = Asc(firstColumn)\n        Dim endChar As Integer\n        endChar = Asc(lastColumn)\n        Dim i As Integer\n        Dim hasMatch As Boolean\n        hasMatch = False\n\n        For i = startChar To endChar\n            If Range(Chr(i) &amp; row).Value = Range(Chr(i + 1) &amp; row).Value Then\n                hasMatch = True\n            End If\n            If Range(Chr(startChar) &amp; row).Value = Range(Chr(i + 1) &amp; row).Value Then\n                hasMatch = True\n            End If\n        Next i\n\n        If (hasMatch) Then\n            Range(resultsColumn &amp; row).Value = isFoundText\n        Else\n            Range(resultsColumn &amp; row).Value = isNotFoundText\n        End If\n        row = row + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559151004, "post_id": 56365691, "comment_id": 99334752, "body": "You are allocating the value from those cells to the variable... i think you should do it the other way around, i.e.: <code>ws.Cells(i, &quot;D&quot;).value = currVal</code>"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559151183, "post_id": 56365691, "comment_id": 99334836, "body": "This <code>lastC = ws.Cells(Rows.Count, 1).End(xlUp).Row</code>, if you don&#39;t qualify <code>Rows.Count</code> it will automatically be <code>ActiveSheet.Rows.Count</code> ... in this case might not make any difference, but keep in mind for future, it should be <code>lastC = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 23, "user_id": 11568451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04aa02cdc0687775caee1adcef95c17a?s=128&d=identicon&r=PG&f=1", "display_name": "Sadie", "link": "https://stackoverflow.com/users/11568451/sadie"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559151334, "post_id": 56365691, "comment_id": 99334894, "body": "Oh, thank your for your quick response.  When I change that, the macro runs!!  Yay, first time it&#39;s run.  But now, it deletes what is in column C and nothing is copied?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559151404, "post_id": 56365691, "comment_id": 99334924, "body": "Did you swap <code>currVal = ws.Cells(i, &quot;c&quot;)</code> too? That was fine... just the other 3 where you want to write the value back to the cells, it should be <code>cell = value</code>, not <code>value = cell</code>."}, {"owner": {"reputation": 23, "user_id": 11568451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04aa02cdc0687775caee1adcef95c17a?s=128&d=identicon&r=PG&f=1", "display_name": "Sadie", "link": "https://stackoverflow.com/users/11568451/sadie"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1559151617, "post_id": 56365691, "comment_id": 99335005, "body": "You are a lifesaver!  Yes, that&#39;s exactly what i did wrong!  thank you so much for helping!   ;)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11568451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04aa02cdc0687775caee1adcef95c17a?s=128&d=identicon&r=PG&f=1", "display_name": "Sadie", "link": "https://stackoverflow.com/users/11568451/sadie"}, "edited": false, "score": 0, "creation_date": 1559155401, "post_id": 56366006, "comment_id": 99336516, "body": "and if you needed to paste the formulas?  is there a simple way to xlpaste.formulas?  And I do really like the R for rows, makes so much more sense!  Thank you for all your help with this."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 23, "user_id": 11568451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04aa02cdc0687775caee1adcef95c17a?s=128&d=identicon&r=PG&f=1", "display_name": "Sadie", "link": "https://stackoverflow.com/users/11568451/sadie"}, "edited": false, "score": 0, "creation_date": 1559157048, "post_id": 56366006, "comment_id": 99337219, "body": "You can use <code>range.Value</code> for values, <code>range.formula</code> for formulas, etc."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 1, "last_activity_date": 1559156999, "last_edit_date": 1559156999, "creation_date": 1559151970, "answer_id": 56366006, "question_id": 56365691, "link": "https://stackoverflow.com/questions/56365691/excel-vba-loop-through-column-to-copy-and-paste-non-blanks-to-3-other-columns/56366006#56366006", "title": "Excel VBA Loop through Column to Copy and Paste Non Blanks to 3 other Columns?", "body": "<p>Adding to the comments, this is how I would have written that particular code, maybe it helps:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Copy()\n\n    Dim ws As Worksheet: Set ws = ActiveSheet\n    Dim lastC As Long: lastC = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n    Dim R As Long 'I like to use R (rows) &amp; C (cols), just because makes it more readable (for me)\n\n    For R = 4 To lastC\n        With ws\n            If .Cells(R, \"A\").Value &lt;&gt; \"\" Then\n                .Cells(R, \"D\") = .Cells(R, \"C\").Value\n                .Cells(R, \"G\") = .Cells(R, \"C\").Value\n                .Cells(R, \"I\") = .Cells(R, \"C\").Value\n            End If\n        End With\n    Next R\n\nEnd Sub\n</code></pre>\n\n<p>PS: I prefer numbers instead of letters for <code>.Cells</code> reference, but in this case is understandable to use letter. Just for best practice - readability wise, shouldn't mix them.</p>\n"}], "owner": {"reputation": 23, "user_id": 11568451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04aa02cdc0687775caee1adcef95c17a?s=128&d=identicon&r=PG&f=1", "display_name": "Sadie", "link": "https://stackoverflow.com/users/11568451/sadie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56366006, "answer_count": 1, "score": 2, "last_activity_date": 1559156999, "creation_date": 1559150550, "last_edit_date": 1559151010, "question_id": 56365691, "link": "https://stackoverflow.com/questions/56365691/excel-vba-loop-through-column-to-copy-and-paste-non-blanks-to-3-other-columns", "title": "Excel VBA Loop through Column to Copy and Paste Non Blanks to 3 other Columns?", "body": "<p>I am new to Excel VBA and have run into a road block. I am not receiving any errors when I run this and I am unsure where to even start...  </p>\n\n<p>I would like to search column C and if there is a non blank copy that value to columns (D,G,I) of the same worksheet.  I would start the searching in Row 4.  </p>\n\n<p>I've tried stepping through the code and I'm pretty sure my error is with currVal = ws.Cells(i, \"c\").  When I step through, nothing happens on the excel sheet (no cells are copied or pasted).  </p>\n\n<p>Any assistance is GREATLY appreciated! I've been looking at this all morning.  </p>\n\n<pre><code>Sub Copy()\n\nDim lastC As Integer\nDim i As Integer\nDim j As Integer\nDim currVal As String\nDim ws As Worksheet\n\nSet ws = ActiveSheet\nlastC = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 4 To lastC\ncurrVal = ws.Cells(i, \"c\")\n   If ws.Cells(i, 1).Value &lt;&gt; \"\" Then\n       currVal = ws.Cells(i, \"D\")\n       currVal = ws.Cells(i, \"G\")\n       currVal = ws.Cells(i, \"I\")\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Actual results is nothing happens (at least that I can see) and with no errors giving me a place to start looking! </p>\n\n<p>Expected Results would be copying this into 3 additional columns.  The result is an actual formula.  The formula is what i need to be copied.  </p>\n\n<p>5/27/2019 9:39 --- value</p>\n\n<p>='15_2019-02_003.CSV'!$A$2  -- formula</p>\n\n<p>I have addressed the formula updating and removing references to the CSV file once the value is pulled from original CSV File.  The purpose of this code is only to search blanks and copy/paste.<a href=\"https://i.stack.imgur.com/9JBMl.png\" rel=\"nofollow noreferrer\">Picture of Excel WS</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1559150498, "post_id": 56365603, "comment_id": 99334514, "body": "What error message or number are you getting?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1559151072, "post_id": 56365603, "comment_id": 99334787, "body": "You should either re-apply the same filter to get only the csv files, or add an <code>If</code> statement to skip any non-csv files that are found."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559151347, "post_id": 56365603, "comment_id": 99334900, "body": "What&#39;s the name of the file which causes the error ?  I&#39;ve never seen <code>Dir</code> ignore a filter."}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559151834, "post_id": 56365603, "comment_id": 99335088, "body": "@TimWilliams An example file name that works is &quot;SECMQ0419045345D.CSV&quot;. An example that doesn&#39;t work is &quot;SECMQ0419045345D.TXT&quot;. Every CSV file will have a corresponding TXT file."}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1559151907, "post_id": 56365603, "comment_id": 99335102, "body": "@Mistella I get run-time error 5. Invalid procedure call or argument, on the <code>strWorkbook = Dir</code> line."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1559152065, "post_id": 56365603, "comment_id": 99335164, "body": "@TBoulz - have you tried my code below? If it works, consider changing <code>Call Export_Excel_as_PDF(wbktoExport)</code> to <code>Export_Excel_as_PDF wbktoExport</code>"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1559152712, "post_id": 56365948, "comment_id": 99335420, "body": "Thanks for the reply. Your code did work when I hardcode the exact folder into it, but I won&#39;t be doing that moving forward.  To give some more information, I edited my post to include what the string <code>strSourceExcelLocation</code> is. The string includes another string <code>fldr</code> which is determined through user input as it will always change and we won&#39;t always know the name of it in advance.  If it is not related to that string, then could it be something to do with the actions I&#39;m having it perform during the <code>Dir</code> loop (edit the csv then save as PDF)?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 1, "creation_date": 1559152999, "post_id": 56365948, "comment_id": 99335564, "body": "@TBoulz - making something small work is the first part in the debugging process. Now try to add the <code>fldr</code> part in the code and make sure it works. Do not add the pdf part still."}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1559153578, "post_id": 56365948, "comment_id": 99335808, "body": "Yes, I added the <code>fldr</code> in the same sub and it still worked. The path was printed to the immediate window."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1559153730, "post_id": 56365948, "comment_id": 99335863, "body": "@TBoulz - that&#39;s the way. So, if only the <code>CSV</code> path was printed tothe immediate window, then, you can concentrate on the 3 lines, related to the <code>Export_Excel_as_PDF</code> function."}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1559154643, "post_id": 56365948, "comment_id": 99336232, "body": "My first action in the loop is to open the <code>CSV</code> file, which doesn&#39;t work with the one string <code>strSourceExcelLocation</code> because it returns the file name from the directory, but it needs the full file path. I was using <code>strSourceExcelLocation</code> and <code>strWorkbook</code> to open the file previously. In the test sub we have tried, we are left with <code>workbookPath</code> but that is not enough to open the file, I think?"}, {"owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1559157409, "post_id": 56365948, "comment_id": 99337371, "body": "I think I&#39;ve found the cause of my problem. In the <code>Call Export_Excel_as_PDF(wbktoExport)</code> procedure, I use Dir again to see if a folder with today&#39;s date exists in a seperate location. So I think it is getting messed up because of a Dir within a Dir loop.  <code>If Len(Dir(strTargetPDFLocation, vbDirectory)) = 0 Then MkDir strTargetPDFLocation</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "edited": false, "score": 0, "creation_date": 1559174062, "post_id": 56365948, "comment_id": 99342348, "body": "@TBoulz - well, give it a try. Or provide the code for the Export_Excel_as_PDF (and please, do not use &amp;quot;_&amp;quot; in the names of the procedures, they are reserved signs for events \u263a)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1559151736, "creation_date": 1559151736, "answer_id": 56365948, "question_id": 56365603, "link": "https://stackoverflow.com/questions/56365603/excel-vba-dir-error-when-file-type-changes/56365948#56365948", "title": "Excel VBA Dir() Error when file type changes", "body": "<p>Try to hardcode the path and give it a try again. Probably the error is something really small in the hardcoding. E.g., in the code below, replace <code>C:\\Users\\username\\Desktop\\AAA\\</code> with the path of the file. Then run it. Do not forget the last <code>\\</code>. It should work:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim workbookPath As String\n    workbookPath = Dir(\"C:\\Users\\username\\Desktop\\AAA\\\" &amp; \"*.csv\")\n\n    Do While Len(workbookPath) &gt; 0\n        Debug.Print workbookPath\n        workbookPath = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "is_accepted": true, "score": 2, "last_activity_date": 1559158540, "creation_date": 1559158540, "answer_id": 56367377, "question_id": 56365603, "link": "https://stackoverflow.com/questions/56365603/excel-vba-dir-error-when-file-type-changes/56367377#56367377", "title": "Excel VBA Dir() Error when file type changes", "body": "<p>Solved my issue.</p>\n\n<p>The problem seems to have been because when I called another procedure, I had another <code>Dir</code> in that sub to create a new folder if one didn't already exist. So basically I had a <code>Dir</code> in a <code>Dir</code>, which apparently is bad.</p>\n\n<p>I moved the folder creation part to the very beginning of my procedure, so it is executed before I begin the <code>Dir</code> for looping through all the <code>CSV</code> files.</p>\n\n<pre><code>Option Explicit\n\nSub Loop_Dir_for_Excel_Workbooks()\nDim strWorkbook As String, wbktoExport As Workbook, strSourceExcelLocation As String, fldr As String, strTargetPDFLocation As String, d As String\n\nstrTargetPDFLocation = \"\\\\nhchefs001\\Accounting\\IMAGING\\BILLINGS &amp; DEDUCTIONS\\EAST MCB FILES\\\"\n'***** Creating a folder to save the PDFs in. Naming the folder with today's date *****\nd = Format(Date, \"mm-dd-yyyy\")\nstrTargetPDFLocation = \"\\\\nhchefs001\\Accounting\\IMAGING\\BILLINGS &amp; DEDUCTIONS\\EAST MCB FILES\\\" &amp; d &amp; \"\\\"\nIf Len(Dir(strTargetPDFLocation, vbDirectory)) = 0 Then MkDir strTargetPDFLocation\n\nfldr = InputBox(\"Input the EXACT Folder Name that you want to create PDFs for\")\n\nstrSourceExcelLocation = \"\\\\rilinfs001\\Interdepartmental\\Billings &amp; Deductions\\Billing Coordinators\\MCB Reports\\East\\Monthly Quality MCBs (CMQ &amp; SECMQ)\\2019\\Individual_Reports\\\" &amp; fldr &amp; \"\\\"\n\n'Search all Excel files in the directory with .xls, .xlsx, xlsm extensions\nstrWorkbook = Dir(strSourceExcelLocation &amp; \"*.csv\")\n\nDo While Len(strWorkbook) &gt; 0\n    'Open the workbook\n    Set wbktoExport = Workbooks.Open(Filename:=strSourceExcelLocation &amp; strWorkbook)\n\n    'Export all sheets as single PDF\n    Call Export_Excel_as_PDF(wbktoExport, strTargetPDFLocation)\n\n    'Close Excel workbook without making changes\n    wbktoExport.Close False\n\n    'Get next workbook\n    strWorkbook = Dir\n\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56367377, "answer_count": 2, "score": 1, "last_activity_date": 1559158540, "creation_date": 1559150113, "last_edit_date": 1559152682, "question_id": 56365603, "link": "https://stackoverflow.com/questions/56365603/excel-vba-dir-error-when-file-type-changes", "title": "Excel VBA Dir() Error when file type changes", "body": "<p>I'm trying to better understand the <code>Dir</code> function. I have a <code>Dir</code> loop to take action on all <code>.csv</code> files in the directory, but when the loop comes across another file type, like <code>.txt</code>, it will error instead of moving on to the next <code>.csv</code>. item. </p>\n\n<p>This is the relevant portion of my code.</p>\n\n<pre><code>strSourceExcelLocation = \"\\\\rilinfs001\\Interdepartmental\\Billings &amp; Deductions\\Billing Coordinators\\MCB Reports\\East\\Monthly Quality MCBs (CMQ &amp; SECMQ)\\2019\\Individual_Reports\\\" &amp; fldr &amp; \"\\\"\n\nstrWorkbook = Dir(strSourceExcelLocation &amp; \"*.csv*\")\n\nDo While Len(strWorkbook) &gt; 0\n    'Open the workbook\n    Set wbktoExport = Workbooks.Open(Filename:=strSourceExcelLocation &amp; strWorkbook)\n\n    'Export all sheets as single PDF\n    Call Export_Excel_as_PDF(wbktoExport)\n\n    'Get next workbook\n    strWorkbook = Dir\n\n    'Close Excel workbook without making changes\n    wbktoExport.Close False\nLoop\n</code></pre>\n\n<p>So if there are only  <code>.csv</code> files in the directory, then this works fine. When it comes across another file type, an error occurs. </p>\n\n<p>The error is on line</p>\n\n<pre><code>strWorkbook = Dir\n</code></pre>\n\n<p>Run-time error 5: Invalid procedure call or argument</p>\n\n<p>Am I missing something with the way I use the wildcards in the <code>.csv</code> at the beginning?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1559150213, "post_id": 56365578, "comment_id": 99334392, "body": "It is not working wit. I tried it..."}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 4, "creation_date": 1559150232, "post_id": 56365578, "comment_id": 99334402, "body": "What does not working mean? Are you getting an error? If so, on what line?"}, {"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1559150532, "post_id": 56365578, "comment_id": 99334539, "body": "It says &quot;Active method of worksheet class failed And when I debug it highlights the row &quot;Worksheets(&quot;Master Filtered&quot;).Activate &quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1559150547, "post_id": 56365578, "comment_id": 99334550, "body": "Add <code>Option Explicit</code> to the <i>very top</i> of the Module the code is in. This will force you to declare variables - right now you don&#39;t declare <code>myrange</code>, so I&#39;d at least add <code>Dim myrange as Range</code> to the code.  Also, since it&#39;s a static range (you&#39;re not changing it), I&#39;d <code>Set myrange ...</code> <i>outside</i> of the <code>For</code> loop."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1559152473, "post_id": 56365578, "comment_id": 99335317, "body": "Is the code in a module or in a worksheet? If it is in a worksheet, change to a module"}, {"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1559155027, "post_id": 56365578, "comment_id": 99336372, "body": "It is in a module already"}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 0, "last_activity_date": 1559176725, "creation_date": 1559176725, "answer_id": 56370214, "question_id": 56365578, "link": "https://stackoverflow.com/questions/56365578/is-it-possible-to-lookup-for-a-value-from-another-sheet-in-the-same-workbook/56370214#56370214", "title": "Is it possible to lookup for a value from another sheet in the same workbook?", "body": "<pre><code>Sub MTL_OR_TOR()\n    ' Name your variables in a meaningful way and indicate their type\n    Dim strAcctNb As String\n    Dim strResult As String\n    Dim lngLastRow As Long\n    Dim lngLoop As Long\n    Dim rngLookup As Range\n\n    'Set your range and variables before you execute the code for readability\n    Set rngLookup = Worksheets(\"MTL OR TOR\").Range(\"AA4:AB685\") 'Range in which the table MTL or TOR should be entered\n\n    'Do not Activate or Select unless you really have to\n    'Worksheets(\"Master Filtered\").Activate\n\n    With Worksheets(\"Master Filtered\")\n\n        lngLastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n        For lngLoop = 4 To lngLastRow\n            strAcctNb = .Cells(lngLoop, 3).Value\n            strResult = Application.WorksheetFunction.VLookup(strAcctNb, rngLookup, 2, False)\n            .Range(\"K\" &amp; lngLoop).Value = strResult\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56370214, "answer_count": 1, "score": 0, "last_activity_date": 1559176725, "creation_date": 1559150010, "last_edit_date": 1559152417, "question_id": 56365578, "link": "https://stackoverflow.com/questions/56365578/is-it-possible-to-lookup-for-a-value-from-another-sheet-in-the-same-workbook", "title": "Is it possible to lookup for a value from another sheet in the same workbook?", "body": "<p>I have a workbook with multiple spreadsheets. One of the sheets is called \"Master Filtered\" and the other is called \"MTL OR TOR\" \nI want to fill in the column K of the \"Master filtered\" sheet with a lookup value from the \"MTL or TOR\" sheet in the second column. I wrote this piece of code but it is not working.</p>\n\n<pre><code>Sub MTL_OR_TOR()\n    Dim AcctNb As String\n    Dim result As String\n\n\n    Worksheets(\"Master Filtered\").Activate \n    Dim lastrow As Long\n    lastrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n\n    For G = 4 To lastrow\n\n    AcctNb = Cells(G, 3).Value\n\n    Set myrange = Worksheets(\"MTL OR TOR\").Range(\"AA4:AB685\") 'Range in which the table MTL or TOR should be entered\n    result = Application.WorksheetFunction.VLookup(AcctNb, myrange, 2, False)\n\n    Range(\"K\" &amp; G).Value = result\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Do you have any idea why is this code not working and how to fix it?</p>\n\n<p>I was thinking maybe my error is in the line starting with <code>Set myrange= Worksheets(\"MTL OR TOR\")</code> but couldn't figure it out.</p>\n"}, {"tags": ["excel", "vba", "filter"], "comments": [{"owner": {"reputation": 11, "user_id": 11516355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c197739aec20d6886d0067c31937c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth N", "link": "https://stackoverflow.com/users/11516355/gareth-n"}, "edited": false, "score": 0, "creation_date": 1559149782, "post_id": 56365428, "comment_id": 99334168, "body": "After a little bit more playing with the code I appear to have found a solution. The code was looking at Sheet A for the advance filter criteria (which is blank data) and all I needed to do was to add the sheet to CriteriaRange..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1559149999, "post_id": 56365428, "comment_id": 99334268, "body": "Unqualified <code>Range</code> calls are member calls against <code>Me</code>, i.e. the <code>Worksheet</code> module that code is written in (would be implicit/indirect reference to <code>ActiveSheet</code> otherwise). Don&#39;t <code>Select</code> sheets, declare a <code>Worksheet</code> variable and <code>Set</code> it to the sheet object you mean to work with, then use that variable to qualify the <code>Range</code> member calls that mean to work against that particular worksheet."}, {"owner": {"reputation": 11, "user_id": 11516355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c197739aec20d6886d0067c31937c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth N", "link": "https://stackoverflow.com/users/11516355/gareth-n"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559153225, "post_id": 56365428, "comment_id": 99335665, "body": "Thanks @MathieuGuindon , I&#39;m fairly new to working with VBA so it isn&#39;t very elegant but will work to update it with your advice. Much appreciated thanks :D"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559153845, "post_id": 56365428, "comment_id": 99335924, "body": "FWIW <a href=\"http://www.rubberduckvba.com/\" rel=\"nofollow noreferrer\">Rubberduck</a> (a free, open-source VBE add-in project I manage) can help making your indentation so perfectly consistent even professional programmers wouldn&#39;t notice how inexperienced you are, <i>and</i> it can locate <a href=\"http://rubberduckvba.com/Inspections/List\" rel=\"nofollow noreferrer\">a number of</a> &quot;beginner traps&quot; in your code, too =)"}], "owner": {"reputation": 11, "user_id": 11516355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c197739aec20d6886d0067c31937c3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Gareth N", "link": "https://stackoverflow.com/users/11516355/gareth-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559150718, "creation_date": 1559149382, "last_edit_date": 1559150718, "question_id": 56365428, "link": "https://stackoverflow.com/questions/56365428/advance-filter-failing-to-work-as-part-of-worksheet-changeby-val", "title": "Advance filter failing to work as part of worksheet_change(by Val)", "body": "<p>I am trying to automatically update a graph once set criteria are change using advance filters.</p>\n\n<p>There are three specific cell that set the criteria range on a separate sheet that is meant to then filter on these new values which then produce the updated graph..</p>\n\n<p>i.e. \nI am trying to use an advance filter on Sheet B (Graph Sheet) from data taken from Sheet A (Summary Sheet) when set cells change in value on Sheet A which will update a graph on Sheet A that takes the data from the filtered table on Sheet B</p>\n\n<p>Unfortunately the code below (also using the alternative entry looking at the table rather than set range of cells) isn't completing the advance filter as required even when, if I run it separately, the advance filter code does appear to filter the table (and thus update the graph)</p>\n\n<p>Any help would be appreciated...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim KeyCells As Range\n\nSet KeyCells = Worksheets(\"Summary Sheet\").Range(\"O5:S6\")\n\nIf Not Application.Intersect(KeyCells, Range(Target.Address)) _\n       Is Nothing Then\n\nSheets(\"Graph Sheet\").Select\nApplication.CutCopyMode = False\nApplication.CutCopyMode = False\nRange(\"A7:S1002\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:= _\n    Range(\"G1:I2\"), Unique:=False\nSheets(\"Summary Sheet\").Select\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Alternative Code</p>\n\n<pre><code>Sheets(\"Graph Sheet\").Select\nApplication.CutCopyMode = False\nApplication.CutCopyMode = False\nRange(\"Filter[#All]\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:= _\n    Range(\"G1:I2\"), Unique:=False\nSheets(\"Summary Sheet\").Select\n</code></pre>\n\n<p>No error messages appear upon the code 'running' but the table is not filtered on the required values</p>\n"}, {"tags": ["mysql", "excel", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1559147716, "post_id": 56364952, "comment_id": 99333249, "body": "The problem with Connect() is that the connection is only local to that function, it would need to be a <i>Module Level Variable</i> instead.  You should add some timing code to see if its the connection or query that takes the most time.  The obvious way to speed up the query is to build a single SQL statement that queries for multiple items at once - i.e making only one trip to the DB - but this depends of your use case of the function."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1559147771, "post_id": 56364952, "comment_id": 99333280, "body": "Concatenating values to SQL statements opens you up to SQL Injection vulnerabilities/bugs, ADO supports Parameterized Queries which fix this."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1559148781, "post_id": 56364952, "comment_id": 99333725, "body": "Also, make sure you set the recordset to readonly."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559148916, "post_id": 56364952, "comment_id": 99333782, "body": "If you&#39;re running this as a UDF, then you could/should use something like a dictionany to cache the result for a given set of inputs, so instead of re-running the query each time the worksheet calculates, you can return a cached result (which clearly will be much faster).  How long you cache the result depends on your data and how volatile it is.   Eg:  <a href=\"https://stackoverflow.com/questions/34048266/excel-vba-function-with-recordset-performance-issue/34059374#34059374\" title=\"excel vba function with recordset performance issue\">stackoverflow.com/questions/34048266/&hellip;</a>"}, {"owner": {"reputation": 108, "user_id": 11057542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5606a0d3bca9261defdc98be2a8723f?s=128&d=identicon&r=PG&f=1", "display_name": "jmaloney13", "link": "https://stackoverflow.com/users/11057542/jmaloney13"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1559153614, "post_id": 56364952, "comment_id": 99335826, "body": "@Alex K. Yes! That worked! Just moved the &quot;Dim Conn as ADODB.Connection&quot; before &quot;Sub Connect()&quot; and my sheet now updates correctly and wonderfully fast. Thank you, thank you. Geez. Wow. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 108, "user_id": 11057542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5606a0d3bca9261defdc98be2a8723f?s=128&d=identicon&r=PG&f=1", "display_name": "jmaloney13", "link": "https://stackoverflow.com/users/11057542/jmaloney13"}, "is_accepted": false, "score": 2, "last_activity_date": 1559169635, "creation_date": 1559169635, "answer_id": 56369430, "question_id": 56364952, "link": "https://stackoverflow.com/questions/56364952/can-i-speed-up-this-vba-function-that-queries-an-aws-mysql-db/56369430#56369430", "title": "Can I speed up this VBA function that queries an (AWS) mysql db?", "body": "<p>Based on @Alex K.'s comment above, I changed the code as follows: </p>\n\n<pre><code>Dim Conn As ADODB.Connection\n\nSub Connect()\n\n    Dim connstring As String\n\n    Set Conn = New ADODB.Connection\n\n    connstring = \"connection string\"\n\n    Conn.Open connstring\nEnd Sub\n\nPublic Function Quer(Param1 As String, Param2 As String, Param3 As String)\n\n    Dim querystring1 As String\n    Dim rs1 As ADODB.Recordset\n\n    querystring1 = \"Select \" &amp; Param1 &amp; \" FROM table WHERE Param2 = \" &amp; Param2 &amp; \" AND Param3 = \" &amp; Param3\n\n    Set rs1 = New ADODB.Recordset\n    rs1.Open querystring1, Conn\n\n    Record = rs1.GetRows\n\n    Quer = Record(0, 0)\n\nEnd Function\n</code></pre>\n\n<p>Conn is now set as a module level variable, so it works in both the Sub Connect() and the Quer function. With this change, the Quer function works and does, indeed, update much faster. \nThis change does not address the security/vulnerability issues with my code, but it solves my initial problem and helps me considerably with what I'm trying to do. \nThanks to everyone who commented for your help. </p>\n"}], "owner": {"reputation": 108, "user_id": 11057542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5606a0d3bca9261defdc98be2a8723f?s=128&d=identicon&r=PG&f=1", "display_name": "jmaloney13", "link": "https://stackoverflow.com/users/11057542/jmaloney13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559169635, "creation_date": 1559147334, "last_edit_date": 1559148738, "question_id": 56364952, "link": "https://stackoverflow.com/questions/56364952/can-i-speed-up-this-vba-function-that-queries-an-aws-mysql-db", "title": "Can I speed up this VBA function that queries an (AWS) mysql db?", "body": "<p>I've written a function (see below) that queries an external MySQL database that's set up on AWS and returns a single value. It works fine - just like I wanted it to, really - except that it's fairly slow. If you're just using the function in a spreadsheet once, it's fine, but if you want to pull, say, 10 different numbers from your database into your spreadsheet, there's an annoying pause of several seconds (15?) while they all update. \nIt's not the end of the world, but it seems like it could/should be faster.</p>\n\n<p>I wondered if the problem was that I was opening a new connection to the db each time I ran the function, so I tried to split the process up into a Sub that connects to the db, and a function that just submits the queries (see further below). I thought I'd run the \"Connect\" Sub once when I first opened the spreadsheet, and then use the querying function as needed, but that didn't work at all. I just got a \"#VALUE\" in any cell that included the function. </p>\n\n<p>I realize that this is a pretty open-ended question and I apologize, but I'm stumped, and I thought someone on stackoverflow might have some good suggestions. It just seems like this should be faster than it is. \nIt probably goes without saying, but: I'm new to VBA and find it pretty wonky and confusing. </p>\n\n\n\n<p>Original function:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function Quer(Param1 As String, Param2 As String, Param3 As String)\n\n    Dim Conn As ADODB.Connection\n    Dim rs1 As ADODB.Recordset\n    Dim connstring As String\n\n    Set Conn = New ADODB.Connection\n\n    connstring = \"connection string\"\n\n    Conn.Open connstring\n\n    Dim querystring1 As String\n\n    querystring1 = \"Select \" &amp; Param1 &amp; \" FROM table WHERE Param2 = \" &amp; Param2 &amp; \" AND Param3 = \" &amp; Param3\n\n    Set rs1 = New ADODB.Recordset\n    rs1.Open querystring1, Conn\n\n    Record = rs1.GetRows\n\n    Quer = Record(0, 0)\n\n\nEnd Function\n</code></pre>\n\n<p>Like I said, the above function seemed to work fine, just slow. </p>\n\n<p>My \"second attempt\" was the following, which tried to split up the main database connection and the individual queries. This was a complete failure, as far as I could tell, but maybe there's some easy fix that I'm missing. Or does it matter? Would this approach be faster even if it worked?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Connect()\n\n    Dim Conn As ADODB.Connection\n    Dim connstring As String\n\n    Set Conn = New ADODB.Connection\n\n    connstring = \"connection string\"\n\n    Conn.Open connstring\nEnd Sub\n\nPublic Function Quer(Param1 As String, Param2 As String, Param3 As String)\n\n    Dim querystring1 As String\n    Dim rs1 As ADODB.Recordset\n\n    querystring1 = \"Select \" &amp; Param1 &amp; \" FROM table WHERE Param2 = \" &amp; Param2 &amp; \" AND Param3 = \" &amp; Param3\n\n    Set rs1 = New ADODB.Recordset\n    rs1.Open querystring1, Conn\n\n    Record = rs1.GetRows\n\n    Quer = Record(0, 0)\n\nEnd Function\n\n</code></pre>\n\n<p>Any thoughts or suggestions would be much appreciated.</p>\n"}, {"tags": ["vba", "ms-access", "dateadd"], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "edited": false, "score": 0, "creation_date": 1559203999, "post_id": 56367140, "comment_id": 99350078, "body": "I have a similar production process, and I do what @ChanceFinley has suggested, I store the duration of the production activity as a decimal rather than a number of hours.  My code than tracks the running total for any activities that are less than 1 in duration, and moves to a new day once the running total exceeds 1, and then I subtract 1 from the running total and carry on adding."}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "edited": false, "score": 0, "creation_date": 1559204360, "post_id": 56367140, "comment_id": 99350194, "body": "As a further suggestion, you may find @Gustav WorkDayAdd code helpful, rather than DateAdd.  His code allows for weekends, holidays etc to be adjusted for."}], "tags": [], "owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "is_accepted": false, "score": 1, "last_activity_date": 1559220471, "last_edit_date": 1559220471, "creation_date": 1559157326, "answer_id": 56367140, "question_id": 56364924, "link": "https://stackoverflow.com/questions/56364924/is-there-a-vba-function-that-allows-me-to-set-the-number-of-hours-in-a-day-to-le/56367140#56367140", "title": "Is there a VBA function that allows me to set the number of hours in a day to less than 24 hrs?", "body": "<p>When your DateTime value goes over 12 hours you could divide that value by 2.</p>\n\n<p>Start Time = 05/01/2019 8:00AM \nEnd Time = 05/02/2019 8:00 AM</p>\n\n<p>The Total time taken here is 24 hours. But since you only work 12 hour days, dividing by 2 will give you, 12 hours. </p>\n\n<p>If you worked 8 hour days, you could divide by 3 to return only 8 hours and so forth.</p>\n\n<p>Keep in mind your value with this solution will be in a decimal format, not a Time format</p>\n\n<pre><code>Dim ActualTimeTaken as Decimal\n\nrs.Edit\n\nIf rs.(\"YourTimeTaken\").value &gt; 12 Then\n\n    ActualTimeTaken = rs.(\"YourTimeTaken\").Value / 2\n    'Do whatever you need here.\n\n\nEnd If\n\nrs.Update\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11574046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fa25e1a46f32faeac3222cdeaa61950?s=128&d=identicon&r=PG&f=1", "display_name": "Nepali_nut", "link": "https://stackoverflow.com/users/11574046/nepali-nut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594771752, "creation_date": 1559147225, "last_edit_date": 1594771752, "question_id": 56364924, "link": "https://stackoverflow.com/questions/56364924/is-there-a-vba-function-that-allows-me-to-set-the-number-of-hours-in-a-day-to-le", "title": "Is there a VBA function that allows me to set the number of hours in a day to less than 24 hrs?", "body": "<p>I am trying to create a VBA loop that will run through a set of orders. For each order I have a duration in hours. For each record, it will add the duration to the start date time and create the end date time. The end date time will be the start date time for the next record etc.</p>\n\n<p>I have this working using the <code>dateadd</code> function but that assumes that the production happens 24 hrs a day. </p>\n\n<p>How can I specify that we only work 12 hours a day for example, so any work that goes past say, 7 pm in the evening will spill into the next day?</p>\n\n<p>I tried using <code>dateadd</code> in a loop and it works but I cannot specify 12 hours in a day</p>\n\n<pre><code>Set rs = db.OpenRecordset(\"Select * from Combined_Prod_PO_2_T ORDER BY SEQ\")\n\n'Define Changeover master as RefChangeover recordset\nDim EffStart_DateTime As Date\nDim EffEnd_DateTime As Date\nDim FamFrom As String\nDim FamTo As String\nDim changeover As Double\nDim RefChangeover As Recordset\n\n'rs.OpenRecordset\nrs.MoveFirst\nDo Until rs.EOF\n    EffEnd_DateTime = rs.Fields(\"EFFEND_DATETIME\")\n    FamFrom = rs.Fields(\"PRODUCT_FAMILY\")\n    Debug.Print FamFrom\n\n    rs.MoveNext\n    If Not rs.EOF Then        ' making sure that the \"next\" line exists i.e. stop at the second last line\n        FamTo = rs.Fields(\"PRODUCT_FAMILY\")\n        Debug.Print FamTo\n        Duration = rs.Fields(\"DURATION\")\n\n        Dim sqlcmd As String\n        sqlcmd = \"select sum(hrs) from (SELECT hrs from AP_Changeover_Master where [FROM] = '\" &amp; FamFrom &amp; \"'\" &amp; \" and [TO] = '\" &amp; FamTo &amp; \"'\" &amp; \" union select distinct 0 from AP_Changeover_Master) \"\n\n        Debug.Print sqlcmd\n        Set RefChangeover = db.OpenRecordset(sqlcmd)\n        changeover = RefChangeover.Fields(0).Value\n        Debug.Print changeover\n\n        'If Not rs.EOF Then\n\n        rs.Edit\n        rs(\"Effstart_datetime\") = EffEnd_DateTime\n        rs(\"EffEnd_DateTime\") = DateAdd(\"n\", (Duration + changeover) * 60, EffEnd_DateTime)\n        rs(\"changeover\") = changeover\n        rs.Update\n    End If\nLoop\nrs.Close\nSet rs = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 695, "user_id": 3385216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d26b0dd65930ae15e83dcdf422f1819?s=128&d=identicon&r=PG&f=1", "display_name": "jamie", "link": "https://stackoverflow.com/users/3385216/jamie"}, "edited": false, "score": 0, "creation_date": 1559154116, "post_id": 56364837, "comment_id": 99336030, "body": "should be edited to remove the &quot;tsql&quot; tag."}, {"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1559164583, "post_id": 56364837, "comment_id": 99340015, "body": "Unable to test, but I think your connection string should look a bit more like this as it&#39;s missing the Driver specification: <code>Driver={SQL Server};Server=myServerAddress;Database=myDataBase;Uid=myUse&zwnj;&#8203;rname;Pwd=myPassword&zwnj;&#8203;;</code>"}, {"owner": {"reputation": 19, "user_id": 11573565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57cb1b39cae86c051f832c989bcf5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Wolf", "link": "https://stackoverflow.com/users/11573565/joe-wolf"}, "edited": false, "score": 0, "creation_date": 1559330293, "post_id": 56364837, "comment_id": 99399722, "body": "Fink, you were right.  Thank you for the help.  I had another error after, but it was a fairly simple fix (Environment).  Thank You So Much."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 11573565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57cb1b39cae86c051f832c989bcf5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Wolf", "link": "https://stackoverflow.com/users/11573565/joe-wolf"}, "is_accepted": true, "score": 0, "last_activity_date": 1560368844, "creation_date": 1560368844, "answer_id": 56569423, "question_id": 56364837, "link": "https://stackoverflow.com/questions/56364837/opening-adodb-connection-receiving-error-data-source-name-not-found-and-no-d/56569423#56569423", "title": "Opening ADODB.Connection - Receiving error: &quot;Data source name not found and no default driver specified.&quot;", "body": "<p>The code was missing:    </p>\n\n<pre><code> Driver={SQLServer};Server=myServerAddress;Database=myDataBase;Uid=myUsername;Pwd=myPassword;\n</code></pre>\n\n<p>as pointed out by Fink (user:167478).  After adding I was able to successfully run the stored proc.</p>\n"}], "owner": {"reputation": 19, "user_id": 11573565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b57cb1b39cae86c051f832c989bcf5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Wolf", "link": "https://stackoverflow.com/users/11573565/joe-wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "accepted_answer_id": 56569423, "answer_count": 1, "score": 1, "last_activity_date": 1562449023, "creation_date": 1559146873, "last_edit_date": 1562449023, "question_id": 56364837, "link": "https://stackoverflow.com/questions/56364837/opening-adodb-connection-receiving-error-data-source-name-not-found-and-no-d", "title": "Opening ADODB.Connection - Receiving error: &quot;Data source name not found and no default driver specified.&quot;", "body": "<p>On <code>oConn.Open</code> I get the error</p>\n\n<blockquote>\n  <p>[Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified</p>\n</blockquote>\n\n<p>The goal of the project is to generate a report in Excel from the SQL database. This is a first go round to test the concept and see how expansive we could make it. The stored proc works, I have verified in SQL.</p>\n\n<p>I've verified that there is the Microsoft ActiveX Data Objects 6.1 Library.  I know there is also 2.8 but I chose to use the most recent extension.</p>\n\n<p>I don't know if I need to run anything or connect it anyway. I've run \"ODBC Data Sources (64-bit)\" however I've not edited anything in the ODBC.</p>\n\n<p>Here is all the code I am running in VBA.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub DataTakenFromSQL()\nDim oConn As New ADODB.Connection\nDim rs As New ADODB.Recordset\nDim fld As ADODB.Field\nDim mySQL As String\nDim Row As Integer\nDim Col As Integer\nDim ws As ThisWorkbook\nSet ws = ThisWorkbook\nApplication.ScreenUpdating = False\nSet oConn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nmySQL = \"EXEC [StoredProc] @var = 'nVarChar'\"\noConn.ConnectionString = \"{SQL Server};\" &amp; _\n  \"Server=[SERVER];uid=[UN];pwd=[PW];database=[DATABASE]\"\noConn.ConnectionTimeout = 90\n\noConn.Open\n\nrs.Open mySQL, oConn\nIf rs.EOF Then\n    MsgBox \"No Matching Records\"\n    rs.Close\n    oConn.Close\n    Exit Sub\nEnd If\nRow = 5\nCol = 1\n    For Each fld In rs.Fields\n    Sheet1.Cells(Row, Col).Value = fld.Name\n    Col = (Col + 1)\n    Next\nrs.MoveFirst\nRow = Row + 1\nDo While Not rs.EOF\n    Col = 1\n    For Each fld In rs.Fields\n    Sheet1.Cells(Row, Col).Value = fld\n    Col = Col + 1\n    Next\nRow = Row + 1\nrs.MoveNext\nLoop\nrs.Close\noConn.Close    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1090, "user_id": 3878638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UlH9h.png?s=128&g=1", "display_name": "wbrugato", "link": "https://stackoverflow.com/users/3878638/wbrugato"}, "edited": false, "score": 0, "creation_date": 1559146368, "post_id": 56364645, "comment_id": 99332576, "body": "If you select the range of columns you want to resize via <code>.Select</code> I believe you can do something like <code>Selection.EntireColumn.Autofit</code>"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559148326, "post_id": 56364645, "comment_id": 99333527, "body": "Is not difficult, but at what length you want to break your headers? Word count? Character count? Specific column size?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559149302, "post_id": 56364645, "comment_id": 99333971, "body": "<code>Range(&quot;BI13&quot;).Value = &quot;ACTUAL SAMPLE &quot; &amp; vbCrLf &amp; &quot;FABRIC INHOUSE DATE&quot;</code>, then <code>Range(&quot;BI13&quot;).EntireColumn.AutoFit</code> should do. Note, no need to <code>.Select</code> anything <i>or</i> work with <code>ActiveCell</code>, and <code>.FormulaR1C1</code> should be used for specifying a R1C1-style formula, but you&#39;re assigning a string expression / literal value - <code>Range.Value</code> is more appropriate. Macro recorder isn&#39;t very smart ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 11561158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcfab384fc6e33996160df3ad56d2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Hippolyte BRINGER", "link": "https://stackoverflow.com/users/11561158/hippolyte-bringer"}, "is_accepted": false, "score": 0, "last_activity_date": 1559147262, "creation_date": 1559147262, "answer_id": 56364934, "question_id": 56364645, "link": "https://stackoverflow.com/questions/56364645/how-to-fit-a-lot-of-header-within-cell-width-using-vba/56364934#56364934", "title": "How to fit a lot of header within cell width using VBA?", "body": "<p>I don't understand very well your ask.\nDo you want apply the formula <code>\"ACTUAL SAMPLE \" &amp; Chr(10) &amp; \"FABRIC INHOUSE DATE\"</code> for a different cells ? </p>\n\n<p>Like this :</p>\n\n<pre><code>Sub test()\n    For Each c In Range(\"A1:B20\").Cells\n        c.FormulaR1C1 = \"ACTUAL SAMPLE \" &amp; Chr(10) &amp; \"FABRIC INHOUSE DATE\"\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1559147663, "creation_date": 1559147663, "answer_id": 56365027, "question_id": 56364645, "link": "https://stackoverflow.com/questions/56364645/how-to-fit-a-lot-of-header-within-cell-width-using-vba/56365027#56365027", "title": "How to fit a lot of header within cell width using VBA?", "body": "<p>After playing around with your sample, adding the line of code below after you set the contents of the cell will, I believe, do what you want:</p>\n\n<pre><code>ActiveCell.EntireRow.AutoFit\n</code></pre>\n\n<p>There are some limitations that I found while playing with this.  In the example code you provided, you have that Chr(10) bit in there and when that is present, Excel doesn't seem to want to widen the cell to show everything that you have set as a single line on a single line.  It will break the entire string into individual words with each word on a single line within the cell.  Additionally, you can swap the EntireRow with EntireColumn if you have need to.</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1559149716, "creation_date": 1559149716, "answer_id": 56365501, "question_id": 56364645, "link": "https://stackoverflow.com/questions/56364645/how-to-fit-a-lot-of-header-within-cell-width-using-vba/56365501#56365501", "title": "How to fit a lot of header within cell width using VBA?", "body": "<p><code>Chr(10)</code> is <code>vbLf</code>... and it doesn't quite play well with <code>Range.AutoFit</code>. <code>vbNewLine</code> (<code>vbCrLf</code>, i.e. <code>Chr(10)</code> &amp; <code>Chr(13)</code>) works beautifully though; you don't need to <code>Select</code> anything, or to work off the <code>ActiveCell</code> at all - that's just macro-recorder junk begging to be cleaned up (recorder merely mimicks [most] user actions, including selecting cells: it doesn't care for redundant or efficient code):</p>\n\n<pre><code>Public Sub FitHeaders()\n    With ActiveSheet.Range(\"BI13\")\n        .Value = \"ACTUAL SAMPLE\" &amp; vbNewLine &amp; \"FABRIC INHOUSE DATE\"\n        .EntireColumn.AutoFit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11573935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bbb494fb988b739e1fc2bca65f3af56?s=128&d=identicon&r=PG&f=1", "display_name": "Tarequl Islam", "link": "https://stackoverflow.com/users/11573935/tarequl-islam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1559149716, "creation_date": 1559146087, "last_edit_date": 1559149413, "question_id": 56364645, "link": "https://stackoverflow.com/questions/56364645/how-to-fit-a-lot-of-header-within-cell-width-using-vba", "title": "How to fit a lot of header within cell width using VBA?", "body": "<p>I have copied approximately 88 columns of content from another spreadsheet. The problem is the headers are too big and they are not showing in the column cell properly. So, I had to go to each cell and press Alt+Enter each time. I want to use a macro that will do it automatically.</p>\n\n<p>I am using Microsoft Excel 2016 version.</p>\n\n<pre><code>Sub Fit_Headers()\n\n   'Fit_Headers Macro\n\n    Range(\"BI13\").Select\n    ActiveCell.FormulaR1C1 = \"ACTUAL SAMPLE \" &amp; Chr(10) &amp; \"FABRIC INHOUSE DATE\"\n    Range(\"BJ13\").Select\nEnd Sub\n</code></pre>\n\n<p>I used \"Record Macro\" to record what I am doing in one cell. How can I modify it so I can use it for remaining cells?`</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11237850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64402e0366896bc84d0df22b641267?s=128&d=identicon&r=PG&f=1", "display_name": "egreg", "link": "https://stackoverflow.com/users/11237850/egreg"}, "edited": false, "score": 0, "creation_date": 1559249265, "post_id": 56366858, "comment_id": 99370920, "body": "Thank you very much for your time, all sorted now."}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 0, "last_activity_date": 1559202988, "last_edit_date": 1559202988, "creation_date": 1559155978, "answer_id": 56366858, "question_id": 56364616, "link": "https://stackoverflow.com/questions/56364616/how-to-set-dropdown-box-on-website-so-that-select-option-and-scrape-data/56366858#56366858", "title": "How to set dropdown box on website so that select option and scrape data", "body": "<p>Ok so, not sure what you are after exactly, but the website you're scraping offers an API which in my opinion could probably make your life a lot easier. To put it simply, this means that it provides an easy way to request for data with the use of some parameters embedded in a URL. It returns the requested data in JSON format.</p>\n\n<p>In the following code I will be using the XMLHTTP request method and a JSON Parser. For this you will need the following:</p>\n\n<ol>\n<li><a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">JSON parser</a> , it helps you parse the downloaded data. Follow the installation instructions to import it in your project</li>\n<li>A reference to the <code>Microsoft Scripting Runtime</code> library. The JSON parser needs it.</li>\n<li>A reference to the <code>Microsoft WinHTTP Services, Version 5.1</code> library. It lets you use an HTTP request object.</li>\n</ol>\n\n<p>For demonstration purposes, the following code will only print in the immediate window the first entry's name and position. You can modify the code to fit your needs.</p>\n\n<pre><code>Sub test()\nDim req As New WinHttpRequest\nDim jsonResponse As String\nDim jsonParsed As Object\nDim url As String\nDim pageNum As Integer\nDim numPerPage As Integer\npageNum = 1 'You can change this parameter to navigate in different pages\nnumPerPage = 100 'You can change this parameter to control the number of entries\nurl = \"https://www.gurufocus.com/reader/_api/stocks/OTCPK:CFWFF/insider?page=\" &amp; pageNum &amp; \"&amp;per_page=\" &amp; numPerPage &amp; \"&amp;sort=date%7Cdesc\"\n\nWith req\n    .Open \"GET\", url, False\n    .setRequestHeader \"Accept\", \"application/json, text/plain, */*\"\n    .setRequestHeader \"Authorization\", ThisWorkbook.Worksheets(\"The name of your Worksheet\").Range(\"A1\").Value 'I have stored a string that is essential to the request in cell A1\n    .send\n    jsonResponse = .responseText\nEnd With\nSet jsonParsed = JsonConverter.ParseJson(jsonResponse)\nDebug.Print jsonParsed(\"data\")(1)(\"name\") 'get the name parameter of the first entry\nDebug.Print jsonParsed(\"data\")(1)(\"position\") 'get the position parameter of the first entry\n\nEnd Sub\n</code></pre>\n\n<p>Please note that there's a very long string which is essential to the request, which I have stored in cell A1. This string looks like so:</p>\n\n<blockquote>\n  <p>Bearer\n  eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImUxYjAwMmYxMjczMGRiMTBmMmZkYjJkNDk0YTU4NjRmZDZjOWY3ZGI4ZmI1NDY1NTQ2MzZlMGJhNzkxODUxNmY4NTM2ZWIzZDNhODhmN2VmIn0.eyJhdWQiOiIyIiwianRpIjoiZTFiMDAyZjEyNzMwZGIxMGYyZmRiMmQ0OTRhNTg2NGZkNmM5ZjdkYjhmYjU0NjU1NDYzNmUwYmE3OTE4NTE2Zjg1MzZlYjNkM2E4OGY3ZWYiLCJpYXQiOjE1NTkwNzA3OTcsIm5iZiI6MTU1OTA3MDc5NywiZXhwIjoxNTY5NDM4NzkzLCJzdWIiOiIiLCJzY29wZXMiOltdfQ.mZ4DqhUk9YAU6JYDBScF8MJ_zHPyL94bAec7LxZTaWipcWf9uesdGDMDC9v_7W-6zrtXAUWhk4YAL70E5rpPjM7gusYH0RfO48O2PnaV8gsqXoNCFwFBOHuxh109q7X0YsNkfX2wX8m3XigtK9A_YAGID7wxgX96lwzBevsDJ3borHMcJlQtxidF_Bq2D5WPASsuy3jdY80HkOCR1y4eaSIswBEtK5rPj_xy7VXRbYGhLklqw4wgHgq4blfaHnVVmPXf6k8mx45ye8vPecS-w9kjuDOHVn2mvU6mpBzqEpbH4lqpiqmYG7M-CvB1joEAcMQtcilCvsdfKOusoC2MU4_vPtF3Q4ZFVaEcXIQgomdKtFa_XGpCudit45b2rEFacKMUENqLj_sPwYkgM1IPl1lQfR-VpigqnCHPAxVQAPzqwJvS6CxuYOPmvnrx23fBAillP7LtDHwHtlMpgZUjdB5y6IWsia76crM4kbkrKn3zc8xoAGb1fIrgJlY-9hOzrwsmrchantEdYOFZjcMJvhCnlfvnEm6kT2Sdcu4o6TndTZJjrVmD4mb-jNGy4kw_mAx1DfyqR7GLtCVSzcSLKgrrwCJEL22K2bfXH2HExXvgLFbPXivVZJc70TnF9lJmx_dx79cxAm7szFGIdrs56bAC4mdKpvKL3BNmVY-J-G0</p>\n</blockquote>\n\n<p>The same string should work for you as well.</p>\n\n<p>The result looks like so:</p>\n\n<pre><code>Brown, James Michael\nSenior Officer\n</code></pre>\n\n<p>Each one of the 100 data entries has the following structure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wP21M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wP21M.png\" alt=\"enter image description here\"></a></p>\n\n<p>It's fairly easy to loop through all the entries as well. For example, to print the name of all the entries you would have to do this:</p>\n\n<pre><code>Dim item As Object\nFor Each item In jsonParsed(\"data\")\n    Debug.Print item(\"name\")\nNext item\n</code></pre>\n\n<p>Finally, you can also loop through all the parameters of each entry. For example, the following code prints all the parameters and their corresponding values for the first entry:</p>\n\n<pre><code>Dim key As Variant\nFor Each key In jsonParsed(\"data\")(1).Keys\n    Debug.Print key &amp; \": \" &amp; jsonParsed(\"data\")(1)(key)\nNext key \n</code></pre>\n\n<p>So this way you can basically  access any parameter you want for each entry.</p>\n"}], "owner": {"reputation": 9, "user_id": 11237850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec64402e0366896bc84d0df22b641267?s=128&d=identicon&r=PG&f=1", "display_name": "egreg", "link": "https://stackoverflow.com/users/11237850/egreg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56366858, "answer_count": 1, "score": 0, "last_activity_date": 1559202988, "creation_date": 1559145965, "question_id": 56364616, "link": "https://stackoverflow.com/questions/56364616/how-to-set-dropdown-box-on-website-so-that-select-option-and-scrape-data", "title": "How to set dropdown box on website so that select option and scrape data", "body": "<p>A website has changed so I can't scrape data from it anymore. Just need to change the set line below I believe but have tried a number of things and none have worked. I'm not very knowledgeable about this area I'm afraid but rest of code is working. Eg url is <a href=\"https://www.gurufocus.com/stock/CFWFF/insider\" rel=\"nofollow noreferrer\">https://www.gurufocus.com/stock/CFWFF/insider</a> and it is the table of insider transactions I am trying to press the dropdown for and change it to 100 instead of 10:</p>\n\n<pre><code>t = Timer\nnoTable = 0\nDo\n    Set DropDown = doc.querySelectorAll(\".el-dropdown-menu__item\")\n    lastDropDrownItemIndex = DropDown.Length - 1\n    If Timer - t &gt; MAX_WAIT_SEC Then\n        noTable = 1\n        Exit Do\n    End If\nLoop While lastDropDrownItemIndex &lt; 1\nIf noTable = 1 Then GoTo noTableEscape\nDropDown.Item(lastDropDrownItemIndex).Click\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 11, "user_id": 11573816, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bc280jnRvak/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3504h6x_5ybn9JAfnkN4BQPmxwQ/mo/photo.jpg?sz=128", "display_name": "rpmathur 12", "link": "https://stackoverflow.com/users/11573816/rpmathur-12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566045033, "creation_date": 1559145179, "last_edit_date": 1566045033, "question_id": 56364413, "link": "https://stackoverflow.com/questions/56364413/how-to-send-text-to-edit-box-in-external-app-using-excel-vba", "title": "How to Send Text to Edit Box in External App using excel VBA", "body": "<p>I have written code for sending text to other web base application(.appref-ms), my code is opening the application but some things wrong in my code as not finding application window from variable \"main_window1\" on wards.(refer captured pic from WINSPECTOR</p>\n\n<pre><code>Public Declare Function FindWindow Lib \"user32.dll\" Alias \"FindWindowA\" ( _\n     ByVal lpClassName As String, _\n     ByVal lpWindowName As String) As Long\n\nPublic Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" ( _\n     ByVal hwnd As Long, _\n     ByVal lpOperation As String, _\n     ByVal lpFile As String, _\n     ByVal lpParameters As String, _\n     ByVal lpDirectory As String, _\n     ByVal nShowCmd As Long) As Long\n\nPublic Declare Function SendMessageByString Lib \"user32.dll\" Alias \"SendMessageA\" ( _\n     ByVal hwnd As Long, _\n     ByVal wMsg As Long, _\n     ByVal wParam As Long, _\n     ByRef lParam As Any) As Long\n\n\nPublic Declare Function SendMessage Lib \"user32.dll\" Alias \"SendMessageA\" ( _\n     ByVal hwnd As Long, _\n     ByVal wMsg As Long, _\n     ByVal wParam As Long, _\n     ByRef lParam As Any) As Long\n\nPublic Const SW_SHOWMAXIMIZED As Long = 3\n\nPublic Declare Function FindWindowEx Lib \"user32.dll\" Alias \"FindWindowExA\" ( _\nByVal hWndParent As Long, _\nByVal hWndChildAfter As Long, _\nByVal lpszClass As String, _\nByVal lpszWindow As String) As Long\n\nPublic Const WM_SETTEXT As Long = &amp;HC\nPublic Const BM_CLICK As Long = &amp;HF5&amp;\n\nPublic Declare Function GetWindow Lib \"user32.dll\" ( _\n     ByVal hwnd As Long, _\n     ByVal wCmd As Long) As Long\n\nSub run_application()\nDim str As String\nstr = \"C:\\Users\\Guest\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\StartMenu\\Excellon 5.appref-ms\"\nhwnd = FindWindow(VBA.Constants.vbNullString, \"Excellon\")\nstart_doc = ShellExecute(hwnd, \"open\", str, \"\", \"\", SW_SHOWMAXIMIZED)\nIf start_doc = 2 Then Exit Sub\nIf start_doc = 3 Then Exit Sub\n\nDo\nDoEvents\nhwindow2 = FindWindow(vbNullString, \"Excellon\")\nLoop Until hwindow2 &gt; 0\n\nmain_window1 = FindWindowEx(hwindow2, 0&amp;, \"layoutControl1\", vbNullString)\nmain_window2 = FindWindowEx(main_window1, 0&amp;, \"0011037C\", vbNullString)\nmain_window3 = FindWindowEx(main_window3, 0&amp;, \"EDIT\", vbNullString)\n\nCall SendMessageByString(main_window3, WM_SETTEXT, 0, \"123\")\nDoEvents\n[enter image description here][1]\nEnd Sub\\[enter image description here\\]\\[1\\]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XO2P8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XO2P8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1559145392, "post_id": 56364366, "comment_id": 99332074, "body": "You want to check if the file exists before opening it. <a href=\"https://stackoverflow.com/questions/16351249/vba-check-if-file-exists\">This</a> could be of use. Also, while it is not your question, you really want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid activate and select</a> in your code."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559148981, "post_id": 56364366, "comment_id": 99333818, "body": "You are opening and closing the workbooks immediatelly,... without doing anything in them. what are you trying to achieve exactly with this code?"}, {"owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559223553, "post_id": 56364366, "comment_id": 99359117, "body": "Thank you both for answers and cybernetic.nomad for tips. @DarXyde I have INDEX functionin in another sheet which is getting needed data from opened file, then VBA copy and paste it to another as values and close the file. Then VBA is doing that to next looking file and datas, so there is no need to keep the files opened longer than that the INDEX function get data before copying them to another sheet."}, {"owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559224430, "post_id": 56364366, "comment_id": 99359649, "body": "Ohh, sorry you all. Now I mentioned it why you all are so confused. I supposed to write INDIRECT function, not INDEX. Sorry about that."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 7281608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f053f995cc8e582b19adee4526f29b9?s=128&d=identicon&r=PG&f=1", "display_name": "GarrettS1", "link": "https://stackoverflow.com/users/7281608/garretts1"}, "is_accepted": false, "score": 1, "last_activity_date": 1559145696, "creation_date": 1559145696, "answer_id": 56364545, "question_id": 56364366, "link": "https://stackoverflow.com/questions/56364366/is-there-a-way-to-skip-error-filename-is-not-found-and-move-to-the-next-file/56364545#56364545", "title": "Is there a way to skip error &quot;filename is not found&quot; and move to the next file", "body": "<p>The best way I have found to handle this is to use the \"On Error\" statement. You can keep it really simple and use <code>On Error Resume Next</code>, which tells the code to skip the error entirely and move to the next statement (that does not have an error). The main issue with this is that it covers ALL errors, not just the specific one you are having issues with currently. It can make it hard to know if errors are occurring/if your code is functioning as you expect. </p>\n\n<p>The other option, which can help avoid the issues mentioned above, is to use something like this:</p>\n\n<pre><code>On Error GoTo ErrH\n    'Main Body of Your Code\n    Exit Sub 'Use to avoid continuing on to the ErrH section.\nErrH:\n    'Some method for handling the error, such as a message box or other notification.\n</code></pre>\n\n<p>This usually isn't necessary with small chunks of code, but when you start combining your subs and functions it can be a life saver!</p>\n\n<p>Good Luck!</p>\n\n<p>Edit: You could/should also consider removing those blanks if they are not necessary for the sheet to work.</p>\n"}, {"tags": [], "owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "is_accepted": false, "score": 0, "last_activity_date": 1559149213, "creation_date": 1559149213, "answer_id": 56365397, "question_id": 56364366, "link": "https://stackoverflow.com/questions/56364366/is-there-a-way-to-skip-error-filename-is-not-found-and-move-to-the-next-file/56365397#56365397", "title": "Is there a way to skip error &quot;filename is not found&quot; and move to the next file", "body": "<p>You could work around this by creating a second Sub that opens the file and handles the error if the file doesn't exist. That way you are still able to catch other Errors in the main Sub without going to next. Example:</p>\n\n<pre><code>Sub MainSub()\n\n    myFile1 = \"C:\\Temp\\New1.xlsx\"\n    myFile2 = \"C:\\Temp\\New2.xlsx\"\n    CheckAndOpen (myFile1)\n    CheckAndOpen (myFile2)\n\nEnd Sub\n\nSub CheckAndOpen(myFileName As String)\n\n    On Error Resume Next\n    Workbooks.Open Filename:=myFileName\n    Debug.Print Err.Number, myFileName\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559224599, "post_id": 56365747, "comment_id": 99359741, "body": "Thank you for the answer! I&#39;m going to try this one. The reason for closing the file immediately is that I have function like this:     =INDIRECT(&quot;&#39;S:\\FI\\xxx\\xxx\\xxx[&quot; &amp; $D$16 &amp; &quot;]Resepti&#39;!B11&quot;) It is getting the needed data and copying it to another sheet as values and closing the file before VBA is moving to next step. I mentioned that I was talking INDEX function in my starting post and it supposed to be INDIRECT. Sorry for that."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559227098, "post_id": 56365747, "comment_id": 99361046, "body": "Let me know if you get stuck on something, I can try to help further."}, {"owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559227597, "post_id": 56365747, "comment_id": 99361327, "body": "Tried this out and VBA runned smooth but it did not copied the data from &quot;Aputaulukko 2&quot; to sheet &quot;Aputaulukko 3&quot; after each opened and closed file."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559227959, "post_id": 56365747, "comment_id": 99361538, "body": "Please see the updated code <code>rngToPaste = rngToCopy.Value</code> ... i keep forgetting it needs <code>.Value</code> to actually work."}, {"owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559229167, "post_id": 56365747, "comment_id": 99362172, "body": "Ohh, thank you. Now it is working but pasted only the last one copied data area into sheet &quot; Aputaulukko 3 &quot;. I think the VBA code is doing it right but the data is losted from the INDIRECT function before VBA copy it. Maybe?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559229448, "post_id": 56365747, "comment_id": 99362319, "body": "My logic is a bit off, let me see if i can fix it."}, {"owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 1, "creation_date": 1559292120, "post_id": 56365747, "comment_id": 99382093, "body": "Woah! It did exactly what it was mentioned to do. Thank you a lot of buddy! :)"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1559292828, "post_id": 56365747, "comment_id": 99382426, "body": "Glad it worked. Hope that comparing the difference between your code and mine, will help you code better in the future :)"}, {"owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "edited": false, "score": 0, "creation_date": 1563184683, "post_id": 56365747, "comment_id": 100602694, "body": "Hello @FAB, I added a new comment on top of this post. Can you please check it? :)"}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 1, "last_activity_date": 1559229768, "last_edit_date": 1559229768, "creation_date": 1559150817, "answer_id": 56365747, "question_id": 56364366, "link": "https://stackoverflow.com/questions/56364366/is-there-a-way-to-skip-error-filename-is-not-found-and-move-to-the-next-file/56365747#56365747", "title": "Is there a way to skip error &quot;filename is not found&quot; and move to the next file", "body": "<p>I took the liberty to rewrite your code... i'm still not quite sure why you are openning and closing the workbook immediately, but in essence this is what your code does at the moment:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub HaeReseptiTiedot()\n\nApplication.ScreenUpdating = False\n\nDim wbSource As Workbook\nDim wb As Workbook: Set wb = ThisWorkbook 'Or ActiveWorkbook or Workbooks(\"book name\")\nDim ws As Worksheet: Set ws = wb.ActiveSheet 'Or wb.Sheets(\"Sheet Name\")\nDim rngToCopy As Range, rngToPaste As Range\nDim X As Long\n\nFor X = 4 To 49 Step 5\n    On Error Resume Next\n    Set wbSource = Workbooks.Open(FileName:=ws.Cells(19, X), UpdateLinks:=0)\n    On Error GoTo 0\n\n    If Not wbSource Is Nothing Then\n        wbSource.Close False\n\n        With wb.Sheets(\"Aputaulukko 2\")\n            Set rngToCopy = .Range(.Cells(16, X), .Cells(30, X + 3))\n            'Debug.Print rngToCopy.Address\n        End With\n\n        With wb.Sheets(\"Aputaulukko 3\")\n            Set rngToPaste = .Range(.Cells(4, X - 2), .Cells(rngToCopy.Rows.Count + 3, X + 1))\n            'Debug.Print rngToPaste.Address\n        End With\n\n        rngToPaste = rngToCopy.Value\n    End If\n    Set wbSource = Nothing\nNext X\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "is_accepted": false, "score": 1, "last_activity_date": 1559151254, "creation_date": 1559151254, "answer_id": 56365839, "question_id": 56364366, "link": "https://stackoverflow.com/questions/56364366/is-there-a-way-to-skip-error-filename-is-not-found-and-move-to-the-next-file/56365839#56365839", "title": "Is there a way to skip error &quot;filename is not found&quot; and move to the next file", "body": "<p>Here is a function that can check if a file exists:</p>\n\n<pre><code>'********************************************************************************************************************************\n' To check if a particular file exists\n' Set excelFile = False, if it is not an Excel file that is being checked\n'********************************************************************************************************************************\nPublic Function isAnExistingFile(ByVal fileNameStr As Variant, Optional ByVal excelFile As Boolean = True) As Boolean\nDim wb As Workbook\n\nisAnExistingFile = True\nErr.Clear\nOn Error GoTo errHandler\nIf Not VarType(fileNameStr) = vbString Then\n    isAnExistingFile = False\nElseIf Len(fileNameStr) = 0 Then\n    isAnExistingFile = False\nElseIf Len(Dir(fileNameStr)) = 0 Then\n    isAnExistingFile = False\nElseIf ((GetAttr(fileNameStr) And vbDirectory) &lt;&gt; vbDirectory) = False Then\n    isAnExistingFile = False\nElse\n    If excelFile Then\n        On Error Resume Next\n        Set wb = Application.Workbooks.Open(Filename:=fileNameStr, UpdateLinks:=0, ReadOnly:=True)\n        If wb Is Nothing Then isAnExistingFile = False\n        If Not wb Is Nothing Then\n            wb.Close False\n            Set wb = Nothing\n        End If\n        GoTo Out\n    End If\nEnd If\n\nerrHandler:\nIf Not Err.Number = 0 Then isAnExistingFile = False\n\nOut:\nErr.Clear: On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15565097, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5161643a2839f19c2302ef03355072d3?s=128&d=identicon&r=PG", "display_name": "Cobus Claassens", "link": "https://stackoverflow.com/users/15565097/cobus-claassens"}, "is_accepted": false, "score": 0, "last_activity_date": 1617716207, "last_edit_date": 1617716207, "creation_date": 1617710096, "answer_id": 66968178, "question_id": 56364366, "link": "https://stackoverflow.com/questions/56364366/is-there-a-way-to-skip-error-filename-is-not-found-and-move-to-the-next-file/66968178#66968178", "title": "Is there a way to skip error &quot;filename is not found&quot; and move to the next file", "body": "<p>You could, alternatively, just put the following in your code:</p>\n<pre><code>If dir(&quot;FILENAME&quot;) &lt;&gt; &quot;&quot; Then\n Add the rest of your code\nEnd If\n</code></pre>\n<p>I usually run 3 or 4 <code>for</code> loops inside of each other with different variables to get the full path of each file, then put this to ensure I do not open files where there are blanks.</p>\n"}], "owner": {"reputation": 11, "user_id": 11499572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865b2fe240ddbdf618209ddd2921c0cf?s=128&d=identicon&r=PG&f=1", "display_name": "FFDP", "link": "https://stackoverflow.com/users/11499572/ffdp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1617716207, "creation_date": 1559145002, "last_edit_date": 1565585311, "question_id": 56364366, "link": "https://stackoverflow.com/questions/56364366/is-there-a-way-to-skip-error-filename-is-not-found-and-move-to-the-next-file", "title": "Is there a way to skip error &quot;filename is not found&quot; and move to the next file", "body": "<p>Is there a way to skip error \"filename is not found\" and move to the next file?</p>\n\n<pre><code>Sub CopyDataAndMoveDown()\n\nApplication.ScreenUpdating = False\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet: Set ws = wb.ActiveSheet\nDim rngToCopy As Range, rngToPaste As Range\nDim x As Long\nDim breakdown1\nDim breakdown As Worksheet: Set breakdown = wb.ActiveSheet\n\nFor x = 4 To 504 Step 6\n\n    With wb.Sheets(\"Sheet1\")\n        breakdown1 = breakdown.Cells(9, x - 2)\n    End With\n\n    If IsEmpty(breakdown1) Then\n        Call MoveBelow\n    Else\n\n        With wb.Sheets(\"Sheet1\")\n            Set rngToCopy = .Range(.Cells(4, x - 2), .Cells(24, x + 3))\n            Debug.Print rngToCopy.Address\n        End With\n\n        With wb.Sheets(\"Sheet2\")\n            Set rngToPaste = .Range(.Cells(4, x - 2), .Cells(rngToCopy.Rows.Count + 3, x + 3))\n            Debug.Print rngToPaste.Address\n        End With\n\n        rngToPaste = rngToCopy.Value\n    End If\n\nNext x\n\nApplication.ScreenUpdating = True\nMsgBox \"Valmis.\"\nEnd Sub\n\nSub MoveBelow ()\n\nApplication.ScreenUpdating = False\n\nDim wb As Workbook: Set wb = ThisWorkbook\nDim ws As Worksheet: Set ws = wb.ActiveSheet\nDim rngToCopy As Range, rngToPaste As Range\nDim x As Long\nDim breakdown1\nDim breakdown As Worksheet: Set breakdown = wb.ActiveSheet\n\nFor x = 4 To 504 Step 6\n\n    With wb.Sheets(\"Sheet1\")\n        breakdown1 = breakdown.Cells(9, x - 2)\n    End With\n\n    If IsEmpty(breakdown1) Then\n        ' At this point when the macro meet again a empty cell\n        ' it should keep moving from the same counted X\n        ' but start the paste operation from 24 rows below.\n    Else\n\n        With wb.Sheets(\"Sheet1\")\n            Set rngToCopy = .Range(.Cells(4, x - 2), .Cells(24, x + 3))\n            Debug.Print rngToCopy.Address\n        End With\n\n        With wb.Sheets(\"Sheet2\")\n            Set rngToPaste = .Range(.Cells(28, x - 2), .Cells(rngToCopy.Rows.Count + 3, x + 3))\n            Debug.Print rngToPaste.Address\n        End With\n\n        rngToPaste = rngToCopy.Value\n    End If\n\nNext x\n\nApplication.ScreenUpdating = True\nMsgBox \"Valmis.\"\nEnd Sub\n</code></pre>\n\n<p>So when the macro is copying / pasting data from Sheet 1 to Sheet 2 and meets an empty cell it should keep going, copying next available data, but paste it 24 rows below.</p>\n\n<p>--------Below the old question.<br>\nI have a VBA which is opening and closing file for that INDEX function get data. My problem is that. VBA is getting the filename from reference cell which contain the full path. But some of the reference cells are blanks/zeros and then the running VBA stops and give me error \"filename is not found\". Is there a way to skip that and move to next step?</p>\n\n<pre><code>Sub HaeReseptiTiedot()\n\nDim myfile As String\nDim myfile1 As String\nDim myfile2 As String\nDim myfile3 As String\nDim myfile4 As String\nDim myfile5 As String\nDim myfile6 As String\nDim myfile7 As String\nDim myfile8 As String\nDim myfile9 As String\n\n\nmyfile = Cells(19, 4).Value\nmyfile1 = Cells(19, 9).Value\nmyfile2 = Cells(19, 14).Value\nmyfile3 = Cells(19, 19).Value\nmyfile4 = Cells(19, 24).Value\nmyfile5 = Cells(19, 29).Value\nmyfile6 = Cells(19, 34).Value\nmyfile7 = Cells(19, 39).Value\nmyfile8 = Cells(19, 44).Value\nmyfile9 = Cells(19, 49).Value\n\nApplication.ScreenUpdating = False\n\n\nWorkbooks.Open Filename:=myfile, UpdateLinks:=0\nActiveWorkbook.Close False\nSheets(\"Aputaulukko 2\").Select\nRange(\"D16:G30\").Select\nSelection.Copy\nSheets(\"Aputaulukko 3\").Select\nRange(\"B4\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nWorkbooks.Open Filename:=myfile1, UpdateLinks:=0\nActiveWorkbook.Close False\nSheets(\"Aputaulukko 2\").Select\nRange(\"I16:L30\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(\"Aputaulukko 3\").Select\nRange(\"G4\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["vba", "powerpoint", "powerpoint-2010"], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1559200460, "creation_date": 1559200460, "answer_id": 56373464, "question_id": 56364099, "link": "https://stackoverflow.com/questions/56364099/vba-code-for-giving-slides-a-constant-name/56373464#56373464", "title": "VBA code for giving slides a constant name", "body": "<p>As you already found out: Neither <code>SlideIndex</code>, <code>SlideNumber</code>, <code>SlideID</code> nor <code>Name</code> can be used to identify a copied slide. </p>\n\n<p>You may work with the \"alternative text\" of a characteristic shape to identify a slide:<br>\nJust do a right mouseclick on the shape and edit its alternative text.</p>\n\n<p>Also slide notes may help to identify a slide.</p>\n\n<p>Following prints some slide information to your debug window:</p>\n\n<pre><code>Private Sub IdentifyMySlide()\n    Dim myslide As PowerPoint.Slide\n    For Each myslide In ActivePresentation.Slides\n        Debug.Print \"Index: \" &amp; myslide.SlideIndex,\n        Debug.Print \"Number: \" &amp; myslide.SlideNumber,\n        Debug.Print \"ID: \" &amp; myslide.SlideID,\n        Debug.Print \"Name: \" &amp; myslide.Name,\n\n        If myslide.Shapes.Count &gt; 0 Then\n            Debug.Print \"Alternative ShapeText: \" &amp; myslide.Shapes(1).AlternativeText,\n        End If\n\n        If myslide.HasNotesPage Then\n            If myslide.NotesPage(1).Shapes.Count &gt; 0 Then\n                If myslide.NotesPage(1).Shapes(1).HasTextFrame Then\n                    Debug.Print \"Notes: \" &amp; Left(myslide.NotesPage(1).Shapes(1).TextFrame.TextRange.Text, 10)\n                Else\n                    Debug.Print\n                End If\n            Else\n                Debug.Print\n            End If\n        Else\n            Debug.Print\n        End If\n\n    Next myslide\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1560447058, "post_id": 56380715, "comment_id": 99749503, "body": "Agree, that this is a better answer than mine. Didn&#39;t know about tags on slides and shapes. +1"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1560609877, "post_id": 56380715, "comment_id": 99797638, "body": "It&#39;s a very overlooked and very useful feature, and oddly, unique to PowerPoint, though I suppose Word and Excel have other ways of doing similar things."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1559228157, "creation_date": 1559228157, "answer_id": 56380715, "question_id": 56364099, "link": "https://stackoverflow.com/questions/56364099/vba-code-for-giving-slides-a-constant-name/56380715#56380715", "title": "VBA code for giving slides a constant name", "body": "<p>@Asger's suggestion would work but a more consistent approach (IMO) would be to use tags. Any presentation, slide, or shape on a slide can have one or more bits of text attached in the form of a tag.</p>\n\n<p>For example:</p>\n\n<pre><code>ActivePresentation.Slides(1).Tags.Add \"SlideIdentifier\", \"Bob\"\n</code></pre>\n\n<p>will create a tag named SlideIdentifier with a value of Bob on slide #1 in the current presentation. These tags will travel with the slide, wherever it goes.</p>\n\n<p>This page on the PowerPoint FAQ that I maintain has more info on using tags:</p>\n\n<p><a href=\"http://www.pptfaq.com/FAQ00815_Working_with_Tags_-and_a_bit_about_Functions-.htm\" rel=\"nofollow noreferrer\">http://www.pptfaq.com/FAQ00815_Working_with_Tags_-and_a_bit_about_Functions-.htm</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11573748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfdf5d5b2cb84e0e36146a1e5aeb0d2d?s=128&d=identicon&r=PG&f=1", "display_name": "infonoob", "link": "https://stackoverflow.com/users/11573748/infonoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559228157, "creation_date": 1559144040, "question_id": 56364099, "link": "https://stackoverflow.com/questions/56364099/vba-code-for-giving-slides-a-constant-name", "title": "VBA code for giving slides a constant name", "body": "<p>I am trying to reduce the effort needed to keep a certain slide (lets call it SlideXYZ) up to date. SlideXYZ is an important content slide that can be found in multiple slide decks. I initially created slide objects that updated automatically when a change was made in the \"source slide\". However, slide objects unfortunately don't contain animations (they are simply a snapshot of the actual slide). I am now trying to write a VBA script that will search and replace SlideXYZ in each deck with a newer version of SlideXYZ. However, the slide number is dynamic (it changes when a new slide is added above). I need a static, constant reference to SlideXYZ. </p>\n\n<p>I thought of copying SlideXYZ into all presentations once and then using the Slide.Name property to find all instances of it once an update is needed. </p>\n\n<p>However, it appears that the Slide.Name is reassigned by powerpoint each time the slide is pasted into a new presentation. I need a reference that will not change so that I can find and replace SlideXYZ.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2628, "user_id": 2495728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bgl4n.jpg?s=128&g=1", "display_name": "Jonathan Alfaro", "link": "https://stackoverflow.com/users/2495728/jonathan-alfaro"}, "edited": false, "score": 0, "creation_date": 1559144361, "post_id": 56364014, "comment_id": 99331500, "body": "Are you getting an error?  What exactly is the problem?"}, {"owner": {"reputation": 13, "user_id": 11573155, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pKn5EfeTQP0/AAAAAAAAAAI/AAAAAAAAAUE/40ibKR0DRTI/photo.jpg?sz=128", "display_name": "Dilan Chudasama", "link": "https://stackoverflow.com/users/11573155/dilan-chudasama"}, "reply_to_user": {"reputation": 2628, "user_id": 2495728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bgl4n.jpg?s=128&g=1", "display_name": "Jonathan Alfaro", "link": "https://stackoverflow.com/users/2495728/jonathan-alfaro"}, "edited": false, "score": 0, "creation_date": 1559144827, "post_id": 56364014, "comment_id": 99331772, "body": "I am having trouble putting together a code that does what I need it to. I am new to using VBA and have been thrown in the deep end a little."}, {"owner": {"reputation": 2628, "user_id": 2495728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bgl4n.jpg?s=128&g=1", "display_name": "Jonathan Alfaro", "link": "https://stackoverflow.com/users/2495728/jonathan-alfaro"}, "edited": false, "score": 2, "creation_date": 1559146119, "post_id": 56364014, "comment_id": 99332461, "body": "Yes. But here most people are not going to provide you with code.   We are only going to help you fix your code.  So the first thing you need to do is try to do it yourself... then post the code here."}, {"owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "edited": false, "score": 0, "creation_date": 1559159748, "post_id": 56364014, "comment_id": 99338290, "body": "This may help for ideas: <a href=\"https://stackoverflow.com/questions/20687810/vba-macro-that-search-for-file-in-multiple-subfolders\" title=\"vba macro that search for file in multiple subfolders\">stackoverflow.com/questions/20687810/&hellip;</a>"}], "owner": {"reputation": 13, "user_id": 11573155, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pKn5EfeTQP0/AAAAAAAAAAI/AAAAAAAAAUE/40ibKR0DRTI/photo.jpg?sz=128", "display_name": "Dilan Chudasama", "link": "https://stackoverflow.com/users/11573155/dilan-chudasama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559143864, "creation_date": 1559143769, "last_edit_date": 1559143864, "question_id": 56364014, "link": "https://stackoverflow.com/questions/56364014/find-the-location-of-a-file-in-a-path-consisting-of-folders-and-subfolders-usi", "title": "Find the location of a file in a path (consisting of folders and subfolders) using its file name and the date it was modified", "body": "<p>I currently have two columns. Column A contains a list of file names (with extension) and column B contains the date it was last modified. I wanted to create a macro that loops through the list of files and scans through a file path with folders and subfolders and prints the exact link to the table in column C. It should be noted that the subfolders contain the same files which have been created/modified on different dates, however I wish to obtain the link to the file with the same timestamp as column B. I have written a few lines of code but I am struggling to put together the logic needed. </p>\n\n<pre><code>Sub tester()\n\npath = \"\"\nfname = \"Book1.csv\"\n\nx = Dir(path &amp; \"\\\" &amp; fname)\n\nIf x = fname Then\n\n    link = path &amp; \"\\\" &amp; fname\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fs.GetFile(link)\n    created = f.DateCreated\n\nElse\n    link = \"Not Found\"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1559143695, "post_id": 56363899, "comment_id": 99331117, "body": "Check out the LEFT function."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559148661, "post_id": 56363899, "comment_id": 99333668, "body": "@SJR has the answer for your question.  In terms of what to do with that information, you will need to build logic in your <code>f2</code> function for what will happen when your last_ID+1 is one of those unwanted scenarios with an if-statement or switch."}, {"owner": {"reputation": 35, "user_id": 11573701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2039d7fc83951c055018c21d849ea452?s=128&d=identicon&r=PG&f=1", "display_name": "Azar", "link": "https://stackoverflow.com/users/11573701/azar"}, "edited": false, "score": 0, "creation_date": 1559232620, "post_id": 56363899, "comment_id": 99364084, "body": "@QuickSilver   Hi and thanks for your answer. This is not working. It does not give me any error but simply it is not working. I mean if the last ID is 3012 then although I am writing that the IDs should not start with 3 , it generating 3013 as the next one. any idea? And on another level is it possible to tell this function to generates IDs that are not for example between 3000 and 4000 8000 and 9000? this is the same problem, I just want to know if this can work ?"}], "answers": [{"tags": [], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "is_accepted": false, "score": 0, "last_activity_date": 1559161715, "creation_date": 1559161715, "answer_id": 56368051, "question_id": 56363899, "link": "https://stackoverflow.com/questions/56363899/not-generating-ids-which-start-with-specific-value/56368051#56368051", "title": "Not Generating IDs which start with specific value", "body": "<p>You can do something like this.</p>\n\n<pre><code>Function f1(search_value As Long, rng As Range)\n    For i = 1 To rng.Count\n        If rng.Cells(i, 1).value = search_value Then\n            f1 = True\n            Exit Function\n        End If\n    Next i\n\n    f1 = False\nEnd Function\n\nFunction genID(last_ID As Long, rng As Range)\n    Dim newID As Long\n\n    If Not Left(Len(last_ID + 1), 1) = 3 Or Left(Len(last_ID + 1), 1) = 4 Or Left(Len(last_ID + 1), 1) = 8 Then\n        newID = last_ID + 1\n    End If\n\n    While f1(newID, rng)\n        newID = newID + 1\n    Wend\n\n    f2 = newID\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11573701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2039d7fc83951c055018c21d849ea452?s=128&d=identicon&r=PG&f=1", "display_name": "Azar", "link": "https://stackoverflow.com/users/11573701/azar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559161715, "creation_date": 1559143338, "last_edit_date": 1559143637, "question_id": 56363899, "link": "https://stackoverflow.com/questions/56363899/not-generating-ids-which-start-with-specific-value", "title": "Not Generating IDs which start with specific value", "body": "<p>I have a link that is generating IDs by looking at the last row of one of the sheets and add 1 to that. These IDs can not be some specific numbers.\nFor this I have two functions that is working properly and doing what I expected but now I have some new criteria. Instead of some random IDs that my generated IDs can not be, I want to tell my function that \"do not generate IDs that start with 3 , 4, 8 \" How can I do this?</p>\n\n<p>I am not really good with vba and I may need lots of explanations.</p>\n\n<pre><code>Function f1(search_value As Long, rng As Range)\n    For i = 1 To rng.Count\n        If rng.Cells(i, 1).Value = search_value Then\n            f1 = True\n            Exit Function\n        End If\n    Next i\n\n    f1= False\nEnd Function\n\nFunction f2(last_ID As Long, rng As Range)\n    Dim newID As Long\n    newID = last_ID + 1\n\n    While f1(newID, rng)\n        newID = newID + 1\n    Wend\n\n    f2 = newID\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "authentication", "curl", "response"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 10111003, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2utTgyJsOfw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o0Yczj-u5ky8y8lRPYWLcWaXP6nA/mo/photo.jpg?sz=128", "display_name": "Chad Daniels", "link": "https://stackoverflow.com/users/10111003/chad-daniels"}, "is_accepted": false, "score": 0, "last_activity_date": 1559146193, "creation_date": 1559146193, "answer_id": 56364672, "question_id": 56363850, "link": "https://stackoverflow.com/questions/56363850/token-authentication-for-curl-in-excel-vba/56364672#56364672", "title": "Token authentication for CURL in EXCEL VBA", "body": "<p>Figured this out after more reading in the documentation and it was due to not passing the Authentication header the correct way. Here is my code:</p>\n\n<pre><code>Public Function CallRestAPI3(strUrl1 As String)\n    Dim xmlhttp As New MSXML2.XMLHTTP60, myurl As String\n    myurl = \"https://company.clearbit.com/v2/companies/find?domain=toplinegroup.com\"\n    xmlhttp.Open \"GET\", myurl, False\n    xmlhttp.setRequestHeader \"Authorization\", \"Bearer \" + \"sk_b3b05a8924c4f3df86248b4e38421cfa\"\n    xmlhttp.Send\n    Debug.Print (xmlhttp.responseText)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10111003, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2utTgyJsOfw/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o0Yczj-u5ky8y8lRPYWLcWaXP6nA/mo/photo.jpg?sz=128", "display_name": "Chad Daniels", "link": "https://stackoverflow.com/users/10111003/chad-daniels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 708, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559146193, "creation_date": 1559143208, "last_edit_date": 1559143515, "question_id": 56363850, "link": "https://stackoverflow.com/questions/56363850/token-authentication-for-curl-in-excel-vba", "title": "Token authentication for CURL in EXCEL VBA", "body": "<p>A client requested that I put together a tool to take a company domain name and somehow come up with the account name. I found an API that I can work with, but I'm not as familiar with doing this in VBA.</p>\n\n<p>Here is the CURL procedure that the site documentation gives to push through a Domain Name, and receive the company name as a response:</p>\n\n<pre><code>curl 'https://company.clearbit.com/v2/companies/find?domain=segment.com' \\\n        -u sk_b3b05a8924c4f3df86248b4e38421cfa:\n</code></pre>\n\n<p>After several attempts of receiving the \"Please authenticate your request\", I've finally gotten to the point where I am receiving an error from the API, I think indicating that I am now correctly calling the API in some way.</p>\n\n<p>Here is my current code. Any idea why I may be receiving this error?</p>\n\n<pre><code>{\"error\":{\"type\":\"api_error\",\"message\":\"Sorry, something went wrong. We have been notified.\"}}\n</code></pre>\n\n<pre><code>Public Function CallRestAPI2(strUrl1 As String)\n    TargetURL = \"https://company.clearbit.com/v2/companies/find?domain=toplinegroup.com\"\n    Set HTTPReq = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    'HTTPReq.Option(4) = 13056 '\n    HTTPReq.Open \"GET\", TargetURL, False\n    HTTPReq.SetRequestHeader \"Content-Type\", \"application/json\"\n    HTTPReq.SetRequestHeader \"Accept\", \"application/json\"\n    HTTPReq.Send \"-u sk_b3b05a8924c4f3df86248b4e38421cfa\"\n    Debug.Print HTTPReq.responseText\nEnd Function\n</code></pre>\n\n<p>Any idea what I am doing wrong?</p>\n"}, {"tags": ["vba", "ms-access", "webbrowser-control", "activex"], "answers": [{"tags": [], "owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "is_accepted": true, "score": 0, "last_activity_date": 1559156020, "creation_date": 1559156020, "answer_id": 56366869, "question_id": 56363772, "link": "https://stackoverflow.com/questions/56363772/how-to-hide-or-cover-a-ms-access-activex-web-browser-control/56366869#56366869", "title": "How to hide or cover a MS Access ActiveX Web Browser control?", "body": "<p>Three hours later, it dawned on me how to accomplish hiding the ActiveX Web Browser but still get it to be accessible to the VBA code.  Simple:  Don't update the screen when running the code to access the ActiveX Web Browser and use the .Visible property to \"show\" the Browser Control when VBA needs to access it (but it won't be visible to the user if screen updating is off) and then hide the Browser Control when VBA is done accessing it.  </p>\n\n<p>Here's the code I used to accomplish that:</p>\n\n<pre><code>Application.Echo False  'turn off screen updating\nMe.acxWebBrowser1.Visible = True  'make web browser control \"visible\" to VBA code\n\n     {do stuff, like:  process web page}\n\nMe.btnClickMe.SetFocus  'set focus on the button so we can hide the web browser control\nMe.acxWebBrowser1.Visible = False  'make web browser invisible so user is not distracted\nApplication.Echo True  'turn screen updating back on\nMe.Refresh  'refresh the screen; this is probably not necessary\n</code></pre>\n\n<p>Just be </p>\n\n<ul>\n<li><strong><em>absolutely sure</em></strong> to <strong>turn screen updating (echo) back on</strong></li>\n</ul>\n\n<p>You should send any error handling to code that sets <code>Application.Echo True</code> otherwise you will not be able to see or do anything if the code crashes after setting echo to False.</p>\n"}], "owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 56366869, "answer_count": 1, "score": 0, "last_activity_date": 1594771765, "creation_date": 1559142929, "last_edit_date": 1594771765, "question_id": 56363772, "link": "https://stackoverflow.com/questions/56363772/how-to-hide-or-cover-a-ms-access-activex-web-browser-control", "title": "How to hide or cover a MS Access ActiveX Web Browser control?", "body": "<p>I have a database in which users enter a value into Textbox1 on a form; the form also has an ActiveX Web Browser control (acxWebBrowser1), plus another blank Textbox2, and finally a command button.  After the user enters text into Textbox1 and clicks the command button, the VBA code will navigate to a specific web page in acxWebBrowser1, enter the Textbox1 value into the web page form, and then obtain a result in the web page in acxWebBrowser1.  The result is then grabbed by the VBA code and entered into Textbox2 on the database form.</p>\n\n<p>What I need to be able to do is hide the ActiveX Web Browser control to (a) prevent the user from messing with the web page, and (b) to prevent the clutter and distraction of the ActiveX Web Browser since the VBA code does all the necessary interactions with the web page behind the scenes.</p>\n\n<p>Problem is, I cannot get the acxWebBrowser1 to stay hidden behind a rectangle box control on the form because the browser automatically moves itself to the top of the stack of controls.  If I reduce the size of the acxWebBrowser1 control to be very tiny, the web page does not function properly.  If I make the web browser control not visible, then the code cannot grab the needed values.  I cannot use a POST approach to avoid using the web browser.  (I might be wrong about not being able to use POST--maybe someone can point me to how to do that if that is the way to go.)</p>\n\n<p>How can I hide or put something on top of the web browser control?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1559142834, "post_id": 56363515, "comment_id": 99330625, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.fullseriescollection\" rel=\"nofollow noreferrer\">Documentation</a> might help."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559142814, "post_id": 56363624, "comment_id": 99330602, "body": "<code>FullSeriesCollection</code> includes <code>Series</code> objects that may be filtered out."}, {"owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1559143178, "post_id": 56363624, "comment_id": 99330820, "body": "@BigBen Ok got it, so <code>FullSeriesCollection</code> has been generated because I was filtering some data just before that line of code. thx!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1559142407, "creation_date": 1559142407, "answer_id": 56363624, "question_id": 56363515, "link": "https://stackoverflow.com/questions/56363515/differences-between-seriescollection-and-fullseriescollection/56363624#56363624", "title": "Differences between SeriesCollection and FullSeriesCollection", "body": "<p>Sure someone else will give more info.</p>\n\n<p>At least one difference is seriesCollection is backwards compatible across Excel version.</p>\n\n<p>Your code is fine for newer Excel versions but if you want to ensure compatibility across then use seriesCollection instead.</p>\n"}], "owner": {"reputation": 551, "user_id": 7862279, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d81f99dbb19cd58585415b7b724b75c0?s=128&d=identicon&r=PG&f=1", "display_name": "JackA", "link": "https://stackoverflow.com/users/7862279/jacka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3280, "favorite_count": 0, "accepted_answer_id": 56363624, "answer_count": 1, "score": 2, "last_activity_date": 1559143034, "creation_date": 1559141984, "last_edit_date": 1559143034, "question_id": 56363515, "link": "https://stackoverflow.com/questions/56363515/differences-between-seriescollection-and-fullseriescollection", "title": "Differences between SeriesCollection and FullSeriesCollection", "body": "<p>I am trying to clean some auto generated code and I am rather new with the series functionality in excel. So in many websites/forums I found people using a lot more <code>SeriesCollection</code> instead of my generated code using <code>FullSeriesCollection</code>.</p>\n\n<p>My code is filtering some stuff and then it is setting the x axis values of a chart so it is doing that:</p>\n\n<p><code>.ChartObjects(\"Voltage\").Chart.FullSeriesCollection(1).XValues = \"=Parametric_Sheet!D:D\"</code></p>\n\n<p>I'm trying to know if this code is ok or not or if I can clean it.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1559143451, "post_id": 56363431, "comment_id": 99330983, "body": "Post the actual code you&#39;ve tried and indicate what part of it isn&#39;t working correctly. &quot;Vainly tried&quot; could be a typo in what you retyped, it could be that you missed a line in copy/paste, it&#39;s hard to tell..."}, {"owner": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1559143658, "post_id": 56363431, "comment_id": 99331096, "body": "@FreeMan I tried above code(as posted by pstraton) it works when both the start and end date are in the same year but it goes wrong when both dates are in different years e.g. startdate in 2018 and enddate in 2019."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1559143905, "post_id": 56363431, "comment_id": 99331261, "body": "Have a look to the thread you are mentioning, scroll down and try the code of user <i>pstraton</i>."}, {"owner": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "edited": false, "score": 0, "creation_date": 1559143993, "post_id": 56363431, "comment_id": 99331310, "body": "thank you for response. updated my comment.does it work really?"}], "answers": [{"comments": [{"owner": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "edited": false, "score": 1, "creation_date": 1559192375, "post_id": 56364185, "comment_id": 99345805, "body": "Thank you! but it also do not calculate the correct fraction of month e.g. HowManyMonths(03 December 2018, 17 June 2019) returns <code>6.5032</code> which would be <code>29&#47;31+1+1+1+1+1+17&#47;30 = 6.50215053762 or 6.5022</code>"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "edited": false, "score": 0, "creation_date": 1559197069, "post_id": 56364185, "comment_id": 99347090, "body": "@SIslam that&#39;s a different approach than what you said previously. In your first example with November you did total days subtract date divided by total days so: <code>(30-15)&#47;30=0.5</code>. But with your December 3 example you show 29/31 which is a different approach. Based on your previous example it would be which equals 28, instead you <code>31-2</code> to get 29 over 31. This would explain your difference. If you want to include the start date (as you did for your December examples) it&#39;s easy to change."}, {"owner": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "edited": false, "score": 0, "creation_date": 1559198492, "post_id": 56364185, "comment_id": 99347691, "body": "<code>monthfractiondiff(15&#47;01&#47;2016,15&#47;02&#47;2016) will return ((31-15)&#47;31)+(15&#47;29) = 1.0333704116</code> Here <code>(31-15) = (Total Days in that month)-Day portion of the start date</code>"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "edited": false, "score": 0, "creation_date": 1559199209, "post_id": 56364185, "comment_id": 99348026, "body": "@SIslam sorry, I don&#39;t understand. Good luck with it."}, {"owner": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "edited": false, "score": 0, "creation_date": 1559199553, "post_id": 56364185, "comment_id": 99348180, "body": "Sorry if you don&#39;t understand. <code>monthfractiondiff(15&#47;01&#47;2016,15&#47;02&#47;2016)</code> will return <code>((31-15)&#47;31)+(15&#47;29) = 1.0333704116</code> Here <code>(31-15) = (Total Days in January month)-(Day portion of the start date i.e. 15)</code>"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "edited": false, "score": 0, "creation_date": 1559200021, "post_id": 56364185, "comment_id": 99348393, "body": "Yeah I see that... Jan 15 to Feb 15 in a leap year equals 1.0337 (31-15) = 16/31 + 15/29.That&#39;s what my formula returns, and that&#39;s what you listed as the expected result in your example. That&#39;s not the same approach in your December 3 example which is = (31-3) = that shows TWENTY-NINE instead of 28 divided by 31."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1559147811, "last_edit_date": 1559147811, "creation_date": 1559144364, "answer_id": 56364185, "question_id": 56363431, "link": "https://stackoverflow.com/questions/56363431/how-to-calculate-month-with-fraction-in-access-vba/56364185#56364185", "title": "How to calculate month with fraction in Access VBA", "body": "<p><strong>UPDATED</strong> thanks to other answer WeeBee</p>\n\n<pre><code>Function HowManyMonths(startdate As Date, Enddate As Date) As Double\nDim pctSTARTmonth As Double, pctENDmonth As Double, M As Long\n\n\n'caputues percentage of month\npctSTARTmonth = Day(startdate) / Day(DateSerial(Year(startdate), Month(startdate) + 1, 1) - 1)\npctENDmonth = Day(Enddate) / Day(DateSerial(Year(Enddate), Month(Enddate) + 1, 1) - 1)\n\n\n'Use Date difference function to get whole number and then combine perc\nHowManyMonths = DateDiff(\"M\", startdate, Enddate) + pctENDmonth - pctSTARTmonth\n\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559145889, "post_id": 56364449, "comment_id": 99332330, "body": "I like your overall approach better (i.e. standadizing the month), but the OP makes it clear that he/she is looking for each month to be converted to a percentage in relative days of month. Your formula doesn&#39;t quite fit as it would return 1.0163 for the Jan/Feb example instead of 1.0337."}, {"owner": {"reputation": 11, "user_id": 2220761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7df3da941e749d7f926786071e7f004?s=128&d=identicon&r=PG", "display_name": "WeeBee", "link": "https://stackoverflow.com/users/2220761/weebee"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1559147297, "post_id": 56364449, "comment_id": 99333059, "body": "Yeah, My formula don&#39;t have your level of accuracy, it&#39;s math approach."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559147842, "post_id": 56364449, "comment_id": 99333304, "body": "I stole part of your answer (And paid for it with an upclick!). The <code>DateDiff</code> is a better approach than my loop idea."}, {"owner": {"reputation": 11, "user_id": 2220761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7df3da941e749d7f926786071e7f004?s=128&d=identicon&r=PG", "display_name": "WeeBee", "link": "https://stackoverflow.com/users/2220761/weebee"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559153341, "post_id": 56364449, "comment_id": 99335718, "body": "Thanks, @PGCodeRider!"}], "tags": [], "owner": {"reputation": 11, "user_id": 2220761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7df3da941e749d7f926786071e7f004?s=128&d=identicon&r=PG", "display_name": "WeeBee", "link": "https://stackoverflow.com/users/2220761/weebee"}, "is_accepted": false, "score": 1, "last_activity_date": 1559145338, "creation_date": 1559145338, "answer_id": 56364449, "question_id": 56363431, "link": "https://stackoverflow.com/questions/56363431/how-to-calculate-month-with-fraction-in-access-vba/56364449#56364449", "title": "How to calculate month with fraction in Access VBA", "body": "<p>I would go with datediff().</p>\n\n<pre><code>datediff(\"d\", \"01/01/2019\", date())/30.5\n</code></pre>\n\n<p>Today this returns me 4,85245901639344.</p>\n"}, {"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559197615, "post_id": 56368311, "comment_id": 99347311, "body": "Seems like quite the effort to get <code>DaysInMonth</code>. See my approach below: <code>Day(DateSerial(Year(startdate), Month(startdate) + 1, 1) - 1)</code>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559201513, "post_id": 56368311, "comment_id": 99349056, "body": "@PGCodeRider: It&#39;s taken from a structured library."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1559197578, "last_edit_date": 1559197578, "creation_date": 1559163025, "answer_id": 56368311, "question_id": 56363431, "link": "https://stackoverflow.com/questions/56363431/how-to-calculate-month-with-fraction-in-access-vba/56368311#56368311", "title": "How to calculate month with fraction in Access VBA", "body": "<p>As the day count of months varies, you have to count by days to get as close as possible, as there never (except within a month or within July/August or December/January) will be an exact value:</p>\n\n<pre><code>' Rounds by default to two decimals, as more decimals has no meaning\n' due to the varying count of days of a month.\n' Optionally, don't round, by setting Round2 to False.\n'\nPublic Function TotalMonths( _\n    ByVal Date1 As Date, _\n    ByVal Date2 As Date, _\n    Optional Round2 As Boolean = True) _\n    As Double\n\n    Dim Months      As Double\n    Dim Part1       As Double\n    Dim Part2       As Double\n    Dim Fraction    As Double\n    Dim Result      As Double\n\n    Months = DateDiff(\"m\", Date1, Date2)\n    Part1 = (Day(Date1) - 1) / DaysInMonth(Date1)\n    Part2 = (Day(Date2) - 1) / DaysInMonth(Date2)\n\n    If Round2 = True Then\n        ' Round to two decimals.\n        Fraction = (-Part1 + Part2) * 100\n        Result = Months + Int(Fraction + 0.5) / 100\n    Else\n        Result = Months - Part1 + Part2\n    End If\n\n    TotalMonths = Result\n\nEnd Function\n\n\n' Returns the count of days of the month of Date1.\n'\n' 2016-02-14. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function DaysInMonth( _\n    ByVal Date1 As Date) _\n    As Integer\n\n    Const MaxDateValue  As Date = #12/31/9999#\n    Const MaxDayValue   As Integer = 31\n\n    Dim Days    As Integer\n\n    If DateDiff(\"m\", Date1, MaxDateValue) = 0 Then\n        Days = MaxDayValue\n    Else\n        Days = Day(DateSerial(Year(Date1), Month(Date1) + 1, 0))\n    End If\n\n    DaysInMonth = Days\n\nEnd Function\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>? TotalMonths(#2016/01/15#, #2016/02/15#)\n 1.03 \n\n? TotalMonths(#2018/11/15#, #2019/02/15#)\n 3.03 \n</code></pre>\n"}], "owner": {"reputation": 4976, "user_id": 1045364, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/bFobR.jpg?s=128&g=1", "display_name": "SIslam", "link": "https://stackoverflow.com/users/1045364/sislam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 56364185, "answer_count": 3, "score": -1, "last_activity_date": 1594771776, "creation_date": 1559141677, "last_edit_date": 1594771776, "question_id": 56363431, "link": "https://stackoverflow.com/questions/56363431/how-to-calculate-month-with-fraction-in-access-vba", "title": "How to calculate month with fraction in Access VBA", "body": "<p>I need to write a function that receives two arguments <code>startdate</code> and <code>enddate</code> where it returns the difference between these two dates.</p>\n\n<p>Say that function is <code>monthfractiondiff(startdate,enddate)</code></p>\n\n<p>e.g. <code>monthfractiondiff(15/01/2016,15/02/2016)</code> will return\n<code>((31-15)/31)+(15/29) = 1.0333704116</code></p>\n\n<p><code>monthfractiondiff(15/11/2018,15/02/2019)</code> will return\n<code>((30-15)/30)+1+1+(15/28) = 3.0357142857</code></p>\n\n<p>I vainly tried <a href=\"https://access-programmers.co.uk/forums/showthread.php?t=113589\" rel=\"nofollow noreferrer\">https://access-programmers.co.uk/forums/showthread.php?t=113589</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1559139987, "post_id": 56362861, "comment_id": 99329009, "body": "This was so obvious, can&#39;t believe I didn&#39;t think to just do that after seeing how the if statements were triggered, originally. Thanks a lot, going to try this now."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1559140304, "post_id": 56362861, "comment_id": 99329209, "body": "Solution verified!"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 2, "last_activity_date": 1559139893, "creation_date": 1559139893, "answer_id": 56362861, "question_id": 56362669, "link": "https://stackoverflow.com/questions/56362669/how-can-i-append-this-value-in-addition-to-what-the-user-inputs/56362861#56362861", "title": "How can I append this value in addition to what the user inputs?", "body": "<p>If I'm understanding correctly, the variable <code>rFound</code> points to a cell in column A from which you want to offset. If that's the case, you could write code like:</p>\n\n<pre><code>MsgBox \"Job Code (\" &amp; lJobCode &amp; \") is eligible for this (\" &amp; rFound.Offset(,7).Value &amp; \") cost-center.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1559140150, "creation_date": 1559140150, "answer_id": 56362946, "question_id": 56362669, "link": "https://stackoverflow.com/questions/56362669/how-can-i-append-this-value-in-addition-to-what-the-user-inputs/56362946#56362946", "title": "How can I append this value in addition to what the user inputs?", "body": "<p>You can add that line:</p>\n\n<pre><code>Option Explicit\nSub findJC_CC()\n\nDim wsData As Worksheet\nDim rFound As Range\nDim lJobCode As String\nDim lCC As String\nDim sFirst As String\nDim matched As Boolean\n\nlJobCode = Application.InputBox(\"Please provide a job code\", \"Job Code\", Type:=2)\nIf lJobCode = \"False\" Then Exit Sub 'Pressed cancel\nlCC = Application.InputBox(\"Please enter in a cost-center\", \"CC\", Type:=2)\nIf lCC = \"False\" Then Exit Sub 'Pressed cancel\n\nmatched = False\nSet wsData = ThisWorkbook.Worksheets(\"Sheet2\")\nSet rFound = wsData.Columns(\"A\").Find(lJobCode, wsData.Cells(wsData.Rows.Count, \"A\"), xlValues, xlWhole)\n\nIf Not rFound Is Nothing Then\n    sFirst = rFound.Address\n    Do\n\n        If rFound.Offset(, 2).Value = lCC Then\n            matched = True\n\n            'if criteria is met, display msgbox and exit\n            If rFound.Offset(, 4).Value = \"Exempt\" Then\n                MsgBox \"The business identified this exempt job as being eligible for schedule pay allowance .\"\n                Exit Sub\n            End If\n\n            'if criteria is met, display msgbox and exit\n            If rFound.Offset(, 5).Value = \"Eligible - Employee Level\" Then\n                MsgBox \"This job is only eligible at the employee level. If you have further questions, please reach out to your HRBP.\"\n                Exit Sub\n            End If\n\n            'if non-exempt role, and matched, display msgbox and exit\n            MsgBox \"Job Code (\" &amp; lJobCode &amp; \") is eligible for this (\" &amp; rFound.Offset(, 7).Value &amp; \") cost-center.\"\n            Exit Sub\n        End If\n\n        'loop after first address found until column C has lCC value matched\n        Set rFound = wsData.Columns(\"A\").FindNext(rFound)\n    Loop While rFound.Address &lt;&gt; sFirst\n\n    'lJobCode value matched, lCC value not matched\n    If Not matched Then MsgBox \"Job Code (\" &amp; lJobCode &amp; \") found, but not eligible for this cost-center.\"\nElse\n\n    'lJobCode not matched\n    MsgBox \"Job Code (\" &amp; lJobCode &amp; \") not eligible.\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 56362861, "answer_count": 2, "score": 0, "last_activity_date": 1559140150, "creation_date": 1559139313, "last_edit_date": 1559140022, "question_id": 56362669, "link": "https://stackoverflow.com/questions/56362669/how-can-i-append-this-value-in-addition-to-what-the-user-inputs", "title": "How can I append this value in addition to what the user inputs?", "body": "<p>I have a script that implements <code>FindNext</code> in order to search a sheet for a row to match two column values that the user inputs via <code>Application.InputBox</code>. Works flawlessly. But there is an instance where I'd like one of the msgboxs to display another cell value in that row without the user input. </p>\n\n<p>Example: User inputs Job code <code>000001</code> found in column A, cost-center <code>100100010001</code> Found in column C. </p>\n\n<p>The msgbox will match it and say: <code>MsgBox \"Job Code (\" &amp; lJobCode &amp; \") is eligible for this cost-center.</code></p>\n\n<p>What if I also wanted that message box to add in a value found in another column, but automatically? Like, without the user input because they wouldn't know this info off hand. </p>\n\n<p>New MsgBox Example: <code>MsgBox \"Job Code (\" &amp; lJobCode &amp; \") is eligible for this (\" &amp; Column H Value for this row &amp; \") cost-center.</code></p>\n\n<p>I was thinking something like a <code>str</code> variable and reference the column, but I'm having trouble having VBA trigger that value once the row is matched. </p>\n\n<p>Rest of script: </p>\n\n<pre><code>Option Explicit\nSub findJC_CC()\n\nDim wsData As Worksheet\nDim rFound As Range\nDim lJobCode As String\nDim lCC As String\nDim sFirst As String\nDim matched As Boolean\n\nlJobCode = Application.InputBox(\"Please provide a job code\", \"Job Code\", Type:=2)\nIf lJobCode = \"False\" Then Exit Sub 'Pressed cancel\nlCC = Application.InputBox(\"Please enter in a cost-center\", \"CC\", Type:=2)\nIf lCC = \"False\" Then Exit Sub 'Pressed cancel\n\nmatched = False\nSet wsData = ThisWorkbook.Worksheets(\"Sheet2\")\nSet rFound = wsData.Columns(\"A\").Find(lJobCode, wsData.Cells(wsData.Rows.Count, \"A\"), xlValues, xlWhole)\n\nIf Not rFound Is Nothing Then\n    sFirst = rFound.Address\n    Do\n\n        If rFound.Offset(, 2).Value = lCC Then\n            matched = True\n\n            'if criteria is met, display msgbox and exit\n            If rFound.Offset(, 4).Value = \"Exempt\" Then\n                MsgBox \"The business identified this exempt job as being eligible for schedule pay allowance .\"\n                Exit Sub\n            End If\n\n            'if criteria is met, display msgbox and exit\n            If rFound.Offset(, 5).Value = \"Eligible - Employee Level\" Then\n                MsgBox \"This job is only eligible at the employee level. If you have further questions, please reach out to your HRBP.\"\n                Exit Sub\n            End If\n\n            'if non-exempt role, and matched, display msgbox and exit\n            MsgBox \"Job Code (\" &amp; lJobCode &amp; \") is eligible for this cost-center.\"\n            Exit Sub\n        End If\n\n        'loop after first address found until column C has lCC value matched\n        Set rFound = wsData.Columns(\"A\").FindNext(rFound)\n    Loop While rFound.Address &lt;&gt; sFirst\n\n    'lJobCode value matched, lCC value not matched\n    If Not matched Then MsgBox \"Job Code (\" &amp; lJobCode &amp; \") found, but not eligible for this cost-center.\"\nElse\n\n    'lJobCode not matched\n    MsgBox \"Job Code (\" &amp; lJobCode &amp; \") not eligible.\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 1, "creation_date": 1559139886, "post_id": 56362649, "comment_id": 99328954, "body": "<code>ExamViewQry</code> is just a string.  I assume you need to execute this and return the result before you do anything else."}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559140060, "post_id": 56362649, "comment_id": 99329057, "body": "&quot; I am trying to assign the value from a SQL Query to a text box and running into a road block.&quot; - what does it exactly mean? Do you want to create a list of values as a source of combobox/listbox? Or something else? Could you provide more details about this?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1559140575, "post_id": 56362649, "comment_id": 99329389, "body": "Do you want to assign a value, or a control source? If you assign a value, it will not auto-update with changing data, and you have to calculate the value in the VBA code and use the .Value property. If you want to assign a control source, you need to wrap the query in a <code>DLookUp</code> function."}, {"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559141204, "post_id": 56362649, "comment_id": 99329759, "body": "the SQL returns a SUM, I want to assign that sum to the value of the text box."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559142711, "post_id": 56363285, "comment_id": 99330549, "body": "OK, As a VBA noob, I think I understand all of the second section. its the first code snippet, I am lost on. where the SQL code is.  thanks"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559142950, "post_id": 56363285, "comment_id": 99330691, "body": "On the ribbon you click create, then find Query Design. once you are in there, you will see a button on the far left, if you click the little down arrow under it, select the one that says SQL View."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143088, "post_id": 56363285, "comment_id": 99330767, "body": "Actually, i will add a picture to the post just to make it explicit."}, {"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143165, "post_id": 56363285, "comment_id": 99330812, "body": "Oh I see you mean having a Query Object in the DB. not just creating one on the fly! I get it."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143255, "post_id": 56363285, "comment_id": 99330865, "body": "Yea no problem, i used to do the on the fly querys, but i discovered it adds a LOT to database bloat (you know where it goes from a 3.5MB file to 700MB in a couple months of not compacting it)"}, {"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143361, "post_id": 56363285, "comment_id": 99330924, "body": "and TADA... that did it... Thanks, I was hoping to be more dynamic (within the VBA code) with the querys but this will work. I will Adjust my thought process to work from this method....   Resistance is Futile!"}, {"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143574, "post_id": 56363285, "comment_id": 99331043, "body": "and one quick last question. in the PARAMETERS eid LONG; (never seen this before) how would I go about adding 3 PARAMS. since I might use them for the other &quot;AND&quot; variables."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143593, "post_id": 56363285, "comment_id": 99331058, "body": "Yeah, i do this stuff day in day out, ive gotten to a point where i have an access file devoted to code modules i reuse the code from."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143743, "post_id": 56363285, "comment_id": 99331153, "body": "So, the parameters HAVE to be filled with something if they are listed in that section, but to add more, you would just do PARMETERS eid long, SecondParamter text(255); Also, you HAVE to have the semicolon between the parameters part and the rest of the query. EDIT: if you want to set the parameters, you can just goto the query tools when on the design grid view, and on the top it has a button called parameters. you can add to the list that way."}, {"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143842, "post_id": 56363285, "comment_id": 99331215, "body": "Beat ya to it... Thanks. Now I am going to play with using this bit of code over and over again for multiple text boxes.   Thanks again KySoto!"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559143910, "post_id": 56363285, "comment_id": 99331267, "body": "by the way, if you build a query that has ALL of the data that you need (for all of the fields you are working on) then you can use this method to load data into them all."}, {"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559144601, "post_id": 56363285, "comment_id": 99331625, "body": "Thats exaclty what I was Thinking... Now contemplating how to write the SQL statement for ALL the totals with the all the variable... Might be a LONG SQL statement....."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "reply_to_user": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559147258, "post_id": 56363285, "comment_id": 99333036, "body": "By the way, would you mark my answer as the best answer if it was so?"}, {"owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "edited": false, "score": 0, "creation_date": 1559149809, "post_id": 56363285, "comment_id": 99334174, "body": "Done! noob ... LOL"}], "tags": [], "owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "is_accepted": true, "score": 0, "last_activity_date": 1559143523, "last_edit_date": 1559143523, "creation_date": 1559141233, "answer_id": 56363285, "question_id": 56362649, "link": "https://stackoverflow.com/questions/56362649/assign-value-from-query-with-sum-to-textbox/56363285#56363285", "title": "Assign Value from Query with sum to Textbox", "body": "<p>Create a query using the sql you have, but slightly modded paste it here:\n<a href=\"https://i.stack.imgur.com/St6FU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/St6FU.png\" alt=\"Sql view\"></a></p>\n\n<pre><code>PARAMETERS eid long;\nSELECT Sum(tblentrys.entryhours) AS TotalHoursPerFunction\nFROM tBleExams\nINNER JOIN (\n    tBlBankList INNER JOIN (\n        tBlExaminers INNER JOIN (\n            tBlEntrys INNER JOIN tBlActivity ON tBlEntrys.EntryActivityID = tBlActivity.FunctionKey\n            ) ON tBlExaminers.ExaminersKey = tBlEntrys.EntryExaminerID\n        ) ON tBlBankList.BankID = tBlEntrys.EntryInstitutionID\n    ) ON (tBlBankList.BankID = tBleExams.ExamBankID)\n    AND (tBleExams.ExamID = tBlEntrys.EntryExamID)\nWHERE tBlEntrys.EntryActivityID = 1\n    AND tblEntrys.EntryExamStageID = 1\n    AND tBleExams.ExamID = [eid]\n</code></pre>\n\n<p>lets call it qryGetHours (since i dont know what you need it for.)\nin the after update event (also use better naming, this is quick and dirty)</p>\n\n<pre><code>dim db as DAO.Database\ndim qry as QueryDef\ndim rs as DAO.Recordset\n\nset db = currentdb\nset qry = db.querydefs(\"qryGetHours\")\n'this is the name of the query you made above\nqry.parameters(\"eid\").value = me.SelectedExam.Column(0)\nset rs = qry.openrecordset(dbopendynaset,dbseechanges)\n'dbseechanges is more for if you have a sql server backend, but i usually do\nif not ( rs.eof and rs.bof) then\n    rs.movefirst\n    me.prepoffEIC = rs.fields(\"TotalHoursPerFunction\").value\n    'This portion assumes that you only get one record back, \n    'or if you do end up with more than one, it only goes \n    'after the first one.\nelse\n    msgbox \"Errors... Errors everywhere.\"\n    'You will definitely want to put something meaningful \n    'here relating to it not being able to find the data you \n    'were looking for.\nend if\nif not rs is nothing then\n    rs.close\n    set rs = nothing\nend if\nset qry = nothing\nset db = nothing\n'you will always want to do this portion where you properly \n'check if a recordset exists and then close it when you are \n'done, along with closing out the querydef and database variables.\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11573371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1020effec4df1399c1fefac668b46d?s=128&d=identicon&r=PG&f=1", "display_name": "Gary", "link": "https://stackoverflow.com/users/11573371/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 56363285, "answer_count": 1, "score": 0, "last_activity_date": 1612726842, "creation_date": 1559139242, "last_edit_date": 1612726842, "question_id": 56362649, "link": "https://stackoverflow.com/questions/56362649/assign-value-from-query-with-sum-to-textbox", "title": "Assign Value from Query with sum to Textbox", "body": "<p>I am trying to assign the value from a SQL Query to a text box.</p>\n<p>I have the function tied to a ComboBox After update.</p>\n<p>I tested the SQL by running it.</p>\n<p>How do I assign the result to the Txtbox named prepoffEIC?</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Dim MyVar2 As Integer\nMyVar2 = Me.SelectedExam.Column(0)\nExamViewQry = &quot;SELECT Sum(tblentrys.entryhours) AS TotalHoursPerFunction FROM tBleExams INNER JOIN (tBlBankList INNER JOIN (tBlExaminers INNER JOIN (tBlEntrys INNER JOIN tBlActivity ON tBlEntrys.EntryActivityID = tBlActivity.FunctionKey) ON tBlExaminers.ExaminersKey = tBlEntrys.EntryExaminerID) ON tBlBankList.BankID = tBlEntrys.EntryInstitutionID) ON (tBlBankList.BankID = tBleExams.ExamBankID) AND (tBleExams.ExamID = tBlEntrys.EntryExamID) WHERE tBlEntrys.EntryActivityID=1 AND tblEntrys.EntryExamStageID=1 AND tBleExams.ExamID=&quot; &amp; MyVar2\n\nMe.prepoffEIC.ControlSource = &quot;ExamViewQry&quot;\nMe.prepoffEIC.Requery\n</code></pre>\n"}, {"tags": ["excel", "vba", "foreach"], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "is_accepted": false, "score": 0, "last_activity_date": 1559141844, "creation_date": 1559141844, "answer_id": 56363469, "question_id": 56362504, "link": "https://stackoverflow.com/questions/56362504/loop-through-each-sheets-to-look-for-name-containing-value-do-something-loop-a/56363469#56363469", "title": "Loop through each sheets to look for name containing value, do something, loop again looking for new value", "body": "<p>I would use a code similar to the below:</p>\n\n<pre><code>Dim s As Worksheet, t As String\nDim i As Long, K As Long\nK = Sheets.Count\n\nFor i = 1 to i = K\n    t = Sheets(i).Name\n\n    Sheets(i).activate\n\n    ' Do your activities within this loop\nNext i\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "is_accepted": false, "score": 1, "last_activity_date": 1559153978, "creation_date": 1559153978, "answer_id": 56366452, "question_id": 56362504, "link": "https://stackoverflow.com/questions/56362504/loop-through-each-sheets-to-look-for-name-containing-value-do-something-loop-a/56366452#56366452", "title": "Loop through each sheets to look for name containing value, do something, loop again looking for new value", "body": "<p>You could use a function to grab numbers from the tab name.  Looks like you only want tabs that include 100 thru 300.  How 'bout trying this:</p>\n\n<pre><code>For Each sh In ActiveWorkbook.Worksheets\n    vNumName = NumOnly(sh.Name)\n    If vNumName &gt;= 100 And vNumName &lt;= 300 Then\n        Worksheets(sh.Name).Select (False)\n        ActiveSheet.ExportAsFixedFormat _\n            ''' pdf format and save location'''\n    End If\nNext sh\n</code></pre>\n\n<p>The function:</p>\n\n<pre><code>Function NumOnly(vName As String) As Integer\n    vOut = \"\"\n    For i = 1 To Len(vName)\n        If Mid(vName, i, 1) &gt;= \"0\" And Mid(vName, i, 1) &lt;= \"9\" Then vOut = vOut &amp; Mid(vName, i, 1)\n    Next\n    If Len(vOut) &gt;= 4 Then\n        NumOnly = vOut\n    Else\n        NumOnly = 0\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11573295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-c45c4MhFcAE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reizecnQUQbU5Sdut_9HRNkNYr-Eg/mo/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/11573295/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559153978, "creation_date": 1559138819, "last_edit_date": 1559141130, "question_id": 56362504, "link": "https://stackoverflow.com/questions/56362504/loop-through-each-sheets-to-look-for-name-containing-value-do-something-loop-a", "title": "Loop through each sheets to look for name containing value, do something, loop again looking for new value", "body": "<p>I am trying to loop through sheets in a workbook, select those with names alike, save them to a PDF, then loop again but change the name it looks for in the sheets.  The sheets will have in common a number that is 4 digits like <code>0001</code> or <code>0243</code> and the four digits are important so sheets <code>0030</code> and <code>0003</code> do not get combined. </p>\n\n<p>I have gotten the code to work on just one name to find (below) but cannot figure out how to make it loop through more names.  Tried making the name an integer and add 1 to it after each loop, tried very briefly to make it loop through array values but that did not work how I tried. </p>\n\n<pre><code>For Each sh In ActiveWorkbook.Worksheets\n\n    If sh.Name Like \"*0001*\" Then\n\n        Worksheets(sh.Name).Select (False)\n        ActiveSheet.ExportAsFixedFormat _\n            ''' pdf format and save location'''\n\n    End If\n\nNext sh\n</code></pre>\n\n<p>If it could loop through each digit from <code>0001</code> to <code>0300</code> that would be ideal so I do not need to edit code each time I run it to add the new sheet names.  However if an array will work best I can make a long array for the numbers I know will be present in the file and add new ones each month as needed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559138652, "post_id": 56362340, "comment_id": 99328229, "body": "Is your folder actually called &quot;TEST FOLDER &quot; (with a space)?"}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1559138822, "post_id": 56362340, "comment_id": 99328343, "body": "Does the directory already exist / do you have sufficient privileges to create a folder there? ... There really isn&#39;t much that could wrong with that line of code, you could try build the string first maybe: <code>Dim path as String   path = &quot;\\\\base\\child\\&quot; &amp; Format(Date, &quot;yyyy&quot;) &amp; &quot; Email Tracking\\&quot; &amp; Format(Date, &quot;mm.dd.yy&quot;) &amp; &quot;\\sub-folder\\&quot;     MkDir path</code>  if the path already exists then <code>If Len(Dir(path, vbDirectory)) = 0 Then    MkDir path End If</code>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1559139001, "post_id": 56362340, "comment_id": 99328462, "body": "Are you sure the error comes from this line? The VBA compiler doesn&#39;t complain and when I run it, I get a &quot;Path not found&quot; error - exactly what I expected."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1559139480, "post_id": 56362340, "comment_id": 99328721, "body": "This code compiles perfectly fine. Please <a href=\"https://stackoverflow.com/posts/56362340/edit\">edit</a> your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that reproduces the problem."}], "answers": [{"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1559141196, "creation_date": 1559141196, "answer_id": 56363274, "question_id": 56362340, "link": "https://stackoverflow.com/questions/56362340/create-directory-without-compile-error-message/56363274#56363274", "title": "Create directory without compile error message", "body": "<p>Your code is compiling perfectly.</p>\n\n<p>But when you add this next to your code:</p>\n\n<pre><code>Function Format(s As String)\nFormat = \"tralala\"\nEnd Function\n</code></pre>\n\n<p>Then, it does not work anymore.</p>\n\n<p>Can you verify you don't have some <code>Format()</code> function defined somewhere?</p>\n"}], "owner": {"reputation": 11, "user_id": 10923791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d780b48f84a99b44e30a82e834bb9cbe?s=128&d=identicon&r=PG&f=1", "display_name": "fireFly", "link": "https://stackoverflow.com/users/10923791/firefly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559141196, "creation_date": 1559138301, "question_id": 56362340, "link": "https://stackoverflow.com/questions/56362340/create-directory-without-compile-error-message", "title": "Create directory without compile error message", "body": "<p>Please help. I am pretty new. I am trying to create a folder using dates and got a compile error message \"wrong number of arguments or invalid property assignments\". The code worked perfectly for a month but not anymore. </p>\n\n<pre><code>Sub Test()\n\nMkDir \"\\\\AD.TEST.COM\\nas\\Team-AB-TEST\\TEST FOLDER\\TEST FOLDER \\\" &amp; Format(Date, \"yyyy\") &amp; \" Email Tracking\\\" &amp; Format(Date, \"mm.dd.yy\") &amp; \"\\Attach\\\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "memory", "out-of-memory", "instance"], "comments": [{"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "edited": false, "score": 0, "creation_date": 1559138513, "post_id": 56362283, "comment_id": 99328140, "body": "When you say referencing do you mean as in excel formulae or in vba code? Formula-wise WrkB is not referencing WrkA, if you can provide examples I would be happy to try and remove all references and see if this fixes it"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "edited": false, "score": 0, "creation_date": 1559139204, "post_id": 56362384, "comment_id": 99328589, "body": "That was it! Thank you! I love easy answers :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 2, "last_activity_date": 1559138452, "creation_date": 1559138452, "answer_id": 56362384, "question_id": 56362283, "link": "https://stackoverflow.com/questions/56362283/call-an-excel-macro-in-specific-instance-of-excel-in-vba/56362384#56362384", "title": "Call an excel macro in specific instance of excel in VBA", "body": "<p>Change</p>\n\n<pre><code>Application.Run \"'WkbB.xlsm'!Main\"\n</code></pre>\n\n<p>to </p>\n\n<pre><code>WrkB.Run \"'WorkbookB.xlsm'!Main\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6805988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c931fc7203559239df8185e5201fce9?s=128&d=identicon&r=PG&f=1", "display_name": "St. Jimmy", "link": "https://stackoverflow.com/users/6805988/st-jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56362384, "answer_count": 1, "score": 0, "last_activity_date": 1559138452, "creation_date": 1559138090, "question_id": 56362283, "link": "https://stackoverflow.com/questions/56362283/call-an-excel-macro-in-specific-instance-of-excel-in-vba", "title": "Call an excel macro in specific instance of excel in VBA", "body": "<p>I'm receiving out of resources errors in 32-bit Excel 365 (64-bit remedies the problem but our IT won't allow it for the number of users that would use this book, so I'm stuck with 32-bit). I have plenty of RAM so I'm trying to split the two workbooks into different instances to allow more memory allocation (if this is a bad strategy I'd be happy to know why/alternatives!). </p>\n\n<p>My set-up has two workbooks, Workbook A opens Workbook B and Workbook B runs the heavy lifting code and then transfers the data back to Workbook A in value format. </p>\n\n<p>Excel Instance 1: Workbook A</p>\n\n<p>Excel Instance 2: Workbook B</p>\n\n<p>I want WkbA (open in Excel Instance 1) to call a macro on WrkB open in Excel Instance 2. I wrote the code below to try this.</p>\n\n<pre><code>Dim WkbB As Object\nSet WkbB = New Excel.Application\nWith WkbB\n    .Visible = True\n    .Workbooks.Open \"P:\\Root\\WorkbookB.xlsm\", True, False\nEnd With\n\nApplication.Run \"'WkbB.xlsm'!Main\"\n</code></pre>\n\n<p>At the 'End With' line, the Code opens WkbA and WrkB in two separate Excel Instances as I want</p>\n\n<p>Excel Instance 1: WrkA</p>\n\n<p>Excel Instance 2: WrkB</p>\n\n<p>But at the Application.Run line excel opens WrkB again in instance 1</p>\n\n<p>Excel Instance 1: WrkA &amp; WrkB</p>\n\n<p>Excel Instance 2: WrkB</p>\n\n<p>Instead of calling the Main subroutine in Instance 2 WorkbookB.</p>\n"}, {"tags": ["vba", "ibm-midrange"], "answers": [{"comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "reply_to_user": {"reputation": 11, "user_id": 11573244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e68T6LgXWFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0trpfOiVPsqS7AEQxAW-_nxpMjg/mo/photo.jpg?sz=128", "display_name": "dwight chang", "link": "https://stackoverflow.com/users/11573244/dwight-chang"}, "edited": false, "score": 0, "creation_date": 1559320639, "post_id": 56366298, "comment_id": 99396029, "body": "The Database, Hostname, and SYSTEM parameters, as well as the DBQ parameter for which base libraries you want to use..."}], "tags": [], "owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "is_accepted": false, "score": 1, "last_activity_date": 1559320601, "last_edit_date": 1559320601, "creation_date": 1559153277, "answer_id": 56366298, "question_id": 56362169, "link": "https://stackoverflow.com/questions/56362169/macro-to-get-data-from-iseries-as400-using-excel-vba/56366298#56366298", "title": "Macro to Get Data from Iseries (AS400) using Excel VBA", "body": "<p>As a side note, you can also use open JT400 in <code>java</code> to use DB2 SQL to query your tables.</p>\n\n<p>Using VBA you can also use queries as follows:</p>\n\n<p>The code I am using here is primarily from <a href=\"https://stackoverflow.com/questions/18313899/vba-new-database-connection\">VBA New Database Connection</a>. </p>\n\n<p>However, of importance to you is your database connection string.\nThis is using the Client Access ODBC driver to connect to an IBM i DB2 database on a server with the name POWER7 and other options. The \"translate\" option I believe takes it from the 65535 CSSID and converts it to something nice from EBDIC.</p>\n\n<pre><code>\n\n\nSub DbConnection()\n\n    Dim cn As Object ' ADODB.Connection\n    Set cn = CreateObject(\"ADODB.Connection\") ' New ADODB.Connection\n    Dim rs As Object ' ADODB.Recordset\n\n    Dim strConn As String\n    strConn = \"DRIVER={Client Access ODBC Driver (32-bit)};\" &amp; _\n                \"Database=&lt;myDataBase&gt;;\" &amp; _\n                \"Hostname=&lt;POWER7&gt;;\" &amp; _\n                \"Port=1234;\" &amp; _\n                \"Protocol=TCPIP;\" &amp; _\n                \"Uid=&lt;USERID&gt;;\" &amp; _\n                \"Pwd=&lt;PASSWORD&gt;;\" &amp; _\n                \"SYSTEM=&lt;POWER7&gt;;\" &amp; _\n                \"DBQ=QGPL &lt;YOUR BASE LIBRARY&gt; &lt;ANOTHER&gt;;\" &amp; _\n                \"DFTPKGLIB=QGPL;\" &amp; _\n                \"LANGUAGEID=ENU;\" &amp; _\n                \"PKG=QGPL/DEFAULT(IBM),2,0,1,0,512;QRYSTGLMT=-1;\" &amp; _\n                \"TRANSLATE=1;\" &amp; _\n                \"CONNTYPE=2;\" &amp; _\n                \"REGIONAL=NO;\"\n\n    cn.Open strConn\n\n    Dim queryArr, i\n    queryArr = Array(\"SELECT * FROM &lt;LIBRARY&gt;.&lt;TABLE&gt;\")\n\n    For i = LBound(queryArr) To UBound(queryArr)\n        ExecuteQuery queryArr(i), cn, rs\n    Next i\n\n    cn.Close\n    Set cn = Nothing\nEnd Sub\n\nPrivate Sub ExecuteQuery(query As Variant, ByRef cn As Object, ByRef rs As Object)\n    Set rs = CreateObject(\"ADODB.Recordset\") ' New ADODB.Recordset\n    With rs\n        .ActiveConnection = cn\n        .Open CStr(query)\n        Sheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset rs\n        .Close\n    End With\n    Set rs = Nothing\nEnd Sub\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 834, "user_id": 7959837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9C9j.jpg?s=128&g=1", "display_name": "Suliman Farzat", "link": "https://stackoverflow.com/users/7959837/suliman-farzat"}, "is_accepted": false, "score": 0, "last_activity_date": 1559920708, "creation_date": 1559920708, "answer_id": 56497125, "question_id": 56362169, "link": "https://stackoverflow.com/questions/56362169/macro-to-get-data-from-iseries-as400-using-excel-vba/56497125#56497125", "title": "Macro to Get Data from Iseries (AS400) using Excel VBA", "body": "<p>test this:</p>\n\n<pre><code> Option Explicit\n    Option Base 1\n\n    Sub Firmennamen()\n    On Error GoTo ERRORHANDLER\n\n    Dim sSQLFirmen As String\n    Dim objListObj As ListObject\n    Dim objListCols As ListColumns\n    Set WB = ThisWorkbook\n    Set ws_Einstellungen = WB.Worksheets(\"Einstellung\") ' tab name in excel\n    Set objListObj = ws_Einstellungen.ListObjects(\"FirmenNamen\") ' table name in excel\n    Set objListCols = objListObj.ListColumns\n\n        ws_Einstellungen.Range(\"FirmenNamen\").ClearContents ' clear table\n\n        sconnect = \"PROVIDER=IBMDA400;Data Source=server_name;USER ID=username;PASSWORD=Password;\"\n        conn.ConnectionTimeout = 30\n        conn.Open sconnect\n        Set mrs.ActiveConnection = conn\n        sSQLFirmen = \" SELECT t.col1 AS Nr, t.col2 AS Firma \" &amp; _\n                    \" From server_name.schema_name.table_name t \" &amp; _\n                    \" WHERE t.col2='010' \" &amp; _\n                    \" ORDER BY t.col1 \"\n        mrs.Open sSQLFirmen, conn\n        For i = 0 To mrs.fields.count - 1\n                    objListCols(i + 1).Name = mrs.fields(i).Name\n                Next i\n        ws_Einstellungen.Range(\"FirmenNamen\").CopyFromRecordset mrs\n        mrs.Close\n        conn.Close\n        Set mrs = Nothing\n        Set conn = Nothing\n        Exit Sub\n         'get out before the Error Handler kicks in\n\n        '//////////////////////////////////////////////////////////\n        ERRORHANDLER:\n            Call ERROR\n        End\n\n        End Sub\n\n\n\n\n\n        Private Sub Workbook_Open()\n            Call Firmennamen ' when excel open --&gt; query update\n        End Sub\n\n\n\n\n        Sub ERROR()\n\n            Select Case Err.Number\n                Case -2147217843\n                    msg = \"Sie m\u00fcssen Ihre User ID und Password eintragen: \" &amp; Err.Number _\n                    &amp; \" oder Ihre user ID und Password sind nicht correct.\"\n                    MsgBox msg, vbOKOnly\n                Case 13\n                    msg = \"You have text data in a numeric field (\" &amp; BadField &amp; \"). Fix and re-Upload\"\n                    MsgBox msg, vbOKOnly\n                Case 1004\n                    msg = \"Firma fehlt oder ist ung\u00fcltig !\"\n                    MsgBox msg, vbOKOnly\n\n                Case Else\n                    msg = \"DIe Fehler ist: \" &amp; Err.Number &amp; \" /  \" &amp; Err.Description &amp; vbCrLf &amp; vbCrLf &amp; \" Bitte sich bei IT melden (mit Screenshot dieser Meldung) !! :(  \"\n                    MsgBox msg, vbOKOnly\n            End Select\n\n            Err.Clear\n            'Set GetConnection = Nothing\n\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11573244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-e68T6LgXWFk/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY0trpfOiVPsqS7AEQxAW-_nxpMjg/mo/photo.jpg?sz=128", "display_name": "dwight chang", "link": "https://stackoverflow.com/users/11573244/dwight-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2561, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1559920708, "creation_date": 1559137774, "last_edit_date": 1559150648, "question_id": 56362169, "link": "https://stackoverflow.com/questions/56362169/macro-to-get-data-from-iseries-as400-using-excel-vba", "title": "Macro to Get Data from Iseries (AS400) using Excel VBA", "body": "<p>I am getting data from AS400 via Excel add-in and I'm trying to find an automated to do this because I have to do this many times with various source files and it's annoying to constantly to having to log in whenever I use a new source file.</p>\n\n<p>For instance, for the source file \"bond.tto\" I would do this to download it:</p>\n\n<p>In Excel, \ngo to \"Add-Ins\" --> \"Transfer Data from iSeries.\" A \"Transfer Request\" window pops up and from there I choose \"create a new file\"... the path and the file name is c:\\bond.tto.</p>\n\n<p>\"starting cell position\" I chose column A and row 1 and click \"include column headings.\"  I press \"OK.\"</p>\n\n<p>then I enter my credentials which let's say my user name is \"abc\" and pw is \"abc.\"  The server...let's call it \"BLUE.TOR.MCFLY.COM.\"</p>\n\n<p>Could somebody suggest code to automate this?  Please and thank you.</p>\n\n<p>The macro recorder doesn't give me any lines of code to work with.\nNo errors as the macro recorder doesn't work.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559142560, "post_id": 56361938, "comment_id": 99330465, "body": "Look at prior answers which loop shell windows and find  right window by document.title or url. Or use selenium vba."}, {"owner": {"reputation": 1, "user_id": 11533936, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UvMbzMG2PY0/AAAAAAAAAAI/AAAAAAAAE6o/NbToWk0tD7A/photo.jpg?sz=128", "display_name": "bbb", "link": "https://stackoverflow.com/users/11533936/bbb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559289504, "post_id": 56361938, "comment_id": 99380913, "body": "@QHarr thank you for your comment, but what do you mean loop shell windows ?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559289601, "post_id": 56361938, "comment_id": 99380956, "body": "<a href=\"https://www.google.com/search?safe=strict&amp;rlz=1C1GCEV_enGB851GB851&amp;ei=7d7wXP2OGfKi1fAPytyT4AM&amp;q=vba+find+ie+window&amp;oq=vba+find+ie+window&amp;gs_l=psy-ab.3..0i30l2j0i8i30.5786.6355..6602...0.0..0.169.552.0j4......0....1..gws-wiz.......0i71j0i7i30j0i8i7i30.cVAcXwCF3AA\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11533936, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UvMbzMG2PY0/AAAAAAAAAAI/AAAAAAAAE6o/NbToWk0tD7A/photo.jpg?sz=128", "display_name": "bbb", "link": "https://stackoverflow.com/users/11533936/bbb"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1559553580, "post_id": 56361938, "comment_id": 99443455, "body": "@QHarr I found the right question and it works, thank you very much!"}], "owner": {"reputation": 1, "user_id": 11533936, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UvMbzMG2PY0/AAAAAAAAAAI/AAAAAAAAE6o/NbToWk0tD7A/photo.jpg?sz=128", "display_name": "bbb", "link": "https://stackoverflow.com/users/11533936/bbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559137175, "creation_date": 1559137032, "last_edit_date": 1559137175, "question_id": 56361938, "link": "https://stackoverflow.com/questions/56361938/how-i-can-navigate-vba-to-the-new-tab-after-logging", "title": "How I can navigate vba to the new tab after logging?", "body": "<p>I login on some web page using vba excel code, and after login my IE page opens new tab and I need macro to change to this new tab and then continue this code there. </p>\n\n<p>I have tried something like this but nothing is happening.</p>\n\n<pre><code>   objIE.navigate \"\"\n   Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n objIE.document.getElementById(\"sidebar\").contentDocument.getElementById(\"Link0\").Click\n</code></pre>\n"}, {"tags": ["excel", "vba", "replace", "find", "sendkeys"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559137069, "post_id": 56361887, "comment_id": 99327208, "body": "Welcome to SO. Have you tried converting those strings to Doubles? Dates are numbers after all (the integer part would be a date, and the decimal part would be hours, minutes and seconds)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559138102, "post_id": 56361887, "comment_id": 99327884, "body": "A trick which sometimes works is to add a column and set a formula to multiply the original column by 1.  This forces the text to be a number (which as stated above) is also a date."}, {"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1559139794, "post_id": 56361887, "comment_id": 99328896, "body": "first, excel is not doing anything &#39;randomly&#39; and this is important to recognize.  Dates are not converting because your regional settings (probably) are set to MM/DD/YYYY .... -- and the example 31/03/2019 cannot be converted into such a date.  There is no month &quot;31&quot;  -- so be extremely wary of the dates that DID convert.  They probably look like 05/06/2019 -- and I bet you read in May 6, when that date ought to be June 5."}, {"owner": {"reputation": 1, "user_id": 11572726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7000d675e3bb1f6c79f1b907758c4c8?s=128&d=identicon&r=PG&f=1", "display_name": "Bonley", "link": "https://stackoverflow.com/users/11572726/bonley"}, "edited": false, "score": 0, "creation_date": 1559213079, "post_id": 56361887, "comment_id": 99354114, "body": "Thank you for the help! Good point, computers don&#39;t do things at random, I suppose I said &quot;randomly&quot; because I haven&#39;t been able to identify the cause yet. I&#39;ve edited the question to clarify that the date formats are all aligned into &quot;DD/MM/YYYY&quot; format so that isn&#39;t the issue. I&#39;ve verified this by checking a file with timestamps &gt;12 DD, and it deals with it correctly."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1559139512, "creation_date": 1559139512, "answer_id": 56362743, "question_id": 56361887, "link": "https://stackoverflow.com/questions/56361887/how-to-get-excel-to-recognise-dates-without-a-manual-find-and-replace-for/56362743#56362743", "title": "How to get Excel to recognise dates without a manual find and replace &quot;/&quot; for &quot;/&quot;?", "body": "<p>First import the date/time field into Excel as <strong><em>Text</em></strong>.  In my demo case I use column <strong>A</strong>.  Then run:</p>\n\n<pre><code>Sub TextToValue()\n    Dim Kolumn As String, N As Long, i As Long\n    Dim d As Double, dt As Date, tm As Date\n    Dim v As Variant\n\n    Kolumn = \"A\"\n    N = Cells(Rows.Count, Kolumn).End(xlUp).Row\n\n    For i = 1 To N\n        v = Cells(i, Kolumn).Text\n        If InStr(1, v, \"/\") &gt; 0 Then\n            arr = Split(v, \" \")\n            brr = Split(arr(0), \"/\")\n            dt = DateSerial(brr(2), brr(1), brr(0))\n            tm = TimeValue(arr(1))\n            d = CDbl(dt + tm)\n            Cells(i, Kolumn).Clear\n            Cells(i, Kolumn).Value = d\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3xHRs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3xHRs.png\" alt=\"enter image description here\"></a></p>\n\n<p>And after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yYrVK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yYrVK.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1559157883, "creation_date": 1559157883, "answer_id": 56367258, "question_id": 56361887, "link": "https://stackoverflow.com/questions/56361887/how-to-get-excel-to-recognise-dates-without-a-manual-find-and-replace-for/56367258#56367258", "title": "How to get Excel to recognise dates without a manual find and replace &quot;/&quot; for &quot;/&quot;?", "body": "<p>You need to back up a step.</p>\n\n<p>Your problem is common and is caused by <strong>OPEN</strong>ing a <code>csv</code> file where the date format (<code>DMY</code>) in this case is in a different format than your Windows Regional Setting on the your computer.  </p>\n\n<p>So even the input that appears to convert properly, will not be as the Day and Month will be exchanged from what you might expect.</p>\n\n<p>Arguably the \"best\" fix for this issue, assuming you cannot alter the <code>csv</code> file, will be to <strong>IMPORT</strong> the file instead.</p>\n\n<p>Depending on how you do the <strong>IMPORT</strong>, and that is Excel version dependent, you will have the opportunity, at the time of import, to define the date format of the incoming data, so it will be properly converted by Excel.</p>\n\n<p>In <code>Power Query</code> you can specify to have <code>PQ</code> do the date conversion according to a specified locale.  In earlier versions of Excel, a Text-to-columns wizard will open allowing you to specify <code>DMY</code> for the format of the csv file.  I would suggest using <code>PQ</code> as it can easily handle the time portion, whereas with the older wizard you'll need to split the two, and then add them back together.</p>\n"}], "owner": {"reputation": 1, "user_id": 11572726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7000d675e3bb1f6c79f1b907758c4c8?s=128&d=identicon&r=PG&f=1", "display_name": "Bonley", "link": "https://stackoverflow.com/users/11572726/bonley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559210050, "creation_date": 1559136886, "last_edit_date": 1559210050, "question_id": 56361887, "link": "https://stackoverflow.com/questions/56361887/how-to-get-excel-to-recognise-dates-without-a-manual-find-and-replace-for", "title": "How to get Excel to recognise dates without a manual find and replace &quot;/&quot; for &quot;/&quot;?", "body": "<p>How do I get excel to recognize timestamps as timestamps rather than strings?</p>\n\n<p>If I do a find and replace on \"/\" with \"/\" it fixes it on most files:</p>\n\n<pre><code>Cells.Replace What:=\"/\", Replacement:=\"/\", LookAt:=xlPart, SearchOrder :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n</code></pre>\n\n<p>I have a chunk of code that checks if it's still in the wrong format by converting to \"Comma\" format and checking if the cell contains any \"/\" characters, then a break line that triggers in that instance to alert me that I need to manually do the find and replace on this file. If I stop the Macro when it fails and run it manually (Crtl+h, Enter), then it works and I can restart the macro to finish the standardisation. I need a way of automating this.</p>\n\n<p>I have >2000 .csv files of a similar but not identical format. Each one contains ~350 variables, each with it's own timestamp and data column. I've written some code that formats it into a usable format. The original csv has the timestamps in \"DD/MM/YYYY hh:mm:ss\" format as is my computer and Excel default. </p>\n\n<p>Excel seemingly randomly decides it can't recognise around a quarter of the files timestamps and instead interprets them as strings. This can be corrected by clicking into the cell and then clicking out of the cell, then excel recognises it as a timestamp. I need the timestamps recognised so that I can interpolate values into a standard sampling frequency as Excel can't interpolate using values it interprets as strings.</p>\n\n<p>There are often well over 100k timestamps per file, so doing this manually isn't an option. </p>\n\n<p>I've tried using SendKeys. The problem with that seems to be that it opens the find and replace dialogue for the VBA script editor, not for the excel sheet.\nI've tried shifting focus before by calling: </p>\n\n<pre><code>Windows(windowname).Activate\nActiveWorkbook.Application.SendKeys(\"^h\")\n</code></pre>\n\n<p>I've also tried: </p>\n\n<pre><code>Windows(windowname).Application.SendKeys(\"^h\")\n</code></pre>\n\n<p>Which both result in the find and replace being called on the VBA script editor.</p>\n\n<p>I have no shortcut to start the Macro.</p>\n\n<p>I've tried Matlab, but it can't deal with the header on the file or the columns populated with text. I'd like to retain all the data.</p>\n\n<p>I have used the Macro recorder to record me doing the find and replace which results in:</p>\n\n<pre><code>Sub Fixer()\n'\n' Fixer Macro\n'\n\n'\n    Selection.Replace What:=\"/\", Replacement:=\"/\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\nEnd Sub\n</code></pre>\n\n<p>But this doesn't work when you run it on the same file.</p>\n\n<p>I expect it to convert the string \"DD/MM/YYYY hh:mm:ss\" format into a date-time format that I can then convert into decimal format which I can then use for interpolating the values into a usable format. Instead I get no error message, and nothing happens.</p>\n\n<p>An example line of date timestamps from the raw CSV is: \n\"31/03/2019 14:55:57,1.0000000149,31/03/2019 14:55:57,14.6,31/03/2019 14:55:57,57.86,31/03/2019 14:55:57,0.175000000000068\"</p>\n\n<p>So the timestamp \"31/03/2019 14:55:57\" I want converting into \"43555.62218750000\"</p>\n\n<p>I could use a script to deconstruct the string, calculate the decimal equivalent, and overwrite the cell, but this will take a prohibitively long time.</p>\n"}, {"tags": ["vba", "ms-word", "hp-uft"], "comments": [{"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 1, "creation_date": 1559137283, "post_id": 56361871, "comment_id": 99327335, "body": "code provided seems to be not enough to answer your question, thus try to split your questions into parts, and describe details."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1559143124, "post_id": 56361871, "comment_id": 99330790, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/56361871/edit\">edit your question</a> to include more information.  I suspect that attacking the &quot;data goes away&quot; problem first may remove the need to worry about whether Word is on top."}, {"owner": {"reputation": 17, "user_id": 10863799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXSoYjRDR9Q/AAAAAAAAAAI/AAAAAAAAAUc/U2ezBDsx2kA/photo.jpg?sz=128", "display_name": "Patrick de la rosa", "link": "https://stackoverflow.com/users/10863799/patrick-de-la-rosa"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1559162041, "post_id": 56361871, "comment_id": 99339152, "body": "@cxw For some reason, the data set in the fields of the macro created in the Word document, gets deleted if the winword.exe application is not being displayed, thats what I meant."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1559182337, "post_id": 56361871, "comment_id": 99343933, "body": "Are you using <code>ActiveDocument</code> in your code, by any chance?  That changes depending on what is on top.  <code>Documents(&quot;Foo.docx&quot;)</code> does not have that problem."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 10863799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXSoYjRDR9Q/AAAAAAAAAAI/AAAAAAAAAUc/U2ezBDsx2kA/photo.jpg?sz=128", "display_name": "Patrick de la rosa", "link": "https://stackoverflow.com/users/10863799/patrick-de-la-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1559162138, "creation_date": 1559162138, "answer_id": 56368146, "question_id": 56361871, "link": "https://stackoverflow.com/questions/56361871/is-there-a-way-to-keep-word-using-vba-on-top-of-uft-while-is-running/56368146#56368146", "title": "Is there a way to keep Word using VBA on top of UFT while is running?", "body": "<p>To fix the deletion or removal of the data sent, I had to use the following:</p>\n\n<pre><code>Application.Activate()\n</code></pre>\n\n<p>So the focus is on the Word File</p>\n"}], "owner": {"reputation": 17, "user_id": 10863799, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXSoYjRDR9Q/AAAAAAAAAAI/AAAAAAAAAUc/U2ezBDsx2kA/photo.jpg?sz=128", "display_name": "Patrick de la rosa", "link": "https://stackoverflow.com/users/10863799/patrick-de-la-rosa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559242717, "creation_date": 1559136847, "last_edit_date": 1559242717, "question_id": 56361871, "link": "https://stackoverflow.com/questions/56361871/is-there-a-way-to-keep-word-using-vba-on-top-of-uft-while-is-running", "title": "Is there a way to keep Word using VBA on top of UFT while is running?", "body": "<p>I need to keep MS WORD on top of the applications, in this case HP UFT for my code to work properly, I don't know why, but this is the only way the macro I created does what it is supposed to. </p>\n\n<p>I created a function that calls the creation of a macro and fills the Word Document with the data sent in the call to the function, but this data is kept only when the Document is being shown, if the document is in the background the data goes away for some reason I don't know yet.</p>\n\n<p>I tried with some properties for the Application like :</p>\n\n<pre><code>   Application.Visible = True \n   Application.ScreenUpdating = True\n</code></pre>\n\n<p>But none of them worked, is this possible to achieve with UFT?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 11561158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcfab384fc6e33996160df3ad56d2e5?s=128&d=identicon&r=PG&f=1", "display_name": "Hippolyte BRINGER", "link": "https://stackoverflow.com/users/11561158/hippolyte-bringer"}, "is_accepted": false, "score": 1, "last_activity_date": 1559144280, "last_edit_date": 1559144280, "creation_date": 1559142482, "answer_id": 56363634, "question_id": 56361800, "link": "https://stackoverflow.com/questions/56361800/how-to-merge-dynamic-range-of-cells-in-one-specific-column/56363634#56363634", "title": "How to merge dynamic range of cells in one specific column?", "body": "<p>Could you show the code that you have already written?</p>\n\n<p>I think you have to use the function <code>Merge</code> in your range.</p>\n\n<p>The code below works great for me :</p>\n\n<pre><code>Sub merge()\n    Dim i As Integer\n    Dim i2 As Integer\n    Dim i3 As Integer\n    i = Range(\"B1\")\n    i2 = Range(\"B2\")\n    i3 = Range(\"B3\")\n    Range(\"A1:A\" &amp; i).merge\n    Range(\"A\" &amp; (i + 1) &amp; \":A\" &amp; (i + i2)).merge\n    Range(\"A\" &amp; (i + i2 + 1) &amp; \":A\" &amp; (i + i2 + i3)).merge\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11573160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213455964826193/picture?type=large", "display_name": "Yan Ni", "link": "https://stackoverflow.com/users/11573160/yan-ni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559144280, "creation_date": 1559136582, "last_edit_date": 1559141768, "question_id": 56361800, "link": "https://stackoverflow.com/questions/56361800/how-to-merge-dynamic-range-of-cells-in-one-specific-column", "title": "How to merge dynamic range of cells in one specific column?", "body": "<p>For e.g. I have three values (numbers) in cells B1, B2 and B3. These explain how many cells I should merge in column A. \nFor example B1 = 6, B2 =3 and B3 = 2  then I want to merge cell range A16 to A22 (16+6), then A23 to A26 should be a new merged range and the last merged range should be A27 to A29.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1559144733, "post_id": 56361690, "comment_id": 99331717, "body": "What is \u201ewhisper\u201c and what kind of shape are you talking about? Might a screenshot explain it?"}, {"owner": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1559208985, "post_id": 56361690, "comment_id": 99352279, "body": "&quot;whisper&quot; is function when you use mail adress once or you have adress already in contact list. So you dont type email but few letters and outlook pick rest of."}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "edited": false, "score": 0, "creation_date": 1559208787, "post_id": 56365846, "comment_id": 99352195, "body": "thank you for answer, can you pls add you type of code to mine ? im lost."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "edited": false, "score": 0, "creation_date": 1559229731, "post_id": 56365846, "comment_id": 99362462, "body": "What exactly are you having problems with? Looping through recipients? Accessing the Address and Type properties? Or something else?"}, {"owner": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "edited": false, "score": 0, "creation_date": 1559282193, "post_id": 56365846, "comment_id": 99378012, "body": "problem is how to everything put to my code, how declare MailItem.Recipients with Recipients.Adress and how use olTo."}, {"owner": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "edited": false, "score": 0, "creation_date": 1559284309, "post_id": 56365846, "comment_id": 99378682, "body": "declare Dim recip As Outlook.MailItem ?"}, {"owner": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "edited": false, "score": 0, "creation_date": 1559287041, "post_id": 56365846, "comment_id": 99379789, "body": "it doesnt work, object .To is blank and saved as draft"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "edited": false, "score": 0, "creation_date": 1559310793, "post_id": 56365846, "comment_id": 99391265, "body": "Outlook.Recipient. What does not work? Are you getting an error?"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1559283465, "last_edit_date": 1559283465, "creation_date": 1559151288, "answer_id": 56365846, "question_id": 56361690, "link": "https://stackoverflow.com/questions/56361690/pick-mail-from-to/56365846#56365846", "title": "Pick mail from .To", "body": "<p>Do not use the <code>To</code> / <code>CC</code> / <code>BCC</code> properties - they, generally, include only the display names, not email addresses.</p>\n\n<p>Loop through all recipients in the <code>MailItem.Recipients</code> collection and use the <code>Recipient.Address</code> property - keep in mind you might have an EX type address, nit SMTP in case of Exchange, you might have to use <code>Recipient.AddressEntry.GetExchangeUser().PrimarySmtpAddress</code> (<code>GetExchangeUser</code> will return null for the non-Exchange address entries). </p>\n\n<p>The recipient kind (<code>olTo</code> / <code>olCC</code> / <code>olBCC</code>) is stored in the <code>Recipient.Type</code> property. </p>\n\n<pre><code>   dim recip, newRecip\n   ...\n   With objNewMail1\n        for each recip in objMail.Recipients\n          set newRecip = .Recipients.Add(recip.Address)\n          newRecip.Type = recip.Type \n        next\n        .Send\n    End With\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 3681759, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f5d250fad7448b6ef7399ac7230c872?s=128&d=identicon&r=PG&f=1", "display_name": "novice", "link": "https://stackoverflow.com/users/3681759/novice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 56365846, "answer_count": 1, "score": 1, "last_activity_date": 1591659396, "creation_date": 1559136204, "last_edit_date": 1591659396, "question_id": 56361690, "link": "https://stackoverflow.com/questions/56361690/pick-mail-from-to", "title": "Pick mail from .To", "body": "<p>My VBA code will take the email address from the <code>.To</code> property, and send another email.</p>\n\n<p>When the address is in \"whisper\" and it has a shape instead of john.smith@email.dot but John Smith the <code>.To</code> is empty for VBA code.</p>\n\n<p>Is it possible to bypass it?</p>\n\n<pre><code>Dim objMail As Outlook.MailItem\nDim objNewMail1 As Outlook.MailItem    \nDim strTo As String\n\nstrTo = objMail.To\n\nSet objNewMail1 = Application.CreateItem(olMailItem)\n\nWith objNewMail1\n    .To = strTo\n    .Send\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 116, "user_id": 10969038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c239e8f5d55119ec56aff4f424065e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Eedz", "link": "https://stackoverflow.com/users/10969038/eedz"}, "edited": false, "score": 0, "creation_date": 1559136210, "post_id": 56360737, "comment_id": 99326662, "body": "Your Find object is attached to the Selection object, but you haven&#39;t yet selected anything. Try setting your Selection object to the area of text that you want to search."}, {"owner": {"reputation": 23, "user_id": 11504889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406c59451f72a24207cf10c9a34d718a?s=128&d=identicon&r=PG&f=1", "display_name": "ecksdee", "link": "https://stackoverflow.com/users/11504889/ecksdee"}, "reply_to_user": {"reputation": 116, "user_id": 10969038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c239e8f5d55119ec56aff4f424065e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Eedz", "link": "https://stackoverflow.com/users/10969038/eedz"}, "edited": false, "score": 0, "creation_date": 1559137060, "post_id": 56360737, "comment_id": 99327199, "body": "Isn&#39;t it selecting the inputted text in my first example?"}, {"owner": {"reputation": 116, "user_id": 10969038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c239e8f5d55119ec56aff4f424065e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Eedz", "link": "https://stackoverflow.com/users/10969038/eedz"}, "edited": false, "score": 0, "creation_date": 1559137125, "post_id": 56360737, "comment_id": 99327237, "body": "Do you have the correct number of spaces between the 1. and the SSS ?"}, {"owner": {"reputation": 673, "user_id": 11409399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bM0MF.png?s=128&g=1", "display_name": "Van Ng", "link": "https://stackoverflow.com/users/11409399/van-ng"}, "edited": false, "score": 0, "creation_date": 1559137398, "post_id": 56360737, "comment_id": 99327402, "body": "I think <code>1.  SSS </code> in document can be a list in Word, so it contains Tab symbol, has own formatting and so on"}, {"owner": {"reputation": 23, "user_id": 11504889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406c59451f72a24207cf10c9a34d718a?s=128&d=identicon&r=PG&f=1", "display_name": "ecksdee", "link": "https://stackoverflow.com/users/11504889/ecksdee"}, "edited": false, "score": 0, "creation_date": 1559137702, "post_id": 56360737, "comment_id": 99327604, "body": "I believe so, I can&#39;t even find the string &quot;1.&quot;. I think that numbering (the bulleting) isn&#39;t something I input as plain text for the find method."}], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1559149151, "post_id": 56362327, "comment_id": 99333898, "body": "This &quot;Answer&quot; is of low quality as it doesn&#39;t contribute anything new - it just repeats a small part of what Rich wrote. While Stack Overflow does allow people to answer their own questions, there&#39;s no value in repeating part of a much better contribution."}, {"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1559152854, "post_id": 56362327, "comment_id": 99335487, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/23142570\">From Review</a>"}, {"owner": {"reputation": 23, "user_id": 11504889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406c59451f72a24207cf10c9a34d718a?s=128&d=identicon&r=PG&f=1", "display_name": "ecksdee", "link": "https://stackoverflow.com/users/11504889/ecksdee"}, "reply_to_user": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1559230959, "post_id": 56362327, "comment_id": 99363174, "body": "Thanks @Taplar, I&#39;ll do better."}, {"owner": {"reputation": 23, "user_id": 11504889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406c59451f72a24207cf10c9a34d718a?s=128&d=identicon&r=PG&f=1", "display_name": "ecksdee", "link": "https://stackoverflow.com/users/11504889/ecksdee"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1559230989, "post_id": 56362327, "comment_id": 99363192, "body": "And sorry @Cindy, I posted that before Rich and didn&#39;t intend to detract from his response."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1559236879, "post_id": 56362327, "comment_id": 99365942, "body": "@ecksdee Ah, I couldn&#39;t see that from the time stamps. Sorry!"}], "tags": [], "owner": {"reputation": 23, "user_id": 11504889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406c59451f72a24207cf10c9a34d718a?s=128&d=identicon&r=PG&f=1", "display_name": "ecksdee", "link": "https://stackoverflow.com/users/11504889/ecksdee"}, "is_accepted": false, "score": -1, "last_activity_date": 1559138248, "creation_date": 1559138248, "answer_id": 56362327, "question_id": 56360737, "link": "https://stackoverflow.com/questions/56360737/how-to-detect-numbering-in-simple-vba-string-replacement/56362327#56362327", "title": "How to detect numbering in simple vba string replacement", "body": "<p>Numbering is a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Word.listparagraphs\" rel=\"nofollow noreferrer\">ListParagraphs</a> Object and can't be searched as if it's plain text.</p>\n"}, {"tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": true, "score": 2, "last_activity_date": 1559139116, "creation_date": 1559139116, "answer_id": 56362597, "question_id": 56360737, "link": "https://stackoverflow.com/questions/56360737/how-to-detect-numbering-in-simple-vba-string-replacement/56362597#56362597", "title": "How to detect numbering in simple vba string replacement", "body": "<p>You are not finding the number associated with the paragraph text because it most likely is a ListLevelNumber and these are automatically generated by the ListFormat style. In other words, they are not part of the physical text that can be found using a Search, at least the way you currently have it setup in your code.</p>\n\n<p>A separate Search would be required to find the ListParagraph Style being used and then some additional code that would manipulate the ListLevelNumber if that is what you are attempting to do. </p>\n\n<p>Below is example code that determines what the ListLevelNumber is on a given paragraph and then takes some action based on what the level actually is:</p>\n\n<pre><code>Sub IsSelectionListParagraph()\n    Dim i As Integer\n    If Selection.Range.ListParagraphs.Count &gt; 0 Then\n        For i = 1 To Selection.Range.ListParagraphs.Count\n            Select Case Selection.Range.ListParagraphs(i).Range.ListFormat.ListLevelNumber\n                Case Is = 1\n                    Debug.Print Selection.Range.Text\n                Case Is = 2\n                    Debug.Print Selection.Range.Text\n                Case Else\n                    Debug.Print Selection.Range.Text\n            End Select\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11504889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406c59451f72a24207cf10c9a34d718a?s=128&d=identicon&r=PG&f=1", "display_name": "ecksdee", "link": "https://stackoverflow.com/users/11504889/ecksdee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 56362597, "answer_count": 2, "score": 1, "last_activity_date": 1559148753, "creation_date": 1559133149, "last_edit_date": 1559148753, "question_id": 56360737, "link": "https://stackoverflow.com/questions/56360737/how-to-detect-numbering-in-simple-vba-string-replacement", "title": "How to detect numbering in simple vba string replacement", "body": "<p>I'm trying to replace numbering (Word's 1. , 2. , etc.). In a simple string and replace search but I can't seem to find the numbers.</p>\n\n<p>This is for Word 365, and I'm using the VB editor in there.</p>\n\n<pre><code>Sub ayaya()\nDocuments.Open FileName:=ActiveDocument.Path + \"\\Doc1.docm\"\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n    .Text = \"SSS\"\n    .Replacement.Text = \"PPP\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\nWith Selection\n    If .Find.Forward = True Then\n        .Collapse Direction:=wdCollapseStart\n    Else\n        .Collapse Direction:=wdCollapseEnd\n    End If\n    .Find.Execute Replace:=wdReplaceAll\nEnd With\n\nEnd Sub\n\n</code></pre>\n\n<p>My word document looked like this: </p>\n\n<pre><code>SSS\nSSS\n1.  SSS \n</code></pre>\n\n<p>and turned to </p>\n\n<pre><code>PPP\nPPP\n1.  PPP\n</code></pre>\n\n<p>but when I replace the search to any variation of </p>\n\n<pre><code>With Selection.Find\n    .Text = \"1. SSS\"\n</code></pre>\n\n<p>It does not find the text.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1559137840, "creation_date": 1559137840, "answer_id": 56362192, "question_id": 56360662, "link": "https://stackoverflow.com/questions/56360662/paste-table-from-email-body-to-an-excel-sheet/56362192#56362192", "title": "Paste table from Email body to an Excel sheet", "body": "<p>You can address and copy the table within the email's body by this:</p>\n\n<pre><code>OutlookMail.GetInspector.WordEditor.Range.Tables(1).Range.Copy\n</code></pre>\n\n<p>and then you paste it e. g. as values into your <code>Excel.Range</code>: </p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Sheet2\")\n    .Range(\"A1\").PasteSpecial xlPasteValues \n</code></pre>\n\n<p>If you want to paste in a different clipboard-supported format, try to get the ideal format with Excel's macro recorder. It results in something like this:</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Sheet2\")\n    .Range(\"A1\").Select\n    .PasteSpecial Format:=\"Text\"   ' or \"HTML\" or ...\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 56362192, "answer_count": 1, "score": 1, "last_activity_date": 1562379160, "creation_date": 1559132927, "last_edit_date": 1562379160, "question_id": 56360662, "link": "https://stackoverflow.com/questions/56360662/paste-table-from-email-body-to-an-excel-sheet", "title": "Paste table from Email body to an Excel sheet", "body": "<p>I want the sender and the body of my mail pasted in my Excel file.</p>\n\n<p>I have reached as far as pasting the sender but when the body, which is a table is pasted, it destroys the format since it pastes in one cell.</p>\n\n<p>How to paste the table inside my email next to the sender?</p>\n\n<p>I think the code for pasting a table should start at the comment: 'Paste the table inside the email body here.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim OutlookApp As Outlook.Application\n    Dim OutlookNamespace As Namespace\n    Dim Folder As MAPIFolder\n    Dim OutlookMail As Variant\n    Dim i As Integer\n\n    Set OutlookApp = New Outlook.Application\n    Set OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\n    Set Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"ABV\")\n\n    i = 2\n\n    With ThisWorkbook.Sheets(\"Sheet2\")\n        For Each OutlookMail In Folder.Items\n            If OutlookMail.ReceivedTime &gt;= .Range(\"C1\") Then\n                With .Cells(i, 1)\n                    .Value = OutlookMail.SenderName\n                    .Columns.AutoFit\n                    .VerticalAlignment = xlTop\n                End With\n                With .Cells(i, 2)\n                    'Paste the table inside the email body here\n                End With\n                i = i + 1\n            End If\n        Next OutlookMail\n    End With\n\n    Set Folder = Nothing\n    Set OutlookNamespace = Nothing\n    Set OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>All the emails in this folder will contain a table, so I would like to loop as every sender and its table gets pasted.</p>\n"}, {"tags": ["excel", "vba", "compiler-errors", "watch"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "edited": false, "score": 0, "creation_date": 1559132685, "post_id": 56360469, "comment_id": 99324440, "body": "Are you saying that the part (.Rows.Count - 1, .Columns.Count -  1) is&#39;nt possible to execute in the immediate window? Do I have to specify it as fixed numbers?"}, {"owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "edited": false, "score": 0, "creation_date": 1559133565, "post_id": 56360469, "comment_id": 99325000, "body": "I&#39;m just inteterested to know why I&#39;m getting an error with the code I&#39;m using. The code is from an online course so I know it works, but in the course they are using a variable range and looks like this:  shAll.Range(&quot;A1:I&quot; &amp; LastRow)Offset(1).Resize(.Rows.Count - 1, .Columns.Count - 1).SpecialCells(xlCellTypeVisible).Copy. I just want to test the code in the immediate window using a fixed range instead."}], "tags": [], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "is_accepted": false, "score": 0, "last_activity_date": 1559132317, "creation_date": 1559132317, "answer_id": 56360469, "question_id": 56360357, "link": "https://stackoverflow.com/questions/56360357/vba-excel-execute-code-that-offsets-resizes-a-range-then-copies-it-compi/56360469#56360469", "title": "VBA, Excel. Execute code that offsets &amp; resizes a range &amp; then copies it. &quot;Compile error: Invalid watch expression&quot;", "body": "<p>You can do a name range or put the actual range that you need. </p>\n\n<pre><code>Worksheets(\"Sheet\").Range(\"namedrange_d\").Resize(, 4).Offset(6, 0).Copy _\n  Worksheets(\"Sheet1\").Range(\"namedrange\").Resize(, 4).Offset(6, 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "edited": false, "score": 0, "creation_date": 1559150634, "post_id": 56361091, "comment_id": 99334598, "body": "This is it, now it works! :) And you really taught me a very useful insight today. An object needs to be specified and can be done in the ways you described. Thank you very much Gareth!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 0, "last_activity_date": 1559134192, "creation_date": 1559134192, "answer_id": 56361091, "question_id": 56360357, "link": "https://stackoverflow.com/questions/56360357/vba-excel-execute-code-that-offsets-resizes-a-range-then-copies-it-compi/56361091#56361091", "title": "VBA, Excel. Execute code that offsets &amp; resizes a range &amp; then copies it. &quot;Compile error: Invalid watch expression&quot;", "body": "<p>You have not specified which object <code>.Rows</code> and <code>.Columns</code> apply to.</p>\n\n<p>If they apply to the range then</p>\n\n<pre><code>With shAll.Range(\"A1:I78\")\n    .Offset(1).Resize(.Rows.Count - 1, .Columns.Count - 1).SpecialCells(xlCellTypeVisible).copy\nEnd with\n</code></pre>\n\n<p>or</p>\n\n<pre><code>shAll.Range(\"A1:I78\").Offset(1).Resize(shAll.Range(\"A1:I78\").Rows.Count - 1, _\nshAll.Range(\"A1:I78\").Columns.Count - 1).SpecialCells(xlCellTypeVisible).copy\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11345103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I2fp7SHvo7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVSizPPdub2uoLMBWsI0GSrHzj-w/mo/photo.jpg?sz=128", "display_name": "SweDentan", "link": "https://stackoverflow.com/users/11345103/swedentan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56361091, "answer_count": 2, "score": 0, "last_activity_date": 1559134192, "creation_date": 1559131963, "last_edit_date": 1559132294, "question_id": 56360357, "link": "https://stackoverflow.com/questions/56360357/vba-excel-execute-code-that-offsets-resizes-a-range-then-copies-it-compi", "title": "VBA, Excel. Execute code that offsets &amp; resizes a range &amp; then copies it. &quot;Compile error: Invalid watch expression&quot;", "body": "<p>I'm trying to offset,resize and copy a range containing data and is typing this line of code in the immediate window:</p>\n\n<pre><code>shAll.Range(\"A1:I78\").Offset(1).Resize(.Rows.Count - 1, .Columns.Count - \n1).SpecialCells(xlCellTypeVisible).copy\n</code></pre>\n\n<p>When I press enter I get this error: \"Compile error: Invalid watch expression\"</p>\n\n<p>Is it a syntax issue?</p>\n\n<p>This part of the code it working fine when executed in the immediate window:</p>\n\n<pre><code>shAll.Range(\"A1:I78\").Offset(1).select\n</code></pre>\n\n<p>It's getting offseted the way I want. The remaining part is to resize and copy it.</p>\n\n<p>By the way, the range <code>shAll.Range(\"A1:I78\")</code> contains data in all cells.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1559131015, "post_id": 56360050, "comment_id": 99323428, "body": "Rather than a string as you suggest, have you tried defining the workbook as a workbook object?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9905145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Omz6H.jpg?s=128&g=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/9905145/harry"}, "edited": false, "score": 0, "creation_date": 1559132450, "post_id": 56360194, "comment_id": 99324268, "body": "Thanks a lot! That worked. There was a typo just after &#39;before:=&#39; and got an error on the same line. :D But it is great now."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": true, "score": 1, "last_activity_date": 1559132139, "last_edit_date": 1559132139, "creation_date": 1559131363, "answer_id": 56360194, "question_id": 56360050, "link": "https://stackoverflow.com/questions/56360050/cannot-copy-sheet-to-another-workbook/56360194#56360194", "title": "Cannot copy sheet to another workbook", "body": "<p>I would use workbook objects to keep the two files clear:</p>\n\n<pre><code>Sub something()\n\n    Dim wb_from As Workbook, wb_to As Workbook\n    Set wb_to = ActiveWorkbook\n    Workbooks.Open Filename:=\"C:\\\\\\\\Layout.xlsx\"\n    Set wb_from = Workbooks(\"Layout.xlsx\")\n    wb_from.Sheets(\"Pivot\").Copy Before:=wb_to.Sheets(\"Main List\")\n    wb_from.Close SaveChanges:=False\nend sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9905145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Omz6H.jpg?s=128&g=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/9905145/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 56360194, "answer_count": 1, "score": 0, "last_activity_date": 1559132139, "creation_date": 1559130943, "question_id": 56360050, "link": "https://stackoverflow.com/questions/56360050/cannot-copy-sheet-to-another-workbook", "title": "Cannot copy sheet to another workbook", "body": "<p>I have what it seems a small issue but cannot figure out how to solve.\nSo, every week I have to make a bunch of pivot tables to summarize raw data that I am getting. I figured, it would be much easier if I create all the tables into a Layout file and then just copy them to the new file and then change the source. And I wrote the following code: </p>\n\n<pre><code>Sub something()\n\nWorkbooks.Open Filename:=\"C:\\\\\\\\Layout.xlsx\"\nWith Workbooks(\"Layout.xlsx\")\n    .Sheets(\"Pivot\").Copy Before:=ActiveWorkbook.Sheets(\"Main List\")\n    .Close savechanges:=False\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>This code works just fine. The issue comes when I try to paste the code into my personal workbook and then run through VBA directly, rather than copying and pasting it every time. </p>\n\n<p>What I could do is, to change the code from 'Activeworkbook' to the name of my new workbook but its name change every week, because it is based on a date. \nI already tried to declare the name of the new workbook as a string and call it through that but that didn't work either. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1559132959, "post_id": 56360037, "comment_id": 99324609, "body": "Check the name of the sheet &quot;ECs full&quot; to make sure it doesn&#39;t have a trailing space at the end (i.e. &quot;ECs full &quot;)."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 1, "last_activity_date": 1559140489, "creation_date": 1559140489, "answer_id": 56363057, "question_id": 56360037, "link": "https://stackoverflow.com/questions/56360037/vba-excel-code-does-not-read-a-third-worksheet/56363057#56363057", "title": "Vba Excel Code does not read a third worksheet", "body": "<p>It took me a while to see this</p>\n\n<pre><code>Dim shECF As Worksheet\n</code></pre>\n\n<p>(Not Worksheet<strong>s</strong>)</p>\n"}], "owner": {"reputation": 11, "user_id": 11345763, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Nn_W_SHdKNU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reuhbOgB19npAZJmZjNhnbsbzAfDg/mo/photo.jpg?sz=128", "display_name": "otr_91", "link": "https://stackoverflow.com/users/11345763/otr-91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559151880, "creation_date": 1559130881, "last_edit_date": 1559151880, "question_id": 56360037, "link": "https://stackoverflow.com/questions/56360037/vba-excel-code-does-not-read-a-third-worksheet", "title": "Vba Excel Code does not read a third worksheet", "body": "<p>I'm working with two workbooks, both with different sheets. The code is writen for the Workbook called \"Rober.xslm\" and in the following macro I open another workbook (\"Formato permisos.xlsm\") and read values in some sheets to work with them in my original workbook. Firstly I managed to read the values from the sheet \"Requisitos contenedor + ATI\" in the workbook \"Formato permisos.xlsm\" and work with then in my sheet \"Seleccion_ECs\" from \"Rober.xlsm\". </p>\n\n<p>The problem comes when I select, or activate, or open the sheet \"ECs full\" from the workbook \"Rober.xlsm\". I don't understand why this statement:\nSet shECF=wbDest.Worksheets(\"ECs full\")\nreturns Nothing if I also have this one:\nSet shrelacion=wbDest.Worksheets(\"Relaci\u00f3n ciclo y fechas\")\nand it works with it! The name ECs full is well written. It's a normal sheet, not a chartsheet.</p>\n\n<pre><code>Set wbSource = Workbooks.Open(sFileName)\n\nDebug.Print (wbSource.Name) '\"Formato permisos.xlsm\"\n\nIf Err.Number &lt;&gt; 0 Then Debug.Print (\"Error number en Libro gr\u00e1ficas: \" &amp; Err.Number)\n\nIf Err.Number = 0 Then Debug.Print (\"No ha habido error en libro gr\u00e1ficas\")\n\nSet Requisitos = wbSource.Worksheets(\"Requisitos Contenedor + ATI\")\n\nSet QvsE = Workbooks.Open(sFileName) 'wbSource.Charts(\"Curva - QvsE\")\n\nSet wbDest = ThisWorkbook 'Workbooks(\"Rober.xlsm\")\n\nDebug.Print (wbDest.Name) '\"Rober.xlsm\"\n\nIf Err.Number &lt;&gt; 0 Then Debug.Print (\"Error number en Libro Rober: \" &amp; Err.Number)\n\nSet shEC = wbDest.Worksheets(\"Seleccion_ECs\")\n\nIf Err.Number &lt;&gt; 0 Then Debug.Print (\"Error number en hoja Seleccion_ECs: \" &amp; Err.Number)\n\nim fechaActual As Variant, fechaEOC As Date\n\nDim shECF As Worksheets, rangoECF As Range\n\nDim nFilasECF As Double, nColumECF As Double, a\u00f1os As Double\n\nSet shECF = wbDest.Worksheets(\"ECs full\")\n\n'wbDest.Sheets(\"ECs_full\").Activate --These are some thigs I tried\n\n'wbDest.Sheets(\"ECs_full\").Select\n\n\nIf Err.Number &lt;&gt; 0 Then Debug.Print (\"Error al seleccionar hoja ECs full: \" &amp; Err.Number)\n\nMsgBox ThisWorkbook.Path &amp; vbNewLine &amp; ThisWorkbook.Name 'Archivo Rober\n\nSet rangoECF = Sheets(\"ECs full\").UsedRange\n\n    nFilasECF = rangoECF.Rows.Count\n\n    nColumECF = rangoECF.Columns.Count\n\nSet shrelacion = wbDest.Worksheets(\"Relaci\u00f3n ciclo y fechas\")\n\nFor g = 1 To nColumECF\n\n    If shECF.Cells(1, g) = \"\u00faltimo ciclo de operaci\u00f3n\" Then\n\n        C = shECF.Cells(1, g).Column 'Don't manage to get this value since I can't read the sheet \"ECs full\"\n\n    End If\n\nNext g\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559130939, "post_id": 56360001, "comment_id": 99323373, "body": "Do you expect the change to happen when you change the cell or when you change the cell and re-run the code?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1559130999, "post_id": 56360001, "comment_id": 99323418, "body": "What is the point of <code>Sub ColorIf</code>? It has no executable statements. In any event, changing a cell color does not trigger a worksheet calculation, which might be your issue."}, {"owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559135391, "post_id": 56360001, "comment_id": 99326126, "body": "@ Gareth - I do expect a change when the cell changes without having to re-run the code, like a standard Excel formulae I suppose"}, {"owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559135473, "post_id": 56360001, "comment_id": 99326170, "body": "@ John, My mistake, I put this in by mistake, or at least forgot to remove this sub. So I need to trigger a worksheet calculation? I&#39;ll look into this, thank you"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559135341, "post_id": 56360388, "comment_id": 99326096, "body": "Thank you John for the comment, I&#39;ll try playing with this code, see what happens and report back."}, {"owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559136341, "post_id": 56360388, "comment_id": 99326741, "body": "Hi John, that worked perfectly. I added the WorkSheet_SelectionChange sub to the worksheet and updated the module code and now everything works as expected !!!"}, {"owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559302610, "post_id": 56360388, "comment_id": 99387257, "body": "@ John, I regret with this solution copy and paste no longer works?!? I select a cell to copy, move to antoher cell and now Paste is not available? Any advice would be appreciated :-)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559304756, "post_id": 56360388, "comment_id": 99388217, "body": "@MarkHutchins Good question. See the edit. Note that with the edit if you both change the color of a cell and then immediately copy it, the function won&#39;t be recalculated until after the paste."}, {"owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559306862, "post_id": 56360388, "comment_id": 99389298, "body": "thanks for the update John. I did try If Application.CutCopyMode = False which worked, but then had Excel crashing when trying to &#39;undo&#39; or Ctrl+Z!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559307814, "post_id": 56360388, "comment_id": 99389750, "body": "@MarkHutchins I don&#39;t get any crashes when I use undo or ctrl+Z with the code as changed. Something else is going on with your code."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559308836, "post_id": 56360388, "comment_id": 99390257, "body": "@MarkHutchins One possible idea is to ditch <code>CountColorIf()</code> and <code>Me.Calculate</code> entirely and move the logic of counting the colored cells and updating the count to the <code>SelectionChange</code> event itself. That would work easily if you have only a single cell containing <code>=CountColorIf()</code> and the ranges which you feed to that function are fixed. <code>SelectionChange</code> could just update the value of that one cell."}, {"owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "edited": false, "score": 0, "creation_date": 1559311272, "post_id": 56360388, "comment_id": 99391535, "body": "thanks John. Unfortunately we have more than one cell with more than one more than one reference cell and range. I will propose to the user who has requested this to find another way to format the cells that would be easier to count with standard functions, such as CountIf etc. Thanks again for all your help"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1559304607, "last_edit_date": 1559304607, "creation_date": 1559132049, "answer_id": 56360388, "question_id": 56360001, "link": "https://stackoverflow.com/questions/56360001/excel-counting-by-colour-vba-not-updating-with-changes/56360388#56360388", "title": "Excel counting by colour VBA not updating with changes?", "body": "<p>Unfortunately, it doesn't seem that a format change triggers any of the standard Excel event handlers. Something which comes close would be to target the Worksheet's Selection Change event. In the code module for the worksheet put:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Me.Calculate\nEnd Sub\n</code></pre>\n\n<p>Then change the definition of <code>CountColorIf</code> so that it begins:</p>\n\n<pre><code>Function CountColorIf(rSample As Range, rArea As Range) As Long\n    Application.Volatile \n</code></pre>\n\n<p>Then, if a color of a cell is changed, the count is updated -- as soon as you move to a different cell.</p>\n\n<p>Another idea would be to use <code>Application.OnTime</code> to run a sub which triggers a recount every few seconds, but this would still not lead to instant updates as soon as you change a color.</p>\n\n<p><strong>On Edit</strong> Since there is no <code>FormatChange</code> event that you can target, using <code>SelectionChange</code> as a proxy for it is not ideal. One problem, that you noted in the comments, is that this will fire in the middle of a copy-paste act, in which case the resulting worksheet calculation will get Excel out of copy-paste mode. One fix for that particular problem is to change the code to: </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Application.CutCopyMode = 0 Then Me.Calculate\nEnd Sub\n</code></pre>\n\n<p>If this code is for your own personal use, a simple solution is to keep <code>Application.Volatile</code> but get rid of the event handler entirely, getting into the habit of hitting <code>F9</code> when you change the color of a cell. That would limit the recalculations to when you want them, at the cost of required action on your part.</p>\n"}], "owner": {"reputation": 23, "user_id": 8714026, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155766486496170/picture?type=large", "display_name": "Mark Hutchins", "link": "https://stackoverflow.com/users/8714026/mark-hutchins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 56360388, "answer_count": 1, "score": 2, "last_activity_date": 1559304607, "creation_date": 1559130782, "last_edit_date": 1559143695, "question_id": 56360001, "link": "https://stackoverflow.com/questions/56360001/excel-counting-by-colour-vba-not-updating-with-changes", "title": "Excel counting by colour VBA not updating with changes?", "body": "<p>I have some VBA in Excel that counts if a range of cells contains a colour from a reference cell, which works well. But changing the colour of any cell in the range does not update the total counted.</p>\n\n<p>Ideally, I want the code to update the number of coloured cells that match the reference, and when the cell colours are changed, to update the sum counted.</p>\n\n<p>I have tried adding an Else statement in the If statement so that if a cell is 'blank' or had its colour 'cleared' using the paint pot button for filling cells, it would deduct a number, but this failed to work.</p>\n\n<pre><code>Sub Colourif()\nEnd Sub\n\nFunction CountColorIf(rSample As Range, rArea As Range) As Long\n    Dim rAreaCell As Range\n    Dim lMatchColor As Long\n    Dim lCounter As Long\n\n    lMatchColor = rSample.Interior.Color\n\n    For Each rAreaCell In rArea\n        If rAreaCell.Interior.Color = lMatchColor Then\n            lCounter = lCounter + 1\n        End If\n    Next rAreaCell\n\n    CountColorIf = lCounter\nEnd Function\n</code></pre>\n\n<p>If I change a cell in the range fill using the paint pot icon to say 'clear' it does not change the count of cells filled with the reference colour.</p>\n\n<p>I would be extremely grateful for some advice on how to ensure this code automatically updates the sum when cell fills are changed from the reference colour.</p>\n"}, {"tags": ["excel", "vba", "validation", "office365", "conditional-formatting"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559130207, "post_id": 56359644, "comment_id": 99322956, "body": "My approach would be using dictionaries. 1 dictionary adds the sheet 2 data, Each name with all their atributes (Name | Atributie1, Atribute2, Atribute3,...) and then loop through the master sheet data and check if the atribute exists on the dictionary, if not, highlight that name on sheet2."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559138120, "post_id": 56359644, "comment_id": 99327897, "body": "Welcome to SO. Would work for you a non VBA solution that highlights name and Attribute in Sheet1 instead of in Sheet2? It would highlight your left dataset (Sally, Happy) instead of highlighting in the right dataset"}, {"owner": {"reputation": 133, "user_id": 6793852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7D1B.jpg?s=128&g=1", "display_name": "Jonathan R Swift", "link": "https://stackoverflow.com/users/6793852/jonathan-r-swift"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559138245, "post_id": 56359644, "comment_id": 99327974, "body": "Hi @FoxfireAndBurnsAndBurns - Yes, I&#39;d be very interested to see that! I could adjust the user instructions to make that work!"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 6793852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7D1B.jpg?s=128&g=1", "display_name": "Jonathan R Swift", "link": "https://stackoverflow.com/users/6793852/jonathan-r-swift"}, "edited": false, "score": 0, "creation_date": 1559146710, "post_id": 56362751, "comment_id": 99332743, "body": "Thanks! I&#39;ve posted my own answer below building on your work here - I&#39;m delighted to have a VBA-free solution."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1559139548, "creation_date": 1559139548, "answer_id": 56362751, "question_id": 56359644, "link": "https://stackoverflow.com/questions/56359644/highlighting-missing-unique-pairs-when-compared-to-master-list-excel/56362751#56362751", "title": "Highlighting missing unique pairs when compared to master list - Excel", "body": "<p>Well, you want to highlight value <code>Sally, Happy</code> if that value does not appear in Sheet2, so you just need a COUNTIFS</p>\n\n<blockquote>\n  <p><strong><a href=\"https://support.office.com/en-ie/article/countifs-function-dda3dc6e-f74e-4aee-88bc-aa8c2a866842\" rel=\"nofollow noreferrer\">COUNTIFS function</a></strong></p>\n</blockquote>\n\n<p>I've got this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CeNvw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CeNvw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I've used a Conditional Formatin Rule based on my own formula. The formula I've used is:</p>\n\n<pre><code>=IF($B2=\"\";IF(COUNTIFS($F$2:$F$12;$A2;$G$2:$G$12;\"\")=0;TRUE;FALSE);IF(COUNTIFS($F$2:$F$12;$A2;$G$2:$G$12;$B2)=0;TRUE;FALSE))\n</code></pre>\n\n<p>There are 2 COUNTIFS, because blank values are possible:</p>\n\n<ol>\n<li><code>IF(COUNTIFS($F$2:$F$12;$A2;$G$2:$G$12;\"\")=0;TRUE;FALSE)</code> will count how many rows got same name and non blank attributes in Sheet2. If 0, then it will return <code>True</code> and highlight row.</li>\n<li><code>IF(COUNTIFS($F$2:$F$12;$A2;$G$2:$G$12;$B2)=0;TRUE;FALSE)</code> will count how many rows got same name and blank attributes. If 0, then it will return <code>True</code> and will highlight</li>\n</ol>\n\n<p>With the initial IF you can blanks or non blanks attributes, just to make sure you count all posibilities of values.</p>\n\n<p>I've uploaded a sample to mi Gdrive in case you want to download and get the formulas autotranslated opening at your PC.</p>\n\n<p><a href=\"https://drive.google.com/open?id=1Im4LoaK4EIvINBj7tfyEcYk9juWUp7zr\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1Im4LoaK4EIvINBj7tfyEcYk9juWUp7zr</a></p>\n\n<p>Hope you can adapt this to your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 6793852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7D1B.jpg?s=128&g=1", "display_name": "Jonathan R Swift", "link": "https://stackoverflow.com/users/6793852/jonathan-r-swift"}, "is_accepted": false, "score": 1, "last_activity_date": 1559146656, "creation_date": 1559146656, "answer_id": 56364775, "question_id": 56359644, "link": "https://stackoverflow.com/questions/56359644/highlighting-missing-unique-pairs-when-compared-to-master-list-excel/56364775#56364775", "title": "Highlighting missing unique pairs when compared to master list - Excel", "body": "<p><a href=\"https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns\">@Foxfire And Burns And Burns</a> helped me to solve my problem - I have modified his formulae slightly, to remove the double <code>COUNTIFS</code>, and to account for rows in the master data where both cells are blank - below is what I used.</p>\n\n<pre><code>=IF (OR($A2&lt;&gt;\"\",$B2&lt;&gt;\"\"),\n        (IF(COUNTIFS($D$2:$D$12,$A2,$E$2:$E$12,IF($B2=\"\",\"\",$B2))=0,TRUE,FALSE)\n        )\n    )\n</code></pre>\n\n<p>This works by returning <code>TRUE</code> or <code>FALSE</code> from the following logical checks - if the final result is <code>TRUE</code>, then the formatting appears.</p>\n\n<ol>\n<li><code>OR($A2&lt;&gt;\"\",$B2&lt;&gt;\"\")</code> - Checks is either of the cells in the master are <em>not</em> blank. - If both cells are blank, this returns <code>FALSE</code>, and does not format anything (see <code>A10:B10</code>).</li>\n<li><code>IF(COUNTIFS($D$2:$D$12,$A2,$E$2:$E$12,[see point 3])&lt;1,TRUE,FALSE)</code> - This counts the number of times that <em>both</em> the range <code>$D$2:$D$12</code> contains the value of cell <code>$A2</code>, AND the range <code>$E$2:$E$12</code> contains the value of cell <code>$B2</code>. If that number is <code>&lt;1</code>, (zero matches), then the statement returns <code>TRUE</code> and implements the formatting.</li>\n<li><code>IF($B2=\"\",\"\",$B2)</code> - This nested IF statement checks if Cell <code>$B2</code> is blank, and returns <code>\"\"</code> if it is blank, or keeps the value of <code>$B2</code> otherwise. This is because <code>COUNTIFS</code> would see the cell as a 'zero' when blank otherwise (see <code>A9:B9</code>).</li>\n<li>I have not used a similar nested if to check if <code>$A2</code> is blank, because it <em>should not be blank</em>, so it's useful to highlight that the user has made an error in data entry here, too (see <code>A2:B2</code> - this will remain red once the user inputs a name, as it will no longer match <code>D2:E2</code>.)</li>\n</ol>\n\n<p>Reference image below:        </p>\n\n<p><a href=\"https://i.stack.imgur.com/INdfh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/INdfh.png\" alt=\"Working Conditional Formatting\"></a></p>\n"}], "owner": {"reputation": 133, "user_id": 6793852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K7D1B.jpg?s=128&g=1", "display_name": "Jonathan R Swift", "link": "https://stackoverflow.com/users/6793852/jonathan-r-swift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 56362751, "answer_count": 2, "score": 0, "last_activity_date": 1559146656, "creation_date": 1559129605, "question_id": 56359644, "link": "https://stackoverflow.com/questions/56359644/highlighting-missing-unique-pairs-when-compared-to-master-list-excel", "title": "Highlighting missing unique pairs when compared to master list - Excel", "body": "<p>On Sheet 1, I have a master list of data, with corresponding attributes. Some data has more than one attribute, some has only one, and there is a possibility of blanks. Attributes can be repeated when assigned to a different name.</p>\n\n<p>I've posted some example data below, so we can all talk about the same cells/names etc.</p>\n\n<p>On Sheet 2, there is much more freeform data input/analysis going on. Users are able to select a 'Name' from a dropdown menu using Data Validation, and are then able to select from the available attributes corresponding to that name, again using a dropdown menu. Names and attributes can appear in any order on Sheet 2.</p>\n\n<p>It is important that all pairings are considered in the second worksheet.</p>\n\n<p>Is it possible to use conditional formatting to highlight the 'Name' field (on Sheet 2) until at least one row exists with all possible pairings? In the example below, you can see that we have forgotten to put any info relating to the fact that Sally is Happy, and consequently 'Sally' has been highlighted to draw attention to the fact that there is some missing information.</p>\n\n<p><a href=\"https://i.stack.imgur.com/o5ePZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o5ePZ.png\" alt=\"Example Data\"></a></p>\n\n<p>Current thoughts:\nI already have a list of the attributes that match the corresponding name- this is what drives the dropdown menu on Sheet 2, and is generated in a background sheet when a name is picked on Sheet 2. I can count the non-blank cells in this range to find out the total number of pairs that are required.</p>\n\n<p>I would like to then count the number of non-duplicate attributes that are on rows that have the same Name as the current row, and compare this value.</p>\n\n<p>I'm expecting this to get into the realms of array formulae, but may be wrong...\nI'm also expecting array formulae to not work directly with conditional formatting, and to require the use of a 'helper column' to drive the formatting. Let me know if this is incorrect?</p>\n\n<p>Something along the lines of the below (formatted as pseudo-code for readability, but this should be read as a high level description, not actual code)</p>\n\n<pre><code>{Count the 1s in the array(AND(\n'Check if it's a name match'\nIf($D$1:$D$10=[$ACurrent],[set flag to 1],[set flag to 0])\n'Check if it's a unique value'\n[somehow check array values set at 1 to see if there is a duplicate value in column E, and then set the array value to zero if so])\n}\n</code></pre>\n\n<p>Does this approach make sense, and how would I go about constructing this actual formula?</p>\n\n<p>I don't mind using VBA if required, but would prefer to avoid it if possible (company policy, sorry).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 354, "user_id": 6225525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4eccb00f87165a22e14b8779555449f?s=128&d=identicon&r=PG&f=1", "display_name": "Olf", "link": "https://stackoverflow.com/users/6225525/olf"}, "edited": false, "score": 3, "creation_date": 1559128151, "post_id": 56359163, "comment_id": 99321856, "body": "Why you don&#39;t use a while loop ?"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 1, "creation_date": 1559128242, "post_id": 56359163, "comment_id": 99321897, "body": "BTW It should be <code>Next i</code> not <code>Next ForEnd</code>"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1559128688, "post_id": 56359163, "comment_id": 99322159, "body": "Thought what Olf said is the way to go in this case, maybe giving us a bit more info on your goals might help giving you a specific approach to your problem. As for your code goes, there is no need to do that. Why do you need to increase the ending?"}], "answers": [{"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1559128926, "creation_date": 1559128926, "answer_id": 56359431, "question_id": 56359163, "link": "https://stackoverflow.com/questions/56359163/is-it-possible-to-update-a-for-end-argument-while-inside-it/56359431#56359431", "title": "Is it possible to update a For End argument while inside it?", "body": "<p>I have no idea why you need to increase the ending, and why you cannot use other options as <code>Do...Loop</code>, but this migh work for you. Try to adapt it to your needs:</p>\n\n<pre><code>Dim ForEnd As Byte 'Limit or FOR...NEXT\nDim i As Byte 'Counter of FOR...NEXT\nDim XX As Byte 'It will store the last value of i when we restart the FOR...NEXT\nDim Something As String\n\nForEnd = 3\nXX = 1 'First value of i\n\nFor_Start:\n\nFor i = XX To ForEnd Step 1\n    If Something = \"TRUE\" Then\n        ForEnd = ForEnd + 1\n        XX = i + 1\n        GoTo For_Start\n    End If\n\nNext i\n</code></pre>\n\n<p>You handle with another variable the last position of your loop, and restart it from there with a <code>GoTo</code></p>\n"}, {"comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1559129470, "post_id": 56359446, "comment_id": 99322562, "body": "<code>While...Wend</code> is deprecated, and <code>While...Do...Wend</code> is an invalid construct."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1559132225, "post_id": 56359446, "comment_id": 99324136, "body": "@jsheeran: thanks for the remark. I&#39;ve removed the &quot;do&quot; part, but why do you say that &quot;while..wend&quot; is deprecated? It still works fine and according to &quot;<a href=\"https://docs.microsoft.com/en-gb/office/vba/language/reference/user-interface-help/whilewend-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-gb/office/vba/language/reference/&hellip;</a>&quot;, it&#39;s the way to go."}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1559132357, "post_id": 56359446, "comment_id": 99324212, "body": "It&#39;s a holdover from the original BASIC syntax. The page you&#39;ve linked to recommends <code>Do...Loop</code> instead, which supersedes it."}, {"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1559132590, "post_id": 56359446, "comment_id": 99324362, "body": "@jsheeran: you&#39;re right, I&#39;ve adapted my question accordingly."}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": true, "score": 1, "last_activity_date": 1559132562, "last_edit_date": 1559132562, "creation_date": 1559128974, "answer_id": 56359446, "question_id": 56359163, "link": "https://stackoverflow.com/questions/56359163/is-it-possible-to-update-a-for-end-argument-while-inside-it/56359446#56359446", "title": "Is it possible to update a For End argument while inside it?", "body": "<p>As mentioned by Olff, replace the for-loop by a while-loop:</p>\n\n<pre><code>ForEnd = 3\ni = 1\n\nwhile i&lt;ForEnd\n   If Something = \"TRUE\" Then\n      ForEnd = ForEnd + 1\n   End If\n   i = i + 1\nWend\n</code></pre>\n\n<p>Be very careful not ending up in an infinite loop! (<code>Something</code> needs to be different than <code>\"TRUE\"</code> regularly)</p>\n\n<p>Another way to go (a more modern approach) is using the <code>Do..Loop</code> approach:</p>\n\n<pre><code>ForEnd = 3\ni = 1\n\nDo While i&lt;ForEnd\n   If Something = \"TRUE\" Then\n      ForEnd = ForEnd + 1\n   End If\n   i = i + 1\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1559130062, "creation_date": 1559130062, "answer_id": 56359799, "question_id": 56359163, "link": "https://stackoverflow.com/questions/56359163/is-it-possible-to-update-a-for-end-argument-while-inside-it/56359799#56359799", "title": "Is it possible to update a For End argument while inside it?", "body": "<p>You can not control the upper limit of a <code>For</code> cycle when you use a const or a variable in the heading. However, using a function will do this: </p>\n\n<pre><code>for i = 1 To ForEnd(i)\n      ' commands\nNext i\n\nFunction ForEnd(k as Long) As Long\n\n     If Something = \"TRUE\" Then\n        ForEnd = 0\n     Else\n        ForEnd = k + 1\n     End If\n\nEnd Function\n</code></pre>\n\n<p>though I'd rather use <code>Do While</code> as above. If you need <code>For</code> loop then you can use <code>Exit For</code> to break the loop in case:</p>\n\n<pre><code>for i = 1 To 111111\n    If Something = \"False\" Then Exit For\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1559130596, "creation_date": 1559130596, "answer_id": 56359955, "question_id": 56359163, "link": "https://stackoverflow.com/questions/56359163/is-it-possible-to-update-a-for-end-argument-while-inside-it/56359955#56359955", "title": "Is it possible to update a For End argument while inside it?", "body": "<p>You could use:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim i As Long\n\n    i = 1\n\n    Do Until i &gt; 6\n\n        ThisWorkbook.Worksheets(\"Sheet1\").Cells(i, 1).Value = 20\n\n        i = i + 1\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10614963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9a03c6d297fb2bd3d01d9ab097ac1?s=128&d=identicon&r=PG&f=1", "display_name": "GBeltramini", "link": "https://stackoverflow.com/users/10614963/gbeltramini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56359446, "answer_count": 4, "score": 0, "last_activity_date": 1559132562, "creation_date": 1559128104, "last_edit_date": 1559128488, "question_id": 56359163, "link": "https://stackoverflow.com/questions/56359163/is-it-possible-to-update-a-for-end-argument-while-inside-it", "title": "Is it possible to update a For End argument while inside it?", "body": "<p>I wanted to change my For \"End\" argument while inside the For.</p>\n\n<p>For instance:</p>\n\n<pre><code>ForEnd = 3\nfor i = 1 To ForEnd\n   If Something = \"TRUE\" Then\n      ForEnd = ForEnd + 1\n   End If\nNext i\n</code></pre>\n\n<p>This doesn't work because the \"End\" or \"Upper Limit\" argument is defined once the code goes through the first line. Even if I change it inside the code it will consider the original value.</p>\n\n<p>Any thoughts?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba", "vb.net"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559129642, "post_id": 56359041, "comment_id": 99322660, "body": "Maybe you can move the code to an AddIn, which you keep to yourself?"}, {"owner": {"reputation": 466, "user_id": 3614957, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/ed0ff9171602ab25d1f9dca6252d6a55?s=128&d=identicon&r=PG&f=1", "display_name": "Zakir_SZH", "link": "https://stackoverflow.com/users/3614957/zakir-szh"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559129771, "post_id": 56359041, "comment_id": 99322727, "body": "@chrisneilsen, sir, thanks for your reply, i have also thought that but is not what client want. because he will work on the master file and edit the code anytime he want. :("}, {"owner": {"reputation": 466, "user_id": 3614957, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/ed0ff9171602ab25d1f9dca6252d6a55?s=128&d=identicon&r=PG&f=1", "display_name": "Zakir_SZH", "link": "https://stackoverflow.com/users/3614957/zakir-szh"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1559744801, "post_id": 56359041, "comment_id": 99516563, "body": "@chrisneilsen, sir, as i didn&#39;t get any answer or any suggestion , can you tell me how i can move all vb codes from excel files to a add-in and run the add-in from my software only? please make sure all moved code should work as it is running from the excel file. .. would you please  help me out?"}], "owner": {"reputation": 466, "user_id": 3614957, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/ed0ff9171602ab25d1f9dca6252d6a55?s=128&d=identicon&r=PG&f=1", "display_name": "Zakir_SZH", "link": "https://stackoverflow.com/users/3614957/zakir-szh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559129375, "creation_date": 1559127744, "last_edit_date": 1559129375, "question_id": 56359041, "link": "https://stackoverflow.com/questions/56359041/disable-excel-macros-when-running-directly", "title": "Disable Excel Macros When Running Directly", "body": "<p>I am facing an error on my current project.</p>\n\n<p>This is the project requirements:</p>\n\n<p>Client has xlsm excel file with macros in it.\nClient want that macro will be only available if it opened by my developed App.</p>\n\n<p>So, I have tried this:</p>\n\n<p>a) I password protect the file and open using following code:</p>\n\n<pre><code>objEApp = Activator.CreateInstance(System.Type.GetTypeFromProgID(\"Excel.Application\"))\nobjEApp.Workbooks.Open(strExcelFile, password:=\"excelpassword\")\nobjEApp.Visible = True\nobjEApp = Nothing\n</code></pre>\n\n<p>b) and put another function and with the help of a third party library, I remove the macros from excel file and save as client version (another file).</p>\n\n<p>but the client is not happy with it as:</p>\n\n<ol>\n<li>it creates two excel file one is for the full version password protected, another is for the client version.</li>\n<li>he also doesn't want the excel file to be password protected.</li>\n<li>he wants it as very simple</li>\n</ol>\n\n<p>a) if the user opens the excel file directly (double click or open through excel) then VBA macros will not be present/work.</p>\n\n<p>b) if the user opens the excel file by my software then it will work with those macros.</p>\n\n<p>so, I am out of ideas now. I can't figure out how that is even possible?</p>\n\n<p>though, I have an idea.. but can't find the way to achieve it.</p>\n\n<p>for example, I put a global Boolean variable on macro scripts, like bolAppRun Macro with a default value to false.</p>\n\n<p>and when this file is opened via my software, my software just set the Boolean value to true. so, that macro will work. however, when user saves the excel file that Boolean value will not be saved.</p>\n\n<p>something like:</p>\n\n<pre><code>objEWorkBook = objEApp.Workbooks.Open(strExcelFile, password:=\"excelpassword\")\nobjEWorkBook.bolAppRun = true;\n</code></pre>\n\n<p>any idea to achieve my idea.. or do you have a better idea.</p>\n\n<p>thanks in advance\nbest regards</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559128005, "post_id": 56358990, "comment_id": 99321765, "body": "Is your Bienvenidas folder a sub folder of your inbox?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559128065, "post_id": 56358990, "comment_id": 99321793, "body": "Yes, are you looking for the default folder called task? If so, you want <code>(olFolderTasks)</code>"}, {"owner": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559128337, "post_id": 56358990, "comment_id": 99321960, "body": "my Task folder is a subfolder in my Inbox folder. Is my code right on that part?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559128461, "post_id": 56358990, "comment_id": 99322031, "body": "Yes, in theory... I edited my answer adding a code to check all your subfolders inside the inbox. If the immediate window shows you the &quot;Task&quot; folder, then it must be empty...."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559128986, "post_id": 56358990, "comment_id": 99322327, "body": "Glad it helped, Consider marking this as correct answer so others might find it."}, {"owner": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559130155, "post_id": 56358990, "comment_id": 99322932, "body": "hey man, do you happen to know how to do it if every word in the mail get pasted in a different cell going to the right?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559130448, "post_id": 56358990, "comment_id": 99323111, "body": "@Link look at my second edit, beware of the lenght on your mails because columns have a limit and the code splits words by spaces."}, {"owner": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559130894, "post_id": 56358990, "comment_id": 99323346, "body": "ill rephrase it. how to copy table from outlook then paste it as table in excel using your code?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "edited": false, "score": 0, "creation_date": 1559131093, "post_id": 56358990, "comment_id": 99323481, "body": "Read <a href=\"https://www.extendoffice.com/documents/outlook/5225-export-outlook-email-body-table-to-excel.html\" rel=\"nofollow noreferrer\">this</a> @Link it might help you."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1559130401, "last_edit_date": 1559130401, "creation_date": 1559127551, "answer_id": 56358990, "question_id": 56358712, "link": "https://stackoverflow.com/questions/56358712/i-cant-retrieve-what-is-inside-my-outlook-with-my-code/56358990#56358990", "title": "I cant retrieve what is inside my outlook with my code", "body": "<p>I just changed few things on your code but it's working allright for me</p>\n\n<pre><code>Option Explicit\nPrivate Sub CommandButton1_Click()\n\n    Dim OutlookApp As Outlook.Application\n    Dim OutlookNamespace As Namespace\n    Dim Folder As MAPIFolder\n    Dim OutlookMail As Variant\n    Dim i As Integer\n\n    Set OutlookApp = New Outlook.Application\n    Set OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\n    Set Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"Bienvenidas\")\n\n    i = 2\n\n    With ThisWorkbook.Sheets(\"MySheet\") 'Change MySheet for your sheet name, and ALWAYS reference sheets and workbooks.\n        For Each OutlookMail In Folder.Items\n            If OutlookMail.ReceivedTime &gt;= .Range(\"C1\") Then\n                With .Cells(i, 1)\n                    .Value = OutlookMail.SenderName\n                    .Columns.AutoFit\n                    .VerticalAlignment = xlTop\n                End With\n                With .Cells(i, 2)\n                    .Value = OutlookMail.Body\n                    .Columns.AutoFit\n                    .VerticalAlignment = xlTop\n                End With\n                i = i + 1\n            End If\n        Next OutlookMail\n    End With\n\n    Set Folder = Nothing\n    Set OutlookNamespace = Nothing\n    Set OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Instead of using ranges and then offseting, go to the cell which have the sender, body and date range and reference them directly.</p>\n\n<p>The only thing that comes to me, is that folder \"tasks\" inside your inbox folder? The error may come from there.</p>\n\n<p>Edit: Code to check all your subfolders inside the inbox folder:</p>\n\n<pre><code>Sub Loop_folders_of_inbox()\n\n    Dim ns As Outlook.Namespace\n    Dim myfolder As Outlook.Folder\n    Dim mysubfolder As Outlook.Folder\n    Dim OutlookApp As Outlook.Application\n\n    Set OutlookApp = New Outlook.Application\n    Set ns = OutlookApp.GetNamespace(\"MAPI\")\n    'Get the default inboxfolder\n    Set myfolder = ns.GetDefaultFolder(olFolderInbox)\n    'Loop through each folder and display name of the folder\n    For Each mysubfolder In myfolder.Folders\n        Debug.Print mysubfolder.Name\n    Next mysubfolder\n\nEnd Sub\n</code></pre>\n\n<p>Edit 2: Each word from the body into a different column:</p>\n\n<pre><code>Dim arrBody\nDim j As Long\n\narrBody = Split(OutlookMail.Body, \" \") 'words delimited by space\nFor j = LBound(arrBody) To UBound(arrBody)\n    .Cells(i, j + 1) = arrBody(j) 'use j + 1 because arrays built from Space function start at index 0\nNext j\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 8970437, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1063a778c6c628f0914448c9a39c8201?s=128&d=identicon&r=PG&f=1", "display_name": "Link", "link": "https://stackoverflow.com/users/8970437/link"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 56358990, "answer_count": 1, "score": 0, "last_activity_date": 1559130401, "creation_date": 1559126695, "question_id": 56358712, "link": "https://stackoverflow.com/questions/56358712/i-cant-retrieve-what-is-inside-my-outlook-with-my-code", "title": "I cant retrieve what is inside my outlook with my code", "body": "<p>I can't get the inside on my Task folder on my outlook with my code. Do you guys know any problems here?</p>\n\n<p>The problem I saw is that it doesnt go in my For Loop.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim OutlookApp As Outlook.Application\nDim OutlookNamespace As Namespace\nDim Folder As MAPIFolder\nDim OutlookMail As Variant\nDim i As Integer\n\n\nSet OutlookApp = New Outlook.Application\nSet OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\nSet Folder = OutlookNamespace.GetDefaultFolder(olFolderInbox).Folders(\"Task\")\n\n\ni = 1\n\nFor Each OutlookMail In Folder.Items\nIf OutlookMail.ReceivedTime &gt;= Range(\u201cdate_received\u201d).Value Then\nRange(\u201cSender\u201d).Offset(i, 0).Value = OutlookMail.SenderName\nRange(\u201cSender\u201d).Offset(i, 0).Columns.AutoFit\nRange(\u201cSender\u201d).Offset(i, 0).VerticalAlignment = xlTop\nRange(\u201cBody\u201d).Offset(i, 0).Value = OutlookMail.Body\nRange(\u201cBody\u201d).Offset(i, 0).Columns.AutoFit\nRange(\u201cBody\u201d).Offset(i, 0).VerticalAlignment = xlTop\n\ni = i + 1\nEnd If\nNext OutlookMail\n\nSet Folder = Nothing\nSet OutlookNamespace = Nothing\nSet OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 1, "creation_date": 1559126303, "post_id": 56358421, "comment_id": 99320828, "body": "I don&#39;t think you can use VLOOKUP like that.  the first argument should be a value, not a range."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559129826, "post_id": 56358876, "comment_id": 99322754, "body": "I guess I didn&#39;t express myself pretty well.  If I were to do this using cells from a worksheet, I would just fill the table column (&quot;Table_3[Stock Qty]&quot;) with this formula  <code>=VLOOKUP(Table_3[Part Number];Table1[[Part Number]:[Stock Qty]];3;0)</code>"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559132269, "post_id": 56358876, "comment_id": 99324168, "body": "see the new answer"}, {"owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559133143, "post_id": 56358876, "comment_id": 99324734, "body": "Wow, nice! I wouldn&#39;t know how to do it! I&#39;ll try that!"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559133242, "post_id": 56358876, "comment_id": 99324787, "body": "i ll wait for your feedback"}, {"owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559134004, "post_id": 56358876, "comment_id": 99325266, "body": "I got a MsgBox with &quot;Application-defined or object-defined error&quot; Somehow it&#39;s not being able to understand the formula"}, {"owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559135266, "post_id": 56358876, "comment_id": 99326050, "body": "At the &quot;tbl3.ListColumns(&quot;Status&quot;).DataBody[...]&quot; line"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559135712, "post_id": 56358876, "comment_id": 99326331, "body": "make sure that the table 3 has a column named &quot;Status&quot;"}, {"owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559136241, "post_id": 56358876, "comment_id": 99326690, "body": "It worked if I move the Part Number column to the first column of the table (I know vlookup uses the first column, but my array would not include all table, just 3 columns from it)  Edit: That&#39;s why at first I tried using <code>&quot;Table1[[#All];[Part Number]:[Status]]&quot;</code> instead of just <code>Table1[#All]</code> But it didn&#39;t work"}, {"owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559136525, "post_id": 56358876, "comment_id": 99326871, "body": "I don&#39;t get it. If I manually insert to Table_3 (Status) Column  <code>&quot;=VLOOKUP([Part Number];Table1[[#All];[Part Number]:[Status]];3;FALSE)&quot;</code> It works.  If try to insert it using vba, it doesn&#39;t work"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559137063, "post_id": 56358876, "comment_id": 99327203, "body": "could you please upload an image of your tables?"}, {"owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "edited": false, "score": 0, "creation_date": 1559210980, "post_id": 56358876, "comment_id": 99353183, "body": "Sorry about the delay. I decided to solve this using to while loops instead... ):"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1559132246, "last_edit_date": 1559132246, "creation_date": 1559127217, "answer_id": 56358876, "question_id": 56358421, "link": "https://stackoverflow.com/questions/56358421/table-reference-for-vlookup-vba/56358876#56358876", "title": "Table reference for VLOOKUP VBA", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim tbl1 As ListObject, tbl3 As ListObject\n\n    'Set you sheet\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        'Set tables\n        Set tbl1 = .ListObjects(\"Table1\")\n        Set tbl3 = .ListObjects(\"Table_3\")\n        tbl3.ListColumns(\"Status\").DataBodyRange.FormulaR1C1 = \"=VLOOKUP([Part Number],Table1[#All],3,FALSE)\"\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11233844, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yrMv3WfrhtA/AAAAAAAAAAI/AAAAAAAAGA8/fZhA7rzq0hE/photo.jpg?sz=128", "display_name": "Iago Moschetto", "link": "https://stackoverflow.com/users/11233844/iago-moschetto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 56358876, "answer_count": 1, "score": 0, "last_activity_date": 1559132246, "creation_date": 1559125731, "last_edit_date": 1559129310, "question_id": 56358421, "link": "https://stackoverflow.com/questions/56358421/table-reference-for-vlookup-vba", "title": "Table reference for VLOOKUP VBA", "body": "<p>I'm trying to use a table as reference for my VLOOKUP function using VBA, but it doesn't seem to work. Could somebody help me? My guess is that I'm not calling the tables properly.</p>\n\n<p>Some info:</p>\n\n<ol>\n<li>Table_3 and Table1 are set tables</li>\n<li>Both of them are not fixed (data is added to it)</li>\n</ol>\n\n<pre><code>Range(\"Table_3[Status]\") = Application.WorksheetFunction.VLookup(Range(\"Table_3[Part_Number]\"), Range(\"Table1[[#All];[Part Number]:[Status]]\"), 3, False)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11572154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7efa96023b16fe28a762674004341a7?s=128&d=identicon&r=PG&f=1", "display_name": "jenya kipnis", "link": "https://stackoverflow.com/users/11572154/jenya-kipnis"}, "edited": false, "score": 0, "creation_date": 1559201359, "post_id": 56359821, "comment_id": 99349003, "body": "Hi, it doesn&#39;t do exactly what I need. it substitutes the previous value with the value of the cell that it stands on and at the end it doesn&#39;t print the sum of all the range that it runs on. How to fix it that it will sum the B column and print the sum and won&#39;t substitute the values in the cells?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 1, "user_id": 11572154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7efa96023b16fe28a762674004341a7?s=128&d=identicon&r=PG&f=1", "display_name": "jenya kipnis", "link": "https://stackoverflow.com/users/11572154/jenya-kipnis"}, "edited": false, "score": 0, "creation_date": 1559203033, "post_id": 56359821, "comment_id": 99349651, "body": "It s better to upload an images with the data and one with the desirable outcome."}, {"owner": {"reputation": 1, "user_id": 11572154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7efa96023b16fe28a762674004341a7?s=128&d=identicon&r=PG&f=1", "display_name": "jenya kipnis", "link": "https://stackoverflow.com/users/11572154/jenya-kipnis"}, "edited": false, "score": 0, "creation_date": 1559204965, "post_id": 56359821, "comment_id": 99350451, "body": "i added a picture"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1559130145, "creation_date": 1559130145, "answer_id": 56359821, "question_id": 56358345, "link": "https://stackoverflow.com/questions/56358345/how-to-write-a-sum-loop-with-a-criteria-in-excel-sheet/56359821#56359821", "title": "How to write a sum loop with a criteria in excel sheet?", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRow As Long, i As Long\n\n    'Set you sheet\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        'Start from row 2\n        For i = 2 To LastRow\n\n            If Not IsEmpty(.Range(\"A\" &amp; i).Value) Then\n\n                .Range(\"B\" &amp; i - 1).Value = .Range(\"B\" &amp; i).Value + .Range(\"B\" &amp; i - 1).Value\n\n            Else\n\n                .Range(\"B\" &amp; i + 1).Value = .Range(\"B\" &amp; i).Value\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11572154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7efa96023b16fe28a762674004341a7?s=128&d=identicon&r=PG&f=1", "display_name": "jenya kipnis", "link": "https://stackoverflow.com/users/11572154/jenya-kipnis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559206227, "creation_date": 1559125460, "last_edit_date": 1559206227, "question_id": 56358345, "link": "https://stackoverflow.com/questions/56358345/how-to-write-a-sum-loop-with-a-criteria-in-excel-sheet", "title": "How to write a sum loop with a criteria in excel sheet?", "body": "<p>I need to run a loop that checks if cells in column A is not empty then it will take the integer in column B in the same row and sum it to the previous integer, when the cell in column A is empty then it will print the sum in the next row in column B.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>X = 0\n\nFor myCounter = myRow To 1 Step -1\nDo While Not IsEmpty(Cells(myCounter + 1, 1).Value)\n    X = Cells (myCounter,10).Value + X\nLoop\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Nk3Mb.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559124919, "post_id": 56358152, "comment_id": 99320105, "body": "Could you show what you have tried so far?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559125363, "post_id": 56358152, "comment_id": 99320328, "body": "So you are saying insert 2 rows, but your example shows extra columns... what would it be? rows or columns? .nvm... was edited."}, {"owner": {"reputation": 3, "user_id": 11468228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MruojJBXtjU/AAAAAAAAAAI/AAAAAAAAADg/PlOm7v6T09g/photo.jpg?sz=128", "display_name": "Aaron6", "link": "https://stackoverflow.com/users/11468228/aaron6"}, "reply_to_user": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559125631, "post_id": 56358152, "comment_id": 99320461, "body": "@erazorv4: I tried to insert rows but received Error 1004"}, {"owner": {"reputation": 3, "user_id": 11468228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MruojJBXtjU/AAAAAAAAAAI/AAAAAAAAADg/PlOm7v6T09g/photo.jpg?sz=128", "display_name": "Aaron6", "link": "https://stackoverflow.com/users/11468228/aaron6"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559125667, "post_id": 56358152, "comment_id": 99320486, "body": "@DarXyde It is rows, thank you for editing"}, {"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559126142, "post_id": 56358152, "comment_id": 99320742, "body": "@Aaron6 We can&#39;t help you if you don&#39;t show the code, Error 1004 could be caused by a lot of things. <a href=\"https://stackoverflow.com/posts/56358152/edit\">edit</a> your question with the code you&#39;re trying, and what line the error is on."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11468228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MruojJBXtjU/AAAAAAAAAAI/AAAAAAAAADg/PlOm7v6T09g/photo.jpg?sz=128", "display_name": "Aaron6", "link": "https://stackoverflow.com/users/11468228/aaron6"}, "edited": false, "score": 0, "creation_date": 1559126743, "post_id": 56358533, "comment_id": 99321061, "body": "It works well. I just changed loop for R from 2 to 1 and it included first value as well. Thank you very much for the solution."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 3, "user_id": 11468228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MruojJBXtjU/AAAAAAAAAAI/AAAAAAAAADg/PlOm7v6T09g/photo.jpg?sz=128", "display_name": "Aaron6", "link": "https://stackoverflow.com/users/11468228/aaron6"}, "edited": false, "score": 0, "creation_date": 1559126817, "post_id": 56358533, "comment_id": 99321103, "body": "I&#39;ve left that out thinking of headers, but yeah. Glad it works for you."}, {"owner": {"reputation": 3, "user_id": 11468228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MruojJBXtjU/AAAAAAAAAAI/AAAAAAAAADg/PlOm7v6T09g/photo.jpg?sz=128", "display_name": "Aaron6", "link": "https://stackoverflow.com/users/11468228/aaron6"}, "edited": false, "score": 0, "creation_date": 1559131817, "post_id": 56358533, "comment_id": 99323913, "body": "Can you help me with this solution as well please thank you! <a href=\"https://stackoverflow.com/q/56360207/11468228\">stackoverflow.com/q/56360207/11468228</a>"}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 0, "last_activity_date": 1559126098, "creation_date": 1559126098, "answer_id": 56358533, "question_id": 56358152, "link": "https://stackoverflow.com/questions/56358152/insert-row-between-range-of-numbers-in-excel/56358533#56358533", "title": "Insert Row between range of numbers in Excel", "body": "<p>I think this will do:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub insertRows()\nDim ws As Worksheet: Set ws = ActiveSheet\nDim lastRow As Long: lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\nDim R As Long\n\n    For R = lastRow To 2 Step -1\n        ws.Rows(R &amp; \":\" &amp; R + 1).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        ws.Range(ws.Cells(R, 1), ws.Cells(R + 1, 1)) = ws.Cells(R + 2, 1).Value\n    Next R\n\nEnd Sub\n</code></pre>\n\n<p>PS: this is working its up from the bottom... not top to bottom.</p>\n"}], "owner": {"reputation": 3, "user_id": 11468228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MruojJBXtjU/AAAAAAAAAAI/AAAAAAAAADg/PlOm7v6T09g/photo.jpg?sz=128", "display_name": "Aaron6", "link": "https://stackoverflow.com/users/11468228/aaron6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56358533, "answer_count": 1, "score": -1, "last_activity_date": 1559126098, "creation_date": 1559124785, "last_edit_date": 1559125362, "question_id": 56358152, "link": "https://stackoverflow.com/questions/56358152/insert-row-between-range-of-numbers-in-excel", "title": "Insert Row between range of numbers in Excel", "body": "<p>My Excel have 1 Column and 10 Rows of sequential numbers. I want to create a macro which could start from top value of column then insert 2 rows with the first value of list and then move on to second value and do same and so on.</p>\n\n<pre><code>Values Column\n1\n2\n3\n\nResult Column\n1\n1\n1\n2\n2\n2\n3\n3\n3\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "hta"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559123255, "post_id": 56357618, "comment_id": 99319157, "body": "You can read about reading information from HTML using VBA from (<a href=\"https://www.encodedna.com/excel/extract-contents-from-html-element-of-a-webpage-in-excel-using-vba.htm\" rel=\"nofollow noreferrer\">encodedna.com/excel/&hellip;</a>)"}, {"owner": {"reputation": 41, "user_id": 11399419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04779f8df6a17a9d8bde9047c349ec8f?s=128&d=identicon&r=PG&f=1", "display_name": "jaHolden", "link": "https://stackoverflow.com/users/11399419/jaholden"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559123677, "post_id": 56357618, "comment_id": 99319430, "body": "Basically I know something how to work on it, how to connect with browswer and find there what I need, but to do that I have to Set IE = New InternetExplorer and so one. In this case my code have to find a window, recognize it and then find something inside."}], "owner": {"reputation": 41, "user_id": 11399419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04779f8df6a17a9d8bde9047c349ec8f?s=128&d=identicon&r=PG&f=1", "display_name": "jaHolden", "link": "https://stackoverflow.com/users/11399419/jaholden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1559128155, "creation_date": 1559123089, "last_edit_date": 1559128155, "question_id": 56357618, "link": "https://stackoverflow.com/questions/56357618/how-to-get-value-from-an-hta-file-using-vbscript-or-vba", "title": "How to get value from an HTA file using VBScript or VBA", "body": "<p>I am running VBScript and trying to get values from checkbox in HTA file (HTA window is already displayed). What is important, VBScript is a separate file - this code shoud not be included in  section in HTA file because of some reasons/restrictions.</p>\n\n<p>I think I should set this HTA window and create object somehow, but really do not how.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;html&gt;\n&lt;head&gt;\n&lt;HTA:APPLICATION ID=\"objHTAHelpomatic\" APPLICATIONNAME=\"Checklist\" SCROLL=\"no\" SINGLEINSTANCE=\"yes\" WINDOWSTATE=\"maximize\" /&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;input type=\"checkbox\" name=\"c1\" value=\"1\" checked&gt;ONE&lt;br&gt;\n    &lt;input type=\"checkbox\" name=\"c2\" value=\"1\" checked&gt;TWO&lt;br&gt;\n    &lt;input type=\"checkbox\" name=\"c3\" value=\"1\" checked&gt;THREE&lt;br&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Could anyone suggest me how to get those values? For example to double click on VBS file and display values in <code>MsgBox</code>?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 2, "creation_date": 1559122702, "post_id": 56357448, "comment_id": 99318810, "body": "What is the error?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559122916, "post_id": 56357448, "comment_id": 99318940, "body": "I tried the line.. It&#39;s working fine."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559123462, "post_id": 56357448, "comment_id": 99319285, "body": "Can you post a data example of where are you aplying this?"}], "answers": [{"tags": [], "owner": {"reputation": 150, "user_id": 9566887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kynakuu", "link": "https://stackoverflow.com/users/9566887/kynakuu"}, "is_accepted": false, "score": 0, "last_activity_date": 1559214724, "last_edit_date": 1559214724, "creation_date": 1559124759, "answer_id": 56358140, "question_id": 56357448, "link": "https://stackoverflow.com/questions/56357448/why-does-remove-duplicates-now-throws-an-error/56358140#56358140", "title": "Why does remove duplicates now throws an error?", "body": "<p>I've added an edit to the question, however I'll post it here to close the question. The table was imported to excel as an XML and had stayed in that format, hence the function wasn't working properly. To fix it, all I had to do was copy all the data and paste it into a separate sheet as values.</p>\n"}], "owner": {"reputation": 150, "user_id": 9566887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kynakuu", "link": "https://stackoverflow.com/users/9566887/kynakuu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559214724, "creation_date": 1559122607, "last_edit_date": 1559202913, "question_id": 56357448, "link": "https://stackoverflow.com/questions/56357448/why-does-remove-duplicates-now-throws-an-error", "title": "Why does remove duplicates now throws an error?", "body": "<p>I had a script working about a month ago and nothing has changed since. However, when I run the script now, it throws an error. The function I am trying to use is the <code>Remove Duplicates</code> function.</p>\n\n<p>I've tried changing the function in multiple ways thinking that it may be the order, however, I cannot work out how it has broken since nothing has changed since it last worked.</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$F$8000\").RemoveDuplicates 1, xlYes\n</code></pre>\n\n<p>As stated, the expected result is that it removes all the duplicates at the end since the previous part of the script is removing a wide criteria.</p>\n\n<p>Error message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wBq2u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wBq2u.png\" alt=\"Error Message\"></a></p>\n\n<p>Data example and the highlight of what should be removed:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cd0PZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cd0PZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Test example which also failed on me which was a lot smaller:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vSX9E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vSX9E.png\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT</p>\n\n<p>Found the issue now... the data was in a separate table within excel so I just copied it out and pasted it as values in a separate sheet.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1559122144, "post_id": 56357272, "comment_id": 99318499, "body": "Search for the worksheet event <code>Worksheet_Change</code> this is what you need,"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1559123245, "post_id": 56357272, "comment_id": 99319148, "body": "hi, replace         For Each trgt In Intersect(Target, Range(&quot;F:F, I:I, L:L, O:O, R:R, U:U, X:X, AA:AA, AB:AB, .... with For Each trgt In Target.."}], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 3771988, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/560490749/picture?type=large", "display_name": "Adam Mann Pro", "link": "https://stackoverflow.com/users/3771988/adam-mann-pro"}, "edited": false, "score": 0, "creation_date": 1559123917, "post_id": 56357721, "comment_id": 99319570, "body": "Brill that&#39;s worked a treat, now just to work out how to integrate it with my current above code"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 235, "user_id": 3771988, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/560490749/picture?type=large", "display_name": "Adam Mann Pro", "link": "https://stackoverflow.com/users/3771988/adam-mann-pro"}, "edited": false, "score": 1, "creation_date": 1559123982, "post_id": 56357721, "comment_id": 99319601, "body": "I&#39;d do a If/ElseIF with all your needs and the code in between. Outside the if the <code>Application.EnableEvents</code> and that should do it."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1559123401, "creation_date": 1559123401, "answer_id": 56357721, "question_id": 56357272, "link": "https://stackoverflow.com/questions/56357272/update-excel-cell-with-date-if-a-cell-in-a-range-is-update/56357721#56357721", "title": "Update excel cell with date if a cell in a range is update", "body": "<p>This works for me:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = False\n    If Intersect(Target, Me.Range(\"A\" &amp; Target.Row &amp; \":CR\" &amp; Target.Row)) Is Nothing Then GoTo SafeExit\n    Me.Cells(Target.Row, \"CU\") = Now()\nSafeExit:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 10674906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd85014fe2f9134aa04f631709b7de10?s=128&d=identicon&r=PG&f=1", "display_name": "Rinshad", "link": "https://stackoverflow.com/users/10674906/rinshad"}, "is_accepted": false, "score": 0, "last_activity_date": 1582391769, "creation_date": 1582391769, "answer_id": 60354697, "question_id": 56357272, "link": "https://stackoverflow.com/questions/56357272/update-excel-cell-with-date-if-a-cell-in-a-range-is-update/60354697#60354697", "title": "Update excel cell with date if a cell in a range is update", "body": "<p>The below code takes care of:</p>\n\n<ol>\n<li>Clearing the time if the row is blank.</li>\n<li>Updating the time only if the values really change from the previous value.</li>\n</ol>\n\n<pre><code>Dim oldValue As String\n\n'Change the range below where your data will be\nConst RangeString = \"A:CR\"\n\n'Below variable decides the column in which date will be displayed\n'Change the below value to 1 for column A, 2 for B, ... 99 for CU\nConst ColumnIndex = 99\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim WorkRng As Range\n    Dim HorizontalRng As Range\n    Dim Rng As Range\n    Dim HorRng As Range\n    Dim RowHasVal As Boolean\n\n    Set WorkRng = Intersect(ActiveSheet.Range(RangeString), Target)\n\n    If Not WorkRng Is Nothing Then\n        If WorkRng.Cells.Count = 1 And WorkRng.Cells(1, 1).Value = oldValue Then\n            Exit Sub\n        End If\n        Application.EnableEvents = False\n        For Each Rng In WorkRng\n            Set HorizontalRng = Intersect(ActiveSheet.Range(RangeString), Rows(Rng.Row))\n            RowHasVal = False\n            For Each HorRng In HorizontalRng\n                If Not VBA.IsEmpty(HorRng.Value) Then\n                    RowHasVal = True\n                    Exit For\n                End If\n            Next\n            If Not RowHasVal Then\n                ActiveSheet.Cells(Rng.Row, ColumnIndex).ClearContents\n            ElseIf Not VBA.IsEmpty(Rng.Value) Then\n                ActiveSheet.Cells(Rng.Row, ColumnIndex).Value = Now\n                ActiveSheet.Cells(Rng.Row, ColumnIndex).NumberFormat = \"dd-mm-yyyy, hh:mm:ss\"\n            End If\n        Next\n        Application.EnableEvents = True\n    End If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not Intersect(Target, ActiveSheet.Range(RangeString)) Is Nothing Then\n        If Target.Cells.Count = 1 Then\n            oldValue = Target.Value\n        Else\n            oldValue = \"\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 3771988, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/560490749/picture?type=large", "display_name": "Adam Mann Pro", "link": "https://stackoverflow.com/users/3771988/adam-mann-pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 56357721, "answer_count": 2, "score": 0, "last_activity_date": 1582391769, "creation_date": 1559122003, "last_edit_date": 1559122197, "question_id": 56357272, "link": "https://stackoverflow.com/questions/56357272/update-excel-cell-with-date-if-a-cell-in-a-range-is-update", "title": "Update excel cell with date if a cell in a range is update", "body": "<p>I need to update a cell with the date and time stamp (NOW()) if any cell is updated within any cell before it within that same row.</p>\n\n<p>So update cell \"CU\" with date and time when any cell from \"A-CR\" is updated.</p>\n\n<p>I have done some searching but I can only seem to find bits that work if only updating a single cell, I'm looking for if anything changes within that range.</p>\n\n<p>I currently have some Vba which does something similar which will update the adjacent cell with time and date which is required but I also need an overall one for the whole process.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"F:F, I:I, L:L, O:O, R:R, U:U, X:X, AA:AA, AB:AB, AE:AE, AH:AH, AK:AK, AN:AN, AQ:AQ, AT:AT, AW:AW, AZ:AZ, BC:BC, BF:BF, BI:BI, BL:BL, BO:BO, BR:BR, BU:BU, BX:BX, CA:CA, CD:CD, CG:CG, CJ:CJ, CM:CM, CP:CP\")) Is Nothing Then\n    On Error GoTo safe_exit\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n        Dim trgt As Range, ws1 As Worksheet\n        'Set ws1 = ThisWorkbook.Worksheets(\"Info\")\n        For Each trgt In Intersect(Target, Range(\"F:F, I:I, L:L, O:O, R:R, U:U, X:X, AA:AA, AB:AB, AE:AE, AH:AH, AK:AK, AN:AN, AQ:AQ, AT:AT, AW:AW, AZ:AZ, BC:BC, BF:BF, BI:BI, BL:BL, BO:BO, BR:BR, BU:BU, BX:BX, CA:CA, CD:CD, CG:CG, CJ:CJ, CM:CM, CP:CP\"))\n            If trgt &lt;&gt; vbNullString Then\n                If UCase(trgt.Value) = \"Y\" Or UCase(trgt.Value) = \"N\" Then\n                    Cells(trgt.Row, trgt.Column + 1) = Now()\n                    Cells(trgt.Row, trgt.Column + 2) = Environ(\"username\")\n                    'Select Case trgt.Column\n                    '    Case 2   'column B\n                    '        Cells(trgt.Row, trgt.Column + 1) = Environ(\"username\")\n\n                    '     Case 4   'column D\n                    '       'do something else\n                    ' End Select\n                Else\n                    trgt = \"\"\n                    Cells(trgt.Row, trgt.Column + 1) = \"\"\n                    Cells(trgt.Row, trgt.Column + 2) = \"\"\n                End If\n            End If\n\n        Next trgt\n        'Set ws1 = Nothing\n    End With\nEnd If\n</code></pre>\n\n<p>safe_exit:\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 1, "last_activity_date": 1559121999, "creation_date": 1559121999, "answer_id": 56357271, "question_id": 56357146, "link": "https://stackoverflow.com/questions/56357146/avoiding-the-use-of-worksheet-activate-in-order-to-execute-code/56357271#56357271", "title": "Avoiding the use of worksheet.activate in order to execute code", "body": "<p>See if this helps understanding what was missing:</p>\n\n<pre><code>Option Explicit\nSub test()\n\n    'Your code:\n    Cols = Worksheets(\"Sheet1\").Range(Cells(1, 1), Cells(1, 1).End(xlToRight)).Count 'Cells inside the range are not qualified\n\n    'Corrected code:\n    Cols = Worksheets(\"Sheet1\").Range(Worksheets(\"Sheet1\").Cells(1, 1), Worksheets(\"Sheet1\").Cells(1, 1).End(xlToRight)).Count\n\n    'Above code is too long right?\n\n    'Option 1        \n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    Cols = ws.Range(ws.Cells(1, 1), ws.Cells(1, 1).End(xlToRight)).Count\n\n    'Option 2\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .Range(.Cells(1, 1), .Cells(1, 1).End(xlToRight)).Count\n    End With\n\n    'Changing your code works with any option:\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .Cells(1, .Columns.Count).End(xlToLeft).Column 'This option goes from right to left to find the last column with data\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Also, always qualify worksheets and <strong>workbooks</strong> might seem that with the worksheet is enough, but if you work with more than 1 workbook not qualifying it will be a problem too.</p>\n"}, {"tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 2, "last_activity_date": 1559122003, "creation_date": 1559122003, "answer_id": 56357273, "question_id": 56357146, "link": "https://stackoverflow.com/questions/56357146/avoiding-the-use-of-worksheet-activate-in-order-to-execute-code/56357273#56357273", "title": "Avoiding the use of worksheet.activate in order to execute code", "body": "<p>You're quite close to doing it right.</p>\n\n<p>You need to remember to refer to a WB and WS for <strong>each</strong> range object. Otherwise, VBA will refer to the <strong>active</strong> WB and WS</p>\n\n<p>In <code>Worksheets(\"Sheet1\").Range(Cells(1, 1), Cells(1, 1).End(xlToRight)).Count</code> I count two <code>Cells</code> range objects that need referencing.<br>\nAdditionally, your workbook is not specified for the sheet you're referring to. If there is no sheet named \"Sheet1\" in the active workbook, you will get a <em>Subscript out of Range</em> error.  </p>\n\n<p>To prevent such errors, it is good practice to use a <code>With...End With</code> statement. That way you will only have to specify the workbook and -sheet first, preventing cluttered code.</p>\n\n<p>So, it would be:</p>\n\n<pre><code>With Workbooks(REF).Sheets(\"Sheet1\")\n    .Range(.Cells(1, 1), .Cells(1, 1).End(xlToRight)).Count\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 56357273, "answer_count": 2, "score": 0, "last_activity_date": 1559122003, "creation_date": 1559121623, "question_id": 56357146, "link": "https://stackoverflow.com/questions/56357146/avoiding-the-use-of-worksheet-activate-in-order-to-execute-code", "title": "Avoiding the use of worksheet.activate in order to execute code", "body": "<p>This should be easy. I would like to reduce the usage of the code <code>worksheets(\"Sheet1\").activate</code> as it is cumbersome and faulty oftentimes, however all the attempts I have tried out they do not work. So far I have used the <code>set worksheet</code> option and <code>with worksheet</code> option but unless I am strictly on the worksheet sheet 1 on Excel , the code does not execute.</p>\n\n<p>I have tried some of the options listed in this link but none of them worked: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. I am really starting to think that I need to use activate all the time.</p>\n\n<p>For example, a code like:</p>\n\n<pre><code>Sub test()\nDim Cols As integer\nCols = Worksheets(\"Sheet1\").Range(Cells(1, 1), Cells(1, 1).End(xlToRight)).Count\nEnd sub\n</code></pre>\n\n<p>I would expect that this code execute even if I am not situated on Sheet1 since I have specifically defined the worksheet in which it must be executed. However, unless I am on that worksheet, the code does not work. As background information, I run most of my codes under subroutines in the modules section of VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559121998, "post_id": 56357137, "comment_id": 99318417, "body": "Is <code>Sheets(&quot;Time series&quot;)</code> the same as <code>Sheets(1)</code> ? I prefer to use the names, is less confusing and easier to debug."}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559122840, "post_id": 56357137, "comment_id": 99318889, "body": "It isn&#39;t the same and I cannot guarantee that it will have the same position in the workbook in the future. It comes from an external source. The figure is presented in sheet(1) always."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 1, "creation_date": 1559123743, "post_id": 56357137, "comment_id": 99319459, "body": "<i>I thought of creating an array that is based on the databodyrange and then removing the first element of the array, but that seems to be overkill.</i> - If you are building a stable application there is no such thing as overkill.  Build structured, well-documented code always.  It will save you time in the long run!"}], "answers": [{"comments": [{"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1559122904, "post_id": 56357409, "comment_id": 99318931, "body": "That was my original code before I found the issue. Originally I defined them as ranges and did not specify a range within my databodyrange. This does mess up my graph as the first value in my ranges is empty, hence my problem."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1559123336, "post_id": 56357409, "comment_id": 99319211, "body": "Without specifying a range for DataBodyRange (which if i do, seems to be messing the chart), rng_pf and others have the right range... (2 to last row). all rng_pf is full, no empty values... where you get empty value? in the chart itself?"}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1559123824, "post_id": 56357409, "comment_id": 99319512, "body": "Added picture of the listobject. I could just remove the first row, but I prefer not messing with the original date."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1559123885, "post_id": 56357409, "comment_id": 99319553, "body": "Ah... missed the fact you are trying to get rid of the first row under the header... oh well. Let&#39;s rethink this."}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1559126763, "post_id": 56357409, "comment_id": 99321074, "body": "It is perfect! Just fyi you duplicated the name of ranges in your solution."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1559126856, "post_id": 56357409, "comment_id": 99321127, "body": "Copy/Paste fail... I`ll correct the answer, thanks for pointing out."}, {"owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559139482, "post_id": 56357409, "comment_id": 99328726, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/194122/discussion-between-blackbear-and-darxyde\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "edited": false, "score": 0, "creation_date": 1559147387, "post_id": 56357409, "comment_id": 99333100, "body": "@BlackBear I feel bad for not having done that in the first place... oh well, done :)"}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": true, "score": 1, "last_activity_date": 1559147340, "last_edit_date": 1559147340, "creation_date": 1559122457, "answer_id": 56357409, "question_id": 56357137, "link": "https://stackoverflow.com/questions/56357137/creating-a-a-range-within-a-databodyrange/56357409#56357409", "title": "Creating a a range within a databodyrange", "body": "<p>You should define ranges a bit better, but meanwhile give this a try?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub UpdateGraph()\n\nDim rng_pf As Range, rng_bm As Range, rng_date As Range\n\n' Defining ranges\nWith ThisWorkbook.Sheets(\"Time series\")\n        With .ListObjects(1)\n            With .ListColumns(\"PF\")\n                Set rng_pf = .DataBodyRange.Offset(1, 0).Resize(.DataBodyRange.Rows.Count - 1, 1)\n            End With\n            With .ListColumns(\"BM\")\n                Set rng_bm = .DataBodyRange.Offset(1, 0).Resize(.DataBodyRange.Rows.Count - 1, 1)\n            End With\n            With .ListColumns(\"Date\")\n                Set rng_date = .DataBodyRange.Offset(1, 0).Resize(.DataBodyRange.Rows.Count - 1, 1)\n            End With\n        End With\nEnd With\n\n' Updating chart\nWith Sheets(1).ChartObjects(\"Chart 1\").Chart\n    .FullSeriesCollection(1).Values = rng_pf\n    .FullSeriesCollection(2).Values = rng_bm\n    .FullSeriesCollection(1).XValues = rng_date\n    .FullSeriesCollection(2).XValues = rng_date\nEnd With\n\nEnd Sub\n```vba\n\n**EDIT:** minor code cleanup as per OP suggestion.\n</code></pre>\n"}], "owner": {"reputation": 275, "user_id": 10506372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4352215e71f341fca321250004b14f?s=128&d=identicon&r=PG&f=1", "display_name": "BlackBear", "link": "https://stackoverflow.com/users/10506372/blackbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56357409, "answer_count": 1, "score": 0, "last_activity_date": 1559147340, "creation_date": 1559121594, "last_edit_date": 1559147084, "question_id": 56357137, "link": "https://stackoverflow.com/questions/56357137/creating-a-a-range-within-a-databodyrange", "title": "Creating a a range within a databodyrange", "body": "<p>I have a sub that updates a graph with the series based within a table. However, the first row of the table is blank and I want to omit that from my series collection. I thought of creating a range within my databody range and use that. This is my code:</p>\n\n<pre><code>Sub UpdateGraph()\n\nDim rng_pf As Variant, rng_bm As Variant, rng_date As Variant,\nDim lr as integer\n\n' Defining ranges\nWith ThisWorkbook.Sheets(\"Time series\")\n         lr = .ListObjects(1).ListColumns(1).Range.Rows.Count + 6 ' This corresponds to the last row in my table\n         rng_pf = .ListObjects(1).ListColumns(\"PF\").DataBodyRange(2, lr) ' &lt;-- This doesnt work\n         rng_bm = .ListObjects(1).ListColumns(\"BM\").DataBodyRange(2, lr)\n         rng_date = .ListObjects(1).ListColumns(\"Date\").DataBodyRange(2, lr)\nEnd With\n\n' Updating chart\nWith Sheets(1).ChartObjects(\"Chart 1\").Chart\n    .FullSeriesCollection(1).Values = rng_pf\n    .FullSeriesCollection(2).Values = rng_bm\n    .FullSeriesCollection(1).XValues = rng_date\n    .FullSeriesCollection(2).XValues = rng_date\nEnd With\n\nEnd sub\n</code></pre>\n\n<p>I thought of creating an array that is based on the databodyrange and then removing the first element of the array, but that seems to be overkill.\nWhen running my code I get that rng_pf is <code>Empty</code>.\nMy table:\n<a href=\"https://i.stack.imgur.com/x18wB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x18wB.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "filter", "pivot-table", "rank"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559120828, "post_id": 56356652, "comment_id": 99317751, "body": "Have you tried <code>RANK</code> formula? See <a href=\"https://www.contextures.com/excel-functions-rank.html\" rel=\"nofollow noreferrer\">here</a>. After that, just filter on Rank = 1 i guess."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559120938, "post_id": 56356652, "comment_id": 99317802, "body": "You can apply Filter on Rank 1."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 10483485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309556070811d2af16b7d1103cc57353?s=128&d=identicon&r=PG&f=1", "display_name": "seaside_escape", "link": "https://stackoverflow.com/users/10483485/seaside-escape"}, "edited": false, "score": 0, "creation_date": 1559127301, "post_id": 56358039, "comment_id": 99321365, "body": "Thank you.  I hadn&#39;t thought about the Top x Count option.  That works perfectly for what I need."}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1559124430, "creation_date": 1559124430, "answer_id": 56358039, "question_id": 56356652, "link": "https://stackoverflow.com/questions/56356652/how-can-i-set-an-excel-pivot-table-to-show-just-rank-1-via-vba/56358039#56358039", "title": "How can I set an Excel Pivot Table to show just Rank 1 via VBA?", "body": "<p>You can apply a filter \"Top 1 Count\" to the PivotField like this:</p>\n\n<pre><code>With ActiveSheet.PivotTables(1)\n    .PivotFields(\"Object\").PivotFilters.Add2 _\n        Type:=xlTopCount, _\n        Value1:=1, _\n        DataField:=.DataFields(1)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 10483485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309556070811d2af16b7d1103cc57353?s=128&d=identicon&r=PG&f=1", "display_name": "seaside_escape", "link": "https://stackoverflow.com/users/10483485/seaside-escape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56358039, "answer_count": 1, "score": 1, "last_activity_date": 1559126792, "creation_date": 1559120046, "last_edit_date": 1559126792, "question_id": 56356652, "link": "https://stackoverflow.com/questions/56356652/how-can-i-set-an-excel-pivot-table-to-show-just-rank-1-via-vba", "title": "How can I set an Excel Pivot Table to show just Rank 1 via VBA?", "body": "<p>I have a list of Objects and I want to see the most used object. I know I could write a formula for this, if there was only 1 object which had the most use, but sometimes the results are tied and we can have 2, 3, 4... objects all used the same amount of times.</p>\n\n<p>Therefore I believe a Pivot, using Ranking, could be the best way to present the results - as long as I can filter on all Objects with RANK 1.</p>\n\n<p>However, I can't seem to work out how to get the Pivot to just display RANK 1 results.\nFor example, below is the data source;</p>\n\n<pre><code>Object\nPencil\nPencil\nPencil\nPaper\nPaper\nPaper\nRuler\nRuler\nRubber\n</code></pre>\n\n<p>When put into a Pivot you would get:</p>\n\n<pre><code>Object  Vol.  Rank\nPencil  3     1\nPaper   3     1\nRuler   2     2\nRubber  1     3\n</code></pre>\n\n<p>How do I get the Pivot to only display RANK 1.\nAnd how would I write this in Excel VBA?</p>\n"}, {"tags": ["vba", "ms-word", "clipboard", "rtf"], "comments": [{"owner": {"reputation": 656, "user_id": 2103337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0SDOA.jpg?s=128&g=1", "display_name": "supajason", "link": "https://stackoverflow.com/users/2103337/supajason"}, "edited": false, "score": 0, "creation_date": 1559121267, "post_id": 56356636, "comment_id": 99318004, "body": "If you paste it will ctrl + v does it paste with formatting?"}, {"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559121312, "post_id": 56356636, "comment_id": 99318033, "body": "This question might help: <a href=\"https://stackoverflow.com/questions/38674641/excel-vba-copy-cell-contents-to-a-inkedit-text-box-and-keep-for-formatting-inclu\">Excel VBA copy Cell contents to a InkEdit text box and keep for formatting including colour/bold etc</a>"}, {"owner": {"reputation": 3, "user_id": 8826363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222b3aa126846f390f53f522fe3353a9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/8826363/dada"}, "edited": false, "score": 0, "creation_date": 1559121345, "post_id": 56356636, "comment_id": 99318052, "body": "Yes manually with CTRL+V it does paste with formatting"}, {"owner": {"reputation": 3, "user_id": 8826363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222b3aa126846f390f53f522fe3353a9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/8826363/dada"}, "reply_to_user": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559121506, "post_id": 56356636, "comment_id": 99318141, "body": "@erazorv4 great link but will it keep picture and for example table ?"}, {"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559122112, "post_id": 56356636, "comment_id": 99318483, "body": "Not sure but try the top answer, If you edit that one, it looks like it might work. Edit: Just realised there are 2 top answers. I mean the answer from @Comintern"}, {"owner": {"reputation": 3, "user_id": 8826363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222b3aa126846f390f53f522fe3353a9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/8826363/dada"}, "edited": false, "score": 0, "creation_date": 1559122451, "post_id": 56356636, "comment_id": 99318674, "body": "Nice one indeed, i think it might work just how to tell what is my range as it a copy from word ?"}, {"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559122572, "post_id": 56356636, "comment_id": 99318734, "body": "If you already have it in your clipboard, you should not need the copy part. Only the paste part."}, {"owner": {"reputation": 3, "user_id": 8826363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222b3aa126846f390f53f522fe3353a9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/8826363/dada"}, "edited": false, "score": 0, "creation_date": 1559122823, "post_id": 56356636, "comment_id": 99318877, "body": "It&#39;s working thanks !"}, {"owner": {"reputation": 3, "user_id": 8826363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222b3aa126846f390f53f522fe3353a9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/8826363/dada"}, "edited": false, "score": 0, "creation_date": 1559122850, "post_id": 56356636, "comment_id": 99318899, "body": "Now do you know if i can remove pictures from this paste ?"}, {"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559123226, "post_id": 56356636, "comment_id": 99319138, "body": "Sorry no idea how to do that. Maybe one of the other answers doesn&#39;t include pictures, but I&#39;m not sure."}], "owner": {"reputation": 3, "user_id": 8826363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222b3aa126846f390f53f522fe3353a9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/8826363/dada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574244509, "creation_date": 1559120001, "last_edit_date": 1574244509, "question_id": 56356636, "link": "https://stackoverflow.com/questions/56356636/getfromclipboard-and-keep-format-in-a-richtextbox", "title": "GetFromClipboard and keep format in a RichTextBox", "body": "<p>I run into a issue while pasting something in my InkEdit component.</p>\n\n<p>I'm trying to copy and paste some text from a Word document. This text have style. </p>\n\n<p>When I paste it like this : </p>\n\n<pre><code>Dim MyData As DataObject\n\nPrivate Sub CommandButton1_Click()\n   MyData.GetFromClipboard\n   InkEdit1.TextRTF = MyData.GetText(1)\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n   Set MyData = New DataObject\nEnd Sub\n</code></pre>\n\n<p>The style is gone. Is there a way to get the text and paste it with the style ? Thanks.</p>\n"}, {"tags": ["excel", "vba", "array-formulas"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1559120062, "post_id": 56356574, "comment_id": 99317300, "body": "Shouldn&#39;t you include <code>=</code> before Sum ?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1559120095, "post_id": 56356574, "comment_id": 99317319, "body": "The code executes, it does not arises any errors, but it does nothing, and formulas don&#39;t work. I had a similar issue in the past. Please, check <a href=\"https://stackoverflow.com/questions/51196290/error-1004-when-trying-to-use-formulaarray-replace-trick-does-not-work\" title=\"error 1004 when trying to use formulaarray replace trick does not work\">stackoverflow.com/questions/51196290/&hellip;</a>"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559120105, "post_id": 56356574, "comment_id": 99317326, "body": "@MohitBansal the <code>=</code> is already there..."}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559120320, "post_id": 56356574, "comment_id": 99317457, "body": "@FoxfireAndBurnsAndBurns that worked! Thank you a lot! If you post your solution as an answer I&#39;ll accept it!"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559120535, "post_id": 56356574, "comment_id": 99317572, "body": "I tried on my Sheet .... Using <code>&quot;TEST1&quot;</code> this worked instead of <code>&quot;&quot;&quot;TEST1&quot;&quot;&quot;</code>."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559120721, "post_id": 56356574, "comment_id": 99317678, "body": "Glad it worked, but it&#39;s not my answer, this question is a duplicate. :)"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1559137952, "post_id": 56356574, "comment_id": 99327779, "body": "Yep! I guess I didn&#39;t do my research properly. Thanks anyway!"}], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1559137880, "answer_count": 0, "score": 0, "last_activity_date": 1559119809, "creation_date": 1559119809, "question_id": 56356574, "link": "https://stackoverflow.com/questions/56356574/vba-insert-big-array-formula-problem-with-replaces", "closed_reason": "Duplicate", "title": "VBA insert big array formula - problem with replaces", "body": "<p>Recently I came across an <code>Excel</code> limitation and learned that we can't write an array formula with more than 255 characters long directly on a cell using <code>VBA</code>.\nThe solution for this problem as I found on the web (including on SO: <a href=\"https://stackoverflow.com/questions/30105324/error-unable-to-set-the-formulaarray-property-of-the-range-class\">here</a>), is replacing parts of the formula once it's inserted on the cell.</p>\n\n<p>Here's what I'm trying to do:</p>\n\n<pre><code>Sub WriteFormulaArray()\n    '------\n        Dim SH As Worksheet: Set SH = ThisWorkbook.ActiveSheet\n    '------\n        Dim StrF1 As String: StrF1 = \"=IFERROR(\"\"PART2\"\"/\"\"PART3\"\",\"\"PART4\"\")\"\n        Dim StrF2 As String: StrF2 = \"SUMPRODUCT(IF(('01 - Hist\u00f3rico'!R5C6:R101641C6&gt;=RC1-1)*('01 - Hist\u00f3rico'!R5C6:R101641C6&lt;RC1+1)*('01 - Hist\u00f3rico'!R5C8:R101641C8&gt;=R4C-0.125)*('01 - Hist\u00f3rico'!R5C8:R101641C8&lt;R4C+0.125),'01 - Hist\u00f3rico'!R5C5:R101641C5),'01 - Hist\u00f3rico'!R5C10:R101641C10)\"\n        Dim StrF3 As String: StrF3 = \"SUM(IF(('01 - Hist\u00f3rico'!R5C6:R101641C6&gt;=RC1-1)*('01 - Hist\u00f3rico'!R5C6:R101641C6&lt;RC1+1)*('01 - Hist\u00f3rico'!R5C8:R101641C8&gt;=R4C-0.125)*('01 - Hist\u00f3rico'!R5C8:R101641C8&lt;R4C+0.125),'01 - Hist\u00f3rico'!R5C5:R101641C5))\"\n        Dim StrF4 As String: StrF4 = \"MIN(IF(('01 - Hist\u00f3rico'!R5C6:R101641C6&gt;=RC1-1)*('01 - Hist\u00f3rico'!R5C6:R101641C6&lt;RC1+1),'01 - Hist\u00f3rico'!R5C10:R101641C10))\"\n    '------\n        SH.Cells(5, 2).FormulaArray = StrF1\n        SH.Cells(5, 2).Replace \"\"\"PART2\"\"\", StrF2, LookAt:=xlPart\n        SH.Cells(5, 2).Replace \"\"\"PART3\"\"\", StrF3, LookAt:=xlPart\n        SH.Cells(5, 2).Replace \"\"\"PART4\"\"\", StrF4, LookAt:=xlPart\n    '------\nEnd Sub\n</code></pre>\n\n<p>Well, the previous code is very hard to analyse because of the length and complexity of the formulas, but the routine doesn't do any of the replacements and writes just</p>\n\n<pre><code>{=IFERROR(\"PART2\"/\"PART3\",\"PART4\")}\n</code></pre>\n\n<p>on cell <code>B5</code> (and returns correctly <code>\"PART4\"</code>).</p>\n\n<p>Then I tried to simplify the code to find the problem:</p>\n\n<pre><code>Sub WriteFormulaArrayTest()\n    '------\n        Dim SH As Worksheet: Set SH = ThisWorkbook.ActiveSheet\n    '------\n        SH.Cells(6, 2).FormulaArray = \"=\"\"TEST1\"\"\"\n        SH.Cells(6, 2).Replace \"\"\"TEST1\"\"\", \"\"\"TEST2\"\"\", LookAt:=xlPart\n    '------\nEnd Sub\n</code></pre>\n\n<p>And it works just fine.\nBut when I write:</p>\n\n<pre><code>Sub WriteFormulaArrayTest()\n    '------\n        Dim SH As Worksheet: Set SH = ThisWorkbook.ActiveSheet\n    '------\n        SH.Cells(6, 2).FormulaArray = \"=\"\"TEST1\"\"\"\n        SH.Cells(6, 2).Replace \"\"\"TEST1\"\"\", \"SUM(R5C6:R5C7)\", LookAt:=xlPart\n    '------\nEnd Sub\n</code></pre>\n\n<p>the replace doesn't work again and I have the feeling that's the same problem of the first code.</p>\n\n<p>Please note that the routine doesn't give any errors. It just simply doesn't do the replacements.</p>\n\n<p>What am I missing here?? Thanks.</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1559118575, "post_id": 56356142, "comment_id": 99316509, "body": "please see <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559118601, "post_id": 56356142, "comment_id": 99316523, "body": "You need to give a lot more information including the code and what you have tried so far"}, {"owner": {"reputation": 53, "user_id": 10218602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098e6232f3f47f4c1629171e34e5e3f2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakingfaith", "link": "https://stackoverflow.com/users/10218602/breakingfaith"}, "edited": false, "score": 0, "creation_date": 1559118675, "post_id": 56356142, "comment_id": 99316561, "body": "So Sorry, completely forgot to add it! D&#39;oh clearly need another coffee"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1559119382, "post_id": 56356142, "comment_id": 99316892, "body": "Not your problem but some improvement, change: <code>Range(&quot;B&quot; &amp; RowToPasteTo &amp; &quot;:&quot; &amp; &quot;Z&quot; &amp; RowToPasteTo).Select With Selection.Borders</code> for: <code>With Range(&quot;B&quot; &amp; RowToPasteTo &amp; &quot;:&quot; &amp; &quot;Z&quot; &amp; RowToPasteTo).Borders</code> Also is a good idea to full qualify your ranges (workbook and sheet where that range belongs)"}, {"owner": {"reputation": 53, "user_id": 10218602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098e6232f3f47f4c1629171e34e5e3f2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakingfaith", "link": "https://stackoverflow.com/users/10218602/breakingfaith"}, "edited": false, "score": 0, "creation_date": 1559119596, "post_id": 56356142, "comment_id": 99317001, "body": "I completely agree. I probably should have mentioned  I have it qualified in another sub and was going to reference it but forgot - really not my morning aha  On note with your improvement Damian, VBA is returning a Compile error: Invalid Use of Property"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559119742, "post_id": 56356142, "comment_id": 99317099, "body": "<code>.Borders</code> require an argument (i.e.<code>.Borders(xlEdgeBottom)</code>), see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.borders\" rel=\"nofollow noreferrer\">Borders</a>"}, {"owner": {"reputation": 5572, "user_id": 3375670, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dftd9.jpg?s=128&g=1", "display_name": "Robert Kock", "link": "https://stackoverflow.com/users/3375670/robert-kock"}, "edited": false, "score": 0, "creation_date": 1559119770, "post_id": 56356142, "comment_id": 99317120, "body": "Have a look at this. Not sure whether it&#39;s the same problem: <a href=\"https://stackoverflow.com/questions/45054857/run-time-error-1004-unable-to-set-line-style-property-of-border-class-in-vba\" title=\"run time error 1004 unable to set line style property of border class in vba\">stackoverflow.com/questions/45054857/&hellip;</a>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559119794, "post_id": 56356142, "comment_id": 99317138, "body": "You are using a <code>With</code> inside another <code>With</code>. I think line <code>Range(&quot;B&quot; &amp; RowToPasteTo &amp; &quot;:&quot; &amp; &quot;Z&quot; &amp; RowToPasteTo).Select</code> should have a dot at start, or it will take the range in whatever the activesheet is, instead of the range in sheet(4)."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559119881, "post_id": 56356142, "comment_id": 99317188, "body": "I did try your code in my  workbook and it works, doesn&#39;t change a thing because <code>.TintAndShade</code> overrides <code>.ThemeColor</code> and that leaves the cell the same way, but no errors at all on my sheet."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559120320, "post_id": 56356142, "comment_id": 99317456, "body": "@MimiBeard could you please add the code calling this sub? because there are no errors when running it like this, and also what is your goal on adding borders? your sheet has no borders? Because this code inputs the default borders that come with the sheet, if you unchecked the square view has sense, otherwise it does not."}, {"owner": {"reputation": 53, "user_id": 10218602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098e6232f3f47f4c1629171e34e5e3f2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakingfaith", "link": "https://stackoverflow.com/users/10218602/breakingfaith"}, "edited": false, "score": 0, "creation_date": 1559120618, "post_id": 56356142, "comment_id": 99317624, "body": "I am very confused! I have done all these amendments and its still coming up with the Line Style Error.  Additionally I just created a new sheet (and then changed the with sheets number accordingly) and it comes up with a different error all together."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559124733, "post_id": 56356142, "comment_id": 99320004, "body": "@MimiBeard I edited my answer with your new info, does my way work?"}, {"owner": {"reputation": 53, "user_id": 10218602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098e6232f3f47f4c1629171e34e5e3f2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakingfaith", "link": "https://stackoverflow.com/users/10218602/breakingfaith"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559125717, "post_id": 56356142, "comment_id": 99320518, "body": "@Damian yep! It&#39;s beautiful thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1559120949, "post_id": 56356769, "comment_id": 99317809, "body": "I think that the OP&#39;s want to mark all the edges, so there is no need to go 1 by 1, without writting one specific border VBA will print them all. Using the left/right/top/bottom is to scope them, if you need all of them there is no need."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559121189, "post_id": 56356769, "comment_id": 99317956, "body": "Thanks Damian, you are correct... my experience with formatting is somewhat limited, as I avoid it as much as possible."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1559121422, "post_id": 56356769, "comment_id": 99318101, "body": "No problem I hate formatting also, actually I just found out that by trying the OP&#39;s code hahaha..."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 1, "last_activity_date": 1559121451, "last_edit_date": 1559121451, "creation_date": 1559120370, "answer_id": 56356769, "question_id": 56356142, "link": "https://stackoverflow.com/questions/56356142/vba-how-to-automatically-include-cell-borders-without-error-runtime-1004-line/56356769#56356769", "title": "VBA: How to Automatically Include Cell Borders Without Error (Runtime 1004) Line Style", "body": "<p>As said above, <code>.Borders</code> require at least 1 argument to work. One way to achieve what you are trying to do is:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Borders()\n\nDim RowToPasteTo As Long\n\nWith Sheets(4)\n\n    RowToPasteTo = .Cells(.Rows.Count, \"B\").End(xlUp).Row + 1\n\n    For X = 1 To 4\n        With .Range(\"B\" &amp; RowToPasteTo &amp; \":\" &amp; \"Z\" &amp; RowToPasteTo).Borders(X)\n            .LineStyle = xlContinuous\n            .ColorIndex = 3\n            .Weight = xlThin\n        End With\n    Next X\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Correction</strong> as per @Damian's comment, though the above is perfectly usable as well:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Borders()\n\nDim RowToPasteTo As Long\n\nWith Sheets(\"Sheet1\")\n\n    RowToPasteTo = .Cells(.Rows.Count, \"B\").End(xlUp).Row + 1\n    With .Range(\"B\" &amp; RowToPasteTo &amp; \":\" &amp; \"Z\" &amp; RowToPasteTo).Borders\n        .LineStyle = xlContinuous\n        .ColorIndex = 3\n        .Weight = xlThin\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.borders\" rel=\"nofollow noreferrer\">Borders</a> for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 1, "last_activity_date": 1559124715, "last_edit_date": 1559124715, "creation_date": 1559120628, "answer_id": 56356838, "question_id": 56356142, "link": "https://stackoverflow.com/questions/56356142/vba-how-to-automatically-include-cell-borders-without-error-runtime-1004-line/56356838#56356838", "title": "VBA: How to Automatically Include Cell Borders Without Error (Runtime 1004) Line Style", "body": "<p>I think there is something going on from the main sub calling the border sub. To avoid these kind of problems you need to full qualify all your ranges, another way is to do this:</p>\n\n<pre><code>Option Explicit\nSub ToTank()\n\n    Dim RowToPasteTo As Long\n\n    With ThisWorkbook.Sheets(4) 'If the code runs for the same workbook the code is in\n        RowToPasteTo = .Cells(.Rows.Count, \"B\").End(xlUp).Row + 1\n        .Unprotect\n        Borders .Range(\"B\" &amp; RowToPasteTo &amp; \":\" &amp; \"Z\" &amp; RowToPasteTo) 'call the procedure inserting the borders passing the range you need\n    End With\n\nEnd Sub\nSub Borders(MyRange As Range)\n\n    With MyRange.Borders\n        .LineStyle = xlContinuous\n        .ThemeColor = 3\n        .TintAndShade = -9.99786370433668E-02\n        .Weight = xlThin\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This way you can always call the <code>Borders</code> sub giving the range you want without any modifications. You could also make variables the <code>LineStyle</code> and all the properties you need by passing more arguments.</p>\n"}], "owner": {"reputation": 53, "user_id": 10218602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098e6232f3f47f4c1629171e34e5e3f2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakingfaith", "link": "https://stackoverflow.com/users/10218602/breakingfaith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 56356838, "answer_count": 2, "score": 0, "last_activity_date": 1559124715, "creation_date": 1559118343, "last_edit_date": 1559121038, "question_id": 56356142, "link": "https://stackoverflow.com/questions/56356142/vba-how-to-automatically-include-cell-borders-without-error-runtime-1004-line", "title": "VBA: How to Automatically Include Cell Borders Without Error (Runtime 1004) Line Style", "body": "<p>So this a question about the same big project my others are. </p>\n\n<p>I am now just tidying up some formatting and essentially want a sub (that I can call from another) which will automatically add the borders I need around the new data being posted to the sheet. </p>\n\n<p>I recorded the macro of adding the borders (and changed the range to one that is variable - RowToPasteTo) and all was working well. </p>\n\n<p>I tried to call it from another piece of code and it went haywire, now giving me an error of:</p>\n\n<p><code>Run-Time error '1004':</code></p>\n\n<p><code>Unable to set the LineStyle Property of the Borders class</code></p>\n\n<p>As the error mentions, it seems to be an error with the <code>.LineStyle</code> but I am using the same style as what their recorder gave me.</p>\n\n<p>How can I get this working again so that is completes all borders?</p>\n\n<p>EDIT: Forgot to add the code - sorry!</p>\n\n<pre><code>Sub Borders()\n\nDim RowToPasteTo As Long\n\nWith Sheets(4)\n\n RowToPasteTo = .Cells(.Rows.Count, \"B\").End(xlUp).Row + 1\n Range(\"B\" &amp; RowToPasteTo &amp; \":\" &amp; \"Z\" &amp; RowToPasteTo).Select\n  With Selection.Borders\n    .LineStyle = xlContinuous\n    .ThemeColor = 3\n    .TintAndShade = -9.99786370433668E-02\n    .Weight = xlThin\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>EDIT 2: This piece of code is to insert the borders when each new row of data is moved to this sheet (grid marks are off, as the borders are only to be shown on the lines with data. </p>\n\n<p>I have tried all amendments so far suggested and am still receiving errors when running the above code alone. </p>\n\n<p>I have now also created a blank sheet (and adjusted the sheets number accordingly) and I receive a different error there. </p>\n\n<p>The (minimised) code that will later call this piece if as follows:</p>\n\n<pre><code>Sub ToTank()\nDim RowToPasteTo As Long\n        RowToPasteTo = .Cells(.Rows.Count, \"B\").End(xlUp).Row + 1\n\n        Sheets(4).Unprotect\n        .Range(\"A\" &amp; RowToPasteTo &amp; \":\" &amp; \"Z\" &amp; RowToPasteTo).Locked = False\nCall Borders()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559118412, "post_id": 56355990, "comment_id": 99316417, "body": "I think the problem is that when you are trying with one cell, VBA knows which exact cell to color, but when you are trying to add multiple cells, VBA doesn&#39;t know which cell to color as there is no mapping provided in both cells. I will suggest use of arrays in this case."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1559118468, "post_id": 56355990, "comment_id": 99316446, "body": "Would this not be much easier with Conditional Formatting?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559118801, "post_id": 56355990, "comment_id": 99316620, "body": "Try the code I have answered, It should work. If not comment the line it throws error on."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559118897, "post_id": 56355990, "comment_id": 99316663, "body": "@Gareth .. I think the mapping is not constant... like a 2 after 5 .... so Conditional Formatting work not work as no option to formulate a formula for Conditional formatting."}, {"owner": {"reputation": 11, "user_id": 9152324, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918045553604/picture?type=large", "display_name": "Richard Had A Portable-telli", "link": "https://stackoverflow.com/users/9152324/richard-had-a-portable-telli"}, "edited": false, "score": 0, "creation_date": 1559367940, "post_id": 56355990, "comment_id": 99406359, "body": "@Gareth I did go down the route of Conditional Formatting but, I need the flexibility in being able to add additional background colours to the cells after the initial orange colouring. This needs to be done in an instant and so I do not have the time to clear each individual cell of it&#39;s conditional formatting to then change the cell colour."}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 11100142, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XdEQK6VB4hY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOh324gfbc__WozjCwMcg1wPSjnFQ/mo/photo.jpg?sz=128", "display_name": "vanq", "link": "https://stackoverflow.com/users/11100142/vanq"}, "is_accepted": false, "score": 0, "last_activity_date": 1559122474, "last_edit_date": 1559122474, "creation_date": 1559118341, "answer_id": 56356141, "question_id": 56355990, "link": "https://stackoverflow.com/questions/56355990/if-statement-within-look-error-13-type-error/56356141#56356141", "title": "If statement within look error 13 - type error", "body": "<p>Try this </p>\n\n<pre><code>Set r3FTop = Worksheets(\"mapOut\").Range(\"X5, X2\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9152324, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918045553604/picture?type=large", "display_name": "Richard Had A Portable-telli", "link": "https://stackoverflow.com/users/9152324/richard-had-a-portable-telli"}, "edited": false, "score": 0, "creation_date": 1559367509, "post_id": 56356259, "comment_id": 99406304, "body": "Thank you for taking the time to provide an alternative answer to my issue. Albeit with the above I am still experiencing the same mismatch error at:      If rRng.Value = False Then  My thinking that even an #N/A value should be picked up by the else part of my if statement . . ."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1559118724, "creation_date": 1559118724, "answer_id": 56356259, "question_id": 56355990, "link": "https://stackoverflow.com/questions/56355990/if-statement-within-look-error-13-type-error/56356259#56356259", "title": "If statement within look error 13 - type error", "body": "<p>This should Work now:</p>\n\n<pre><code>Sub toCheckOut()\n\nDim rCell As Range\nDim rRng As Range\nDim r3FTop As Range\nDim arr(1) as String\nDim i as Integer\n\ni = 0\n\n ' check out check column\nSet rRng = Worksheets(\"mapOut\").Range(\"DO2:DO3\")\n\narr(0) = \"5\"\narr(1) = \"2\"\n'Set r3FTop = Worksheets(\"mapOut\").Range(\"X5\", \"X2\")\n\nFor Each rCell In rRng.Cells\n    If rRng.Value = False Then\n        GoTo Continue\n\n    ElseIf rRng.Value = True Then\n         Worksheets(\"mapOut\").Range(\"X\" &amp; arr(i)).Interior.Color = RGB(237, 125, 49)\n         i = i + 1\n    Else\n        GoTo Continue\n\n    End If\n\nContinue:\n\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9152324, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918045553604/picture?type=large", "display_name": "Richard Had A Portable-telli", "link": "https://stackoverflow.com/users/9152324/richard-had-a-portable-telli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 622, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559168644, "creation_date": 1559117859, "last_edit_date": 1559168644, "question_id": 56355990, "link": "https://stackoverflow.com/questions/56355990/if-statement-within-look-error-13-type-error", "title": "If statement within look error 13 - type error", "body": "<p>I have boolean or #N/A values in column DO. If a True boolean is within the DO column range, I wish for the corresponding cell in range r3FTop to be changed to the colour as per my code. My thinking is that DO2 cell corresponds to X5, and the D03 to X2.</p>\n\n<p>When i run this code with </p>\n\n<pre><code>Set rRng = Worksheets(\"mapOut\").Range(\"DO2:DO2\") and \nSet r3FTop = Worksheets(\"mapOut\").Range(\"X5\")\n</code></pre>\n\n<p>the code works fine (cells turn to orange when the cell value at DO2 is True and don't when the cell value is False or #N/A). However upon adding the next cell in each range (DO3 and X2) I keep getting the type 13 error.</p>\n\n<p>I've tried the bottom on the first row and it colours the cell at X5 perfectly. I run into problems when I try and add a second cell to the range.</p>\n\n<p>For ease of use I have opted to batch the cell references I wish to colour in a group as they appear on screen.</p>\n\n<pre><code>Sub toCheckOut()\n\nDim rCell As Range\nDim rRng As Range\nDim r3FTop As Range\n\n' check out check column\nSet rRng = Worksheets(\"mapOut\").Range(\"DO2:DO3\")\n\n\nSet r3FTop = Worksheets(\"mapOut\").Range(\"X5\", \"X2\")\n\nFor Each rCell In rRng.Cells\n    If rRng.Value = False Then\n        GoTo Continue\n\n    ElseIf rRng.Value = True Then\n        r3FTop.Interior.Color = RGB(237, 125, 49)\n\n    Else\n        GoTo Continue\n\n    End If\n\nContinue:\n\n    Next rCell\n\nEnd Sub\n</code></pre>\n\n<p>My actual column range is DO2:DO90 and I have corresponding cell values for r3FTop variable too. I wish for the code to go though and disregard and #N/A or False values and only change corresponding cell colors when a True boolean is found.</p>\n\n<p>I've tried rewriting the above code so that the True boolean is dealt with first as so with dealing with blanks (using application.worksheet.isna(rRng). </p>\n\n<p>Any pointers would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559117409, "post_id": 56355803, "comment_id": 99315865, "body": "Could you share what you tried so far, and what you&#39;re getting stuck on."}, {"owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "reply_to_user": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559117657, "post_id": 56355803, "comment_id": 99316003, "body": "Here is one that I tried from a youtube video (<a href=\"https://www.youtube.com/watch?v=_jel_Otcgds&amp;t=75s\" rel=\"nofollow noreferrer\">youtube.com/watch?v=_jel_Otcgds&amp;t=75s</a>) =IF(ISNA(VLOOKUP(ROW(A1),$A$1:$A$20,1,FALSE)),ROW(A1),&quot;&quot;)"}, {"owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "reply_to_user": {"reputation": 374, "user_id": 11333965, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kX6ChNKPbZQ/AAAAAAAAAAI/AAAAAAAAAEU/Z5ZFx29rLzI/photo.jpg?sz=128", "display_name": "erazorv4", "link": "https://stackoverflow.com/users/11333965/erazorv4"}, "edited": false, "score": 0, "creation_date": 1559118015, "post_id": 56355803, "comment_id": 99316187, "body": "What I am looking for is to change the range that the formula or vba code is looking at, to a specific number I choose.  For example, from the video link above, they are choosing a range from 1-12.  I want the range to be from 1-30, but still only have those same numbers (1, 2, 4, 5, 6, 7, 9, 10, 12).  So my missing numbers would be everything missing from 1-30.  I also want to make sure that the range starts at 1, even if my first value does not."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1559118740, "post_id": 56355803, "comment_id": 99316580, "body": "Please, do not post formulas or code in comments. Edit your question. Also, you&#39;ve tagged the question as VBA, so post the code you&#39;ve tried."}, {"owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559523651, "post_id": 56355803, "comment_id": 99435578, "body": "@Foxfire and Burns and Burns, okay, I will not make the mistake again."}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1559118685, "creation_date": 1559118685, "answer_id": 56356245, "question_id": 56355803, "link": "https://stackoverflow.com/questions/56355803/finding-missing-numbers-in-a-preset-range/56356245#56356245", "title": "Finding missing numbers in a preset range", "body": "<p>this is how VBA code would be:</p>\n\n<pre><code>Option Explicit\nSub MissingNumbers()\n\n    Dim C As Range\n    Dim LastRow As Long\n    Dim FirstNumber As Long\n    Dim LastNumber As Long\n    Dim i As Long\n    Dim MyNumbers As New Scripting.Dictionary 'Need Microsoft Scripting Runtime library checked on references\n\n    FirstNumber = 1 'here goes your first number to check\n    LastNumber = 30 'here goes the last number to check\n\n    'Assume you have a column A with all the values and column B will hold the missing ones\n    With ThisWorkbook.Sheets(\"MySheet\") 'Change MySheet for your working sheet name\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row 'Last Row on column A\n        'Store your existing numbers in the dictionary\n        For Each C In .Range(\"A2:A\" &amp; LastRow) 'I'm assuming you have headers on row 1\n            MyNumbers.Add C.Value, 1\n        Next C\n        LastRow = 2 'starting on row 2 for column B\n        'Loop through all the numbers you want to check\n        For i = FirstNumber To LastNumber\n            'If the number doesn't exist on the dictionary\n            If Not MyNumbers.Exists(i) Then\n                .Cells(LastRow, 2) = i 'write it on the next available row for columnB\n                LastRow = LastRow + 1 'add 1 number to last row so we don't overwrite results\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "edited": false, "score": 0, "creation_date": 1559625976, "post_id": 56356643, "comment_id": 99469286, "body": "Would this be possible to do with a date.  For example column B would be 3/4/2018, 5/4/2018 and column D would be 1/4/2018, 2/4/2018?"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "reply_to_user": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "edited": false, "score": 0, "creation_date": 1559630760, "post_id": 56356643, "comment_id": 99470888, "body": "Yes, it would need a bit of adjustment to get the start date as well as the end date, but should work the same way."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "reply_to_user": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "edited": false, "score": 0, "creation_date": 1559647773, "post_id": 56356643, "comment_id": 99479303, "body": "Have added to answer"}, {"owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "edited": false, "score": 0, "creation_date": 1559874264, "post_id": 56356643, "comment_id": 99564128, "body": "I am getting an error of <code>You&#39;ve entered too few arguments for this function</code>.  the curser is between the double parenthesis after the 0, <code>ROW(D$1)),0))</code>."}, {"owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "edited": false, "score": 0, "creation_date": 1559874445, "post_id": 56356643, "comment_id": 99564162, "body": "However, I think I have found a much easier way.  I will autofill all of the dates starting with the known starting date (<code>A2</code>).  Then use the match function to show which dates have a match with the exclusions dates.  Dates with no match will result with a <code>#N&#47;A</code>."}], "tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": true, "score": 1, "last_activity_date": 1559647761, "last_edit_date": 1559647761, "creation_date": 1559120025, "answer_id": 56356643, "question_id": 56355803, "link": "https://stackoverflow.com/questions/56355803/finding-missing-numbers-in-a-preset-range/56356643#56356643", "title": "Finding missing numbers in a preset range", "body": "<p>This is similar to the formula quoted by OP in the comment above but generalised for user-defined number of numbers:</p>\n\n<pre><code>=IFERROR(SMALL(IF(ISERROR(MATCH(ROW(A$1:INDEX(A:A,C$2)),D$2:INDEX(D:D,COUNT(D:D)+ROW(D$1)),0)),\nROW(A$1:INDEX(A:A,C$2))),ROW()-ROW(A$1)),\"\")\n</code></pre>\n\n<p>Must be entered as an array formula using <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd></p>\n\n<p><a href=\"https://i.stack.imgur.com/VoxJF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VoxJF.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>You can change the formula so that you can set both the start and end points:</p>\n\n<pre><code>=IFERROR(SMALL(IF(ISERROR(MATCH(ROW(INDEX(A:A,C$2):INDEX(A:A,C$3)),D$2:INDEX(D:D,COUNT(D:D)+ROW(D$1)),0)),\nROW(INDEX(A:A,C$2):INDEX(A:A,C$3))),ROW()-ROW(A$1)),\"\")\n</code></pre>\n\n<p>This works with dates if column B is formatted appropriately:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NSsYV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NSsYV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1559120058, "creation_date": 1559120058, "answer_id": 56356656, "question_id": 56355803, "link": "https://stackoverflow.com/questions/56355803/finding-missing-numbers-in-a-preset-range/56356656#56356656", "title": "Finding missing numbers in a preset range", "body": "<p>So here is an example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DeIaS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DeIaS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formula in <code>B2</code>:</p>\n\n<pre><code>=IFERROR(INDEX(ROW($A$1:$A$30),MATCH(0,IFERROR(MATCH(ROW($A$1:$A$30),$A$2:$A$7,0),COUNTIF($B$1:$B1,ROW($A$1:$A$30))),0)),\"\")\n</code></pre>\n\n<p>Confirmed through <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd></p>\n\n<p>You can change this part <code>ROW($A$1:$A$30)</code> to your liking to include a larger range of numbers (or smaller) depending on the month.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1559120602, "creation_date": 1559120602, "answer_id": 56356828, "question_id": 56355803, "link": "https://stackoverflow.com/questions/56355803/finding-missing-numbers-in-a-preset-range/56356828#56356828", "title": "Finding missing numbers in a preset range", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRowA As Long, LastRowB As Long, i As Long, StartValue As Long, EndValue As Long\n    Dim rng As Range\n\n    StartValue = 1\n    EndValue = 30\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        LastRowA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        Set rng = .Range(\"A1:A\" &amp; LastRowA)\n\n        For i = StartValue To EndValue\n\n            If Application.WorksheetFunction.CountIf(rng, i) = 0 Then\n\n                LastRowB = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n                If LastRowB = 1 And .Range(\"B\" &amp; LastRowB).Value = \"\" Then\n                    .Range(\"B1\").Value = i\n                Else\n                    .Range(\"B\" &amp; LastRowB + 1).Value = i\n                End If\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/smq7D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/smq7D.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1044, "user_id": 10068520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18bb002969dd5d8e5cd6ed739e5f917?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowStacker", "link": "https://stackoverflow.com/users/10068520/overflowstacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1559135240, "creation_date": 1559135240, "answer_id": 56361400, "question_id": 56355803, "link": "https://stackoverflow.com/questions/56355803/finding-missing-numbers-in-a-preset-range/56361400#56361400", "title": "Finding missing numbers in a preset range", "body": "<p>a possible <a href=\"http://www.excelformeln.de/formeln.html?welcher=362\" rel=\"nofollow noreferrer\">formula solution</a> would be <strong>ARRAY FORMULA:   CTRL + SHIFT + ENTER</strong></p>\n\n<pre><code>{=SMALL(IF(COUNTIF(A:A,ROW(INDIRECT(\"1:\"&amp;MAX(A:A)-MIN(A:A)+1))+MIN(A:A)-1)=0,ROW(INDIRECT(\"1:\"&amp;MAX(A:A)-MIN(A:A)+1))+MIN(A:A)-1),ROW())}\n</code></pre>\n\n<p>Copy downwards to get all values.</p>\n"}], "owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 56356643, "answer_count": 5, "score": 0, "last_activity_date": 1559647761, "creation_date": 1559117166, "last_edit_date": 1559118863, "question_id": 56355803, "link": "https://stackoverflow.com/questions/56355803/finding-missing-numbers-in-a-preset-range", "title": "Finding missing numbers in a preset range", "body": "<p>I am having a problem finding missing values within a preset range.  For example I have:</p>\n\n<p>Column A: 3, 5, 7, 9, 10, 11\nI want either VBA or a formula in excel to return\nColumn B: 1, 2, 4, 6, 8, 12, 13 --> 30</p>\n\n<p>The final number in Column B will vary.  I want it to change based on user discretion.  For my problem I am working with days of the month.  So January, February, and March have different total days.  I've seen a lot of examples, but all are based on a array in the spreedsheet.  What if I want to change the array to 1-30, 1-31, or 1-28 (depending on which month I am looking at)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559117943, "post_id": 56355770, "comment_id": 99316152, "body": "Can you clarify your question again? Your heading says something else than your description."}], "answers": [{"comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1559118156, "post_id": 56355951, "comment_id": 99316264, "body": "I don&#39;t need to close workbook, and do not know how many books are opened"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1559119991, "post_id": 56355951, "comment_id": 99317248, "body": "@DmitrijHolkin <code>.Close</code> is just an example as you can see in the code. Moreover, assign workbook to a variable is the best approach to use a work to avoid <code>.Activate</code>"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1559117706, "creation_date": 1559117706, "answer_id": 56355951, "question_id": 56355770, "link": "https://stackoverflow.com/questions/56355770/activate-the-workbook-containing-the-code/56355951#56355951", "title": "Activate the Workbook containing the code", "body": "<p>Generally, is not a good idea to use <code>.Activate</code>. In my opinion the best way to indirect with Workbooks is to set workbooks in variables and then use that variable in a <code>With Statement</code>.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim wb1 As Workbook, wb2 As Workbook\n\n    Set wb1 = Workbooks(\"Book1\")\n    Set wb2 = Workbooks(\"Book2\")\n\n    With wb2\n        'Close is just an example\n        .Close\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 0, "last_activity_date": 1559118333, "creation_date": 1559118333, "answer_id": 56356138, "question_id": 56355770, "link": "https://stackoverflow.com/questions/56355770/activate-the-workbook-containing-the-code/56356138#56356138", "title": "Activate the Workbook containing the code", "body": "<p><code>Application</code> affects all workbooks within the current Application so I assume you have multiple Applications open and want to refer to the one where the code is running? </p>\n\n<p>If so you can use </p>\n\n<pre><code>With ThisWorkbook.Application\n</code></pre>\n\n<p>(which is good practice anyway)</p>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559128485, "creation_date": 1559117054, "last_edit_date": 1559128485, "question_id": 56355770, "link": "https://stackoverflow.com/questions/56355770/activate-the-workbook-containing-the-code", "title": "Activate the Workbook containing the code", "body": "<p>Trying to activate active workbook after UNAPP macros, but (if many workbooks are opened) activating always last opened workbook and every time is toggling (last workbook to Activeworkbook), I need to activate ALWAYS the workbook from which code is called.</p>\n\n<pre><code>Sub App()\n    With Application\n      .ScreenUpdating = False\n      .DisplayAlerts = False\n      .EnableEvents = False\n      .Calculation = xlManual\n      .Visible = False\n    End With\nEnd Sub\n\nSub unApp()\n    With Application\n      .ScreenUpdating = True\n      .DisplayAlerts = True\n      .EnableEvents = True\n      .Calculation = xlCalculationAutomatic\n      .Visible = True\n    End With\nEnd Sub\n\nSub testActivate()\n    Set wbT = ThisWorkbook\n    App\n    unApp\n    wbT.Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1559111984, "post_id": 56354325, "comment_id": 99313151, "body": "What specifically is giving you problems?"}, {"owner": {"reputation": 5, "user_id": 11571021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef504aec1a72dd39c2bd6ea14d025ea4?s=128&d=identicon&r=PG&f=1", "display_name": "nofriendsnojo", "link": "https://stackoverflow.com/users/11571021/nofriendsnojo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559172670, "post_id": 56354325, "comment_id": 99342066, "body": "I have very very limited experience working with VBA so I tried to record a macro to do the job but so far I have just been able to copy and paste the value but I want it to move/paste down one cell each time the macro is used. Here is what I have so far:       Range(&quot;G16&quot;).Select     Selection.Copy     Range(&quot;G19&quot;).Select     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _         :=False, Transpose:=False     Range(&quot;G16&quot;).Select     ActiveSheet.Paste     Application.CutCopyMode = False     Next End Sub"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559173063, "post_id": 56354325, "comment_id": 99342139, "body": "<code>Range(&quot;G16&quot;).Copy Cells(Rows.count, &quot;G&quot;).End(xlUp).Offset(1, 0)</code> will copy G16 to the next free cell below."}, {"owner": {"reputation": 5, "user_id": 11571021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef504aec1a72dd39c2bd6ea14d025ea4?s=128&d=identicon&r=PG&f=1", "display_name": "nofriendsnojo", "link": "https://stackoverflow.com/users/11571021/nofriendsnojo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559173292, "post_id": 56354325, "comment_id": 99342184, "body": "That&#39;s nearly perfect! Thanks man! Only thing is that the G16 cell that I am copying from is a formula and I am trying to copy/paste just the value that the formula reaches, is that possible?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1559173373, "creation_date": 1559173373, "answer_id": 56369879, "question_id": 56354325, "link": "https://stackoverflow.com/questions/56354325/vba-function-to-copy-text-from-a-single-un-moving-cell-to-paste-to-another-cell/56369879#56369879", "title": "VBA function to copy text from a single un-moving cell to paste to another cell, moving down one cell each paste/loop", "body": "<p>This should work:</p>\n\n<pre><code>Cells(Rows.count, \"G\").End(xlUp).Offset(1, 0).Value = Range(\"G16\").Value\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11571021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef504aec1a72dd39c2bd6ea14d025ea4?s=128&d=identicon&r=PG&f=1", "display_name": "nofriendsnojo", "link": "https://stackoverflow.com/users/11571021/nofriendsnojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56369879, "answer_count": 1, "score": 0, "last_activity_date": 1559173373, "creation_date": 1559111262, "question_id": 56354325, "link": "https://stackoverflow.com/questions/56354325/vba-function-to-copy-text-from-a-single-un-moving-cell-to-paste-to-another-cell", "title": "VBA function to copy text from a single un-moving cell to paste to another cell, moving down one cell each paste/loop", "body": "<p>I am trying to make a worksheet that will eventually be used for route optimization using an original base address and a list of locations. I currently have a macro that uses google maps api that will list distances and duration from the origin address to all of the addresses on the list. I am trying to pull the shortest duration found using the google maps api and have the associated address be used as the new origin so I can compare the distances and duration again. I have the worksheet setup so that the shortest duration address replaces the previous origin address, but I need to be able to copy and paste each of the new origin addresses into their own cells to essentially make a list of the order that they are used. </p>\n\n<p>Basically, consider that cell G16 is where the first origin address is stored and after the first run of the distance/duration macro G16 will update to whatever address is the least furthest away from the origin address, therefor becoming the new origin. I then need to copy that origin address to cell G18 and repeat the distance/duration macro with each subsequent address from G16 being copied down 1 cell/row at a time. ie, the 1st address is copied to G18, the 2nd to G19, 3rd to G20, until all of the addresses are listed. The number of addresses is also variable and changes with each week so the range is inconsistent.</p>\n\n<p>Please let me know if this makes any sense as it is kind of complicated to explain. Thank you!</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1559110874, "post_id": 56354127, "comment_id": 99312685, "body": "If you remove <code>ComboBox2.DropDown</code> you&#39;ll notice it will work. Change that line into <code>SendKeys &quot;%{Down}&quot;</code> and it will work."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559111130, "post_id": 56354127, "comment_id": 99312778, "body": "Yes, it&#39;ll run but I want the combobox2 to expand. It will only get focused."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559111646, "post_id": 56354127, "comment_id": 99312979, "body": "Have you tried the replacement code?"}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559111935, "post_id": 56354127, "comment_id": 99313116, "body": "I didn&#39;t notice the second part of the comment when I&#39;ve posted. Yes, it&#39;s working, thank you. As for what&#39;s causing the error, do you have any idea?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559113251, "post_id": 56354127, "comment_id": 99313729, "body": "Not quite, but have a look <a href=\"https://stackoverflow.com/questions/13040694/excel-display-combobox-dropdown-by-vba\">here</a>"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559113478, "post_id": 56354127, "comment_id": 99313825, "body": "As far as I can replicate the problem, it doesn&#39;t seem to error out if CombBox1 is not populated (just change value to trigger CB2 event), so it might have something to do with how the combobox is populated?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559113964, "post_id": 56354127, "comment_id": 99314036, "body": "I&#39;ve tried populating the CB1 from a range, and still getting the same error. As far as I can tell from Google results you might be out of luck, it looks like a Microsoft &quot;feature&quot; :/"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 2, "creation_date": 1559114581, "post_id": 56354127, "comment_id": 99314335, "body": "@DarXyde, try using the <code>.DropDown</code> on a combobox2.mousdown event. That works. It&#39;s puzzling indeed."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1559799690, "post_id": 56354127, "comment_id": 99533733, "body": "@JvdV, using <code>SendKeys &quot;%{Down}&quot;</code> is a nice workaround, however it disables the numlock button so I&#39;m trying to avoid using <code>SendKeys</code> command. I wasn&#39;t able to use <code>Combobox1.Mousedown()</code>, it gives me an error <code>Procedure Declaration does not match description of event or procedure having the same name</code>."}], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559110321, "creation_date": 1559110321, "question_id": 56354127, "link": "https://stackoverflow.com/questions/56354127/focus-and-expand-second-combobox-list-on-change-event-on-first-list", "title": "Focus and expand second Combobox list on Change Event on first list", "body": "<p>I'm trying to optimise a userform from excel by focusing and expanding the second combobox when an item from the first combobox is selected.</p>\n\n<p>I've tried using <code>.Dropdown</code> but I receive an error <code>The Object Invoked Has Disconnected from its Clients</code>.</p>\n\n<p>The code I've written so far in the UserForm is the following:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\nWith ComboBox1\n    .AddItem \"First item\"\n    .AddItem \"second item\"\nEnd With\nEnd Sub\nPrivate Sub ComboBox1_Change()\nDim index As Integer\nindex = ComboBox1.ListIndex\nComboBox2.Clear\nSelect Case index\n    Case Is = 0\n        With ComboBox2\n           .AddItem \"First subitem\"\n           .AddItem \"second subitem\"\n           End With\n    Case Is = 1\n        With ComboBox2\n           .AddItem \"First subitem on second item\"\n           .AddItem \"Second subitem on second item\"\n        End With\nEnd Select\nComboBox2.SetFocus\nComboBox2.DropDown\nEnd Sub\n</code></pre>\n\n<p>Also, I've written in <code>ThisWorkbook</code> section </p>\n\n<pre><code>Private Sub Workbook_Open()\nUserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>The debugging highlights <code>UserForm1.Show</code> but the error only appear if I use the <code>ComboBox2.DropDown</code> line.</p>\n\n<p>I know that this error is not very specific but I cannot get the code to work as expected. </p>\n\n<p>Note: I simplified the code as much as I could so that the error is still there.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "edited": false, "score": 0, "creation_date": 1559107131, "post_id": 56353510, "comment_id": 99311303, "body": "i am new to stack over flow.still learning to post question.sorry .but please help"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1559118195, "last_edit_date": 1559118195, "creation_date": 1559117379, "answer_id": 56355856, "question_id": 56353510, "link": "https://stackoverflow.com/questions/56353510/how-to-select-an-option-from-a-dropdown-list-in-a-webpage-using-the-inner-text/56355856#56355856", "title": "how to select an option from a dropdown list in a webpage using the inner text", "body": "<p>There isn't a select by text option in IE implementation.</p>\n\n<p>1) Either gather collection/nodelist of options and loop comparing innerText against desired text string then select if found and Exit For</p>\n\n<pre><code>Dim options As Object, i As Long, found As Boolean\n\nSet options = ie.document.querySelectorAll(\"#inspNumber options\")\n\nFor i = 0 To options.length - 1\n    If options.item(i).innerText = \"target string\" Then\n        options.item(i).Selected = True\n        found = True\n        Exit For\n    End If\nNext\nIf Not found Then\n    'do something if not found\nEnd If\n</code></pre>\n\n<p>2) Use <a href=\"https://github.com/florentbr/SeleniumBasic/releases/tag/v2.0.9.0\" rel=\"nofollow noreferrer\">selenium vba wrapper</a> which does implement this functionality</p>\n\n<pre><code>Dim ele As Select\nSet ele = driver.FindElementById(\"inspNumber\").AsSelect\nele.SelectByText \"Option Text\"\n</code></pre>\n\n<hr>\n\n<p>N.B. Of course there are using attributes values and selectedIndex methods but you didn't want those.</p>\n"}], "owner": {"reputation": 35, "user_id": 11533673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ExXOL21s898/AAAAAAAAAAI/AAAAAAAADr0/KRFv8sZNoR4/photo.jpg?sz=128", "display_name": "Ash Sooraj", "link": "https://stackoverflow.com/users/11533673/ash-sooraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 56355856, "answer_count": 1, "score": 1, "last_activity_date": 1566506888, "creation_date": 1559106875, "last_edit_date": 1566506888, "question_id": 56353510, "link": "https://stackoverflow.com/questions/56353510/how-to-select-an-option-from-a-dropdown-list-in-a-webpage-using-the-inner-text", "title": "how to select an option from a dropdown list in a webpage using the inner text", "body": "<p>How to select an option from a dropdown list in a webpage using the inner text</p>\n\n<p>below is vba code</p>\n\n<pre><code>Sub navigation_site_with_part_number()\n    Dim eRow As Long\n    Dim ele As Object\n    Set sht = Sheets(\"Sheet1\")\n    RowCount = 1`enter code here\n    eRow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    requestnumber = InputBox(\"Enter the request number.\")\n    With objIE\n    .Visible = True\n    .navigate \"*http://www.auto.com*\"\n    Do While .Busy Or _\n    .readyState &lt;&gt; 4\n    DoEvents\n    Loop\n    .document.getElementsByid(\"inspNumber\").selectedinnertext = 2\n   .document.getElementById(\"InspQuery_Search\").Click\n    Do While .Busy Or _\n   .readyState &lt;&gt; 4\n    DoEvents\n    Loop\n    End With\n</code></pre>\n\n<p>Below is Html code:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>div id=\"RequestNumberGroup\" class=\"form-group\"&gt;\r\n&lt;label for=\"TextRequestNumber\"&gt;Request Number:&lt;/label&gt;\r\n&lt;select class=\"form-control\" id=\"inspNumber\" name=\"inspNumber\"&gt;\r\n  &lt;option value=\"\"&gt;&lt;/option&gt;\r\n  &lt;option value=\"813\"&gt;20190205&lt;/option&gt;\r\n  &lt;option value=\"1034\"&gt;20190426&lt;/option&gt;\r\n  &lt;option value=\"1059\"&gt;20190451&lt;/option&gt;\r\n  &lt;option value=\"1061\"&gt;20190453&lt;/option&gt;\r\n  &lt;option value=\"1064\"&gt;20190456&lt;/option&gt;\r\n  &lt;option value=\"1065\"&gt;20190457&lt;/option&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I expected to select the option in dropdownlist with requestnumber not option value </p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1559106267, "post_id": 56353371, "comment_id": 99311083, "body": "Can you share the code you tried !, if not take a look at the [this link] (<a href=\"https://analysistabs.com/excel-vba/ado-sql-macros-connecting-database/\" rel=\"nofollow noreferrer\">analysistabs.com/excel-vba/ado-sql-macros-connecting-databa&zwnj;&#8203;se</a>)"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1559108671, "post_id": 56353371, "comment_id": 99311792, "body": "We&#39;re not a free service where we write code for you. We help those who help themselves.."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1559114602, "post_id": 56353371, "comment_id": 99314347, "body": "What is your question? What have you tried so far and where are you stuck?"}], "answers": [{"tags": [], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "is_accepted": false, "score": 0, "last_activity_date": 1559127188, "last_edit_date": 1559127188, "creation_date": 1559109516, "answer_id": 56353982, "question_id": 56353371, "link": "https://stackoverflow.com/questions/56353371/i-need-code-to-run-a-sql-server-query-which-is-stored-in-my-local-drive-via-vba/56353982#56353982", "title": "I need code to run a SQL Server query which is stored in my local drive via VBA and get data into an Excel sheet", "body": "<p>You can do something similar to this. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>txtSQLcmd = \"SELECT * FROM xxxx_Log;\"\ndtDateValue = DateValue(FetchAValueFromTable(txtSQLcmd))\ntxtSQLcmd = \"UPDATE TablevVariables SET [TablevVariables].KeyValue = #\" &amp; dtDateValue &amp; \"# WHERE [TablevVariables].KeyName='xxxx_Log';\"\nExecuteSQLcmd (txtSQLcmd)\n\nFunction FetchAValueFromTable(ByVal strSQL As String) As String\nDim cnn1 As ADODB.Connection\nSet cnn1 = CurrentProject.Connection\nDim myRecordSet As New ADODB.Recordset\nmyRecordSet.ActiveConnection = cnn1\nmyRecordSet.CursorType = adOpenDynamic\nmyRecordSet.LockType = adLockOptimistic\nmyRecordSet.Open strSQL\nFetchAValueFromTable = myRecordSet.Fields(0).Value\nmyRecordSet.Close\nSet myRecordSet = Nothing\nSet cnn1 = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 8153534, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211412744427345/picture?type=large", "display_name": "Wim F", "link": "https://stackoverflow.com/users/8153534/wim-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1559123798, "creation_date": 1559123798, "answer_id": 56357837, "question_id": 56353371, "link": "https://stackoverflow.com/questions/56353371/i-need-code-to-run-a-sql-server-query-which-is-stored-in-my-local-drive-via-vba/56357837#56357837", "title": "I need code to run a SQL Server query which is stored in my local drive via VBA and get data into an Excel sheet", "body": "<p>You can retrieve SQL data from within Excel using default Excel functionality Eg Data/get data from SQL database, you can store the connection and queries it doesn't really require VBA</p>\n"}], "owner": {"reputation": 1, "user_id": 9416775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebf7eaac4c52bea101360490b63ee6ce?s=128&d=identicon&r=PG&f=1", "display_name": "Sikandar Baksh", "link": "https://stackoverflow.com/users/9416775/sikandar-baksh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1559127188, "creation_date": 1559106003, "last_edit_date": 1559115724, "question_id": 56353371, "link": "https://stackoverflow.com/questions/56353371/i-need-code-to-run-a-sql-server-query-which-is-stored-in-my-local-drive-via-vba", "title": "I need code to run a SQL Server query which is stored in my local drive via VBA and get data into an Excel sheet", "body": "<p>I have multiple SQL queries saved on my local drive, and each time I have to run SQL and copy data from SQL Server to Excel.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559105364, "post_id": 56353264, "comment_id": 99310890, "body": "Can you share the code you have already written so we can see where you need help.."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559105518, "post_id": 56353264, "comment_id": 99310923, "body": "You can use <b>arrays</b> instead of many variables, that should make it short and understandable. Also share the code that you have tried so far, so that we can see what is that you are doing wrong."}, {"owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "edited": false, "score": 0, "creation_date": 1559109223, "post_id": 56353264, "comment_id": 99312008, "body": "see edits above in original post."}], "owner": {"reputation": 346, "user_id": 10859585, "user_type": "registered", "profile_image": "https://graph.facebook.com/2007539325992092/picture?type=large", "display_name": "Zman3", "link": "https://stackoverflow.com/users/10859585/zman3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1559112623, "creation_date": 1559105221, "last_edit_date": 1559112623, "question_id": 56353264, "link": "https://stackoverflow.com/questions/56353264/moving-data-to-specific-columns-and-rows", "title": "Moving Data to Specific Columns and rows", "body": "<p>I have two columns of data in my excel sheet:</p>\n\n<pre><code>    Month: 4, 4, 4, 4, 4, 5, 6, 6, 6, etc.\n    Day: 2, 2, 2, 3, 4, 6, 1, 2, 3, etc.\n</code></pre>\n\n<p>What I would like to do is set up the months in additional columns.  Then match that month with the month's day in each row.  I'd like to write a sub routine for this in VBA so that with any set of data (month and day) I can do the iteration.  So my range would be something like A1:A.... So from the example above it would look something like this:</p>\n\n<pre><code>    January February March April May June July August ....\n                             2    6    1\n                             2         2\n                             2         3\n                             3\n                             4\n</code></pre>\n\n<p>I've played around with some If statements, but I am getting too many variables and think I am making it more complicated then I need to.</p>\n\n<p>Edits:</p>\n\n<pre><code>    j = 10\n    k = 2\n    m = 11\n    v = 2\n    u = 13\n    LastRow_0 = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n    For i = 2 To LastRow_0\n    If Cells(i, j) = 4 Then\n        Cells(v, u) = Cells(k, m)\n            Else: Cells(v, u) = \"\"\n                k = k + 1\n                v = v + 1\n\n    End If\n    Next i\n</code></pre>\n\n<p>This is what I have.  It is not liking the \".Rows.Count\" syntax.  Months are j and days are m.  u is the month of April in column # u (13).  I would then copy and paste this code twelve times to get all of the months.  v and k are changing by 1 to go through all the rows until i runs out.  Basically until Null.</p>\n\n<p>Edits 2:</p>\n\n<pre><code>    'January\n    With ThisWorkbook.Sheets(\"Form Date\")\n        LR1 = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n    For i = 2 To LR1\n        If Cells(i, 10) = 1 Then\n            Cells(i, 13) = Cells(i, 11)\n                Else: Cells(i, 13) = \"\"\n\n        End If\n    Next i\n    End With\n    '--------------------------------------------------------\n    'Febuary\n    With ThisWorkbook.Sheets(\"Form Date\")\n        LR2 = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n    For i = 2 To LR2\n        If Cells(i, 10) = 2 Then\n            Cells(i, 14) = Cells(i, 11)\n                Else: Cells(i, 14) = \"\"\n\n        End If\n    Next i\n    End With\n    '---------------------------------------------------------\n    'March\n    With ThisWorkbook.Sheets(\"Form Date\")\n        LR3 = .Cells(.Rows.Count, \"J\").End(xlUp).Row\n    For i = 2 To LR3\n        If Cells(i, 10) = 3 Then\n            Cells(i, 15) = Cells(i, 11)\n                Else: Cells(i, 15) = \"\"\n\n        End If\n    Next i\n    End With\n</code></pre>\n\n<p>I gave it some more thought and change a couple of things to exclude some variables.  Ended up not needing them.  I would like a smaller code of what I have here, so it takes less time to run and I don't need 12 of these.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1559104042, "last_edit_date": 1559104042, "creation_date": 1559103392, "answer_id": 56353038, "question_id": 56352782, "link": "https://stackoverflow.com/questions/56352782/what-is-the-difference-between-method-sheet1-showall-and-sheet1-autofilter-showa/56353038#56353038", "title": "What is the difference between method Sheet1.ShowAll and Sheet1.AutoFilter.ShowAll", "body": "<p><code>Sheet1.ShowAllData</code> is the code you are looking for to <strong>clear the Filter</strong>. </p>\n\n<p>But if you use <code>Sheet1.UsedRange.AutoFilter</code> , it will <strong>remove the filter</strong> or add the filter if no filter is applied.</p>\n"}], "owner": {"reputation": 11, "user_id": 2103865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ADv3b.jpg?s=128&g=1", "display_name": "Charin Nawaritloha", "link": "https://stackoverflow.com/users/2103865/charin-nawaritloha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559153675, "creation_date": 1559101187, "last_edit_date": 1559153675, "question_id": 56352782, "link": "https://stackoverflow.com/questions/56352782/what-is-the-difference-between-method-sheet1-showall-and-sheet1-autofilter-showa", "title": "What is the difference between method Sheet1.ShowAll and Sheet1.AutoFilter.ShowAll", "body": "<p>I recorded a macro to clear filter and show all row data. Result is Sheet1.ShowAll. I use this method for long time but sometimes I got error that I can fix using Sheet1.AutoFilter.ShowAll. Why is Sheet1.AutoFilter.ShowAll working?</p>\n\n<p>I use and tested on Excel 2010</p>\n\n<pre><code>Sheet1.ShowAll 'runtime error\n\nSheet1.AutoFilter.ShowAll 'no error, why?\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11570595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398d0d35acc7786a21f46c5f7bf396b3?s=128&d=identicon&r=PG&f=1", "display_name": "ssabissett", "link": "https://stackoverflow.com/users/11570595/ssabissett"}, "edited": false, "score": 0, "creation_date": 1559151455, "post_id": 56355924, "comment_id": 99334945, "body": "THANK YOU. I was running the SQL in Excel to Access, not within Access. That was my issue. You saved me a great deal of time."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 0, "last_activity_date": 1559117601, "creation_date": 1559117601, "answer_id": 56355924, "question_id": 56352750, "link": "https://stackoverflow.com/questions/56352750/no-read-permission-on-msysobjects-error-no-2147217911-when-using-microsoft/56355924#56355924", "title": "No read permission on &#39;MSysObjects&#39; (Error No: -2147217911) when Using Microsoft Excel VBA to Query Access accdb files only - mdb works fine", "body": "<p>Within Access you need to give permission for the default user to access the table.</p>\n\n<p>In the immediate window with Access execute </p>\n\n<pre><code>CurrentProject.Connection.Execute \"GRANT SELECT ON MSysObjects TO Admin;\"\n</code></pre>\n\n<p>And your SQL will work after that.</p>\n\n<p>You might want to change your connection string.  IIRC Jet won't work after Access 2003 so try</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"C:\\...ADAIICH9TEST.accdb;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11570595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398d0d35acc7786a21f46c5f7bf396b3?s=128&d=identicon&r=PG&f=1", "display_name": "ssabissett", "link": "https://stackoverflow.com/users/11570595/ssabissett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 56355924, "answer_count": 1, "score": 0, "last_activity_date": 1594771786, "creation_date": 1559100882, "last_edit_date": 1594771786, "question_id": 56352750, "link": "https://stackoverflow.com/questions/56352750/no-read-permission-on-msysobjects-error-no-2147217911-when-using-microsoft", "title": "No read permission on &#39;MSysObjects&#39; (Error No: -2147217911) when Using Microsoft Excel VBA to Query Access accdb files only - mdb works fine", "body": "<p>No read permission on 'MSysObjects' (Error No: -2147217911) when Using Microsoft Excel VBA to Query Access accdb files only - mdb works fine</p>\n\n<p>Using Microsoft Excel VBA to Query Access.</p>\n\n<p>With an mdb file this connection string opens the mdb file fine and the SQL String returns the tables I want.</p>\n\n<pre><code>Connection String: Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"C:\\My Files\\Word\\ADA II Text\\Chapters\\9 -\n\n\n\n8\\Access\\ADAIICH9TEST.mdb\";User Id=admin;Password=;\nSQL String: SELECT MSysObjects.Name From MSysObjects WHERE MSysObjects.Name Not Like \"MSyS*\" And Type=1 AND \n\nFlags=0 ORDER BY MSysObjects.Name;\n</code></pre>\n\n<p>With an accdb file this connection string opens the accdb file fine but the SQL throws the following error:</p>\n\n<p>Error No: -2147217911       Error Desc: Record(s) cannot be read; no read permission on 'MSysObjects'.</p>\n\n<p>Why does it have access to MSysObjects when reading the mdb file but not the accdb file?\nHow do I grant access either programmatically or from within the Access File?</p>\n\n<p>I have already tried executing the following statements prior to running the SQL:</p>\n\n<pre><code>'cn.Execute \"GRANT SELECT ON MSysObjects TO Admin;\"\n'cn.Execute \"GRANT SELECT ON TABLE MSysObjects TO PUBLIC;\"\n</code></pre>\n\n<p>They throw the error:\nError No: -2147467259       Error Desc: Cannot open the Microsoft Access database engine workgroup information </p>\n\n<p>file.</p>\n"}, {"tags": ["excel", "vba", "string", "function"], "answers": [{"comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1559100319, "post_id": 56352685, "comment_id": 99309913, "body": "Try and find the line you are getting error on If any by using F8."}, {"owner": {"reputation": 7, "user_id": 11112152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187bca9824443719ccfc7af07c0d853a?s=128&d=identicon&r=PG&f=1", "display_name": "j18273018", "link": "https://stackoverflow.com/users/11112152/j18273018"}, "edited": false, "score": 0, "creation_date": 1559101221, "post_id": 56352685, "comment_id": 99310053, "body": "I can&#39;t believe one line ruined all the code! Thanks so much, this fixed it."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559101571, "post_id": 56352685, "comment_id": 99310119, "body": "Well it&#39;s an answer now"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1559100276, "creation_date": 1559100276, "answer_id": 56352685, "question_id": 56352637, "link": "https://stackoverflow.com/questions/56352637/excel-vba-editing-a-column-of-strings-with-a-function/56352685#56352685", "title": "EXCEL VBA: Editing a Column of Strings with a Function", "body": "<p>Can you try this:</p>\n\n<pre><code>Sub fixOutcomeColumn()\n\n    Dim lastRow As Long\n    Dim rng As Range, col As Range\n    Dim val As String\n\n    lastRow = Cells(Rows.Count, 2).End(xlUp).Row\n    val = \"test\"\n    Set col = ActiveWorkbook.ActiveSheet.Range(\"B1:B\" &amp; lastRow)\n    'Set rng = ActiveWorkbook.ActiveSheet.Range(\"B1\")\n\n    For Each rng In col.Cells\n        val = rng.Value\n        rng.Value = changeOutcomesToOG(val)\n    Next rng\n\nEnd Sub\n\nPublic Function changeOutcomesToOG(str As String) As String\n\n    Select Case str\n        Case \"a\"\n            changeOutcomesToOG = \"A\"\n        Case \"b\"\n            changeOutcomesToOG = \"B\"\n        Case \"c\"\n            changeOutcomesToOG = \"C\"\n        Case \"d\"\n            changeOutcomesToOG = \"D\"\n        Case \"e\"\n            changeOutcomesToOG = \"E\"\n        Case Else\n            changeOutcomesToOG = str\n    End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11112152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187bca9824443719ccfc7af07c0d853a?s=128&d=identicon&r=PG&f=1", "display_name": "j18273018", "link": "https://stackoverflow.com/users/11112152/j18273018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56352685, "answer_count": 1, "score": 0, "last_activity_date": 1559100276, "creation_date": 1559099856, "question_id": 56352637, "link": "https://stackoverflow.com/questions/56352637/excel-vba-editing-a-column-of-strings-with-a-function", "title": "EXCEL VBA: Editing a Column of Strings with a Function", "body": "<p>I work with reports every day that list the results for each initiative we handle in a range of about 40 possible outcomes. I have created 4 groups which each of these outcomes could fall into to reduce the required comprehension, and would like my code to replace each individual outcome in column B with its assigned outcome group. This is my first time creating my own function in VBA, so please forgive any obvious errors.</p>\n\n<p>I have created a simple Sub that should (hopefully) find the last row of column B, then loop up each row in the column passing the contained string to a function I've created. The should accept a string, perform a \"select case\" to ascertain which Outcome Group the string would be assigned to, then return the Outcome Group to the Sub for the current cell to be edited to. The select case options in my code have been reduced for readability. Additionally, the Function is stored in a separate VBA module to the sub.</p>\n\n<pre><code>Sub fixOutcomeColumn()\n\n    Dim lastRow As Long\n    Dim rng As Range, col As Range\n    Dim val As String\n\n    lastRow = Cells(Rows.Count, 2).End(xlUp).Row\n    val = \"test\"\n    Set col = ActiveWorkbook.ActiveSheet.Range(\"B1\" &amp; lastRow)\n    Set rng = ActiveWorkbook.ActiveSheet.Range(\"B1\")\n\n    For Each rng In col.Cells\n        val = rng.Value\n        rng = changeOutcomesToOG(val)\n    Next rng\n\nEnd Sub\n\nPublic Function changeOutcomesToOG(str As String) As String\n\n    Select Case str\n        Case \"a\"\n            changeOutcomesToOG = \"A\"\n        Case \"b\"\n            changeOutcomesToOG = \"B\"\n        Case \"c\"\n            changeOutcomesToOG = \"C\"\n        Case \"d\"\n            changeOutcomesToOG = \"D\"\n        Case \"e\"\n            changeOutcomesToOG = \"E\"\n        Case Else\n            changeOutcomesToOG = str\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>Stepping through the code in the editor while reading the Locals window shows me that my rng variable isn't being populated by any values when the code is run. Additionally, the code is not looping through each cell in the column, and runs the for loop once instead. I imagine I've made a pretty basic error, but can't figure it out for the life of me!</p>\n"}, {"tags": ["vba", "function", "ms-access"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1559100750, "post_id": 56352529, "comment_id": 99309990, "body": "Where the error appears?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1559100773, "post_id": 56352529, "comment_id": 99309998, "body": "Function is <code>Copy_Of_CompID_Fields()</code> not <code>MyFunction()</code>. If you are really using <code>=MyFunction()</code>, I expect it would fail."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1559110962, "post_id": 56352529, "comment_id": 99312715, "body": "<code>[Forms]</code> is a collection of forms, so how could this work?: <code>[Forms].[Dirty]</code>"}, {"owner": {"reputation": 35, "user_id": 2437174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d33adf70c4d64c60065c30110772942?s=128&d=identicon&r=PG&f=1", "display_name": "Theseus", "link": "https://stackoverflow.com/users/2437174/theseus"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1559135468, "post_id": 56352529, "comment_id": 99326163, "body": "@June7 I am not using MyFunction(). I only used that as an example to see if I was using the proper syntax in the property field."}, {"owner": {"reputation": 116, "user_id": 10969038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c239e8f5d55119ec56aff4f424065e1d?s=128&d=identicon&r=PG&f=1", "display_name": "Eedz", "link": "https://stackoverflow.com/users/10969038/eedz"}, "edited": false, "score": 0, "creation_date": 1559135616, "post_id": 56352529, "comment_id": 99326272, "body": "Is the function in a module? If it is part of a form, that form would need to be open for you to call the function."}, {"owner": {"reputation": 35, "user_id": 2437174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d33adf70c4d64c60065c30110772942?s=128&d=identicon&r=PG&f=1", "display_name": "Theseus", "link": "https://stackoverflow.com/users/2437174/theseus"}, "reply_to_user": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1559137991, "post_id": 56352529, "comment_id": 99327812, "body": "@unhandled That is exactly what my problem was with the standalone macro. I took the suggestion that popped up which had an &quot;s&quot; in it."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1559151585, "post_id": 56352529, "comment_id": 99334990, "body": "Best to use actual code when you have it, not example. Regarding Dirty property, review <a href=\"http://allenbrowne.com/bug-01.html\" rel=\"nofollow noreferrer\">allenbrowne.com/bug-01.html</a>."}, {"owner": {"reputation": 825, "user_id": 1898524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6C9A.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1898524/ben"}, "edited": false, "score": 0, "creation_date": 1567404739, "post_id": 56352529, "comment_id": 101941023, "body": "Can you tell us which line of code produces the error?"}], "owner": {"reputation": 35, "user_id": 2437174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d33adf70c4d64c60065c30110772942?s=128&d=identicon&r=PG&f=1", "display_name": "Theseus", "link": "https://stackoverflow.com/users/2437174/theseus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559100620, "creation_date": 1559098993, "last_edit_date": 1559100620, "question_id": 56352529, "link": "https://stackoverflow.com/questions/56352529/ms-access-calling-vba-function-in-form-event-property-like-on-dbl-click-ref", "title": "MS Access: Calling VBA function in form event property (like On Dbl Click) - refers to object closed or doesn&#39;t exist", "body": "<p>I have taken a macro that was embedded and converted it into vba so I can call it on different forms when needed. The form I am using is an employee list form and I am using it on the first name. I have tried calling the function by putting <code>=MyFunction()</code> and I get the object is closed or doesn't exist.</p>\n\n<p>It works as an embedded macro; however, when I try to use it as a standalone I get an error and when I converted it I get the above error. </p>\n\n<pre><code>Function Copy_Of_CompID_Fields()\nOn Error GoTo Copy_Of_CompID_Fields_Err\n\n    With CodeContextObject\n        On Error Resume Next\n        If (Eval(\"[Forms].[Dirty]\")) Then\n            DoCmd.RunCommand acCmdSaveRecord\n        End If\n        If (.MacroError.Number &lt;&gt; 0) Then\n            Beep\n            MsgBox .MacroError.Description, vbOKOnly, \"\"\n            Exit Function\n        End If\n        On Error GoTo 0\n        If (IsNull(.New_Id)) Then\n            Exit Function\n        End If\n        If (.CreatedDate &lt; #5/1/2019#) Then\n            DoCmd.OpenForm \"Employee Details\", acNormal, \"\", \"[ID]='\" &amp; .ID &amp; \"'\", , acNormal\n        Else\n            DoCmd.OpenForm \"Employee Details\", acNormal, \"\", \"[New_Id]=\" &amp; .ID, , acNormal\n        End If\n        TempVars.Add \"CurrentID\", .ID\n        DoCmd.Requery \"\"\n        DoCmd.SearchForRecord , \"\", acFirst, \"[ID]='\" &amp; TempVars!CurrentID &amp; \"'\"\n        TempVars.Remove \"CurrentID\"\n    End With\n\nCopy_Of_CompID_Fields_Exit:\n    Exit Function\n\nCopy_Of_CompID_Fields_Err:\n    MsgBox Error$\n    Resume Copy_Of_CompID_Fields_Exit\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1559118438, "post_id": 56352445, "comment_id": 99316428, "body": "Is there an url we can test with?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11570427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157938217346062/picture?type=large", "display_name": "Philbin Francis", "link": "https://stackoverflow.com/users/11570427/philbin-francis"}, "edited": false, "score": 0, "creation_date": 1559115194, "post_id": 56352921, "comment_id": 99314679, "body": "Thanks for your respone drHodge.I tried to add below line as mentioned by Mariano, but the text is not filling   For Each Item In IE.Document.all()     If Item.getAttribute(&quot;title&quot;) = &quot;Search for a template&quot; Then     Item.Value = &quot;ORADB&quot;     End If     Next Item  Am I missing anything?"}], "tags": [], "owner": {"reputation": 76, "user_id": 10762297, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xhpUsiovut8/AAAAAAAAAAI/AAAAAAAAAo4/Y8hPL5JxQ2w/photo.jpg?sz=128", "display_name": "drHodge", "link": "https://stackoverflow.com/users/10762297/drhodge"}, "is_accepted": false, "score": 0, "last_activity_date": 1559102446, "creation_date": 1559102446, "answer_id": 56352921, "question_id": 56352445, "link": "https://stackoverflow.com/questions/56352445/ie-handling-in-excel-macros/56352921#56352921", "title": "IE Handling in Excel macros", "body": "<p>I think you need to search through all the elements returned by Document.All().  Try looping through the collection that is returned.  This is much easier if the control had an id, but you will have to check each element having a title = \"Search for a template\".  Once you have found the item you can set the text.</p>\n\n<p>I suggest debugging so you can see what .All returns and then you can work from there.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11570427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157938217346062/picture?type=large", "display_name": "Philbin Francis", "link": "https://stackoverflow.com/users/11570427/philbin-francis"}, "edited": false, "score": 0, "creation_date": 1559115314, "post_id": 56353290, "comment_id": 99314739, "body": "Thanks for your respone Mariano.I tried to add below line as mentioned by  but the text is not filling   For Each Item In IE.Document.all()     If Item.getAttribute(&quot;title&quot;) = &quot;Search for a template&quot; Then     Item.Value = &quot;ORADB&quot;     End If     Next Item  Am I missing anything?"}, {"owner": {"reputation": 162, "user_id": 10713658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/siljY.jpg?s=128&g=1", "display_name": "Mariano Luis Villa", "link": "https://stackoverflow.com/users/10713658/mariano-luis-villa"}, "reply_to_user": {"reputation": 11, "user_id": 11570427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157938217346062/picture?type=large", "display_name": "Philbin Francis", "link": "https://stackoverflow.com/users/11570427/philbin-francis"}, "edited": false, "score": 0, "creation_date": 1559149093, "post_id": 56353290, "comment_id": 99333875, "body": "Hi Philbin. Is this HTML being downloaded in real-time navigation, or is it a file on your computer? Are you sure that there&#39;s actually an element with that title? I just made the same loop with your exact HTML snippet (saved as a file) and got it working; that&#39;s why I&#39;m guessing something changed on the HTML you&#39;re searching in. Here&#39;s the whole Sub: <a href=\"https://codeshare.io/5zkL8r\" rel=\"nofollow noreferrer\">codeshare.io/5zkL8r</a> Note that this isn&#39;t production code: it could fail in several ways and it isn&#39;t as efficient as it could."}], "tags": [], "owner": {"reputation": 162, "user_id": 10713658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/siljY.jpg?s=128&g=1", "display_name": "Mariano Luis Villa", "link": "https://stackoverflow.com/users/10713658/mariano-luis-villa"}, "is_accepted": false, "score": 0, "last_activity_date": 1559105372, "creation_date": 1559105372, "answer_id": 56353290, "question_id": 56352445, "link": "https://stackoverflow.com/questions/56352445/ie-handling-in-excel-macros/56353290#56353290", "title": "IE Handling in Excel macros", "body": "<p>welcome to SO. If you need to get an element, as drHodge said, using an iterator and some sort of ID attribute is usually enough. I tried this with Google a minute ago:</p>\n\n<pre><code>Dim Item As Object\nFor Each Item In IE.Document.all()\nIf Item.getAttribute(\"title\") = \"Buscar\" Then\nItem.Value = \"Test\"\nEnd If\nNext Item\n</code></pre>\n\n<p>I also made it press space, down arrow and enter, for the sake of doing something with the suggestion and searching part:</p>\n\n<pre><code>SendKeys (\"{ }\")\nApplication.Wait Now + TimeSerial(0, 0, 1)\nSendKeys (\"{DOWN}\"), True\nApplication.Wait Now + TimeSerial(0, 0, 1)\nSendKeys (\"{ENTER}\"), True\n</code></pre>\n\n<p>(I do not recommend using SendKeys on any script, tho; it's quite unreliable.)</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1559118689, "creation_date": 1559118689, "answer_id": 56356248, "question_id": 56352445, "link": "https://stackoverflow.com/questions/56352445/ie-handling-in-excel-macros/56356248#56356248", "title": "IE Handling in Excel macros", "body": "<p>You could try the following:</p>\n\n<p>1) Focus and change</p>\n\n<pre><code>With ie.document.querySelector(\"[title='Search for a template']\")\n    .focus\n    .value = \"abcd\"\nEnd With\n</code></pre>\n\n<p>2) Javascript set value</p>\n\n<pre><code>ie.document.parentWindow.execScript \"document.querySelector('[title=\\'Search for a template\\']').value = 'abcd';\"\n</code></pre>\n\n<p>3) Attach event and fire</p>\n\n<pre><code>Dim evt As Object\nSet evt = ie.document.createEvent(\"HTMLEvents\")\nevt.initEvent \"change\", True, False\n\nWith ie.document.querySelector(\"[title='Search for a template']\")\n    .Focus\n    .Value = \"abcd\"\n    .dispatchEvent evt\nEnd With\n</code></pre>\n\n<p>4) FireEvent</p>\n\n<pre><code>With ie.document.querySelector(\"[title='Search for a template']\")\n    .Focus\n    .Value = \"abcd\"\n    .FireEvent \"onchange\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11570427, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157938217346062/picture?type=large", "display_name": "Philbin Francis", "link": "https://stackoverflow.com/users/11570427/philbin-francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1559118689, "creation_date": 1559098316, "last_edit_date": 1559102103, "question_id": 56352445, "link": "https://stackoverflow.com/questions/56352445/ie-handling-in-excel-macros", "title": "IE Handling in Excel macros", "body": "<p>I am new to Excel macros and I am trying to auto-fill the text box and select the option from Dropdown and click on Submit. </p>\n\n<p>Using macros I have navigated to a page and from the page, I need to enter the text in the text box, and based on the Suggestion, I need to select the option. </p>\n\n<p>Once the option is selected I need to click on continue using macros.</p>\n\n<p>Here is the current code (I tried with the commented line but it's not working).</p>\n\n<pre><code>Sub Create_Change()\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    Dim HWNDSrc As Long\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    URL = \"URL to Navigate\"\n    IE.Navigate URL\n    Application.StatusBar = URL &amp; \" is loading. Please wait...\"\n    Do While IE.ReadyState = 4: DoEvents: Loop\n    Do Until IE.ReadyState = 4: DoEvents: Loop\n    Application.StatusBar = URL &amp; \" Loaded\"\n    ' IE.Document.All(\"Search for a template\").Value = \"text to search\"\n    Set IE = Nothing\n    Set objElement = Nothing\n    Set objCollection = Nothing\nEnd Sub\n</code></pre>\n\n<p>HTML CODE:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;input title=\"Search for a template\" \n       class=\"change-template__search-input ng-pristine ng-untouched ng-valid\" \n       role=\"combobox\" \n       aria-expanded=\"false\" \n       aria-owns=\"typeahead-258-8737\" \n       aria-autocomplete=\"list\" \n       type=\"text\" \n       placeholder=\"Search for a template\" \n       ng-enter=\"getRecommendedTemplates(template.search)\" \n       ng-model=\"template.search\" \n       typeahead=\"template as template for template in getTemplateList($viewValue)\" \n       typeahead-focus-first=\"false\" \n       typeahead-on-select=\"getRecommendedTemplates($item)\" \n       typeahead-min-length=\"3\"&gt;\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5351332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d84a901f551b56061e54b02cddc0f6?s=128&d=identicon&r=PG&f=1", "display_name": "BagoLang", "link": "https://stackoverflow.com/users/5351332/bagolang"}, "edited": false, "score": 0, "creation_date": 1559109387, "post_id": 56352331, "comment_id": 99312077, "body": "Hi Tim,  Thank you so much for your quick response. I am still having error with the code you provided but I was able to use the idea behind it and did some tweaks and it solved my problem :)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1559123870, "last_edit_date": 1559123870, "creation_date": 1559097208, "answer_id": 56352331, "question_id": 56351822, "link": "https://stackoverflow.com/questions/56351822/vba-how-to-call-sql-database-connection-from-separate-module/56352331#56352331", "title": "VBA - How to call SQL database connection from separate module", "body": "<p>You can return the connection from your function:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function dbconnection() as ADODB.connection\n\n    Dim cnn As New ADODB.connection\n\n    cnn.Open = \"Driver={SQL Server};Server=HOLAP-IST9985\\CASETRACKER;\" &amp; _\n               \"Database=casetracker; Trusted_Connection=Yes\"\n\n    Set dbconnection = cnn\n\nEnd Function\n</code></pre>\n\n<p>And then use it:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function po_maintenance()\n\nDim cnn As New ADODB.connection\nDim rst As New ADODB.Recordset\nSet rst = New ADODB.Recordset\n\nSet cnn = dbconnection()\nrst.Open \"SELECT * FROM po_numberstbl ORDER BY [PO_Number];\", cnn, \nadOpenStatic\nIf rst.EOF = False Then\n'etc etc\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5351332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d84a901f551b56061e54b02cddc0f6?s=128&d=identicon&r=PG&f=1", "display_name": "BagoLang", "link": "https://stackoverflow.com/users/5351332/bagolang"}, "is_accepted": false, "score": 0, "last_activity_date": 1559124192, "last_edit_date": 1559124192, "creation_date": 1559109686, "answer_id": 56354008, "question_id": 56351822, "link": "https://stackoverflow.com/questions/56351822/vba-how-to-call-sql-database-connection-from-separate-module/56354008#56354008", "title": "VBA - How to call SQL database connection from separate module", "body": "<p>So here's what I have came up with to solve the connection problem..</p>\n\n<p>dbconnection:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public sqlt As String\nFunction dbconnection() As ADODB.connection\nDim cnn As New ADODB.connection\nDim rst As New ADODB.Recordset\n\nsqlt = \"Driver={SQL Server};Server=HOLAP- \nIST9985\\CASETRACKER;Database=storecons; Trusted_Connection=Yes\"\nEnd Function\n</code></pre>\n\n<p>Calling dbconnection:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function po_maintenance()\n\nDim cnn As New ADODB.connection\nDim rst As New ADODB.Recordset\nSet rst = New ADODB.Recordset\n\nSet cnn = Module5.dbconnection()\ncnn.Open sqlt\n\n\nrst.Open \"SELECT * FROM po_numberstbl ORDER BY [PO_Number];\", cnn, \nadOpenStatic\nIf rst.EOF = False Then\ni = 0\n\nWith maintenance_frm.maintenance_list\n.Clear\nDo\n    .AddItem\n    .List(i, 0) = rst![po_number]\n    .List(i, 1) = rst![purpose]\n    .List(i, 2) = rst![Vendor]\n    .List(i, 3) = rst![id]\n\n    i = i + 1\n    rst.MoveNext\nLoop Until rst.EOF\nEnd With\nElse\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5351332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7d84a901f551b56061e54b02cddc0f6?s=128&d=identicon&r=PG&f=1", "display_name": "BagoLang", "link": "https://stackoverflow.com/users/5351332/bagolang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559124192, "creation_date": 1559092038, "last_edit_date": 1559119552, "question_id": 56351822, "link": "https://stackoverflow.com/questions/56351822/vba-how-to-call-sql-database-connection-from-separate-module", "title": "VBA - How to call SQL database connection from separate module", "body": "<p>I have been digging on this but I couldn't find the solution related to it. I have a SQL database connection in a separate module (Module 5) that I wanted to call whenever I need to connect to my database from the other Module/form. This is for simplicity and single update so I don't need to go through every function to update the connection.</p>\n\n<p>Database connection (Module5)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function dbconnection()\nDim cnn As New ADODB.connection\nDim rst As New ADODB.Recordset\n\ncnn.Open = \"Driver={SQL Server};Server=HOLAP- \nIST9985\\CASETRACKER;Database=casetracker; Trusted_Connection=Yes\"\n\n\ncnn.Close\nSet cnn = Nothing\n\nEnd Function\n</code></pre>\n\n<p>And this is where I need to call the connection (Module2) - sends query to the database and displays result to my list box.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function po_maintenance()\n\nDim cnn As New ADODB.connection\nDim rst As New ADODB.Recordset\nSet rst = New ADODB.Recordset\n\n\nrst.Open \"SELECT * FROM po_numberstbl ORDER BY [PO_Number];\", cnn, \nadOpenStatic\nIf rst.EOF = False Then\ni = 0\n\nWith maintenance_frm.maintenance_list\n.Clear\nDo\n    .AddItem\n    .List(i, 0) = rst![po_number]\n    .List(i, 1) = rst![purpose]\n    .List(i, 2) = rst![Vendor]\n    .List(i, 3) = rst![id]\n\n    i = i + 1\n    rst.MoveNext\nLoop Until rst.EOF\nEnd With\nElse\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 11537378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KhrlAZSDjIM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceOu_croND7Xr0GbH38d1venBqWg/mo/photo.jpg?sz=128", "display_name": "Oki Toma", "link": "https://stackoverflow.com/users/11537378/oki-toma"}, "is_accepted": false, "score": 0, "last_activity_date": 1559261978, "last_edit_date": 1559261978, "creation_date": 1559102449, "answer_id": 56352924, "question_id": 56351804, "link": "https://stackoverflow.com/questions/56351804/how-to-use-a-nested-query-to-update-a-value-in-another-table/56352924#56352924", "title": "How to use a nested query to update a value in another table?", "body": "<p>While waiting for guidance, I used a work around for this issue. Assigned the value to a variable and then passed it in a normal query.</p>\n\n<pre><code>txtSQLcmd = \"SELECT Max([\u5e74\u6708\u65e5]) FROM xxxx_Archived_Log;\"\ndtDateValue = DateValue(FetchAValueFromTable(txtSQLcmd))\ntxtSQLcmd = \"UPDATE TablevVariables SET [TablevVariables].KeyValue = #\" &amp; dtDateValue &amp; \"# WHERE [TablevVariables].KeyName='xxxx_Archived_Log';\"\nExecuteSQLcmd (txtSQLcmd)\n\nFunction FetchAValueFromTable(ByVal strSQL As String) As String\nDim cnn1 As ADODB.Connection\nSet cnn1 = CurrentProject.Connection\nDim myRecordSet As New ADODB.Recordset\nmyRecordSet.ActiveConnection = cnn1\nmyRecordSet.CursorType = adOpenDynamic\nmyRecordSet.LockType = adLockOptimistic\nmyRecordSet.Open strSQL\nFetchAValueFromTable = myRecordSet.Fields(0).Value\nmyRecordSet.Close\nSet myRecordSet = Nothing\nSet cnn1 = Nothing\nEnd Function\n\nFunction ExecuteSQLcmd(ByVal strSQL As String)\n   DoCmd.RunSQL strSQL\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11537378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KhrlAZSDjIM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceOu_croND7Xr0GbH38d1venBqWg/mo/photo.jpg?sz=128", "display_name": "Oki Toma", "link": "https://stackoverflow.com/users/11537378/oki-toma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559261978, "creation_date": 1559091747, "last_edit_date": 1559164630, "question_id": 56351804, "link": "https://stackoverflow.com/questions/56351804/how-to-use-a-nested-query-to-update-a-value-in-another-table", "title": "How to use a nested query to update a value in another table?", "body": "<p>I have a table (TablevVariables) which stores the last file updated date, the latest log date imported, etc, which is basically storing the values so that that the duplicate data import won't happen if the tool run multiple times a day. </p>\n\n<p>So each day, the logs will be appended to a log archive table which will be used later for other historical data analysis. Then update the <code>TableVariables.Keyvalue=&lt;latest date of the log file&gt;</code>.</p>\n\n<p>Update Template: </p>\n\n<pre><code>UPDATE my_table SET my_column='new value' WHERE something='some value';\n</code></pre>\n\n<p>My Update Query:</p>\n\n<pre><code>UPDATE TablevVariables SET [TablevVariables].KeyValue =\n    (SELECT Max([xxxx_Archived_Log].[\u5e74\u6708\u65e5]) FROM xxxx_Archived_Log)\nWHERE [TablevVariables].KeyName=\"xxxx_Archived_Log\";\n</code></pre>\n\n<p>When I try to execute this query, access throws the error that \"Operation must use an updatable query\".</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1559090206, "post_id": 56351610, "comment_id": 99308165, "body": "<code>ActiveWindow.ScrollRow = Row.Row</code>"}, {"owner": {"reputation": 156, "user_id": 11158543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a367a87c8b9f0787eee934e8494312?s=128&d=identicon&r=PG&f=1", "display_name": "V.Hunon", "link": "https://stackoverflow.com/users/11158543/v-hunon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559090820, "post_id": 56351610, "comment_id": 99308252, "body": "@TimWilliams Saved my day sir, please write it as an answer!"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559145003, "post_id": 56351610, "comment_id": 99331843, "body": "Hey @V.Hunon what about mine?!? Aside from inducing seizures, it is awesome?!?! \u2604\ud83d\ude1c"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 7281608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f053f995cc8e582b19adee4526f29b9?s=128&d=identicon&r=PG&f=1", "display_name": "GarrettS1", "link": "https://stackoverflow.com/users/7281608/garretts1"}, "is_accepted": false, "score": 0, "last_activity_date": 1559093887, "creation_date": 1559093887, "answer_id": 56351992, "question_id": 56351610, "link": "https://stackoverflow.com/questions/56351610/excel-vba-loop-and-show-interactively-changes/56351992#56351992", "title": "Excel VBA loop and show interactively changes", "body": "<p>You could use the status bar to show progress. Use <code>Application.StatusBar =</code> and then follow it with your choice of string, integer, etc. If it is put inside the 'For' statement, it would update with each iteration.</p>\n"}, {"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1559145010, "post_id": 56352279, "comment_id": 99331845, "body": "Nice. Better than mine."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1559096824, "creation_date": 1559096824, "answer_id": 56352279, "question_id": 56351610, "link": "https://stackoverflow.com/questions/56351610/excel-vba-loop-and-show-interactively-changes/56352279#56352279", "title": "Excel VBA loop and show interactively changes", "body": "<pre><code>ActiveWindow.ScrollRow = Row.Row\n</code></pre>\n\n<p>should do what you want</p>\n"}, {"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1559098405, "creation_date": 1559098405, "answer_id": 56352458, "question_id": 56351610, "link": "https://stackoverflow.com/questions/56351610/excel-vba-loop-and-show-interactively-changes/56352458#56352458", "title": "Excel VBA loop and show interactively changes", "body": "<p>What select or hide not work?</p>\n\n<pre><code>rng.EntireRow.Hidden = True\n    For Each row In rng.Rows\n\n        row.EntireRow.Hidden = False\n        'do something.\n        rng.EntireRow.Hidden = True\n\n    Next\n\nrng.EntireRow.Hidden = False\n</code></pre>\n\n<p>or </p>\n\n<pre><code>For Each row In rng.Rows\n\n    row.Select\n    'do something.\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 156, "user_id": 11158543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a367a87c8b9f0787eee934e8494312?s=128&d=identicon&r=PG&f=1", "display_name": "V.Hunon", "link": "https://stackoverflow.com/users/11158543/v-hunon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56352279, "answer_count": 3, "score": 1, "last_activity_date": 1566045165, "creation_date": 1559089641, "last_edit_date": 1566045165, "question_id": 56351610, "link": "https://stackoverflow.com/questions/56351610/excel-vba-loop-and-show-interactively-changes", "title": "Excel VBA loop and show interactively changes", "body": "<p>I have a VBA Application which loops through a range and does some changes.\nHowever, I don't care much about the running time but I want to show the User that changes were made in run time.</p>\n\n<p>I was thinking about something like this.</p>\n\n<pre><code>Private Sub ProcessALBODY(ByRef Fullpath, ByRef MasterWB)\n...\n\n    For Each Row In rng.rows\n    ... 'Do Something\n\n    DoEvents\n    ActiveWindow.ScrollRow = 1 'for each row scrolldown and proceed to next row\n    Next\n\n...\nEnd Sub\n</code></pre>\n\n<p>Unfortunately my application freezes until it has finished..</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "is_accepted": false, "score": 0, "last_activity_date": 1559088010, "creation_date": 1559088010, "answer_id": 56351448, "question_id": 56351283, "link": "https://stackoverflow.com/questions/56351283/how-to-dynamically-autofill-cells/56351448#56351448", "title": "How to Dynamically Autofill Cells", "body": "<p>first you can get the last row coming from column B and use that as reference for auto fill. see my example below.</p>\n\n<pre><code>Dim lastRow As Integer\nRange(\"B1\").Select\n\nSelection.End(xlDown).Select\nlastRow = Selection.Row\nRange(\"C2\").Select\nSelection.AutoFill Destination:=Range(\"C2:C\" &amp; lastRow)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1559089057, "creation_date": 1559089057, "answer_id": 56351562, "question_id": 56351283, "link": "https://stackoverflow.com/questions/56351283/how-to-dynamically-autofill-cells/56351562#56351562", "title": "How to Dynamically Autofill Cells", "body": "<p>You always want to use <code>Long</code> when finding the last row.  Integers only go to 32,767 and there are over 1 million rows.  You should also avoid using <code>Select</code>.</p>\n\n<pre><code>Dim lastRow as Long\nlastRow=Cells(Rows.Count,2).End(xlup).Row\n\nRange(\"C2\").AutoFill Destination:=Range(\"C2:C\" &amp; lastRow)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11476439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff33180e99cd47415ad4ae73252f7a6?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne_Chen", "link": "https://stackoverflow.com/users/11476439/wayne-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1559089057, "creation_date": 1559086522, "question_id": 56351283, "link": "https://stackoverflow.com/questions/56351283/how-to-dynamically-autofill-cells", "title": "How to Dynamically Autofill Cells", "body": "<p>I would like to dynamically fill a column. However, with the VBA code I have now, the formula fills all the way to the max row count (1.04 million). I would like it to stop at the max rows found in the column to its left (same as manual auto fill) </p>\n\n<pre><code>Sub Vlookup()\n\nRange(\"C2\").Select\nActiveCell.FormulaR1C1 = \n\"=IFERROR(VLOOKUP(RC[-2],'C:\\Test.xlsx'!R2C6:R1000C15,10,FALSE),\"\"\"\")\"\nSelection.AutoFill Destination:=Range(\"C2\", Range(\"C2\").End(xlDown))\n\nEnd Sub\n</code></pre>\n\n<p>I tried to use </p>\n\n<pre><code>Selection.Autofill Destination := \nRange(\"C2\",Selection.Range(\"C2\").End(xldown))\n</code></pre>\n\n<p>But that didnt seem to work either</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1559085010, "post_id": 56351046, "comment_id": 99307163, "body": "The mechanics of a progress bar (as found in various tutorials) should be the same no matter the source of the data that the bar is displaying. Why not just accumulate the sum of the iteration counts in that last loop and update the bar afterwards? Also -- what do vegan wolves eat?"}, {"owner": {"reputation": 21, "user_id": 11517508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a6f7137d920106dbfcc7c6e31e60d?s=128&d=identicon&r=PG&f=1", "display_name": "VeganWolf", "link": "https://stackoverflow.com/users/11517508/veganwolf"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1559085305, "post_id": 56351046, "comment_id": 99307232, "body": "It&#39;s not the progress bar I&#39;m having issues with. It&#39;s collecting the progress across all instances of Excel. I will clarify this in the post. Vegan wolves eat tofu."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559105342, "post_id": 56351046, "comment_id": 99310883, "body": "It&#39;s difficult to imaging that writing to a files (or one file per instance) would really slow things down, unless you&#39;re planning on very frequent updates."}, {"owner": {"reputation": 21, "user_id": 11517508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a6f7137d920106dbfcc7c6e31e60d?s=128&d=identicon&r=PG&f=1", "display_name": "VeganWolf", "link": "https://stackoverflow.com/users/11517508/veganwolf"}, "edited": false, "score": 0, "creation_date": 1559106434, "post_id": 56351046, "comment_id": 99311125, "body": "It would be between 1,000-5,000 iterations with each iteration writing to a file and saving so that the master could read it. I suppose one way to reduce that number would be to say something like only write every 5 iterations but even still that seems like a lot of writing to files, no?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1559106560, "post_id": 56351046, "comment_id": 99311148, "body": "Writing to a file is pretty fast...    However, if you&#39;re creating your additional instances using CreateObject, you can use public methods on the workbook object to pass messages, as long as you put a reference to the master workbook in each &quot;slave&quot; workbook."}, {"owner": {"reputation": 21, "user_id": 11517508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a6f7137d920106dbfcc7c6e31e60d?s=128&d=identicon&r=PG&f=1", "display_name": "VeganWolf", "link": "https://stackoverflow.com/users/11517508/veganwolf"}, "edited": false, "score": 0, "creation_date": 1559108915, "post_id": 56351046, "comment_id": 99311881, "body": "I\u2019ll give that a shot then and time it to check if performance takes any significant hit. Will report back on this. Thanks. Could you elaborate on how you might use messages here?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1559175971, "last_edit_date": 1559175971, "creation_date": 1559110015, "answer_id": 56354071, "question_id": 56351046, "link": "https://stackoverflow.com/questions/56351046/sharing-variables-between-multiple-instances-of-excel/56354071#56354071", "title": "Sharing Variables Between Multiple Instances of Excel", "body": "<p>Ok expanding on my comment here's my rough and ready test code: spin up a few \"slave\" Excel instances, load in a copy of the \"driver\" workbook (as readonly), and then give each slave workbook a reference to the master workbook, which they can use to call a public <code>LogProgress</code> method on the <code>ThisWorkbook</code> object.</p>\n\n<p>In a regular module:</p>\n\n<pre><code>Option Explicit\n\nDim col As Collection '&lt;&lt; In the master, stores references to slave application instances\n                      '    Not really used here though\n\n'For \"slave\" workbooks - dummy \"do some work\" long-running \n'   routine which periodically reports back\nPublic Sub DoWork()\n    Dim n As Long\n    'kick something off...\n    For n = 1 To 20\n        Application.Wait Now + TimeSerial(0, 0, 1)\n        ThisWorkbook.ReportWork n '&lt;&lt; update master\n    Next n\nEnd Sub\n\n'Creates slave instances loaded with copies of this workbook\n'  and a reference to the master workbook, and loads them into \"col\"\nSub InitSlaves()\n    Dim x As Long, app\n    ThisWorkbook.Save\n    Debug.Print \"Master instance\", Application.Hwnd\n    Set col = New Collection\n    For x = 1 To 5\n        col.Add XlInstance(ThisWorkbook.FullName)\n    Next x\nEnd Sub\n\n'Set up and return a new Excel instance\nFunction XlInstance(wb As String)\n    Dim app, wkb\n    Set app = CreateObject(\"excel.application\")\n    app.Visible = True\n    Debug.Print \"Slave instance\", app.Hwnd\n    Set wkb = app.Workbooks.Open(wb, ReadOnly:=True)\n    Set wkb.Master = ThisWorkbook\n    wkb.StartWork\n    Set XlInstance = app\nEnd Function\n</code></pre>\n\n<p>In the <code>ThisWorkbook</code> module:</p>\n\n<pre><code>Option Explicit\n\nDim masterWb As Object '&lt;&lt; in a slave workbook, a reference to the master wb\n\n'In a slave workbook, gets a reference to the master workbook\n'  Note: you *must* use 'As Object' here or you can't call the custom\n'        methods later (because a \"WorkBook\"-type doesn't have them)\nPublic Property Set Master(wb As Object)\n    Set masterWb = wb\nEnd Property\n\n'Gets called on the slave workbooks from the master\nPublic Sub StartWork()\n   Application.OnTime Now, \"DoWork\"\nEnd Sub\n\n'From a slave, send a message back to the master workbook\nPublic Sub ReportWork(msg)\n    masterWb.LogProgress Application.Hwnd, msg\nEnd Sub\n\n'In the master, get a message from a slave workbook\nPublic Sub LogProgress(id, msg)\n    Dim m\n    m = Application.Match(id, Sheet1.Columns(1), 0)\n    If IsError(m) Then\n        m = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row + 1\n        Sheet1.Cells(m, 1).Value = id\n    End If\n    Sheet1.Cells(m, 2).Value = msg\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11517508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/724a6f7137d920106dbfcc7c6e31e60d?s=128&d=identicon&r=PG&f=1", "display_name": "VeganWolf", "link": "https://stackoverflow.com/users/11517508/veganwolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1559175971, "creation_date": 1559084296, "last_edit_date": 1559085604, "question_id": 56351046, "link": "https://stackoverflow.com/questions/56351046/sharing-variables-between-multiple-instances-of-excel", "title": "Sharing Variables Between Multiple Instances of Excel", "body": "<p>I have multiple instances of Excel calculating different parts of a problem and I want to be able to track total progress as the number of iterations completed across each instance. How can I share variables between instances of Excel? </p>\n\n<p>My current thought is storing these numbers in the name manager of a master workbook and having the master workbook sum up the value for each name as a total number of iterations completed number. I've also tried the same concept by referencing the hidden namespace in the master instance of Excel as described by Chip Pearson here: <a href=\"http://www.cpearson.com/excel/hidden.htm\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/hidden.htm</a>. Ultimately I'm struggling to keep the progress numbers across instances in memory. I do not want to write to a file that the master Excel instance references as that would slow things down quite a bit.  </p>\n\n<p>Inside of a working instance of Excel would be something like the following code to transmit back it's current progress to the namespace of the master workbook:</p>\n\n<pre><code>Dim xlApp As Excel.Application\nSet xlApp = GetObject(MasterPath).Application\n'The MasterPath is defined as the full path of the master instance: ActiveWorkbook.FullName\nWith xlApp\n    .Workbooks(MasterName).Activate\n    .ActiveWorkbook.Names(\"Thread_\" &amp; i &amp; \"_iter\").RefersTo = \"=\" &amp; CStr(i - seqFrom + 1)\nEnd With\n</code></pre>\n\n<p>The above code is what is giving me errors. It gets stuck in an infinite loop. When I remove it, everything executes as expected. </p>\n\n<p>In the master workbook would be something like the following to show the total progress across all instances:</p>\n\n<pre><code>For thread = 1 To cThreads\n    progress_Arr(thread) = CLng(Right(ThisWorkbook.Names(\"Thread_\" &amp; thread &amp; \"_iter\").RefersTo, Len(ThisWorkbook.Names(\"Thread_\" &amp; thread &amp; \"_iter\").RefersTo) - 1))\n    progress = progress + progress_Arr(thread)\n    Debug.Print \"Thread \" &amp; thread &amp; \": \" &amp; progress_Arr(thread)\nNext thread\n</code></pre>\n\n<p>I would ultimately like to be able to compile all of the iterations in the master instance of Excel.</p>\n"}, {"tags": ["excel", "vba", "date"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11569934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71290728b00d6ef29e30548068a11b61?s=128&d=identicon&r=PG&f=1", "display_name": "VBA_Squish", "link": "https://stackoverflow.com/users/11569934/vba-squish"}, "edited": false, "score": 0, "creation_date": 1559084789, "post_id": 56351047, "comment_id": 99307121, "body": "This definitely works, but do you know how I could produce this in VBA?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1559084913, "last_edit_date": 1559084913, "creation_date": 1559084317, "answer_id": 56351047, "question_id": 56351021, "link": "https://stackoverflow.com/questions/56351021/need-to-change-date-into-current-work-week-1-52-but-skip-to-the-next-week-if/56351047#56351047", "title": "Need to change date into current work week (1-52), but skip to the next week if the day is Wed - Sat in VBA", "body": "<p>how about this:</p>\n\n<pre><code>=YEAR(A1) &amp; TEXT(WEEKNUM(A1,13),\"00\")\n</code></pre>\n\n<p>WeekNum returns the weeknumber with <code>13</code> saying it starts on Wednesday:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NuJYY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NuJYY.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>VBA</p>\n\n<pre><code> wkcd = Year(Range(\"A1\")) &amp; Format(Application.WeekNum(Range(\"A1\")),\"00\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11569934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71290728b00d6ef29e30548068a11b61?s=128&d=identicon&r=PG&f=1", "display_name": "VBA_Squish", "link": "https://stackoverflow.com/users/11569934/vba-squish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559094127, "creation_date": 1559084088, "last_edit_date": 1559094127, "question_id": 56351021, "link": "https://stackoverflow.com/questions/56351021/need-to-change-date-into-current-work-week-1-52-but-skip-to-the-next-week-if", "title": "Need to change date into current work week (1-52), but skip to the next week if the day is Wed - Sat in VBA", "body": "<p>I'm having trouble writing code in VBA that would allow me to input any given date then have an output of the current work week.  I need a restriction of if the date is Sunday through Tuesday, it will keep that current work week and year but if the date is Wednesday through Saturday, then the next work week and year will show.  For example, I'm looking to input (5/28/19) and have an output of 201922 or an input of (5/29/19) with an output of 201923 even though its technically the same work week.</p>\n\n<p>Before getting too in depth, I do have a working function that provides the year and work week, but I'm trying to adapt the function or add a separate function that will change in to the next work week according to the given date.</p>\n\n<p>I'm new to VBA but have tried to do a little research over the last few days.  I was thinking that I could somehow have one input of the date then have two outputs where one would be the year and work week then the other would be the number associated with that date (1 for Sunday, 2 for Monday, and so on).  I tried to create an if then statement that says if the number associated with that date is 1, 2, or 3 then the workweek would stay the same.  If it was any other number then 1 would be added to that work week so it would move to the next one.  I'm having trouble with trying to make two outputs and have them connected, if that makes any sense.</p>\n\n<p>This is the code that I tried to create, but continuously failed at making. The function that gives the correct work week (without the adaptation of the work week based on the date weekday) is WWV1 </p>\n\n<pre><code>Function WWV2(WeekdayName As Integer)\n\n\nDim WWV1 As Integer\n\nIf WeekdayName(Date) = 1 Or 2 Or 3 Then WWV1 = WWV1\n\nElse: WWV1 = WWV1 + 1\n\n\nEnd Function\n</code></pre>\n\n<p>This provides the cell with #NUM! when I use the function in that cell, which I assume is because I need to somehow connect the two functions.</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1559083989, "post_id": 56350988, "comment_id": 99306963, "body": "so 1st place would have the least or the most cells under 0?"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "edited": false, "score": 0, "creation_date": 1559087231, "post_id": 56351106, "comment_id": 99307631, "body": "You tagged it with formula."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1559084767, "creation_date": 1559084767, "answer_id": 56351106, "question_id": 56350988, "link": "https://stackoverflow.com/questions/56350988/vba-ranking-highest-to-lowest-by-counting-negative-values/56351106#56351106", "title": "VBA - Ranking Highest to Lowest by Counting Negative Values?", "body": "<p>You could use this formula:</p>\n\n<pre><code>=SUMPRODUCT(--(COUNTIF(OFFSET($B$1,(ROW($1:$3)-1),0,1,4),\"&lt;0\")&gt;COUNTIF(B1:E1,\"&lt;0\")))+1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0LdYC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0LdYC.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 555, "user_id": 2472696, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/be0f543664bf4ff8c3dacc19c41c8402?s=128&d=identicon&r=PG&f=1", "display_name": "ggmkp", "link": "https://stackoverflow.com/users/2472696/ggmkp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 56351106, "answer_count": 1, "score": -1, "last_activity_date": 1559113481, "creation_date": 1559083738, "last_edit_date": 1559113481, "question_id": 56350988, "link": "https://stackoverflow.com/questions/56350988/vba-ranking-highest-to-lowest-by-counting-negative-values", "title": "VBA - Ranking Highest to Lowest by Counting Negative Values?", "body": "<p>How to rank highest to lowest by counting negative values?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xltn8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xltn8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would probably use something like this follow by if elseif logic but I can't seems to figure it out</p>\n\n<pre><code>Set CountRng = range(\"B1:E1\") \nCountApple = Application.WorksheetFunction.CountIf(CountRng, \"&lt;0\")\nCountOrange ..\nCountBanana ..\n\nIf CountApple &gt; CountOrange then or endif...\n</code></pre>\n\n<p>Maybe there is a better way to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559082555, "post_id": 56350765, "comment_id": 99306570, "body": "It\u2019s actually the American spelling of color."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559082701, "post_id": 56350765, "comment_id": 99306615, "body": "sorry, im Australian... its habit"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1559083171, "post_id": 56350765, "comment_id": 99306746, "body": "I missed that you\u2019re using the wrong property too."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559083270, "post_id": 56350765, "comment_id": 99306771, "body": "LOL, I see you did the same thing.. why cant language be universal!?"}, {"owner": {"reputation": 15, "user_id": 11309298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99fd5.jpg?s=128&g=1", "display_name": "Tyler P", "link": "https://stackoverflow.com/users/11309298/tyler-p"}, "edited": false, "score": 0, "creation_date": 1559096861, "post_id": 56350765, "comment_id": 99309289, "body": "Yeah...I got caught with that too. Knew it would be something simple."}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1559082615, "post_id": 56350820, "comment_id": 99306590, "body": "I should add <code>.ColorIndex</code> is a value between <code>1</code> and <code>56</code>. It represnts some colors but not all (obviously) <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.ColorIndex\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/Excel.ColorIndex</a>"}, {"owner": {"reputation": 15, "user_id": 11309298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99fd5.jpg?s=128&g=1", "display_name": "Tyler P", "link": "https://stackoverflow.com/users/11309298/tyler-p"}, "edited": false, "score": 0, "creation_date": 1559096905, "post_id": 56350820, "comment_id": 99309302, "body": ".Color works perfectly with the full RGB. ColorIndex with the correct numbers also works. Much appreciated. Knew it would be something simple. Also helps when you use the american spelling of color (force of habit)"}], "tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": true, "score": 2, "last_activity_date": 1559082461, "creation_date": 1559082461, "answer_id": 56350820, "question_id": 56350765, "link": "https://stackoverflow.com/questions/56350765/object-cell-range-doesnt-support-font-property-in-vba/56350820#56350820", "title": "Object Cell/Range doesn&#39;t support .Font property in VBA", "body": "<p><code>.ColorIndex</code> is incorrect. Use <code>.Color</code></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim ErrorWagonPack As Boolean, ErrorCellsNotEmpty As Boolean, WagonPack As Integer, cel As Range, Target As Range\n\n    ErrorWagonPack = False\n    ErrorCellsNotEmpty = False\n    Set Target = Application.Range(\"ConsistInput\")\n\n    For Each cel In Target 'issue is here somewhere I think. It's related to how the cel is created and as such what properties it can have\n        Application.EnableEvents = False\n        WagonPack = 0\n        If Len(cel.Value) &gt; 0 Then\n            WagonPack = Application.Index(Application.Range(\"WagonData\"), Application.Match(cel.Value, Application.Range(\"WagonData\").Columns(1), 0), 4)\n            If cel.Offset(0, 1).Value Mod WagonPack &gt; 0 Then\n                ErrorWagonPack = True\n                cel.Font.Color = RGB(156, 0, 6) '438 error here\n                cel.Interior.Color = RGB(255, 199, 206) '438 error here too\n            End If\n        End If\n    Next cel\n\nIf ErrorWagonPack = True Or ErrorCellsNotEmpty = True Then\n    Exit Sub\nEnd If\n\n'calculate stuff\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1559083029, "last_edit_date": 1559083029, "creation_date": 1559082718, "answer_id": 56350852, "question_id": 56350765, "link": "https://stackoverflow.com/questions/56350765/object-cell-range-doesnt-support-font-property-in-vba/56350852#56350852", "title": "Object Cell/Range doesn&#39;t support .Font property in VBA", "body": "<p>The <code>.ColorIndex</code> property is between 1 and 56:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim cel As Range\n    Set cel = Worksheets(1).Range(\"A1\")\n    cel.Interior.ColorIndex = 1\n    cel.Font.ColorIndex = 20\n\nEnd Sub\n</code></pre>\n\n<p>The 2 RGB values go way further than 56:</p>\n\n<pre><code>Sub TestMe()\n\n    Debug.Print RGB(156, 0, 6)          '393372\n    Debug.Print RGB(255, 199, 206)      '13551615\n\nEnd Sub\n</code></pre>\n\n<p>Thus, the only values to be safely used are the 56 red values, between:</p>\n\n<p><code>cel.Font.ColorIndex = RGB(56, 0, 0)</code></p>\n\n<p>and </p>\n\n<p><code>cel.Font.ColorIndex = RGB(1, 0, 0)</code></p>\n\n<p>As an alternative, without using <code>ColorIndex</code> the <code>Range().Font.Color</code> supports the complete RGB values:</p>\n\n<pre><code>Range(\"A1\").Font.Color = RGB(100, 20, 255)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11309298, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99fd5.jpg?s=128&g=1", "display_name": "Tyler P", "link": "https://stackoverflow.com/users/11309298/tyler-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 56350820, "answer_count": 2, "score": 1, "last_activity_date": 1559083052, "creation_date": 1559082079, "last_edit_date": 1559083052, "question_id": 56350765, "link": "https://stackoverflow.com/questions/56350765/object-cell-range-doesnt-support-font-property-in-vba", "title": "Object Cell/Range doesn&#39;t support .Font property in VBA", "body": "<p>I'm trying to colour code cells to give the user a warning about which cell's data is incorrect before running a calculation. Currently throwing a:</p>\n\n<blockquote>\n  <p>run time error 438 object doesn't support property </p>\n</blockquote>\n\n<p>when trying to run through all the data.</p>\n\n<p>Basically creating a worksheet to allow the user to input some data on a consist, then based off some back end data/restrictions, spit out an answer of what they can/can't do. I've got a level of error checking already in the initial code as the user inputs data (basically to try and encourage them to make sure the data they're inputting is valid before they try and run the calculation) and this works fine using a Worksheet_Change subroutine which can loop through all cells one at a time (within the target range) no worries.</p>\n\n<p>If I try replicate this (using a named range instead of the Target cells from the change function) it seems to do one of two things: it will try and send through a range of cells, rather than individual cells and fail when it tries to match data from the \"cells\" rather than the single cell it should be trying to match, OR it will throw the 438 error when it tries to colour it in.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n    Dim ErrorWagonPack As Boolean, ErrorCellsNotEmpty As Boolean, WagonPack As Integer, cel As Range, Target As Range\n\n    ErrorWagonPack = False\n    ErrorCellsNotEmpty = False\n    Set Target = Application.Range(\"ConsistInput\")\n\n    For Each cel In Target 'issue is here somewhere I think. It's related to how the cel is created and as such what properties it can have\n        Application.EnableEvents = False\n        WagonPack = 0\n        If Len(cel.Value) &gt; 0 Then\n            WagonPack = Application.Index(Application.Range(\"WagonData\"), Application.Match(cel.Value, Application.Range(\"WagonData\").Columns(1), 0), 4)\n            If cel.Offset(0, 1).Value Mod WagonPack &gt; 0 Then\n                ErrorWagonPack = True\n                cel.Font.ColourIndex = RGB(156, 0, 6) '438 error here\n                cel.Interior.ColourIndex = RGB(255, 199, 206) '438 error here too\n            End If\n        End If\n    Next cel\n\nIf ErrorWagonPack = True Or ErrorCellsNotEmpty = True Then\n    Exit Sub\nEnd If\n\n'calculate stuff\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Ideally I'd like to get to a point where I run the code, colour the cells causing issues/with incorrect data, then if doesn't throw any error variables, run the calculation but the 438 error seems to be the sticking point. I'm almost willing to bet it's something simple I'm just missing but can't figure it out. Probably doesn't help I'm still pretty green with VBA.</p>\n"}, {"tags": ["vba", "subroutine"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1559082179, "post_id": 56350712, "comment_id": 99306439, "body": "Well first of all, would be simpler to just multiply those values instead of looping?! i.e.: <code>hg = hg + (tf * 0.15)</code> or very similar logic/calculation."}, {"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1559117173, "post_id": 56350712, "comment_id": 99315720, "body": "Seems that <code>subby</code> doesn&#39;t return anything (<code>hg</code> in <code>subby</code> is not the same variable as <code>hg</code> in <code>main</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 32963, "user_id": 2330053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UKKyC.jpg?s=128&g=1", "display_name": "Idle_Mind", "link": "https://stackoverflow.com/users/2330053/idle-mind"}, "is_accepted": false, "score": 0, "last_activity_date": 1559084857, "creation_date": 1559084857, "answer_id": 56351118, "question_id": 56350712, "link": "https://stackoverflow.com/questions/56350712/calling-a-sub-containing-a-do-until-loop-within-a-if-else-statement/56351118#56351118", "title": "Calling a Sub (containing a Do until loop) within a IF/Else Statement", "body": "<p>The problem with your attempt at moving to a sub is that the your variables are not visible in that sub.  I see that you tried to \"fix\" it by declaring those variables as locals, but then the main variables don't get changed right?</p>\n\n<p>One workaround is to insert a MODULE, then declare your variables there as <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/public-statement\" rel=\"nofollow noreferrer\">PUBLIC</a>:</p>\n\n<pre><code>Public tmin As Double  \nPublic hgmin As Double\nPublic tf As Double\nPublic hmix As Double\nPublic hg As Double\nPublic i As Double\n</code></pre>\n\n<p>From the docs:</p>\n\n<blockquote>\n  <p>Variables declared by using the Public statement are available to all\n  procedures in all modules in all applications</p>\n</blockquote>\n\n<p>Be sure to get rid of those duplicate variable declarations, both inside your subby() and in main().  They should only be declared in the module.</p>\n\n<p>An alternative would be to pass ALL of the variables that need to be accessed and changed into the method.  You have to decide which is easier, or better for your situation.</p>\n"}], "owner": {"reputation": 1, "user_id": 11569795, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6XuH8mNSXhw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcvgtOabDVH7FA-3MebqCy3mROzfA/mo/photo.jpg?sz=128", "display_name": "Reginald", "link": "https://stackoverflow.com/users/11569795/reginald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559116992, "creation_date": 1559081703, "last_edit_date": 1559116992, "question_id": 56350712, "link": "https://stackoverflow.com/questions/56350712/calling-a-sub-containing-a-do-until-loop-within-a-if-else-statement", "title": "Calling a Sub (containing a Do until loop) within a IF/Else Statement", "body": "<p>I have a <code>do until loop</code> I keep having to repeat within an <code>IF/ELSE</code> statement.I want to call a <code>sub</code> (containing the <code>do until loop</code>) inside IF/Else If/Then statements instead. Please help  </p>\n\n<p>This code works but I want to condense each <code>do until loop</code> into a <code>sub</code> I can call with varying <code>Tf</code> and <code>gain</code> values:</p>\n\n<pre><code>Dim tmin As Double  \nDim hgmin As Double\nDim tf As Double\nDim hmix As Double\nDim hg As Double\nDim i As Double\ntmin = -70               'Lowest temperature of fluid on chart (Fahreinhet)\nhgmin = 79.66            'Lowest enthalpy(saturated vapor)\n\ntf = InputBox(\"Enter Lower Temperature [Fahrenheit]\")   'Lower temperature of system\n\ni = tmin\nhg = hgmin\nIf tf &lt;= -9 Then\n     Do Until i = tf\n        hg = hg + 0.15\n        i = i + 1\n    Loop\nElseIf tf &gt;= -9 And tf &lt;= 60 Then\n    Do Until i = -9\n        hg = hg + 0.15\n        i = i + 1\n    Loop\n    Do Until i = tf\n        hg = hg + 0.125\n        i = i + 1\n    Loop\nEnd If \nmsgbox(hg)\nEnd Sub\n</code></pre>\n\n<p>Code below does not work, either loop stuck or gives me value of <code>hmin</code> rather than <code>hmin + (gain * amount of iterations from tmin to Tf)</code>.</p>\n\n<pre><code>Sub main()\n    Dim Tf As Double\n    Dim i As Double, hg As Double, tmin As Double, hmin As Double\n\n    Tf= InputBox(\"Enter Lower Temperature Value\")\n    hmin = 79.66\n\n    hg = hmin\n    tmin = -70\n    i = tmin\n\n    If Tf &lt;= -9 Then\n        Call subby(Tf, 0.15)\n\n    ElseIf Tf &gt;= -9 And Tf &lt;= 60 Then\n        Call subby(-9, 0.15)\n        Call subby(Tf, 0.125)\n    End If\n    msgbox(hg)\n\nEnd Sub\n\nSub subby(T As Double, gain As Double)\n    Dim i As Double, hg As Double, tmin As Double, hmin As Double\n    tmin = -70\n    hmin = 79.66\n\n    hg = hmin\n    i = tmin\n    Do Until i = T\n        hg = hg + gain\n        i = i + 1\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>I want the below code attempting the method to call another <code>sub</code> into the <code>main sub</code> <code>IF/Else</code> statement to match the above code values for <code>hg</code>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559081515, "post_id": 56350621, "comment_id": 99306271, "body": "I tested your code and it works.. Have you got the code in the worksheet? If it&#39;s in a module it wont work"}, {"owner": {"reputation": 917, "user_id": 7365949, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fafca5759ac06d50277c66b284f2fd77?s=128&d=identicon&r=PG&f=1", "display_name": "ptts", "link": "https://stackoverflow.com/users/7365949/ptts"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559081632, "post_id": 56350621, "comment_id": 99306299, "body": "I have it in a sheet. So F14 does update the initial values if you set H14-H17 to zero or something? This is very odd"}, {"owner": {"reputation": 917, "user_id": 7365949, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fafca5759ac06d50277c66b284f2fd77?s=128&d=identicon&r=PG&f=1", "display_name": "ptts", "link": "https://stackoverflow.com/users/7365949/ptts"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1559081827, "post_id": 56350621, "comment_id": 99306350, "body": "HM, now it work, no other change made"}], "answers": [{"tags": [], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "is_accepted": true, "score": 1, "last_activity_date": 1559081820, "creation_date": 1559081820, "answer_id": 56350727, "question_id": 56350621, "link": "https://stackoverflow.com/questions/56350621/one-macro-running-the-other-does-not/56350727#56350727", "title": "One macro running , the other does not", "body": "<p>It think you need to change the if statements a bit.</p>\n\n<pre><code>Option Explicit\n\n Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n If Selection.Count = 1 Then\n    If Target = Range(\"F13\") Then\n        If Not Intersect(Target, Range(\"F13\")) Is Nothing Then\n            Call GetCurrency\n        End If\n     Else\n            If Not Intersect(Target, Range(\"F14\")) Is Nothing Then\n                Call UpdateCurrency\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 917, "user_id": 7365949, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fafca5759ac06d50277c66b284f2fd77?s=128&d=identicon&r=PG&f=1", "display_name": "ptts", "link": "https://stackoverflow.com/users/7365949/ptts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14, "favorite_count": 0, "accepted_answer_id": 56350727, "answer_count": 1, "score": 0, "last_activity_date": 1559081820, "creation_date": 1559081138, "last_edit_date": 1559081413, "question_id": 56350621, "link": "https://stackoverflow.com/questions/56350621/one-macro-running-the-other-does-not", "title": "One macro running , the other does not", "body": "<p>I am importing currency data from a website on a <strong>click event</strong>.</p>\n\n<p>The import works and its called by this code:</p>\n\n<pre><code>Option Explicit\n\n Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Selection.Count = 1 Then\n    If Not Intersect(Target, Range(\"F13\")) Is Nothing Then\n        Call GetCurrency\n    End If\nEnd If\nIf Selection.Count = 1 Then\n    If Not Intersect(Target, Range(\"F14\")) Is Nothing Then\n        Call UpdateCurrency\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>If the cell F13 is clicked, the <code>GetCurrency</code> macro runs, imports the data, wonderful.</p>\n\n<p><em>But clicking F14 causes nothing.</em></p>\n\n<p>The update currency macro looks like this</p>\n\n<pre><code>Sub UpdateCurrency()\n\nRange(\"N15\").Value = Range(\"I19\").Value\nRange(\"N14\").Value = Range(\"I26\").Value\nRange(\"N16\").Value = Range(\"I22\").Value\n\n End Sub\n</code></pre>\n\n<p>This should just update some other cells in order to make another formula work properly. Question is, why does clicking the cell F14 not run the UpdateCurrency function?</p>\n"}, {"tags": ["excel", "vba", "textbox", "userform"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1559401980, "post_id": 56350611, "comment_id": 99412899, "body": "Suggest to fully qualify your range references to be sure to address the correct workbook, e.g. via <code>ThisWorkbook.Worksheets(&quot;Sheet2&quot;).</code>\u2026  Assuming there exists another <code>Sheet2</code> currently active, your lastrow Formula would result in row 1 if its column B is empty and your loop wouldn&#39;t show anything. BTW I&#39;d prefer <code>Worksheets</code> to <code>Sheets</code> only as these comprise not only worksheets, but also shapes etc."}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 10713658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/siljY.jpg?s=128&g=1", "display_name": "Mariano Luis Villa", "link": "https://stackoverflow.com/users/10713658/mariano-luis-villa"}, "reply_to_user": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1559137882, "post_id": 56351746, "comment_id": 99327735, "body": "That&#39;s odd. The problem isn&#39;t the assignment, then. I would check if the other values are correct. See if the &quot;id&quot; is actually in ComboBox17, if &quot;finalrow&quot; is what you&#39;re expecting it to be, as well as if there&#39;s something in <code>Cells(i, 9)</code>. Here&#39;s a sample that runs pretty much your snippet: <a href=\"https://1drv.ms/x/s!AiOspEx0IwKt8k5bfyYefbIO_uTF\" rel=\"nofollow noreferrer\">1drv.ms/x/s!AiOspEx0IwKt8k5bfyYefbIO_uTF</a>"}, {"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1559141628, "post_id": 56351746, "comment_id": 99329976, "body": "i have added two screen shots. in the form the flange size is combobox17, the results should show in textbox18 &quot;torque value&quot;.    if combobox17 = &quot;4&quot; then textbox18 should be &quot;89&quot;"}, {"owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "edited": false, "score": 0, "creation_date": 1559144076, "post_id": 56351746, "comment_id": 99331355, "body": "or i could figure out how to use lookup formula in vba  using combobox17 text ..?*"}], "tags": [], "owner": {"reputation": 162, "user_id": 10713658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/siljY.jpg?s=128&g=1", "display_name": "Mariano Luis Villa", "link": "https://stackoverflow.com/users/10713658/mariano-luis-villa"}, "is_accepted": false, "score": 0, "last_activity_date": 1559091140, "creation_date": 1559091140, "answer_id": 56351746, "question_id": 56350611, "link": "https://stackoverflow.com/questions/56350611/how-to-get-textbox-to-show-results/56351746#56351746", "title": "how to get textbox to show results", "body": "<p>Remember that the textbox itself is an object, in which the <code>Text</code> is a field. So if you want to change that field's value, you should try:</p>\n\n<pre><code>Me.TextBox18.Text = Sheets(\"Sheet2\").Cells(i, 9).Text\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11212757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe430ed90b97e029389e850ef22f53e?s=128&d=identicon&r=PG&f=1", "display_name": "Byron", "link": "https://stackoverflow.com/users/11212757/byron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1559141431, "creation_date": 1559081078, "last_edit_date": 1559141431, "question_id": 56350611, "link": "https://stackoverflow.com/questions/56350611/how-to-get-textbox-to-show-results", "title": "how to get textbox to show results", "body": "<p>trying to get results in textbox18, but no results. Is there something wrong with this code? \n</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\nDim id As String\nDim finalrow As Integer\nDim i As Integer\n\nid = Me.ComboBox17.Text\nfinalrow = Sheets(\"Sheet2\").Range(\"B27\").End(xlUp).Row\n\nFor i = 7 To finalrow\n    If Sheets(\"Sheet2\").Cells(i, 2).Text = id Then\n        Me.TextBox18 = Sheets(\"Sheet2\").Cells(i, 9).Text\n\n        End If\n\n    Next i\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TRv0o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TRv0o.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/YOlgL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YOlgL.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11569829, "user_type": "registered", "profile_image": "https://graph.facebook.com/2697149843647850/picture?type=large", "display_name": "Arthur Naletto", "link": "https://stackoverflow.com/users/11569829/arthur-naletto"}, "edited": false, "score": 0, "creation_date": 1559328240, "post_id": 56350653, "comment_id": 99398973, "body": "I don&#39;t believe i understood how to use this code. I am very noob in VBA, i can only create macros and edit a bit.    <code>ActiveSheet.Range(&quot;$A$1:$BK$3018&quot;).AutoFilter Field:=48, Criteria1:= _         &quot;Em Aberto- 00&quot;</code>    I need that after this part, if it returns nothing, just show all data and end the macro. but your code doesn&#39;t have the filter part. I don&#39;t know how to proceed"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1559081320, "creation_date": 1559081320, "answer_id": 56350653, "question_id": 56350502, "link": "https://stackoverflow.com/questions/56350502/when-autofilter-returns-nothing-clear-filter-and-end-macro/56350653#56350653", "title": "When autofilter returns nothing, clear filter and end macro", "body": "<p>Do something like this:</p>\n\n<pre><code>Dim myRange As Range\n\nOn Error Resume Next\nSet myRange = Range(\"your range here\").SpecialCells(xlVisible)\nOn Error GoTo 0\n\nIf myRange Is Nothing Then\n    Exit Sub\nElse\n'do stuff\nEnd If\n</code></pre>\n\n<p>You should avoid  using <code>SELECT</code>, just Google \"how to avoid using SELECT VBA\"</p>\n"}], "owner": {"reputation": 1, "user_id": 11569829, "user_type": "registered", "profile_image": "https://graph.facebook.com/2697149843647850/picture?type=large", "display_name": "Arthur Naletto", "link": "https://stackoverflow.com/users/11569829/arthur-naletto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559081320, "creation_date": 1559080380, "question_id": 56350502, "link": "https://stackoverflow.com/questions/56350502/when-autofilter-returns-nothing-clear-filter-and-end-macro", "title": "When autofilter returns nothing, clear filter and end macro", "body": "<p>I have this macro that runs a filter and delete the results, but today the filter results brought back nothing and i got an error.\nI want to make it so that when the filter in the AV range results in nothing, just clear the filter and end sub</p>\n\n<p>this problem occurs after the \"Em Aberto- 00\" filter.</p>\n\n<p>I have tried some suggestions, but being a noob that i am, most of them i could'nt understand what was going on</p>\n\n<pre><code>Columns(\"J:J\").Select\nSelection.TextToColumns Destination:=Range(\"J1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 4), TrailingMinusNumbers:=True\nColumns(\"K:K\").Select\nSelection.TextToColumns Destination:=Range(\"K1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 4), TrailingMinusNumbers:=True\n\nColumns(\"BD:BF\").Select\nSelection.Replace What:=\"\", Replacement:=\"0\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n\n\nRange(\"A1\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nSelection.AutoFilter\nActiveWindow.SmallScroll ToRight:=31\nRange(\"AV3\").Select\nActiveSheet.Range(\"$A$1:$BK$3018\").AutoFilter Field:=48, Criteria1:= _\n    \"Em Aberto- 00\"\n\nRange(\"A2\").Select\nRange(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\nSelection.SpecialCells(xlCellTypeVisible).Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1559091052, "creation_date": 1559091052, "answer_id": 56351731, "question_id": 56350447, "link": "https://stackoverflow.com/questions/56350447/how-to-read-a-single-line-out-of-a-word-document/56351731#56351731", "title": "How to read a single line out of a word document", "body": "<p>You are trying to read a docx or docm file, which is a zip archive. Word files are not plain text files, so you won't get anything meaningful treating them as such. You need to open the file with Word or another app that can read such files.</p>\n"}], "owner": {"reputation": 23, "user_id": 11504889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406c59451f72a24207cf10c9a34d718a?s=128&d=identicon&r=PG&f=1", "display_name": "ecksdee", "link": "https://stackoverflow.com/users/11504889/ecksdee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56351731, "answer_count": 1, "score": 0, "last_activity_date": 1582780018, "creation_date": 1559079967, "last_edit_date": 1582780018, "question_id": 56350447, "link": "https://stackoverflow.com/questions/56350447/how-to-read-a-single-line-out-of-a-word-document", "title": "How to read a single line out of a word document", "body": "<p>The method I used was for text files and gives gibberish as expected.</p>\n\n<pre><code>In: John Smith\nOut: PK!~8\u00ecz\u2021\u00ad[Content_Types].xml \u00a2(\u00a0\u00b4\u201d\u00cfN\u00c2@\u00c6\u00ef&amp;\u00beC\u00b3W\u00d3.x0\u00c6P8\u2022D|\u20aca;\u2026\u00d5vw\u00b3;\u00fc{{\u00a7\u00b45@U\u00f4BRf\u00be\u00df\u00f7\u00cdv;\u00bd\u00c1\u00ba,\u00a2%\u00fa\u00a0\u00adIE7\u00e9\u02c6\u00b2\u21226\u00b3T\u00bcL\u00e2[\u201cAa\n\u00a6b\u0192A\u00fa\u2014\u00bd\u00c9\u00c6a\u02c6XmB*\u00e6D\u00eeN\u00ca\u00a0\u00e6XBH\u00acC\u00c3\u2022\u00dc\u00fa\u02c6\u00fdL:Po0Cy\u00dd\u00e9\u00dcHe\n\u00a1\u00a1\u02dc*\u2020\u00e8\u00f7\u2020\u02dc\u00c3\u00a2\u00a0h\u00b4\u00e6\u00bf\u00eb$SmDt_\u00f7UV\u00a9\u00e7\n\u00ad\u20ac\u00b8,\u2014&amp;K\u00ca\u00db&lt;\u00d7\n</code></pre>\n\n<p>I'm a novice at VBA, and I'm trying to read a document line by line so that I can eventually have the macro automatically remove entire lines based on their content. </p>\n\n<pre><code>Sub ayaya()\nDim TextLine As String\nOpen ActiveDocument.Path &amp; \"\\Doc1.docm\" For Input As #1\n    Do While Not EOF(1) ' Loop until end of file.\n    Line Input #1, TextLine ' Read line into variable.\n    Debug.Print TextLine\n    Loop\n    Close #1\n\n\nEnd Sub\n</code></pre>\n\n<p>Part of me hoped that it would give \"John Smith\". I've seen some solutions put the entire document into a text file. Is there any way where I can delimit the data somehow? I'd like to be able to isolate a single line and remove it.</p>\n"}, {"tags": ["excel", "vba", "excel-2010", "conditional-formatting"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1559079533, "post_id": 56350239, "comment_id": 99305703, "body": "You can apply conditional formatting to the entire range at once (either manually or with VBA). <a href=\"https://stackoverflow.com/questions/13661965/conditional-formatting-using-excel-vba-code?rq=1\">this</a> may be of use"}, {"owner": {"reputation": 61, "user_id": 6431412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b72772c67bd659ddd610d2ac4ef776?s=128&d=identicon&r=PG&f=1", "display_name": "G.Williams", "link": "https://stackoverflow.com/users/6431412/g-williams"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1559083349, "post_id": 56350239, "comment_id": 99306795, "body": "Greetings,There are many hundreds of cells per row with several dozen different conditional formats. The purpose of saving the template (which was created by a data model developer - not me) is to avoid hard coding hundreds of individual conditional formats. The issue is when copying and pasting the conditional format to a range, not creating it in the first place. Thanks though."}], "owner": {"reputation": 61, "user_id": 6431412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b72772c67bd659ddd610d2ac4ef776?s=128&d=identicon&r=PG&f=1", "display_name": "G.Williams", "link": "https://stackoverflow.com/users/6431412/g-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1559115932, "creation_date": 1559078654, "last_edit_date": 1559115932, "question_id": 56350239, "link": "https://stackoverflow.com/questions/56350239/excel-2010-vba-how-to-pastespecial-a-row-to-a-range-of-rows-and-maintain-row-by", "title": "Excel 2010 VBA: How to PasteSpecial a row to a range of rows and maintain row by row conditional formatting", "body": "<p><strong>Excel 2010:</strong></p>\n\n<p>This question relates specifically to the use of <strong>PasteSpecial</strong> with <strong>Conditional Formatting</strong>.</p>\n\n<p><strong>Overview:</strong>\nI have a template row stored in a different sheet. This row contains roughly 350 columns and numerous formats, formulas and conditional formatting.</p>\n\n<p>Data is loaded from SQL Server and contains N rows - generally between 400 and 15000.</p>\n\n<p><strong>The doing:</strong></p>\n\n<p>I copy the template row and insert require number rows:</p>\n\n<pre><code>AryVariant = rst_ADODB.GetRows\nlRecordCount = UBound(AryVariant, 2) + 1\n\nTemplates.Range(\"TEMPLATE_ROW\").Copy\nsheet1.Range(sheet1.Range(\"Range_Start\").Offset(1, 0), sheet1.Range(\"Range_Start\").Offset(lRecordCount, 0)).EntireRow.Insert Shift:=xlDown\n</code></pre>\n\n<p>Copying from another sheet like this into a range makes a mess of the formulas, and conditional formatting, but copies the cell formats fine so i then go back over the range to update the formulas and conditional formatting:</p>\n\n<pre><code>Templates.Range(\"TEMPLATE_ROW\").Copy\nsheet1.Range(sheet1.Range(\"Range_Start\").Offset(1, 0), sheet1.Range(\"Range_Start\").Offset(lRecordCount, 0)).EntireRow.PasteSpecial xlPasteFormats\n</code></pre>\n\n<p><strong>The issue:</strong></p>\n\n<p>While this works for formulas, it merges the rows in conditional formatting in the \"Applies To\" part while leaving the Formula in the rule referring to the top row in the range. Example (not sure how to show this part as i can't upload images):</p>\n\n<blockquote>\n  <p><strong>Formula:</strong> \"=$FB18\" </p>\n  \n  <p><strong>Format:</strong> <em>Some format here</em></p>\n  \n  <p><strong>Applies To:</strong> \"=$D$18:$M$11436,$O$18:$AC$11436\"</p>\n</blockquote>\n\n<p><strong>The desired result:</strong></p>\n\n<p>What i want is every row to be self contained, so:</p>\n\n<blockquote>\n  <p><strong>Formula:</strong> \"=$FB18\" </p>\n  \n  <p><strong>Format:</strong> <em>Some format here</em></p>\n  \n  <p><strong>Applies To:</strong> \"=$D$18:$M$18,$O$18:$AC$18\"</p>\n  \n  <p><strong>Formula:</strong> \"=$FB19\" </p>\n  \n  <p><strong>Format:</strong> <em>Some format here</em></p>\n  \n  <p><strong>Applies To:</strong> \"=$D$19:$M$19,$O$19:$AC$19\"</p>\n</blockquote>\n\n<p><strong>The work around:</strong></p>\n\n<p>Currently I am applying the PasteSpecial row by row as a workaround:</p>\n\n<pre><code>For r = 0 To UBound(AryVariant, 2)\n    Templates.Range(\"TEMPLATE_ROW\").Copy\n    sheet1.Range(\"sheet1_Dataset\").Offset(r + 1, 0).EntireRow.PasteSpecial xlPasteFormats\nNext r\n</code></pre>\n\n<p>While this works, it is appallingly slow with large data-sets.</p>\n\n<p><strong>Finally, the question:</strong></p>\n\n<p>Is there a way to get the desired result while applying the formats to the range as a whole?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559314831, "post_id": 56350196, "comment_id": 99393389, "body": "See <a href=\"https://stackoverflow.com/questions/22233264/inserting-signature-into-outlook-email-from-excel-vba\" title=\"inserting signature into outlook email from excel vba\">stackoverflow.com/questions/22233264/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559314620, "post_id": 56350572, "comment_id": 99393293, "body": "You cannot concatenate two HTML strings (and emailMessage  above is not even a well formed HTML string) and expect to produce a valid HTML. The two must be merged."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559315801, "post_id": 56350572, "comment_id": 99393904, "body": "@DmitryStreblechenko Are you able to elaborate on that statement? It works perfectly the way it is. I\u2019m using this daily and don\u2019t have a problem with it."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559316824, "post_id": 56350572, "comment_id": 99394421, "body": "You got lucky that Outlook can handle some misformed HTML. It would not work in general case."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559322226, "post_id": 56350572, "comment_id": 99396678, "body": "@DmitryStreblechenko Are you able to share the right way of doing it?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559324319, "post_id": 56350572, "comment_id": 99397542, "body": "That would be a few hundred lines of some pretty dense code - you would need to load both message and signature HTML into IHTMLDocument2 object, figure out the attachments in the signature, read them, add as regular attachments to the message and set the content-id appropriately, modify the img tags, merge the HTML styles, then merge the HTML bodies."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559325687, "post_id": 56350572, "comment_id": 99398083, "body": "@DmitryStreblechenko Guess I\u2019m just lucky it works right of the box. Please feel free to share this information so others can learn from if you have the time."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559433290, "post_id": 56350572, "comment_id": 99419618, "body": "I cannot share that code, sorry - it is a part of a commercial product."}, {"owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1559459234, "post_id": 56350572, "comment_id": 99422433, "body": "@DmitryStreblechenko Too bad we could have learned a lot from that."}], "tags": [], "owner": {"reputation": 684, "user_id": 6486727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-upTdmzgae5c/AAAAAAAAAAI/AAAAAAAAATE/qB3VPvaP-yQ/photo.jpg?sz=128", "display_name": "QuickSilver", "link": "https://stackoverflow.com/users/6486727/quicksilver"}, "is_accepted": false, "score": 0, "last_activity_date": 1559080849, "creation_date": 1559080849, "answer_id": 56350572, "question_id": 56350196, "link": "https://stackoverflow.com/questions/56350196/inserting-my-default-outlook-signature-into-an-email/56350572#56350572", "title": "Inserting my default Outlook Signature into an Email", "body": "<p>You need something like this. First create a function and then call it in your outlook code just before the email details and when you put the email details do something like  <code>.HTMLBody = emailMessage &amp; Signature</code></p>\n\n<pre><code>'Change only Mysig.htm to the name of your signature\n    sigString = Environ(\"appdata\") &amp; _\n                \"\\Microsoft\\Signatures\\Mysig.htm\"\n\n    If Dir(sigString) &lt;&gt; \"\" Then\n        Signature = GetBoiler(sigString)\n    Else\n        Signature = \"\"\n    End If\n\n\nFunction GetBoiler(ByVal sFile As String) As String\n\n    Dim FSO As Object\n    Dim ts As Object\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = FSO.GetFile(sFile).OpenAsTextStream(1, -2)\n    GetBoiler = ts.readall\n    ts.Close\nEnd Function\n</code></pre>\n\n<p>Full code as example to make more sense of the above snippet.</p>\n\n<pre><code>Sub SendEmail()\n\n    Dim outlookApp As Object\n    Dim outlookMail As Object\n    Dim sigString As String\n    Dim Signature As String\n    Dim insertPhoto As String\n    Dim photoSize As String\n    Dim outlookPA As Outlook.PropertyAccessor\n\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n    Set outlookMail = outlookApp.CreateItem(0)\n\n\n    'Change only Mysig.htm to the name of your signature\n    sigString = Environ(\"appdata\") &amp; _\n                \"\\Microsoft\\Signatures\\Mysig.htm\"\n\n    If Dir(sigString) &lt;&gt; \"\" Then\n        Signature = GetBoiler(sigString)\n    Else\n        Signature = \"\"\n    End If\n\n    insertPhoto = \"C:\\Users\\marius.dragan\\Desktop\\Presale.jpg\" 'Picture path\n    photoSize = \"&lt;img src=\"\"cid:Presale.jpg\"\"height=400 width=400&gt;\" 'Change image name here\n\n    emailMessage = \"&lt;BODY style=font-size:11pt;font-family:Calibri&gt;Dear \" &amp; titleName &amp; \" \" &amp; fullName &amp; \",\" &amp; _\n                    \"&lt;p&gt;I hope my email will find you very well.\" &amp; _\n                    \"&lt;p&gt;Our &lt;strong&gt;sales preview&lt;/strong&gt; starts on Thursday the 22nd until Sunday the 25th of November.\" &amp; _\n                    \"&lt;p&gt;I look forward to welcoming you into the store to shop on preview.&lt;p&gt;\" &amp; _\n                    \"&lt;p&gt; It really is the perfect opportunity to get some fabulous pieces for the fast approaching festive season.\" &amp; _\n                    \"&lt;p&gt;Please feel free to contact me and book an appointment.\" &amp; _\n                    \"&lt;p&gt;I look forward to seeing you then.\" &amp; _\n                    \"&lt;p&gt;\" &amp; photoSize &amp; _\n                    \"&lt;p&gt;\"\n\n\n    With outlookMail\n        .To = clientEmail\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"PRIVATE SALE\"\n        .BodyFormat = 2\n        .Attachments.Add insertPhoto, 1, 0\n        .HTMLBody = emailMessage &amp; Signature 'Including photo insert and signature\n        .Importance = 2\n        .ReadReceiptRequested = True\n        .Display 'Needs to display the email and then send to display in line image\n        .send 'this will send the email without review\n\n    End With\n\n    Set outlookApp = Nothing\n    Set outlookMail = Nothing\nEnd Sub\nFunction GetBoiler(ByVal sFile As String) As String\n\n    Dim FSO As Object\n    Dim ts As Object\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = FSO.GetFile(sFile).OpenAsTextStream(1, -2)\n    GetBoiler = ts.readall\n    ts.Close\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11569559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a2cf0f3bef5876c05c427bce2034e7?s=128&d=identicon&r=PG&f=1", "display_name": "ld123", "link": "https://stackoverflow.com/users/11569559/ld123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591659484, "creation_date": 1559078380, "last_edit_date": 1591659484, "question_id": 56350196, "link": "https://stackoverflow.com/questions/56350196/inserting-my-default-outlook-signature-into-an-email", "title": "Inserting my default Outlook Signature into an Email", "body": "<p>Trying to insert my default Outlook signature. I can't seem to get it to work.  Any thoughts on this would be appreciated.</p>\n\n<p>I can't seem to get it to work with .HTML</p>\n\n<pre><code>Sub Send_email_fromexcel()\n\n    Dim edress As String\n    Dim subj As String\n    Dim message As String\n    Dim outlookapp As Object\n    Dim outlookmailitem As Object\n    Dim path As String\n    Dim lastrow As Integer\n    Dim x As Integer\n    Dim header As String\n    Dim header1 As String\n    Dim header2 As String\n    Dim header3 As String\n    Dim header4 As String\n    Dim header5 As String\n    Dim header6 As String\n    Dim header7 As String\n    Dim hearder8 As String\n    Dim data As String\n    Dim data1 As String\n    Dim data2 As String\n    Dim data3 As String\n    Dim data4 As String\n    Dim data5 As String\n    Dim data6 As String\n    Dim sig As String\n\n    x = 2\n    Do While Sheet1.Cells(x, 1) &lt;&gt; \"\"\n\n        Set outlookapp = CreateObject(\"Outlook.Application\")\n        Set outlookmailitem = outlookapp.createitem(0)\n\n        edress = Sheet1.Cells(x, 1)\n        subj = Sheet1.Cells(x, 2)\n        header = Sheet1.Cells(1, 3)\n        header2 = Sheet1.Cells(1, 4)\n        header3 = Sheet1.Cells(1, 5)\n        header4 = Sheet1.Cells(1, 6)\n        header5 = Sheet1.Cells(1, 7)\n        header6 = Sheet1.Cells(1, 8)\n        header7 = Sheet1.Cells(1, 9)\n        header8 = Sheet1.Cells(1, 10)\n\n        data = Sheet1.Cells(x, 3)\n        data1 = Sheet1.Cells(x, 4)\n        data2 = Sheet1.Cells(x, 5)\n        data3 = Sheet1.Cells(x, 6)\n        data4 = Sheet1.Cells(x, 7)\n        data5 = Sheet1.Cells(x, 8)\n        data6 = Sheet1.Cells(x, 9)\n\n\n        outlookmailitem.To = edress\n        outlookmailitem.cc = \"\"\n        outlookmailitem.bcc = \"\"\n        outlookmailitem.Subject = subj\n        outlookmailitem.body = \"Good afternoon,\" &amp; vbNewLine &amp; \" \" &amp; vbNewLine &amp; \"I'm just reaching out because we are attempting to process rewards for customers that were referred using the Lawn Doctor Referral Rewards Program,\u2026 I have put it in this email.\" &amp; vbNewLine &amp; \"Please update your records accordingly by going into \u2026(s). Please let me know when this has been completed and I will push their Amazon Gift Card out.\" &amp; vbCrLf &amp; header &amp; \" \" &amp; header2 &amp; \" \" &amp; header3 &amp; \" \" &amp; header4 &amp; \" \" &amp; header5 &amp; \" \" &amp; header6 &amp; \" \" &amp; header7 &amp; \" \" &amp; header8 &amp; _\n        vbCrLf &amp; data &amp; \" \" &amp; data1 &amp; \" \" &amp; data2 &amp; \" \" &amp; data3 &amp; \" \" &amp; data4 &amp; \" \" &amp; data5 &amp; \" \" &amp; data6 &amp; _\n        vbCrLf &amp; vbNewLine &amp; \"Regards\"\n\n        outlookmailitem.display\n        outlookmailitem.send\n\n        lastrow = lastrow + 1\n        edress = \"\"\n        x = x + 1\n\n    Loop\n\n    Set outlookapp = Nothing\n    Set outlookmailitem = Nothing\n\nEnd Sub\n</code></pre>\n"}]