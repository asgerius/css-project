[{"tags": ["excel", "vba", "selenium"], "comments": [{"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1564614429, "post_id": 57299737, "comment_id": 101093449, "body": "you&#39;re outside of the DOM at that point.  You could take a screenshot."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1564614712, "post_id": 57299737, "comment_id": 101093515, "body": "No I don&#39;t want to take screen shot. I know how to do that. All what I need is to download the image using Right-click and interact with the context menu.."}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 1, "creation_date": 1564615396, "post_id": 57299737, "comment_id": 101093645, "body": "What is the jsp page returning here?  Base-64 encoded image?  If so, it might be pretty easy to grab that."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1564615801, "post_id": 57299737, "comment_id": 101093717, "body": "@pcalkins I don&#39;t know exactly. How can I know what is returning ?? It is dynamic image .."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1564616058, "post_id": 57299737, "comment_id": 101093765, "body": "some thing similar to contextClick perform then sendkeys up/down and enter"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564617078, "post_id": 57299737, "comment_id": 101093976, "body": "@QHarr Can you show me how to do that ..?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1564641444, "post_id": 57299737, "comment_id": 101099125, "body": "Not at present as I have no selenium basic and get malicious software warnings from the download site (not sure if true but not sure I want to chance at present)."}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 1, "creation_date": 1564683653, "post_id": 57299737, "comment_id": 101121683, "body": "@YasserKhalil, use the browser&#39;s inspector.   It should have a list of resources/media if the object itself isn&#39;t inspectable with a right-click (does it show &quot;/resource.jsp&quot; when you do that?).  Btw, Selenium&#39;s &quot;sendKeys&quot; won&#39;t work here, it&#39;s outside the DOM.  VBA&#39;s sendKeys may work... though I&#39;m not familiar with that..."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1564686365, "post_id": 57299737, "comment_id": 101122903, "body": "Thanks a lot. I chose to take snapshot of the element itself and I think this is working well."}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 441, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564613170, "creation_date": 1564613170, "question_id": 57299737, "link": "https://stackoverflow.com/questions/57299737/right-click-on-image-save-image-as-in-selenium-vba", "title": "Right-click on image save image as in selenium VBA", "body": "<p>I am stuck at a point when trying to save an image to the hard drive using the selenium\nI need a way to right-click on the image and click \"Save image as\" from the context menu\nAll what I could do is to right-click on the image</p>\n\n<pre><code>.FindElementByXPath(\"//img[@src='/resource.jsp']\").ClickContext\n</code></pre>\n\n<p>How can I select Save Image As option for the image or even better to download the image to the hard drive directly\nThe problem is that I can't use the image URL to download it .. so I have no way except to use the Right-click menu ..\nAny ideas?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1564648271, "post_id": 57299655, "comment_id": 101102564, "body": "It sounds like the source query of the form is read-only."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1564654283, "post_id": 57299655, "comment_id": 101105847, "body": "<code>Me.cboCombo.Enabled = True</code> -- if your combo box is disabled before, it won&#39;t even receive the KeyDown. I think."}, {"owner": {"reputation": 41, "user_id": 11810218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aeTRx-CorFs/AAAAAAAAAAI/AAAAAAAABBU/NI1789Vfatk/photo.jpg?sz=128", "display_name": "TooOldForThis", "link": "https://stackoverflow.com/users/11810218/toooldforthis"}, "edited": false, "score": 0, "creation_date": 1567091402, "post_id": 57299655, "comment_id": 101868429, "body": "I have made some progress.  What can be done is break the recordset&#39;s active connection before assigning it to the form.  What is particularly frustrating is knowing that Microsoft can make what I am doing so much easier, instead they&#39;d rather drive the coder&#39;s crazy."}, {"owner": {"reputation": 41, "user_id": 11810218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aeTRx-CorFs/AAAAAAAAAAI/AAAAAAAABBU/NI1789Vfatk/photo.jpg?sz=128", "display_name": "TooOldForThis", "link": "https://stackoverflow.com/users/11810218/toooldforthis"}, "edited": false, "score": 0, "creation_date": 1567092598, "post_id": 57299655, "comment_id": 101869066, "body": "Dim cnn As ADODB.Connection    Dim rst As ADODB.Recordset    Set cnn = New ADODB.Connection    cnn.Open gconConnectOLEDB           Set rst = New ADODB.Recordset    With rst      Set .ActiveConnection = cnn          .Source = &quot;EXEC spGetCompanyInfo &quot; &amp; lngCompanyID          .LockType = adLockOptimistic          .CursorType = adOpenKeyset \t .CursorLocation = adUseClient          .Open    End With    Set rst.ActiveConnection = Nothing    Set Me.Recordset = rst     Me.txtName.ControlSource = &quot;Name&quot;    Me.txtAddress.ControlSource = &quot;Address&quot;"}], "owner": {"reputation": 41, "user_id": 11810218, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aeTRx-CorFs/AAAAAAAAAAI/AAAAAAAABBU/NI1789Vfatk/photo.jpg?sz=128", "display_name": "TooOldForThis", "link": "https://stackoverflow.com/users/11810218/toooldforthis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594635083, "creation_date": 1564612559, "last_edit_date": 1594635083, "question_id": 57299655, "link": "https://stackoverflow.com/questions/57299655/how-do-i-make-unbound-controls-writeable", "title": "How do I make unbound controls writeable?", "body": "<p>I have an MS Access 2013 database that I am porting all tables and queries to SQL Server.  After unbinding the controls on a form, I am unable to make them editable.</p>\n\n<p>The form I am working with has a combo box, and a text box that are loaded from ADODB recordsets populated with data returned from Stored procedures.\nI have tried to make the controls (Combo box, and text box) editable by changing the \"Locked\" and \"Enabled\" properties, and I have set the form's AllowEdits to True, but I am unable to change the selected text in the combo box or change text in the text box.   </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cboCombo_KeyDown(KeyCode As Integer, Shift As Integer)\n    Me.cboCombo.Locked = False\n    Me.cboCombo.Enabled = True\n    Select Case KeyCode\n    Case vbKeyTab, vbKeyPageUp, vbKeyPageDown, vbKeyEnd, vbKeyUp, vbKeyDown, vbKeyLeft, vbKeyRight, vbKeyHome, vbKeyExecute, vbKeyEscape\n    Case Else\n        DoCmd.CancelEvent\n    End Select\nEnd Sub\n</code></pre>\n\n<p>I want to be able to make a selection, but when the program is running, the status text repeatedly says the form is read only.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564610341, "post_id": 57299243, "comment_id": 101092553, "body": "So, you closed the workbook and the application itself still exists."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564610431, "post_id": 57299243, "comment_id": 101092574, "body": "What&#39;s the aim of this code?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564610536, "post_id": 57299243, "comment_id": 101092608, "body": "Last line try <code>Application.Quit</code>. I&#39;ve noticed behavior in a similar situation before as well. I believe it had something to do with other hidden &quot;workbooks&quot; being open, such as a personal macro workbook that can be seen in the VBE. I noticed this behavior was eliminated by looping all workbooks in the application object and ensuring they were closed, so there&#39;s another method you can try."}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1564610694, "post_id": 57299243, "comment_id": 101092654, "body": "Tim Williams, obviously is a extreme simplification"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1564610793, "post_id": 57299243, "comment_id": 101092684, "body": "K. Davis, I can&#39;t close the entire application, users would kill me :)"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564611157, "post_id": 57299243, "comment_id": 101092791, "body": "How do you open this Application? Hopefully not with a <code>Dim xlApp As New Excel.Application</code>. Instancing the variable within the declare statement can cause results similar to this, making it difficult to destroy the object."}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1564611235, "post_id": 57299243, "comment_id": 101092814, "body": "K Davis There are no other open workbooks, and the code is what you can see. Not one more line. Extremely simple. the WorkBook is opened as a normal workbook: &quot;File -&gt; Open.  Try to reproduce it. It&#39;s simple."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564611597, "post_id": 57299243, "comment_id": 101092886, "body": "Are you just wanting to not prompt the user to save changes?"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1564611734, "post_id": 57299243, "comment_id": 101092913, "body": "Exactly: it is a program that should not be saved, for technical reasons of my company. I know that the best solution would be Application.quit, but I can&#39;t do it, users can have several books open at once"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564612537, "post_id": 57299243, "comment_id": 101093094, "body": "Why not just mark the file as read-only?"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1564613303, "post_id": 57299243, "comment_id": 101093249, "body": "Tim Williams, sincerely thank you very much for your interest. K. Davis already answered me. I consider the thread closed. Again, thank you very much for your kindness."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1564610460, "post_id": 57299366, "comment_id": 101092581, "body": "Hi, thanks for your answer.  I already tried with a static not to happen twice, the result is the same.  The problem is that I can&#39;t spill the application, users would kill me :)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1564610352, "creation_date": 1564610352, "answer_id": 57299366, "question_id": 57299243, "link": "https://stackoverflow.com/questions/57299243/strange-behavior-when-closing-a-workbook-twice/57299366#57299366", "title": "Strange behavior when closing a workbook twice", "body": "<p>It's possible you're re-triggering the event.  Try something like this:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n     Static InProgress As Boolean\n\n     If InProgress Then Exit Sub\n\n     InProgress = True\n     ThisWorkbook.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 3, "last_activity_date": 1564611751, "creation_date": 1564611751, "answer_id": 57299554, "question_id": 57299243, "link": "https://stackoverflow.com/questions/57299243/strange-behavior-when-closing-a-workbook-twice/57299554#57299554", "title": "Strange behavior when closing a workbook twice", "body": "<p>If all you are trying to do is to not prompt the user to save changes, just play with the appropriate flags to 'trick' Excel that changes have already been saved.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Me.Saved = True\n\nEnd Sub\n</code></pre>\n\n<p>This will allow the workbook to close, without prompting any changes to be saved, but this does <em>not</em> actually save them.</p>\n\n<p>Notice the subtle difference between the words: <code>Me.Saved</code> and <code>Me.Save</code>. </p>\n\n<ul>\n<li><p><code>Saved</code> is a <strong>property</strong> that gets flipped to <code>False</code> when Excel detects changes were made as of the last save.</p></li>\n<li><p><code>Save</code> is a <strong>method</strong> - not a property as above - that actually will save the workbook.</p></li>\n</ul>\n\n<p>Your workbook <em>is already closing</em>, which is what fired this event to begin with. No need to try to close it again within this event. Just tell Excel that no changes have been made since the last save, and it should close all on it's own - without the prompts.</p>\n"}], "owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 57299554, "answer_count": 2, "score": 1, "last_activity_date": 1564611751, "creation_date": 1564609653, "question_id": 57299243, "link": "https://stackoverflow.com/questions/57299243/strange-behavior-when-closing-a-workbook-twice", "title": "Strange behavior when closing a workbook twice", "body": "<p>Strange issue when closing a workbook twice from VBA (Workbook_BeforeClose)</p>\n\n<p>Hi. This problem appears to me in an extremely simple workbook: Workbook_BeforeClose only.</p>\n\n<pre><code>Option Explicit\n     Private Sub Workbook_BeforeClose(Cancel As Boolean)\n     ThisWorkbook.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n\n<p>If I open and close the workbook twice, the main Excel screen looks like this, and it's impossible to do something, I can only close it from the status bar:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kHN6k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kHN6k.png\" alt=\"final status\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1564609450, "post_id": 57299191, "comment_id": 101092318, "body": "Do you mean <code>ClearContents</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564617671, "post_id": 57299191, "comment_id": 101094083, "body": "You can replace all 3 lines with <code>sh.Range(&quot;I20:J30&quot;).ClearContents</code>  No need for any selection"}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "is_accepted": false, "score": 0, "last_activity_date": 1564627830, "last_edit_date": 1564627830, "creation_date": 1564609877, "answer_id": 57299286, "question_id": 57299191, "link": "https://stackoverflow.com/questions/57299191/looping-through-sheets-to-delete-a-particular-range/57299286#57299286", "title": "looping through sheets to delete a particular range", "body": "<p>Your code works fine for me with a few minor adjustments:</p>\n\n<p>When you define a range (<code>sh.Range(\"I20 : J30\").Select</code> in your case) do not put spaces before and after the semicolon, instead use: <code>sh.Range(\"I20:J30\").Select</code></p>\n\n<p>Secondly, as braX noted, <code>\"ClearContents\"</code>.</p>\n\n<p>I hope this resolves your issue,\nCheers</p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 11709287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w2fV_JQhXF4/AAAAAAAAAAI/AAAAAAAAV_o/ByQFYQe94LU/photo.jpg?sz=128", "display_name": "Horst", "link": "https://stackoverflow.com/users/11709287/horst"}, "is_accepted": false, "score": 0, "last_activity_date": 1564643715, "creation_date": 1564643715, "answer_id": 57303630, "question_id": 57299191, "link": "https://stackoverflow.com/questions/57299191/looping-through-sheets-to-delete-a-particular-range/57303630#57303630", "title": "looping through sheets to delete a particular range", "body": "<p>...and while you're at it: there's no need to select anything.</p>\n\n<pre><code>For Each sh In ActiveWorkbook.Worksheets\n    sh.Range(\"I20:J30\").ClearContents\nNext sh\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 11860883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d066e43ee7ac0a67a4d17d509ea186c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/11860883/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1564643715, "creation_date": 1564609263, "last_edit_date": 1564627783, "question_id": 57299191, "link": "https://stackoverflow.com/questions/57299191/looping-through-sheets-to-delete-a-particular-range", "title": "looping through sheets to delete a particular range", "body": "<p>I am trying to loop through all my sheets to delete all content in I20 to I30\nand J20 to J30</p>\n\n<pre><code>Dim sh As Worksheet\n  For Each sh In ActiveWorkbook.Worksheets\n    sh.Select\n    sh.Range(\"I20 : J30\").Select\n    Selection.ClearContens\nNext sh\n</code></pre>\n\n<p>It returns method of selection error</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1564608758, "post_id": 57299072, "comment_id": 101092099, "body": "You can try replacing it with a single quote (<code>&#39;</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 11860228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecfb3d8120e4267137c66b1a9ea989d9?s=128&d=identicon&r=PG&f=1", "display_name": "Gurcan", "link": "https://stackoverflow.com/users/11860228/gurcan"}, "is_accepted": true, "score": 2, "last_activity_date": 1564609915, "creation_date": 1564609915, "answer_id": 57299290, "question_id": 57299072, "link": "https://stackoverflow.com/questions/57299072/show-number-without-exponential-expression-after-remove-non-numeric-character/57299290#57299290", "title": "Show number without exponential expression after remove non-numeric character", "body": "<p>Try this : (Change 'ActiveCell' to your needs) </p>\n\n<pre><code>ActiveCell.NumberFormat = \"0\"\n</code></pre>\n"}], "owner": {"reputation": 1730, "user_id": 5691558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/18305559850d1d9ce0aa697f3fa38a2c?s=128&d=identicon&r=PG&f=1", "display_name": "Ger Cas", "link": "https://stackoverflow.com/users/5691558/ger-cas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 57299290, "answer_count": 1, "score": 0, "last_activity_date": 1564627700, "creation_date": 1564608487, "last_edit_date": 1564627700, "question_id": 57299072, "link": "https://stackoverflow.com/questions/57299072/show-number-without-exponential-expression-after-remove-non-numeric-character", "title": "Show number without exponential expression after remove non-numeric character", "body": "<p>I have the following code to remove some \"garbage\" from cell contents.</p>\n\n<pre><code>Sub RemoveChar()\nWith Cells\n    Cells.NumberFormat = \"@\" ' setting format as text\n    Cells.Replace What:=\"#\", Replacement:=\"\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The sheet contains values like <code>#123451234512345</code> and when I remove the <code>#</code> the value changes to look like this <code>1.23451E+14</code> even when above I changed the format to text before the replacement.</p>\n\n<p>How can I remove the character <code>#</code> and after remove it say to Excel to show the value as <code>123451234512345</code> and not as <code>1.23451E+14</code>?</p>\n\n<p>Thank in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564608932, "post_id": 57299043, "comment_id": 101092152, "body": "Does your sheet name &quot;Standard List &quot; really have space at the end?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1564637122, "post_id": 57299043, "comment_id": 101097690, "body": "What you see on other computers is default - automatic change of all formulas in a Table column, but it can be disabled as described <a href=\"https://stackoverflow.com/a/40697914\">here</a>"}, {"owner": {"reputation": 11, "user_id": 11837884, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219192730305919/picture?type=large", "display_name": "Dayson Darby", "link": "https://stackoverflow.com/users/11837884/dayson-darby"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1564683635, "post_id": 57299043, "comment_id": 101121677, "body": "@BrakNicku That was exactly the problem and your solution worked fantastic. Is there anyway to give you props for that answer? I&#39;m new to StackOverFlow"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1564719335, "post_id": 57299043, "comment_id": 101130471, "body": "I just linked the solution. You can <i>give props</i> to the author of the linked answer by upvoting it, but to be able to do that, I think you need to have 15 reputation points first."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11837884, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219192730305919/picture?type=large", "display_name": "Dayson Darby", "link": "https://stackoverflow.com/users/11837884/dayson-darby"}, "edited": false, "score": 0, "creation_date": 1564684048, "post_id": 57299142, "comment_id": 101121883, "body": "I will try to be more explicit when setting formulas in the future but in this case, it didn&#39;t change anyways. Still is great advice though as I learn to code in VBA. BrakNicku&#39;s comment above fixed the problem I was having in this case"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1564608888, "creation_date": 1564608888, "answer_id": 57299142, "question_id": 57299043, "link": "https://stackoverflow.com/questions/57299043/table-listrows-add-works-properly-on-my-computer-but-none-of-the-other-computers/57299142#57299142", "title": "Table.ListRows.Add works properly on my computer but none of the other computers in our 20 computer chem lab", "body": "<p>Try being a little more explicit when setting the formulas:</p>\n\n<pre><code>With NewAnalyte.Range\n   .Cells(1).Formula = \"='Standard List '!\" + Cell.Offset(0, -1).Address\n   .Cells(2).Formula = \"='Standard List '!\" + Cell.Offset(0, 1).Address\n   .Cells(3).Formula = = \"='Standard List '!\" + Cell.Offset(0, 2).Address\n   'etc      \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11837884, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219192730305919/picture?type=large", "display_name": "Dayson Darby", "link": "https://stackoverflow.com/users/11837884/dayson-darby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564608888, "creation_date": 1564608268, "question_id": 57299043, "link": "https://stackoverflow.com/questions/57299043/table-listrows-add-works-properly-on-my-computer-but-none-of-the-other-computers", "title": "Table.ListRows.Add works properly on my computer but none of the other computers in our 20 computer chem lab", "body": "<p>Hopefully this makes sense. I created a macro that will read off information from a master sheet, create worksheets based off the name of an analyte, and then after the worksheet is created, it will transfer 8 cells of information from the master sheet to a table on the newly created analyte sheet. </p>\n\n<p>On my computer, when I run the my code using a step-into, when the line Set NewAnalyte = Table.ListRows.Add is run, a new line is created and the 6 rows of the table are already filled in with whatever information was found on the first row of the table, then that data gets overwritten as the With portion of the set statement gets run.</p>\n\n<p>On every other computer, when I run my code using a step-into, when the line Set NewAnalyte = Table.ListRows.Add is run, a new line is created and the 6 rows of the table are already filled in with whatever information was found on the first row of the table, then ALL data gets overwritten as the with portion of the set statement gets run. For instance, is there are 3 entries in my table, as the with statement is run for the 3rd entry, all entries on that row get overwritten at the same time.</p>\n\n<p>When running on my computer, all entries are different like they are supposed to be. On all other computers, all entries resemble the final entry to the table which is not supposed to happen. The excel file is stored in a network area and everyone accessed the same file. The file contains no external references(Activeworkbook only).</p>\n\n<p>Hoping that someone can help as I am beyond confused why this is happening.</p>\n\n<p>1) I have tried to make sure the excel version and windows version is identical to the one the code was created on(did not work)</p>\n\n<pre><code>For Each Cell In AnalyteName\n    If Cell.Interior.ColorIndex &lt;&gt; 35 Then\n        WorkSheetName = Cell.Value\n        For Each ws In wb.Worksheets\n            If WorkSheetName = ws.Name Then\n                Set Table = ws.ListObjects(WorkSheetName)\n                Set NewAnalyte = Table.ListRows.Add\n                    With NewAnalyte\n                        .Range(1) = \"='Standard List '!\" + Cell.Offset(0, -1).Address\n                        .Range(2) = \"='Standard List '!\" + Cell.Offset(0, 1).Address\n                        .Range(3) = \"='Standard List '!\" + Cell.Offset(0, 2).Address\n                        .Range(4) = \"='Standard List '!\" + Cell.Offset(0, 3).Address\n                        .Range(5) = \"='Standard List '!\" + Cell.Offset(0, 4).Address\n                        .Range(6) = \"='Standard List '!\" + Cell.Offset(0, 5).Address\n                    End With\n                Range(Cell.Offset(0, -2), Cell.Offset(0, 5)).Interior.ColorIndex = 35\n            End If\n        Next ws\n    End If\nNext Cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1564606416, "post_id": 57298633, "comment_id": 101091319, "body": "You need to add the values in your range to an Array, then compare from there. You&#39;re making multiple calls to the worksheet object slows things down, especially when you&#39;re writing to the worksheet multiple times like you are. So you&#39;d also want to place your new values in an array then write that array to the worksheet once instead of everytime your If statement returns true."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1564607264, "post_id": 57298633, "comment_id": 101091630, "body": "And I&#39;ve noticed your <code>.EnableEvents</code> and <code>.ScreenUpdating</code>. You forgot what is usually the most taxing of all, <code>.Calculation</code>. You are writing to the worksheet many many times within your loops. Every single write to the worksheet causes a recalc to occur, and your loop cannot progress until the calculation has finished . However, if your loop is dependent on the newly calculated values, this wouldn&#39;t be appropriate to change the property to manual - but that&#39;s likely the largest cause of your slow code. But again, using arrays as I&#39;ve mentioned above is the way to go."}], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1564621812, "creation_date": 1564621812, "answer_id": 57300640, "question_id": 57298633, "link": "https://stackoverflow.com/questions/57298633/how-to-optimize-for-each-loop-in-vba/57300640#57300640", "title": "how to optimize for each loop in vba", "body": "<p>Tried to modify the code, it takes only 0.04 Secs with two tables of around 500 rows.</p>\n\n<p>Tried to keep the replacement logic same as the original, But may please check the same, as i am little confused about the same. If find otherwise, please modify them to your need. Also Could not understand the what is <code>TBL</code> in cases with both the tables and assumed the obvious. </p>\n\n<pre><code>Option Explicit\nSub Input_Classification()\n    Dim WSSeg As Worksheet\n    Dim TBLClassification As ListObject\n    Dim TBLReference As ListObject\n    Dim rClassification As Range\n\n    Dim SrcArr As Variant, TrgArr As Variant, SrcCel As Variant\n    Dim i As Long, Tm As Double\n    Set WSSeg = ThisWorkbook.Sheets(\"Sheet1\")\n\n    Tm = Timer\n    Set TBLClassification = WSSeg.ListObjects(\"TBClass\")\n    Set rClassification = TBLClassification.ListColumns(3).DataBodyRange.Resize(TBLClassification.DataBodyRange.Rows.Count, 2)\n    TrgArr = rClassification.Value\n\n    Set TBLReference = WSSeg.ListObjects(\"TBResumo\")\n    SrcArr = TBLReference.ListColumns(4).DataBodyRange.Value\n\n    For i = 1 To UBound(TrgArr, 1)\n        For Each SrcCel In SrcArr\n            If TrgArr(i, 1) &lt;= SrcCel Then\n                TrgArr(i, 2) = SrcCel\n            End If\n        Next SrcCel\n    Next i\n\n\nrClassification.Value = TrgArr\nDebug.Print \"Seconds taken \" &amp; Timer - Tm\nEnd Sub\n</code></pre>\n\n<p>Since I personally don't prefer to keep calculations, event processing and screen updating off (in normal cases) i haven't added that standard lines. However you may use these standard techniques, depending on the working file condition.</p>\n"}], "owner": {"reputation": 35, "user_id": 11138011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd7c3fdec7dfc2a8743c4fb4063a7dc?s=128&d=identicon&r=PG&f=1", "display_name": "Rildo", "link": "https://stackoverflow.com/users/11138011/rildo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564627691, "creation_date": 1564606108, "last_edit_date": 1564627691, "question_id": 57298633, "link": "https://stackoverflow.com/questions/57298633/how-to-optimize-for-each-loop-in-vba", "title": "how to optimize for each loop in vba", "body": "<p>I need to classify each row of a range accordingly with another range. The script works just fine. But it takes too much time even if it has no more than 300 rows. E.g. 298 rows take more than 2 minutes.</p>\n\n<p>In order to achieve the classification, the script was built with a for each loop inside another one. All is done in the same worksheet called <code>WSSeg</code>. I tried to use all the good practices that I know of. </p>\n\n<pre><code>Option Explicit\nSub Input_Classification()\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Dim TBLClassification As ListObject\n    Dim TBLReference As ListObject\n\n    Dim rClassificationCell As Range\n    Dim rClassification As Range\n\n    Dim rReferenceCell As Range\n    Dim rReference As Range\n\n    Set TBLClassification = WSSeg.ListObjects(\"TBClass\")    \n    Set rClassification = TBL.ListColumns(4).DataBodyRange\n\n    Set TBLReference = WSSeg.ListObjects(\"TBResumo\")\n    Set rReference = TBL.ListColumns(4).DataBodyRange\n\n    For Each rClassificationCell In rClassification\n        For Each rReferenceCell In rReference\n            If rClassificationCell.Offset(0, -1).Value &lt;= rReferenceCell.Value Then\n                rClassificationCell.Value = rReferenceCell.Value\n            End If\n        Next rReferenceCell\n    Next rClassificationCell\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I expect the run time code to be shorter. I don't know if I have to use another logic system. Thanks in advance. </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1564605705, "post_id": 57298441, "comment_id": 101091061, "body": "That &quot;error&quot; is buried in the query &quot;MedWaiver LIST - Query&quot;."}, {"owner": {"reputation": 1, "user_id": 11865821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBpy7vn6oWw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re2OrJxfhb1NUuncdnRjznxRLT-aw/photo.jpg?sz=128", "display_name": "Gavin", "link": "https://stackoverflow.com/users/11865821/gavin"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1564605808, "post_id": 57298441, "comment_id": 101091106, "body": "No errors come up when i run that query"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1564606131, "post_id": 57298441, "comment_id": 101091230, "body": "Perhaps you need the full syntax: <code>DCount(&quot;*&quot;, &quot;[MedWaiver LIST - Query]&quot;)</code>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564606294, "post_id": 57298441, "comment_id": 101091282, "body": "I tested without the [ ] for query name and it works. Edit question to post entire SQL statement. Is that really the entire error message?"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 1, "creation_date": 1564607472, "post_id": 57298441, "comment_id": 101091713, "body": "Apparently you&#39;re using a parameter in your query. You&#39;ll have to add that parameter to your DCount."}], "owner": {"reputation": 1, "user_id": 11865821, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBpy7vn6oWw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re2OrJxfhb1NUuncdnRjznxRLT-aw/photo.jpg?sz=128", "display_name": "Gavin", "link": "https://stackoverflow.com/users/11865821/gavin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594550445, "creation_date": 1564605170, "last_edit_date": 1594550445, "question_id": 57298441, "link": "https://stackoverflow.com/questions/57298441/issue-with-code-connected-to-button-in-access-form-showing-runtime-error-2471", "title": "Issue with code connected to button in access form showing runtime error 2471", "body": "<p>when i click on a button that was set up in a form   i receive  this error </p>\n\n<blockquote>\n  <p>Run-time error '2471.: the expression you entered as a query parameter\n  produced this error:\"MW_client.CIRTS_Client_ID</p>\n</blockquote>\n\n<pre><code>'MedWaiver ALL Open Form button\nPrivate Sub Command_MW_All_Open_Form_Click()\n\n    ' clear old fields used by other buttons\n    globalClientLastName = \"\"\n    globalClientReferID = \"\"\n    globalClientCIRTSID = \"\"\n    globalClientSSN = \"\"\n    globalStartDate = Null\n    globalEndDate = Null\n\n    ' Clear the other Query Types\n    globalQueryMyOpenTriageClients = False\n    globalQueryMyOpenEligibilityClients = False\n    globalQueryStartEndDates = False\n    globalQueryClientLastName = False\n    globalQueryClientReferID = False\n    globalQueryClientCIRTSID = False\n    globalQueryClientSSN = False\n    globalQueryStaff = False\n    globalQueryAddClients = False\n    globalQueryCompleted = False\n    globalQueryDelete = False\n\n\n    ' set the query type to ALL Open Clients\n    globalQueryAllOpen = True\n\n    ' Check to see how many records match\n    If DCount(\"*\", \"MedWaiver LIST - Query\") &gt; 0 Then  - here is the issue \n    ' open the form for MedWaiver Clients\n        DoCmd.OpenForm \"MedWaiver Release FORM\"\n    Else\n        MsgBox \"No records matched your OPEN search\"\n    End If\n\n    ' open the form for MedWaiver Clients\n    ' DoCmd.OpenForm \"MedWaiver Release FORM\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564604112, "post_id": 57298039, "comment_id": 101090492, "body": "What does it do instead of work? If you get an error, <i>describe the error</i>. BTW you&#39;re reading <code>FormulaR1C1</code> but then setting that into <code>Formula</code>"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1564607486, "post_id": 57298039, "comment_id": 101091718, "body": "I&#39;d like to think that not surrounding your worksheet names in quotes is the problem.  Why pass through an intermediate value when you can just have <code>Range1.NumberFormat = Range2.NumberFormat</code>?  Your very long variable names might be hiding some solutions."}], "answers": [{"tags": [], "owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "is_accepted": false, "score": 0, "last_activity_date": 1564613693, "creation_date": 1564613693, "answer_id": 57299798, "question_id": 57298039, "link": "https://stackoverflow.com/questions/57298039/excel-vba-copy-range-cells-value-formula-format-without-clipboard/57299798#57299798", "title": "Excel VBA copy range cells value formula format without clipboard", "body": "<p>I'm going to assume that this is actually a sub and not just a scrap of code. Operating off of that assumption, your function would pass in the two worksheets names (sFormat, sHoldings), your source row (iSourceRow), start column (iStartColumn), end column (iEndColumn), destination row (iDestRow) and destination column (iDestCol) as parameters.  Set you source range (rSource) and destination range (rDest) and then work with them directly.  This makes your code FAR more readable and you can watch those ranges to make sure that you're using the correct ranges.  This way there's no intermediate variables to hold your values, formats and formulas.</p>\n\n<pre><code>Sub CopyStuff( _\n    sFormat As String, _\n    sHoldings As String, _\n    iSourceRow As Integer, _\n    iStartColumn As Integer, _\n    iEndColumn As Integer, _\n    iDestRow As Integer, _\n    iDestCol As Integer)\n\n    Dim rSource As Range, rDest As Range\n\n    rDest = Sheets(sHoldings).Range(Sheets(sHoldings).Cells(iDestRow, iDestCol), Sheets(sHoldings).Cells(iDestRow, iDestCol)).Offset(-5, 0)\n    rSource = Sheets(sFormat).Range(Sheets(sFormat).Cells(iSourceRow, iStartColumn), Sheets(sFormat).Cells(iSourceRow + 1, iEndColumn))\n\n    rDest.Value2 = rSource.Value2\n    rDest.NumberFormat = rSource.NumberFormat\n    rDest.Formula = rSource.Formula\n\n    shtHoldings.Select\nEnd Sub\n</code></pre>\n\n<p>Also, why not just use the clipboard??  Doing so would change your code to:</p>\n\n<pre><code>Sub CopyStuff( _\n        sFormat As String, _\n        sHoldings As String, _\n        iSourceRow As Integer, _\n        iStartColumn As Integer, _\n        iEndColumn As Integer, _\n        iDestRow As Integer, _\n        iDestCol As Integer)\n\n        Dim rSource As Range, rDest As Range\n\n        rDest = Sheets(sHoldings).Range(Sheets(sHoldings).Cells(iDestRow, iDestCol), Sheets(sHoldings).Cells(iDestRow, iDestCol)).Offset(-5, 0)\n        rSource = Sheets(sFormat).Range(Sheets(sFormat).Cells(iSourceRow, iStartColumn), Sheets(sFormat).Cells(iSourceRow + 1, iEndColumn))\n\n        rSource.Copy rDest\n\n        shtHoldings.Select\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 1290271, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WZXD4.png?s=128&g=1", "display_name": "Deep in Development", "link": "https://stackoverflow.com/users/1290271/deep-in-development"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564613693, "creation_date": 1564603106, "last_edit_date": 1564604415, "question_id": 57298039, "link": "https://stackoverflow.com/questions/57298039/excel-vba-copy-range-cells-value-formula-format-without-clipboard", "title": "Excel VBA copy range cells value formula format without clipboard", "body": "<p>I need copy cells(value,formula,format) from one sheet to another sheet without clipboard involved. The code below does not work. How can I fix it? I do appreciate your help.</p>\n\n<pre><code> Dim v_value As Variant    \n Dim v_formula As Variant    \n Dim v_format As Variant\n\n With Sheets(FORMATSSHEET)    \n      v_value = .Range(.Cells(iSourcePositionRow, iStartPositionColumn), .Cells(iSourcePositionRow + 1, iEndPositionColumn)).Value2    \n      v_format = .Range(.Cells(iSourcePositionRow, iStartPositionColumn), .Cells(iSourcePositionRow + 1, iEndPositionColumn)).NumberFormat    \n      v_formula = .Range(.Cells(iSourcePositionRow, iStartPositionColumn), .Cells(iSourcePositionRow + 1, iEndPositionColumn)).FormulaR1C1    \n End With\n\n With Sheets(HOLDINGSSHEET)\n     .Range(.Cells(iDestinationPositionRow, iDestinationPositionCol), .Cells(iDestinationPositionRow, iDestinationPositionCol)).Offset(-5, 0).Value2 = v_value\n     .Range(.Cells(iDestinationPositionRow, iDestinationPositionCol), .Cells(iDestinationPositionRow, iDestinationPositionCol)).Offset(-5, 0).NumberFormat = v_format\n     .Range(.Cells(iDestinationPositionRow, iDestinationPositionCol), .Cells(iDestinationPositionRow, iDestinationPositionCol)).Formula = v_formula\n\n End With\n\nSheets(HOLDINGSSHEET).Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1564603501, "post_id": 57297960, "comment_id": 101090259, "body": "You may be able to use SUBTOTAL()  - it can ignore hidden rows.  <a href=\"https://www.excelcampus.com/functions/subtotal-formula-explained/\" rel=\"nofollow noreferrer\">excelcampus.com/functions/subtotal-formula-explained</a>   You may need a loop to find the correct range to average over though."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1564606638, "post_id": 57297960, "comment_id": 101091392, "body": "@GMalc In trying to use what you had posted, changing N to offset will still select the hidden cell, just the number is smaller.  rows 1-10 exist and our UDF is in row 11, where rows 5 &amp; 6 are hidden; the count of visible rows is 8, so the offset would start (1-8=) -7 rows offset, aka starting at row (11-7 =) 4, resulting in averaging values in rows 4, 5, 6, 7, 8, 9, 10, &amp; 11 (resize to N more than start).  Did I miss something?"}], "owner": {"reputation": 11, "user_id": 11865863, "user_type": "registered", "profile_image": "https://graph.facebook.com/2639712796073542/picture?type=large", "display_name": "Tyler Ian Brimmer", "link": "https://stackoverflow.com/users/11865863/tyler-ian-brimmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564607050, "creation_date": 1564602619, "last_edit_date": 1564607050, "question_id": 57297960, "link": "https://stackoverflow.com/questions/57297960/function-how-to-create-a-range-from-filtered-cells-using-offset", "title": "Function: How to create a range from filtered cells using offset", "body": "<p>I am trying to finish my function where an average is take from values above the active cell. N is an input number for number of cells above active cell to be averaged. </p>\n\n<p>The issue I'm having is that this will take the average of N cells, hidden or visible, above the active cell. I want this function to set a range from only visible cells.</p>\n\n<p>I am attempting to incorporate \".SpecialCells(xlCellTypeVisible)\" but cannot get it to work. I am also avoiding subroutines. </p>\n\n<pre><code>Function MovingAVG_S2S(rng As Range, N As Integer) As Variant\n Dim rng2 As Range\n If rng &lt;&gt; 0 Then\n Set rng2 = rng.Offset(1 - N, 0).Resize(N, 1)\n MovingAVG_S2S = Application.WorksheetFunction.Average(rng2)\n Else\n MovingAVG_S2S = \"\"\n End If \n</code></pre>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>For reference, I am averaging a range of values from Column P, the cell containing the function will be in Column R.  </p>\n\n<p>I want to take the average of \"N\" values above the cell with the function.</p>\n\n<p>i.e., with an input of N = 90, and the function in cell R100, I want R to display an average of range P9:P99.</p>\n\n<pre><code>Function MovingAVG_S2S(ByVal top As Range, n As Long)\nDim sr As Long, sc As Long, er As Long, ec As Long\nsr = top.Row\nsc = top.Column\ner = ActiveCell.Row\nec = ActiveCell.Column\nMovingAVG_S2S = Application.Subtotal(101, Range(Cells(er - n, sc), Cells(er - 1, sc)))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1564601403, "post_id": 57297696, "comment_id": 101089474, "body": "To start things off, you need to show us the code you are using to attempt this. Please see how to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Thank you!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564619759, "post_id": 57297696, "comment_id": 101094440, "body": "&quot;0000&quot; is just the file extension - you can take any type of file and give it a &quot;.0000&quot; extension: what really matters is the underlying format of the file itself.  If your source files are plain-text then you need to figure out exactly how they&#39;re formatted and try to pick the appropriate selection from the existing list in Excel."}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1564606342, "creation_date": 1564606342, "answer_id": 57298684, "question_id": 57297696, "link": "https://stackoverflow.com/questions/57297696/saving-file-without-an-extension/57298684#57298684", "title": "Saving File without an extension", "body": "<p>Save the file as a txt file and close it. Then rename it in Windows Explorer.</p>\n\n<p>You can also do that with VBA. Use the NAME command to rename it to a file name with the desired extension.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/name-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/name-statement</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11041856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f084e575fe75e5ff3f70e501e50d62?s=128&d=identicon&r=PG&f=1", "display_name": "Al_M", "link": "https://stackoverflow.com/users/11041856/al-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "closed_date": 1564607178, "answer_count": 1, "score": -1, "last_activity_date": 1564627670, "creation_date": 1564601249, "last_edit_date": 1564627670, "question_id": 57297696, "link": "https://stackoverflow.com/questions/57297696/saving-file-without-an-extension", "closed_reason": "Not suitable for this site", "title": "Saving File without an extension", "body": "<p>We have a system that creates files that are imported into Oracle. The files have the naming convention...</p>\n\n<p>Filename.0000</p>\n\n<p>Where the numbers are incremented with each export. So one file might be filename.4357 and the next file will be filename.4358. </p>\n\n<p>I have managed to import the file into a spreadsheet as a comma delimited file where I then carry out some cleansing of the file. </p>\n\n<p>I then want to save the file back to this unusual type .0000 but I can only seem to save it as Excel, CSV, TXT, PDF etc. </p>\n\n<p>Does anyone have any ideas ? Thank you in advance. </p>\n\n<p>Nothing yet</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1564665275, "post_id": 57297471, "comment_id": 101112017, "body": "No need for activate (as it is about as bad as using .select) . The &#39;Documents.open&#39; should already return the document you opened. Likewise with the &#39;DropContainer&#39; Method, it returns the dropped shape directly, so no need to go looking for the shape on the page."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11644704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f03bac1ea8a654840a9134e01b39f9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Ziegler", "link": "https://stackoverflow.com/users/11644704/michael-ziegler"}, "edited": false, "score": 0, "creation_date": 1564766112, "post_id": 57311279, "comment_id": 101151812, "body": "Thank you. It works perfect and the explanations are clear. I&#39;m doing a lot of reading. Again Thanks"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 9, "user_id": 11644704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f03bac1ea8a654840a9134e01b39f9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Ziegler", "link": "https://stackoverflow.com/users/11644704/michael-ziegler"}, "edited": false, "score": 0, "creation_date": 1564770111, "post_id": 57311279, "comment_id": 101153264, "body": "@MichaelZiegler If this answer resolves your problem can you mark it as accepted?It makes it more likely that someone else will find the answer (and I get some imaginary internet points  ^^)."}], "tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": true, "score": 0, "last_activity_date": 1564669666, "creation_date": 1564669666, "answer_id": 57311279, "question_id": 57297471, "link": "https://stackoverflow.com/questions/57297471/how-to-get-a-container-header-id-to-a-variable-and-passed-to-vba-to-write-a-new/57311279#57311279", "title": "How to get a container header id to a variable and passed to vba to write a new header?", "body": "<p>First things first: your exact question was already answered her: <a href=\"http://visguy.com/vgforum/index.php?topic=6787.0\" rel=\"nofollow noreferrer\">http://visguy.com/vgforum/index.php?topic=6787.0</a></p>\n\n<p>I packaged the whole code into a function, calling the function will drop a classic container on the page you passed as argument and fill the caption with the passed caption argument. The return value is the dropped Container, bottom function shows how to use the function and add shapes to the container.</p>\n\n<pre><code>'@Folder(\"ExampleDropContainer\")\nOption Explicit\n\nPublic Function DropContainerWithCaption(pg As Visio.Page, caption As String) As Visio.Shape\n\n    Dim vsPg As Visio.Page\n    Set vsPg = pg\n\n    Dim vsStencilName As String\n    vsStencilName = Application.GetBuiltInStencilFile(visBuiltInStencilContainers, visMSUS)\n\n    Dim vsStencil As Visio.Document\n    Set vsStencil = Application.Documents.OpenEx(vsStencilName, visOpenHidden)\n\n    Dim vsMas As Visio.Master\n    Set vsMas = vsStencil.Masters.ItemU(\"Classic\")\n\n    'If you already had the shapes you want to have inside the continer you can replace \"Nothing\" with them.\n    Dim droppedContainer As Visio.Shape\n    'Set droppedContainer = vsPg.DropContainer(vsMas, Nothing)\n    'Using page.Drop circumvents some issues when a shape already occupies the space where the shape is to be dropped.\n    Set droppedContainer = vsPg.Drop(vsMas, 0, 0)\n\n    droppedContainer.Text = caption\n\n    Set DropContainerWithCaption = droppedContainer\n\nEnd Function\n\n\nSub TestExample()\n\n    Dim newContainer As Visio.Shape\n    Set newContainer = DropContainerWithCaption(ActivePage, \"Bananas\")\n\n    'Example on how to add a Shape to the container, someShape is a visio.shape object\n    'newContainer.ContainerProperties.AddMember someShape\n\nEnd Sub\n</code></pre>\n\n<p>You seem to have posted a lot of questions concerning the same or similar problems lately, most of which are quite basic once you get to know VBA. You should read up a bit, especially on the concept of return values of functions. Also be aware that most questions regarding programming in Visio are exactly the same in VBA for Excel, only the interaction with the document/workbook is sometime different. Many answers can be found when searching properly</p>\n\n<p>Some good links are:  </p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid Select</a>  Probably the most read article concerning VBA in Stackoverflow</p></li>\n<li><p><a href=\"https://excelmacromastery.com/vba-tutorial-1/\" rel=\"nofollow noreferrer\">ExcelMacroMastery</a>  Good Resource, a lot on the basics of programming in VBA</p></li>\n<li><p><a href=\"http://www.cpearson.com/Excel/MainPage.aspx\" rel=\"nofollow noreferrer\">Chip Pearson's Website</a> Lots of great and deep information</p></li>\n<li><p><a href=\"https://rubberduckvba.wordpress.com/2019/07/15/modern-vba-best-practices-default-members/\" rel=\"nofollow noreferrer\">RubberduckVBA Blog</a> Fantastic resource with many examples on how to bring VBA-Code up to modern standards. He's also active here on SO</p></li>\n</ul>\n\n<p>The first two links are a must-read IMHO, the other two are great if you want to dive deeper into VBA. </p>\n"}], "owner": {"reputation": 9, "user_id": 11644704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f03bac1ea8a654840a9134e01b39f9?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Ziegler", "link": "https://stackoverflow.com/users/11644704/michael-ziegler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 1, "accepted_answer_id": 57311279, "answer_count": 1, "score": 0, "last_activity_date": 1564669666, "creation_date": 1564600267, "question_id": 57297471, "link": "https://stackoverflow.com/questions/57297471/how-to-get-a-container-header-id-to-a-variable-and-passed-to-vba-to-write-a-new", "title": "How to get a container header id to a variable and passed to vba to write a new header?", "body": "<p>I have created this script to generate a container that I want to use it to generate containers It works fine but I also need to be able to give the containers a custom header. As you can see I tried to capture the shape id in a variable so I could use the variable to get the shape Id for the container. Nevertheless, I cannot get the shape id or assign one statically I also found out that the container has more than one shape ID. How do I Identify the ID for the header portion.  I also need to be able to drop shapes in the container. I followed Microsoft instructions and tried using  </p>\n\n<pre><code>vsoContainerShape.ContainerProperties.AddMember vsoShape, \nvisMemberAddExpandContainer\n</code></pre>\n\n<p>However that doesn\u2019t work. </p>\n\n<pre><code>Sub Add_Container()\n\n\n    Dim DiagramServices As Integer\n\n    DiagramServices = ActiveDocument.DiagramServicesEnabled\n\n    ActiveDocument.DiagramServicesEnabled = visServiceVersion140 + \nvisServiceVersion150\n\n    Dim visapp As Visio.Application\n\n    Dim vlan30 As Visio.Document\n\n    Dim node As Visio.Shape\n\n    Dim vlan30id As Integer\n\n\n\n\n\nApplication.Documents.OpenEx(Application.GetBuiltInStencilFile(visBuiltInStencilContainers, visMSUS), visOpenHidden)\n\n\nApplication.Windows.ItemEx(\"container.vsdm\").Activate 'need to activate\n\n\nApplication.ActiveWindow.Page.DropContainer vlan30.Masters.ItemU(\"Classic\"), Nothing  \n\n\nvlan30id = vlan30.ID\n\nDebug.Print vlan30id\n\nDim v30chars As Visio.Characters\nSet v30chars = Application.ActiveWindow.Page.Shapes.ItemFromID(vlan30id).Characters\nv30chars.Begin = 0\nv30chars.End = 7\nv30chars.Text = \"Vlan_30\"\n\nvlan30.Close\n\nActiveWindow.DeselectAll\n\n'Restore diagram services\n\nActiveDocument.DiagramServicesEnabled = DiagramServices\n\n\nEnd Sub\n</code></pre>\n\n<p>I need to be able to get the shape id for the heading of the containers and stored in a variable so I can use the variable for passing the argument in the ItemFromID. Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": false, "score": 0, "last_activity_date": 1564599360, "creation_date": 1564599360, "answer_id": 57297281, "question_id": 57297214, "link": "https://stackoverflow.com/questions/57297214/unable-to-use-proper-path-with-vba-savecopyas/57297281#57297281", "title": "Unable to use proper path with VBA SaveCopyAs", "body": "<p><code>Path</code> returns the folder the workbook is saved under. Sounds like you want:</p>\n\n<pre><code>ThisWorkbook.SaveCopyAs Filename:=ThisWorkbook.Path &amp; \"\\Rounds \" &amp; Month(Sheet4.Cells(1, 2)) &amp; \" - \" &amp; Year(Sheet4.Cells(1, 2))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 11865658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-S1R9nFBknkk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUEwCBPJE2Hwzs-hg3rdMWdaPDCA/photo.jpg?sz=128", "display_name": "user11865658", "link": "https://stackoverflow.com/users/11865658/user11865658"}, "edited": false, "score": 0, "creation_date": 1564607381, "post_id": 57297300, "comment_id": 101091673, "body": "@user11865658 <a href=\"https://stackoverflow.com/help/someone-answers\">You may consider marking the answer as accepted</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1564599428, "creation_date": 1564599428, "answer_id": 57297300, "question_id": 57297214, "link": "https://stackoverflow.com/questions/57297214/unable-to-use-proper-path-with-vba-savecopyas/57297300#57297300", "title": "Unable to use proper path with VBA SaveCopyAs", "body": "<p>If you run this:</p>\n\n<pre><code>Sub TestMe()\n    Debug.Print ThisWorkbook.Path\nEnd Sub\n</code></pre>\n\n<p>you would see something like: <code>C:\\Users\\Username\\Desktop</code> in the immediate window.\nThus, if you run your code like this: </p>\n\n<p><code>Debug.Print ThisWorkbook.Path &amp; \"Rounds \" &amp; Month(Sheet4.Cells(1, 2))</code></p>\n\n<p>You would most probably see something like this:</p>\n\n<p><code>C:\\Users\\Username\\DesktopRounds 12</code> and this is not what you need. There is obviously a <code>/</code> missing after the Desktop. Thus, put it there and try further:</p>\n\n<p><code>ThisWorkbook.SaveCopyAs Filename:=ThisWorkbook.Path &amp; \"\\Rounds \" &amp; Month(Sheet4.Cells(1, 2)) &amp; \" - \" &amp; Year(Sheet4.Cells(1, 2))</code></p>\n"}], "owner": {"reputation": 11, "user_id": 11865658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-S1R9nFBknkk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfUEwCBPJE2Hwzs-hg3rdMWdaPDCA/photo.jpg?sz=128", "display_name": "user11865658", "link": "https://stackoverflow.com/users/11865658/user11865658"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1564599428, "creation_date": 1564599076, "last_edit_date": 1564599113, "question_id": 57297214, "link": "https://stackoverflow.com/questions/57297214/unable-to-use-proper-path-with-vba-savecopyas", "title": "Unable to use proper path with VBA SaveCopyAs", "body": "<p>Unable to <code>SaveCopyAs</code> to proper path using vba:</p>\n\n<pre><code>ThisWorkbook.SaveCopyAs Filename:=ThisWorkbook.Path &amp; \"Rounds \" &amp; Month(Sheet4.Cells(1, 2)) &amp; \" - \" &amp; Year(Sheet4.Cells(1, 2))\n</code></pre>\n\n<p>The code is saving just short of the file path.  Folder is located on a folder on the desktop but the new file is being saved to the desktop.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1564597717, "post_id": 57296800, "comment_id": 101087892, "body": "Welcome to SO. Small tip just to warm you up: <code>ActiveSheet</code> does not have a property <code>Selection</code>. Both <code>ActiveSheet</code> and <code>Selection</code> are properties of <code>Application</code>, so they are at the same &quot;level&quot;. Try <code>Set rng = Selection</code>. The rest of the code seems to be on the good track (needs some small adjustments) so let me know if you need further help or you get stuck. I can see that you are already proceeding nicely and would be great if you could figure it out yourself. Good luck!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564604605, "post_id": 57296800, "comment_id": 101090665, "body": "If you get errors when running your code, it&#39;s most useful to note on which line you see the error - otherwise we&#39;re just guessing."}, {"owner": {"reputation": 11, "user_id": 11865497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150756815b488813b9e381d0136204c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahb23", "link": "https://stackoverflow.com/users/11865497/ahb23"}, "edited": false, "score": 0, "creation_date": 1564606546, "post_id": 57296800, "comment_id": 101091361, "body": "Unfortunately I&#39;m not getting any line specific errors, just an error message and a graph output that isn&#39;t what I am looking for"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1564624452, "post_id": 57296800, "comment_id": 101095275, "body": "hope  @Justyna MK comment solved your problem. if not, sometimes <code>Chrt.Chart.HasTitle = True</code> and   <code>Chrt.Chart.ChartTitle.Text = &quot;Some thing&quot;</code> may help.Also depending on excel version may try with <code>FullSeriesCollection</code> instead of  <code>SeriesCollection</code>.Otherwise  I concur fully with Justyna MK that you are already proceeding nicely."}, {"owner": {"reputation": 11, "user_id": 11865497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150756815b488813b9e381d0136204c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahb23", "link": "https://stackoverflow.com/users/11865497/ahb23"}, "edited": false, "score": 0, "creation_date": 1564673108, "post_id": 57296800, "comment_id": 101116821, "body": "yes, it was helpful, and now it produces a basic graph. However, I am now getting an &quot;object required&quot; error whenever I try any formatting. I am clearly misunderstanding something with my initial declarations, and would love to know what that might be. Thanks for all the help!"}], "owner": {"reputation": 11, "user_id": 11865497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150756815b488813b9e381d0136204c8?s=128&d=identicon&r=PG&f=1", "display_name": "ahb23", "link": "https://stackoverflow.com/users/11865497/ahb23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564597189, "creation_date": 1564597189, "question_id": 57296800, "link": "https://stackoverflow.com/questions/57296800/creating-graphs-with-specific-formatting-from-user-highlighted-cells", "title": "Creating graphs with specific formatting from user highlighted cells", "body": "<p>I am attempting to create a macro that can be used on a variety of data sets that will create graphs with standardized, specific formatting. I haven't actually changed the formatting specifics yet because I am trying to get the general code to run first.</p>\n\n<p>I am new to VBA, and am somewhat confused. I know that some of my logic may be incorrect as I switch from the chrt variable to the cht variable, but can't tell why even the basic portion doesn't work. I have tried different variable declarations to no avail.</p>\n\n<pre><code>Sub fullPageLine()\n\nDim rng As Range\nDim chrt As Object\nDim cht As Chart\n\n'Your data range for the chart\n  Set rng = ActiveSheet.Selection\n\n'Create a chart\n  Set chrt = ActiveSheet.ChartObjects.Add( _\n    Left:=ActiveCell.Left, _\n    Width:=450, _\n    Top:=ActiveCell.Top, _\n    Height:=250)\n\n'Give chart some data\n  chrt.Chart.SetSourceData Source:=rng\n\n'Determine the chart type\n  chrt.Chart.ChartType = xlLine\n\n    'Reposition Title\n        With chrt.Chart.ChartTitle\n          .Left = 100\n          .Top = 50\n           End With\n\n            Set cht = chrt\n\n            'Format Font Size\n                cht.ChartArea.Format.TextFrame2.TextRange.Font.Size = 7\n                cht.ChartTitle.Format.TextFrame2.TextRange.Font.Size = 8.4\n\n            'Format Font Type\n                cht.ChartArea.Format.TextFrame2.TextRange.Font.Name = \"Arial\"\n                cht.ChartTitle.Format.TextFrame2.TextRange.Font.Name = \"Arial\"\n\n\n            'Change chart series fill color\n                cht.SeriesCollection(1).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n                cht.SeriesCollection(2).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n                cht.SeriesCollection(3).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n                cht.SeriesCollection(4).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n                cht.SeriesCollection(5).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n                cht.SeriesCollection(6).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n                cht.SeriesCollection(7).Format.Fill.ForeColor.RGB = RGB(91, 155, 213)\n\nEnd Sub\n</code></pre>\n\n<p>When attempting to create the graph, I get an error message saying \"object doesn't support this property or method\". This issue persists even after I have commented out everything beyond the chart type, so the initial code to create the chart won't even work.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 191, "user_id": 10609408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05205d061d53c93f7dc53cfec02ec877?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10609408/tom"}, "edited": false, "score": 1, "creation_date": 1564598375, "post_id": 57296769, "comment_id": 101088179, "body": "I would like to make sure I understand your question. So when this button is clicked, if it&#39;s a NEW date, then it will add the current date to the next row and start a new counter. If the current date matches the most recent one on the list when the button is pressed, then it will simply add +1 to the count for that day."}, {"owner": {"reputation": 808, "user_id": 4463825, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/1d305404404727e4c1dc80b8e020547a?s=128&d=identicon&r=PG&f=1", "display_name": "Jesh Kundem", "link": "https://stackoverflow.com/users/4463825/jesh-kundem"}, "reply_to_user": {"reputation": 191, "user_id": 10609408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05205d061d53c93f7dc53cfec02ec877?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10609408/tom"}, "edited": false, "score": 0, "creation_date": 1564601279, "post_id": 57296769, "comment_id": 101089414, "body": "Tom - You got it right. Just one thing - the next row, should be at the end of the column (to make sure we are on the same page)"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 11682371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6aef3eb1f706c18fff41556dcdbbc31?s=128&d=identicon&r=PG&f=1", "display_name": "dasche", "link": "https://stackoverflow.com/users/11682371/dasche"}, "is_accepted": false, "score": 0, "last_activity_date": 1564600439, "creation_date": 1564600439, "answer_id": 57297513, "question_id": 57296769, "link": "https://stackoverflow.com/questions/57296769/button-that-appends-data-to-a-sheet/57297513#57297513", "title": "Button that appends data to a sheet", "body": "<p>If I understand what you are asking here's my attempt at it.</p>\n\n<pre><code>Sub stuff()\n    Dim dateCol As Range\n    Dim countCol As Range\n\n    Set dateCol = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A:A\") ' Change to proper sheet\n    Set countCol = ThisWorkbook.Worksheets(\"Sheet2\").Range(\"B:B\") ' Change to proper sheet\n\n    Dim foundDate As Range\n    Dim searchDate As String\n    searchDate = Format(Now(), \"m/dd/yyyy\")\n    Set foundDate = dateCol.Find(what:=searchDate, lookat:=xlWhole)\n\n    If Not foundDate Is Nothing Then\n        foundDate.Offset(0, 1).Value = foundDate.Offset(0, 1).Value + 1\n    Else\n        Dim newEntry As Range\n        If dateCol.Cells(1, 1).Value &lt;&gt; \"\" Then\n            Set newEntry = dateCol.Cells(dateCol.Cells.Count, 1).End(xlUp).Offset(1, 0)\n        Else\n            Set newEntry = dateCol.Cells(1, 1)\n        End If\n        newEntry.Value = searchDate\n        newEntry.Offset(0, 1).Value = 1\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 10609408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05205d061d53c93f7dc53cfec02ec877?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/10609408/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1564895464, "last_edit_date": 1564895464, "creation_date": 1564600765, "answer_id": 57297587, "question_id": 57296769, "link": "https://stackoverflow.com/questions/57296769/button-that-appends-data-to-a-sheet/57297587#57297587", "title": "Button that appends data to a sheet", "body": "<p>So to start, we're going to have to have our program figure out what cell contains the most recent date that is in our list. Once we get that cell, we can compare it's value to the current date in order to determine if we need to add +1 to that day or start a new row.</p>\n\n<p>I have provided an example subroutine below and you will have to replace the contents inside of the square brackets to match your sheet that you're working in. </p>\n\n<pre><code>Sub buttonPressed()\n    Dim lastRow, dateColumn As Long\n    Dim lastDate As Date\n    Dim clickCtr As Long\n\n    With Sheets([sheetName])\n        'Set the column containing dates.\n        dateColumn = [column number where dates are stored]\n\n        'Get the last row containing a date and save it into lastRow\n        lastRow = .Cells(.Rows.Count, dateColumn).End(xlUp).row\n\n        'Convert value of lastRow into a date\n        lastDate = DateValue(.Cells(lastRow, dateColumn).Value)\n\n        'Compare last date to current date\n        If (lastDate = Date) Then\n            'Get the current button press count and add 1 to it\n            clickCtr = .Cells(lastRow, dateColumn + 1).Value + 1\n            'Replace contents of cell with new click amount\n            .Cells(lastRow, dateColumn + 1).Value = clickCtr\n        Else\n            'Add the new date to the next row\n            .Cells(lastRow + 1, dateColumn).Value = Date\n            'Start the counter next to the new date\n            .Cells(lastRow + 1, dateColumn + 1).Value = 1\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 808, "user_id": 4463825, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/1d305404404727e4c1dc80b8e020547a?s=128&d=identicon&r=PG&f=1", "display_name": "Jesh Kundem", "link": "https://stackoverflow.com/users/4463825/jesh-kundem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57297587, "answer_count": 2, "score": -2, "last_activity_date": 1564895464, "creation_date": 1564597036, "last_edit_date": 1564600526, "question_id": 57296769, "link": "https://stackoverflow.com/questions/57296769/button-that-appends-data-to-a-sheet", "title": "Button that appends data to a sheet", "body": "<p>I am looking to create an excel workbook, where I will have a button(s) - when clicked on it, it should write the date, number of times it clicked on that day. </p>\n\n<p>I am able to write the date, based on a macro, however I am struggling in two scenarios. Presently I am only able to update the date in the same cell. \n 1. I would like to append it, in the row below, rather erase the same cell and update it. \n 2. The number of times the user clicked on the day (should be on the column next to it), should be updated dynamically, and should match the date column next to it. </p>\n\n<p>Any thoughts on the logic, would be helpful. </p>\n\n<p>This is the result, I am looking to get, this is two columns. </p>\n\n<pre><code>7/29/19     5\n7/30/19     9\n7/31/19     12\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1564597172, "post_id": 57296688, "comment_id": 101087653, "body": "I think you left out the <code>Payment</code> calculation"}], "answers": [{"tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1564597538, "creation_date": 1564597538, "answer_id": 57296872, "question_id": 57296688, "link": "https://stackoverflow.com/questions/57296688/pmt-error-wrong-number-of-arguments-or-invalid-property-assignment/57296872#57296872", "title": "PMT error: wrong number of arguments or invalid property assignment", "body": "<p>Hi it seems you never ended your <code>If</code> statement with <code>End If</code>. It wasn't 100% clear where the end if belonged but I put it where I figured you wanted it. </p>\n\n<p>Also your <code>Dim</code> statement is declaring your variables as <code>Variant</code> types, so you may also want to declare these accordingly since it may be causing your error as well.</p>\n\n<p>Good coding practice is would indent as well. I did some basics below, it makes it easier to read, follow and maintain, but it won't solve your issues.</p>\n\n<p>Try the below</p>\n\n<pre><code>Dim FVal, PVal, APR, TotPmts, Payment\n\nFVal = 0    ' Usually 0 for a loan.\nPVal = Val(Txt_Loan_Amount)\nAPR = Val(Txt_Interest_Rate)\n\nIf APR &gt; 1 Then \n    APR = APR / 100    ' Ensure proper form.\nEnd If 'Please note I put this where I thought it belonged, you may need to move this.\nTotPmts = Val(Txt_Amortized) * 12\n\nMsgBox \"Your payment will be \" &amp; Format(Payment) &amp; \" per month.\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "edited": false, "score": 0, "creation_date": 1564604958, "post_id": 57298224, "comment_id": 101090787, "body": "Thank you for the assistance! You solution worked perfectly!"}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1564604105, "creation_date": 1564604105, "answer_id": 57298224, "question_id": 57296688, "link": "https://stackoverflow.com/questions/57296688/pmt-error-wrong-number-of-arguments-or-invalid-property-assignment/57298224#57298224", "title": "PMT error: wrong number of arguments or invalid property assignment", "body": "<p>You can have 1 line IF/Then statements.  As stated, all your variables are <code>Variant</code>.  If you enter the <code>WorksheetFunction.Pmt</code> command, it will tell you what your variables should be, i.e. Arg1 as Double, Arg2 as Double.  Your variables should match.  You can test your inputs on your user form to ensure they are compliant.  After you determine that your APR is > or &lt; 1, you will want to convert to a monthly rate as you are converting your time periods to monthly.  In formatting the <code>Payment</code>, I put a minus sign in front to display as a positive number.</p>\n\n<pre><code>Dim PVal As Double\nDim APR As Double\nDim TotPmts As Double\nDim Payment As Double\n\nPVal = Val(Txt_Loan_Amount) 'Based on input\nAPR = Val(Txt_Interest_Rate) 'Based on input\nIf APR &gt; 1 Then APR = APR / 100    ' Ensure proper form.\nAPR = APR / 12 'Convert to monthly\nTotPmts = Val(Txt_Amortized) * 12 'Using monthly\nPayment = WorksheetFunction.Pmt(APR, TotPmts, PVal)\n\nMsgBox \"Your payment will be \" &amp; Format(-Payment, \"$#,##0.00\") &amp; \" per month.\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9969556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea01a120f70769b881010175c5c6643?s=128&d=identicon&r=PG&f=1", "display_name": "Slayerxx128", "link": "https://stackoverflow.com/users/9969556/slayerxx128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 57298224, "answer_count": 2, "score": 0, "last_activity_date": 1564627658, "creation_date": 1564596600, "last_edit_date": 1564627658, "question_id": 57296688, "link": "https://stackoverflow.com/questions/57296688/pmt-error-wrong-number-of-arguments-or-invalid-property-assignment", "title": "PMT error: wrong number of arguments or invalid property assignment", "body": "<p>I am using a user Form to input data for a model. I want to calculate the monthly payments needed for a loan using the PMT function in VBA. I need this so I can then take the value and add it to the total monthly expenses. I have provided a screen shot of the current code I have written. each time I run the macro I get \"wrong number of arguments or invalid property assignment\" I have tried a few different ways to calculate this, but I would really like the payment inputs to come from the user form since I will have many different inputs.</p>\n\n<p>Just to clarify the \"Val(txt_Loan-Amount)\" are the reference to the user form I have already created and named each input box with the names to pull the data from.</p>\n\n<p>I have tried this by manually added the number in and it does calculate the payment. I'm assuming the error is coming from the user form values</p>\n\n<pre><code>Dim FVal, PVal, APR, TotPmts, Payment\nFVal = 0    ' Usually 0 for a loan.\nPVal = Val(Txt_Loan_Amount)\nAPR = Val(Txt_Interest_Rate)\nIf APR &gt; 1 Then APR = APR / 100    ' Ensure proper form.\nTotPmts = Val(Txt_Amortized) * 12\nMsgBox \"Your payment will be \" &amp; Format(Payment) &amp; \" per month.\"\n</code></pre>\n\n<p>Like I mentioned above the error I am receiving is \"wrong number of arguments or invalid property assignment\" I am not sure why this is happening</p>\n"}, {"tags": ["vba", "sum", "offset"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11865504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4595fd7fc496bf9452523e40ad1d6d65?s=128&d=identicon&r=PG&f=1", "display_name": "Shehroz Malik", "link": "https://stackoverflow.com/users/11865504/shehroz-malik"}, "edited": false, "score": 1, "creation_date": 1564597731, "post_id": 57296803, "comment_id": 101087901, "body": "This worked, I was trying to do this for 2 hours.   Thank you a ton!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1564597204, "creation_date": 1564597204, "answer_id": 57296803, "question_id": 57296674, "link": "https://stackoverflow.com/questions/57296674/how-to-sum-a-range-that-i-offset/57296803#57296803", "title": "How to Sum a Range that I Offset?", "body": "<p>Not sure I follow what you're doing. Does this help?</p>\n\n<pre><code>Range(\"b8\").End(xlToRight).Offset(0, 1).Value = _\n                             WorksheetFunction.Sum(Range(\"A4\").End(xlToRight).Resize(4))\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11865504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4595fd7fc496bf9452523e40ad1d6d65?s=128&d=identicon&r=PG&f=1", "display_name": "Shehroz Malik", "link": "https://stackoverflow.com/users/11865504/shehroz-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 57296803, "answer_count": 1, "score": 0, "last_activity_date": 1564597204, "creation_date": 1564596549, "question_id": 57296674, "link": "https://stackoverflow.com/questions/57296674/how-to-sum-a-range-that-i-offset", "title": "How to Sum a Range that I Offset?", "body": "<p>I have some code that populates data on the next empty column. I do this by using the (x1ToEnd) feature. </p>\n\n<p>However, I am trying to do the same feature with a sum of a range of multiple cells (the ones I want to sum) within my WorksheetFunction.SUM function but the whole range is not working, only the very first cell populates. </p>\n\n<p>Check out my code</p>\n\n<pre><code>range(\"b8\").End(xlToRight).Offset(0, 1).Value = \nWorksheetFunction.Sum(Range(\"A4:A7\").End(xlToRight).Value)\n</code></pre>\n"}, {"tags": ["excel", "vba", "hex", "byte"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1564600210, "post_id": 57296658, "comment_id": 101088959, "body": "Please clarify what you want.  You write <i>... concert them to decimal</i> but no where in your code are you doing that.  And you write <i>\u2026 I am trying to convert bytes 7 to 10, to look like this: <code>00001F07</code></i>  but  <code>00001F07</code> is not a decimal number.  And your <code>Join</code> function is using a space as a delimiter, but the value you show as a result does not include any spaces!  Also, it is not clear what value you are passing to your function (what is <code>measShoot</code>?) to let it know you only want bytes 7-10."}, {"owner": {"reputation": 71, "user_id": 11463478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb0746957c3a653a9753c828b4d1910?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/11463478/adam"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1564602200, "post_id": 57296658, "comment_id": 101089805, "body": "To be technically correct, &quot;Hex&quot; converts the hex number to decimals, which are then printed as strings. Updated question slightly to clarify, but I already figured it out by myself. Thanks for the help."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1564605221, "post_id": 57296658, "comment_id": 101090876, "body": "Here <code>Hex</code> converts a decimal number to Hex.  As you can see where <code>Hex(12) --&gt; C</code>.  To convert <code>AA 00 00 22 00 03 00 00 1F 07 00 BC 07</code> to <code>00001F07</code> can be done without VBA using just string functions."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 11463478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb0746957c3a653a9753c828b4d1910?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/11463478/adam"}, "is_accepted": true, "score": 1, "last_activity_date": 1564602231, "last_edit_date": 1564602231, "creation_date": 1564601865, "answer_id": 57297824, "question_id": 57296658, "link": "https://stackoverflow.com/questions/57296658/combining-hex-bytes-into-a-string-in-vba-without-losing-the-leading-zero/57297824#57297824", "title": "Combining hex bytes into a string in VBA, without losing the leading Zero?", "body": "<p>After some more research, the solution was to add some code as follows:</p>\n\n<pre><code>Dim i As Long\n    For i = LBound(measHex) + 6 To LBound(measHex) + 9\n        bytes(i) = Hex(measHex(i))\n\n        Dim l As Integer \n\n        l = 2\n\n        h(i) = Replace(Space(l - Len(Hex(measHex(i)))), \" \", \"0\") &amp; Hex(measHex(i))\n\n    Next\n    ToHexStringMeas = Strings.Join(h, \"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1564606717, "creation_date": 1564606717, "answer_id": 57298755, "question_id": 57296658, "link": "https://stackoverflow.com/questions/57296658/combining-hex-bytes-into-a-string-in-vba-without-losing-the-leading-zero/57298755#57298755", "title": "Combining hex bytes into a string in VBA, without losing the leading Zero?", "body": "<p>You can also accomplish what I think is your goal using string functions.</p>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>Function ToHexStringShoot(ByRef measHex As String, Optional first As Long = 7, Optional last As Long = 10) As String\n    ToHexStringShoot = Replace(Mid(measHex, (first - 1) * 3, last * 3 - (first - 1) * 3), \" \", \"\")\nEnd Function\n</code></pre>\n\n<p><strong>Worksheet Formula</strong> <em>using the same logic</em></p>\n\n<pre><code>=SUBSTITUTE(MID(A1,6*3,10*3-6*3),\" \",\"\")\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11463478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb0746957c3a653a9753c828b4d1910?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/11463478/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 57297824, "answer_count": 2, "score": 0, "last_activity_date": 1564606717, "creation_date": 1564596474, "last_edit_date": 1564602059, "question_id": 57296658, "link": "https://stackoverflow.com/questions/57296658/combining-hex-bytes-into-a-string-in-vba-without-losing-the-leading-zero", "title": "Combining hex bytes into a string in VBA, without losing the leading Zero?", "body": "<p>In VBA, I am trying to select 4 bytes out of a hex array, and convert them to decimal. However, if the byte is smaller than F, the first digit, which is 0, is lost in the compilation of the  string, and the conversion is thus wrong.</p>\n\n<p>I have tried various solution on this forum, without success.</p>\n\n<p>The string I need to convert looks like this variable (called measHex):\n    AA 00 00 22 00 03 00 00 1F 07 00 BC 07</p>\n\n<p>I am trying to convert bytes 7 to 10, to look like this:\n    00001F07</p>\n\n<p>but what I get is 1F7</p>\n\n<p>The following code is my function.</p>\n\n<pre><code>Private Function ToHexStringMeas(ByRef measHex As Variant) As String\n    ReDim bytes(LBound(measHex) + 6 To LBound(measHex) + 9)\n    Dim i As Long\n    For i = LBound(measHex) + 6 To LBound(measHex) + 9\n        bytes(i) = Hex(measHex(i))\n    Next\n    ToHexStringMeas = Strings.Join(bytes, \"\")\nEnd Function \n</code></pre>\n\n<p>Any help would be highly appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11865396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876e0d16a88997f3fba226201d72a4?s=128&d=identicon&r=PG&f=1", "display_name": "mfgriggs", "link": "https://stackoverflow.com/users/11865396/mfgriggs"}, "edited": false, "score": 0, "creation_date": 1564688022, "post_id": 57298612, "comment_id": 101123530, "body": "I was hoping to avoid links.  There will be about 60 tables and I would like to avoid the clutter."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 23, "user_id": 11865396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876e0d16a88997f3fba226201d72a4?s=128&d=identicon&r=PG&f=1", "display_name": "mfgriggs", "link": "https://stackoverflow.com/users/11865396/mfgriggs"}, "edited": false, "score": 0, "creation_date": 1564689838, "post_id": 57298612, "comment_id": 101124205, "body": "You mentioned 2, not 60, so how could we know? But link them as you need them, and delete the links when done. Fast and easy and no &quot;clutter&quot;."}, {"owner": {"reputation": 23, "user_id": 11865396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876e0d16a88997f3fba226201d72a4?s=128&d=identicon&r=PG&f=1", "display_name": "mfgriggs", "link": "https://stackoverflow.com/users/11865396/mfgriggs"}, "edited": false, "score": 0, "creation_date": 1565016024, "post_id": 57298612, "comment_id": 101208636, "body": "Is it possible to use DMAX?"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1564606016, "creation_date": 1564606016, "answer_id": 57298612, "question_id": 57296561, "link": "https://stackoverflow.com/questions/57296561/how-can-i-use-the-max-function-to-retrieve-the-max-date-of-field-in-a-table-in-a/57298612#57298612", "title": "How can I use the MAX function to retrieve the max date of field in a table in another database?", "body": "<p>Create a <em>link</em> to each of the tables in the two databases. Then it will be:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Date1 = DMax(\"[RunDate]\", \"NameOfLinkedTable1\")\nDate2 = DMax(\"[RunDate]\", \"NameOfLinkedTable2\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11865396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876e0d16a88997f3fba226201d72a4?s=128&d=identicon&r=PG&f=1", "display_name": "mfgriggs", "link": "https://stackoverflow.com/users/11865396/mfgriggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594550465, "creation_date": 1564596038, "last_edit_date": 1594550465, "question_id": 57296561, "link": "https://stackoverflow.com/questions/57296561/how-can-i-use-the-max-function-to-retrieve-the-max-date-of-field-in-a-table-in-a", "title": "How can I use the MAX function to retrieve the max date of field in a table in another database?", "body": "<p>I am using a database (DB1) and would like to use the DMAX function to extract the maximum date of a field called \"RunDate\" in a table (tbl1) located in another database (DB2).</p>\n\n<p>This is for a project that I am working on that compares the dates in two different databases.  I am using SAS to ftp several text files from a mainframe into an access database (DB1).  I wish to compare the dates of the tables in DB1 to the corresponding tables in another database (DB2).  If the RunDates in DB1 are greater than those in DB2, I would like to append DB1 data to the corresponding tables in DB2 .</p>\n\n<pre><code>Date1= DMAX(\"[RunDate]\",\"C:\\path\\to\\.mdb file\")\nDate2= DMAX(\"[RunDate]\",\"E:\\path\\to\\.mdb file\")\n</code></pre>\n\n<p>If Date1 > Date2 Then I would like to append tables.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564596983, "post_id": 57296459, "comment_id": 101087574, "body": "Have you step debugged? I tested your code and do not get the error. Edit question to post rest of procedure (opening recordset) and sample data."}, {"owner": {"reputation": 123, "user_id": 9170374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4232196d1266adcdb920917739d2d403?s=128&d=identicon&r=PG&f=1", "display_name": "Russtopher", "link": "https://stackoverflow.com/users/9170374/russtopher"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564597080, "post_id": 57296459, "comment_id": 101087621, "body": "I have step debugged and once it gets to the second record, it throws the error. It\u2019s just a simple recordset."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564597758, "post_id": 57296459, "comment_id": 101087915, "body": "I cannot replicate error. However, suggest you move the Debug.Print to outside the recordset loop. If you don&#39;t want to provide info as requested, cannot help further."}, {"owner": {"reputation": 123, "user_id": 9170374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4232196d1266adcdb920917739d2d403?s=128&d=identicon&r=PG&f=1", "display_name": "Russtopher", "link": "https://stackoverflow.com/users/9170374/russtopher"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564597845, "post_id": 57296459, "comment_id": 101087959, "body": "I\u2019ll run some more tests and get back to you."}, {"owner": {"reputation": 123, "user_id": 9170374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4232196d1266adcdb920917739d2d403?s=128&d=identicon&r=PG&f=1", "display_name": "Russtopher", "link": "https://stackoverflow.com/users/9170374/russtopher"}, "edited": false, "score": 0, "creation_date": 1564600254, "post_id": 57296459, "comment_id": 101088975, "body": "It errors on strData = strData &amp; recSet.Fields(intCtr) &amp; Space(25 - Len(Nz(recSet.Fields(intCtr))))  and the value is 1"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564600658, "post_id": 57296459, "comment_id": 101089160, "body": "Still cannot replicate error and therefore do not have solution."}, {"owner": {"reputation": 123, "user_id": 9170374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4232196d1266adcdb920917739d2d403?s=128&d=identicon&r=PG&f=1", "display_name": "Russtopher", "link": "https://stackoverflow.com/users/9170374/russtopher"}, "edited": false, "score": 0, "creation_date": 1564600838, "post_id": 57296459, "comment_id": 101089228, "body": "If I remove the Space() function it doesn&#39;t error out."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 9170374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4232196d1266adcdb920917739d2d403?s=128&d=identicon&r=PG&f=1", "display_name": "Russtopher", "link": "https://stackoverflow.com/users/9170374/russtopher"}, "edited": false, "score": 0, "creation_date": 1564602153, "post_id": 57297819, "comment_id": 101089786, "body": "That&#39;s it. The length of one of the strings is longer than 25. Not sure why I didn&#39;t catch it. Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 75, "user_id": 11837578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYOeu.png?s=128&g=1", "display_name": "wakgtech", "link": "https://stackoverflow.com/users/11837578/wakgtech"}, "is_accepted": true, "score": 2, "last_activity_date": 1564601858, "creation_date": 1564601858, "answer_id": 57297819, "question_id": 57296459, "link": "https://stackoverflow.com/questions/57296459/error-5-vba-invalid-call-when-looping-through-a-recordset/57297819#57297819", "title": "Error 5 vba, invalid call when looping through a recordset", "body": "<p>Looks like you are subtracting the length of the field from 25, but what if the length is say 30? You would need to determine the length of field. Could you post more of your code? It would help greatly. </p>\n"}], "owner": {"reputation": 123, "user_id": 9170374, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4232196d1266adcdb920917739d2d403?s=128&d=identicon&r=PG&f=1", "display_name": "Russtopher", "link": "https://stackoverflow.com/users/9170374/russtopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57297819, "answer_count": 1, "score": 1, "last_activity_date": 1564604953, "creation_date": 1564595615, "question_id": 57296459, "link": "https://stackoverflow.com/questions/57296459/error-5-vba-invalid-call-when-looping-through-a-recordset", "title": "Error 5 vba, invalid call when looping through a recordset", "body": "<p>Trying to create a string to paste to the body of an email. Getting an Error 5 invalid call when looping through a record set. It goes through the first record fine, but once it gets to the second record, it throws the error.</p>\n\n<pre><code>Do While Not recSet.EOF\n   For intCtr = 0 To recSet.Fields.Count - 1\n      strData = strData &amp; recSet.Fields(intCtr) &amp; Space(25 - Len(Nz(recSet.Fields(intCtr))))\nNext\n   strData = Trim(strData) &amp; vbCrLf\n   recSet.MoveNext\n   Debug.Print strData\nLoop\n</code></pre>\n\n<p>It's supposed to paste the results from a query into the body of the email.</p>\n"}, {"tags": ["excel", "vba", "pdf", "mailmerge"], "comments": [{"owner": {"reputation": 1695, "user_id": 666246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4faf37bc3c0c00aae4e6ccd72977507b?s=128&d=identicon&r=PG", "display_name": "chucklukowski", "link": "https://stackoverflow.com/users/666246/chucklukowski"}, "edited": false, "score": 1, "creation_date": 1564594940, "post_id": 57296178, "comment_id": 101086707, "body": "Could you remove On Error Resume Next and test it? I think that will suppress your errors"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1564595466, "post_id": 57296178, "comment_id": 101086927, "body": "<code>Const strPath As String = &quot;\\\\maplesandcalder.com\\mfs\\xauser\\desktop\\auk\\&quot;</code>, is that a legal way of declaring a variable? May need to put the <code>= ...</code> bit on a new line: <code>Const strPath as String &#47; strPath = &quot;...&quot;</code>  Also, add <code>Debug.Print strPath &amp; strName</code> before the <code>ExportAsFixedFormat</code> line and see if the Immediate Window (press CTRL+G in the VBEditor to show it) shows a path you expect."}, {"owner": {"reputation": 53, "user_id": 3943033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7FmIP.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3943033/alex"}, "edited": false, "score": 0, "creation_date": 1564598926, "post_id": 57296178, "comment_id": 101088439, "body": "I&#39;ve added/changed to both your suggestions. I&#39;m not receiving any errors shown and it it still loading the word version, then opening another word version saying the file is already open (as it&#39;s trying to open the same filename)."}], "owner": {"reputation": 53, "user_id": 3943033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7FmIP.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3943033/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564596371, "creation_date": 1564594265, "last_edit_date": 1564596371, "question_id": 57296178, "link": "https://stackoverflow.com/questions/57296178/pull-data-from-excel-populate-bookmark-and-saving-as-pdf-with-variable-filename", "title": "Pull data from excel, populate bookmark and saving as PDF with variable filename", "body": "<p>I'm trying to pull a name from an excel sheet into a word doc that I have a template for and then save a new pdf for each row in the excel sheet.</p>\n\n<p>I have almost got there. I can pull the data and it tries to save multiple copies of the same filename as a word doc.</p>\n\n<pre><code>Dim objWord As Object\nDim ws As Worksheet\nDim X As Integer\nConst strPath As String = \"\\desktop\\auk\\\"\nDim strName As String\n    On Error Resume Next\n    strName = ActiveDocument.Bookmarks(\"Client\").Range.Text\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    X = 1\n\n    Do Until ws.Range(\"A\" &amp; X) = \"\"\n\n         Set objWord = CreateObject(\"Word.Application\")\n\n         objWord.Visible = True\n         objWord.Documents.Open \"\\desktop\\auk\\Template.docx\"\n         With objWord.ActiveDocument\n              .Bookmarks(\"Client\").Range.Text = ws.Range(\"A\" &amp; X).Value\n\n         End With\n         If Not strName = \"\" Then\n         strName = strName &amp; \".pdf\"\n         ActiveDocument.ExportAsFixedFormat OutputFileName:= _\n                                           strPath &amp; strName, _\n                                           ExportFormat:=wdExportFormatPDF, _\n                                           OpenAfterExport:=False, _\n                                           OptimizeFor:=wdExportOptimizeForPrint, _\n                                           Range:=wdExportAllDocument, _\n                                           From:=1, to:=1, _\n                                           Item:=wdExportDocumentContent, _\n                                           IncludeDocProps:=True, _\n                                           KeepIRM:=True, _\n                                           CreateBookmarks:=wdExportCreateNoBookmarks, _\n                                           DocStructureTags:=True, _\n                                           BitmapMissingFonts:=True, _\n                                           UseISO19005_1:=False\n         End If\n         Set objWord = Nothing\n\n         X = X + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>It doesn't throw an error, it just doesn't save as a variable filename and doesn't try to save as PDF.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1564594838, "post_id": 57296154, "comment_id": 101086662, "body": "What is in cell U9?  You could set a variable to be the new shape/object and use that to make you changes."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11865095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9bbbc6152fbfb8eb5d424b58c46c7d?s=128&d=identicon&r=PG&f=1", "display_name": "jb_liaison", "link": "https://stackoverflow.com/users/11865095/jb-liaison"}, "edited": false, "score": 0, "creation_date": 1564598355, "post_id": 57296322, "comment_id": 101088167, "body": "Hi thanks for getting back to me on this.  This does work on the first usage, but again, when the shape changes I get run-time error 1004 - &#39;Application-defined or object-defined error&#39;.  Could I name the pasted shape and then manipulate it from there? How would I do that?  Thanks again!"}], "tags": [], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "is_accepted": false, "score": 0, "last_activity_date": 1564594958, "creation_date": 1564594958, "answer_id": 57296322, "question_id": 57296154, "link": "https://stackoverflow.com/questions/57296154/select-name-move-newly-pasted-shape-excel-vba/57296322#57296322", "title": "Select / name / move newly pasted shape (Excel VBA)", "body": "<p>Welcome to StackOverflow\nMaybe this code, without any \"Select\" usings (which is a very bad practice in VBA), can help you.</p>\n\n<p>This works provided that the image you want to replicate is the last image added in the Sheet, since it's reference always changes.</p>\n\n<pre><code>Sub Test()\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n\n        .Shapes(.Shapes.Count).Copy\n        .Cells(10, 21).PasteSpecial\n\n        .Shapes(.Shapes.Count).IncrementLeft 130\n        .Shapes(.Shapes.Count).IncrementTop 12\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11865095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a9bbbc6152fbfb8eb5d424b58c46c7d?s=128&d=identicon&r=PG&f=1", "display_name": "jb_liaison", "link": "https://stackoverflow.com/users/11865095/jb-liaison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564594958, "creation_date": 1564594177, "question_id": 57296154, "link": "https://stackoverflow.com/questions/57296154/select-name-move-newly-pasted-shape-excel-vba", "title": "Select / name / move newly pasted shape (Excel VBA)", "body": "<p>Total amateur hour here, learning by doing. I am trying to copy an image in cell U9, paste it and then move it to a certain place in the Excel document (it needs to be placed within a bigger image so pasting it directly to a cell doesn't work).</p>\n\n<p>I am having problems naming and moving the newly pasted image (because the image reference changes every time a new one is pasted). I've found some code that works once (using Shapes.Count) but if the copied image changes (as it needs to), I get the following error when I try to run the code again</p>\n\n<p>Run-time error '-2147467259 (80004005)':\nMethod 'Select' of object 'Shape' failed</p>\n\n<p>Any help gratefully received - I'm in the deep end and managing to figure out quite a lot (thanks Stack Overflow) but this has stumped me all day!</p>\n\n<pre><code>ActiveSheet.Range(\"U9\").Copy\nActiveSheet.Range(\"U10\").Select\nActiveSheet.Paste\nActiveSheet.Shapes(ActiveSheet.Shapes.Count).Select\nSelection.Name = \"Logo 1\"\nSelection.ShapeRange.IncrementLeft 130\nSelection.ShapeRange.IncrementTop 12\n</code></pre>\n"}, {"tags": ["excel", "vba", "shell", "sap"], "comments": [{"owner": {"reputation": 2239, "user_id": 5400362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc3721db0d3d78c446c6ae3f2b99737?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5400362/dev"}, "edited": false, "score": 0, "creation_date": 1564601623, "post_id": 57296149, "comment_id": 101089558, "body": "welcome to so! add some context to your post, so that it will be easy to understand, add like what you trying to achieve? where did you stuck? what error you getting ? also please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to know how to make perfect answerable question"}, {"owner": {"reputation": 3, "user_id": 11865332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3c53f53169ca75228ee5b2cbacd305?s=128&d=identicon&r=PG&f=1", "display_name": "Fiinguer", "link": "https://stackoverflow.com/users/11865332/fiinguer"}, "reply_to_user": {"reputation": 2239, "user_id": 5400362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc3721db0d3d78c446c6ae3f2b99737?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5400362/dev"}, "edited": false, "score": 0, "creation_date": 1564661486, "post_id": 57296149, "comment_id": 101109830, "body": "Thanks. Is that better now?"}, {"owner": {"reputation": 2239, "user_id": 5400362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afc3721db0d3d78c446c6ae3f2b99737?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5400362/dev"}, "edited": false, "score": 0, "creation_date": 1564663099, "post_id": 57296149, "comment_id": 101110798, "body": "yes better than initial one ,but there is still scope to improve"}], "answers": [{"tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": true, "score": 1, "last_activity_date": 1579252908, "last_edit_date": 1579252908, "creation_date": 1564729095, "answer_id": 57321381, "question_id": 57296149, "link": "https://stackoverflow.com/questions/57296149/vba-to-check-for-pr-sap-attachment/57321381#57321381", "title": "VBA to check for PR SAP attachment", "body": "<p>In my test comes with a non-existent attachment a message below.</p>\n\n<p>If that is not the case with you, you could apply the following workaround, for example:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\n    ' The area at left of title is called the GOS container (shellcont).\n    ' It contains a GuiToolbarControl (shell), with one button named %GOS_TOOLBOX,\n    ' which is of type \"ButtonAndMenu\" (button with a dropdown menu).\n    ' Click the dropdown part of the button.\n\n    session.findById(\"wnd[0]/titl/shellcont/shell\").pressContextButton \"%GOS_TOOLBOX\"\n\n    ' Press the menu item \"Attachment list\"\n\n    session.findById(\"wnd[0]/titl/shellcont/shell\").selectContextMenuItem \"%GOS_VIEW_ATTA\"\n\n    ' A popup (wnd[1]) should open if there are attachments, otherwise none opens.\n\n    on error resume next \n    session.findById(\"wnd[1]\").close\n    if err.number &lt;&gt; 0 then \n       msgbox \"There are no attachments.\"\n    end if\n    on error goto 0\n    ...\n</code></pre>\n\n<p>Regards, ScriptMan</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 11865332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3c53f53169ca75228ee5b2cbacd305?s=128&d=identicon&r=PG&f=1", "display_name": "Fiinguer", "link": "https://stackoverflow.com/users/11865332/fiinguer"}, "is_accepted": false, "score": 0, "last_activity_date": 1565284667, "last_edit_date": 1565284667, "creation_date": 1565013228, "answer_id": 57360072, "question_id": 57296149, "link": "https://stackoverflow.com/questions/57296149/vba-to-check-for-pr-sap-attachment/57360072#57360072", "title": "VBA to check for PR SAP attachment", "body": "<p>I solved by using:</p>\n\n<pre><code>session.findById(\"wnd[0]/titl/shellcont/shell\").pressContextButton \"%GOS_TOOLBOX\"\nsession.findById(\"wnd[0]/titl/shellcont/shell\").selectContextMenuItem \"%GOS_VIEW_ATTA\"\n\nErr.Clear\nOn Error Resume Next\n\nIf session.findById(\"/app/con[0]/ses[0]/wnd[1]\").changeable = True Then\n  err1 = Err.Number\nEnd If\n\nIf session.findById(\"/app/con[0]/ses[1]/wnd[1]\").changeable = True Then\n  err3 = Err.Number\nEnd If\n\nOn Error GoTo 0\n\nIf err1 = 619 And err3 = 619 Then\nElse\nsession.findById(\"wnd[0]\").sendVKey 3\n</code></pre>\n\n<p>I just don't know why sometimes the code sometimes is [...]/ses[0]/wnd[0] and sometimes [...]ses[0]/wnd[1]... so, I made 2 rows, one for each case.</p>\n"}], "owner": {"reputation": 3, "user_id": 11865332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3c53f53169ca75228ee5b2cbacd305?s=128&d=identicon&r=PG&f=1", "display_name": "Fiinguer", "link": "https://stackoverflow.com/users/11865332/fiinguer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 57321381, "answer_count": 2, "score": 0, "last_activity_date": 1579252908, "creation_date": 1564594155, "last_edit_date": 1564668646, "question_id": 57296149, "link": "https://stackoverflow.com/questions/57296149/vba-to-check-for-pr-sap-attachment", "title": "VBA to check for PR SAP attachment", "body": "<p>I need excel tell me if the button below called \"Attachment List\" is avaiable to click or not, but I couldn't get it. below is the code i tried - </p>\n\n<pre><code>Sub teste()\n\n        Set SapGuiAuto = GetObject(\"SAPGUI\")\n        Set SAPApplication = SapGuiAuto.GetScriptingEngine\n        Set SAPConnection = SAPApplication.Children(0)\n        Set session = SAPConnection.Children(0)\n\n\n            session.findById(\"wnd[0]\").maximize\n            session.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nme53n\"\n            session.findById(\"wnd[0]\").sendVKey 0\n\n            session.findById(\"wnd[0]\").sendVKey 17\n            session.findById(\"wnd[1]/usr/subSUB0:SAPLMEGUI:0003/ctxtMEPO_SELECT-BANFN\").Text = \"Purchase Requisition\"\n            session.findById(\"wnd[1]/usr/subSUB0:SAPLMEGUI:0003/ctxtMEPO_SELECT-BANFN\").caretPosition = 8\n            session.findById(\"wnd[1]\").sendVKey 0\n\n        session.findById(\"wnd[0]/titl/shellcont/shell\").pressContextButton \"%GOS_TOOLBOX\"\n        Set botao = session.findById(\"/app/con[0]/ses[0]/wnd[0]/titl/shellcont/shell/\")\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vwT3R.png\" rel=\"nofollow noreferrer\">Attachment List Button</a></p>\n\n<p>I set \"botao\" to get all the 8 button data from the list on the image, but none of the properties helped me.</p>\n\n<p>I need something like this:</p>\n\n<pre><code>attach = botao.CurrentContextMenu.Children.Item(2).isfocused\n</code></pre>\n\n<p>The code: \"botao.CurrentContextMenu.Children.Item(2)\" leads me to the \"Attachment List\" button, but no property was valuable to help me.</p>\n\n<p>REALLY need help with this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564596089, "post_id": 57295999, "comment_id": 101087201, "body": "I added a comment to your previous question. Might be as simple as <code>activesheet.showalldata</code>."}, {"owner": {"reputation": 5, "user_id": 11864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ETE8KfxIB7o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewffap8q_p17P1fB_Vjx1ZOk6lmQ/photo.jpg?sz=128", "display_name": "Jhov", "link": "https://stackoverflow.com/users/11864613/jhov"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564596149, "post_id": 57295999, "comment_id": 101087228, "body": "I made the revision and its still showing the previous filtered criteria."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564596368, "post_id": 57295999, "comment_id": 101087323, "body": "Where did you put that line? Needs to be an else clause in the inner If."}, {"owner": {"reputation": 5, "user_id": 11864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ETE8KfxIB7o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewffap8q_p17P1fB_Vjx1ZOk6lmQ/photo.jpg?sz=128", "display_name": "Jhov", "link": "https://stackoverflow.com/users/11864613/jhov"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564596520, "post_id": 57295999, "comment_id": 101087383, "body": "Private Sub Worksheet_Change(ByVal Target As Range) &#39;Updateby Extendoffice 20160606    If Target.Address = Range(&quot;$J$2&quot;).Address Then        If Len(Target) &gt; 0 Then           Range(&quot;A2:H50000&quot;).CurrentRegion.AdvancedFilter Action:=ActiveSheet.ShowAllData, CriteriaRange:=Range(&quot;J1:J2&quot;)        End If    End If End Sub"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564596916, "post_id": 57295999, "comment_id": 101087550, "body": "As you can see code is unreadable in comments. Please add to your question."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ETE8KfxIB7o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewffap8q_p17P1fB_Vjx1ZOk6lmQ/photo.jpg?sz=128", "display_name": "Jhov", "link": "https://stackoverflow.com/users/11864613/jhov"}, "edited": false, "score": 1, "creation_date": 1564597083, "post_id": 57296748, "comment_id": 101087624, "body": "This is perfect.  Thank you!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1564596937, "creation_date": 1564596937, "answer_id": 57296748, "question_id": 57295999, "link": "https://stackoverflow.com/questions/57295999/my-vba-code-to-auto-filter-data-will-keep-previous-criteria-reults-when-criteria/57296748#57296748", "title": "My VBA Code to Auto FIlter Data will keep previous Criteria reults when Criteria Cell is blank. How can I make it return all the Data instead?", "body": "<p>This works for me.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$J$2\" Then  'don't need the range bit\n    If Len(Target) &gt; 0 Then\n       Range(\"A2:H50000\").AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=Range(\"J1:J2\")\n    Else\n        ActiveSheet.ShowAllData\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11864613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ETE8KfxIB7o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rewffap8q_p17P1fB_Vjx1ZOk6lmQ/photo.jpg?sz=128", "display_name": "Jhov", "link": "https://stackoverflow.com/users/11864613/jhov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 57296748, "answer_count": 1, "score": 0, "last_activity_date": 1564627650, "creation_date": 1564593380, "last_edit_date": 1564627650, "question_id": 57295999, "link": "https://stackoverflow.com/questions/57295999/my-vba-code-to-auto-filter-data-will-keep-previous-criteria-reults-when-criteria", "title": "My VBA Code to Auto FIlter Data will keep previous Criteria reults when Criteria Cell is blank. How can I make it return all the Data instead?", "body": "<p>I have a large data set with part numbers that I would like a VBA code wrote to Auto Filter when I enter the part number in a cell. It works great, until I hit delete on the criteria cell, resulting in a Blank cell. It will keep the previous Criteria results instead of unfilter all data.</p>\n\n<p>Previously was helped with an error code, which helped tremendously.  Tried adjusting if statement.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Updateby Extendoffice 20160606\n   If Target.Address = Range(\"$J$2\").Address Then\n       If Len(Target) &gt; 0 Then\n          Range(\"A2:H50000\").CurrentRegion.AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:=Range(\"J1:J2\")\n       End If\n   End If\nEnd Sub\n</code></pre>\n\n<p>I would like the data to return ALL Unfiltered instead of previous Filtered Criteria, when the Criteria Cell is left blank.</p>\n"}, {"tags": ["vba", "ms-word", "wildcard"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1564593631, "post_id": 57295804, "comment_id": 101086149, "body": "You do three sets of replaces. The first replaces BRB ( with BRB XX, you then do yourfind and replace that unhighlights, you then replace BRB XX with BRB ("}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1564620580, "last_edit_date": 1564620580, "creation_date": 1564606935, "answer_id": 57298787, "question_id": 57295804, "link": "https://stackoverflow.com/questions/57295804/use-macro-to-find-acronyms-unless-it-is-followed-by-in-word-vba/57298787#57298787", "title": "Use macro to find acronyms unless it is followed by ( in Word/VBA", "body": "<p>Try this out:</p>\n\n<pre><code>Sub HighlightAcronyms()\n\n    Dim rng As Range, r2 As Range\n\n    Set rng = ActiveDocument.Content\n    Set r2 = ActiveDocument.Content\n\n    With rng.Find\n        .ClearFormatting\n        .Text = \"&lt;[A-Z]{2,}&gt;\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .MatchCase = True\n        .MatchWildcards = True\n        .Format = False\n\n        Do While .Execute\n            'look two characters past the found acroynm\n            r2.Start = rng.End + 1\n            r2.End = rng.End + 3\n            Debug.Print rng.Text, r2.Text\n\n            'highlight if r2 has a \"(\" otherwise clear highlight\n            rng.HighlightColorIndex = IIf(r2.Text Like \"*(*\", _\n                                        wdAuto, wdYellow)\n\n\n        Loop\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9131829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68be4a8c96b33b73cb50cbecd53a674b?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9131829/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 57298787, "answer_count": 1, "score": 0, "last_activity_date": 1564723969, "creation_date": 1564592529, "last_edit_date": 1564723969, "question_id": 57295804, "link": "https://stackoverflow.com/questions/57295804/use-macro-to-find-acronyms-unless-it-is-followed-by-in-word-vba", "title": "Use macro to find acronyms unless it is followed by ( in Word/VBA", "body": "<p>I know I can use wildcards to find acronyms in Word document. I have a macro that does so. However, I want to 'unhighlight' that acronym if it is followed by a (. For example, my content might say \"BRB (be right back)\" so BRB would not be highlighted. But, LOL would be because (laughing out loud) does not immediately follow the text.</p>\n\n<p>I am trying to avoid a lot of false positives that macro throws up. Is there way I can exclude the 'BRB' results?</p>\n\n<pre><code>With ActiveDocument.Content.Find\n  .ClearFormatting\n  .Text = \"&lt;[A-Z]{2,}&gt;\"\nWith .Replacement\n  .Text = \"^&amp;\"\n  .ClearFormatting\n  .Highlight = True\nEnd With```\n</code></pre>\n"}, {"tags": ["excel", "vba", "selenium", "xmlhttprequest"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1564601990, "post_id": 57295697, "comment_id": 101089718, "body": "Page won&#39;t load for me - even under different locations."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564605489, "post_id": 57295697, "comment_id": 101090976, "body": "The website is only working for Kuwait. I even tried to open it from my country Egypt but I couldn&#39;t .. so I used a device of one my friend using teamviewer to be able to login the website. I thought using VPN may solve this problem but it doesn&#39;t."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564605787, "post_id": 57295697, "comment_id": 101091099, "body": "when you manually enter the number and submit do you observe a POST request in the network traffic?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564607248, "post_id": 57295697, "comment_id": 101091625, "body": "No I noticed GET and when tried to copy the URL that has the parameters (including the number I am searching for), the page doesn&#39;t open for the desired output"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564607708, "post_id": 57295697, "comment_id": 101091797, "body": "with xmlhttp does it return the expected content when  .Open &quot;GET&quot;, urlWithParams, False  ?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564608451, "post_id": 57295697, "comment_id": 101092006, "body": "No it just opens the main page with the search box and doesn&#39;t return the desired content"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564608491, "post_id": 57295697, "comment_id": 101092022, "body": "Did you set the appropriate headers?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564608576, "post_id": 57295697, "comment_id": 101092046, "body": "What is the headers that I should put? Can you give me example and I will try to adapt it later."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1564608637, "post_id": 57295697, "comment_id": 101092060, "body": "Headers are shown in the dev tools of browser for the GET request"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1564608701, "post_id": 57295697, "comment_id": 101092080, "body": "Do you mean response headers or request headers?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1564608733, "post_id": 57295697, "comment_id": 101092094, "body": "Request headers"}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564592110, "creation_date": 1564592110, "question_id": 57295697, "link": "https://stackoverflow.com/questions/57295697/convert-selenium-vba-code-to-xmlhttp-get-request", "title": "Convert selenium vba code to xmlhttp get request", "body": "<p>I have the following code that I used selenium VBA but as I am trying to improve my skills, I am trying to use GET method but as for this link I am totally lost\nHere's the code used in selenium</p>\n\n<pre><code>Private bot As New Selenium.ChromeDriver\n\nSub Test()\nDim ws          As Worksheet\nDim c           As Range\nDim dlg         As alert\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nFor Each c In ws.Range(\"A2:A\" &amp; ws.Cells(Rows.Count, 1).End(xlUp).Row)\n    With bot\n        If c.Row = 2 Then\n            .Get \"https://www.moi.gov.kw/gdt/Service_Paymnt.html\"\n            On Error GoTo Skipper\n            .SwitchToFrame \"Services\"\n        ElseIf c.Row &gt; 2 Then\n            .FindElementById(\"openNewSearch\").Click\n            Application.Wait Now + TimeValue(\"00:00:05\")\n            On Error GoTo Skipper\n        End If\n\n        .FindElementByXPath(\"//input[@type='text'][@name='numberValue']\").SendKeys c.Value\n        Application.Wait Now + TimeValue(\"00:00:01\")\n        .FindElementByXPath(\"//*[@name='search']\").Click\n        Application.Wait Now + TimeValue(\"00:00:04\")\n\n        c.Offset(, 1).Value = Replace(Replace(Replace(Split(.FindElementByXPath(\"/html[1]/body[1]/table[1]/tbody[1]/tr[2]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/div[1]/table[1]/tbody[1]/tr[1]/td[1]/form[1]/table[1]/tbody[1]/tr[1]/td[1]/table[1]/tbody[1]/tr[2]/td[1]/table[1]/tbody[1]/tr[1]/td[1]/table[1]/tbody[1]/tr[1]/td[1]\").Text)(0), vbCrLf, \"\"), Chr(34), \"\"), vbLf, \"\")\n    End With\nNext c\n\nExit Sub\n\nSkipper:\nOn Error Resume Next\n    Set dlg = bot.SwitchToAlert(Raise:=False)\n    dlg.Dismiss\nOn Error GoTo 0\nResume\nEnd Sub\n</code></pre>\n\n<p>An example of the numbers used \"290123101619\" \nHope I can find a way using XMLHTTP GET ..\nThe problem is that the URL I found in the Netwrok is too long and when copy that url and test to see if it is working on the browser or not, I found it doesn't return the DOC result.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1564591320, "post_id": 57295330, "comment_id": 101085147, "body": "Use a filter, and set up a button or event macro to trigger the updating."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1564594027, "post_id": 57295330, "comment_id": 101086295, "body": "Try this link and then edit your question.  <a href=\"https://stackoverflow.com/help/how-to-ask\">Good Questions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 11830695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48dc156bc2e7e88dca89cd3461a51da7?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/11830695/mat"}, "is_accepted": false, "score": 0, "last_activity_date": 1564596574, "creation_date": 1564596574, "answer_id": 57296681, "question_id": 57295330, "link": "https://stackoverflow.com/questions/57295330/retrieve-rows-with-dates-matching-the-past-7-days-from-yesterday/57296681#57296681", "title": "Retrieve rows with dates matching the past 7 days from yesterday", "body": "<p>Try this formula and replace the \"A\" with the text. =IF(AND(A1>TODAY()-8,D7=\"a\"),A1,\"\"). This will just return the value in cell A1 if it is within the past 8 days and contains certain text. I am not positive if this is what you are looking for, so let me know how else I could help.</p>\n"}], "owner": {"reputation": 11, "user_id": 11864962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbb27c7c6164ac42b443662cfcc1114?s=128&d=identicon&r=PG&f=1", "display_name": "exoticfruits", "link": "https://stackoverflow.com/users/11864962/exoticfruits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1568301495, "creation_date": 1564590597, "last_edit_date": 1568301495, "question_id": 57295330, "link": "https://stackoverflow.com/questions/57295330/retrieve-rows-with-dates-matching-the-past-7-days-from-yesterday", "title": "Retrieve rows with dates matching the past 7 days from yesterday", "body": "<p>I need to pull rows from one tab in a spreadsheet to another when the date is within the last 7 days from yesterday, and that matches a second criteria as well (text).</p>\n\n<p>I know I can use a pivot table, but I want to automatically update a table with articles without having to manually adjust the dates in a pivot table.</p>\n\n<p>I want to create a table that displays the top 20 articles by revenue (text/string) from (1) the past 30 days and (2) the past 7 days for 3 different publications.</p>\n\n<p>I am pulling data from a platform that gives me rows of individual purchases with tons of columns, the ones I care about being how much revenue came from a purchase, the name of the article that the purchase came from, and the name of the publication that the article came from.</p>\n\n<p>Because these rows represent individual purchases, I need to pull the articles that have the greatest sum of revenue for a specific publication. I am able to filter by publication and get the top generating articles through a pivot table. I have a table in another spreadsheet that pulls the top 20 cells in the Pivot table.</p>\n\n<p>I created a pivot table, and it works, but the document to automatically pull data without me having to manually adjust the dates in the pivot table each time.</p>\n\n<p>I don't know what formula to use, or how to set up the part of the formula that matches the date with any date in the last week from yesterday, so something along the lines of:</p>\n\n<p><code>((Today()-1)&gt;(Today()-8))</code></p>\n"}, {"tags": ["vba", "ms-access", "multivalue"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1564590887, "post_id": 57295226, "comment_id": 101084950, "body": "A quick google shows error 3075 is for Syntax error (missing operator). You&#39;ve likely got a misspelled column name somewhere, or need brackets somewhere, or are missing a <code>&#39;</code>. We can&#39;t really help you debug that. You could start by removing all the conditions in your query, making sure it works, then slowly adding them back in until it stops working, so you can figure out where your issue is."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1564592094, "post_id": 57295226, "comment_id": 101085495, "body": "Are all of your fields Text types?  I&#39;m not sure you can use <code>Like</code> on dates/numbers"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1564593053, "post_id": 57295226, "comment_id": 101085906, "body": "Does your search term include single or double quotes?"}, {"owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1564604324, "post_id": 57295226, "comment_id": 101090568, "body": "@JoshEller was correct there was a syntax error in the expression."}], "owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564636772, "creation_date": 1564590166, "last_edit_date": 1564636772, "question_id": 57295226, "link": "https://stackoverflow.com/questions/57295226/search-multiple-fields-in-access", "title": "Search Multiple Fields in Access", "body": "<p>I've been trying to make the value from a text box search across all fields in my form \"Dashboard\". The dashboard has 15 fields to search through. I've gone online and tried every example but none seem to work for me. Below is the code that has come closest to what I want, but it outputs to a listbox. I have a continuous form that needs to be searched not a listbox.</p>\n\n<p>Example Code:</p>\n\n<pre><code>Private Sub cmdKeywordSearch_Click()\nDim strSQL As String\nSearchFor.SetFocus\n\n\n'Create a string (text) variable\n    Dim vSearchString As String\n\n'Populate the string variable with the text entered in the Text Box SearchFor\n    SearchFor.SetFocus\n\n    vSearchString = SearchFor.Text\n\n'Pass the value contained in the string variable to the hidden text box SrchText,\n'that is used as the search criteria for the Query QRY_SearchAll\n    SrchText.value = vSearchString\n\n'Requery the List Box to show the latest results for the text entered in Text Box SearchFor\n'NEED THIS TO SEARCH THE FORM NOT A LIST BOX\n   ' Me.SearchResults.Requery\n    Dim frm As Form: Set frm = Forms!Dashboard\n    frm.Requery\n\n\n\n'Tests for a trailing space and exits the sub routine at this point\n'so as to preserve the trailing space, which would be lost if focus was shifted from Text Box SearchFor\n    If Len(Me.SrchText) &lt;&gt; 0 And InStr(Len(SrchText), SrchText, \" \", vbTextCompare) Then\n        Exit Sub\n    End If\n\n'Set the focus on the first item in the list box\n'NOT USING A LIST BOX BUT INSTEAD A CONTINOUS FORM NAMED DASHBOARD\n    Me.SearchResults = Me.SearchResults.ItemData(1)\n    Me.SearchResults.SetFocus\n    frm.Requery\n\n\n'Requery the form to refresh the content of any unbound text box that might be feeding off the record source of  the List Box\n    DoCmd.Requery\n\n'Returns the cursor to the the end of the text in Text Box SearchFor\n    Me.SearchFor.SetFocus\n\n    If Not IsNull(Len(Me.SearchFor)) Then\n        Me.SearchFor.SelStart = Len(Me.SearchFor)\n    End If\nEnd Sub\n</code></pre>\n\n<p>My next try which worked only if I used a few fields. When I put all the fields in the SQL string I get the error 3075. I thought going the SQL method was best but it errors. Here is it: </p>\n\n<pre><code>Forms![Dashboard].RecordSource = \"SELECT DISTINCT ProposalTracker3.*, ProposalTracker3.Status, ProposalTracker3.GACP FROM ProposalTracker3 \" _\n&amp; \"WHERE (((ProposalTracker3.Status) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR (((ProposalTracker3.GACP) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR (((ProposalTracker3.Status) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[GACP Charge Number]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Proposal Title]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Anticipated Submittal Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Expected Contract Award Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[Customer Name]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Program Manager]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Proposal Manager]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Project Engineer]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[BAM POC]) Like '*\" &amp; Me.SearchFor &amp; \"*') OR ((ProposalTracker3.[PCE POC]) Like '*\" &amp; Me.SearchFor &amp; \"*') OR ((ProposalTracker3.[PLCS PCE Assigned]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[BPA Pre-KO Notifiction Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[KO Date]) Like '*\" &amp; Me.SearchFor &amp; \"*') OR ((ProposalTracker3.[BOE/BE Due Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[BOE Submit Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Route Memo By Date]) Like '*\" &amp; Me.SearchFor &amp; \"*') OR ((ProposalTracker3.[Memo Due Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Memo Submit Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[PLCS Group]) Like '*\" &amp; Me.SearchFor &amp; \"*') OR ((ProposalTracker3.[Estimator 1]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Estimator 2]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[Hours Bid]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Budgeted Hours On Contract]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[Executed Hours]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.Notes) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.Description) Like '*\" &amp; Me.SearchFor &amp; \"*'))  \" _\n&amp; \"OR ((ProposalTracker3.[Proposal Type]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[Business Group]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.Organization) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.Competitive) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.Direct) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[Proposal Value]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Contract Award Date]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[Contract #]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.[Contract Value]) Like '*\" &amp; Me.SearchFor &amp; \"*')) OR ((ProposalTracker3.[Contract Type]) Like '*\" &amp; Me.SearchFor &amp; \"*')) \" _\n&amp; \"OR ((ProposalTracker3.Phase) Like '*\" &amp; Me.SearchFor &amp; \"*'));\"\n</code></pre>\n\n<p>I appreciate your guidance on this.\nMaxine</p>\n"}, {"tags": ["excel", "vba", "listbox", "selected"], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "is_accepted": true, "score": 0, "last_activity_date": 1564612002, "creation_date": 1564612002, "answer_id": 57299585, "question_id": 57295010, "link": "https://stackoverflow.com/questions/57295010/how-to-select-highlighted-listbox-item-to-add-to-textbox/57299585#57299585", "title": "How to select highlighted listbox item to add to textbox", "body": "<p>I believe I have your solution :)</p>\n\n<p>Control the deselection in the MouseUp event as shown below:</p>\n\n<pre><code>Private Sub ListBox1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    ListBox1.ListIndex = -1\nEnd Sub\n</code></pre>\n\n<p>As long as you don't interrupt the MouseUp event (such as with a MsgBox), this seems to work fine.</p>\n\n<p>Sample code I have used is below:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    ListBox1.AddItem \"asd\"\n    ListBox1.AddItem \"sad\"\n    ListBox1.AddItem \"dsa\"\n    ListBox1.AddItem \"das\"\nEnd Sub\n\nPrivate Sub ListBox1_Click()\n    Sheets(1).Cells(1).Value = ListBox1.List(ListBox1.ListIndex)\n    'MsgBox \"hi\"   'notice this disrupts the MouseUp event...\nEnd Sub\n\nPrivate Sub ListBox1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    ListBox1.ListIndex = -1\nEnd Sub\n</code></pre>\n\n<p>I hope this resolves your issue,\nCheers</p>\n"}], "owner": {"reputation": 28, "user_id": 11660730, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HB4qytPPk18/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcWq7Cgh4fcj-SN5jiN8vklTdh7ig/mo/photo.jpg?sz=128", "display_name": "kyle campbell", "link": "https://stackoverflow.com/users/11660730/kyle-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 57299585, "answer_count": 1, "score": 0, "last_activity_date": 1564627514, "creation_date": 1564589412, "last_edit_date": 1564627514, "question_id": 57295010, "link": "https://stackoverflow.com/questions/57295010/how-to-select-highlighted-listbox-item-to-add-to-textbox", "title": "How to select highlighted listbox item to add to textbox", "body": "<p>My code has a listbox filled with common small strings of text that the user can click to add to a texbox instead of manually typing them out.\nIt works in everyway except the previously selected item cannot be clicked again to add to textbox.</p>\n\n<p>I've tried setting listbox.selected = -1 and listbox1.value =\"\" and when I do this the text is added twice and not unselected.\nAt one point I was able to make a button that just does listbox1.value = \"\" and it worked, but when I add it after my code it fails and does the double text thing.</p>\n\n<pre><code>Private Sub ListBox1_Click()\nFor i = 0 To ListBox1.ListCount - 1\nIf ListBox1.selected(i) Then\nselecteditemtext = ListBox1.List(i)\nEnd If\nNext i\nTextBox2.Text = TextBox2.Text &amp; selecteditemtext &amp; \", \"\n</code></pre>\n\n<p>What I need it for the selected listbox item become unselected after being clicked so it can be clicked again if needed.</p>\n\n<p>When I run this code line by line it works. but all together it adds the text twice.</p>\n\n<pre><code>Private Sub ListBox1_Click()\nFor i = 0 To ListBox1.ListCount - 1\nIf ListBox1.selected(i) Then\nselecteditemtext = ListBox1.List(i)\nEnd If\nNext i\nTextBox2.Text = TextBox2.Text &amp; selecteditemtext &amp; \", \" \ncall listdeselect\nend sub\n\nsub listdeselect()\nsheet1.listbox1.value = \"\"\nend sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "sharepoint", "sharepoint-online"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10726649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a417aa7d598c2be5b16a86755c450d?s=128&d=identicon&r=PG&f=1", "display_name": "Colin G.", "link": "https://stackoverflow.com/users/10726649/colin-g"}, "edited": false, "score": 0, "creation_date": 1564675138, "post_id": 57298497, "comment_id": 101117976, "body": "Yes, that&#39;s what I figured. What I am wondering however is if I can create a macro that can do the &quot;copy it back when done&quot; part for the user automatically upon execution?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 21, "user_id": 10726649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a417aa7d598c2be5b16a86755c450d?s=128&d=identicon&r=PG&f=1", "display_name": "Colin G.", "link": "https://stackoverflow.com/users/10726649/colin-g"}, "edited": false, "score": 0, "creation_date": 1564681788, "post_id": 57298497, "comment_id": 101120884, "body": "Yes, that could be done. Create a script that copies the file, launches Access and, when this closes, copies the file back. Launch the script from a shortcut."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1564605473, "creation_date": 1564605473, "answer_id": 57298497, "question_id": 57294601, "link": "https://stackoverflow.com/questions/57294601/is-there-a-way-to-save-an-access-database-to-a-sharepoint-folder-with-vba/57298497#57298497", "title": "Is there a way to save an Access Database to a SharePoint folder with VBA?", "body": "<p>Not possible. Access needs an <em>SMB file share</em>, which Sharepoint/OneDrive is not (Windows Server and Linux/Samba are).</p>\n\n<p>The only method is, in fact, the one you currently use: Copy the file to a local folder; copy it back when done. Of course, this rules out simultaneous users.</p>\n"}, {"tags": [], "owner": {"reputation": 305, "user_id": 1020132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89962dc04eae1762a0895e6a1f266800?s=128&d=identicon&r=PG", "display_name": "AbAkt", "link": "https://stackoverflow.com/users/1020132/abakt"}, "is_accepted": false, "score": 0, "last_activity_date": 1564614548, "creation_date": 1564614548, "answer_id": 57299896, "question_id": 57294601, "link": "https://stackoverflow.com/questions/57294601/is-there-a-way-to-save-an-access-database-to-a-sharepoint-folder-with-vba/57299896#57299896", "title": "Is there a way to save an Access Database to a SharePoint folder with VBA?", "body": "<p>Agree with previous comment: Access is not designed to work in this way with SharePoint or OneDrive. Works with SMB. You can manage the DB file, but it is not the best or most efficientway to manage it.</p>\n\n<p>SP Server used to have Access web applications- where you could import an Access solution to SP and it would be converted to a SP app/site. I found them useful to migrate simple Access apps to SP server, and then once as SP apps it was possible to migrate them to SP Online with migration tools. Microsoft dropped them for SP Online a while back (maybe for server too?).</p>\n\n<p>If you are on O365, and it is feasible to consider, then I would  suggest to look into O365 solutions in the longer term, converting or migrating to products like PowerApps, as that is where Microsoft are going in this space.</p>\n"}], "owner": {"reputation": 21, "user_id": 10726649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9a417aa7d598c2be5b16a86755c450d?s=128&d=identicon&r=PG&f=1", "display_name": "Colin G.", "link": "https://stackoverflow.com/users/10726649/colin-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1594635096, "creation_date": 1564587996, "last_edit_date": 1594635096, "question_id": 57294601, "link": "https://stackoverflow.com/questions/57294601/is-there-a-way-to-save-an-access-database-to-a-sharepoint-folder-with-vba", "title": "Is there a way to save an Access Database to a SharePoint folder with VBA?", "body": "<p>I have an Access Database, saved to a SharePoint site, that I maintain for several others to use. A lot of people who use it have been having problems saving to our SharePoint site and I am wondering if there is a way I can create a VBA Macro that would allow them to save their changes to SharePoint just by clicking a control on some form. </p>\n\n<p>What we do now is the standard check out and download the database off of SharePoint and then save our changes over the previous file back in that same SharePoint folder. A lot of the people who use the database don't have a ton of experience with Access in general so I'm looking for anyway to streamline the process as much as possible.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564587862, "post_id": 57294492, "comment_id": 101083362, "body": "Sorry but dumping reams of code without any indication of where the error occurs is not very helpful. Please consider providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 11864816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1538ac049d2ce8a53544acc36005756?s=128&d=identicon&r=PG&f=1", "display_name": "df2nut", "link": "https://stackoverflow.com/users/11864816/df2nut"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564588909, "post_id": 57294492, "comment_id": 101083921, "body": "I&#39;m unsure how to highlight the code once entered, and was not sure how much would be relevant to finding the answer. The issue occurs within &quot;Sub Print_Report()&quot; and debugger highlights &quot;FindSpoot&quot; within that section."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564589179, "post_id": 57294492, "comment_id": 101084067, "body": "It&#39;s not reasonable to expect people to wade through all that code to work out what&#39;s going on. <code>EmptySpoot = START.FindSpoot</code>  - what is START? FindSpoot seems to be a function returning a number so this doesn&#39;t make sense to me."}, {"owner": {"reputation": 1, "user_id": 11864816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1538ac049d2ce8a53544acc36005756?s=128&d=identicon&r=PG&f=1", "display_name": "df2nut", "link": "https://stackoverflow.com/users/11864816/df2nut"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564589201, "post_id": 57294492, "comment_id": 101084076, "body": "@SJR I have shortened the code down to where I think only relevant data remains. I made the area where the debugger highlights the error bold."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564589926, "post_id": 57294492, "comment_id": 101084472, "body": "You should also read this - will help you to shorten that code <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 11864816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1538ac049d2ce8a53544acc36005756?s=128&d=identicon&r=PG&f=1", "display_name": "df2nut", "link": "https://stackoverflow.com/users/11864816/df2nut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564589117, "creation_date": 1564587659, "last_edit_date": 1564589117, "question_id": 57294492, "link": "https://stackoverflow.com/questions/57294492/method-or-data-member-not-found-error-received-within-a-vb-form", "title": "Method or Data Member Not found Error received within a VB Form", "body": "<p>I keep receiving the method or data member not found when trying to utilize my form. </p>\n\n<p>I've tried rearranging the order of the code, and several other things, but I'm shooting in the dark here. I've made the text that debugger highlights bold.</p>\n\n<pre><code>\n\nPrivate Sub cmdPrint_Click()\n    Call PRINT_REPORT\n    Call Unprotect\n    Call updateforkeith\nEnd Sub\n\n\nSub PRINT_REPORT()\nDim EmptySpoot As Integer\n\n    Sheets(\"ENV-2 FORM\").Select\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True\n    Sheets(\"Calculations\").Select\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True\n    Sheets(\"Database\").Unprotect\n    Sheets(\"Calculations\").Unprotect\n    EmptySpoot = START.**FindSpoot**\n    Sheets(\"Database\").Cells(EmptySpoot, 3).Select\n    Sheets(\"Database\").Range(\"C\" &amp; r &amp; \":K\" &amp; r).Value = Sheets(\"F0541LOG\").Range(\"C\" &amp; i &amp; \":K\" &amp; i).Value\n    Sheets(\"Calculations\").Select\n    Sheets(\"Calculations\").Range(\"T13:AK13\").Select\n    Selection.Copy\n    EmptySpooot = START.FindSpooot\n    Sheets(\"Database\").Select\n    Sheets(\"Database\").Cells(EmptySpooot, 12).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"ENV-2 Form\").Select\n\n'-----------------------------------------------------------------------------------\n\nDim cellvalue As Integer\nDim preseqnum As Integer\nDim currseqnum As Integer\nDim curdate As String\nDim myfilename As String\nDim myfilename2 As String\n\n</code></pre>\n\n<p>I get the error in the Sub PRINT_REPORT() section. </p>\n\n<p>Any help would be greatly appreciated. PS. This is my first post here, so if I did something wrong I apologize.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564587682, "post_id": 57294447, "comment_id": 101083252, "body": "<code>If IsEmpty(range(&quot;A1&quot;))</code>. If A1 isn&#39;t blank but everything else is xldown will take you to the bottom of the sheet and you will get an error. Better to work up from the bottom. And don&#39;t select things <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1587583621, "post_id": 57294682, "comment_id": 108572352, "body": "If A1 is not blank and A2 is, this will select the wrong cell (eg the last row on the sheet if there is no other data in A) ."}], "tags": [], "owner": {"reputation": 17, "user_id": 11767484, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DWOM_XN6hcc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdyZ4u_yIJQSBepnfey4C4g23pvGQ/photo.jpg?sz=128", "display_name": "Charlie Rodiles", "link": "https://stackoverflow.com/users/11767484/charlie-rodiles"}, "is_accepted": false, "score": 0, "last_activity_date": 1564588313, "creation_date": 1564588313, "answer_id": 57294682, "question_id": 57294447, "link": "https://stackoverflow.com/questions/57294447/error-in-else-part-of-if-statement-but-else-shouldnt-activate-trying-to-use-x/57294682#57294682", "title": "Error in Else part of If statement, but Else shouldn&#39;t activate. Trying to use xlDown on blank worksheet", "body": "<p>First of all, you should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">always avoid using Select or Activate</a>, but answering your question directly:</p>\n\n<pre><code>If Range(\"A1\") = \"\" Then\n    Range(\"A1\").Select\nElse\n    Range(\"A1\").End(xlDown).Offset(1, 0).Select\nEnd If\n</code></pre>\n\n<p>If A1 is empty (\"\"), select it. Otherwise, select the last cell using xlDown <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">(There's also a better way of finding the last row)</a>. </p>\n"}], "owner": {"reputation": 1, "user_id": 11864757, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7UY1N3utBT4/AAAAAAAAAAI/AAAAAAAAA04/Z9vDM-j8Tg8/photo.jpg?sz=128", "display_name": "Charles Henderson", "link": "https://stackoverflow.com/users/11864757/charles-henderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564588313, "creation_date": 1564587492, "question_id": 57294447, "link": "https://stackoverflow.com/questions/57294447/error-in-else-part-of-if-statement-but-else-shouldnt-activate-trying-to-use-x", "title": "Error in Else part of If statement, but Else shouldn&#39;t activate. Trying to use xlDown on blank worksheet", "body": "<p>I'm attempting to copy material from one workbook and paste it into the next open cell in a different workbook.</p>\n\n<p>I've tried using xlDown, but a runtime error occurs when the sheet is blank because there are no used range of non-empty cells to navigate to the bottom of. So I set up an If Else Statement to determine if cell A1 is empty or not. If A1 is empty, select it, else use xlDown to get to the last cell.</p>\n\n<pre><code>Range(\"a1\").Activate\n    If IsEmpty(\"A1\") = True Then\n        currentCell.Select\n    Else\n        Range(\"A1\").End(xlDown).Offset(1, 0).Select\n    End If\n</code></pre>\n\n<p>I would expect the code to just select A1 if it's blank the paste the contents that were copied. If A1 isn't blank, I would want to activate or select the next blank cell in Column A.</p>\n\n<p>Thank you in advance for any and all help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1564587151, "post_id": 57294053, "comment_id": 101082954, "body": "You should ask a question, it is very unlcear what you expect us to answer."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564587649, "post_id": 57294053, "comment_id": 101083232, "body": "The problem to understand what you want is probably that none of your example data meets the criteria <code>IF Expiry is *99 or *00 THEN</code> so ther is nothing to change to <code>ignore</code>."}], "answers": [{"comments": [{"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 1, "creation_date": 1564587984, "post_id": 57294490, "comment_id": 101083437, "body": "Hi, I believe that&#39;s what I&#39;m looking for. My criteria was not clear though, it&#39;s where the difference between the expiry is any of :99, 100, 199, 200, 299, 300, 399, 400. I have edited OP"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1564644092, "post_id": 57294490, "comment_id": 101100344, "body": "@Badja I&#39;ve now updated my answer to reflect your comments, please could you accept my response as an answer, if it has helped? Thanks :)"}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1564647180, "post_id": 57294490, "comment_id": 101102023, "body": "Hi, Thanks for the change in answer. It&#39;s not quite answered my question, as it doesn&#39;t change the whole block, only one line - but I think I can cope with that. Edited my answer to show"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1564648733, "post_id": 57294490, "comment_id": 101102814, "body": "@Badja, I forgot to add 0 to the Case Statement, I believe this now should work as you expect it to...."}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "edited": false, "score": 0, "creation_date": 1564649812, "post_id": 57294490, "comment_id": 101103386, "body": "Brilliant! I&#39;m still seeing an issue where if a card number is clearly different, it&#39;s telling me to investigate, as it&#39;s not checking for that. Different cards have different expiry&#39;s, so that&#39;s expected. I was hoping to look at each record of a card number as a &quot;block&quot; then move on to the next - do I need to change my question to reflect this?"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 3, "last_activity_date": 1564648681, "last_edit_date": 1564648681, "creation_date": 1564587655, "answer_id": 57294490, "question_id": 57294053, "link": "https://stackoverflow.com/questions/57294053/expiry-date-comparison-and-marking-groups-of-rows-in-a-table/57294490#57294490", "title": "Expiry Date Comparison and Marking Groups of Rows in a Table", "body": "<p>If I understood correctly, something like the below would achieve your desired results:</p>\n\n<pre><code>Sub Reissue()\n\nDim ws As Worksheet\n\nSet ws = Worksheets(\"Report\")\n\nFor i = lastRowBeforeImport To lastRowAfterImport\nIf ws.Cells(i, 13).Value - ws.Cells(i - 1, 13).Value = 99 Or ws.Cells(i, 13).Value - ws.Cells(i - 1, 13).Value = 0 Then\n    ws.Cells(i, 14).Value = \"Ignore\"\nElse\n    ws.Cells(i, 14).Value = \"Investigate\"\nEnd If\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>Further to the comment, I've used a Case Statement to see if the value matches any of the mentioned:</p>\n\n<pre><code>Sub Reissue()\nDim ws As Worksheet\nSet ws = Worksheets(\"Report\")\n\nFor i = lastRowBeforeImport To lastRowAfterImport\n    Select Case ws.Cells(i, 13).Value - ws.Cells(i - 1, 13).Value\n          Case 0, 99, 100, 199, 200, 299, 300, 399, 400\n              ws.Cells(i, 14).Value = \"Ignore\"\n          Case Else\n              ws.Cells(i, 14).Value = \"Investigate\"\n    End Select\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564650032, "creation_date": 1564586253, "last_edit_date": 1564650032, "question_id": 57294053, "link": "https://stackoverflow.com/questions/57294053/expiry-date-comparison-and-marking-groups-of-rows-in-a-table", "title": "Expiry Date Comparison and Marking Groups of Rows in a Table", "body": "<p>I need to calculate expiry date differences on reward cards.</p>\n\n<p>In the Track 2 Data sits the expiry, a 4 digit code written as YYMM (1907 for this month).</p>\n\n<p>Transactions where two cards were used will show up in my report on multiple (together) lines. What I want to do is compare all the lines for each card and if there the reason the card was used twice is the expiry - then mark it to be ignored.</p>\n\n<p>I'm not sure how to go about it, so I've come here!</p>\n\n<pre><code>;2130100020=1906192161277?3\n;2130100020=2006192161076?:\n;2130100020=2006192161076?:\n;2130100020=2006192161076?:\n</code></pre>\n\n<p>Here are 4 examples. as shown above the expiry comes after the <code>=</code> sign.</p>\n\n<p>The card number (hidden here for security) is is column B - this data is in column M and the notes section is column N.</p>\n\n<p>The below is what I <em>think</em> I require of the code, but I can't even get my head around the logic, let alone the VBA</p>\n\n<p>If the difference between the expiry is any of 99,100,199,200,299,300,299,400, then the card has expired/been reissued.</p>\n\n<p>So in this case, Column N should read \"ignore\" on all 4 lines as above, but ignore the other ~2000 per day </p>\n\n<hr>\n\n<p>So the question I am asking is:</p>\n\n<p>What statements and code do I need to use to turn the pseudocode below into something VBA can understand?</p>\n\n<hr>\n\n<pre><code>+---------+-+-+-+---------+--------+\n| Card No |e|t|c| Track 2 | Notes  | \n+---------+-+-+-+---------+--------+\n| 1234567 | | | | =1906   | ignore |\n| 1234567 | | | | =2006   | ignore |\n| 1234567 | | | | =2006   | ignore |\n| 1234567 | | | | =2006   | ignore |\n| 9532211 | | | | =2201   | invest |\n| 9532211 | | | | =2201   | invest |\n| 9532211 | | | | =2201   | invest |\n| 9532211 | | | | =2201   | invest |\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vgudz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vgudz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here you can see two card numbers. The green is set at ignore because one of the expiry's is matching the case: <code>2006-1906=100</code>. So every instance of this card in this range of cells can be set to <strong>IGNORE</strong>.</p>\n\n<p>The next card in orange needs to be investigated because the expiry is the same across both, so that's not the reason it's on the report. Hence it needs investigating <code>2207-2207=0</code> - <strong>INVESTIGATE</strong></p>\n\n<p>Code:</p>\n\n<pre><code>Sub Reissue()\n\nDim ws As Worksheet\n\nSet ws = Worksheets(\"Report\")\n\n    With ws.Range(Cells(lastRowBeforeImport, 13), Cells(lastRowAfterImport, 13))\n    'In the above range\n    'IF Expiry is different by 99, 100, 199, 200 etc to 499. \n    '    Example being diff between 2006 and 1906 is 100, so criteria is met\n    'Change NOTES column to REISSUE - IGNORE\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>EDIT:\nWith Xabier's answer, I get the following</p>\n\n<p><a href=\"https://i.stack.imgur.com/2qEFJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2qEFJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is correct as it shows the line with a different expiry that matches the case (here the difference is 300) and the line says \"ignore\". Only change would be to have the whole block say ignore as every case can now be ignored.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1564587886, "post_id": 57293972, "comment_id": 101083378, "body": "<code>Weekday</code> is already a built-in function. Try changing your function name."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1564588353, "post_id": 57293972, "comment_id": 101083628, "body": "Thanks! tried that but get the same error."}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1564589788, "post_id": 57293972, "comment_id": 101084397, "body": "Could you update your code to show what you tried? You might be having more than one issue, but the function name is definitely an issue in itself."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1564596356, "post_id": 57295182, "comment_id": 101087313, "body": "Thanks for that works perfectly! Figured there would have to be an easier way to do this."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 2, "last_activity_date": 1564589960, "creation_date": 1564589960, "answer_id": 57295182, "question_id": 57293972, "link": "https://stackoverflow.com/questions/57293972/vba-access-using-next-business-week-day/57295182#57295182", "title": "VBA Access using next business (week) day", "body": "<p><code>DateAdd</code> takes three arguments and you are only passing it two. The third argument is the date you're starting with.</p>\n\n<p>A function is designed to return a value. Generally you pass in one or more arguments, then you assign the function name to the result and that's what the function returns. As @Josh Eller said, <code>Weekday</code> is already a function name. You can still use it, but it's probably best if you don't. </p>\n\n<p>Here's one way to write a function that will return the next business day. It takes a date as an argument, then adds the proper number of days based on what day of the week the passed in date is.</p>\n\n<pre><code>Function NextBusDay(ByVal dtStart As Date)\n\n    Dim lAdder As Long\n\n    lAdder = 1\n\n    If Weekday(dtStart) = 6 Then lAdder = lAdder + 2\n    If Weekday(dtStart) = 7 Then lAdder = lAdder + 1\n\n    NextBusDay = dtStart + lAdder\n\nEnd Function\n</code></pre>\n\n<p>You can call it like</p>\n\n<pre><code>![DateCreated] = NextBusDay(Date)\n</code></pre>\n\n<p>if you want to get the next business date after today. or</p>\n\n<pre><code>![DateCreated] = NextBusDay(![DateCreated])\n</code></pre>\n\n<p>if you want to change the DateCreated field to the next business date after whatever date is already in there.</p>\n"}, {"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1564596456, "post_id": 57295823, "comment_id": 101087357, "body": "Thanks! Gonna try this out. I know there are better ways to do what I was trying to do but since I&#39;m self taught I&#39;m still learning all the ways to do these functions."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1564610771, "last_edit_date": 1564610771, "creation_date": 1564592598, "answer_id": 57295823, "question_id": 57293972, "link": "https://stackoverflow.com/questions/57293972/vba-access-using-next-business-week-day/57295823#57295823", "title": "VBA Access using next business (week) day", "body": "<p>You were close with your logic, but you omitted the date argument for the <code>DateAdd</code> function, and you were also attempting to redefine the existing in-built <code>Weekday</code> function.</p>\n\n<p>Instead, you could condense the logic to the following:</p>\n\n<pre><code>Function NextWorkingDay(datDate As Date) As Date\n    If Weekday(datDate) &gt; 5 Then\n        NextWorkingDay = datDate + 9 - Weekday(datDate)\n    Else\n        NextWorkingDay = datDate + 1\n    End If\nEnd Function\n</code></pre>\n\n<p>Here, if the weekday of the supplied date (counting from Sunday) is greater than 5 (i.e. if the day is Friday or Saturday) the function will add 3 days for Friday and 2 days for Saturday, else 1 day will be added to the date.</p>\n\n<p>This could also be written:</p>\n\n<pre><code>Function NextWorkingDay(datDate As Date) As Date\n    Dim i As Integer: i = Weekday(datDate)\n    If i &lt; 6 Then i = 8\n    NextWorkingDay = datDate + 9 - i\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1564596391, "post_id": 57296532, "comment_id": 101087330, "body": "Thanks! I&#39;m still learning to use SQL and incorporate it into VBA."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1564598254, "post_id": 57296532, "comment_id": 101088128, "body": "Not sure what you mean as you do not need use SQL in attempted code. Do note: stored queries often runs more efficiently than VBA string SQL as Access engine saves best execution plan and no recordsets are opened here."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1564595939, "creation_date": 1564595939, "answer_id": 57296532, "question_id": 57293972, "link": "https://stackoverflow.com/questions/57293972/vba-access-using-next-business-week-day/57296532#57296532", "title": "VBA Access using next business (week) day", "body": "<p>Consider a pure SQL solution that can be called with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.openquery\" rel=\"nofollow noreferrer\">DoCmd.OpenQuery</a>. Doing so, you can  avoid any nested multiple, recordset calls. Below updates original <em>DateCreated</em> field by adding needed days if date lands on Fri-Sun (all assuming Monday as start of <a href=\"https://support.office.com/en-us/article/weekday-function-05d360d7-2c3f-4691-9448-c96ea0351940\" rel=\"nofollow noreferrer\">weekday</a>), otherwise adds a single day.</p>\n\n<p><strong>SQL</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE tblTasks\nSET DateCreated = IIF(WeekDay(DateCreated, 1) = 5, DateAdd('d', 3, DateCreated), \n                      IIF(WeekDay(DateCreated, 1) = 6, DateAdd('d', 2, DateCreated), \n                           IIF(WeekDay(DateCreated, 1) = 7, DateAdd('d', 1, DateCreated), \n                               DateAdd('d', 1, DateCreated)\n                               ) \n                         )\n                  )\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub EndofDay_Click()\n    Dim nConfirmation As Integer\n\n    nConfirmation = MsgBox(\"Are you sure you want to complete this Task?\", _\n                           vbInformation + vbYesNo, \"Complete Task?\")\n\n    If nConfirmation = vbYes Then    \n        DoCmd.SetWarnings False\n        DoCmd.OpenQuery \"myUpdateQuery\"\n        DoCmd.SetWarnings True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 57295182, "answer_count": 3, "score": 1, "last_activity_date": 1594635115, "creation_date": 1564585898, "last_edit_date": 1594635115, "question_id": 57293972, "link": "https://stackoverflow.com/questions/57293972/vba-access-using-next-business-week-day", "title": "VBA Access using next business (week) day", "body": "<p>I'm attempting to write a function that fills in the next business day (excludes weekends) to a [DateCreated] field in a record. I was trying to setup something like this:</p>\n\n<pre><code>Function WD()\n\n'Monday\nIf [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 2))) Then '&lt;---Debug hates this line\n[DateCreated] = [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 3)) Mod 7, Date)\n'Tuesday\nElseIf [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 3))) Then\n[DateCreated] = [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 4)) Mod 7, Date)\n'Wednesday\nElseIf [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 4))) Then\n[DateCreated] = [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 5)) Mod 7, Date)\n'Thursday\nElseIf [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 5))) Then\n[DateCreated] = [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 6)) Mod 7, Date)\n'Friday\nElseIf [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 6))) Then\n[DateCreated] = [DateCreated] = DateAdd(\"d\", (8 - Weekday(Date, 2)) Mod 7, Date)\nEnd If\nEnd Function\n</code></pre>\n\n<p>But I get an argument not optional error when attempting to call it. </p>\n\n<p>I'm using the following to code to pull it in:</p>\n\n<pre><code>Public Sub EndofDay_Click()\nDim rs1 As DAO.Recordset\nDim rs2 As DAO.Recordset\nDim nConfirmation As Integer\n\n    nConfirmation = MsgBox(\"Are you sure you want to complete this Task?\", vbInformation + vbYesNo, \"Complete Task?\")\nIf nConfirmation = vbYes Then\n'Copy Records with Status of 10 In Progress\nSet rs1 = CurrentDb.OpenRecordset(\"tblTasks\")\nSet rs2 = CurrentDb.OpenRecordset(\"tblTasks\")\n\nrs1.MoveFirst\nIf Not (rs1.EOF And rs1.BOF) Or Status = 10 Then\nDo Until rs1.EOF = True\n    If (rs1![Status] = 10) Then\n       With rs2\n            .AddNew\n            ![DateCreated] = WD '&lt;---- Here\n            .Update\n       End With\n    End If\n    rs1.MoveNext\nLoop\nElse\n'do nothing\nEnd If\n\nrs1.Close 'Close the recordset\nSet rs1 = Nothing 'Clean up\nrs2.Close 'Close the recordset\nSet rs2 = Nothing 'Clean up\n\nForms![frmTasks].Form.Requery\nForms![frmTasks].Form.Refresh\nEnd sub\n</code></pre>\n\n<p>I'm not even sure this is the best way to go about trying this. Any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 6922002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e134da67d2fc3ce296953eb3efd5d62?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Emilio Flores Delfin", "link": "https://stackoverflow.com/users/6922002/erik-emilio-flores-delfin"}, "reply_to_user": {"reputation": 13, "user_id": 10947079, "user_type": "registered", "profile_image": "https://graph.facebook.com/2078343558914359/picture?type=large", "display_name": "Aditya Pal", "link": "https://stackoverflow.com/users/10947079/aditya-pal"}, "edited": false, "score": 0, "creation_date": 1564750880, "post_id": 57294100, "comment_id": 101143905, "body": "You could create a new tab in the final Excel File and called it Config, there you could save each element that you already processed, in that case in the beggining you will check if the file was already checked or not, the config tab could contain other thing as for example formulas to manage the last cell used, etc. that way you could use it cells as fields to save data that the code requires."}], "tags": [], "owner": {"reputation": 64, "user_id": 6922002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e134da67d2fc3ce296953eb3efd5d62?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Emilio Flores Delfin", "link": "https://stackoverflow.com/users/6922002/erik-emilio-flores-delfin"}, "is_accepted": true, "score": 1, "last_activity_date": 1564586406, "creation_date": 1564586406, "answer_id": 57294100, "question_id": 57293913, "link": "https://stackoverflow.com/questions/57293913/vba-to-copy-data-from-another-workbook-in-excel/57294100#57294100", "title": "VBA to Copy Data from Another Workbook in Excel", "body": "<p>I ahve somethign similar, I read all the files located on a folder for your case you will save all the 65 Workbooks in a folder, then read each one of them with a loop, once it takes the first book opened you will take the info:</p>\n\n<pre><code>Dim fldr As FileDialog\nDim sItem As String\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sItem = .SelectedItems(1) &amp; sItem + \"\\\"\n    FilePathBox.Value = sItem\nEnd With\nNextCode:\nGetFolder = sItem &amp; \"\\\"\nSet fldr = Nothing\n</code></pre>\n\n<p>If you see my code above it taks the url of the folder, then I will start a process that will see file by file:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    UserForm1.Top = (Application.Height / 2) - (UserForm1.Height / 2) + 45\n    UserForm1.Left = (Application.Width / 2) - (UserForm1.Width / 2) + 200\n    UserForm1.Label1.Visible = True\n    Label1.Caption = \"\"\n    '-----------------------------------------THIS IS THE LOOP OFR EACH FILE INTO THE FOLDER--------------------------------------------------\n    MyPath = UserForm2.FilePathBox.Value\n    Dim strFilename As String\n    strFilename = Dir(MyPath &amp; \"*.txt\", vbNormal)\n    filesc = 1\n    If Len(strFilename) = 0 Then Exit Sub\n    Do Until strFilename = \"\"\n        Application.DisplayAlerts = False\n        If filesc &gt;= 1 Then\n            showBarName.Caption = showBarName.Caption &amp; strFilename\n            'Worksheets.Add(Worksheets(Worksheets.Count)).Name = \"Data\"\n            Call ThisWorkbook.XY_Data((UserForm2.FilePathBox.Value &amp; strFilename), (strFilename &amp; \"\"))\n            showBarName.Caption = \"Generating XY Data for %PATH%/\"\n        End If\n        filesc = filesc + 1\n        counter = counter + cols\n        strFilename = Dir()\n    Loop\n    '------------------------------------------END--------------------------------------------------------------------------------------------\n    Worksheets(\"Spec\").Visible = True\n    For Each ws In ThisWorkbook.Worksheets\n         If ws.Name = \"Spec\" Then\n            Application.DisplayAlerts = False\n            ws.Delete\n            Application.DisplayAlerts = True\n        End If\n    Next ws\n    UserForm1.Hide\n    showBarName.Caption = \"Saving File\"\n    'THIS IS FOR XLSX\n    Application.StatusBar = \"Save your file into the PNL Project path.\"\n    Application.DisplayAlerts = False\n    Dim hoja As Worksheet\n    For Each hoja In Sheets\n        If ActiveSheet.Name = \"Data\" Then\n            ActiveWindow.SelectedSheets.Delete\n        End If\n    Next hoja\n    fileSaveName = Application.GetSaveAsFilename( _\n    fileFilter:=\"Excel Workbooks (*.xlsx), *.xlsx\")\n    If fileSaveName &lt;&gt; False Then\n        Application.ActiveWorkbook.SaveAs Filename:=fileSaveName, FileFormat:=51\n    End If\n    showBarName.Caption = \"Generating XY Data for %PATH%/\"\n    'This is to close the macro without saving\n    Application.StatusBar = \"XY Data Generated by Yazaki &lt;&lt;erik.floresdelfin@mx.yazaki.com&gt;&gt;\"\n    'ThisWorkbook.Close savechanges = False\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Then on the above code in some part I take each file in txt format, and I call a method which contains the url of the file that I want to open, the rest should be taking what tou need to copy and paste on the actual file, the final code I show is how to save the file asking to the user, sorry for the trash code but I think you caould manage taking what you need.</p>\n"}], "owner": {"reputation": 13, "user_id": 10947079, "user_type": "registered", "profile_image": "https://graph.facebook.com/2078343558914359/picture?type=large", "display_name": "Aditya Pal", "link": "https://stackoverflow.com/users/10947079/aditya-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 57294100, "answer_count": 1, "score": 1, "last_activity_date": 1564586406, "creation_date": 1564585697, "last_edit_date": 1564585762, "question_id": 57293913, "link": "https://stackoverflow.com/questions/57293913/vba-to-copy-data-from-another-workbook-in-excel", "title": "VBA to Copy Data from Another Workbook in Excel", "body": "<p>Problem: \nA problem in making a cell reference in VBA for source workbook name. Error 9 subscripts out of range.</p>\n\n<p>Task I am doing?\nEx. I have to copy 32 columns out of 50 columns from a workbook(Master) into a new workbook. I am able to make a code to copy and paste the column in the required sequence in new workbook.</p>\n\n<p>The master workbook is a template of a register to take peoples information and it saved with a new name. \nI have more than 65 workbooks(Master) to copy. I was trying to make a cell reference where I paste the source workbook(Master) name. I am aware that source workbook has to be open will running VBA.</p>\n\n<p>I made icell as variable to fetch that value from cell B2, where I pasted workbook name but code is not running.  </p>\n\n<p>Code attached\nAny suggestion is highly appreciated.</p>\n\n<pre><code>Sub Copy_Paste()\n    Dim iCell As String  \n    iCell = Workbooks(\"Crack it\").Worksheets(\"Intro\").Range(\"B2\").Value\n    'B2 will store the name of source workbook for copying data which will keep on changing \n\n    Workbooks(\"iCell\").Worksheets(\"Register\").Range(\"E2:E50\").Copy\n    Workbooks(\"Crack it.xlsm\").Worksheets(\"Risk\").Range(\"A2\").PasteSpecial Paste:=xlPasteValues 'Refid\n\n    Workbooks(\"iCell\").Worksheets(\"Register\").Range(\"H2:H50\").Copy\n    Workbooks(\"Crack it.xlsm\").Worksheets(\"Risk\").Range(\"B2\").PasteSpecial Paste:=xlPasteValues 'Tags\n\n    Workbooks(\"iCell\").Worksheets(\"Register\").Range(\"A2:A50\").Copy\n    Workbooks(\"Crack it.xlsm\").Worksheets(\"Risk\").Range(\"c2\").PasteSpecial Paste:=xlPasteValues 'Name\n\n    Workbooks(\"iCell\").Worksheets(\"Register\").Range(\"Z2:Z50\").Copy\n    Workbooks(\"Crack it.xlsm\").Worksheets(\"Risk\").Range(\"D2\").PasteSpecial Paste:=xlPasteValues 'Element\n\n    ...... code keeps on repeating till column 32th \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 4, "creation_date": 1564584761, "post_id": 57293559, "comment_id": 101081553, "body": "Welcome to Stack Overflow. Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> or <a href=\"https://meta.stackoverflow.com/questions/261592/how-much-research-effort-is-expected-of-stack-overflow-users\">How much research effort is expected of Stack Overflow users?</a> might help you to improve your question."}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 2, "creation_date": 1564584863, "post_id": 57293559, "comment_id": 101081631, "body": "As P\u1d07\u029c mentioned, you&#39;ll need to show what you&#39;ve done so far, and ask a specific question. A good start is to use the macro recorder in Excel, do the actions you&#39;ve described, and start working from the code it generates."}, {"owner": {"reputation": 5, "user_id": 11864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d4e0923052bc9187a48887490ba940?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Ghizzo", "link": "https://stackoverflow.com/users/11864393/pedro-ghizzo"}, "edited": false, "score": 0, "creation_date": 1564590161, "post_id": 57293559, "comment_id": 101084575, "body": "Hey there, thanks for answering. Ive just put the initial code as an edit. Thats how it should be done for the next part number. My question is how to make it work for every next item in the sheet as a macro. Identify the &quot;stop regions&quot; and take next items to match with their spots in column A."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d4e0923052bc9187a48887490ba940?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Ghizzo", "link": "https://stackoverflow.com/users/11864393/pedro-ghizzo"}, "edited": false, "score": 0, "creation_date": 1564687240, "post_id": 57302636, "comment_id": 101123256, "body": "It worked! Exactly the way i needed Thank you very much for helping!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1564639149, "creation_date": 1564639149, "answer_id": 57302636, "question_id": 57293559, "link": "https://stackoverflow.com/questions/57293559/how-to-move-and-transpose-data-from-a-varied-number-of-columns-about-different-i/57302636#57302636", "title": "How to move and transpose data from a varied number of columns about different itens?", "body": "<p>I suggest the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ReOrganizeData()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"DataSheet\")  'define your worksheet\n\n    Dim LastRow As Long  'find last used row in column D\n    LastRow = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n\n    'find first row with data in column B\n    Dim StartRow As Long\n    If ws.Cells(1, \"B\").Value = vbNullString Then\n        StartRow = ws.Cells(1, \"B\").End(xlDown).Row\n    Else\n        StartRow = 1\n    End If\n\n    Dim MatchedRow As Double\n    Dim EndRow As Long\n\n    Do While StartRow &lt; LastRow  'loop through all data\n        'find end row\n        EndRow = ws.Cells(StartRow, \"B\").End(xlDown).Row - 1\n        If EndRow &gt; LastRow Then EndRow = LastRow  'check for last row overflow\n\n        'match data in column C with data in column A\n        MatchedRow = Application.Match(ws.Cells(StartRow, \"C\").Value, ws.Columns(\"A\"), 0)\n        If Not IsError(MatchedRow) Then\n            'check if matched row is free\n            If ws.Cells(MatchedRow, \"D\").Value &lt;&gt; vbNullString Then\n                MsgBox \"The row \" &amp; MatchedRow &amp; \" where I need to write data is not empty. Something went wrong.\", vbCritical\n                Exit Sub\n            End If\n\n            'move data B and C\n            ws.Cells(MatchedRow, \"B\").Resize(1, 2).Value = ws.Cells(StartRow, \"B\").Resize(1, 2).Value\n            ws.Cells(StartRow, \"B\").Resize(1, 2).Clear\n\n            'transpose data D\n            ws.Cells(MatchedRow, \"D\").Resize(1, EndRow - StartRow + 1).Value = Application.Transpose(ws.Cells(StartRow, \"D\").Resize(EndRow - StartRow + 1, 1).Value)\n            ws.Cells(StartRow, \"D\").Resize(EndRow - StartRow + 1, 1).Clear\n        Else\n            MsgBox \"Data '\" &amp; ws.Cells(StartRow, \"C\").Value &amp; \"' could not be matched with column A.\", vbExclamation\n        End If\n\n        'set new start row\n        StartRow = EndRow + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Using this data \u2026</p>\n\n<p><a href=\"https://i.stack.imgur.com/gJKGZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gJKGZ.png\" alt=\"enter image description here\"></a>\n<em><sup>Image 1: Input data of \"DataSheet\".</sup></em></p>\n\n<p>\u2026 it will output this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OBCwm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OBCwm.png\" alt=\"enter image description here\"></a>\n<em><sup>Image 2: Data in \"DataSheet\" after transformation.</sup></em></p>\n"}], "owner": {"reputation": 5, "user_id": 11864393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0d4e0923052bc9187a48887490ba940?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Ghizzo", "link": "https://stackoverflow.com/users/11864393/pedro-ghizzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 57302636, "answer_count": 1, "score": -3, "last_activity_date": 1564639149, "creation_date": 1564584587, "last_edit_date": 1564590035, "question_id": 57293559, "link": "https://stackoverflow.com/questions/57293559/how-to-move-and-transpose-data-from-a-varied-number-of-columns-about-different-i", "title": "How to move and transpose data from a varied number of columns about different itens?", "body": "<p>I am working with data of 18 thousand itens that come from a SAP program and I need to organize them in lines of content. The part numbers in columns A and C must be a match (the number in C column should be positioned in line with the first time it appears in column A), and the description provided in column C should be transposed to this line of match (copy + paste special transpose then delete from the column).</p>\n\n<p>My idea for a code is something like this (im not a programmer):</p>\n\n<ol>\n<li><p>Select the region of interest in columns B, C and D;</p></li>\n<li><p>In column A, find the first cell with a match for the part number in column C for the selected interval - save this line;</p></li>\n<li><p>Cut the interval;</p></li>\n<li><p>Paste the selected region (step 1) in column B of saved line in step 2;</p></li>\n<li><p>Copy the description in column D and paste special (transpose) in column E of the saved line;</p></li>\n<li><p>In column D, select the content from saved line+1 until there's no more data in the cells of the column and delete;</p></li>\n<li><p>End.</p></li>\n</ol>\n\n<p><a href=\"https://drive.google.com/file/d/1zf1maftGdCfupdAA7R0TNc6lzPnQrJ0j/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1zf1maftGdCfupdAA7R0TNc6lzPnQrJ0j/view?usp=sharing</a> (this is a small part of the actual sheet im working on).</p>\n\n<p>Macro code is currently the following:</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n\n'\n    Range(\"B20:D22\").Select\n    Selection.Cut\n    Range(\"B8\").Select\n    ActiveSheet.Paste\n    Range(\"D8:D10\").Select\n    Selection.Copy\n    Range(\"E8\").Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n    Range(\"D9:D10\").Select\n    Application.CutCopyMode = False\n    Selection.ClearContents\nEnd Sub\n</code></pre>\n\n<p>Lines 1 and 5 are examples of how it should look in the end (I must do the same with the next part numbers in column C and A). The macro should move the data until the first time the part number appears in column A, do the match and transpose description from column to line.</p>\n"}, {"tags": ["vba", "32bit-64bit"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1564590583, "post_id": 57293427, "comment_id": 101084810, "body": "The <code>ptrSafe</code> means that the declaration can be executed on a 64bit platform. It doesn&#39;t really make the call safer. It appeared with the 64bit version of Excel as mean to prevent old code to run on a 64bit Excel."}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1564589114, "post_id": 57293708, "comment_id": 101084026, "body": "&quot;The API declaration of this function has changed to 64-bit version&quot; -- that&#39;s not really accurate. Using VBA7 syntax means that the declaration will run in both 32-bit or 64-bit version just fine. It just won&#39;t blow up because the <code>LongPtr</code> scales to either 32-bit or 64-bit integer, whereas <code>Long</code> nor <code>LongLong</code> won&#39;t scale based on the hardware. In fact, your example has the VBA7 version running for either 32-bit or 64-bit Office; only older VBA6 hosts (e.g. Office 2007 and prior) will run the 2nd, non-pointer-safe version because <code>LongPtr</code> doesn&#39;t exist there."}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 1, "last_activity_date": 1569490268, "last_edit_date": 1569490268, "creation_date": 1564585102, "answer_id": 57293708, "question_id": 57293427, "link": "https://stackoverflow.com/questions/57293427/what-is-the-purpose-of-the-ptrsafe-attribute-of-a-declare-statement/57293708#57293708", "title": "What is the purpose of the ptrSafe attribute of a declare statement", "body": "<p><code>PtrSafe</code> serves to tell VBA that API declarations are safe: <code>Ptr (pointer)</code> <code>Safe (safe, safe)</code></p>\n\n<p>This attribute indicates that we target the 64-bit version.</p>\n\n<p><strong>For Example</strong></p>\n\n<p>Take the <code>ShellExecute</code> API function, which opens any file in its default application without knowing it. For example, an .xlsx document will open in Excel, a .pdf will open in Acrobat Reader, unless you have installed another PDF reader (such as Sumatra PDF).</p>\n\n<p>The API declaration of this function has changed to <code>64-bit</code> version. To make <code>32 and 64-bit</code> versions coexist in the same database, write this:</p>\n\n<pre><code>' --- DECLARATION API WINDOWS\n#If VBA7 Then\n  Private Declare PtrSafe Function ShellExecute _\n    Lib \"shell32.dll\" _\n    Alias \"ShellExecuteA\" ( _\n      ByVal hwnd As LongPtr, ByVal lpOperation As String, _\n      ByVal lpFile As String, ByVal lpParameters As String, _\n      ByVal lpDirectory As String, ByVal nShowCmd As Long) _\n    As LongPtr\n#Else\n  Private Declare Function ShellExecute _\n    Lib \"shell32.dll\" _\n    Alias \"ShellExecuteA\" ( _\n      ByVal hwnd As Long, ByVal lpOperation As String, _\n      ByVal lpFile As String, ByVal lpParameters As String, _\n      ByVal lpDirectory As String, ByVal nShowCmd As Long) _\n    As Long\n#End If\n</code></pre>\n\n<p><a href=\"https://www.oipapio.com/question-16934448\" rel=\"nofollow noreferrer\">Original content can be found there</a></p>\n"}], "owner": {"reputation": 35370, "user_id": 180275, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/4GALY.jpg?s=128&g=1", "display_name": "Ren&#233; Nyffenegger", "link": "https://stackoverflow.com/users/180275/ren%c3%a9-nyffenegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1569490268, "creation_date": 1564584213, "question_id": 57293427, "link": "https://stackoverflow.com/questions/57293427/what-is-the-purpose-of-the-ptrsafe-attribute-of-a-declare-statement", "title": "What is the purpose of the ptrSafe attribute of a declare statement", "body": "<p>In VBA, I need to <code>declare</code> a function in a DLL with the <code>ptrSafe</code> attribute if I am using it in a 64-bit Office environment.</p>\n\n<p>As far as I can see, the <code>ptrSafe</code> does not technically change anything so that I am not sure what the purpose of the <code>ptrSafe</code> attribute actually is.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 93, "user_id": 6622150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c62b3241a9cc5e9aa944f3c7855ff62?s=128&d=identicon&r=PG&f=1", "display_name": "HeyYouCoding", "link": "https://stackoverflow.com/users/6622150/heyyoucoding"}, "edited": false, "score": 1, "creation_date": 1564585947, "post_id": 57293366, "comment_id": 101082294, "body": "hey there, are FuelTy , EngMake  etc, variables inside the vba project or fields on your query table? , because it could be an error in the string construction of your query"}, {"owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "reply_to_user": {"reputation": 93, "user_id": 6622150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c62b3241a9cc5e9aa944f3c7855ff62?s=128&d=identicon&r=PG&f=1", "display_name": "HeyYouCoding", "link": "https://stackoverflow.com/users/6622150/heyyoucoding"}, "edited": false, "score": 1, "creation_date": 1564586668, "post_id": 57293366, "comment_id": 101082695, "body": "They are text that refers to the column as this is a validator query so I added abbreviated field names as text and then the actual field results so it is easier to see what column it is for. So &#39;Pages ID &#39; &amp; [p.id];  Pages Id is text and then p.id is the column."}, {"owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "reply_to_user": {"reputation": 93, "user_id": 6622150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c62b3241a9cc5e9aa944f3c7855ff62?s=128&d=identicon&r=PG&f=1", "display_name": "HeyYouCoding", "link": "https://stackoverflow.com/users/6622150/heyyoucoding"}, "edited": false, "score": 1, "creation_date": 1564586991, "post_id": 57293366, "comment_id": 101082852, "body": "I can usually get the queries to work if they are on one line but when I break them up into multiple lines is when I have issues usually."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "edited": false, "score": 0, "creation_date": 1564664654, "post_id": 57294821, "comment_id": 101111624, "body": "That fixed it. Thank you so much! I had a feeling it was something small but im a noob to vba."}], "tags": [], "owner": {"reputation": 93, "user_id": 6622150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c62b3241a9cc5e9aa944f3c7855ff62?s=128&d=identicon&r=PG&f=1", "display_name": "HeyYouCoding", "link": "https://stackoverflow.com/users/6622150/heyyoucoding"}, "is_accepted": true, "score": 0, "last_activity_date": 1564588756, "creation_date": 1564588756, "answer_id": 57294821, "question_id": 57293366, "link": "https://stackoverflow.com/questions/57293366/can-not-get-sql-query-to-run-vba-and-keep-getting-errors-3131-error-in-from-clau/57294821#57294821", "title": "Can not get sql query to run VBA and keep getting errors 3131 error in from clause and 3067 Query must contain at least one table or query", "body": "<p>the use of of parentheses (\"a\")&amp;(\"b\") isn't necessary, you could use a single \"a\" &amp; \"b\" to concatenate strings and \"a\" &amp; _ \"b\" to  join lines of code, try this to construct your query</p>\n\n<pre><code>Sub JoinQueryString()\nDim SqlQuery As String\nSqlQuery = \"SELECT DISTINCT 'Pages ID ' &amp; [p.id] &amp; ', Model ' &amp; '''' &amp; [p.equipmentmodel] &amp; '''' &amp; ', S/Prefix ' &amp; '''' &amp; [p.equipmentserialprefix] &amp; '''' &amp; ', FuelTy ' &amp; '''' &amp; [p.equipmentfueltype] &amp; '''' &amp; ', EngMake ' &amp; '''' &amp; [p.EngineMake] &amp; '''' &amp; ', Engine ' &amp; '''' &amp; [p.enginemodel] &amp; '''' &amp; ', TraMake ' &amp; '''' &amp; [p.transmissionmake] &amp; '''' &amp; ', TraSeries ' &amp; '''' &amp; [p.transmissionseries] &amp; '''' &amp; ', TraModel ' &amp; '''' &amp; [p.transmissionModel] &amp; '''' &amp; ', TranType ' &amp; '''' &amp; [p.transmissiontype] &amp; '''' &amp; ', MastMake ' &amp; '''' &amp; [p.mastmake] &amp; '''' &amp; ', Mast ' &amp; '''' &amp; [p.mastmodel] &amp; '''' &amp; ', CtrlPnl ' &amp; '''' &amp; [p.controlpanel] &amp; '''' &amp; ', Volt ' &amp; '''' &amp; [p.voltage] &amp; '''' &amp; ', CtryCode ' &amp; '''' &amp; [p.countrycode] &amp; '''' &amp; ', Capacity ' &amp; '''' &amp; [p.capacity] &amp; '''' &amp; '; not on Model tbl.' AS Expr1\" &amp; _\n\" FROM pgs_v AS p LEFT JOIN model AS M ON ([p.CAPACITY] = [M.CAPACITY]) AND ([p.VOLTAGE] = [M.VOLTAGE]) AND ([p.MASTMODEL] = [M.MASTMODEL]) AND ([p.TRANSMISSIONTYPE] = [M.TRANSMISSIONTYPE]) AND ([p.TRANSMISSIONSERIES] = [M.TRANSMISSIONSERIES]) AND ([p.EQUIPMENTSERIALPREFIX] = [M.EQUIPMENTSERIALPREFIX]) AND ([p.EQUIPMENTMODEL] = [M.EQUIPMENTMODEL]) AND ([p.EQUIPMENTFUELTYPE] = [M.EQUIPMENTFUELTYPE]) AND ([p.ENGINEMODEL] = [M.ENGINEMODEL]) AND ([p.ENGINEMAKE] = [M.ENGINEMAKE]) AND ([p.TRANSMISSIONMAKE] = [M.TRANSMISSIONMAKE]) AND ([p.TRANSMISSIONMODEL] = [M.TRANSMISSIONMODEL]) AND ([p.MASTMAKE] = [M.MASTMAKE]) AND ([p.CONTROLPANEL] = [M.CONTROLPANEL]) AND ([p.COUNTRYCODE] = [M.COUNTRYCODE]) \" &amp; _\n\" WHERE ((([p.ENGINEMAKE])&lt;&gt;'' And ([p.ENGINEMAKE]) Is Not Null) AND (([p.equipmentmodel])&lt;&gt;'' And ([p.equipmentmodel]) Is Not Null) AND (([p.equipmentserialprefix])&lt;&gt;'' And ([p.equipmentserialprefix]) Is Not Null) AND (([M.EQUIPMENTMODEL]) Is Null) AND (([p.EQUIPMENTFUELTYPE])&lt;&gt;'' And ([p.EQUIPMENTFUELTYPE]) Is Not Null) AND (([p.ENGINEMODEL])&lt;&gt;'' And ([p.ENGINEMODEL]) Is Not Null) AND (([M.EQUIPMENTFUELTYPE]) Is Null) \" &amp; _\n\" AND (([M.EQUIPMENTSERIALPREFIX]) Is Null) AND (([M.ENGINEMODEL]) Is Null) AND (([M.ENGINEMAKE]) Is Null) AND (([p.TRANSMISSIONMAKE])&lt;&gt;'' And ([p.TRANSMISSIONMAKE]) Is Not Null) AND (([M.TRANSMISSIONMAKE]) Is Null) AND (([p.TRANSMISSIONSERIES])&lt;&gt;'' And ([p.TRANSMISSIONSERIES]) Is Not Null) AND (([M.TRANSMISSIONSERIES]) Is Null) AND (([p.TRANSMISSIONMODEL])&lt;&gt;'' And ([p.TRANSMISSIONMODEL]) Is Not Null) AND (([M.TRANSMISSIONMODEL]) Is Null) AND (([p.TRANSMISSIONTYPE])&lt;&gt;'' And ([p.TRANSMISSIONTYPE]) Is Not Null) AND (([M.TRANSMISSIONTYPE]) Is Null) AND (([p.MASTMAKE])&lt;&gt;'' And ([p.MASTMAKE]) Is Not Null) AND (([M.MASTMAKE]) Is Null) AND (([p.MASTMODEL])&lt;&gt;'' AND \" &amp; _\n\" ([p.MASTMODEL]) Is Not Null) AND (([M.MASTMODEL]) Is Null) AND (([p.CONTROLPANEL])&lt;&gt;'' And ([p.CONTROLPANEL]) Is Not Null) AND (([M.CONTROLPANEL]) Is Null) AND (([p.VOLTAGE])&lt;&gt;'' And ([p.VOLTAGE]) Is Not Null) AND (([M.VOLTAGE]) Is Null) AND (([p.COUNTRYCODE])&lt;&gt;'' And ([p.COUNTRYCODE]) Is Not Null) AND (([M.COUNTRYCODE]) Is Null) AND (([p.CAPACITY])&lt;&gt;'' And ([p.CAPACITY]) Is Not Null) AND (([M.CAPACITY]) Is Null))\"\nDebug.Print SqlQuery\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11703627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f57cccf049334acbb97e2694b9653074?s=128&d=identicon&r=PG&f=1", "display_name": "Turtlemp", "link": "https://stackoverflow.com/users/11703627/turtlemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 57294821, "answer_count": 1, "score": 1, "last_activity_date": 1564588756, "creation_date": 1564584027, "last_edit_date": 1564584145, "question_id": 57293366, "link": "https://stackoverflow.com/questions/57293366/can-not-get-sql-query-to-run-vba-and-keep-getting-errors-3131-error-in-from-clau", "title": "Can not get sql query to run VBA and keep getting errors 3131 error in from clause and 3067 Query must contain at least one table or query", "body": "<p>Trying to run a complicated left join on multiple columns and have results show up but won't run in VBA. I am a noob on this.</p>\n\n<p>I have Tried adding brackets and removed <code>iif</code> statement</p>\n\n<pre><code>SELECT DISTINCT 'Pages ID ' &amp; [p.id] &amp; ', Model ' &amp; '''' &amp; [p.equipmentmodel] &amp; '''' &amp; ', S/Prefix ' &amp; '''' &amp; [p.equipmentserialprefix] &amp; '''' &amp; ', FuelTy ' &amp; '''' &amp; [p.equipmentfueltype] &amp; '''' &amp; ', EngMake ' &amp; '''' &amp; [p.EngineMake] &amp; '''' &amp; ', Engine ' &amp; '''' &amp; [p.enginemodel] &amp; '''' &amp; ', TraMake ' &amp; '''' &amp; [p.transmissionmake] &amp; '''' &amp; ', TraSeries ' &amp; '''' &amp; [p.transmissionseries] &amp; '''' &amp; ', TraModel ' &amp; '''' &amp; [p.transmissionModel] &amp; '''' &amp; ', TranType ' &amp; '''' &amp; [p.transmissiontype] &amp; '''' &amp; ', MastMake ' &amp; '''' &amp; [p.mastmake] &amp; '''' &amp; ', Mast ' &amp; '''' &amp; [p.mastmodel] &amp; '''' &amp; ', CtrlPnl ' &amp; '''' &amp; [p.controlpanel] &amp; '''' &amp; ', Volt ' &amp; '''' &amp; [p.voltage] &amp; '''' &amp; ', CtryCode ' &amp; '''' &amp; [p.countrycode] &amp; '''' &amp; ', Capacity ' &amp; '''' &amp; [p.capacity] &amp; '''' &amp; '; not on Model tbl.' AS Expr1\") &amp; _\n(\"\n\nFROM pgs_v AS p LEFT JOIN model AS M ON ([p.CAPACITY] = [M.CAPACITY]) AND ([p.VOLTAGE] = [M.VOLTAGE]) AND ([p.MASTMODEL] = [M.MASTMODEL]) AND ([p.TRANSMISSIONTYPE] = [M.TRANSMISSIONTYPE]) AND ([p.TRANSMISSIONSERIES] = [M.TRANSMISSIONSERIES]) AND ([p.EQUIPMENTSERIALPREFIX] = [M.EQUIPMENTSERIALPREFIX]) AND ([p.EQUIPMENTMODEL] = [M.EQUIPMENTMODEL]) AND ([p.EQUIPMENTFUELTYPE] = [M.EQUIPMENTFUELTYPE]) AND ([p.ENGINEMODEL] = [M.ENGINEMODEL]) AND ([p.ENGINEMAKE] = [M.ENGINEMAKE]) AND ([p.TRANSMISSIONMAKE] = [M.TRANSMISSIONMAKE]) AND ([p.TRANSMISSIONMODEL] = [M.TRANSMISSIONMODEL]) AND ([p.MASTMAKE] = [M.MASTMAKE]) AND ([p.CONTROLPANEL] = [M.CONTROLPANEL]) AND ([p.COUNTRYCODE] = [M.COUNTRYCODE])\") &amp; _\n(\"\n\nWHERE ((([p.ENGINEMAKE])&lt;&gt;'' And ([p.ENGINEMAKE]) Is Not Null) AND (([p.equipmentmodel])&lt;&gt;'' And ([p.equipmentmodel]) Is Not Null) AND (([p.equipmentserialprefix])&lt;&gt;'' And ([p.equipmentserialprefix]) Is Not Null) AND (([M.EQUIPMENTMODEL]) Is Null) AND (([p.EQUIPMENTFUELTYPE])&lt;&gt;'' And ([p.EQUIPMENTFUELTYPE]) Is Not Null) AND (([p.ENGINEMODEL])&lt;&gt;'' And ([p.ENGINEMODEL]) Is Not Null) AND (([M.EQUIPMENTFUELTYPE]) Is Null)\") &amp; _\n(\"\n\nAND (([M.EQUIPMENTSERIALPREFIX]) Is Null) AND (([M.ENGINEMODEL]) Is Null) AND (([M.ENGINEMAKE]) Is Null) AND (([p.TRANSMISSIONMAKE])&lt;&gt;'' And ([p.TRANSMISSIONMAKE]) Is Not Null) AND (([M.TRANSMISSIONMAKE]) Is Null) AND (([p.TRANSMISSIONSERIES])&lt;&gt;'' And ([p.TRANSMISSIONSERIES]) Is Not Null) AND (([M.TRANSMISSIONSERIES]) Is Null) AND (([p.TRANSMISSIONMODEL])&lt;&gt;'' And ([p.TRANSMISSIONMODEL]) Is Not Null) AND (([M.TRANSMISSIONMODEL]) Is Null) AND (([p.TRANSMISSIONTYPE])&lt;&gt;'' And ([p.TRANSMISSIONTYPE]) Is Not Null) AND (([M.TRANSMISSIONTYPE]) Is Null) AND (([p.MASTMAKE])&lt;&gt;'' And ([p.MASTMAKE]) Is Not Null) AND (([M.MASTMAKE]) Is Null) AND (([p.MASTMODEL])&lt;&gt;'' And\") &amp; _\n (\"\n\n ([p.MASTMODEL]) Is Not Null) AND (([M.MASTMODEL]) Is Null) AND (([p.CONTROLPANEL])&lt;&gt;'' And ([p.CONTROLPANEL]) Is Not Null) AND (([M.CONTROLPANEL]) Is Null) AND (([p.VOLTAGE])&lt;&gt;'' And ([p.VOLTAGE]) Is Not Null) AND (([M.VOLTAGE]) Is Null) AND (([p.COUNTRYCODE])&lt;&gt;'' And ([p.COUNTRYCODE]) Is Not Null) AND (([M.COUNTRYCODE]) Is Null) AND (([p.CAPACITY])&lt;&gt;'' And ([p.CAPACITY]) Is Not Null) AND (([M.CAPACITY]) Is Null))\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016", "msgbox"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1564583935, "post_id": 57293253, "comment_id": 101080973, "body": "With a UserForm, you can create your own &quot;message box&quot; with far more robust ability to control font size, style, etc."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1564584011, "post_id": 57293253, "comment_id": 101081032, "body": "Likewise, you have far more control over button placement, button text, etc."}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1564589816, "post_id": 57293253, "comment_id": 101084418, "body": "There&#39;s a reason why you can&#39;t modify a messagebox&#39;s appearance: it&#39;s uniform across all Windows applications and even Windows itself. So users are presented with a common familiar UI widget. The messagebox also honors the user&#39;s (Windows) UI settings. So unless there&#39;s a real good reason to &quot;go fancy&quot;, use the messagebox &quot;as is&quot;. If the <i>information</i> you want to present via a messagebox needs a different layout, a user form is better choice in the first place."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1564650643, "post_id": 57293253, "comment_id": 101103829, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39408720/vba-change-the-text-color-in-msgbox\">VBA Change the text color in MsgBox</a>"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1564583914, "creation_date": 1564583914, "answer_id": 57293333, "question_id": 57293253, "link": "https://stackoverflow.com/questions/57293253/options-of-message-box-in-excel/57293333#57293333", "title": "Options of message box in Excel", "body": "<p>Easy answer: You can't. </p>\n\n<p>That's why you can't find anything about it in the official documentation of the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/msgbox-function\" rel=\"nofollow noreferrer\">MsgBox function</a>.</p>\n\n<p>A workaround can be to create your own UserForm where you are free in how to style it.</p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1564584294, "creation_date": 1564584294, "answer_id": 57293460, "question_id": 57293253, "link": "https://stackoverflow.com/questions/57293253/options-of-message-box-in-excel/57293460#57293460", "title": "Options of message box in Excel", "body": "<p>Add a UserForm in your workbook's code module, and configure it with as many Label and CommandButton controls as needed. </p>\n\n<p><a href=\"https://i.stack.imgur.com/yd5sH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yd5sH.png\" alt=\"enter image description here\"></a></p>\n\n<p>If the label text will be static, you can configure these all through the Properties window in the IDE:</p>\n\n<p><a href=\"https://i.stack.imgur.com/O6Ug6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O6Ug6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Labels, Command Buttons, etc., are accessible <em>Controls</em> on the UserForm, and can be altered dynamically during runtime if needed, e.g., during the form's <code>Initialize</code> or <code>Activate</code> or any other event handlers. Controls on the form can even alter other controls, for example you could leverage the command button's <code>Click</code> event handler to modify the text associated with <code>Label1</code> control, etc.</p>\n\n<p>You can even add (or remove) controls (labels and such) dynamically, too, and fully control their appearance/formatting/etc.</p>\n"}], "owner": {"reputation": 3, "user_id": 11426165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b8410388ea66a24c33b78ef2976958?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Kidd", "link": "https://stackoverflow.com/users/11426165/alan-kidd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2113, "favorite_count": 0, "accepted_answer_id": 57293333, "answer_count": 2, "score": 0, "last_activity_date": 1564584549, "creation_date": 1564583673, "last_edit_date": 1564584098, "question_id": 57293253, "link": "https://stackoverflow.com/questions/57293253/options-of-message-box-in-excel", "title": "Options of message box in Excel", "body": "<p>We would like to change the font, color and size of the text displayed in message boxes.</p>\n\n<p>Can/how do you VBA this?</p>\n\n<p>Nothing tried, we are not finding any help in online manuals, including the Microsoft help site.</p>\n\n<p>We would like to make the message box big, bold and loud.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1564583840, "post_id": 57293004, "comment_id": 101080904, "body": "So you&#39;re working on assessing if the <code>Cells(i,1).Value</code>, split into an array based on &quot; &quot;, to see if any of those values are captured in <code>Cells(i,2).Value</code>?  Or are you wanting to ensure that all are found?  As this is tied to VBA, what <i>have</i> you put together (you talk about <code>regex</code> but have no attempt at using it in your post)?  Remembering that this is not a code-for-you service and is not the appropriate forum for a discussion, conversation, please provide your code so a specific, objective answer can be provided to an exact and specific question which you are asking."}, {"owner": {"reputation": 700, "user_id": 6274595, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/fbccb62f5faf92749bd3183879fbd21e?s=128&d=identicon&r=PG&f=1", "display_name": "PL200", "link": "https://stackoverflow.com/users/6274595/pl200"}, "edited": false, "score": 0, "creation_date": 1564583928, "post_id": 57293004, "comment_id": 101080963, "body": "Hi, you should show what you have tried so far, so that others may assist you."}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 0, "creation_date": 1564589849, "post_id": 57293004, "comment_id": 101084444, "body": "It seems it might be helpful to organize your conditions a bit better. I have code that seems like I could modify it to suit your need, but I need a much better understanding of what you&#39;re trying to achieve here."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11864344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0fc97cdb5c0024d26e230f80bd0c31e?s=128&d=identicon&r=PG&f=1", "display_name": "New2Coding", "link": "https://stackoverflow.com/users/11864344/new2coding"}, "edited": false, "score": 0, "creation_date": 1564681156, "post_id": 57306694, "comment_id": 101120622, "body": "Thank you very much &quot;Ahmed AU&quot; for the solution! We were trying create a code with State machine looking for each and every character and then deciding the logic, but it was getting a bit complicated because of lots of possible combinations. I really liked your approach of  making the decision based on Boolean data. Thanks again!"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 13, "user_id": 11864344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0fc97cdb5c0024d26e230f80bd0c31e?s=128&d=identicon&r=PG&f=1", "display_name": "New2Coding", "link": "https://stackoverflow.com/users/11864344/new2coding"}, "edited": false, "score": 0, "creation_date": 1564681484, "post_id": 57306694, "comment_id": 101120770, "body": "Welcome, You made my day.  Hope for success.."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 13, "user_id": 11864344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0fc97cdb5c0024d26e230f80bd0c31e?s=128&d=identicon&r=PG&f=1", "display_name": "New2Coding", "link": "https://stackoverflow.com/users/11864344/new2coding"}, "edited": false, "score": 0, "creation_date": 1564705163, "post_id": 57306694, "comment_id": 101128116, "body": "Please refer to @Tim Williams <a href=\"https://stackoverflow.com/questions/57311216/is-vba-compilation-of-changing-code-is-responsible-for-wrong-results-in-a-loop/57315422#57315422\">answer</a> to my question for his brilliant &amp; further improved solution.."}, {"owner": {"reputation": 13, "user_id": 11864344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0fc97cdb5c0024d26e230f80bd0c31e?s=128&d=identicon&r=PG&f=1", "display_name": "New2Coding", "link": "https://stackoverflow.com/users/11864344/new2coding"}, "edited": false, "score": 0, "creation_date": 1565019513, "post_id": 57306694, "comment_id": 101210371, "body": "Thank you very much Tim Williams and @Ahmed AU for taking time and providing the solution. It took a while for me to understand what&#39;s code since I&#39;m new to this stuff."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1564654671, "last_edit_date": 1564654671, "creation_date": 1564654263, "answer_id": 57306694, "question_id": 57293004, "link": "https://stackoverflow.com/questions/57293004/macro-to-analyze-and-evaluate-a-string-with-respect-to-data-in-different-cell/57306694#57306694", "title": "Macro to Analyze and Evaluate a String with respect to Data in different cell", "body": "<p>Welcome to SO. Thanks and congratulation  for a good question.  There may be other parsing method for converting the condition string as workable formula, I opted for a simple parsing method and somehow out way approach to use the formula in VBA itself. Solution needs Reference  to \"Microsoft Visual Basic for extensibility\" \u2026 to be added (in VBA Project window  -> Tools-> Reference \u2013> and then add).</p>\n\n<p>It is assumed the conditions in column B is consistent and single space is between all the operators. However code could be modified for little changes in condition syntax. Sheet name, Row &amp; Column details may please be modified for actual requirement.</p>\n\n<p>The tested code:</p>\n\n<pre><code>Option Explicit\nSub test3()\nDim TestStr As String\nDim CondStr As String, xFormula As String, iFormula As String\nDim Arr As Variant, VBstr As String\nDim i As Integer, Srw As Long, Lrw As Long, Rw As Long\nDim Ws As Worksheet, Wb As Workbook, Rslt As Boolean, vbc As VBComponent\nSet Ws = ThisWorkbook.ActiveSheet\n\nSet Wb = Workbooks.Add\nSet vbc = Wb.VBProject.VBComponents.Add(vbext_ct_StdModule)\n\nSrw = 1\nLrw = Ws.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor Rw = Srw To Lrw\n'TestStr = \"AAA BBB DDD EEE GGG HHH A11 B11 C11 1A1 1AB AA0\"\n'TestStr = \"AAA BBB EEE GGG HHH A11 B11 C11 1A1 1AB AA0\"\nTestStr = Ws.Cells(Rw, 1).Value\n\n'CondStr = \"( AAA + BBB + ( CCC | DDD ) + ( EEE + ! FFF ) ) | ( GGG + HHH + DDD + EEE + FFF )\"\nCondStr = Ws.Cells(Rw, 2).Value\n\nArr = Split(CondStr, \" \")\nVBstr = \"\"\n    For i = LBound(Arr) To UBound(Arr)\n    xFormula = Trim(Arr(i))\n    Select Case xFormula\n    Case \"\"\n    iFormula = \"\"\n    Case \"(\", \")\"\n    iFormula = Arr(i)\n    Case \"+\"\n    iFormula = \" And \"\n    Case \"|\"\n    iFormula = \" OR \"\n    Case \"!\"\n    iFormula = \" Not \"\n    Case Else\n    iFormula = (InStr(1, TestStr, xFormula) &gt; 0)\n    End Select\n    VBstr = VBstr &amp; iFormula\n    Next i\nVBstr = \"X = \" &amp; VBstr\nDebug.Print Rw &amp; VBstr\n\n\nDim StrLine As Long, LineCnt As Long\nWith vbc.CodeModule\nOn Error Resume Next\nStrLine = .ProcBodyLine(\"VersatileCode\", vbext_pk_Proc)\nLineCnt = .ProcCountLines(\"VersatileCode\", vbext_pk_Proc)\n.DeleteLines StrLine, LineCnt\nOn Error GoTo 0\n.InsertLines StrLine + 1, \"Sub VersatileCode()\"\n.InsertLines StrLine + 2, VBstr\n.InsertLines StrLine + 3, \"ThisWorkbook.Sheets(1).cells(1,1).value = X\"\n.InsertLines StrLine + 4, \"End Sub\"\nEnd With\nDoEvents\nApplication.Run Wb.Name &amp; \"!VersatileCode\"\nDoEvents\n\nRslt = Wb.Sheets(1).Cells(1, 1).Value\nDebug.Print Rslt\n\n    If Rslt = True Then\n    Ws.Cells(Rw, 4).Value = Ws.Cells(Rw, 3).Value\n    Else\n    Ws.Cells(Rw, 4).Value = 0\n    End If\nNext Rw\nWb.Close False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11864344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0fc97cdb5c0024d26e230f80bd0c31e?s=128&d=identicon&r=PG&f=1", "display_name": "New2Coding", "link": "https://stackoverflow.com/users/11864344/new2coding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1564668874, "accepted_answer_id": 57306694, "answer_count": 1, "score": 1, "last_activity_date": 1564654671, "creation_date": 1564582833, "last_edit_date": 1564583213, "question_id": 57293004, "link": "https://stackoverflow.com/questions/57293004/macro-to-analyze-and-evaluate-a-string-with-respect-to-data-in-different-cell", "closed_reason": "Needs details or clarity", "title": "Macro to Analyze and Evaluate a String with respect to Data in different cell", "body": "<p>I have a list of \u201cData Codes\u201d in - Column A, \"Conditions\u201d in - Column B and Numeric Values in \u201cColumn C\u201d. I\u2019m in need of a VBA code which verifies the condition in column B with respect to Data codes in column A and if the condition is true then update Column D with same values as column C or else put zero in Column D and repeat this process until the last data cell in Column A. I came across VBA RegEx, but I don't really know how can I use it to solve the problem? </p>\n\n<p>Any Help is appreciated!</p>\n\n<p>Example:-\nData Codes in Cell <code>\"A1\" = \"AAA BBB DDD EEE GGG HHH A11 B11 C11 1A1 1AB AA0\"</code></p>\n\n<p>Condition in Cell <code>\"B1\" = \"( AAA + BBB + ( CCC | DDD ) + ( EEE + ! FFF ) ) | ( GGG + HHH + DDD + EEE + FFF )\"</code></p>\n\n<p>Value in Cell <code>\"C1\" = \"5\"</code></p>\n\n<p>The Macro shall update Cell <code>\"D1\" = \"5\"</code> - Since the condition is true - \u201cA1\u201d has <code>AAA, BBB, DDD, EEE and \"NOT FFF\"</code></p>\n\n<p>Data Codes in Cell <code>\"A2\" = \"AAA BBB DDD EEE GGG HHH A11 B11 C11 1A1 1AB AA0\"</code>\nCondition in Cell <code>\"B1\" = \"( AAA + BBB + ( CCC | DDD ) + ( ! EEE + ! FFF ) ) | ( GGG + HHH + DDD + EEE + FFF )\"</code>\nValue in Cell <code>\"C2\" = \"3\"</code>\nThe Macro shall update Cell <code>\"D2\" = \"0\"</code>, Since the condition is false - \u201cA1\u201d has <code>\"EEE\"</code> and doesn\u2019t have <code>\"FFF\"</code></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1564582907, "post_id": 57292971, "comment_id": 101080307, "body": "Can you share some sample input/table and what you would want this result to look like. It&#39;s not clear from just your text."}, {"owner": {"reputation": 1, "user_id": 11788241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed7ca624135d84ebbb4e138e9f4b242?s=128&d=identicon&r=PG&f=1", "display_name": "gsaez", "link": "https://stackoverflow.com/users/11788241/gsaez"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1564622307, "post_id": 57292971, "comment_id": 101094893, "body": "Sub Stock_Values()    Dim Ticker As String    Dim Stock_Total As Double   Stock_Total = 0   Dim Summary_Table_Row As Integer   Summary_Table_Row = 2    For i = 2 To 760191   If Cells(i + 1, 1).Value &lt;&gt; Cells(i, 1).Value Then            Ticker = Cells(i, 1).Value            Stock_Total = Stock_Total + Cells(i, 7).Value            Range(&quot;J&quot; &amp; Summary_Table_Row).Value = Ticker            Range(&quot;K&quot; &amp; Summary_Table_Row).Value = Stock_Total            Summary_Table_Row = Summary_Table_Row + 1 Stock_Total = 0 Else Stock_Total = Stock_Total + Cells(i, 7).Value End If Next i End Sub"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1564666571, "post_id": 57292971, "comment_id": 101112823, "body": "Please edit your question and paste the code in. Highlight what was pasted and click the <code>{}</code> button at the top to format as code. It&#39;s unreadable in a comment."}], "owner": {"reputation": 1, "user_id": 11788241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed7ca624135d84ebbb4e138e9f4b242?s=128&d=identicon&r=PG&f=1", "display_name": "gsaez", "link": "https://stackoverflow.com/users/11788241/gsaez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564582746, "creation_date": 1564582746, "question_id": 57292971, "link": "https://stackoverflow.com/questions/57292971/how-can-i-create-a-list-that-add-values-from-a-table-located-in-the-same-sheet-b", "title": "How can I create a list that add values from a table located in the same sheet but with different location", "body": "<p>I want to create a table that allows me to extract information from a table located in the same sheet but this new table is able to add similar values (All letters A with its respective volume, which is located in the following column)</p>\n\n<p>I've tried to create a table that extract the data but I connot make a sum of the similar values (the same thing that a pivot table does)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1564582581, "post_id": 57292839, "comment_id": 101080092, "body": "In your nested <code>For z = 9 to lastRow</code>, I&#39;m pretty sure you can remove that and just do <code>Range(Cells(9,i),cells(lastRow,i)).Value = Range(Cells(9,i),cells(lastRow,i)).Value</code> and set those all in one go.  Also, you can use <code>Else If</code>, instead of <code>End If</code>, since with <code>If &#47; ... &#47; End If &#47; If &#47; ... &#47; End If</code>will check every <code>If</code> condition.  Assuming a cell is one value, you could do <code>If [cell].Value = &quot;Banana&quot; Then &#47; [that range formula above] &#47; ElseIf [cell].Value = &quot;Apple&quot; &#47; ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1564584126, "post_id": 57293136, "comment_id": 101081114, "body": "Clever using <code>Match()</code>.  You could also change that <code>For</code> loop and just have a one line <code>Range(Cells(7, i), Cells(lastRow, i)).Value = Range(Cells(7, i), Cells(lastRow, i)).Value</code>"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1564584778, "post_id": 57293136, "comment_id": 101081562, "body": "@BruceWayne Nice one! It would be even more efficient then."}, {"owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1564587138, "post_id": 57293136, "comment_id": 101082942, "body": "Per Bruce&#39;s suggestion, I added it in yet am having an Object not defined error. To test out where the error would be, I replaced <code>Range(Cells(9, i), Cells(lastrow, i))</code> with <code>Range(&quot;F1:F48&quot;)</code> and it ran without an error. So it seems like defining range with the cells seems to be throwing an issue. Any idea as to why? @BruceWayne @JustynaMK"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "edited": false, "score": 3, "creation_date": 1564587313, "post_id": 57293136, "comment_id": 101083041, "body": "@tokyo_north You&#39;ll get that error if <code>Sheet1</code> is NOT your currently active sheet.  This is because you don&#39;t fully qualify your <code>Cells</code> references inside the <code>Range</code> argument, which makes the <code>Cells</code> default to the ActiveSheet.  Because <code>Range</code> is qualified to <code>Sheet1</code> and <code>Cells</code> are defaulting to ActiveSheet, if you have a different sheet selected you&#39;ll end up with that error."}, {"owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1564588458, "post_id": 57293136, "comment_id": 101083693, "body": "@tigeravatar +1. I didn&#39;t have the sheet activated either, which was an issue. But thanks to all who helped. This proves to be very efficient."}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": true, "score": 3, "last_activity_date": 1564584959, "last_edit_date": 1564584959, "creation_date": 1564583312, "answer_id": 57293136, "question_id": 57292839, "link": "https://stackoverflow.com/questions/57292839/most-efficient-way-to-loop-thru-a-column-searching-for-a-specific-values/57293136#57293136", "title": "Most efficient way to loop thru a column searching for a specific values", "body": "<p>You can use an array of search words (<code>arrWords</code>) as an alternative solution, and then check if a given header (<code>Cells(7,i).Value</code>) belongs to this array (<code>Application.Match</code>):</p>\n\n<pre><code>Sub foo()\n    Dim lastcol As Long, lastrow As Long, z As Long\n    Dim arrWords As Variant\n\n    arrWords = Array(\"Banana\", \"Apple\", \"Coconut\", \"Kiwi\", \"Watermelon\", \"Orange\")\n    lastcol = Sheets(\"Sheet1\").Cells(7, Columns.Count).End(xlToLeft).Column\n    lastrow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 5 To lastcol\n        If Not IsError(Application.Match(Sheets(\"Sheet1\").Cells(7, i).Value, arrWords, 0)) Then\n            For z = 9 To lastrow\n                Sheets(\"Sheet1\").Cells(z, i).Value = Sheets(\"Sheet1\").Cells(z, i).Value\n            Next z\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>As per Bruce's suggestion, you can also replace your whole <code>For z = 9 to lastrow ... Next z</code> loop with one line:</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(Cells(9, i), Cells(lastrow, i)).Value = Sheets(\"Sheet1\").Range(Cells(9, i), Cells(lastrow, i)).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1564585949, "last_edit_date": 1564585949, "creation_date": 1564584065, "answer_id": 57293377, "question_id": 57292839, "link": "https://stackoverflow.com/questions/57292839/most-efficient-way-to-loop-thru-a-column-searching-for-a-specific-values/57293377#57293377", "title": "Most efficient way to loop thru a column searching for a specific values", "body": "<p>You could use an array, and check the value of the array.</p>\n\n<p>This is a little longer than @JustynaMK's answer, but I was working on it before they posted their, so figure I'll go ahead and post.</p>\n\n<pre><code>Option Explicit\n\nSub replace_formulas()\nDim keys() As Variant\nDim keyWords As String\n\nDim ws As Worksheet\nSet ws = Worksheets(\"Sheet1\")\n\nkeys = Array(\"Banana\", \"Apple\", \"Coconut\", \"Kiwi\", \"Watermelon\", \"Orange\")\nkeyWords = joinArray(keys, \"#\")\n\nDim headerRow As Long, startCol As Long\nheaderRow = 7\nstartCol = 5\n\nDim lastCol As Long, lastRow As Long\nlastCol = ws.Cells(headerRow, Columns.Count).End(xlToLeft).Column\n' I changed this to Column 5 to get the lastRow, but change as needed\nlastRow = ws.Cells(Rows.Count, startCol).End(xlUp).Row\n\nDim headers As Range\nSet headers = ws.Range(ws.Cells(headerRow, startCol), ws.Cells(headerRow, lastCol))\n\nDim cel As Range\nWith ws\n    For Each cel In headers\n        If InStr(1, keyWords, \"#\" &amp; cel.Value &amp; \"#\", vbTextCompare) Then\n            .Range(.Cells(headerRow, cel.Column), .Cells(lastRow, cel.Column)).Value = _\n            .Range(.Cells(headerRow, cel.Column), .Cells(lastRow, cel.Column)).Value\n        End If\n    Next cel\nEnd With\n\nEnd Sub\n\nFunction joinArray(arr As Variant, delim As String) As String\n'https://stackoverflow.com/a/11112615/4650297\nDim strg As String\nstrg = Join(arr, delim)\njoinArray = delim &amp; strg\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2261, "user_id": 8544123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f32b871be77d8c71efc294359b300367?s=128&d=identicon&r=PG&f=1", "display_name": "Acccumulation", "link": "https://stackoverflow.com/users/8544123/acccumulation"}, "is_accepted": false, "score": 0, "last_activity_date": 1564588014, "creation_date": 1564588014, "answer_id": 57294610, "question_id": 57292839, "link": "https://stackoverflow.com/questions/57292839/most-efficient-way-to-loop-thru-a-column-searching-for-a-specific-values/57294610#57294610", "title": "Most efficient way to loop thru a column searching for a specific values", "body": "<p>If you store your list as an array on a sheet, then there are a variety of ways of testing whether something is in the list.</p>\n\n<p>A1 = apple A2 = banana A3 = missing B1 = TRUE B2 = TRUE B3 = FALSE</p>\n\n<p><code>=ISNUMBER(MATCH(\"apple\",A1:A2,0))</code> returns TRUE</p>\n\n<p><code>=ISNUMBER(MATCH(\"orange\",A1:A2,0))</code> returns FALSE</p>\n\n<p><code>=vlookup(\"apple\",A1:A3,1)=\"apple\"</code> returns TRUE. </p>\n\n<p><code>=vlookup(\"orange\",A1:A3,1)=\"orange\"</code> returns FALSE. </p>\n\n<p><code>=not(vlookup(\"apple\",A1:A3,1)=\"missing\")</code> returns TRUE. </p>\n\n<p><code>=not(vlookup(\"orange\",A1:A3,1)=\"missing\")</code> returns FALSE. </p>\n\n<p><code>=vlookup(\"apple\",A1:B3,2)</code> returns TRUE. </p>\n\n<p><code>=vlookup(\"orange\",A1:B3,2)</code> returns FALSE. </p>\n"}], "owner": {"reputation": 105, "user_id": 11595922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ff5f0abcc6a9e22b54df381f080164?s=128&d=identicon&r=PG&f=1", "display_name": "tokyo_north", "link": "https://stackoverflow.com/users/11595922/tokyo-north"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57293136, "answer_count": 3, "score": 0, "last_activity_date": 1564588014, "creation_date": 1564582347, "question_id": 57292839, "link": "https://stackoverflow.com/questions/57292839/most-efficient-way-to-loop-thru-a-column-searching-for-a-specific-values", "title": "Most efficient way to loop thru a column searching for a specific values", "body": "<p>I have some code that I want to search thru a row of column names (row 7) and identify whether or not the column name is part of a list I have. If it detects that it is part of the list, then it will go down that column and convert the formulas to values by doing <code>Sheet.Range.Value=Sheet.Range.Value</code>. </p>\n\n<p>For example, if it detects the word Apple or Banana, it will loop thru the column and convert the formulas into values.</p>\n\n<p>However, I have found that this probably isn't the most efficient way to achieve this. I have the code listed below. Does anyone know how to make this more efficient?</p>\n\n<pre><code>Dim lastcol, lastrow As Long\n\n    lastcol = Sheets(\"Sheet1\").Cells(7, Columns.Count).End(xlToLeft).Column\n    lastrow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n    Dim z\n    For i = 5 To lastcol\n        If Sheets(\"Sheet1\").Cells(7, i).value = \"Banana\" Then\n            For z = 9 To lastrow\n                Sheets(\"Sheet1\").Cells(z, i).value = Sheets(\"Sheet1\").Cells(z, i).value\n            Next z\n        End If\n        If Sheets(\"Sheet1\").Cells(7, i).value = \"Apple\" Then\n            For z = 9 To lastrow\n                Sheets(\"Sheet1\").Cells(z, i).value = Sheets(\"Sheet1\").Cells(z, i).value\n            Next z\n        End If\n        If Sheets(\"Sheet1\").Cells(7, i).value = \"Coconut\" Then\n            For z = 9 To lastrow\n                Sheets(\"Sheet1\").Cells(z, i).value = Sheets(\"Sheet1\").Cells(z, i).value\n            Next z\n        End If\n        If Sheets(\"Sheet1\").Cells(7, i).value = \"Kiwi\" Then\n            For z = 9 To lastrow\n                Sheets(\"Sheet1\").Cells(z, i).value = Sheets(\"Sheet1\").Cells(z, i).value\n            Next z\n        End If\n        If Sheets(\"Sheet1\").Cells(7, i).value = \"Watermelon\" Then\n            For z = 9 To lastrow\n                Sheets(\"Sheet1\").Cells(z, i).value = Sheets(\"Sheet1\").Cells(z, i).value\n            Next z\n        End If\n        If Sheets(\"Sheet1\").Cells(7, i).value = \"Orange\" Then\n            For z = 9 To lastrow\n                Sheets(\"Sheet1\").Cells(z, i).value = Sheets(\"Sheet1\").Cells(z, i).value\n            Next z\n        End If\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "api", "catia"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6330087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3d385ee9dd374e065154a6a6d2f5b2?s=128&d=identicon&r=PG&f=1", "display_name": "h.sabatou", "link": "https://stackoverflow.com/users/6330087/h-sabatou"}, "is_accepted": false, "score": 0, "last_activity_date": 1564650813, "creation_date": 1564650813, "answer_id": 57305585, "question_id": 57292321, "link": "https://stackoverflow.com/questions/57292321/select-folder-using-shbrowseforfoldera-does-not-work-on-windows-10-platform/57305585#57305585", "title": "Select Folder using SHBrowseForFolderA does not work on windows 10 platform", "body": "<p>I have finaly found how to solve this issue.\nThe declaration was not correct</p>\n\n<p>Here is the good declaration</p>\n\n<pre><code>'API Declares\n\n    Public Declare PtrSafe Function SendMessageA Lib \"user32\" (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, lParam As Any) As LongPtr\n    Private Declare PtrSafe Function SHBrowseForFolder Lib \"shell32.dll\" Alias \"SHBrowseForFolderA\" (lpBrowseInfo As BROWSEINFO) As LongPtr\n    Private Declare PtrSafe Function SHGetPathFromIDList Lib \"shell32.dll\" Alias \"SHGetPathFromIDListA\" (ByVal pidList As LongPtr, ByVal lpBuffer As String) As Boolean\n    Private Declare PtrSafe Sub CoTaskMemFree Lib \"ole32.dll\" (ByVal hMem As LongPtr)\n\n'BrowseInfo Type\n    Public Type BROWSEINFO\n        hWndOwner As LongPtr\n        pidlRoot As LongPtr\n        pszDisplayName As String\n        lpszTitle As String\n        ulFlags As Long\n        lpfnCallback As LongPtr\n        lParam As LongPtr\n        iImage As Long\n    End Type\n</code></pre>\n\n<p>regards</p>\n"}], "owner": {"reputation": 21, "user_id": 6330087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3d385ee9dd374e065154a6a6d2f5b2?s=128&d=identicon&r=PG&f=1", "display_name": "h.sabatou", "link": "https://stackoverflow.com/users/6330087/h-sabatou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564650813, "creation_date": 1564580809, "question_id": 57292321, "link": "https://stackoverflow.com/questions/57292321/select-folder-using-shbrowseforfoldera-does-not-work-on-windows-10-platform", "title": "Select Folder using SHBrowseForFolderA does not work on windows 10 platform", "body": "<p>I have a vba7 macro which use a folder select box base on windows api.\nThis code use SHBrowseForFolderA, SendMessageA, SHGetPathFromIDListA APIs</p>\n\n<p>Upto now this code run perfectly on Windows 7 x64 platform.\nThis code crash when I run it on win 10 x64 platform.</p>\n\n<pre><code>    'API Declares\n    Public Declare PtrSafe Function SendMessageA Lib \"user32\" (ByVal hWnd   As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, lParam As Any) As LongPtr\n    Private Declare PtrSafe Function SHBrowseForFolderA Lib \"shell32.dll\" (lpBrowseInfo As BrowseInfo) As Long\n    Private Declare PtrSafe Function SHGetPathFromIDListA Lib \"shell32.dll\" (ByVal pidList As Long, ByVal lpBuffer As String) As Long\n    Private Declare PtrSafe Sub CoTaskMemFree Lib \"ole32.dll\" (ByVal hMem As Long)\n\n\n\n    Public Function FolderBrowse(ByVal sDialogTitle As String, ByVal sPath As String) As String\n  Dim ReturnPath As String\n\n  Dim b(MAX_PATH) As Byte\n  Dim pItem       As Long\n  Dim sFullPath   As String\n  Dim bi          As BrowseInfo\n  Dim ppidl       As Long\n\n  sPath = CorrectPath(sPath)\n\n  bi.hWndOwner = 0 'Screen.ActiveForm.hwnd\n\n  'SHGetSpecialFolderLocation bi.hWndOwner, CSIDL_DRIVES, ppidl\n\n  bi.pIDLRoot = 0 'ppidl\n\n  bi.pszDisplayName = VarPtr(b(0))\n  bi.lpszTitle = sDialogTitle\n  bi.ulFlags = BF_Flags.BIF_RETURNONLYFSDIRS + BF_Flags.BIF_NEWDIALOGSTYLE + BF_Flags.BIF_STATUSTEXT              'BIF_RETURNONLYFSDIRS\n  'bi.ulFlags = BF_Flags.BIF_RETURNONLYFSDIRS + BF_Flags.BIF_USENEWUI + BF_Flags.BIF_STATUSTEXT             'BIF_RETURNONLYFSDIRS\n\n  If FolderExists(sPath) Then bi.lpfnCallback = PtrToFunction(AddressOf BFFCallback)\n  bi.lParam = StrPtr(sPath)\n\n\n\n  pItem = SHBrowseForFolderA(bi)\n\n  If pItem Then ' Succeeded\n    sFullPath = Space$(MAX_PATH)\n    If SHGetPathFromIDListA(pItem, sFullPath) Then\n      ReturnPath = Left$(sFullPath, InStr(sFullPath, vbNullChar) - 1) ' Strip nulls\n      CoTaskMemFree pItem\n    End If\n  End If\n\n'  If pItem &lt;&gt; 0 Then ' Succeeded\n'    sFullPath = Space$(MAX_PATH_Unicode)\n'    If SHGetPathFromIDListW(pItem, StrPtr(sFullPath)) Then\n'      ReturnPath = Left$(sFullPath, InStr(sFullPath, vbNullChar) - 1) ' Strip nulls\n'      CoTaskMemFree pItem 'nettoyage\n'    End If\n'  End If\n\n  If Right$(ReturnPath, 1) &lt;&gt; \"\\\" And ReturnPath &lt;&gt; \"\" Then  'Could be \"C:\"\n    FolderBrowse = ReturnPath &amp; \"\\\"\n  End If\n\n'If Right$(ReturnPath, 1) &lt;&gt; \"\\\" And ReturnPath &lt;&gt; \"\" Then  'Could be \"C:\"\n'    FolderBrowse = ReturnPath &amp; \"\\\"\n'  End If\n\nEnd Function\n</code></pre>\n\n<p>I don't have any error message\nJust Catia application is frozen.</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1564581069, "post_id": 57292157, "comment_id": 101079061, "body": "You can load the text into a string and execute it.  For queries that don&#39;t return records you can use <code>[Connection Object].Execute</code>"}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 11492891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b428e69e63e6d545c8ede828ead33e3?s=128&d=identicon&r=PG&f=1", "display_name": "Keenan B", "link": "https://stackoverflow.com/users/11492891/keenan-b"}, "is_accepted": false, "score": 2, "last_activity_date": 1564580851, "creation_date": 1564580851, "answer_id": 57292332, "question_id": 57292157, "link": "https://stackoverflow.com/questions/57292157/how-do-i-execute-a-sql-script-from-excel-using-vba/57292332#57292332", "title": "How do I execute a sql script from excel using VBA", "body": "<p>You could try executing SQL stored procedures from VBA. I can imagine it isn't very different from executing a SQL query.</p>\n\n<pre><code>Set mobjConn = New ADODB.Connection\nmobjConn.Open \"your connection string\"\nSet mobjCmd = New ADODB.Command\nWith mobjCmd\n    .ActiveConnection = Me.Connection\n    .CommandText = \"your stored procedure\"\n    .CommandType = adCmdStoredProc\n    .CommandTimeout = 0\n    .Parameters.Append .CreateParameter(\"your parameter name\", adInteger, adParamInput, , your parameter value)\n    ' repeat as many times as you have parameters\n\n    .Execute\nEnd With\n</code></pre>\n\n<p>Found from The Dumb Radish <a href=\"https://stackoverflow.com/questions/24267080/calling-stored-procedure-vba\">Calling stored procedure VBA</a></p>\n\n<p>Another option may be storing strings (SQL Queries) in a text file and loading them into a VBA array and executing them. </p>\n"}, {"tags": [], "owner": {"reputation": 505, "user_id": 9204831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KwPAL.png?s=128&g=1", "display_name": "Lodi", "link": "https://stackoverflow.com/users/9204831/lodi"}, "is_accepted": false, "score": 0, "last_activity_date": 1564581239, "creation_date": 1564581239, "answer_id": 57292455, "question_id": 57292157, "link": "https://stackoverflow.com/questions/57292157/how-do-i-execute-a-sql-script-from-excel-using-vba/57292455#57292455", "title": "How do I execute a sql script from excel using VBA", "body": "<p>You could download SQL Server's \"sqlcmd\" Utility\n(read more on <a href=\"https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-2017\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-2017</a>)</p>\n\n<p>With it, you can run *.sql scripts from command line...</p>\n\n<p>Then, in your VBA Code, you could use the <code>Shell</code> procedure</p>\n\n<p><code>current_query = Shell(\"sqlcmd -S &lt;server Name&gt; -U sa -P sapassword -i inputquery_file_name -o outputfile_name\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11136218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dotJOSFDTC0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxMDqBXWHAZE_gSlYYaAlAu6IgxQ/mo/photo.jpg?sz=128", "display_name": "Roy Taylor", "link": "https://stackoverflow.com/users/11136218/roy-taylor"}, "is_accepted": false, "score": 1, "last_activity_date": 1564585296, "creation_date": 1564585296, "answer_id": 57293780, "question_id": 57292157, "link": "https://stackoverflow.com/questions/57292157/how-do-i-execute-a-sql-script-from-excel-using-vba/57293780#57293780", "title": "How do I execute a sql script from excel using VBA", "body": "<p>Many thanks for the replies.  I'm getting round it with:</p>\n\n<pre><code>Sub Run_my_sql()\nDim con As ADODB.Connection\nDim ConnectionString As String\nDim SQL_Commands As Variant\nDim SQL_String As Variant\nDim strFilename As String: strFilename = \"C:\\folder_name\\my_sql_file.sql\"\nDim iFile As Integer: iFile = FreeFile\n\nSet con = New ADODB.Connection\nSet recset = New ADODB.Recordset\n\nConnectionString = \"xxxx.1;User ID=xxx_xxxxx_xxxx;password=xxxxxxxx;Data Source=xxxxxxx\"\n\ncon.Open ConnectionString\n\n\nOpen strFilename For Input As #iFile\nSQL_String = Input(LOF(iFile), iFile)\nClose #iFile\n\nSQL_Commands = Split(SQL_String, \";\")\nFor Each SQL_String In SQL_Commands\n    con.Execute SQL_String\nNext SQL_String\n\ncon.Close\nEnd Sub\n</code></pre>\n\n<p>at the moment.</p>\n"}], "owner": {"reputation": 11, "user_id": 11136218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dotJOSFDTC0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcxMDqBXWHAZE_gSlYYaAlAu6IgxQ/mo/photo.jpg?sz=128", "display_name": "Roy Taylor", "link": "https://stackoverflow.com/users/11136218/roy-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3772, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1564598741, "creation_date": 1564580319, "last_edit_date": 1564598741, "question_id": 57292157, "link": "https://stackoverflow.com/questions/57292157/how-do-i-execute-a-sql-script-from-excel-using-vba", "title": "How do I execute a sql script from excel using VBA", "body": "<p>I would like to have macros that will run .sql scripts (that are saved in a folder), instead of having to put the SQL code in the Excel VBA script.</p>\n\n<p>I have over 50 scripts that I'd like to automate - and these have many queries in each that are separated by a ; </p>\n\n<p>I've tried </p>\n\n<pre><code>db.ExecuteImmediate (\"\\\\c\\sql_folder\\1.0_Create_My Lovely_Table.sql\") \n</code></pre>\n\n<p>but the error says 'Object Required'</p>\n\n<p>The code below works but I'd like help to do the above.  Thanks.</p>\n\n<pre><code>Sub CREATE_My_lovely_table()\nDim con As ADODB.Connection\nDim recset As ADODB.Recordset\nDim ConnectionString As String\nDim SQL_String As String\n\nSet con = New ADODB.Connection\nSet recset = New ADODB.Recordset\n\nConnectionString = \"xxxxxx.1;User ID=XXXX_XXXX_XXXX;password=xxxxxxxx;Data Source=xxxxxxxx\"\n\ncon.Open ConnectionString\n\nSQL_String = \"CREATE TABLE My_lovely_table (CASEID NUMBER,ACCOUNTNUMBER NUMBER,RESOLVEDDATE TIMESTAMP,RESOLUTION VARCHAR (50),RESOLVEDBY VARCHAR (100),ORDERID NUMBER)\"\nrecset.Open SQL_String, con\n    con.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1564580471, "post_id": 57291902, "comment_id": 101078635, "body": "What you had should almost work. You had <code>&#39;ActiveCell.Offset(-1, 8).Copy &#39;ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats</code> but I think it should be <code>&#39;ActiveCell.Offset(-1, 8).Copy &#39;ActiveCell.PasteSpecial Paste:=xlPasteFormats</code> Did you try?"}], "answers": [{"tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": false, "score": 0, "last_activity_date": 1564582311, "creation_date": 1564582311, "answer_id": 57292825, "question_id": 57291902, "link": "https://stackoverflow.com/questions/57291902/i-cant-convert-data-into-appropriate-format/57292825#57292825", "title": "I can&#39;t convert data into appropriate format", "body": "<p>Give this a try :</p>\n\n<pre><code>Option Explicit\nSub data_entry()\n\nApplication.ScreenUpdating = False\n\nDim ItemNumber As String\nDim ItemType As String\nDim Issues As String\nDim InventoryValue As String\n\nItemNumber = InputBox(\"Please enter Item Number\", \"Item Number\", \"Type here\")\nItemType = InputBox(\"Please enter Item Type\", \"Item Type\", \"Type here\")\nIssues = InputBox(\"Please enter Number of Issues\", \"Issues\", \"Type here\")\nInventoryValue = InputBox(\"Please enter Inventory Value\", \"Inventory Value\", \"Type here\")\n\nRange(\"A2\").Activate\n\nDo\n\nIf ActiveCell.Value = \"\" Then Exit Do\nActiveCell.Offset(1, 0).Activate\n\nLoop\n\nActiveCell.Value = ItemNumber\n'ActiveCell.Offset(-1, 0).Copy\nRange(ActiveCell, ActiveCell.Offset(-1, 0)).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial xlPasteValuesAndNumberFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial PasteSpecial xlPasteFormats\n\nActiveCell.Offset(0, 5).Value = ItemType\n'ActiveCell.Offset(0, 5).Copy\nRange(ActiveCell, ActiveCell.Offset(-1, 0)).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial xlPasteValuesAndNumberFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial PasteSpecial xlPasteFormats\n\nActiveCell.Offset(0, 7).Value = Issues\n'ActiveCell.Offset(-1, 7).Copy\nRange(ActiveCell, ActiveCell.Offset(-1, 7)).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial xlPasteValuesAndNumberFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial PasteSpecial xlPasteFormats\n\nActiveCell.Offset(0, 8).Value = InventoryValue\n'ActiveCell.Offset(-1, 8).Copy\nRange(ActiveCell, ActiveCell.Offset(-1, 8)).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial xlPasteValuesAndNumberFormats\nSheets(\"NameSheet\").Range(ActiveCell, ActiveCell.Offset(1, 0)).PasteSpecial PasteSpecial xlPasteFormats\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 11741419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFxSYVo2ULg/AAAAAAAAAAI/AAAAAAAAALg/y0i7eV7vSf8/photo.jpg?sz=128", "display_name": "Samuel Balun", "link": "https://stackoverflow.com/users/11741419/samuel-balun"}, "edited": false, "score": 0, "creation_date": 1564584722, "post_id": 57292862, "comment_id": 101081527, "body": "Great! Short and effective. Thank you!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1564582841, "last_edit_date": 1564582841, "creation_date": 1564582415, "answer_id": 57292862, "question_id": 57291902, "link": "https://stackoverflow.com/questions/57291902/i-cant-convert-data-into-appropriate-format/57292862#57292862", "title": "I can&#39;t convert data into appropriate format", "body": "<p>I believe the following will achieve your expected results without Activating a cell and without the Do Loop too, both of which will invariably result in reduced performance:</p>\n\n<pre><code>Sub Data_Entry()\nDim ws As Worksheet: Set ws = ThisWorkbook.ActiveSheet 'or you could be more explicit and use: ThisWorkbook.Worksheets(\"Sheet1\")\n'declare and set the worksheet being used, amend as required.\nApplication.ScreenUpdating = False\n\nDim ItemNumber As String\nDim ItemType As String\nDim Issues As String\nDim InventoryValue As String\n\nItemNumber = InputBox(\"Please enter Item Number\", \"Item Number\", \"Type here\")\nItemType = InputBox(\"Please enter Item Type\", \"Item Type\", \"Type here\")\nIssues = InputBox(\"Please enter Number of Issues\", \"Issues\", \"Type here\")\nInventoryValue = InputBox(\"Please enter Inventory Value\", \"Inventory Value\", \"Type here\")\n\nNextRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n'find the next free row in Column A\n\nws.Range(\"A\" &amp; NextRow).Value = ItemNumber\n'another way to reference a cell would be: ws.Cells(NextRow, 1).Value = ItemNumber\nws.Range(\"F\" &amp; NextRow).Value = ItemType\nws.Range(\"H\" &amp; NextRow).Value = Issues\nws.Range(\"I\" &amp; NextRow).Value = InventoryValue\n\n\nws.Range(\"A\" &amp; NextRow - 1 &amp; \":I\" &amp; NextRow - 1).Copy\n'Copy above row from Columns A to I\nws.Range(\"A\" &amp; NextRow &amp; \":I\" &amp; NextRow).PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n'paste the formating to new row Columns A to I\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 11741419, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OFxSYVo2ULg/AAAAAAAAAAI/AAAAAAAAALg/y0i7eV7vSf8/photo.jpg?sz=128", "display_name": "Samuel Balun", "link": "https://stackoverflow.com/users/11741419/samuel-balun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 57292862, "answer_count": 2, "score": 0, "last_activity_date": 1564582841, "creation_date": 1564579531, "last_edit_date": 1564581107, "question_id": 57291902, "link": "https://stackoverflow.com/questions/57291902/i-cant-convert-data-into-appropriate-format", "title": "I can&#39;t convert data into appropriate format", "body": "<p>I created auto-populating offset function to add data into my list. Now I need to convert the inserted data into the same format as cells above. I reckon there is some shorter code to do this. Mine's not working anyway. The data are scattered all over the worksheet.</p>\n\n<pre><code>Option Explicit\nSub data_entry()\n\nApplication.ScreenUpdating = False\n\nDim ItemNumber As String\nDim ItemType As String\nDim Issues As String\nDim InventoryValue As String\n\nItemNumber = InputBox(\"Please enter Item Number\", \"Item Number\", \"Type here\")\nItemType = InputBox(\"Please enter Item Type\", \"Item Type\", \"Type here\")\nIssues = InputBox(\"Please enter Number of Issues\", \"Issues\", \"Type here\")\nInventoryValue = InputBox(\"Please enter Inventory Value\", \"Inventory Value\", \"Type here\")\n\nRange(\"A2\").Activate\n\nDo\n\nIf ActiveCell.Value = \"\" Then Exit Do\nActiveCell.Offset(1, 0).Activate\n\nLoop\n\nActiveCell.Value = ItemNumber\n'ActiveCell.Offset(-1, 0).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\n\nActiveCell.Offset(0, 5).Value = ItemType\n'ActiveCell.Offset(-1, 0).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\n\nActiveCell.Offset(0, 7).Value = Issues\n'ActiveCell.Offset(-1, 7).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\n\nActiveCell.Offset(0, 8).Value = InventoryValue\n'ActiveCell.Offset(-1, 8).Copy\n'ActiveCell.Offset(1, 0).PasteSpecial Paste:=xlPasteFormats\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 11863037, "user_type": "registered", "profile_image": "https://graph.facebook.com/478037519675644/picture?type=large", "display_name": "Sebastian Rupp", "link": "https://stackoverflow.com/users/11863037/sebastian-rupp"}, "reply_to_user": {"reputation": 16954, "user_id": 307138, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6bc245ebc908699a0cd9fbdc2e598ba3?s=128&d=identicon&r=PG", "display_name": "Ocaso Protal", "link": "https://stackoverflow.com/users/307138/ocaso-protal"}, "edited": false, "score": 0, "creation_date": 1564580162, "post_id": 57291862, "comment_id": 101078431, "body": "This code should be inserted: Sub SalesCarProduction() &#39;Parameters for searching strings Dim SalesCarProduction As String Dim AUDIa1 As String &#39;Parameters for saving the sales the devision Dim Revenue_AudiA1 As Integer Dim i As Integer strDepartment = &quot;Car Production&quot; strAudiA1 = &quot;Audi A1&quot; For i = 1 To 10000 If Tabelle1.Cells(i, 1).Text = strDepartment And Tabelle1.Cells(i, 4).Text = strAudiA1 Then Revenue_AudiA1 = CLng(Tabelle1.Cells(i, 6).Value) * Tabelle1.Cells(i, 10).Value End If Next i End Sub"}, {"owner": {"reputation": 16954, "user_id": 307138, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6bc245ebc908699a0cd9fbdc2e598ba3?s=128&d=identicon&r=PG", "display_name": "Ocaso Protal", "link": "https://stackoverflow.com/users/307138/ocaso-protal"}, "edited": false, "score": 1, "creation_date": 1564580322, "post_id": 57291862, "comment_id": 101078518, "body": "Yes, you can do that yourself, just click on <a href=\"https://stackoverflow.com/posts/57291862/edit\">edit</a> and insert the code :) I could do that too, but it is hard to paste from your comment and add all the linebreaks and so on :)"}, {"owner": {"reputation": 1446, "user_id": 1930817, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/66Aja.jpg?s=128&g=1", "display_name": "guzmonne", "link": "https://stackoverflow.com/users/1930817/guzmonne"}, "edited": false, "score": 0, "creation_date": 1564582050, "post_id": 57291862, "comment_id": 101079731, "body": "@SebastianRupp, please check if the code was correctly added."}, {"owner": {"reputation": 1, "user_id": 11863037, "user_type": "registered", "profile_image": "https://graph.facebook.com/478037519675644/picture?type=large", "display_name": "Sebastian Rupp", "link": "https://stackoverflow.com/users/11863037/sebastian-rupp"}, "reply_to_user": {"reputation": 16954, "user_id": 307138, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6bc245ebc908699a0cd9fbdc2e598ba3?s=128&d=identicon&r=PG", "display_name": "Ocaso Protal", "link": "https://stackoverflow.com/users/307138/ocaso-protal"}, "edited": false, "score": 0, "creation_date": 1564604254, "post_id": 57291862, "comment_id": 101090545, "body": "@OcasoProtal I think i miscommunicated :D. I meant that i want to be able to add endless car and devisions and combinations of cars and divisions very easily without programming knowledge, through an input mask and clicking safe. -&gt; than the code should be generated by itself (Like a predefined code with placeholders which gets bigger and bigger by adding more products. Is that possible?"}], "owner": {"reputation": 1, "user_id": 11863037, "user_type": "registered", "profile_image": "https://graph.facebook.com/478037519675644/picture?type=large", "display_name": "Sebastian Rupp", "link": "https://stackoverflow.com/users/11863037/sebastian-rupp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564591276, "creation_date": 1564579437, "last_edit_date": 1564591276, "question_id": 57291862, "link": "https://stackoverflow.com/questions/57291862/creating-a-input-mask-in-excel-to-insert-new-code-new-parameters-for-a-code-in", "title": "Creating a input mask in excel to insert new code/ new parameters for a code in VBA", "body": "<p>What i want to do, is to create a a VBA code for an input mask in excel, which should always save the word entered as a paramter and that it belongs to a certain group (department) e.g. Product: Audi A1, Department: Car production. </p>\n\n<p>Simultaneously it should create a code automatically and insert it on a certain position. The code below should be inserted on a certain position in the same form as below after the content of the input masked is safed. Does anyone know how to do this?</p>\n\n<p>Here is the code that should be inserted:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SalesCarProduction() \n  'Parameters for searching strings\n  Dim SalesCarProduction As String\n  Dim AUDIa1 As String \n\n  'Parameters for saving the sales the devision \n  Dim Revenue_AudiA1 As Integer \n  Dim i As Integer \n\n  strDepartment = \"Car Production\" \n  strAudiA1 = \"Audi A1\" \n\n  For i = 1 To 10000 \n    If Tabelle1.Cells(i, 1).Text = strDepartment And Tabelle1.Cells(i, 4).Text = strAudiA1 \n    Then Revenue_AudiA1 = CLng(Tabelle1.Cells(i, 6).Value) * Tabelle1.Cells(i, 10).Value \n    End If \n  Next i \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1564579958, "post_id": 57291760, "comment_id": 101078296, "body": "An <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would help. Comment out <code>On Error Resume Next</code> for starters to see what&#39;s actually going on."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1564580711, "post_id": 57291760, "comment_id": 101078822, "body": "Welcome to SO. First of all, delete <code>On Error Resume next</code>, because it <i>hides</i> errors, but they still occur. Second, VLOOKUP can return an error in diferent situation. If nothing is found, it will return an error, so make sure what you are searching is on it, and it&#39;s <b>exactly</b> the same (no hidden chars, extra blanks). Secoond, make sure range <code>New_opened_rng</code> got 11 columns"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564581498, "post_id": 57291760, "comment_id": 101079357, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/18063214/11683\">How to error handle 1004 Error with WorksheetFunction.VLookup?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b376ce9b2ef28f333166848bc52f0c82?s=128&d=identicon&r=PG&f=1", "display_name": "paul_baine", "link": "https://stackoverflow.com/users/11853426/paul-baine"}, "edited": false, "score": 0, "creation_date": 1564654730, "post_id": 57292460, "comment_id": 101106081, "body": "Hi Cyril, I tried your code, and it works as long as a match is found.  If not, it returns &quot;Run-time error 13&quot; - type mismatch&quot;.  I am not that familiar with error handling.  I tried modifying the code as follows:      On Error Resume Next     Resp_Unit2 = Application.Index(OutputRng, Application.Match(NCASTS, SearchRng, 0))     If IsError(Resp_Unit2) Then Resp_Unit2 = &quot;Not found&quot;  However, the program still stops at the &quot;Application.Index&quot; step and flags the Run-time error.  Could you please advise on how to handle this error?  Thanks!"}, {"owner": {"reputation": 1, "user_id": 11853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b376ce9b2ef28f333166848bc52f0c82?s=128&d=identicon&r=PG&f=1", "display_name": "paul_baine", "link": "https://stackoverflow.com/users/11853426/paul-baine"}, "edited": false, "score": 0, "creation_date": 1564658983, "post_id": 57292460, "comment_id": 101108427, "body": "Never mind, I found a solution that works: &#39;     If IsError(Application.Match(NCASTS, SearchRng, 0)) Then         Resp_Unit2 = &quot;Not found&quot;     Else         Resp_Unit2 = Application.Index(OutputRng, Application.Match(NCASTS, SearchRng, 0))     End If  Thanks very much for your help!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1564581562, "last_edit_date": 1564581562, "creation_date": 1564581248, "answer_id": 57292460, "question_id": 57291760, "link": "https://stackoverflow.com/questions/57291760/why-am-i-getting-run-time-error-1004-using-vlookup/57292460#57292460", "title": "Why am I getting Run time error 1004 using Vlookup?", "body": "<p>Rather than <code>vlookup</code>, since you're working in a specific column out in yonder (and hoenstly ensuring it's the 11th column of the range is its own PITA (subjective, I know)), you might try <code>index</code>/<code>match</code> to ensure you're only having to specify your lookup and output ranges.  Will make a couple changes, like <em>ensuring to qualify ALL ranges (even the <code>cells</code> inside of <code>range</code>)</em>:</p>\n\n<pre><code>Dim OutputRng as Range, SearchRng as Range, NCASTS as String, Resp_Unit2 as String, Last_row_1 as Long\nWith Worksheets(Newest_opened)\n    Set SearchRng = .Range(.Cells(1,1),.Cells(Last_row_1,1)) 'Assumes Column A is searched\n    Set OutputRng = .Range(.Cells(1,11),.Cells(Last_row_1,11)) 'Assumes Column K has otuput\n    Last_row_1 = .Cells(.Rows.Count, 1).End(xlUp).Row  'qualified\n    Do Until IsEmpty(.Cells(x, 1)) 'qualified this, but may want to try a for or for each loop?\n        NCASTS = .Cells(x, 1).Value 'qualify it, don't use .activate and added .value\n        Resp_Unit2 = Application.Index(OutputRng, Application.Match(NCASTS, SearchRng, 0))\n        x = x+1\n    Loop\nEnd With\n</code></pre>\n\n<p>Related to your error, you might not have an exact match, which would throw an error; using <code>WorkSheetFunction</code> you will get an error that flags, similar to the worksheet's <code>#VALUE</code>.  FoxFire touches on that in the comments section of the post which is quite important.</p>\n"}], "owner": {"reputation": 1, "user_id": 11853426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b376ce9b2ef28f333166848bc52f0c82?s=128&d=identicon&r=PG&f=1", "display_name": "paul_baine", "link": "https://stackoverflow.com/users/11853426/paul-baine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564581562, "creation_date": 1564579163, "last_edit_date": 1564579857, "question_id": 57291760, "link": "https://stackoverflow.com/questions/57291760/why-am-i-getting-run-time-error-1004-using-vlookup", "title": "Why am I getting Run time error 1004 using Vlookup?", "body": "<p>I have a macro where I go through each row of Newest_closed worksheet and:\n - get the NCASTS string in column A\n - look for the string in Newest_opened worksheet using Vlookup\n - if found, get contents of Column K and call it \"Resp_Unit2\"\n - paste value of \"Resp_Unit2\" in Column K of Newest_closed worksheet\nNOTE:  Newest_opened and Newest_closed are Public-dimensioned strings, and actual names of the worksheets are created in another Sub.</p>\n\n<p>When I reach the line of code that uses Vlookup, I get \"Run-time error 1004: Application-defined or object-defined error\".  Why am I getting this error?</p>\n\n<p>I have used \"Immediate\" window to query values of Last_row_1, Last_column_1, and NCASTS (for loop counter x = 2).  All queries return valid values.</p>\n\n<p>I have also used \"Immediate\" window to execute:</p>\n\n<pre><code>Worksheets(Newest_opened).Range(Cells(1, 1), Cells(Last_row_1, Last_column_1)).Select\n</code></pre>\n\n<p>Excel shows the correct range of cells selected in the worksheet.</p>\n\n<pre><code>    Sub Assign_Resp_Unit_2()\n    'This sub does the following:\n    '\n    '   - for each NCASTS in the Newest_closed worksheet:\n    '       - searches in the Newest_opened worksheet for that NCASTS\n    '       - if NCASTS found, gets the value from the \"Responsible Unit\"    column and pastes it in the same column in the Newest_closed worksheet\n    '\n    Dim x As Integer\n    Dim NCASTS As String\n    Dim Resp_Unit2 As String\n    Dim Last_row_1 As Long\n    Dim Last_column_1 As Long\n    Dim New_opened_rng As Range\n   '\n   'Find range of Newest_opened worksheet\n   Worksheets(Newest_opened).Activate\n   Last_row_1 = Cells(Rows.Count, 1).End  (xlUp).Row                           'get number of last row in table\n   Last_column_1 = Cells(1, Columns.Count).End(xlToLeft).Column              'get number of last column in table\n   '\n   'Set the variable \"Newest_opened_range\" to be the Range of the Newest_opened worksheet\n   Set New_opened_rng = Worksheets(Newest_opened).Range(Cells(1, 1), Cells(Last_row_1, Last_column_1))\n   '\n   'search Newest_opened worksheet for Responsible Unit\n   '\n   'Loop through each cell in Column A of Newest_closed until a blank cell is encountered (i.e. end of entries)\n   '\n   Worksheets(Newest_closed).Activate\n   x = 2   'initialize row counter\n   Do Until IsEmpty(Cells(x, 1))\n       '\n       'Get NCASTS number from Column A of Newest_closed worksheet\n       NCASTS = Cells(x, 1)\n       '\n       'Search for NCASTS number in Newest_opened worksheet and find  corresponding Responsible Unit entry;\n       'Preset string variable Resp_Unit2 to \"Not found\" for case where NCASTS number is not in the range\n       '\n       Resp_Unit2 = \"Not found\"\n       On Error Resume Next\n       Resp_Unit2 = Application.WorksheetFunction.VLookup(NCASTS, New_opened_rng, 11, False)\n       '\n       'Paste value of Resp_Unit2 to Responsible Unit column (column L) for same NCASTS in Newest_closed worksheet\n       '\n       Sheets(Newest_closed).Cells(x, 12).Value = Resp_Unit2\n       '\n       'Move to next row of Newest_closed worksheet\n       '\n       x = x + 1\n   '\n   Loop\n   '\n   End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping", "twitter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1564581193, "post_id": 57291672, "comment_id": 101079163, "body": "I recommend to make use of the Twitter API otherwise your code will break everytime Twitter changes something on their website."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1564581929, "post_id": 57291672, "comment_id": 101079648, "body": "<code>ss1</code> needs to be <code>set</code>. This <code>HTML.getElementsByClassName()</code> returns a collection of objects, which is an object itself. So <code>ss1</code> needs to be declared and <code>set</code> accordingly."}, {"owner": {"reputation": 8279, "user_id": 262478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1526dcb784188b422544c6344ef223c2?s=128&d=identicon&r=PG", "display_name": "Andy Piper", "link": "https://stackoverflow.com/users/262478/andy-piper"}, "edited": false, "score": 0, "creation_date": 1564596950, "post_id": 57291672, "comment_id": 101087562, "body": "Scraping the Twitter website like this is against the Terms of Service and may lead to your IP address being blocked. Use the official API."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1564652102, "post_id": 57291672, "comment_id": 101104660, "body": "Also, why use this <code>Set HTML = CreateObject(&quot;htmlfile&quot;)</code> when you have already declared and instantiated an HTMLDocument object called HTML1?"}], "owner": {"reputation": 11, "user_id": 11864009, "user_type": "registered", "profile_image": "https://graph.facebook.com/3249244095085685/picture?type=large", "display_name": "MPO", "link": "https://stackoverflow.com/users/11864009/mpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564581127, "creation_date": 1564578927, "last_edit_date": 1564581127, "question_id": 57291672, "link": "https://stackoverflow.com/questions/57291672/error-438-on-getting-information-from-twitter-by-using-vba-xmlhttp-getelementsby", "title": "Error 438 on getting information from Twitter by using VBA XMLHTTP getElementsByClassName()", "body": "<p>I have limited knowledge on Excel VBA programming. \nFailed to get data from Twitter by using VBA XMLHTTP <code>getelementsbyClassName ()</code> which always result in error 438. </p>\n\n<pre><code>ss1 = HTML.getElementsByClassName(\"css-1dbjc4n r-1oszu61 r-1niwhzg r-18u37iz r-16y2uox r-2llsf r-13qz1uu\") \n</code></pre>\n\n<p>result in error message: </p>\n\n<blockquote>\n  <p>Object doesn't support this property or method. </p>\n</blockquote>\n\n<p><code>HTML.all</code> did work but if I used <code>getElementsbyClassName</code>, it failed. </p>\n\n<pre><code>Sub Fetch_Twit_1()    \n    Dim HTML1 As New HTMLDocument, elem As Object, ss1 As Object, URL$\n\n    URL = \"https://twitter.com/realdonaldtrump\"\n\n    With CreateObject(\"MSXML2.XMLHTTP\")             \n        .Open \"GET\", URL, False        \n        .send\n\n        Set HTML = CreateObject(\"htmlfile\")\n\n        If .Status = 200 Then        \n            HTML.body.innerHTML = .responseText        \n        Else: MsgBox \"Error\"\n        End If\n\n        ss1 = HTML.getElementsByClassName(\"css-1dbjc4n r-1oszu61 r-1niwhzg r-18u37iz r-16y2uox r-2llsf r-13qz1uu\")\n\n        For Each element In ss1        \n            ActiveCell.Value = element.innerText        \n            ActiveCell.Offset(0, 1).Value = element.ID        \n            ActiveCell.Offset(1, 0).Select        \n        Next element\n\n        Set HTML = Nothing\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564583504, "post_id": 57292964, "comment_id": 101080706, "body": "I tried using this &quot;&lt;img src=&quot;cid:my-xcontent-id&quot;&gt;&quot;, but I don&#39;t know how to set the header on the attachments."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564589866, "post_id": 57292964, "comment_id": 101084450, "body": "Were you able to <b>add</b> the attachment?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564671114, "post_id": 57292964, "comment_id": 101115713, "body": "Please show your code and the resulting MIME message."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564672404, "post_id": 57292964, "comment_id": 101116414, "body": "I do not see your code setting the content-id header on the attachment.to &quot;TempExportChart.bmp&quot;"}, {"owner": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564744929, "post_id": 57292964, "comment_id": 101140914, "body": "Could you please help me doing this? I don&#39;t now how to do that right."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564772914, "post_id": 57292964, "comment_id": 101154306, "body": "Are you doing this using the Outlook Object Model or CDO?"}, {"owner": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564777454, "post_id": 57292964, "comment_id": 101155976, "body": "I am doing using CDO. I tried using OOM, but don&#39;t worked well."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564779790, "post_id": 57292964, "comment_id": 101156642, "body": "AddAttachment  call returns IBodyPart object (<a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/exchange-server-2007/aa581351(v%3Dexchg.80)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer&zwnj;&#8203;/&hellip;</a> ). You need to set the MIME header using BodyPart.Fields.Item - <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/exchange-server-2007/aa581142(v=exchg.80)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer/&zwnj;&#8203;&hellip;</a>"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1564582735, "creation_date": 1564582735, "answer_id": 57292964, "question_id": 57291639, "link": "https://stackoverflow.com/questions/57291639/embed-image-not-showing-on-email/57292964#57292964", "title": "Embed image not showing on email", "body": "<p>You need to add the images as file attachments, set the \"content-id\" MIME header on these attachment MIME parts, and make suire teh HTML body refers to the image attachents by content id (e.g. <code>&lt;img src=\"cid:my-xcontent-id\"&gt;</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564660730, "post_id": 57295499, "comment_id": 101109423, "body": "Eugene, I tried using this code you sent, but I still facing the same error (&quot;X&quot;)."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "edited": false, "score": 0, "creation_date": 1564911152, "post_id": 57295499, "comment_id": 101178805, "body": "I have just updated the post. Please see the code shown above."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1564911132, "last_edit_date": 1564911132, "creation_date": 1564591311, "answer_id": 57295499, "question_id": 57291639, "link": "https://stackoverflow.com/questions/57291639/embed-image-not-showing-on-email/57295499#57295499", "title": "Embed image not showing on email", "body": "<p>You need to add the image and hide it. The position 0 will add and hide it.</p>\n\n<pre><code>MailItem.Attachments.Add Fname, 1, 0\n</code></pre>\n\n<p>The <code>1</code> is the Outlook Constant <code>olByValue</code>.</p>\n\n<p>Once you add the image then you have to use \"cid:FILENAME.jpg\" as shown below. For example:</p>\n\n<pre><code>With OutMail\n    .To = tName   \n    .Subject = \"Hello world!\"\n    .Attachments.Add Fname, 1, 0\n    .HTMLBody = \"&lt;img src=\"\"cid:Claims.jpg\"\"height=520 width=750&gt;\"\n    .Display\nEnd With\n</code></pre>\n\n<p>Also, you may set the attachment content ID explicitly:</p>\n\n<pre><code>Function SendasAttachment(fName As String)\n\nDim olApp As Outlook.Application\nDim olMsg As Outlook.MailItem\nDim olAtt As Outlook.Attachments\n\nSet olApp = Outlook.Application\nSet olMsg = olApp.CreateItem(0) ' email\nSet olAtt = olMsg.Attachments\n\nConst PR_ATTACH_MIME_TAG = \"http://schemas.microsoft.com/mapi/proptag/0x370E001E\"\nConst PR_ATTACH_CONTENT_ID = \"http://schemas.microsoft.com/mapi/proptag/0x3712001E\"\nConst PR_ATTACHMENT_HIDDEN = \"http://schemas.microsoft.com/mapi/proptag/0x7FFE000B\"\n\n' attach file\nolAtt.Add (fldName &amp; fName)\n\nSet l_Attach = olAtt.Add(fldName &amp; fName)\nSet oPA = l_Attach.PropertyAccessor\n       oPA.SetProperty PR_ATTACH_MIME_TAG, \"image/jpeg\"\n       oPA.SetProperty PR_ATTACH_CONTENT_ID, \"myident\"\n       oPA.SetProperty PR_ATTACHMENT_HIDDEN, True\n\nolMsg.PropertyAccessor.SetProperty \"http://schemas.microsoft.com/mapi/id/{00062008-0000-0000-C000-000000000046}/8514000B\", True\n\nolMsg.To = \"test@somedomain.com\"\nmsgHTMLBody = \"&lt;HTML&gt;\" &amp; _\n                   \"&lt;head&gt;\" &amp; _\n                   \"&lt;/head&gt;\" &amp; _\n                   \"&lt;BODY&gt;\" &amp; \"Hi \" &amp; olMsg.To &amp; \", &lt;br /&gt;&lt;br /&gt; I have attached \" &amp; fName &amp; \" as you requested.\" &amp; _\n                   \"&lt;br /&gt;&lt;img align=baseline border=1 hspace=0 src=cid:myident width='400'/&gt;\" &amp; _\n                   \"&lt;/BODY&gt;&lt;/HTML&gt;\"\n' send message\nWith olMsg\n  .Subject = \"Hello world!\"\n  .BodyFormat = olFormatHTML\n  .HTMLBody = msgHTMLBody\n  .Save\n  '.Display\n  .Send\nEnd With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11863678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dbd0939a11476d67c40a71e5e89616?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo M. Pires", "link": "https://stackoverflow.com/users/11863678/leonardo-m-pires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 885, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1590663708, "creation_date": 1564578849, "last_edit_date": 1590663708, "question_id": 57291639, "link": "https://stackoverflow.com/questions/57291639/embed-image-not-showing-on-email", "title": "Embed image not showing on email", "body": "<p>I have a macro to send some emails, but the embed images goes with a \"x\" to the recievers.</p>\n\n<p>My email have: anex, body text and the embed images.</p>\n\n<pre><code>Option Explicit\n\nDim lsave As String\n\n\nSub Arquivoanex()\n\nApplication.DisplayAlerts = False\n\nDim OutApp As Object\nDim OutMail As Object\nDim oEmail As Object\nDim strBody As String\n\nDim line As String\nDim subject As String\nDim destine As String\nDim anex As String\nDim product As String\nDim unit As String\nDim retval As String\nDim anex_name As String\nDim validation As String\nDim signature As String\n\nline = 3\n\nproduct = \"x\"\n\nDo While product &lt;&gt; \"\"\n\n    Set oEmail = CreateObject(\"CDO.Message\")\n\n    product = Sheets(\"Send_Emails\").Range(\"M\" &amp; line)\n    unit = Sheets(\"Send_Emails\").Range(\"N\" &amp; line)\n    destine = Sheets(\"Send_Emails\").Range(\"O\" &amp; line)\n    subject = Sheets(\"Send_Emails\").Range(\"P\" &amp; line)\n    anex = Sheets(\"Send_Emails\").Range(\"Q\" &amp; line)\n    anex_name = Sheets(\"Send_Emails\").Range(\"R\" &amp; line)\n    validation = Sheets(\"Send_Emails\").Range(\"L\" &amp; line)\n\n    signature = \"\\\\...\\signature.png\"\n\n    Sheets(\"Send_Emails\").Range(\"S1\") = product\n\n    retval = Dir(anex)\n\n    If retval = anex_name Then\n\n    Else\n        GoTo next_anex\n    End If\n\n    If anex = \"\" Then\n        GoTo next_anex\n    End If\n\n    Sheets(\"Send_Emails\").Select\n    ActiveSheet.Calculate\n\n    Select Case product\n\n        Case Is = \"X\"\n            Sheets(\"X\").Select\n            Range(\"K3\") = unit\n            ActiveSheet.Calculate\n\n        Case Is = \"Y\"\n            If validation = \"Send\" Then\n                Sheets(\"Y\").Select\n                Range(\"K3\") = unit\n                ActiveSheet.Calculate\n            Else: GoTo next_anex\n\n            End If\n    End Select\n\n    On Error Resume Next\n\n    Call lCriarImagem 'Creates the image and give the location\n\n    strBody = Sheets(\"Send_Emails\").Range(\"B9\") &amp; \"&lt;img src=\"\"cid:TempExportChart.bmp\"\"height=520 width=750&gt;\" &amp; \"&lt;br/&gt;&lt;br/&gt;TKS! &lt;br/&gt;&lt;br/&gt;&lt;/body&gt;\"\n\n    MailItem.Attachments.Add FName, 1, 0\n\n    With oEmail\n\n    .Display\n    oEmail.From = \"mail_from@mail\"\n    oEmail.To = \"mail_to@mail\"\n    oEmail.subject = subject\n    oEmail.Attachments.Add FName, 1, 0\n    oEmail.AddAttachment anex\n    oEmail.HTMLBody = strBody &amp; .HTMLBody\n\n    oEmail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/sendusing\") = 2\n    oEmail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/smtpserver\") = \"myserver.server\"\n    oEmail.Configuration.Fields.Item(\"http://schemas.microsoft.com/cdo/configuration/authenticate\") = 1\n    oEmail.Configuration.Fields.Update\n\n    oEmail.Send\n\n    End With\n\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nnext_anex:\n\n    line = line + 1\n\nLoop\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>It's posible to fix this problems using this code structure?</p>\n\n<blockquote>\n  <p>Obs: This is the code after all the sugestions.</p>\n  \n  <p>I still facing the problems with the \"X\" on the email:<a href=\"https://ibb.co/0hX6Dvf\" rel=\"nofollow noreferrer\">https://ibb.co/0hX6Dvf</a> (\"The photo cannot be show. Maybe the file cam be moved, renamed or excluded. Verify if the destiny is in the correct location\").</p>\n</blockquote>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "edited": false, "score": 0, "creation_date": 1565681839, "post_id": 57293007, "comment_id": 101418508, "body": "I used the same code after changing outlook application to a word application object but its not working  <code>Sub x()  Dim WordApp As Word.Application  With WordApp.EmailOptions.EmailSignature </code>"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "edited": false, "score": 0, "creation_date": 1565713441, "post_id": 57293007, "comment_id": 101435071, "body": "Please show your code that initializes the WordApp variable."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1564582840, "creation_date": 1564582840, "answer_id": 57293007, "question_id": 57291523, "link": "https://stackoverflow.com/questions/57291523/not-able-to-use-emailoptions-property-in-microsoft-outlook-vba/57293007#57293007", "title": "Not able to use EmailOptions Property in microsoft Outlook VBA", "body": "<p><code>EmailOptions</code> property is exposed by the <code>Word.Application</code> object, not by the <code>Outlook.Application</code> object.</p>\n"}], "owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564582840, "creation_date": 1564578524, "question_id": 57291523, "link": "https://stackoverflow.com/questions/57291523/not-able-to-use-emailoptions-property-in-microsoft-outlook-vba", "title": "Not able to use EmailOptions Property in microsoft Outlook VBA", "body": "<p>I am experimenting with the EmailOptions property.\nI found the example on Microsoft Docs (<a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.emailoptions\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/word.emailoptions</a>) and I am trying out. But it is giving the error: \" Object Doesn't Support this Property or Method \"</p>\n\n<p>I have added references to MS Word and Excel. What am i missing?</p>\n\n<pre><code>Option Explicit\n\nSub x()\nWith Outlook.Application.EmailOptions.EmailSignature\n    If .NewMessageSignature = \"\" Then\n        MsgBox \"There is no signature for new \" \n    Else\n        MsgBox \"There is signature for new e-mail\"\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1564578650, "post_id": 57291477, "comment_id": 101077470, "body": "Do you expect <code>.Count</code> number of <i>rows</i> or of <i>columns</i>?"}, {"owner": {"reputation": 27, "user_id": 11546104, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDlGDmult8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMMKR6IBXXfo6Q1Tz4PgnK3ShX6A/mo/photo.jpg?sz=128", "display_name": "Victor Lalonde", "link": "https://stackoverflow.com/users/11546104/victor-lalonde"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1564578835, "post_id": 57291477, "comment_id": 101077588, "body": "I expect <code>.Count</code> number of rows and 21 columns + 1 column for the keys, so I would like my table to be <code>.Count</code> x 22"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1564579689, "post_id": 57291477, "comment_id": 101078127, "body": "Can you please show either how the <code>.Items</code> are filled with the ranges or give an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 27, "user_id": 11546104, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDlGDmult8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMMKR6IBXXfo6Q1Tz4PgnK3ShX6A/mo/photo.jpg?sz=128", "display_name": "Victor Lalonde", "link": "https://stackoverflow.com/users/11546104/victor-lalonde"}, "edited": false, "score": 0, "creation_date": 1564580060, "post_id": 57291477, "comment_id": 101078374, "body": "Yes please see my edit :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564580540, "post_id": 57291477, "comment_id": 101078696, "body": "@VictorLalonde see my answer."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11546104, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDlGDmult8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMMKR6IBXXfo6Q1Tz4PgnK3ShX6A/mo/photo.jpg?sz=128", "display_name": "Victor Lalonde", "link": "https://stackoverflow.com/users/11546104/victor-lalonde"}, "edited": false, "score": 0, "creation_date": 1564580847, "post_id": 57291820, "comment_id": 101078902, "body": "Wow as simple as that! Thanks a lot I had tried to double transposed but didn&#39;t get the syntax correct I guess :P I works like a charm!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 3, "last_activity_date": 1564580526, "last_edit_date": 1564580526, "creation_date": 1564579319, "answer_id": 57291820, "question_id": 57291477, "link": "https://stackoverflow.com/questions/57291477/pasting-item-values-from-scripting-dictionary/57291820#57291820", "title": "Pasting item values from scripting dictionary", "body": "<h3>The trick is to double transpose</h3>\n\n<p>Imagine the following \"Sheet2\" which I read the ranges from</p>\n\n<p><a href=\"https://i.stack.imgur.com/ltKKP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ltKKP.png\" alt=\"enter image description here\"></a>\n<em><sup>Image 1: \"Sheet2\" contains example data to fill the items.</sup></em></p>\n\n<p>The following code \u2026</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestDictionary()\n    Dim Dic As Object\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n\n    Dic.Add \"key1\", Worksheets(\"Sheet2\").Cells(1, 1).Resize(1, 21)\n    Dic.Add \"key2\", Worksheets(\"Sheet2\").Cells(2, 1).Resize(1, 21)\n    Dic.Add \"key3\", Worksheets(\"Sheet2\").Cells(3, 1).Resize(1, 21)\n    Dic.Add \"key4\", Worksheets(\"Sheet2\").Cells(4, 1).Resize(1, 21)\n    Dic.Add \"key5\", Worksheets(\"Sheet2\").Cells(5, 1).Resize(1, 21)\n    Dic.Add \"key6\", Worksheets(\"Sheet2\").Cells(6, 1).Resize(1, 21)\n\n\n    'output in column A and B\n    Worksheets(\"Sheet1\").Range(\"A1\").Resize(Dic.Count, 1).Value = Application.Transpose(dic.keys)\n    Worksheets(\"Sheet1\").Range(\"B1\").Resize(Dic.Count, 21).Value = Application.Transpose(Application.Transpose(Dic.items))\nEnd Sub\n</code></pre>\n\n<p>\u2026 produces the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qdHAJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qdHAJ.png\" alt=\"enter image description here\"></a>\n<em><sup>Image 2: \"Sheet1\" for output of keys in column A and items in column B to V.</sup></em></p>\n"}], "owner": {"reputation": 27, "user_id": 11546104, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DDlGDmult8I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMMKR6IBXXfo6Q1Tz4PgnK3ShX6A/mo/photo.jpg?sz=128", "display_name": "Victor Lalonde", "link": "https://stackoverflow.com/users/11546104/victor-lalonde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 57291820, "answer_count": 1, "score": 0, "last_activity_date": 1565807121, "creation_date": 1564578416, "last_edit_date": 1565807121, "question_id": 57291477, "link": "https://stackoverflow.com/questions/57291477/pasting-item-values-from-scripting-dictionary", "title": "Pasting item values from scripting dictionary", "body": "<p>I have a <code>d = CreateObject(\"Scripting.Dictionary\")</code> that it's items are ranges. I would like to paste those items in a blank worksheet and this is the code I have for now : </p>\n\n<pre><code>ThisWorkbook.Sheets(2).ListObjects(1).DataBodyRange.Clear\n\n    With LatestRevisions\n        ThisWorkbook.Worksheets(2).Range(\"A1\").Resize(.Count, 1) = Application.Transpose(.keys)\n        ThisWorkbook.Worksheets(2).Range(\"B1\").Resize(.Count, 21) = Application.Transpose(.Items)\n    End With\n</code></pre>\n\n<p>In which <code>LatestRevisions</code> is a variable set to my dictionary name <code>d</code> and I resize the range B1 to 21 because that is the size of my item ranges.</p>\n\n<p>My problem is that the items are in the wrong direction (column data is in rows and row data is in columns), but if I do not put in the <code>Application.Transpose</code>nothing gets pasted.</p>\n\n<p>Any ideas?</p>\n\n<p>Thank you</p>\n\n<p>Edit :\nHere is how my dictionary is created and filled </p>\n\n<pre><code> Set d = CreateObject(\"Scripting.Dictionary\")\nIf SearchRng.Columns.Count &gt; 1 Then Exit Function\n\nFor Each Cell In SearchRng\n\n    If Not d.Exists(Cell.Value) Then\n        d.Add Cell.Value, Cell.Offset(0, 1).Resize(1, 21) 'fetch data from column B:V\n    Else\n        RevisionInDict = ConvertTextToNumeric(d(Cell.Value).Cells(1).Value)\n        Revision = ConvertTextToNumeric(Cell.Offset(0, 1))\n        If Revision &gt; RevisionInDict Then\n            Set d(Cell.Value) = Cell.Offset(0, 1).Resize(1, 21)\n                End If\n        End If\n    Next\n\n    Set GetLatestRevisions = d\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1564617268, "post_id": 57291397, "comment_id": 101094009, "body": "Can you explain the purpose of this class. My feeling is that your architecture isn&#39;t quite right - even if you solve the object checking in the <code>Getter</code>, aren&#39;t you just going to have to repeat the check in the routine that calls this class property? Having a <code>Variant</code> that could hold an object or primitive data type is often a sign of incorrect design. I&#39;m not saying yours is, but it&#39;d be interesting to understand the purpose of this class."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1564691603, "post_id": 57291397, "comment_id": 101124800, "body": "@Ambie - you have a very good point here. I would have to apply the same object checking down the stack. Perhaps the best option here is to include a <code>IsObject</code> property flag. The purpose of this class is to allow for batch executions across different types and instances of objects, like a mediator pattern. You can have something like a collection of PropertyPtrs that, when the time comes to mediate, can run through its list of Properties and update/use/etc them across types/instances."}, {"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1564691718, "post_id": 57291397, "comment_id": 101124836, "body": "I have another similar class for FunctionPtr which emulates storing a function in a variable (like in javascript)"}], "answers": [{"comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1564754561, "post_id": 57318737, "comment_id": 101146074, "body": "Thank you for posting this detailed example! I find it very helpful as I learn more about design patterns (and how to implement them in VBA... sometimes a frustrating task). I think you are right about CallByName regarding the variant type. This would end up forcing all objects that want to participate to declare variant typed properties."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 1, "last_activity_date": 1564707641, "creation_date": 1564707641, "answer_id": 57318737, "question_id": 57291397, "link": "https://stackoverflow.com/questions/57291397/how-to-handle-a-function-where-the-returned-value-type-is-not-known-at-run-time/57318737#57318737", "title": "How to handle a function where the returned value type is not known at run-time (Object or Non-Object)", "body": "<p>Okay, so if you really want to follow that route then I think you'll have to set an <code>IsObj</code> flag - probably at the point you set the property name.</p>\n\n<p>However, I'd still maintain that using a <code>Variant</code> for either an Object or primitive type isn't a great idea, and the <code>CallByName()</code> function in this context comes with issues. My hesitations are that performance will be diminished and you'll have quite a task to keep the property strings aligned with the property names (should you update things in the future).</p>\n\n<p>It is possible to implement a Mediator Pattern in VBA and I do feel you should consider this route. Below is a really basic example of how you could do it. I haven't bothered with an interface for the mediator, but I have created an interface for my participating classes (to cover the possibility that you're dealing with your own 'groups' of classes).</p>\n\n<p><strong>Mediator class (called cMediator):</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate mSweets As Collection\n\nPrivate Sub Class_Initialize()\n    Set mSweets = New Collection\nEnd Sub\n\nPublic Sub RegisterSweet(sweet As ISweet)\n    Set sweet.Mediator = Me\n    mSweets.Add sweet\nEnd Sub\n\nPublic Sub SendSugarLimit(limit As Long)\n    Dim sweet As ISweet\n\n    For Each sweet In mSweets\n        sweet.ReceiveSugarLimit limit\n    Next\nEnd Sub\n\nPublic Sub ReceiveMeltingAlert(offender As String)\n    Dim sweet As ISweet\n\n    For Each sweet In mSweets\n        sweet.ReceiveEatNow offender\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Participating classes Interface (called ISweet):</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Property Set Mediator(RHS As cMediator)\nEnd Property\n\nPublic Sub ReceiveSugarLimit(g_perDay As Long)\nEnd Sub\n\nPublic Sub ReceiveEatNow(offender As String)\nEnd Sub\n</code></pre>\n\n<p><strong>My two participating classes (cQtySweet and cWeightSweet):</strong></p>\n\n<pre><code>Option Explicit\nImplements ISweet\n\nPublic Name As String\nPublic SugarPerItem As Long\nPublic CanMelt As Boolean\nPrivate pMediator As cMediator\n\nPublic Sub OhNoItsMelting()\n    pMediator.ReceiveMeltingAlert Name\nEnd Sub\n\nPrivate Property Set ISweet_Mediator(RHS As cMediator)\n    Set pMediator = RHS\nEnd Property\n\nPrivate Sub ISweet_ReceiveEatNow(offender As String)\n    If CanMelt Then Debug.Print offender &amp; \" is melting. Eat \" &amp; Name &amp; \"s now!\"\nEnd Sub\n\nPrivate Sub ISweet_ReceiveSugarLimit(g_perDay As Long)\n    Dim max As Long\n\n    max = g_perDay / SugarPerItem\n    Debug.Print \"Max \" &amp; Name &amp; \"s: \" &amp; max &amp; \".\"\nEnd Sub\n\nOption Explicit\nImplements ISweet\n\nPublic Name As String\nPublic SugarPer100g As Long\nPublic CanMelt As Boolean\nPrivate pMediator As cMediator\n\nPublic Sub OhNoItsMelting()\n    pMediator.ReceiveMeltingAlert Name\nEnd Sub\nPrivate Property Set ISweet_Mediator(RHS As cMediator)\n    Set pMediator = RHS\nEnd Property\n\nPrivate Sub ISweet_ReceiveEatNow(offender As String)\n    If CanMelt Then Debug.Print offender &amp; \" is melting. Eat \" &amp; Name &amp; \" now!\"\nEnd Sub\n\nPrivate Sub ISweet_ReceiveSugarLimit(g_perDay As Long)\n    Dim max As Long\n\n    max = g_perDay / (SugarPer100g / 100)\n    Debug.Print \"Max \" &amp; Name &amp; \": \" &amp; max &amp; \"g.\"\nEnd Sub\n</code></pre>\n\n<p><strong>Module Code:</strong></p>\n\n<pre><code>Public Sub RunMe()\n    Dim m As cMediator\n    Dim qtySweet As cQtySweet\n    Dim weightSweet As cWeightSweet\n\n    Set m = New cMediator\n\n    Set qtySweet = New cQtySweet\n    With qtySweet\n        .Name = \"Gobstopper\"\n        .SugarPerItem = 5\n        .CanMelt = False\n    End With\n    m.RegisterSweet qtySweet\n\n    Set qtySweet = New cQtySweet\n    With qtySweet\n        .Name = \"Wine Gum\"\n        .SugarPerItem = 2\n        .CanMelt = True\n    End With\n    m.RegisterSweet qtySweet\n\n    Set weightSweet = New cWeightSweet\n    With weightSweet\n        .Name = \"Sherbert\"\n        .SugarPer100g = 80\n        .CanMelt = False\n    End With\n    m.RegisterSweet weightSweet\n\n    Set weightSweet = New cWeightSweet\n    With weightSweet\n        .Name = \"Fudge\"\n        .SugarPer100g = 50\n        .CanMelt = True\n    End With\n    m.RegisterSweet weightSweet\n\n    'Blasted government has reduced sugar allowance.\n    Debug.Print \"New govt. limits...\"\n    m.SendSugarLimit 200\n\n    'Phew what a scorcher - the fudge is melting in my pocket.\n    Debug.Print \"Sweet alarm...\"\n    weightSweet.OhNoItsMelting\nEnd Sub\n</code></pre>\n\n<p>\u2026 and the output looks like this:</p>\n\n<blockquote>\n  <p>New govt. limits...</p>\n  \n  <p>Max Gobstoppers: 40.</p>\n  \n  <p>Max Wine Gums: 100.</p>\n  \n  <p>Max Sherbert: 250g.</p>\n  \n  <p>Max Fudge: 400g.</p>\n  \n  <p>Sweet alarm...</p>\n  \n  <p>Fudge is melting. Eat Wine Gums now!</p>\n  \n  <p>Fudge is melting. Eat Fudge now!</p>\n</blockquote>\n"}], "owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 57318737, "answer_count": 1, "score": 0, "last_activity_date": 1564707641, "creation_date": 1564578191, "last_edit_date": 1564578644, "question_id": 57291397, "link": "https://stackoverflow.com/questions/57291397/how-to-handle-a-function-where-the-returned-value-type-is-not-known-at-run-time", "title": "How to handle a function where the returned value type is not known at run-time (Object or Non-Object)", "body": "<p>This question centers around the return value of a call to <code>CallByName</code>. I have a class called <code>PropertyPtr</code> which is meant to act as a generic pointer to an object property. It holds a reference to an Object, and the name of one of its properties. It exposes a Getter and Setter method.</p>\n\n<p><code>PropertyPtr</code>:</p>\n\n<pre><code>Option Explicit\n\nPublic Obj As Object\nPublic PropertyName As String\n\nPublic Sub Setter(Val As Variant)\n    If IsObject(Val) Then\n        CallByName Me.Obj, Me.PropertyName, VbSet, Val\n    Else\n        CallByName Me.Obj, Me.PropertyName, VbLet, Val\n    End If\nEnd Sub\n\nPublic Function Getter() As Variant\n    If IsObject(CallByName(Me.Obj, Me.PropertyName, VbGet)) Then\n        Set Getter = CallByName(Me.Obj, Me.PropertyName, VbGet)\n    Else\n        Getter = CallByName(Me.Obj, Me.PropertyName, VbGet)\n    End If\nEnd Function\n</code></pre>\n\n<p>In the Getter, my CallByName could return a object or not. But the only way I can see to test if the CallByName value will be an object is to end up running it twice - once to test inside an <code>IsObject</code> and then again to get a reference to the value. The only other way I could see doing this is trapping for an error. Then, you at least only SOMETIMES run the CallByName twice.</p>\n\n<p>My question is: is there some other way to do this without running CallByName twice?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1564576118, "post_id": 57290607, "comment_id": 101075939, "body": "You need to replace the value<code>FieldRange.Value = &quot;WORKS&quot;</code> inside the loop. Otherwise it will loop endless if it only occurs once because it will always find the same address and <code>FieldRange.Address = FirstAddress</code> is always true."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1564576151, "post_id": 57290607, "comment_id": 101075953, "body": "<code>Do While FieldRange.Address = FirstAddress</code> - if the value only exists once your loop will go on forever."}, {"owner": {"reputation": 11, "user_id": 11836773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xFsCQQ-XXic/AAAAAAAAAAI/AAAAAAAAAIk/D2a1zbJZcAA/photo.jpg?sz=128", "display_name": "Darth Vader", "link": "https://stackoverflow.com/users/11836773/darth-vader"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564576363, "post_id": 57290607, "comment_id": 101076075, "body": "@P\u1d07\u029c but if I replace the value in the Loop I would change the thing I don&#39;t want to change"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564576505, "post_id": 57290607, "comment_id": 101076161, "body": "@DarthVader If you asked X but your problem is Y (see <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">What is the X/Y-Problem</a>). Please describe your actual issue and give a full example data and what you expect from your code. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11, "user_id": 11836773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xFsCQQ-XXic/AAAAAAAAAAI/AAAAAAAAAIk/D2a1zbJZcAA/photo.jpg?sz=128", "display_name": "Darth Vader", "link": "https://stackoverflow.com/users/11836773/darth-vader"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564576787, "post_id": 57290607, "comment_id": 101076313, "body": "@P\u1d07\u029c I now found a solution for my Problem but I would like you to look over it if you would have the time for that but thanks for your soulution it gave me an idea"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564577017, "post_id": 57290607, "comment_id": 101076464, "body": "@DarthVader Don&#39;t get what you mean? If you want someone to review your code (and you don&#39;t have an actual issue with the code) have a look at <a href=\"https://codereview.stackexchange.com\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 11, "user_id": 11836773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xFsCQQ-XXic/AAAAAAAAAAI/AAAAAAAAAIk/D2a1zbJZcAA/photo.jpg?sz=128", "display_name": "Darth Vader", "link": "https://stackoverflow.com/users/11836773/darth-vader"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1564577234, "post_id": 57290607, "comment_id": 101076602, "body": "@P\u1d07\u029c I had a problem I now fixed"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1564576249, "creation_date": 1564576249, "answer_id": 57290787, "question_id": 57290607, "link": "https://stackoverflow.com/questions/57290607/delete-old-entry-when-same-data-entered-elsewhere/57290787#57290787", "title": "Delete old entry when same data entered elsewhere?", "body": "<p>You need to replace the value <code>FieldRange.Value = \"WORKS\"</code> inside the loop. Otherwise it will loop endless if it only occurs once because it will always find the same address and <code>FieldRange.Address = FirstAddress</code> is always <code>True</code>.</p>\n\n<p>Also the <code>While</code> should be in the end of the loop, otherwise the first find would not replace.</p>\n\n<p>The following should work:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub One_Find()\n    Dim FieldRange As Range\n    Set FieldRange = Cells.Find(What:=ActiveCell.Value, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)\n\n    If FieldRange Is Nothing Then\n        MsgBox (\"Find failed\")\n        Exit Sub\n    End If\n\n    Dim FirstAddress As String\n    FirstAddress = FieldRange.Address\n\n    Do \n        FieldRange.Value = \"WORKS\"\n        FieldRange = Cells.FindNext(FieldRange)\n    Loop While FieldRange.Address &lt;&gt; FirstAddress\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11836773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xFsCQQ-XXic/AAAAAAAAAAI/AAAAAAAAAIk/D2a1zbJZcAA/photo.jpg?sz=128", "display_name": "Darth Vader", "link": "https://stackoverflow.com/users/11836773/darth-vader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564644474, "creation_date": 1564575586, "last_edit_date": 1564644474, "question_id": 57290607, "link": "https://stackoverflow.com/questions/57290607/delete-old-entry-when-same-data-entered-elsewhere", "title": "Delete old entry when same data entered elsewhere?", "body": "<p>I have a worksheet with 190 names and tables where the people sit.</p>\n\n<p>I would like to automate the action of searching where a person has sat before and deleting the name on the old sitting place when I write in the same name on the new sitting place.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPublic Sub One_Find()\n    Dim Placeholder As Integer\n    Dim FieldRange As Range\n    Set FieldRange = Cells.Find(What:=ActiveCell.Value, LookIn:=xlValues, _\n      LookAt:=xlWhole, SearchOrder:=xlByColumns)\n    Placeholder = 0\n\n    If FieldRange Is Nothing Then\n        MsgBox (\"Find failed\")\n        Exit Sub\n    End If\n\n    Dim FirstAddress As String\n    FirstAddress = FieldRange.Address\n\n    Do While FieldRange.Address = FirstAddress\n        FieldRange = Cells.FindNext(FieldRange)\n        Placeholder = Placeholder + 1\n        If Placeholder = 2000 Then\n            Exit Sub\n        End If\n    Loop\n\n    FieldRange.Value = \"WORKS\"\nEnd Sub\n</code></pre>\n\n<p>Maybe a solution:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPublic Sub One_Find()\n    Dim Placeholder As Integer\n    Dim FieldRange As Range\n    Dim Placeholder2 As String\n    Placeholder2 = ActiveCell.Value\n    Set FieldRange = Cells.Find(What:=Placeholder2, LookIn:=xlValues, _\n      LookAt:=xlWhole, SearchOrder:=xlByColumns)\n    Placeholder = 0\n\n    If FieldRange Is Nothing Then\n        MsgBox (\"Find failed\")\n        Exit Sub\n    End If\n\n    Dim FirstAddress As String\n    FirstAddress = FieldRange.Address\n\n    Do While FieldRange.Address = FirstAddress\n        FieldRange.Value = Placeholder + \".\"\n        FieldRange = Cells.FindNext(FieldRange)\n        Placeholder = Placeholder + 1\n        If Placeholder = 2000 Then\n            Exit Sub\n        End If\n        Loop\n\n    FieldRange.Value = \"WORKS\"\nEnd Sub\n</code></pre>\n\n<p>Placeholder2 would be the Value I would like to search for. </p>\n\n<p>I'm expecting the WORKS instead of the old name but at first it was just loading for like 3 hours until I implemented the time to live as 'Placeholder'</p>\n\n<p>I'm learning VBA, coming from C#.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1564575665, "post_id": 57290433, "comment_id": 101075665, "body": "Instead of <code>Workbooks.Open Filename:=fNameAndPath</code> you should <code>Dim sourceWB as Workbook</code> and <code>Set sourceWB = Workbooks.Open(filename:=fNameAndPath)</code>. Then, at the end of your procedure you can simply do <code>sourceWB.Close</code>"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1564575638, "creation_date": 1564575638, "answer_id": 57290620, "question_id": 57290433, "link": "https://stackoverflow.com/questions/57290433/how-do-i-close-source-file-after-copying/57290620#57290620", "title": "How do I close source file after copying?", "body": "<p>it's safer if you use object variable:  </p>\n\n<pre><code>dim wb as workbook\nset wb = Workbooks.Open(Filename:=fNameAndPath)\n'do your stuff\nwb.close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1564575647, "creation_date": 1564575647, "answer_id": 57290623, "question_id": 57290433, "link": "https://stackoverflow.com/questions/57290433/how-do-i-close-source-file-after-copying/57290623#57290623", "title": "How do I close source file after copying?", "body": "<p>You need to be more precise in which workbook your worksheets are and avoid using <code>ActiveSheet</code> and <code>ActiveWorkbook</code> wherever possible.</p>\n\n<pre><code>Public Sub Load_Loan()\n    Dim fNameAndPath As Variant  \n    fNameAndPath = Application.GetOpenFilename(FileFilter:=\"*.XLS, *CSV\", Title:=\"Select Tape\")\n\n    If fNameAndPath = False Then Exit Sub\n\n    Dim WbSource As Workbook  'reference the opened workbook in a variable that we can use later to access/close it\n    Set WbSource = Workbooks.Open(Filename:=fNameAndPath)\n\n    Dim WbDestination As Workbook\n    Set WbDestination = ThisWorkbook  'or if it is not the workbook this code is in then Workbooks(\"Dashboard.xlsm\")\n\n    'specify a worksheet in the source workbook\n    WbSource.Worksheets(1).Copy After:=WbDestination WbDestination.Sheets(WbDestination.Sheets.Count)\n    WbSource.Close SaveChanges:=False   'close and don't save\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8446805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ce6fa23232113af13babd06d5f40e7?s=128&d=identicon&r=PG&f=1", "display_name": "PokerMaster", "link": "https://stackoverflow.com/users/8446805/pokermaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564575647, "creation_date": 1564574947, "last_edit_date": 1564575047, "question_id": 57290433, "link": "https://stackoverflow.com/questions/57290433/how-do-i-close-source-file-after-copying", "title": "How do I close source file after copying?", "body": "<p>I'm trying to close the original source file after copying it to my Dashboard. How do I do it?</p>\n\n<pre><code>Sub Load_Loan()\n    Dim fNameAndPath As Variant  \n    fNameAndPath = Application.GetOpenFilename(FileFilter:=\"*.XLS, *CSV\", Title:=\"Select Tape\")\n\n    If fNameAndPath = False Then Exit Sub\n\n    Workbooks.Open Filename:=fNameAndPath\n    ActiveSheet.Copy After:=Workbooks(\" Dashboard.xlsm\").Sheets(Workbooks(\" Dashboard.xlsm\").Worksheets.Count)\n    ActiveWorkbook.Close\n\n    Workbooks(\" Dashboard.xlsm\").Activate\n</code></pre>\n\n<p>I had to debug</p>\n"}, {"tags": ["excel", "vba", "dictionary", "nested"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564576758, "post_id": 57290411, "comment_id": 101076301, "body": "Instances of reference types are never copied on assignment or when passed as arguments, regardless of <code>ByVal</code> or <code>ByRef</code>. A class is a reference type. A dictionary is a class."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564577510, "post_id": 57290411, "comment_id": 101076790, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/4805475/11683\">Assignment of objects in VB6</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1564577709, "post_id": 57290411, "comment_id": 101076907, "body": "Because you want to clone a dictionary, which is a class that is not under your control, you will need to manually clone it (create a new dictionary and add all keys and values from the original dictionary). Note that this will create a shallow copy, that is, the dictionary will be different, but if the values contained in the dictionary are themselves reference types, the two dictionaries will refer to the same instances of the data, and you would need to clone them too."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1564581572, "post_id": 57290411, "comment_id": 101079406, "body": "Replace both <code>.RemoveAll</code> by <code>Set ... = New Scripting.Dictionary</code> to create new references. Though you should avoid nesting dictionaries. For instance, if your goal is to get a value by name,section,key then store all the values in a single dictionary: <code>dict.Add name &amp; &quot;|&quot; &amp; section &amp; &quot;|&quot; &amp; key, Value</code>"}, {"owner": {"reputation": 188, "user_id": 11363139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500985081bae3544736a9d937ad75932?s=128&d=identicon&r=PG&f=1", "display_name": "mrt", "link": "https://stackoverflow.com/users/11363139/mrt"}, "edited": false, "score": 0, "creation_date": 1564582456, "post_id": 57290411, "comment_id": 101080000, "body": "alright, in between I found that out on my own, replacing <code>.RemoveAll</code> with <code>Set dict = Nothing</code> and <code>Set dict = New Scripting.Dictionary</code> after that worked out. Do you know if it makes a difference for resources used if I destroy the object first and create a new one, or if I directly create a new one like you suggested? Why should I avoid nested dictionaries? I did not want to join a string together, as those values are numerous and can have several special characters so it would be hard to find a delimiter."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1564584762, "post_id": 57290411, "comment_id": 101081554, "body": "Of course it makes a difference whether or not you are destroying objects. The thing is, you are <a href=\"https://stackoverflow.com/a/19038890/11683\">not destroying them</a> either way. <code>middledict</code> keeps the references to all your <code>innerdict</code>s, otherwise how would you be able to retrieve them later?"}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1564622540, "creation_date": 1564622540, "answer_id": 57300703, "question_id": 57290411, "link": "https://stackoverflow.com/questions/57290411/vba-how-to-build-up-nested-dictionaries-in-a-loop-byval/57300703#57300703", "title": "VBA: How to build up nested dictionaries in a loop (ByVal?)", "body": "<p>Knowing what you want to do with your data would have quite a bearing on the solution. FlorentB's suggestion of a delimited key is appealing if you simply want to retrieve single data items. If you want to iterate data within those lists, then nested dictionaries are probably the way to go.</p>\n\n<p>For nested dictionaries, as you've seen, a reference to the object is stored. So you'd need to create a new instance of a dictionary for each nested dictionary. Some skeleton code, then, would look like this:</p>\n\n<pre><code>Dim v As Variant\nDim r As Long, c As Long\nDim nameDic As Dictionary, secDic As Dictionary, valDic As Dictionary\n\n'Find area of data.\nWith Sheet1\n    r = .Cells(.Rows.Count, 1).End(xlUp).Row\n    c = .Cells(2, .Columns.Count).End(xlToLeft).Column\n    v = .Range(.Cells(1, 1), .Cells(r, c)).Value2\nEnd With\n\n'Populate dictionaries.\nSet nameDic = New Dictionary\nFor r = 3 To UBound(v, 1)\n    Set secDic = New Dictionary\n    nameDic.Add v(r, 1), secDic\n    For c = 2 To UBound(v, 2)\n        If Not IsEmpty(v(1, c)) Then\n            'It's a new section.\n            Set valDic = New Dictionary\n            secDic.Add v(1, c), valDic\n        End If\n        valDic.Add v(2, c), v(r, c)\n    Next\nNext\n\n'Single data items can be retrieved like so:\nDebug.Print nameDic(\"name 2\")(\"section 2\")(\"key 4\")\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 11363139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/500985081bae3544736a9d937ad75932?s=128&d=identicon&r=PG&f=1", "display_name": "mrt", "link": "https://stackoverflow.com/users/11363139/mrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 319, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564622540, "creation_date": 1564574848, "last_edit_date": 1564576545, "question_id": 57290411, "link": "https://stackoverflow.com/questions/57290411/vba-how-to-build-up-nested-dictionaries-in-a-loop-byval", "title": "VBA: How to build up nested dictionaries in a loop (ByVal?)", "body": "<p>I am exporting several INI-files from an Excel Spreadsheet, where one line means one INI-file, the INI-sections and keys are the columns. This works quite well so far, except it seems VBA is passing dictionaries ByRef (?), but let me explain:<br><br>\nThe Excel Spreadsheet looks like this:</p>\n\n<pre><code>       |       section 1       |   section 2   |  section 3  | ...\n       | key1  | key2  | key3  | key4  | key3  |  ...\nname 1 | value | value | value | value | value |  ...\nname 2 | value | value | value | value | value |  ...\n...\n</code></pre>\n\n<p>I get all INI-sections, keys and values dynamically from spreadsheet, that's why I decided not to build a class module but to set up a dictionary structure with 3 nested dictionaries like this:<br><br>\n<strong>innerdict</strong>: holds key/value pairs of one section<br>\n<strong>middledict</strong>: holds section name and innerdict with key/value pairs<br>\n<strong>outerdict</strong>: holds line name with middledict<br><br>\nThe following simplified code should do to explain my situation:</p>\n\n<pre><code>Set outerDict = New Scripting.Dictionary\nSet middleDict = New Scripting.Dictionary\nSet innerDict = New Scripting.Dictionary\n\nFor row = 3 to 10\nFor col = 1 to 5\n  key = Cells(a,b).Value\n  value = Cells(x,y).Value\n  innerdict.Add key, value\n\n  If nextSectionGroup Then\n    middledict.Add sectionName, innerdict\n    innerdict.RemoveAll\n  End If\nNext col\n\nouterdict.Add linename, middledict\nmiddledict.RemoveAll\n\nNext row\n</code></pre>\n\n<p>In words:<br>\nStarting in the first value row, I loop through columns, fill key/value pairs in the innerdict until I hit the end of a section.</p>\n\n<p>Then I <em>(want to)</em> copy the <code>innerdict</code> into the <code>middledict</code> and after that delete the content of <code>innerdict</code> so it can be used for the next section. If I hit the end of the entire row, I copy the <code>middledict</code> into the <code>outerdict</code> and delete the content of <code>middledict</code> so it can be used for next row.</p>\n\n<p>But after running the above code, the <code>middledict</code> and <code>innerdict</code> are not accessible via the <code>outerdict</code>, it seems they are just empty. If I delete those <em>.RemoveAll</em> statements, the code works fine but fills the dicts with wrong content.</p>\n\n<p>It seems to me, that <em>dict.Add</em> does not copy the content to the parent dict, but makes a reference. That would explain why content is empty after the <code>.RemoveAll</code>.</p>\n\n<p>But how to solve it, may someone have a hint please?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "graph", "charts", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1564577729, "creation_date": 1564577729, "answer_id": 57291250, "question_id": 57290118, "link": "https://stackoverflow.com/questions/57290118/modify-treemap-chart-in-powerpoint/57291250#57291250", "title": "Modify Treemap-Chart in PowerPoint", "body": "<p>Sorry, the treemap chart style is fairly new and has not been included in the VBA object model.</p>\n"}], "owner": {"reputation": 73, "user_id": 11713144, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LA1C6H-ro_g/AAAAAAAAAAI/AAAAAAAABrQ/V5RP76LkGgw/photo.jpg?sz=128", "display_name": "Bartek", "link": "https://stackoverflow.com/users/11713144/bartek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564577729, "creation_date": 1564573944, "last_edit_date": 1564575489, "question_id": 57290118, "link": "https://stackoverflow.com/questions/57290118/modify-treemap-chart-in-powerpoint", "title": "Modify Treemap-Chart in PowerPoint", "body": "<p>I have a chart that I modify with VBA by changing the values from an excel-workbook. Everything works fine, but I want to use the <code>treemap-chart</code> where suddenly the code stops working. </p>\n\n<p>The code works perfectly fine with the other charts in PowerPoint but when I change it to <code>TreeMap</code> the Code stops executing and the chart doesn't change it values.</p>\n\n<pre><code>Option Explicit\n\nSub Chart_TT()\n\n With ActivePresentation.Slides(2).Shapes(\"Chart 1\").Chart.ChartData\n    .Activate\n    .Workbook.Sheets(2).Range(\"C2\").Value = .Workbook.Sheets(2).Range(\"I9\").Value\n    .Workbook.Sheets(2).Range(\"D2\").Value = .Workbook.Sheets(2).Range(\"J9\").Value\n    .Workbook.Sheets(2).Range(\"E2\").Value = .Workbook.Sheets(2).Range(\"K9\").Value\n    .Workbook.Sheets(2).Range(\"F2\").Value = .Workbook.Sheets(2).Range(\"L9\").Value\n    .Workbook.Close SaveChanges:=True\n End With\n\nEnd Sub\n</code></pre>\n\n<p>The error code which is shown is:</p>\n\n<blockquote>\n  <p>\"Error -2147467259 (80004005): The method \"workbook\" for the object \"ChartData\" failed.</p>\n</blockquote>\n\n<p>What do I have to change that the code also works with the TreeMap chart?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1564572799, "post_id": 57289723, "comment_id": 101074087, "body": "What is <code>indexdataname</code>? It is not defined. Same with <code>dataname</code>. Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 65, "user_id": 11513625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a3f335914d02a1b145eaa807cc8f71?s=128&d=identicon&r=PG&f=1", "display_name": "borneo", "link": "https://stackoverflow.com/users/11513625/borneo"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564573013, "post_id": 57289723, "comment_id": 101074217, "body": "dataname and indexdataname from define name. dataname A1: C15, indexdataname A1: A15"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 11513625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a3f335914d02a1b145eaa807cc8f71?s=128&d=identicon&r=PG&f=1", "display_name": "borneo", "link": "https://stackoverflow.com/users/11513625/borneo"}, "edited": false, "score": 1, "creation_date": 1564574097, "post_id": 57289909, "comment_id": 101074823, "body": "Your explanation is very perfect, complete with comments and very helpful for me who is still a layman studying excel. Once again, thank you"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1564573208, "creation_date": 1564573208, "answer_id": 57289909, "question_id": 57289723, "link": "https://stackoverflow.com/questions/57289723/reference-to-use-index-formula-and-name-in-vba-excel/57289909#57289909", "title": "Reference to use index formula and name in VBA Excel", "body": "<p>I assume <code>indexdataname</code> and <code>dataname</code> are named ranges.</p>\n\n<p>It would work with something like below:</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\") 'define sheet name\n\nDim Dataname As Range\nSet Dataname = ws.Range(\"dataname\")\n\nDim IndexDataname As Range\nSet IndexDataname = ws.Range(\"indexdataname\")\n\nDim MatchedRow As Double\nOn Error Resume Next 'next line throws error if no match is found\nMatchedRow = Application.WorksheetFunction.Match(SpinButton1.Value, IndexDataname, 0)\nOn Error Goto 0 'always re-activate error reporting !!!\n\n'test if something matched\nIf MatchedRow = 0 Then\n    MsgBox \"Nothing matched\", vbCritical\n    Exit Sub\nEnd If\n\nTextbox1 = Application.WorksheetFunction.Index(Dataname, MatchedRow, 9)\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11513625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a3f335914d02a1b145eaa807cc8f71?s=128&d=identicon&r=PG&f=1", "display_name": "borneo", "link": "https://stackoverflow.com/users/11513625/borneo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57289909, "answer_count": 1, "score": 0, "last_activity_date": 1564573208, "creation_date": 1564572538, "last_edit_date": 1564573118, "question_id": 57289723, "link": "https://stackoverflow.com/questions/57289723/reference-to-use-index-formula-and-name-in-vba-excel", "title": "Reference to use index formula and name in VBA Excel", "body": "<p>I want to ask, how about the code in writing VBA Excel like this.</p>\n\n<pre><code>Textbox1=Application.WorksheetFunction.Index(dataname, Application.WorksheetFunction.Match(SpinButton1.Value, indexdataname, 0), 3)\n</code></pre>\n\n<p>In simple formulas on sheets like </p>\n\n<pre><code>=INDEX(dataname,MATCH(number,indexdataname,0),3)\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1564572329, "post_id": 57289474, "comment_id": 101073840, "body": "The common sense would suggest that you need this on your report computer... as you can send the email to it to &quot;Reinicia todo&quot;."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1564572477, "post_id": 57289474, "comment_id": 101073917, "body": "That&#39;s what I did, outlook won&#39;t share the code to the other computer then?"}], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567969475, "creation_date": 1564571632, "last_edit_date": 1567969475, "question_id": 57289474, "link": "https://stackoverflow.com/questions/57289474/running-a-macro-in-specific-computer-if-the-same-outlook-session-is-open-on-two", "title": "Running a macro in specific computer if the same Outlook session is open on two computers", "body": "<p>I have two computers, one handling automated reports and sending emails, and one where I do my work. Both have Outlook open with my session.</p>\n\n<p>Sometimes office updates, or an external app crashes and my automated reports are done.</p>\n\n<p>I found code which will help restarting everything by receiving an email with a certain subject.</p>\n\n<p>Will Outlook run the macro on the report computer or my working computer?</p>\n\n<p>Can I force it to run on the report computer?</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_NewMail()\n\n    Dim exApp As New Excel.Application\n    Dim wb As Excel.Workbook\n\n    Dim Msg As Outlook.MailItem\n\n    Set Msg = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Items.GetLast\n    If Msg.Subject = \"Reinicia todo\" Then\n        CerrarProcesos\n        Set wb = exApp.Workbooks.Open(\"C:\\Users\\UserName\\Desktop\\Alertas Renfe.xlsb\")\n        exApp.Visible = True\n    End If\n\nEnd Sub\n\n\nSub CerrarProcesos()\n\n    Dim oServ As Object\n    Dim cProc As Variant\n    Dim oProc As Object\n\n    Set oServ = GetObject(\"winmgmts:\")\n    Set cProc = oServ.ExecQuery(\"Select * from Win32_Process\")\n\n    For Each oProc In cProc 'Case Sensitive\n        If oProc.Name Like \"Acs*.exe\" Or oProc.Name Like \"acs*.exe\" Or oProc.Name Like \"ACS*.exe\" Or oProc.Name Like \"EXCEL*\" Then\n          oProc.Terminate\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1564574146, "creation_date": 1564574146, "answer_id": 57290183, "question_id": 57288875, "link": "https://stackoverflow.com/questions/57288875/disable-warning-about-a-program-trying-to-send-an-email/57290183#57290183", "title": "Disable warning about a program trying to send an email", "body": "<p>The common way to solve this is to install and use <a href=\"http://www.dimastr.com/redemption/home.htm\" rel=\"nofollow noreferrer\">Outlook Redemption </a>.</p>\n\n<p>Another method is to bypass Outlook completely and send via <em>SMTP</em>, but that is another story and requires a lot more code.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "edited": false, "score": 0, "creation_date": 1564647652, "post_id": 57295417, "comment_id": 101102269, "body": "Thanks for your answer but how i develop a COM add-in to make this possible?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "edited": false, "score": 0, "creation_date": 1564652098, "post_id": 57295417, "comment_id": 101104655, "body": "See <a href=\"https://docs.microsoft.com/en-us/visualstudio/vsto/walkthrough-creating-your-first-vsto-add-in-for-outlook?view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/visualstudio/vsto/&hellip;</a>"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1564591051, "creation_date": 1564591051, "answer_id": 57295417, "question_id": 57288875, "link": "https://stackoverflow.com/questions/57288875/disable-warning-about-a-program-trying-to-send-an-email/57295417#57295417", "title": "Disable warning about a program trying to send an email", "body": "<p>You get a standard security prompt in Outlook.</p>\n\n<p>There are several ways for supressing such prompts:</p>\n\n<ol>\n<li><p>Use a third-party components for supressing Outlook security warnings. See <a href=\"https://www.add-in-express.com/outlook-security/index.php\" rel=\"nofollow noreferrer\">Security Manager for Microsoft Outlook</a> for more information.</p></li>\n<li><p>Use a low-level API instead of OOM. Or any other third-party wrappers around that API, for example, Redemption.</p></li>\n<li><p>Develop a COM add-in which has access to the trusted Application object.</p></li>\n<li><p>Use group policy objects for setting up machines.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "is_accepted": true, "score": 0, "last_activity_date": 1564660379, "creation_date": 1564660379, "answer_id": 57308443, "question_id": 57288875, "link": "https://stackoverflow.com/questions/57288875/disable-warning-about-a-program-trying-to-send-an-email/57308443#57308443", "title": "Disable warning about a program trying to send an email", "body": "<p>The warning appears for using DoCmd.sendObject to send an email, so instead of downloading thir party components. </p>\n\n<p>I just not used doCmd.sendObjects and used a function like this: </p>\n\n<pre><code> Public Function CreateNewMessage()\n Dim objMsg As MailItem\n\n Set objMsg = Application.CreateItem(olMailItem)\n\n With objMsg\n.To = \"Alias@domain.com\"\n.CC= \"Alias2@domain.com\"\n.BCC = \"Alias3@domain.com\"\n.Subject = \"This is the subject\"\n.Categories = \"Test\"\n.VotingOptions = \"Yes;No;Maybe;\"\n.BodyFormat = olFormatPlain ' send plain text message\n.Importance = olImportanceHigh\n.Sensitivity = olConfidential\n.Attachments.Add (\"path-to-file.docx\")\n\n' Calculate a date using DateAdd or enter an explicit date\n.ExpiryTime = DateAdd(\"m\", 6, Now) '6 months from now\n.DeferredDeliveryTime = #8/1/2012 6:00:00 PM#\n\n.Display\nEnd With\n\nSet objMsg = Nothing\nEnd Function\n</code></pre>\n\n<p>Thank you so much</p>\n"}], "owner": {"reputation": 55, "user_id": 8925147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760a07d02753b53efaf2e9e42504f238?s=128&d=identicon&r=PG&f=1", "display_name": "Adriiboom", "link": "https://stackoverflow.com/users/8925147/adriiboom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 57308443, "answer_count": 3, "score": 1, "last_activity_date": 1594548763, "creation_date": 1564569592, "last_edit_date": 1594548763, "question_id": 57288875, "link": "https://stackoverflow.com/questions/57288875/disable-warning-about-a-program-trying-to-send-an-email", "title": "Disable warning about a program trying to send an email", "body": "<p>I send an email using Outlook 2010 with Access VBA.</p>\n\n<p>I get a warning from Microsoft Outlook about a program trying to send an email and I'm forced to push allow.</p>\n\n<p>I have the Microsoft Outlook Object Library 14 from the reference in VBA.</p>\n\n<p>In Outlook - Options - access through programin is marked on don't show warnings.</p>\n\n<p>I added the next entries in regedit </p>\n\n<pre><code>Key: HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\ \n&lt;version&gt;\\Outlook\\Security\nValue name: AdminSecurityMode\nValue type: REG_DWORD\nValue: 3\n\nKey: HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\ \n&lt;version&gt;\\Outlook\\Security\nValue name: PromptOOMSend\nValue name: PromptOOMAddressBookAccess\nValue name: PromptOOMAddressInformationAccess\nValue name: PromptOOMMeetingTaskRequestResponse\nValue name: PromptOOMSaveAs\nValue name: PromptOOMFormulaAccess\nValue name: PromptSimpleMAPISend\nValue name: PromptSimpleMAPINameResolve\nValue name: PromptSimpleMAPIOpenMessage\nValue type: REG_DWORD\nValue: 2\n</code></pre>\n\n<p>I also add DoCmd.SetWarnings False in the email function.</p>\n\n<p>How to disable this warning?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564570882, "post_id": 57288735, "comment_id": 101072985, "body": "Apply a Formula on Sheet2 Column A. <code>=Sheet1!A1</code> and drag it down."}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564571133, "post_id": 57288735, "comment_id": 101073139, "body": "See comment on the answer by chucklukowski"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564571122, "post_id": 57289261, "comment_id": 101073132, "body": "I tried this one, I&#39;m having 2 issues with it. It does bring across the value correctly, but when I drag it down it just duplicates the same value, it doesn&#39;t match what is on Sheet1. But more importantly, if I then go and change the value in Sheet1, it doesn&#39;t change it on Sheet2"}, {"owner": {"reputation": 1695, "user_id": 666246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4faf37bc3c0c00aae4e6ccd72977507b?s=128&d=identicon&r=PG", "display_name": "chucklukowski", "link": "https://stackoverflow.com/users/666246/chucklukowski"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564571487, "post_id": 57289261, "comment_id": 101073340, "body": "Is the Formula -&gt; Calculation Options set to Automatic? Also, what is the formula you have in B1 after dragging the formula down?"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564573014, "post_id": 57289261, "comment_id": 101074218, "body": "Is there a way to apply that to the entire column? Or at least the length of where the data is coming from on Sheet1? This is so if people are adding data into Sheet1, they don&#39;t need to drag it down on Sheet2, it should just appear"}, {"owner": {"reputation": 1695, "user_id": 666246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4faf37bc3c0c00aae4e6ccd72977507b?s=128&d=identicon&r=PG", "display_name": "chucklukowski", "link": "https://stackoverflow.com/users/666246/chucklukowski"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564573679, "post_id": 57289261, "comment_id": 101074588, "body": "Would depend on what your process is. Can you put the formula before they get the file?"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564574276, "post_id": 57289261, "comment_id": 101074908, "body": "I ended up just doing it for 1000 rows and when it produced 0&#39;s I edited the formatting so it took them away - seems to have sorted it!"}, {"owner": {"reputation": 1695, "user_id": 666246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4faf37bc3c0c00aae4e6ccd72977507b?s=128&d=identicon&r=PG", "display_name": "chucklukowski", "link": "https://stackoverflow.com/users/666246/chucklukowski"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564574753, "post_id": 57289261, "comment_id": 101075175, "body": "=IF(ISBLANK(Sheet1!A1),&quot;&quot;,Sheet1!A1)"}, {"owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564578714, "post_id": 57289261, "comment_id": 101077511, "body": "This turns the 0 into &#39;True&#39;"}, {"owner": {"reputation": 1695, "user_id": 666246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4faf37bc3c0c00aae4e6ccd72977507b?s=128&d=identicon&r=PG", "display_name": "chucklukowski", "link": "https://stackoverflow.com/users/666246/chucklukowski"}, "reply_to_user": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "edited": false, "score": 0, "creation_date": 1564592939, "post_id": 57289261, "comment_id": 101085859, "body": "Might have a typo, IF Sheet1A1 is Blank, THEN return empty string &quot;&quot;, ELSE return the value in Sheet1A1. If you changed your formatting previously, that might be changing your result, now?"}], "tags": [], "owner": {"reputation": 1695, "user_id": 666246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4faf37bc3c0c00aae4e6ccd72977507b?s=128&d=identicon&r=PG", "display_name": "chucklukowski", "link": "https://stackoverflow.com/users/666246/chucklukowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1564570935, "creation_date": 1564570935, "answer_id": 57289261, "question_id": 57288735, "link": "https://stackoverflow.com/questions/57288735/excel-mirrored-cells-from-one-column-to-another-changes-reflect-automatically/57289261#57289261", "title": "Excel: Mirrored cells from one column to another, changes reflect automatically", "body": "<p>On <code>Sheet2!A1</code> put the formula <code>=Sheet1!A1</code> and drag down. Should mirror the column from Sheet1. This will mirror the column and will update on any changes. Only issue I can think of is that deleting/inserting rows might cause problems.</p>\n"}], "owner": {"reputation": 109, "user_id": 4595147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336302f2c784b65433e402bef2ec92b6?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4595147/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 57289261, "answer_count": 1, "score": 0, "last_activity_date": 1564570935, "creation_date": 1564569147, "question_id": 57288735, "link": "https://stackoverflow.com/questions/57288735/excel-mirrored-cells-from-one-column-to-another-changes-reflect-automatically", "title": "Excel: Mirrored cells from one column to another, changes reflect automatically", "body": "<p>I thought this would be a simple one but I can't seem to find the answer online. I have a column of data on Sheet1 (column A) and I'd like column A on Sheet2 to be exactly the same and any changes made to Sheet1 Column A will automatically be reflected in the mirrored Sheet2 Column a. Is there any way to do this other than VBA WorksheetChange?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 2, "creation_date": 1564569720, "post_id": 57288690, "comment_id": 101072343, "body": "If properly designed, multiple users can input data."}, {"owner": {"reputation": 5, "user_id": 11539406, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4_mh-PLY7tQ/AAAAAAAAAAI/AAAAAAAACho/tIz50IZ5sTY/photo.jpg?sz=128", "display_name": "Atul", "link": "https://stackoverflow.com/users/11539406/atul"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1564577852, "post_id": 57288690, "comment_id": 101076991, "body": "Hi @Gustav thank you for your reply. Could you please be more specific on the part of designing? - Thanks"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1564579039, "post_id": 57288690, "comment_id": 101077696, "body": "I could, but that is way to broad a topic for this forum. You could try at <a href=\"https://www.experts-exchange.com\" rel=\"nofollow noreferrer\">Experts Exchange</a>."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564593399, "post_id": 57288690, "comment_id": 101086056, "body": "Each user should run their own copy of frontend."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 13795378, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-g_v1TLqLsY8/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckXLQUQL7x77_yhk_lVHEZ5KxRupw/photo.jpg?sz=128", "display_name": "bigjoepro75", "link": "https://stackoverflow.com/users/13795378/bigjoepro75"}, "is_accepted": false, "score": 0, "last_activity_date": 1594561544, "creation_date": 1594561544, "answer_id": 62861850, "question_id": 57288690, "link": "https://stackoverflow.com/questions/57288690/allow-multiple-users-to-fill-form-in-ms-access-or-html-form-based-submission/62861850#62861850", "title": "Allow multiple users to fill form in MS Access or HTML Form based submission", "body": "<p>This is the same type of setup I use at my company. We have one backend (all the tables) and a frontend (queries, forms, reports, etc). The way to allow multiple users to work with the database is to have each user run their own instance on their computer ie have them copy/paste the frontend to their local desktop. Another thing to keep in mind is that the tables must be set up with primary key and autonumber field to prevent users from accessing and editing the same record.</p>\n"}], "owner": {"reputation": 5, "user_id": 11539406, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4_mh-PLY7tQ/AAAAAAAAAAI/AAAAAAAACho/tIz50IZ5sTY/photo.jpg?sz=128", "display_name": "Atul", "link": "https://stackoverflow.com/users/11539406/atul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594635128, "creation_date": 1564568994, "last_edit_date": 1594635128, "question_id": 57288690, "link": "https://stackoverflow.com/questions/57288690/allow-multiple-users-to-fill-form-in-ms-access-or-html-form-based-submission", "title": "Allow multiple users to fill form in MS Access or HTML Form based submission", "body": "<p>I'll summarize the operation to give you a background. \nI've an Access database in place with forms wherein a user inputs with diverse fields. This file is hosted on a shared network for my organization. The database is split between backend and frontend. </p>\n\n<p>Issue(s): \n- Multiple user cannot access a single form and simultaneous entries are not allowed. \n- In case, if the file is opened by mistake it will prevent to enable submissions for other users on the network. </p>\n\n<p>I am not sure if this will work as I am a newbie in Access. But can we create a HTML based form which will fill the tables in Access? If yes, kindly help in creating one. If not, kindly suggest an alternative.</p>\n\n<p>Sample table attributes: </p>\n\n<pre><code>Date Name Type Remark\n</code></pre>\n"}, {"tags": ["excel", "vba", "merge", "cell"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564569067, "post_id": 57288648, "comment_id": 101072006, "body": "What&#39;s going wrong? Where is your issue? Did you get any errors? Please give more information and ask a question (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>). Throwing in the code and say <i>&quot;please fix it for me&quot;</i> will not work here."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1564569488, "post_id": 57288648, "comment_id": 101072224, "body": "Why did you change your text data and results into a screenshot?  It is much simpler to copy/paste text data into excel than to have to copy a screenshot manually, in order to help in troubleshooting."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 2, "creation_date": 1564573038, "post_id": 57288648, "comment_id": 101074234, "body": "Also, is there really a need to merge cells. This rarely is a good choice, seeing that  interaction with merged cells is almost always troublesome."}], "answers": [{"tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 0, "last_activity_date": 1564573421, "creation_date": 1564573421, "answer_id": 57289964, "question_id": 57288648, "link": "https://stackoverflow.com/questions/57288648/merge-cells-with-the-same-value-vba/57289964#57289964", "title": "merge cells with the same value VBA", "body": "<p>Your code is almost correct. The issue is that the value of <code>P</code> is always set to be equal to the first cell <code>Set P = Selection.Cells(1, 1)</code> and it never changes. That is why the second part of your selection (i.e. <code>WqP01650012</code>) doesn't merge.</p>\n\n<p>Try using the following code:</p>\n\n<pre><code>Sub scalanie()\n    Dim P As Range ' deklaracja zmiennej P\n    Dim komorka As Range ' deklaracja kom\u00f3rki\n\n    Application.DisplayAlerts = False\n\n      For Each komorka In Selection       ' dla kazdej kom\u00f3rki w zaznaczeniu\n        On Error Resume Next\n        If komorka.Value = komorka.End(xlUp).Value Then\n            Range(komorka, komorka.Offset(-1, 0)).Merge\n        End If\n        On Error GoTo 0\n      Next komorka  ' przejdz do nastepnej kom\u00f3rki\n\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TOW91.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TOW91.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 11191637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1ef07f999394b231163633653d74f0?s=128&d=identicon&r=PG&f=1", "display_name": "Hanna P", "link": "https://stackoverflow.com/users/11191637/hanna-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1564573421, "creation_date": 1564568820, "last_edit_date": 1564572260, "question_id": 57288648, "link": "https://stackoverflow.com/questions/57288648/merge-cells-with-the-same-value-vba", "title": "merge cells with the same value VBA", "body": "<p>I want to merge cells with the same value. I looked at other topics about this but none are the same.</p>\n\n<pre><code>WI05000002\nWI05000002\nWI05000002\nWI05000002\nWI05000002\nWI05000002\nWI05000002\nWI05000002\nWqP01650012\nWqP01650012\nWqP01650012\nWqP01650012\nWqP01650012\nWqP01650012\nWqP01650012 \n</code></pre>\n\n<p>Input data:<br>\n<a href=\"https://i.stack.imgur.com/3PD3F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3PD3F.png\" alt=\"enter image description here\"></a></p>\n\n<p>Desired result:<br>\n<a href=\"https://i.stack.imgur.com/P2J2w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P2J2w.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub scalanie()\n\n\nDim P As Range ' deklaracja zmiennej P\n  Dim komorka As Range ' deklaracja kom\u00f3rki\n\nApplication.DisplayAlerts = False\n  Set P = Selection.Cells(1, 1)       ' zapami\u0119taj pierwsz\u0105 kom\u00f3rk\u0119 z zaznaczenia\n  For Each komorka In Selection       ' dla ka\u017cdej kom\u00f3rki w zaznaczeniu\n    If komorka = P Then               ' je\u015bli kom\u00f3rka jest taka sama jak P\n      Range(komorka.Offset(0, 0), P).Merge ' scal powy\u017cej kom\u00f3rki do P\n                            ' zapami\u0119taj kom\u00f3rk\u0119\n    End If\n  Next komorka  ' przejd\u017a do nast\u0119pnej kom\u00f3rki\n\n  Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "edited": false, "score": 0, "creation_date": 1564570046, "post_id": 57288491, "comment_id": 101072534, "body": "Where is the location of the &#39;new&#39; column in the source sheet?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1564571299, "post_id": 57288491, "comment_id": 101073231, "body": "It seems that the processing bases on <code>arrData</code>which is read in the line <code>arrData = ActiveWorkbook.Sheets(1).Range(&quot;A1&quot;).CurrentRegion.Value</code>. Add a statement <code>Debug.Print ActiveWorkbook.Sheets(1).Range(&quot;A1&quot;).CurrentRegion.Address</code> and check the result in the immediate Window (Ctrl+G). Does it contain your new column? Do you have any empty column between <code>A</code> and your new column?"}, {"owner": {"reputation": 817, "user_id": 10753968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/epgIK.jpg?s=128&g=1", "display_name": "half of a glazier", "link": "https://stackoverflow.com/users/10753968/half-of-a-glazier"}, "edited": false, "score": 0, "creation_date": 1564576866, "post_id": 57288491, "comment_id": 101076360, "body": "The &#39;new&#39; column was added in the middle of the columns ie between D and F, but I tried adding it in other places as well, without results."}, {"owner": {"reputation": 817, "user_id": 10753968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/epgIK.jpg?s=128&g=1", "display_name": "half of a glazier", "link": "https://stackoverflow.com/users/10753968/half-of-a-glazier"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1564577191, "post_id": 57288491, "comment_id": 101076580, "body": "@FunThomas I added <code>Debug.Print ActiveWorkbook.Sheets(1).Range(&quot;A1&quot;).CurrentRegion.Address</code> and I get Compile error: Invalid or unqualified reference"}], "owner": {"reputation": 817, "user_id": 10753968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/epgIK.jpg?s=128&g=1", "display_name": "half of a glazier", "link": "https://stackoverflow.com/users/10753968/half-of-a-glazier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564568353, "creation_date": 1564568353, "question_id": 57288491, "link": "https://stackoverflow.com/questions/57288491/why-is-excel-macro-ignoring-newly-added-column", "title": "Why is Excel macro ignoring newly added column", "body": "<p>I have an Excel macro used to create flash cards, that copies all data in the selected spreadsheet to another spreadsheet, and multiplies the rows in groups of 4. This is so it can be easily mail merged into Word for double-sided printing.\nI added a new column of data to the sheet, but when I run the macro, it completely ignores it and only processes the already existent columns.</p>\n\n<p>I'm familiar in C# but not Visual Basic, which means that while I can understand the gist of the macro, I can't edit or add to the code without tediously looking up the use of every keyword in the documentation. (I received the macro from a VB programmer.)</p>\n\n<p>I'm not sure which part of the code is needed to fix this problem, so here's the whole sub:<br>\n(I renamed some of the variables to make the code easier to read. Eg j => ixLoop)</p>\n\n<pre><code>Sub a()\nDim shtSource As Worksheet, shttarget As Worksheet\nDim arrData As Variant\nSet shtSouce = ActiveWorkbook.Sheets(1)\narrData = ActiveWorkbook.Sheets(1).Range(\"A1\").CurrentRegion.Value\nSet shttarget = ActiveWorkbook.Sheets.Add\nFor ixBound = LBound(arrData, 2) To UBound(arrData, 2) 'i\n    shttarget.Range(\"A1\").Offset(0, ixBound - 1) = arrData(1, ixBound)\nNext ixBound\nquarterOfUBound = Int(UBound(arrData, 1) / 4) 'n\nremOfQuarterOfUBound = UBound(arrData, 1) Mod 4 'm\ncounter = 0 'k\nFor ixLoop = 1 To quarterOfUBound 'j\n    For ixLoop2 = counter + 1 To counter + 4 'r\n        For ixBound = LBound(arrData, 2) To UBound(arrData, 2)\n            shttarget.Range(\"A1\").Offset(ixLoop2 + counter, ixBound - 1) = arrData(ixLoop2 + 1, ixBound)\n        Next ixBound\n    Next ixLoop2\n    For ixLoop2 = 2 To 4 Step 2\n        For ixBound = LBound(arrData, 2) To UBound(arrData, 2)\n            shttarget.Range(\"A1\").Offset(ixLoop * 4 + counter + ixLoop2 - 1, ixBound - 1) = arrData(ixLoop2 + 1 + counter, ixBound)\n        Next ixBound\n    Next ixLoop2\n    For ixLoop2 = 1 To 3 Step 2\n        For ixBound = LBound(arrData, 2) To UBound(arrData, 2)\n            shttarget.Range(\"A1\").Offset(ixLoop * 4 + counter + ixLoop2 + 1, ixBound - 1) = arrData(ixLoop2 + 1 + counter, ixBound)\n        Next ixBound\n    Next ixLoop2\n    counter = counter + 4\nNext ixLoop\n\n\nEnd Sub\n</code></pre>\n\n<p>What code needs to be changed or added to enable the new column to be included in the process?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1564568216, "post_id": 57288225, "comment_id": 101071526, "body": "For starters, don&#39;t use <code>j</code> twice. And I don&#39;t think you need the <code>j</code> loop at all. <code>Instr</code> will just check the presence of the string."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1564568406, "post_id": 57288225, "comment_id": 101071632, "body": "You are incrementing count by one every time a match is found, but it appears you are not using that count anywhere else in your code."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1564568407, "post_id": 57288225, "comment_id": 101071634, "body": "I just deleted an answer, cause actually I got a bit confused. You are looping column AG and you want to color all the words carriere in these cells red? But then I see you copy paste these values and formats to another sheet. Would you be interested in my answer even though I left out the part where you copy/paste?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1564568583, "post_id": 57288225, "comment_id": 101071750, "body": "@Luuklag counr is used at the end of end with So I know How much time the word appear in a String."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1564568857, "post_id": 57288225, "comment_id": 101071901, "body": "@Dorian, you are also taking count with the <code>lr</code>variable, so your doing it twice ;)"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1564568935, "post_id": 57288225, "comment_id": 101071934, "body": "@Luuklag Nop because <code>lr</code> will not be reseted for the next cells ^^ and <code>Count</code> is reseted each cells."}], "answers": [{"comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564585943, "post_id": 57288429, "comment_id": 101082291, "body": "I Solved my issue but this way was faster So i take this one, Thanks you"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1564569294, "last_edit_date": 1564569294, "creation_date": 1564568143, "answer_id": 57288429, "question_id": 57288225, "link": "https://stackoverflow.com/questions/57288225/color-word-if-in-string/57288429#57288429", "title": "Color Word if in String", "body": "<p>Adapted a piece of code I already had, maybe you can use it to draw some ideas from? </p>\n\n<p><a href=\"https://i.stack.imgur.com/OMDeo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OMDeo.png\" alt=\"enter image description here\"></a> </p>\n\n<pre><code>Option Compare Text\n\nSub ColorTag()\n\nDim Tags() As String, Tag As Long, X As Long, Y As Long, ChrPos As Long\nWith ThisWorkbook.Sheets(\"Sheet1\")\n    For X = 5 To .Cells(.Rows.Count, \"AG\").End(xlUp).Row\n        Tags() = Split(.Cells(X, \"AG\"), \" \")\n        For Tag = LBound(Tags) To UBound(Tags)\n            If Tags(Tag) = \"carri\u00e8re\" Or Tags(Tag) = \"carriere\" Then\n                .Cells(X, \"AG\").Interior.ColorIndex = 6\n                Y = InStr(1, .Cells(X, \"AG\"), Tags(Tag))\n                For ChrPos = Y To Y + Len(Tags(Tag)) - 1\n                    .Cells(X, \"AG\").Characters(ChrPos, 1).Font.ColorIndex = 3\n                Next ChrPos\n            End If\n        Next Tag\n    Next X\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/sxmSE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sxmSE.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57288429, "answer_count": 1, "score": 0, "last_activity_date": 1564569294, "creation_date": 1564567500, "question_id": 57288225, "link": "https://stackoverflow.com/questions/57288225/color-word-if-in-string", "title": "Color Word if in String", "body": "<p>I am trying to Color the word \"Carri\u00e8re\" or \"Carriere\" If \"carri\" Exist in Cell.</p>\n\n<p>To do this I Coded this : </p>\n\n<pre><code>For j = 1 To Len(.Cells(I, \"AG\"))\n            If InStr(j, .Cells(I, \"AG\"), \"carri\", vbTextCompare) Then\n                .Cells(I, \"AG\").Interior.ColorIndex = 6\n                count = count + 1\n\n                j = InStr(j, .Cells(I, \"AG\"), \"carri\", vbTextCompare)\n\n\n                .Cells(I, \"AG\").Characters(j, 8).Font.ColorIndex = 3\n                Range(I &amp; \":\" &amp; I).Rows.Copy\n                Sheets(\"Carriere\").Range(\"A\" &amp; lr).PasteSpecial xlPasteValuesAndNumberFormats\n                Sheets(\"Carriere\").Range(\"A\" &amp; lr).PasteSpecial xlPasteFormats\n                lr = lr + 1\n\n            End If\n        Next j\n</code></pre>\n\n<p>Note that this <code>For</code> Is set in a loop with loop like below</p>\n\n<pre><code>    With ws\n        rw = .Range(\"AG\" &amp; .Rows.count).End(xlUp).Row\n        For I = 5 To rw\n         'HERE IS MY FOR LOOP\n\n        Next I\n End With\n</code></pre>\n\n<p><strong>What is doing  this code</strong> : </p>\n\n<p>It <strong>firstly</strong> check if \"carri\" exists in cell, If \"carri\"exists then we will highlight the cell in yellow (<strong>working</strong>)</p>\n\n<p><strong>Then</strong> we would count the number of char before \"carri\"  this variable is called <code>j</code> once we counted it we will color the font in red for the <code>j</code> char (so the first letter of the word \"carri\" ( <strong>c</strong> ) and <strong>7</strong> more char. <code>.Cells(I, \"AG\").Characters(j, 8).Font.ColorIndex = 3</code></p>\n\n<p>But This is <strong>not working</strong> : Sometimes this work and sometimes it color something else ( Often the first word of the string).. </p>\n\n<p>Am I doing something wrong here ?</p>\n"}, {"tags": ["arrays", "excel", "vba", "sorting", "rank"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564566340, "post_id": 57287774, "comment_id": 101070362, "body": "Why aren&#39;t you using formula?"}, {"owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1564568151, "post_id": 57287774, "comment_id": 101071489, "body": "List gets filled by different imports and grows or shrinks, dependingly. Also the values are insert by a makro already so i guess it would make sense to use vba. Lets say its a complex enviorment ^^"}], "owner": {"reputation": 189, "user_id": 10639239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1144623e974f785366d0e177ca82?s=128&d=identicon&r=PG&f=1", "display_name": "G.M", "link": "https://stackoverflow.com/users/10639239/g-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564568074, "creation_date": 1564566081, "last_edit_date": 1564568074, "question_id": 57287774, "link": "https://stackoverflow.com/questions/57287774/give-a-rank-depending-on-values", "title": "Give a rank depending on values", "body": "<p>I have a small problem an hoped you can help me with. A list of mine conatains values and also several empty rows between them. Now I need to give a Rank for each Value.\nSo for example my values are 5, 7 and 10. They would have the ranks 1 (5), 2 (7) and 3 (10)\nIn the same row as 5 the rank 1 should be written in another column.</p>\n\n<p>I have an idea of an solution but it dont seems very practical:\n- go through the list and store all values in an array\n-Sort the array (somehow)\n- go through each line again and if the first value in the array is found, write 1 as rank\n-go through each line and write 2 where the second value is found, write 2 as rank\n-continue for each element in array</p>\n\n<p>This doesnt seem to be smart or quick way to solve my issue.\nAlso I would need to figure out how to sort an array.</p>\n\n<p>I read about the \"Rank\" method but Iam unsure how to use it.</p>\n\n<pre><code>Dim RankingArray As Variant\nDim a As Integer\nDim i As Integer\nDim j As Integer\nDim x As Integer\n\na = 0\nx = 0\nReDim RankingArray(a) As String \n\nFor i = 1 to LastRow\nRankingArray(a) = Cells(i,5).value \n    a = a + 1\n    ReDim Preserve ArrDoneME(a) As String\n\nNext i\n\n'Sort Array magically\n\na = 0\n\nFor j = LBound(RankingArray) To UBound(RankingArray)\n     For i = 1 to LastRow\n         If RankingArray(j) = Cells(i,5).value \n            x = x + 1\n            cells(i,4).value = x\n         End if\n     Next i\nNext j\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1564575455, "post_id": 57287725, "comment_id": 101075568, "body": "Have a look <a href=\"https://support.microsoft.com/en-us/help/210684/copying-worksheet-programmatically-causes-run-time-error-1004-in-excel\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "edited": false, "score": 0, "creation_date": 1564568293, "post_id": 57288138, "comment_id": 101071566, "body": "I understand your point about telling VBA exactly what I want it to do. I will carry out a review of the entire suite of macros to try and spot other instances.I tried your suggestion and it still gave Error 1004. I also tried using ThisWorkbook.Sheets.Count in the After clause and got 1004 again"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "edited": false, "score": 0, "creation_date": 1564568762, "post_id": 57288138, "comment_id": 101071845, "body": "@Peterthehistorian That should not be happening. Do you have anything fancy on those sheets, auto refreshing queries, event handlers?"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "edited": false, "score": 0, "creation_date": 1564570047, "post_id": 57288138, "comment_id": 101072535, "body": "@Peterthehistorian, check the comment by JvdV which gives you a Microsoft link describing said problem."}, {"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564570278, "post_id": 57288138, "comment_id": 101072664, "body": "@GSerg No, nothing other than relatively basic things: For and Do loops, If Then Else End If, a little bit of With. The input, output and target workbooks are simple tabular worksheets. These get Workbook Open, SaveAs and Close. New sheets are added with Sheet Add."}, {"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1564578746, "post_id": 57288138, "comment_id": 101077527, "body": "@AAA I did read JvdV&#39;s link article. The scenario was different. The code example implied that more than 270 worksheets were being added. I was getting the error trying to add the second sheet to ThisWorkbook"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "edited": false, "score": 0, "creation_date": 1564579112, "post_id": 57288138, "comment_id": 101077754, "body": "@Peterthehistorian Another issue you should be considering is the use of <code>.Sheets</code> collection. This is a collection of all <code>worksheets</code> <b>and</b> <code>chart sheets</code>. You are telling VBA to add a new sheet after the <code>worksheets(1)</code>. What if there are no worksheets though in the workbook and there are only chart sheets? It&#39;s probably not your case, but you should consider it nonetheless."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "edited": false, "score": 0, "creation_date": 1564579357, "post_id": 57288138, "comment_id": 101077908, "body": "@Peterthehistorian, it doesn&#39;t necessarily mean you have to add 270 sheets. The article indicates this problem can occur and may do at any time. Why not save after adding the first sheet any way&gt;"}, {"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1564582744, "post_id": 57288138, "comment_id": 101080195, "body": "@Stavros Jon  All the workbooks contain just tabular data, no charts or anything like that. The largest target worksheet has just over 700 rows of 10 columns. None of the worksheets has more than 10 columns of data. The purpose of the macro suite is to copy row contents from one sheet (in the target workbook) to another (in the output workbook) based workbook names, sheetnames and row numbers provided by the input workbook."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1564568679, "last_edit_date": 1564568679, "creation_date": 1564567256, "answer_id": 57288138, "question_id": 57287725, "link": "https://stackoverflow.com/questions/57287725/why-does-the-same-code-sheets-add-exhibit-two-different-behaviours/57288138#57288138", "title": "Why does the same code (Sheets.Add) exhibit two different behaviours?", "body": "<p>Try</p>\n\n<pre><code>Set wsTemp = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Worksheets(1))\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>With ThisWorkbook\n    Set wsTemp = .Sheets.Add(After:=.Worksheets(1))\nEnd With\n</code></pre>\n\n<p>It's a very common problem: When you access an object from Excel (Sheet, Range, ...) and don't specify where it belongs to (eg a Worksheet belongs to a Workbook, a Range belongs to a Worksheet), VBA assumes you are referring to whatever is currently <em>active</em> (currently having the input focus).<br>\nIf you write <code>Worksheets(1)</code>, Excel will translate this to <em>the first worksheet of the current active Workbook</em>. When <code>ThisWorkbook</code> is not the active workbook, this will lead to the situation that you ask Excel to add a sheet to one workbook but put it after the sheet of another workbook - and that's not possible and will throw an error.</p>\n\n<p>VBA beginners will often try to solve this by put <code>activate</code>-statements in the code, but that's the wrong attempt. There is no need to activate anything. Instead, just tell VBA exactly what you want. By writing <code>ThisWorkbook.Worksheets(1)</code>, you specify that you mean the first sheet of <code>ThisWorkbook</code> (which is the WB where the code lives in). The second piece of code (using <code>With</code>) is just another way of writing it - but note that <code>.Worksheet</code> has a leading <code>.</code> that signals that we are accessing the sheet of the Workbook specified in the <code>With</code>-clause.</p>\n\n<p>As a rule of thumb, <strong>never</strong> put anything in your code that let's VBA guess something. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "is_accepted": false, "score": 0, "last_activity_date": 1564579025, "creation_date": 1564579025, "answer_id": 57291704, "question_id": 57287725, "link": "https://stackoverflow.com/questions/57287725/why-does-the-same-code-sheets-add-exhibit-two-different-behaviours/57291704#57291704", "title": "Why does the same code (Sheets.Add) exhibit two different behaviours?", "body": "<p>Having spent an hour or two working through the entire suite of macros, applying the technique suggested by @Fun Thomas, and tidying up some other loose code as I went along, I can no longer reproduce the failure on my most up-to-date version of the macros.</p>\n\n<p>Thank you everybody for your thoughts and suggestions. I will now concentrate on offering further diagnostic data to my very original post about flickering grey screens when opening workbooks. </p>\n"}], "owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564579025, "creation_date": 1564565939, "last_edit_date": 1564566124, "question_id": 57287725, "link": "https://stackoverflow.com/questions/57287725/why-does-the-same-code-sheets-add-exhibit-two-different-behaviours", "title": "Why does the same code (Sheets.Add) exhibit two different behaviours?", "body": "<p>Earlier this morning I asked my first question. Whilst investigating the suggestion put forward by Marco, I encountered a \"does not make sense\" situation. I went back to the immediately previous version of the macro suite to see what behaviour that gave. Let's call these Suite A and Suite B</p>\n\n<p>In both Suite A and B there is the following code:  </p>\n\n<pre><code>Public wsTemp As Worksheet  \nSub DrillDown() \n</code></pre>\n\n<p>In Suite A there is the following:  </p>\n\n<pre><code>Sub HandleNewFileNumber()  \n    If iK &lt;&gt; 0 Then  \n        wbTgt.Close  \n    End If  \n    Set wsTemp = ThisWorkbook.Sheets.Add(After:=Worksheets(1))\n</code></pre>\n\n<p>In Suite B there is:  </p>\n\n<pre><code>Sub HandleNewFileNumber()  \n    If iK &lt;&gt; 0 Then  \n        wbTgt.Close  \n    End If  \n    Set wsTemp = ThisWorkbook.Sheets.Add(After:=Worksheets(1))  \n</code></pre>\n\n<p>No, I have not simply copied the same code twice. I took each piece of code out of the two separate workbooks. The code is identical.</p>\n\n<p>When I run the macro suite A everything runs through to successful completion. When I run macro suite B I get Error 1004. In both cases the Set of wsTemp is the first time wsTemp has been referenced.</p>\n\n<p>I am at a loss to understand how the same code can give two radically different results.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1564566624, "post_id": 57287713, "comment_id": 101070547, "body": "Works for me with a shape. Your With clause is wrong though as <code>x</code> is the shape not a range."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1564566873, "post_id": 57287713, "comment_id": 101070711, "body": "The contents of the <code>With</code> clause is rather pointless as it ultimately returns <code>x.TopLeftCell</code>, <a href=\"https://stackoverflow.com/q/17733541/11683\">making some mistakes</a> in the process. The entire thing should be replaced with <code>x.TopLeftCell.Offset(0,1)</code>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1564572650, "post_id": 57287713, "comment_id": 101074013, "body": "It might help for you to determine exactly what value <code>Application.Caller</code> is returning in your specific scenario. There&#39;s code in the Help topic you could use. Quite possibly, it&#39;s returning something that can&#39;t be assigned to an <code>Object</code>..."}], "owner": {"reputation": 87, "user_id": 5416380, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/52861a17076d915bdb4d2915cc4e6ec9?s=128&d=identicon&r=PG&f=1", "display_name": "JDT", "link": "https://stackoverflow.com/users/5416380/jdt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564574949, "creation_date": 1564565908, "last_edit_date": 1564574949, "question_id": 57287713, "link": "https://stackoverflow.com/questions/57287713/error-91-each-time-i-run-an-application-caller-macro", "title": "Error 91 each time I run an Application.Caller Macro", "body": "<p>I am getting an error when I use <code>Application.Caller</code> in Excel VBA. </p>\n\n<p>I have a piece of code attached to a button/shape that I want to use to print a timestamp in the cell next to the button. </p>\n\n<p>I need to use this button over and over so don't want to reference actual ranges of where to put the timestamp, so I thought this code would work. </p>\n\n<p>However, each time the macro gets to the 2nd line, i.e. the <code>Application.Caller</code> row, it gives me an error:</p>\n\n<blockquote>\n  <p>ERROR 91 : 'Object variable or With block variable not set' </p>\n</blockquote>\n\n<p>I would greatly appreciate if someone could assist with why this is happening as I can't fix it.</p>\n\n<p>Thank you </p>\n\n<p>I have tried <code>activesheet.buttons</code> as well as <code>activesheet.shapes</code> but neither have worked. </p>\n\n<pre><code>Dim x As Object\nSet x = ActiveSheet.Shapes(Application.CALLER)\nWith x.TopLeftCell\nRange(Cells(x.Row, x.Column), Cells(x.Row, x.Column)).Offset(0, 1).Select\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1564564104, "post_id": 57286714, "comment_id": 101069012, "body": "Works fine for me. Are you sure there is no other code running in the same Excel instance when the scheduled time arrives?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564564368, "post_id": 57286714, "comment_id": 101069166, "body": "@JB3872 does <code>Application.OnTime Now + TimeValue(&quot;00:00:15&quot;), &quot;Update&quot;</code> Work for you ?"}, {"owner": {"reputation": 1, "user_id": 11862752, "user_type": "registered", "profile_image": "https://graph.facebook.com/753027278448806/picture?type=large", "display_name": "JB3872", "link": "https://stackoverflow.com/users/11862752/jb3872"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564565449, "post_id": 57286714, "comment_id": 101069835, "body": "@Dorian Yes, it works on the computer in a &quot;simple&quot; excel file that does only that."}, {"owner": {"reputation": 1, "user_id": 11862752, "user_type": "registered", "profile_image": "https://graph.facebook.com/753027278448806/picture?type=large", "display_name": "JB3872", "link": "https://stackoverflow.com/users/11862752/jb3872"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1564565512, "post_id": 57286714, "comment_id": 101069877, "body": "@jkpieterse It is probably something like that. There is no other code running at the same time. The macro is very simple and run well if I remove the Application .Ontime (i.e If I run all routines at the same time). Any idea what could prevent to run Application.Ontime?"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1564572092, "post_id": 57286714, "comment_id": 101073706, "body": "issue with your clock ? is the computer time correct ?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1564572483, "post_id": 57286714, "comment_id": 101073922, "body": "<i>Any idea what could prevent to run Application.Ontime?</i> Application needs to be in <i>Ready</i> mode to execute scheduled code. Operations like: editing cell, opening modal dialog will prevent running schedued code."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1564579709, "post_id": 57286714, "comment_id": 101078141, "body": "Any other VBA code that is running will also delay the start of the timed procedure."}], "owner": {"reputation": 1, "user_id": 11862752, "user_type": "registered", "profile_image": "https://graph.facebook.com/753027278448806/picture?type=large", "display_name": "JB3872", "link": "https://stackoverflow.com/users/11862752/jb3872"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564565855, "creation_date": 1564562871, "last_edit_date": 1564565855, "question_id": 57286714, "link": "https://stackoverflow.com/questions/57286714/application-ontime-is-not-running-at-the-set-time", "title": "Application.Ontime is not running at the set time", "body": "<p>I have a rather odd problem. I am using <code>Application.Ontime TimeValue()</code> to run excel macro at given time (refresh some data and send an email). It used to work great until 3 weeks ago but since, the macro are executed at <code>\"random time\"</code>, i.e with some delay from 1 to 30 minutes. </p>\n\n<p>I tried on 2 computers with up to date windows and <code>Excel 365</code> versions. Issues are the same. All macro run well when I execute them manually or without the <code>Application.Ontime TimeValue()</code>.</p>\n\n<pre><code>Application.OnTime TimeValue(\"16:00:00\"), \"Update\"\nApplication.OnTime TimeValue(\"16:03:00\"), \"SendPDF\"\nApplication.OnTime TimeValue(\"16:04:00\"), \"SaveThisWorkbook\"\n</code></pre>\n\n<p>As said before, I have no error message and the <code>Application. OnTime</code> add some random delay to the execution.\nThank you for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1564562114, "post_id": 57286474, "comment_id": 101067912, "body": "Please read <a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">An image of your code is not helpful</a> then <a href=\"https://stackoverflow.com/posts/57286474/edit\">edit</a> and improve your question: Add your code formatted as code block and also tell in which line you get the error."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1564562825, "post_id": 57286474, "comment_id": 101068327, "body": "use <code>Set FieldRange =........</code> instead of <code>FieldRange =. </code>"}, {"owner": {"reputation": 11, "user_id": 11836773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xFsCQQ-XXic/AAAAAAAAAAI/AAAAAAAAAIk/D2a1zbJZcAA/photo.jpg?sz=128", "display_name": "Darth Vader", "link": "https://stackoverflow.com/users/11836773/darth-vader"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564564891, "post_id": 57286474, "comment_id": 101069497, "body": "@P\u1d07\u029c yeah I excidentlly deleted it I wanted the picture and the Code but thanks for hinting at it"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 2, "last_activity_date": 1564565202, "last_edit_date": 1564565202, "creation_date": 1564565004, "answer_id": 57287431, "question_id": 57286474, "link": "https://stackoverflow.com/questions/57286474/why-is-there-an-object-variable-or-with-block-variable-missing/57287431#57287431", "title": "why is there an Object Variable or With-block variable missing?", "body": "<p>Some general rules:</p>\n\n<ol>\n<li><p>Make sure that your code includes the workbook &amp; the worksheet you want to use. This could be achieved using a <code>With Statement</code></p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Sheet1\")\nEnd With\n</code></pre></li>\n<li><p>Avoid <code>ActiveCell</code> and refer to cell using cell address.</p></li>\n<li><p>Before you use <code>FieldRange</code> make sure that you check if it is <code>Nothing</code> or not.</p>\n\n<pre><code>If FieldRange Is Nothing Then\n    Debug.Print \"Value was not found.\"\nElse\n    Debug.Print \"Value found in :\" &amp; FieldRange.Address\nEnd If\n</code></pre></li>\n<li><p>A <code>Do \u2026 While</code> structure</p>\n\n<pre><code>Do While i &lt; 5\n    i = i + 1\n    MsgBox \"The value of i is : \" &amp; i\nLoop\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1564565104, "creation_date": 1564565104, "answer_id": 57287465, "question_id": 57286474, "link": "https://stackoverflow.com/questions/57286474/why-is-there-an-object-variable-or-with-block-variable-missing/57287465#57287465", "title": "why is there an Object Variable or With-block variable missing?", "body": "<ol>\n<li><p>Your <code>FieldRange</code> is of type <code>Range</code> and therefore it is an object, and objects need to use <code>Set</code></p></li>\n<li><p>After using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Range.Find method</a> you must test if it was successful by testing it for <code>Nothing</code></p></li>\n</ol>\n\n<p>So you end up with \u2026</p>\n\n<pre><code>Option Explicit\n\nPublic Sub One_Find()\n    Dim FieldRange As Range\n    Set FieldRange = Cells.Find(What:=ActiveCell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n\n    If FieldRange Is Nothing\n        MsgBox \"Find failed\"\n        Exit Sub\n    End If\n\n    Dim FirstAddress As String\n    FirstAddress = FieldRange.Address\n\n    Do\n        FieldRange = Cells.FindNext(FieldRange)\n    Loop While FieldRange.Address &lt;&gt; FirstAddress\n\n    FieldRange.Value = \"WORKS\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11836773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xFsCQQ-XXic/AAAAAAAAAAI/AAAAAAAAAIk/D2a1zbJZcAA/photo.jpg?sz=128", "display_name": "Darth Vader", "link": "https://stackoverflow.com/users/11836773/darth-vader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 57287465, "answer_count": 2, "score": -2, "last_activity_date": 1564567861, "creation_date": 1564561932, "last_edit_date": 1564567861, "question_id": 57286474, "link": "https://stackoverflow.com/questions/57286474/why-is-there-an-object-variable-or-with-block-variable-missing", "title": "why is there an Object Variable or With-block variable missing?", "body": "<p>why is there an </p>\n\n<blockquote>\n  <p>Object variable or With-bock variable missing </p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/QovY7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QovY7.png\" alt=\"In the Picture is the Problem (in German) and the Code \"></a></p>\n\n<p>I have already googled if I could find anything in the Internet but I didn't  </p>\n\n<pre><code>Sub One_Find()\n    Dim FieldRange As Range\n    Dim FirstAddress As String\n    FieldRange = Cells.Find(What:=ActiveCell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n    FirstAddress = FieldRange.Address\n\n    Do\n        FieldRange = Cells.FindNext(FieldRange)\n    Loop While FieldRange.Address &lt;&gt; FirstAddress\n\n    FieldRange.Value = \"WORKS\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "named-ranges"], "answers": [{"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1564563033, "last_edit_date": 1564563033, "creation_date": 1564562217, "answer_id": 57286536, "question_id": 57286457, "link": "https://stackoverflow.com/questions/57286457/how-to-reference-a-named-column-in-a-range-of-rows-in-excel-vba/57286536#57286536", "title": "How to Reference a Named Column in a Range of Rows in Excel VBA", "body": "<p>Here are two ways to loop through every cell in the range <code>rng</code> and prove we visited each of them.</p>\n\n<pre><code>Dim r as Range\nFor Each r in rng\n    r = \"visited\" \nNext r\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To rng.Cells.Count\n    rng.Cells(i) = \"visited\"\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 10994626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjqaP.png?s=128&g=1", "display_name": "norsemanGrey", "link": "https://stackoverflow.com/users/10994626/norsemangrey"}, "edited": false, "score": 0, "creation_date": 1564567753, "post_id": 57286878, "comment_id": 101071236, "body": "Perfect! Exactly what I was looking for."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1564564388, "last_edit_date": 1564564388, "creation_date": 1564563376, "answer_id": 57286878, "question_id": 57286457, "link": "https://stackoverflow.com/questions/57286457/how-to-reference-a-named-column-in-a-range-of-rows-in-excel-vba/57286878#57286878", "title": "How to Reference a Named Column in a Range of Rows in Excel VBA", "body": "<p>You can use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.intersect\" rel=\"nofollow noreferrer\"><code>Intersect</code></a>:</p>\n\n<pre><code>Sub Test()\n\nDim rng1 As Range, rng2 As Range, cl As Range\nWith ThisWorkbook.Sheets(\"Sheet1\") 'Whichever sheet your working on\n    Set rng1 = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\n    Set rng2 = Intersect(rng1, .Range(\"COLE\")) 'Whichever name your named range is.\n    For Each cl In rng2\n        'Do something\n    Next cl\nEnd With    \n\nEnd Sub\n</code></pre>\n\n<p>Note that upon canceling the inputbox, this will throw an error which you can solve with some error handling.</p>\n"}], "owner": {"reputation": 103, "user_id": 10994626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjqaP.png?s=128&g=1", "display_name": "norsemanGrey", "link": "https://stackoverflow.com/users/10994626/norsemangrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 57286878, "answer_count": 2, "score": 2, "last_activity_date": 1564564388, "creation_date": 1564561873, "question_id": 57286457, "link": "https://stackoverflow.com/questions/57286457/how-to-reference-a-named-column-in-a-range-of-rows-in-excel-vba", "title": "How to Reference a Named Column in a Range of Rows in Excel VBA", "body": "<p>I want to loop through all the cells in in a named column of a set of rows selected by the user. However, I am not sure how to accomplish this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TsMq4.png\" rel=\"nofollow noreferrer\">Named Column in Selection of Rows</a></p>\n\n<p>I have used the blow code to get the user selected range / rows, but I do not know how to go from there to get hold of the cells in the named column within this range.</p>\n\n<pre><code>Set rng = Application.InputBox(\"Select a range\", \"Obtain Range Object\", Type:=8)\n</code></pre>\n"}, {"tags": ["excel", "vba", "save", "refresh"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564561344, "post_id": 57286226, "comment_id": 101067497, "body": "@GorLzyan you want to save aftre refresh ?"}, {"owner": {"reputation": 23, "user_id": 6430086, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aQEg3OLsq2s/AAAAAAAAAAI/AAAAAAAAARU/Jt4Rgm7giWo/photo.jpg?sz=128", "display_name": "Gor Lazyan", "link": "https://stackoverflow.com/users/6430086/gor-lazyan"}, "reply_to_user": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564561453, "post_id": 57286226, "comment_id": 101067550, "body": "@Dorian yes, save and close."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564561523, "post_id": 57286226, "comment_id": 101067590, "body": "Please Have a Look to my <a href=\"https://stackoverflow.com/a/57286325/11167163\">Answer</a>"}], "owner": {"reputation": 23, "user_id": 6430086, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aQEg3OLsq2s/AAAAAAAAAAI/AAAAAAAAARU/Jt4Rgm7giWo/photo.jpg?sz=128", "display_name": "Gor Lazyan", "link": "https://stackoverflow.com/users/6430086/gor-lazyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "closed_date": 1569501553, "answer_count": 0, "score": 0, "last_activity_date": 1564561794, "creation_date": 1564561097, "last_edit_date": 1564561405, "question_id": 57286226, "link": "https://stackoverflow.com/questions/57286226/problem-when-auto-refresh-save-and-close-excel-file-using-vba", "closed_reason": "Duplicate", "title": "Problem when Auto refresh, save and close excel file using vba", "body": "<p>I am facing a problem when refreshing and saving a workbook.(MS Excel 2010)</p>\n\n<p>When I only refresh the workbook it is fine (code 1), but when I adding save command, it does not refresh the sheet (code 2). I have tried different commands to save the file, but still no any result. \n I tried with separate macros (macro 1 for refreshing and macro 2 for saving and closing the application). Separately it works again, but when adding a button to run 2 macros, it fails to refresh again. Any help on this? I even tried adding a time lag after refreshing: Application.Wait (Now + TimeValue(\"00:00:10\")), but this is not solving the problem. </p>\n\n<p>Please advise how to deal with this.</p>\n\n<p>code1:</p>\n\n<pre><code>Public Sub test()\nPath = \"D:\\test\\test.xlsx\" \nWith Application\n    .DisplayAlerts = False\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .AskToUpdateLinks = False\nEnd With\n\nWorkbooks.Open Path\nActiveWorkbook.UpdateLink Name:=ActiveWorkbook.LinkSources\nActiveWorkbook.RefreshAll\nEnd Sub\n</code></pre>\n\n<p>code 2:</p>\n\n<pre><code>Public Sub test()\nPath = \"D:\\test\\test.xlsx\" \nWith Application\n    .DisplayAlerts = False\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .AskToUpdateLinks = False\nEnd With\n\nWorkbooks.Open Path\nActiveWorkbook.UpdateLink Name:=ActiveWorkbook.LinkSources\nActiveWorkbook.RefreshAll\nActiveWorkbook.Save ()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11685090, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9dlfUuC1HlY/AAAAAAAAAAI/AAAAAAAAAEc/XruLlD5Rhhk/photo.jpg?sz=128", "display_name": "Nikhil Nick", "link": "https://stackoverflow.com/users/11685090/nikhil-nick"}, "edited": false, "score": 0, "creation_date": 1564561482, "post_id": 57286090, "comment_id": 101067567, "body": "Mikku, thanks man, i didnt find any understandable solution online for this problem,  but you solved it in seconds. works like a charm. Thanks again."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1564560615, "creation_date": 1564560615, "answer_id": 57286090, "question_id": 57286004, "link": "https://stackoverflow.com/questions/57286004/calling-a-array-element-in-find-function/57286090#57286090", "title": "calling a array element in .Find function", "body": "<p>You are missing an <code>End If</code> in your code. Try the Below code, it will color the cells red where your string in Array is found.</p>\n\n<p><strong>Try this:</strong></p>\n\n<pre><code>Sub colr()\n\nDim SCtr As Long\nDim whattofind As Variant\nDim cel As Range\n\n\nwhattofind = Array(\"pdy\", \"Pdx\", \"temp\")\n\nFor SCtr = LBound(whattofind) To UBound(whattofind)\n\n    Set cel = ActiveSheet.Cells.Find(What:=whattofind(SCtr))\n\n\n    If Not cel Is Nothing Then\n        cel.Interior.ColorIndex = 3\n    End If\n\nNext SCtr\n\nEnd Sub\n</code></pre>\n\n<p>Try to avoid the Object Names used by Excel. Like <code>Cell</code></p>\n"}], "owner": {"reputation": 3, "user_id": 11685090, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9dlfUuC1HlY/AAAAAAAAAAI/AAAAAAAAAEc/XruLlD5Rhhk/photo.jpg?sz=128", "display_name": "Nikhil Nick", "link": "https://stackoverflow.com/users/11685090/nikhil-nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 57286090, "answer_count": 1, "score": 0, "last_activity_date": 1564560821, "creation_date": 1564560317, "last_edit_date": 1564560821, "question_id": 57286004, "link": "https://stackoverflow.com/questions/57286004/calling-a-array-element-in-find-function", "title": "calling a array element in .Find function", "body": "<p>I have an array with \"n\" number of strings, i want to call every string in the array in .find function, and search whole sheet for the respective string, then display the position of the string in the worksheet.</p>\n\n<pre><code>Dim SCtr as long\n\nDim whattofind as variant\n\nWhatToFind = Array(\"pdy\", \"Pdx\", \"temp\")\n\nFor SCtr = LBound(WhatToFind) To UBound(WhatToFind)\n\n     'here is the problem it was searching only first value in the array not going to the next item in the array\n\n    Set Cell = Cells.Find(What:=WhatToFind(SCtr), After:=ActiveCell, LookIn:= _\n                         xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows,                  SearchDirection:= _xlNext, MatchCase:=False, SearchFormat:=False)\n\n      If Not Cell Is Nothing Then\n           'do something\nNext SCtr\n</code></pre>\n\n<p>which funtion can be used for this purpose or can something be done to make this code work</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1564559970, "post_id": 57285825, "comment_id": 101066771, "body": "Is your goal to actually have formulas, or is your goal to have the right values?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 1, "creation_date": 1564560114, "post_id": 57285825, "comment_id": 101066849, "body": "You have to Enter that in a VB Editor Window, not in a Cell. And for the Visible cells you can use <code>Range(&quot;AA2:AA&quot; &amp; lastrow).SpecialCells(xlCellTypeVisible)</code>"}, {"owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564561927, "post_id": 57285825, "comment_id": 101067820, "body": "@Mikku, it works if the first visible filtered cell is 10, otherwise it doesn&#39;t, any idea how to overcome that?"}], "owner": {"reputation": 133, "user_id": 11640386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367b8583c4167d4e026090ade9282c1d?s=128&d=identicon&r=PG&f=1", "display_name": "Valwrie", "link": "https://stackoverflow.com/users/11640386/valwrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564559981, "creation_date": 1564559700, "last_edit_date": 1564559981, "question_id": 57285825, "link": "https://stackoverflow.com/questions/57285825/how-to-input-vlookup-formula-on-visible-cells-with-reference-from-another-workbo", "title": "How to input vlookup formula on visible cells with reference from another workbook vba", "body": "<p>I currently have a workbook that will be filtered, and I need to input a vlookup formula on the visible cells in column \"AA\". However, the table array is on another workbook. I'm aware of how to do it on excel, but not how to code it. Is it possible to do so with VBA? Is there also a better way to do this besides vlookup?</p>\n\n<ul>\n<li>Filename of reference file = <code>\"TestCases.xlsm\"</code></li>\n<li><p>Filename of output file = <code>\"Actual.xlsx\"</code></p>\n\n<pre><code>Range(\"AA2:AA\" &amp; lastrow).Formula = \"=vlookup(A10, '[TestCases.xlsm]tc'!$B$3:$M$8, 1,0)\"\n</code></pre></li>\n</ul>\n\n<p>This is what I'd key into a cell. It doesn't work as I wouldn't know the row number of the first visible cell. Any help would be greatly appreciated! Thank you!</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1564589781, "post_id": 57285804, "comment_id": 101084393, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/56533672/how-do-i-position-my-pivot-table-filters-above-each-other-using-vba\">How do I position my pivot table filters above each other using VBA?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11852585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdlDU5osJwE/AAAAAAAAAAI/AAAAAAACIew/D_3qV_LDLh8/photo.jpg?sz=128", "display_name": "Marco Veggo Scocco", "link": "https://stackoverflow.com/users/11852585/marco-veggo-scocco"}, "edited": false, "score": 0, "creation_date": 1564563210, "post_id": 57286206, "comment_id": 101068540, "body": "Thank you for your answer! Can you give me a suggestion where place those strings? I understand what they stand for but I&#39;m trying to figure out where placing them in the code, I&#39;m very new to VBA."}, {"owner": {"reputation": 5, "user_id": 11852585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdlDU5osJwE/AAAAAAAAAAI/AAAAAAACIew/D_3qV_LDLh8/photo.jpg?sz=128", "display_name": "Marco Veggo Scocco", "link": "https://stackoverflow.com/users/11852585/marco-veggo-scocco"}, "edited": false, "score": 0, "creation_date": 1564565067, "post_id": 57286206, "comment_id": 101069604, "body": "OMG sorry for this stupid question, I just realized I was looking on the wrong part of the code! I have inserted &quot;xlDownThenOver&quot; in .PageFieldOrder, and &quot;3&quot; in .PageFieldWrapCount Thank you very much for the help, I checked the acceptance of your answer :)"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1564561010, "creation_date": 1564561010, "answer_id": 57286206, "question_id": 57285804, "link": "https://stackoverflow.com/questions/57285804/put-elements-inside-the-pivot-filters-field-in-the-same-column/57286206#57286206", "title": "Put elements inside the Pivot Filter&#39;s field in the same column", "body": "<p>The arrangement of filters (which are <code>PageFields</code>) is defined by following parameters:</p>\n\n<pre><code>.PageFieldOrder = xlDownThenOver    ' 1=xlDownThenOver, 2=xlOverThenDown\n.PageFieldWrapCount = 0             ' amount of page fields per column\n</code></pre>\n\n<p>So you just need to exchange these.</p>\n"}], "owner": {"reputation": 5, "user_id": 11852585, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdlDU5osJwE/AAAAAAAAAAI/AAAAAAACIew/D_3qV_LDLh8/photo.jpg?sz=128", "display_name": "Marco Veggo Scocco", "link": "https://stackoverflow.com/users/11852585/marco-veggo-scocco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 57286206, "answer_count": 1, "score": 1, "last_activity_date": 1564561137, "creation_date": 1564559614, "last_edit_date": 1564561137, "question_id": 57285804, "link": "https://stackoverflow.com/questions/57285804/put-elements-inside-the-pivot-filters-field-in-the-same-column", "title": "Put elements inside the Pivot Filter&#39;s field in the same column", "body": "<p>I try to create a Pivot table with 3 elements inside the Pivot filter field.</p>\n\n<p>These usually are in the same column, when I create the Pivots manually, but with VBA they are in the same row and I cannot understand why.</p>\n\n<p>The Pivot I want to create has the following fields:</p>\n\n<ul>\n<li>Filters: Ship Date, Account name, Zip</li>\n<li>Rows: SAP Code</li>\n<li>Values: US Qty Shipped</li>\n</ul>\n\n<p>Visually this is the result I obtain with my actual code:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZTwzz.jpg\" alt=\"Pivot with filters in the same row\"></p>\n\n<p>And this is what I want to obtain (I made it manually without VBA, then I recorded the Macro following the same steps but I obtain the filters are always in the same column):</p>\n\n<p><img src=\"https://i.stack.imgur.com/66EkL.jpg\" alt=\"Pivot with filters in the same column\"></p>\n\n<p>I tried also to select the \"Compact Layout\" from PivotTable tools without success. </p>\n\n<pre><code>    Sub Shipped_qty_US()\n\n    Sheets(\"Tracker\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Tracker!R1C1:R72606C25\", Version:=6).CreatePivotTable TableDestination:= _\n        \"Foglio7!R3C1\", TableName:=\"Tabella pivot1\", DefaultVersion:=6\n    Sheets(\"Foglio7\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"Tabella pivot1\")\n        .ColumnGrand = True\n        .HasAutoFormat = True\n        .DisplayErrorString = False\n        .DisplayNullString = True\n        .EnableDrilldown = True\n        .ErrorString = \"\"\n        .MergeLabels = False\n        .NullString = \"\"\n        .PageFieldOrder = 2\n        .PageFieldWrapCount = 0\n        .PreserveFormatting = True\n        .RowGrand = True\n        .SaveData = True\n        .PrintTitles = False\n        .RepeatItemsOnEachPrintedPage = True\n        .TotalsAnnotation = False\n        .CompactRowIndent = 1\n        .InGridDropZones = False\n        .DisplayFieldCaptions = True\n        .DisplayMemberPropertyTooltips = False\n        .DisplayContextTooltips = True\n        .ShowDrillIndicators = True\n        .PrintDrillIndicators = False\n        .AllowMultipleFilters = False\n        .SortUsingCustomLists = True\n        .FieldListSortAscending = False\n        .ShowValuesRow = False\n        .CalculatedMembersInFilters = False\n        .RowAxisLayout xlCompactRow\n    End With\n    With ActiveSheet.PivotTables(\"Tabella pivot1\").PivotCache\n        .RefreshOnFileOpen = False\n        .MissingItemsLimit = xlMissingItemsDefault\n    End With\n    ActiveSheet.PivotTables(\"Tabella pivot1\").RepeatAllLabels xlRepeatLabels\n    Sheets(\"Foglio7\").Select\n    Sheets(\"Foglio7\").Name = \"Shipped Qty US\"\n    Sheets(\"Shipped Qty US\").Select\n    Sheets(\"Shipped Qty US\").Name = \"PV Shipped Qty\"\n    With ActiveSheet.PivotTables(\"Tabella pivot1\").PivotFields(\"Ship Date\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"Tabella pivot1\").PivotFields(\"Account Name\")\n        .Orientation = xlPageField\n        .Position = 2\n    End With\n    With ActiveSheet.PivotTables(\"Tabella pivot1\").PivotFields(\"Zip\")\n        .Orientation = xlPageField\n        .Position = 3\n    End With\n    With ActiveSheet.PivotTables(\"Tabella pivot1\").PivotFields(\"SAP Code\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"Tabella pivot1\").AddDataField ActiveSheet.PivotTables( _\n        \"Tabella pivot1\").PivotFields(\"Qty Shipped\"), \"Somma di Qty Shipped\", xlSum\n    Range(\"B5\").Select\n    ActiveSheet.PivotTables(\"Tabella pivot1\").DataPivotField.PivotItems( _\n        \"Somma di Qty Shipped\").Caption = \"US Qty Shipped\"\n\nEnd Sub\n</code></pre>\n\n<p>Thank you very much for the help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "edited": false, "score": 0, "creation_date": 1564560164, "post_id": 57285764, "comment_id": 101066876, "body": "is d set as date format in your sheet ?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1564562359, "post_id": 57285764, "comment_id": 101068043, "body": "See here: <a href=\"https://stackoverflow.com/questions/35531137/vba-goto-cell-with-a-certain-value-type-date/35531503#35531503\" title=\"vba goto cell with a certain value type date\">stackoverflow.com/questions/35531137/&hellip;</a>. Could be the cause of your problems."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564571678, "post_id": 57285764, "comment_id": 101073463, "body": "Inside the <code>select case : case 10</code>, what is <code>TypeName(tmpArr(1, j))</code>?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564572243, "post_id": 57285764, "comment_id": 101073796, "body": "@GSerg  d = tmpArr(1, j)  tmpArr(1, j) is the date I am trying to find in range  ws2.Range(&quot;I4:CK4&quot;)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564572284, "post_id": 57285764, "comment_id": 101073820, "body": "Yes, and what is its <code>TypeName()</code>?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564572598, "post_id": 57285764, "comment_id": 101073975, "body": "@GSerg  MyType = TypeName(d) Mytype = &quot;Date&quot;"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564573023, "post_id": 57285764, "comment_id": 101074225, "body": "Then <code>.find(DateValue(Format(CDate(d), &quot;dd&#47;mm&#47;yyyy&quot;)), LookIn:=xlValues, LookAt:=xlPart)</code> should be <code>.Find(d, LookIn:=xlValues, LookAt:=xlWhole)</code>."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564573736, "post_id": 57285764, "comment_id": 101074633, "body": "@GSerg Set c = .find(d, LookIn:=xlValues, LookAt:=xlWhole) doesn&#39;t find the date! when I debug xlValues = -4163  xlWhole = 1"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564573923, "post_id": 57285764, "comment_id": 101074731, "body": "You do not need to debug <code>xlValues</code> or <code>xlWhole</code> You do however need to verify that <code>ws2.Range(&quot;I4:CK4&quot;)</code> contains dates that are formatted as dates (again, with <code>TypeName</code>)."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564574687, "post_id": 57285764, "comment_id": 101075147, "body": "@GSerg mytype = TypeName(ws2.Cells(4, 41).Value) mytype = &quot;Date&quot;"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564575485, "post_id": 57285764, "comment_id": 101075577, "body": "Do those dates have a time component (seen in the formula bar when the cell is selected)? Do the dates in <code>Tbk Mnth</code> have a time component?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564576009, "post_id": 57285764, "comment_id": 101075878, "body": "@GSerg they have no time component."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564576179, "post_id": 57285764, "comment_id": 101075969, "body": "Then there is no reason why it would not find them. Can you make a separate xslx file that shows the problem, with a small portion of the <code>Tbk Mnth</code> data and a small portion of <code>ws2.Range(&quot;I4:CK4&quot;)</code>, and upload it somewhere?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564577075, "post_id": 57285764, "comment_id": 101076505, "body": "@GSerg Really appreciate your time. Can you recommend somewhere I can upload the file or long shot I am happy to e-mail it."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1564577190, "post_id": 57285764, "comment_id": 101076579, "body": "Google drive would be fine."}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564561753, "post_id": 57286000, "comment_id": 101067711, "body": "Thanks for your answers. I have tried both your solutions but no success. The array is built up from cells that are formatted as date so d should be a date. When I debug the line Set c = .find(DateValue(d), LookIn:=xlValues, LookAt:=xlPart)   d = 2018/10/01 xlValues = -4163 xlPart = 2 . Should the value for 2018/10/01 not be 43374?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564562851, "post_id": 57286000, "comment_id": 101068347, "body": "Appreciate your help but still no luck!"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564563101, "post_id": 57286000, "comment_id": 101068484, "body": "@Anthony Can you Debug.Print <code>DateValue(Format(CDate(d), &quot;dd&#47;mm&#47;yyyy&quot;)</code> Just after <code>d = tmp(i,j)</code> So we see what It does.."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564563284, "post_id": 57286000, "comment_id": 101068579, "body": "Values stay the same:  d = 2018/10/01 xlValues = -4163 xlPart = 2"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564563490, "post_id": 57286000, "comment_id": 101068695, "body": "@ Dorian debug.Print  d = 2018/10/01"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564563591, "post_id": 57286000, "comment_id": 101068748, "body": "@Anthony after <code>d ) tmp(1,J)</code> add : <code>debug.Print ThisWorkbook.Sheets(1).Range(&quot;A:A&quot;).Find(CDate(d)).Row</code> This should give you the first row where we found the date"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564563796, "post_id": 57286000, "comment_id": 101068848, "body": "@Anthony so d = 20/18/01 and what is writen in your cell 2018/10/01 or 01/10/2018 or smth else ?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564565640, "post_id": 57286000, "comment_id": 101069954, "body": "The date I am trying to find is in cell is in AK4 and is date formatted and looks like this 2018/10/01. I actually only need the column number. When I try this: Debug.Print ws2.Range(&quot;AK:AK&quot;).find(CDate(d)).Row  I receive error 91 object variable with block variable not set."}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564566267, "post_id": 57286000, "comment_id": 101070316, "body": "What is a UTS value?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564566716, "post_id": 57286000, "comment_id": 101070609, "body": "@Anthony <code>Sheets(&quot;Name&quot;).Range(&quot;AK:AK&quot;).Find(&quot;2018&#47;10&#47;01&quot;).Row</code> Replace Name by your sheet name"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564567138, "post_id": 57286000, "comment_id": 101070882, "body": "Tried:  Debug.Print Sheets(&quot;Plan&quot;).Range(&quot;AK:AK&quot;).find(2018 / 10 / 1).Row  Still receive error 91"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564567552, "post_id": 57286000, "comment_id": 101071105, "body": "@Anthony add <code>&quot;&quot;</code> for the date : Debug.Print <code>Sheets(&quot;Plan&quot;).Range(&quot;AK:AK&quot;).find(&quot;2018 &#47; 10 &#47; 1&quot;).Row</code>"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564567967, "post_id": 57286000, "comment_id": 101071382, "body": "you are indeed patient! Appreciate your help. Tried that. Still error 91"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564568038, "post_id": 57286000, "comment_id": 101071425, "body": "wow and if you select you <b>AK</b> Column then press <b>Ctrl + F</b> Then type 2018/10/1 then search, does this found something ?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564568633, "post_id": 57286000, "comment_id": 101071775, "body": "Ctrl F and 2018/10/01 is found! That is why I am baffled!"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564568683, "post_id": 57286000, "comment_id": 101071805, "body": "@Anthony May I Ask you to edit your issue so I can try to debug it ?"}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564568793, "post_id": 57286000, "comment_id": 101071864, "body": "@Anthony Just Copy And Paste your full code in your issue, so I can reproduce this"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1564570796, "post_id": 57286000, "comment_id": 101072931, "body": "I have now posted the full code. I hope it makes sense. I am a novice VBA coder."}, {"owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "reply_to_user": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "edited": false, "score": 0, "creation_date": 1569490085, "post_id": 57286000, "comment_id": 102616870, "body": "@Anthony If your issue is solved, May I ask you to accept this answer ?"}], "tags": [], "owner": {"reputation": 2455, "user_id": 11167163, "user_type": "registered", "profile_image": "https://graph.facebook.com/972653802873117/picture?type=large", "display_name": "Dorian", "link": "https://stackoverflow.com/users/11167163/dorian"}, "is_accepted": true, "score": 1, "last_activity_date": 1564562012, "last_edit_date": 1564562012, "creation_date": 1564560309, "answer_id": 57286000, "question_id": 57285764, "link": "https://stackoverflow.com/questions/57285764/unable-to-find-date-using-vba-find/57286000#57286000", "title": "Unable to find date using VBA .find", "body": "<p>You might use : <code>DateValue()</code> if your <strong>date</strong> d is set as date format in cells then delete <code>CDate()</code> because <code>Cdate()</code> is used to convert  <code>String</code> to <code>date</code></p>\n\n<pre><code>Case 10\n            With ws2.Range(\"i4:ck4\")\n            Dim d As Date\n                d = tmpArr(1, j)\n                    Set c = .find(DateValue(CDate(d)), LookIn:=xlValues, LookAt:=xlPart)\n                    If Not c Is Nothing Then\n                    firstAddress = c.Address\n                    firstAddress = Mid(firstAddress, 4, 3)\n\n                    End If\n\n            End With\n\n        End Select\n    Next j\n</code></pre>\n\n<p>So if your <strong>cell is as date format</strong> maybe use this one : </p>\n\n<pre><code>Case 10\n            With ws2.Range(\"i4:ck4\")\n            Dim d As Date\n                d = tmpArr(1, j)\n                    Set c = .find(DateValue(d), LookIn:=xlValues, LookAt:=xlPart)\n                    If Not c Is Nothing Then\n                    firstAddress = c.Address\n                    firstAddress = Mid(firstAddress, 4, 3)\n\n                    End If\n\n            End With\n\n        End Select\n    Next j\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<pre><code>Case 10\n                With ws2.Range(\"i4:ck4\")\n                Dim d As Date\n                    d = tmpArr(1, j)\n                        Set c = .find(DateValue(Format(CDate(d), \"dd/mm/yyyy\")), LookIn:=xlValues, LookAt:=xlPart)\n                        If Not c Is Nothing Then\n                        firstAddress = c.Address\n                        firstAddress = Mid(firstAddress, 4, 3)\n\n                        End If\n\n                End With\n\n            End Select\n        Next j\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 57286000, "answer_count": 1, "score": 1, "last_activity_date": 1564571304, "creation_date": 1564559403, "last_edit_date": 1564571304, "question_id": 57285764, "link": "https://stackoverflow.com/questions/57285764/unable-to-find-date-using-vba-find", "title": "Unable to find date using VBA .find", "body": "<p><code>tmpArr(1, j)</code> may be a date or a string. If it is a date then I need to find it in Range(i4:ck4). The dates in this range are formatted as dates. My code below is not finding my dates. What am I doing wrong?</p>\n\n<p><code>Data</code> is Code in column A which is alphanumeric and may be 3 characters long. <code>Tbk mnth</code> is column B and is a date.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Code    Tbk Mnth\nBX      1-Oct-06\nC7      1-Dec-11\nC7      1-Apr-12\nLA      1-Feb-15\nNJ      1-Mar-15\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim rng As Range\n    Dim tmpArr As Variant\n    Dim Dict As Object, tmpDict As Object\n    Dim i As Long, j As Long\n    Dim v, key\n    Dim ws As Worksheet\n    Dim ws2 As Worksheet\n    Dim ws3 As Worksheet\n    Dim item As Variant\n    Dim d As Date\n\n    Set Dict = CreateObject(\"Scripting.Dictionary\")\n    Set ws = Worksheets(\"Data\")\n    Set ws2 = Worksheets(\"Plan\")\n    Set ws3 = Worksheets(\"test\")\n\n    With ws\n        Set rng = .Range(.Cells(2, 1), .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, 2))\n\n        tmpArr = rng.Value\n\n        For i = LBound(tmpArr, 1) To UBound(tmpArr, 1)\n            ' Test if value exists in dictionary. If not add and set up the dictionary item\n            If Not Dict.exists(tmpArr(i, 1)) Then\n                Set tmpDict = Nothing\n                Set tmpDict = CreateObject(\"Scripting.Dictionary\")\n                Dict.Add key:=tmpArr(i, 1), item:=tmpDict\n            End If\n            ' Set nested dictionary to variable to edit it\n            Set tmpDict = Nothing\n            Set tmpDict = Dict(tmpArr(i, 1))\n\n            ' Test if value exists in nested Dictionary, add if not and initiate counter\n            If Not tmpDict.exists(tmpArr(i, 2)) Then\n                tmpDict.Add key:=tmpArr(i, 2), item:=1\n            Else\n                ' Increment counter if it already exists\n                tmpDict(tmpArr(i, 2)) = tmpDict(tmpArr(i, 2)) + 1\n            End If\n            ' Write nested Dictionary back to Main dictionary\n            Set Dict(tmpArr(i, 1)) = tmpDict\n        Next i\n\n        ' Repurpose array for output setting to maximum possible size (helps with speed of code)\n        ReDim tmpArr(LBound(tmpArr, 2) To UBound(tmpArr, 2), LBound(tmpArr, 1) To UBound(tmpArr, 1))\n        ' Set starting counters for array\n        i = LBound(tmpArr, 1)\n        j = LBound(tmpArr, 2)\n        ' Convert dictionary and nested dictionary to flat output\n        For Each key In Dict\n            tmpArr(j, i) = key\n            i = i + 1\n            For Each v In Dict(key)\n                tmpArr(j, i) = v\n                tmpArr(j + 1, i) = Dict(key)(v)\n                i = i + 1\n            Next v\n        Next key\n\n        ' Reshape array to actual size\n        ReDim Preserve tmpArr(LBound(tmpArr, 1) To UBound(tmpArr, 1), LBound(tmpArr, 2) To i - 1)\n        'Change dates less than date in cell 1,9  to overdue and find the row number associated to the code\n        d = ws.Cells(1, 9).Value\n        For j = LBound(tmpArr, 2) To UBound(tmpArr, 2)\n            dte = tmpArr(1, j)\n            If dte &lt; d Then\n                tmpArr(1, j) = \"Overdue\"\n                b = b + tmpArr(2, j)\n            Else\n                With ws2.Range(\"e5:e280\")\n                    Set c = .find(tmpArr(1, j), LookIn:=xlValues)\n                    If Not c Is Nothing Then\n                        firstAddress = c.Address\n                        firstAddress = Mid(firstAddress, 4, 3)\n                        tmpArr(2, j) = firstAddress\n                    End If\n                End With\n            End If    \n        Next j\n\n        For j = LBound(tmpArr, 2) To UBound(tmpArr, 2)\n            l = Len(tmpArr(1, j))\n            Select Case l\n            Case Is &lt;= 3\n                k = j\n                rw = tmpArr(2, k)\n            Case 7\n                With ws2.Cells(rw, 8)\n                    .Value = .Value + tmpArr(2, j)\n                End With\n            Case 10\n                'find column for date numbers\n                With ws2.Range(\"I4:CK4\")\n                    d = tmpArr(1, j)\n                    Set c = .find(DateValue(Format(CDate(d), \"dd/mm/yyyy\")), LookIn:=xlValues, LookAt:=xlPart)\n                    Debug.Print d\n                    If Not c Is Nothing Then\n                        firstAddress = c.Address\n                        firstAddress = Mid(firstAddress, 4, 3)\n                    End If                \n                End With\n            End Select\n        Next j\n\n        'See what  tmpArr looks like\n        With ws3.Cells(2, 5)\n            Range(.Offset(0, 0), .Cells(UBound(tmpArr, 2), UBound(tmpArr, 1))) = Application.Transpose(tmpArr)\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1564760613, "post_id": 57285718, "comment_id": 101149512, "body": "Comment out the user-type error handling <code>On Error GoTo MsgErr</code> while in development. Edit the question with that line commented and update the line that causes the error."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1567909509, "post_id": 57285718, "comment_id": 102105575, "body": "The missing <code>Set</code> in the line <code>store = SubFolder.store</code> should generate an error before reaching the line <code>Set conv = Item.GetConversation()</code>."}], "owner": {"reputation": 21, "user_id": 6079825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12464fddb5347254dedb33c741d148c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cas Van Mierlo", "link": "https://stackoverflow.com/users/6079825/cas-van-mierlo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1590997330, "creation_date": 1564559233, "last_edit_date": 1590997330, "question_id": 57285718, "link": "https://stackoverflow.com/questions/57285718/error-438-when-using-getconversation-on-a-mail-item", "title": "Error 438 when using GetConversation on a mail item", "body": "<p>I'm trying to export all e-mails in a shared inbox to excel. I'm specifically interested in how many conversations I've had, rather than all e-mails I've received. </p>\n\n<p>I'm getting the <code>438 error</code>  on the <code>Set conv = Item.GetConversation()</code> line: </p>\n\n<blockquote>\n  <p>Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>This implies that Item doesn't support GetConversation, even though it is a function for a MailItem.</p>\n\n<pre><code>    Public Sub ExportToExcel()\n        Dim objOL As Outlook.Application\n        Dim objNS As Outlook.NameSpace\n        Dim SubFolder As Object\n        Dim MailFolder As Object\n        Dim SharedInbox As Outlook.MAPIFolder\n        Dim objRecip As Outlook.Recipient\n\n        Dim Item As Object\n        Dim conv As Object\n        Dim store As Outlook.Store\n\n        Dim xlApp As New Excel.Application\n        Dim xlWB As Excel.Workbook\n        Dim i As Long\n        Dim ArrHeader As Variant\n\n        On Error GoTo MsgErr\n\n        Set objOL = Application\n        Set objNS = objOL.GetNamespace(\"MAPI\")\n        Set objRecip = objNS.CreateRecipient(\"sharedmailbox@outlook.com\")\n        Set SharedInbox = objNS.GetSharedDefaultFolder(objRecip, olFolderInbox)\n\n        Set MailFolder = SharedInbox.Folders(\"Archive\").Folders(\"Sub\")\n\n\n        ArrHeader = Array(\"Category\", \"Date Sent\", \"Subject\", \"Mails in conversation\")\n\n        Set xlApp = CreateObject(\"Excel.Application\")\n        xlApp.Visible = True\n        Set xlWB = xlApp.Workbooks.Add\n\n\n        xlWB.Worksheets(1).Range(\"A1\").resize(1, UBound(ArrHeader) + 1).Value = ArrHeader\n\n        For Each SubFolder In MailFolder.Folders\n            For Each Item In SubFolder.Items\n                If (Item.Class = olMail) Then\n                    store = SubFolder.store\n\n                    If (store.IsConversationEnabled) Then\n                        Set conv = Item.GetConversation()\n\n                        If (conv &lt;&gt; Null) Then\n                            xlWB.Worksheets(1).Cells(i + 1, \"A\").Value = SubFolder.Name\n                            xlWB.Worksheets(1).Cells(i + 1, \"B\").Value = Item.ReceivedTime\n                            xlWB.Worksheets(1).Cells(i + 1, \"C\").Value = Item.Subject\n                            xlWB.Worksheets(1).Cells(i + 1, \"D\").Value = conv.GetTable().getrows()\n                        End If\n                    End If\n                End If\n            Next Item\n        Next SubFolder\n\n        xlWB.Worksheets(1).Cells.EntireColumn.Autofit\n\n    MsgErr_Exit:\n        Set emailSourceFolder = Nothing\n        Set emailDestFolder = Nothing\n        Set objNS = Nothing\n        Set objOL = Nothing\n        Set SubFolder = Nothing\n        Set MailFolder = Nothing\n        Set SharedInbox = Nothing\n        Set objRecip = Nothing\n        Set Item = Nothing\n        Set conv = Nothing\n        Set Store = Nothing\n        Set xlWB = Nothing\n        Set xlApp = Nothing\n        Set i = Nothing\n        Set ArrHeader = Nothing\n\n        Exit Sub\n\n    '// Error information\n    MsgErr:\n        MsgBox \"An unexpected Error has occurred.\" _\n             &amp; vbCrLf &amp; \"Error Number: \" &amp; Err.Number _\n             &amp; vbCrLf &amp; \"Error Description: \" &amp; Err.Description _\n             , vbCritical, \"Error!\"\n        Resume MsgErr_Exit\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "office365"], "comments": [{"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1564558492, "post_id": 57285451, "comment_id": 101066011, "body": "Marco, Please read posts more carefully. I quote &quot;...I have done the following: Application.ScreenUpdating = False is set.&quot;"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1564558601, "post_id": 57285451, "comment_id": 101066074, "body": "Do you call any other macros from your initial macro?"}, {"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1564558961, "post_id": 57285451, "comment_id": 101066254, "body": "Macro suite schema: DrillDown calls SelectInputWorkbook, PopulateWorkbook, CreateWorkbook, CloseWorkbooks PopulateWorkbook calls HandleNewFileNumber, HandleSameFileNumber CreateWorkbook calls TidySheets CloseWorkbooks"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1564560228, "post_id": 57285451, "comment_id": 101066914, "body": "If you call any custom macros from within your initial macro, make sure to include <code>Application.ScreenUpdating = False</code> in those macros aswell."}, {"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1564562223, "post_id": 57285451, "comment_id": 101067962, "body": "Have done that and it made matters worse!   I now see, briefly, each workbook displayed after it opens, and this then stays in view until the next one opens."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1564573038, "post_id": 57285451, "comment_id": 101074233, "body": "How much code is contained in the workbook in question? It&#39;s kinda hard to troubleshoot without being able to see what&#39;s going on."}, {"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1564577492, "post_id": 57285451, "comment_id": 101076774, "body": "@eirikdaude When the entire module of code is copied and pasted into a Word document and set to &quot;No Spacing&quot; it occupies eight and half A4 portrait pages. That code is spread across ten macros. I am about to update the original post with the exact sequence of flicking. Watch this space."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "edited": false, "score": 0, "creation_date": 1564588973, "post_id": 57291965, "comment_id": 101083961, "body": "The settings suggested by eirikdaude in his answer have been tried. They have had no effect. It&#39;s beginning to look as though there is no solution using Excel alone. As this particular project is for my own use, I think I&#39;ll just have to accept that what it does is how it does it; no alternative."}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1564579782, "creation_date": 1564579782, "answer_id": 57291965, "question_id": 57285451, "link": "https://stackoverflow.com/questions/57285451/how-can-i-prevent-the-screen-flashing-grey-at-every-workbook-open-in-a-macro-sui/57291965#57291965", "title": "How can I prevent the screen flashing grey at every workbook open in a macro suite", "body": "<p>I am not sure if there is any easy way to prevent the problem you are describing - I am guessing you are seeing the various workbooks being opened on top of the current one, although I can't recall having experienced anything quite similar despite at times working with quite big workbooks and macros. </p>\n\n<p>I wrote the macros you can see below in an attempt to replicate your problem, but didn't see it - of course there is a lot less work done in the various workbooks in my example than in what you describe, so maybe some of the problems come from that. I tried running the macro both with and without the settings in the bottommost macros turned off, but nothing seemed to replicate your problem.</p>\n\n<pre><code>Option Explicit\n\nSub test1()\n    Call speedup\n\n    Call test2\n\n    Call slowdown\nEnd Sub\n\nPrivate Sub test2()\n    Dim i As Long\n\n    For i = 1 To 4\n        With Workbooks.Open(Filename:=\"C:\\Users\\EirikDaude\\Desktop\\Test\\Test\" &amp; CStr(i) &amp; \".xlsx\", ReadOnly:=True)\n            Application.Wait (Now + TimeValue(\"0:00:03\"))\n            Debug.Print .FullName\n            .Close\n        End With\n    Next i\nEnd Sub\n\nPrivate Sub speedup()\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Application.EnableAnimations = False\n    Application.Calculation = xlCalculationManual\nEnd Sub\n\nPrivate Sub slowdown()\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.EnableAnimations = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>As you can see, I am turning off some Excel settings, similarly to what you found when you googled. Contrary to the suggestions in the comments on your question, I recommend only doing this in the main sub you are calling the others from, in order to keep track of which ones are turned off and which ones are turned on. Of course you may need to e.g. calculate some formulas in your sheet in the middle of your code execution, but if you do I would recommend doing so \"manually\" using <a href=\"https://stackoverflow.com/questions/37459903/what-is-the-difference-between-application-calculate-and-application-calculatefu\"><code>Application.Calculate</code> or <code>Application.CalculateFull</code></a>. I'll leave it as an exercise to you to figure out what the different settings do, it should be easy enough to google them.</p>\n\n<p>As you may have guessed already, I think the best recipe for minimizing the amount of grey screen you see is making your code more efficient. Playing around with the settings shown in my macros could be a start, otherwise there are a lot of sites out there making recommendations on how to achieve this (I like <a href=\"https://www.microsoft.com/en-us/microsoft-365/blog/2009/03/12/excel-vba-performance-coding-best-practices/\" rel=\"nofollow noreferrer\">this one</a>, for instance). From what you wrote, doing something like <code>wb1.worksheet.range.value = wb2.worksheet.range.value</code> instead of copying the same might be a good place to start. Of course, without knowing exactly what your macro looks like, or what it does, it is hard to offer much concrete advice. I hope this at least could be of some help, I'm sorry I couldn't be more helpful with the concrete problem you are facing.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "is_accepted": false, "score": 0, "last_activity_date": 1564602978, "creation_date": 1564602978, "answer_id": 57298018, "question_id": 57285451, "link": "https://stackoverflow.com/questions/57285451/how-can-i-prevent-the-screen-flashing-grey-at-every-workbook-open-in-a-macro-sui/57298018#57298018", "title": "How can I prevent the screen flashing grey at every workbook open in a macro suite", "body": "<p>Problem SOLVED!</p>\n\n<p>I added a <code>ThisWorkbook.Activate</code> statement immediately prior to the <code>Set wbTarget =...</code> statement. Now the focus remains on the main worksheet.  </p>\n\n<p>My inspiration came from further Google searches around the subjects of Excel Window Focus Hold in combination with other terms I had used. No single search result gave me the answer. It was more a case of a slow dawning that <code>Activate</code>, along with everything else it did, set the focus on the Excel window specified.  </p>\n\n<p>I never expected to be the one who contribute the solution to his own problem on my very first posting to this forum. The encouragement you guys gave me kept me going until the end.  </p>\n\n<p>Thanks!</p>\n"}], "owner": {"reputation": 11, "user_id": 11862302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnv4k.jpg?s=128&g=1", "display_name": "Peter the historian", "link": "https://stackoverflow.com/users/11862302/peter-the-historian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1564602978, "creation_date": 1564558216, "last_edit_date": 1564579520, "question_id": 57285451, "link": "https://stackoverflow.com/questions/57285451/how-can-i-prevent-the-screen-flashing-grey-at-every-workbook-open-in-a-macro-sui", "title": "How can I prevent the screen flashing grey at every workbook open in a macro suite", "body": "<p>The suite is triggered by a button on Sheet1 of DrillDown.xlsm.</p>\n\n<p>The suite uses the following workbooks: wbIn, wbOut, wbTarget. The contents of wbIn are used to identify which workbook file should be opened as wbTarget. The relevant rows are then copied from wbTarget to wbOut. During a run of the suite there may be from 1 to 4 wbTargets used. Each one is closed before the next one is opened.</p>\n\n<p>During the execution of the suite there will be between two and five file open events (wbIn and up to four wbTargets). At each of these, Sheet1 of DrillDown.xlsm disappears from view and is replaced by a grey screen. This is followed by a brief re-display of Sheet1 before it again is removed and replaced by the grey screen.</p>\n\n<p>Any thoughts on what I can do to hold focus on Sheet1 of DrillDown.xlsm throughout the entire run of the suite?</p>\n\n<p>I have trawled the net and as a result I have done the following:  </p>\n\n<pre><code>Application.ScreenUpdating = False is set.\n</code></pre>\n\n<p>There is no use of Activate anywhere in the suite. There is no use of Select anywhere in the suite.</p>\n\n<p>The code which opens the target workbook is as below  </p>\n\n<pre><code>Set wbTgt = Workbooks.Open(Filename:=sTargetWbk, ReadOnly:=True)  \nSet wsTgt = wbTgt.Sheets(1)  \n</code></pre>\n\n<p>Updated at 13:52 GMT+1 on 31-07-2019  </p>\n\n<p>In what follows, \"Main Screen\" is the content of Sheet1 of ThisWorkbook. If I can work out how big an image file should be, and how to add one, I will let you all see what the \"grey screen\" looks like. The sequence of events, after accepting the user's input is as follows:<br>\nMain Screen with Hour-glass mouse pointer - no immediate flicker<br>\nFlicker to Grey Screen with steady Hour-glass<br>\nHour-glass changes to small White Cross steady<br>\nBack to Hour-glass which flickers steadily<br>\nMain Screen flashes up very briefly<br>\nThen repeat three more times (because I used all four target files on this test) from Flicker to Grey Screen... </p>\n\n<p>By providing these details about the mouse pointer behaviour and the screens displayed, however briefly, I'm hoping somebody out there can get an understanding of what is going on \"under the covers\" of Excel. All my mouse pointer settings are as factory-shipped.</p>\n\n<p>Updated at 1422 GMT+1</p>\n\n<p>Here's the Grey Screen image. It was captured by \"Print Screen\" and then taken into Photoshop to downsize it to fit the web page. I hope!\n<a href=\"https://i.stack.imgur.com/lulcs.jpg\" rel=\"nofollow noreferrer\">Grey Screen</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1564555605, "post_id": 57284744, "comment_id": 101064590, "body": "Is the <code>Exit Sub</code> in the end a typo that should be <code>End Sub</code>? \u2022 Please explain what you mean by <i>&quot;Both the trim function and print function (&#39;Bedragen optellen&#39;) aren&#39;t showing.&quot;</i> \u2022 It is pretty unclear what your actual issue is. <i>&quot;Not working&quot;</i> is no useful error description."}, {"owner": {"reputation": 23, "user_id": 11862114, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NgQ4Bkjr4TM/AAAAAAAAAAI/AAAAAAAABt8/637tjNd9ec0/photo.jpg?sz=128", "display_name": "Syff", "link": "https://stackoverflow.com/users/11862114/syff"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564557005, "post_id": 57284744, "comment_id": 101065249, "body": "Thanks for the fast reply! The End sub comes a bit later. In between there is an Errorhandler.  If you want I can paste the entire macro to get a better view."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1564557486, "post_id": 57284744, "comment_id": 101065493, "body": "Actually the other points I mentioned are much more improtant, because your question is unclear. Please <a href=\"https://stackoverflow.com/posts/57284744/edit\">edit</a> and improve it. We need to know what exactly the issue is, where do you get errors and which, or what does your code vs what did you expect. Example input/output, screenshots everything you can provide to explain can help. Reading <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might help you. \u2022 And yes if there is an error handler please show that too."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1564562043, "post_id": 57284744, "comment_id": 101067876, "body": "OK, I guess finding the issue is impossible without providing a proper example of the text file, because we need to reproduce the issue (anything else would be guessing). Also we need to know where the error occurs."}, {"owner": {"reputation": 23, "user_id": 11862114, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NgQ4Bkjr4TM/AAAAAAAAAAI/AAAAAAAABt8/637tjNd9ec0/photo.jpg?sz=128", "display_name": "Syff", "link": "https://stackoverflow.com/users/11862114/syff"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1564566541, "post_id": 57284744, "comment_id": 101070500, "body": "Updated the OP with the contents of a input file. Note that numbers have been recplaced with &quot;X&quot; and words have been changed for privacy reasons.  Thanks again for the replies Peh, much appreciated! :)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11862114, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NgQ4Bkjr4TM/AAAAAAAAAAI/AAAAAAAABt8/637tjNd9ec0/photo.jpg?sz=128", "display_name": "Syff", "link": "https://stackoverflow.com/users/11862114/syff"}, "edited": false, "score": 1, "creation_date": 1564573435, "post_id": 57288356, "comment_id": 101074457, "body": "You sir, are my hero!  Many thanks for solution and a more efficient function. Besides that, big thanks for the fast response"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1564567886, "creation_date": 1564567886, "answer_id": 57288356, "question_id": 57284744, "link": "https://stackoverflow.com/questions/57284744/trim-function-not-working-properly-what-am-i-doing-wrong/57288356#57288356", "title": "Trim function not working properly, what am I doing wrong?", "body": "<p>The main issue is in this line </p>\n\n<pre><code>Do While UCase(Trim(contrCel.Value)) &lt;&gt; \"Rekening\"\n</code></pre>\n\n<p>you are looking for the <code>UCase</code> of a cell value that means all characters in the cell value are converted to upper case by <code>UCase</code> so when it comes to <code>Rekening</code> you compare <code>\"REKENING\" &lt;&gt; \"Rekening\"</code> so it does not match. You would need to change it to</p>\n\n<pre><code>Do While UCase(Trim(contrCel.Value)) &lt;&gt; \"REKENING\"\n</code></pre>\n\n<p>But instead I recommend to use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.Find\" rel=\"nofollow noreferrer\">Range.Find method</a> which should find <code>\"Rekening\"</code> faster than a loop. You can make it non case sensitive <code>MatchCase:=False</code> and let it look at a part of a cell <code>LookAt:=xlPart</code> so you don't need to <code>Trim</code>.</p>\n\n<pre><code>Set StartCel = wbBron.Worksheets(1).Columns(\"A\").Find(What:=\"Rekening\", LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)\n</code></pre>\n\n<p>See the complete improved code of the <code>Bewerkbestand</code> procedure below:</p>\n\n<pre><code>Sub Bewerkbestand(ByVal wbBron As Workbook)\n    On Error GoTo Errorhandler\n\n    Dim StartCel As Range\n    Set StartCel = wbBron.Worksheets(1).Columns(\"A\").Find(What:=\"Rekening\", LookIn:=xlValues, LookAt:=xlPart, MatchCase:=False)\n\n    If StartCel Is Nothing Then\n        MsgBox \"'Rekening' could not be found.\", vbCritical\n        Exit Sub\n    End If\n\n    Dim contrCel As Range\n    Set contrCel = StartCel.Offset(2, 0)\n    Do While contrCel.Value &amp; contrCel.Offset(1, 0).Value &amp; contrCel.Offset(2, 0).Value &lt;&gt; \"\"\n        If contrCel.Value &lt;&gt; \"22300\" Then\n            Set contrCel = contrCel.Offset(-1, 0)\n            contrCel.Offset(1, 0).EntireRow.Delete\n        Else\n        End If\n        Set contrCel = contrCel.Offset(1, 0)\n    Loop\n\n    'Bedragen optellen\n    Set contrCel = StartCel.Offset(2, 0)\n\n    Dim TotBedr As Double\n    Do While contrCel.Value &lt;&gt; \"\"\n        TotBedr = TotBedr + CDbl(contrCel.Offset(0, 9).Value)\n        Set contrCel = contrCel.Offset(1, 0)\n    Loop\n\n    With StartCel\n        .Offset(-2, 8).Value = \"Totaalbedrag\"\n        .Offset(-2, 8).Font.Bold = True\n        .Offset(-2, 8).HorizontalAlignment = xlRight\n        .Offset(-2, 9).Value = TotBedr\n        .Offset(-2, 9).EntireColumn.ColumnWidth = 16\n        .Offset(-2, 9).Font.Bold = True\n    End With\n\n\n    Exit Sub\nErrorhandler:\n    MsgBox Err.Number &amp; \" \" &amp; Err.Description, vbCritical, \"Fout tijdens verwerking!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11862114, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NgQ4Bkjr4TM/AAAAAAAAAAI/AAAAAAAABt8/637tjNd9ec0/photo.jpg?sz=128", "display_name": "Syff", "link": "https://stackoverflow.com/users/11862114/syff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 57288356, "answer_count": 1, "score": 2, "last_activity_date": 1565469815, "creation_date": 1564555506, "last_edit_date": 1565469815, "question_id": 57284744, "link": "https://stackoverflow.com/questions/57284744/trim-function-not-working-properly-what-am-i-doing-wrong", "title": "Trim function not working properly, what am I doing wrong?", "body": "<p><strong>Background:</strong> At work a client has an issue with an Excel Macro they have been using for a long time now. In short, the macro reads .txt files, trims away rows that don't include the value \"22300\" in column A (starting beneath the word \"Rekening\") adds a total value of the numbers associated with the remaining rows and generates an Excel file of the results. </p>\n\n<p><strong>Current results:</strong> After a change of the provided .txt files template (minor changes) the macro has stopped working. When the user starts the macro (by clicking on an image/shape) the macro starts running but gives a 1004 error (windowed error). When the user clicks on OK the Macro continuous generating the Excel file though without applying the trim function and adding the total value.</p>\n\n<p>I have double checked the spelling of \"Rekening\" and \"22300\" within the files. Besides that I also tried playing with the Offset values though again, I am not sure what I am doing since I am pretty new to this.</p>\n\n<pre><code>Option Explicit\nSub OpenBestand()\n    Application.DisplayAlerts = False\n    Dim sBronMap As String\n    Dim sResultmap As String\n    Dim sDonemap As String\n    Dim sBronbest As String\n    Dim wbBron As Workbook\n\n    On Error GoTo Errorhandler\n\n    sBronMap = Blad1.Range(\"Bronmap\").Value\n    If Right(sBronMap, 1) &lt;&gt; \"\\\" Then sBronMap = sBronMap &amp; \"\\\"\n\n    sBronbest = Dir(sBronMap &amp; \"*.prt\", vbNormal)\n    If sBronbest = \"\" Then\n        sBronbest = Dir(sBronMap &amp; \"*.txt\", vbNormal)\n    End If\n    Application.DisplayAlerts = False\n    If sBronbest &lt;&gt; \"\" Then\n        With Application\n            .ScreenUpdating = False\n            .StatusBar = \"Even geduld bezig met verwerken bestand \" &amp; sBronbest\n        End With\n\n        Workbooks.OpenText Filename:=sBronMap &amp; sBronbest, _\n            Origin:=xlWindows, _\n            StartRow:=9, _\n            DataType:=xlFixedWidth, _\n            FieldInfo:=Array(Array(0, 1), _\n                            Array(9, 1), _\n                            Array(18, 1), _\n                            Array(33, 1), _\n                            Array(53, 1), _\n                            Array(69, 2), _\n                            Array(78, 1), _\n                            Array(88, 1), _\n                            Array(95, 1), _\n                            Array(109, 1), _\n                            Array(123, 1), _\n                            Array(129, 1)), _\n                            TrailingMinusNumbers:=True\n\n        Set wbBron = ActiveWorkbook\n        Bewerkbestand wbBron\n\n    Else\n        MsgBox \"geen bestand gevonden\", vbInformation, \"Mededeling\"\n        Exit Sub\n    End If\n\n    sResultmap = Blad1.Range(\"Resultmap\").Value\n    If Right(sResultmap, 1) &lt;&gt; \"\\\" Then sResultmap = sResultmap &amp; \"\\\"\n    wbBron.SaveAs sResultmap &amp; Left(wbBron.Name, InStr(1, wbBron.Name, \".\") - 1), xlWorkbookNormal\n\n    sDonemap = Blad1.Range(\"Donemap\").Value\n    If Right(sDonemap, 1) &lt;&gt; \"\\\" Then sDonemap = sDonemap &amp; \"\\\"\n\n    FileCopy sBronMap &amp; sBronbest, sDonemap &amp; sBronbest\n    Kill sBronMap &amp; sBronbest\n\n    wbBron.Activate\n    With ActiveWindow\n        .ScrollColumn = 1\n        .ScrollRow = 1\n    End With\n\n    With Application\n        .ScreenUpdating = True\n        .StatusBar = False\n    End With\n\n    ThisWorkbook.Close SaveChanges:=False\nExit Sub\nErrorhandler:\n    MsgBox Err.Number &amp; \" \" &amp; Err.Description, vbCritical, \"Fout tijdens verwerking!\"\n    With Application\n        .ScreenUpdating = True\n        .StatusBar = False\n    End With\nEnd Sub\n\n\nSub Bewerkbestand(ByVal wbBron As Workbook)\n    On Error GoTo Errorhandler\n\n    Dim contrCel As Range, StartCel As Range\n    Dim TotBedr As Double\n\n    TotBedr = 0\n    Set contrCel = wbBron.Worksheets(1).Range(\"A1\")\n    Do While UCase(Trim(contrCel.Value)) &lt;&gt; \"Rekening\"\n        Set contrCel = contrCel.Offset(1, 0)\n    Loop\n    Set StartCel = contrCel\n\n    Set contrCel = contrCel.Offset(2, 0)\n    Do While contrCel.Value &amp; contrCel.Offset(1, 0).Value &amp; contrCel.Offset(2, 0).Value &lt;&gt; \"\"\n        If contrCel.Value &lt;&gt; \"22300\" Then\n            Set contrCel = contrCel.Offset(-1, 0)\n            contrCel.Offset(1, 0).EntireRow.Delete\n        Else\n        End If\n        Set contrCel = contrCel.Offset(1, 0)\n    Loop\n\n    'Bedragen optellen\n    Set contrCel = StartCel.Offset(2, 0)\n    Do While contrCel.Value &lt;&gt; \"\"\n        TotBedr = TotBedr + CDbl(contrCel.Offset(0, 9).Value)\n        Set contrCel = contrCel.Offset(1, 0)\n    Loop\n\n    With StartCel\n        .Offset(-2, 8).Value = \"Totaalbedrag\"\n        .Offset(-2, 8).Font.Bold = True\n        .Offset(-2, 8).HorizontalAlignment = xlRight\n        .Offset(-2, 9).Value = TotBedr\n        .Offset(-2, 9).EntireColumn.ColumnWidth = 16\n        .Offset(-2, 9).Font.Bold = True\n    End With\n\nExit Sub\n\nErrorhandler:\nMsgBox Err.Number &amp; \" \" &amp; Err.Description, vbCritical, \"Fout tijdens verwerking!\"\n\nEnd Sub\n</code></pre>\n\n<p>I have included a screenshot of the input and desired/previously generated output.</p>\n\n<p>Input screenshot</p>\n\n<p><a href=\"https://i.imgur.com/sjFzIIg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/sjFzIIg.png\" alt=\"Input screenshot\"></a></p>\n\n<p>Desired/previously generated output</p>\n\n<p><a href=\"https://i.imgur.com/5d79lBa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/5d79lBa.png\" alt=\"Desired/previously generated output\"></a></p>\n\n<p>Here is the content (edited obviously) of a txt file for reference:</p>\n\n<pre><code>    A(s0V&amp;k0V&amp;l0o8V(s12.66A                                     G X X X X E E E K   V E E E E E K I I I I R E E E E E G\n\n=================================================================================================================================\n Integr.bestand:  MEMO      Periode:     Dagb:  Soci Zac Stap                                     Bladnr:    1\n\n=================================================================================================================================\nRekening     Kostenpl. Kostendr. Rekeningnaam        Omschrijving    Boekstuk Datum     Periode         Debet        Credit\n=================================================================================================================================\n RUNPARAMETERS\n GEBRUIKER   : Gxx\n Gemo    : 001\n Financiele integratie Kup\n Periode             : 201907\n Verslagnummer van   : 180000\n Verslagnummer t/m   : 180022\n Periode             : 201907\n Regeling(en)        : 0 Regeling 1\n                       1 Regeling 2\n                       2 Regeling 3\n                       3 Regeling 4\n                       4 Regeling 5\n                       5 Regeling 6\n                       6 Regeling 7\n                       7 Regeling 8\n                       8 Regeling 9\n                       9 Regeling 10\n                       10 Regeling 11\n                       11 Regeling 12\n                       12 Regeling 13\n                       13 Regeling 14\n Boekingsdatum van   : --\n Boekingsdatum t/m   : --\n EINDE RUNPARAMETERS\n                                     G X X X X E E E K   V E E E E E K I I I I R E E E E E G\n\n=================================================================================================================================\n Integr.bestand:  MEMO      Periode:     Dagb:  Soci Zac Stap                                     Bladnr:    2\n\n=================================================================================================================================\nRekening     Kostenpl. Kostendr. Rekeningnaam        Omschrijving    Boekstuk Datum     Periode         Debet        Credit\n=================================================================================================================================\n 60XXXXXX    4XXXX               NXXXXXXXXXXX        PXXX            0XXXXXXX 30-07-2019 201906       1XX,XX\n 60XXXXXX    4XXXX               IXXXXXXXX           PXXX            0XXXXXXX 30-07-2019 201906                      7X,XX\n 60XXXXXX    4XXXX               OXXXXXXXXXXXXXXXX   PXXX            0XXXXXXX 30-07-2019 201906                    8XXX,XX\n    22300                        BXXXXXXX            PXXX            0XXXXXXX 30-07-2019 201906                    3XXX,XX\n 60XXXXXX    4XXXX               EXXXXXXXXXX         PXXX            0XXXXXXX 30-07-2019 201906      6XXX,XX\n    22304                        AXXXXXXXXXXXXXXXXXX PXXX            0XXXXXXX 30-07-2019 201906                    6XXX,XX\n 60XXXXXX    4XXXX               VXXXXXXXXXXX        PXXX            0XXXXXXX 30-07-2019 201906       5XX,13\n 60XXXXXX    4XXXX               RXXXXXXXXXXXXX      PXXX            0XXXXXXX 30-07-2019 201906                     5XX,XX\n 60XXXXXX    4XXXX               LXXXXXXXXXXXXXXXXXX PXXX            0XXXXXXX 30-07-2019 201906     1XXXX,XX\n\n                                                                                                ------------- -------------\nTotalen :                                                                                           4XXX,XX      4XXX,XX\n                                                                                                ============= =============\n</code></pre>\n"}, {"tags": ["vba", "types"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1564555572, "post_id": 57284720, "comment_id": 101064573, "body": "<code>Dim r As Range</code> will hold it as if you were using <code>Range(&quot;A1&quot;)</code> for example."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564555989, "post_id": 57284720, "comment_id": 101064761, "body": "It will saved as <code>String</code>. So <code>Dim add As String</code> &amp; <code>add = Function.Address</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1564556843, "post_id": 57284938, "comment_id": 101065172, "body": "Why would you save it as a String and then use it as a range? Why don&#39;t you set the range as a <code>Range</code>and use it however you want?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1564557026, "post_id": 57284938, "comment_id": 101065262, "body": "That&#39;s Correct @Damian. But <code>fnx.Address</code> gives you a string, and besides sometimes when you are using the range function working with <code>Activecell</code> and similar ranges it can change. But if you store it as a String, it will not change. There was a Question couple of weeks back regarding this. I will share the link if i could find it. <a href=\"https://stackoverflow.com/a/57108905/5720144\">Found it</a>"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1564556324, "creation_date": 1564556324, "answer_id": 57284938, "question_id": 57284720, "link": "https://stackoverflow.com/questions/57284720/as-what-for-a-data-type-is-the-address-function-saved/57284938#57284938", "title": "As what for a Data Type is the .Address function saved?", "body": "<p>It will be Saved as <code>String</code></p>\n\n<pre><code>Dim add As String\n\nadd = FieldRange.Address\n</code></pre>\n\n<p>Where <code>FieldRange</code> is a <code>Range</code> Object. </p>\n\n<p>To refer back to the same address you can put <code>add</code> in a range object like</p>\n\n<pre><code>Range(add).Row\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11836773, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xFsCQQ-XXic/AAAAAAAAAAI/AAAAAAAAAIk/D2a1zbJZcAA/photo.jpg?sz=128", "display_name": "Darth Vader", "link": "https://stackoverflow.com/users/11836773/darth-vader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564561506, "creation_date": 1564555408, "last_edit_date": 1564561506, "question_id": 57284720, "link": "https://stackoverflow.com/questions/57284720/as-what-for-a-data-type-is-the-address-function-saved", "title": "As what for a Data Type is the .Address function saved?", "body": "<p>I would like to know what the .Address Function in VBA is saved as. Because I don't know how I would need to 'Dim' my Variable as.\nPlease Help</p>\n\n<p>This is the Function I mean:</p>\n\n<p><img src=\"https://i.stack.imgur.com/D2IdX.png\" alt=\"\"></p>\n"}, {"tags": ["excel", "vba", "product", "cartesian"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564555409, "post_id": 57284680, "comment_id": 101064500, "body": "Yes you can create this using VBA. Give it a Try yourself, if it doesn&#39;t work then you can post the non-working code here. You can start by learning about <code>Array</code> &amp; <code>loop</code> in VBA."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1564557428, "post_id": 57284680, "comment_id": 101065468, "body": "You can find a couple of different solutions <a href=\"https://stackoverflow.com/questions/31472816\">here</a>."}, {"owner": {"reputation": 1, "user_id": 11568019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddc4f7788f4723b4b0ba8135ee6404c?s=128&d=identicon&r=PG&f=1", "display_name": "MZee", "link": "https://stackoverflow.com/users/11568019/mzee"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564590515, "post_id": 57284680, "comment_id": 101084776, "body": "@mikku I couldn&#39;t really get a firm grip on Arrays, but I understand the loop concept. So I ended up making it work using just loops. I Tested the macro up to 3456 combinations and compared it to ones I created manually. It worked perfectly. At first the loops were a bit repetitive,  so it took around 3 mins to create the combinations, but then i changed it a bit, it takes less than 5 seconds now. Thank you for advising me to try it myself ... I have been trying for the last 3 days with no results."}, {"owner": {"reputation": 1, "user_id": 11568019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddc4f7788f4723b4b0ba8135ee6404c?s=128&d=identicon&r=PG&f=1", "display_name": "MZee", "link": "https://stackoverflow.com/users/11568019/mzee"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1564590837, "post_id": 57284680, "comment_id": 101084925, "body": "@BrakNicku Thanks man for the suggested solutions ... am so novice in VBA, I couldn&#39;t understand the Array part completely, and how others name their variables. But as you can see above. I eventually was able to do it just using loops."}], "owner": {"reputation": 1, "user_id": 11568019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ddc4f7788f4723b4b0ba8135ee6404c?s=128&d=identicon&r=PG&f=1", "display_name": "MZee", "link": "https://stackoverflow.com/users/11568019/mzee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564555235, "creation_date": 1564555235, "question_id": 57284680, "link": "https://stackoverflow.com/questions/57284680/cartesian-product-for-number-of-sets-using-excel-vba", "title": "Cartesian product for number of sets using Excel VBA", "body": "<p>Is there a way to create a macro in excel to generate all possible combinations (Cartesian product) of a number of sets (more than 8), each containing a dynamic number of words (up to 60 words).</p>\n\n<p>eg.\nif I have 4 sets as below:</p>\n\n<ul>\n<li>Set 1:    A1          </li>\n<li>Set 2:    B1, B2, B3, B4</li>\n<li>Set 3:    C1, C2      </li>\n<li>Set 4:    D1, D2      </li>\n</ul>\n\n<p>It should create 16 combinations:\n<a href=\"https://i.stack.imgur.com/MH8I6.png\" rel=\"nofollow noreferrer\">(A1    B1  C1  D1), (A1    B1  C2  D1), (A1    B1  C1  D2), (A1    B1  C2  D2), (A1    B2  C1  D1), (A1    B2  C2  D1), (A1,   B2  C1  D2), (A1    B2  C2  D2), (A1    B3  C1  D1), (A1    B3  C2  D1), (A1    B3  C1  D2), (A1    B3  C2  D2), (A1    B4  C1  D1), (A1    B4  C2  D1), (A1    B4  C1  D2), (A1    B4  C2  D2) -Please see the picture  </a></p>\n\n<p>The above example is easy to make manyally. But for the below one, it is supposed to create 3456 combinations</p>\n\n<ul>\n<li>Set 1 A1                  </li>\n<li>Set 2 B1  B2  B3  B4      </li>\n<li>Set 3 C1  C2              </li>\n<li>Set 4 D1  D2  D3  D4      </li>\n<li>Set 5 E1  E2              </li>\n<li>Set 6 F1  F2  F3  F4  F5  F6</li>\n<li>Set 7 G1  G2  G3          </li>\n<li>Set 8 H1  H2  H3          </li>\n</ul>\n\n<p>Any idea how to do that for dynamic number of sets with dynamic number of words? Thanks A Lot.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1564570571, "post_id": 57284665, "comment_id": 101072815, "body": "This code is designed to create an indented list of all the folders to which you have access.  Look at your folder pane.  The name of the store (the file on disc that holds emails, task, etc.) is against the left edge.  The folders within the store are indented by one tab.  The folders within those folders are indented by two tabs.  The folders within those folders are indented by three tabs.  This code creates a string that looks like your folder pane.  So <code>Tabs</code> specifies the current level of indenting."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1564570644, "post_id": 57284665, "comment_id": 101072856, "body": "Do you know what recursion is?  This code will be unintelligible unless you do."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1564570671, "post_id": 57284665, "comment_id": 101072868, "body": "What do you mean by \u201canalyses \u2026 moves emails to match existing patterns\u201d?  Do you intend to identify that most emails from John Doe are in folder \u201cxxx\\yyy\\DoeJohn\u201d and then move any other emails from John to the same folder?  I might want to file my new emails every day but I would not want to perform the analysis every day.  Also I would not want to file a new email unless I had answered it or marked it as processed.  Are you still exploring your options or do you have a detailed specification of your requirement?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1564937321, "post_id": 57284665, "comment_id": 101184639, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43637311/how-to-specify-nested-folder-in-outlook-using-excel-vba\">How to specify nested folder in Outlook using Excel VBA</a>"}, {"owner": {"reputation": 9, "user_id": 2801393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AqwCZ.jpg?s=128&g=1", "display_name": "David Mountain", "link": "https://stackoverflow.com/users/2801393/david-mountain"}, "edited": false, "score": 0, "creation_date": 1564983007, "post_id": 57284665, "comment_id": 101192901, "body": "Yes, I understand recursion. With regard to the tabs I understand the output has tabs in it but I don&#39;t see any incrementing of tabs or a tabs variable so I guess it&#39;s an innate property being accessed."}, {"owner": {"reputation": 9, "user_id": 2801393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AqwCZ.jpg?s=128&g=1", "display_name": "David Mountain", "link": "https://stackoverflow.com/users/2801393/david-mountain"}, "edited": false, "score": 0, "creation_date": 1564983037, "post_id": 57284665, "comment_id": 101192908, "body": "With regard to function your last comment is spot on."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1564999903, "post_id": 57284665, "comment_id": 101199791, "body": "The nested calls of <code>RecurseFolders</code> specify <code>Tabs &amp; vbTab</code> so every time it goes down a level, an extra vbTab is added."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1565130518, "creation_date": 1565130518, "answer_id": 57384784, "question_id": 57284665, "link": "https://stackoverflow.com/questions/57284665/how-to-move-email-to-a-folder-inside-a-folder/57384784#57384784", "title": "How to move email to a folder inside a folder?", "body": "<p>Assuming you know where the folders are there is no need to search for them.</p>\n\n<p>With the designteam folder directly under the inbox. Adjust as applicable.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub moveToSubfolder()\n\nDim olInbox As Folder\nDim desTeamFolder As Folder\nDim mikeFolder As Folder\nDim sandyFolder As Folder\n\nDim currItem As Object\n\nSet olInbox = Session.GetDefaultFolder(olFolderInbox)\n\nSet desTeamFolder = olInbox.Folders(\"designteam\")\n\nWith desTeamFolder\n    Set mikeFolder = .Folders(\"mike\")\n    Set sandyFolder = .Folders(\"sandy\")\nEnd With\n\nSet currItem = ActiveInspector.CurrentItem\n\nIf currItem.Class = olMail Then\n    If InStr(currItem.Subject, \"mike pattern\") Then\n        currItem.Move mikeFolder\n    ElseIf InStr(currItem.Subject, \"sandy pattern\") Then\n        currItem.Move sandyFolder\n    Else\n        Debug.Print \"no match\"\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1565981076, "last_edit_date": 1565981076, "creation_date": 1565643964, "answer_id": 57468235, "question_id": 57284665, "link": "https://stackoverflow.com/questions/57284665/how-to-move-email-to-a-folder-inside-a-folder/57468235#57468235", "title": "How to move email to a folder inside a folder?", "body": "<p>My total answer exceeds Stack overflow's limit of 30,000 characters so I have split it into two.  This part includes all the explanatory text and some of the code.  The second part includes the remaining code.  A comment in italics in the middle of the first part shows where the second part belongs. </p>\n\n<p>The code below is work-in-progress rather than a polished solution but includes some macros that may be immediately useful and I believe it includes all the snippets you need for your own solution.</p>\n\n<p>I was a little ahead of you in deciding I needed to rearrange my Outlook stores and folders.  I had reached the stage of identifying the scale of the problem when I saw your question.  I have added a macro that moves selected emails.  This shows how to find source and destination folders and to move emails from one to the other.  This routine is not terribly useful for me because I have too many emails of which none are in the right folder but it ensures that everything I think you need is here.</p>\n\n<p>This code is designed for an Excel workbook.  I knew I would want to store data in a worksheet so I would need to use both Excel and Outlook VBA.  It is possible for Outlook to push data to Excel or for Excel to pull data from Outlook.  I have gone for pull since I was confident I would need some Excel only macros and I prefer all code for a single problem to be in one place.</p>\n\n<p>You will need to create a macro-enabled workbook.  This workbook must contain a worksheet named \u201cEmails\u201d and must reference \"Microsoft Outlook n.nn Object Library\" where \"n.nn\" depends on the version of Outlook used.</p>\n\n<p>You will need to create a user form within that workbook.  If you are not familiar with user forms, search for \u201cvba create userform\u201d and you will find many tutorials.  My user form only uses label controls and has no code within it so it is as easy as it gets.</p>\n\n<p>I use this user form to report progress.  On my system (with over 13,000 emails) some of my macros take several minutes. I hate programs that say \u201cThis may take from a few minutes to several hours\u201d and then go quiet until they have finished.  I want to know that the program is doing something.  My user form looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KG0r0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KG0r0.png\" alt=\"Progress user form\"></a></p>\n\n<p>Do not worry about matching the text; it is there to help align the labels.  There is one label that runs across the top of the form and then two rows of four labels.  I have coloured my labels so you can see their size.  You must match my names:</p>\n\n<pre><code>Form:        frmProgress\nFirst row:   lblMsg\nSecond row:  lblFldrName  lblFldrCrnt  lblFldrOf  lblFldrMax\nThird row:   lblItemName  lblItemCrnt  lblItemOf  lblItemMax\n</code></pre>\n\n<p>On my form, the text in lblFldrName, lblFldrCrnt, lblItemName and lblItemCrnt is right-aligned.  I believe this improves the appearance but it is not important.</p>\n\n<p>I use Excel\u2019s PERSONAL.XLSB as a library of subs and functions.  Some routines are Excel only, some are for any version of VBA and some are for other Office products such as Outlook.  The following function comes from a module I name \u201cLibOutlook\u201d:</p>\n\n<pre><code>Option Explicit\nPublic Function GetFldrRef(ByRef AppOut As Outlook.Application, _\n                           ByVal FldrName As String, _\n                           ByVal Create As Boolean, ByRef ErrMsg As String, _\n                           Optional ByVal Sep As String = \"\\\") As Outlook.Folder\n\n  ' Returns reference to the Outlook folder named FldrName\n  ' Returns Nothing if:\n  '    the store cannot be found\n  '    the folder cannot be found and Create is False\n\n  ' AppOut    Open copy of Outlook\n  ' FldrName  The full name of the folder in the format:\n  '             StoreName\\Folder1\\Folder2\\...\n  ' Create    If True, the folder will be created if it does not exist.\n  '           Note, the store must exist. This routine can create a folder\n  '           within a store but it cannot create a store.\n  ' ErrMsg    The reason for any failure\n  ' Sep       If the separator for FldrName is not \"\\\", used to specify the\n  '           actual separator.\n\n  Dim FldrChld As Outlook.Folder\n  Dim FldrCrnt As Outlook.Folder\n  Dim FldrNameCrnt As String\n  Dim FldrNameParts() As String\n  Dim InxP As Long\n  Dim NoError As Boolean\n\n  If FldrName = \"\" Then\n    ErrMsg = \"No folder name provided\"\n    Set GetFldrRef = Nothing\n  End If\n\n  FldrNameParts = Split(FldrName, Sep)\n\n  Set FldrCrnt = Nothing\n  On Error Resume Next\n  Set FldrCrnt = AppOut.Session.Folders(FldrNameParts(0))\n  On Error GoTo 0\n  If FldrCrnt Is Nothing Then\n    ' Store name not recognised\n    Debug.Print FldrNameParts(0) &amp; \" is not recognised as a store\"\n    Debug.Assert False     ' Fatal error\n    Set GetFldrRef = Nothing\n    Exit Function\n  End If\n  FldrNameCrnt = FldrNameParts(0)\n\n  NoError = True\n  For InxP = 1 To UBound(FldrNameParts)\n  Set FldrChld = Nothing\n    On Error Resume Next\n    Set FldrChld = FldrCrnt.Folders(FldrNameParts(InxP))\n    On Error GoTo 0\n    If FldrChld Is Nothing Then\n      If Not Create Then\n        ' Sub-folder name not recognised but folder FldrName must exist\n        ErrMsg = \"\"\"\" &amp; FldrNameParts(InxP) &amp; \"\"\" is not recognised as a \" &amp; _\n                 \"folder within \" &amp; FldrNameCrnt\n        Debug.Assert False    ' Fatal error\n        Set GetFldrRef = Nothing\n        Exit Function\n      Else\n        NoError = False\n        Exit For\n      End If\n    End If\n    Set FldrCrnt = FldrChld\n    FldrNameCrnt = FldrNameCrnt &amp; Sep &amp; FldrNameParts(InxP)\n    Set FldrChld = Nothing\n  Next\n\n  If NoError Then\n    ' Entire FldrName successfully converted to folder reference\n    ErrMsg = \"\"\n    Set GetFldrRef = FldrCrnt\n    Exit Function\n  End If\n\n  ' FldrCrnt is a existing folder within Outlook named FldrNameCrnt\n  ' Subfolder FldrNameParts(InxP) does not exist within FldrCrnt\n  ' Create Subfolder FldrNameParts(InxP) and any children\n\n  For InxP = InxP To UBound(FldrNameParts)\n    On Error Resume Next\n    Set FldrChld = FldrCrnt.Folders.Add(FldrNameParts(InxP))\n    On Error GoTo 0\n    If FldrChld Is Nothing Then\n      ' Attempt to create sub-folder failed\n      ErrMsg = \"\"\"\" &amp; FldrNameParts(InxP) &amp; \"\"\" cannot be created as a \" &amp; _\n               \"sub-folder within folder \" &amp; FldrNameCrnt\n      Debug.Assert False    ' Fatal error\n      Set GetFldrRef = Nothing\n      Exit Function\n    End If\n    Set FldrCrnt = FldrChld\n    FldrNameCrnt = FldrNameCrnt &amp; Sep &amp; FldrNameParts(InxP)\n    Set FldrChld = Nothing\n  Next\n\n  Set GetFldrRef = FldrCrnt\n\nEnd Function\n</code></pre>\n\n<p>You can include the above function in PERSONAL.XLSB, a separate module within your workbook or the same module as the other code.</p>\n\n<p>The following code belongs in a module within your workbook:</p>\n\n<p><em>Code moved to second answer because size limit exceeded.</em></p>\n\n<p>You will notice that I make heavy use of <code>Debug.Print</code> to help debug my code.  Some <code>Debug.Print</code>s are commented out since I have fully debugged their bit of the code.  Other <code>Debug.Print</code>s are still active because I am still working on the code.  I also tend to plant <code>Debug.Assert False</code> at the top of every branch through the code.  This stops execution the first time the branch is taken.  Once I have checked the branch executes as I wish, I comment it out.  An active <code>Debug.Assert False</code> tells me I have not tested a branch.</p>\n\n<p>You will need to amend function <code>GetOtherParty</code>.  The other party is the sender if you are the receiver and the recipients if you are the sender.  I have two email addresses.  This routine checks to see if I am the sender or the receiver and gets the name of the other party.  You will have to amend this for your email address or addresses.</p>\n\n<p>The first macro is <code>TidyPhase1</code>.  This searches through every folder of every store in your Outlook installation and write a row to worksheet \u201cEmails\u201d for every email\u201d.  It creates columns \u201cStatus\u201d, \u201cOther party\u201d, \u201cFolder\u201d, \u201cCount\u201d and \u201cReceived Time\u201d.  I will explain \u201cStatus\u201d and \u201cCount\u201d later.  If other party is \u201cSmithJohn@gmail.com\u201d and folder in \u201cabc\\def\\ghi\u201d, you have sent an email to or received an email from John Smith which is in folder \u201cabc\\def\\ghi\u201d.  Originally I had a column indicating if an email was sent or received.  I found this to be a nuisance for the next macro and its value was not obvious.  I included the received time so I could locate the email in Outlook if I did not understand a row.  If you decide to add a column for another property please use a constant for the column number, as I have, and update constant <code>ColEmailsSortLast</code> as appropriate. </p>\n\n<p>Note that <code>TidyPhase1</code> does not use recursion.  Recursion is a very convenient technique but it is slow.  I use a Collection to build my own stack although it is not a LIFO stack.  I will explain further if necessary.</p>\n\n<p>The next macro is <code>TidyPhase2</code>.  This merges rows for the same other party and folder.  The column \u201cCount\u201d identifies the number of source rows for a merged row.  At the end of this macro, worksheet \u201cEmails\u201d will be sequenced by other party and will contain rows like:</p>\n\n<pre><code>Status   Other party          Folder  Count  Received\n         SmithJohn@gmail.com  FolderA     2\n         SmithJohn@gmail.com  FolderB    10\n         SmithJohn@gmail.com  FolderC     1  12/8/2019 20:13  \n</code></pre>\n\n<p>There is only one email for John in FolderC so the date/time received in display in your local format. I found having a date useful in investigating emails that are misplaced.  If FolderB is the correct folder, type values into the Status column to give:</p>\n\n<pre><code>Status   Other party          Folder  Count  Received\nmove     SmithJohn@gmail.com  FolderA     2\ndest     SmithJohn@gmail.com  FolderB    10\nmove     SmithJohn@gmail.com  FolderC     1  12/8/2019 20:13  \n</code></pre>\n\n<p>The macro <code>HandleDestAndMove</code> will move John\u2019s emails from FolderA and FolderC to FolderB.  When the macro has finished, the worksheet will look like:</p>\n\n<pre><code>Status   Other party          Folder  Count  Received\ndest     SmithJohn@gmail.com  FolderB    13\n</code></pre>\n\n<p>If the correct folder is FolderD, add a row to give:</p>\n\n<pre><code>Status   Other party          Folder  Count  Received\nmove     SmithJohn@gmail.com  FolderA     2\nmove     SmithJohn@gmail.com  FolderB    10\nmove     SmithJohn@gmail.com  FolderC     1  12/8/2019 20:13\ndest     SmithJohn@gmail.com  FolderD\n</code></pre>\n\n<p>When the macro has finished, the worksheet will look like:</p>\n\n<pre><code>Status   Other party          Folder  Count  Received\ndest     SmithJohn@gmail.com  FolderD    13\n</code></pre>\n\n<p>I can already see ways of improving my macros but have decided to give you something now rather than wait until I have improved them since those improvements may not be important to you.</p>\n\n<p>To summarise:</p>\n\n<ul>\n<li><p>Macro <code>TidyPhase1</code> shows how to search every folder of every store for email.</p></li>\n<li><p>Macro <code>HandleDestAndMove</code> shows how to convert a folder name to a folder reference and how to move an email from one folder to another.</p></li>\n</ul>\n\n<p>Come back with questions if necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1565644117, "creation_date": 1565644117, "answer_id": 57468270, "question_id": 57284665, "link": "https://stackoverflow.com/questions/57284665/how-to-move-email-to-a-folder-inside-a-folder/57468270#57468270", "title": "How to move email to a folder inside a folder?", "body": "<p>Code moved from first answer because of size limit:</p>\n\n<pre><code>Option Explicit\n\n  ' Requires reference to \"Microsoft Outlook n.nn Object Library\" where \"n.nn\"\n  ' depends on the version of Outlook used.\n\n  Const ColEmailsSortFirst As Long = 1\n  Const ColEmailsStatus As Long = 1\n  Const ColEmailsOtherParty As Long = 2\n  Const ColEmailsFldrName As Long = 3\n  Const ColEmailsCount As Long = 4\n  Const ColEmailsReceivedTime As Long = 5\n  Const ColEmailsSortLast As Long = 5\nSub TidyPhase1()\n\n  ' * Accesses Outlook and copies other party, folder and received time\n  '   of every email to worksheet \"Emails\".\n  ' * If the sender email address is not one of my addresses, it is\n  '   used to identify the other party.  Otherwise the macro uses Recipients\n  '   to build the other party.\n\n  Dim AppOut As Outlook.Application\n  Dim EmailAddressOtherParty As String\n  Dim FldrsToCheck As Collection\n  Dim FldrCrnt As Outlook.Folder\n  Dim FldrNameCrnt As String\n  Dim InxA As Long\n  Dim InxF As Long\n  Dim InxI As Long\n  'Dim InxR As Long\n  Dim InxS As Long\n  Dim RowEmailsCrnt As Long\n  Dim WshtEmails As Worksheet\n\n  Load frmProgress\n  With frmProgress\n    .Caption = \"Tidy Outlook Phase 1\"\n    .lblMsg.Caption = \"Opening Outlook if not already open\"\n    .lblFldr.Caption = \"\"\n    .lblFldrCrnt.Caption = \"\"\n    .lblFldrOf.Caption = \"\"\n    .lblFldrMax.Caption = \"\"\n    .lblItem.Caption = \"\"\n    .lblItemCrnt.Caption = \"\"\n    .lblItemOf.Caption = \"\"\n    .lblItemMax.Caption = \"\"\n    .Show vbModeless\n  End With\n  DoEvents\n\n  Application.ScreenUpdating = False\n  Set WshtEmails = Worksheets(\"Emails\")\n  With WshtEmails\n    .Cells.EntireRow.Delete\n    WshtEmails.Cells(1, ColEmailsStatus).Value = \"Status\"\n    WshtEmails.Cells(1, ColEmailsOtherParty).Value = \"Other party\"\n    WshtEmails.Cells(1, ColEmailsFldrName).Value = \"Folder\"\n    WshtEmails.Cells(1, ColEmailsCount).Value = \"Count\"\n    WshtEmails.Cells(1, ColEmailsReceivedTime).Value = \"Received\"\n  End With\n\n  Set AppOut = CreateObject(\"Outlook.Application\")\n\n  With frmProgress\n    .lblMsg.Caption = \"Preparing to search Outlook folders for emails\"\n    .lblFldr.Caption = \"Folders to check\"\n    .lblFldrMax.Caption = \"0\"\n  End With\n  DoEvents\n\n  Set FldrsToCheck = New Collection\n\n  With AppOut\n    With .Session\n      ' Initialise FldrsToCheck with reference to and name of\n      ' every accessible store\n      For InxS = 1 To .Folders.Count\n        FldrsToCheck.Add VBA.Array(.Folders(InxS), .Folders(InxS).Name)\n        With frmProgress\n          .lblFldrMax.Caption = FldrsToCheck.Count\n        End With\n        DoEvents\n      Next\n    End With\n  End With\n\n  ' Process all folders\n  With frmProgress\n    .lblMsg.Caption = \"Checking folders\"\n    .lblFldr.Caption = \"Folders to check\"\n    .lblFldrMax.Caption = FldrsToCheck.Count\n  End With\n  DoEvents\n  RowEmailsCrnt = 2\n  Do While FldrsToCheck.Count &gt; 0\n    ' Extract next folder to process and delete it\n    Set FldrCrnt = FldrsToCheck(1)(0)\n    FldrNameCrnt = FldrsToCheck(1)(1)\n    Call FldrsToCheck.Remove(1)\n    'Debug.Print FldrCrnt.Name &amp; \" \" &amp; FldrNameCrnt &amp; \" \" &amp; FldrCrnt.Items.Count\n    With FldrCrnt\n      If .Folders.Count &gt; 0 Then\n        ' Folder contains sub-folders\n        ' Add sub-folders to FldrsToCheck\n        For InxF = 1 To .Folders.Count\n          FldrsToCheck.Add VBA.Array(.Folders(InxF), _\n                                     FldrNameCrnt &amp; \"\\\" &amp; .Folders(InxF).Name)\n          With frmProgress\n           .lblFldrMax.Caption = FldrsToCheck.Count\n          End With\n          DoEvents\n        Next\n      End If\n      If .Items.Count &gt; 0 Then\n        ' Folder contains items\n        If .DefaultItemType = olMailItem Then\n          ' Folder could contains MailItems\n          With frmProgress\n           .lblItem.Caption = \"Item within current folder\"\n           .lblItemCrnt.Caption = \"0\"\n           .lblItemOf.Caption = \"of\"\n           .lblItemMax.Caption = FldrCrnt.Items.Count\n          End With\n          DoEvents\n          ' Output details of all mail items to worksheet \"Emails\"\n          For InxI = 1 To .Items.Count\n            With .Items(InxI)\n              If .Class = olMail Then\n                WshtEmails.Cells(RowEmailsCrnt, ColEmailsOtherParty).Value = _\n                                                    GetOtherParty(FldrCrnt.Items(InxI))\n                WshtEmails.Cells(RowEmailsCrnt, ColEmailsFldrName).Value = FldrNameCrnt\n                WshtEmails.Cells(RowEmailsCrnt, ColEmailsCount).Value = 1\n                WshtEmails.Cells(RowEmailsCrnt, ColEmailsReceivedTime).Value = .ReceivedTime\n                RowEmailsCrnt = RowEmailsCrnt + 1\n              End If\n            End With\n            With frmProgress\n             .lblItemCrnt.Caption = InxI\n            End With\n          Next InxI\n        End If  ' .DefaultItemType = olMailItem\n      End If  ' .Items.Count &gt; 0\n    End With  ' FldrCrnt\n    With frmProgress\n      .lblFldrMax.Caption = FldrsToCheck.Count\n      .lblItem.Caption = \"\"\n      .lblItemCrnt.Caption = \"\"\n      .lblItemOf.Caption = \"\"\n      .lblItemMax.Caption = \"\"\n    End With\n    DoEvents\n  Loop\n\n  With frmProgress\n    .lblMsg.Caption = \"Closing Outlook if not opened by another process\"\n  End With\n  DoEvents\n\n  AppOut.Quit\n\n  Set AppOut = Nothing\n  Unload frmProgress\n\n  With WshtEmails\n    .Columns.AutoFit\n    .Rows.AutoFit\n    .Cells.VerticalAlignment = xlTop\n  End With\n\n  Application.ScreenUpdating = True\n\nEnd Sub\nSub TidyPhase2()\n\n  ' 1. Sorts worksheet \"Emails\" by Other party.\n  ' 2. Rows for the same Other party and Folder are combined.\n\n  Dim RngSortAll As Range\n  Dim RngSortCol As Range\n  Dim RowEmailsCrnt As Long\n  Dim RowEmailsLast As Long\n  Dim WshtEmails As Worksheet\n\n  Load frmProgress\n  With frmProgress\n    .Caption = \"Tidy Outlook Phase 2\"\n    .lblMsg.Caption = \"Sorting worksheet by 'Other Party'\"\n    .lblFldr.Caption = \"\"\n    .lblFldrCrnt.Caption = \"\"\n    .lblFldrOf.Caption = \"\"\n    .lblFldrMax.Caption = \"\"\n    .lblItem.Caption = \"\"\n    .lblItemCrnt.Caption = \"\"\n    .lblItemOf.Caption = \"\"\n    .lblItemMax.Caption = \"\"\n    .Show vbModeless\n  End With\n  DoEvents\n\n  Application.ScreenUpdating = False\n\n  Set WshtEmails = Worksheets(\"Emails\")\n\n  With WshtEmails\n\n    RowEmailsLast = .Cells(Rows.Count, ColEmailsCount).End(xlUp).Row\n    Set RngSortAll = .Range(.Cells(1, ColEmailsSortFirst), _\n                            .Cells(RowEmailsLast, ColEmailsSortLast))\n    Set RngSortCol = .Range(.Cells(2, ColEmailsOtherParty), _\n                            .Cells(RowEmailsLast, ColEmailsOtherParty))\n\n    With .Sort\n      .SortFields.Clear\n      .SortFields.Add Key:=RngSortCol, SortOn:=xlSortOnValues, _\n                      Order:=xlAscending, DataOption:=xlSortNormal\n      .SetRange RngSortAll\n      .Header = xlYes\n      .MatchCase = False\n      .Orientation = xlTopToBottom\n      .SortMethod = xlPinYin\n      .Apply\n    End With\n\n  End With  ' WshtEmails\n\n  With frmProgress\n    .Caption = \"Tidy Outlook Phase 2\"\n    .lblMsg.Caption = \"Merging rows for same 'Other Party' and 'Folder'\"\n    .lblItemCrnt.Caption = \"0\"\n    .lblItemOf.Caption = \"of\"\n    .lblItemMax.Caption = RowEmailsLast\n  End With\n  DoEvents\n\n  With Worksheets(\"Emails\")\n    RowEmailsCrnt = 2\n\n    Do While RowEmailsCrnt &lt;= RowEmailsLast\n      If (.Cells(RowEmailsCrnt, ColEmailsOtherParty).Value = _\n          .Cells(RowEmailsCrnt - 1, ColEmailsOtherParty).Value) And _\n         (.Cells(RowEmailsCrnt, ColEmailsFldrName).Value = _\n          .Cells(RowEmailsCrnt - 1, ColEmailsFldrName).Value) Then\n        .Cells(RowEmailsCrnt - 1, ColEmailsCount).Value = _\n                      .Cells(RowEmailsCrnt - 1, ColEmailsCount).Value + _\n                      .Cells(RowEmailsCrnt, ColEmailsCount).Value\n        .Cells(RowEmailsCrnt - 1, ColEmailsReceivedTime).Value = \"\"\n        .Rows(RowEmailsCrnt).Delete\n        RowEmailsLast = RowEmailsLast - 1\n        frmProgress.lblItemMax.Caption = RowEmailsLast\n      Else\n        RowEmailsCrnt = RowEmailsCrnt + 1\n        frmProgress.lblItemCrnt.Caption = RowEmailsCrnt\n      End If\n      DoEvents\n    Loop\n\n  End With\n\n  Unload frmProgress\n\n  Application.ScreenUpdating = True\n\nEnd Sub\nFunction GetOtherParty(ItemCrnt As Outlook.MailItem) As String\n\n  ' If the sender is one of my email addresses, return recipient.\n  ' Otherwise return sender.\n\n  Dim InxR As Long\n  Dim OtherParty As String\n  Dim EmailIn As Boolean\n\n  With ItemCrnt\n\n    EmailIn = True  ' Assume incoming email until find otherwise\n    OtherParty = .SenderEmailAddress\n    If OtherParty = \" tonydallimore@myisp.com\" Then\n      EmailIn = False\n    ElseIf OtherParty = \"tonydallimore@gmail.com\" Then\n      EmailIn = False\n    End If\n\n    If Not EmailIn Then\n      ' Create OtherParty from Recipients\n      OtherParty = .Recipients(1).Address\n        For InxR = 2 To .Recipients.Count\n          OtherParty = OtherParty &amp; vbLf &amp; .Recipients(InxR).Address\n        Next\n     End If\n\n   End With\n\n  GetOtherParty = OtherParty\n\nEnd Function\nSub HandleDestAndMove()\n\n  ' Before calling this routine:\n  '  1. Find one or more rows with Other Party = \"Xxxx\" and with Folder not\n  '     correct for Other Party Xxxx.  Set Status of these rows to \"Move\".\n  '  2. Find the row with Other Party = \"Xxxx\" and with Folder correct\n  '     for Other Party Xxxx.  Set Status of this row to \"Dest\".\n  '  3. If no suitable dest row exists, because no emails for the Other Party\n  '     are present in the dest folder, create such a row.  If this folder\n  '     does not exist within Outlook, this routine will create it.\n\n  ' Finds matching Dest and Move rows in worksheet \"Email\" and move emails\n  ' from the folders identified in Move rows to the folder identified in the\n  ' matching Dest row.\n\n  ' 1. Look for \"Dest\" in column Status.  Record Other Party And Folder.\n  ' 2. Find or create dest folder within Outlook.\n  ' 3. Find a row with \"Move\" in column Status and the same Other Party\n  '    as the dest row.\n  ' 4. Find the move folder within Outlook.\n  ' 5  Move all emails for the Other Party from the move folder to the\n  '    dest folder.\n  ' 6  Reduce count of move row and increase count of dest row\n  ' 7  Repeat steps 3 to 6 until all move rows for the Other Party have\n  '    been priocessed.\n  ' 8  Repeat steps 1 to 7 until all dest row have been processed.\n  ' 9  Delete all move rows with count of 0\n\n  Dim AppOut As Outlook.Application\n  Dim CountDest As Long\n  Dim ErrMsg As String\n  Dim FldrDest As Outlook.Folder\n  Dim FldrDestName As String\n  Dim FldrSrc As Outlook.Folder\n  Dim FldrSrcName As String\n  Dim InxI As Long\n  Dim InxR As Long\n  'Dim MatchFound As Boolean\n  Dim NumFldrsDestPrcd As Long       ' Number of destination folders processed so far\n  Dim NumFldrsDestTtl As Long        ' Total number of destination folders\n  Dim NumItemsToMoveCrnt As Long     ' Number of emails in current move fldr according to worksheet\n  Dim NumItemsToMovePrcd As Long     ' Actual number of emails moved\n  Dim NumItemsToMoveTtl As Long      ' Total number of emails to move according to worksheet\n  Dim OtherPartyDest As String\n  Dim OtherPartyEmail As String\n  Dim Rng As Range\n  Dim RowEmailsCrnt As Long\n  Dim RowEmailsDestOrig As Long\n  Dim RowEmailsDestCrnt As Long\n  Dim RowEmailsMoveOrig As Long\n  Dim RowEmailsMoveCrnt As Long\n  Dim WshtEmails As Worksheet\n\n  Application.ScreenUpdating = False\n\n  Load frmProgress\n  With frmProgress\n    .Caption = \"Handle moves\"\n    .lblMsg.Caption = \"Accessing work load\"\n    .lblFldr.Caption = \"Destination folders\"\n    .lblFldrCrnt.Caption = \"\"\n    .lblFldrOf.Caption = \"\"\n    .lblFldrMax.Caption = \"0\"\n    .lblItem.Caption = \"Total mail items to move\"\n    .lblItemCrnt.Caption = \"\"\n    .lblItemOf.Caption = \"\"\n    .lblItemMax.Caption = \"0\"\n    .Show vbModeless\n  End With\n  DoEvents\n\n  Set WshtEmails = Worksheets(\"Emails\")\n\n  NumFldrsDestTtl = 0\n  NumItemsToMoveTtl = 0\n\n  RowEmailsCrnt = 1\n\n  'Count number of occurrences of \"dest\" and \"move\" in status column\n  With WshtEmails\n    ' Find first value in status column\n    Set Rng = .Columns(ColEmailsStatus).Find( _\n                What:=\"*\", After:=.Cells(RowEmailsCrnt, ColEmailsStatus), _\n                LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n                SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n    If Rng Is Nothing Then\n      Debug.Assert False\n      Call MsgBox(\"No rows found with anything in status column\", vbOKOnly)\n      Unload frmProgress\n      Exit Sub\n    End If\n    ' Process value just found in status column then find next value.\n    ' Loop until next value is on row 1.\n    Do While True\n      If LCase(.Cells(Rng.Row, ColEmailsStatus).Value) = \"dest\" Then\n        NumFldrsDestTtl = NumFldrsDestTtl + 1\n        frmProgress.lblFldrMax.Caption = NumFldrsDestTtl\n      ElseIf LCase(.Cells(Rng.Row, ColEmailsStatus).Value) = \"move\" Then\n        If IsNumeric(.Cells(Rng.Row, ColEmailsCount).Value) Then\n          NumItemsToMoveTtl = NumItemsToMoveTtl + .Cells(Rng.Row, ColEmailsCount).Value\n          frmProgress.lblItemMax.Caption = NumItemsToMoveTtl\n        Else\n          .Cells(Rng.Row, ColEmailsCount).Value = 0\n        End If\n      End If\n      DoEvents\n      Set Rng = .Columns(ColEmailsStatus).FindNext(Rng)\n      If Rng.Row = 1 Then\n        ' Have looped back to top row\n        Exit Do\n      End If\n    Loop\n  End With  ' WshtEmails\n\n  If NumFldrsDestTtl = 0 Or NumItemsToMoveTtl = 0 Then\n    Debug.Assert False\n    Call MsgBox(\"Nothing found to do\", vbOKOnly)\n    Unload frmProgress\n    Exit Sub\n   End If\n\n  With frmProgress\n    .lblMsg.Caption = \"Opening Outlook if not already open\"\n  End With\n  DoEvents\n\n  ' There can only be one instance of Outlook open.  If Outlook is already\n  ' open, CreateObject will create a link to that instance. If the user opens\n  ' and closes Outlook while this macro is running, it will close the instance\n  ' this macro is using.\n  Set AppOut = CreateObject(\"Outlook.Application\")\n\n  With frmProgress\n    .lblMsg.Caption = \"Moving emails to correct folder\"\n    .lblFldrCrnt.Caption = \"0\"\n    .lblFldrOf.Caption = \"of\"\n    .lblItemCrnt.Caption = \"0\"\n    .lblItemOf.Caption = \"of\"\n  End With\n  DoEvents\n\n  RowEmailsDestOrig = 0   ' No dest row found\n  RowEmailsDestCrnt = 1   ' Start row for first search for dest row\n\n  ' This outer loop find first occurence of \"dest\" in status column. When\n  ' inner loop has finished processing move rows, the next dest row is found.\n  ' This continues until the first dest row is found again.\n  Do While True\n\n    With WshtEmails\n\n      Set Rng = .Columns(ColEmailsStatus).Find( _\n                  What:=\"dest\", After:=.Cells(RowEmailsDestCrnt, ColEmailsStatus), _\n                  LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n                  SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n      If Rng Is Nothing Then\n        Debug.Assert False\n        Call MsgBox(\"No row found with 'Dest' in status column\", vbOKOnly)\n        Exit Sub\n      End If\n      If RowEmailsDestOrig = 0 Then\n        ' This is first dest row found.  When it is found again, all dest rows\n        ' have been processed.\n        'Debug.Assert False\n        RowEmailsDestOrig = Rng.Row\n      ElseIf RowEmailsDestOrig = Rng.Row Then\n        ' Have looped back to first dest row\n        'Debug.Assert False\n        Exit Do\n      End If\n      RowEmailsDestCrnt = Rng.Row\n      OtherPartyDest = .Cells(RowEmailsDestCrnt, ColEmailsOtherParty).Value\n      FldrDestName = .Cells(RowEmailsDestCrnt, ColEmailsFldrName).Value\n      If .Cells(RowEmailsDestCrnt, ColEmailsCount).Value = \"\" Then\n        'Debug.Assert False\n        .Cells(RowEmailsDestCrnt, ColEmailsCount).Value = 0\n      End If\n      CountDest = .Cells(RowEmailsDestCrnt, ColEmailsCount).Value\n      ' Count column will be increased for each email moves into dest fldr.\n    End With  ' WshtEmails\n\n    Debug.Print \"Dest \" &amp; OtherPartyDest &amp; \" \" &amp; RowEmailsDestCrnt\n    Debug.Print \"  \" &amp; FldrDestName\n    Debug.Print \"  CountDest \" &amp; CountDest\n    Set FldrDest = GetFldrRef(AppOut, FldrDestName, True, ErrMsg)\n    If ErrMsg &lt;&gt; \"\" Then\n      Debug.Print \"  GetFldrRef: \" &amp; ErrMsg\n    Else\n      Debug.Print \"  GetFldrRef: \" &amp; FldrDest.Name\n    End If\n\n    RowEmailsMoveOrig = 0                   ' No move row found\n    RowEmailsMoveCrnt = RowEmailsDestCrnt   ' Start row for search for move row\n\n    ' This inner loop find first occurence of \"move\" in status column after the\n    ' dest row. When processing of the move row has finished, the next move row\n    ' is found. This continues until the first move row is found again.\n    Do While True\n\n      With WshtEmails\n\n        Set Rng = .Columns(ColEmailsStatus).Find( _\n                    What:=\"move\", After:=.Cells(RowEmailsMoveCrnt, ColEmailsStatus), _\n                    LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n        If Rng Is Nothing Then\n          'Debug.Assert False\n          Call MsgBox(\"No rows found with 'Move' in status column\", vbOKOnly)\n          Exit Do\n        End If\n      End With\n\n      RowEmailsMoveCrnt = Rng.Row\n      If RowEmailsMoveOrig = 0 Then\n        ' This is first move row found after dest row.  When it is found again,\n        ' all move rows have been checked.\n        'Debug.Assert False\n        RowEmailsMoveOrig = RowEmailsMoveCrnt\n      ElseIf RowEmailsMoveOrig = RowEmailsMoveCrnt Then\n        ' Have looped back to first move row\n        'Debug.Assert False\n        Exit Do\n      End If\n\n      ' Have a new move row but may not be for dest row\n\n      If OtherPartyDest = WshtEmails.Cells(RowEmailsMoveCrnt, ColEmailsOtherParty).Value Then\n        ' Have move row for current dest row\n        'Debug.Assert False\n        FldrSrcName = WshtEmails.Cells(RowEmailsMoveCrnt, ColEmailsFldrName).Value\n        NumItemsToMoveCrnt = WshtEmails.Cells(RowEmailsMoveCrnt, ColEmailsCount).Value\n        Debug.Print \"  Move \" &amp; RowEmailsMoveCrnt &amp; \" \" &amp; FldrSrcName\n\n        Set FldrSrc = GetFldrRef(AppOut, FldrSrcName, False, ErrMsg)\n        If ErrMsg &lt;&gt; \"\" Then\n          Debug.Print \"    GetFldrRef: \" &amp; ErrMsg\n          Debug.Assert False\n        Else\n          Debug.Print \"    FldrSrc.Name: \" &amp; FldrSrc.Name\n        End If\n\n        ' Have found move row for current dest row\n        ' Move all MailItems for other party to dest fldr\n        For InxI = FldrSrc.Items.Count To 1 Step -1\n          If OtherPartyDest = GetOtherParty(FldrSrc.Items(InxI)) Then\n            Debug.Print \"    Match \" &amp; FldrSrc.Items(InxI).ReceivedTime\n            FldrSrc.Items(InxI).Move FldrDest\n            NumItemsToMovePrcd = NumItemsToMovePrcd + 1\n            CountDest = CountDest + 1\n            With frmProgress\n              .lblItemCrnt.Caption = NumItemsToMovePrcd\n            End With\n            DoEvents\n            NumItemsToMoveCrnt = NumItemsToMoveCrnt - 1\n          Else\n            'Debug.Print \"NonMt \" &amp; FldrSrc.Items(InxI).ReceivedTime\n          End If\n        Next InxI\n        Debug.Print \"    CountDest \" &amp; CountDest\n        WshtEmails.Cells(RowEmailsMoveCrnt, ColEmailsCount).Value = NumItemsToMoveCrnt\n        WshtEmails.Cells(RowEmailsMoveCrnt, ColEmailsReceivedTime).Value = \"\"\n        WshtEmails.Cells(RowEmailsDestCrnt, ColEmailsCount).Value = CountDest\n        Debug.Print \"    NumItemsToMoveCrnt \" &amp; NumItemsToMoveCrnt\n        If NumItemsToMoveCrnt &lt;&gt; 0 Then\n          'Debug.Assert False\n          ' The actual number of emails found did not match the count in the worksheet\n          ' Adjust display counts\n          NumItemsToMoveTtl = NumItemsToMoveTtl - NumItemsToMoveCrnt\n          With frmProgress\n            .lblItemMax.Caption = NumItemsToMoveTtl\n          End With\n          DoEvents\n        End If\n\n      End If  ' move row for current dest row\n\n    Loop  ' for all move rows\n\n    NumFldrsDestPrcd = NumFldrsDestPrcd + 1\n    Debug.Print \"NumFldrsDestPrcd \" &amp; NumFldrsDestPrcd\n    With frmProgress\n      .lblFldrCrnt.Caption = NumFldrsDestPrcd\n    End With\n    DoEvents\n\n  Loop  ' for all dest rows\n\n  With frmProgress\n    .lblMsg.Caption = \"Closing Outlook if not opened by another process\"\n  End With\n  DoEvents\n\n  AppOut.Quit\n  Set AppOut = Nothing\n\n  With frmProgress\n    .lblMsg.Caption = \"Deleting move rows with a count of zero\"\n    .lblFldr.Caption = \"\"\n    .lblFldrCrnt.Caption = \"\"\n    .lblFldrOf.Caption = \"\"\n    .lblFldrMax.Caption = \"\"\n    .lblItem.Caption = \"Move rows deleted\"\n    .lblItemCrnt.Caption = \"0\"\n    .lblItemOf.Caption = \"\"\n    .lblItemMax.Caption = \"\"\n  End With\n  DoEvents\n\n  With WshtEmails\n\n    RowEmailsMoveCrnt = 1\n\n    Do While True  ' Loop until no move rows with a count of 0\n\n      Set Rng = .Columns(ColEmailsStatus).Find( _\n                  What:=\"move\", After:=.Cells(RowEmailsMoveCrnt, ColEmailsStatus), _\n                  LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n                  SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n      If Rng Is Nothing Then\n        'Debug.Assert False\n        ' All move row deleted\n        Exit Do\n      End If\n\n      RowEmailsMoveCrnt = Rng.Row\n      RowEmailsMoveOrig = RowEmailsMoveCrnt\n\n      Do While True\n        If WshtEmails.Cells(RowEmailsMoveCrnt, ColEmailsCount).Value = 0 Then\n          ' This row is to be deleted\n          .Rows(RowEmailsMoveCrnt).Delete\n          RowEmailsMoveCrnt = RowEmailsMoveCrnt - 1\n          RowEmailsMoveOrig = 0\n          Exit Do\n        End If\n        Set Rng = .Columns(ColEmailsStatus).Find(Rng)\n        RowEmailsMoveCrnt = Rng.Row\n        If RowEmailsMoveOrig = RowEmailsMoveCrnt Then\n          ' Have move rows but none with a count of 0\n          Exit Do\n        End If\n      Loop  ' until row deleted or no row to delete\n\n      If RowEmailsMoveOrig = RowEmailsMoveCrnt Then\n        ' There are move rows but none with a count of 0\n        Exit Do\n      End If\n\n    Loop  ' until no move rows with a count of 0\n\n  End With\n\n  Unload frmProgress\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 2801393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AqwCZ.jpg?s=128&g=1", "display_name": "David Mountain", "link": "https://stackoverflow.com/users/2801393/david-mountain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1591040318, "creation_date": 1564555125, "last_edit_date": 1591040318, "question_id": 57284665, "link": "https://stackoverflow.com/questions/57284665/how-to-move-email-to-a-folder-inside-a-folder", "title": "How to move email to a folder inside a folder?", "body": "<p>I'm trying to move emails that match existing patterns.</p>\n\n<p>How do I move mail to a folder inside a folder? e.g. designteam>mike or designteam>sandy</p>\n\n<p>I copied this. I struggle to understand what Tabs is doing. Is it just storing the number of tabs?</p>\n\n<p>At some point in this can I store the path to the folder?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub GetListOfFolders()\n    On Error GoTo On_Error\n\n    Dim Session As Outlook.NameSpace\n    Dim Report As String\n    Dim Folders As Outlook.Folders\n    Dim Folder As Outlook.Folder\n    Dim reply As Integer\n\n    Set Session = Application.Session\n\n    Set Folders = Session.Folders\n\n    For Each Folder In Folders\n        Call RecurseFolders(Folder, vbTab, Report)\n    Next\n    Dim retValue As Boolean\n    Debug.Print (Report)\n\nExiting:\n        Set Session = Nothing\n        Exit Sub\nOn_Error:\n    MsgBox \"error=\" &amp; Err.Number &amp; \" \" &amp; Err.Description\n    Resume Exiting\n\nEnd Sub\n\n\nPrivate Sub RecurseFolders(CurrentFolder As Outlook.Folder, Tabs, Report As String)\n    Dim Table As Outlook.Table\n    Dim Row As Outlook.Row\n    Dim rowValues() As Variant\n    Dim SubFolders As Outlook.Folders\n    Dim SubFolder As Outlook.Folder\n\n    Report = Report &amp; Tabs &amp; CurrentFolder.Name &amp; vbCrLf\n\n    Set SubFolders = CurrentFolder.Folders\n    For Each SubFolder In SubFolders\n        Call RecurseFolders(SubFolder, Tabs &amp; vbTab, Report)\n    Next SubFolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1564552475, "post_id": 57284039, "comment_id": 101063279, "body": "\u2460 What are you trying to do with that code? Please describe with words. \u2461 Where did you get this error? \u2462 What is the formula in <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;d8:G32&quot;)</code> and <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;k7&quot;)</code>?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1564554868, "post_id": 57284039, "comment_id": 101064262, "body": "Is the name of one of your sheets really &quot;Waste Claculation&quot;? Sounds like a typo. And why do you open the same file 2 times?"}, {"owner": {"reputation": 1, "user_id": 11861966, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a14MIIYZ6So/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4NzZlpZo-DqQ8WIL3yyjn98orHw/photo.jpg?sz=128", "display_name": "Cagri iyican", "link": "https://stackoverflow.com/users/11861966/cagri-iyican"}, "edited": false, "score": 0, "creation_date": 1564578325, "post_id": 57284039, "comment_id": 101077280, "body": "First of all thank you for your replies. I am trying to copy some values from 2 &quot;different&quot; books that I can download. For copying from closed books I am using the functions that you can see upper part in my code. The typo is a mistake I can understand bu the Major issue is that I can not copy anything from a file which has foreign letters. The name of my file is originally &quot;&#220;retim \u0130zleme&quot;. So whenever I try to put this file name in my code I get an error that I mentioned earlier.So basically the VBA can not read foreign languages. I do not know how to make vba reads files with foreign letters"}], "owner": {"reputation": 1, "user_id": 11861966, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a14MIIYZ6So/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4NzZlpZo-DqQ8WIL3yyjn98orHw/photo.jpg?sz=128", "display_name": "Cagri iyican", "link": "https://stackoverflow.com/users/11861966/cagri-iyican"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564552309, "creation_date": 1564552135, "last_edit_date": 1564552309, "question_id": 57284039, "link": "https://stackoverflow.com/questions/57284039/vba-project-can-not-detect-foreign-letters", "title": "VBA project can not detect foreign letters", "body": "<p>Whenever I try to take data from a xlsx document wich consists letters like \"\u00f6 \u00fc \u0130\" and etc I get some error. </p>\n\n<p>I have already tried to change the language of the program also the changing language for non-unicode programs. It did not work</p>\n\n<pre><code>Sub Getdataclosed()    \n    Dim src As Workbook        \n    Set src = Workbooks.Open(\"C:\\Users\\ciyican\\Desktop\\Daily_LU31_DM_Report\\nameofthebook.xlsx\", True, True)\n\n    ThisWorkbook.Activate        \n    Worksheets(\"Sheet1\").Range(\"A2:d26\").Formula = src.Worksheets(\"Sheet1\").Range(\"d8:G32\").Formula        \n\n    Set src = Workbooks.Open(\"C:\\Users\\ciyican\\Desktop\\Daily_LU31_DM_Report\\nameofthebook.xlsx \", True, True)\n\n    ThisWorkbook.Activate\n    Worksheets(\"Waste Claculation\").Range(\"h3\").Formula = src.Worksheets(\"Sheet1\").Range(\"k7\").Formula\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Application defined or object defined error</p>\n</blockquote>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11861729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897dd1a5582bb85b591c7d6318811ef4?s=128&d=identicon&r=PG&f=1", "display_name": "pira___", "link": "https://stackoverflow.com/users/11861729/pira"}, "is_accepted": false, "score": 2, "last_activity_date": 1564549089, "creation_date": 1564549089, "answer_id": 57283463, "question_id": 57283340, "link": "https://stackoverflow.com/questions/57283340/can-not-run-excel-macro-via-python-using-xlwings/57283463#57283463", "title": "Can not run Excel macro via Python using xlwings", "body": "<p>I solved it by myself.</p>\n\n<p>I edited the code like this and it works correctly.</p>\n\n<pre><code>macro = wb.macro('ThisWorkbook.test')\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11861729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897dd1a5582bb85b591c7d6318811ef4?s=128&d=identicon&r=PG&f=1", "display_name": "pira___", "link": "https://stackoverflow.com/users/11861729/pira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1564552072, "creation_date": 1564548311, "last_edit_date": 1564552072, "question_id": 57283340, "link": "https://stackoverflow.com/questions/57283340/can-not-run-excel-macro-via-python-using-xlwings", "title": "Can not run Excel macro via Python using xlwings", "body": "<p>I'm trying to run simple Excel macro via Python using xlwings but it doesn't work.</p>\n\n<p>I tried to run Python in JupyterLab. Both code, VBA and Python, are so simple and when I run VBA code in Excel, it works correctly. Also, I tried some simple python code using xlwings like</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import xlwings as xw\n\nwb = xw.Book('test.xlsm')\nsheet = wb.sheets[0]\nsheet.range('A1').value = 'test'\n</code></pre>\n\n<p>works correctly.</p>\n\n<p>However, the python code below doesn't work.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import xlwings as xw\n\nwb = xw.Book('test.xlsm')\nmacro = wb.macro('test')\nmacro()\n</code></pre>\n\n<p>I put this VBA code below on \"ThisWorkbook\" in ExcelVBA editor.</p>\n\n<pre><code>Sub test()\n    Range(\"A1\").Value = \"This is a test.\"\nEnd Sub\n</code></pre>\n\n<p>Error message is like this.</p>\n\n<pre><code>com_error: \"Cannot run the macro 'test.xlsm'!test'. The macro may not be available in this workbook or all macros may be disabled.\"\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11340735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d36ff735c9af128d1f93f609b354580?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/11340735/rick-smith"}, "edited": false, "score": 0, "creation_date": 1564685203, "post_id": 57284563, "comment_id": 101122389, "body": "This didn&#39;t work either.  I have tried so many different ways to do this, I think it has something to do with the checkboxes themselves, but not sure.  I used this code                                                            Private Sub Form_Current()  If Me.StartTimeChallengeYes.Value = True Then Me.StartTimeChallengeYes.Visible = False Else Me.StartTimeChallengeYes.Visible = True End If  End Sub"}], "tags": [], "owner": {"reputation": 407, "user_id": 9642355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wrulj.png?s=128&g=1", "display_name": "Fil", "link": "https://stackoverflow.com/users/9642355/fil"}, "is_accepted": false, "score": 0, "last_activity_date": 1564554594, "creation_date": 1564554594, "answer_id": 57284563, "question_id": 57283106, "link": "https://stackoverflow.com/questions/57283106/make-check-boxes-disappear-if-the-value-of-another-field-is-equal-to-a-specific/57284563#57284563", "title": "Make check boxes disappear if the value of another field is equal to a specific string", "body": "<p>Try using <code>Form_Current</code> event.\nOn the control say:</p>\n\n<pre><code>Private Sub Form_Current()\nIf (Me.Textbox1.Value = Me.Textbox2.Value) Then\nMe.Textbox2.Visible = False\nMe.Textbox3.FontBold = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11340735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d36ff735c9af128d1f93f609b354580?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/11340735/rick-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594549060, "creation_date": 1564546657, "last_edit_date": 1594549060, "question_id": 57283106, "link": "https://stackoverflow.com/questions/57283106/make-check-boxes-disappear-if-the-value-of-another-field-is-equal-to-a-specific", "title": "Make check boxes disappear if the value of another field is equal to a specific string", "body": "<p>I am trying to make the checkboxes in the record disappear if the value of the field is equal to \"Basic Actions\".  I would also like to make the font bold turning it into a header.</p>\n\n<p>I have tried the .Visible and .Fontbold properties using an If-Then statement.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Load()\n\n    If Form_Sub_MonSAChallenges.StandardAction = \"Basic Actions\" Then\n        Form_Sub_MonSAChallenges.StandardAction.FontBold = True\n        Form_Sub_MonSAChallenges.StartTimeChallengeYes.Visible = False\n        Form_Sub_MonSAChallenges.StartTimeChallengeNo.Visible = False\n        Form_Sub_MonSAChallenges.ActivityChallengeYes.Visible = False\n        Form_Sub_MonSAChallenges.ActivityChallengeNo.Visible = False\n    Else\n        Form_Sub_MonSAChallenges.StandardAction.FontBold = False\n        Form_Sub_MonSAChallenges.StartTimeChallengeYes.Visible = True\n        Form_Sub_MonSAChallenges.StartTimeChallengeNo.Visible = True\n        Form_Sub_MonSAChallenges.ActivityChallengeYes.Visible = True\n        Form_Sub_MonSAChallenges.ActivityChallengeNo.Visible = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I'm not getting any error messages, the form loads, but without the needed changes.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1564542712, "creation_date": 1564542712, "answer_id": 57282639, "question_id": 57282468, "link": "https://stackoverflow.com/questions/57282468/copying-specific-data-from-workbook-a-houses-code-to-workbook-b/57282639#57282639", "title": "Copying specific data from workbook A (houses code) to workbook B", "body": "<pre><code>Cells.Range(Cells(1, 1), Cells(6, 1)).Value = _\n                   ParentData.Range(Cells(6, 1), Cells(11, 1)).Value\n</code></pre>\n\n<p>This will fail when <code>ParentData</code> is not the active sheet, because your calls to <code>Cells()</code> will default to the activesheet, even though they're wrapped in a <code>Range()</code> scoped to <code>ParentData</code>.</p>\n\n<p>This should work:</p>\n\n<pre><code>Cells.Range(Cells(1, 1), Cells(6, 1)).Value = _\n           ParentData.Range(ParentData.Cells(6, 1), ParentData.Cells(11, 1)).Value \n</code></pre>\n\n<p>See: <a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\">What is the default scope of worksheets and cells and range?</a></p>\n"}], "owner": {"reputation": 27, "user_id": 11861480, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gd9axUwlw7E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3EnyQNvvwrQG3mpIVpHSzZdC27g/photo.jpg?sz=128", "display_name": "Tangerine Dream", "link": "https://stackoverflow.com/users/11861480/tangerine-dream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 57282639, "answer_count": 1, "score": 0, "last_activity_date": 1564542712, "creation_date": 1564541166, "last_edit_date": 1564542022, "question_id": 57282468, "link": "https://stackoverflow.com/questions/57282468/copying-specific-data-from-workbook-a-houses-code-to-workbook-b", "title": "Copying specific data from workbook A (houses code) to workbook B", "body": "<p>I've been working at this for a bit. I have data in one column, separated by headers. Based off the user's interactions with the GUI, I want to be able to select portions of the data, that will then be written to a separate workbook. I have the rows for the data indexed into a variable. \nI think I have basically got it, but my indexing is not working for some reason when I use numerical indexing (eg Range(Cells(1, 1), Cells(6, 1))</p>\n\n<p>I'm mainly confused by why writing out the index as<br>\n<code>Cells.Range(Cells(1, 1), Cells(6, 1)).Value = ParentData.Range(Cells(6, 1), Cells(11, 1)).Value</code> doesn't work, but </p>\n\n<p><code>Cells.Range(Cells(1, 1), Cells(6, 1)).Value = ParentData.Range(\"A6:A11\").Value</code>\ndoes.</p>\n\n<p>The data I'm copying is just strings, so I'm not sure that copy/paste special would be a better route. I've search around some other stackoverflow.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Complete_Click()\nSet parentWorkbook = Workbooks.Open(Application.ActiveWorkbook.FullName)\nIf OptionButton1 Then\n    ActiveSheetStr = \"Sheet1\"\nEnd If\nIf OptionButton2 Then\n    ActiveSheetStr = \"Sheet2\"\nEnd If\nWorksheets(ActiveSheetStr).Activate\nSet ParentData = Sheets(ActiveSheetStr).UsedRange.Select\n\nWith parentWorkbook.Sheets(ActiveSheetStr)\n    Set FoundCell = .Cells.Find(What:=\"Header 1\")\n    If Not FoundCell Is Nothing Then\n        datRowStart = FoundCell.Row\n        datColStart = FoundCell.Column\n    End If\n    Set FoundCell = .Cells.Find(What:=\"Header 2\")\n    If Not FoundCell Is Nothing Then\n        datRowEnd = FoundCell.Row\n        datColEnd = FoundCell.Column\n    End If\nEnd With\n\n\nnewBook = Workbooks.Add\nWith newBook\n.SaveAs Filename:=\"newBook.xls\"\nEnd With\n\nIf CheckBox1 Then\n'here's what I would actually call\n'Cells.Range(Cells(1, 1), Cells(1 + (datRowEnd - datRowStart - 2), 1)).Value = parentWorkbook.Sheets(ActiveSheetStr).Range(Cells(datRowStart, datColStart), Cells(datRowEnd - 2, datColStart)).Value\n'here's what I'm actually running/testing\nCells.Range(Cells(1, 1), Cells(6, 1)).Value = parentWorkbook.Sheets(ActiveSheetStr).Range(Cells(6, 1), Cells(11, 1)).Value 'does not work\nCells.Range(Cells(1, 1), Cells(6, 1)).Value = ParentData.Range(\"A6:A11\").Value 'works\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Data looks like:</p>\n\n<p>Header 1</p>\n\n<p>blah</p>\n\n<p>blah</p>\n\n<p>blah</p>\n\n<p>Header 2</p>\n\n<p>blah</p>\n\n<p>blah</p>\n\n<p>blah</p>\n\n<p>Works as expected when I use the alphanumeric indexing, gives me a runtime error 1004 \"Application defined or object defined error\" when I use numerical indexing.</p>\n\n<p>Thank you for reading and for the help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1564540847, "post_id": 57282413, "comment_id": 101060677, "body": "Based on your provided code: see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1564541024, "post_id": 57282413, "comment_id": 101060715, "body": "if <code>xxx</code> is static, they should be set outside the loop, not in it. Even better, if <code>some_data + some_data_2</code> is static, set that prior to the loop.  Probably won&#39;t make much difference timewise, but it&#39;s definitely more efficient."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1564548832, "post_id": 57282413, "comment_id": 101062133, "body": "if you are using <code>some_data + some_data_2</code> why not make the constant <code>some_data_2 = some_data + x</code>!? Then you can change this <code>some_data + some_data_2</code> to simply this <code>some_data_2</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1564543689, "creation_date": 1564543689, "answer_id": 57282740, "question_id": 57282413, "link": "https://stackoverflow.com/questions/57282413/excel-running-efficiency/57282740#57282740", "title": "EXCEL running efficiency", "body": "<ul>\n<li><p>You can Benefit from <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to Avoid Using Select</a></p></li>\n<li><p>You can also Make use of <code>Application.Screenupdating = False</code> at start of your code and <code>True</code> in the End. That should make it significantly faster. </p></li>\n<li>Include <a href=\"https://stackoverflow.com/questions/6028288/properly-handling-errors-in-vba-excel\">Error handling</a>, Crashing could be because of Error that occurs somewhere in the Loop.</li>\n</ul>\n\n<p><strong>Change your code without select &amp; Activate like:</strong></p>\n\n<pre><code>    some_data = xxx\n    some_data_2 = xxx\n\n\n   For i = 2 To 60\n\n    Sheets(\"template1\").Copy Before:=Sheets(20)\n\n    Sheets(\"example\").Range(Cells(some_data + 1, i), Cells(some_data + some_data_2, i)).Copy\n\n    Sheets(\"template1 (2)\").Range(\"C5\").Paste\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 11860883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d066e43ee7ac0a67a4d17d509ea186c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/11860883/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564544955, "creation_date": 1564540613, "last_edit_date": 1564544955, "question_id": 57282413, "link": "https://stackoverflow.com/questions/57282413/excel-running-efficiency", "title": "EXCEL running efficiency", "body": "<p>I am trying to improve the efficiency of my following code which is a pretty easy copy paste task</p>\n\n<pre><code>For i = 2 To 60\nsome_data = xxx\nsome_data_2 = xxx\n\n\nSheets(\"template1\").Select\nSheets(\"template1\").Copy Before:=Sheets(20)\n\n\nSheets(\"example\").Select\nRange(Cells(some_data + 1, i), Cells(some_data + some_data_2, i)).Select\nSelection.Copy\n\n\n\nSheets(\"template1 (2)\").Select\nRange(\"C5\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I am only looping this for 60 sheets, then it took several minutes and Excel exited automatically(crahsed?). How can I improve its efficiency?</p>\n\n<p>EIDT: Will it help if I try to rewrite the whole thing using python via for instance openpyxl?</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 69, "user_id": 11710036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdac7783cf18ba2a36d275c4147ef846?s=128&d=identicon&r=PG&f=1", "display_name": "Curiosity_Bug", "link": "https://stackoverflow.com/users/11710036/curiosity-bug"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1564543395, "post_id": 57281999, "comment_id": 101061059, "body": "Few of them are not solved yet, I thought people can help me if it is open. Sure I will close the rest, thanks for reminding."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1564537581, "creation_date": 1564537581, "answer_id": 57282073, "question_id": 57281999, "link": "https://stackoverflow.com/questions/57281999/removing-extra-spaces-of-a-text-without-losing-style-of-slide-using-vba/57282073#57282073", "title": "Removing extra spaces of a text without losing style of slide using VBA?", "body": "<p>This is a slightly revised version of the code in the linked question that uses <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.textrange.replace\" rel=\"nofollow noreferrer\"><code>TextRange.Replace</code></a> instead of writing the trimmed text back to the shape. It should maintain the formatting.</p>\n\n<pre><code>Sub Test()\n    Dim shpTextRng As TextRange\n    Dim sld As Slide\n    Dim shp As Shape\n\n    For Each sld In ActivePresentation.Slides\n        For Each shp In sld.Shapes\n            If shp.HasTextFrame Then\n                Set shpTextRng = shp.TextFrame.TextRange\n\n                Do While InStr(shpTextRng.Text, \"  \") &gt; 0\n                    shpTextRng.Replace FindWhat:=\"  \", ReplaceWhat:=\" \"\n                Loop\n            End If\n        Next shp\n    Next sld\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11710036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdac7783cf18ba2a36d275c4147ef846?s=128&d=identicon&r=PG&f=1", "display_name": "Curiosity_Bug", "link": "https://stackoverflow.com/users/11710036/curiosity-bug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 57282073, "answer_count": 1, "score": 1, "last_activity_date": 1593677708, "creation_date": 1564536829, "last_edit_date": 1593677708, "question_id": 57281999, "link": "https://stackoverflow.com/questions/57281999/removing-extra-spaces-of-a-text-without-losing-style-of-slide-using-vba", "title": "Removing extra spaces of a text without losing style of slide using VBA?", "body": "<p>I am trying to remove extra spaces in text using trim method and with the help of following: <a href=\"https://stackoverflow.com/q/34495654/11710036\">How do I remove extra spaces in PPT using VBA?</a></p>\n\n<p>The problem is, it is changing font color, styling and setting all text in slide to single format/style.</p>\n\n<p>Example:<br>\nSlide has blue colored bold title, remaining text is in black. After running above code the title is changing its style (i.e it is changed to black and not bold).</p>\n"}, {"tags": ["vba", "google-forms"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "edited": false, "score": 0, "creation_date": 1564707882, "post_id": 57282446, "comment_id": 101128562, "body": "Thanks Mikku. I had found out that you could do a form submit and that will do the job."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1564541388, "last_edit_date": 1564541388, "creation_date": 1564541002, "answer_id": 57282446, "question_id": 57281887, "link": "https://stackoverflow.com/questions/57281887/submiting-the-google-form-via-vba-prefill/57282446#57282446", "title": "Submiting the google form via VBA prefill", "body": "<p><strong>This Loop will do that:</strong></p>\n\n<p>Set a ObjCollection to the Elements by Tag name <code>span</code>, Then loop through them and get the element whose innertext is <code>Submit</code>. Assign it to a new variable &amp; Click that Element out of the Loop.</p>\n\n<pre><code>Set objCollection = Nothing\n\nSet objCollection = IE.document.getElementsByTagName(\"span\")\n\ni = 0\n\n\n    While i &lt; objCollection.Length\n        If objCollection(i).innerText = \"Submit\" Then\n            Set objElement = objCollection(i)\n\n        End If\n        i = i + 1\n    Wend\n\nobjElement.Click\n</code></pre>\n\n<p><a href=\"https://www.youtube.com/watch?v=CIjYMZ0Gn1I\" rel=\"nofollow noreferrer\">Link to my Video</a></p>\n"}], "owner": {"reputation": 23, "user_id": 11861243, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Gc2ljPqZQjk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf7hQ18qYXSLATQLZ62Dc1naDXCrw/photo.jpg?sz=128", "display_name": "Shanmugam Arumugam", "link": "https://stackoverflow.com/users/11861243/shanmugam-arumugam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57282446, "answer_count": 1, "score": 1, "last_activity_date": 1564541388, "creation_date": 1564535666, "last_edit_date": 1564535724, "question_id": 57281887, "link": "https://stackoverflow.com/questions/57281887/submiting-the-google-form-via-vba-prefill", "title": "Submiting the google form via VBA prefill", "body": "<p>I am trying to prefil and submit a google form. But I am not sure how I will click the submit button on the google form  from my code.</p>\n\n<p>Please assist with this.</p>\n\n<p>Using VBA to pass data via a google form to google speardsheet.</p>\n\n<p>I am able to manually click  submit button on IE  and data gets saved.</p>\n\n<p>But what / how to do this via code!!!</p>\n\n<pre><code>IE.Visible = True\nIE.navigate \"https://docs.google.com/forms/d/e/12344545/viewform\"\n\nDo While IE.Busy\n    Application.Wait DateAdd(\"s\", 5, Now)\nLoop\n\nSet Doc = IE.document\n\nDoc.getElementById(\"entry.2116136539\").Value = sht.Range(\"A\" &amp; i).Value\nDoc.getElementById(\"entry.451687686\").Value = sht.Range(\"B\" &amp; i).Value\n\n\nDoc.getElementById(\"?????????\").Click\n\n\nNext i\n</code></pre>\n\n<p>Just need the syntax for submit....</p>\n"}, {"tags": ["excel", "vba", "visio"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1564535464, "post_id": 57281836, "comment_id": 101059752, "body": "Untested (I&#39;m not super familiar with Visio), but maybe try <code>Debug.Print objXLApp.ActiveWorkbook.Name</code>. A bit of a shot in the dark, so I won&#39;t be surprised if it fails."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1564535511, "post_id": 57281836, "comment_id": 101059758, "body": "Btw, note that you have a mix of early- and late-binding. It probably makes sense to be consistent."}, {"owner": {"reputation": 21, "user_id": 11861140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OnhNcsQiyNA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfEaJwYWCCDwlWvSkLGj42HhkeWWA/photo.jpg?sz=128", "display_name": "Dan Hintz", "link": "https://stackoverflow.com/users/11861140/dan-hintz"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1564538602, "post_id": 57281836, "comment_id": 101060270, "body": "No dice, I still get the &#39;Object Variable not set error&#39; and a blank printout.  Thanks for the comment about binding though, I wasn&#39;t aware of the 2 options - never done cross application VBA before - I&#39;ll be going through my other macro to apply that, although it did not help in this particular situation."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1564542206, "post_id": 57281836, "comment_id": 101060865, "body": "When you run the Script, Does the Visio save the File somewhere or the Excel Workbook opens up in the Background ?"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1564562202, "post_id": 57281836, "comment_id": 101067957, "body": "As far as I can see the <code>addon(&quot;xxx&quot;).run</code> will not return an excel file/object. The duplicate link above includes a different method to get a reference to the generated excel file."}, {"owner": {"reputation": 21, "user_id": 11861140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OnhNcsQiyNA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfEaJwYWCCDwlWvSkLGj42HhkeWWA/photo.jpg?sz=128", "display_name": "Dan Hintz", "link": "https://stackoverflow.com/users/11861140/dan-hintz"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1564594143, "post_id": 57281836, "comment_id": 101086339, "body": "@L8n - that post held the key: <code>Set AppExcel = GetObject(, &quot;excel.application&quot;)</code> placed just AFTER the line exporting the data &amp; creating the new application instance successfully selects the just-opened workbook.  Thanks for pointing me in that direction, I really thought I&#39;d seen every relevant post on the internet :)."}], "owner": {"reputation": 21, "user_id": 11861140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OnhNcsQiyNA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfEaJwYWCCDwlWvSkLGj42HhkeWWA/photo.jpg?sz=128", "display_name": "Dan Hintz", "link": "https://stackoverflow.com/users/11861140/dan-hintz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1564594333, "answer_count": 0, "score": 2, "last_activity_date": 1564535144, "creation_date": 1564535144, "question_id": 57281836, "link": "https://stackoverflow.com/questions/57281836/activating-an-excel-workbook-created-by-a-visio-shapereport", "closed_reason": "Duplicate", "title": "Activating an Excel Workbook created by a Visio ShapeReport", "body": "<p>First-time poster here.  I've written VBA within a Visio Document, which runs a ShapeReport and exports it as an Excel Workbook.  In this code, I need to then activate that newly created workbook in order to run a separate macro on the exported data, but I can't figure out how to activate the workbook since I don't consistently know the name or file order (Workbooks(1) for example), and I can't set the export line as a variable.\nIn the code below, I need the ActiveWorkbook.Name to print out the workbook that opens in the prior line. Best case would be to figure out how to assign that workbook to the ObjXLBook Variable to be able to easily reference it.</p>\n\n<p>I've tried declaring a Workbook Variable and setting it equal to the line of code which exports/creates the Excel Workbook and I've tried doing nothing and structuring the macro under the assumption that the newly created Workbook would already be activated, but neither option worked.</p>\n\n<p>Current Code:</p>\n\n<pre><code>Sub testExport()\n    Dim objXLApp As Object\n    Dim objXLBook As Excel.Workbook\n\n    Set objXLApp = CreateObject(\"Excel.Application\")\n\n    'create new workbook via report export\n    'this is the workbook that I need to activate and/or assign\n    Visio.Application.Addons(\"VisRpt\").Run (\"/rptDefName=VarianceRep.vrd\")\n\n    Debug.Print (ActiveWorkbook.Name)\n    Debug.Print (objXLBook.Name)\nEnd Sub\n</code></pre>\n\n<p>Attempt 1: Assign Variable</p>\n\n<pre><code>Set objXLBook = Visio.Application.Addons(\"VisRpt\").Run(\"/rptDefName=VarianceRep.vrd\")\n</code></pre>\n\n<p>Attempting to set the variable results in \"Compile Error: Expected Function or Variable\".\nLeaving it blank results in \"Run-time error '91': Object Variable or With block variable not set\" and the debug printing nothing.</p>\n\n<p>I need the debug to print out the name of the newly created workbook which contains the exported data. The second debug will only apply if I can assign the workbook to the objXLBook Variable as well.</p>\n"}, {"tags": ["excel", "vba", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 11535153, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DSIVYzUctwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re6ocrO9kcLSwkgWSMjPKJVkzcDMQ/mo/photo.jpg?sz=128", "display_name": "A.Milosevic", "link": "https://stackoverflow.com/users/11535153/a-milosevic"}, "is_accepted": false, "score": 0, "last_activity_date": 1564530955, "creation_date": 1564530955, "answer_id": 57281451, "question_id": 57281353, "link": "https://stackoverflow.com/questions/57281353/delete-multiple-rows-across-multiple-sheets-containing-the-same-keyword/57281451#57281451", "title": "Delete multiple rows across multiple sheets containing the same keyword", "body": "<p>A quicker way to do it is to use shortcuts to delete the row and then go to the next sheet:</p>\n\n<p>Say you want to delete the 6th row:</p>\n\n<ol>\n<li>Go to the 6th row and hit <code>Shift+Space</code> this will highlight the entire row</li>\n<li>To delete the row <code>Ctrl + -</code> (Ctrl and the minus sign)</li>\n<li>Then to go from sheet one to sheet two you <code>Ctrl + Page Down btn</code></li>\n</ol>\n\n<p>If you really want to save time and know VBA you can create a short script. Unfortunately, I'm on my mac so I can't test one out right now but I found a good link that gives you a step by step <a href=\"https://analysistabs.com/vba/delete-entire-row-excel-macro-code/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1564559218, "creation_date": 1564559218, "answer_id": 57285716, "question_id": 57281353, "link": "https://stackoverflow.com/questions/57281353/delete-multiple-rows-across-multiple-sheets-containing-the-same-keyword/57285716#57285716", "title": "Delete multiple rows across multiple sheets containing the same keyword", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n    Dim LastRow As Long, i As Long\n\n    'Loop all sheets\n    For Each ws In ThisWorkbook.Worksheets\n\n        With ws\n            'Find the last row of column 6\n            LastRow = .Cells(.Rows.Count, 6).End(xlUp).Row\n\n            'Loop all rows in column 6 starting from the last one\n            For i = LastRow To 1 Step -1\n                'If the value is \"MARTIN\" then delete\n                If .Cells(i, 6).Value = \"MARTIN\" Then\n                    .Rows(i).EntireRow.Delete\n                End If\n\n            Next i\n\n        End With\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 3899025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02876f00f401de2a58b0251b77c6e3b2?s=128&d=identicon&r=PG&f=1", "display_name": "marouane91", "link": "https://stackoverflow.com/users/3899025/marouane91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 57285716, "answer_count": 2, "score": 0, "last_activity_date": 1564559218, "creation_date": 1564529916, "last_edit_date": 1564543884, "question_id": 57281353, "link": "https://stackoverflow.com/questions/57281353/delete-multiple-rows-across-multiple-sheets-containing-the-same-keyword", "title": "Delete multiple rows across multiple sheets containing the same keyword", "body": "<p>I have an excel file that contains around 50 sheets, all sheets have the same columns.</p>\n\n<p>However, i would like to delete the entire rows that contains the same keyword <code>\"MARTIN\"</code> located in the 6th/last column in all the sheets.</p>\n\n<p>I have tried to select all sheets at once and then delete the rows but it only worked for one sheet. </p>\n\n<p>So if there is a way to do that either through an excel option or vba i'm all ears to suggestions.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "combobox", "userform"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1564538948, "post_id": 57281348, "comment_id": 101060340, "body": "From the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dropbuttonclick-event\" rel=\"nofollow noreferrer\">MSDN page</a> for the <code>DropButtonClick</code> event - &quot;Occurs whenever the drop-down list appears or disappears&quot;"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1564560901, "post_id": 57281348, "comment_id": 101067241, "body": "It&#39;s common practice to have a <code>sub</code> that initializes the <code>userform</code> and its elements and is triggered by the click of a button which <code>loads</code> and <code>shows</code> the <code>userform</code>. I suggest you populate your combobox in that <code>sub</code> and not by using the <code>DropButtonClick</code> event."}, {"owner": {"reputation": 13, "user_id": 3566139, "user_type": "registered", "profile_image": "https://graph.facebook.com/6408149/picture?type=large", "display_name": "user3566139", "link": "https://stackoverflow.com/users/3566139/user3566139"}, "edited": false, "score": 0, "creation_date": 1564590270, "post_id": 57281348, "comment_id": 101084647, "body": "Thanks for the input. The reason I have many combo boxes populate upon drop down click is because I use them in a down select process so that each subsequent combo box doesn&#39;t have 100% of the available options, but rather reflects a filtered subset reflective of a previous selection the user made. If, for example, the first combobox is STATE, and the user selects California before moving to the next combobox, I want the CITY combo box to recognize the state and only provide the user a list of applicable cities rather than all the cities."}], "owner": {"reputation": 13, "user_id": 3566139, "user_type": "registered", "profile_image": "https://graph.facebook.com/6408149/picture?type=large", "display_name": "user3566139", "link": "https://stackoverflow.com/users/3566139/user3566139"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 548, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564543933, "creation_date": 1564529873, "last_edit_date": 1564543933, "question_id": 57281348, "link": "https://stackoverflow.com/questions/57281348/excel-vba-combobox-dropbuttonclick-event-fires-twice", "title": "Excel VBA ComboBox DropButtonClick() event fires twice", "body": "<p>I have an elaborate dashboard that makes use of several userforms and many controls in each userform. The specific question I have deals with the <code>ComboBox_DropButtonClick()</code> event which appears to be firing twice. The combobox has two events currently, the <code>DropButtonClick()</code>event - where I populate the combo box list via array, and a <code>ComboBox_Change()</code> event. What I'm finding and trying to prevent is that when I click the dropbutton, the <code>DropButtonClick()</code> event fires as expected. When the list appears on the userform, I make a selection. After I've clicked on one of the items, the <code>ComboBox_Change()</code> event fires - also as expected. However, when the <code>ComboBox_Change()</code> event finishes, the <code>ComboBox_DropButtonClick()</code> event fires an additional time, presumably when it closes? I'd prefer the second <code>DropButtonClick()</code> not fire because it runs that code an additional time.</p>\n\n<p>Rather than provide the elaborate dashboard code and also to confirm my findings, I created a second, brand new workbook to demonstrate the issue. I created a single user form, with a single combobox. I created the same two events: <code>DropButtonClick()</code> and <code>Change()</code>. I then wrote a similar snippet of code to populate the combobox list from an array, and then print the combobox value to an arbitrary cell on a blank worksheet. I used a breakpoint in the <code>DropButtonClick()</code> event to help step through the sequence and confirm the events are firing as I've described above. </p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nThisworkbook.worksheets(1).Range(\"A5\") = Me.ComboBox1.Value\n\nend sub\n\nPrivate Sub ComboBox1_DropButtonClick()  \ndim arr as variant  \ndim I as integer  \n\nfor I = 0 to 5  \n    if IsEmpty(arr) then  \n        redim arr(0)  \n    else  \n        redim preserve arr(ubound(arr)+1)  \n    end if  \n    arr(ubound(arr)) = \"A\" &amp; I  \nnext I  \n\nMe.ComboBox1.List = arr  \n\nend sub  \n</code></pre>\n\n<p>I would expect the <code>DropButtonClick()</code> event to fire, which will show me the array of elements to choose from. Then, I make a selection from the option, which should fire the <code>Change()</code> event and print to the worksheet. Check. that all happens. then for some reason, after that has taken place, the <code>DropButtonClick()</code> event fires one more time before all of the execution completes. Trying to understand why the <code>DropButtonClick()</code> event happens twice, and how I might avoid the second event without having to embed a public Boolean variable that exits immediately if <code>true</code> (for example)</p>\n"}, {"tags": ["xml", "vba", "ms-access", "callback"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564528642, "post_id": 57281115, "comment_id": 101058568, "body": "Database should be split and each user run their own copy of frontend."}, {"owner": {"reputation": 13, "user_id": 11762103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Pvv0ZxXM5xs/AAAAAAAAAAI/AAAAAAAAACI/z4DfKwB7gQw/photo.jpg?sz=128", "display_name": "Dovid Sandhaus", "link": "https://stackoverflow.com/users/11762103/dovid-sandhaus"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564532244, "post_id": 57281115, "comment_id": 101059200, "body": "That makes a lot of sense. Does this mean that I have to rebuild the database from scratch, as all the tables are in that same Database and they are all linked to forms and queries?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564538942, "post_id": 57281115, "comment_id": 101060337, "body": "Don&#39;t have to rebuild from scratch. Use the split wizard on Database tab or do it manually. Make a copy and rename it. Delete everything but tables from one, delete tables from the other. Set links in frontend to tables in backend. Distribute frontend to users."}, {"owner": {"reputation": 13, "user_id": 11762103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Pvv0ZxXM5xs/AAAAAAAAAAI/AAAAAAAAACI/z4DfKwB7gQw/photo.jpg?sz=128", "display_name": "Dovid Sandhaus", "link": "https://stackoverflow.com/users/11762103/dovid-sandhaus"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564600700, "post_id": 57281115, "comment_id": 101089174, "body": "Same issue after splitting the database"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564601357, "post_id": 57281115, "comment_id": 101089450, "body": "Was afraid of that but splitting still recommended approach for multi-user db. You are using CurrentProject.Path. If every user runs their own copy opened from their local work station, then the Path will be different for each. However, would think the path would work for all users for non-split version. Try a literal path string instead and see what happens. I would use UNC path: <code>\\\\servername\\path\\test4.bmp</code>"}, {"owner": {"reputation": 13, "user_id": 11762103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Pvv0ZxXM5xs/AAAAAAAAAAI/AAAAAAAAACI/z4DfKwB7gQw/photo.jpg?sz=128", "display_name": "Dovid Sandhaus", "link": "https://stackoverflow.com/users/11762103/dovid-sandhaus"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564608781, "post_id": 57281115, "comment_id": 101092104, "body": "the issue is that it is not running the OnRibbonLoad or the GetImageCallback or the GetUserNameRibbon Sub. it did not even have a chance to get to the CurrentProject.Path"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1564612093, "post_id": 57281115, "comment_id": 101092991, "body": "It works for one user only? Sorry, never had this issue."}], "owner": {"reputation": 13, "user_id": 11762103, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Pvv0ZxXM5xs/AAAAAAAAAAI/AAAAAAAAACI/z4DfKwB7gQw/photo.jpg?sz=128", "display_name": "Dovid Sandhaus", "link": "https://stackoverflow.com/users/11762103/dovid-sandhaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564528621, "creation_date": 1564527798, "last_edit_date": 1564528621, "question_id": 57281115, "link": "https://stackoverflow.com/questions/57281115/microsoft-access-cannot-load-the-macro-or-callback-function-onribbonload", "title": "Microsoft Access cannot load the macro or callback function &#39;OnRibbonLoad&#39;", "body": "<p>I set up a custom ribbon in a Microsoft Access DB that is shared over a network. The OnRibbonLoad functions when one user logs in, however, it does not work when another user logs in even from the same computer.</p>\n\n<p>I changed security permissions within the database for the second user to match the first but beyond that, I don't even know where to start.</p>\n\n<p>VBA</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic globalRibbon As IRibbonUI\n\n\nPublic Sub onRibbonLoad(ByVal ribbon As IRibbonUI)\n   Set globalRibbon = ribbon\nEnd Sub\n\nPublic Sub GetImageCallBack(control As IRibbonControl, ByRef image)\n    Dim strPath As String\n    strPath = CurrentProject.Path &amp; \"\\DbImages\\\"\n\n    Select Case control.ID\n          Case \"appIcon\"\n              Set image = LoadPicture(strPath &amp; \"test4.bmp\")\n    End Select\nEnd Sub\n\nPublic Sub GetUserNameRibbon(control As IRibbonControl, ByRef Label)\n      Label = \"User: \" &amp; Environ(\"Username\")\nEnd Sub\n</code></pre>\n\n<p>XML</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" \nonLoad=\"OnRibbonLoad\"&gt;\n  &lt;ribbon startFromScratch=\"true\"&gt;\n    &lt;tabs&gt;\n      &lt;tab id=\"Home\" label=\"Home\"&gt;\n       &lt;group id =\"Application\" label=\"Application\"&gt;\n         &lt;button id=\"AppIcon\" getImage=\"GetImageCallBack\" size=\"large\"/&gt;\n         &lt;labelControl id=\"UserID\" getLabel=\"GetUserNameRibbon\"/&gt;\n       &lt;/group&gt;\n        &lt;group id=\"Group1\" label=\"Control\"&gt;\n          &lt;button id=\"Primary\" label=\"Primary\" imageMso=\"BlogHomePage\"\n          tag=\"Primary\" onAction=\"ribOpenForm\" getEnabled=\"ControlEnabled\"\n          size=\"large\" supertip=\"Open the Main Menu\"/&gt;\n        &lt;/group&gt;       \n\n      &lt;/tab&gt;\n\n    &lt;/tabs&gt;\n  &lt;/ribbon&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "is_accepted": false, "score": 0, "last_activity_date": 1564527766, "creation_date": 1564527766, "answer_id": 57281110, "question_id": 57281060, "link": "https://stackoverflow.com/questions/57281060/excel-vba-deleting-a-row-if-a-cell-contains-a-text-throughout-whole-workbook/57281110#57281110", "title": "Excel vba Deleting a row if a cell contains a text throughout whole workbook", "body": "<p>Just loop through all the worksheets in the workbook, like so:</p>\n\n<pre><code>For Each ws in Application.ActiveWorkbook.Sheets\n   RemoveRows(ws) 'for each worksheet in ActiveWorkbook, call RemoveRows to remove its rows\nNext ws\n---------------------------------------------\nSub RemoveRows(Worksheet ws)  \n\nDim r As Integer   \nFor r = ws.UsedRange.Rows.Count to 1 step -1\n    If Cells(r, \"C\") = \"-\" Then           \n        ws.Rows(r).EntireRow.Delete    \n    End If\nNext \n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11861007, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6qo4DPXc5gU/AAAAAAAAAAI/AAAAAAAAHtM/osqumsd5_Jo/photo.jpg?sz=128", "display_name": "Kaitlyn Buchholz", "link": "https://stackoverflow.com/users/11861007/kaitlyn-buchholz"}, "edited": false, "score": 0, "creation_date": 1564587995, "post_id": 57281147, "comment_id": 101083440, "body": "This successfully deleted the rows throughout the workbook but only renamed the first worksheet and came up with a 400 error. Any ideas as to why?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 11861007, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6qo4DPXc5gU/AAAAAAAAAAI/AAAAAAAAHtM/osqumsd5_Jo/photo.jpg?sz=128", "display_name": "Kaitlyn Buchholz", "link": "https://stackoverflow.com/users/11861007/kaitlyn-buchholz"}, "edited": false, "score": 0, "creation_date": 1564590168, "post_id": 57281147, "comment_id": 101084580, "body": "Which line was the error and what was the error message?  It&#39;s possible your values in C3 may not all be valid sheet names."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1564527982, "creation_date": 1564527982, "answer_id": 57281147, "question_id": 57281060, "link": "https://stackoverflow.com/questions/57281060/excel-vba-deleting-a-row-if-a-cell-contains-a-text-throughout-whole-workbook/57281147#57281147", "title": "Excel vba Deleting a row if a cell contains a text throughout whole workbook", "body": "<p>Something like this:</p>\n\n<pre><code>Option Explicit\n\nSub Master()\n    Dim ws As Worksheet\n    For Each ws in ActiveWorkbook.Worksheets \n        RemoveRowsWithDash ws\n        RenameSheet ws\n    Next ws\nEnd Sub\n\nSub RemoveRowsWithDash(ws As Worksheet)\n    Dim r As Long   \n    For r = ws.Cells(ws.Rows.Count, \"C\").End(xlUp).Row to 1 step -1\n        If ws.Cells(r, \"C\") = \"-\" Then           \n            ws.Rows(r).EntireRow.Delete    \n        End If\n    Next r\nEnd Sub\n\nSub RenameSheet(ws As Worksheet)\n    ws.Name = ws.Range(\"C3\").Value\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1564560935, "last_edit_date": 1564560935, "creation_date": 1564560247, "answer_id": 57285983, "question_id": 57281060, "link": "https://stackoverflow.com/questions/57281060/excel-vba-deleting-a-row-if-a-cell-contains-a-text-throughout-whole-workbook/57285983#57285983", "title": "Excel vba Deleting a row if a cell contains a text throughout whole workbook", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub Master()\n\n    Dim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        Call RenameSheet(ws)\n        Call RemoveRows(ws)\n\n    Next ws\n\nEnd Sub\n\nSub RenameSheet(ws As Worksheet)\n\n    With ws\n        .Name = .Range(\"C3\").Value\n    End With\n\nEnd Sub\n\nSub RemoveRows(ws As Worksheet)\n\n    Dim Lastrow As Long, Position As Long, i As Long\n\n    With ws\n\n        Lastrow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n        For i = Lastrow To 1 Step -1\n\n            Position = InStr(1, .Cells(i, \"C\").Value, \"-\")\n\n            If Position &gt; 0 Then\n                .Rows(i).EntireRow.Delete\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong></p>\n\n<p>In my opinion is better to:</p>\n\n<ul>\n<li>Check if cell value is not empty</li>\n<li>Check if the new sheet name is not already exist</li>\n<li>Check if the length of the new name because there is a limitation in the number of characters you could use for sheet name (max 31)</li>\n<li>Check the the new name does not include invalid characters (\\,/,*,[,],:,?)</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 11861007, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6qo4DPXc5gU/AAAAAAAAAAI/AAAAAAAAHtM/osqumsd5_Jo/photo.jpg?sz=128", "display_name": "Kaitlyn Buchholz", "link": "https://stackoverflow.com/users/11861007/kaitlyn-buchholz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1564560935, "creation_date": 1564527350, "last_edit_date": 1564544187, "question_id": 57281060, "link": "https://stackoverflow.com/questions/57281060/excel-vba-deleting-a-row-if-a-cell-contains-a-text-throughout-whole-workbook", "title": "Excel vba Deleting a row if a cell contains a text throughout whole workbook", "body": "<p>I want to rename all sheets in a workbook based on a reference cell as well as delete rows that contain \"-\" within column C throughout the whole workbook, but I can't figure out how to apply the code I found on this forum to an entire workbook (and not only one worksheet). Please help!</p>\n\n<pre><code>Sub Master()\nCall RemoveRows()\nCall RenameSheet()\nEnd Sub\n\nSub RemoveRows()\n\nDim r As Integer   \nFor r = Sheet1.UsedRange.Rows.Count to 1 step -1\n    If Cells(r, \"C\") = \"-\" Then           \n        Sheet1.Rows(r).EntireRow.Delete    \n    End If\nNext \n\nEnd Sub\n\n\nSub RenameSheet()\n\nDim rs As Worksheet\n\nFor Each rs In Application.ActiveWorkbook.Sheets\nrs.Name = rs.Range(\"C3\")\nNext rs\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1564527687, "post_id": 57281080, "comment_id": 101058359, "body": "To note - Range.value is not needed"}, {"owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "reply_to_user": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1564527890, "post_id": 57281080, "comment_id": 101058400, "body": "noted, I guess null values is the only possible reason then?"}, {"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1564528111, "post_id": 57281080, "comment_id": 101058444, "body": "I think the cells.value is probably needed though"}], "tags": [], "owner": {"reputation": 766, "user_id": 9217609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa066678695c56e5bd95bc07dd9954f0?s=128&d=identicon&r=PG&f=1", "display_name": "Aiyuni", "link": "https://stackoverflow.com/users/9217609/aiyuni"}, "is_accepted": false, "score": -1, "last_activity_date": 1564527495, "creation_date": 1564527495, "answer_id": 57281080, "question_id": 57281043, "link": "https://stackoverflow.com/questions/57281043/mismatch-during-if-statement/57281080#57281080", "title": "Mismatch during if-statement", "body": "<p>Assuming you have checked for possible null values, then you want to get/set the value of the Cell, not the Cell itself:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim i As Integer, LastRow\n\n'Find the last row in the Information sheet\n'LastRow = Sheets(\"Information\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 3 To 1000 'Check rows 3 through the last one\n\n    If Sheets(\"Information\").Cells(\"A\", i).Value = \"Current\" Then 'Check what row has current\n        Sheets(\"Scorecard\").Range(\"B3\").value = Sheets(\"Information\").Cells(\"A\" &amp; i).value 'Input the name in the scorecard\n\n        End If\n\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11860990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35ae66e275d0667c5895989f8b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "tjlabatte", "link": "https://stackoverflow.com/users/11860990/tjlabatte"}, "edited": false, "score": 0, "creation_date": 1564531219, "post_id": 57281262, "comment_id": 101059041, "body": "This ended up fixing my Mismatch error, now however, it is not entering the if statement even though the statement is true on one account. Do I need to set the cell to be a specific type i.e. text?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 11860990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35ae66e275d0667c5895989f8b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "tjlabatte", "link": "https://stackoverflow.com/users/11860990/tjlabatte"}, "edited": false, "score": 0, "creation_date": 1564531383, "post_id": 57281262, "comment_id": 101059074, "body": "Are you sure there are no extra spaces around the value?"}, {"owner": {"reputation": 13, "user_id": 11860990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35ae66e275d0667c5895989f8b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "tjlabatte", "link": "https://stackoverflow.com/users/11860990/tjlabatte"}, "edited": false, "score": 0, "creation_date": 1564531717, "post_id": 57281262, "comment_id": 101059126, "body": "Yes, I just went and confirmed."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 11860990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35ae66e275d0667c5895989f8b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "tjlabatte", "link": "https://stackoverflow.com/users/11860990/tjlabatte"}, "edited": false, "score": 0, "creation_date": 1564531927, "post_id": 57281262, "comment_id": 101059154, "body": "OK then it&#39;s something else but I&#39;ve no idea what - if the <code>If</code> statement is not getting triggered then it&#39;s difficult to say why without access to the worksheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 11860990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35ae66e275d0667c5895989f8b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "tjlabatte", "link": "https://stackoverflow.com/users/11860990/tjlabatte"}, "edited": false, "score": 0, "creation_date": 1564532309, "post_id": 57281262, "comment_id": 101059207, "body": "Are you actually entering &quot;Current&quot; into that cell, or is it maybe formatted to display that?   In which case try <code>Cells(i, &quot;A&quot;).Text</code> instead"}, {"owner": {"reputation": 13, "user_id": 11860990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35ae66e275d0667c5895989f8b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "tjlabatte", "link": "https://stackoverflow.com/users/11860990/tjlabatte"}, "edited": false, "score": 0, "creation_date": 1564532720, "post_id": 57281262, "comment_id": 101059282, "body": "It is manually put into the cell. But that fixed it there, I also put the cell type as text. Thank you! Everything works now."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1564531380, "last_edit_date": 1564531380, "creation_date": 1564529039, "answer_id": 57281262, "question_id": 57281043, "link": "https://stackoverflow.com/questions/57281043/mismatch-during-if-statement/57281262#57281262", "title": "Mismatch during if-statement", "body": "<pre><code>If Sheets(\"Information\").Cells(\"A\", i).Value = \"Current\" Then\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>If Sheets(\"Information\").Cells(i, \"A\").Value = \"Current\" Then\n</code></pre>\n\n<p>Similarly:</p>\n\n<pre><code>Sheets(\"Information\").Cells(\"A\" &amp; i) &gt;&gt; Sheets(\"Information\").Cells(i, \"A\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11860990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35ae66e275d0667c5895989f8b04bd?s=128&d=identicon&r=PG&f=1", "display_name": "tjlabatte", "link": "https://stackoverflow.com/users/11860990/tjlabatte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 57281262, "answer_count": 2, "score": 1, "last_activity_date": 1564544158, "creation_date": 1564527218, "last_edit_date": 1564544158, "question_id": 57281043, "link": "https://stackoverflow.com/questions/57281043/mismatch-during-if-statement", "title": "Mismatch during if-statement", "body": "<p>I am slowly learning VBA here and I seem to be running into a mismatch problem. The goal is to find the row that I am working on i.e \"Current\" and then autofill the information on the second sheet in specific cells. From using the debugger, the issue seems to be inside the if-statement. Any help is appreciated!</p>\n\n<p>I tried to go through and change the cell type in the sheet itself. Also tried using .Range instead of .Cells (assuming I am even doing that correctly.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim i As Integer, LastRow\n\n'Find the last row in the Information sheet\n'LastRow = Sheets(\"Information\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 3 To 1000 'Check rows 3 through the last one\n\n    If Sheets(\"Information\").Cells(\"A\", i).Value = \"Current\" Then 'Check what row has current\n        Sheets(\"Scorecard\").Range(\"B3\") = Sheets(\"Information\").Cells(\"A\" &amp; i) 'Input the name in the scorecard\n\n        End If\n\n    Next i\n\n\nEnd Sub\n</code></pre>\n\n<p>Error states</p>\n\n<pre><code>Run-time error '13'\nType Mismatch\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1564525266, "post_id": 57280728, "comment_id": 101057769, "body": "Why not abbreviate the state names so in your example NY University."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1564525370, "post_id": 57280728, "comment_id": 101057801, "body": "..and/or replace &quot;University&quot; with &quot;Uni&quot; or &quot;Univ&quot;.  There&#39;s no built-in way to do this - you&#39;d need to define some rules and code them in a function.  If the rules don&#39;t solve the length problem then pop up an Input asking for an alternative name."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 11860883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d066e43ee7ac0a67a4d17d509ea186c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/11860883/adam"}, "edited": false, "score": 1, "creation_date": 1564529980, "post_id": 57280902, "comment_id": 101058824, "body": "Very brilliant!!! Thank you very much! I modified it a little bit though. Instead of using Checkspelling, I created a u = Split(UniversityName, &quot; &quot;) then used a loop to compare v and u. Checkspelling would not work if my name contains something that does not make sense."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1564731961, "last_edit_date": 1564731961, "creation_date": 1564526170, "answer_id": 57280902, "question_id": 57280728, "link": "https://stackoverflow.com/questions/57280728/excel-name-character-restriction/57280902#57280902", "title": "Excel name character restriction", "body": "<p>This should check to see if the last word is spelled correctly, and remove it if it is not. (Untested as I do not have Excel on this machine - corrections welcome)</p>\n\n<pre><code>UniversityName2 = Left$(UniversityName, 30)\nDim v as Variant\nv = Split(UniversityName2, \" \")\nIf Not Application.CheckSpelling(v(Ubound(v))) Then\n  ReDim Preserve v(Ubound(v) - 1)\nEnd If\nDim item as String\nUniversityName2 = \"\"\nFor Each item In v\n  UniversityName2 = UniversityName2 &amp; \" \" &amp; item &amp; \" \"\nNext\nUniversityName2 = Trim$(UniversityName2)\n</code></pre>\n\n<p>You may also want to consider adding some sort of check to see if there is already a sheet with the same name, because if there is, you will get an error as 2 sheets cannot have the same name.</p>\n"}], "owner": {"reputation": 241, "user_id": 11860883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d066e43ee7ac0a67a4d17d509ea186c?s=128&d=identicon&r=PG&f=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/11860883/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57280902, "answer_count": 1, "score": 0, "last_activity_date": 1564731961, "creation_date": 1564524930, "last_edit_date": 1564525413, "question_id": 57280728, "link": "https://stackoverflow.com/questions/57280728/excel-name-character-restriction", "title": "Excel name character restriction", "body": "<p>Is there any way to get around the excel name characters restriction?</p>\n\n<p>Say I have a sheet A with a list of names of n universities in the U.S., now I need to write a VBA code to create n new sheets and copy the names in sheet A to name those n sheets correspondingly. I am able to write codes to do this. However, there is one problem that is so annoying is that: some of the names in sheet A might have too many characters that exceed the maximal character limit of the sheet name Excel allows. Then my program will be interrupted, and I need to name the sheet myself, then rerun the program. How can I solve this?</p>\n\n<pre><code>UniversityName = Worksheets(\"A\").Cells(\"A\" &amp; i).Value\nSheets(\"Sheet1 (2)\").Select\nSheets(\"Sheet1 (2)\").Name = UniversityName\n</code></pre>\n\n<p>One way that I can think of to resolve this is to define UniversityName2 = Left[UniversityName, 30]. However it would cause something like \"New York Universi\"and I really need it to be something that makes sense though not complete. Then a plausible way is to first let it judge whether the length of UniversityName is over 30, if true. Then define UniversityName2 to be such that it contains the maximal possible complete information. In this example it would be New York.</p>\n\n<p>Is there any way to achieve this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1564528454, "post_id": 57280375, "comment_id": 101058523, "body": "Create folder, Set folder location, Loop over worksheets and set filename, copy sheet to new workbook, save using the folder location and filename variables, continue with next iteration. - if only starting from one workbook then you only need one loop"}], "answers": [{"comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1565838447, "post_id": 57282673, "comment_id": 101477326, "body": "Did this Work ? If not I will remove the Answer."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": -1, "last_activity_date": 1564543001, "creation_date": 1564543001, "answer_id": 57282673, "question_id": 57280375, "link": "https://stackoverflow.com/questions/57280375/save-multiple-sheets-from-one-workbook-to-individual-folders/57282673#57282673", "title": "Save multiple sheets from one workbook to individual folders", "body": "<p>Everything was right with your code except the <strong>Folder Paths</strong>. </p>\n\n<p>Use <code>MkDir</code> to create a Folder and then save the Files in it. Use <code>AND</code> in If condition to skip the <code>Master Sheet</code>. I have amended the code.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub saveVisibleSheetsAsXLSM()\n\n    Const exportPath = \"x:\\yourDestinationPath\\\" '**Change your Path HERE**\n\n    Dim ws As Worksheet, wbNew As Workbook\n\n    For Each ws In ThisWorkbook.Sheets\n        If ws.Visible And Not ws.Name = \"master sheet\" Then '**Check the spelling of Master Sheet**\n            Debug.Print \"Exporting: \" &amp; ws.Name\n                ws.Copy\n            Set wbNew = Application.ActiveWorkbook\n            MkDir exportPath &amp; ws.Name\n            wbNew.SaveAs exportPath &amp; ws.Name &amp; \"\\\" &amp; ws.Name &amp; \".xlsm\", 52\n            wbNew.Close\n            Set wbNew = Nothing\n        End If\n\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11353865, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XxuHTn6d6YI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdnJTnYxdWLHHBgFnV6pfTspMgpOA/mo/photo.jpg?sz=128", "display_name": "Madison Hanks", "link": "https://stackoverflow.com/users/11353865/madison-hanks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57282673, "answer_count": 1, "score": 0, "last_activity_date": 1564543001, "creation_date": 1564522653, "last_edit_date": 1564526939, "question_id": 57280375, "link": "https://stackoverflow.com/questions/57280375/save-multiple-sheets-from-one-workbook-to-individual-folders", "title": "Save multiple sheets from one workbook to individual folders", "body": "<p>I have a workbook with many sheets, both hidden and visible. \nI need to copy all but the first sheet to individual folders that are not created </p>\n\n<p>In the original workbook I have :master sheet, sheet 1, sheet 2, sheet 3, etc\nevery sheet has a title inside the sheet at cell A1</p>\n\n<p>I want to copy all EXCEPT master sheet and the hidden sheets. </p>\n\n<p>I need to save the sheets to individual workbooks </p>\n\n<pre><code>U:\\folder\n   \\sheet 1\n   \\sheet 2\n   \\sheet 3\n</code></pre>\n\n<p>I am so confused. I know i need a loop to go through the sheets, I need a loop to save and set the name variable from the sheet as it runs through the loop, and then it also has to create the folders if needed. </p>\n\n<p>I am so lost in how to mesh that many loops and commands. I can see the overall outline but I am getting lost.</p>\n\n<p>I would really appreciate the help.</p>\n\n<p>I've tried several individual solutions but I have NO idea how to incorporate all of them. </p>\n\n<p>'some of the code i found online I've been trying to merge together to one</p>\n\n<pre><code>'copy only visible sheets\nSub saveVisibleSheetsAsXLSM()       'saves all visible sheets as new xlsx files\n    Const exportPath = \"x:\\yourDestinationPath\\\"\n    Dim ws As Worksheet, wbNew As Workbook\n    For Each ws In ThisWorkbook.Sheets                      'for each worksheet\n        If ws.Visible Then                                  'if it's visible:\n            Debug.Print \"Exporting: \" &amp; ws.Name\n            ws.Copy '(if no params specified, COPY creates + activates a new wb)\n            Set wbNew = Application.ActiveWorkbook          'get new wb object\n            wbNew.SaveAs exportPath &amp; ws.Name &amp; \".xlsm\", 52 'save new wb\n            wbNew.Close                                     'close new wb\n            Set wbNew = Nothing                             'cleanup \n        End If\n    Next ws\n    Set ws = Nothing                                        'clean up \nEnd Sub\n\n\n'skip first sheet code\nSub WorksheetLoop()\n\n         Dim WS_Count As Integer\n         Dim I As Integer\n\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\n         WS_Count = ActiveWorkbook.Worksheets.Count\n\n         ' Begin the loop.\n         For I = 1 To WS_Count\n\n            ' Insert your code here.\n            ' The following line shows how to reference a sheet within\n            ' the loop by displaying the worksheet name in a dialog box.\n            MsgBox ActiveWorkbook.Worksheets(I).Name\n\n         Next I\n\n      End Sub\n</code></pre>\n"}, {"tags": ["javascript", "excel", "vba", "google-apps-script"], "comments": [{"owner": {"reputation": 2473, "user_id": 11427375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qg6Nk.jpg?s=128&g=1", "display_name": "ross", "link": "https://stackoverflow.com/users/11427375/ross"}, "edited": false, "score": 2, "creation_date": 1564522714, "post_id": 57280265, "comment_id": 101057012, "body": "This question is it stands is too broad. You need to at least include an attempt to convert your own code to Google Apps Script."}], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 11173654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aUZJ5.jpg?s=128&g=1", "display_name": "MiMi", "link": "https://stackoverflow.com/users/11173654/mimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1564546607, "creation_date": 1564546607, "answer_id": 57283097, "question_id": 57280265, "link": "https://stackoverflow.com/questions/57280265/how-to-hide-columns-with-less-than-one-input-in-google-sheets-script/57283097#57283097", "title": "How to hide columns with less than one input in Google sheets script?", "body": "<p>Try this:</p>\n\n<pre><code>function hideBlankColumns() {\n  var ss=SpreadsheetApp.getActive();\n  var sh=ss.getActiveSheet();\n  var rg=sh.getDataRange();\n  var width=rg.getWidth();//could also be sh.getMaxColumns()\n  for(var c=1;c&lt;=width;c++) {\n    if(getColHeight(c,sh,ss)==0) {\n      sh.hideColumns(c);\n    }\n  }\n}\n\nfunction getColHeight(col,sh,ss){\n  var ss=ss || SpreadsheetApp.getActive();\n  var sh=sh || ss.getActiveSheet();\n  var col=col || sh.getActiveCell().getColumn();\n  var rg=sh.getRange(1,col,sh.getLastRow(),1);\n  var vA=rg.getValues();\n  if(vA) {\n    while(vA.length &amp;&amp; vA[vA.length-1][0].length==0){\n      vA.splice(vA.length-1,1);\n    }\n    return vA.length;\n  }\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 11856799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6c8980db880726ef0bb34e1ebd7c380?s=128&d=identicon&r=PG&f=1", "display_name": "Void", "link": "https://stackoverflow.com/users/11856799/void"}, "is_accepted": false, "score": 0, "last_activity_date": 1564564194, "last_edit_date": 1564564194, "creation_date": 1564559094, "answer_id": 57285683, "question_id": 57280265, "link": "https://stackoverflow.com/questions/57280265/how-to-hide-columns-with-less-than-one-input-in-google-sheets-script/57285683#57285683", "title": "How to hide columns with less than one input in Google sheets script?", "body": "<p>Try this,</p>\n\n<pre><code>function myFunction() {\n  var spreadsheet = SpreadsheetApp.getActive();\n  var sheet = spreadsheet.getActiveSheet();\n  var i;\n  var j;\n  for(i=1;i&lt;=1000;i++)\n  {\n    var count = 0;\n    var r = sheet.getLastRow();\n    for(j=1;j&lt;r;j++)\n    {\n      if(!sheet.getRange(j,i).isBlank())\n      {\n        count++;\n      }\n    }\n    if(count &lt; 2)\n    {\n      sheet.hideColumns(i);\n    }    \n  }  \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19106, "user_id": 11599789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1l1AT.jpg?s=128&g=1", "display_name": "ziganotschka", "link": "https://stackoverflow.com/users/11599789/ziganotschka"}, "is_accepted": false, "score": 0, "last_activity_date": 1564668543, "creation_date": 1564668543, "answer_id": 57310958, "question_id": 57280265, "link": "https://stackoverflow.com/questions/57280265/how-to-hide-columns-with-less-than-one-input-in-google-sheets-script/57310958#57310958", "title": "How to hide columns with less than one input in Google sheets script?", "body": "<h2>Problem</h2>\n\n<ul>\n<li>You have rows hidden by a filter</li>\n<li>You want to hide all columns, which do not have contents in the non-hidden cells</li>\n</ul>\n\n<h2>Solution</h2>\n\n<ul>\n<li>You need a function that returns you the hidden rows</li>\n<li>You loop through all columns</li>\n<li>For each column you loop through all rows and check if the row is not hidden</li>\n<li>For all non-hidden rows, you check if the cell in given column has contents</li>\n<li>If non of the non-hidden cells in a column has contents, you hide this column </li>\n</ul>\n\n<p>If I understood right that this is what you want to do - here is a script that allows you to do so.</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>function getIndexesOfFilteredRows(ssId, sheetId) {\n  var hiddenRows = [];  \n  // get row metadata to find the hidden rows\n  var fields = \"sheets(data(rowMetadata(hiddenByFilter)),properties/sheetId)\";\n  var sheets = Sheets.Spreadsheets.get(ssId, {fields: fields}).sheets;  \n  //Find the right sheet\n  for (var i = 0; i &lt; sheets.length; i++) {\n    if (sheets[i].properties.sheetId == sheetId) {\n      var data = sheets[i].data;\n      var rows = data[0].rowMetadata;\n      for (var j = 0; j &lt; rows.length; j++) {\n        //push the indexes of all hodden rows into an array\n        if (rows[j].hiddenByFilter) hiddenRows.push(j);\n      }\n    }\n  }\n  //return indexes of hidden rows\n  return hiddenRows;\n} \n\nfunction hideEmptyHeaders() {\n  var ssId='XXXXX';\n  var sheetId=0;// adjust if necessary\n  //get the rows that are hidden by a filter\n  var hidden=getIndexesOfFilteredRows(ssId, sheetId);\n  var sheet=SpreadsheetApp.openById(ssId).getSheets()[sheetId];\n  //get all sheet contents\n  var rangeValues=sheet.getDataRange().getValues();\n  //check for every column either the not hidden part of the column is empty\n   for(var j=0;j&lt;rangeValues[0].length;j++)  {\n  // loop through all data rows  \n    for(var i=0;i&lt;rangeValues.length;i++)    {\n    //check if the row is not hidden\n     if((hidden.indexOf(i)+1)==false)       {\n     // if the row is not hidden, check if the cell in column j has content\n        if(rangeValues[i][j]!=\"\"||rangeValues[i][j]!=\"\")        {\n        //if the cell has content, jump to the next column, otherwise check first all the other rows\n          break;\n        }\n      }\n      // if no content has been found in column j after ite5rating through all non-hidden rows, hide column j\n      if(i==(rangeValues.length-1))      {\n        sheet.hideColumns(j+1)\n      }\n    }\n }\n}\n\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11860807, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ScXuDunIkTM/AAAAAAAAAAI/AAAAAAAAAAc/tlfb9spy4IE/photo.jpg?sz=128", "display_name": "Ryan Munker", "link": "https://stackoverflow.com/users/11860807/ryan-munker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1564668543, "creation_date": 1564522112, "last_edit_date": 1564578169, "question_id": 57280265, "link": "https://stackoverflow.com/questions/57280265/how-to-hide-columns-with-less-than-one-input-in-google-sheets-script", "title": "How to hide columns with less than one input in Google sheets script?", "body": "<p>I have a very large data set with clients and prices but not all clients get charged every price. When I filter out a client, I need to be able to run a macro to hide all of the columns that do not have a price associated with the header. I had the macro in Excel working fine but cannot transfer it into google sheets.</p>\n\n<p>Excel VBA that worked perfectly:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub KolumnHider()\n    Dim wf As WorksheetFunction\n    Dim i As Long, r As Range\n\n    Set wf = Application.WorksheetFunction\n    For i = 1 To 1000\n        Set r = Cells(1, i).EntireColumn\n        If wf.Subtotal(3, r) &lt; 2 Then r.Hidden = True\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This formula below is almost what I need. My issue is that I need it to hide the columns based on what is showing. When I filter out the data, I then want to run the macro and hide the columns with empty cells. It works when I filter to the certain row that 'ss.GetRange(3,1,1)' implies. For this example, If I filter to row 3 it works, but I have to change the code to say 6,1,1 for it to hide the correct info on row 6. I need it to hide only the row showing. Please help!</p>\n\n<pre><code>  function hideEmptyHeaders() {\nvar ss = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();\nvar headers = ss.getRange(3, 1, 1, ss.getMaxColumns()).getValues()[0];\nvar columnIndex = 0, numColumns = 0;\nheaders.forEach(function(header, index) {\n  if (!header) {\n    if (!columnIndex)\n      columnIndex = index + 1;\n    numColumns++;\n  } else if (columnIndex &gt; 0) {\n    ss.hideColumns(columnIndex, numColumns);\n    columnIndex = numColumns = 0;\n  }\n});\nif (columnIndex &gt; 0) ss.hideColumns(columnIndex, numColumns);\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1564522038, "post_id": 57280192, "comment_id": 101056786, "body": "Have you tried using a form and textbox on the form instead of an InputBox? An InputBox is limited to 255 characters. It will require a bit more coding."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1564572866, "post_id": 57280192, "comment_id": 101074122, "body": "A possible alternative to the UserForm approach would be to write the list in another document. Then the <code>blueword</code> line could be changed to something like: <code>blueword = Documents(&quot;NAme&quot;).Content.Text</code>. (Note that you&#39;d need to cut off the last character - a paragraph mark - but if the approach is acceptable that&#39;s a very simple thing to do."}, {"owner": {"reputation": 29, "user_id": 9633037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a194d3b5d87a208d3ec0cc4c9adcee?s=128&d=identicon&r=PG&f=1", "display_name": "ninja97", "link": "https://stackoverflow.com/users/9633037/ninja97"}, "edited": false, "score": 0, "creation_date": 1564583143, "post_id": 57280192, "comment_id": 101080455, "body": "Very interesting.  I will try that.  The words are coming from another document anyway.  This could actually save me a step."}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 9390758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f7f95c8a370a7e9afb4f728c5a0bcc?s=128&d=identicon&r=PG&f=1", "display_name": "SlappedProgrammer", "link": "https://stackoverflow.com/users/9390758/slappedprogrammer"}, "is_accepted": false, "score": 1, "last_activity_date": 1564524845, "creation_date": 1564524845, "answer_id": 57280721, "question_id": 57280192, "link": "https://stackoverflow.com/questions/57280192/need-to-be-able-to-input-more-words/57280721#57280721", "title": "Need to be able to input more words", "body": "<p>Add a user form instead, then add a button and a text box (there is no limit on text boxes in forms) then set the button to run the macro taking the input from the forms text box</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 9633037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a194d3b5d87a208d3ec0cc4c9adcee?s=128&d=identicon&r=PG&f=1", "display_name": "ninja97", "link": "https://stackoverflow.com/users/9633037/ninja97"}, "is_accepted": false, "score": 1, "last_activity_date": 1564610451, "creation_date": 1564610451, "answer_id": 57299382, "question_id": 57280192, "link": "https://stackoverflow.com/questions/57280192/need-to-be-able-to-input-more-words/57299382#57299382", "title": "Need to be able to input more words", "body": "<pre><code>Sub BlueWords()\n  Dim blueword As String\n  Dim numberofwords As Long\n\n  Application.ScreenUpdating = False\n\n  ' Enter words that need to become bold blue words.\n  UserForm1.Show\n\n  'blueword = The super long input string in the userform\n  blueword = UserForm1.TextBox1.Text\n  numberofwords = UBound(Split(blueword, \",\"))\n\n ' Find each item and replace it with new one respectively.\n  For numberofwords = 0 To numberofwords\n    With Selection\n      .HomeKey Unit:=wdStory\n      With Selection.Find\n        .Text = Split(blueword, \",\")(numberofwords)\n        .Replacement.Text = \"\"\n        .Replacement.Font.Bold = True\n        .Replacement.Font.ColorIndex = wdBlue\n        .Format = True\n        .MatchWholeWord = True\n      End With\n    Selection.Find.Execute Replace:=wdReplaceAll\n  End With\nNext numberofwords\n\n  Application.ScreenUpdating = True\n\n  Unload UserForm1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9633037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18a194d3b5d87a208d3ec0cc4c9adcee?s=128&d=identicon&r=PG&f=1", "display_name": "ninja97", "link": "https://stackoverflow.com/users/9633037/ninja97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1564610451, "creation_date": 1564521633, "last_edit_date": 1564523011, "question_id": 57280192, "link": "https://stackoverflow.com/questions/57280192/need-to-be-able-to-input-more-words", "title": "Need to be able to input more words", "body": "<p>I am trying to make my macro bring up a search box that allows me to enter as many words as I want, separated by comma, and then find each word in the list in the document and make them bold and blue.  What I have right now actually DOES exactly what I want it to do.  It finds each word that I enter into the searchbox (separated by commas), finds the word, and changes it to bold blue font.</p>\n\n<p>The problem is this:  I need to be able to enter a page or more of words.  InputBox only gives me 255 characters to use at a time.  Is there a modification to make to my code to be able to have no limit to the number of words I can paste in to change?</p>\n\n<p>It doesn't help that I am new at this. It has taken me a day and a half to get where I am right now.</p>\n\n<pre><code>Sub BlueWords()\n  Dim blueword As String\n  Dim numberofwords As Long\n\n  Application.ScreenUpdating = False\n\n  ' Enter words that need to become bold blue words.\n  blueword = InputBox(\"Enter items to be found here,seperated by comma: \", \"Items to be found\")\n  numberofwords = UBound(Split(blueword, \",\"))\n\n ' Find each item and replace it with new one respectively.\n  For numberofwords = 0 To numberofwords\n    With Selection\n      .HomeKey Unit:=wdStory\n      With Selection.Find\n        .Text = Split(blueword, \",\")(numberofwords)\n        .Replacement.Text = \"\"\n        .Replacement.Font.Bold = True\n        .Replacement.Font.ColorIndex = wdBlue\n        .Format = True\n        .MatchWholeWord = True\n      End With\n    Selection.Find.Execute Replace:=wdReplaceAll\n  End With\nNext numberofwords\n\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>It works.  I just need to be able to input more than 255 characters of words at a time.  I need \"no limit\".</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1564521504, "post_id": 57280106, "comment_id": 101056606, "body": "Use <code>&amp;</code> instead of <code>+</code> to concatenate strings in your formula."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1564522254, "post_id": 57280106, "comment_id": 101056861, "body": "What is <code>DSheet</code> and where do you <code>Set</code> it?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1564525582, "post_id": 57280106, "comment_id": 101057864, "body": "<code>DSheet.Name + &quot;&#39;RC13</code> should be <code>DSheet.Name + &quot;&#39;!RC13,</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1564525708, "post_id": 57280106, "comment_id": 101057897, "body": "...and just use <code>DSheet.Cells(i, 14).FormulaR1C1 = ...</code> no need to select anything here.  Your current code may be failing because DSheet isn&#39;t active: you can&#39;t select a range on a non-active sheet."}], "owner": {"reputation": 11, "user_id": 11831321, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AcT7G0MWbKU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reQGLGPUrJZtBs5SmZxqtnwRLsAVA/photo.jpg?sz=128", "display_name": "Andy U", "link": "https://stackoverflow.com/users/11831321/andy-u"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564525734, "creation_date": 1564521155, "last_edit_date": 1564525734, "question_id": 57280106, "link": "https://stackoverflow.com/questions/57280106/using-a-dynamic-table-header-as-a-variable-in-a-vba-formula", "title": "Using a dynamic table header as a variable in a VBA formula", "body": "<p>I am trying to enter a formula into a cell using VBA.  The formula needs to take in the column header of a separate table.</p>\n\n<p>I have tried taking the column header as a value using the <code>Cells.Value</code> function.</p>\n\n<pre><code>Value1 = DSheet.Cells(1, 14).Value\nFor i = 2 To lastRowD\n    DSheet.Cells(i, 14).Select\n    ActiveCell.FormulaR1C1 = \"=SUMIF(SalesData[[Form]:[Form]], '\" + DSheet.Name + \"'RC13,SalesData[[#All],[\" + Value1 + \"]])\"\nNext\n</code></pre>\n\n<p>I am currently getting a Run-Time error 1004:</p>\n\n<pre><code>Select method of Range class failed\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 2, "creation_date": 1564521019, "post_id": 57279988, "comment_id": 101056466, "body": "Take a look at the following question: <a href=\"https://stackoverflow.com/q/50473365/8597922\">stackoverflow.com/q/50473365/8597922</a>."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1564634578, "post_id": 57279988, "comment_id": 101097076, "body": "@Victor K how would that approach work for User Forms or code held at the Sheet Module Level? How would it trigger macros that are called from shapes?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1564665754, "post_id": 57279988, "comment_id": 101112321, "body": "You can definitely include user forms in an add-in. Worksheet events can be handled as well but it might depend on you particular situation."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1564671873, "post_id": 57279988, "comment_id": 101116151, "body": "@Victor K for clarification purposes, would I then call the VBA code by using <code>Application.Run(ModuleName.SubName)</code> and reference everything to the <code>ActiveWorkBook</code>?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1564672754, "post_id": 57279988, "comment_id": 101116630, "body": "Depend entirely on organization of code. You can have an .xlsm that has an add-in as a refence. Than you can use <code>ModuleName.SubName</code> or even <code>SubName</code>. Or you can open an add-in every time and have it reference <code>ActiveWorkbook</code>, or, conversely, have workbook use <code>Application.Run</code>."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1564688338, "post_id": 57279988, "comment_id": 101123659, "body": "@VictorK i think i am understanding a bit better. I&#39;m going to update my question with some scenarios. Could you post an answer to those scenarios so I may mark it as the answer, I would like for you to get credit for your input."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1564701360, "post_id": 57279988, "comment_id": 101127418, "body": "@VictorK I have added 3 different scenarios, I hope my edits make sense"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1564707823, "post_id": 57279988, "comment_id": 101128556, "body": "I will look into the scenarios that you provided and I will try to give an answer tomorrow."}], "answers": [{"tags": [], "owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1565188426, "last_edit_date": 1592644375, "creation_date": 1565188426, "answer_id": 57396829, "question_id": 57279988, "link": "https://stackoverflow.com/questions/57279988/can-excel-vba-code-be-updated-via-an-excel-add-in-for-multiple-users/57396829#57396829", "title": "Can Excel Vba code be updated via an Excel Add In for multiple users", "body": "<p>One thing to know about any <code>Userform</code> is that it is just like any other class but with a UI element to it. That means that it follows a very similar set of rules to classes. If you look at the properties of a <code>Class Module</code> you will see a property called <code>Instancing</code>. VBA allows for two options: <code>Private</code> and <code>PublicNotCreatable</code>.<br />\nIf you select <code>PublicNotCreatable</code> than you can use a class, but you cannot instantiate it outside of its project. Similar to your <strong>Scenario 1</strong>:</p>\n<pre><code>'in Project A:\nDim Cls as ProjectB.TestClass\nSet Cls = New ProjectB.TestClass\n</code></pre>\n<p>I believe this will give you a compile error. This behavior is documented <a href=\"https://docs.microsoft.com/en-us/office/troubleshoot/office-developer/set-up-vb-project-using-class\" rel=\"nofollow noreferrer\">here along with a proposed solution</a>, which I use myself, although it somehow a little 'hacky'. But it works and that's what Microsoft tells VBA programmers to do. This is similar to your Scenario 2:</p>\n<pre><code>'in ProjectB:\nPublic Function NewTestClass() as TestClass\n     Set NewTestClass = New TestClass\nEnd Function\n'in ProjectA:\nPublic Sub InstantiateTestClass()\n    Dim Cls as ProjectB.TestClass \n   'as long as there are no other classes with the same name in your references \n   'you can drop &quot;ProjectB.&quot; prefix\n    Set Cls = NewTestClass\nEnd Sub\n</code></pre>\n<p>Note how I use <code>NewTestClass</code>, which is a function that returns an instance of a <code>TestClass</code> and it almost the same as usual instancing of <code>Set xxx = New TestClass</code>. So basically you need a function inside of the project that will return you an instance of the class in that same project to any outside project.<br />\nGiven that every <code>UserForm</code> comes with one free instance your <strong>Scenario 2</strong> works. You can rewrite it like this:</p>\n<pre><code>'in ProjectB:\nPublic Function NewUserForm() as UserForm1\n    Set NewUserForm = New UserForm1\nEnd Function\n'in ProjectA:\nPublic Sub ShowUserForm()\n    Dim View as ProjectB.UserForm1\n    Set View = ProjectB.NewUserForm\n    View.Show\nEnd Sub\n</code></pre>\n<p>Now I would suggest to change that approach with <code>UserForm1.Show</code> as <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">as explained here</a>. I use a similar approach as advocated in that blog, which works great, but might take you down a rabbit hole of learning and writing things you didn't know you need in your code. Definitely made it easier to maintain code in my experience. You can take a look at some questions about the topic, <a href=\"https://stackoverflow.com/q/47288496/8597922\">like this one</a>.</p>\n<p>In <strong>Scenario 3</strong> it appears to me that yes, you would need to reference an <code>ActiveWorkbook</code> the way it is written now. But I would strongly advocate to create a class, that will take a <code>Workbook</code> or a <code>Worksheet</code>(or a <code>Shape</code> or data or another class (preferably with an interface) or whatever it actually need to do its work) as an argument and take responsibility out of <code>Button_Click</code> event:</p>\n<p>in ProjectB:</p>\n<pre><code>Public Function NewWorksheetManipulator() as WorksheetManipulator\n    Set NewWorksheetManipulator= New WorksheetManipulator\nEnd Function\n</code></pre>\n<p>Class WorkSheetManipulator:</p>\n<pre><code>Private ClientSheet as Worksheet\nPrivate ManipulatedSheet as Worksheet\nPublic Property Set SheetClients(byval Value as WorkSheet)\n    Set ClientSheet = Value\nEnd Property\nPublic Property Set SheetToManipulate (byval Value as WorkSheet)\n    Set ManipulatedSheet = Value\nEnd Property\nPublic Sub DoStuff()\nIf ManipulatedSheet.FilterMode Then\n    ManipulatedSheet.ShowAllData\n    With ClientSheet.Shapes(&quot;priorities&quot;)\n        .Fill.ForeColor.RGB = RGB(64, 64, 64)\n    End With\nEnd If\n'etc...\nEnd Sub\n</code></pre>\n<p>in ProjectA:</p>\n<pre><code>Public Sub Private Sub CommandButton1_Click()()\n    Dim Manipulator as WorkSheetManipulator\n    Set Manipulator = WorkSheetManipulator\n    Set Manipulator.SheetClients = ActiveWorkbook.Sheets(&quot;clientmenu&quot;)\n    Set Manipulator.SheetToManipulate = ActiveSheet\n    Manipulator.DoStuff\nEnd Sub\n</code></pre>\n<p>Now, I did not test this code, but in concept this is how you can make a more modular, portable and organized code. Please note that there are many things you can do better than in my example: <code>Option Explicit</code>, private field to back variables in classes, better names, etc.</p>\n"}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 57396829, "answer_count": 1, "score": 1, "last_activity_date": 1565188426, "creation_date": 1564520569, "last_edit_date": 1564701329, "question_id": 57279988, "link": "https://stackoverflow.com/questions/57279988/can-excel-vba-code-be-updated-via-an-excel-add-in-for-multiple-users", "title": "Can Excel Vba code be updated via an Excel Add In for multiple users", "body": "<p>I have an Excel workbook that contains lots of VBA code. The VBA Code consists of many Sub routines, Functions and User Forms. Over 200+ employees will be using this Workbook.</p>\n\n<p>Currently my VBA code lives inside the distributed Excel Workbook. The problem I fear I will be faced with is updating each Workbooks VBA code if any update is ever needed.</p>\n\n<p>Would it be best to write all my VBA code as part of an Add In, upload a new version of the Add In to a site and have employees download from there? If so, would I encounter any limitations or restrictions? Is such feature even possible? Is VB.Net a better solution?</p>\n\n<p>I have created an XLAM file from my original Workbook File. The original Workbook file containa all my Sub Routines, Functions, and UserForms. I am encountering an error when calling the UserForm directly, even though I referenced the XLAM file that contains UserForm1.  </p>\n\n<p>The following scenarios are being ran from the distributed WorkBook copy. The WorkBook is referencing the XLAM file. </p>\n\n<p><strong>Scenario1: Calling a UserForm from a Sub assigned to a shape</strong>\nThe following Sub returns a <code>Runtime Error 424 Object Required</code></p>\n\n<pre><code>Sub RectangleRoundedCorners1_Click()\nUserForm1.Show 'highlights this line on the error, XLAM reference houses UserForm1\nEnd Sub\n</code></pre>\n\n<p><strong>Scenario2: Calling a Sub Procedure from a shape that calls the UserForm</strong> \nThis method doesn't return an error, why? Can we not reference UserForm Objects from a referenced Add In? </p>\n\n<pre><code>Sub RectangleRoundedCorners1_Click()\nshowUserForm\nEnd Sub\n\nSub showUserForm()\nUserForm1.Show\nEnd Sub\n</code></pre>\n\n<p><strong>Scenario 3: Using UserForms to input values into Worksheet Cells</strong></p>\n\n<p><em>Would I have to refrence the <code>ActiveWorkbook</code> in each of my UserForms?</em></p>\n\n<pre><code>Private Sub CommandButton1_Click()\nSet wb = ActiveWorkbook\nSet ws = wb.Sheets(\"clientmenu\")\n    forceLogOut\n    'clear filter so that we dont mix new customers up\n\n    If ActiveSheet.FilterMode Then\n        ActiveSheet.ShowAllData\n        With ws.Shapes(\"priorities\")\n            .Fill.ForeColor.RGB = RGB(64, 64, 64)\n        End With\n    End If\n\n\n    If contact.value &lt;&gt; \"\" And result.value = vbNullString Then\n        MsgBox \"Please enter a result\"\n        result.BorderColor = vbRed\n        result.BackColor = vbYellow\n        result.DropDown\n        Exit Sub\n\n    ElseIf contact.value = vbNullString And result.value &lt;&gt; \"\" Then\n        MsgBox \"Please enter a date\"\n        contact.BorderColor = vbRed\n        contact.BackColor = vbYellow\n        Exit Sub\n\n    Else: With ws\n            callDate\n            callResult\n        End With\n    End If\n\n\n\n\n    With ws\n        lastrow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n        If Me.priority_ = vbNullString Then\n            ws.Range(\"A\" &amp; lastrow).Interior.Color = vbWhite\n            ws.Range(\"A\" &amp; lastrow).Font.Color = RGB(0, 0, 0)\n\n        ElseIf Me.priority_ = \"None\" Then\n            ws.Range(\"A\" &amp; lastrow).Interior.Color = vbWhite\n            ws.Range(\"A\" &amp; lastrow).Font.Color = RGB(0, 0, 0)\n            ws.Range(\"B\" &amp; lastrow).value = vbNullString\n\n        ElseIf Me.priority_ = \"High\" Then\n            '.Cells(x, 1).Interior.Color = RGB(0, 176, 80)\n            ws.Range(\"A\" &amp; lastrow).Font.Color = RGB(0, 176, 80)\n            ws.Range(\"B\" &amp; lastrow).value = addnewClient.priority_.Text\n        ElseIf Me.priority_ = \"Medium\" Then\n            '.Cells(x, 1).Interior.Color = RGB(255, 207, 55)\n            ws.Range(\"A\" &amp; lastrow).Font.Color = RGB(255, 207, 55)\n            ws.Range(\"B\" &amp; lastrow).value = addnewClient.priority_.Text\n        ElseIf Me.priority_ = \"Low\" Then\n            '.Cells(x, 1).Interior.Color = RGB(241, 59, 59)\n            ws.Range(\"A\" &amp; lastrow).Font.Color = RGB(241, 59, 59)\n            ws.Range(\"B\" &amp; lastrow).value = addnewClient.priority_.Text\n        End If\n\nIf Me.client = vbNullString Then\nMsgBox \"Must enter Clients name in order to proceed\"\nExit Sub\nElseIf Me.client &lt;&gt; vbNullString Then\n\nws.Range(\"L\" &amp; lastrow).value = Format(Now(), \"mm/dd/yyyy\")\n\n        ws.Range(\"A\" &amp; lastrow).value = addnewClient.client.Text\n        ws.Range(\"A\" &amp; lastrow).Font.Name = \"Arial\"\n        ws.Range(\"A\" &amp; lastrow).Font.Size = 18\n        ws.Range(\"A\" &amp; lastrow).Font.Bold = True\n\n\n\n        ws.Range(\"B\" &amp; lastrow).Font.Name = \"Arial\"\n        ws.Range(\"B\" &amp; lastrow).Font.Size = 14\n        ws.Range(\"B\" &amp; lastrow).HorizontalAlignment = xlCenter\n\n        ws.Range(\"C\" &amp; lastrow).value = addnewClient.priority.Text\n\n        ws.Range(\"C\" &amp; lastrow).Font.Name = \"Arial\"\n        ws.Range(\"C\" &amp; lastrow).Font.Size = 14\n        ws.Range(\"C\" &amp; lastrow).HorizontalAlignment = xlCenter\n\n        ws.Range(\"E\" &amp; lastrow).value = addnewClient.contact.value\n        ws.Range(\"E\" &amp; lastrow).Font.Name = \"Arial\"\n        ws.Range(\"E\" &amp; lastrow).Font.Size = 14\n        ws.Range(\"E\" &amp; lastrow).HorizontalAlignment = xlCenter\n\n\n        ws.Range(\"G\" &amp; lastrow).value = addnewClient.result.Text\n        ws.Range(\"G\" &amp; lastrow).Font.Name = \"Arial\"\n        ws.Range(\"G\" &amp; lastrow).Font.Size = 14\n        ws.Range(\"G\" &amp; lastrow).HorizontalAlignment = xlCenter\n\n\n        ws.Range(\"I\" &amp; lastrow).value = addnewClient.segmentType.Text\n        ws.Range(\"I\" &amp; lastrow).Font.Name = \"Arial\"\n        ws.Range(\"I\" &amp; lastrow).Font.Size = 14\n        ws.Range(\"I\" &amp; lastrow).HorizontalAlignment = xlCenter\n\n        ws.Range(\"K\" &amp; lastrow).value = addnewClient.notes.Text\n\n        If Me.contact = vbNullString Then\n        ElseIf Me.contact &lt;&gt; vbNullString Then\n            ws.Range(\"J\" &amp; lastrow) = Sheet3.Range(\"J\" &amp; lastrow).value + 1\n            ws.Range(\"J\" &amp; lastrow).Font.Name = \"Arial\"\n            ws.Range(\"J\" &amp; lastrow).Font.Size = 14\n            ws.Range(\"J\" &amp; lastrow).Font.Bold = True\n            ws.Range(\"J\" &amp; lastrow).HorizontalAlignment = xlCenter\n\n        End If\n        End If\n\n    End With\n\n\n\n    'With Sheet3\n    'Sheet3.Range(\"A\" &amp; lastrow &amp; \":K\" &amp; lastrow).Interior.Color = vbWhite\n    Application.GoTo Range(\"A\" &amp; lastrow), True\n    'End With\n\n    wb.Sheets(2).Range(\"C4\") = Format(Now, \"mm/dd/yyyy\")\n    Unload Me\n\nEnd Sub\n</code></pre>\n"}]