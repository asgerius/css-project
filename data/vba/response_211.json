[{"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548290479, "post_id": 54337027, "comment_id": 95492594, "body": "Welcome! There is a <code>Reports</code> collection that you can use in code to enumerate open reports. For a report to show up in the Project Explorer view in the VBA IDE, the report must have a class module bound to it. Check the <code>Has Module</code> property of the report. Code goes into event properties of the report, its sections and controls. Check the <code>Events</code> tab of the <code>Property Sheet</code> when the report is in design view."}, {"owner": {"reputation": 1, "user_id": 9230525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a995a7ffe247254299f38903785da960?s=128&d=identicon&r=PG&f=1", "display_name": "BillR", "link": "https://stackoverflow.com/users/9230525/billr"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548382165, "post_id": 54337027, "comment_id": 95530795, "body": "thanks. I&#39;ve inherited a report that uses a large denormalized data set with parents children and grandchildren, and in the parents band they want to put a listbox with the children. I need to see how access handles all that."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548445790, "post_id": 54337027, "comment_id": 95558234, "body": "You can&#39;t put child reports in a listbox, but you can add a subgroup in the parent band to contain your sub-reports."}], "answers": [{"comments": [{"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548445877, "post_id": 54356905, "comment_id": 95558267, "body": "Note that OpenArgs is available anywhere in the report&#39;s code, not just in the Open event."}, {"owner": {"reputation": 21, "user_id": 9421631, "user_type": "registered", "profile_image": "https://graph.facebook.com/737373599794263/picture?type=large", "display_name": "Matthew Harris", "link": "https://stackoverflow.com/users/9421631/matthew-harris"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1548474552, "post_id": 54356905, "comment_id": 95565232, "body": "I did not intend to imply that the value of OpenArgs was not available outside of the On_Open event-handler."}], "tags": [], "owner": {"reputation": 21, "user_id": 9421631, "user_type": "registered", "profile_image": "https://graph.facebook.com/737373599794263/picture?type=large", "display_name": "Matthew Harris", "link": "https://stackoverflow.com/users/9421631/matthew-harris"}, "is_accepted": false, "score": 0, "last_activity_date": 1548474454, "last_edit_date": 1548474454, "creation_date": 1548372529, "answer_id": 54356905, "question_id": 54337027, "link": "https://stackoverflow.com/questions/54337027/where-do-i-put-code-to-modify-a-control-in-an-access-report/54356905#54356905", "title": "Where do I put code to modify a control in an Access report?", "body": "<p>Follow these steps:</p>\n\n<ol>\n<li>Open the report in design view</li>\n<li>right click the upper left corner of the report</li>\n<li>Select \"build event\" from the popup menu. </li>\n<li>Choose \"Code Builder\" in the dialog that appears after choosing \"build event\"</li>\n<li>Access will create a module for the form, and create an empty procedure declaration for the On_Open event. write whatever code you need to modify controls, labels, and so on in the On_Open event.</li>\n</ol>\n\n<p>NOTE: My answer assumes that all the information you need to modify the report is known at the time you open the report. I personally use the OpenArgs argument of the OpenReport method to pass information into the On_Open method. If the On_Open event doesn't meet your needs, check the drop-down list in the VBA editor to see what other events are available in the report. Other events include On_Load, LostFocus, and several more. </p>\n\n<p>I hope this answer helps you!</p>\n"}], "owner": {"reputation": 1, "user_id": 9230525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a995a7ffe247254299f38903785da960?s=128&d=identicon&r=PG&f=1", "display_name": "BillR", "link": "https://stackoverflow.com/users/9230525/billr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594619868, "creation_date": 1548284525, "last_edit_date": 1594619868, "question_id": 54337027, "link": "https://stackoverflow.com/questions/54337027/where-do-i-put-code-to-modify-a-control-in-an-access-report", "title": "Where do I put code to modify a control in an Access report?", "body": "<p>I've written VBA code in Excel, but now I have to modify listbox in an Access report and I don't know where the code goes. Sorry so stupid. Is there an event like On_Report_Run or something? There must be a Reports collection somewhere, but I don't see any objects in the object explorer that have a name like the report. Does the code go in a module?  Any help would be appreciated.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1548283622, "post_id": 54336784, "comment_id": 95490917, "body": "I&#39;d recommend pasting your code into the body of your question - easier for us to help and thus more likely you&#39;ll get a response"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1548284396, "post_id": 54336784, "comment_id": 95491174, "body": "Thank you RGA I went ahead and posted my code. Thank you"}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548284630, "post_id": 54336784, "comment_id": 95491237, "body": "Matteo NNZ has a very good answer. You&#39;ll want to be reasonably familiar with HTML coding (and CSS really).  You need to find something unique that identifies the data you are pulling, then you can pull it in."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548286512, "post_id": 54336784, "comment_id": 95491787, "body": "please don&#39;t post pictures of code. Use the snippet tool available via <a href=\"https://stackoverflow.com/posts/54336784/edit\">edit</a> to insert relevant html."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548286770, "post_id": 54336784, "comment_id": 95491832, "body": "It would help if you can verify if the classnames and ids of the relevant items are dynamic or static i.e. do they change over time/with different report selections? They look like they could be dynamic. I can think of at least one sensible and flexible approach to this if you can share the html for the whole report page using <a href=\"https://pastebin.com/\" rel=\"nofollow noreferrer\">pastebin.com</a>"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548286953, "post_id": 54336784, "comment_id": 95491880, "body": "@QHarr I posted my excel code already or are you referring to the code from the website? Sorry learning as I go along this was my first post. YES the class and IDs are dynamic"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548287118, "post_id": 54336784, "comment_id": 95491917, "body": "code from the website i.e. the html. The snippet tool icon looks like a document with  &lt;&gt; angle brackets on. You paste html in the top left square. Can you also confirm if the number of rows in the table(s) remain constant."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548287450, "post_id": 54336784, "comment_id": 95491981, "body": "@Qharr I believe the number of rows do not remain constant as sometimes we have different sales and the report can sometimes between 2 to 4 pages long. Trying to figure out the snippet tool real quick as soon as I figure out I will try to post it."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548287617, "post_id": 54336784, "comment_id": 95492015, "body": "@QHarr how can I copy all the html from the website to there?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548287809, "post_id": 54336784, "comment_id": 95492054, "body": "The answer given is good though I would load set the ie.document to an htmldocument variable and pass that to the function (just a personal preference). If you select the opening html tag at the top of the document &lt;html&gt; and right click it &gt; copy element &gt; that should copy all the html."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548290208, "post_id": 54336784, "comment_id": 95492541, "body": "@QHarr I got some of the snippet in there please let me know if that helps"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548353797, "post_id": 54336784, "comment_id": 95521247, "body": "@QHarr can you please check the code? Thank you"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548359378, "post_id": 54336784, "comment_id": 95523730, "body": "I looked but it is only part. I would like to see the entire html via pastebin.com"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548374358, "post_id": 54336784, "comment_id": 95529139, "body": "@QHarr <a href=\"https://pastebin.com/p9m5tMMw\" rel=\"nofollow noreferrer\">pastebin.com/p9m5tMMw</a> finally lol"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548468028, "post_id": 54336784, "comment_id": 95564434, "body": "@QHarr can you please check the code, I posted it on pastebin"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548284777, "post_id": 54337000, "comment_id": 95491287, "body": "how can I get it to enter the data into my sheet 1 cell A17? And do I need to post that code for every label I need? I am sorry I am a total noob on this stuff just trying to understand it correctly. Can you write the actual code to generate the net sales and value or is the above what I need to write in?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548284961, "post_id": 54337000, "comment_id": 95491335, "body": "@MohamadBallout, I can&#39;t code something working without having real access to the code. All I can do is look at the HTML structure you posted and try my guess. In my answer you already have what you need, if you write <code>Range(&quot;B1&quot;) = getValueByLabel(IE, &quot;NET SALES&quot;)</code> in your macro you&#39;ll get the value of NET SALES in cell B1, if you write <code>Range(&quot;B2&quot;) = getValueByLabel(IE, &quot;GROSS SALES&quot;)</code> you&#39;ll have the value of GROSS SALES in <code>B2</code>, etc."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548285486, "post_id": 54337000, "comment_id": 95491494, "body": "Matteo, I understand. I copied that same code in but is not returning any value"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548285650, "post_id": 54337000, "comment_id": 95491550, "body": "do you do any private coding? via team view or something? @Matteo NNZ"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548285690, "post_id": 54337000, "comment_id": 95491564, "body": "@MohamadBallout, as I was saying, you can&#39;t expect to copy/paste it and make it work. Set a breakpoint at the beginning of the function, then move step by step (F8) and check what object you&#39;re reading. The logic is that one, but the elements you access depend on the actual DOM of your HTML page that I only see in a picture."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548285777, "post_id": 54337000, "comment_id": 95491589, "body": "@MohamadBallout no, this site is not for free-lancing but just free knowledge sharing. I unfortunately don&#39;t do that, but I highly suggest you to spare some money by simply following the breakpoint suggestion I gave you above."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548286098, "post_id": 54337000, "comment_id": 95491662, "body": "Sorry was not trying to get free lancing. I am going to try to insert a breakpoint looking up how to do that right now. Thank you again for your help I appreciate it."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548286326, "post_id": 54337000, "comment_id": 95491736, "body": "@MohamadBallout have a look at <a href=\"https://www.techonthenet.com/excel/macros/vba_debug2013.php\" rel=\"nofollow noreferrer\">this page</a>. If you&#39;re learning to code, learning how to debug is vital. Coding without debugging is like driving with a blindfold. Good study :)"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548286460, "post_id": 54337000, "comment_id": 95491769, "body": "thank you for the link and your help, I will make sure to read that."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1548314930, "post_id": 54337000, "comment_id": 95498661, "body": "@QHarr you\u2019re right, I\u2019ve fixed the issue. MohamadBallout, you might want to check the code after edit proposed."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548353859, "post_id": 54337000, "comment_id": 95521273, "body": "I tried your code with adjusting minor things but I am not generating any data into the cells. Can you check the html I posted ?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548360194, "post_id": 54337000, "comment_id": 95524061, "body": "@MohamadBallout the HTML you posted is not much different than what you posted yesterday, I would need the website. Did you try debugging as I was telling you yesterday? This is really what you should be doing to fix this kind of issue. The code is structured properly, but you will have to run it step by step and checking each variable you define to figure out where the concrete issue is."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548374418, "post_id": 54337000, "comment_id": 95529158, "body": "<a href=\"https://pastebin.com/p9m5tMMw\" rel=\"nofollow noreferrer\">pastebin.com/p9m5tMMw</a>  here it is sorry took me a while was trying to figure it out."}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548374672, "post_id": 54337000, "comment_id": 95529231, "body": "The report that gets generated sometimes has two or three pages, and you have to click to go to the next page. It is dynamic"}, {"owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "edited": false, "score": 0, "creation_date": 1548700934, "post_id": 54337000, "comment_id": 95627459, "body": "I am still stuck guys if somebody can take a look at the pastebin html link I posted I would appreciate it."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 2, "last_activity_date": 1548314815, "last_edit_date": 1548314815, "creation_date": 1548284384, "answer_id": 54337000, "question_id": 54336784, "link": "https://stackoverflow.com/questions/54336784/excel-vba-coding-to-scrap-data-i-am-stuck/54337000#54337000", "title": "Excel VBA Coding to scrap data, I am stuck", "body": "<p>I would approach it with a function which takes in input two parameters:</p>\n\n<ul>\n<li>The Internet Explorer instance</li>\n<li>The label you want to scrape (e.g. <code>NET SALES</code>)</li>\n</ul>\n\n<p>... and returns as <code>String</code> the desired value. \nUnfortunately I can't help much without having the real HTML and being able to test, so this is my <strong>blind</strong> attempt (get inspired, but don't expect to copy/paste and that the code will work):</p>\n\n<pre><code>Private Function getValueByLabel(ByVal ie As SHDocVw.InternetExplorer, ByVal label As String) As String\n    Dim listOfRows As Object: Set listOfRows = ie.document.getElementsByTagName(\"tr\")\n    Dim cellsInsideARow As Object \n    For Each tRow In listOfRows\n        Set cellsInsideARow = tRow.getElementsByTagName(\"td\")\n        If cellsInsideARow(2).getElementsByTagName(\"div\")(1).innerText = label Then\n            getValueByLabel = cellsInsideARow(3).getElementsByTagName(\"div\")(1).innerText\n            Exit Function\n        End If\n    Next tRow\n    getValueByLabel = \"N/A\"\nEnd Function\n</code></pre>\n\n<p>Basically the function above is:</p>\n\n<ul>\n<li>Getting the list of <code>tr</code> (rows) loaded into the <code>document.body</code> of the <code>InternetExplorer</code> instance you passed through</li>\n<li>For each of them, checking if the <code>.innerText</code> of the 3rd <code>td</code> (cell) element is equal to the <code>label</code> you want to scrape (in your case <code>NET SALES</code>)</li>\n<li>If it's the case, returns the function with the <code>.innerText</code> of the 4th <code>td</code> element</li>\n<li>Else, returns <code>N/A</code></li>\n</ul>\n\n<p>You would use the function by just calling it with the good parameters from your macro, for example: </p>\n\n<pre><code>Range(\"A1\") = \"NET SALES\"\nRange(\"B1\") = getValueByLabel(IE, Range(\"A1\").Value)\n</code></pre>\n\n<p>P.s. the reason why I did a function is that you can re-use the same code for any element being into the same table, by just passing the wished label (<code>NET SALES</code> rather than <code>GROSS SALES</code> etc.)</p>\n"}], "owner": {"reputation": 37, "user_id": 10958370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991cc262bbf248849cd4c0784cc99ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Ballout", "link": "https://stackoverflow.com/users/10958370/mohamad-ballout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548715409, "creation_date": 1548283161, "last_edit_date": 1548715409, "question_id": 54336784, "link": "https://stackoverflow.com/questions/54336784/excel-vba-coding-to-scrap-data-i-am-stuck", "title": "Excel VBA Coding to scrap data, I am stuck", "body": "<p>First of all I would like to thank this community for the amazing website. I am completely new to the coding world and excel vba. After learning about the possibilities in excel I started my journey to automate our daily data entry that we do here at our business. I have been able over the past few weeks to put some codes together that can access a secured website and generate the report I need based on the date I enter. However now I am stuck in how to actually pull the table values into excel. I have attached a few pictures. Right now the the third and fourth \n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548281920, "post_id": 54336533, "comment_id": 95490351, "body": "<i>&quot;There are blanks in between the rows so using the code .End(xl)Up doesn&#39;t work unless you&#39;re able to target the entire column regardless of the blanks in between the rows somehow.&quot;</i> - Incorrect. <code>.End(xlUp)</code> will find the last cell in the entire column that has data in it. It&#39;s <code>.End(xlDown)</code> that will be halted by blanks in a column."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548282028, "post_id": 54336533, "comment_id": 95490394, "body": "The second code snippet you posted should work - can you show us your sample data? Did you change column B to column D to adjust it for your needs?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548282323, "post_id": 54336533, "comment_id": 95490508, "body": "@dwirony Wouldn&#39;t &#39;.End(xl)Up&#39; be halted when it comes across the first blank since it will think that&#39;s where the data is started?  Or would it select last cell with data and select up to row 1?  Sorry, yes I did change the column from B to D...forgot to change it and will edit the OP now.  How do I post the sample data to show you?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548282481, "post_id": 54336533, "comment_id": 95490560, "body": "It&#39;s <code>.End(xlUp)</code> and it starts from row 1048576 and looks upward to the first cell with data in it, then that becomes your value :). If you can maybe make a small example (like 10 or 20 rows), screenshot a before and after, you can edit your question and add an image. You don&#39;t have the rep to embed it yet, but I can do that for you."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 1, "creation_date": 1548282872, "post_id": 54336533, "comment_id": 95490687, "body": "Note that deleting and entire row with VBA using <code>EntireRow.Delete</code> is for some reason very memory intensive and takes forever with large datasets!"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548284505, "post_id": 54336533, "comment_id": 95491209, "body": "@dwirony I have added an image to the OP.  In that image for example, &quot;delete&quot; is in Column D and I would like the code to run through column D and remove the entire row for the duplicates...in this case the cells that say &quot;delete&quot;. However row 2293:2295 also happen to be blank before resuming with more data."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1548284923, "post_id": 54336533, "comment_id": 95491327, "body": "@MBB70 hmm..that is good to know since I didn&#39;t know that.  Do you think something with ~3000 rows across 18 columns would be large enough to cause the macro to run for minutes?"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1548285436, "post_id": 54336533, "comment_id": 95491481, "body": "@J Doe the speed reduction caused by deleting entire rows with VBA is almost always painfully noticeable."}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548284763, "post_id": 54336873, "comment_id": 95491281, "body": "Do you have formula errors in your data in column D? That&#39;s what it sounds like to me, I can make an update to handle and ignore those."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548284764, "post_id": 54336873, "comment_id": 95491282, "body": "Thank you for coming up with this.  I did a test run of the code and it seems to delete more than just the duplicates...it seems to have removed most of the outlines as well"}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548285136, "post_id": 54336873, "comment_id": 95491385, "body": "It deletes the entire row. Isn&#39;t that what you wanted?  What are the outlines?  If you need to only delete the duplicate <b>cells</b> then you can use <code>rngDelete.Rows.Delete</code>"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548285776, "post_id": 54336873, "comment_id": 95491588, "body": "It does delete the entire row however it is also deleting rows that do not have a duplicate existing in column D as well.  I can take a snippet of the outlines and include it in the OP since I&#39;m not sure how to add an image to a comment."}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548286038, "post_id": 54336873, "comment_id": 95491648, "body": "Yes, that would be useful.  I did update the code to ignore blanks, too. That way rows with a blank in column D aren&#39;t deleted."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548286247, "post_id": 54336873, "comment_id": 95491703, "body": "I have updated the OP with an image of the outlines.  The outlines are the expanders to the left shaped like [+]"}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548286487, "post_id": 54336873, "comment_id": 95491778, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187210/discussion-between-hmvba-and-j-doe\">continue this discussion in chat</a>."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548287011, "post_id": 54336873, "comment_id": 95491891, "body": "HMVBA helped me figure the solution to this in chat for anyone reading this in the future.  I had to expand my outline first then the code ran perfect"}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548287212, "post_id": 54336873, "comment_id": 95491942, "body": "Glad we figured it out. Just check out my change to modify the starting row. Otherwise, the wrong rows will get deleted!"}], "tags": [], "owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "is_accepted": true, "score": 2, "last_activity_date": 1548287153, "last_edit_date": 1548287153, "creation_date": 1548283701, "answer_id": 54336873, "question_id": 54336533, "link": "https://stackoverflow.com/questions/54336533/delete-duplicate-rows-keep-last-and-delete-first/54336873#54336873", "title": "Delete Duplicate Rows, Keep Last and Delete First", "body": "<p><strong>Edit: Now ignores blanks</strong></p>\n\n<p>Edit: Modified to have the ability to change the starting row</p>\n\n<p>What you might want to do is pull the data into an array and search the array for duplicates.  Excel can process arrays <strong>much</strong> faster than it can go through each cell.  </p>\n\n<p>The following code does just that. It will leave D1 alone (such as in your example code) and will remove the entire row of any duplicates, only leaving the last item.</p>\n\n<p>To deal with deleting the rows, we add all of the duplicates into a range object named rngDelete and delete all the rows at once. This will make it run much faster than deleting one by one.</p>\n\n<pre><code>Sub Row_Dupe_Killer_Keep_Last()\n    Dim vData As Variant\n    Dim rngDelete As Range\n    Dim lrow As Long, lrowSearch As Long\n    Dim lStartRow as long\n\n    'Change this to the row you wish to start with (the top row)\n    lStartRow = 22\n\n    'Get all of the data from the cells into a variant array\n    'Normally I would prefer to use usedrange, but this method is fine\n    '(Note: Change the 2 to 1 if you want to include the entire column including Row number 1)\n    vData = Range(Cells(lStartRow, \"D\").Address &amp; \":\" &amp; Cells(Rows.Count, \"D\").End(xlUp).Address)\n\n    'Search for duplicates\n    'First, loop through backwards one by one\n    For lrow = UBound(vData) To LBound(vData) Step -1\n        'now loop through forwards (up to the point where we have already looked)\n        For lrowSearch = LBound(vData) To lrow\n            'Check if we have a duplicate\n            If Not IsError(vData(lrow, 1)) And Not IsError(vData(lrowSearch, 1)) Then\n                If lrow &lt;&gt; lrowSearch And vData(lrow, 1) = vData(lrowSearch, 1) And vData(lrow, 1) &lt;&gt; \"\" Then\n                    'We have a duplicate! Let's add it to our \"list to delete\"\n                    If rngDelete Is Nothing Then\n                        'if rngDelete isn't set yet...\n                        Set rngDelete = Range(\"D\" &amp; lrowSearch + lStartRow-1)\n                    Else\n                        'if we are adding to rngDelete...\n                        Set rngDelete = Union(rngDelete, Range(\"D\" &amp; lrowSearch + lStartRow-1))\n                    End If\n                End If\n            End If\n        Next lrowSearch\n    Next lrow\n\n    'Delete all of the duplicate rows\n    If Not rngDelete Is Nothing Then\n        rngDelete.EntireRow.Delete\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548286099, "post_id": 54337110, "comment_id": 95491663, "body": "Hmm this code seems to get close...  Is there a way to not delete any blanks?  It doesn&#39;t appear to delete any rows where Column D has duplicate numbers..  The numbers are formatted as General if that matters."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548287033, "post_id": 54337110, "comment_id": 95491894, "body": "I will edit the code and comment out the blank deletion."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548287092, "post_id": 54337110, "comment_id": 95491909, "body": "OK, it will not delete blanks now."}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 1, "last_activity_date": 1548287069, "last_edit_date": 1548287069, "creation_date": 1548284986, "answer_id": 54337110, "question_id": 54336533, "link": "https://stackoverflow.com/questions/54336533/delete-duplicate-rows-keep-last-and-delete-first/54337110#54337110", "title": "Delete Duplicate Rows, Keep Last and Delete First", "body": "<p>This should help you out.</p>\n\n<pre><code>    Option Explicit\n\n    Const c_intMaxBlanks As Integer = 5\n    Const c_AbsoluteMaxRowsInSheet As Integer = 5000\n\n    Public Sub RunIt()\n        Row_Dupe_Killer_Keep_Last ActiveSheet.Range(\"D:D\")\n    End Sub\n\n    Public Sub Row_Dupe_Killer_Keep_Last(rngCells As Range)\n\n        Dim iRow As Integer, iCol As Integer\n        Dim intBlankCnt As Integer\n        Dim intMaxBlanks As Integer\n        Dim blnIsDone As Boolean\n        Dim intSaveStartRow As Integer\n        Dim blnStartCnt As Boolean\n        Dim strTemp As String\n        Dim strCheck As String\n        Dim intI As Integer\n        Dim intJ As Integer\n        Dim intSaveEndRow As Integer\n\n\n        'First, Count the consecutive blanks\n        blnIsDone = False\n        blnStartCnt = False\n        intSaveStartRow = 0\n        intSaveEndRow = 0\n        intBlankCnt = 0\n        iRow = 1\n        iCol = rngCells.Column\n        Do While (Not blnIsDone)\n            'Check for blank Row using length of string\n            If (Len(Trim(rngCells.Cells(iRow, 1).Value)) &lt; 1) Then  \n                If Not blnStartCnt Then\n                    intSaveStartRow = iRow\n                    blnStartCnt = True\n                Else\n                    If (intSaveStartRow + intBlankCnt) &lt;&gt; iRow Then\n                        'restart\n                        intSaveStartRow = iRow\n                        intBlankCnt = 0\n                    End If\n                End If\n                intBlankCnt = intBlankCnt + 1\n            Else\n                'restart\n                blnStartCnt = False\n                intBlankCnt = 0\n            End If\n\n            intSaveEndRow = iRow\n\n            If intBlankCnt &gt;= c_intMaxBlanks Then blnIsDone = True\n\n            'Stop Loop: Maybe Infinite\"\n            If iRow &gt; c_AbsoluteMaxRowsInSheet Then Exit Do\n            iRow = iRow + 1\n        Loop\n\n        'Now, loop through each row in the column and check values.\n        For intI = intSaveEndRow To 2 Step -1\n            strTemp = LCase(Trim(rngCells.Cells(intI, 1).Value))\n            For intJ = intSaveEndRow To 2 Step -1\n                If intJ &lt;&gt; intI Then\n                    strCheck = LCase(Trim(rngCells.Cells(intJ, 1).Value))\n                    If strTemp = strCheck Then\n                        'Found a dup, delete it\n                        rngCells.Cells(intJ, 1).EntireRow.Delete\n                    'ElseIf Len(strCheck) &lt; 1 Then\n                    '    'Delete the blank line\n                    '    rngCells.Cells(intJ, 1).EntireRow.Delete\n                    End If\n                End If\n            Next intJ\n        Next intI\n\n    End Sub\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1548285824, "post_id": 54337131, "comment_id": 95491604, "body": "I didn&#39;t realize you were just working with data in column D...you can just enter <code>myDuplicate = vbnullstring</code> in lieu of <code>Range(&quot;D&quot; &amp; myDuplicate.Row).ClearContents</code>"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1548286495, "post_id": 54337131, "comment_id": 95491781, "body": "This code actually seems to almost get there.  It looks like it is deleting the second duplicate instead of the first duplicate and seems to do something funky...like the in column D is being pasted over?"}], "tags": [], "owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "is_accepted": false, "score": 1, "last_activity_date": 1548342223, "last_edit_date": 1548342223, "creation_date": 1548285152, "answer_id": 54337131, "question_id": 54336533, "link": "https://stackoverflow.com/questions/54336533/delete-duplicate-rows-keep-last-and-delete-first/54337131#54337131", "title": "Delete Duplicate Rows, Keep Last and Delete First", "body": "<p>This method avoids the use of <code>EntireRow.Delete</code>, which is notoriously slow. The contents are cleared and the dataset is sorted to remove gaps.</p>\n\n<p>EDIT: switched to For Next to enable searching upwards from the bottom; also cleaned up sort routine generated by the macro recorder...I never seem to have that routine on-hand when I need it :).</p>\n\n<p>Note: this will also not work with an outline...whatever you did to make it work for the other answer will need to be done for this one as well.</p>\n\n<p>I am curious if the Clear/Sort approach works for you and if it speeds up your routine.</p>\n\n<pre><code>Option Explicit\nSub RemoveFirstDuplicate()\n    Dim myDataRange As Range, iCounter As Long, myDuplicate As Range, lastRow As Long\n    lastRow = Range(\"D1000000\").End(xlUp).Row\n    Set myDataRange = Sheets(\"Sheet1\").Range(\"D1:D\" &amp; lastRow)\n    'searching up to the second row (below the field name assumed to be in row 1)...you may need to adjust where the loop stops\n    For iCounter = myDataRange.Cells.Count To 2 Step -1\n        With myDataRange\n            If WorksheetFunction.CountIf(myDataRange, myDataRange.Item(iCounter)) &gt; 1 Then\n                Set myDuplicate = .Find(What:=myDataRange.Item(iCounter), After:=myDataRange.Item(iCounter), SearchDirection:=xlPrevious)\n                Range(\"D\" &amp; myDuplicate.Row).ClearContents\n            End If\n        End With\n    Next iCounter\n    With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=myDataRange.Offset(1, 0)\n        .SetRange myDataRange\n        .Header = xlYes\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 54336873, "answer_count": 3, "score": 1, "last_activity_date": 1548342223, "creation_date": 1548281746, "last_edit_date": 1548286218, "question_id": 54336533, "link": "https://stackoverflow.com/questions/54336533/delete-duplicate-rows-keep-last-and-delete-first", "title": "Delete Duplicate Rows, Keep Last and Delete First", "body": "<p><a href=\"https://i.stack.imgur.com/zlE36.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zlE36.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I'm trying to come up with code that look in Column D for any duplicate text then deletes the entire row that the first duplicate is located in.  There are blanks in between the rows so using the code <code>.End(xl)Up</code> doesn't work unless you're able to target the entire column regardless of the blanks in between \n the rows somehow. </p>\n\n<p>I've tried two methods so far but neither have worked to my expectation.</p>\n\n<p>This was my first method which doesn't work since the worksheet has an outline:</p>\n\n<pre><code>Sub test()\n\nActiveSheet.Range(\"D:D\").RemoveDuplicates Columns:=1, header:=xlNo\n\nEnd Sub\n</code></pre>\n\n<p>This was my second method that I got from another site that runs for minutes but doesn't appear to do what I'm trying to achieve.</p>\n\n<pre><code>Sub Row_Dupe_Killer_Keep_Last()\nDim lrow As Long\n\nFor lrow = Cells(Rows.Count, \"D\").End(xlUp).Row To 2 Step -1\n    If Cells(lrow, \"D\") = Cells(lrow, \"D\").Offset(-1, 0) Then\n       Cells(lrow, \"D\").Offset(-1, 0).EntireRow.Delete\n    End If\n\nNext lrow\nEnd Sub\n</code></pre>\n\n<p>Does anyone have any suggestions or tips?  I've been working at it for a few days now with my limited skills and haven't been able to figure a way to do it...Thank you in advance for your time.</p>\n"}, {"tags": ["vba", "csv", "http"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1548279557, "post_id": 54335998, "comment_id": 95489432, "body": "<code>API.responsetext</code> returns response as string.  then read this : <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a>"}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548279625, "post_id": 54335998, "comment_id": 95489463, "body": "It appears that the response is already in CSV format.  You could simple output the result to file in that case: <code>Open myFile For Output As #1 :     Print #1, API.responsetext :     Close #1</code>"}, {"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1548281103, "post_id": 54335998, "comment_id": 95490079, "body": "@cyboashu Thank you, I&#39;m aware of the ability to read the required values from a JSON format, however I&#39;m looking to access the data in CSV format."}, {"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "reply_to_user": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 1, "creation_date": 1548281324, "post_id": 54335998, "comment_id": 95490142, "body": "@HMVBA Perfect! I had tried this method but couldn&#39;t get it to behave - I was getting CSV files with all the data in a single cell. This method works perfectly. Thanks very much!"}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548281693, "post_id": 54335998, "comment_id": 95490278, "body": "@healey Sounds like you may have been using <code>Write</code> instead of <code>Print</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548282697, "post_id": 54335998, "comment_id": 95490624, "body": "you can also do a binary download as shown <a href=\"https://stackoverflow.com/a/54334813/6241235\">here</a>. You wouldn&#39;t need the tidy sub."}, {"owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548296918, "post_id": 54335998, "comment_id": 95493842, "body": "@QHarr Thanks for the suggestion! Does a binary download tend to be more efficient than writing it from text?"}], "owner": {"reputation": 314, "user_id": 10812919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y4hHw.jpg?s=128&g=1", "display_name": "healey", "link": "https://stackoverflow.com/users/10812919/healey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 756, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548279177, "creation_date": 1548279177, "question_id": 54335998, "link": "https://stackoverflow.com/questions/54335998/save-a-http-request-response-as-csv-in-vba", "title": "Save a HTTP request response as CSV in VBA", "body": "<p>I'm using the MSXML2.XMLHTTP method to connect to an API via VBA. My preferred response format is in a CSV, but I'm unsure of how to take the <code>API.responsetext</code> value and save it as a CSV locally.</p>\n\n<p>Even pasting to a new or existing sheet in the active workbook would be useful.   </p>\n\n<pre><code>Option Explicit\nSub getData()\n\nDim API As Object\n\n    Set API = CreateObject(\"MSXML2.XMLHTTP\")\n\n    API.Open \"GET\", \"https://factsetfundamentals.xignite.com/xFactSetFundamentals.csv/GetFinancialStatements?IdentifierType=Symbol&amp;Identifiers=CSCO&amp;StatementTypes=BalanceSheet,CashFlowStatement&amp;AsOfDate=1/22/2019&amp;ReportType=Annual&amp;ExcludeRestated=False&amp;_token=7C6B46D98F6B4B0C88FF5A5CE2C64C0C\", False\n    API.Send\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1548276672, "post_id": 54335243, "comment_id": 95488227, "body": "1. use <code>getElementsByTagName(&quot;div&quot;)</code> to get a collection of all divs. 2. Loop throught that collection and use <code>className</code> property to read the class name. 3. Use string functions or <code>LIKE</code> to match a pattern in the class name."}], "answers": [{"comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 403, "user_id": 3767975, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c550961b4b16e52946dbb1f95670dd2?s=128&d=identicon&r=PG&f=1", "display_name": "ti01878", "link": "https://stackoverflow.com/users/3767975/ti01878"}, "edited": false, "score": 0, "creation_date": 1548548519, "post_id": 54335621, "comment_id": 95580948, "body": "Heck...I didn&#39;t realize that you could query multiple class name till I read your post.  Thanks for accepting my answer."}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": true, "score": 1, "last_activity_date": 1548277444, "creation_date": 1548277444, "answer_id": 54335621, "question_id": 54335243, "link": "https://stackoverflow.com/questions/54335243/vba-scrape-html-get-element-with-dynamic-class/54335621#54335621", "title": "vba scrape html - get element with dynamic class", "body": "<p>You are using the first element that contains 3 classes</p>\n\n<ul>\n<li>redesignTravelHistory </li>\n<li>tank-thlist__date</li>\n<li>2019-01-16</li>\n</ul>\n\n<p>I'm guessing that the date class \"2019-01-16\" is irrelevant and can be removed.</p>\n\n<blockquote>\n<pre><code> Set wyjatek = ie.Document.getElementsByClassName(\"redesignTravelHistory tank-thlist__date\")(0)\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1548281857, "creation_date": 1548281857, "answer_id": 54336562, "question_id": 54335243, "link": "https://stackoverflow.com/questions/54335243/vba-scrape-html-get-element-with-dynamic-class/54336562#54336562", "title": "vba scrape html - get element with dynamic class", "body": "<p>You can use a css attribute = value selector with ^ operator (value starts with substring after the =)</p>\n\n<pre><code>ie.document.querySelector(\"div[class^='redesignTravelHistory tank-thlist__date']\")\n</code></pre>\n\n<p>If there can be more than one element matched with this then use querySelectorAll and index in to the nodeList to get the right element e.g. index 1</p>\n\n<pre><code>ie.document.querySelectorAll(\"div[class^='redesignTravelHistory tank-thlist__date']\").item(1)\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 3767975, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2c550961b4b16e52946dbb1f95670dd2?s=128&d=identicon&r=PG&f=1", "display_name": "ti01878", "link": "https://stackoverflow.com/users/3767975/ti01878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 54335621, "answer_count": 2, "score": 0, "last_activity_date": 1612351609, "creation_date": 1548275812, "last_edit_date": 1612351609, "question_id": 54335243, "link": "https://stackoverflow.com/questions/54335243/vba-scrape-html-get-element-with-dynamic-class", "title": "vba scrape html - get element with dynamic class", "body": "<p>using excel vba i need to scrape the date (2019-01-16).\nthis code works great:</p>\n<pre><code>Set wyjatek = ie.Document.getElementsByClassName(&quot;redesignTravelHistory tank-thlist__date 2019-01-16&quot;)(0)\n</code></pre>\n<p>but the problem is, that in every html I try to scrape, this date can be different.\nDo you know how to solve it?</p>\n<p>part of html:</p>\n<pre><code>&lt;div class=&quot;redesignTravelHistory tank-thlist__date 2019-01-16&quot;&gt;16/01/2019&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548279525, "post_id": 54335820, "comment_id": 95489425, "body": "This did not work: The data is on a separate sheet taking up two columns, with the name of the field in A and the email that the corresponding field should be sent to."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1548287622, "post_id": 54335820, "comment_id": 95492018, "body": "@IAmNerd2000 I&#39;ve never seen &quot;ActiveWorkbook.EnvelopeVisible&quot; before.  What is this?"}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548341429, "post_id": 54335820, "comment_id": 95513957, "body": "How do i attach the images?"}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548349166, "post_id": 54335820, "comment_id": 95518950, "body": "@IAmNerd2000 i cant add images can you send me your email and ill send you the attachments?"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 1, "creation_date": 1548353025, "post_id": 54335820, "comment_id": 95520906, "body": "@FrankBall The Envelope visible allows you to see the Excel mail envelope for sending email through excel."}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548772120, "post_id": 54335820, "comment_id": 95656429, "body": "@IAmNerd2000 have added the images, the first one is at the top the second at the bottom. I am trying to loop the code to filter through the pivot fields and send each one to the specific email on the other sheet."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548777552, "post_id": 54335820, "comment_id": 95660146, "body": "Sam, I am still having trouble understanding exactly what you want so, I made some assumptions and modified the code above.  I assumed you know the fields name and therefore use that to get the email address (assuming field is fund name).  Please be as descriptive as possible :)"}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548777895, "post_id": 54335820, "comment_id": 95660351, "body": "Okay, so I am working on automating this pivot table so that I can send each filter (fund) to a specific email recipient. The first screenshot shows what the pivot table looks like, and the second is the emails i want to send each fund to. I want to loop this code so that it goes through the fields on the pivot table and sends that specific section to the corresponding email on the separate VBA tab. Does that help? @IAmNerd2000"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548780681, "post_id": 54335820, "comment_id": 95662045, "body": "Yeah, but without the workbook I cannot test my code. Have a look at the updated code above. I think it may work. What I have done is loop through each field and, using the field name, I loop through the cells on the VBA Tab worksheet to see if the name and subject match. Then, send if they do."}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548782357, "post_id": 54335820, "comment_id": 95662938, "body": "The fld.currentpage= is not working properly as well as other parts of the code iis there any way I can somehow get this workbook to you to see what is going wrong? @IAmNerd2000"}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548784201, "post_id": 54335820, "comment_id": 95663821, "body": "@IAmNerd2000 Added my email to the about me section."}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548792945, "post_id": 54335820, "comment_id": 95667972, "body": "@IAmNerd2000 Can you check your email again, the code was rejected when i changed the example to the actual email on the VBA tab."}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548795742, "post_id": 54335820, "comment_id": 95669116, "body": "@IAmNerd2000 Is it possible to assign two emails to each fund filter?"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548797269, "post_id": 54335820, "comment_id": 95669771, "body": "I would just make another row on your vba tab sheet and give it the same name as fund filter but with different email. and repeat for all funds"}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548797719, "post_id": 54335820, "comment_id": 95669957, "body": "@IAmNerd2000 When I try to do this the code stops after the first email listed and does not continue onto the rows i just added. Wondering if there is something in the code that stops it after the first round of emails."}, {"owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "edited": false, "score": 0, "creation_date": 1548856447, "post_id": 54335820, "comment_id": 95693407, "body": "@IAmNerd2000 Thanks so much for all of your help!"}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 1, "last_activity_date": 1548799977, "last_edit_date": 1548799977, "creation_date": 1548278446, "answer_id": 54335820, "question_id": 54335097, "link": "https://stackoverflow.com/questions/54335097/i-am-having-trouble-looping-this-code-to-go-through-a-set-range-of-emails-and-na/54335820#54335820", "title": "I am having trouble looping this code to go through a set range of emails and names in order to send to an email depending on the pivot field", "body": "<p>You can try this:</p>\n\n<pre><code>    Sub EmailFund1()\n\n        Dim r As Range\n        Dim SItm As SlicerItem\n        Dim SItm2 As SlicerItem\n        Dim cel As Range\n        Dim strEmail As String\n        Dim strSubject As String\n        Dim intI As Integer\n        Dim intJ As Integer\n        Dim objRow As Range\n        Dim blnExit As Boolean\n\n        Set r = Worksheets(\"Fund Pivot\").Range(\"B1\")\n        r.Select\n\n        For Each objRow In Worksheets(\"VBA Tab\").Rows\n            blnExit = False\n\n            ActiveWorkbook.EnvelopeVisible = True\n\n            For Each SItm In ActiveWorkbook.SlicerCaches(\"Slicer_Fund_s\").SlicerItems\n\n\n                SItm.Selected = True\n                For Each SItm2 In ActiveWorkbook.SlicerCaches(\"Slicer_Fund_s\").SlicerItems\n                    If SItm.Name &lt;&gt; SItm2.Name Then\n                        SItm2.Selected = False\n                    End If\n                Next\n\n\n                strEmail = LCase(Trim(objRow.Cells(, 2).Value))\n                strSubject = UCase(Trim(objRow.Cells(, 1).Value))\n\n                If UCase(Trim(SItm.Name)) = strSubject Then\n\n                    With r.Parent.MailEnvelope.Item\n                        .to = strEmail\n                        .cc = \"\"\n                        .bcc = \"\"\n                        .Subject = strSubject\n\n                        .send\n\n                    End With\n\n                   'We have found the email, we can exit the for loop.\n                   Exit For\n               ElseIf Len(strSubject) &lt; 1 Then\n                   'Reached the end. exit loop\n                   blnExit = True\n               End If\n           Next\n\n           If blnExit Then Exit For\n        Next\n\n        Set r = Nothing\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10957816, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Y7eyIrcF934/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaMANpT3iDL_s0ZVZH533vqy8IW6A/mo/photo.jpg?sz=128", "display_name": "Sam Engel", "link": "https://stackoverflow.com/users/10957816/sam-engel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 54335820, "answer_count": 1, "score": 0, "last_activity_date": 1548799977, "creation_date": 1548275106, "last_edit_date": 1548772048, "question_id": 54335097, "link": "https://stackoverflow.com/questions/54335097/i-am-having-trouble-looping-this-code-to-go-through-a-set-range-of-emails-and-na", "title": "I am having trouble looping this code to go through a set range of emails and names in order to send to an email depending on the pivot field", "body": "<p><a href=\"https://i.stack.imgur.com/0y1OW.png\" rel=\"nofollow noreferrer\">enter image description here</a>I am trying to have this loop through a set of emails, where the \"Example\" refers to a specific email on another sheet and sends accordingly. Code is below, please let me know if you can help, thanks!</p>\n\n<pre><code>    Sub EmailFund1()\n\n        Dim r As Range\n        Set r = Selection\n\n        Range(\"B1\").Select\n        Sheet2.PivotTables(\"PivotTable2\").PivotFields(\"Format\").ClearAllFilters\n        Sheet2.PivotTables(\"PivotTable2\").PivotFields(\"Format\").CurrentPage = \"Example\"\n\n        ActiveWorkbook.EnvelopeVisible = True\n\n        With r.Parent.MailEnvelope.Item\n            .To = \"enteremailhere\"\n            .cc = \"\"\n            .bcc = \"\"\n            .Subject = \"EnterSubjectHere\"\n\n            .Send\n\n        End With\n    End Sub\n</code></pre>\n\n<p>Want the code to loop through the long list of fields in the pivot tables and send to specific email depending on the selected filter.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UoNlJ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "jira-rest-api"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1548275718, "post_id": 54334715, "comment_id": 95487845, "body": "pass your value as int <code>&quot;&quot;customfield_13744&quot;&quot; : 1234,</code>  i.e. without quotes"}, {"owner": {"reputation": 23, "user_id": 6042474, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206353314736241/picture?type=large", "display_name": "Vitor Prado", "link": "https://stackoverflow.com/users/6042474/vitor-prado"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1548326530, "post_id": 54334715, "comment_id": 95504964, "body": "And that was all! It works fine now! Thanks a lot @cyboashu!"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6042474, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206353314736241/picture?type=large", "display_name": "Vitor Prado", "link": "https://stackoverflow.com/users/6042474/vitor-prado"}, "is_accepted": true, "score": 0, "last_activity_date": 1548327299, "creation_date": 1548327299, "answer_id": 54344973, "question_id": 54334715, "link": "https://stackoverflow.com/questions/54334715/error-message-operation-value-must-be-a-number-on-creation-of-new-jira-issue/54344973#54344973", "title": "Error message: &quot;Operation value must be a number&quot;, on creation of new JIRA issue", "body": "<p>It turns out I just had to pass de numeric value without quotes, as suggested by @cyboashu. It's working now.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 7791881, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JCx1oL3ds3I/AAAAAAAAAAI/AAAAAAAAARI/qeMlAkRBc5g/photo.jpg?sz=128", "display_name": "motodiver", "link": "https://stackoverflow.com/users/7791881/motodiver"}, "is_accepted": false, "score": 0, "last_activity_date": 1590058979, "creation_date": 1590058979, "answer_id": 61933026, "question_id": 54334715, "link": "https://stackoverflow.com/questions/54334715/error-message-operation-value-must-be-a-number-on-creation-of-new-jira-issue/61933026#61933026", "title": "Error message: &quot;Operation value must be a number&quot;, on creation of new JIRA issue", "body": "<p>You must delete punctuation mark \"</p>\n"}], "owner": {"reputation": 23, "user_id": 6042474, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206353314736241/picture?type=large", "display_name": "Vitor Prado", "link": "https://stackoverflow.com/users/6042474/vitor-prado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 0, "accepted_answer_id": 54344973, "answer_count": 2, "score": 0, "last_activity_date": 1590058979, "creation_date": 1548273275, "question_id": 54334715, "link": "https://stackoverflow.com/questions/54334715/error-message-operation-value-must-be-a-number-on-creation-of-new-jira-issue", "title": "Error message: &quot;Operation value must be a number&quot;, on creation of new JIRA issue", "body": "<p>When creating a new JIRA issue using REST API in VBA, I'm getting the following error message for custom field 13744: \"Operation value must be a number\". </p>\n\n<p>I've tested the following code without the numeric field, and everything works fine, the issue is created and all the other fields value are passed:</p>\n\n<pre><code>Public Pass As Variant    \n</code></pre>\n\n<pre><code> Sub criarIssue()\n\n    Dim JiraService As New MSXML2.XMLHTTP60\n    Dim sErg As Variant\n    Dim sRestAntwort As Variant\n    Dim sSummary As Variant\n    Dim sDescription As Variant\n    Dim sProject As Variant\n    Dim sIssueType As Variant\n    Dim sData As Variant\n    Dim sPath As Variant\n    Dim sUsername As Variant\n    Dim sPassword As Variant\n    Dim sAux As Variant\n    Dim sStatus As Variant\n    Dim sEncbase64Auth As Variant\n\n    sUsername = Environ$(\"UserName\")\n    Senha.Show\n\n    sPassword = Pass\n\n    sSummary = ActiveSheet.Range(\"C3\").Value 'Issue name\n    sIssueType = \"Projeto\"\n    sProject = \"EXP\"\n\n    sData = \" { \"\"fields\"\" : { \"\"project\"\" : { \"\"key\"\" : \"\"\" &amp; sProject &amp; \"\"\" }, \"\"summary\"\" : \"\"\" &amp; _\n    sSummary &amp; \"\"\", \"\"issuetype\"\" : { \"\"name\"\" : \"\"\" &amp; sIssueType &amp; \"\"\"}, \"\"customfield_13744\"\" : \"\"1234\"\", \"\"customfield_13663\"\" : {\"\"name\"\" : \"\"vitor.ribeiro\"\"}, \"\"customfield_13670\"\" : \"\"2019-01-23 00:00:00\"\", \"\"customfield_13671\"\" :  {\"\"value\"\" : \"\"SP\"\" , \"\"child\"\" : {\"\"value\"\" : \"\"SAO PAULO\"\" }}}} \"\n\n    sEncbase64Auth = EncodeBase64(sUsername &amp; \":\" &amp; sPassword)\n\n    'Creates Issue\n    With JiraService\n        .Open \"POST\", \"http://172.16.2.128:8080/rest/api/2/issue/\", False\n        .SetRequestHeader \"Content-Type\", \"application/json\"\n        .SetRequestHeader \"Accept\", \"application/json\"\n        .SetRequestHeader \"X-Atlassian-Token\", \"nocheck\"\n        .SetRequestHeader \"Authorization\", \"Basic \" &amp; sEncbase64Auth\n        .Send (sData)\n        sRestAntwort = .ResponseText\n        sStatus = .Status &amp; \" | \" &amp; .StatusText\n    End With\n\n    ' JSON Response\n    sAux = Replace(sRestAntwort, \"{\", \"\")\n    sAux = Replace(sAux, \"}\", \"\")\n    sAux = Split(sAux, \",\")\n    sAux = sAux(1)\n    sAux = Split(sAux, \":\")\n    sAux = sAux(1)\n    sAux = Replace(sAux, \"\"\"\", \"\")\n\n    ActiveSheet.Range(\"J2\").Value = sStatus\n    ActiveSheet.Range(\"J3\").Value = sRestAntwort &amp; \" | \" &amp; sAux\n    ActiveSheet.Range(\"J4\").Value = ActiveSheet.Range(\"J4\").Value + 1\n    ActiveSheet.Range(\"C2\").Value = sAux\n\n    With JiraService\n    .Open \"DELETE\", \"http://172.16.2.128:8080/rest/auth/1/session\", False\n        .Send\n        End With\n\n\nEnd Sub\n\n\n\n</code></pre>\n\n<pre><code>Public Function EncodeBase64(text As String) As String\n\n    Dim arrData() As Byte\n    arrData = StrConv(text, vbFromUnicode)\n\n    Dim objXML As MSXML2.DOMDocument\n    Dim objNode As MSXML2.IXMLDOMElement\n\n    Set objXML = New MSXML2.DOMDocument\n    Set objNode = objXML.createElement(\"b64\")\n\n    objNode.DataType = \"bin.base64\"\n    objNode.nodeTypedValue = arrData\n    EncodeBase64 = objNode.text\n\n    Set objNode = Nothing\n    Set objXML = Nothing\n\nEnd Function\n</code></pre>\n\n<p>All but custom field 13744 values are passed without a problem. </p>\n\n<p>For this one I get the following error message:</p>\n\n<p>{\"errorMessages\":[],\"errors\":{\"customfield_13744\":\"Operation value must be a number\"}</p>\n\n<p>Why isn't it recognized as a number?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1548274287, "post_id": 54334691, "comment_id": 95487280, "body": "When you call the function it assumes you are passing the variables for heading and shtname.  Because you are not, the values are nothing and you will get the error because no such sheet or heading exists."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1548274915, "post_id": 54334691, "comment_id": 95487513, "body": "<code>r = .Range(&quot;1:1&quot;).Find(heading, LookIn:=xlValue)</code> is missing a <code>Set</code> keyword. I&#39;m surprised that isn&#39;t throwing error 91."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548275833, "post_id": 54334691, "comment_id": 95487896, "body": "I&#39;m curious about whether these sheets exist at compile-time in <code>ThisWorkbook</code>, and whether the &quot;headings&quot; actually belong to <code>ListObject</code> (table) objects. If that is the case, there&#39;s a much, much simpler way to go about this."}, {"owner": {"reputation": 87, "user_id": 10533391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yvqFL.jpg?s=128&g=1", "display_name": "NigelH", "link": "https://stackoverflow.com/users/10533391/nigelh"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548344638, "post_id": 54334691, "comment_id": 95516081, "body": "@MathieuGuindon yes, the sheet does exist as I am using this function after creating new worksheets and applying names from the <code>DataSht.</code> variables. However, I will take the advice and learn more about the <code>ListObject</code> as I&#39;m all for simpler solutions. Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548344692, "post_id": 54334691, "comment_id": 95516117, "body": "Ctrl+T (in Excel) is your new best friend ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548275518, "post_id": 54335133, "comment_id": 95487764, "body": "Wow, nice catch! Confirmed repro (throws error 91 once the typo is fixed, without the <code>Set</code> added). This would have been prevented with <code>Option Explicit</code> being specified at the top of the module."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548275675, "post_id": 54335133, "comment_id": 95487826, "body": "I would also suspect a possible error #9 at <code>Sheets(shtName)</code>, if that code isn&#39;t written in the <code>ThisWorkbook</code> module and the <code>ActiveWorkbook</code> (to which an unqualified <code>Sheets</code> call is then an implicit/indirect reference to) doesn&#39;t have a worksheet by that name. I would also advocate to use the <code>Worksheets</code> collection instead, to rule out the possibility of a type mismatch when the given name pulls, say, some <code>Chart</code> sheet - however unlikely that is."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548275873, "post_id": 54335133, "comment_id": 95487920, "body": "Also, congrats! You now have enough rep to comment everywhere! =)"}, {"owner": {"reputation": 87, "user_id": 10533391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yvqFL.jpg?s=128&g=1", "display_name": "NigelH", "link": "https://stackoverflow.com/users/10533391/nigelh"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548339611, "post_id": 54335133, "comment_id": 95512904, "body": "The missing <code>Set</code> and <code>xlValues</code> has cured the problem, big tick and thanks. Also appreciate the refined code. I had actually put the <code>.Select</code> statement in as a visible &#39;debug&#39; flag, so yes, redundant. @Mathieu your helpful advice duly noted, VBA objects and variables scope is driving me nuts!!"}], "tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": true, "score": 3, "last_activity_date": 1548275320, "creation_date": 1548275320, "answer_id": 54335133, "question_id": 54334691, "link": "https://stackoverflow.com/questions/54334691/vba-subscript-out-of-range-name-resolution-problem/54335133#54335133", "title": "VBA Subscript out of range, name resolution problem?", "body": "<p>Sadly can't comment, but you're actually getting the <code>out of range</code> error because it should be <code>LookIn:=xlValues</code> where you have <code>LookIn:=xlValue</code></p>\n\n<p>As @Mathieu indicates, you'll need to fix add <code>Set r = Find(heading, LookIn:=xlValues)</code> to set the range to the value returned.</p>\n\n<p>As a side note-you should drop the selection.  Its not doing anything for you.</p>\n\n<pre><code>With wks.Range(\"1:1\")\n   Set r = .Find(heading, LookIn:=xlValues)\n    If r Is Nothing Then\n        namedColumnNo = -1\n    Else: namedColumnNo = r.Column\n    End If\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10533391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yvqFL.jpg?s=128&g=1", "display_name": "NigelH", "link": "https://stackoverflow.com/users/10533391/nigelh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 54335133, "answer_count": 1, "score": 1, "last_activity_date": 1548275320, "creation_date": 1548273185, "question_id": 54334691, "link": "https://stackoverflow.com/questions/54334691/vba-subscript-out-of-range-name-resolution-problem", "title": "VBA Subscript out of range, name resolution problem?", "body": "<p>Trying to write a VBA function that will return the column number given the header cell string and the worksheet name but I get the Subscript out of range error. \nHere is the function:</p>\n\n<pre><code>Public Function namedColumnNo(heading As String, shtName As String) As Long\n' Return the column number with named header text'\n' on given worksheet.\nDim r As Range\nDim wks As Worksheet\n\nDebug.Print shtName\n'Exit Function\n\nSet wks = Sheets(shtName)\nwks.Range(\"1:1\").Select\nWith wks\n    r = .Range(\"1:1\").Find(heading, LookIn:=xlValue)\n    If r Is Nothing Then\n        namedColumnNo = -1\n    Else: namedColumnNo = r.Column\n    End If\n\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>I am using this test sub to call the funtion:</p>\n\n<pre><code>Public Sub getCol()\n\nDebug.Print \"Find MidTemp on \" &amp; DataSht.RawDataSht\nDebug.Print \"Col \" &amp; namedColumnNo(\"MidTemp\", DataSht.RawDataSht)\n\nEnd Sub\n</code></pre>\n\n<p>I have a user defined type DataSht where I have variables to name worksheets e.g.</p>\n\n<pre><code>Public Type dataShtNames\n    HeaderSht As String\n    RawDataSht As String\n    ResultDataSht As String\nEnd Type\nPublic DataSht As dataShtNames\n</code></pre>\n\n<p>With the Exit Function statement uncommented the variables resolve OK with the debug.print statements I get</p>\n\n<pre><code>Find MidTemp on RawData\nRawData:MidTemp\nCol 0\n</code></pre>\n\n<p>Leaving the function to run through the error occurs at\n<code>Set wks = Sheets(shtName)</code>\nIf I replace the argument shtName with the actual sheet name as a string \"RawData\", then the error moves down to the line using the second argument <code>heading</code>. If I substitute a the parameter with a string here the error persists. \nIs there something I am missing here? Some help will be much appreciated. </p>\n"}, {"tags": ["excel", "vba", "substring", "measurement"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1548290625, "post_id": 54334631, "comment_id": 95492615, "body": "You already have a solution, but a REGEX would also work nicely here."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 3225730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/320989c711f8451725b4d0ea1e1acf38?s=128&d=identicon&r=PG&f=1", "display_name": "StrangeBiscuit", "link": "https://stackoverflow.com/users/3225730/strangebiscuit"}, "is_accepted": true, "score": 0, "last_activity_date": 1548277088, "creation_date": 1548277088, "answer_id": 54335530, "question_id": 54334631, "link": "https://stackoverflow.com/questions/54334631/excel-vba-convert-numbers-that-come-before-a-certain-substring/54335530#54335530", "title": "Excel VBA - Convert numbers that come before a certain substring", "body": "<p>Got someone to assist with this and they came up with this really nice solution. Hopefully might be useful to someone else someday!</p>\n\n<pre><code>Sub ChangeCM2IN()\n  Dim X As Long, Z As Long, FirstDigit As Long, V As Double, Cell As Range, CM() As String\n  Application.ScreenUpdating = False\n  For Each Cell In Range(\"A1\", Cells(Rows.Count, \"A\").End(xlUp))\n    CM = Split(\" \" &amp; Cell.Value, \"cm\", , vbTextCompare)\n    For X = 0 To UBound(CM) - 1\n      For Z = Len(CM(X)) To 1 Step -1\n        If Mid(CM(X), Z, 1) Like \"[!0-9.]\" Then\n          FirstDigit = Z + 1\n          V = Format(Mid(CM(X), FirstDigit) * 0.393700787401575, \"0.0\")\n          Exit For\n        End If\n      Next\n      CM(X) = Left(CM(X), FirstDigit - 1) &amp; V\n    Next\n    Cell.Offset(, 1).Value = Trim(Join(CM, \"in\"))\n  Next\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3225730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/320989c711f8451725b4d0ea1e1acf38?s=128&d=identicon&r=PG&f=1", "display_name": "StrangeBiscuit", "link": "https://stackoverflow.com/users/3225730/strangebiscuit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 54335530, "answer_count": 1, "score": 0, "last_activity_date": 1548277088, "creation_date": 1548272937, "question_id": 54334631, "link": "https://stackoverflow.com/questions/54334631/excel-vba-convert-numbers-that-come-before-a-certain-substring", "title": "Excel VBA - Convert numbers that come before a certain substring", "body": "<p>I've got a column with cells full of HTML content that includes measurements in centimeters that we need to convert to inches.</p>\n\n<p>The number to convert always precedes \"cm\" as in <code>&lt;p&gt;&lt;strong&gt;Medium - 6.3cm x 7cm&lt;/strong&gt;&lt;/p&gt;</code></p>\n\n<p>I've been trying to copy the whole cell content into an adjacent cell and identify the numbers to convert by looking between \"cm\" and a space.</p>\n\n<p>However, there's not always a space between the number and another character as there can be cases like <code>&lt;p&gt;8cm x 5.3cm&lt;/p&gt;</code> or <code>blah-10.5cm x 5cm</code>. In some cases it comes at the beginning of the cell in which case there would also be no space, i.e. <code>12cm x 8cm - blah blah blah</code>.</p>\n\n<p>Can anyone suggest any way to do this by identifying the number to convert as all non-numerical characters preceding the \"cm\" substring?</p>\n\n<p>What we've got so far tries working around this by replacing characters that show up before the numbers with a space...but finding there are too many possibilities needed for replacement and it also messes up the HTML of course.</p>\n\n<p>I've copied it below for reference in any case. If anyone could help us solve this problem, it'd be immensely appreciated!</p>\n\n<pre><code>Sub ChangeCM2IN()\n  Dim X As Long, V As Double, Cell As Range, CM() As String\n  Application.ScreenUpdating = False\n  For Each Cell In Range(\"A1\", Cells(Rows.Count, \"A\").End(xlUp))\n    CM = Split(Replace(Replace(\" \" &amp; Cell.Value, \"x\", \"x \", , , vbTextCompare), \"&gt;\", \" \"), \"cm\", , vbTextCompare)\n    For X = 0 To UBound(CM) - 1\n      V = Format(Mid(CM(X), InStrRev(CM(X), \" \")) * 0.393700787401575, \"0.0\")\n      CM(X) = Left(CM(X), InStrRev(CM(X), \" \")) &amp; V\n    Next\n    Cell.Offset(, 1).Value = Join(CM, \"in\")\n  Next\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548271735, "post_id": 54334351, "comment_id": 95486233, "body": "Use a <code>For</code> loop"}, {"owner": {"reputation": 1963, "user_id": 2137316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mvWqd.jpg?s=128&g=1", "display_name": "kmuenkel", "link": "https://stackoverflow.com/users/2137316/kmuenkel"}, "edited": false, "score": 0, "creation_date": 1548273594, "post_id": 54334351, "comment_id": 95487006, "body": "Please include what you&#39;ve already attempted for this, so we can try to point you in the right direction."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "edited": false, "score": 0, "creation_date": 1548339061, "post_id": 54334351, "comment_id": 95512523, "body": "@niematerialny If you just want to see the 56 colors then they can be seen here <a href=\"http://dmcritchie.mvps.org/excel/colors.htm\" rel=\"nofollow noreferrer\">dmcritchie.mvps.org/excel/colors.htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1548273129, "post_id": 54334418, "comment_id": 95486811, "body": "I figured that was what the OP was asking for. Perhaps they wanted to see all of the colors for reference?"}], "tags": [], "owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "is_accepted": false, "score": 2, "last_activity_date": 1548271969, "creation_date": 1548271969, "answer_id": 54334418, "question_id": 54334351, "link": "https://stackoverflow.com/questions/54334351/how-to-color-56-cells-in-b-column/54334418#54334418", "title": "How to color 56 cells in B column", "body": "<p>Use the following code:</p>\n\n<pre><code>Sub colorCells()\n     For i = 1 To 56\n        Range(\"B1\").Offset(i - 1, 0).Interior.ColorIndex = i\n     Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10957612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca9e0849182d6c7356afe1a840f4f8d?s=128&d=identicon&r=PG&f=1", "display_name": "niematerialny", "link": "https://stackoverflow.com/users/10957612/niematerialny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1548279144, "answer_count": 1, "score": -2, "last_activity_date": 1548314911, "creation_date": 1548271646, "last_edit_date": 1548314911, "question_id": 54334351, "link": "https://stackoverflow.com/questions/54334351/how-to-color-56-cells-in-b-column", "closed_reason": "Needs more focus", "title": "How to color 56 cells in B column", "body": "<p>How to write a code that colors 56 cells in B column with 56 color from color index function-> cells.interior.colorindex</p>\n"}, {"tags": ["vba", "ms-word", "ribbonx"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1548275924, "post_id": 54334346, "comment_id": 95487939, "body": "Which line throws error? Without knowing details, dare to suggest to move code into separate procedure and use <code>Application.OnTime</code> which will call it after set time."}, {"owner": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1548278290, "post_id": 54334346, "comment_id": 95488869, "body": "Sorry, I should have made that more clear in my original question. The line that throws the error is the first ActiveDocument.Name If statement. If I move it into a separate procedure and call it from onLoad, I don&#39;t think that will help. The onLoad sub is called when the Ribbon is being initiated, which seems to be happening before the document is open in 2016 (but in 2013 it was happening after the document was open)."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548279101, "post_id": 54334346, "comment_id": 95489231, "body": "Try a loop that tests <code>If Documents.Count &gt; 0</code> Once that&#39;s true, exit the loop and check the active document&#39;s name."}, {"owner": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548285314, "post_id": 54334346, "comment_id": 95491438, "body": "Thanks @Cindy. Unfortunately, I ended up with an infinite loop because      Documents.Count never got past 0 because the onLoad runs before a document is open."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548357649, "post_id": 54334346, "comment_id": 95522937, "body": "Well, if it truly runs before a document is opened, and a document can&#39;t / won&#39;t be opened until it has run, the test is not possible. If a document <i>can</i> open while it&#39;s running you could try sticking a <code>Do Events</code> in the loop. Or you could try putting another label in the code so that you can <code>GoTo Label</code> in the error handler, back into the body of the <code>If</code>."}, {"owner": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548362709, "post_id": 54334346, "comment_id": 95525196, "body": "Thanks @Cindy. I added a Do Events to the loop when I tested it. The document doesn&#39;t open until the onLoad sub has finished completely, it seems, which means I&#39;m going to have to figure out a new method to do many of the things that get done before the user is allowed to interact with the document."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "edited": false, "score": 0, "creation_date": 1548285204, "post_id": 54336312, "comment_id": 95491405, "body": "Thanks for the insight. Unfortunately, this doesn&#39;t work because the Ribbon onLoad fires before the app event that fires when a document is opened. I tested this with simple message boxes. So, really, the issue is that the ribbon loads before a document loads in Word 2016, which is different behavior from Word 2013."}, {"owner": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "edited": false, "score": 0, "creation_date": 1548455300, "post_id": 54336312, "comment_id": 95561663, "body": "I think I misunderstood your answer initially and I&#39;m 99% certain it will work. I&#39;ll mark this as the answer once I&#39;ve tested it."}], "tags": [], "owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "is_accepted": false, "score": 0, "last_activity_date": 1548280622, "creation_date": 1548280622, "answer_id": 54336312, "question_id": 54334346, "link": "https://stackoverflow.com/questions/54334346/activedocument-error-4248-in-ribbon-onload-sub/54336312#54336312", "title": "ActiveDocument error 4248 in Ribbon onLoad sub", "body": "<p>Move the code to an application level event handler. The code will run each time a new document is opened, but that can be remedied if needed (see code comments).</p>\n\n<p><strong>Create a new class module and name the class module EventMngr.</strong> </p>\n\n<p><strong>Place the following code in the class module:</strong></p>\n\n<pre><code>Public WithEvents appevent As Application\n\nPrivate Sub appevent_DocumentOpen(ByVal Doc As Document)\n    'This code will only allow the event to fire once\n    Static hasOpened As Boolean\n    If hasOpened Then Exit Sub Else hasOpened = True\n\n    'Place Code Here...\nEnd Sub\n</code></pre>\n\n<p><strong>Then you can place this line in a normal module before any other subs/functions</strong></p>\n\n<pre><code>'application level event handler\nPublic myEventHandler As New EventMngr\n</code></pre>\n\n<p><strong>And last, place this in your Ribbon OnLoad sub:</strong></p>\n\n<pre><code>'application event handler\n Set myEventHandler.appevent = Application\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "edited": false, "score": 0, "creation_date": 1548285253, "post_id": 54336366, "comment_id": 95491420, "body": "Will this work if I add these procedures to the global template? I thought these were only document level procedures."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "edited": false, "score": 0, "creation_date": 1548317122, "post_id": 54336366, "comment_id": 95499721, "body": "They need to be in the Template on which the document is based or in the document itself."}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1548280956, "creation_date": 1548280956, "answer_id": 54336366, "question_id": 54334346, "link": "https://stackoverflow.com/questions/54334346/activedocument-error-4248-in-ribbon-onload-sub/54336366#54336366", "title": "ActiveDocument error 4248 in Ribbon onLoad sub", "body": "<p>Similar to the previous answer but possibly simpler is to add autoopen and autonew procedures to your code and capture the activedocument in those procedures rather than the onload procedure.</p>\n"}], "owner": {"reputation": 13, "user_id": 9357364, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lg3e6i7O9Iw/AAAAAAAAAAI/AAAAAAAADQA/nwNam7fAHGw/photo.jpg?sz=128", "display_name": "Anthony Yannotta", "link": "https://stackoverflow.com/users/9357364/anthony-yannotta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548280956, "creation_date": 1548271625, "last_edit_date": 1548279007, "question_id": 54334346, "link": "https://stackoverflow.com/questions/54334346/activedocument-error-4248-in-ribbon-onload-sub", "title": "ActiveDocument error 4248 in Ribbon onLoad sub", "body": "<p>I have a global template with a customized ribbon. When I try to open a document, I receive error 4248, which claims the command can't run because no document is open.</p>\n\n<p>The code in the onLoad sub is checking to make sure that the active document isn't the template or Normal.dotm because I don't want document variables written to those files via the called procedures. This worked fine in Word 2013, but I'm noticing that in Word 2016, it seems the ribbon onLoad procedure is running before a document in Word is open.\nI've pinpointed the issue to the ActiveDocument.Name line, where I can trap the error and resume next, but that doesn't help me run the additional code after the determination is made that this isn't the global template document or Normal.dotm. </p>\n\n<pre><code>Public myRibbonNewNormal As IRibbonUI\nPublic bVisible As Boolean\nDim bDocSaved As Boolean\n\nSub onLoad_newNormal(ribbon As IRibbonUI)\nSet myRibbonNewNormal = ribbon\n\nOn Error GoTo onLoadError\n\nIf ActiveDocument.Name = \"Styles.dotm\" Or ActiveDocument.Name = \n\"newNormal.dotm\" Then\n  Exit Sub\nElseIf ActiveDocument.ReadOnly Then\n  Exit Sub\nElse\n  'Call checkDocType\n  Call uncheckUpdateStyles\n  Call removeClientFooter\n  Call checkTemplate\n  If bDocSaved &lt;&gt; True Then\n    Call preventSave\n  Else\n    'do nothing\n  End If\nEnd If\n\nExit Sub\n\nonLoadError:\nIf Err.Number = 0 Then\n  Resume Next\nElseIf Err.Number = 5 Then\n  Resume Next\nElseIf Err.Number = 5825 Then\n  Resume Next\nElseIf Err.Number = 5903 Then\n  Resume Next\n'ElseIf Err.Number = 5155 Then\n'  Resume Next\nElseIf Err.Number = 4248 Then\n  Resume Next\nElse\nMsgBox \"This error is in the onLoad sub in the newNormal RibbonControl\" _\n  &amp; vbCrLf &amp; vbCfLf &amp; \"Error: \" &amp; Err.Number &amp; vbCrLf &amp; Err.Description, , \n\"Error\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>(Please excuse my error handling. I was in a hurry when I wrote this code and just haven't gotten back around to doing it properly.)</p>\n\n<p>Is there a way for me to wait to execute the onLoad sub until Word has opened the document (by simple double-click)? I'm sure I'm missing something here, but I'm struggling to find any information about this online.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1548335895, "post_id": 54334165, "comment_id": 95510543, "body": "Welcome to SO. Please see <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and don&#39;t forget to read <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a>. Also check out the <a href=\"https://stackoverflow.com/tour\">tour</a>, and more good information at <a href=\"https://stackoverflow.com/help/on-topic\">&quot;help center&quot;.</a>. You should post some data example, with the input you have, and the expected output."}], "owner": {"reputation": 11, "user_id": 10957620, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9LAZk3qgKho/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNUKzUCP0qamnm0U33vndv_KklhDQ/mo/photo.jpg?sz=128", "display_name": "CJ Levin", "link": "https://stackoverflow.com/users/10957620/cj-levin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548314897, "creation_date": 1548270846, "last_edit_date": 1548314897, "question_id": 54334165, "link": "https://stackoverflow.com/questions/54334165/how-to-create-a-moving-average-based-on-time-values-in-a-separate-column", "title": "How to create a moving average based on time values in a separate column", "body": "<p>I have physiological data collected over a specific period of time in excel. I have the time points in one column and the measures in a separate column. I want a macro that will automatically average the first 10 minutes of physio data, move to the start of the next 10 minutes then average that and so on and so forth for the entire data set. </p>\n\n<p>I've been trying to combine the averageIfs and offset functions in a way that does this but I keep hitting a wall. Help please?</p>\n\n<pre><code>=AverageIfs((Offset(A2+10/1440)), D:D,A:A,\"&gt;=\"&amp; A2,A:A,\"&lt;\"&amp;(A2+10/1440))\n</code></pre>\n\n<p>I was hoping this would average and then at least move to the next cell after the averaged range. Instead I got an error message that says not enough arguments. I realize there are a lot of problems here, and that I can't accomplish my goal with a single line of code but this feels a bit out of my depth and I could use help.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "scrape"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1548351198, "post_id": 54334813, "comment_id": 95520022, "body": "Amazing, the first one worked like a charm! The second one however came out as &quot;Download Failed&quot;, maybe im not inserting the filepath like i should?"}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1549977650, "post_id": 54334813, "comment_id": 96093283, "body": "API has changed I think, how can i find the new API of the same webpage that will work for my macro? Debugger highlights ReDim output(1 To UBound(lines), 1 To 2) with error 9. Thanks!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1549981764, "post_id": 54334813, "comment_id": 96096079, "body": "I\u2019ll have a look"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550003233, "post_id": 54334813, "comment_id": 96107721, "body": "Use the dev tools in chome (F12) - Network tab. Refresh the page and then look at the XHR requests made and see if the API call is there."}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550087627, "post_id": 54334813, "comment_id": 96145703, "body": "Excuse my ignorance, but there are many API&#39;s. Ive tried replacing all of them and it still wont work. Thank you so much by the way."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550087901, "post_id": 54334813, "comment_id": 96145832, "body": "for example: <a href=\"https://rofex.primary.ventures/api/v2/rofexrt/securities?_ds=1550087701605-993529\" rel=\"nofollow noreferrer\">rofex.primary.ventures/api/v2/rofexrt/&hellip;</a>  but that one produces a json response."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550087991, "post_id": 54334813, "comment_id": 96145878, "body": "was there a download button before?"}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550089129, "post_id": 54334813, "comment_id": 96146419, "body": "No, there wasnt a Download button"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550089213, "post_id": 54334813, "comment_id": 96146462, "body": "If you put that url I just gave in Firefox you should see the Json data"}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550152742, "post_id": 54334813, "comment_id": 96171653, "body": "I replace &quot;&quot;<a href=\"https://rofex.primary.ventures/api/v1/platform/market/md\" rel=\"nofollow noreferrer\">rofex.primary.ventures/api/v1/platform/market/md</a>&quot;&quot; with your url and i get an Error 9 and &quot;ReDim output(1 To UBound(lines), 1 To 2)&quot; gets highlighted"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550154080, "post_id": 54334813, "comment_id": 96172451, "body": "That returns Json. You need to use a jsonparser like jsonconvertor.bas"}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550672058, "post_id": 54334813, "comment_id": 96355077, "body": "Dont know how to use a jsconvertor.bas, if you could code it in i would really appreciate it"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1550674778, "post_id": 54334813, "comment_id": 96356842, "body": "You can find lots of examples of jsonconverter.bas in my previous answers given. <a href=\"https://stackoverflow.com/search?q=jsonconverter.bas+user%3A6241235+is%3Aanswer\">stackoverflow.com/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1554218347, "post_id": 54334813, "comment_id": 97666682, "body": "Im sorry, its been over a month and I still havent been able to code it correctly.  I cant scrape the data from the <a href=\"https://rofex.primary.ventures/\" rel=\"nofollow noreferrer\">rofex.primary.ventures</a> , I dont know if my issue is with the loading page or what.  Any chance of you helping me? Thanks!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1554218489, "post_id": 54334813, "comment_id": 97666778, "body": "Do you want to open a new question and include your current code attempt that way more people can look at it and I will also when home."}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1554226605, "post_id": 54334813, "comment_id": 97671129, "body": "I have already downloaded jsconverter.bas and enabled microsoft scripting runtime but my coding skills are very rudimentary"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1554302145, "post_id": 54334813, "comment_id": 97702429, "body": "Yes. I can\u2019t look until tonight."}, {"owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "edited": false, "score": 0, "creation_date": 1554839186, "post_id": 54334813, "comment_id": 97896534, "body": "Thank you very much, here is the new thread <a href=\"https://stackoverflow.com/questions/55600252/i-cant-seem-able-to-scrape-data-off-a-website-that-constantly-changes-its-price\" title=\"i cant seem able to scrape data off a website that constantly changes its price\">stackoverflow.com/questions/55600252/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1548274489, "last_edit_date": 1548274489, "creation_date": 1548273670, "answer_id": 54334813, "question_id": 54333993, "link": "https://stackoverflow.com/questions/54333993/i-cant-seem-able-to-scrape-data-form-a-website-that-is-constantly-changing-its-p/54334813#54334813", "title": "I cant seem able to scrape data form a website that is constantly changing its prices using VBA in excel", "body": "<p>Use the available API. There is a csv format xmlhttp response that you can target to extract this info. Note that the results are in 1000s so, for example, <code>DOEne19</code> is <code>ult</code> <code>37,960</code> and the output is <code>37.96</code>. </p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Const URL As String = \"https://rofex.primary.ventures/api/v1/platform/market/md\"\n    Dim lines() As String\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", URL, False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        lines = Split(.responseText, vbLf)\n    End With\n    Dim output(), i As Long, rowCounter As Long, arr() As String\n    ReDim output(1 To UBound(lines), 1 To 2)\n    For i = 1 To UBound(lines)\n        If InStr(lines(i), \"|\") &gt; 0 Then\n            rowCounter = rowCounter + 1\n            arr = Split(lines(i), \"|\")\n            output(rowCounter, 1) = Replace$(arr(0), \"m;\", vbNullString)\n            output(rowCounter, 2) = arr(6)\n        End If\n    Next\n    output = Application.Transpose(output)\n    ReDim Preserve output(1 To 2, 1 To rowCounter)\n    output = Application.Transpose(output)\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .Cells(1, 1) = \"Ticker\": .Cells(1, 2) = \"1000s\"\n        .Cells(2, 1).Resize(UBound(output, 1), UBound(output, 2)) = output\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Otherwise, you can download as csv as then use loop column A and use split to extract the columns of interest. Download part shown below.</p>\n\n<pre><code>Public Sub DownloadFile()\n    Dim http As Object\n    Const filepath As String = \"C:\\Users\\User\\Desktop\\TestDownload.csv\"\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n    http.Open \"GET\", \"https://rofex.primary.ventures/api/v1/platform/market/md\", False\n    http.send\n    On Error GoTo errhand\n    With CreateObject(\"ADODB.Stream\")\n        .Open\n        .Type = 1\n        .Write http.responseBody\n        .SaveToFile filepath '&lt;== specify your path here\n        .Close\n    End With\n    Debug.Print \"FileDownloaded\"\n    TidyFile filepath\n    Exit Sub\nerrhand:\n    If Err.Number &lt;&gt; 0 Then\n        Debug.Print Err.Number, Err.Description\n        MsgBox \"Download failed\"\n    End If\nEnd Sub\n\nPublic Sub TidyFile(ByVal filepath As String)\n    Dim wb As Workbook, lines(), i As Long, output(), rowCounter As Long, arr() As String\n    Set wb = Workbooks.Open(filepath)\n\n    With wb.Sheets(1)\n        lines = Application.Transpose(.Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Value)\n\n        ReDim output(1 To UBound(lines), 1 To 2)\n        For i = LBound(lines) To UBound(lines)\n            If InStr(lines(i), \"|\") &gt; 0 Then\n                rowCounter = rowCounter + 1\n                arr = Split(lines(i), \"|\")\n                output(rowCounter, 1) = Replace$(arr(0), \"m;\", vbNullString)\n                output(rowCounter, 2) = arr(6)\n            End If\n        Next\n        output = Application.Transpose(output)\n        ReDim Preserve output(1 To 2, 1 To rowCounter)\n        output = Application.Transpose(output)\n        .Cells.ClearContents\n        .Cells(1, 1) = \"Ticker\": .Cells(1, 2) = \"1000s\"\n        .Cells(2, 1).Resize(UBound(output, 1), UBound(output, 2)) = output\n    End With\n    wb.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10957525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IXLVH6ejqD0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNHsCJBIoGl9P4rQRKP-9k9vQhILg/mo/photo.jpg?sz=128", "display_name": "Luis Blaq", "link": "https://stackoverflow.com/users/10957525/luis-blaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 54334813, "answer_count": 1, "score": 0, "last_activity_date": 1548274489, "creation_date": 1548270011, "last_edit_date": 1548273751, "question_id": 54333993, "link": "https://stackoverflow.com/questions/54333993/i-cant-seem-able-to-scrape-data-form-a-website-that-is-constantly-changing-its-p", "title": "I cant seem able to scrape data form a website that is constantly changing its prices using VBA in excel", "body": "<p>I cant seem to find the ID when i inspect the source of the website \"rofex.primary.ventures\".  All i want to do is grab all the data below the Ult column and put it into an excel worksheet. Ive used firefox because it shows the HTLM code in a nicer way but i would like to scrape it from chrome using an excel Macro. How would i do this?</p>\n\n<pre><code>Sub Rofex()\n\nDim appIE As Object\nSet appIE = CreateObject(\"internetexplorer.application\")\nWith appIE\n.Navigate \"https://rofex.primary.ventures\"\n.Visible = True\nEnd With\nDo While appIE.Busy\nDoEvents\nLoop\n\nSet allRowOfData = appIE.document.getElementById(\"rx:DO:2019:01:a\")\nDim myValue As String: myValue = allRowOfData.Cells(6).innerHTML\n\nappIE.Quit\nSet appIE = Nothing\nRange(\"A1\").Value = myValue\nEnd Sub\n</code></pre>\n\n<p>This is what i have but get all types of errors, im new to coding, needless to say. Thank you!</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "edited": false, "score": 0, "creation_date": 1548280973, "post_id": 54333959, "comment_id": 95490024, "body": "But you get an error?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1548333251, "post_id": 54333959, "comment_id": 95508835, "body": "Try submitting the form instead. E.g. something like this<code>ie.document.getElementsByTagName(&quot;form&quot;)(0).submit</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1549254978, "creation_date": 1549254978, "answer_id": 54510191, "question_id": 54333959, "link": "https://stackoverflow.com/questions/54333959/unable-to-click-submit-button-web-scraping-vba/54510191#54510191", "title": "Unable to click Submit Button_Web Scraping VBA", "body": "<p>JavaScript is going to be more challenging to deal with, compared to regular old HTML, but anyway, it looks like the button is named 'Submit'.  Did you try to  click 'Submit'?  </p>\n\n<pre><code>IE.Document.getElementById(\"UserID\").Value = \"something\" 'Login\nIE.Document.getElementById(\"Password\").Value = \"something\" 'Password\nIE.Document.getElementById(\"Submit\").Click 'Submit button\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8746502, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gzVCeam3Iz4/AAAAAAAAAAI/AAAAAAAABXk/3JO0tpmscy0/photo.jpg?sz=128", "display_name": "raj kumar", "link": "https://stackoverflow.com/users/8746502/raj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1549254978, "creation_date": 1548269884, "last_edit_date": 1548314875, "question_id": 54333959, "link": "https://stackoverflow.com/questions/54333959/unable-to-click-submit-button-web-scraping-vba", "title": "Unable to click Submit Button_Web Scraping VBA", "body": "<p>I would require help in completing the coding for web scraping.</p>\n\n<p>In the below given vba code am able to enter the username and password into the input boxes but not able to click the submit button to move further.</p>\n\n<pre><code>IE.navigate \"http://wasbprbvl.corp.anheuser-busch.com/WMSBrwy/Login\"\n            Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE\n            Loop\n        IE.document.forms(\"Login\").elements(\"j_username\").Value = \"UserName\"\n        IE.document.forms(\"Login\").elements(\"j_password\").Value = \"XXXXXXX\"\n\n        Set tagNames = HTMLDoc.getElementsByTagName(\"INPUT\")\n        i = 0\n        While i &lt; tagNames.Length\n            If tagNames(i).Type = \"submit\" And tagNames(i).Value = \"Submit\" Then\n                Set objElement = tagNames(i)\n                GoTo clickCode\n            End If\n            i = i + 1\n        Wend\n</code></pre>\n\n<p>clickCode:\n            objElement.Click\n        End If</p>\n\n<p>I have also attached the screenshot of page along with the inspect screen.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nA0A5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nA0A5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Regards,\nRaj</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 3, "creation_date": 1548270389, "post_id": 54333918, "comment_id": 95485673, "body": "All of your Excel objects need to be fully qualified.   PowerPoint knows nothing of Excel <code>Range</code>, <code>Column</code> etc. I would also remove reliance on <code>ActiveSheet</code>, <code>Select</code>, <code>Selection</code> etc and set variables to the required objects. Use <code>xlApp.Quit</code> to close the created instance of Excel"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548277804, "post_id": 54333918, "comment_id": 95488650, "body": "You need to clear out the Excel variable by setting it to nothing after it has been closed.  <code>Set xlApp = Nothing</code>. That should fix the problem."}, {"owner": {"reputation": 11, "user_id": 10957520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadffd515528f2507f2a79c2b96dec65?s=128&d=identicon&r=PG&f=1", "display_name": "aberry27", "link": "https://stackoverflow.com/users/10957520/aberry27"}, "edited": false, "score": 0, "creation_date": 1548283622, "post_id": 54333918, "comment_id": 95490918, "body": "Thanks for the responses.  I believe the line &quot;With xlApp.ActiveSheet.QueryTables.Add(Connection:=&quot;TEXT;midfilel&zwnj;&#8203;ocation\\FinalIN3.txt&zwnj;&#8203;&quot;, Destination:=Range(&quot;A1&quot;))&#39;code&#39; is the issue.                                         I read the easiest way to sort a non-deliminated text file into excel is with a macro so that is what I did.  Is there a better way to handle this?  Sorry I can&#39;t figure out how to make the code tag work in the comments..."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548403165, "post_id": 54333918, "comment_id": 95536430, "body": "The code tag in the comments is a single ` character followed by a closing ` character with no spaces at the end ex: ` <code>codehere</code> `"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1548403283, "post_id": 54361116, "comment_id": 95536471, "body": "You would probably want to close Excel first though, otherwise the loop will open multiple instances as it goes along. Use <code>xlApp.Quit</code> before setting to <code>Nothing</code>"}, {"owner": {"reputation": 11, "user_id": 10957520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadffd515528f2507f2a79c2b96dec65?s=128&d=identicon&r=PG&f=1", "display_name": "aberry27", "link": "https://stackoverflow.com/users/10957520/aberry27"}, "edited": false, "score": 0, "creation_date": 1548437735, "post_id": 54361116, "comment_id": 95554643, "body": "Again, I thank you all for the answers.  I have tried just about everything I can think of and had no luck.  Every time I run the code a second time I get the error: Run-time error 1004 Method Range of object_Global failed.  It works fantastic the first run-through though!"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548438584, "post_id": 54361116, "comment_id": 95555095, "body": "Check out the update. I modified some things and added <code>xlApp.DisplayAlerts =  False</code>"}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1548438534, "last_edit_date": 1548438534, "creation_date": 1548403104, "answer_id": 54361116, "question_id": 54333918, "link": "https://stackoverflow.com/questions/54333918/importing-text-file-into-excel-gets-caught-on-second-run-of-code/54361116#54361116", "title": "Importing text file into Excel gets caught on second run of code", "body": "<p>You need to clear out the Excel variable by setting it to nothing after it has been closed. Also, add the <code>xlApp.DisplayAlerts</code> = False line.</p>\n\n<p>after</p>\n\n<pre><code>    xlApp.DisplayAlerts = False\n\n    xlApp.ActiveWorkbook.SaveAs Filename:=\"C:\\finalfilelocation\\FinalIN3Document.xlsx\", \n       AccessMode:=xlExclusive, \n       ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges\n\n    xlApp.ActiveWorkbook.Close\n\n    xlApp.Workbooks.Close\n\n    xlApp.Quit\n</code></pre>\n\n<p>put the following:</p>\n\n<pre><code>Set xlApp = Nothing\n\n</code></pre>\n\n<p>That should fix the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10957520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadffd515528f2507f2a79c2b96dec65?s=128&d=identicon&r=PG&f=1", "display_name": "aberry27", "link": "https://stackoverflow.com/users/10957520/aberry27"}, "is_accepted": false, "score": 0, "last_activity_date": 1548871476, "creation_date": 1548871476, "answer_id": 54446863, "question_id": 54333918, "link": "https://stackoverflow.com/questions/54333918/importing-text-file-into-excel-gets-caught-on-second-run-of-code/54446863#54446863", "title": "Importing text file into Excel gets caught on second run of code", "body": "<p>I got it to work by adding xlAPP in front of most of the code (see below).  Thanks again for all of your help on this everyone.  Is there something I need to do to mark this as solved?</p>\n\n<pre><code>With xlApp.ActiveSheet.QueryTables.Add(Connection:=\"TEXT;C:filepath\\begin.txt\", Destination:=xlApp.Cells(1, 1))\n\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlFixedWidth\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileFixedColumnWidths = Array(4, 10, 10, 9, 18, 15, 23, 32, 12, 5, 7, 13, 9, 6)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n    xlApp.Rows(\"1:9\").Select\n    xlApp.Selection.Delete Shift:=xlUp\n    xlApp.Columns(\"A:A\").Select\n    xlApp.Selection.Delete Shift:=xlToLeft\n    xlApp.Rows(\"2:2\").Select\n    xlApp.Selection.Delete Shift:=xlUp\n    xlApp.Range(\"M:M,N:N\").Select\n    xlApp.Range(\"N1\").Activate\n    xlApp.Selection.Delete Shift:=xlToLeft\n    xlApp.Columns(\"K:K\").Select\n    xlApp.Selection.Delete Shift:=xlToLeft\n    xlApp.Range(\"F20\").Select\n\n\n     xlApp.Columns(\"D\").EntireColumn.Delete\n     xlApp.Columns(\"H\").EntireColumn.Delete\n     xlApp.Columns(\"I\").EntireColumn.Delete\n     xlApp.Columns(\"G\").EntireColumn.Delete\n     xlApp.Columns(\"C\").EntireColumn.Delete\n     xlApp.Columns(\"A\").EntireColumn.Delete\n\n\n     xlApp.Columns(\"A\").ColumnWidth = 25\n     xlApp.Columns(\"B\").ColumnWidth = 25\n     xlApp.Columns(\"C\").ColumnWidth = 30\n     xlApp.Columns(\"D\").ColumnWidth = 60\n     xlApp.Columns(\"E\").ColumnWidth = 15\n\n\n     xlApp.Range(\"A1:E1\").EntireRow.Insert\n     xlApp.Range(\"A1:E1\").Merge\n     xlApp.Range(\"A:E\").HorizontalAlignment = xlCenter\n     xlApp.Range(\"A:E\").Font.Size = 15\n     xlApp.Range(\"A1\").Font.Size = 30\n     xlApp.Range(\"A1\").Value = \"IN3 Dispatch as of \" &amp; latestDate\n\n\n    xlApp.DisplayAlerts = False\n\n    xlApp.ActiveWorkbook.SaveAs FileName:=\"C:\\filepath\\end.xlsx\", AccessMode:=xlExclusive, ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges\n\n    xlApp.ActiveWorkbook.Close\n\n    xlApp.Workbooks.Close\n\n\n   xlApp.Quit\n   Excel.Application.Quit\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10957520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dadffd515528f2507f2a79c2b96dec65?s=128&d=identicon&r=PG&f=1", "display_name": "aberry27", "link": "https://stackoverflow.com/users/10957520/aberry27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548871476, "creation_date": 1548269754, "question_id": 54333918, "link": "https://stackoverflow.com/questions/54333918/importing-text-file-into-excel-gets-caught-on-second-run-of-code", "title": "Importing text file into Excel gets caught on second run of code", "body": "<p>I am trying to get powerpoint to open find the newest text file in a folder, open the text file with excel, format the text file, then save the file as an xlsx. Then that final document will be updated in the powerpoint presentation. </p>\n\n<p>The problem I have is the code will run once and does as it is supposed to do. Then on the next iteration powerpoint crashes. It appears the code keeps a tie to excel and I can't figure out how to sever it at the codes conclusion. Any ideas?</p>\n\n<pre><code>Sub ImportFormatIN3()\n\n\n    Dim MyPath As String\n    Dim TargetFolder As String\n    Dim MyFile As String\n    Dim LatestFile As String\n    Dim latestDate As Date\n    Dim LMD As Date\n\n    'Defined path to reports\n    MyPath = \"R:\\filelocation\\\"\n    TargetFolder = \"C:\\midfilelocation\\FinalIN3.txt\"\n\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n    MyFile = Dir(MyPath &amp; \"*.txt\")\n    If Len(MyFile) = 0 Then\n      Exit Sub\n    End If\n\n    'Find the newest file in the mypath\n    Do While Len(MyFile) &gt; 0\n        LMD = FileDateTime(MyPath &amp; MyFile)\n        If LMD &gt; latestDate Then\n            LatestFile = MyFile\n            latestDate = LMD\n        End If\n        MyFile = Dir\n    Loop\n\n    FileCopy MyPath &amp; LatestFile, TargetFolder\n\n    Dim xlApp As Excel.Application\n    Set xlApp = New Excel.Application\n    xlApp.Workbooks.Add\n    xlApp.Visible = True\n\n\n    'On Error Resume Next\n    With xlApp.ActiveSheet.QueryTables.Add(Connection:=\"TEXT;midfilelocation\\FinalIN3.txt\", Destination:=Range(\"A1\"))\n\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlFixedWidth\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileFixedColumnWidths = Array(4, 10, 10, 9, 18, 15, 23, 32, 12, 5, 7, 13, 9, 6)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n    Rows(\"1:9\").Select\n    Selection.Delete Shift:=xlUp\n    Columns(\"A:A\").Select\n    Selection.Delete Shift:=xlToLeft\n    Rows(\"2:2\").Select\n    Selection.Delete Shift:=xlUp\n    Range(\"M:M,N:N\").Select\n    Range(\"N1\").Activate\n    Selection.Delete Shift:=xlToLeft\n    Columns(\"K:K\").Select\n    Selection.Delete Shift:=xlToLeft\n    Range(\"F20\").Select\n\n\n     Columns(\"D\").EntireColumn.Delete\n     Columns(\"H\").EntireColumn.Delete\n     Columns(\"I\").EntireColumn.Delete\n     Columns(\"G\").EntireColumn.Delete\n     Columns(\"C\").EntireColumn.Delete\n     Columns(\"A\").EntireColumn.Delete\n\n\n     Columns(\"A\").ColumnWidth = 25\n     Columns(\"B\").ColumnWidth = 25\n     Columns(\"C\").ColumnWidth = 30\n     Columns(\"D\").ColumnWidth = 60\n     Columns(\"E\").ColumnWidth = 15\n\n\n     Range(\"A1:E1\").EntireRow.Insert\n     Range(\"A1:E1\").Merge\n     Range(\"A:E\").HorizontalAlignment = xlCenter\n     Range(\"A:E\").Font.Size = 15\n     Range(\"A1\").Font.Size = 30\n     Range(\"A1\").Value = \"IN3 Dispatch as of \" &amp; latestDate\n\n\n    Dim KillConnects As Long\n    With ActiveWorkbook\n        For KillConnects = .Connections.Count To 1 Step -1\n            .Connections(KillConnects).Delete\n        Next KillConnects\n    End With\n\n    ActiveWorkbook.SaveAs FileName:=\"C:\\finalfilelocation\\FinalIN3Document.xlsx\", AccessMode:=xlExclusive, ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges\n\n    ActiveWorkbook.Close\n\n    xlApp.Workbooks.Close\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1548269269, "post_id": 54333749, "comment_id": 95485150, "body": "<code>Range(&quot;A&quot; &amp; I + 3).Value = I</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1548269328, "post_id": 54333749, "comment_id": 95485189, "body": "Do you really want to run this for every change on the sheet?"}, {"owner": {"reputation": 3, "user_id": 2175465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95535826c620fa50a41c4d0ba2f8c9c7?s=128&d=identicon&r=PG", "display_name": "Russ McDaniel", "link": "https://stackoverflow.com/users/2175465/russ-mcdaniel"}, "reply_to_user": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1548276662, "post_id": 54333749, "comment_id": 95488225, "body": "@Kubie Because I need to have the ability to insert rows as needed and keep the lines numbers updated, without having to do as you suggested every time I Inserted."}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1548276716, "post_id": 54333749, "comment_id": 95488243, "body": "@RussMcDaniel  fair point"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2175465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95535826c620fa50a41c4d0ba2f8c9c7?s=128&d=identicon&r=PG", "display_name": "Russ McDaniel", "link": "https://stackoverflow.com/users/2175465/russ-mcdaniel"}, "edited": false, "score": 0, "creation_date": 1548276496, "post_id": 54333866, "comment_id": 95488156, "body": "Thank you.  Worked perfect.  Zero&#39;d out on A4, but no biggie.  I worked around that."}], "tags": [], "owner": {"reputation": 592, "user_id": 7577404, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/682c5ac7d6e758a648c98087663ea705?s=128&d=identicon&r=PG&f=1", "display_name": "MrClean", "link": "https://stackoverflow.com/users/7577404/mrclean"}, "is_accepted": true, "score": 0, "last_activity_date": 1548269561, "creation_date": 1548269561, "answer_id": 54333866, "question_id": 54333749, "link": "https://stackoverflow.com/questions/54333749/number-sequence-starting-in-cell-a1/54333866#54333866", "title": "Number Sequence starting in Cell &lt;&gt; A1", "body": "<pre><code>Sub Worksheet_Change(ByVal Target As Range)\nDim I As Integer\nSet startRng = Cells(4, 1)\n\nApplication.EnableEvents = False\nFor I = 0 To 999\n    startRng.Offset(I, 0) = I\nNext\nRange(\"A1010\").Value = \"\"\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2175465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95535826c620fa50a41c4d0ba2f8c9c7?s=128&d=identicon&r=PG", "display_name": "Russ McDaniel", "link": "https://stackoverflow.com/users/2175465/russ-mcdaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 54333866, "answer_count": 1, "score": 0, "last_activity_date": 1548269561, "creation_date": 1548269093, "last_edit_date": 1548269227, "question_id": 54333749, "link": "https://stackoverflow.com/questions/54333749/number-sequence-starting-in-cell-a1", "title": "Number Sequence starting in Cell &lt;&gt; A1", "body": "<p>Want sequence to start on Cell A4.  so that A4 is 1, A5 is 2 et al to A1004 = 1004</p>\n\n<p>Tried changing [Range(\"A\" &amp; I)..] to [Range(\"A4\" &amp; I)..]\nTried changing I=4</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim I As Integer\n    I = 1\n    Application.EnableEvents = False\n    For I = 1 To 1000\n        Range(\"A\" &amp; I).Value = I\n    Next\n    Range(\"A1010\").Value = \"\"\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548268954, "post_id": 54333575, "comment_id": 95485019, "body": "Are you looking for a faster Sumif function? I suppose you could write a custom sumif function in VBA which stores the 300,000 rows as a 2D array and loop through that. Should be faster than the alternative."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548278056, "post_id": 54333575, "comment_id": 95488765, "body": "I would create a vba macro. Have you done vba before?"}, {"owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "reply_to_user": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548372409, "post_id": 54333575, "comment_id": 95528683, "body": "@HMVBA Thank you for idea. Yes I am trying to store them in a range and will see how that works"}, {"owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "reply_to_user": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548372468, "post_id": 54333575, "comment_id": 95528706, "body": "@IAmNerd2000 Yes I am trying with macros. Thanks for answering"}], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1548395397, "creation_date": 1548395397, "answer_id": 54359624, "question_id": 54333575, "link": "https://stackoverflow.com/questions/54333575/sum-up-multiple-rows-and-columns-value/54359624#54359624", "title": "Sum up multiple rows and columns value", "body": "<p>Here is some code that I worked on to do what you require.  It will look in the <code>rngColToSearch</code> range which should simply be the column of data that holds your Program# names. The <code>rngDataContents</code> range is used to specify where you have numbers for the summation.  The <code>rngOutput</code> is a cell where you want the output to start to be written to.</p>\n\n<p>It will then find and group the rows that contain unique Program #'s. Then, the data for each quarter (week1 through week13, week14 through week26, etc.) will be summed up based on Program#.</p>\n\n<p>Finally, it will output the data starting from a specified region.  </p>\n\n<p>The code is as follows (put in a module):</p>\n\n<pre><code>    Option Explicit\n\n    Private Type udtMatches\n        Name As String\n        RowNums() As Integer\n        Quarters() As Double  '0 to 3\n    End Type\n\n    Private uItems() As udtMatches\n\n    Sub RunIT()\n        mySumIF Range(\"A5:A27\"), Range(\"B5:N27\"), Range(\"G30\")\n    End Sub\n\n    Public Sub mySumIF(rngColToSearch As Range, rngDataContents As Range, rngOutput As Range)\n        Dim intI As Integer\n        Dim intJ As Integer\n        Dim intK As Integer\n        Dim intL As Integer\n        Dim strColValues() As String\n        Dim intInMaxCol As Integer\n        Dim intStartRow As Integer\n        Dim intRows As Integer\n        Dim strTemp As String\n        Dim strCheck As String\n        Dim blnFoundRow As Boolean\n        Dim blnFoundName As Boolean\n        Dim dblSumCols As Double\n        Dim intRow As Integer\n        Dim intCol As Integer\n\n        Dim intNameCnt As Integer\n        Dim intRowCnt() As Integer\n\n        intRows = rngColToSearch.Rows.Count\n\n\n        If intRows &lt;&gt; rngDataContents.Rows.Count Then\n            MsgBox \"Error: You need to select the Searching Column and the Data Contents such that\" &amp; vbCrLf &amp; _\n                   \"  they have the same row count.\", vbOKOnly + vbExclamation, \"Bad Selection\"\n        Else\n            'Dimension the UDT's\n            ReDim uItems(0 To (intRows - 1))\n            ReDim intRowCnt(0 To (intRows - 1))\n            For intI = 0 To (intRows - 1)\n                ReDim uItems(intI).RowNums(0 To (intRows - 1))\n            Next intI\n\n            intNameCnt = 0\n            'We are good, continue\n            For intI = 1 To intRows\n                strTemp = LCase(Trim(rngColToSearch.Cells(intI, 1).Value))\n                If intI = 1 Then\n                    uItems(intNameCnt).Name = Trim(rngColToSearch.Cells(intI, 1).Value)\n                    uItems(intNameCnt).RowNums(intRowCnt(intNameCnt)) = intI\n\n                    intRowCnt(intNameCnt) = intRowCnt(intNameCnt) + 1\n                    intNameCnt = intNameCnt + 1\n                Else\n                    blnFoundName = False\n                    For intJ = 0 To (intNameCnt - 1)\n                        strCheck = LCase(Trim(uItems(intJ).Name))\n                        If strCheck = strTemp Then\n                            blnFoundName = True\n                            'Name is found, now search for Rownumber\n                            blnFoundRow = False\n                            For intK = 0 To (intRowCnt(intJ) - 1)\n                                If uItems(intJ).RowNums(intK) = intI Then\n                                    blnFoundRow = True\n                                    Exit For\n                                End If\n                            Next intK\n                            If Not blnFoundRow Then\n                                'Add it to the list\n                                uItems(intJ).RowNums(intRowCnt(intJ)) = intI\n\n                                intRowCnt(intJ) = intRowCnt(intJ) + 1\n                            End If\n                        End If\n\n                        If blnFoundRow Then Exit For\n                    Next intJ\n\n                    If Not blnFoundName Then\n                        'Add it to the list\n                        uItems(intNameCnt).Name = rngColToSearch.Cells(intI, 1).Value\n                        uItems(intNameCnt).RowNums(intRowCnt(intNameCnt)) = intI\n\n                        intRowCnt(intNameCnt) = intRowCnt(intNameCnt) + 1\n                        intNameCnt = intNameCnt + 1\n                    End If\n                End If\n            Next intI\n\n            ReDim Preserve uItems(0 To (intNameCnt - 1))\n            'Now, redim the udt's\n            For intI = 0 To (intNameCnt - 1)\n                ReDim Preserve uItems(intI).RowNums(0 To intRowCnt(intI) - 1)\n                ReDim Preserve uItems(intI).Quarters(0 To 3)\n            Next intI\n\n\n            'Now, for each 13 weeks we need to add the columns \n            'intI = Quarters\n            For intI = 0 To (intNameCnt - 1)\n\n                For intK = 0 To 3\n                'intJ = Weeks of Quarters\n                    dblSumCols = 0\n                    For intJ = 0 To (intRowCnt(intI) - 1)\n                        For intL = 1 To 13\n                            With rngDataContents\n                                dblSumCols = dblSumCols + \n                                             CDbl(.Cells(uItems(intI).RowNums(intJ),\n                                                   (intK * 13 + intL)).Value)\n                            End With\n                        Next intL\n                    Next intJ\n                    uItems(intI).Quarters(intK) = dblSumCols\n                Next intK\n            Next intI\n\n\n            'Set up the Column and Row Labels\n            intRow = 2\n            intCol = 1\n            For intI = 0 To (intNameCnt - 1)\n                rngOutput.Cells(intRow + intI, intCol).Value = uItems(intI).Name\n            Next intI\n            intRow = 1\n            intCol = 2\n            For intI = 0 To 3\n                rngOutput.Cells(intRow, intI + intCol).Value = \"Q\" &amp; (intI + 1)\n            Next intI\n\n\n            'And finally print out the data.\n            intRow = 2\n            For intI = 0 To (intNameCnt - 1)\n                For intJ = 0 To 3\n                    rngOutput.Cells(intRow + intI, intJ + intCol).Value = \n                        uItems(intI).Quarters(intJ)\n                Next intJ\n            Next intI\n\n        End If\n\n    End Sub\n\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10457463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf5aee4184cc7631f4a53a10ff09783a?s=128&d=identicon&r=PG&f=1", "display_name": "kh999459", "link": "https://stackoverflow.com/users/10457463/kh999459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548395397, "creation_date": 1548268405, "last_edit_date": 1548314862, "question_id": 54333575, "link": "https://stackoverflow.com/questions/54333575/sum-up-multiple-rows-and-columns-value", "title": "Sum up multiple rows and columns value", "body": "<p><a href=\"https://i.stack.imgur.com/BA2Si.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Like the input section shows, I have some projects' resource loading. Each project has multiple rows. Each week's resource loading is a column. </p>\n\n<p>I would like to output a list of projects(each project needs to be in a row) of their quarterly resource loading(column). </p>\n\n<p>Please refer the picture for a better understanding. </p>\n\n<p>Things I ve tried but don't work well:</p>\n\n<ol>\n<li>Pivot table: </li>\n</ol>\n\n<p>Pivot table can help to address the problem quickly but since I have calculations based on the output, pivot table is not stable enough to be embedded into fomulas for calculation</p>\n\n<ol start=\"2\">\n<li>SUMIF(Excel formula or VBA)</li>\n</ol>\n\n<p>I have more than 3000 rows data in input sheet with 100+ projects. Sumif would go through those 3000 rows for each program(that's 300k rows for each column). It works but very ineffecient.</p>\n\n<p>Please let me know for questions</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1548267654, "post_id": 54333217, "comment_id": 95484421, "body": "It actually would be quite helpful if you posted the SQL that you&#39;re using, because you are getting results close to what you&#39;re looking for and it may be that only a slight modification to your existing code is necessary."}, {"owner": {"reputation": 23, "user_id": 4279188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SD2WM.png?s=128&g=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/4279188/josephd"}, "reply_to_user": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1548273875, "post_id": 54333217, "comment_id": 95487129, "body": "Pat--okay, thanks. I&#39;ve attached a version of the pivot query, rewritten to match the sample data. This one returns all the data in one row, but doesn&#39;t insert anything for the blank fields."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4279188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SD2WM.png?s=128&g=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/4279188/josephd"}, "edited": false, "score": 0, "creation_date": 1548277106, "post_id": 54335025, "comment_id": 95488378, "body": "Perfect! That does the job. Thanks, forpas."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1548320582, "post_id": 54335025, "comment_id": 95501381, "body": "As an alternative you can specify fixed column headings in an access crosstab. Some examples are here <a href=\"https://access-programmers.co.uk/forums/showthread.php?t=263759\" rel=\"nofollow noreferrer\">access-programmers.co.uk/forums/showthread.php?t=263759</a> using both IN() and code."}], "tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": true, "score": 1, "last_activity_date": 1548275212, "last_edit_date": 1548275212, "creation_date": 1548274765, "answer_id": 54335025, "question_id": 54333217, "link": "https://stackoverflow.com/questions/54333217/access-sql-pivot-query-that-includes-blank-fields/54335025#54335025", "title": "Access SQL Pivot Query That Includes Blank Fields", "body": "<p>You must group by ID and get the columns with conditional MAX: </p>\n\n<pre><code>SELECT ID,\nMAX(IIF(TypeCode = 'AT', TypeID, NULL)) AS AT,\nMAX(IIF(TypeCode = 'PL', TypeID, NULL)) AS PL,\nMAX(IIF(TypeCode = 'TJ', TypeID, NULL)) AS TJ,\nMAX(IIF(TypeCode = 'NX', TypeID, NULL)) AS NX\nFROM MyTable\nWHERE ID = 329\nGROUP BY ID;\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>ID    AT        PL      TJ     NX\n329   7465      7998    6232    \n</code></pre>\n\n<p>If you remove the WHERE part, the result is:</p>\n\n<pre><code>ID    AT        PL      TJ      NX\n248   3013          \n329   7465      7998    6232    \n477                             1403\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4279188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SD2WM.png?s=128&g=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/4279188/josephd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 54335025, "answer_count": 1, "score": 0, "last_activity_date": 1548275212, "creation_date": 1548267003, "last_edit_date": 1548273745, "question_id": 54333217, "link": "https://stackoverflow.com/questions/54333217/access-sql-pivot-query-that-includes-blank-fields", "title": "Access SQL Pivot Query That Includes Blank Fields", "body": "<p>I'm trying to write an Access SQL pivot query that displays values in a single row for all codes in a table for a given ID value, even if the fields are blank. So far, everything that I've tried has returned either multiple rows or, if the data's on one row, any blank fields get left out.</p>\n\n<p>I've tried this as a pivot query, as a self-join, using IIF, as a union query, and anything else I could think of or find online. </p>\n\n<pre><code>Sample Data:\nID    TypeCode  TypeID\n248    AT       3013\n329    AT       7465\n329    PL       7998\n329    TJ       6232\n477    NX       1403\n\nDesired results on a query of ID 329:\nID      AT      PL      TJ      NX\n329     7465    7998    6232    &lt;blank&gt;\n\nWhat I get: \nID    AT    PL      TJ\n329   7465  7998    6232\n\nor \nID    AT    PL      TJ\n329   7465  \n329         7998\n329                 6232\n\nDesired results on a query of ID 248:\nID    AT     PL       TJ      NX\n248   7465   &lt;blank&gt;  &lt;blank&gt; &lt;blank&gt;\n\nWhat I get:\nID    AT\n248   7465\n\nSample query:\nTRANSFORM Avg(MyTable.[ID]) AS ID\nSELECT MyTable.[ID], TypeCode, TypeID\nFROM MyTable WHERE MyTable.ID = 329\nGROUP BY TypeCode, TypeID\nPIVOT MyTable.TypeCode;\n</code></pre>\n\n<p>I've tried adding IFF statements to the SELECT fields, but no dice.</p>\n\n<p>I'm hoping someone can suggest the right approach I should be using to end up with the desired results shown above. Thanks for any help you can give. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1548266816, "post_id": 54333148, "comment_id": 95484013, "body": "Just for more context, is there a specific reason you went with VBA as opposed to regular conditional formatting?"}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1548267557, "post_id": 54333148, "comment_id": 95484375, "body": "If i use the excel conditional formatting, it fills my empty cells with the highlighted color until data is inputted. At least that&#39;s my experience with some of my other forms using it."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1548267699, "post_id": 54333148, "comment_id": 95484440, "body": "You should be able to avoid that with conditional formatting..."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1548269101, "post_id": 54333148, "comment_id": 95485081, "body": "I tried &quot;Using a formula to determine which cells to format&quot; with the formula =And($I$16:$O$101&lt;&gt;&quot;&quot;,$I$16:$O$101&lt;$L$6) and it doesn&#39;t fill the cells but it also never highlights the cell if its out of spec. What is your suggestion?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1548269450, "post_id": 54333148, "comment_id": 95485244, "body": "<code>=AND(I16&lt;&gt;&quot;&quot;,I16&lt;$L$6)</code>. The rule should apply to the range <code>$I$16:$O$101</code>."}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1548269702, "post_id": 54333148, "comment_id": 95485368, "body": "I second @BigBen With normal conditional formatting and applying the said rules, it works.  Personally, I prefer to use the following formula =IF(A1&lt;$L$6,1,0) because I can control whether the formatting is triggered or not by the condition by simply switching the 1 and 0."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1548270355, "post_id": 54333148, "comment_id": 95485655, "body": "@BigBen, that works! Thanks."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1548282433, "post_id": 54333148, "comment_id": 95490545, "body": "Update, same thing is happening as my macros..."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1548287932, "post_id": 54333148, "comment_id": 95492071, "body": "Are the lowspec/highspec values perhaps <i>text-that-looks-like-a-number</i>?"}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1548348648, "post_id": 54333148, "comment_id": 95518647, "body": "its a vlookup formula, however the cell is formatted as a number."}], "owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548314856, "creation_date": 1548266613, "last_edit_date": 1548314856, "question_id": 54333148, "link": "https://stackoverflow.com/questions/54333148/inconsistent-conditional-formatting", "title": "Inconsistent conditional formatting", "body": "<p>I have a specification range that I want the conditional formatting code to reference and fill the cell with a color (or no color) if the value is out of the specification range. It works with some numbers and not all numbers. For example, if the lowspec range is set to 305 and 305 is inputted into the data cell, it gets highlighted RED as out of spec when it should not be. But if the lowspec range is 299 and 299 is inputted, it does not get highlighted which is exactly what I want. This goes the same with the highspec also.</p>\n\n<p>Keep in mind my lowspec/highspec ranges are being pulled via vlookup so I'm not sure if that's creating the issue? </p>\n\n<p>Hopefully all of this makes sense.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim lowspec As Double, highspec As Double\n\nDim width As Range\n\nDim C As Range\n\nlowspec = Me.Range(\"l6\")\nhighspec = Me.Range(\"p6\")\n\n\nSet width = Intersect(Target, Me.Range(\"i16:o101\"))\n\nApplication.EnableEvents = False\n If Not width Is Nothing Then\n\n    For Each C In width.Cells\n       v = C.Value\n       If Len(v) &gt; 0 Then\n           Select Case v\n               Case Is &lt; lowspec: newcolor = 3\n               Case Is &gt; highspec: newcolor = 45\n           End Select\n       Else\n           newcolor = xlNone\n       End If\n       C.Interior.ColorIndex = newcolor\n    Next C\n End If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "list", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1548266078, "post_id": 54332995, "comment_id": 95483649, "body": "record a macro while doing it manually and you should get the syntax needed"}, {"owner": {"reputation": 393, "user_id": 3811602, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8841b485967578937c8e56b4f0223acf?s=128&d=identicon&r=PG&f=1", "display_name": "solracid", "link": "https://stackoverflow.com/users/3811602/solracid"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1548266191, "post_id": 54332995, "comment_id": 95483719, "body": "Already recorded a macro and the provided code didn&#39;t allow me to change styles :("}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548357682, "post_id": 54332995, "comment_id": 95522950, "body": "Did any of the suggestions posted as an Answer help? If not, why not?"}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 3811602, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8841b485967578937c8e56b4f0223acf?s=128&d=identicon&r=PG&f=1", "display_name": "solracid", "link": "https://stackoverflow.com/users/3811602/solracid"}, "edited": false, "score": 0, "creation_date": 1548762372, "post_id": 54333803, "comment_id": 95650328, "body": "thanks! I didnt attach the created style to the selection"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1548269268, "creation_date": 1548269268, "answer_id": 54333803, "question_id": 54332995, "link": "https://stackoverflow.com/questions/54332995/vb-word-macro-to-set-lists-bulletpoints-style/54333803#54333803", "title": "VB Word macro to set lists bulletpoint&#39;s style", "body": "<p>When you got the <code>ListGalleries.Item(3).ListTemplates(1).ListLevels(1).NumberFormat = ChrW(61485)</code> as a result from your recording, you probably changed the style definition, but never applied it.</p>\n\n<p>If you do the same recording again and examine it, you will hopefully find that it associated that to a style. A line that looks something like <code>.LinkedStyle = \"List Paragraph\"</code>, but perhaps in German.</p>\n\n<p>Work that part in to your existing macro and then, after selecting relevant parts of your document, do a </p>\n\n<pre><code>Selection.Style = ListGalleries.Item(3).ListTemplates(1).ListLevels(1).LinkedStyle\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1548269402, "creation_date": 1548269402, "answer_id": 54333834, "question_id": 54332995, "link": "https://stackoverflow.com/questions/54332995/vb-word-macro-to-set-lists-bulletpoints-style/54333834#54333834", "title": "VB Word macro to set lists bulletpoint&#39;s style", "body": "<p>I was able to record a macro that set up a new list style using the dash character. To create my test, I set up a blank document with 5 paragraphs of text:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EPItO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EPItO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then, from the recorded macro, I created a separate <code>Sub</code> to initialize my new <code>ListTemplate</code> for a list style that uses a dash:</p>\n\n<pre><code>Private Function CreateCustomListStyle(ByRef oDoc As Document) As ListTemplate\n    With ListGalleries(wdBulletGallery).ListTemplates(1).ListLevels(1)\n        .NumberFormat = ChrW(8210)\n        .TrailingCharacter = wdTrailingTab\n        .NumberStyle = wdListNumberStyleBullet\n        .NumberPosition = InchesToPoints(0.5)\n        .Alignment = wdListLevelAlignLeft\n        .TextPosition = InchesToPoints(0.75)\n        .TabPosition = wdUndefined\n        .ResetOnHigher = 0\n        .StartAt = 1\n        With .Font\n            .Bold = wdUndefined\n            .Italic = wdUndefined\n            .StrikeThrough = wdUndefined\n            .Subscript = wdUndefined\n            .Superscript = wdUndefined\n            .Shadow = wdUndefined\n            .Outline = wdUndefined\n            .Emboss = wdUndefined\n            .Engrave = wdUndefined\n            .AllCaps = wdUndefined\n            .Hidden = wdUndefined\n            .Underline = wdUndefined\n            .Color = wdUndefined\n            .Size = wdUndefined\n            .Animation = wdUndefined\n            .DoubleStrikeThrough = wdUndefined\n            .Name = \"Calibri\"\n        End With\n        .LinkedStyle = \"\"\n    End With\n    ListGalleries(wdBulletGallery).ListTemplates(1).Name = \"\"\n    Set CreateCustomListStyle = ListGalleries(wdBulletGallery).ListTemplates(1)\nEnd Function\n</code></pre>\n\n<p>And finally, my test code to select all the paragraphs and make the list:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim oDoc As Document\n    Set oDoc = ThisDocument\n\n    oDoc.Range.Select       'selects all paragraphs\n    Selection.Range.ListFormat.ApplyBulletDefault\n\n    '--- create a list template that uses \"-\"\n    Dim dashTemplate As ListTemplate\n    Set dashTemplate = CreateCustomListStyle(oDoc)\n\n    Selection.Range.ListFormat.ApplyListTemplateWithLevel ListTemplate:= _\n        dashTemplate\nEnd Sub\n</code></pre>\n\n<p>With the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RrsUy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RrsUy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 393, "user_id": 3811602, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8841b485967578937c8e56b4f0223acf?s=128&d=identicon&r=PG&f=1", "display_name": "solracid", "link": "https://stackoverflow.com/users/3811602/solracid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 54333834, "answer_count": 2, "score": 0, "last_activity_date": 1548278811, "creation_date": 1548265967, "last_edit_date": 1548278811, "question_id": 54332995, "link": "https://stackoverflow.com/questions/54332995/vb-word-macro-to-set-lists-bulletpoints-style", "title": "VB Word macro to set lists bulletpoint&#39;s style", "body": "<p>I am setting some text as a list, and it always displays with thick black dots. I am strugling to find how to set the lists starting with \"-\" instead of dots.</p>\n\n<p>Setting the list:</p>\n\n<pre><code>oDoc.Paragraphs.Add() '17\niStartIndex = oDoc.Paragraphs.Count\noDoc.Paragraphs.Last.Range.Text = strUmfang\niEndIndex = oDoc.Paragraphs.Count\n\noDoc.Range( Start := oDoc.Paragraphs(iStartIndex).Range.Start, End := \noDoc.Paragraphs.Last.Range.End ).Select()\n\nSelection.Range.ListFormat.ApplyBulletDefault\n</code></pre>\n\n<p>I tried to set with: \n    ListGalleries.Item(3).ListTemplates(1).ListLevels(1).NumberFormat = ChrW(61485)</p>\n\n<p>It keeps displaying as black dots. Any tips ? Thanks ^^</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1548266255, "post_id": 54332933, "comment_id": 95483749, "body": "since you are referring to word vba object model inside of Excel instance, you will need to refactor your code. Using early binding can help tremendously with this; otherwise, you will have to find the enumeration values for things <code>wdDefaultFirstRecord</code> and such, and refrain from using <code>ActiveDocument</code>. Excel does not now what those things since it&#39;s not in its object model."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548347495, "post_id": 54332933, "comment_id": 95517970, "body": "When asking a question about an error please always provide the <i>line of code</i> that triggers the error."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1548348038, "creation_date": 1548348038, "answer_id": 54351461, "question_id": 54332933, "link": "https://stackoverflow.com/questions/54332933/vba-to-send-word-mail-merge/54351461#54351461", "title": "VBA to send Word Mail Merge", "body": "<p>Since this is running in Excel VBA the code needs to specifically reference what belongs to Word. That means that this line:</p>\n\n<pre><code>With ActiveDocument.MailMerge\n</code></pre>\n\n<p>Needs to be </p>\n\n<pre><code>With wordApp.ActiveDocument.MailMerge\n</code></pre>\n\n<p>Since Excel knows nothing about <code>ActiveDocument</code>. Even better, however, would be to assign an object to the Document when it's opened, rather than rely on <code>ActiveDocument</code>:</p>\n\n<pre><code>Dim wordDoc as Object\nSet wordDoc = wordapp.documents.Open(\"C:\\Users\\me\\Desktop\\hello.docx\", ReadOnly:=True)\nWith wordDoc.MailMerge\n</code></pre>\n\n<p>Once you have that working, you'll get additional error messages for all the enumeration values starting with <code>wd</code>. These, too, belong to Word VBA. Since you're using <code>Object</code> instead of <code>Word.Application</code> for <code>wordapp</code> the code <em>cannot</em> use the <code>wd</code> enumerations - VBA can't look them up. Using <code>Word.Application</code> would mean needing to set a Reference to the Word object model in Tools/References. This can make it difficult if the macro needs to be used by other people with a different (older) version of Office, which is why many code samples for running Word from Excel use <code>Object</code>.</p>\n\n<p>If you want to use <code>Object</code> then you need to replace all the <code>wd</code> enumeration values with their numerical equivalent. <code>wdSendToEmail</code> for example has the value 2, so </p>\n\n<pre><code>.Destination = 2\n</code></pre>\n\n<p>I leave it to you to look up the other values, which is simple enough. Open Word's VBA editor, press F2 to open the object browser, then search each <code>wd</code> value. The numeric equivalent will be at the very bottom of the window when you click on a value.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ef5zt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ef5zt.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 10923791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d780b48f84a99b44e30a82e834bb9cbe?s=128&d=identicon&r=PG&f=1", "display_name": "fireFly", "link": "https://stackoverflow.com/users/10923791/firefly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 956, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548348038, "creation_date": 1548265715, "last_edit_date": 1548314848, "question_id": 54332933, "link": "https://stackoverflow.com/questions/54332933/vba-to-send-word-mail-merge", "title": "VBA to send Word Mail Merge", "body": "<p>When attempting to run this code I get an object required error. I am not sure how to resolve this. </p>\n\n<p>I am trying to run vba from excel to run mail merge in word. </p>\n\n<pre><code>Sub MailMerge()\n    Set wordapp = CreateObject(\"word.Application\")\n    wordapp.documents.Open \"C:\\Users\\me\\Desktop\\hello.docx\", ReadOnly:=True\n    wordapp.Visible = True\n\n\n            With ActiveDocument.MailMerge\n        .Destination = wdSendToEmail\n        .SuppressBlankLines = True\n        With .DataSource\n            .FirstRecord = wdDefaultFirstRecord\n            .LastRecord = wdDefaultLastRecord\n        End With\n        .Execute Pause:=False\n    End With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1548271144, "post_id": 54332917, "comment_id": 95485979, "body": "&quot;Connected&quot; as in accessing the mailbox at any given time? Or as in having the right to access the mailbox as a delegate?"}, {"owner": {"reputation": 11, "user_id": 10957064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e1b0b4124f36b86f79f6eee50000d5?s=128&d=identicon&r=PG&f=1", "display_name": "user10957064", "link": "https://stackoverflow.com/users/10957064/user10957064"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1548271838, "post_id": 54332917, "comment_id": 95486277, "body": "having the right to access"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10957064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e1b0b4124f36b86f79f6eee50000d5?s=128&d=identicon&r=PG&f=1", "display_name": "user10957064", "link": "https://stackoverflow.com/users/10957064/user10957064"}, "edited": false, "score": 0, "creation_date": 1548318969, "post_id": 54340423, "comment_id": 95500589, "body": "Thanks for your answer, it seems to be requiring deeper knowledge than I have, but shows the path.."}, {"owner": {"reputation": 853, "user_id": 8099242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca9542d20c14bebf293aee32ff096a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dhruvil21_04", "link": "https://stackoverflow.com/users/8099242/dhruvil21-04"}, "edited": false, "score": 0, "creation_date": 1548446498, "post_id": 54340423, "comment_id": 95558492, "body": "Hi Dmitry, I need some help with my outlook-vba script. I&#39;ve contacted you because I found you as the best person who can help me. My link is <a href=\"https://superuser.com/questions/1397111/ms-outlook-vba-script-automatic-print-original-email-when-it-gets-undelivered\" title=\"ms outlook vba script automatic print original email when it gets undelivered\">superuser.com/questions/1397111/&hellip;</a>"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 853, "user_id": 8099242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca9542d20c14bebf293aee32ff096a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dhruvil21_04", "link": "https://stackoverflow.com/users/8099242/dhruvil21-04"}, "edited": false, "score": 0, "creation_date": 1548446692, "post_id": 54340423, "comment_id": 95558564, "body": "@Dhruvil21_04 =- what is your question? Did you start a new thread?"}, {"owner": {"reputation": 853, "user_id": 8099242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca9542d20c14bebf293aee32ff096a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dhruvil21_04", "link": "https://stackoverflow.com/users/8099242/dhruvil21-04"}, "edited": false, "score": 0, "creation_date": 1548446815, "post_id": 54340423, "comment_id": 95558608, "body": "My question is in my link. Hope that makes sense."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1548452469, "post_id": 54340423, "comment_id": 95560759, "body": "That was really a programming question, SU is probably a wrong place for it. Start a new thread on SO and I&#39;ll give you a few pointers."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1548310704, "creation_date": 1548310704, "answer_id": 54340423, "question_id": 54332917, "link": "https://stackoverflow.com/questions/54332917/get-list-of-exchange-users-connected-to-a-mailbox/54340423#54340423", "title": "Get list of exchange users connected to a mailbox", "body": "<p>Firstly, you might be better off using <code>Namespace.CreateRecipient</code> / <code>Recipient.Resolve</code> / <code>Recipient.AddressEntry</code> instead of accessing \"Global Address List\" list (the name can be localized).</p>\n\n<p>To figure out which user has delegate access to a particular mailbox, you would need to open the <code>PR_EMS_AB_PUBLIC_DELEGATES</code> property as <code>IMAPITable</code> from the <code>IMailUser</code> object representing the mailbox owner. This would require Extended MAPI (C++ or Delphi), you cannot do that from VBA. If you can use <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a>, it exposes <a href=\"http://www.dimastr.com/redemption/RDOAddressEntry.htm\" rel=\"nofollow noreferrer\">RDOAddressEntry</a>.Delegates collection. RDOAddressEntry object can be retrieved from the <a href=\"http://www.dimastr.com/redemption/rdostore.htm#RDOExchangeMailboxStore\" rel=\"nofollow noreferrer\">RDOExchnageMailboxStore</a>.Owner property. You can also use <a href=\"http://www.dimastr.com/redemption/rdostore.htm#RDOExchangeMailboxStore\" rel=\"nofollow noreferrer\">RDOExchangeMailboxStore</a>.Delegates collection (it uses EWS).</p>\n"}], "owner": {"reputation": 11, "user_id": 10957064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e1b0b4124f36b86f79f6eee50000d5?s=128&d=identicon&r=PG&f=1", "display_name": "user10957064", "link": "https://stackoverflow.com/users/10957064/user10957064"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 54340423, "answer_count": 1, "score": 0, "last_activity_date": 1592693628, "creation_date": 1548265644, "last_edit_date": 1592693628, "question_id": 54332917, "link": "https://stackoverflow.com/questions/54332917/get-list-of-exchange-users-connected-to-a-mailbox", "title": "Get list of exchange users connected to a mailbox", "body": "<p>I need to get the outlook-users that can access to a shared mailbox. I am able to get userdetails with excel-vba code, but this task exceeds my limits.\nIs there a way to get this information programatically? \nI usually do it something like this, but the object I am using don't have a method to return the value I need.\nAny help would be appreciated.</p>\n\n<pre><code>Public Sub listUsers()\n    Dim myolApp As Outlook.Application\n    Dim myNameSpace As Namespace\n    Dim myAddrList As AddressList\n    Dim myAddrEntry As AddressEntry\n    Dim whoIsThis As String\n    Dim exchUser As Outlook.ExchangeUser\n\n    Set myolApp = CreateObject(\"Outlook.Application\")\n    Set myNameSpace = myolApp.GetNamespace(\"MAPI\")\n    Set myAddrList = myNameSpace.AddressLists(\"Global Address List\")\n\n    Dim FullName As String, LastName As String, FirstName As String\n    Dim HomeState As String, PhoneNum As String\n\n    whoIsThis = \"Doe, John\"\n\n    Set myAddrEntry = myAddrList.AddressEntries(whoIsThis)\n    Set exchUser = myAddrEntry.GetExchangeUser\n\n    If Not exchUser Is Nothing Then\n        FirstName = exchUser.FirstName\n        LastName = exchUser.LastName\n        HomeState = exchUser.StateOrProvince\n        PhoneNum = exchUser.BusinessTelephoneNumber\n        test = exchUser.Alias\n        lista2 = exchUser.Alias\n        myemail = exchUser.Address\n        myemail = exchUser.PrimarySmtpAddress        \n        'etc...\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "dao", "recordset"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1548266307, "post_id": 54332895, "comment_id": 95483771, "body": "You make a form that allows them to enter in the field names and types as well as the table name and then from that form you generate the table, much as you are doing here. What specific question do you have?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1548268119, "post_id": 54332895, "comment_id": 95484640, "body": "Make a loop creating fields as long as the user input values."}, {"owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "edited": false, "score": 0, "creation_date": 1548269394, "post_id": 54332895, "comment_id": 95485219, "body": "Yes exactly, the form is actually set up; however, I&#39;m just looking for guidance on how to set up that loop creating fields."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1548322215, "last_edit_date": 1548322215, "creation_date": 1548275918, "answer_id": 54335264, "question_id": 54332895, "link": "https://stackoverflow.com/questions/54332895/add-records-to-recordset-add-fields-to-table/54335264#54335264", "title": "Add Records to Recordset / Add fields to table", "body": "<p>Apparently you already have a 'temp' table (table is permanent but records are temporary) to save user input of field names and types. Open a recordset of those records and loop through recordset. If this is a split database and you want table created in backend, code must set connection to backend, create table, set table link. Example from my db below.</p>\n\n<p>Constant gstrBasePath is declared in a general module header. It is path to folder that holds the frontend and backend files:<br>\n<code>Global Const gstrBasePath = \"\\\\servername\\folderpath\\\"</code></p>\n\n<pre><code>Private Sub tbxTestNum_AfterUpdate()\n\nDim td As TableDef\n\n'check if test table already exists in backend\nFor Each td In DBEngine.OpenDatabase(gstrBasePath &amp; \"\\Data\\LabData.accdb\").TableDefs\n    If td.Name = Me.tbxTestNum Then\n        MsgBox \"Data table for this test already exists in the backend.\"\n        Exit Sub\n    End If\nNext td\nMe.DataField.SetFocus\nDoCmd.GoToRecord , , acNewRec\n\nEnd Sub\n\n\nPrivate Sub btnBuild_Click()\n\nOn Error GoTo err_Proc\n\nDim tdf As TableDef\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim db As DAO.Database\n\nCurrentDb.Execute \"DELETE FROM BuildTable WHERE DataField &lt;&gt; 'LabNum' AND DataField &lt;&gt; 'method'\"\n\nIf IsNull(Me.tbxTestNum) Then\n    MsgBox \"Must enter test number.\", vbCritical, \"Error\"\nElse\n    Set cn = New ADODB.Connection\n    'connect to the backend database\n    cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source='\" &amp; gstrBasePath &amp; \"Data\\LabData.accdb'\"\n    'create the test table\n    cn.Execute \"CREATE TABLE \" &amp; Me.tbxTestNum &amp; \" (LabNum text(12) PRIMARY KEY Not Null, method text(30) Not Null);\"\n\n    'set table link\n    Set tdf = CurrentDb.CreateTableDef(Me.tbxTestNum)\n    tdf.SourceTableName = Me.tbxTestNum\n    tdf.Connect = \"; DATABASE=\" &amp; gstrBasePath &amp; \"Data\\LabData.accdb\"\n    CurrentDb.TableDefs.Append tdf\n\n    Set rs = New ADODB.Recordset\n    rs.Open \"SELECT * FROM BuildTable;\", CurrentProject.Connection, adOpenStatic, adLockPessimistic\n    'must use DAO to set AllowZeroLength property, I don't allow zero length fields and Access defaults to Yes\n    Set db = DBEngine.OpenDatabase(gstrBasePath &amp; \"Data\\LabData.accdb\")\n    While Not rs.EOF\n        If rs!DataField &lt;&gt; \"LabNum\" And rs!DataField &lt;&gt; \"method\" Then\n            'create field in new table\n            cn.Execute \"ALTER TABLE \" &amp; Me.tbxTestNum &amp; \" ADD COLUMN \" &amp; _\n                        rs!DataField &amp; \" \" &amp; IIf(rs!DataType = \"Boolean\", \"Bit\", rs!DataType) &amp; _\n                        IIf(rs!DataType = \"Text\", \"(\" &amp; rs!FieldSize &amp; \")\", \"\") &amp; \";\"\n        End If\n        If rs!DataType = \"Text\" Then\n            'change the AllowZeroLength default Yes to No\n            db.TableDefs(Me.tbxTestNum).Fields(rs!DataField).AllowZeroLength = False\n        ElseIf rs!DataType = \"Number\" Then\n            'make sure number field DefaultValue not set to 0\n            db.TableDefs(Me.tbxTestNum).Fields(rs!DataField).DefaultValue = \"\"\n        End If\n        rs.MoveNext\n    Wend\n\n    rs.Close\n    cn.Close\n    db.Close\n\nEnd If\n\nMe.tbxTestNum.SetFocus\n\nExit_proc:\n    Exit Sub\n\nerr_Proc:\n    MsgBox \"Error encountered in AddDataTable procedure btnBuild_Click - \" &amp; Err &amp; \" : \" &amp; Err.Description\n    Resume Exit_proc\n\nEnd Sub\n</code></pre>\n\n<p>If there are multiple users allowed to run this process, place this table in frontend or save records with user ID and then open recordset filtered to that ID. Also, the DELETE action would have to include this filter.</p>\n\n<p>However, I do not recommend implementing code that allows users to modify db design.</p>\n"}], "owner": {"reputation": 19, "user_id": 8216451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e2e99c4a9093dd787729d56d32bfc1?s=128&d=identicon&r=PG&f=1", "display_name": "Ibra22", "link": "https://stackoverflow.com/users/8216451/ibra22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1548322215, "creation_date": 1548265526, "last_edit_date": 1548269704, "question_id": 54332895, "link": "https://stackoverflow.com/questions/54332895/add-records-to-recordset-add-fields-to-table", "title": "Add Records to Recordset / Add fields to table", "body": "<p>Objective: </p>\n\n<ol>\n<li>Allow the user to create a custom table with X defined fields </li>\n<li>Allow the user to input field names</li>\n</ol>\n\n<p>Right now, the code is able to create a table with 1 column. The idea is to allow the user to create a custom table with x defined fields and also allow the user to define the field names.</p>\n\n<p>The table name is stored in ExportName.\nThe column name is stored in Field1</p>\n\n<pre><code>Dim dbs As DAO.Database\nDim tbl As DAO.TableDef\nDim fld As DAO.Field2\nDim rs As DAO.Recordset2\nDim i As Integer\n\nSet dbs = CurrentDb\nSet tbl = dbs.CreateTableDef(Me.ExportName)\n\nSet fld = tbl.CreateField(Field1, dbInteger)\ntbl.Fields.Append fld\ndbs.TableDefs.Append tbl\n</code></pre>\n\n<p>Given the above objectives, what is an efficient way to set up a loop that reads the different field inputs?</p>\n\n<p>Thanks in advance for your help. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548265705, "post_id": 54332477, "comment_id": 95483479, "body": "Your loop and logic will greatly benefit with a short block of code before the loop to determine where the <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">last row of data</a> exists. Using that <code>lastRow</code> value (plus one) will get you straight to the first unused row to use for the destination. One of the problems your code has is that you&#39;re incrementing the <code>i</code> variable that is automatically incremented by the <code>for loop</code>. Everything will get confused if you do that."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548266143, "post_id": 54332477, "comment_id": 95483689, "body": "In addition to @PeterT &#39;s comment, I would change your for loops to <code>Do While i &lt;= 200</code> and <code>Do While f &lt;= 35</code>. Then, before each relevant loop set <code>i = 3</code> and <code>f = 5</code>. Also, at the last lines of the loops you add the increments of <code>i = i + 1</code> and <code>f = f + 1</code>"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1548266332, "post_id": 54332477, "comment_id": 95483782, "body": "You should NEVER manipulate the iterator within the for-loop."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1548266489, "post_id": 54332477, "comment_id": 95483853, "body": "I&#39;m really trying hard to understand what you are actually trying to achieve. Can you give a better example and show both sheets?"}, {"owner": {"reputation": 5, "user_id": 6798684, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVZ1_b66-qo/AAAAAAAAAAI/AAAAAAAAI9k/JO0uCvCtUAM/photo.jpg?sz=128", "display_name": "Anton", "link": "https://stackoverflow.com/users/6798684/anton"}, "edited": false, "score": 0, "creation_date": 1548267144, "post_id": 54332477, "comment_id": 95484153, "body": "PeterT I will try what you&#39;ve suggested and let you know how I get on, I did initially leave it up to the for loop to increment the &#39;i&#39; and &#39;f&#39; values but it wasn&#39;t doing anything so to get it to work (kind of atleast) I had to add the increments in I felt like it was unnecessary but I&#39;m pretty new to VBA so wasn&#39;t sure if maybe loops just work a little different."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6798684, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVZ1_b66-qo/AAAAAAAAAAI/AAAAAAAAI9k/JO0uCvCtUAM/photo.jpg?sz=128", "display_name": "Anton", "link": "https://stackoverflow.com/users/6798684/anton"}, "edited": false, "score": 0, "creation_date": 1548267634, "post_id": 54333159, "comment_id": 95484413, "body": "Thank you, your code works perfectly to what I was after"}, {"owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "reply_to_user": {"reputation": 5, "user_id": 6798684, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVZ1_b66-qo/AAAAAAAAAAI/AAAAAAAAI9k/JO0uCvCtUAM/photo.jpg?sz=128", "display_name": "Anton", "link": "https://stackoverflow.com/users/6798684/anton"}, "edited": false, "score": 0, "creation_date": 1548267659, "post_id": 54333159, "comment_id": 95484424, "body": "Happy to have helped."}], "tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 0, "last_activity_date": 1548267431, "last_edit_date": 1548267431, "creation_date": 1548266692, "answer_id": 54333159, "question_id": 54332477, "link": "https://stackoverflow.com/questions/54332477/vba-multiple-for-loops-works-right-only-first-two-times/54333159#54333159", "title": "VBA multiple For loops - works right only first two times", "body": "<p>The reason it's working the first and second time is because of this line</p>\n\n<pre><code>If ws.Cells(i, 1).Value &lt;&gt; \"\" Then\n    i = i + 1\nEnd If\n</code></pre>\n\n<p>But, if you'll notice, it's only running once for each iteration. Which means that on a blank sheet, it will evaluate false on the first iteration of the first run and continue, on the first iteration of the second run, it will evaluate true and move down one row to row 4, but on the first iteration of the third run it will also evaluate true and move down to row 4 and then place data starting at <code>ws.Range(ws.Cells(i, 1), ws.Cells(i, 30).End(xlToRight))</code></p>\n\n<p>You need to change your <code>If-End If</code> to a function that will retrieve the last used row in Column A of your data sheet. Additionally, you probably don't need your outer <code>For-Next</code> loop since that's looping through your output sheet and would output the same <code>M5:M35</code> values for every single row.</p>\n\n<p>If I understand your needs correctly, I believe you could utilize this to accomplish what you're looking for</p>\n\n<pre><code>Dim rng As Range\nDim ws As Worksheet\nDim Tws As Worksheet\n\nDim endRow As Long\n\nSet Tws = Worksheets(\"Test\")\nSet ws = Worksheets(\"data\")\n\nendRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\nSet rng = ws.Cells(endRow, 1)\n\nFor f = 5 To 35\n    If Tws.Cells(f, 13).Value &lt;&gt; \"\" Then\n        rng.Value = Tws.Cells(f, 13).Value\n        Set rng = rng.Offset(0, 1)\n    End If\nNext\n</code></pre>\n\n<p>With this, every sequential button click would insert data at a new row, looping through <code>Tws.Cells(f,13)</code> and placing that value in the right-most column by incrementally setting the range.</p>\n"}], "owner": {"reputation": 5, "user_id": 6798684, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JVZ1_b66-qo/AAAAAAAAAAI/AAAAAAAAI9k/JO0uCvCtUAM/photo.jpg?sz=128", "display_name": "Anton", "link": "https://stackoverflow.com/users/6798684/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 54333159, "answer_count": 1, "score": 0, "last_activity_date": 1548314806, "creation_date": 1548263943, "last_edit_date": 1548314806, "question_id": 54332477, "link": "https://stackoverflow.com/questions/54332477/vba-multiple-for-loops-works-right-only-first-two-times", "title": "VBA multiple For loops - works right only first two times", "body": "<p>So I have been working on this little piece of code for a couple of days now and have hit a snag that I just cannot figure out. Basically  I have a nested for loop that is supposed to take values from one Sheet and put them in a data sheet so that those value can be saved and averaged out over time.\nI want the data from the cells M5 - M35 to get put into the data sheet like this: from left to right A3 - AC200, but I also want the loop to stop once the M5 - M35 range runs out of values and when the user next pushes the button to store data I want the loop to start on the next line down.  </p>\n\n<p>So This Spreadsheet is for my work, it is for a Butchery Yield Test and I want it to have it's owned database stored on a hidden sheet that will be averaged out over time so I or others can come back to it and update it every few months to make the averages more accurate and to get a better understanding of the profitability of certain cuts of meat.</p>\n\n<p>I have tried setting the loop values back to their starting values once the loop has filled out all the data which worked and I thought I'd solved the issue until I ran the test multiple time and found that the first and second time work as expected from the third onwards however it <em>doesn't start the loop down at the next row</em> it just continues through the range </p>\n\n<p><a href=\"https://i.stack.imgur.com/Ew5rm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ew5rm.png\" alt=\"Screen capture of what is happening\"></a></p>\n\n<pre><code>Sub subData1()\n\n    Dim rng As Range\n    Dim rcell As Range\n    Dim ws As Worksheet\n    Dim Tws As Worksheet\n\n    Set Tws = Worksheets(\"Test\")\n    Set ws = Worksheets(\"data\")\n\n    For i = 3 To 200 'range is from cell A3 - A200\n\n        'if start cell already has value go down a row\n        If ws.Cells(i, 1).Value &lt;&gt; \"\" Then\n            i = i + 1\n        End If\n\n        'set the range for data sheet\n        Set rng = ws.Range(ws.Cells(i, 1), ws.Cells(i, 30).End(xlToRight))\n\n        For f = 5 To 35\n\n            For Each rcell In rng 'loop through each cell in data sheet range\n\n                If rcell.Value = \"\" Then 'if cell is blank input data\n\n                    If Tws.Cells(f, 13).Value &lt;&gt; \"\" Then\n\n                        'Check the selected Cell has a value\n                        rcell.Value = Tws.Cells(f, 13).Value\n                        f = f + 1\n\n                    End If\n\n                Else\n\n                    If f &gt; 5 Then\n                        MsgBox \"Data Storage Updated\", , \"Data Storage\"\n                        f = 5\n                        Exit Sub\n\n                    'Else\n                        'MsgBox \"Value Must Be Greater Than Zero\", , f\n                        'f = 5\n                        'Exit Sub\n\n                    End If\n\n                End If\n            Next\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1548267038, "creation_date": 1548267038, "answer_id": 54333223, "question_id": 54332455, "link": "https://stackoverflow.com/questions/54332455/how-to-check-for-2-different-values-and-delete-the-text-where-either-of-these-va/54333223#54333223", "title": "How to check for 2 different values and delete the text where either of these values are found?", "body": "<p>It's best to break out repeated code into a sub which has parameters for the variable parts of the operation.</p>\n\n<p>You can do something like this:</p>\n\n<pre><code>Sub Tester()\n    Dim theRange As Range\n    Set theRange = Sheets(\"User Load\").Range(\"E1:E3000\")\n    RemoveTextAfter theRange, \"Ext\"\n    RemoveTextAfter theRange, \"/\"\nEnd Sub\n\nSub RemoveTextAfter(rng As Range, findWhat As String)\n    Dim f As Range\n    If Len(findWhat) = 0 Then Exit Sub\n    Set f = rng.Find(What:=\"Ext\", lookat:=xlPart)\n    Do While Not f Is Nothing\n        f.Value = Split(f.Value, findWhat)(0)\n        Set f = rng.Find(What:=\"Ext\", lookat:=xlPart)\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1548267550, "creation_date": 1548267550, "answer_id": 54333380, "question_id": 54332455, "link": "https://stackoverflow.com/questions/54332455/how-to-check-for-2-different-values-and-delete-the-text-where-either-of-these-va/54333380#54333380", "title": "How to check for 2 different values and delete the text where either of these values are found?", "body": "<p>I'm going to give you two answers for the price of one. :)</p>\n\n<p>At its root, the basic logic you need to figure out if a substring exists in a given string is a standard part of VBA in the <a href=\"https://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow noreferrer\"><code>InStr</code> function</a>. Using this, you can break out your logic to check a cell's value and (conditionally) delete the remainder of the string into a function like this:</p>\n\n<pre><code>Private Function DeleteTextAfter(ByVal contents As String, _\n                                 ByVal token As String) As String\n    '--- searches the given string contents and if it finds the given token\n    '    it deletes the token and all following characters\n    DeleteTextAfter = contents\n\n    Dim pos1 As Long\n    pos1 = InStr(1, contents, token, vbTextCompare)\n    If pos1 &gt; 0 Then\n        DeleteTextAfter = Left(contents, pos1 - 1)\n    End If\nEnd Function\n</code></pre>\n\n<p>Notice here that using the function created above, we don't need to use <code>Range.Find</code> at all.</p>\n\n<p>Once you have that, your top-level logic consists of setting up the range to search. In all of my code, I explicitly create objects to reference the workbook and worksheet so that I can keep things straight. In a simple example like this, it may seem like overkill, but the habit comes in handy when your code gets more involved. So I set up the range like this</p>\n\n<pre><code>Dim thisWB As Workbook\nDim userLoadWS As Worksheet\nSet thisWB = ThisWorkbook\nSet userLoadWS = thisWB.Sheets(\"User Load\")\n\nDim searchRange As Range\nSet searchRange = userLoadWS.Range(\"E1:E3000\")\n</code></pre>\n\n<p>Now the loop just goes through each cell and gets a (potentially) updated value.</p>\n\n<pre><code>Dim cell As Variant\nFor Each cell In searchRange\n    If Not cell.value = vbNullString Then\n        Debug.Print cell.Address &amp; \" = \" &amp; cell.value\n        cell.value = DeleteTextAfter(cell.value, \"Ext\")\n        cell.value = DeleteTextAfter(cell.value, \"/\")\n    End If\nNext cell\n</code></pre>\n\n<p>So your whole solution looks like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestDirectlyFromRange()\n    Dim thisWB As Workbook\n    Dim userLoadWS As Worksheet\n    Set thisWB = ThisWorkbook\n    Set userLoadWS = thisWB.Sheets(\"User Load\")\n\n    Dim searchRange As Range\n    Set searchRange = userLoadWS.Range(\"E1:E3000\")\n\n    Dim cell As Variant\n    For Each cell In searchRange\n        If Not cell.value = vbNullString Then\n            Debug.Print cell.Address &amp; \" = \" &amp; cell.value\n            cell.value = DeleteTextAfter(cell.value, \"Ext\")\n            cell.value = DeleteTextAfter(cell.value, \"/\")\n        End If\n    Next cell\nEnd Sub\n\nPrivate Function DeleteTextAfter(ByVal contents As String, _\n                                 ByVal token As String) As String\n    '--- searches the given string contents and if it finds the given token\n    '    it deletes the token and all following characters\n    DeleteTextAfter = contents\n\n    Dim pos1 As Long\n    pos1 = InStr(1, contents, token, vbTextCompare)\n    If pos1 &gt; 0 Then\n        DeleteTextAfter = Left(contents, pos1 - 1)\n    End If\nEnd Function\n</code></pre>\n\n<p>But wait, there's more!!</p>\n\n<p>You're iterating over 3,000 rows of data. That can get to be slow if all those rows are filled or if you increase the number of rows to search. To speed up the search, the answer is to copy the data in the range to a <a href=\"https://excelmacromastery.com/excel-vba-array/#Reading_from_a_Range_of_Cells_to_an_Array\" rel=\"nofollow noreferrer\">memory-based array</a> first, modify any of the data, then copy the results back. This example uses the same <code>Function DeleteTextAfter</code> as above and is much quicker. Use whichever one fits your situation best.</p>\n\n<pre><code>Public Sub TestRangeInArray()\n    Dim thisWB As Workbook\n    Dim userLoadWS As Worksheet\n    Set thisWB = ThisWorkbook\n    Set userLoadWS = thisWB.Sheets(\"User Load\")\n\n    '--- create the range and copy into a memory array\n    Dim searchRange As Range\n    Dim searchData As Variant\n    Set searchRange = userLoadWS.Range(\"E1:E3000\")\n    searchData = searchRange.value\n\n    Dim i As Long\n    For i = LBound(searchData, 1) To UBound(searchData, 1)\n        If Not searchData(i, 1) = vbNullString Then\n            searchData(i, 1) = DeleteTextAfter(searchData(i, 1), \"Ext\")\n            searchData(i, 1) = DeleteTextAfter(searchData(i, 1), \"/\")\n        End If\n    Next i\n\n    '--- now copy the modified array back to the worksheet range\n    searchRange.value = searchData\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 1, "last_activity_date": 1548268450, "last_edit_date": 1548268450, "creation_date": 1548268137, "answer_id": 54333513, "question_id": 54332455, "link": "https://stackoverflow.com/questions/54332455/how-to-check-for-2-different-values-and-delete-the-text-where-either-of-these-va/54333513#54333513", "title": "How to check for 2 different values and delete the text where either of these values are found?", "body": "<p>This code should work. It is simple to read and easy to understand.</p>\n\n<pre><code>    Option Explicit\n\n    'The calling Sub\n    Sub main()\n        DeleteTextFromColumn ActiveSheet.Range(\"E1:E3000\")\n    End Sub\n\n    Sub DeleteTextFromColumn(ByRef inRange As Range)\n\n        Dim cCell As Range\n        Dim intPos1 As Integer\n        Dim intPos2 As Integer\n        Dim strTemp As String\n        Dim strOut As String\n\n        'You can specify which column if more than one column is provided to the\n        '  subroutine. Ex: Range(\"E1:F3000\")\n        For Each cCell In inRange.Columns(1).Cells\n            strTemp = cCell.Value\n            'gets the position of \"ext\" (case insensitive)\n            intPos1 = InStr(LCase(strTemp), \"ext\")\n            'gets the position of \"/\"\n            intPos2 = InStr(strTemp, \"/\")\n\n            strOut = strTemp\n            If intPos1 &gt; 1 Then\n                strOut = Mid(strTemp, 1, intPos1 - 1)\n            ElseIf intPos2 &gt; 1 Then\n                strOut = Mid(strTemp, 1, intPos2 - 1)\n            End If\n\n            'Outputs the results\n            cCell.Value = strOut\n        Next\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10945590, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QOAl39wY4GQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbtvniudz3Rdh9JA46OntLMB1jo5A/mo/photo.jpg?sz=128", "display_name": "Alex Webb", "link": "https://stackoverflow.com/users/10945590/alex-webb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 54333513, "answer_count": 3, "score": 2, "last_activity_date": 1548268450, "creation_date": 1548263878, "last_edit_date": 1548265891, "question_id": 54332455, "link": "https://stackoverflow.com/questions/54332455/how-to-check-for-2-different-values-and-delete-the-text-where-either-of-these-va", "title": "How to check for 2 different values and delete the text where either of these values are found?", "body": "<p>I want to find \"Ext\" and \"/\" in a column of data and delete all the text after and including those characters\nIf it doesn't find those characters in my data then exit the sub</p>\n\n<p>I can do them separately but I definitely over complicated it, there must be an easier way</p>\n\n<p>The data column will also have blanks in so I have to avoid blank cells and check the whole range of data</p>\n\n<p>Code</p>\n\n<pre><code>Sub DeleteAfterText()\n    Dim rngFoundCell As Range\n    Set rngFoundCell = Sheets(\"User Load\").Range(\"E1:E3000\").Find(What:=\"Ext\")\n    'This is checking to see if the range contains EXT, if not it exits the sub'\n    If rngFoundCell Is Nothing Then 'If no cell in the range has an ' then exist sub\n        Exit Sub\n    Else\n        Worksheets(\"User Load\").Range(\"E1000\").Select 'Start from bottom'\n        Selection.End(xlUp).Select  'This selects the bottom to the top'\n        Do Until ActiveCell.Value = \"Phone Number\"    'This does the change until it reaches the header name'\n            If ActiveCell.Value = \"\" Then     'If the cell is blank it skips it as there is no action after the then'\n            Else\n                ActiveCell = Split(ActiveCell.Value, \"Ext\")(0)\n                'ActiveCell = Split(ActiveCell.Value, \"/\")(0)\n            End If\n            ActiveCell.Offset(-1, 0).Select\n        Loop    \n    End If\nEnd Sub\n\nSub DeleteAfterText2()\n    Dim rngFoundCell As Range\n    Set rngFoundCell = Sheets(\"User Load\").Range(\"E1:E3000\").Find(What:=\"/\")\n    'This is checking to see if the range contains EXT, if not it exits the sub'\n    If rngFoundCell Is Nothing Then 'If no cell in the range has an ' then exist sub\n    Exit Sub\n    Else\n        Worksheets(\"User Load\").Range(\"E1000\").Select 'Start from bottom'\n        Selection.End(xlUp).Select  'This selects the bottom to the top'\n        Do Until ActiveCell.Value = \"Phone Number\"    'This does the change until it reaches the header name'\n            If ActiveCell.Value = \"\" Then     'If the cell is blank it skips it as there is no action after the then'\n            Else\n                ActiveCell = Split(ActiveCell.Value, \"/\")(0)\n            End If\n            ActiveCell.Offset(-1, 0).Select\n        Loop    \n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "ms-word", "office365"], "answers": [{"tags": [], "owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1548266525, "creation_date": 1548266525, "answer_id": 54333132, "question_id": 54332352, "link": "https://stackoverflow.com/questions/54332352/ms-word-2016-macro-regex-replace/54333132#54333132", "title": "MS Word 2016 Macro Regex Replace", "body": "<p>The Find functionality provide only a very limited support to the regular expressions. You need to use <code>VBScript.Regexp</code> as shown below.</p>\n\n<p>Try this Code:</p>\n\n<pre><code>Sub RemoveQuestionTopic()\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n\n    strReplacementText = \"++__++\"\n    ActiveDocument.Select\n    Set objReg = CreateObject(\"VBScript.Regexp\")\n    objReg.Pattern = \"\\s*\\(Topic\\s*\\d+\\)\"\n    objReg.Global = True\n    Selection.Text = objReg.Replace(Selection.Text, strReplacementText)\n\n    With Selection.Find\n        .MatchWildcards = True\n        .Text = strReplacementText\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = True\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n\n<p><strong><a href=\"https://regex101.com/r/zMGSnq/1\" rel=\"nofollow noreferrer\">Regex Demo</a></strong></p>\n"}, {"comments": [{"owner": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1548268925, "post_id": 54333392, "comment_id": 95485006, "body": "Certainly better solution than mine. +1. Can you also provide some link for reference from where I can learn more about word regexp syntax?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 1, "creation_date": 1548269425, "post_id": 54333392, "comment_id": 95485230, "body": "<a href=\"https://superuser.com/questions/86397/wildcards-in-word\">superuser.com/questions/86397/wildcards-in-word</a> contains a lot of information and good links"}, {"owner": {"reputation": 921, "user_id": 1655774, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4cd6578354eba1f6bc4de61217763e16?s=128&d=identicon&r=PG&f=1", "display_name": "aadi1295", "link": "https://stackoverflow.com/users/1655774/aadi1295"}, "reply_to_user": {"reputation": 8926, "user_id": 5331061, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/g1Sv2.jpg?s=128&g=1", "display_name": "Gurmanjot Singh", "link": "https://stackoverflow.com/users/5331061/gurmanjot-singh"}, "edited": false, "score": 0, "creation_date": 1548274927, "post_id": 54333392, "comment_id": 95487519, "body": "Thanks for your help, it worked like a charm. Since this is a better solution as @Gurman also agreed. I am marking this one the right answer. Thanks again"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1548307933, "post_id": 54333392, "comment_id": 95496132, "body": "You could reduce that further, to: .Text = &quot;&#40;Topic [0-9]@&#41;&quot;. For more on <i>wildcards</i> in Word, see: <a href=\"https://wordmvp.com/FAQs/General/UsingWildcards.htm\" rel=\"nofollow noreferrer\">wordmvp.com/FAQs/General/UsingWildcards.htm</a> And, if the number following &#39;Topic&#39; is only ever a single digit, you don&#39;t even need <i>wildcards</i> - just (Topic ^#)."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1548309141, "post_id": 54333392, "comment_id": 95496500, "body": "Forum swallows backslashes - .Text = &quot;\\&#40;Topic [0-9]@\\&#41;&quot;"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 2, "last_activity_date": 1548267604, "creation_date": 1548267604, "answer_id": 54333392, "question_id": 54332352, "link": "https://stackoverflow.com/questions/54332352/ms-word-2016-macro-regex-replace/54333392#54333392", "title": "MS Word 2016 Macro Regex Replace", "body": "<p>The regexp syntax differs from normal regexp. If you replace your expression with this:</p>\n\n<pre><code>.Text = \"\\(Topic ([0-9]@&gt;)\\)\"\n</code></pre>\n\n<p>you will get the expected result. No need to use VBScript.Regexp in this case.</p>\n"}], "owner": {"reputation": 921, "user_id": 1655774, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4cd6578354eba1f6bc4de61217763e16?s=128&d=identicon&r=PG&f=1", "display_name": "aadi1295", "link": "https://stackoverflow.com/users/1655774/aadi1295"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 1, "accepted_answer_id": 54333392, "answer_count": 2, "score": 1, "last_activity_date": 1548278415, "creation_date": 1548263447, "last_edit_date": 1548278415, "question_id": 54332352, "link": "https://stackoverflow.com/questions/54332352/ms-word-2016-macro-regex-replace", "title": "MS Word 2016 Macro Regex Replace", "body": "<p>I am trying to code a macro using <code>Regex</code> and my pattern is <code>\\(\\bTopic \\d+\\b\\)</code> and macro should remove <strong>(Topic 1)</strong> and <strong>(Topic 2)</strong> from all questions in the whole document, but my macro code is not working. Thanks for your help.</p>\n\n<p><strong>Input:</strong></p>\n\n<p>QUESTION NO: 1 (Topic 1)</p>\n\n<p>QUESTION NO: 15 (Topic 2)</p>\n\n<p><strong>Result should be</strong> </p>\n\n<p>QUESTION NO: 1</p>\n\n<p>QUESTION NO: 15</p>\n\n<p><strong>Macro Code</strong></p>\n\n<pre><code>Sub RemoveQuestionTopic()\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = \"\\(\\bTopic \\d+\\b\\)\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = True\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548264748, "post_id": 54332342, "comment_id": 95483081, "body": "Getting the logic and requirements for <b>what</b> your macro needs to do is the important first step. For posting a question here, the next step is to re-frame your question with the guidelines in creating a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a>. You&#39;ll get all the help you need."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548268105, "post_id": 54332342, "comment_id": 95484635, "body": "What version of Excel are you using?  For later versions you can directly access the conditional format colour.  For earlier versions you have to recode the conditions."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 0, "last_activity_date": 1548495518, "last_edit_date": 1548495518, "creation_date": 1548272592, "answer_id": 54334556, "question_id": 54332342, "link": "https://stackoverflow.com/questions/54332342/hiding-more-than-one-column-based-on-cell-color/54334556#54334556", "title": "Hiding more than one column based on cell color", "body": "<p>Please try checking the <code>DisplayFormat</code> like this:</p>\n\n<pre><code>Private Sub HideRedFilledColumnPairs()\n    Dim ws As Worksheet\n    Dim lastRow As Long, lastColumn As Long\n    Dim r As Long, c As Long\n\n    Set ws = ActiveSheet\n\n    ' get the used range\n    lastRow = ws.Cells.Find(What:=\"*\", LookIn:=xlFormulas, _\n        SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    lastColumn = ws.Cells.Find(What:=\"*\", LookIn:=xlFormulas, _\n        SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n\n    ' loop your columns row by row\n    For c = ws.Range(\"I:I\").Column To ws.Range(\"HC:HC\").Column ' or To lastColumn\n        For r = 1 To lastRow\n            If ws.Cells(r, c).DisplayFormat.Interior.Color = vbRed Then\n                ws.Columns(c).EntireColumn.Hidden = True\n                ws.Columns(c - 1).EntireColumn.Hidden = True\n                Exit For    ' take next column\n            End If\n        Next r\n    Next c\n\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10957049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b5d47645b7a09d1c8193d54623bdc4?s=128&d=identicon&r=PG&f=1", "display_name": "M Mills", "link": "https://stackoverflow.com/users/10957049/m-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 54334556, "answer_count": 1, "score": 0, "last_activity_date": 1548495518, "creation_date": 1548263396, "last_edit_date": 1548314799, "question_id": 54332342, "link": "https://stackoverflow.com/questions/54332342/hiding-more-than-one-column-based-on-cell-color", "title": "Hiding more than one column based on cell color", "body": "<p>I have a very large spreadsheet with conditional formatting that turns a cell red (color 255) if certain parameters are true. This part is working fine. </p>\n\n<p>My issue is that I am trying to write a macro to hide the entire column and the entire column to the left of it if there is a cell in the first column that has a red cell in it. For example, if column N has a red cell in it, it will hide column N and column M. This inquiry will need to be run for all columns \"I:HC\" (like I said, it is a giant spreadsheet.) I will be associating this macro with a Form Control Button so that when the button is activated, the columns will hide. </p>\n\n<p>Any ideas would be greatly appreciated.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1548263653, "post_id": 54332282, "comment_id": 95482641, "body": "Remove the extra leading and trailing quote."}, {"owner": {"reputation": 1, "user_id": 10946468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1cf392e3a96cdc8f3e92bbaa5b907a?s=128&d=identicon&r=PG&f=1", "display_name": "monkey1009", "link": "https://stackoverflow.com/users/10946468/monkey1009"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1548263905, "post_id": 54332282, "comment_id": 95482759, "body": "I tried that but it doesn&#39;t solve the main issue where the variable names no longer reference the variable values anymore"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1548264558, "creation_date": 1548264558, "answer_id": 54332629, "question_id": 54332282, "link": "https://stackoverflow.com/questions/54332282/converting-formula-to-string/54332629#54332629", "title": "Converting formula to string", "body": "<p>In VBA <code>\"</code> serves as a delimiter for <em>string literals</em>, like this:</p>\n\n<pre><code>Dim foo As String\nfoo = \"some string\"\n</code></pre>\n\n<p>If your string literal needs to contain <code>\"</code> double quotes, you need to <em>escape</em> them, by doubling them up <em>between the string delimiters</em>:</p>\n\n<pre><code>foo = \"\"\"some string\"\"\"\n</code></pre>\n\n<p>Printing the above would yield <code>\"some string\"</code>, <em>including</em> the double quotes.</p>\n\n<p>So you <em>do</em> need to <a href=\"https://stackoverflow.com/questions/54332282/converting-formula-to-string#comment95482641_54332282\">remove the leading &amp; trailing double quotes</a>.</p>\n\n<pre><code>sformula = \"=IF(K2 = 100, \"\"#NA\"\", IF(K2 &lt;\" &amp; minfee &amp; \",\" &amp; feetier3 &amp; \",IF(K2&lt;\" &amp; feetier4 &amp; \",K2+ \" &amp; bpspread1 &amp; \",IF(K2&lt;\" &amp; feetier5 &amp; \",K2+ \" &amp; bpspread2 &amp; \",K2+ \" &amp; bpspread3 &amp; \"))))\"\n</code></pre>\n\n<p>Breaking this down, it's a concatenation of the following literals:</p>\n\n<ul>\n<li><code>\"=IF(K2 = 100, \"\"#NA\"\", IF(K2 &lt;\"</code> (note, <code>\"#NA\"</code> is a bad idea IMO. Use the <code>NA()</code> function to yield an actual worksheet error instead of a string value that <em>looks</em> like one)</li>\n<li><code>\",\"</code></li>\n<li><code>\",IF(K2&lt;\"</code></li>\n<li><code>\",K2+ \"</code></li>\n<li><code>\",IF(K2&lt;\"</code></li>\n<li><code>\",K2+ \"</code></li>\n<li><code>\",K2+ \"</code></li>\n<li><code>\"))))\"</code></li>\n</ul>\n\n<p>Which looks right to me.</p>\n\n<p>Arguably, such concatenation is annoyingly confusing. A custom <a href=\"https://stackoverflow.com/questions/14534360/implementing-string-format-in-vb6/14534361#14534361\">StringFormat</a> function can help mitigate this, by abstracting away the concatenations:</p>\n\n<pre><code>sFormula = StringFormat(\"=IF(K2=100, \"\"#NA\"\", IF(K2&lt;{0},{1},IF(K2&lt;{2},K2+{3},IF(K2&lt;{4},K2+{5},K2+{6}\", _\n    minfee, feetier3, feetier4, bpspread1, feetier5, bpspread2, bpspread3)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10946468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1cf392e3a96cdc8f3e92bbaa5b907a?s=128&d=identicon&r=PG&f=1", "display_name": "monkey1009", "link": "https://stackoverflow.com/users/10946468/monkey1009"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548264558, "creation_date": 1548263149, "question_id": 54332282, "link": "https://stackoverflow.com/questions/54332282/converting-formula-to-string", "title": "Converting formula to string", "body": "<p>I have the following formula that I am inputting in a function.  </p>\n\n<pre><code>dim minfee, feetier3, feetier4, feetier5, bpspread1, bpsread2, bpspread3 as double\n\ncall insformulaincell(\"=IF(K2 = 100, \"\"#NA\"\", IF(K2 &lt;\" &amp; minfee &amp; \",\" &amp; feetier3 &amp; \",IF(K2&lt;\" &amp; feetier4 &amp; \",K2+ \" &amp; bpspread1 &amp; \",IF(K2&lt;\" &amp; feetier5 &amp; \",K2+ \" &amp; bpspread2 &amp; \",K2+ \" &amp; bpspread3 &amp; \"))))\")\n\n'all the function does is paste the formula into a cell \n'How would I format the formula so that it can be stored as a single string?\n'Ex:\n\ndim sFormula as string \n\nsformula = \"\"=IF(K2 = 100, \"\"#NA\"\", IF(K2 &lt;\" &amp; minfee &amp; \",\" &amp; feetier3 &amp; \",IF(K2&lt;\" &amp; feetier4 &amp; \",K2+ \" &amp; bpspread1 &amp; \",IF(K2&lt;\" &amp; feetier5 &amp; \",K2+ \" &amp; bpspread2 &amp; \",K2+ \" &amp; bpspread3 &amp; \"))))\"\"\n\ncall insformulaincell(sFormula)\n</code></pre>\n\n<p>The main issue is that the variables such as minfee would not reference its actual values but instead have the actual string variable name appear.</p>\n\n<p>Ex: \"... If(K2 &lt;\" &amp; minfee &amp; \",\" ... )\nas opposed to \n\"... If(K2 &lt; 1) ...\" ' assuming that minfee = 1</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1561200146, "post_id": 54332281, "comment_id": 99991727, "body": "Now it&#39;s supported by Microsoft VBA. You can use <code>If Not Cells(xrow, xcol).CommentThreaded Is Nothing Then</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": true, "score": 4, "last_activity_date": 1561200063, "last_edit_date": 1561200063, "creation_date": 1551890068, "answer_id": 55027979, "question_id": 54332281, "link": "https://stackoverflow.com/questions/54332281/checking-threaded-comments/55027979#55027979", "title": "Checking Threaded Comments", "body": "<p>As of May 15th 2019 the new object <code>CommentThreaded</code> is described by <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.commentthreaded\" rel=\"nofollow noreferrer\">Microsoft</a>.<br>\nIn my Excel version 1906, it's fully supported in VBA.</p>\n\n<p>Your assumed <code>If Range.CommentThreaded Is Nothing</code> works.</p>\n\n<p>Here's some code to play with:</p>\n\n<pre><code>Private Sub ExcelsNewCommentThreaded()\n    Dim AllCommentsThreaded As Excel.CommentsThreaded\n    Dim OneCommentThreaded As Excel.CommentThreaded\n    Dim AllReplies As Excel.CommentsThreaded\n    Dim OneReply As Excel.CommentThreaded\n    Dim r As Range\n\n    Set AllCommentsThreaded = ActiveSheet.CommentsThreaded\n\n    ' loop over all threaded comments of a worksheet and get their info\n    For Each OneCommentThreaded In AllCommentsThreaded\n        With OneCommentThreaded\n            Debug.Print .Author.Name, .Date, .Text\n            For Each OneReply In .Replies\n                With OneReply\n                    Debug.Print .Author.Name, .Date, OneReply.Text\n                End With\n            Next OneReply\n        End With\n    Next OneCommentThreaded\n\n    Set r = Selection.Cells(1)\n\n    ' check if the selected cell already contains a threaded comment\n    If r.CommentThreaded Is Nothing Then\n        r.AddCommentThreaded (\"my new comment\")\n    End If\n\n    With r.CommentThreaded\n        ' get text of comment\n        Debug.Print .Text\n\n        ' add some replies\n        .AddReply (\"my reply 1\")\n        .AddReply (\"my reply 2\")\n\n        ' change text of comment\n        Debug.Print .Text(Text:=\"text of comment changed\")\n        Debug.Print .Text\n\n        ' change text of a reply\n        .Replies(1).Text Text:=\"text of reply 1 changed\"\n        Debug.Print .Replies(1).Text\n\n        ' delete second reply\n        .Replies(2).Delete\n\n        ' delete whole comment including its replies\n        .Delete\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9120260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcfac6f1258d7bc71377fd7ce5dc6d2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike T", "link": "https://stackoverflow.com/users/9120260/mike-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2465, "favorite_count": 2, "accepted_answer_id": 55027979, "answer_count": 1, "score": 6, "last_activity_date": 1561200063, "creation_date": 1548263143, "question_id": 54332281, "link": "https://stackoverflow.com/questions/54332281/checking-threaded-comments", "title": "Checking Threaded Comments", "body": "<p>My office just upgraded to a new version of Office 365, and with it came a new way that comments are done. The old comments are now referred to as \"notes\" and the new comments are now called \"comments\". </p>\n\n<p>In one of my workbooks, I have a button that, when clicked, will look through certain cells to check whether there is a comment or not. It will then color the cell based on what it finds.</p>\n\n<p>(my full code for the button is posted below)\nLine 9 contains the issue</p>\n\n<p>In previous versions of Excel, this button worked just fine. However, now it only works if the cells have \"notes\" and does not work if they have \"comments\". In my code, the class that I had been using was called \"Comment\", so my code was something along the lines of \"If Cells(row, col).Comment Is Nothing...\". This class still works, but only looks for notes. I have looked through the Object Library and under the hidden objects, I found a new class called \"CommentThreaded\". I tried changing my code to that (\"If Cells(row, col).CommentThreaded Is Nothing...\") but it does not work. When I click the button, I now get a run-time error: applictaion-defined or object-defined error when it tries to access this new class.</p>\n\n<p>Does anyone know what I need to change to get my button to work with threaded comments?</p>\n\n<p>Thanks,\nMike</p>\n\n<pre><code>Sub Comments()\nDim xrow As Integer\nDim xcol As Integer\n\nFor xrow = 7 To 88\n    For xcol = 3 To 15\n        If Cells(xrow, xcol).Value &lt;= -0.1 Or Cells(xrow, xcol).Value &gt;= 0.1 Then\n            If Cells(5, xcol).Value = \"MTD %\" Or Cells(5, xcol).Value = \"YTD %\" Then\n                If Not Cells(xrow, xcol).Comment Is Nothing Then\n                    Cells(xrow, xcol).Interior.Color = RGB(155, 255, 188)\n                Else\n                    Cells(xrow, xcol).Interior.Color = RGB(255, 255, 0)\n                End If\n            End If\n        End If\n    Next xcol\nNext xrow\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548268373, "post_id": 54331978, "comment_id": 95484756, "body": "please include your current coding attempts. Are you saying that during your automation you perform a click which opens a filedialog? Have you looked at FindWindow? <a href=\"https://stackoverflow.com/a/52906215/6241235\">stackoverflow.com/a/52906215/6241235</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1548346626, "post_id": 54331978, "comment_id": 95517387, "body": "Scratch the IE2: IE2.document.getElementById -&gt; document.getElementById"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1548352185, "post_id": 54331978, "comment_id": 95520510, "body": "Thanks peakpeak.  But unfortunately that will trigger the &quot;Object Required&quot; error.  IE2 is the IE object."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1548352275, "post_id": 54331978, "comment_id": 95520559, "body": "Qharr - no.  I don&#39;t know about findwindow.  But I&#39;ll certainly look it up.  Thanks for the tip!"}], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548345854, "creation_date": 1548262027, "last_edit_date": 1548345854, "question_id": 54331978, "link": "https://stackoverflow.com/questions/54331978/vba-link-to-an-already-open-web-based-file-dialog-box", "title": "VBA Link to an already open web-based file dialog box", "body": "<p>I have a company intranet site that opens a file dialog box (when a input box is clicked) to allow the user to select a file to upload to our main system.  Clicking \"OK\" after selecting a file closes the filedialog box and puts the files location into the input box.  I've searched the thread 35411826, which looks like a good answer for some applications - but it does not solve my distinct problem.  Our system does more than simply accept an uploaded file.  It generates codes for the uploaded file and enters it into several subsystems.</p>\n\n<p>I'd like to automate this by controlling the already opened file dialog box.  I've attempted to fill the input box with the location of the file but it does not work.  The input box must be clicked on to open the file dialog box, which I can do with the .click command.</p>\n\n<p>Here is the html for the element:</p>\n\n<pre><code>&lt;input id=\"fileToUploadNewDoc\" type=\"file\" size=\"50\"&gt;\n</code></pre>\n\n<p>I imagine the type \"file\" initiates the element to open a file dialogue box when clicked.  I don't know.  But that's what happens when the input box is clicked.</p>\n\n<p>How can I locate the open filedialog box and set it to an object variable that would allow me to select a file and click the \"OK\" button to fill the element with the file location?</p>\n\n<p><strong>Update 01-24-2019</strong>:  I was asked to provide more coding/explanation.</p>\n\n<p>Briefly:</p>\n\n<p>I have a popup webpage set to the variable IE2.\nThere is an HTML input box on this page with ID of \"fileToUploadNewDoc\"\nHere is the HTML code of the document:</p>\n\n<pre><code>&lt;div class=\"span12\"&gt;\n    &lt;div class=\"control-group\"&gt;\n        &lt;label class=\"control-label\" for=\"selectDocumentType\"&gt;File to Upload&lt;/label&gt;\n        &lt;input id=\"fileToUploadNewDoc\" type=\"file\" size=\"50\"&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is an image of the input box:\n<a href=\"https://i.stack.imgur.com/SCk5M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SCk5M.png\" alt=\"Image of Input Box on Web Page\"></a></p>\n\n<p>You can see that a \"Browse\" button has been added to the input box.  This is not an actual button, but is placed there by javascript, css, or something.  Clicking anywhere in the input box causes a filedialog browsing box to open.</p>\n\n<p>As I said earlier, I attempted to bypass the \"Browse\" box by filling the input box directly with the location of the file, as shown below:</p>\n\n<pre><code>IE2.document.getElementById(\"fileToUploadNewDoc\").Value = \"C:\\Users\\nunYa\\Documents\\My Scans\\Current Scans\\PSA_ABC-54596900.pdf\"\n</code></pre>\n\n<p>But it does not put the location into the input box. In fact nothing happens.</p>\n\n<p>I have also tried:</p>\n\n<pre><code>IE2.document.parentWindow.execScript \"$('#fileToUploadNewDoc').val('C:\\Users\\nunYa\\Documents\\My Scans\\Current Scans\\PSA_ABC-54596900.pdf').trigger('change')\"\n</code></pre>\n\n<p>But to no avail.  This does not work to put the document location into the input box either.</p>\n\n<p>The only way to interact with this input box (so far as I know) is to click on it, which causes a filedialog box to open for the user to select a folder and file's location to put into the input box when the \"OK\" button on the filedialog box is clicked.  In my simple mind I think that I must assign the open filedialog box to an object variable to programmatically choose a file and click \"OK\" on the filedialog box.</p>\n\n<p>Generally when a programmer opens a filedialog box he can assign it to an object variable. (There are a thousand examples of that on the internet.)   That gives the programmer the ability to control the filedialog box. ie, Select folders and files and to close the filedialog box.</p>\n\n<p>In this case, the website opens the filedialog box, not me the programmer, so I don't have it set to an object variable and therefore can not control it.  I need to be able to find the filedialog box and set it to an object variable in order to control it.  I don't know how to explain that more simply.  I'm sorry if it's confusing.</p>\n\n<p>I also did check out thread 35411826 on controlling dialog boxes.  But that thread's answer is not to control the dialog box but rather it explains how to upload a file directly to some website's folder innocuously.  As I also explained earlier our work system is not innocuous.  When this file is uploaded the server side updates dozens of other systems and creates codes and keys across an entire array of different systems.  Uploading the file to some folder on the server would do absolutely nothing.</p>\n\n<p>Boiling it down, this is as simple as I can make the question:  How do I find an already open filedialog box and set it to an object variable in VBA so that I can programmatically select a folder and file and then click \"OK.\"  I kind of feel like the title of my question explained that but understand why it might be confusing.  As this minutia explanation certainly reveals.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548264332, "post_id": 54331733, "comment_id": 95482928, "body": "The issue is- item is nothing - you will have to assign set item to a reference"}, {"owner": {"reputation": 23, "user_id": 10559288, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ESirg9LcZm0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAvCbWFIW7HtfHPMes1EKKmIIPUUw/mo/photo.jpg?sz=128", "display_name": "Emi", "link": "https://stackoverflow.com/users/10559288/emi"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548269276, "post_id": 54331733, "comment_id": 95485154, "body": "How do I assign a reference to Item? I want the Item to refer to every new mail coming into this folder."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548277214, "post_id": 54331733, "comment_id": 95488426, "body": "See answer below and let me know- Thanks"}, {"owner": {"reputation": 23, "user_id": 10559288, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ESirg9LcZm0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAvCbWFIW7HtfHPMes1EKKmIIPUUw/mo/photo.jpg?sz=128", "display_name": "Emi", "link": "https://stackoverflow.com/users/10559288/emi"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1548281941, "post_id": 54331733, "comment_id": 95490362, "body": "Thank you! Works perfectly."}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1548277131, "last_edit_date": 1548277131, "creation_date": 1548276793, "answer_id": 54335459, "question_id": 54331733, "link": "https://stackoverflow.com/questions/54331733/saving-attachments-either-returns-91-error-or-does-not-save/54335459#54335459", "title": "Saving attachments either returns 91 error or does not save", "body": "<p><em>Try the following</em> </p>\n\n<pre><code>Dim att As Outlook.attachment\nDim msg As Outlook.MailItem\nDim filepath As String, filedate As String\n\nfilepath = \"C:\\Documents\\\"\n\nIf TypeName(Item) = \"MailItem\" Then\n    Set msg = Item\n    Debug.Print msg.ReceivedTime ' print on Immediate Window\n    filedate = Format(msg.ReceivedTime, \"YYYYMMDD\")\n\n    If InStr(msg.Subject, \"XXX\") &gt; 0 Then\n        For Each att In msg.Attachments\n            att.SaveAsFile filepath &amp; \"XXX\\\" &amp; filedate &amp; \"_raw.csv\"\n        Next\n   ElseIf InStr(msg.Subject, \"YYY\") &gt; 0 Then\n        For Each att In msg.Attachments\n            att.SaveAsFile filepath &amp; \"YYY\\\" &amp; filedate &amp; \"_raw.xlsx\"\n        Next\n    ElseIf InStr(msg.Subject, \"ZZZ\") &gt; 0 Then\n        For Each att In msg.Attachments\n            att.SaveAsFile filepath &amp; \"ZZZ.csv\"\n        Next\n    End If\nEnd If\n</code></pre>\n\n<p><em>also you don't need <code>outlookApp</code> when the code is running within Outlook Application, simply use Application.</em></p>\n\n<p><em>Example</em> </p>\n\n<pre><code>Private Sub Application_Startup()\n  Dim objectNS As Outlook.NameSpace\n\n  Set objectNS = Application.GetNamespace(\"MAPI\")\n  Set folderItems = objectNS.GetDefaultFolder(olFolderInbox) _\n                            .Folders(\"Operations\") _\n                            .Folders(\"Test\").Items\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10559288, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ESirg9LcZm0/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAvCbWFIW7HtfHPMes1EKKmIIPUUw/mo/photo.jpg?sz=128", "display_name": "Emi", "link": "https://stackoverflow.com/users/10559288/emi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 54335459, "answer_count": 1, "score": 1, "last_activity_date": 1592694178, "creation_date": 1548261158, "last_edit_date": 1592694178, "question_id": 54331733, "link": "https://stackoverflow.com/questions/54331733/saving-attachments-either-returns-91-error-or-does-not-save", "title": "Saving attachments either returns 91 error or does not save", "body": "<p>I'm trying to set up a macro in ThisOutlookSession to save attachments to file.</p>\n\n<p>I previously used rules and 'run a script', but it is not enabled for all users.</p>\n\n<p>The below code either returns a 91 error (object or variable not set), or it runs without error, but doesn't save.</p>\n\n<p>The code is looking at a subfolder, to save all attachments to a location based on subject. The emails are sent to the subfolder through a rule.</p>\n\n<p>I want to rename the attachments based on the ReceivedTime, and I think this is where the issue arises. If I use Msg.ReceivedTime, I get the 91 error. If I use Item.ReceivedTime, there is no error, but the file is not saved.</p>\n\n<p>Here is the source where I derived most of the code and customized. <a href=\"https://www.tachytelic.net/2017/10/how-to-run-a-vba-macro-when-new-mail-is-received-in-outlook/\" rel=\"nofollow noreferrer\">https://www.tachytelic.net/2017/10/how-to-run-a-vba-macro-when-new-mail-is-received-in-outlook/</a></p>\n\n<pre><code>Private WithEvents folderItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n  Dim outlookApp As Outlook.Application\n  Dim objectNS As Outlook.NameSpace\n\n  Set outlookApp = Outlook.Application\n  Set objectNS = outlookApp.GetNamespace(\"MAPI\")\n  Set folderItems = objectNS.GetDefaultFolder(olFolderInbox).Folders(\"Operations\").Folders(\"Test\").Items\nEnd Sub\n\nPrivate Sub folderItems_ItemAdd(ByVal Item As Object)\nOn Error GoTo ErrorHandler\nDim att As Outlook.Attachment\nDim msg As Outlook.MailItem\nDim filepath As String, filedate As String\nfilepath = \"C:\\Documents\\\"\nfiledate = Format(Item.ReceivedTime, \"YYYYMMDD\") 'This is the line which I think is the problem. If I do Msg.ReceivedTime, I get 91 error, but if I do Item.ReceivedTime, it does not save\nIf TypeName(Item) = \"MailItem\" Then\n    If InStr(Item.Subject, \"XXX\") &gt; 0 Then\n        For Each att In Item.Attachments\n            att.SaveAsFile filepath &amp; \"XXX\\\" &amp; filedate &amp; \"_raw.csv\"\n        Next\n   ElseIf InStr(Item.Subject, \"YYY\") &gt; 0 Then\n        For Each att In Item.Attachments\n            att.SaveAsFile filepath &amp; \"YYY\\\" &amp; filedate &amp; \"_raw.xlsx\"\n        Next\n    ElseIf InStr(Item.Subject, \"ZZZ\") &gt; 0 Then\n        For Each att In Item.Attachments\n            att.SaveAsFile filepath &amp; \"ZZZ.csv\"\n        Next\n    End If\nEnd If\nExitNewItem:\n    Exit Sub\nErrorHandler:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Resume ExitNewItem\nEnd Sub\n</code></pre>\n\n<p>My hypothesis is that the ReceivedTime is the issue. If I can use Msg.ReceivedTime, how do I set the variable? Or, if Item.ReceivedTime is correct, why does it not save?</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1548271048, "creation_date": 1548271048, "answer_id": 54334213, "question_id": 54331677, "link": "https://stackoverflow.com/questions/54331677/macro-to-copy-paste-between-a-data-workbook-and-a-plot-workbook/54334213#54334213", "title": "Macro to Copy-Paste between a Data Workbook and a Plot Workbook", "body": "<p>This should work.\nNOTE: Make sure that you open each workbook in only 1 instance of Excel.\n      EX: Open Dataworkbook.xls\n          From the file menu open next workbook\n          From the file menu open next workbook\n          etc.</p>\n\n<p>The following is the code:</p>\n\n<pre><code>    Option Explicit\n\n    'NOTE: This should be called from your main data Workbook\n    Sub RunIT()\n\n      '                             'Sheet that data is on\n      '                                              'Range matrix to copy\n      '                                                        'Workbook\n      '                                                                     'Range to copy to\n      DataPaste ThisWorkbook.Sheets(\"Sheet1\").Range(\"C1:E10\"), \"Book1.xls\", \"E1\"\n      DataPaste ThisWorkbook.Sheets(\"Sheet1\").Range(\"C1:E10\"), \"Book2.xls\", \"E1\"\n\n    End Sub\n\n    Sub DataPaste(rngFrom As Range, strToWorkbook As String, strToRange As String)\n        Dim shtSheet As Worksheet\n        Dim wndw As Window\n        Dim wbTo As Workbook\n        Dim wbItem As Workbook\n\n        'Initialize copy event\n        rngFrom.Copy\n\n        strToWorkbook = LCase(Trim(strToWorkbook))\n        'loop through each workbook that is open in this instance of Excel\n        For Each wbItem In Application.Workbooks\n            'If Names match then, copy data\n            If LCase(Trim(wbItem.Name)) = strToWorkbook Then\n                'This loops through all sheets in specified workbook(CopyTo).\n                For Each shtSheet In wbItem.Worksheets\n                    'Paste it\n                    shtSheet.Paste shtSheet.Range(strToRange)\n                Next\n            End If\n        Next\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10775884, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aI48HU230qA/AAAAAAAAAAI/AAAAAAAAFX0/2Au-lRBnsgU/photo.jpg?sz=128", "display_name": "Kali Miller", "link": "https://stackoverflow.com/users/10775884/kali-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548271048, "creation_date": 1548260978, "question_id": 54331677, "link": "https://stackoverflow.com/questions/54331677/macro-to-copy-paste-between-a-data-workbook-and-a-plot-workbook", "title": "Macro to Copy-Paste between a Data Workbook and a Plot Workbook", "body": "<p>I am fairly new to coding macros in excel VBA and I am in need of some help. I have 2 different workbooks that I am working with. One has data sets on multiple sheets and one has plots that correspond to those data sets. I am looking for a macro that will allow for me to copy columns D-I from the active sheet in the data workbook and will paste it into the active sheet in the plot workbook. The tricky part that I am trying to achieve is I want the data to be pasted to the plot workbook based on a corresponding date column (column a in plot workbook and column b in data workbook).</p>\n\n<p>The reason for the 2 workbooks is the plots are a template and this is the easiest way I have been able to come up with to keep all the plots to look exactly the same except for the various data. I have over a hundred of these plots to do so anything that will speed up the transfer process would be greatly appreciated.</p>\n"}, {"tags": ["html", "excel", "vba", "web", "web-scraping"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1548260398, "post_id": 54331452, "comment_id": 95480906, "body": "I&#39;ve tried to fix your formatting issues for your syntax but you may want to give it a once over to make sure it is what you intended"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10956249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe4650d813625d97afd5f40694ab95?s=128&d=identicon&r=PG&f=1", "display_name": "Ragee", "link": "https://stackoverflow.com/users/10956249/ragee"}, "edited": false, "score": 0, "creation_date": 1557560968, "post_id": 54333509, "comment_id": 98813637, "body": "QHarr, i was working to get the links working for long time...kept the things aside for some new approach..i will come back to this....thanks"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 10956249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe4650d813625d97afd5f40694ab95?s=128&d=identicon&r=PG&f=1", "display_name": "Ragee", "link": "https://stackoverflow.com/users/10956249/ragee"}, "edited": false, "score": 0, "creation_date": 1557561014, "post_id": 54333509, "comment_id": 98813642, "body": "happy days then :-)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1548268104, "creation_date": 1548268104, "answer_id": 54333509, "question_id": 54331452, "link": "https://stackoverflow.com/questions/54331452/reading-the-elements-of-2nd-page-after-submit-click/54333509#54333509", "title": "reading the elements of 2nd page after submit click", "body": "<p>Try using proper waits after navigate and <code>.click</code> and work off <code>.document</code>. This should update with new content after the <code>.click</code></p>\n\n<pre><code>Option Explicit\nPublic Sub PerformActions()\n    Dim IE As InternetExplorer\n    Set IE = New InternetExplorer\n\n    With IE\n        .Visible = True\n        .Navigate2 \"https://xyzfrmTarget=New&amp;Text_ident=002719&amp;frmOption=CREATE\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.getElementById(\"ui-new_widget-1_monitor_12\").Value = ThisWorkbook.Sheets(\"Data\").Range(\"A2\").Value\n        .document.getElementById(\"new_date\").Value = \"2019-01-19\"\n        .document.getElementById(\"new_no_mail\").Click\n\n         While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n         '.document ''&lt; do whatever references off .document here\n         'other code\n         '.quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10956249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe4650d813625d97afd5f40694ab95?s=128&d=identicon&r=PG&f=1", "display_name": "Ragee", "link": "https://stackoverflow.com/users/10956249/ragee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548268123, "creation_date": 1548260120, "last_edit_date": 1548268123, "question_id": 54331452, "link": "https://stackoverflow.com/questions/54331452/reading-the-elements-of-2nd-page-after-submit-click", "title": "reading the elements of 2nd page after submit click", "body": "<p>I am working on a web form fill using excel cells data, and the issue here is that after filling the text in the first page using the elements ID, when it click on Submit it loads a new IE.</p>\n\n<p>Now here I am not able to fill the text using the elements ID etc, as its (VBA) not identifying it or not considering it.</p>\n\n<p>IE Page loads properly here no issue.</p>\n\n<pre><code>Sub Test1()\n    Dim IE As Object\n    Dim doc As HTMLDocument\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.navigate \"https://xyzfrmTarget=New&amp;Text_ident=002719&amp;frmOption=CREATE\"\n    Do While IE.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n    Set doc = IE.document\n    'IE.document.getElementById().Value=\"test\"\n    'doc.getElementById(\"ui-new_widget-1_new_company_12\").Value = ThisWorkbook.Sheets(\"Data\").Range(\"A2\").Value\n    doc.getElementById(\"ui-new_widget-1_monitor_12\").Value = ThisWorkbook.Sheets(\"Data\").Range(\"A2\").Value\n    doc.getElementById(\"new_date\").Value = \"2019-01-19\"\n    'ThisWorkbook.Sheets(\"Data\").Range(\"c2\").Value\n    doc.getElementById(\"new_no_mail\").Click\n    IE.document.forms(0).submit\nEnd Sub\n</code></pre>\n\n<p>It submit the 1st page with the Text data from excel, but issue with the 2nd page which loads</p>\n"}, {"tags": ["excel", "vba", "pivot-chart"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1548260710, "post_id": 54331346, "comment_id": 95481086, "body": "<i>&quot;Somehow, when I run my macro, the pivot tables are not showing. When I run the macro again, the pivot charts are showing. How come?&quot;</i> - Pivot tables or pivot charts? The two are not the same. I&#39;m having a hard time understanding your problem."}, {"owner": {"reputation": 1, "user_id": 10956793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5_FgG7qN41s/AAAAAAAAAAI/AAAAAAAAALg/FFPYeXcQIK0/photo.jpg?sz=128", "display_name": "Aletta", "link": "https://stackoverflow.com/users/10956793/aletta"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548664166, "post_id": 54331346, "comment_id": 95606802, "body": "Sorry, It is about the pivot charts. The pivot tables are working fine."}], "owner": {"reputation": 1, "user_id": 10956793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5_FgG7qN41s/AAAAAAAAAAI/AAAAAAAAALg/FFPYeXcQIK0/photo.jpg?sz=128", "display_name": "Aletta", "link": "https://stackoverflow.com/users/10956793/aletta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548259986, "creation_date": 1548259809, "last_edit_date": 1548259986, "question_id": 54331346, "link": "https://stackoverflow.com/questions/54331346/why-does-my-macro-has-to-run-twice-to-show-pivot-charts", "title": "Why does my macro has to run twice to show pivot charts?", "body": "<p>I have pivot charts in my workbook. Somehow, when I run my macro, the pivot tables are not showing. When I run the macro again, the pivot charts are showing. How come?</p>\n\n<p>Also sometimes, but not always, the next line gives an error (in the part Resfresh output):\n        Selection.NumberFormat = \"0%\"</p>\n\n<p>I have tried code to unhide the pivot charts with .Visible = True. It still doesn't show the pivot tables</p>\n\n<pre><code>Sub CopyOrders()\n\n' Unhide all Sheets\nFor Each ws In ActiveWorkbook.Worksheets\n    ws.Visible = xlSheetVisible\n    If ws.AutoFilterMode Or ws.FilterMode Then\n        ws.ShowAllData\n    End If\n    ws.Columns.EntireColumn.Hidden = False\n    ws.Rows.EntireRow.Hidden = False\nNext ws\n\nActiveWorkbook.SlicerCaches(\"Slicer_Site_Peros_Number___Name\"). _\n    ClearManualFilter\n\n' Other code is showing here to calculate and form the tables my pivotcharts are coming from\n\n\n' Refresh Output\nSheets(\"Output Frames\").Select\nActiveSheet.PivotTables(\"PivotTableArticles\").PivotCache.Refresh\nSheets(\"Output Frames\").PivotTables(\"PivotTableArticles\").DataBodyRange.NumberFormat = \"dd/mm/yyyy\"\nSheets(\"Output Frames\").PivotTables(\"PivotTableSoldPerSite\").PivotSelect \"Percentage\", _\n    xlDataAndLabel, True\nSelection.NumberFormat = \"0%\"\nColumns(\"A:R\").EntireColumn.AutoFit\nRange(\"A2:P4\").Font.Size = 30\nRange(\"A6:P8\").Font.Size = 20\nRange(\"A42:P44\").Font.Size = 20\nRange(\"A1\").Select\n\n' Hide Data\nSheets(\"Output Frames\").Columns(\"R:XFD\").EntireColumn.Hidden = True\nSheets(\"Output Frames\").Columns(\"H\").EntireColumn.Hidden = True\nSheets(\"Output Frames\").Columns(\"N\").EntireColumn.Hidden = True\nSheets(\"Sales\").Visible = xlSheetHidden\nSheets(\"Orders vs Sales\").Visible = xlSheetHidden\nSheets(\"Sitenumbers\").Visible = xlSheetHidden\nSheets(\"PivotTables\").Visible = xlSheetHidden\n\nEnd Sub\n</code></pre>\n\n<p>Can someone tell why the pivot tables aren't showing the first time en how to fix this?</p>\n"}, {"tags": ["excel", "vba", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548262195, "post_id": 54331340, "comment_id": 95481883, "body": "Which line causes the error in the first code snippet? Is there an error when trying to open a PDF produced by the second?"}, {"owner": {"reputation": 3, "user_id": 7908498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee297b049b32ba3f301cde519beedb0?s=128&d=identicon&r=PG&f=1", "display_name": "MajesticMadman", "link": "https://stackoverflow.com/users/7908498/majesticmadman"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1548320796, "post_id": 54331340, "comment_id": 95501498, "body": "In the first snippet: objWord.ActiveDocument.ExportAsFixedFormat OutputFileName:=&quot;C:\\test.pdf&quot;, ExportFormat:=wdExportFormatPDF   And yeah the second one is when trying to open."}], "owner": {"reputation": 3, "user_id": 7908498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee297b049b32ba3f301cde519beedb0?s=128&d=identicon&r=PG&f=1", "display_name": "MajesticMadman", "link": "https://stackoverflow.com/users/7908498/majesticmadman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548320923, "creation_date": 1548259782, "last_edit_date": 1548320923, "question_id": 54331340, "link": "https://stackoverflow.com/questions/54331340/excel-vba-export-word-to-pdf", "title": "Excel Vba export word to pdf", "body": "<p>I've been struggling to get a conversion of word files to PDFS (Ran using excel) to work. </p>\n\n<p>I've tried the below(From other answers on here) and get the error(On the ExportAsFixedFormat Line), \"Invalid procedure call or argument\":</p>\n\n<pre><code>Dim objWord As Object\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = False\nobjWord.DisplayAlerts = False\nobjWord.Documents.Open \"C:\\Test.docx\"\nobjWord.ActiveDocument.ExportAsFixedFormat OutputFileName:=\"C:\\test.pdf\", ExportFormat:=wdExportFormatPDF\nobjWord.Quit\n</code></pre>\n\n<p>I've also tried this setup however this doesn't error when ran, but the PDFs error when trying to open.</p>\n\n<pre><code>Dim objWord As Object\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = False\n    objWord.DisplayAlerts = False\n    objWord.Documents.Open \"C:\\Test.docx\"\n    objWord.ActiveDocument.SaveAs2 FileName:=\"C:\\Test.pdf\", FileFormat:=wdFormatPDF\n    objWord.Quit\n</code></pre>\n"}, {"tags": ["excel", "vba", "function"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10956667, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155950877645887/picture?type=large", "display_name": "Tri", "link": "https://stackoverflow.com/users/10956667/tri"}, "edited": false, "score": 1, "creation_date": 1548426982, "post_id": 54331399, "comment_id": 95548572, "body": "Thanks, Tom! This did it. I was working under the (false) assumption that all excel functions would have already been defined."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 2, "last_activity_date": 1548259963, "creation_date": 1548259963, "answer_id": 54331399, "question_id": 54331332, "link": "https://stackoverflow.com/questions/54331332/excel-own-function-compile-error-sub-or-function-not-defined/54331399#54331399", "title": "Excel own function: Compile error: Sub or Function not defined", "body": "<p>Replace <code>Substitute</code> with <code>Replace</code> for the <code>VBA</code> function</p>\n\n<pre><code>Public Function IPFix(IP)\n    IPFix = Replace(Replace(Replace(\"@.\" &amp; Trim(IP), \".0\", \".\"), \".0\", \".\"), \"@.\", \"\")\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10956667, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155950877645887/picture?type=large", "display_name": "Tri", "link": "https://stackoverflow.com/users/10956667/tri"}, "edited": false, "score": 0, "creation_date": 1548427189, "post_id": 54331880, "comment_id": 95548691, "body": "Thank you, Mathieu, for the in-depth description and lesson. Much appreciated!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1548261712, "creation_date": 1548261712, "answer_id": 54331880, "question_id": 54331332, "link": "https://stackoverflow.com/questions/54331332/excel-own-function-compile-error-sub-or-function-not-defined/54331880#54331880", "title": "Excel own function: Compile error: Sub or Function not defined", "body": "<p>VBA is <em>hosted</em> in Excel, but it's completely distinct: VBA doesn't know anything about Excel's worksheet functions. At least, not natively.</p>\n\n<p>So, <code>Substitute</code> isn't defined anywhere - same for <code>VLookup</code>, and many other worksheet functions. Some VBA functions have the same name (or a similar one) as Excel worksheet functions, <em>and behave differently</em>.</p>\n\n<p>The VBA standard library <em>does</em> have a <code>Strings</code> module that exposes a number of specialized <code>String</code> functions (several of which also exist as worksheet functions, e.g. <code>=LEFT</code> vs <code>Left</code> and <code>Left$</code>).</p>\n\n<p>As <a href=\"https://stackoverflow.com/a/54331399/1188513\">Tom correctly specifies</a>, the VBA standard library function that's equivalent to Excel's <code>Substitute</code> function, is <code>Replace</code> - a function that's defined in the <code>VBA.Strings</code> module, which you can explore by pressing <kbd>F2</kbd> to bring up the VBE's <em>Object Browser</em>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/MCniZ.png\" alt=\"VBE object browser showing definition for VBA.Strings.Replace\"></p>\n\n<p>Since these functions are all globally-scoped, you don't <em>have</em> to fully qualify them; that's why &amp; how you can legally write <code>Debug.Print Replace(string1, string2)</code>. But know that you could always type <code>VBA.</code> and get <em>IntelliSense</em> to list what functions are available - <code>VBA.Strings.Replace</code> works, as does <code>VBA.Replace</code>, or just <code>Replace</code>:</p>\n\n<pre><code>Public Function IPFix(ByVal IP As String) As String\n    IPFix = VBA.Strings.Replace(VBA.Strings.Replace(VBA.Strings.Replace(\"@.\" &amp; Trim(IP), \".0\", \".\"), \".0\", \".\"), \"@.\", \"\")\nEnd Function\n</code></pre>\n\n<p>Now that's wordy. The benefit though, is that now if your VBA project defines a <code>Replace</code> function, places that invoke <code>VBA.Strings.Replace</code> or <code>VBA.Replace</code>, will still be invoking that function instead of your <code>VBAProject.Module1.Replace</code> custom function - because an identifier reference in VBA is always resolved by the compiler, starting with the smallest accessible scope: so a custom function can exist in a custom module and \"shadow\" or \"hide\" a VBA standard library function (or any other function defined in any other referenced type library).</p>\n\n<p>Lasty, note that for the times you do need to invoke an actual worksheet function, you can do it from the Excel object model - here using a <code>With</code> block to reduce the verbiage:</p>\n\n<pre><code>Public Function IPFix(ByVal IP As String) As String\n    With Application.WorksheetFunction\n        IPFix = .Substitute(.Substitute(.Substitute(\"@.\" &amp; Trim(IP), \".0\", \".\"), \".0\", \".\"), \"@.\", \"\")\n    End With\nEnd Function\n</code></pre>\n\n<p>Worksheet functions invoked like this will work exactly like their actual-worksheet counterparts; you can use <code>Index</code>, <code>Match</code>, <code>VLookup</code>, and <em>a lot</em> of other worksheet functions that way, with an early-bound standard VBA member call that will raise a standard VBA runtime error given invalid arguments.</p>\n\n<p>You can also invoke them late-bound, directly against the <code>Application</code> object - in which case invalid arguments won't <em>raise</em> an error, but <em>return</em> one - just like they do in actual worksheets (e.g. <code>#VALUE!</code>) - if you want to return that worksheet error value, your function needs to return a <code>Variant</code> (implicit like you have, or explicit as follows), because an <code>Error</code> is a VBA data type that can't be coerced into a <code>String</code> value, so the return assignment would throw a <em>type mismatch</em> error:</p>\n\n<pre><code>Public Function IPFix(ByVal IP As String) As Variant\n    With Application\n        IPFix = .Substitute(.Substitute(.Substitute(\"@.\" &amp; Trim(IP), \".0\", \".\"), \".0\", \".\"), \"@.\", \"\")\n    End With\nEnd Function\n</code></pre>\n\n<p>Note that because these calls are <em>late-bound</em>, they are only resolved at run-time, which means you must be very careful with typos; you also don't get any <em>IntelliSense</em> or \"parameter quick-info\" to help as you type it.</p>\n"}], "owner": {"reputation": 21, "user_id": 10956667, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155950877645887/picture?type=large", "display_name": "Tri", "link": "https://stackoverflow.com/users/10956667/tri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1548261712, "creation_date": 1548259768, "last_edit_date": 1548259837, "question_id": 54331332, "link": "https://stackoverflow.com/questions/54331332/excel-own-function-compile-error-sub-or-function-not-defined", "title": "Excel own function: Compile error: Sub or Function not defined", "body": "<p>We have a system which exports IP address data always with three digit octets. I am trying to create an own function in Excel in order to remove any unnecessary leading zeros from these IP addresses. I have a proven formula which accomplishes this, but when trying to create a function, I get the Compile error: Sub or Function not defined. \nAny help would be appreciated.  </p>\n\n<p>the formula that works:</p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(\"@.\" &amp; TRIM(A2), \".0\", \".\"), \".0\", \".\"), \"@.\", \"\") \n</code></pre>\n\n<p>e.g. if the cell A2 contains 010.110.009.254 this formula results in 10.110.9.254  </p>\n\n<pre><code>Public Function IPFix(IP)\nIPFix = Substitute(Substitute(Substitute(\"@.\" &amp; Trim(IP), \".0\", \".\"), \".0\", \".\"), \"@.\", \"\")\nEnd Function\n</code></pre>\n\n<p>I would expect that =IPFix(A2) would result in a valid IP format with no leading zeros.\nHowever I am just getting this compile error.</p>\n"}, {"tags": ["excel", "vba", "outlook", "mass-emails"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548259915, "post_id": 54331287, "comment_id": 95480594, "body": "Replace <code>Cells(cell.Row, &quot;L3&quot;).Value</code> with <code>Cells(cell.Row, &quot;L&quot;).Value</code> (occurs 2 times)"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1548260121, "post_id": 54331287, "comment_id": 95480726, "body": "Also, remove the underscore from this line if it is going to be all on one line <code>&quot;Please confirm by&quot; &amp; Cells(cell.Row, &quot;L3&quot;).Value _ &amp; &quot; so that we may be able to &quot;</code>"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1548260169, "post_id": 54331287, "comment_id": 95480761, "body": "And similarly on the line <code>.Subject = &quot;Action may be required by&quot; &amp; Cells(cell.Row, &quot;L3&quot;).Value _</code>"}], "owner": {"reputation": 1, "user_id": 10037486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85b3611863f6e1da5a8907c9718f231c?s=128&d=identicon&r=PG&f=1", "display_name": "MiaLea", "link": "https://stackoverflow.com/users/10037486/mialea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548259823, "creation_date": 1548259645, "last_edit_date": 1548259823, "question_id": 54331287, "link": "https://stackoverflow.com/questions/54331287/how-to-fix-my-vba-code-so-that-the-date-in-the-email-content-is-not-static", "title": "How to Fix My VBA Code so that the Date in the Email Content is not Static", "body": "<p>I am having difficulties changing a VBA code so that the dates in the email content which are static become dynamic. May you please review my code and let me know my error?</p>\n\n<p>This code is to send emails to a group of people. In the email, there are some dates, which may change periodically. Therefore, I would like to be able to update ONE CELL (L3) in Excel and have the date in the email content (including the title) changes automatically. </p>\n\n<pre><code>Sub Mail_small_Text_Change_Account()\n\n    Dim cel As Range\n    Dim OutApp As Outlook.Application\n    Dim OutMail As Outlook.MailItem\n    Dim strbody As String\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    On Error GoTo cleanup\n    For Each cell In Columns(\"D\").Cells.SpecialCells(xlCellTypeConstants)\n        If cell.Value Like \"?*@?*.?*\" And _\n           Cells(cell.Row, \"G\") = \"Y\" Then\n\n    strbody = \"Dear \" &amp; Cells(cell.Row, \"C\").Value _\n                      &amp; vbNewLine &amp; vbNewLine &amp; _\n                        \"Please confirm by\" &amp; Cells(cell.Row, \"L3\").Value _ &amp; \" so that we may be able to \"\n\n    Set OutMail = OutApp.CreateItem(olMailItem)\n    On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            '.CC = cel.Offset(0, 3).Value\n            .Subject = \"Action may be required by\" &amp; Cells(cell.Row, \"L3\").Value _\n            .Body = strbody\n            .SendUsingAccount = OutApp.Session.Accounts.Item(3)\n            .Display   'or use .Send\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n        End If\n    Next cell\n\ncleanup:\n    Set OutApp = Nothing\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1548259351, "creation_date": 1548259351, "answer_id": 54331193, "question_id": 54331071, "link": "https://stackoverflow.com/questions/54331071/select-multiple-defined-sheets/54331193#54331193", "title": "Select multiple defined sheets", "body": "<p>You are close. However, the <code>Sheets</code>-collection needs numbers or strings as parameter, but in your code you are passing <code>Worksheet</code>-objects. The fix is easy: Just pass the names of the worksheets:</p>\n\n<pre><code>ThisWorkbook.Sheets(Array(SheetA.name, SheetB.name).Select\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9684720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/941aaac3a3d5bb93f83736827a6d7fb5?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/9684720/anne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "accepted_answer_id": 54331193, "answer_count": 1, "score": 0, "last_activity_date": 1548259477, "creation_date": 1548258962, "last_edit_date": 1548259477, "question_id": 54331071, "link": "https://stackoverflow.com/questions/54331071/select-multiple-defined-sheets", "title": "Select multiple defined sheets", "body": "<p>This is a very basic question but I just can't get it right.\nI have a workbook with multiple sheets, but for this code I only need two specific ones, which the user selects. So the code starts like this:</p>\n\n<pre><code>Dim SheetA as Worksheet\nDim SheetB as Worksheet\n\nSet SheetA = ThisWorkbook.Sheets(\"The sheet the user wants\")\nSet SheetB = ThisWorkbook.Sheets(\"The sheet the user wants\")\n</code></pre>\n\n<p>Then there is some code. Later I need to select these two sheets and I want the first sheet to be activated.\nThis is the code I've tried so far, but it does not work (at least the first line).</p>\n\n<pre><code>ThisWorkbook.Sheets(Array(SheetA, SheetB)).Select\nSheetA.Activate\n</code></pre>\n\n<p>Thank you for any helpful advise.</p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1548259692, "post_id": 54331038, "comment_id": 95480468, "body": "<code>SPLIT</code> retunrs an array, so you can say <code>a=split(strInput,&quot;material_cd&quot;)</code> then this array a, you can put in a range, so something like <code>range(&quot;a1&quot;).resize(ubound(a)-1,1).value=a</code>"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 3282832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b8e59b190ecfbd1b1a3ee853820e7f?s=128&d=identicon&r=PG&f=1", "display_name": "GIS_GOD", "link": "https://stackoverflow.com/users/3282832/gis-god"}, "edited": false, "score": 0, "creation_date": 1548260319, "post_id": 54331345, "comment_id": 95480864, "body": "Would this be done using the built in VBA interface inside excel?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 101, "user_id": 3282832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b8e59b190ecfbd1b1a3ee853820e7f?s=128&d=identicon&r=PG&f=1", "display_name": "GIS_GOD", "link": "https://stackoverflow.com/users/3282832/gis-god"}, "edited": false, "score": 0, "creation_date": 1548260569, "post_id": 54331345, "comment_id": 95481016, "body": "I don&#39;t get your question. This is VBA code - just put it in a function or subroutine and adapt it to your needs"}, {"owner": {"reputation": 101, "user_id": 3282832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b8e59b190ecfbd1b1a3ee853820e7f?s=128&d=identicon&r=PG&f=1", "display_name": "GIS_GOD", "link": "https://stackoverflow.com/users/3282832/gis-god"}, "edited": false, "score": 0, "creation_date": 1548260834, "post_id": 54331345, "comment_id": 95481138, "body": "Use this the same way I would call the &quot;Concatenation&quot; function in excel? I&#39;d pick a cell, type =Concatenation(.....), or can I make custom functions?"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1548259808, "creation_date": 1548259808, "answer_id": 54331345, "question_id": 54331038, "link": "https://stackoverflow.com/questions/54331038/split-a-string-at-a-specific-word-and-create-a-new-row/54331345#54331345", "title": "Split a String at a Specific Word and Create a New Row", "body": "<p>Just use the <code>split</code>-command and use the string <code>material_cd</code> as split criteria. When working on the splitted parts, add the string <code>material_cd</code> again:</p>\n\n<pre><code>Const s = \"material_cd = 10798259 AND inputportcount  24 ...\"\nConst splitString = \"material_cd\"\n\nDim a() As String, i As Integer\na = Split(s, splitString )\n\nFor i = 0 To UBound(a)\n    Debug.Print splitString  &amp; a(i)\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 3282832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b8e59b190ecfbd1b1a3ee853820e7f?s=128&d=identicon&r=PG&f=1", "display_name": "GIS_GOD", "link": "https://stackoverflow.com/users/3282832/gis-god"}, "edited": false, "score": 0, "creation_date": 1548263330, "post_id": 54331396, "comment_id": 95482467, "body": "How would I turn this into a function?I have numerous strings like the one mentioned above, I need to be able to set a cell to the variable &quot;s&quot; in your sub routine, so as it goes down the lists of cells it uses that string to split."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 101, "user_id": 3282832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b8e59b190ecfbd1b1a3ee853820e7f?s=128&d=identicon&r=PG&f=1", "display_name": "GIS_GOD", "link": "https://stackoverflow.com/users/3282832/gis-god"}, "edited": false, "score": 0, "creation_date": 1548670538, "post_id": 54331396, "comment_id": 95610152, "body": "<a href=\"https://stackoverflow.com/questions/16638449/change-sub-to-function-then-call-in-vba\" title=\"change sub to function then call in vba\">stackoverflow.com/questions/16638449/&hellip;</a>   If you haven&#39;t searched yet."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 2, "last_activity_date": 1548259958, "creation_date": 1548259958, "answer_id": 54331396, "question_id": 54331038, "link": "https://stackoverflow.com/questions/54331038/split-a-string-at-a-specific-word-and-create-a-new-row/54331396#54331396", "title": "Split a String at a Specific Word and Create a New Row", "body": "<p>Something like this,</p>\n\n<pre><code>Sub tt()\n\nDim s As String\nDim a() As String\n\ns = \"material_cd = 10798259 AND inputportcount  24 material_cd = 10798259 AND outputportcount  144 material_cd = 10798259 AND inputblockcount  1 material_cd = 10798259 AND outputblockcount  1 material_cd = 10798259 AND bv_type_name  FDH material_cd = 10798259 AND manufacturer  Corning material_cd = 10798259 AND partnumber  N/A material_cd = 10798259 AND bv_status  Preliminary Designed material CD = 10798259 AND bv_tail_length  25\"\ns = Replace(s, \"material_cd\", \"*^*material_cd\")\na = Split(s, \"*^*\")\n\nRange(\"a1\").Resize(UBound(a) - 1, 1).Value = Application.Transpose(a)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3282832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b8e59b190ecfbd1b1a3ee853820e7f?s=128&d=identicon&r=PG&f=1", "display_name": "GIS_GOD", "link": "https://stackoverflow.com/users/3282832/gis-god"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1548259958, "creation_date": 1548258854, "question_id": 54331038, "link": "https://stackoverflow.com/questions/54331038/split-a-string-at-a-specific-word-and-create-a-new-row", "title": "Split a String at a Specific Word and Create a New Row", "body": "<p>I'm trying to split this string at the word \"material_cd\" and have it create a new row with the split string.</p>\n\n<pre>\nmaterial_cd = 10798259 AND inputportcount  24 material_cd = 10798259 AND outputportcount  144 material_cd = 10798259 AND inputblockcount  1 material_cd = 10798259 AND outputblockcount  1 material_cd = 10798259 AND bv_type_name  FDH material_cd = 10798259 AND manufacturer  Corning material_cd = 10798259 AND partnumber  N/A material_cd = 10798259 AND bv_status  Preliminary Designed material CD = 10798259 AND bv_tail_length  25\n</pre>\n\n<p>Desired Outcome:</p>\n\n<pre><code>material_cd = 10798259 AND inputportcount &lt;&gt; 24\nmaterial_cd = 10798259 AND outputportcount &lt;&gt; 144\nmaterial_cd = 10798259 AND inputblockcount &lt;&gt; 1\nmaterial_cd = 10798259 AND outputportcount &lt;&gt; 1\n</code></pre>\n\n<p>....and so on</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1548259637, "post_id": 54331000, "comment_id": 95480434, "body": "Why is this getting down/close voted? I think this is a valid question with enough details to answer."}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1548260594, "post_id": 54331197, "comment_id": 95481038, "body": "Thanks, so for your For Loop answer, this should wrap around my existing loop?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1548260782, "post_id": 54331197, "comment_id": 95481111, "body": "just put <code>If i = 5000 Then Stop</code> as first line into your existing <code>for</code> loop. The rest was just to illustrate where to put it."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1548277841, "post_id": 54331197, "comment_id": 95488672, "body": "This may seem wishful, but is there a way to skip to loop 5000? Its taking me awhile to get to that halfway mark lol."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1548312912, "post_id": 54331197, "comment_id": 95497794, "body": "well then let your loop start at 5000 like <code>For i = 5000 To 10000</code> just adjust to your needs."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1548260850, "last_edit_date": 1592644375, "creation_date": 1548259362, "answer_id": 54331197, "question_id": 54331000, "link": "https://stackoverflow.com/questions/54331000/vba-debug-how-to-step-through-multiple-loops-at-once/54331197#54331197", "title": "VBA Debug, How to step through multiple loops at once", "body": "<p>Put something like <code>If i = 5000 Then Stop</code> in your loop. The code will then stop at <code>i = 5000</code> in debug mode with <code>Stop</code> highlighted. You can then proceed step by step using F9.</p>\n<h3>For loop</h3>\n<pre><code>For i = 1 to 10000 '&lt;-- this is YOUR loop!\n    If i = 5000 Then Stop\n\n    'your other code here\nNext i\n</code></pre>\n<hr />\n<h3>Do loop</h3>\n<p>If it is a <code>Do</code> loop put in a counter <code>i</code></p>\n<pre><code>Dim i As Long\nDo While Criteria = True\n    i = i + 1\n    If i = 5000 Then Stop\n\n    'your other code here\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1548260537, "post_id": 54331201, "comment_id": 95480987, "body": "Thanks, so where in my loop should i put this code? Before the <code>next</code> ?"}, {"owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1548274805, "post_id": 54331201, "comment_id": 95487477, "body": "@excelguy before the <code>next</code> or just after the <code>for</code>"}], "tags": [], "owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "is_accepted": false, "score": 1, "last_activity_date": 1548259368, "creation_date": 1548259368, "answer_id": 54331201, "question_id": 54331000, "link": "https://stackoverflow.com/questions/54331000/vba-debug-how-to-step-through-multiple-loops-at-once/54331201#54331201", "title": "VBA Debug, How to step through multiple loops at once", "body": "<p>Add an increment variable in your loop and then, a condition like this :</p>\n\n<pre><code>i = i + 1\nif i = 5000 then\n   i = 5000                        &lt;---- Do F9 here\nend if\n</code></pre>\n\n<p>Do F9 on the \"i = 5000\" line to add a breakpoint for debugging.</p>\n\n<p>This will stop the running at 5000 iteration</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548313557, "post_id": 54331637, "comment_id": 95498049, "body": "You could also use a conditional compiling <code>#If DEBUGMODE Then</code> and set a <i>Conditional Compilation Argument</i> at project level to switch into debug mode. See <a href=\"https://christopherjmcclellan.wordpress.com/2014/11/21/setting-up-a-debug-environment-for-vba/\" rel=\"nofollow noreferrer\">Setting Up a Debug Environment for VBA</a>. So that&#39;s not a simple <code>If</code> switch that is run every time the code runs but a switch that compiles either the one or the other code based on the argument."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 3, "last_activity_date": 1548262061, "last_edit_date": 1548262061, "creation_date": 1548260853, "answer_id": 54331637, "question_id": 54331000, "link": "https://stackoverflow.com/questions/54331000/vba-debug-how-to-step-through-multiple-loops-at-once/54331637#54331637", "title": "VBA Debug, How to step through multiple loops at once", "body": "<p>Learn to use <code>Debug.Assert</code> this will automatically pause your code when it evaluates to <code>False</code>. For example:</p>\n\n<pre><code>Sub Demo_Debug_Assert()\n    Dim i As Long\n\n    For i = 1 To 100\n        Debug.Assert i &lt; 50\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Will break on every value of <code>i</code> greater than 49. This condition can obviously be changed for your criteria so:</p>\n\n<pre><code>Debug.Assert i &lt;&gt; 5000\n</code></pre>\n\n<p>If you want it to break just on <code>5000</code> or</p>\n\n<pre><code>Debug.Assert i &lt; 5000\n</code></pre>\n\n<p>for the code to break on every value after <code>4999</code></p>\n\n<p>To further this, instead of worrying about removing these lines before you use the code you can create a global constant (here named <code>DebugMode</code>) which is a <code>Boolean</code> so that this isn't triggered</p>\n\n<pre><code>Const DebugMode = True\nSub Demo_Debug_Assert()\n    Dim i As Long\n\n    For i = 1 To 100\n        If DebugMode Then Debug.Assert i &lt; 50\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Changing the global constant to  <code>Const DebugMode = False</code> will run your code to the end without pausing</p>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 54331197, "answer_count": 3, "score": 0, "last_activity_date": 1548262061, "creation_date": 1548258707, "last_edit_date": 1548259230, "question_id": 54331000, "link": "https://stackoverflow.com/questions/54331000/vba-debug-how-to-step-through-multiple-loops-at-once", "title": "VBA Debug, How to step through multiple loops at once", "body": "<p>I have a loop that loops through 10k rows. I am having trouble with one record in the middle and I want to see what the code is doing around the 5k row mark.\nThis is not practical to do f5 on each next.</p>\n\n<p>How can I run up to a specified loop or row number?</p>\n"}, {"tags": ["excel", "vba", "paste", "type-mismatch"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548258943, "post_id": 54330656, "comment_id": 95480030, "body": "Which line is throwing error 13, specifically?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1548259383, "post_id": 54330656, "comment_id": 95480299, "body": "Probably the <code>Worksheets(Sheet1)</code> part?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1548259813, "post_id": 54330656, "comment_id": 95480527, "body": "@VincentG right, just repro&#39;d. Thought it was funny because <code>Worksheet</code> has no default member, so <code>Debug.Print Sheet1</code> throws error 438 for that reason - error 13 makes sense since it&#39;s then the <code>Worksheet</code> reference that&#39;s being passed to the <code>Worksheets</code> indexer, throwing a type mismatch - which confirms that <code>Sheet1</code> is the sheet&#39;s code name, because that would be error 9 / subscript out of range if it was a <code>Variant&#47;Empty</code> undeclared variable. In other words, <code>Sheet1.Range(...)</code> fixes it."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548258230, "post_id": 54330677, "comment_id": 95479606, "body": "I&#39;ll add that <code>Sheet1</code> is the default <i>code name</i> of the &quot;Sheet1&quot; worksheet in a new workbook; it&#39;s a project-scoped identifier VBA creates for free, giving you a compile-time reference to that specific <code>Worksheet</code> object - thus, retrieving that object from the <code>Worksheets</code> collection is redundant altogether: <code>Sheet1.Range(...)</code> would be preferable -- and ideally, that sheet&#39;s <code>(Name)</code> property should be modified to a meaningful identifier, e.g. <code>SummarySheet</code>, which makes <code>SummarySheet.Range(...)</code> legal, without needing to declare any <code>SummarySheet</code> variable."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548258311, "post_id": 54330677, "comment_id": 95479667, "body": "@MathieuGuindon I will never explain things as well as you. Do you mind if I copy pasta, and attribute, your comment?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548259009, "post_id": 54330677, "comment_id": 95480056, "body": "The thing is, <code>Sheet1.Range(&quot;42N&quot;)</code> throws error 1004, not 13. I&#39;m not sure where the error is occurring in OP&#39;s code, but it has to be before that well spotted bug."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1548259153, "post_id": 54330677, "comment_id": 95480155, "body": "I personally don&#39;t like using the code name of the sheets, sometimes users plays with worksheets and copy/paste/rename them and that can break code easily. It&#39;s easy to tell them &quot;rename the worksheet&quot; than &quot;Open the VBE, look for the worksheet object, change the Name property&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1548259363, "post_id": 54330677, "comment_id": 95480285, "body": "@VincentG care to explain? Using the code name is <i>precisely</i> the only thing that prevents a user from breaking your code by merely moving or renaming a sheet, short of enabling workbook structure protection."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1548260079, "post_id": 54330677, "comment_id": 95480691, "body": "I agree it doesn&#39;t occurs often, and that I could probably prevent it by protecting the sheets, but we had some case where user made a &quot;work copy&quot; of a worksheet, put modification in it and then delete the original and rename the copy. If you do so, the code name is lost."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548260221, "post_id": 54330677, "comment_id": 95480796, "body": "haha yeah, users deleting worksheets is indeed a problem... the <code>Workbook.SheetBeforeDelete</code> event should probably be handled to prevent that ;-) (although, it can&#39;t be cancelled so the proper handling would be... a msgbox saying &quot;I&#39;m afraid I can&#39;t let you do that, Dave&quot;, followed by the workbook closing without saving."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1548260260, "post_id": 54330677, "comment_id": 95480823, "body": "users are always a problem ;)"}, {"owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "edited": false, "score": 0, "creation_date": 1548267710, "post_id": 54330677, "comment_id": 95484443, "body": "I got the data to copy and paste into the correct workbook. Thank you for the help! However, I have encountered another problem....haha...Instead of pasting on the next available row in the table is is jumping down 28 rows and then pasting..."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1548258802, "last_edit_date": 1548258802, "creation_date": 1548257609, "answer_id": 54330677, "question_id": 54330656, "link": "https://stackoverflow.com/questions/54330656/why-am-i-getting-a-type-mismatch-error/54330677#54330677", "title": "Why am I getting a &#39;type mismatch&#39; error?", "body": "<p>Your range needs to be for correct syntax</p>\n\n<pre><code>Range(\"A\" &amp; N)\n</code></pre>\n\n<p>You could also use</p>\n\n<pre><code>Cells(N, \"A\")\n</code></pre>\n\n<p>And <code>sheet1</code> should be <code>\"Sheet1\"</code> i.e. <code>Worksheets(\"Sheet1\")</code>. <code>Sheet1</code> by itself, unquoted, will be seen as a variable. Unless you have a string variable by that name? Use <code>Option Explicit</code> at the top of your module to check for variable declarations.</p>\n\n<hr>\n\n<p>Additional comment from @MathieuGuidon:</p>\n\n<p><em>I'll add that Sheet1 is the default code name of the \"Sheet1\" worksheet in a new workbook; it's a project-scoped identifier VBA creates for free, giving you a compile-time reference to that specific Worksheet object - thus, retrieving that object from the Worksheets collection is redundant altogether: Sheet1.Range(...) would be preferable -- and ideally, that sheet's (Name) property should be modified to a meaningful identifier, e.g. SummarySheet, which makes SummarySheet.Range(...) legal, without needing to declare any SummarySheet variable</em></p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1548262396, "creation_date": 1548262396, "answer_id": 54332087, "question_id": 54330656, "link": "https://stackoverflow.com/questions/54330656/why-am-i-getting-a-type-mismatch-error/54332087#54332087", "title": "Why am I getting a &#39;type mismatch&#39; error?", "body": "<blockquote>\n<pre><code>Destination1:=Worksheets(Sheet1).Range(N &amp; \"A\")\n</code></pre>\n</blockquote>\n\n<p>@QHarr <a href=\"https://stackoverflow.com/a/54330677/1188513\">correctly identified</a> the problem with <code>Range(N &amp; \"A\")</code>, and proposed a fix for the type mismatch error you're getting at <code>Worksheets(Sheet1)</code>.</p>\n\n<p>I just wanted to explain what's going on in more details than can fit a little comment box.</p>\n\n<p><code>Sheet1</code> is an implicitly declared object variable of type <code>Worksheet</code>, whose compile-time identifier is determined by the <code>(Name)</code> property of the worksheet:</p>\n\n<p><img src=\"https://i.stack.imgur.com/rq4i7.png\" alt=\"Sheet1 properties toolwindow showing the (Name) property\"></p>\n\n<p>If you change this property value to, say, <code>SummarySheet</code>, then <code>Sheet1</code> is no longer a valid identifier, and <code>SummarySheet</code> becomes one - and this is part of why specifying <code>Option Explicit</code> at the top of every module is important, because without it VBA will happily compile and run, except now instead of <code>Sheet1</code> being illegal, it's now an undefined <code>Variant/Empty</code> value that can merrily passed around accidentally, which can make things very hard to debug (the same holds true for <em>any</em> undeclared variable, not just worksheet code names).</p>\n\n<p>So <code>Sheet1</code> is a <code>Worksheet</code> object reference. If <code>Worksheet</code> had a <em>default member</em> that returned the value of its <code>Name</code> property, your code would work.</p>\n\n<p>But <code>Worksheet</code> doesn't have a <em>default member</em>, so <code>Worksheets(Sheet1)</code> is passing the <code>Worksheet</code> object reference as an argument to the <code>Worksheets.Item</code> indexer (implicitly - because the <code>Worksheets</code> class <em>does</em> have a default member, its <code>Item</code> property), which is expecting a <code>Variant</code> holding either the name of a worksheet (<code>Variant/String</code>), or a numeric index (<code>Variant/Integer</code> or <code>Variant/Long</code>).</p>\n\n<p>Passing a <code>Worksheet</code> object to <code>Worksheets.Item</code> is what's throwing the <em>type mismatch</em> error.</p>\n\n<p>Therefore, assuming that <code>Sheet1</code> worksheet is the intended destination, this would fix it (making abstraction of the <code>Range</code> parameter bug identified earlier by QHarr):</p>\n\n<pre><code>wbData.ActiveSheet.Paste Destination:=Sheet1.Range(...)\n</code></pre>\n\n<p>There is never a need to retrieve a worksheet that exists at compile-time in <code>ThisWorkbook</code>, from the <code>Worksheets</code> collection.</p>\n\n<p>Note that in the original code:</p>\n\n<blockquote>\n<pre><code>Destination1:=Worksheets(Sheet1).Range(N &amp; \"A\")\n</code></pre>\n</blockquote>\n\n<p>Since <code>Worksheets</code> isn't qualified, the <code>Workbook</code> it belongs to is ambiguous: if that code is written in <code>ThisWorkbook</code>, then <code>Worksheets</code> is a member call against <code>Me</code>, i.e. <code>ThisWorkbook.Worksheets</code>. Otherwise, it \"conveniently\" implicitly refers to <em>whatever workbook happens to be currently active</em>, and that's often a risky assumption for code to be making.</p>\n"}], "owner": {"reputation": 59, "user_id": 10686696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07876c4563e4bee7c2e30298223740cc?s=128&d=identicon&r=PG&f=1", "display_name": "mdavis0510", "link": "https://stackoverflow.com/users/10686696/mdavis0510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 54330677, "answer_count": 2, "score": 3, "last_activity_date": 1548262396, "creation_date": 1548257562, "last_edit_date": 1548258058, "question_id": 54330656, "link": "https://stackoverflow.com/questions/54330656/why-am-i-getting-a-type-mismatch-error", "title": "Why am I getting a &#39;type mismatch&#39; error?", "body": "<p>I am trying to copy a range from one workbook to a table in another workbook to capture production data. I am able to copy the correct range and open the workbook with the table successfully. However, when it tries to paste the information into the next available row in the table I get the error 13. I am rather new to vba and can't seem to find a solution, any help would be greatly appreciated. </p>\n\n<pre><code>Dim wbTime As Workbook\n   Set wbTime = ThisWorkbook\n\n   Dim wbData As Workbook\n\n   Dim N As Long\n   N = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\n   Dim UsdRws As Long\n   UsdRws = Cells.Find(\"*\", After:=Range(\"A32\"), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n   wbTime.ActiveSheet.Range(\"A6:O\" &amp; UsdRws).Copy\n\n   Set wbData = Workbooks.Open(\"S:\\Lean Carrollton Initiative\\Allen\\Buffering Interrupters\\1st Shift\\B10\\Data.xlsx\")\n\n   wbData.ActiveSheet.Paste Destination:=Worksheets(Sheet1).Range(N &amp; \"A\")\n\n   wbData.Close SaveChanges:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "utf-8"], "comments": [{"owner": {"reputation": 5450, "user_id": 2758823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Nxaq.jpg?s=128&g=1", "display_name": "Giacomo Catenazzi", "link": "https://stackoverflow.com/users/2758823/giacomo-catenazzi"}, "edited": false, "score": 0, "creation_date": 1548262596, "post_id": 54330347, "comment_id": 95482078, "body": "Look <a href=\"https://stackoverflow.com/questions/31435662/vba-save-a-file-with-utf-8-without-bom\" title=\"vba save a file with utf 8 without bom\">stackoverflow.com/questions/31435662/&hellip;</a> . IT is two stages: one you create a stream with BOM. Then you put your position to 3 (so after BOM). Second step: you copy from that stream. Because you start from byte 3, you will not copy BOM. Your error: you are moving to position 3 before you have 3 bytes on the file."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1548265405, "post_id": 54330347, "comment_id": 95483337, "body": "Show the error you get as copyable, searchable text in the body of the question."}, {"owner": {"reputation": 1, "user_id": 10921858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dced85c67ee509980b9dbf42973a83fa?s=128&d=identicon&r=PG&f=1", "display_name": "SachaCS", "link": "https://stackoverflow.com/users/10921858/sachacs"}, "edited": false, "score": 1, "creation_date": 1548265510, "post_id": 54330347, "comment_id": 95483384, "body": "I finally found what I wanted, but thks for the help ;)"}], "owner": {"reputation": 1, "user_id": 10921858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dced85c67ee509980b9dbf42973a83fa?s=128&d=identicon&r=PG&f=1", "display_name": "SachaCS", "link": "https://stackoverflow.com/users/10921858/sachacs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1645, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1595928129, "creation_date": 1548256546, "last_edit_date": 1548265451, "question_id": 54330347, "link": "https://stackoverflow.com/questions/54330347/vba-function-to-convert-csv-to-utf-8-without-bom", "title": "VBA Function to convert .csv to UTF-8 without BOM", "body": "<p>I made a macro that generate a .csv file with datas from an excel sheet.\nWhen I click on a button, this csv file is send to a server and is consummed after minutes.</p>\n\n<p>It works perfectly.</p>\n\n<p>The only problem is that this csv file is generated in UTF-8 with BOM and I don't want that, I need UTF-8 without BOM</p>\n\n<p>I got inspired from this function that I found simply and easy to read : \n<a href=\"https://stackoverflow.com/questions/25243803/use-adodb-stream-to-convert-ansi-to-utf-8-miss-1-2-character-in-the-first-row\">Use &quot;ADODB.Stream&quot; to convert ANSI to UTF-8, miss 1-2 character in the first row</a></p>\n\n<p>I tried to adapt it into this : </p>\n\n<pre><code>Function ConvertToUtf8(myFileIn, myFileOut)\n\n    Dim stream, strText\n    Set stream = CreateObject(\"ADODB.Stream\")\n\n    stream.Type = 2 'text\n    stream.Charset = \"_autodetect_all\"\n    stream.Open\n    stream.LoadFromFile myFileIn\n    strText = stream.ReadText\n    stream.Close\n\n    stream.Type = 2\n    stream.Charset = \"utf-8\"\n    stream.Open\n    stream.Position = 3 'without BOM (doesn't work)\n    stream.WriteText strText\n    stream.SaveToFile myFileOut, 2\n    stream.Close\n    Set stream = Nothing\n\nEnd Function\n</code></pre>\n\n<p>I don't know why but it creates the file into UTF-8 without BOM but this error pop-up :</p>\n\n<p>(<a href=\"https://imgur.com/a/FhJDAzh\" rel=\"nofollow noreferrer\">https://imgur.com/a/FhJDAzh</a>)</p>\n\n<p>I'm pretty sure I'm not far from the solution but I don't find it</p>\n\n<p>When I click on \"debug\", this line is in cause : </p>\n\n<pre><code>stream.Position = 3 'without BOM (doesn't work)\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Finally I found exactly what I was looking for, instead of a function which convert the file, a more efficient function to write directly in UTF-8 without BOM in the file :</p>\n\n<pre><code>Function WriteUTF8WithoutBOM(chaine As String, nomfichier As String)\nDim UTFStream As Object, BinaryStream As Object\nWith CreateObject(\"adodb.stream\")\n    .Type = 2\n    .Mode = 3\n    .Charset = \"UTF-8\"\n    .LineSeparator = -1\n    .Open\n    .WriteText chaine, 1\n    .Position = 3 'skip BOM\n   Set BinaryStream = CreateObject(\"adodb.stream\")\n        BinaryStream.Type = 1\n        BinaryStream.Mode = 3\n        BinaryStream.Open\n    'Strips BOM (first 3 bytes)\n    .CopyTo BinaryStream\n    .Flush\n    .Close\nEnd With\n        BinaryStream.SaveToFile nomfichier, 2\n        BinaryStream.Flush\n        BinaryStream.Close\nEnd Function\n</code></pre>\n\n<p>For the credit, I found it here <a href=\"https://www.excel-downloads.com/threads/question-de-conversion-en-utf-8-pour-une-vba-qui-enregistre-un-txt.20011510/\" rel=\"nofollow noreferrer\">https://www.excel-downloads.com/threads/question-de-conversion-en-utf-8-pour-une-vba-qui-enregistre-un-txt.20011510/</a>  (Staple1600 answer)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1548255224, "post_id": 54329773, "comment_id": 95477871, "body": "You&#39;ve got <code>Workbooks.Add</code> twice. Remove the first one and add a dot in front of the second one."}], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 9635098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a781d7fd3cacab5fbc08554bc8dfb759?s=128&d=identicon&r=PG&f=1", "display_name": "Beek", "link": "https://stackoverflow.com/users/9635098/beek"}, "is_accepted": true, "score": 0, "last_activity_date": 1548255654, "creation_date": 1548255654, "answer_id": 54330087, "question_id": 54329773, "link": "https://stackoverflow.com/questions/54329773/basic-macro-i-wrote-is-opening-two-workbooks-one-named-and-saved-as-intended-o/54330087#54330087", "title": "Basic macro I wrote is opening two workbooks (one named and saved as intended, one blank) - why?", "body": "<p>It seems to me your intention is for only 1 new workbook to be created and saved. \nYour code contains the     <code>workbooks.add</code> statement twice.\nSo taking the first out, should solve your problem.</p>\n\n<p>If that doesn't work, I would recommend declaring a <code>Workbook object</code>, and referencing that. </p>\n\n<p>Also the line <code>Sheets(\"Health Care\").Select</code> doesn't really do anything since your copy-statements include an explicit reference.</p>\n\n<p>Your code would look something like this: </p>\n\n<pre><code>Sub CreateHealthcare()\nDim NewBook as Workbook\n\n    Application.SheetsInNewWorkbook = 1\n\n    Set NewBook = Workbooks.Add\n\n            With NewBook\n\n                Workbooks(\"TVL Portfolio Creator.xlsm\").Sheets(\"Health Care\").Range(\"D:D\").Copy\n                .Sheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n                Workbooks(\"TVL Portfolio Creator.xlsm\").Sheets(\"Health Care\").Range(\"E:E\").Copy\n                .Sheets(1).Range(\"B1\").PasteSpecial Paste:=xlPasteValues\n\n                .Sheets(1).Name = \"Health Care Portfolio\"\n\n            End With\n\n        NewBook.SaveAs Filename:=\"C:\\Users\\example\\Health Care Portfolio\" &amp; Format(Now(), \" DDMMMYY\") _\n, FileFormat:=xlCSV, CreateBackup:=False\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10956316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e2474343ab252be7992bcf83f28cdb?s=128&d=identicon&r=PG&f=1", "display_name": "T F", "link": "https://stackoverflow.com/users/10956316/t-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 54330087, "answer_count": 1, "score": 0, "last_activity_date": 1548255654, "creation_date": 1548254662, "question_id": 54329773, "link": "https://stackoverflow.com/questions/54329773/basic-macro-i-wrote-is-opening-two-workbooks-one-named-and-saved-as-intended-o", "title": "Basic macro I wrote is opening two workbooks (one named and saved as intended, one blank) - why?", "body": "<p>I wrote a basic macro (very new to VBA) that extracts two columns from a workbook and puts them into a new workbook which I name and save. This works fine, but when I run it it opens and saves one as intended (e.g. \"Health Care Portfolio\") and opens (but doesn't name/save) a second blank book (with the standard \"Book #\" name). An excerpt of my code is below, could someone point out why this is happening? Thank you</p>\n\n<pre><code>Sub CreateHealthcare()\n\nSheets(\"Health Care\").Select\n\n    With Application\n        .SheetsInNewWorkbook = 1\n        .Workbooks.Add\n            With Workbooks.Add\n\n                Workbooks(\"TVL Portfolio Creator.xlsm\").Sheets(\"Health Care\").Range(\"D:D\").Copy\n                .Sheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n\n                Workbooks(\"TVL Portfolio Creator.xlsm\").Sheets(\"Health Care\").Range(\"E:E\").Copy\n                .Sheets(1).Range(\"B1\").PasteSpecial Paste:=xlPasteValues\n\n                .Sheets(1).Name = \"Health Care Portfolio\"\n\n            End With\n\n        ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\example\\Health Care Portfolio\" &amp; Format(Now(), \" DDMMMYY\") _\n, FileFormat:=xlCSV, CreateBackup:=False\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1548255541, "post_id": 54329511, "comment_id": 95478081, "body": "I just tried the exact same procedure and can not reproduce the behavior."}, {"owner": {"reputation": 11, "user_id": 5273732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/637ca072489d238471ab6a1a21354f2f?s=128&d=identicon&r=PG", "display_name": "Simon Sawyer", "link": "https://stackoverflow.com/users/5273732/simon-sawyer"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1548307587, "post_id": 54329511, "comment_id": 95496046, "body": "Are you saying it worked for you? You did the above and when you pressed the button it popped up with that message?"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1548545040, "post_id": 54329511, "comment_id": 95580265, "body": "sorry for the late reply. Yes it did, and every time i clicked cb1 it would close and reopen the form. To stop the loop you had to press the close(X) button."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 9281303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/075rM.png?s=128&g=1", "display_name": "Ferd", "link": "https://stackoverflow.com/users/9281303/ferd"}, "is_accepted": false, "score": 0, "last_activity_date": 1595523415, "creation_date": 1595523415, "answer_id": 63059401, "question_id": 54329511, "link": "https://stackoverflow.com/questions/54329511/how-do-i-hook-into-a-button-click-event-on-a-custom-form/63059401#63059401", "title": "How do I hook into a button click event on a custom form?", "body": "<p>That's because you're using the Project's VBA editor.</p>\n<p>You must use the button's script editor.</p>\n<p>For example:</p>\n<p><strong>1)</strong> Select the button</p>\n<p><strong>2)</strong> Open script editor</p>\n<p><strong>3)</strong> Write your code</p>\n<p><a href=\"https://i.stack.imgur.com/yoi9E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yoi9E.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 11, "user_id": 5273732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/637ca072489d238471ab6a1a21354f2f?s=128&d=identicon&r=PG", "display_name": "Simon Sawyer", "link": "https://stackoverflow.com/users/5273732/simon-sawyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1599743321, "creation_date": 1548253848, "last_edit_date": 1599743321, "question_id": 54329511, "link": "https://stackoverflow.com/questions/54329511/how-do-i-hook-into-a-button-click-event-on-a-custom-form", "title": "How do I hook into a button click event on a custom form?", "body": "<p>I'm trying to write a Custom Form in Outlook 365 (only interested in desktop Outlook).</p>\n<p>I click New Email, Developer Tab, Design this form. I add a new button. The default name is &quot;CommandButton1&quot;. I then click &quot;View Code&quot; and put:</p>\n<pre><code>Sub CommandButton1_Click()\n    MsgBox &quot;Hello World&quot;\nEnd Sub\n</code></pre>\n<p>I then &quot;Run this form&quot;, click the button and... nothing.</p>\n<p>How do I hook into the Click Event of this custom button control on a custom Outlook Form?</p>\n"}, {"tags": ["excel", "vba", "optimization"], "comments": [{"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548253877, "post_id": 54329409, "comment_id": 95476936, "body": "Peh, did you provide any answer ? I see that you wrote something but can&#39;t see what you wrote."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1548254236, "post_id": 54329409, "comment_id": 95477219, "body": "Look into the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Range.Find method</a>.  You can use this to search for &quot;First name&quot; and use the found cell without actually knowing its position beforehand.  Then you&#39;ll just need to learn how to <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">Loop though files in a folder</a>.  That should give you a place to start."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548254395, "post_id": 54329409, "comment_id": 95477312, "body": "@JustGreat no, just corrected your tags. But I was about to write the same comment as tigeravatar. \u2022 Your question is too broad to provide a answer because you did nothing yet. Give the method in the comment above a try."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548255056, "post_id": 54329409, "comment_id": 95477760, "body": "thanks to both...Looping through a folder I already know how to do so this is not the problem... As for the Range.Find, you mean that I check the headers of each data to get the values ? is it faster than telling I need the data at the position 1,2 let us say ?  Also I am thinking about something. the range.find will give me the position of the header, so I should make an offset to get the value right ? and if yes, this mean that if one day, we add a column or line or a small cell betweek the headers and the values, I should review the whole code right ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548255580, "post_id": 54329409, "comment_id": 95478105, "body": "Is the name <code>Model 1</code> etc always in <code>Cells(1, 6)</code>? Then you could read this cell to decide which model it is and where the other data is expected. That would be faster than using <code>find()</code>."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548257449, "post_id": 54329409, "comment_id": 95479174, "body": "Thanks PEH, so you mean that if I know that for model 1, the first name is at position 2,3, for model 2, at position 5,6 etc.it&#39;s better that I make a kind of select case, case model 1, i read my 80 cells from where I know they are etc.so this is what I called in my ideas above (reading data based on columns and row indexes) can you check my last paragraph which is another idea of that kind but a little bit more flexible, instead of specifying in my code that the first name is at this or that position,I create a sheet where I say the position of each fields based on model.is it gonna be slow?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548257909, "post_id": 54329409, "comment_id": 95479427, "body": "@JustGreat Have a look at my answer below. I think the <code>match</code> will still be faster than a <code>find</code>. To be even more faster you could cache the rows/columns data of the lookup table in an array to look it up there (which makes it a bit more complicated). Start with the idea below and if you need to improve speed go further caching it into an array."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548412257, "post_id": 54329409, "comment_id": 95540900, "body": "@P\u1d07\u029c can you please tell me more about your idea of caching the lookup into an array ? should I make an array of user defined type, something like    Type LookupTable    Field As String     lRow As Integer     lCol As Boolean  End Type    Dim myArray (LastRow) as LookupTable  or a normal array like Dim myArray (LastRow, 3) as string   and to fill the array, it&#39;s better to do something like MyArray =Range(&quot;A1&quot;, Range(&quot;C1048576&quot;).End(xlUp)) or to loop and fill it row by row ?  and can I later apply the function match to the array ? Or i create a normal loop to find my items ?"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548412541, "post_id": 54329409, "comment_id": 95541080, "body": "@P\u1d07\u029c I am sorry in my above comment my code is on the same line, the site doesn&#39;t allow multi lines a it seems in comments, so if you can copy paste it to notepad, you will be able to read better my question about arrays"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548412604, "post_id": 54329409, "comment_id": 95541107, "body": "@JustGreat I made an edit to my answer. Please also read the comments below my answer."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548414488, "post_id": 54329409, "comment_id": 95542020, "body": "@P\u1d07\u029c thanks a lot, I saw that after I wrote the comment....By the way there is something that I can&#39;t understand on this site, someone put me -1 to my question ! what does mean a -1 on a question ? you ask a question, we note the question itself ? That makes no sens. There is nothing called a bad question, and the one who voted -1 could have try to help like you did instead of voting without beeing helpfull.thank you Peh again for your support and help."}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548410268, "post_id": 54330273, "comment_id": 95539741, "body": "Thanks a lot Peh, that&#39;s exactly what i was thinking about in my last idea when talking about making it something flexible.  To make the match function faster, should I use something like  .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row instead of Range(&quot;A:A&quot;) ?  Anyway, do you think that the code will not be very slow if i have to read 200 workbook and in each workbook there is between 60-80 fields to read with the ReadField function (number of fields depends on the template). what do you think ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548413766, "post_id": 54330273, "comment_id": 95541683, "body": "Of course you can try to limit your range instead of using the full column (but I never tested if there is a speed benefit at all, because I hope the lookup will do that limitation automatically too.) \u2022 I improved the function using an array to cache the table, so the lookups will be faster (see my edit). The previous issue isn&#39;t in count anymore, the cache only contains the data. \u2022 Of course 200 workbooks will still need their time. But I see no other option to get this even faster. Caching made that function about 2 times faster."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548414270, "post_id": 54330273, "comment_id": 95541932, "body": "Thanks a lot.So in your example, LookupCache  will be an array representing the field names and LookupResults the positions. I am thinking about making 3 lookuptable, one for each model Simply because I have 80 fields,so to avoid scrolling a lot, and if I do so, my field column, will not be called model1-FirstName, it will be directly FirstName on each model. Anyway I am still wating users to send me the 200 files to try all that, once again thanks a lot Peh you are very helpfull and if you got more ideas don&#39;t hesitate to update the answer.I will tag it as answered once I finish work on it."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548414678, "post_id": 54330273, "comment_id": 95542113, "body": "@JustGreat Don&#39;t split up the lookup table into models! If you need to add a model later, you will have to start coding again, and code gets easily messed. Keep it like it is and you can add as many models as you like and code keeps clean. \u2022 If you like use filters on your LookupTable to get a better view on one selected model only \u2022 If this answered your question please mark it as solved: <a href=\"https://meta.stackexchange.com/a/5235\">Accepting Answers: How does it work?</a>"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548432135, "post_id": 54330273, "comment_id": 95551710, "body": "I didn&#39;t undestand Why do you suggest me not to split it into a lookupsheet for each model ? what I was imagining is making 3 lookup sheet one by model, and in my code, I do something like for each sheet in my wb, if sheetname = model X, then I read the corresponding model sheet, and if i want to add a new model one day, I add a new sheet called model 4 etc... so can you tell me please the disadvantage ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548507325, "post_id": 54330273, "comment_id": 95570627, "body": "@JustGreat But if you read the model sheet each time the model changes then there is no caching anymore. So you will need to read all models at once and keep them in cache anyway"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548513053, "post_id": 54330273, "comment_id": 95572049, "body": "@Peh I see what you mean, in case I want still to do in separate sheets, I can keep the main lookup sheet as you did, and create a lookup sheet for each model, at the beginning of my code, I copy all lookup sheets into the main lookup sheet, and I work normally on the main lookup sheet so that I can use the caching the way you did"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548591592, "post_id": 54330273, "comment_id": 95588133, "body": "@JustGreat Well you can but I see no benefit in that."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 2, "creation_date": 1548638544, "post_id": 54330273, "comment_id": 95600534, "body": "@JustGreat You forgot to mark PEH&#39;s answer as &quot;Selected&quot;."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548797245, "post_id": 54330273, "comment_id": 95669762, "body": "@P\u1d07\u029c I will tag your solution as answered thanks a lot, on the same time Variatus provided me an answer when I was asking about arrays to pass to your function. Based on ur code, variatus proposed to use enum which is good to avoid &#39;find&#39; and strings&#39;s concatanation.Any idea which one is more performant ?if I know that the info in excel are strings, I keep the array as variant? or i make it strings ? and CVErr(xlErrNA) will return N/A in case of error ?right?<a href=\"https://stackoverflow.com/questions/54383897/best-way-to-copy-ranges-from-different-sheets-and-store-them-into-an-array/54384878#54384878\" title=\"best way to copy ranges from different sheets and store them into an array\">stackoverflow.com/questions/54383897/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548832008, "post_id": 54330273, "comment_id": 95679319, "body": "If you read a range into an array it has to be variant. And yes <code>CVErr(xlErrNA)</code> will return the error <code>N&#47;A</code>."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548840259, "post_id": 54330273, "comment_id": 95683692, "body": "@P\u1d07\u029c thanks again for your efforts, you are a very good helper and I learned many things from your answer above. by the way, did you check the solution proposed by variatus ? what do you think about using the enum, isn&#39;t it better than FIND methode ? do you suggest me to use the find as in your example or to go for the enum which seems good as well ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548841196, "post_id": 54330273, "comment_id": 95684232, "body": "Using enum has one big disadvantage: If you need to add fields or templates you need to start coding again. That means someone who is able to code (=expensive person) needs to work for this. If you seperate your data (like fields name etc) into a sheet <i>everyone</i> (who reads the hopefully existing explanation about the sheet) can add fields (without knowledge of coding). I recommend always to seperate code logic and data, and never hardcode data into code (that&#39;s best practice). By the way I didn&#39;t use <code>Find</code> I used <code>Match</code>."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548845979, "post_id": 54330273, "comment_id": 95687212, "body": "@P\u1d07\u029c I totally agree, and it&#39;s exactly what I want, after I finish the project that I am working on, someone who is not programmer can maintains it to add new model and fields. The problem is that I am not understanding honestly why with enum I will need someone to code and how in your proposed solution I will not need someone to code later on. Maybe I missunderstand something but in the coming comment I will explain"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548846434, "post_id": 54330273, "comment_id": 95687504, "body": "@P\u1d07\u029c to complete my idea, and why I don&#39;t understand, In the solution right above, I should call the function that way: ReadField(MyLoopWorkbook.Worksheets(&quot;MyTemplate&quot;),&quot;First name&quot;). If we added a new field Company to a new model4,a user must go to the sheet lookuptable and add Model4-Company at line 11 with the row and col, but also in the code he has to go and add ReadField(MyLoopWorkbook.Worksheets(&quot;MyNewTemplate&quot;), &quot;Company&quot;), right?That&#39;s why I am not understanding how I can count only on persons who don&#39;t code to add that?Can you clarify please because what you said is really important"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548847358, "post_id": 54330273, "comment_id": 95688075, "body": "@JustGreat just make reading fields dynamic too. See my edit."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548859417, "post_id": 54330273, "comment_id": 95695374, "body": "@P\u1d07\u029c that&#39;s a good addition.I understand now, that with enum, If i want to add something I should go to the code and add it to the enum,while here any user can just have to add it to Excel(-&gt;Flexible). I am thinking about changing the lookup table, can you check my edited pic above? what do you think ? I said that this way i will have row, col and range, in case I need in my code I don&#39;t have to calculate,all will be in my lookup, also visually it&#39;s easiar for a user to fill it,instead of filling template-field and to avoid string concatenation, what do you think ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548860065, "post_id": 54330273, "comment_id": 95695832, "body": "@JustGreat No good idea. As I already told you this will mess up your code a lot. Keep it in one place as in my example. Same data has to be in the same position (thats how you do it). \u2022 For better usability you could auto generate the the lookup-value out of a <code>Model</code> and <code>Field</code> column by using the formula <code>=A:A &amp; &quot;-&quot; &amp; B:B</code> (where A is the Model and B the Field column) so the user can enter it more easily and it concatenates automatically. Note that you don&#39;t need both <code>rng</code> and <code>row&#47;column</code> decide for one of it and adjust the code accordingly. Don&#39;t use both at the same time!"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548862732, "post_id": 54330273, "comment_id": 95697699, "body": "@P\u1d07\u029c Thanks. Auto generate the lookup-value, is a good idea. I will do that. What about if I autogenerate the lookup that you suggested, based on the lookup I suggested ? I mean the user will fill a sheet that looks like the pic I proposed and with formulas excel will autofill the lookup that you suggested and the code will work on that ?  any inconvinience if I do it that way ? Regarding that I have to choose if I want to work on ranges or ROW/COL I think that ROW/COL is better except if you have opinion. Thanks again those are my last questions about this subject"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548863297, "post_id": 54330273, "comment_id": 95698020, "body": "It will be the same mess to convert that table from your format into mine and there will be no great advantage just disadvantages of converting and non-consistent data. Just in case if you ask again I will still tell you &quot;don&#39;t do that&quot;. \u2022 In <code>Rng</code> vs <code>row&#47;col</code> the range might be a slightly faster because you only need to handle 1 variable instead of 2. And ranges might be more convenient for the user. Anyway both will work and there will be no big difference."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548864273, "post_id": 54330273, "comment_id": 95698571, "body": "@P\u1d07\u029c can you check last Edit ? is that what do you suggest ?I can invert the place of col and row to fit your code, but I wanted to make sure that I got it well this time..By the way, If Ranges are faster in this case I will use Ranges, I thought that Row Col is better when in code you wanna reference a cell. if range are faster I will directly do ranges"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 1, "creation_date": 1548865440, "post_id": 54330273, "comment_id": 95699326, "body": "@JustGreat almost it should be  <code>Model - Field</code> to work with my code. And Excel formulas calculate faster from left to right so the best column order would be <code>Template</code>, <code>Field</code> and then <code>Autofill</code>."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548866415, "post_id": 54330273, "comment_id": 95699982, "body": "@P\u1d07\u029c I never knew that the order may affect the performance! is it normal ? anyway I changed the order as suggested but in this case I should make Your lookupcache start at C, and your lookup LookupResults at D. I can also replace the R C by ranges like &quot;A1&quot; etc...to make it faster (plz check pic back now)"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548870751, "post_id": 54330273, "comment_id": 95702311, "body": "I just discovered something that Will cause me problem...i may have in some of the templates comboboxes....i should thibk about solving that :("}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 1, "creation_date": 1548918215, "post_id": 54330273, "comment_id": 95718174, "body": "@JustGreat the performance difference between ranges and row/column is minimal, because you read it only once into the array cache and so you can ignore this 1/10 second you could win here. Use the one that suits better to you and your users. \u2022 Calculation order in Excel is from left/top to right/bottom, so if you calculate in <code>A1 = B1 + C1</code> (and B1 and C1 are also formulas) then Excel starts with A1 then calculates B1 which triggers a change in A1 again, then calculates C1 which triggers again a change in A1. So it has to calculate A1 multiple times. So it&#39;s better to calc <code>C1 = A1 + B1</code>."}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548931768, "post_id": 54330273, "comment_id": 95725625, "body": "@P\u1d07\u029c thanks a lot, you teached me lots of things and now I understand why the order is important. I thought about how to solve the presence of controls checkbox or combobox in some sheets template and I will do something like a new procedure that execute after yours to treat only controls  : For Each obj In Sheets(1).OLEObjects ... check the type using if TypeName(obj.Object) = &quot;CheckBox&quot; and get the values and store them . The only thing I never understood why we need to do Obj.Object and not directly Obj to get the type of active x controls :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 1, "creation_date": 1548932986, "post_id": 54330273, "comment_id": 95726309, "body": "@JustGreat That&#39;s just how it is designed <code>Obj.Object</code> ask Microsoft why they did it that way ;)"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 0, "creation_date": 1548934114, "post_id": 54330273, "comment_id": 95726952, "body": "YES :), but they design it as it seems like if an oleobject itself doesn&#39;t have too much properties, but one of the few properties is an OBJECT and inside this OBJECT we find our real properties. like of oleobject is a canvas and real object is inside the OBJECT; Anyway I will do that to get the controls"}, {"owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "edited": false, "score": 1, "creation_date": 1549380687, "post_id": 54330273, "comment_id": 95877053, "body": "@P\u1d07\u029c Just faced an error with the ReadField function, I added Byval to make it work, if you call it from <b>ReadAllFields</b> without adding byval you will get an error that you can&#39;t pass ByRef value to it. so i maded it like that <code>ReadField(Ws As Worksheet, ByVal FieldName As String) </code>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1548847329, "last_edit_date": 1548847329, "creation_date": 1548256317, "answer_id": 54330273, "question_id": 54329409, "link": "https://stackoverflow.com/questions/54329409/vba-excel-getting-same-data-from-different-sheets-at-different-positions/54330273#54330273", "title": "VBA - Excel Getting same data from different sheets at different positions", "body": "<p>The basic idea (beside looping through your files):</p>\n\n<ol>\n<li><p>Change your lookup data into the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9J5oI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9J5oI.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Then read <code>Cells(1, 6)</code> to get your model.</p>\n\n<pre><code>Dim Model As String\nModel = Worksheets(\"MyTemplate\").Cells(1, 6).Value\n</code></pre></li>\n<li><p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.WorksheetFunction.Match\" rel=\"nofollow noreferrer\">WorksheetFunction.Match method</a> to find your field in the lookup table.</p>\n\n<pre><code>Dim FieldRow As Long\nFieldRow = Application.WorksheetFunction.Match(Model &amp; \"-First name\", Worksheets(\"LookupTable\").Range(\"A:A\"), 0)\n</code></pre></li>\n<li><p>Use \u2026</p>\n\n<pre><code>fRow = Worksheets(\"LookupTable\").Cells(FieldRow, 2)\nfColumn = Worksheets(\"LookupTable\").Cells(FieldRow, 3)\n</code></pre>\n\n<p>To get row and column where to look for that field in your template.</p></li>\n</ol>\n\n<p>If you put the field lookup stuff into a handy function, the code would get easier to maintain. For example put the following into a module:</p>\n\n<pre><code>Option Explicit\n\nPublic LookupCache As Variant\nPublic LookupResults As Variant\n\nPublic Function ReadField(Ws As Worksheet, FieldName As String) As Variant\n    'Here we cache the lookup table. It reads the sheet LookupTable into an \n    'array if the array does not exist yet. If the function runs a second time,\n    'the array exists already and is used directly (saves time).\n    'Lookup in arrays is much faster than in cells.\n    'Caching makes this function about 2 times faster than without.\n    If IsEmpty(LookupCache) Or IsEmpty(LookupResults) Then\n        With ThisWorkbook.Worksheets(\"LookupTable\")\n            Dim LastLookupRow As Long\n            LastLookupRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n            LookupCache = .Range(\"A2\", \"A\" &amp; LastLookupRow).Value\n            LookupResults = .Range(\"B2\", \"C\" &amp; LastLookupRow).Value\n        End With\n    End If\n\n    Dim ModelName As String\n    ModelName = Ws.Cells(1, 6).Value\n\n    Dim LookupRow As Long\n    On Error Resume Next\n    LookupRow = Application.WorksheetFunction.Match(ModelName &amp; \"-\" &amp; FieldName, LookupCache, 0)\n    On Error GoTo 0\n\n    If LookupRow = 0 Then\n        'field not found\n        ReadField = CVErr(xlErrNA)\n        Exit Function\n    End If\n\n    Dim fRow As Long, fColumn As Long\n    fRow = LookupResults(LookupRow, 1)\n    fColumn = LookupResults(LookupRow, 2)\n\n    ReadField = Ws.Cells(fRow, fColumn).Value\nEnd Function\n</code></pre>\n\n<p>So you could read a field like </p>\n\n<pre><code>Debug.Print ReadField(MyLoopWorkbook.Worksheets(\"MyTemplate\"), \"First name\")\n'MyLoopWorkbook should be the current workbook in your files loop\n</code></pre>\n\n<hr>\n\n<p>Edit according to the comment \u2026</p>\n\n<blockquote>\n  <p>If we added a new field <code>Company</code> to a new model4,a user must go to the sheet lookuptable and add <code>Model4-Company</code> at line 11 with the row and col, but also in the code he has to go and add <code>ReadField(MyLoopWorkbook.Worksheets(\"MyNewTemplate\"), \"Company\")</code>, right? That's why I am not understanding how I can count only on persons who don't code to add that? Can you clarify please because what you said is really important.</p>\n</blockquote>\n\n<p>If you make the <code>ReadField</code> part dynamic you don't need to code here too. For example if you want to end up with a table like that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qRVK6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qRVK6.png\" alt=\"enter image description here\"></a></p>\n\n<p>You would just add a new header in column 4 called like the field eg <code>Company</code>. And write a loop that loops throug the columns of that header row to collect all fields.</p>\n\n<pre><code>Sub ReadAllFields()\n    Dim wsData As Worksheet\n    Set wsData = Worksheets(\"CollectedData\")\n\n    Dim FreeRow As Long 'find next free row in table\n    FreeRow = wsData.Cells(wsData.Rows.Count, \"A\").End(xlUp).Row + 1\n\n    Dim Fields() As Variant 'read headers into array\n    Fields = wsData.Range(\"A1\", wsData.Cells(1, wsData.Columns.Count).End(xlToLeft)).Value\n\n    Dim iCol As Long\n    For iCol = 1 To UBound(Fields, 2) 'loop through header columns\n        wsData.Cells(FreeRow, iCol).Value = ReadField(MyLoopWorkbook.Worksheets(\"MyNewTemplate\"), Fields(1, iCol)) \n        'reads fields dynamically depending on which headers exist in data sheet\n    Next iCol\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 511080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bac7b768f76267ab0c1db86d07b15fa8?s=128&d=identicon&r=PG", "display_name": "JustGreat", "link": "https://stackoverflow.com/users/511080/justgreat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 54330273, "answer_count": 1, "score": -1, "last_activity_date": 1548866375, "creation_date": 1548253497, "last_edit_date": 1548866375, "question_id": 54329409, "link": "https://stackoverflow.com/questions/54329409/vba-excel-getting-same-data-from-different-sheets-at-different-positions", "title": "VBA - Excel Getting same data from different sheets at different positions", "body": "<p>I want to make a macro that will open all excel books in a folder, read the filled information and store them in a sheet which will represent my database.\nI need to know your suggestions and what is the best way to do that, to get a fast and flexible result.</p>\n\n<p>To help you understand my question, let us suppose that I have 3 excel templates containing First Name, Last Name and Country, but at different positions like these pictures</p>\n\n<p><strong>Template 1</strong>\n<a href=\"https://i.stack.imgur.com/pCL2u.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pCL2u.jpg\" alt=\"Template1\"></a></p>\n\n<p><strong>Template 2</strong>\n<a href=\"https://i.stack.imgur.com/zkK26.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zkK26.jpg\" alt=\"Template2\"></a></p>\n\n<p><strong>Template 3</strong>\n<a href=\"https://i.stack.imgur.com/2xAU7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2xAU7.jpg\" alt=\"Template3\"></a></p>\n\n<p>Based on that, the final result that I would like to get is :\n<a href=\"https://i.stack.imgur.com/77i9z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/77i9z.jpg\" alt=\"Result\"></a></p>\n\n<p>The exemple that I am giving by these pictures is really very simple, but it was just to help you understand what I want. Now I will detail about the real need. In fact, I have 3 templates, but each of them contains about 80 fields of data to collect (not only first name, last name and country). And i don't have to read only 3 files, but I have to read about 200 files placed in a folder and each of them is either template1, or 2 or 3. In the future we may have a template 4 that's why I need something flexible.</p>\n\n<p>I thought about named ranges, but the template 1,2,3 already exists, and I can't collect from the 200 users the 200 existing excels files, and before launching my macro, giving a named range to the 80 field at each file. I can use named range if in the future they will be a template 4, so before sending the files to the final user who will fill the excel we name the ranges and send it to him, but before the template 4,i have to fix the problem of the current 3 existing templates.</p>\n\n<p>I also thought about reading data based on columns and row indexes,for exemple I check the type of file and if I am reading a file template one, I get first name from the cell (2,3), and If it's a template 2, i get the information from cell (5,6) and if it's a template 3, i get the information from Cel (9,4), but the problem is that my code will not be at all flexible.</p>\n\n<p>I also said, I may do like a sheet called reference, in which I define the positions of each field based on the template model, for example I say that the first name is for template 1 at the position 2,3 for the template 2, first name is at 5,6 and for template3 it's at 9,4. Like the following picture, and when I loop through my 200 files, I check, if it's template 1 i read the sheet of reference and I know that the first name will be at this position, same for template 2 and so on....this solution looks like previous one, but more flexible, because all we have to change is the reference table if something changes, but I am wondering if it will be fast or slow if for each field i have to come read 2 cells in the reference sheet to know the position. \n<a href=\"https://i.stack.imgur.com/FfDbE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FfDbE.png\" alt=\"Sheet Reference\"></a></p>\n\n<p>I am really lost because I have to choose the best way to do what I want before start coding to avoid time wasting. \nIf any expert can help by telling me what is best or giving me more ideas than what I thought about I will really appreciate.</p>\n\n<p>Thanks in advance to any helper</p>\n\n<p>EDIT:\n@PEH, what do you think about if I make my lookup table like that ?\n<a href=\"https://i.stack.imgur.com/xmm6f.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xmm6f.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT2:\n@PEH, that's what is suggested in last comment \n<a href=\"https://i.stack.imgur.com/QAFkU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QAFkU.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548252640, "post_id": 54329066, "comment_id": 95476195, "body": "The way you use <code>On Error Resume Next</code> is a very bad practice. This line hides <b>all</b> error messages but the errors still occur, you just cannot see them because it makes you blind. But the issue is that you cannot fix error that you don&#39;t see. If you don&#39;t fix them your code doesn&#39;t work. Remove these <code>On Error Resume Next</code> lines completely and fix the errors you get properly."}, {"owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548252868, "post_id": 54329066, "comment_id": 95476315, "body": "The errors that I am getting are because the cell name doesn&#39;t exist or it can&#39;t match up the cell correctly. I understand it is bad practice, but the errors that it is ignoring don&#39;t concern me at this point."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548253079, "post_id": 54329066, "comment_id": 95476425, "body": "Then fix it that way, that it <b>only</b> ignores the specific errors you want and not <b>every</b> error as it does at the moment. You cannot debug/work on your code in this state as it is properly. Make sure <code>On Error Resume Next</code> is exactly before the line where you expect the error and use <code>On Error Goto 0</code> right after the line you expect the error to re-enable error reporting! Also see <a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548253148, "post_id": 54329066, "comment_id": 95476468, "body": "Note that <code>On Error Resume Next</code> will not only hide the <b>next</b> error message as it looks like. Instead it hides <b>all</b> messages until <code>On Error Goto 0</code> or <code>End Sub</code>"}, {"owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548253292, "post_id": 54329066, "comment_id": 95476542, "body": "I removed it, and there were no errors."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548253572, "post_id": 54329066, "comment_id": 95476719, "body": "OK, now we can work on the code ;) It looks like this txt file is using fixed length for each field. So you must count how many characters each field has and use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/mid-function\" rel=\"nofollow noreferrer\">Mid function</a> to split each line apart. Alternatively you might want to have a look at the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.TextToColumns\" rel=\"nofollow noreferrer\">Range.TextToColumns method</a> using <code>DataType:=xlFixedWidth</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548253983, "post_id": 54329066, "comment_id": 95477020, "body": "Also using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.querytable\" rel=\"nofollow noreferrer\">QueryTable</a> with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.querytable.textfileparsetype\" rel=\"nofollow noreferrer\">QueryTable.TextFileParseType property</a> <code>xlFixedWidth</code> might be an option here."}, {"owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548254846, "post_id": 54329066, "comment_id": 95477607, "body": "It looks as if your suggestions are importing the entire txt file into a sheet versus just reading the txt file and splitting the rows based on a delimiter into an array. So I may be confused on how to use them."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548255138, "post_id": 54329066, "comment_id": 95477815, "body": "My first suggestion using <code>Mid()</code> would fit into your approach. You would use it on your <code>Ln</code> variable to extract each data field by their field length. \u2022 My second idea splits a text that is in a cell eg A1 into multiple columns (therefore the text needs to be already imported in a cell, you would need to put the complete <code>Ln</code> into a cell first). \u2022 My third idea is completely different form your approach and queries the txt file directly (incl. splitting fields by fixed width). You would start from scratch here."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1548268300, "post_id": 54329066, "comment_id": 95484720, "body": "How do you want it to split?  <code>Power Query</code>, aka <code>Get &amp; Transform</code> can usually handle any particular delimiter, although, if you do this in code, you may have to write some code to detect the delimiter."}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1548261528, "creation_date": 1548261528, "answer_id": 54331833, "question_id": 54329066, "link": "https://stackoverflow.com/questions/54329066/convert-a-txt-file-that-uses-space-delimiter-to-tab-delimiter/54331833#54331833", "title": "Convert a txt file that uses space delimiter to tab delimiter", "body": "<p>Try</p>\n\n<pre><code>Sub Test()\n\n    Dim PathName As String\n    Dim usFileName  As String\n\n    PathName = \"Your path\"\n    usFileName = PathName &amp; \"\\\" &amp; \"Prices.txt\"\n\n    Workbooks.OpenText Filename:=usFileName, _\n        StartRow:=1, DataType:=xlFixedWidth, FieldInfo:=Array(Array(0, 1), _\n        Array(19, 1), Array(32, 1), Array(48, 1), Array(55, 1))\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "edited": false, "score": 0, "creation_date": 1548272730, "post_id": 54334404, "comment_id": 95486660, "body": "Yeah, i&#39;ve tried to do this. Even when i import the file into excel using something like Power Query, it throws a fit too. The only way to get the columns i need is to use a fixed with."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "edited": false, "score": 0, "creation_date": 1548273305, "post_id": 54334404, "comment_id": 95486879, "body": "OK, I added an additional section of code at the end of my answer. Try that out."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548313891, "post_id": 54334404, "comment_id": 95498187, "body": "@IAmNerd2000 Be careful, you cannot remove the spaces. This will crash your data, eg if one field is empty all other fields will move one field left then! So the position of the data changes column. This can only be solved with fixed length fields."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548700793, "post_id": 54334404, "comment_id": 95627405, "body": "@P\u1d07\u029c I supplied the OP with two different options. If you look at the 2nd you will see that I offered a fixed width version as well (with just the mid function). Thx tho."}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 0, "last_activity_date": 1548273267, "last_edit_date": 1548273267, "creation_date": 1548271886, "answer_id": 54334404, "question_id": 54329066, "link": "https://stackoverflow.com/questions/54329066/convert-a-txt-file-that-uses-space-delimiter-to-tab-delimiter/54334404#54334404", "title": "Convert a txt file that uses space delimiter to tab delimiter", "body": "<p>You can try removing spaces and replacing them this way:</p>\n\n<pre><code>    Ln = US.ReadLine\n    Do While (InStr(Ln, \"  \") &gt; 0)\n        Ln = Replace(Ln, \"  \", \" \")\n    Loop\n    'The only problem I see is the case where you have Time (6:00 PM) this \n    '    would replace the space with Tab. in that case, I would do the following:\n    Ln = Replace(Ln, \" PM\", \"PM\")\n    Ln = Replace(Ln, \" AM\", \"AM\")\n    Ln = Replace(Ln, \" \", vbTab)\n\n    'And then put them back\n    Ln = Replace(Ln, \"PM\", \" PM\")\n    Ln = Replace(Ln, \"AM\", \" AM\")\n\n    'Finally, split the columns\n    Cols = Split(Ln, vbTab)\n</code></pre>\n\n<p>If you want to try with fixed width then do the following (after Ln = US.Readline):</p>\n\n<pre><code>    '01/11/2019 06:00 PM  USO-FOX-USO  E10           8.9929     0.0000    \n    'Do the following only if (InStr(Ln, \"  \") &gt; 0)\n    strCol1 = Mid(Ln, 1, 21)  \n    strCol2 = Mid(Ln, 22, 13)  \n    strCol3 = Mid(Ln, 35, 13)  \n    strCol4 = Mid(Ln, 48, 11)  \n    strCol5 = Mid(Ln, 59, Len(Ln))  \n\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 2482985, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f6fcec1fa6a36d3bbe4dc6ff129fe1ef?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/2482985/geoffrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 54334404, "answer_count": 2, "score": 0, "last_activity_date": 1548273267, "creation_date": 1548252399, "last_edit_date": 1548252448, "question_id": 54329066, "link": "https://stackoverflow.com/questions/54329066/convert-a-txt-file-that-uses-space-delimiter-to-tab-delimiter", "title": "Convert a txt file that uses space delimiter to tab delimiter", "body": "<p>I have an excel file that is importing pricing from various txt files that are automatically generated by a third party. I hit a road block with one of the txt files because it uses space delimited whereas the others use tab. Because of the space delimited, when i split the data i get different values in each column.</p>\n\n<p>Here is what I have so far to open and read the text file</p>\n\n<pre><code>        usFileName = PathName &amp; \"\\\" &amp; \"Prices.txt\"\n\n        If fs.FileExists(usFileName) Then\n            Set US = fs.OpenTextFile(usFileName, 1)\n\n            theData = US.ReadLine\n            getDate = Split(theData, Chr(0))\n            curDate = Trim(Left(getDate(0), 10))\n\n            If curDate = ActiveSheet.Range(\"Sheet_Date\") Then\n                    Do While Not US.AtEndOfStream\n                        On Error Resume Next\n                        Ln = US.ReadLine\n                        Cols = Split(Ln, \"  \")\n                        Price = Trim(Cols(7))\n                        NameTrim = Trim(Replace(Cols(1), \"USO-\", \"\"))\n                        CellName = Replace(NameTrim, \"-\", \"_\") &amp; \"_\" &amp; Trim(Cols(2))\n\n                        If ActiveSheet.Range(CellName) Is Nothing Then\n                            ''Do Nothing here\n                            On Error Resume Next\n                        Else\n\n                            Set TxtRng = ActiveSheet.Range(CellName)\n\n                            If TxtRng = ActiveSheet.Range(CellName) Then\n                                TxtRng.Value = Price\n                            End If\n                        End If\n                    Loop\n\n                Else\n                    MsgBox (\"The current sheet date does not match the US file import date.\")\n                End If\n\n            US.Close\n        Else\n            MsgBox (\"The file Prices.txt does not exist.\")\n        End If\n</code></pre>\n\n<p>This is what the txt file looks like:</p>\n\n<pre><code>01/11/2019 06:00 PM  USO-FOX-USO  E10           8.9929     0.0000\n01/11/2019 06:00 PM  USO-FOX-USO  CON8HE10      1.3212    -0.0244\n01/11/2019 06:00 PM  USO-FOX-USO  CON8HE10TT    1.3232    -0.0244\n</code></pre>\n\n<p>And this is what the Cols variable looks like.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CPBia.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CPBia.png\" alt=\"Cols Output\"></a>\n<a href=\"https://i.stack.imgur.com/UvH4Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UvH4Y.png\" alt=\"Cols Output 2\"></a></p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1548262285, "creation_date": 1548262285, "answer_id": 54332056, "question_id": 54328930, "link": "https://stackoverflow.com/questions/54328930/how-to-bulk-export-attachments-from-emails-which-are-emails-to-another-folder/54332056#54332056", "title": "How to bulk export Attachments from emails (which are emails) to another folder within Outlook", "body": "<p>There are two problems here - first is accessing embedded message attachments without saving them first as MSG file. Second is importing the MSG files back - you can use Application.CreateItemFromTemplate, but the item will be unsent. You can use Namespace.OpenSharedItem, and then use MailItem.Move, but it is still a kludge.</p>\n\n<p>There issn't much much you can do in OOM alone. Extended MAPI would work, but it is C++ or Delphi only. If using <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow noreferrer\">Redemption</a> is an option (I am its author), you can use <code>EmbeddeedMsg</code> property exposed by the Redemption <a href=\"http://www.dimastr.com/redemption/RDOAttachment.htm\" rel=\"nofollow noreferrer\">RDOAttachment</a> object. You can also use <a href=\"http://www.dimastr.com/redemption/RDOMail.htm\" rel=\"nofollow noreferrer\">RDOMail</a>.<code>CopyTo</code> and pass a folder as a parameter to copy an embedded message attachment to a folder:</p>\n\n<pre><code>Set Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset redItem = Session.GetMessageFromId(OutlookMessage.EntryID)\nset redFolder = Session.GetFolderFromId(OutlookFolder.EntryID)\nfor each attach in redItem.Attachments\n  if attach.Type = olEmbeddeditem Then\n    attach.EmbeddedMsg.CopyTo OutlookFolder\n  End If\nnext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10956089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36969c5bd19d01602f7c8bd142124e8?s=128&d=identicon&r=PG&f=1", "display_name": "deltakilo", "link": "https://stackoverflow.com/users/10956089/deltakilo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 54332056, "answer_count": 1, "score": 0, "last_activity_date": 1592694390, "creation_date": 1548251868, "last_edit_date": 1592694390, "question_id": 54328930, "link": "https://stackoverflow.com/questions/54328930/how-to-bulk-export-attachments-from-emails-which-are-emails-to-another-folder", "title": "How to bulk export Attachments from emails (which are emails) to another folder within Outlook", "body": "<p>I need to extract .msg attachments from emails in a range and save these into another outlook sub-folder. This works currently by dragging the attachment into a sub-folder of 'inbox' but is there a quicker way?</p>\n\n<p>I have searched around a bit and found ways to extract them to a local folder but i need them to be contained within outlook.</p>\n\n<p>I appreciate any help and suggestions. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548251773, "post_id": 54328795, "comment_id": 95475666, "body": "How have you declared <code>oWdDoc</code> ?"}, {"owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548252513, "post_id": 54328795, "comment_id": 95476101, "body": "I had not but I just tried again with declaration (as object) and it still doesn&#39;t work. Also, it works fine without declaration in the other macro (same macro, same module, same file, just saves instead of send). Do you want me to the share the full code?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548252736, "post_id": 54328795, "comment_id": 95476249, "body": "Yes, please share full code, the <code>.</code> prefix means its enclosed in a <code>with</code> statement, but don&#39;t know what etc.."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548253080, "post_id": 54328795, "comment_id": 95476426, "body": "The <code>.send</code> or <code>.display</code> covers the difference, however you need to allow programatic access to OUtlook, something may be done on one machine, but not the other."}, {"owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548253437, "post_id": 54328795, "comment_id": 95476633, "body": "Added full code now. It is the same machine, Excel file, module, macro calling this function, everything is exactlyt the same except the last line where it is save instead of send."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1548253573, "post_id": 54328795, "comment_id": 95476722, "body": "interesting. i&#39;ve never seen it done this way. i typically use <code>RangeToHTML</code> function and <code>.htmlbody</code> with the mail message. maybe consider that as an alternative approach"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548253749, "post_id": 54328795, "comment_id": 95476834, "body": "Also, have you added the Word Object Reference Library?"}, {"owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1548254011, "post_id": 54328795, "comment_id": 95477040, "body": "@ScottHoltzman I had that approach before and works well except that it results in a table inside email with a visible gap on the top of body. My client is too finicky about it so had to switch to rich text editing."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1548254062, "post_id": 54328795, "comment_id": 95477075, "body": "@dsauce - that spacing gap can be controlled for sure. you just have to fiddle with the html"}, {"owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548254115, "post_id": 54328795, "comment_id": 95477113, "body": "@Nathan_Sav I had not but I tried now after adding it and still the same error. As I said before, the other equivalent function works fine with same reference scenario."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548254662, "post_id": 54328795, "comment_id": 95477474, "body": "Do you run it with the on error statement in, turn that off if so, it could be an error from a previous line?  The only difference between the 2 macros is saving or sending?  THey are in the same workbook and on the same machine?"}, {"owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1548254692, "post_id": 54328795, "comment_id": 95477491, "body": "@ScottHoltzman trust me, I tried a lot of fiddling with the html code that comes out from rangeToHTML and couldn&#39;t eliminate that space. It came in from Outlook after setting the HTML code to provide external padding to the table. Had to resort to rich text."}, {"owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548254908, "post_id": 54328795, "comment_id": 95477653, "body": "@Nathan_Sav I have tried with &amp; without on error statment. Also, the compile error is on the entire function, doesn&#39;t point to a line. I played with each line to conclude it is that line which is causing the issue. Yes, the only difference is saving &amp; sending. Same workbook, same machine."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548255725, "post_id": 54328795, "comment_id": 95478183, "body": "How are you using this?  You&#39;re returning a string from the function, but you are not setting <code>send_mail_rich_text</code> you are setting <code>save_mail_rich_text</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548256861, "post_id": 54328795, "comment_id": 95478849, "body": "Also, why are you resetting standard enumartions, like <code>olFormatRichText = 3</code> ?"}, {"owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548259132, "post_id": 54328795, "comment_id": 95480144, "body": "@Nathan_Sav Perfect. I was hoping it must be a stupid error. I missed correcting this when copy-pasting the macro from save to send. Works now. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1548261667, "last_edit_date": 1548261667, "creation_date": 1548256842, "answer_id": 54330441, "question_id": 54328795, "link": "https://stackoverflow.com/questions/54328795/sending-rich-text-email-from-outlook-using-excel-vba/54330441#54330441", "title": "Sending rich text email from Outlook using Excel VBA", "body": "<p>Please try this:</p>\n\n<pre><code>Function send_mail_rich_text(ByVal send_to As String, ByVal mail_subject As String, _\n    ByVal mail_content As Range, ByVal cc_list As String, ByVal bcc_list As String, _\n    ByVal rr As Boolean) As String\n\n    Dim oOlApp As Object    ' Outlook.Application\n    Dim oOlMItem As Object  ' Outlook.MailItem\n    Dim oWdDoc As Object    ' Word.Document\n\n    Err.Clear\n\n    Set oOlApp = CreateObject(\"Outlook.Application\")\n    Set oOlMItem = oOlApp.CreateItem(olMailItem)\n\n    ' Range can be copied directly as given as Range via function call\n    mail_content.Copy\n\n    ' On Error Resume Next   ' activate it after debugging\n    With oOlMItem\n        .To = send_to\n        .CC = cc_list\n        .BCC = bcc_list\n        .Subject = mail_subject\n        .ReadReceiptRequested = rr ' can be used directly if given as boolean\n        .BodyFormat = 3 ' 3=RichTextFormat\n\n        Set oWdDoc = .GetInspector.WordEditor\n\n        ' by this you paste below your signature\n        ' oWdDoc.Paragraphs(oWdDoc.Paragraphs.Count).Range.Paste\n\n        ' by these alternatives you paste before your signature\n        oWdDoc.Range(oWdDoc.Content.Start, oWdDoc.Content.Start).Paste\n        oWdDoc.Bookmarks(\"\\StartOfDoc\").Range.Paste\n\n        .Display ' change to .Send after debugging\n    End With\n\n    Application.CutCopyMode = False\n\n    If Err.Number &lt;&gt; 0 Then\n        send_mail_rich_text = \"error\"\n    ElseIf oOlMItem.Sent = True Then\n        send_mail_rich_text = \"sent\"\n    Else\n        send_mail_rich_text = \"no error, but not sent\"\n    End If\nEnd Function\n</code></pre>\n\n<p>As <code>ReadReceiptRequested</code> is expected as boolean, I changed it within the function call. Be aware to change your calls to this function accordingly. I tested it with this:</p>\n\n<pre><code>Private Sub TestSendmailFunction()\n    Debug.Print send_mail_rich_text(\"to@test.com\", \"Test\", ActiveSheet.Range(\"B2:C3\"), _\n        \"cc@test.com\", \"bcc@test.com\", False)\nEnd Sub\n</code></pre>\n\n<p>It is not necessary to switch to another sheet and later back to the previous one as you give \"mail_content\" as range. A range can be copied directly also from non-active sheets.</p>\n\n<p>You should use <code>Option Explicit</code> at the beginning of every VBA module to prevent errors like \"send_mail_rich_text\" vs. \"save_mail_rich_text\" or unknown objects like oWdRng.</p>\n\n<p>You can combine commands if you don't need the object again: Instead of <code>Set oWdRng = ...</code> and <code>oWdRng.Paste</code> you can use the whole part: <code>....Paste</code>.</p>\n\n<p>If you can add a reference to \"Microsoft Excel x.x Object Library\" and \"Microsoft Word x.x Object Library\" then you can exchange <code>Object</code> by e. g. <code>Outlook.Mailitem</code> to provide more debugging features by \"early binding\". Then also the predefinded constants as <code>olFormatRichText</code> (from internal ENUM OlBodyFormat) are known and can be used directly.</p>\n"}], "owner": {"reputation": 534, "user_id": 2935885, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/K6UX4.jpg?s=128&g=1", "display_name": "dsauce", "link": "https://stackoverflow.com/users/2935885/dsauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1339, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1548261667, "creation_date": 1548251386, "last_edit_date": 1548253378, "question_id": 54328795, "link": "https://stackoverflow.com/questions/54328795/sending-rich-text-email-from-outlook-using-excel-vba", "title": "Sending rich text email from Outlook using Excel VBA", "body": "<p>I am using the following (piece of) code in a macro to send outlook emails using Excel VBA.</p>\n\n<pre><code>Function send_mail_rich_text(ByVal send_to As String, ByVal mail_subject As String, ByVal mail_content As Range, ByVal cc_list As String, ByVal bcc_list As String, ByVal rr As String) As String\n\nSet psht = ActiveSheet\n\nErr.Number = 0\n\nIf LCase(rr) = \"yes\" Then\n    rr_boo = True\nElse\n    rr_boo = False\nEnd If\n\nSet oOlApp = CreateObject(\"Outlook.Application\")\n\nolMailItem = 0\nSet oOlMItem = oOlApp.CreateItem(olMailItem)\n\n'get Excel cell range which shall be in the mail\nSet oWB = ActiveWorkbook\nSet oWS = Range(\"mail.content\").Worksheet\noWS.Activate\nSet oRange = mail_content\n\noRange.Copy ' Range is now in Clipboard\n\nOn Error Resume Next\n\nDim oWdDoc As Object\n\nWith oOlMItem\n    '.Display\n    .To = send_to\n    .CC = cc_list\n    .BCC = bcc_list\n    .Subject = mail_subject\n    .ReadReceiptRequested = rr_boo\n\n    Set oOlInsp = .GetInspector\n    Set oWdDoc = oOlInsp.WordEditor ' get Word Document from the MailBody\n    olFormatRichText = 3\n    .bodyformat = olFormatRichText ' change to RichTextFormat\n\n    Set oWdRng = oWdDoc.Paragraphs(oWdDoc.Paragraphs.Count).Range        \n    oWdRng.Paste ' paste Excel range from Clipboard\n\n    Set oWdRng = oWdDoc.Paragraphs(oWdDoc.Paragraphs.Count).Range\n\n    .send\n\nEnd With\n\nApplication.CutCopyMode = False\n\nIf Err.Number &lt;&gt; 0 Then\n    save_mail_rich_text = \"error\"\nElse\n    save_mail_rich_text = \"sent\"\nEnd If\n\npsht.Activate\n\nEnd Function\n</code></pre>\n\n<p>However, I get can a compile error on the line \"<code>Set oWdDoc = oOlInsp.WordEditor</code>\". Error says \"<code>Function call on the left-hand side of assignment must return Variant or Object</code>\". Further, the strange part is that I have two macros with the exact same code except that one sends and the other saves draft. The compilation error occurs only in case of send macro. What I am missing here?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1548251539, "post_id": 54328792, "comment_id": 95475554, "body": "No you&#39;ll need to open it to update them. What you can do though is open the destination workbook in another instance of Excel which you can make hidden from the user making it look like no workbook was opened"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10894507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7988eede36877050a4a3c98bf301421?s=128&d=identicon&r=PG&f=1", "display_name": "Webs", "link": "https://stackoverflow.com/users/10894507/webs"}, "edited": false, "score": 0, "creation_date": 1548402053, "post_id": 54328889, "comment_id": 95535981, "body": "Thanks for the imput. I am getting an error that the file doesnt exsist even tho I have filled in the relative paths. Is there a way to update my macro to open WB2 as hidden and close it when WB1 closes?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 3, "user_id": 10894507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7988eede36877050a4a3c98bf301421?s=128&d=identicon&r=PG&f=1", "display_name": "Webs", "link": "https://stackoverflow.com/users/10894507/webs"}, "edited": false, "score": 0, "creation_date": 1548408550, "post_id": 54328889, "comment_id": 95538821, "body": "You&#39;ll need to use the absolute path for opening the workbook."}, {"owner": {"reputation": 3, "user_id": 10894507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7988eede36877050a4a3c98bf301421?s=128&d=identicon&r=PG&f=1", "display_name": "Webs", "link": "https://stackoverflow.com/users/10894507/webs"}, "edited": false, "score": 0, "creation_date": 1548408795, "post_id": 54328889, "comment_id": 95538953, "body": "What does that mean exactly? I am using the full path for the file on the server that works with my original macro."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 3, "user_id": 10894507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7988eede36877050a4a3c98bf301421?s=128&d=identicon&r=PG&f=1", "display_name": "Webs", "link": "https://stackoverflow.com/users/10894507/webs"}, "edited": false, "score": 0, "creation_date": 1548408965, "post_id": 54328889, "comment_id": 95539052, "body": "Ah apologies. Relative path is to a location where as the absolute path is what you\u2019ve described. You\u2019ll need to check your file path. Try opening the workbook and executing <code>Activeworkbook.Fullname</code> on it and make sure the paths match"}, {"owner": {"reputation": 3, "user_id": 10894507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7988eede36877050a4a3c98bf301421?s=128&d=identicon&r=PG&f=1", "display_name": "Webs", "link": "https://stackoverflow.com/users/10894507/webs"}, "edited": false, "score": 0, "creation_date": 1548413956, "post_id": 54328889, "comment_id": 95541755, "body": "Private Sub Workbook_Open() MsgBox ActiveWorkbook.FullName End Sub  This returns the same path that I am using. So I have no idea why I keep getting the error file not found."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 3, "user_id": 10894507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7988eede36877050a4a3c98bf301421?s=128&d=identicon&r=PG&f=1", "display_name": "Webs", "link": "https://stackoverflow.com/users/10894507/webs"}, "edited": false, "score": 0, "creation_date": 1548419474, "post_id": 54328889, "comment_id": 95544449, "body": "I&#39;d suggest stepping through your code with F8 and checking all values"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1548251731, "creation_date": 1548251731, "answer_id": 54328889, "question_id": 54328792, "link": "https://stackoverflow.com/questions/54328792/is-there-a-way-to-update-linked-pictures-from-another-workbook-without-having-to/54328889#54328889", "title": "Is there a way to update linked pictures from another workbook without having to open it?", "body": "<p>To expand on my comment. Updating them this way will make it look seamless to the end user and give the false impression that the destination workbook wasn't 'opened'</p>\n\n<pre><code>Sub Gumb214_Klikni()\n    'Button to open and close WB2\n    Dim xlApp As New Excel.Application\n    Dim xWb As Workbook\n    Dim wbName As String\n\n\n    On Error Resume Next\n    With xlApp\n        .Visible = False\n        Set xWb = .Workbooks.Open(\"path to link\")\n    End With\n    wbName = xWb.Name\n    Workbooks(\"name of folder\").Close\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox \"This workbook does not exist!\", vbInformation, \"ERROR\"\n        Err.Clear\n    Else\n        ' Update pictures here via whatever method and save&amp;close the destination workbook\n        MsgBox \"TEXT\"\n    End If\n\n    ' Quit the second instance of the application\n    With xlApp\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10894507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7988eede36877050a4a3c98bf301421?s=128&d=identicon&r=PG&f=1", "display_name": "Webs", "link": "https://stackoverflow.com/users/10894507/webs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548251731, "creation_date": 1548251380, "last_edit_date": 1548251488, "question_id": 54328792, "link": "https://stackoverflow.com/questions/54328792/is-there-a-way-to-update-linked-pictures-from-another-workbook-without-having-to", "title": "Is there a way to update linked pictures from another workbook without having to open it?", "body": "<p>I have a report dashboard in WB1 that has linked pictures of charts from another workbook WB2 (PASTE/SPECIAL PASTE/LINKED PICTURE)</p>\n\n<p>The sales team is updating WB2 and linked pictures in WB1 do not update unless both workbooks are open.</p>\n\n<p>So I had a work around by implementing a button in WB1 to open and close WB2 and that updated the links.</p>\n\n<p>Now for some reason that stopped working. The only change I did was change the WB2 into a workbook with a macro (it now auto updates all graphs when new values are added).</p>\n\n<pre><code>Sub Gumb214_Klikni()\n'Button to open and close WB2\n   Dim xWb As Workbook\n   Dim wbName As String\n   On Error Resume Next\n   Set xWb = Workbooks.Open(\"path to link\")\n   wbName = xWb.Name\n   Workbooks(\"name of folder\").Close\n   If Err.Number &lt;&gt; 0 Then\n      MsgBox \"This workbook does not exist!\", vbInformation, \"ERROR\"\n     Err.Clear\n   Else\n    MsgBox \"TEXT\"\n  End If\nEnd Sub\n</code></pre>\n\n<p>The catch is that even if I return to the old way to a non macro WB2 the button stopped refreshing the picture links and they are only refreshed it you manually open them or have both workbooks open.</p>\n\n<p>Is there any other way to update linked pictures? This is driving me nuts since it worked fine before I tried to save time and auto refresh WB2 graphs.</p>\n"}, {"tags": ["vba", "loops", "ms-access-2016"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548251142, "post_id": 54328595, "comment_id": 95475326, "body": "you don&#39;t need <code>[Forms]![frm_SalesOrderEntry]!  [Combo617]</code> you can use <code>SL</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548251293, "post_id": 54328595, "comment_id": 95475426, "body": "Can you explain the query to your code please?  I cant see how it&#39;s used?  Is this <code>Set rst = db.OpenRecordset(SQL)</code> the line that errors?"}, {"owner": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548254072, "post_id": 54328595, "comment_id": 95477080, "body": "Both the query and the code produces a list of product codes. The query is better because it will remove any nulls WHERE(tblREF_Chemical.[Proper Shipping Name]) Is Not Null), but the I can&#39;t seem to output the query to a text file... Print #TextFile, (&quot;DATA HERE&quot;) and I can&#39;t get the code to accept my query as a recordset or use multiple Where conditions."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1548264032, "post_id": 54328595, "comment_id": 95482812, "body": "Your UPDATE2 SQL will not run as you do not have proper spaces before clauses. You need a space before <code>AND</code> and <code>HAVING</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "edited": false, "score": 0, "creation_date": 1548253751, "post_id": 54329306, "comment_id": 95476837, "body": "I&#39;m getting a Run-time error &#39;3075: Syntax error in query expression."}, {"owner": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "edited": false, "score": 0, "creation_date": 1548254856, "post_id": 54329306, "comment_id": 95477614, "body": "Syntex error in query expression &#39;(((qry_AX_LineItems_DISTINCT.SALESID)=&#39;SL&#39;AND((tblREF_Chemi&zwnj;&#8203;cal.[Proper Shipping Name]) Is Not Null));&#39;."}, {"owner": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "edited": false, "score": 0, "creation_date": 1548255053, "post_id": 54329306, "comment_id": 95477755, "body": "I feel like we&#39;re so close. Thank you for the assistance. :-)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1548259206, "post_id": 54329306, "comment_id": 95480183, "body": "<a href=\"https://meta.stackexchange.com/a/148274\">Code-only answers fall under &quot;Very Low Quality&quot; for me...</a>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "edited": false, "score": 0, "creation_date": 1548259801, "post_id": 54329306, "comment_id": 95480520, "body": "@BVar ... simply add a space before the last <code>AND</code> or after the last quote of <i>SL</i> concatenation: <code>&#39;&quot; &amp;  SL &amp; &quot;&#39; &quot;</code>."}, {"owner": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "edited": false, "score": 0, "creation_date": 1548260760, "post_id": 54329306, "comment_id": 95481105, "body": "I got passed the Syntax error... so now the code is referencing my query correctly, but now I&#39;m stuck as it is returning a 3061 error : Too few parameters. Expected 1. I double checked the query itself and it is giving me the expected results... Not sure where I&#39;ve gone wrong exactly."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1548261757, "post_id": 54329306, "comment_id": 95481647, "body": "Forgive me, please confirm you fixed the missing space and error still persists."}, {"owner": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "edited": false, "score": 0, "creation_date": 1548261959, "post_id": 54329306, "comment_id": 95481758, "body": "Unfortunately even with the spaces I get the Run-Time 3061 error."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1548404597, "post_id": 54329306, "comment_id": 95536991, "body": "What is SL holding? The error sounds like it&#39;s null"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1548253863, "last_edit_date": 1548253863, "creation_date": 1548253188, "answer_id": 54329306, "question_id": 54328595, "link": "https://stackoverflow.com/questions/54328595/access-vba-concatenate-single-column-query-into-a-single-line-result/54329306#54329306", "title": "access vba concatenate single column query into a single line result", "body": "<pre><code>Private Sub Command1492_Click()\nDim i As Integer\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim SQL As String\n\nSet db = CurrentDb\nSL = [Forms]![frm_SalesOrderEntry]![Combo617]\nSQL = \"SELECT tblREF_Chemical.Abbr \"\nSQL = SQL &amp; \"FROM qry_AX_LineItems_DISTINCT INNER JOIN tblREF_Chemical ON \"\nSQL = SQL &amp; \"qry_AX_LineItems_DISTINCT.ItemId = tblREF_Chemical.[Item Number] \"\nSQL = SQL &amp; \"GROUP BY tblREF_Chemical.Abbr, qry_AX_LineItems_DISTINCT.SALESID, \"\nSQL = SQL &amp; \"tblREF_Chemical.[Proper Shipping Name] \"\nSQL = SQL &amp; \"HAVING (((qry_AX_LineItems_DISTINCT.SALESID)='\" &amp;  SL &amp; \"'\"  'edit here\nSQL = SQL &amp; \"AND ((tblREF_Chemical.[Proper Shipping Name]) Is Not Null));  \"  \n\n\nSet rst = db.OpenRecordset(SQL)\nDim s as string\n\nDo While rst(0) is not null\n   s = s &amp; \"+\" &amp; rst(0)\n   rst.MoveNext\nLoop\nrst.Close\nDebug.print s\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1548263539, "creation_date": 1548263539, "answer_id": 54332376, "question_id": 54328595, "link": "https://stackoverflow.com/questions/54328595/access-vba-concatenate-single-column-query-into-a-single-line-result/54332376#54332376", "title": "access vba concatenate single column query into a single line result", "body": "<p>Your main issue is a missing space before the <code>AND</code> in <code>HAVING</code> clause. </p>\n\n<p>For this very reason of readability and maintainability, consider using <code>QueryDefs</code> for parameterized queries (an industry best practice) to run your saved query in VBA for several reasons:</p>\n\n<ol>\n<li>You avoid the need to concatenate or enclose quotes or escape literals by effectively divorcing SQL code from VBA (application layer) code.</li>\n<li>MS Access will not allow you to save a query with syntax issues but VBA string queries can have such issues found at runtime.</li>\n<li>MS Access's engine compiles and caches saved queries to best execution plan which especially helps for aggregate queries with joins. This is why saved queries are usually more efficient than VBA string queries run on the fly.</li>\n</ol>\n\n<p><strong>SQL</strong> <em>(save below as a saved query)</em></p>\n\n<p>Query now uses table aliases and <code>HAVING</code> conditions are moved to <code>WHERE</code> since no aggregate is being used.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS idparam LONG;\nSELECT t.Abbr\nFROM qry_AX_LineItems_DISTINCT q\nINNER JOIN tblREF_Chemical t ON q.ItemId = t.[Item Number]\nWHERE (((q.SALESID) = [idparam]) \n  AND  ((t.[Proper Shipping Name]) Is Not Null))\nGROUP BY t.Abbr, q.SALESID, t.[Proper Shipping Name];\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database, qdef AS DAO.QueryDef, rst As DAO.Recordset\nDim SQL As String, s As String\n\nSet db = CurrentDb\n' INITIALIZE SAVED QUERY\nSet qdef = db.QueryDefs(\"mySavedQuery\")\n' BIND PARAMETER\nqdef![idparam] = [Forms]![frm_SalesOrderEntry]![Combo617]\n' OPEN RECORDSET\nSet rst = qdef.OpenRecordset()\n\nDo While rst(0) Is Not Null\n   s = s &amp; \"+\" &amp; rst(0)\n   rst.MoveNext\nLoop\nrst.Close\n\nDebug.Print s\nSet rst = Nothing: Set qdef = Nothing: Set db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10955862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc7c17a5e5c94fcc57b83d29de5af06?s=128&d=identicon&r=PG&f=1", "display_name": "BVar", "link": "https://stackoverflow.com/users/10955862/bvar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548263912, "creation_date": 1548250756, "last_edit_date": 1548263912, "question_id": 54328595, "link": "https://stackoverflow.com/questions/54328595/access-vba-concatenate-single-column-query-into-a-single-line-result", "title": "access vba concatenate single column query into a single line result", "body": "<p>I have a new database to help produce documents for order processing.</p>\n\n<p>I have a query set up with only one column of results (Product Codes) determined by the order selected on the main form. </p>\n\n<p>I need to be able to use this information to name my file aka</p>\n\n<p>(Customer) (Product1)+(Product2)+(Product....) (Location)</p>\n\n<p>I have the code to generate the line (Customer) (Product1) (Location) and am trying to get either a concatenate function or a loop function or something to get all the products to line up with a \"+\" in between each \"line\".</p>\n\n<p>I have a query (Query1) set up to give me the exact data I need...</p>\n\n<pre><code>SELECT tblREF_Chemical.Abbr\nFROM qry_AX_LineItems_DISTINCT INNER JOIN tblREF_Chemical ON \nqry_AX_LineItems_DISTINCT.ItemId = tblREF_Chemical.[Item Number]\nGROUP BY tblREF_Chemical.Abbr, qry_AX_LineItems_DISTINCT.SALESID, \ntblREF_Chemical.[Proper Shipping Name]\nHAVING (((qry_AX_LineItems_DISTINCT.SALESID)=[Forms]![frm_SalesOrderEntry]! \n[Combo617]) AND ((tblREF_Chemical.[Proper Shipping Name]) Is Not Null));\n</code></pre>\n\n<p>I have a button set up on my main form to test the data output and then I intend to add the code to my code for DoCmd.Output file name.</p>\n\n<p>So far the only code that has worked is...</p>\n\n<pre><code>Private Sub Command1492_Click()\nDim i As Integer\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim SQL As String\n\nSet db = CurrentDb\nSL = [Forms]![frm_SalesOrderEntry]![Combo617]\n\nSQL = \"SELECT * FROM  ALL_SalesOrderItemsLineDates WHERE \nALL_SalesOrderItemsLineDates.SALESID = '\" &amp; SL &amp; \"';\"\nSet rst = db.OpenRecordset(SQL)\n\nFor i = 0 To DCount(\"*\", \"ALL_SalesOrderItemsLineDates\", \n \"ALL_SalesOrderItemsLineDates.SALESID = '\" &amp; [Forms]![frm_SalesOrderEntry]! \n[Combo617] &amp; \"'\") - 1\n Debug.Print DLookup(\"[Abbr]\", \"[tblREF_Chemical]\", \"[Item Number]= '\" &amp; \nrst.Fields(\"ItemID\") &amp; \"'\")\n rst.MoveNext\nNext i\n\nrst.Close\n\nEnd Sub\n</code></pre>\n\n<p>I can't seem to add additional where statements within this code or use my actual query or the system presents errors at the db.OpenRecordset line of code (Errors 3061 and 3078). </p>\n\n<p>Even ignoring those problems the output is multi-line and I need it to be used in a single string of text for the document name.</p>\n\n<p><strong>UPDATE1:</strong></p>\n\n<p>I am working with the code to use my query directly...</p>\n\n<pre><code>Dim i As Integer\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim SQL As String\n\nSet db = CurrentDb\nSL = [Forms]![frm_SalesOrderEntry]![Combo617]\n\nSQL = \"SELECT tblREF_Chemical.Abbr \"\nSQL = SQL &amp; \"FROM qry_AX_LineItems_DISTINCT INNER JOIN tblREF_Chemical ON qry_AX_LineItems_DISTINCT.ItemId = tblREF_Chemical.[Item Number] \"\nSQL = SQL &amp; \"GROUP BY tblREF_Chemical.Abbr, qry_AX_LineItems_DISTINCT.SALESID, tblREF_Chemical.[Proper Shipping Name] \"\nSQL = SQL &amp; \"HAVING ((qry_AX_LineItems_DISTINCT.SALESID)='\" &amp; SL &amp; \"'\"\nSQL = SQL &amp; \"AND ((tblREF_Chemical.[Proper Shipping Name]) Is Not Null));  \"\n\nSet rst = db.OpenRecordset(SQL)\nDim s As String\n\nDo While rst(0) Is Not Null\n   s = s &amp; \"+\" &amp; rst(0)\n   rst.MoveNext\nLoop\nrst.Close\nDebug.Print s\n</code></pre>\n\n<p>Unfortunately I'm now getting a run-time error 3061 - Too few parameters. Expected 1.</p>\n\n<p>I have double checked my spellings and ran the query just to be sure and no matter how many results the query is getting (functioning as expected) I am still getting this error. </p>\n\n<p><strong>UPDATE2:</strong></p>\n\n<p>Through more research I learned that queries can have, for lack of better words, invisible coding. I am updating my code to remove the inner query from my query to simplify the amount of \"research\" my VBA has to do. </p>\n\n<pre><code>Private Sub Command1492_Click()\n\nDim i As Integer\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\nDim SQL As String\n\nSet db = CurrentDb\nSL = [Forms]![frm_SalesOrderEntry]![Combo617]\n\nSQL = \"SELECT tblREF_Chemical.Abbr \"\nSQL = SQL &amp; \"FROM ALL_SalesOrderItemsLineDates INNER JOIN tblREF_Chemical ON ALL_SalesOrderItemsLineDates.ItemId = tblREF_Chemical.[Item Number] \"\nSQL = SQL &amp; \"GROUP BY tblREF_Chemical.Abbr, ALL_SalesOrderItemsLineDates.SALESID, tblREF_Chemical.[Proper Shipping Name]\"\nSQL = SQL &amp; \"HAVING ((ALL_SalesOrderItemsLineDates.SALESID)='\" &amp; SL &amp; \"'\"\nSQL = SQL &amp; \"AND ((tblREF_Chemical.[Proper Shipping Name]) Is Not Null));  \"\n\nSet rst = db.OpenRecordset(SQL)\nDim s As String\n\nDo While rst(0) Is Not Null 'Debug error here!\n   s = s &amp; \"+\" &amp; rst(0)\n   rst.MoveNext\nLoop\nrst.Close\nDebug.Print s\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunately I'm still getting a run-time error, but now it is 424 Object required and the debug takes me to the \"Do While\" line.</p>\n\n<p>I think this is a step forward, but still a little stuck. </p>\n\n<p><strong>Update3:</strong>\nSince the debug was taking me to the \"Do While\" line I returned to my functioning code and replaced the loop function with an integer based code. </p>\n\n<p>Thank you #Harassed Dad! Your code was a giant help! Using your idea for a string rather than going straight to a debug.print was genius. </p>\n\n<p>The below replaces my code starting where I was having issues.</p>\n\n<pre><code>Dim s As String\n\nFor i = 0 To DCount(\"*\", \"ALL_SalesOrderItemsLineDates\", \"ALL_SalesOrderItemsLineDates.SALESID = '\" &amp; SL &amp; \"'\") - 1\n s = s &amp; \"+\" &amp; rst.Fields(\"Abbr\")\n rst.MoveNext\nNext i\n\n rst.Close\n Debug.Print s\n</code></pre>\n\n<p>My results are displaying with only one hiccup. </p>\n\n<p>+CHA+DEEA+EEP+MEC+PERC+PM+PROP</p>\n\n<p>There is an extra \"+\" at the beginning, but I'm sure I can find the solution to this tiny problem.</p>\n\n<p>I hope these notes can help someone in the future. Thank you all for your help!</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1548272185, "post_id": 54333807, "comment_id": 95486433, "body": "Thanks, that&#39;s very helpful. But do you know why it&#39;s included in a new report created by selecting a table and going to <i>Create</i> and then <i>Report</i>? There&#39;s no visible chart on the report (even in the version of Access that created it)."}, {"owner": {"reputation": 76, "user_id": 2759928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1312303751/picture?type=large", "display_name": "Shane L. Groff", "link": "https://stackoverflow.com/users/2759928/shane-l-groff"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1548290335, "post_id": 54333807, "comment_id": 95492567, "body": "Yes, every form/report has a &#39;default&#39; version of each control type it supports.  The default control specifies properties that are shared by all control instances of that type.  You can actually control the properties set on the default control by selecting that control type in the toolbox, then setting properties in the property sheet.  Unfortunately, that does mean that you can&#39;t use source code control to share forms/reports between different versions of Access (at least when new control types have been added between versions)"}], "tags": [], "owner": {"reputation": 76, "user_id": 2759928, "user_type": "registered", "profile_image": "https://graph.facebook.com/1312303751/picture?type=large", "display_name": "Shane L. Groff", "link": "https://stackoverflow.com/users/2759928/shane-l-groff"}, "is_accepted": true, "score": 3, "last_activity_date": 1548269301, "creation_date": 1548269301, "answer_id": 54333807, "question_id": 54328256, "link": "https://stackoverflow.com/questions/54328256/ivychart-object-added-to-newly-created-reports-and-interferring-with-version-con/54333807#54333807", "title": "IvyChart object added to newly created reports and interferring with version control", "body": "<p>IvyChart is the internal control name for the new Chart control type that was added in O365.  Office 2016 does not support this control type, so you get an error when trying to LoadFromText a form or report that contains them.</p>\n\n<p>Note that 2016 Access can still open these forms/reports, but will not display the chart.</p>\n\n<p>If you want to use the new charts, you need to use Office 365, or Office 2019.</p>\n"}], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 54333807, "answer_count": 1, "score": 1, "last_activity_date": 1594215403, "creation_date": 1548249723, "last_edit_date": 1594215403, "question_id": 54328256, "link": "https://stackoverflow.com/questions/54328256/ivychart-object-added-to-newly-created-reports-and-interferring-with-version-con", "title": "IvyChart object added to newly created reports and interferring with version control", "body": "<p>I'm using a version control and update solution similar to the one described in <a href=\"https://stackoverflow.com/a/211210/7296893\">this answer</a> that uses <code>SaveAsText</code> and <code>LoadFromText</code> to manage incremental updates.</p>\n\n<p>However, a problem arose recently when loading reports saved using <code>LoadFromText</code> that had been created using <code>SaveAsText</code> on different computers. I tracked this problem down to the following issue:</p>\n\n<p><strong>MCVE</strong></p>\n\n<p>On PC 1:</p>\n\n<ol>\n<li>Create a new database</li>\n<li>Create a table in that database using the ribbon <em>Create</em>, then <em>Table</em> button</li>\n<li>Close and save that table</li>\n<li>Create a report by selecting the table, and pressing <em>Create</em>, and then <em>Report</em></li>\n<li>Close and save the report</li>\n<li>In the immediate window, execute <code>SaveAsText acReport, \"Table1\", \"C:\\SomePath\\Report.txt\"</code></li>\n</ol>\n\n<p>On PC 2:</p>\n\n<ol>\n<li>Create a new database</li>\n<li>In the immediate window, execute <code>LoadFromText acReport, \"Table1\", \"C:\\SomePath\\Report.txt\"</code></li>\n<li>I receive a generic error, a file called <em>error.txt</em> is created at the database location, and in it, it says <em>Expected: object name. Observed: IvyChart</em>.</li>\n</ol>\n\n<p>Further observations:</p>\n\n<p>The text file <em>Report.txt</em> is approximately 100 KB (previous exports of reports based on small tables were around 40 KB).</p>\n\n<p>In the report.txt file, you can find the report contains:</p>\n\n<ul>\n<li>A BoundObjectFrame</li>\n<li>A Chart</li>\n<li>An UnboundObjectFrame</li>\n<li>A CustomControl</li>\n<li>A WebBrowser</li>\n<li>A NavigationControl</li>\n<li><p>An IvyChart with the following properties:</p>\n\n<pre><code>UnknownProp = {48 ,329 ,2 ,1 ,1 } Begin\n    0x00\nEnd\nUnknownProp = {49 ,11 ,2 ,1 ,1 } Begin\n    0x00\nEnd\nUnknownProp = {98 ,150 ,3 ,4 ,2 } Begin\n    0xb811\nEnd\nUnknownProp = {99 ,44 ,3 ,4 ,2 } Begin\n    0x130b\nEnd\nUnknownProp = {260 ,462 ,4 ,4 ,4 } Begin\n    0x27000080\nEnd\nUnknownProp = {295 ,616 ,4 ,0 ,4 } Begin\n    0x01000000\nEnd\nUnknownProp = {300 ,756 ,10 ,4 ,22 } Begin\n    0x4300680061007200740020005400690074006c006500\nEnd\n</code></pre></li>\n</ul>\n\n<p>None of the other controls have these <em>UnknownProp</em> properties.</p>\n\n<p>When I create the report on PC 2, using the same steps, all these controls don't show up.</p>\n\n<p>All these controls are not visible on the report itself. The problem mainly manifests when exporting from a computer with Office 2016 (365) version 1803, and importing in an older version of Office 2016</p>\n\n<p>Access is not using any add-ins, COM or otherwise. This occurs with blank databases, so only using the default references.</p>\n\n<p>Has anyone got any idea what this IvyChart object is, why it's on all newly created reports based on existing objects, and why all these other seemingly random invisible controls come with it?</p>\n\n<p>Can I stop Access adding these invisible controls to new reports?</p>\n\n<p>Googling IvyChart or consulting other resources has brought no insight at all.</p>\n\n<p>I can just open the database on PC 2 and use <code>SaveAsText</code> from there. However, if I do that, the weird controls aren't there but text file is full of lines like this:</p>\n\n<pre><code>Begin\nEnd\n</code></pre>\n\n<p>This makes importing the text file invalid on any computer.</p>\n\n<p>My workaround for now is when creating a new report based on an object, to select all controls, copy all controls (using ctrl + A) to a blank report, and then save the report. The fact that this works, and these hidden controls causing errors aren't copied, also feels a bit iffy to me.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 47, "user_id": 10955764, "user_type": "registered", "profile_image": "https://graph.facebook.com/2016775975084275/picture?type=large", "display_name": "Mhmd Qadi", "link": "https://stackoverflow.com/users/10955764/mhmd-qadi"}, "edited": false, "score": 0, "creation_date": 1548255021, "post_id": 54328071, "comment_id": 95477732, "body": "What does &quot;didn&#39;t work&quot; mean? Have you checked your formula is valid? Try entering it in a cell."}, {"owner": {"reputation": 47, "user_id": 10955764, "user_type": "registered", "profile_image": "https://graph.facebook.com/2016775975084275/picture?type=large", "display_name": "Mhmd Qadi", "link": "https://stackoverflow.com/users/10955764/mhmd-qadi"}, "edited": false, "score": 0, "creation_date": 1548316642, "post_id": 54328071, "comment_id": 95499474, "body": "it work in a cell but not within the code , i read that the reason is because we use excel function (max in this case) and VBA has similar function"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 47, "user_id": 10955764, "user_type": "registered", "profile_image": "https://graph.facebook.com/2016775975084275/picture?type=large", "display_name": "Mhmd Qadi", "link": "https://stackoverflow.com/users/10955764/mhmd-qadi"}, "edited": false, "score": 0, "creation_date": 1548326990, "post_id": 54328071, "comment_id": 95505241, "body": "I have no idea why that happens. I&#39;ve posted a workaround above which works. Put the formula in a cell (any unused cell anywhere), use the value of that cell, and then remove the formula."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1548326934, "last_edit_date": 1548326934, "creation_date": 1548249115, "answer_id": 54328071, "question_id": 54327716, "link": "https://stackoverflow.com/questions/54327716/formula-in-vba-and-be-used-whithin-vba/54328071#54328071", "title": "Formula in VBA and be used whithin VBA", "body": "<p>Use this. You might need an extra bracket in your formula. <code>MaxY</code> is a variable so you want to access its value directly; it does not \"belong\" to a worksheet.</p>\n\n<pre><code>Sub x()\n\nDim MaxY As Integer\n\nWith Range(\"A1\")\n    .Formula = \"=MAX(K3+50,ROUNDUP(IF(OR(ISBLANK('Station info'!C12),ISBLANK('Station info'!C8)),MAX(ABS(MIN(Data!B3:B10000)),ABS(MAX(Data!B3:B10000))),IF(('Station info'!C8-MAX(ABS(MIN(Data!B3:B10000)),ABS(MAX(Data!B3:B10000)))-MAX(Data!B3:B10000)+MIN(Data!B3:B10000))&lt;'Station info'!C12,'Station info'!C8-'Station info'!C12+1,MAX(ABS(MIN(Data!B3:B10000)),ABS(MAX(Data!B3:B10000))))),0))\"\n    MaxY = .Value\n    .Clear\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10955764, "user_type": "registered", "profile_image": "https://graph.facebook.com/2016775975084275/picture?type=large", "display_name": "Mhmd Qadi", "link": "https://stackoverflow.com/users/10955764/mhmd-qadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548326934, "creation_date": 1548247900, "last_edit_date": 1548248191, "question_id": 54327716, "link": "https://stackoverflow.com/questions/54327716/formula-in-vba-and-be-used-whithin-vba", "title": "Formula in VBA and be used whithin VBA", "body": "<p>I am trying to actulize my exel chart, I use the following code:</p>\n\n<pre><code>ActiveChart.Axes(xlValue, xlPrimary).MinimumScale = Sheets(\"Data\").Range(\"K5\").Value\n</code></pre>\n\n<p>I want to use the K5 value in the code ( not to keep in a cell) </p>\n\n<p>so i did the following: </p>\n\n<pre><code>Dim MaxY As Integer\n\nMaxY = (\"=MAX(K3+50,ROUNDUP(IF(OR(ISBLANK('Station info'!C12),ISBLANK('Station info'!C8)),MAX(ABS(MIN(Data!B3:B10000)),ABS(MAX(Data!B3:B10000))),IF(('Station info'!C8-MAX(ABS(MIN(Data!B3:B10000)),ABS(MAX(Data!B3:B10000)))-MAX(Data!B3:B10000)+MIN(Data!B3:B10000))&lt;'Station info'!C12,'Station info'!C8-'Station info'!C12+1,MAX(ABS(MIN(Data!B3:B10000)),ABS(MAX(Data!B3:B10000))))),0))\") \n\n\n ActiveChart.Axes(xlValue, xlPrimary).MinimumScale = Sheets(\"Data\").MaxY.Value\n\nend sub \n</code></pre>\n\n<p>It is not working, but the formula works if I put in K5 and refer to K5.</p>\n\n<p>How can I solve this problem and define the teh formula and keep it within VBA code??</p>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548247584, "post_id": 54327435, "comment_id": 95473216, "body": "What should <code>ray(1 To Rng.Count, 1 To 4)</code> do? Probably you meant something like <code>ReDim ray(1 To Rng.Count, 1 To 4)</code>?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1548248138, "post_id": 54327435, "comment_id": 95473510, "body": "Declare your array and turn it around like <code>Dim ray(1 To 4, 1)</code> then <code>ReDim</code> the array when required?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1548248294, "last_edit_date": 1548248294, "creation_date": 1548247232, "answer_id": 54327521, "question_id": 54327435, "link": "https://stackoverflow.com/questions/54327435/statement-invalid-outside-type-block-vba/54327521#54327521", "title": "Statement invalid outside Type block - VBA", "body": "<p>I guess you are trying to declare or reinitialize an array called <code>ray</code>.</p>\n\n<p>Thus either the word <code>ReDim</code> or <code>Dim</code> is skipped:</p>\n\n<pre><code>Sub nSum()\n    Dim Rng As Range, Dn As Range, n As Long, Txt As String, Ac As Long\n    Set Rng = Range(Range(\"A1\"), Range(\"A\" &amp; Rows.Count).End(xlUp))\n    Dim ray(1 To Rng.Count, 1 To 4) 'Or Redim Ray(1 To ...\n    'Rest of the code\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 54327521, "answer_count": 1, "score": 0, "last_activity_date": 1548248294, "creation_date": 1548246938, "last_edit_date": 1548247062, "question_id": 54327435, "link": "https://stackoverflow.com/questions/54327435/statement-invalid-outside-type-block-vba", "title": "Statement invalid outside Type block - VBA", "body": "<p>I have the below code which consolidates/ merges all duplicate rows with the same text in columns 1-4 and sums the value in column 5. </p>\n\n<p>The code has been functioning correctly for some time however all of a sudden has stopped working and I am faced with the below error message: </p>\n\n<p>Compile Error:</p>\n\n<blockquote>\n  <p>Statement invalid outside type block</p>\n</blockquote>\n\n<p>Any help to resolve this would be much appreciated</p>\n\n<pre><code>Sub nSum()\n    Dim Rng As Range, Dn As Range, n As Long, Txt As String, Ac As Long\n    Set Rng = Range(Range(\"A1\"), Range(\"A\" &amp; Rows.Count).End(xlUp))\n    ray(1 To Rng.Count, 1 To 4) 'Column count ''***ERROR LINE***************\n\n    With CreateObject(\"scripting.dictionary\")\n        .CompareMode = vbTextCompare\n\n        For Each Dn In Rng\n            Txt = Join(Application.Transpose(Application.Transpose(Dn.Resize(, 3))), \",\")\n            If Not .Exists(Txt) Then\n                n = n + 1\n                For Ac = 1 To 4: ray(n, Ac) = Dn.Offset(, Ac - 1): Next Ac\n                .Add Txt, n\n            Else\n                ray(.Item(Txt), 4) = ray(.Item(Txt), 4) + Dn.Offset(, 3)\n            End If\n        Next\n\n        n = .Count\n    End With\n\n    With Sheets(\"Sheet2\").Range(\"A1\").Resize(n, 4)\n        .Value = ray\n        .Borders.Weight = 2\n        .Columns.AutoFit\n    End With\nEnd Sub'\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "ado"], "comments": [{"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1548246807, "post_id": 54327264, "comment_id": 95472766, "body": "Did you create such a datasource? And as far as I remember there is a difference in datasources for 32 and 64 bit. So the datasource should be created according to the architecture (32/64bit) of Microsoft Office. Edit: I see right now, that you aren&#39;t really talking about DataSources stored in Windows."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1548247133, "post_id": 54327264, "comment_id": 95472943, "body": "As you can see here <code>https:&#47;&#47;www.vlsoftware.net&#47;documentation&#47;exportizer&#47;connecti&zwnj;&#8203;on-strings-examples.&zwnj;&#8203;htm</code> you maybe should use a different type of connection string for <code>accdb</code>?"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "reply_to_user": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1548247690, "post_id": 54327264, "comment_id": 95473272, "body": "@UnhandledException I am talking about data sources stored in windows. As the data source name i have to fill in the name of the access table, don&#39;t I? I am trying to push data from an Excel Sheet to Access (and update a SharePoint list form there)"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549619843, "post_id": 54327264, "comment_id": 95976028, "body": "Did you succeed with any of the answers?"}, {"owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1549620385, "post_id": 54327264, "comment_id": 95976353, "body": "@Asger no unfortunately not"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1548250817, "creation_date": 1548250817, "answer_id": 54328613, "question_id": 54327264, "link": "https://stackoverflow.com/questions/54327264/ado-provider-data-source-name-not-found/54328613#54328613", "title": "ADO Provider: Data source name not found", "body": "<p>Why not just use a <code>select into</code> or <code>insert into</code>  </p>\n\n<p>like this, where f1 is column 1(A) and f3 is column 3(C) </p>\n\n<p><code>select f1,f3 INTO tbl1 FROM [EXCEL 12.0;HDR=YES;IMEX=2;DATABASE=C:\\Workspace\\test_data1.xlsx].[sheet1$]</code></p>\n\n<p>or</p>\n\n<p><code>insert into tbl1 SELECT f1,f3 FROM [EXCEL 12.0;HDR=YES;IMEX=2;DATABASE=C:\\Workspace\\test_data1.xlsx].[sheet1$]</code></p>\n"}], "owner": {"reputation": 57, "user_id": 10941795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2a5ffe6f90206f46deff084ac9160b?s=128&d=identicon&r=PG&f=1", "display_name": "Roxana", "link": "https://stackoverflow.com/users/10941795/roxana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548263490, "creation_date": 1548246389, "last_edit_date": 1548247024, "question_id": 54327264, "link": "https://stackoverflow.com/questions/54327264/ado-provider-data-source-name-not-found", "title": "ADO Provider: Data source name not found", "body": "<p>I know this question has been asked before but I can't get the recommendations from previous posts to work. </p>\n\n<p>Below you can see my code which I think is more or less working properly but I always get an error for the data source name.</p>\n\n<p>Any help on that would be very much appreciated! </p>\n\n<pre><code>Sub ADOFromExcelToAccess()\n    Dim cn As ADODB.Connection, rs As ADODB.Recordset, i As Long\n\n    Set cn = New ADODB.Connection\n    cn.Open \"Provider = MSDASQL;\" &amp;_\n      \"Data Source = C:\\Users\\ablohn\\Documents\\Database2.accdb\"\n\n    Set rs = New ADODB.Recordset\n    rs.Open \"NameofTable\", cn, adOpenKeyset, adLockOptimistic,    adCmdTable\n\n    For i = 1 To 10 \n        x = 0\n\n        Do While Len(Range(\"A\" &amp; i).Offset(0, x).Formula &gt; 0\n            With rs\n                .AddNew\n                .Fields(\"Name1\") = Range (\"A\" &amp; i).Value\n                'repeated for as many times as needed\n                .Update\n            End With\n            x = x + 1\n        Loop\n    Next i\n\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1548246261, "post_id": 54327083, "comment_id": 95472478, "body": "Put <code>Option Explicit</code> on top. Declare all variables. Have a look at <a href=\"https://stackoverflow.com/a/27302888/11683\">stackoverflow.com/a/27302888/11683</a>, then <a href=\"https://stackoverflow.com/q/10714251/11683\">stackoverflow.com/q/10714251/11683</a>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1548248180, "post_id": 54327083, "comment_id": 95473530, "body": "Other than that, the code should work. It probably does what you did not expect it to do (e.g. <code>test_selection = Selection</code> copies the cells&#39; values into an array instead or remembering reference to the range), but it works. If it does not for you, it is only because <code>Match</code> does not find anything."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1548246516, "post_id": 54327267, "comment_id": 95472628, "body": "Why use <code>Transpose</code> at all? <code>Match</code> is okay with either rows or columns."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1548246619, "post_id": 54327267, "comment_id": 95472687, "body": "I was incorrectly assuming there was a reason for the <code>Index</code> but you&#39;re right"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1548246868, "post_id": 54327267, "comment_id": 95472805, "body": "Now you&#39;re incorrectly assuming Match can accept a 2D array or range; it cannot."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1548247145, "post_id": 54327267, "comment_id": 95472949, "body": "@GSerg Had noticed too - You beat me to updating my answer. Works now"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1548247945, "post_id": 54327267, "comment_id": 95473417, "body": "Also the entire <code>.End()</code> business, given that we start from top left, can be replaced with <code>.Range(&quot;start&quot;).CurrentRegion</code>. And while coding it this way instead of with the <code>Index()</code> is arguably better, the OP&#39;s original code should work too."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1548250198, "post_id": 54327267, "comment_id": 95474711, "body": "@GSerg Didn&#39;t know about <code>CurrentRegion</code> that&#39;s a handy property"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1548250305, "last_edit_date": 1548250305, "creation_date": 1548246402, "answer_id": 54327267, "question_id": 54327083, "link": "https://stackoverflow.com/questions/54327083/getting-the-unable-to-get-the-match-property-of-the-worksheetfunction-class-er/54327267#54327267", "title": "Getting the &quot;Unable to get the Match property of the WorksheetFunction class&quot; error", "body": "<p>You can achieve what you're trying to do using <code>.Columns(1)</code> instead of indexing the Range. I've updated your code as well to avoid using <code>Select</code> statements. You should update the first <code>With</code> with a proper reference to the sheet that this is on instead of using <code>ActiveSheet</code></p>\n\n<pre><code>Option Explicit\nSub Test()\n    Dim test_selection As Range\n    Dim Check_Row As Long\n\n    ' Update with your sheet reference\n    With ActiveSheet\n        set test_selection = .Range(\"start\").CurrentRegion\n\n        Check_Row = WorksheetFunction.Match(.Range(\"E17\").Value2, test_selection.Columns(1), 0)\n\n        .Range(\"E25\").Value = Check_Row\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 2245130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qB2DA.jpg?s=128&g=1", "display_name": "Milan", "link": "https://stackoverflow.com/users/2245130/milan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548250305, "creation_date": 1548245830, "last_edit_date": 1548246203, "question_id": 54327083, "link": "https://stackoverflow.com/questions/54327083/getting-the-unable-to-get-the-match-property-of-the-worksheetfunction-class-er", "title": "Getting the &quot;Unable to get the Match property of the WorksheetFunction class&quot; error", "body": "<p>I am getting the mentioned error when executing the following line of code:</p>\n\n<pre><code>Check_Row = Application.WorksheetFunction.Match(ActiveCell, Application.WorksheetFunction.Index(Selection, 0, 1), 0)\n</code></pre>\n\n<p>Both my <em>ActiveCell</em> and <em>Selection</em> seem to be correctly defined - <em>ActiveCell</em> contains some text, and the first Column of <em>Selection</em> contains a cell with the value match of <em>ActiveCell</em>. Also, when I try to run almost the same code (below) in a freshly opened excel sheet, it is working fine?</p>\n\n<pre><code>Sub Test()\n\nRange(\"start\").Select\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlToRight)).Select\ntest_selection = Selection\n\nRange(\"A8\").Select\n\nCheck_Row = Application.WorksheetFunction.Match(ActiveCell,Application.WorksheetFunction.Index(test_selection, 0, 1), 0)\n\nRange(\"A9\").Value = Check_Row\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TgWT6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TgWT6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone have an idea what I might be overlooking here? What could be causing this issue?</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1548275472, "post_id": 54327017, "comment_id": 95487743, "body": "You need <a href=\"https://codereview.stackexchange.com/\">code review</a>"}, {"owner": {"reputation": 35, "user_id": 10127482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b14e8af56be5092a519711e3a396129?s=128&d=identicon&r=PG&f=1", "display_name": "AdmirE", "link": "https://stackoverflow.com/users/10127482/admire"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1548278363, "post_id": 54327017, "comment_id": 95488896, "body": "@JohnyL, have i posted in the wrong group? I just need to understand how to loop through columns as well as rows without typing out instructions for each column."}], "owner": {"reputation": 35, "user_id": 10127482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b14e8af56be5092a519711e3a396129?s=128&d=identicon&r=PG&f=1", "display_name": "AdmirE", "link": "https://stackoverflow.com/users/10127482/admire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548272409, "creation_date": 1548245591, "last_edit_date": 1548272409, "question_id": 54327017, "link": "https://stackoverflow.com/questions/54327017/how-to-loop-countifs-through-a-range-of-rows-and-columns", "title": "How to loop countifs through a range of rows and columns", "body": "<p>Is there a way to simplify my code to avoid having to copy the following code for each column? </p>\n\n<p>I am able to loop through a range of rows within one column and apply a formula (in this case a countifs). How do i do apply the same for columns AA:AZ? </p>\n\n<p>My current code is below: </p>\n\n<pre><code>Sub CountIfsFormula2()\nDim lstrow As Long\nDim i As Long\n\nApplication.DisplayAlerts = False\nApplication.AskToUpdateLinks = False\nApplication.Calculation = xlCalculationManual\n\nlstrow = Cells(Rows.Count, \"B\").End(xlUp).Row\nFor i = 2 To lstrow\n    Range(\"C\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C,Sheet1!R1C3,'Agent_Detail_Data'!C[1],\"\"&gt;=\"\"&amp;Sheet1!RC[-1],'Agent_Detail_Data'!C[1],\"\"&lt;\"\"&amp;Sheet1!R[1]C[-1],'Agent_Detail_Data'!C[11],Sheet1!R1C1)\"\n    Range(\"D\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C[-1],Sheet1!R1C4,'Agent_Detail_Data'!C,\"\"&gt;=\"\"&amp;Sheet1!RC[-2],'Agent_Detail_Data'!C,\"\"&lt;\"\"&amp;Sheet1!R[1]C[-2],'Agent_Detail_Data'!C[10],Sheet1!R1C1)\"\n    Range(\"E\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C3,Sheet1!R1C5,'Agent_Detail_Data'!C[-1],\"\"&gt;=\"\"&amp;Sheet1!RC[-3],'Agent_Detail_Data'!C[-1],\"\"&lt;\"\"&amp;Sheet1!R[1]C[-3],'Agent_Detail_Data'!C[9],Sheet1!R1C1)\"\n    Range(\"F\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C3,Sheet1!R1C6,'Agent_Detail_Data'!C[-2],\"\"&gt;=\"\"&amp;Sheet1!RC[-4],'Agent_Detail_Data'!C[-2],\"\"&lt;\"\"&amp;Sheet1!R[1]C[-4],'Agent_Detail_Data'!C[8],Sheet1!R1C1)\"\n    Range(\"G\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C3,Sheet1!R1C7,'Agent_Detail_Data'!C[-3],\"\"&gt;=\"\"&amp;Sheet1!RC[-5],'Agent_Detail_Data'!C[-3],\"\"&lt;\"\"&amp;Sheet1!R[1]C[-5],'Agent_Detail_Data'!C[7],Sheet1!R1C1)\"\n    Range(\"H\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C3,Sheet1!R1C8,'Agent_Detail_Data'!C[-4],\"\"&gt;=\"\"&amp;Sheet1!RC[-6],'Agent_Detail_Data'!C[-4],\"\"&lt;\"\"&amp;Sheet1!R[1]C[-6],'Agent_Detail_Data'!C[6],Sheet1!R1C1)\"\n    Range(\"I\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C3,Sheet1!R1C9,'Agent_Detail_Data'!C[-5],\"\"&gt;=\"\"&amp;Sheet1!RC[-7],'Agent_Detail_Data'!C[-5],\"\"&lt;\"\"&amp;Sheet1!R[1]C[-7],'Agent_Detail_Data'!C[5],Sheet1!R1C1)\"\n    Range(\"J\" &amp; i).Formula = \"=COUNTIFS('Agent_Detail_Data'!C3,Sheet1!R1C10,'Agent_Detail_Data'!C[-6],\"\"&gt;=\"\"&amp;Sheet1!RC[-8],'Agent_Detail_Data'!C[-6],\"\"&lt;\"\"&amp;Sheet1!R[1]C[-8],'Agent_Detail_Data'!C[4],Sheet1!R1C1)\"\n\nNext i\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nApplication.AskToUpdateLinks = True\nApplication.Calculation = xlCalculationAutomatic\n\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2007"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1548245747, "post_id": 54326972, "comment_id": 95472191, "body": "The .CopyFile code will not compile because the _ strings are broken? please post the real code.  Note that the Mth1 directory must exists, it will not be created.  There is a built in FileCopy() function so you can remove the unnecessary FSO code."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1548248452, "post_id": 54326972, "comment_id": 95473694, "body": "Does <code>&quot;C:\\Users\\Peter\\Business\\Invoices\\Sent Invoices\\ _ &quot; &amp; Mth1 &amp; &quot;\\&quot;</code> exist at the time you&#39;re trying to copy a file to it? If not, I&#39;m fairly certain the <code>.CopyFile</code> will fail. You will have to <i>create</i> the directory if it doesn&#39;t exist."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1548248603, "post_id": 54326972, "comment_id": 95473781, "body": "Also, <code>&quot;C:\\Users\\Peter\\Business\\Invoices\\Sent Invoices\\ _ &quot; &amp; Mth1 &amp; &quot;\\&quot;</code> is probably not valid at all with  &quot; _ &quot; in the actual path. If you&#39;re trying to do a line continuation with the <code>_</code>, you need it to be <i>outside</i> the quoted string. In your <code>FSO.CopyFile</code> line, you can use <code>Destination:=Path2</code> to save yourself from typos especially since you declared <code>Path2</code> and haven&#39;t otherwise used it."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4108536, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RHaO4wuHxk/AAAAAAAAAAI/AAAAAAAABKw/y1j3ywXUzV0/photo.jpg?sz=128", "display_name": "Kostas Moschidis Taksidioths", "link": "https://stackoverflow.com/users/4108536/kostas-moschidis-taksidioths"}, "is_accepted": false, "score": 0, "last_activity_date": 1616360440, "creation_date": 1616360440, "answer_id": 66737500, "question_id": 54326972, "link": "https://stackoverflow.com/questions/54326972/how-to-correct-the-error-path-file-not-found-using-the-copyfile-method/66737500#66737500", "title": "how to correct the error &quot;Path/File Not Found&quot; using the CopyFile Method", "body": "<p>I faced the same problem, and from what I saw, this question is asked by many. I think you create the problem when before the FileCopy command there is a command to create the folder that will copy the file. So a compiler that is faster than the hard drive just can't find the folder, because that's what you're creating right now.\nIf you put a delay of 1 second <strong>before the command FileCopy</strong> ,\nlike this..</p>\n<p><strong>Application.Wait (Now + TimeValue(&quot;0:00:01&quot;))</strong></p>\n<p>the problem will be solved</p>\n"}], "owner": {"reputation": 1, "user_id": 9240799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e83bdf71b4a814c0da72ac95021a077?s=128&d=identicon&r=PG&f=1", "display_name": "maltmuncher", "link": "https://stackoverflow.com/users/9240799/maltmuncher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1616360440, "creation_date": 1548245395, "last_edit_date": 1548245615, "question_id": 54326972, "link": "https://stackoverflow.com/questions/54326972/how-to-correct-the-error-path-file-not-found-using-the-copyfile-method", "title": "how to correct the error &quot;Path/File Not Found&quot; using the CopyFile Method", "body": "<p>I am trying to save a sheet as a PDF file to the desktop then copy the file to another location, using the FileCopy method. I keep getting \"File Not Found\" or \"Path Not Found\" errors.</p>\n\n<p>When using the FileCopy method it creates a file on the desktop, then throw up errors for copying the file. Previous to this I tried creating the pdf twice, one after the other, and it creates on the desktop and creates another in the relevant monthly folder. Tried different syntax regarding the 2 variables I'm using. Can't seem to get anything correct. Trying to make code more efficient</p>\n\n<pre><code>Sub Save_Invoice_To_PDF()\n\nDim Fso As Scripting.FileSystemObject\nDim Invoice As Worksheet\nDim Fname As String\nDim Path1 As String\nDim Path2 As String\nDim PndSign As String\nDim Mth As String\nDim Mth1 As String\n\nSet Invoice = Sheet1\n\nPndSign = Chr(163)\n\nMth = Invoice.Range(\"A16\").Value\nMth1 = MonthName(Month(Mth))\n\nPath1 = \"C:\\Users\\Peter\\Desktop\\\"\nPath2 = \"C:\\Users\\Peter\\Documents\\Business\\Sent Invoices\\\" &amp; Mth1 &amp; \"\\\"\nFname = Range(\"C16\").Value &amp; \" \" &amp; Range(\"A8\").Value &amp; \" \" &amp; _\n    PndSign &amp; \"\" &amp; Range(\"E46\").Value _\n    &amp; \" \" &amp; Format(Range(\"A16\"), \"dd-mm-yyyy\") &amp; \".pdf\"\n\nApplication.ScreenUpdating = False\n\n\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n    Filename:=Path1 &amp; \" \" &amp; Fname, _\n    Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n\n\n  Set Fso = New FileSystemObject\n\n    Fso.CopyFile Source:=\"C:\\Users\\Peter\\Desktop\\\" &amp; Fname, _\nDestination:=\"C:\\Users\\Peter\\Business\\Invoices\\Sent Invoices\\ _\n\" &amp; Mth1 &amp; \"\\\"\n\nSet Fso = Nothing\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Would just like to save one pdf to the desktop and copy that pdf to a monthly folder that is designated in the Mth1 variable which is obtained in part from the files Fname variable, ie Format(Range(\"A16\"), \"dd-mm-yyyy\"). Thanks for any help received.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1548244982, "post_id": 54326559, "comment_id": 95471788, "body": "What efforts have you made yourself? You should be able to google and cobble something together to kick you off."}, {"owner": {"reputation": 359, "user_id": 4218363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fea557cac50b3b60be017ef19ccba50c?s=128&d=identicon&r=PG&f=1", "display_name": "Jelmer", "link": "https://stackoverflow.com/users/4218363/jelmer"}, "edited": false, "score": 0, "creation_date": 1548245010, "post_id": 54326559, "comment_id": 95471797, "body": "Have a look here. This should get you started.  <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 10955473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65ebd9397f74a281e7600ae2084a2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/10955473/richard"}, "edited": false, "score": 0, "creation_date": 1548247308, "post_id": 54326559, "comment_id": 95473062, "body": "Hi SJR, I eddited the post to show what I have attempted."}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1548247152, "creation_date": 1548247152, "answer_id": 54327494, "question_id": 54326559, "link": "https://stackoverflow.com/questions/54326559/how-to-insert-and-offset-an-image-based-on-cell-value/54327494#54327494", "title": "How to insert and offset an image based on cell value", "body": "<p>You could use:</p>\n\n<pre><code>Option Explicit\n\nSub image()\n\n    Dim i As Long, Lastrow As Long\n    Dim pic As Picture\n    Dim rng As Range\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Lastrow = .Cells(.Rows.Count, \"O\").End(xlUp).Row\n\n        For i = 1 To Lastrow\n\n            If .Range(\"O\" &amp; i).Value = \"Import\" Then\n\n                Set rng = .Range(\"O\" &amp; i).Offset(0, -9)\n\n                With .Pictures.Insert(\"C:\\Users\\XXXXX\\Desktop\\download.jpg\")\n                    .Top = rng.Top\n                    .Left = rng.Left\n                End With\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10955473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65ebd9397f74a281e7600ae2084a2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/10955473/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1561570038, "creation_date": 1548244009, "last_edit_date": 1561570038, "question_id": 54326559, "link": "https://stackoverflow.com/questions/54326559/how-to-insert-and-offset-an-image-based-on-cell-value", "title": "How to insert and offset an image based on cell value", "body": "<p>I'm facing a bit of an issue.</p>\n\n<p>We needed to make a small, single cell, change to about a 1000 client statements (excel). I ran the change in python using openpyxl and all the company logos disappeared.</p>\n\n<p>I have compiled a VBA to put the images back but am struggling with getting them in the right position on the second page as the top of the second page is not a set row number.</p>\n\n<p>However, the clients name marks the top of the second page.</p>\n\n<p>Is there a way I can search column B for the clients name and insert the companies logo in the same row but 9 columns to the right.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Sub Example()\nDim MyPath As String, FilesInPath As String\nDim MyFiles() As String, Fnum As Long\nDim mybook As Workbook\nDim CalcMode As Long\nDim sh As Worksheet\nDim ErrorYes As Boolean\n\n'Fill in the path\\folder where the files are\nMyPath = \"Path\\to\\excels\"\n\n'Add a slash at the end if the user forget it\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then\n    MyPath = MyPath &amp; \"\\\"\nEnd If\n\n'If there are no Excel files in the folder exit the sub\nFilesInPath = Dir(MyPath &amp; \"*.xl*\")\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n'Fill the array(myFiles)with the list of Excel files in the folder\nFnum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    Fnum = Fnum + 1\n    ReDim Preserve MyFiles(1 To Fnum)\n    MyFiles(Fnum) = FilesInPath\n    FilesInPath = Dir()\nLoop\n\n'Change ScreenUpdating, Calculation and EnableEvents\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n'Loop through all files in the array(myFiles)\nIf Fnum &gt; 0 Then\n    For Fnum = LBound(MyFiles) To UBound(MyFiles)\n        Set mybook = Nothing\n        On Error Resume Next\n        Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n        On Error GoTo 0\n\n        If Not mybook Is Nothing Then\n\n\n            'Change cell value(s) in one worksheet in mybook\n            On Error Resume Next\n            With mybook.ActiveSheet.Pictures.Insert(\"C:Path\\to\\Pic.jpg\")\n\n                    With .ShapeRange\n                        .LockAspectRatio = msoTrue\n                        .Width = 40\n                        .Height = 55\n            End With\n                        .Left = ActiveSheet.Range(\"K1\").Left\n                        .Top = ActiveSheet.Range(\"K1\").Top\n                        .Placement = 1\n                        .PrintObject = True\n\n\n            End With\n\n            With ActiveSheet.Range(\"B12:L13\").BorderAround(ColorIndex:=xlAutomatic, Weight:=xlMedium)\n\n            End With\n\n            If Err.Number &gt; 0 Then\n                ErrorYes = True\n                Err.Clear\n                'Close mybook without saving\n                mybook.Close savechanges:=False\n            Else\n                'Save and close mybook\n                mybook.Close savechanges:=True\n            End If\n            On Error GoTo 0\n        Else\n            'Not possible to open the workbook\n            ErrorYes = True\n        End If\n\n    Next Fnum\nEnd If\n\nIf ErrorYes = True Then\n    MsgBox \"There are problems in one or more files, possible problem:\" _\n         &amp; vbNewLine &amp; \"protected workbook/sheet or a sheet/range that not exist\"\nEnd If\n\n'Restore ScreenUpdating, Calculation and EnableEvents\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = CalcMode\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1548243159, "post_id": 54326266, "comment_id": 95470876, "body": "Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a> and <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please don&#39;t SHOUT!"}, {"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 2, "creation_date": 1548243544, "post_id": 54326266, "comment_id": 95471086, "body": "Surely a quick Google search: <i>polymorphism in vba</i> would have produced some results?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1548243606, "post_id": 54326266, "comment_id": 95471114, "body": "Read the excellent answer <a href=\"https://stackoverflow.com/a/31861832/7599798\">stackoverflow.com/a/31861832/7599798</a> from Mathieu Guindon (the artist formerly known as <i>Mat&#39;s Mug</i>) and have a look to <a href=\"https://stackoverflow.com/a/3142065/7599798\">stackoverflow.com/a/3142065/7599798</a>"}], "owner": {"reputation": 1, "user_id": 4874421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOcw9.jpg?s=128&g=1", "display_name": "Rahul Tandon", "link": "https://stackoverflow.com/users/4874421/rahul-tandon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1548243146, "answer_count": 0, "score": 0, "last_activity_date": 1548243051, "creation_date": 1548243051, "question_id": 54326266, "link": "https://stackoverflow.com/questions/54326266/polymorphism-in-vba", "closed_reason": "Duplicate", "title": "polymorphism in VBA", "body": "<p>IS POLYMORPHISM POSSIBLE IN VBA ? TO WHAT EXTENT? IF POLYMORPHISM IS POSSIBLE IN VBA THEN HOW CAN ONE INDUCE POLYMORPHISM (CREATE IT ARTIFICIALLY !) ?</p>\n\n<p>i need to instantiate a class in different ways than one (multiple constructors!)</p>\n\n<p>Namely, the Class_Initialize() should take arguments, also.</p>\n\n<p>So, also, i need to terminate the class in more ways than one (multiple destructors) !</p>\n\n<p>Namely, the Class_Terminate() should take arguments, also.</p>\n\n<p>Obviously, if it is possible then so should polymorphism be possible for regular functions and subs of VBA. </p>\n\n<p>i Have tried sample code. See below.Maybe i need to set a few switches also. like option explicit etc.</p>\n\n<pre><code>'class module PolyClass, private by default.\n\nPrivate var_x As Integer\n\nProperty Let Ix(Ix As Integer)\nvar_x = Ix\nMsgBox \"you put var_x = \" &amp; tx\nEnd Property\n\nProperty Let x(Dx As Double)\nvar_x = Dx\nMsgBox \"you put var_x = \" &amp; tx\nEnd Property\n\nProperty Get tx() As Integer\ntx = var_x\nEnd Property\n\nSub Class_Terminate()\nMsgBox \"Did it work?\"\nEnd Sub\n\nPublic Sub Class_Initialize() 'Ix As Integer)\nx = 1.0009\nIx = 2\nMsgBox \"you put var_x = \" &amp; tx\nEnd Sub\n\nPublic Sub Class_Initialize2(Dx As Double) ' I HAVE ADDED SUFFIX 2 TO \n'AVOID 'ERROR\nx = Dx\nMsgBox \"you put var_x = \" &amp; tx\nEnd Sub\n\nPublic Sub Class_Initialize3(Ix As Integer) ' I HAVE ADDED SUFFIX 3 TO \n'AVOID 'ERROR\nx = Ix\nMsgBox \"you put var_x = \" &amp; tx\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 4, "creation_date": 1548242619, "post_id": 54326086, "comment_id": 95470592, "body": "Always delete running from last line and going up."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548242876, "post_id": 54326086, "comment_id": 95470725, "body": "Or gather qualifying ranges with union and delete all in one go at end. This is a frequently asked question so there will be lots of examples. You should also remove the .Select and ActiveCell lines and simply work with the rng range object."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1548243042, "post_id": 54326086, "comment_id": 95470810, "body": "There are tons of questions about that, for example <a href=\"https://stackoverflow.com/questions/35042717/excel-vba-delete-rows\" title=\"excel vba delete rows\">stackoverflow.com/questions/35042717/excel-vba-delete-rows</a>. Bottom line is what Vincent G wrote: When deleting do it backwards. This is not limited to Excel, this is true for any indexed list."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10775852, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ccp9xMOMxO0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hUaLQz3kRQMbV4SsyZn8hegaP_-g/mo/photo.jpg?sz=128", "display_name": "R&#252;diger Rodriguez", "link": "https://stackoverflow.com/users/10775852/r%c3%bcdiger-rodriguez"}, "edited": false, "score": 0, "creation_date": 1548243878, "post_id": 54326426, "comment_id": 95471244, "body": "Thanks @Gary&#39;s Student and Vincent G. This worked flawless and makes absolutely sense!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1548243552, "creation_date": 1548243552, "answer_id": 54326426, "question_id": 54326086, "link": "https://stackoverflow.com/questions/54326086/for-each-loop-doesnt-seem-to-iterate-over-every-row/54326426#54326426", "title": "For each loop doesn&#39;t seem to iterate over every row", "body": "<p>Replace:</p>\n\n<pre><code>For i = 2 To dblZeilen + 1\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>For i = dblZeilen + 1 To 2 Step -1\n</code></pre>\n\n<p>When deleting, run the loop backwards to avoid corrupting the index.</p>\n\n<p><em>(there may be other problems)</em></p>\n"}], "owner": {"reputation": 3, "user_id": 10775852, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ccp9xMOMxO0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hUaLQz3kRQMbV4SsyZn8hegaP_-g/mo/photo.jpg?sz=128", "display_name": "R&#252;diger Rodriguez", "link": "https://stackoverflow.com/users/10775852/r%c3%bcdiger-rodriguez"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1548243641, "accepted_answer_id": 54326426, "answer_count": 1, "score": -1, "last_activity_date": 1548246323, "creation_date": 1548242473, "last_edit_date": 1548246323, "question_id": 54326086, "link": "https://stackoverflow.com/questions/54326086/for-each-loop-doesnt-seem-to-iterate-over-every-row", "closed_reason": "Duplicate", "title": "For each loop doesn&#39;t seem to iterate over every row", "body": "<p>I want the code to check every row whether it is 0 or not. If it is equal 0, the row should be deleted. The code works, but it seems that it doesn't go in every row. I put in debug.print to show how many rows are before running and after. If I run the code multiple times it gets to the point it should heading (106 rows should be not deleted)</p>\n\n<pre><code>Dim dblZeilen As Double\ndblZeilen = Worksheets(\"Data\").Range(\"A1\", Range(\"A1\").End(xlDown)).Count\nDebug.Print dblZeilen\n\nFor i = 2 To dblZeilen + 1\n    If Worksheets(\"Data\").Range(\"N\" &amp; i).Value = 0 Then\n        Worksheets(\"Data\").Rows(i).Delete\n    End If\nNext i \n\ndblZeilen = Range(\"A1\", Range(\"A1\").End(xlDown)).Count - 1\nDebug.Print dblZeilen\n</code></pre>\n\n<p>The results from debug.print in order:</p>\n\n<ul>\n<li>460 </li>\n<li><p>279 </p></li>\n<li><p>279 </p></li>\n<li>187 </li>\n<li>187 </li>\n<li>142 </li>\n<li>142 </li>\n<li>121 </li>\n<li>121 </li>\n<li>112 </li>\n<li>112 </li>\n<li>109 </li>\n<li>109 </li>\n<li>107 </li>\n<li>107 </li>\n<li>106 </li>\n</ul>\n\n<p>So after the 8th iteration running the code, the result was right.\nI've also tried another way to get this running, which didn't help.</p>\n\n<pre><code>Dim dblZeilen As Double\ndblZeilen = Worksheets(\"Data\").Range(\"A1\", Range(\"A1\").End(xlDown)).Count\nDebug.Print dblZeilen\nDim rng As Range\nDim rngBereich As Range\n\nSet rngBereich = Worksheets(\"Data\").Range(\"N2:N\" &amp; dblZeilen)\n\nWorksheets(\"Data\").Range(\"N2:N\" &amp; dblZeilen).NumberFormat = \"0.00\"\n\nFor Each rng In rngBereich\n    If rng = 0 Then\n        rng.Select\n        ActiveCell.EntireRow.Delete\n    End If\nNext rng\n\ndblZeilen = Worksheets(\"Data\").Range(\"A1\", Range(\"A1\").End(xlDown)).Count\nDebug.Print dblZeilen\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 0, "last_activity_date": 1548244636, "creation_date": 1548244636, "answer_id": 54326749, "question_id": 54326040, "link": "https://stackoverflow.com/questions/54326040/best-way-to-export-an-icon-image-from-access/54326749#54326749", "title": "Best way to export an Icon Image from Access?", "body": "<p>You can use this code blow.</p>\n\n<p>It will save the content of all image controls of the provided form to files in the same folder.</p>\n\n<p>Beware that some image controls contain 'strange' binary formats which maybe can't be displayed properly by every tool.</p>\n\n<p>Also you would have to take care to assign a correct file extension after exporting yourself.</p>\n\n<p>Place the code in a new module, then open the form in design view and call it like this: <code>SaveAllImageControls Forms(\"MyForm\")</code></p>\n\n<pre><code>Public Sub SaveAllImageControls(ByRef sourceForm As Form)\n    Dim item As control\n    For Each item In sourceForm.Controls: Do\n        If item.ControlType &lt;&gt; acImage Then Exit Do\n        If IsNull(item.PictureData) Then Exit Do\n\n        Dim bArray() As Byte\n        bArray = item.PictureData\n\n        Dim filename As String\n        filename = Application.CurrentDb.Name &amp; \"-\" &amp; sourceForm.Name &amp; \"-\" &amp; item.Name &amp; \".binary\"\n\n        Dim fileNumber As Integer\n        fileNumber = FreeFile\n\n        Open filename For Binary As fileNumber\n        Put fileNumber, , bArray\n        Close fileNumber\n    Loop While False: Next item\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1548244680, "creation_date": 1548244680, "answer_id": 54326765, "question_id": 54326040, "link": "https://stackoverflow.com/questions/54326040/best-way-to-export-an-icon-image-from-access/54326765#54326765", "title": "Best way to export an Icon Image from Access?", "body": "<p>The simplest solution is probably to export all the ico files and then process them with <a href=\"https://www.imagemagick.org/\" rel=\"nofollow noreferrer\">ImageMagick</a>. You can run something like</p>\n\n<pre><code>convert image.ico image.png\n</code></pre>\n\n<p>either as part of the code you linked to or as a plain one time call in a command prompt.</p>\n"}], "owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 54326749, "answer_count": 2, "score": 0, "last_activity_date": 1548244680, "creation_date": 1548242313, "last_edit_date": 1548243324, "question_id": 54326040, "link": "https://stackoverflow.com/questions/54326040/best-way-to-export-an-icon-image-from-access", "title": "Best way to export an Icon Image from Access?", "body": "<p>I have about 50 icon images (.ico) on an Access form, however I don't have them stored on a disk. I'd like to export them from Access onto a disk location.</p>\n\n<p>I tried the suggested solution on this thread:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10792426/access-export-images-from-image-controls-in-forms][1]\">Access - Export images from Image controls in forms</a></p>\n\n<p>I couldn't open the resulting file, probably because my images are (.ico) rather than (.png)</p>\n\n<p>EDIT: I'm able to copy the icons into paint, save them as pngs, then use an online converter to convert them to icons. Pretty time consuming but it works.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548241589, "post_id": 54324574, "comment_id": 95470003, "body": "You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a> and I recommend to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548240526, "post_id": 54325472, "comment_id": 95469410, "body": "<code>-365</code> doesn&#39;t work with lap years. Also this does not work for <i>&quot;to filter 12 months from <b>last month before the actual month</b> we may be in&quot;</i>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548240780, "post_id": 54325472, "comment_id": 95469557, "body": "@P\u1d07\u029c please see edit.  My answer was to prompt the OP to research it, understand it, not just do it for them :o)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548241189, "post_id": 54325472, "comment_id": 95469795, "body": "Yes, but I think the OP wanted to have the result of <i>full</i> months (see the bold part of my comment) and not from/till the <i>current day of the month</i>. So I think that was the tricky part to solve: Finding the end of the previous month and <i>then</i> go 12 month backwards."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548241381, "post_id": 54325472, "comment_id": 95469880, "body": ":o)  no worries, my first question here a long time ago, I was just prompted, felt a little bit deflated, but using those prompts helped me, so I try to do the same in my answers.  There&#39;s always <code>cdate(application.WorksheetFunction.EoMonth(date,-1))</code> to :)"}, {"owner": {"reputation": 9, "user_id": 10561525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dda00622c86021b9be697eff9617bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jemmy", "link": "https://stackoverflow.com/users/10561525/jemmy"}, "edited": false, "score": 0, "creation_date": 1548246102, "post_id": 54325472, "comment_id": 95472384, "body": "Nathan thank, that actually is a good solution to me but not to my superior who doesn&#39;t want anything to do with programming so i have to keep looking for ways to auomate it to suit the desired usage..."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 9, "user_id": 10561525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dda00622c86021b9be697eff9617bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jemmy", "link": "https://stackoverflow.com/users/10561525/jemmy"}, "edited": false, "score": 0, "creation_date": 1548246236, "post_id": 54325472, "comment_id": 95472459, "body": "@Jemmy sorry, I don&#39;t understand what input will be required after this???"}, {"owner": {"reputation": 9, "user_id": 10561525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dda00622c86021b9be697eff9617bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jemmy", "link": "https://stackoverflow.com/users/10561525/jemmy"}, "edited": false, "score": 0, "creation_date": 1548246433, "post_id": 54325472, "comment_id": 95472583, "body": "Nathan, input as in data or what do you mean ? Hope i understood you, the macro is to fliter date info on a basis of 12 months in the past without including the current month and do it at any period of the year"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548250403, "post_id": 54325472, "comment_id": 95474841, "body": "I see, change &gt;=date-365 to <code>&gt;=dateadd(&quot;yyyy&quot;,-1,cdate(worksheetfunction.eomonth(date,-1)&zwnj;&#8203;))</code>"}, {"owner": {"reputation": 9, "user_id": 10561525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dda00622c86021b9be697eff9617bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jemmy", "link": "https://stackoverflow.com/users/10561525/jemmy"}, "edited": false, "score": 0, "creation_date": 1548253135, "post_id": 54325472, "comment_id": 95476462, "body": "Hey Nathan, am receiving an error message on &quot;yyyy&quot; part of what you told me to change soi was wondering what was causing it"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1548253841, "post_id": 54325472, "comment_id": 95476904, "body": "So you replace <code>lngStart</code>  with <code>dateadd(&quot;yyyy&quot;,-1,cdate(worksheetfunction.eomonth(date,-1)))</code>  you have a solution here from myself and Peh, so without seeing your screen, we cant see what you are doing."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1548240664, "last_edit_date": 1548240664, "creation_date": 1548240420, "answer_id": 54325472, "question_id": 54324574, "link": "https://stackoverflow.com/questions/54324574/filter-data-in-function-of-say-12-months-ago-depending-on-the-month-before-the-o/54325472#54325472", "title": "Filter data in function of say 12 months ago depending on the month before the one we may be in without manually typing the start and end dates?", "body": "<pre><code>ActiveSheet.ListObjects(\"Tableau1\").Range.AutoFilter Field:=30, _\n    Criteria1:=\"&gt;=\" &amp; date-365, _\n    Operator:=xlAnd, _\n    Criteria2:=\"&lt;=\" &amp; date\n</code></pre>\n\n<p>Or you can use <code>dateadd(\"yyyy\",-1,date)</code> function to be more precise, change the period you wish to look back on</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10561525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dda00622c86021b9be697eff9617bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jemmy", "link": "https://stackoverflow.com/users/10561525/jemmy"}, "edited": false, "score": 0, "creation_date": 1548245740, "post_id": 54325475, "comment_id": 95472185, "body": "Peh thanks, i can&#39;t get the desired result. i edited as below:        Dim StartDate As Variant Dim lngStart As Variant Dim astDayOfPreviousMonth As Variant Dim DateSerialll As Variant   DateSerialll = DateSerial(Year(Date), Month(Date), 1) LastDayOfPreviousMonth = DateAdd(&quot;d&quot;, -1, DateSerial(Year(Date), Month(Date), 1)) StartDate = DateAdd(&quot;m&quot;, -12, DateOfLastMonth) Range(&quot;Tableau1[[#Headers],[Date dernier freinage]]&quot;).Select ActiveSheet.ListObjects(&quot;Tableau1&quot;).Range.AutoFilter Field:=30, _ Criteria1:=&quot;&gt;=&quot; &amp; DateSerialll, _ Operator:=xlAnd, _ Criteria2:=&quot;&lt;=&quot; &amp; LastDayOfPreviousMonth"}, {"owner": {"reputation": 9, "user_id": 10561525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dda00622c86021b9be697eff9617bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jemmy", "link": "https://stackoverflow.com/users/10561525/jemmy"}, "edited": false, "score": 0, "creation_date": 1548251244, "post_id": 54325475, "comment_id": 95475392, "body": "PEH thank you so much as the code registers the instruction. When you go to personal filters you can see the desired filter (12 months) ago. However no infiormation is displayed on the sheet despite running the macro without any anomaly. I&#39;m now trying to figure that mystery out now"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1548246896, "last_edit_date": 1548246896, "creation_date": 1548240434, "answer_id": 54325475, "question_id": 54324574, "link": "https://stackoverflow.com/questions/54324574/filter-data-in-function-of-say-12-months-ago-depending-on-the-month-before-the-o/54325475#54325475", "title": "Filter data in function of say 12 months ago depending on the month before the one we may be in without manually typing the start and end dates?", "body": "<p>You can use the functions <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dateadd-function\" rel=\"nofollow noreferrer\">DateAdd</a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dateserial-function\" rel=\"nofollow noreferrer\">DateSerial</a>.</p>\n\n<p>Imagine today is <code>2019-01-23</code>. Then \u2026</p>\n\n<pre><code>DateSerial(Year(Date), Month(Date), 1)\n</code></pre>\n\n<p>\u2026 will give you the first day of the current month <code>2019-01-01</code>. If we then subtract 1 day from that using \u2026</p>\n\n<pre><code>LastDayOfPreviousMonth = DateAdd(\"d\", -1, DateSerial(Year(Date), Month(Date), 1))\n</code></pre>\n\n<p>\u2026 we get the last day of the previous month <code>2018-12-31</code> which should be your end date. And if we subtract 12 month from that date \u2026</p>\n\n<pre><code>StartDate = DateAdd(\"m\", -12, LastDayOfPreviousMonth)\n</code></pre>\n\n<p>\u2026 you will get your start date <code>2017-12-31</code>.</p>\n\n<hr>\n\n<pre><code>Sub filter_()\n\n    MsgBox \"12 months filter\"\n\n    Dim LastDayOfPreviousMonth As Date\n    LastDayOfPreviousMonth = DateAdd(\"d\", -1, DateSerial(Year(Date), Month(Date), 1))\n\n    Dim StartDate As Date\n    StartDate = DateAdd(\"m\", -12, LastDayOfPreviousMonth)\n\n    Sheets(\"RBT-RAT \").ListObjects(\"Tableau1\").Range.AutoFilter Field:=30, _\n        Criteria1:=\"&gt;=\" &amp; StartDate, _\n        Operator:=xlAnd, _\n        Criteria2:=\"&lt;=\" &amp; LastDayOfPreviousMonth\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10561525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33dda00622c86021b9be697eff9617bb?s=128&d=identicon&r=PG&f=1", "display_name": "Jemmy", "link": "https://stackoverflow.com/users/10561525/jemmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 54325475, "answer_count": 2, "score": 0, "last_activity_date": 1548246896, "creation_date": 1548237722, "last_edit_date": 1548238993, "question_id": 54324574, "link": "https://stackoverflow.com/questions/54324574/filter-data-in-function-of-say-12-months-ago-depending-on-the-month-before-the-o", "title": "Filter data in function of say 12 months ago depending on the month before the one we may be in without manually typing the start and end dates?", "body": "<p>Could any help be offered to try and change the below macro to something more automated. The below macro will filter data in fonction of start and end dates entered manually. I wish to do away with having to enter the dates manually and put a code that allows to filter data 12 months ago. I can't use the inbuilt one year filter in excel because; supposing we're in the middle of the year and i filter for 12 months, it will indeed filter data for the whole of 2018 yet my request will have been to filter 12 months from last month before the actual month we may be in. If i've not been clear enough, i will be happy to be precise for anyone with any idea. \nThank you in advance for any help</p>\n\n<p>This is for excel 2010 vba. I tried to do some reseach but to no avail and any solution makes the code give an error. But am still searching for solutions</p>\n\n<pre><code>Sub filter_()\n    Sheets(\"data1 \").Select\n\n    MsgBox \"12 months filter\"\n\n    lngStart = Application.InputBox(\"Enter start date of interest as dd/mm/yyyy\", Type:=1 + 2)\n    lngEnd = Application.InputBox(\"Enter end date of interest as dd/mm/yyyy\", Type:=1 + 2)\n    Sheets(\"RBT-RAT \").Select\n    Range(\"Tableau1[[#Headers],[Date dernier freinage]]\").Select\n    ActiveSheet.ListObjects(\"Tableau1\").Range.AutoFilter Field:=30, _\n    Criteria1:=\"&gt;=\" &amp; lngStart, _\n    Operator:=xlAnd, _\n    Criteria2:=\"&lt;=\" &amp; lngEnd\nEnd sub\n</code></pre>\n\n<p>I expect the code to be able to run without manually having to type in the start and end dates within which the filter should be applied and still filter in function of 12 months from which ever time of the year but without applying the filter from the current month. The actual macro posted just below does it but not automatically. </p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548239200, "post_id": 54324518, "comment_id": 95468641, "body": "You are looking for the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"nofollow noreferrer\">Workbooks.Open method</a> and you might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 33, "user_id": 10866494, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3w1ZC9lTr64/AAAAAAAAAAI/AAAAAAAAA4s/kZBfprtVRfo/photo.jpg?sz=128", "display_name": "Henry R", "link": "https://stackoverflow.com/users/10866494/henry-r"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548247419, "post_id": 54324518, "comment_id": 95473121, "body": "Thanks, this really helped!"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1548257287, "post_id": 54324518, "comment_id": 95479081, "body": "Put a Watch on strPathFile  and check it&#39;s value.  I think that you&#39;re missing some backslashes."}, {"owner": {"reputation": 33, "user_id": 10866494, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3w1ZC9lTr64/AAAAAAAAAAI/AAAAAAAAA4s/kZBfprtVRfo/photo.jpg?sz=128", "display_name": "Henry R", "link": "https://stackoverflow.com/users/10866494/henry-r"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 1, "creation_date": 1548419629, "post_id": 54324518, "comment_id": 95544526, "body": "@FrankBall Thanks, this helped me easily find the missing backslashes and other mistakes. Now the code works!"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10866494, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3w1ZC9lTr64/AAAAAAAAAAI/AAAAAAAAA4s/kZBfprtVRfo/photo.jpg?sz=128", "display_name": "Henry R", "link": "https://stackoverflow.com/users/10866494/henry-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1548419709, "creation_date": 1548419709, "answer_id": 54365455, "question_id": 54324518, "link": "https://stackoverflow.com/questions/54324518/excel-print-worksheets-to-pdf-from-closed-file/54365455#54365455", "title": "Excel print worksheets to PDF from closed file", "body": "<p>This is the final code that works for me. Definitely not the most elegant:</p>\n\n<pre><code>Sub ExportToPDFFromClosed()\n\nDim ws As Worksheet\nDim wbA As Workbook\nDim strPath\nDim strFile\nDim wb2 As Workbook\nDim strPath2\nDim saveDest\n\ni = 11\nj = 2\n\n\nApplication.ScreenUpdating = False\nSet wbA = ActiveWorkbook\nstrPath = wbA.path\nstrPath = strPath &amp; \"\\\"\nSet wbA = Workbooks.Open(strPath &amp; \"Job export pic3\")\nSet wb2 = ThisWorkbook\nstrPath2 = wb2.Sheets(\"Prep+BOM\").Range(\"B7\")\nsaveDest = \"C:\\suvaline\\\" &amp; strPath2 &amp; \"\\\"\n\nFor Each ws In Worksheets\nws.Select\nnm = wb2.Sheets(\"Prep+BOM\").Cells(i, j).Value _\n\nstrFile = nm &amp; \".pdf\"\nstrPathFile = saveDest &amp; nm &amp; \"\\\" &amp; strFile\n\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\nfilename:=strPathFile &amp; \".pdf\", _\nQuality:=xlQualityStandard, IncludeDocProperties:=True, _\nIgnorePrintAreas:=False, OpenAfterPublish:=False\n\n i = i + 1\n\nNext ws\n    wbA.Close\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10866494, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3w1ZC9lTr64/AAAAAAAAAAI/AAAAAAAAA4s/kZBfprtVRfo/photo.jpg?sz=128", "display_name": "Henry R", "link": "https://stackoverflow.com/users/10866494/henry-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548419709, "creation_date": 1548237514, "last_edit_date": 1548252391, "question_id": 54324518, "link": "https://stackoverflow.com/questions/54324518/excel-print-worksheets-to-pdf-from-closed-file", "title": "Excel print worksheets to PDF from closed file", "body": "<p>I have a main Excel file that contains info for a project.\nThere will always also be another excel file named \"Job export\" in the same folder as my main file containing drawings - each drawing on separate sheet. Drawings will start from sheet 2 and end at sheet n-1 (currently the code will also print sheet 1 and sheet n). </p>\n\n<p>I have found and modified VBA code that will print these drawings from each sheet into separate PDF files with the name in Cell C5 in each sheet.\nBut this means I have to open the excel file with drawings and copy the code to that workbook just to print the PDFs. I would like to add this code to my main Excel so that it opens the \"Job export\" excel in background and print drawings into separate PDFs.</p>\n\n<p>Further step would be to save these PDFs to folders according to the client's name in Cell B7 and part number in B11 and onwards (in this case the saved PDF would also be named after the part number).</p>\n\n<p>Is this possible with VBA?</p>\n\n<p>Edit:</p>\n\n<p>I'm stuck with chaning the save location of printed PDFs. I tried to just hard-code in the folder \"C:\\suvaline\" but it won't save them there. As I wrote previously, the save folder should be: C:\\suvaline\\\"Clients name\"\\\"Part number\" but it won't even work with the hard-coded one so I haven't even tried to get the clients name from Excel. Is there something I'm missing?</p>\n\n<pre><code>Sub ExportToPDFFromClosed()\n\nDim ws As Worksheet\nDim wbA As Workbook\nDim strPath\nDim strFile\nDim wb2 As Workbook\n\ni = 11\nj = 2\n\nsPath = \"C:\\suvaline\"\nApplication.ScreenUpdating = False\nSet wbA = ActiveWorkbook\nstrPath = wbA.path\nstrPath = strPath &amp; \"\\\"\nSet wbA = Workbooks.Open(strPath &amp; \"Job export pic3\")\nSet wb2 = ThisWorkbook\n\nFor Each ws In Worksheets\nws.Select\nnm = wb2.Sheets(\"Prep+BOM\").Cells(i, j).Value _\n\nstrFile = nm &amp; \".pdf\"\nstrPathFile = \"C:\\suvaline\" &amp; strFile\n\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\nfilename:=strPathFile &amp; \".pdf\", _\nQuality:=xlQualityStandard, IncludeDocProperties:=True, _\nIgnorePrintAreas:=False, OpenAfterPublish:=False\n\n i = i + 1\n\nNext ws\n    wbA.Close\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "c++", "vba", "com", "ms-office"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548237220, "post_id": 54324237, "comment_id": 95467381, "body": "Great,  but this approach has pitfalls: ms-office may become visible after you set <code>Application.Visible</code> to <code>false</code> : e.g. when you open a document with a password application becomes visible, and I suspect that this may not be the only case when it suddenly turns visible."}, {"owner": {"reputation": 13842, "user_id": 2790621, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/b7bSs.jpg?s=128&g=1", "display_name": "xMRi", "link": "https://stackoverflow.com/users/2790621/xmri"}, "reply_to_user": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548237628, "post_id": 54324237, "comment_id": 95467684, "body": "Yes but if it becomes visible, after you set it to false, you can check it when you want to exit, check the Visible property before you exit... This is what I mean."}, {"owner": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548238427, "post_id": 54324237, "comment_id": 95468173, "body": "Yeah, I understood, but I suspect that there may be some other reasons why MS Office may become Visible without user interference - like in the case when it shows &quot;enter password&quot; modal dialog .  Thus, when I want to shutdown MS Office, I check  <code>Visible</code> property, it turns to be <code>true</code> - and I don&#39;t know whether it is visible because user has started new instance or because of other reasons .  What I mean is that application visibility may not be a satisfactory condition when determining whether user has started new office process :("}, {"owner": {"reputation": 13842, "user_id": 2790621, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/b7bSs.jpg?s=128&g=1", "display_name": "xMRi", "link": "https://stackoverflow.com/users/2790621/xmri"}, "reply_to_user": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548242600, "post_id": 54324237, "comment_id": 95470584, "body": "And why do you want to exit the application? If it&#39;s gone Visible for any reason, you are no longer in charge..."}, {"owner": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548251167, "post_id": 54324237, "comment_id": 95475344, "body": "well, as long as my code is executed in a multithreaded environment - I may launch up to 4, 8 or more Office Application instances (depending on processor cores count). So if I don&#39;t quit the application when I should - unclosed applications may overwhelm a system."}], "tags": [], "owner": {"reputation": 13842, "user_id": 2790621, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/b7bSs.jpg?s=128&g=1", "display_name": "xMRi", "link": "https://stackoverflow.com/users/2790621/xmri"}, "is_accepted": false, "score": 0, "last_activity_date": 1548236633, "creation_date": 1548236633, "answer_id": 54324237, "question_id": 54324083, "link": "https://stackoverflow.com/questions/54324083/prevent-user-from-attaching-to-run-by-developer-instance-of-ms-office-process/54324237#54324237", "title": "Prevent user from attaching to run-by-developer instance of MS-Office process", "body": "<p>Get the <code>Application</code> Object. Check the <code>Application.Visible</code> property. If the application is visible than you should not exit the application.</p>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548250824, "post_id": 54326239, "comment_id": 95475117, "body": "That is important asnwer and is close to my case. Since I work in a multithreaded environment - I may launch up to 4, 8 or more Office Application instances (depending on processor cores count) - so it would be great to avoid another Office App launch per each &quot;actual working&quot; Office instance.  But your answer led me to the other possible solution : launch 1 MS Office instance and remove it from ROT - so that user will start its own application instance. If you have any ideas on how to do this, or other thoughts on this matter - will appreciate!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548256620, "post_id": 54326239, "comment_id": 95478707, "body": "@JohnBosco Actually, my answer is essentially that, although it appears not to have been clear enough. I believe it&#39;s necessary to keep that second instance, that&#39;s not in the ROT, open, however."}, {"owner": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548257797, "post_id": 54326239, "comment_id": 95479359, "body": "I&#39;m not sure whether I was clear enough :)  What I mean is the solution where only 1 instance of Word is launched: 1) start an instance of Word 2) Somehow remove its entry from the ROT without starting another Word instance (e.g. via <code>IRunningObjectTable::Revoke</code> or some other way). What do you think about that?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548257932, "post_id": 54326239, "comment_id": 95479443, "body": "Is that possible? You&#39;d have to try it - I&#39;ve never tried to manipulate the ROT directly..."}, {"owner": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "edited": false, "score": 0, "creation_date": 1548260983, "post_id": 54326239, "comment_id": 95481226, "body": "well, it would be great if I could.  Thank you for your replies!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1548242960, "creation_date": 1548242960, "answer_id": 54326239, "question_id": 54324083, "link": "https://stackoverflow.com/questions/54324083/prevent-user-from-attaching-to-run-by-developer-instance-of-ms-office-process/54326239#54326239", "title": "Prevent user from attaching to run-by-developer instance of MS-Office process", "body": "<p>There used to be a good KB article on this, but it's disappeared... The essence was posted in an answer on the MSDN forums, by Bessie Zhao, which I copy here, with what I can remember from the KB explanation below it:</p>\n\n<blockquote>\n  <p>Have you tried the Workaround of KB 188546:\n  <a href=\"http://support.microsoft.com/kb/188546/EN-US/\" rel=\"nofollow noreferrer\">http://support.microsoft.com/kb/188546/EN-US/</a>? It introduces a way as\n  below. Before you create your Word object, first create a temporary\n  Word object. After you create your object, close the temporary object.\n  This causes Word to act properly when you control it through\n  Automation (that is, if a user interactively starts Word, a new\n  instance of Word is opened for the user). The automation instance\n  remains hidden and separate. Code like this,</p>\n\n<pre><code>        object missing = Type.Missing;\n        Word.Application temp = new Word.Application();\n        Word.Application wordApp = new Word.Application();\n        wordApp.Visible = true;\n        temp.Quit(ref missing, ref missing, ref missing);\n        temp = null;\n        ...\n</code></pre>\n</blockquote>\n\n<p>The reason for this is how Office applications use the ROT (Running Object Table). Only <em>one</em> instance of an Office application will ever be present in the ROT - the first one started. </p>\n\n<p>If some other application than Office creates an instance of that application, then that's the one in the ROT. Office is designed to look for a running instance in the ROT and, if one is present, use that when the user starts the application or opens a document. Which is why the situation described in the question is possible.</p>\n\n<p>The work-around basically says: create two instances. Use the second, which won't be in the ROT, then destroy the first. At this point, no instance of the Office application is in the ROT, so when the user invokes it, not finding anything in the ROT, the Office application creates a new instance of itself, independent of that used by the software.</p>\n"}], "owner": {"reputation": 183, "user_id": 5271850, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fc2f6089e8d02402c511c1027aad5f7?s=128&d=identicon&r=PG&f=1", "display_name": "John Bosco", "link": "https://stackoverflow.com/users/5271850/john-bosco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1548242960, "creation_date": 1548236135, "question_id": 54324083, "link": "https://stackoverflow.com/questions/54324083/prevent-user-from-attaching-to-run-by-developer-instance-of-ms-office-process", "title": "Prevent user from attaching to run-by-developer instance of MS-Office process", "body": "<p>I encounter the following issue:\nAfter I start any Ms-Office application via COM in my C++ code (Word, Excel, PowerPoint, Visio) and make it hidden - then if user starts its own intance of that application - it will attach to run-by-my-code office process, while I have no idea of that. Eventually after my code has executed I close Office Application and a user will lose its work (As far as they attached to my process and didn't start its own one)</p>\n\n<p>So,</p>\n\n<p>1) is there any way to prevent a user from attaching to my instance of Office Application and start its own process? Maybe a parameter for CoCreateInstance, or something else?</p>\n\n<p>2) Or (Another option) - how to detect that user has just attached to run-by-me office process ?</p>\n\n<p>Will appreciate any help.</p>\n\n<p>Here is a piece of code on how I create Office Application</p>\n\n<pre><code>CComPtr&lt;IDispatch&gt; pOffApp;\nhr = pOfficeApp.CoCreateInstance(L\"Word.Application\", NULL, CLSCTX_LOCAL_SERVER); //may also be \"Excel.Application\", \"Visio.Application\" etc.\n</code></pre>\n"}, {"tags": ["excel", "vba", "date"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1548236800, "post_id": 54324087, "comment_id": 95467110, "body": "Got it. Thank you mate. It works well for me. I&#39;ll let you know later if it works for him as well.:)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1548238770, "post_id": 54324087, "comment_id": 95468385, "body": "@Sven to prevent stupid user input you can make your date validation more solid. I also suggest to inform the user in the msgbox how the format of the date is required. See my edit."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548240498, "post_id": 54324087, "comment_id": 95469394, "body": "Why not have 3 input boxes with a relevant range of numbers specified for each box? one each for year, month, date etc? Avoids any dot missing or commas etc as you can &quot;put&quot; them or concatenate them together."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548240628, "post_id": 54324087, "comment_id": 95469471, "body": "@SolarMike For example because you have a lot of coding to do to accept pasting a date then ;( And fiddling the pasted date into the boxes would be the same work as validating one box."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548240695, "post_id": 54324087, "comment_id": 95469510, "body": "@P\u1d07\u029c ok, sorry just an idea - worked when I was using the original excel macro language, we used 3 dropdown lists..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1548240892, "post_id": 54324087, "comment_id": 95469614, "body": "@SolarMike Yes, of course that works perfectly but you have to give up the ability of pasting a date, which can be a knock out. At least for me it always was a knock out."}, {"owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 1, "creation_date": 1548252553, "post_id": 54324087, "comment_id": 95476140, "body": "@P\u1d07\u029c It works! Thank you sir! And also thank you for the suggestions to make everything user-friendly. I will definitely integrate it in my tool"}, {"owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1548258794, "post_id": 54324087, "comment_id": 95479939, "body": "@P\u1d07\u029c Seems like his date settings are dd/mm/yyyy. I transformed the code with &quot;/&quot; instead of the &quot;.&quot; so it works now for him. Is there a solution where I can define more then one ArrInput for dates?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1548259136, "post_id": 54324087, "comment_id": 95480147, "body": "@Sven the issue is that you never know if someone puts in <code>dd&#47;mm&#47;yyyy</code> or <code>mm&#47;dd&#47;yyyy</code> if you allow that. So force the user to put in the date in your desired format <code>dd.mm.yyyy</code> or even better as I suggested <code>YYYY-MM-DD</code>. If you let him put the date with slashes you might end up with a wrong date."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1548238703, "last_edit_date": 1548238703, "creation_date": 1548236147, "answer_id": 54324087, "question_id": 54323934, "link": "https://stackoverflow.com/questions/54323934/textbox-converts-date-into-number/54324087#54324087", "title": "Textbox converts date into number", "body": "<p>You could split the date by <code>.</code> into an array <code>ArrInput</code> and then use <code>DateSerial</code> to make it a real date, that you can format.</p>\n\n<pre><code>Dim ArrInput As Variant\nArrInput = Split(TextBox1.Value, \".\")\n\n'StartDate = DateSerial(Year(Date), Month(Date), Day(Date)) 'I see no use in this at all\nTextBox1.Value = Format$(DateSerial(ArrInput(2), ArrInput(1), ArrInput(0)), \"dd.mm.yyyy\")\nStartDate = TextBox1.Value\n</code></pre>\n\n<hr>\n\n<p>The issue with <code>Format(TextBox1.Value, \"dd.mm.yyyy\")</code> is that here you let Excel guess which date format the string in <code>TextBox1.Value</code> is. It automatically casts into a number which is then converted into a string again.</p>\n\n<hr>\n\n<p>To avoid date misunderstandings I recommend always to use the <code>YYYY-MM-DD</code> format according to <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601</a>. This is the only date format that is human readable and cannot be misunderstood. It also has benefits when sorting by dates that are actually strings.</p>\n\n<hr>\n\n<p>To make your validation even more solid use something like:</p>\n\n<pre><code>Dim ArrInput As Variant\nArrInput = Split(TextBox1.Value, \".\")\n\nDim ValidDate As Boolean\n\nIf UBound(ArrInput) = 2 Then 'make sure there are exactly two dots in the date\n    If ArrInput(1) &gt; 0 And ArrInput(1) &lt;= 12 And _ 'month &lt;= 12\n    ArrInput(0) &gt; 0 And ArrInput(0) &lt;= 31 Then     'day &lt;= 31\n        ValidDate = True\n    End If\nElse\n    ValidDate = False\nEnd If\n\nIf Not ValidDate Then\n    MsgBox \"Invalid date, please re-enter in format dd.mm.yyyy\", vbCritical\n    TextBox1.Value = vbNullString\n    TextBox1.SetFocus\n    Exit Sub\nEnd If\n\nTextBox1.Value = Format$(DateSerial(ArrInput(2), ArrInput(1), ArrInput(0)), \"dd.mm.yyyy\")\nStartDate = TextBox1.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1548238409, "post_id": 54324554, "comment_id": 95468164, "body": "This was also my first guess, but he promised me on the phone that he entered the values with a dots"}, {"owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "reply_to_user": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "edited": false, "score": 0, "creation_date": 1548335230, "post_id": 54324554, "comment_id": 95510071, "body": "You might create a kind of log into the workbook itself and have the workbook sent to you after he entered the value:"}], "tags": [], "owner": {"reputation": 781, "user_id": 6299848, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwEAxXq6T1I/AAAAAAAAAAI/AAAAAAAAAPA/Bcu8ARbxjmw/photo.jpg?sz=128", "display_name": "simple-solution", "link": "https://stackoverflow.com/users/6299848/simple-solution"}, "is_accepted": false, "score": 1, "last_activity_date": 1548335930, "last_edit_date": 1548335930, "creation_date": 1548237633, "answer_id": 54324554, "question_id": 54323934, "link": "https://stackoverflow.com/questions/54323934/textbox-converts-date-into-number/54324554#54324554", "title": "Textbox converts date into number", "body": "<p>I do believe that your colleague enters the text string \"01102017\" without dots.<br/>\nYou might want to convert such kind of entries into a valid date:</p>\n\n<pre><code>'  \"01102017\" =&gt; 01.10.2017      - 8 chars variant\n'  \"011017\"   =&gt; 01.10.2017      - 6 chars variant\n</code></pre>\n\n<p>This needs to be done of cause prior to a date conversion.\n<br/>\n<br/>\n<br/>\nAdd a log of the input value to a free cell range and <br/>\nhave the workbook sent back to you:</p>\n\n<pre><code>...\nPrivate Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)\n    Range(\"Z1\").value = \"'\" &amp; TextBox1.Value\n    If Mid(TextBox1.Value, 4, 2) &gt; 12 Then\n...\n</code></pre>\n\n<p><br/>\n<br/>\n<br/>\nCheck if only numbers are used:<br/>\n<a href=\"https://stackoverflow.com/questions/6138896/how-to-check-if-a-string-contains-only-numbers\">How to check if a string contains only numbers?</a>\n<br/>\n<br/>\nand check the length of the string (6 or 8 chars variant) and check if the year part is within a valid range => try to convert to a date and offer it to the user.</p>\n"}], "owner": {"reputation": 31, "user_id": 6618556, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/38a5b5c166f16fd270728116aee797a3?s=128&d=identicon&r=PG&f=1", "display_name": "Sven", "link": "https://stackoverflow.com/users/6618556/sven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 54324087, "answer_count": 2, "score": 0, "last_activity_date": 1548335930, "creation_date": 1548235661, "last_edit_date": 1548236314, "question_id": 54323934, "link": "https://stackoverflow.com/questions/54323934/textbox-converts-date-into-number", "title": "Textbox converts date into number", "body": "<pre><code>Private Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)\n    If Mid(TextBox1.Value, 4, 2) &gt; 12 Then\n        MsgBox \"Invalid date, please re-enter\", vbCritical\n        TextBox1.Value = vbNullString\n        TextBox1.SetFocus\n        Exit Sub\n    End If\n\n    StartDate = DateSerial(Year(Date), Month(Date), Day(Date))\n    TextBox1.Value = Format(TextBox1.Value, \"dd.mm.yyyy\")\n    StartDate = TextBox1.Value\nEnd Sub\n</code></pre>\n\n<p>This code works well for me and my colleagues to make sure the value entered in the textbox is a date. However, a colleague from a different country (but also with the <code>dd.mm.yyyy</code> date-format) gets weird results.</p>\n\n<p>For example: If he enters <code>01.10.2017</code> the TextBox automatically format the date into <code>20.03.4917</code>.</p>\n\n<p>I suspect that in this case the entered value is not recognized as a date but as a number because <code>01102017</code> will transform into <code>20.03.4917</code> in Excel if you convert it as a date.</p>\n\n<p>Does anyone have a suggestion or a guess how to work around this problem?</p>\n\n<p>Thanks and best regards</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548235315, "post_id": 54323654, "comment_id": 95466223, "body": "Are you using an Image control?"}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548235412, "post_id": 54323654, "comment_id": 95466277, "body": "Yes I am using an Image control"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548236201, "post_id": 54323654, "comment_id": 95466762, "body": "Use Picture property instead of PictureData."}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548236695, "post_id": 54323654, "comment_id": 95467046, "body": "This gives the error: Microsoft Access can&#39;t open the file &#39;StaffCalendar16.ico&#39;"}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 0, "creation_date": 1548236812, "post_id": 54323654, "comment_id": 95467117, "body": "So check if the file exists, you have required rights, and the path to the file."}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "edited": false, "score": 0, "creation_date": 1548236866, "post_id": 54323654, "comment_id": 95467159, "body": "The file does not exist, it&#39;s just an image that exists on the Access form. It&#39;s embedded."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1548237440, "post_id": 54323654, "comment_id": 95467547, "body": "Have a look at <a href=\"https://stackoverflow.com/questions/10792426/access-export-images-from-image-controls-in-forms\" title=\"access export images from image controls in forms\">stackoverflow.com/questions/10792426/&hellip;</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1548238006, "post_id": 54323654, "comment_id": 95467922, "body": "Well, I tested with an image that was set as Embedded in the Image control. However, the image does still exist externally. So I renamed the file and then code fails. So as @Sam suggests will have to export image to external location."}, {"owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "edited": false, "score": 0, "creation_date": 1548238491, "post_id": 54323654, "comment_id": 95468222, "body": "Thanks a lot guys, not sure why Microsoft keeps making things harder. I&#39;ll give that a go!"}], "answers": [{"tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 0, "last_activity_date": 1548240235, "last_edit_date": 1548240235, "creation_date": 1548239631, "answer_id": 54325213, "question_id": 54323654, "link": "https://stackoverflow.com/questions/54323654/how-do-i-copy-picturedata-from-one-image-to-another/54325213#54325213", "title": "How do I copy picturedata from one image to another?", "body": "<p>If you use Microsoft Access 2010 or newer, you can add the image to Access <code>Image Gallery</code>.</p>\n\n<p>Once added to the gallery you can rename it there if you want.</p>\n\n<p>This name you then can use to paste it to the <code>Picture</code> property of the image control to assign it to.</p>\n\n<p>One advantage is that you can reference those images to many image controls, but they only use memory once for storage in the database.</p>\n\n<p>The other advantage is, that you can assign them like this (without having the original file on the disk):</p>\n\n<pre><code>Image1.Picture = Image2.Picture\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10943898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d281acb8990327809cb3569419b47e4?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/10943898/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 54325213, "answer_count": 1, "score": 0, "last_activity_date": 1548240235, "creation_date": 1548234776, "last_edit_date": 1548235917, "question_id": 54323654, "link": "https://stackoverflow.com/questions/54323654/how-do-i-copy-picturedata-from-one-image-to-another", "title": "How do I copy picturedata from one image to another?", "body": "<p>I have two image controls. I want to set one of the image controls to hold the same image as the other one. I need to do this in runtime, using VBA.</p>\n\n<pre><code>Me(\"Option\" &amp; RST![ItemNumber]).PictureData = Me(\"img\" &amp; intImage).PictureData\n</code></pre>\n\n<p>For some reason this line of code doesn't do the trick. It does not give errors, but instead leaves the picture control blank. Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "loops", "checkbox", "userform"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548234626, "post_id": 54323473, "comment_id": 95465854, "body": "In which line is the error? \u2022 Remove <code>Dim x1TypePDF As Variant</code> and replace <code>Type:=x1TypePDF</code> with <code>Type:=xlTypePDF</code> Note that <code>xl</code> is a lower case <code>XL</code> not <code>X1</code> \u2022 Also avoid <code>Variant</code> if possible, it&#39;s the worst type you could choose: <code>YYMM</code>, <code>Name_of_File</code>, and <code>Name</code> could be declared as <code>String</code>. \u2022 Since you use <code>Option Explicit</code> your code should throw an error if you don&#39;t declare <code>i As Long</code>. \u2022 <code>Kunde_Array</code> isn&#39;t declared neither, so get your variables clean and declare everything."}, {"owner": {"reputation": 1, "user_id": 10954561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775aa8a93eb63f0dc984b122631b4d60?s=128&d=identicon&r=PG&f=1", "display_name": "Therese", "link": "https://stackoverflow.com/users/10954561/therese"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548234940, "post_id": 54323473, "comment_id": 95466019, "body": "It is in the line &quot;For each shp in PDFUserForm&quot; :) and thank you. I still get the error though :/ @P\u1d07\u029c"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548235324, "post_id": 54323473, "comment_id": 95466229, "body": "Please <a href=\"https://stackoverflow.com/posts/54323473/edit\">edit</a> your question and update the code to what you have now after you applied my suggestions. Note that you <code>Dim PDFUserForm As UserForm</code> but <code>PDFUserForm</code> is never set to something. Therefore <code>PDFUserForm</code> is <code>Nothing</code>."}, {"owner": {"reputation": 1, "user_id": 10954561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775aa8a93eb63f0dc984b122631b4d60?s=128&d=identicon&r=PG&f=1", "display_name": "Therese", "link": "https://stackoverflow.com/users/10954561/therese"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548235563, "post_id": 54323473, "comment_id": 95466377, "body": "@P\u1d07\u029c I  have edited the question. Also i and kundearray are defined public in another module."}, {"owner": {"reputation": 1, "user_id": 10954561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775aa8a93eb63f0dc984b122631b4d60?s=128&d=identicon&r=PG&f=1", "display_name": "Therese", "link": "https://stackoverflow.com/users/10954561/therese"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548235626, "post_id": 54323473, "comment_id": 95466411, "body": "What would you set PDFUserForm to @P\u1d07\u029c? :) :) :) and"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548235696, "post_id": 54323473, "comment_id": 95466467, "body": "@Therese ehhhm to your desired UserForm of course? \u2022 If <code>PDFUserForm</code> is already the name of your UserForm just remove <code>Dim PDFUserForm As UserForm</code>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1548236013, "post_id": 54323473, "comment_id": 95466655, "body": "Don&#39;t you need to loop through controls? -&gt; <code>Dim shp As Control</code> and <code>For Each shp In Me.Controls</code>"}, {"owner": {"reputation": 1, "user_id": 10954561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775aa8a93eb63f0dc984b122631b4d60?s=128&d=identicon&r=PG&f=1", "display_name": "Therese", "link": "https://stackoverflow.com/users/10954561/therese"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1548236435, "post_id": 54323473, "comment_id": 95466875, "body": "@JvdV I just edited the code and the error in my post :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1548236887, "post_id": 54323473, "comment_id": 95467167, "body": "@Therese <code>FormControlType</code> is only for <code>Shapes</code>. Since you changed it to <code>Control</code> you must use <code>If TypeName(shp) = &quot;CheckBox&quot; Then</code>. Also consider changing the variable name from <code>shp</code> to <code>ctl</code> to stop confusing yourself about the type of that variable."}, {"owner": {"reputation": 1, "user_id": 10954561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775aa8a93eb63f0dc984b122631b4d60?s=128&d=identicon&r=PG&f=1", "display_name": "Therese", "link": "https://stackoverflow.com/users/10954561/therese"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548237543, "post_id": 54323473, "comment_id": 95467628, "body": "@P\u1d07\u029c THANK YOU :) now I get another error though, see my edited post."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548237917, "post_id": 54323473, "comment_id": 95467874, "body": "@Therese oh come on you should start doing some research and reading the documentations. I cannot fix all the code for you. A <code>CheckBox</code> object doesn&#39;t have a <code>.ControlFormat</code>."}], "owner": {"reputation": 1, "user_id": 10954561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/775aa8a93eb63f0dc984b122631b4d60?s=128&d=identicon&r=PG&f=1", "display_name": "Therese", "link": "https://stackoverflow.com/users/10954561/therese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548237503, "creation_date": 1548234202, "last_edit_date": 1548237503, "question_id": 54323473, "link": "https://stackoverflow.com/questions/54323473/loop-through-checkboxes-in-vba", "title": "Loop through checkboxes in VBA", "body": "<p>I'm trying to create a code to loop through a userform to see if the checkboxes are checked and then create a PDF of the sheets.\nHowever I get the error \"object doesn't support this property or method\" in the line \"If ctl.controlFormat.Value = True Then\". I hope you can help me :) </p>\n\n<pre><code>     Option Explicit\n\n\nSub Get_PDF_Click()\n\nDim ReportName As String\nReportName = ActiveSheet.Cells(4, 20).Value\nDim OutputPath As String\nOutputPath = \"T:\\5. F\u00e6lles\\Optima Lancering Version 1.0\\6. Oversigtsark\\KontoInvest\\Historik\\\"\nDim YYMM As String\nDim Name_of_File As String\nDim Name As String\n'Dim x1TypePDF As Variant\nDim cbox As CheckBox\nDim FormControlType As Variant\nDim ctl As Control\n'Dim shp As Shape\n\nYYMM = Format(WorksheetFunction.EoMonth(Now(), -1), \"YYMM\")\n\nName = \"BankNordik_faktaark\" &amp; YYMM\nName_of_File = OutputPath &amp; \"BankNordik\\\" &amp; Name\n\n '------- LOOP THROUGH CHECKBOXES -------\nFor i = 0 To 6\n    For Each ctl In Me.Controls\n    'For Each ctl In PDFUserForm.Controls\n        If TypeName(ctl) = \"CheckBox\" Then\n        'If ctl.FormControlType = xlCheckBox Then\n            If ctl.ControlFormat.Value = True Then\n                    For Each Ws In Worksheets\n                        If Ws.Name = \"Fakta \" &amp; Kunde_Array(i + 1, 1) Then\n                            ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n                            Name_of_File, Quality _\n                            :=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n                            :=False, OpenAfterPublish:=False\n                        End If\n                    Next Ws\n             End If\n        End If\n    Next ctl\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1548268941, "creation_date": 1548268941, "answer_id": 54333711, "question_id": 54323331, "link": "https://stackoverflow.com/questions/54323331/ms-project-reset-to-custom-view-via-ribbon-button/54333711#54333711", "title": "MS Project - reset to custom view via ribbon button", "body": "<p>Have two copies of the view but each with a different, but identical, table. When the button is clicked, apply the backup view, delete the master view &amp; table, make a copy of the backup view, and apply it: </p>\n\n<pre><code>Sub RestoreView()\n\n    Const ViewName As String = \"My Custom View\"\n    Const TableName As String = \"My Custom Table\"\n    Const BackupView As String = \"z My Custom View\"\n\n    ViewApply BackupView\n    Application.OrganizerDeleteItem pjViews, ActiveProject.Name, ViewName\n    Application.OrganizerDeleteItem pjTables, ActiveProject.Name, TableName\n    Application.ViewEditSingle Name:=BackupView, Create:=False, NewName:=ViewName, Table:=TableName\n    ViewApply ViewName\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 3609107, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100000140665524/picture?type=large", "display_name": "Laureant", "link": "https://stackoverflow.com/users/3609107/laureant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548268941, "creation_date": 1548233726, "question_id": 54323331, "link": "https://stackoverflow.com/questions/54323331/ms-project-reset-to-custom-view-via-ribbon-button", "title": "MS Project - reset to custom view via ribbon button", "body": "<p>So I want to develop a custom ribbon with a button, which upon clicking would switch to a custom view. This ribbon + button would live in the global template, so upon Project_Open event, it would add the ribbon to MS Project, and it would be usable.</p>\n\n<p>I made the custom ribbon via code, and I have the button working. </p>\n\n<p>My only problem is, that when I click the button, I want the custom view to reset to it's \"Original form\", meaning that if I add/remove columns, or change anything regarding formatting, I would want those to be gone, whenever I click the button.</p>\n\n<p>I can see that the \"ResetView\" functionality doesn't work like this, since it will reset the custom view completely to it's core view.</p>\n\n<p>How can I achieve this, other than building up the view programmatically from the button click?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548232337, "post_id": 54322862, "comment_id": 95464544, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25365547/non-contiguous-named-range-into-an-array-then-into-row-in-different-sheet\">Non-contiguous named range into an array, then into row in different sheet</a> Note: Filtered data might be non-contiguous."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548232515, "post_id": 54322862, "comment_id": 95464658, "body": "You mean maybe data have empty cells?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548232661, "post_id": 54322862, "comment_id": 95464747, "body": "For now data start from row 2 and stops to 344 and starts againg from 349"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548233021, "post_id": 54322862, "comment_id": 95464961, "body": "For example if you have 10 rows and after your filer is applied there is only rows <code>{1, 2, 5, 6, 7}</code>  visible that means that the rows are not contiguous and split into to areas <code>{1, 2}</code> and <code>{5, 6, 7}</code>. Therefore you probably get into trouble when reading it into an array, the array will only contain the values of the first area. See that link above for a solution."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548233243, "post_id": 54322862, "comment_id": 95465089, "body": "Another workaround could be to <code>VisRng.Copy</code> and paste the values into a new worksheet. Then export that worksheet as CSV. \u2022 Copy/Paste of a non-contiguous range makes it contiguous in the destination."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548233415, "post_id": 54322862, "comment_id": 95465174, "body": "The example though is talking about a given ranges..How to adjust it to take variable ranges of non contiguous rows?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548233490, "post_id": 54322862, "comment_id": 95465216, "body": "Same approach. Instead of the named range use your range <code>VisRng</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1548233595, "creation_date": 1548233595, "answer_id": 54323299, "question_id": 54322862, "link": "https://stackoverflow.com/questions/54322862/cannot-select-autofiltered-table-data-using-vba/54323299#54323299", "title": "Cannot select autofiltered table data using VBA", "body": "<p>Your filtered data isn't contiguous.  If you filter your data and there are hidden rows between your firt and last filtered rows then your data isn't contiguous.</p>\n\n<p>If your sort your data on <code>Field:=3</code> before filtering then you will have the contiguous range you need to put in the array. </p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1548234067, "post_id": 54323320, "comment_id": 95465532, "body": "@Nikos No it copies only values, but that&#39;s not an issue because CSV doesn&#39;t support formatting anyway. So even if there were formattings, saving it as CSV would strip the formattings off."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "edited": false, "score": 0, "creation_date": 1548234302, "post_id": 54323320, "comment_id": 95465663, "body": "When I exported it I dont get Euro Currency If I use xlPasteValuesAndNumberFormats I get US dollars"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548234431, "post_id": 54323320, "comment_id": 95465740, "body": "@Nikos Well, so you were talking about number formats not about formattings, that&#39;s a difference. Then use <code>xlPasteValuesAndNumberFormats</code> to keep number formats."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1548233685, "creation_date": 1548233685, "answer_id": 54323320, "question_id": 54322862, "link": "https://stackoverflow.com/questions/54322862/cannot-select-autofiltered-table-data-using-vba/54323320#54323320", "title": "Cannot select autofiltered table data using VBA", "body": "<p>Another solution would be to <code>VisRng.Copy</code> and paste the values into a new workbook/worksheet. Then export/saving that worksheet as CSV. Copy/Paste of a non-contiguous range makes it contiguous in the destination. </p>\n\n<p>Example:</p>\n\n<pre><code>Dim NewWB As Workbook 'create new workbook\nSet NewWB = Application.Workbooks.Add\n\nVisRng.Copy\n\nNewWB.Worksheets(1).Range(\"A1\").PasteSpecial Paste:=xlPasteValues\nNewWB.SaveAs Filename:=\"C:\\Temp\\MyFile.csv\", FileFormat:=xlCSV\nNewWB.Close SaveChanges:=False\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10358702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 54323320, "answer_count": 2, "score": 0, "last_activity_date": 1548233685, "creation_date": 1548232008, "last_edit_date": 1548233253, "question_id": 54322862, "link": "https://stackoverflow.com/questions/54322862/cannot-select-autofiltered-table-data-using-vba", "title": "Cannot select autofiltered table data using VBA", "body": "<p>I have a table with products I apply an autofilter and I get my filtered products</p>\n\n<pre><code>Set tbl = Worksheets(\"FOR EXPORT\").ListObjects(\"MyTable\")\n'SET AUTOFILTER\ntbl.Range.AutoFilter Field:=3, Criteria1:=\"&lt;&gt;*ERROR*\"\n</code></pre>\n\n<p>I want to filter the products copy them to an array to be able to export them to a CSV</p>\n\n<p>So I try to select the filtered products like </p>\n\n<pre><code>Dim VisRng As Range\n' set the new Range object to the visible cells of `tbl.Range`\nSet VisRng = tbl.Range.SpecialCells(xlCellTypeVisible)\n' copy only the visible cells in range to array\ntblArr = VisRng.Value\n</code></pre>\n\n<p>If I add <code>tbl.Range.SpecialCells(xlCellTypeVisible).select</code> it asks for an object</p>\n\n<p>Even if there are about 362 filtered products I get only 196</p>\n\n<p>How to copy the filtered data to variable <code>tblArr</code>? Why I get less products?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1548230392, "post_id": 54321752, "comment_id": 95463572, "body": ".body doesn&#39;t allow text formatting, you should use HTML (.HtmlBody) and format your text with html tags"}, {"owner": {"reputation": 1, "user_id": 10954103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmmSCs1KYaM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaerVWnpk073FW5srlnWZjxLy2LzQ/mo/photo.jpg?sz=128", "display_name": "Amr Hawsawi", "link": "https://stackoverflow.com/users/10954103/amr-hawsawi"}, "reply_to_user": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1548328576, "post_id": 54321752, "comment_id": 95506201, "body": "thank you, what I want is when the new email window display the message(table) which pasted from excel to be alignment to the center. I try this but it doesn&#39;t work (pageEditor.Application.Selection.alignment=center)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10954103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmmSCs1KYaM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaerVWnpk073FW5srlnWZjxLy2LzQ/mo/photo.jpg?sz=128", "display_name": "Amr Hawsawi", "link": "https://stackoverflow.com/users/10954103/amr-hawsawi"}, "edited": false, "score": 0, "creation_date": 1548306827, "post_id": 54326511, "comment_id": 95495867, "body": "thank you,  what I want is when the new email window display the message(table) which pasted from excel to be alignment to the center. I try this but it doesn&#39;t work  (pageEditor.Application.Selection.alignment=center)"}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 0, "last_activity_date": 1548244251, "last_edit_date": 1548244251, "creation_date": 1548243843, "answer_id": 54326511, "question_id": 54321752, "link": "https://stackoverflow.com/questions/54321752/send-excel-data-in-outlook-body-with-borders-alignment/54326511#54326511", "title": "Send Excel data in outlook body with borders alignment", "body": "<p>it seems that this will generate the html code for you, and format your table as it is formatted in excel</p>\n\n<pre><code>Sub esendtable()\n\n\nDim outlook As Object\nDim newEmail As Object\nDim xInspect As Object\nDim pageEditor As Object\n\nSet outlook = CreateObject(\"Outlook.Application\")\nSet newEmail = outlook.CreateItem(0)\n\nWith newEmail\n    .To = Sheet1.Range(\"A2\").Text\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Data\"\n    .body = \"Please find the requested information\" &amp; vbCrLf &amp; \"Best Regards\"\n    .display\n\n    Set xInspect = newEmail.GetInspector\n    Set pageEditor = xInspect.WordEditor\n\n    Sheet1.Range(\"B2:E5\").Copy\n\n    pageEditor.Application.Selection.Start = Len(.body)\n    pageEditor.Application.Selection.End = pageEditor.Application.Selection.Start\n    pageEditor.Application.Selection.PasteAndFormat (wdFormatOriginalFormatting)\n    .display\n    Set pageEditor = Nothing\n    Set xInspect = Nothing\nEnd With\n\nSet newEmail = Nothing\nSet outlook = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10954103, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tmmSCs1KYaM/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaerVWnpk073FW5srlnWZjxLy2LzQ/mo/photo.jpg?sz=128", "display_name": "Amr Hawsawi", "link": "https://stackoverflow.com/users/10954103/amr-hawsawi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1308, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607509282, "creation_date": 1548227364, "last_edit_date": 1548229167, "question_id": 54321752, "link": "https://stackoverflow.com/questions/54321752/send-excel-data-in-outlook-body-with-borders-alignment", "title": "Send Excel data in outlook body with borders alignment", "body": "<p>below code working fine to send excel data in outlook body with borders , question is how to alignment the all data which pasted in body to the center.</p>\n\n<p>Thank you</p>\n\n<pre><code>Sub esendtable()\n\n\nDim outlook As Object\nDim newEmail As Object\nDim xInspect As Object\nDim pageEditor As Object\n\nSet outlook = CreateObject(\"Outlook.Application\")\nSet newEmail = outlook.CreateItem(0)\n\nWith newEmail\n    .To = Sheet1.Range(\"A2\").Text\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Data\"\n    .Body = \"Please find the requested information\" &amp; vbCrLf &amp; \"Best Regards\"\n    .display\n\n    Set xInspect = newEmail.GetInspector\n    Set pageEditor = xInspect.WordEditor\n\n    Sheet1.Range(\"B2:E5\").Copy\n\n    pageEditor.Application.Selection.Start = Len(.Body)\n    pageEditor.Application.Selection.End = pageEditor.Application.Selection.Start\n    pageEditor.Application.Selection.PasteAndFormat (wdFormatPlainText)\n    .display\n    .Send\n    Set pageEditor = Nothing\n    Set xInspect = Nothing\nEnd With\n\nSet newEmail = Nothing\nSet outlook = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1548229062, "last_edit_date": 1548229062, "creation_date": 1548228371, "answer_id": 54322000, "question_id": 54321671, "link": "https://stackoverflow.com/questions/54321671/what-does-application-match-return-an-integer/54322000#54322000", "title": "What does application.match return? an integer?", "body": "<p>Enter 1 in a cell, select it then enter in the Immediate window:</p>\n\n<pre><code>? typename(application.match(1,selection,0))\n</code></pre>\n\n<p>outputs \"Double\"</p>\n\n<p>You should use a <code>Variant</code> though, so you can test the return value for an error in the case where there's no match found:</p>\n\n<pre><code>Dim l As Variant\nl = Application.Match(Range(\"O10\"), Range(\"B9:B500\"), 0)\nIf IsError(l) Then\n    'no match!\nElse\n    'use l\nEnd If\n</code></pre>\n\n<p>Don't forget that (for example) l / k values of 1 would correspond to Row9, not Row1 (because your lookup range is B9:B500)</p>\n"}], "owner": {"reputation": 1, "user_id": 10921212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab68172a627c1865ce3cf3702269e832?s=128&d=identicon&r=PG&f=1", "display_name": "raytk", "link": "https://stackoverflow.com/users/10921212/raytk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548229315, "creation_date": 1548227039, "last_edit_date": 1548229315, "question_id": 54321671, "link": "https://stackoverflow.com/questions/54321671/what-does-application-match-return-an-integer", "title": "What does application.match return? an integer?", "body": "<p>I am facing some issues with the <code>application.match</code> function. Type mismatch.\nWhat is the type of data that <code>application.match</code> returns? an integer?</p>\n\n<p>Any way that I can change the type of <code>l</code> and <code>k</code> below to allow me to work with them using <code>cells(l,k)</code>?</p>\n\n<pre><code>Sub otcheck()\n    Dim i As Integer\n    Dim j As Integer\n\n    For i = 384 To 395\n        j = check(i)\n\n        Range(\"O9\") = mthdate(j)\n        Range(\"O10\") = mthdate(j - 1)\n\n        If Range(\"O10\") = #12:00:00 AM# Then\n            l = 9    \n        Else\n            l = Application.Match(Range(\"O10\"), Range(\"B9:B500\"), 0)\n        End If\n\n        k = Application.Match(Range(\"O9\"), Range(\"B9:B500\"), 0)\n\n        Cells(i, 4) = Application.Sum(Range(Cells(l, 14), Cells(k, 14)))\n        'this above line is having the type mismatch issue\n        'guessing is due to the l and k variables\n    Next i\n\n    Range(\"o9:P10\") = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1548226552, "post_id": 54321406, "comment_id": 95461979, "body": "1. <code>Dim strAssign As String is declared twice</code> 2. <code>3rd If block repeated twice and the last condtion should not have &quot;And&quot; suffix</code>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548228971, "post_id": 54321406, "comment_id": 95462991, "body": "Is there any code in that procedure that truncates the last &quot;AND&quot;?"}, {"owner": {"reputation": 25, "user_id": 10833585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce99afb1852e221901e7df24b9147593?s=128&d=identicon&r=PG&f=1", "display_name": "sherry", "link": "https://stackoverflow.com/users/10833585/sherry"}, "edited": false, "score": 0, "creation_date": 1548252791, "post_id": 54321406, "comment_id": 95476282, "body": "no there isnt, the code works well for the search button, code as above. Not sure how to go about with the Update statement."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1548255764, "creation_date": 1548255764, "answer_id": 54330124, "question_id": 54321406, "link": "https://stackoverflow.com/questions/54321406/update-table-with-a-multi-criteria-form/54330124#54330124", "title": "Update Table with a multi-criteria form", "body": "<p>You cannot use <code>TOP n</code> in an <code>UPDATE</code> query. This is a rather strange requirement.</p>\n\n<p>If you really must do this, you'll have to do something like this:</p>\n\n<pre><code>UPDATE table\nSET foo = 'bar'\nWHERE table.PrimaryKeyColumn IN\n(SELECT TOP 20 PrimaryKeyColumn FROM table\n WHERE &lt;strFilter&gt; \n ORDER BY &lt;sortColumn&gt; )\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10833585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce99afb1852e221901e7df24b9147593?s=128&d=identicon&r=PG&f=1", "display_name": "sherry", "link": "https://stackoverflow.com/users/10833585/sherry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548255764, "creation_date": 1548225868, "last_edit_date": 1548252646, "question_id": 54321406, "link": "https://stackoverflow.com/questions/54321406/update-table-with-a-multi-criteria-form", "title": "Update Table with a multi-criteria form", "body": "<p>I've a multi-criteria search form that searches the Top 20 records in the TblABC based on the filter's selected. The user will be assigned the record when the Assign button is clicked. This will update the ID field (currently blank) in the TblABC.</p>\n\n<p>Currently stuck at the Update Statement... appreciate any help! Thanks!</p>\n\n<pre><code>Private Sub BtnAssign_Click()\n\nDim strfilter As String\n\n'Filters the form with comboboxes\n\nIf Nz(Me.cboIndustry, \"\") &lt;&gt; \"\" Then\nstrfilter = strfilter &amp; \"([Major clusters] = '\" &amp; Trim(Me.cboIndustry) &amp; \"') AND \"\nEnd If\n\nIf Nz(Me.cboIncorp, \"\") &lt;&gt; \"\" Then\n    strfilter = strfilter &amp; \"([Years Incorporated] = '\" &amp; Trim(Me.cboIncorp) &amp; \"') AND \"\nEnd If\n\nIf Nz(Me.cboIndustry, \"\") &lt;&gt; \"\" Then\nstrfilter = strfilter &amp; \"([Major clusters] = '\" &amp; Trim(Me.cboIndustry) &amp; \"') AND \"\nEnd If\n\n... ...\n\n'Assign record to User - Updates Tabel ABC\n\nDim strAssign As String\n\nstrAssign = \"Update Top 20 * [TblABC] set [ID] = '\" &amp; Trim(Me.cboID) &amp; \"'\"\nstrAssign = strAssign &amp; \" where \" &amp; strfilter\n\nDoCmd.RunSQL strAssign\n\nEnd Sub\n</code></pre>\n\n<p>Search button works extremely well with this. It searches for the Top 20 records from TblABC based on the filtered criteria the user chooses. </p>\n\n<pre><code>Private Sub BtnSearch_Click()\n\nDim strfilter As String \n\n'Filters the form with comboboxes\n\nIf Nz(Me.cboIndustry, \"\") &lt;&gt; \"\" Then strfilter = strfilter &amp; \"([Major clusters] = '\" &amp; Trim(Me.cboIndustry) &amp; \"') AND \" End If\n\nIf Nz(Me.cboIncorp, \"\") &lt;&gt; \"\" Then\n    strfilter = strfilter &amp; \"([Years Incorporated] = '\" &amp; Trim(Me.cboIncorp) &amp; \"') AND \" End If\n\nIf Nz(Me.cboIndustry, \"\") &lt;&gt; \"\" Then strfilter = strfilter &amp; \"([Major clusters] = '\" &amp; Trim(Me.cboIndustry) &amp; \"') AND \" End If\n\n... ...\n\n'Search for Top 20 records based on criteria from TblABC\n\nDim strwhere As String\n\nstrwhere = \"Select Top 20 * from [TblABC]\" \nstrwhere = strwhere &amp; \" where \" &amp; strfilter\n\nFrm.RecordSource = strwhere\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10953839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617b8d3f4817360fe08a5fbc16cd6de2?s=128&d=identicon&r=PG&f=1", "display_name": "eagerlearner", "link": "https://stackoverflow.com/users/10953839/eagerlearner"}, "edited": false, "score": 0, "creation_date": 1548392534, "post_id": 54322321, "comment_id": 95532807, "body": "Thank you Tim. I got the solution. Somehow copy pasting formula was not working for me. I dragged the formula down and across."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1548229880, "creation_date": 1548229880, "answer_id": 54322321, "question_id": 54320935, "link": "https://stackoverflow.com/questions/54320935/retrieve-multiple-lookup-values-in-a-single-cell-on-partial-match/54322321#54322321", "title": "Retrieve Multiple lookup Values in a single Cell on Partial Match", "body": "<p>If you enter the array formula shown in E2 you can then fill it down/across:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BvgCp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BvgCp.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10953839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617b8d3f4817360fe08a5fbc16cd6de2?s=128&d=identicon&r=PG&f=1", "display_name": "eagerlearner", "link": "https://stackoverflow.com/users/10953839/eagerlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1548229880, "creation_date": 1548223572, "last_edit_date": 1548228971, "question_id": 54320935, "link": "https://stackoverflow.com/questions/54320935/retrieve-multiple-lookup-values-in-a-single-cell-on-partial-match", "title": "Retrieve Multiple lookup Values in a single Cell on Partial Match", "body": "<p>I have a range of store names and addresses in my sheet and i need to lookup all possible matches (partial or true) and list them infront of that record.\nI have been somewhat successful in getting the total count of possible matches but not able to retrieve all matches except the first one.</p>\n\n<p>Below is the link to sample screenshot of sheet.</p>\n\n<p>-\n<a href=\"https://i.stack.imgur.com/2jvyH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2jvyH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formula used:</p>\n\n<pre><code>Cell    Formula\nE2 -    {=SUM(IF(NOT(ISERROR(FIND(D2,$A$2:$A$28))),1))}\n\nF2 -    {=IF(COLUMN(A1)=$E2,INDEX($A:$A,LARGE(IF(NOT(ISERROR(FIND($D2,$A$2:$A$28))),ROW($A$2:$A$28)),COLUMN(A1))),\"\")}\n</code></pre>\n\n<p>Need help to extend this formula to next columns to get next partial match.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548222925, "post_id": 54320712, "comment_id": 95460674, "body": "Exactly how are you calling it automatically?"}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548223089, "post_id": 54320712, "comment_id": 95460745, "body": "@TimWilliams please check the question i&#39;ve updated it with the code that i am using to call the macro"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1548223318, "post_id": 54320712, "comment_id": 95460837, "body": "None of your code refers to specific worksheets - a good start would be to qualify all of your range/cells references so they refer to the correct worksheet.  Which sheet are you monitoring for changes? All of them?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1548223363, "post_id": 54320712, "comment_id": 95460854, "body": "FWIW You have code that is essentially repeating at the top which, I think, with another outer loop from 1 to 3 could reduce the inner looping to just one block.   For i = 1 to 3: textstring =  Cells(2,i).Value  :  Cells(counter + 3, i)   &#39;&lt;== key replacement lines"}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548223364, "post_id": 54320712, "comment_id": 95460855, "body": "you mean i need to define a worksheet on which the code needs to run??? @TimWilliams"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548223431, "post_id": 54320712, "comment_id": 95460873, "body": "Yes - otherwise it just defaults to whichever sheet is active.  <a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\" title=\"what is the default scope of worksheets and cells and range\">stackoverflow.com/questions/28439376/&hellip;</a>"}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "edited": false, "score": 0, "creation_date": 1548223468, "post_id": 54320712, "comment_id": 95460892, "body": "Ill try and get back to you"}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548223821, "post_id": 54320712, "comment_id": 95461009, "body": "@TimWilliams i&#39;ve tried that as well still it didnt work even after defining the worksheet"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548224022, "post_id": 54320712, "comment_id": 95461074, "body": "In that case it would be useful to edit your question to update your code with the version which specifies the worksheet."}, {"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548224095, "post_id": 54320712, "comment_id": 95461105, "body": "updated the code @TimWilliams please check"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1548225633, "post_id": 54320712, "comment_id": 95461651, "body": "Huge problems in code: (1) Calling <code>SheetChange</code> and then setting the <code>Target</code> without checking what cell actually changed.  (2) activating sheets. (3) not properly qualifying ranges."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "edited": false, "score": 0, "creation_date": 1548225034, "post_id": 54321162, "comment_id": 95461427, "body": "finally ...Thanks! ...it worked ..Thank you so much for your patience and help!"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1548225315, "post_id": 54321162, "comment_id": 95461530, "body": "Tim, I know it was in the OP - but why have a <code>SheetChange</code> and then set <i><code>Target</code></i> to a fixed address that is likely to be anything but the target? I am really surprised you did not pick this up! (Instead: <code>If Target.Address = &quot;B4&quot;</code> etc)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548225618, "post_id": 54321162, "comment_id": 95461645, "body": "I did pick it up but there&#39;s some potential reasons for why it might be that way so..."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1548225840, "post_id": 54321162, "comment_id": 95461722, "body": "Tim, from OP &quot;that is called when there is a change in cell &quot;B4&quot; of sheet &quot; - so the event handler should check to see if that is the cell that is changed - not force the issue. The only thing I can think of is if B4 is changed through formula but then some other criteria must be checked to see if there really is a change. The code as currently stands will run <b><i>every time there is a change in any worksheet</i></b> as long as B4 = completed."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548226034, "post_id": 54321162, "comment_id": 95461798, "body": "The comment above the code was a hint for the OP that they had a bit of work to do to make it right.  B4 is right under the cells being split, and the process would quite likely overwrite whatever is in B4..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1548224716, "creation_date": 1548224716, "answer_id": 54321162, "question_id": 54320712, "link": "https://stackoverflow.com/questions/54320712/vba-code-doesnt-run-when-i-call-it-automatically/54321162#54321162", "title": "VBA code doesn&#39;t run when I call it automatically", "body": "<p>It's unclear what sheet you're monitoring for changes, but this worked for me:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Set Target = sh.Range(\"B4\")\n    If Target.Value = \"Completed\" Then\n        Application.EnableEvents = False\n        splitText\n        Application.EnableEvents = True\n    End If\nEnd Sub\n\n\nSub splitText()\n    Dim warray() As String, i As Long, c As Range\n    For Each c In ThisWorkbook.Sheets(\"OUTPUT 1\").Range(\"A2:C2\").Cells\n        warray = Split(c.Value, \"&gt;\")\n        For i = LBound(warray) To UBound(warray)\n            c.Offset(i + 1, 0).Value = Trim(warray(i))\n        Next i\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10904582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2944732016e320662ac914dab5f66b5d?s=128&d=identicon&r=PG&f=1", "display_name": "j.doe", "link": "https://stackoverflow.com/users/10904582/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 54321162, "answer_count": 1, "score": 1, "last_activity_date": 1548229366, "creation_date": 1548222444, "last_edit_date": 1548229366, "question_id": 54320712, "link": "https://stackoverflow.com/questions/54320712/vba-code-doesnt-run-when-i-call-it-automatically", "title": "VBA code doesn&#39;t run when I call it automatically", "body": "<p>I have a macro named <code>Splittext</code> that is called when there is a change in cell \"B4\" of sheet <code>Macro Process</code> it doesn't work when I call it but it works when I manually run it. There is no error in the code </p>\n\n<pre><code>Sub splitText()\n    Dim wsS1 As Worksheet 'Sheet1\n    Dim textstring As String, warray() As String, counter As Integer, strg As String\n\n    Set wsS1 = Sheets(\"OUTPUT 1\")\n    wsS1.Activate\n\n    textstring = Range(\"A2\").Value\n    warray() = Split(textstring, \"&gt;\")\n\n    For counter = LBound(warray) To UBound(warray)\n        strg = warray(counter)\n        Cells(counter + 3, 1).Value = Trim(strg)\n    Next counter\n\n    textstring = Range(\"B2\").Value\n    warray() = Split(textstring, \"&gt;\")\n\n    For counter = LBound(warray) To UBound(warray)\n        strg = warray(counter)\n        Cells(counter + 3, 2).Value = Trim(strg)  \n    Next counter\n\n    textstring = Range(\"C2\").Value\n    warray() = Split(textstring, \"&gt;\")\n\n    For counter = LBound(warray) To UBound(warray)\n        strg = warray(counter)\n        Cells(counter + 3, 3).Value = Trim(strg)\n    Next counter\nEnd Sub\n</code></pre>\n\n<p>This code is supposed to separate the text present in the Cells (\"A2\")(\"B2\")(\"C2\") of sheet \"OUTPUT 1\" </p>\n\n<p>This is how I am calling the code </p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Set Target = Range(\"B4\")\n    If Target.Value = \"Completed\" Then\n        Call splitText\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-office", "office-js", "office-addins"], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 13113837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/720cd97648033756f852d62183affaa8?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Rush", "link": "https://stackoverflow.com/users/13113837/nathan-rush"}, "edited": false, "score": 1, "creation_date": 1585290276, "post_id": 54331947, "comment_id": 107712642, "body": "Is there any planned future functionality that might expose these VBAs to the API in contexts where they do exist?  Given that APIs are versioned and have feature sets, this seems like a natural extension. Having access to VBA modules would be super helpful! Specifically, trying to write an add-on that detects changes from versions of VBA code."}], "tags": [], "owner": {"reputation": 4675, "user_id": 5904541, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8pyqW.jpg?s=128&g=1", "display_name": "Juan Balmori", "link": "https://stackoverflow.com/users/5904541/juan-balmori"}, "is_accepted": false, "score": 1, "last_activity_date": 1548261913, "creation_date": 1548261913, "answer_id": 54331947, "question_id": 54320155, "link": "https://stackoverflow.com/questions/54320155/re-ask-get-all-the-vba-macros-of-a-workbook-by-javascript-api-for-excel/54331947#54331947", "title": "Re-ask: Get all the VBA macros of a workbook by JavaScript API for Excel", "body": "<p>No this is not possible to do today. Web add-ins are a multiplatform concept meaning all APIs exposed in JavaScript most function across all platforms (namely Windows, Online, Mac, iOS). Given that macros are not a multiplatform concept they are not exposed in our JS API.  </p>\n"}], "owner": {"reputation": 8684, "user_id": 702977, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/859cd18fc4bc067aa389b7c408eeb572?s=128&d=identicon&r=PG", "display_name": "SoftTimur", "link": "https://stackoverflow.com/users/702977/softtimur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1548261913, "creation_date": 1548218725, "question_id": 54320155, "link": "https://stackoverflow.com/questions/54320155/re-ask-get-all-the-vba-macros-of-a-workbook-by-javascript-api-for-excel", "title": "Re-ask: Get all the VBA macros of a workbook by JavaScript API for Excel", "body": "<p>I would like to re-ask a question I asked more than 2 years ago: <strong>Can JavaScript API for Office get VBA macros that a document contains?</strong> (<a href=\"https://officespdev.uservoice.com/forums/224641-feature-requests-and-feedback/suggestions/14062119-enable-fetching-vba-macros-of-a-workbook-in-javasc\" rel=\"nofollow noreferrer\">UserVoice</a>)</p>\n\n<p>Both VBA and VSTO have access to VBA macros. Tools such as <a href=\"https://xlsxwriter.readthedocs.io/working_with_macros.html\" rel=\"nofollow noreferrer\">XlsxWriter</a> could extrait <code>vbaProject.bin</code>; Moreover, tools like <a href=\"https://github.com/decalage2/oletools/blob/master/oletools/olevba.py\" rel=\"nofollow noreferrer\">olevba.py</a> could decompress even <code>vbaProject.bin</code>.</p>\n\n<p>If an Office document contains VBA code, it is probably an important component. Some big companies have in-house tools to inspect their VBA macros against bad programming practices, code smells, malware, computer forensics. There are software to measure metrics of VBA macros and find bugs. All these functionalities would be impossible without access to VBA macros.</p>\n\n<p>I guess providing an JavaScript API to read VBA macros would not be too complicated, but it could make possible many features and JavaScript add-ins.</p>\n"}, {"tags": ["vba", "ms-access", "subroutine"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 2, "creation_date": 1548217517, "post_id": 54319967, "comment_id": 95459368, "body": "No, that is not an issue."}, {"owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "edited": false, "score": 1, "creation_date": 1548230220, "post_id": 54319967, "comment_id": 95463512, "body": "As an addition: Every form (and its code) is like a class itself, so encapsulated. Even if you declare such procedures <code>Public</code> it won&#39;t be a problem."}], "answers": [{"tags": [], "owner": {"reputation": 337, "user_id": 5148062, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80f2650160209f64e6d1e44898ad4dad?s=128&d=identicon&r=PG&f=1", "display_name": "Rhdr", "link": "https://stackoverflow.com/users/5148062/rhdr"}, "is_accepted": true, "score": 0, "last_activity_date": 1548235173, "creation_date": 1548235173, "answer_id": 54323790, "question_id": 54319967, "link": "https://stackoverflow.com/questions/54319967/ms-access-vba-private-subs-with-same-name/54323790#54323790", "title": "MS Access VBA - Private Subs with Same Name", "body": "<p>No. Each private sub is private to that form, meaning that it wont interfere with the other forms private subs. If you have multiple public subs with the same name, then that will pose a problem (overloading is not directly supported in vba)</p>\n"}], "owner": {"reputation": 47, "user_id": 7982233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c271400ae21764671489ed692f45c22?s=128&d=identicon&r=PG&f=1", "display_name": "pewpew", "link": "https://stackoverflow.com/users/7982233/pewpew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 54323790, "answer_count": 1, "score": 0, "last_activity_date": 1593291033, "creation_date": 1548217232, "last_edit_date": 1593291033, "question_id": 54319967, "link": "https://stackoverflow.com/questions/54319967/ms-access-vba-private-subs-with-same-name", "title": "MS Access VBA - Private Subs with Same Name", "body": "<p>I have a database which has an 'exit database' button on every form.</p>\n<p>I have an event procedure that is executed 'on-click', every 'exit database' button in the database has the same sub name  : <code>Private Sub exitDatabase_Click()</code></p>\n<p>Each sub contains slightly different exit conditions. I have not yet come across an error but could having the same name for all my 'exit database' buttons cause an error somewhere down the line even though they are all private subs and exist on different forms? I wouldn't have thought so as they're private but I'm not sure.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1548217693, "post_id": 54319781, "comment_id": 95459408, "body": "Add a line <code>DoEvents</code> after <code>CopyRangeSingle.CopyPicture xlScreen, xlPicture</code>. Now check"}, {"owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1548250961, "post_id": 54319781, "comment_id": 95475206, "body": "Wow. That seems to have solved the issue. Very Simple.  Could you provide some insight into why this was happening and how the solution solves the issue?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1548254729, "post_id": 54319781, "comment_id": 95477525, "body": "When you are executing copy paste in a loop (or otherwise) you need to give excel time to copy and place things in clipboard. Your paste line was executing before the item was getting copied. All we did was gave excel some time..."}, {"owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1548255820, "post_id": 54319781, "comment_id": 95478236, "body": "I spoke a little too soon. Now the loop executes for significantly more iterations (~30)  but still gives me the &quot;Run-time error &#39;1004&#39; CopyPicture method of Range class failed&quot; at later iterations. I&#39;ve added the line &#39;Application.Wait (Now + 0.00003) to give it more time to paste and see if this helps..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1548262142, "post_id": 54319781, "comment_id": 95481860, "body": "This is a different error :)  What is the address of the range when you get the copy error?"}, {"owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1548278792, "post_id": 54319781, "comment_id": 95489082, "body": "If I understand correctly, the range address is S1:AJ50. The error happens at the &#39;CopyRangeSingle.CopyPicture xlScreen, xlPicture&#39; line. Since adding the Application.Wait line the error has stopped but it doesn&#39;t sound like this is an actual fix??"}], "owner": {"reputation": 300, "user_id": 4832718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b5544ae8dbdac9ad4cda754d5c5359?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4832718/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548227152, "creation_date": 1548215533, "last_edit_date": 1548227152, "question_id": 54319781, "link": "https://stackoverflow.com/questions/54319781/runtime-error-1004-paste-method-of-worksheet-class-failed", "title": "Runtime Error 1004 paste method of worksheet class failed", "body": "<p>I have the following subroutine. I am new to VBA so I imagine it is inefficient and clunky. In essence I am trying to call another subroutine (UpdateBlocksSingle) that does something and then I would like to take a screenshot of the results, paste it into a new spreadhseet called \"Screenshots\" and then export the results to a pdf. All of this is done in a loop so I generate a lot of screenshots (and a lot of pages in the pdf). I also begin the process of taking a screenshot out of the loop. </p>\n\n<p>The piece that continues to generate the 1004 error is:</p>\n\n<pre><code>CopyRangeSingle.CopyPicture xlScreen, xlPicture\nScreen.Paste Destination:=PasteRange.Offset(56 * i, 1)\nSheets(\"Screenshots\").Rows(56 * i).PageBreak = xlPageBreakManual\n</code></pre>\n\n<p>The error will occur randomly i.e. sometimes after 10 iterations through the loop other times after 1 or 2. When I change the appearance type from xlScreen to xlPrinter I no longer get the error. Andy advice on how to change the code so that I can successfully loop through and take screenshots while keeping the resolution of xlScreen would be much appreciated.</p>\n\n<pre><code>Sub LoopWaterProviders()\n\n'If a former Screenshot tab exits delete it\nDim ws As Worksheet\n\nFor Each ws In Worksheets\n    If ws.Name = \"Screenshots\" Then\n        Application.DisplayAlerts = False\n        Sheets(\"Screenshots\").Delete\n        Application.DisplayAlerts = True\n    End If\nNext\n\nCall CreateSheet\n\nSheets(\"BlockChart\").Select\n\nDim WaterProviders As Long\nDim OpenPDF As Boolean\nDim ProviderType As Long\nDim j As Long\nDim i As Long\nDim OutSht As Worksheet\nDim CopyRangeSingle As Range\nDim CopyRangeBlock As Range\nDim PasteRange As Range\nDim Block As Worksheet\nDim Screen As Worksheet\n\nj = 1\nProviderType = Sheets(\"Multiple Block Charts\").Range(\"A1\").Value\nOpenPDF = Sheets(\"Multiple Block Charts\").Range(\"A2\").Value\nSet Screen = Sheets(\"Screenshots\")\nSet Block = Sheets(\"BlockChart\")\nSet CopyRangeSingle = Block.Range(\"S1:AJ50\")\nSet CopyRangeBlock = Block.Range(\"A1:P43\")\nSet PasteRange = Screen.Cells(1, 1)\n\nIf ProviderType = 1 Then\nWaterProviders = Sheets(\"Calculations_Single\").Range(\"C11\").Value\nElseIf ProviderType = 2 Then\nWaterProviders = Sheets(\"Multiple Block Charts\").Range(\"F13\").Value\nElseIf ProviderType = 3 Then\nWaterProviders = Sheets(\"Multiple Block Charts\").Range(\"H15\").Value\nElseIf ProviderType = 4 Then\nWaterProviders = Sheets(\"Multiple Block Charts\").Range(\"K61\").Value\nElse: WaterProviders = Sheets(\"Calculations_Single\").Range(\"C11\").Value\nEnd If\n\nApplication.DisplayStatusBar = True\nCopyRangeBlock.CopyPicture xlPrinter, xlPicture\nScreen.Paste Destination:=PasteRange\nSheets(\"Screenshots\").Rows(56).PageBreak = xlPageBreakManual\nApplication.CutCopyMode = False\n\n\nWorksheets(\"BlockChart\").Select\n\nFor i = 1 To WaterProviders\n\n    If ProviderType = 1 Then\n    Sheets(\"Calculations_Single\").Range(\"C12\").Value = i\n    ElseIf ProviderType = 2 Then\n    Sheets(\"Calculations_Single\").Range(\"C12\").Value = Sheets(\"Multiple Block Charts\").Cells(i + 1, 6)\n    ElseIf ProviderType = 3 Then\n    Sheets(\"Calculations_Single\").Range(\"C12\").Value = Sheets(\"Multiple Block Charts\").Cells(i + 1, 9)\n    ElseIf ProviderType = 4 Then\n    Sheets(\"Calculations_Single\").Range(\"C12\").Value = Sheets(\"Multiple Block Charts\").Cells(i + 1, 12)\n\n    Else: Sheets(\"Calculations_Single\").Range(\"C12\").Value = i\n    End If\n\n    Call UpdateBlocksSingle\n\n    CopyRangeSingle.CopyPicture xlScreen, xlPicture\n    Screen.Paste Destination:=PasteRange.Offset(56 * i, 1)\n    Sheets(\"Screenshots\").Rows(56 * i).PageBreak = xlPageBreakManual\n\n    Next i\n\n    Sheets(\"Screenshots\").Range(\"A:S\").ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=\"G:\\P_and_R\\DATA_TOOLS\\Shortage Impacts\\Single_Year_BLOCK_CHART\\Provider_and_CAP_Supply_Block_AC_ver1.X_Output\\ProviderOutputCharts\", _\n    OpenAfterPublish:=OpenPDF, _\n    Quality:=xlQualityHighest, _\n    From:=1, _\n    To:=WaterProviders + 1\n\n\nMsgBox \"Export complete and PDF saved to 'G:\\P_and_R\\DATA_TOOLS\\Shortage Impacts\\Single_Year_BLOCK_CHART\\Provider_and_CAP_Supply_Block_AC_ver1.X_Output' \"\nSheets(\"BlockChart\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 10932531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e8196054bb8955d6fb69cd5a8650729?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/10932531/jasper"}, "is_accepted": true, "score": 0, "last_activity_date": 1548229205, "creation_date": 1548229205, "answer_id": 54322181, "question_id": 54319399, "link": "https://stackoverflow.com/questions/54319399/applying-auto-highlight-row-to-active-cell-to-the-entire-workbook-in-excel/54322181#54322181", "title": "Applying auto-highlight row to active cell to the entire workbook in excel", "body": "<p>Have you try placing the VBA into ThisWorkBook?</p>\n\n<p>I do realise placing the VBA into ThisWorkBook generally works better and more accurate than worksheet. In the ThisWorkBook, you could call a specific worksheet to perform the VBA.</p>\n\n<p>With sheets(\"NameOfWorksheet\")\n    Target.Calculate\nEnd with</p>\n"}], "owner": {"reputation": 25, "user_id": 10936792, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z2cqL99sQ28/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYyIPyiv_ufMnKGNyc9G1jFw4lSMA/mo/photo.jpg?sz=128", "display_name": "Ting", "link": "https://stackoverflow.com/users/10936792/ting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 54322181, "answer_count": 1, "score": 0, "last_activity_date": 1548229205, "creation_date": 1548212061, "last_edit_date": 1548221369, "question_id": 54319399, "link": "https://stackoverflow.com/questions/54319399/applying-auto-highlight-row-to-active-cell-to-the-entire-workbook-in-excel", "title": "Applying auto-highlight row to active cell to the entire workbook in excel", "body": "<p>I'm using the following formula in conditional formatting to highlight the active row when I click on a cell, </p>\n\n<pre><code>=OR(CELL(\"row\")=CELL(\"row\",A1))\n</code></pre>\n\n<p>and in VBA editor I am applying this macro to my worksheet. </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n   Target.Calculate\nEnd Sub\n</code></pre>\n\n<p>Currently I have to repeat the steps when I move onto the next worksheet (with existing data) and for some reason it doesn't always work. Is there a way to apply this to the entire workbook of current worksheets and possible new ones? Many thanks in advance!</p>\n\n<p><a href=\"https://i.stack.imgur.com/XYsZQ.jpg\" rel=\"nofollow noreferrer\">condition formatting - new rule</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/H3BQI.jpg\" rel=\"nofollow noreferrer\">VBA editor</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1548226109, "post_id": 54319384, "comment_id": 95461817, "body": "Maybe the first line raises an error (due to whatever reason) which is suppressed. Are the following lines executed?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1548228908, "post_id": 54319384, "comment_id": 95462956, "body": "Try to also set <code>LookAt:=xlPart, MatchCase:=False</code> Excel remembers the last state of <code>LookAt</code> and you never know what it is until you specified it."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548239043, "post_id": 54319384, "comment_id": 95468544, "body": "Also reference what ever sheet you are working on"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1548242069, "post_id": 54319384, "comment_id": 95470303, "body": "@0m3r If the Range Name is of workbook scope, that won&#39;t be necessary."}], "owner": {"reputation": 11, "user_id": 10869677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b70350cb382eb7395da0bf5fb0c1eb7?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/10869677/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548229743, "creation_date": 1548211941, "last_edit_date": 1548229743, "question_id": 54319384, "link": "https://stackoverflow.com/questions/54319384/range-replace-not-working-as-expected-on-office-365-version", "title": "Range.Replace not working as expected on Office 365 version", "body": "<p>I have a somewhat complex worksheet that has been behaving for my client for over a year now and recently they reported an issue to me that has me baffled.</p>\n\n<p>The workbook creates a copy of it self and then goes though a number of weekly tasks to remove completed tasks and to promote tasks due this week.</p>\n\n<p>The final step is to change a number of characters in a named range.</p>\n\n<p>The code:</p>\n\n<pre><code>Sub No_More_Delays()  \n    Range(\"Com_stat\").Replace What:=\"D\", Replacement:=\"X\"\n    Range(\"Com_stat\").Replace What:=\"L\", Replacement:=\"X\"\n    Range(\"Com_stat\").Replace What:=\"W\", Replacement:=\"X\"\nEnd Sub\n</code></pre>\n\n<p>The symptoms are that only the first \"hit\" works.  So if there is a <code>D</code> in any of the cells then all of the <code>D</code>'s get changed to <code>X</code>, however, if there are no <code>D</code>'s and only <code>L</code>'s then all of the <code>L</code>'s get replaced and if there are no <code>D</code> or <code>L</code>'s the all of the <code>W</code>'s get replaced.  If there are  <code>D</code>'s, <code>L</code>'s and <code>W</code>'s only the <code>D</code>'s get replaced.  If I change the order of the commands and put the <code>W</code> first and the <code>D</code> last and there are <code>D</code>'s, <code>L</code>'s and <code>W</code>'s all of the <code>W</code>'s get replaced and nothing else.</p>\n\n<p>These symptoms only occur at the clients office where they subscribe to Office 365.  On my machine running the same OS and a non Office 365 version of Excel, everything works.</p>\n\n<p>Has anyone else experienced anything like this and if you have is there a work-around.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10953158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3999786b640b25a7c144a095c2ae421?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/10953158/dazedandconfused"}, "edited": false, "score": 0, "creation_date": 1548222491, "post_id": 54320667, "comment_id": 95460558, "body": "Worked a treat. Those &#39;&quot;&quot;things do my head in. Thanks!"}], "tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": true, "score": 0, "last_activity_date": 1548222154, "creation_date": 1548222154, "answer_id": 54320667, "question_id": 54319337, "link": "https://stackoverflow.com/questions/54319337/how-do-i-write-vba-filter-with-wildcard/54320667#54320667", "title": "How do I write vba filter with wildcard", "body": "<p>To use wildcards to filter records try below:</p>\n\n<pre><code>Private Sub SearchTxt_AfterUpdate()\n\n  If Not IsNull(Me.SearchTxt) Then\n    Me.Filter = \"ProductName like '*\" &amp; Me.SearchTxt &amp; \"*'\"\n    Me.FilterOn = True\n  End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10953158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3999786b640b25a7c144a095c2ae421?s=128&d=identicon&r=PG&f=1", "display_name": "dazedAndConfused", "link": "https://stackoverflow.com/users/10953158/dazedandconfused"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 54320667, "answer_count": 1, "score": 1, "last_activity_date": 1548222173, "creation_date": 1548211579, "last_edit_date": 1548222173, "question_id": 54319337, "link": "https://stackoverflow.com/questions/54319337/how-do-i-write-vba-filter-with-wildcard", "title": "How do I write vba filter with wildcard", "body": "<p>can't work out where the quotes go in a filter string with wildcard</p>\n\n<p>I'm trying to create a filter for a split form.</p>\n\n<p>This works perfectly if I type in an exact match but I want to search for records containing the string.</p>\n\n<p>Know I need to use * at start and end but can't get the '\" right so it won't work</p>\n\n<pre><code>Private Sub SearchTxt_AfterUpdate()\n\nIf Not IsNull(Me.SearchTxt) Then\n    Me.Filter like \"ProductName = '\" &amp; Me.SearchTxt &amp; \"'\"\n    Me.FilterOn = True\nEnd If\n</code></pre>\n\n<p>trying to find Dish from dis or ish.</p>\n"}, {"tags": ["excel", "vba", "excel-addins"], "comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 1, "creation_date": 1548212780, "post_id": 54319159, "comment_id": 95458467, "body": "It sounds like the add-in itself is linked to an external source (outside of itself). That is why you disable it the message goes away. Did you create the add-in (or is it from a trusted source)? If not then, it could be doing something you don&#39;t want."}, {"owner": {"reputation": 378, "user_id": 9912294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0d5730932f395638327dce425d2b49?s=128&d=identicon&r=PG&f=1", "display_name": "Lun", "link": "https://stackoverflow.com/users/9912294/lun"}, "reply_to_user": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548229492, "post_id": 54319159, "comment_id": 95463200, "body": "Thanks @IamNerd2000, the macro is just a collection of UDFs and sub-procedures. Are you saying one of these macros refer to an outside file? Highly unlikely but I will check. Thanks!"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548252492, "post_id": 54319159, "comment_id": 95476088, "body": "You should also check if the addin is referencing any other addins or templates. That could be causing the problem as well."}], "owner": {"reputation": 378, "user_id": 9912294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a0d5730932f395638327dce425d2b49?s=128&d=identicon&r=PG&f=1", "display_name": "Lun", "link": "https://stackoverflow.com/users/9912294/lun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548209911, "creation_date": 1548209911, "question_id": 54319159, "link": "https://stackoverflow.com/questions/54319159/excel-warns-this-workbook-contains-links-even-with-a-new-blank-workbook", "title": "Excel warns &quot;this workbook contains links&quot; even with a new blank workbook", "body": "<p>I have an xlam file using both VBA and Power Query codes. I also link to an .XLAM addin to call certain UDFs and macros.</p>\n\n<p>Recently Excel has given me the message \"This workbook contains links to one or more external sources that could be unsafe\" when I open this file. </p>\n\n<p><a href=\"https://i.stack.imgur.com/r1Md2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r1Md2.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried:</p>\n\n<ol>\n<li>Removing all links in Edit Links</li>\n<li>Disabling the warning in \"Startup Prompt\" of Edit Links</li>\n<li>Making sure there are no links in all sheets'formulas, conditional formattings and data validation</li>\n<li>I have no charts so no links there</li>\n</ol>\n\n<p>But none of these options worked.</p>\n\n<p>I also tried to open a new blank workbook and the warning message is still there!</p>\n\n<p>So I disabled the link to the Add-in In Excel Options - Add-Ins and yes, no more annoying message after that for the blank workbook.</p>\n\n<p>But after I connect back to the add-in, the message comes back.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rg4zl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rg4zl.png\" alt=\"enter image description here\"></a></p>\n\n<p>The add-in is stored in C:\\OneDrive\\XJ15 Macros\\Live\\Freelensia Macros.xlam</p>\n\n<p>Why would this create issues with Link Warning message, even though I have opened a new blank workbook, and I turned off the Startup Prompt for Links?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 2, "creation_date": 1548209018, "post_id": 54318982, "comment_id": 95457734, "body": "What have you tried so far?"}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 1, "creation_date": 1548213432, "post_id": 54318982, "comment_id": 95458594, "body": "How is the data in excel formatted? How is the data in Word formatted? In other words is it all on one row in excel? is it all in one column in Word? Some more information would be helpful."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1548242260, "creation_date": 1548242260, "answer_id": 54326027, "question_id": 54318982, "link": "https://stackoverflow.com/questions/54318982/vba-to-transfer-different-fields-in-excel-into-one-word-document-without-a-table/54326027#54326027", "title": "VBA to Transfer different fields in excel into one word document without a table", "body": "<p>The trick is to set bookmarks in the word document at the locations where you want to data to appear. So to transfer the quantity place a bookmark called \"quantity\" just to the right of the text \"Qty\". You can then use Bookmarks(\"quantity\") to refer to that location. You haven't said whether you want to run your code in Word and fetch the excel data, or run it in Excel and push it to Word - but the principle is the same. Set a reference in the code running app to the other, declare a variable to point to the other app, launch it, open the source or receiving file, declare the source range as an excel range object (lets say we call it rSource) and declare a word range object (lets call it myqty) to point to Bookmarks(\"quantity\").range\nyou can then say\nmyqty = rSource.text</p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1548309731, "creation_date": 1548309731, "answer_id": 54340250, "question_id": 54318982, "link": "https://stackoverflow.com/questions/54318982/vba-to-transfer-different-fields-in-excel-into-one-word-document-without-a-table/54340250#54340250", "title": "VBA to Transfer different fields in excel into one word document without a table", "body": "<p>If it's always the same workbook &amp; range of cells, you can link the document or its template to the workbook so there is nothing to copy/paste each time. To set up such a link, copy a given Excel range, then paste it into your document or template using Paste Special, with the 'paste link' option and your preferred paste format. That way the document - or a new document created from the template - will automatically reflect the Excel data. If you're using a template, you might then break the links (e.g. via Ctrl-A, Ctrl-Shift-F9) so the new documents don't keep updating when you re-open them.</p>\n"}], "owner": {"reputation": 11, "user_id": 10953152, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215255076505109/picture?type=large", "display_name": "Tan", "link": "https://stackoverflow.com/users/10953152/tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548309731, "creation_date": 1548208331, "last_edit_date": 1548235246, "question_id": 54318982, "link": "https://stackoverflow.com/questions/54318982/vba-to-transfer-different-fields-in-excel-into-one-word-document-without-a-table", "title": "VBA to Transfer different fields in excel into one word document without a table", "body": "<p>I have an excel spreadsheet where i work out my quotation data. I have been then copying and pasting the different totals for each line of the quote into a Word document. I am trying to get tht code right to transfer each individual field into different parts of the word doc with one click instead of manually copying each one. There are 10 to 20 lines with $amounts that i want to transfer to my word template</p>\n\n<p>In Excel I have</p>\n\n<pre><code>    Qty           50\n    Components    40\n    Hardware      130\n    Panel         375\n    NRE           850\n</code></pre>\n\n<p>Then in Word I have </p>\n\n<pre><code>    Qty           \n    PCB Cost\n    Components    \n    Hardware      \n    Panel         \n    NRE          \n    USD Exchange\n    Total\n</code></pre>\n\n<p>How can i get the numbers from excel into the correct lines in word? </p>\n"}, {"tags": ["excel", "vba", "time", "rtd", "ontime"], "comments": [{"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548214317, "post_id": 54318918, "comment_id": 95458774, "body": "It is hard to know exactly what you are asking here. It looks like you are calling RecordData recursively through the OnTime function. Are you only wanting to Run it once from an external call? Or are you running OpenMe() first?"}, {"owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "reply_to_user": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548215125, "post_id": 54318918, "comment_id": 95458916, "body": "I am running OpenMe() first from a command button which calls the RecordData(). I am capturing some RTD (in 1min intervals) and in order for the RTD to refresh you need to open and close the workbook (after 10min). Then another command button stops StopRecordingData() stops OpenMe() to stop RecordData()."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548215489, "post_id": 54318918, "comment_id": 95458981, "body": "Instead of calling the RecordData&#39;s following code:  Application.OnTime NextTime, &quot;RecordData&quot;  Have you thought about using application.wait? Also, what do you mean by RTD? is it calculated on the workbook open event?"}, {"owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "reply_to_user": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "edited": false, "score": 0, "creation_date": 1548215841, "post_id": 54318918, "comment_id": 95459040, "body": "No I have not. That might help and separate the two OnTime&#39;s that seem to be getting confused with one another. How does application.wait work? Real Time Data (RTD) from another software platform that is logging data into another sheet I am recording from."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 0, "creation_date": 1548217810, "post_id": 54319839, "comment_id": 95459447, "body": "I tried adding this but got an error :/                                                                              Sub OpenMe()                                                                                                 Call RecordData     Application.Wait (Now + TimeValue(&quot;00:010:00&quot;)), &quot;CloseMe&quot;     End Sub"}, {"owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 0, "creation_date": 1548271428, "post_id": 54319839, "comment_id": 95486110, "body": "@Excelosaurus any help on this one? This code is stressing me out!"}, {"owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 0, "creation_date": 1548272509, "post_id": 54319839, "comment_id": 95486553, "body": "I did and there were errors. I am not sure Application.Wait is the right approach as it seems to complicate the code (for me at least) I am still very new to vba."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 1, "creation_date": 1548286967, "post_id": 54319839, "comment_id": 95491882, "body": "The code is working for me.  You will need to change the wait numbers to what you require, but if you test it with the code I pasted in then it will work.  Remember to update the values!"}, {"owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 0, "creation_date": 1548287833, "post_id": 54319839, "comment_id": 95492061, "body": "Ok. Thanks for helping me. The code is running but I am confused on where to put the wait numbers in the code. Can you highlight the areas I need to change? I want to log/record the data in one minute intervals, then close the workbook in 10 minutes, and then reopen in 10 seconds."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 0, "creation_date": 1548288223, "post_id": 54319839, "comment_id": 95492130, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/187212/discussion-between-iamnerd2000-and-mjac\">continue this discussion in chat</a>."}, {"owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "reply_to_user": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 0, "creation_date": 1548344913, "post_id": 54319839, "comment_id": 95516278, "body": "If you found this helpful then, please accept it as your answer and upvote. :)"}, {"owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "edited": false, "score": 0, "creation_date": 1555869199, "post_id": 54319839, "comment_id": 98241125, "body": "@ IAmNerd2000 <a href=\"https://stackoverflow.com/questions/55776267/send-email-w-out-outlook-referencing-worksheet-data\" title=\"send email w out outlook referencing worksheet data\">stackoverflow.com/questions/55776267/&hellip;</a>"}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 1, "last_activity_date": 1548297474, "last_edit_date": 1548297474, "creation_date": 1548216020, "answer_id": 54319839, "question_id": 54318918, "link": "https://stackoverflow.com/questions/54318918/ontime-timestamp-value-doubling-up/54319839#54319839", "title": "OnTime TimeStamp Value Doubling Up", "body": "<p>Here is an example wait sub:</p>\n\n<p>NOTE: This function is only available in excel.</p>\n\n<pre><code>Option Explicit\n\nDim vntNextTime As Variant\nDim blnStopExecution As Boolean\n\nConst c_strTotalRecordDataWaitTime As String = \"00:05:00\"\nConst c_strCloseAndStopWaitTime As String = \"00:00:30\"\n\n\n'This should be on the same sheet as your button!\nPrivate Sub CommandButton1_Click()\n    StopRecordingData\nEnd Sub\n\n'Private Sub WaitFor(intHrs As Integer, intMins As Integer, intSecs As Integer)\n'    Dim newHour As Integer\n'    Dim newMinute As Integer\n'    Dim newSecond As Integer\n'\n'    Dim waitTime As Variant\n'\n'    newHour = Hour(Now()) + intHrs\n'    newMinute = Minute(Now) + intMins\n'    newSecond = Second(Now()) + intSecs\n'\n'    waitTime = TimeSerial(newHour, newMinute, newSecond)\n'\n'    Application.Wait waitTime\n'End Sub\n\n    Private Function CombineTime(intHrs As Integer, intMins As Integer, intSecs As Integer) As Long\n        Dim lngTime As Long\n\n        lngTime = intSecs + intMins * 60 + intHrs * 3600\n        CombineTime = lngTime\n    End Function\n\n    Public Function GetTimeFromString(strInTime As String) As Long\n        Dim strSplit() As String\n        Dim intHrs As Integer\n        Dim intMins As Integer\n        Dim intSecs As Integer\n\n        strSplit = Split(strInTime, \":\")\n        intHrs = CInt(strSplit(0))\n        intMins = CInt(strSplit(1))\n        intSecs = CInt(strSplit(2))\n\n        GetTimeFromString = CombineTime(intHrs, intMins, intSecs)\n    End Function\n\n\n    Private Sub WaitFor(intHrs As Long, intMins As Long, intSecs As Long)\n        Dim newHour As Integer\n        Dim newMinute As Integer\n        Dim newSecond As Integer\n        Dim CurTime As Variant\n\n        Dim waitTime As Variant\n\n        newHour = Hour(Now()) + intHrs\n        newMinute = Minute(Now) + intMins\n        newSecond = Second(Now()) + intSecs\n\n        waitTime = TimeSerial(newHour, newMinute, newSecond)\n\n        'This is bad practice, but it will work for what you need.\n        CurTime = 0\n        Do While CurTime &lt; waitTime\n            newHour = Hour(Now())\n            newMinute = Minute(Now)\n            newSecond = Second(Now())\n\n            CurTime = TimeSerial(newHour, newMinute, newSecond)\n            DoEvents\n            If blnStopExecution Then Exit Do\n        Loop\n        'Application.Wait waitTime\n    End Sub\n\n\n    Private Function GetNextTime(intHrs As Long, intMins As Long, intSecs As Long) As Variant\n        Dim newHour As Integer\n        Dim newMinute As Integer\n        Dim newSecond As Integer\n\n        Dim vntThisNextTime As Variant\n\n        newHour = Hour(Now()) + intHrs\n        newMinute = Minute(Now) + intMins\n        newSecond = Second(Now()) + intSecs\n\n        vntThisNextTime = TimeSerial(newHour, newMinute, newSecond)\n\n        GetNextTime = vntThisNextTime\n    End Function\n\n    Private Sub RecordData()\n        Dim Interval As Double\n        Dim cel As Range, Capture As Range\n        Dim intI As Integer\n        Dim lngTimeStep As Long\n\n        Application.StatusBar = \"Recording Started\"\n\n        lngTimeStep = GetTimeFromString(c_strTotalRecordDataWaitTime) / 10\n\n        For intI = 0 To 9\n            WaitFor 0, 0, lngTimeStep\n            If blnStopExecution Then Exit For\n\n            Set Capture = Worksheets(\"Dashboard\").Range(\"C5:K5\") 'Capture this row of data\n            With Worksheets(\"Journal\") 'Record the data on this worksheet\n                Set cel = .Range(\"A2\") 'First timestamp goes here\n                Set cel = .Cells(.Rows.Count, cel.Column).End(xlUp).Offset(1, 0)\n                cel.Value = Now\n                cel.Offset(0, 1).Resize(1, Capture.Cells.Count).Value = Capture.Value\n            End With\n        Next intI\n    End Sub\n\n    Public Sub OpenMe()\n        blnStopExecution = False\n        Call RecordData\n        Call CloseMe\n    End Sub\n\n   Public Sub CloseMe()\n        blnStopExecution = True\n\n        vntNextTime = GetNextTime(0, 0, GetTimeFromString(c_strCloseAndStopWaitTime))\n        Application.OnTime vntNextTime, \"OpenMe\"  'Now + TimeValue(\"00:00:10\"), \"OpenMe\"\n\n        ThisWorkbook.Close True\n    End Sub\n\n    Public Sub StopRecordingData()\n        blnStopExecution = True\n        Application.StatusBar = \"Recording Stopped\"\n\n        vntNextTime = GetNextTime(0, 0, GetTimeFromString(c_strCloseAndStopWaitTime))\n        Application.OnTime vntNextTime, \"OpenMe\"\n    End Sub\n\n</code></pre>\n\n<p>'I want to log/record the data in one minute intervals, then close the workbook \n'in 10 minutes, and then reopen in 10 seconds</p>\n"}], "owner": {"reputation": 51, "user_id": 5458415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saVFo.jpg?s=128&g=1", "display_name": "mjac", "link": "https://stackoverflow.com/users/5458415/mjac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 54319839, "answer_count": 1, "score": 0, "last_activity_date": 1548297474, "creation_date": 1548207841, "last_edit_date": 1548215517, "question_id": 54318918, "link": "https://stackoverflow.com/questions/54318918/ontime-timestamp-value-doubling-up", "title": "OnTime TimeStamp Value Doubling Up", "body": "<p>When you launch RecordData() sub (from OpenMe() sub) just once it works perfectly. Each time stamp log is consecutive with no doubles. Its when the workbook, re-opens again (due to OpenMe()/Close() subs) is when it creates a duplicate time stamp log. Can I re-arrange the OnTime so it doesn't schedule a double for its next session? Or separate the two OnTime's somehow so their independent?</p>\n\n<pre><code>Dim NextTime As Double\nSub RecordData()\n    Dim Interval As Double\n    Dim cel As Range, Capture As Range\n\n    Application.StatusBar = \"Recording Started\"\n    Set Capture = Worksheets(\"Dashboard\").Range(\"C5:K5\") 'Capture this row of data\n    With Worksheets(\"Journal\") 'Record the data on this worksheet\n        Set cel = .Range(\"A2\") 'First timestamp goes here\n        Set cel = .Cells(.Rows.Count, cel.Column).End(xlUp).Offset(1, 0)\n        cel.Value = Now\n        cel.Offset(0, 1).Resize(1, Capture.Cells.Count).Value = Capture.Value\n    End With\n    NextTime = Now + TimeValue(\"00:01:00\")\n    Application.OnTime NextTime, \"RecordData\"\nEnd Sub\n\nSub StopRecordingData()\n    Application.StatusBar = \"Recording Stopped\"\n    Application.OnTime NextTime, \"OpenMe\", , False\nEnd Sub\n\nSub OpenMe()\n    Call RecordData\n    Application.OnTime Now + TimeValue(\"00:10:00\"), \"CloseMe\"\nEnd Sub\n\nSub CloseMe()\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"OpenMe\"\n    ThisWorkbook.Close True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548207491, "post_id": 54318824, "comment_id": 95457424, "body": "Could you manipulate the FooterMargin to push the footer text up the sheet?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548209613, "post_id": 54318824, "comment_id": 95457846, "body": "That&#39;s exactly what I need to do .. but I couldn&#39;t do that :)"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548210559, "post_id": 54318824, "comment_id": 95458050, "body": "Yeah, looks like Margins setting can only be set for all pages.  The only option might be the one you rejected - a temporary row"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548211013, "post_id": 54318824, "comment_id": 95458129, "body": "Is there a way to change the margin for the last page only to suit the last row .. and then to restore the margin to original position?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1548231222, "post_id": 54318824, "comment_id": 95463981, "body": "Since you can only set the margins for <i>all</i> pages, a temporary change doesn&#39;t work, because it would also affect the previous pages and therefore change the amount of pages."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1548233191, "post_id": 54318824, "comment_id": 95465064, "body": "One rather ugly work around would be to set the print range to exclude the last page, and set footers normally, and print that.  Then set the print range to just the last page and set margins as required,  then print that separately."}], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548228422, "creation_date": 1548207093, "last_edit_date": 1548228422, "question_id": 54318824, "link": "https://stackoverflow.com/questions/54318824/print-footer-directly-after-last-row-in-page", "title": "Print footer directly after last row in page", "body": "<p>I have a sheet that I made a code to print the sheet and the data in the sheet is dynamic by another code. I mean the number of rows that will be printed will not be fixed all the time\nIs there a way to print the footer directly after the last row of each page as the page sometimes has only 5 rows and at this case the footer is far away from the data .. so I need a way to make the footer near the data in that case? Is that possible?\nNote I don't want to include the footer as temporary row and delete that row after the print ..</p>\n\n<p>Here's my try till now</p>\n\n<pre><code>Sub Test()\nDim i As Integer, x As Double, lr As Integer\nDim a, y\nWith ActiveSheet.PageSetup\n    x = .FooterMargin\n    For i = 1 To .Pages.Count\n        If i = .Pages.Count Then\n            'Stop\n            'How to set the margin so as to suit the last row of data\n            lr = Cells(Rows.Count, 1).End(xlUp).Row\n            ActiveSheet.PageSetup.PrintArea = Range(\"A1:H\" &amp; lr).Address\n            a = Mid(Sheets(\"Sheet1\").HPageBreaks(1).Location.Address(0, 0), 2, 99) - 1\n\n\n            y = a - (lr - (a * (.Pages.Count - 1)))\n\n            MsgBox y\n            '.FooterMargin = Application.InchesToPoints(0.78740157480315)\n        End If\n        ActiveSheet.PrintOut from:=i, To:=i, Preview:=True\n        'ActiveSheet.PrintPreview\n    Next i\n    .FooterMargin = x\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer", "automation"], "answers": [{"comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1548299816, "post_id": 54318776, "comment_id": 95494462, "body": "Thanks for sharing the solution here. It will surely help other community members in future in similar kind of issues. I suggest you to mark the solution as an accepted answer for this question. Thanks for your understanding."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1548301076, "post_id": 54318776, "comment_id": 95494675, "body": "@Deepak-MSFT  When answering your own question you need to wait two days..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566240602, "post_id": 54318776, "comment_id": 101586507, "body": "Replying here since OP deleted their dupe question; <code>foo = [{&quot;5&quot;,&quot;9&quot;,&quot;3&quot;,&quot;k&quot;,&quot;p&quot;,&quot;x&quot;,&quot;q&quot;,&quot;8&quot;}]</code> is only legal when the code is hosted in Excel; it abuses square-bracket notation to implicitly invoke <code>Application.Evaluate</code>, which defers to Excel&#39;s calc engine to resolve the curly braces into a variant array - given OP&#39;s obviously poor understanding of arrays, it&#39;s a massive disservice IMO."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1566243371, "post_id": 54318776, "comment_id": 101587508, "body": "@MathieuGuindon - yep I don&#39;t <i>like</i> it either, and it&#39;s not really even much of a shortcut."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1548228951, "last_edit_date": 1548228951, "creation_date": 1548206769, "answer_id": 54318776, "question_id": 54318737, "link": "https://stackoverflow.com/questions/54318737/automating-the-html-document-in-an-ie-web-dialog-window/54318776#54318776", "title": "Automating the HTML document in an IE web dialog window?", "body": "<p>Here's what I ended up with (apologies for not including the various links where I found the key parts - will add later if I can re-find them)</p>\n\n<p>Edit:  <a href=\"https://social.msdn.microsoft.com/Forums/en-US/baf3cb64-8858-4d2d-9d7b-eaee76919256/modify-the-code-obtained-from-the-internet-explorerserver-hwnd-handle?forum=vbgeneral\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/baf3cb64-8858-4d2d-9d7b-eaee76919256/modify-the-code-obtained-from-the-internet-explorerserver-hwnd-handle?forum=vbgeneral</a></p>\n\n<p><strong>Declarations</strong> (if you have 64-bit Office installed you will need to make some adjustments)</p>\n\n<pre><code>Option Explicit\n\n' Requires: VBA project reference to \"Microsoft HTML Object Library\"\n\nPrivate Const SMTO_ABORTIFHUNG = &amp;H2\nPrivate Const GW_CHILD = 5\nPrivate Const GW_HWNDNEXT = 2\n\nPrivate Type UUID\n   Data1 As Long\n   Data2 As Integer\n   Data3 As Integer\n   Data4(0 To 7) As Byte\nEnd Type\n\nPrivate Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n    (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\n\nPrivate Declare Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" _\n    (ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long\n\nPrivate Declare Function GetWindowTextLength Lib \"user32\" Alias \"GetWindowTextLengthA\" _\n    (ByVal hWnd As Long) As Long\n\nPrivate Declare Function GetWindow Lib \"user32\" _\n    (ByVal hWnd As Long, ByVal wCmd As Long) As Long\n\nPrivate Declare Function IsWindowVisible Lib \"user32\" _\n    (ByVal hWnd As Long) As Boolean\n\nPrivate Declare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" _\n    (ByVal hWnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long\n\nPrivate Declare Function RegisterWindowMessage Lib \"user32\" _\n     Alias \"RegisterWindowMessageA\" (ByVal lpString As String) As Long\n\nPrivate Declare Function SendMessageTimeout Lib \"user32\" _\n   Alias \"SendMessageTimeoutA\" ( _\n   ByVal hWnd As Long, _\n   ByVal msg As Long, _\n   ByVal wParam As Long, _\n   lParam As Any, _\n   ByVal fuFlags As Long, _\n   ByVal uTimeout As Long, _\n   lpdwResult As Long) As Long\n\nPrivate Declare Function ObjectFromLresult Lib \"oleacc\" ( _\n   ByVal lResult As Long, _\n   riid As UUID, _\n   ByVal wParam As Long, _\n   ppvObject As Any) As Long\n</code></pre>\n\n<p><strong>Example usage:</strong></p>\n\n<pre><code>'An example of how to use this approach - other subs below should not need adjusting\nSub DialogDemo()\n\n    Const DLG_TITLE = \"User Info -- Webpage Dialog\" '&lt;&lt; the dialog title\n    Dim doc As IHTMLDocument\n\n    Set doc = GetIEDialogDocument(DLG_TITLE)\n\n    If Not doc Is Nothing Then\n        'Debug.Print doc.body.innerHTML\n        doc.getElementById(\"password_id\").Value = \"password\"\n        doc.getElementById(\"Notes_id\").Value = \"notes go here\"\n        doc.getElementById(\"b_Ok_id\").Click '&lt;&lt; click OK\n    Else\n        MsgBox \"Dialog Window '\" &amp; DLG_TITLE &amp; \"' was not found!\", vbOKOnly + vbExclamation\n    End If\nEnd Sub\n\n'Given an IE dialog window title, find the window and return a reference\n'   to the embedded HTML document object\nFunction GetIEDialogDocument(dialogTitle As String) As IHTMLDocument\n    Dim lhWndP As Long, lhWndC As Long, doc As IHTMLDocument\n    'find the IE dialog window given its title\n    If GetHandleFromPartialCaption(lhWndP, dialogTitle) Then\n        Debug.Print \"Found dialog window - \" &amp; dialogTitle &amp; \"(\" &amp; TheClassName(lhWndP) &amp; \")\"\n        lhWndC = GetWindow(lhWndP, GW_CHILD)  'Find Child\n        If lhWndC &gt; 0 Then\n            If TheClassName(lhWndC) = \"Internet Explorer_Server\" Then\n                Debug.Print , \"getting the document...\"\n                Set doc = IEDOMFromhWnd(lhWndC)\n            End If\n        End If\n    Else\n        Debug.Print \"Window '\" &amp; dialogTitle &amp; \"' not found!\"\n    End If\n    Set GetIEDialogDocument = doc\nEnd Function\n\n' IEDOMFromhWnd\n' Returns the IHTMLDocument interface from a WebBrowser window\n' hWnd - Window handle of the control\nFunction IEDOMFromhWnd(ByVal hWnd As Long) As IHTMLDocument\n    Dim IID_IHTMLDocument As UUID\n    Dim hWndChild As Long\n    Dim lRes As Long\n    Dim lMsg As Long\n    Dim hr As Long\n\n    If hWnd &lt;&gt; 0 Then\n\n        lMsg = RegisterWindowMessage(\"WM_HTML_GETOBJECT\") ' Register the message\n        SendMessageTimeout hWnd, lMsg, 0, 0, SMTO_ABORTIFHUNG, 1000, lRes ' Get the object pointer\n\n        If lRes Then\n            With IID_IHTMLDocument ' Initialize the interface ID\n                .Data1 = &amp;H626FC520\n                .Data2 = &amp;HA41E\n                .Data3 = &amp;H11CF\n                .Data4(0) = &amp;HA7\n                .Data4(1) = &amp;H31\n                .Data4(2) = &amp;H0\n                .Data4(3) = &amp;HA0\n                .Data4(4) = &amp;HC9\n                .Data4(5) = &amp;H8\n                .Data4(6) = &amp;H26\n                .Data4(7) = &amp;H37\n            End With\n            ' Get the object from lRes (note - returns the object via the last parameter)\n            hr = ObjectFromLresult(lRes, IID_IHTMLDocument, 0, IEDOMFromhWnd)\n        End If\n   End If 'hWnd&lt;&gt;0\nEnd Function\n\n'utilty function for getting the classname given a window handle\nFunction TheClassName(lhWnd As Long)\n    Dim strText As String, lngRet As Long\n    strText = String$(100, Chr$(0))\n    lngRet = GetClassName(lhWnd, strText, 100)\n    TheClassName = Left$(strText, lngRet)\nEnd Function\n\nPrivate Function GetHandleFromPartialCaption(ByRef lWnd As Long, _\n                                             ByVal sCaption As String) As Boolean\n    Dim lhWndP As Long, sStr As String\n\n    GetHandleFromPartialCaption = False\n    lhWndP = FindWindow(vbNullString, vbNullString) 'PARENT WINDOW\n    Do While lhWndP &lt;&gt; 0\n        sStr = String(GetWindowTextLength(lhWndP) + 1, Chr$(0))\n        GetWindowText lhWndP, sStr, Len(sStr)\n        sStr = Left$(sStr, Len(sStr) - 1)\n        If Len(sStr) &gt; 2 Then\n            If UCase(sStr) Like \"*ARG*\" Then Debug.Print sStr\n        End If\n        If InStr(1, sStr, sCaption) &gt; 0 Then\n            GetHandleFromPartialCaption = True\n            lWnd = lhWndP\n            Exit Do\n        End If\n        lhWndP = GetWindow(lhWndP, GW_HWNDNEXT)\n    Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 1, "accepted_answer_id": 54318776, "answer_count": 1, "score": 2, "last_activity_date": 1548228951, "creation_date": 1548206400, "question_id": 54318737, "link": "https://stackoverflow.com/questions/54318737/automating-the-html-document-in-an-ie-web-dialog-window", "title": "Automating the HTML document in an IE web dialog window?", "body": "<p>Posting this question do I can provide a full example for anyone like me who needed to figure this out...</p>\n\n<p>Occasionally when automating IE you may be faced with a pop-up dialog which you need to interact with: I'm specifically talking here about the modal dialog which is IE-specific, and opened using <code>showModalDialog</code></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms536759(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ms536759(v=vs.85).aspx</a></p>\n\n<p>These dialogs are different from the typical \"pop-over\" dialogs or ones based on <code>window.open()</code> - although they contain HTML, there's no easy way to get a reference to the document contained within the dialog.  For example iterating through the windows under the Windows shell does not find this type of dialog.</p>\n\n<p>I figured there must be some way to solve this problem using the Windows API, and I found a bunch of relevant pieces via Google, but no complete and self-contained example.  </p>\n\n<p>See my answer for how I solved my specific use case - should be easily re-used if you need something similar.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "edited": false, "score": 0, "creation_date": 1548207333, "post_id": 54318667, "comment_id": 95457398, "body": "Just for kicks have you tried printing the ascii value of each character?  For I = 1 to len(text)   Debug.print asc(mid(text,I,1))   Next I.  Put these statements on different lines.  Also I wouldn\u2019t use \u201ctext\u201d as a variable, it looks too much like a reserved word."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548215055, "post_id": 54318667, "comment_id": 95458900, "body": "Where is your text coming from?  If the line breaks were entered in Excel using Alt+Enter they will be <code>vbLf</code> (Ascii 10)"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1548228293, "creation_date": 1548228293, "answer_id": 54321982, "question_id": 54318667, "link": "https://stackoverflow.com/questions/54318667/how-to-detect-a-line-break-in-excel-through-vba/54321982#54321982", "title": "How to detect a line break in Excel through VBA", "body": "<p>The line break in cells, which is created with <kbd>Alt</kbd> + <kbd>Enter</kbd> is a <code>vbLf</code>.</p>\n\n<p>Therefore the following should work.</p>\n\n<pre><code>InStr(startlocation, text, vbLf)\n</code></pre>\n\n<p>If it doesn't work that means you did something else wrong.</p>\n\n<p>If you have the following data in cell A1 (<kbd>Alt</kbd> + <kbd>Enter</kbd> after <code>1</code> and <code>2</code>)</p>\n\n<p><a href=\"https://i.stack.imgur.com/yGo2Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yGo2Y.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then <code>InStr(1, Range(\"A1\"), vbLf)</code> returns <code>2</code>.</p>\n\n<hr>\n\n<p>For example you can use \u2026</p>\n\n<pre><code>Dim ArrLines As Variant\nArrLines = Split(Range(\"A1\"), vbLf)\n</code></pre>\n\n<p>to split these lines into an array like \u2026</p>\n\n<ul>\n<li><code>ArrLines(0)</code> is <code>1</code> </li>\n<li><code>ArrLines(1)</code> is <code>2</code> </li>\n<li><code>ArrLines(2)</code> is <code>3</code> </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 1446675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f9ac8cafc74458a846115fb4cbdc33?s=128&d=identicon&r=PG", "display_name": "fdagher1", "link": "https://stackoverflow.com/users/1446675/fdagher1"}, "is_accepted": false, "score": 0, "last_activity_date": 1548540152, "creation_date": 1548540152, "answer_id": 54383218, "question_id": 54318667, "link": "https://stackoverflow.com/questions/54318667/how-to-detect-a-line-break-in-excel-through-vba/54383218#54383218", "title": "How to detect a line break in Excel through VBA", "body": "<p>As others have confirmed, <code>vbLf</code> was indeed the correct character for identifying the line break introduced by ALT + Enter. My issue turned out to be caused by how the content of <code>text</code> was ending one character before the line break, therefore the <code>InStr(startlocation, text, vbLf)</code> on that string was not finding the line break. Extending <code>text</code> (which was created using the <code>Mid</code> function) by 1 took care of the issue. So:</p>\n\n<p>Instead of: <code>text = Mid(entryvalue, delimeterlocation, Len(entryvalue) - delimeterlocation)</code></p>\n\n<p>I did this: <code>text = Mid(entryvalue, delimeterlocation, Len(entryvalue) - delimeterlocation + 1)</code></p>\n"}], "owner": {"reputation": 27, "user_id": 1446675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f9ac8cafc74458a846115fb4cbdc33?s=128&d=identicon&r=PG", "display_name": "fdagher1", "link": "https://stackoverflow.com/users/1446675/fdagher1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1997, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1548540152, "creation_date": 1548205834, "last_edit_date": 1548227777, "question_id": 54318667, "link": "https://stackoverflow.com/questions/54318667/how-to-detect-a-line-break-in-excel-through-vba", "title": "How to detect a line break in Excel through VBA", "body": "<p>I'm trying to find the carriage return\\line break in various cells, by iterating over them and running the InStr function against the text in each of those cells. The below query is finding the line break correctly in most cells, but is failing in one of those cells. </p>\n\n<p>The line break in those cells was added the same for all of them, and that is by hitting Alt+Enter. </p>\n\n<p>Below is the function I am using:</p>\n\n<pre><code>InStr(startlocation, text, vbLf)\n</code></pre>\n\n<p>I also tried all of the below, but to no avail:</p>\n\n<pre><code>InStr(startlocation, text, Chr(10)) 'this seems to be identical in results to using vbLf\nInStr(startlocation, text, Chr(13)) 'No results with this\nInStr(startlocation, text, ALT + 10) 'I see this returning some results sometimes, not exactly sure for which character though\nInStr(startlocation, text, vbCrLf) 'No results with this\n</code></pre>\n\n<p>Is there any other way to represent line break so I add it to my query?</p>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 1, "creation_date": 1548217746, "post_id": 54318216, "comment_id": 95459428, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32209245/loop-through-each-field-for-ms-project\">Loop through each field for MS Project</a>"}], "owner": {"reputation": 1225, "user_id": 2357712, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/aee103cdb9ad3af1b87a07378b60988c?s=128&d=identicon&r=PG", "display_name": "Maxcot", "link": "https://stackoverflow.com/users/2357712/maxcot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548202479, "creation_date": 1548201751, "last_edit_date": 1548202479, "question_id": 54318216, "link": "https://stackoverflow.com/questions/54318216/how-can-i-iterate-through-all-the-properties-of-a-microsoft-project-task", "title": "How can I iterate through all the properties of a Microsoft Project Task?", "body": "<p>MS Project has a task Object, with literally hundreds of properties. Example, start date, end date, baseline1Start through to Baseline10Start, and so on. </p>\n\n<p>My pseudo code would be </p>\n\n<pre><code>dim tsk as Task\nset tsk = MSProj.ActiveProject.Tasks.Item(1)\n\nFor Each taskPropertyin tsk.properties. \n     debug.print taskproperty\nNext taskProperty\n</code></pre>\n\n<p>... but I cannot find a collection of task properties. They seem to all be explicitly named, and I would have to refer to each of them individually. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/51144134/loop-through-all-tablefields-in-microsoft-project-add-to-combobox\">Loop through all TableFields in Microsoft Project add to combobox</a></p>\n\n<p>This post reveals some of inner workings, but the it's limited to the properties / attributes that are visible only. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548253318, "post_id": 54318106, "comment_id": 95476561, "body": "thank you @Tim Williams.  I appreciate you sitting down to write out a solution to my question despite my lack of understanding of VBA.  I tested it but It doesn&#39;t seem to create any folder/subfolders in the target destination. Would you suggest I change my destination folder?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548259325, "post_id": 54318106, "comment_id": 95480257, "body": "What <i>does</i> it do?"}, {"owner": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548259455, "post_id": 54318106, "comment_id": 95480338, "body": "@  Tim Williams , When I hit the F8 button to test the macro it keeps looping over from top to bottom, with no folders or subfolders in the destination folders.   Also, the &quot;play button&quot; does not work. As in, when I try to run the macro, it does nothing."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548260106, "post_id": 54318106, "comment_id": 95480715, "body": "And you&#39;re selecting the full range of data before you run it?"}, {"owner": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548260489, "post_id": 54318106, "comment_id": 95480966, "body": "Oh! I didn&#39;t select the full range of data before running the code. I tried doing that and it returned an Error message:Run-time error &#39;53&#39;: File not found.  Highlighted line with error:   FileCopy SRC_FOLDER &amp; fName, fPath &amp; &quot;\\&quot; &amp; fName&quot;"}, {"owner": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548261967, "post_id": 54318106, "comment_id": 95481765, "body": "I changed the source path and noticed that there&#39;s an error with the line below now.  If Len(Dir(fPath, vbDirectory)) = 0 Then MkDir fPath"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548265925, "post_id": 54318106, "comment_id": 95483587, "body": "I&#39;m happy to help you get this working but you will need to be a bit more explicit than &quot;there&#39;s an error&quot; - what is the error message you get?  If you add <code>Debug.Print fPath</code> just before the line that errors what is the output (it will show up in the immediate pane of the VBeditor - Ctrl+G to show if not already visible)?"}, {"owner": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548266546, "post_id": 54318106, "comment_id": 95483883, "body": "It worked brilliantly. I had a file name that had &quot;/&quot; which is why it threw an error. You&#39;re awesome. Thank you so much for having helped me with this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "edited": false, "score": 0, "creation_date": 1548266580, "post_id": 54318106, "comment_id": 95483904, "body": "Good to hear you got it working"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1548201025, "creation_date": 1548201025, "answer_id": 54318106, "question_id": 54317815, "link": "https://stackoverflow.com/questions/54317815/vba-code-to-create-folders-and-subfolder-while-referencing-a-range-of-cells-from/54318106#54318106", "title": "VBA code to create folders and subfolder while referencing a range of cells from column B to D?", "body": "<p>Untested:</p>\n\n<pre><code>Sub Tester()\n\n    Const SRC_FOLDER = \"C:\\Users\\Manzurfa\\Desktop\\Macro Project\\Carlo Project\\Order Confirmations\\\"\n    Const DEST_FOLDER = \"C:\\Users\\Manzurfa\\Desktop\\Macros\"\n\n    Dim Rng As Range, fPath, fName\n    Dim maxRows As Long, maxCols As Long, r As Long, c As Long\n\n    Set Rng = Selection\n    maxRows = Rng.Rows.Count\n    maxCols = Rng.Columns.Count\n\n    'assuming the first row in ther selection is the headers...\n    '  otherwise, start at 1\n    For r = 2 To maxRows\n        fPath = DEST_FOLDER '&lt;&lt;set starting point\n        For c = 2 To maxCols\n            fPath = fPath &amp; \"\\\" &amp; Rng.Cells(r, c) '&lt;&lt;build next level\n            If Len(Dir(fPath, vbDirectory)) = 0 Then MkDir fPath\n        Next c\n        'create file name\n        fName = Right(\"0000000000\" &amp; Rng.Cells(r, 1).Value, 10) &amp; \".pdf\"\n        'copy to fpath\n        FileCopy SRC_FOLDER &amp; fName, fPath &amp; \"\\\" &amp; fName\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10919022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9d999c8818642d317f2884ecffa1f9?s=128&d=identicon&r=PG&f=1", "display_name": "fahadmanzur", "link": "https://stackoverflow.com/users/10919022/fahadmanzur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1548252726, "accepted_answer_id": 54318106, "answer_count": 1, "score": -2, "last_activity_date": 1548259129, "creation_date": 1548198834, "last_edit_date": 1548259129, "question_id": 54317815, "link": "https://stackoverflow.com/questions/54317815/vba-code-to-create-folders-and-subfolder-while-referencing-a-range-of-cells-from", "closed_reason": "Needs more focus", "title": "VBA code to create folders and subfolder while referencing a range of cells from column B to D?", "body": "<p>I have 4 columns of data within Excel that I'm trying to transform into a list of folders and sub folders. Column B will be the first list of primary folders, and each entry of column C will be a sub-folder and deeper into sub folder of column D in the corresponding folder from column B.</p>\n\n<p><strong>Column A</strong> comprises of <code>.pdf</code> files names stored in the source destinations that needs to be transferred into the last sub-folder of the target destination.</p>\n\n<p>Source &amp; target Directory:</p>\n\n<ul>\n<li>Source: <code>C:\\Users\\Manzurfa\\Desktop\\Macro Project\\Carlo Project\\Order Confirmations</code></li>\n<li>Target: <code>C:\\Users\\Manzurfa\\Desktop\\Macros</code></li>\n</ul>\n\n<p>Note: Source directory comprises of all the <code>.pdf</code> files. After all the folders and sub folders are create I would need the <code>.pdf</code> files transferred into the last sub folder mentioned in the target directory.</p>\n\n<pre><code>    A              B                       C                       D\nSales doc.        Sales Rep           Customer Name             Sold to\n536460575   Carolyn Coulter     A STEP AHEAD FOOTWEAR INC       108845\n536460718   Carolyn Coulter     A STEP AHEAD FOOTWEAR INC       108845\n536810226   Carolyn Coulter     A STEP AHEAD FOOTWEAR INC       108845\n538391188   Carolyn Coulter     A STEP AHEAD FOOTWEAR INC       108845\n536281822   Carolyn Coulter     ALPHA COMFORT SHOES INC         157808\n</code></pre>\n\n<hr>\n\n<pre><code>Sub MakeFolders()\n    Dim Rng As Range\n    Dim maxRows, maxCols, r, c As Integer\n    Set Rng = Selection\n\n    maxRows = Rng.Rows.Count\n    maxCols = Rng.Columns.Count\n\n    For c = 2 To maxCols\n        r = 2\n        Do While r &lt;= maxRows\n            If Len(Dir(ActiveWorkbook.Path &amp; \"\\\" &amp; Rng(r, c), vbDirectory)) = 0 Then\n                MkDir (ActiveWorkbook.Path &amp; \"\\\" &amp; Rng(r, c))\n                On Error Resume Next\n            End If\n            r = r + 1\n        Loop\n    Next c\nEnd Sub\n</code></pre>\n\n<p>Any help at would be immensely appreciated!</p>\n"}, {"tags": ["arrays", "excel", "vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "is_accepted": true, "score": 2, "last_activity_date": 1548268476, "last_edit_date": 1548268476, "creation_date": 1548201231, "answer_id": 54318140, "question_id": 54317798, "link": "https://stackoverflow.com/questions/54317798/userform-variable-scope-transfer-2d-array-values-from-userform2-to-userform1/54318140#54318140", "title": "UserForm variable scope: transfer 2D array values from userform2 to userform1", "body": "<p>Use a public function in a standard module (not in a userform) which takes an optional parameter (your 2D array). </p>\n\n<p>The parameter is then stored in the function as a <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/modifiers/static\" rel=\"nofollow noreferrer\">static variable</a>. The next time the function is called, if the parameter is missing, then return the stored static variable. Here is the example:</p>\n\n<pre><code>Public Function store2DArray(Optional my2DArray As Variant) As Variant\n    Static storedArray As Variant\n\n    If IsMissing(my2DArray) Then\n        store2DArray = storedArray\n    Else\n        storedArray = my2DArray\n    End If\nEnd Function\n</code></pre>\n\n<p>The usage would then be like this to store the array:</p>\n\n<pre><code>Sub Userform2Button1_Click()\n     store2DArray myArray\nEnd Sub\n</code></pre>\n\n<p>This is how you would retrieve the array:</p>\n\n<pre><code>Sub Userform1Button2_Click()\n    myArray = store2DArray\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10952680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d11346a57996fed09dbaea34846096?s=128&d=identicon&r=PG&f=1", "display_name": "M Nikita", "link": "https://stackoverflow.com/users/10952680/m-nikita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 54318140, "answer_count": 1, "score": 2, "last_activity_date": 1556149028, "creation_date": 1548198734, "last_edit_date": 1556149028, "question_id": 54317798, "link": "https://stackoverflow.com/questions/54317798/userform-variable-scope-transfer-2d-array-values-from-userform2-to-userform1", "title": "UserForm variable scope: transfer 2D array values from userform2 to userform1", "body": "<p>I have a problem transferring a 2D array between two userforms.</p>\n\n<p>When I click on a <em>CommandButton</em> in <code>userform1</code>, it will open <code>userform2</code>. Then I click on <em>CommandButton</em> in <code>userform2</code> for creating a 2D array. After this I terminate <code>userform2</code> and want to transfer my 2D array into <code>userform1</code>.</p>\n\n<p>My best try is calling a function in <code>userform1</code> click event. I put this function into the <code>userform2</code> module. But my <code>userform2</code>'s function doesn't see 2D array from another subs in <code>userform2</code>. <code>Private Sub userform_terminate()</code> can see this 2D-array which was created in <code>Private Sub CommandButton1_Click()</code> but my function doesn't.</p>\n\n<p>userform1:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    dim results()     \n    results = userform2.get2dArray()\nEnd Sub\n</code></pre>\n\n<p>userform2:</p>\n\n<pre><code>Private myArray()\n\nPrivate Sub CommandButton1_Click()\n    ReDim myArray(1 To 2, 1 To 2)\n    myArray(1, 1) = \"arg1\"\n    myArray(2, 1) = \"arg2\"\n    myArray(1, 2) = \"arg3\"\n    myArray(2, 2) = \"arg4\"\nEnd Sub\n\nPrivate Sub userform_terminate() \n   'here i can see every args in myArray\n   ...\nend sub\n\nFunction get2dArray() \n    'that function I called from userform1\n\n    userform2.show vbModal\n    get2dArray = myArray 'but myArray is empty\nEnd Function\n</code></pre>\n\n<p>I want to transfer <code>myArray</code> from <code>userform2</code> back to the main form <code>userform1</code>.</p>\n\n<p>The main problem is <code>userform2.get2dArray</code> doesn't see the private variable <code>myArray</code> in <code>userform2</code> module.</p>\n\n<p>Making <code>myArray</code> global is also impossible.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "edited": false, "score": 0, "creation_date": 1548199249, "post_id": 54317440, "comment_id": 95455539, "body": "I tried to edit the code as follows but still not getting the result I want"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "edited": false, "score": 0, "creation_date": 1548201704, "post_id": 54318050, "comment_id": 95456214, "body": "Thanks for the response. I get a runtime error &quot;PasteSpecial Method of range class failed&quot;. I have a formula in the (data)sheet on different columns could that affect it? they are in columns G,H, and I"}, {"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "reply_to_user": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "edited": false, "score": 0, "creation_date": 1548268318, "post_id": 54318050, "comment_id": 95484727, "body": "Sorry about that. I fixed the answer. Looks like Excel didn&#39;t want to paste it to a specific range, so this will first select the range, then use the built-in paste function."}], "tags": [], "owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "is_accepted": false, "score": 0, "last_activity_date": 1548270127, "last_edit_date": 1548270127, "creation_date": 1548200553, "answer_id": 54318050, "question_id": 54317440, "link": "https://stackoverflow.com/questions/54317440/new-to-excel-and-need-some-help-to-copy-data-to-a-new-sheet-and-keep-it-going/54318050#54318050", "title": "New to excel and need some help to copy data to a new sheet and keep it going", "body": "<p>This will cut the data from the Receive Tracker (A6:D6 and down) and paste it into the Data at the bottom (appending data to the bottom). <strong>It does not rely on data being in A1</strong></p>\n\n<pre><code>Sub CopyPasteClear()\nDim cutRange As Range, pasteRange As Range\nDim shData As Worksheet\nDim shReceive As Worksheet\n\n'You can adjust the names of the worksheets\n'here, if needed\nSet shData = Worksheets(\"Data\")\nSet shReceive = Worksheets(\"Receive Tracker\")\n\n'get the ranges we need to cut and paste\nSet cutRange = shReceive.Range(\"A6:D\" &amp; shReceive.UsedRange.Rows.Count + 6)\nSet pasteRange = shData.UsedRange.Cells(shData.UsedRange.Rows.Count, 1).Offset(1, 0).Resize(cutRange.Rows.Count, cutRange.Columns.Count)\n\n'cut and paste\ncutRange.Cut pasteRange\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "edited": false, "score": 0, "creation_date": 1548251885, "post_id": 54319258, "comment_id": 95475730, "body": "Thanks VBasic. It took me a few mins to get it to run without a runtime error. I had to have data in A1 on my data sheet so I just put the title of the sheet on there as a header and it all worked out apricate the help from you both!"}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "edited": false, "score": 0, "creation_date": 1548290202, "post_id": 54319258, "comment_id": 95492540, "body": "@Scott: Many thanks for the feedback. It is a true mistake of mine. I&#39;m sorry for the inconvenience. The error must have occurred in the line <b>LastRtgt = .Columns(cCol1).Find(&quot;*&quot;, , -4123, , 2, 2).Row</b>, where the row could not have been calculated because the range was <b>Nothing</b> due to no data in column A. I wrongly assumed that you would have headers in Target Worksheet. I&#39;ll fix it ASAP. You should download my workbook which contains a nice functionality with buttons so you could practically see what  my assumptions were."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "edited": false, "score": 0, "creation_date": 1548291478, "post_id": 54319258, "comment_id": 95492771, "body": "@Scott: Added the <b>If Not...End If code block</b>. Now you can have a <b>blank worksheet</b> as the Target Worksheet."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1548291270, "last_edit_date": 1548291270, "creation_date": 1548211006, "answer_id": 54319258, "question_id": 54317440, "link": "https://stackoverflow.com/questions/54317440/new-to-excel-and-need-some-help-to-copy-data-to-a-new-sheet-and-keep-it-going/54319258#54319258", "title": "New to excel and need some help to copy data to a new sheet and keep it going", "body": "<h1>Copy Paste Clear</h1>\n\n<h2>Links</h2>\n\n<p><a href=\"https://www.dropbox.com/s/gdtdq2cvrrkdvpw/new-to-excel-and-need-some-help-to-copy-data-to-a-new-sheet-and-keep-it-going_54317440.xls?dl=0\" rel=\"nofollow noreferrer\">Workbook Download (Dropbox)</a></p>\n\n<h2>The Code</h2>\n\n<pre><code>Sub CopyPasteClear()\n\n    'Source\n    Const cSource As String = \"Recieve Tracker\"   ' Worksheet Name\n    Const cFirstRsrc As Long = 6                  ' First Row Number\n    Const cClr As String = \"B6,D6\"                ' Clear Cells\n    Const cRowClr As Long = 8                     ' First Clear Row\n    Const cFinal As String = \"G12\"                ' Final Select Cell Address\n    ' Target\n    Const cTarget As String = \"Data\"              ' Worksheet Name\n    ' Both\n    Const cCol1 As Variant = \"A\"                  ' First Column Letter/Number\n    Const cCol2 As Variant = \"D\"                  ' Second Column Letter/Number\n\n    Dim vntVal As Variant   ' Value Array\n    Dim LastRsrc As Long    ' Source Last Row Number\n    Dim LastRtgt As Long    ' Target Last Row Number\n\n    ' Source Range into Source Array\n    With ThisWorkbook.Worksheets(cSource)\n        ' Calculate Source Last Row Number of First Column.\n        LastRsrc = .Columns(cCol1).Find(\"*\", , -4123, , 2, 2).Row\n        ' Prevent copying data above First Row. Rows from First Row to\n        ' one less than First Clear Row will still be copied. To prevent this,\n        ' change cFirstRsrc to cRowClr in the following line only.\n        If LastRsrc &lt; cFirstRsrc Then Exit Sub\n        ' Copy Source Range into Source Array\n        vntVal = .Range(.Cells(cFirstRsrc, cCol1), .Cells(LastRsrc, cCol2))\n    End With\n\n    ' Source Array into Target Range\n    With ThisWorkbook.Worksheets(cTarget)\n        ' Check if First Column in Target Worksheet does contain a value.\n        If Not .Columns(cCol1).Find(\"*\", .Cells(.Rows.Count, _\n                .Columns.Count), -4123, , 2) Is Nothing Then ' Found.\n            ' Calculate Target Last Row Number of First Column.\n            LastRtgt = .Columns(cCol1).Find(\"*\", , -4123, , 2, 2).Row\n          Else  ' Not found.\n            LastRtgt = 0 ' Because 1 will be added in the next line of the code.\n        End If\n        ' Copy Source Array into Target Range. Note that Target Last Row\n        ' Number has to be inreased by 1 to get the first empty row.\n        .Cells(LastRtgt + 1, cCol1) _\n                .Resize(UBound(vntVal), UBound(vntVal, 2)) = vntVal\n    End With\n\n    With ThisWorkbook.Worksheets(cSource)\n        ' Prevent deleting data above First Clear Row.\n        If LastRsrc &lt; cRowClr Then Exit Sub\n        ' Clear contents of Clear Cells and modified Source Range.\n        Union(.Range(cClr), .Range(.Cells(cRowClr, cCol1), _\n                .Cells(LastRsrc, cCol2))).ClearContents\n        ' Activate Source Worksheet if it is not active (not the ActiveSheet).\n        ' The following Select method will produce an error if the program\n        ' was started while a different worksheet than the Source Worksheet\n        ' was active.\n        If .Parent.ActiveSheet.Name &lt;&gt; .Name Then\n            .Activate\n        End If\n        ' Select Final Select Cell.\n        .Range(cFinal).Select\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10952535, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jeu1Vyytzao/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaBjUxj41QG96752nQYDZsXiz6q4g/mo/photo.jpg?sz=128", "display_name": "Scott", "link": "https://stackoverflow.com/users/10952535/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54319258, "answer_count": 2, "score": 1, "last_activity_date": 1548291270, "creation_date": 1548196470, "last_edit_date": 1548202809, "question_id": 54317440, "link": "https://stackoverflow.com/questions/54317440/new-to-excel-and-need-some-help-to-copy-data-to-a-new-sheet-and-keep-it-going", "title": "New to excel and need some help to copy data to a new sheet and keep it going", "body": "<p>I am new to VBA and not sure how I need to go about doing what I want. I am trying to collect certain data from one sheet(Receive Tracker) to another sheet(data) and than clear the contents of my Receiver Tracker Sheet. How do I keep the data and not overwrite? Also sometimes data will need to go beyond A:16-D:16 on the Receive Tracker what's the best way to go about just pulling everything from A:6-D:6 and below? </p>\n\n<pre><code>Sub CopyPasteClear()\n'\n' CopyPasteClear Macro\n'\n\n'\n    Range(\"A6:D16\").Select\n    Selection.Copy\n    Sheets(\"data\").Select\n    Range(\"A:A\").Select\n    ActiveSheet.Paste\n    Sheets(\"Recieve Tracker\").Select\n    Range(\"B6\").Select\n    Application.CutCopyMode = False\n    Selection.ClearContents\n    Range(\"D6\").Select\n    Selection.ClearContents\n    Range(\"A8:D16\").Select\n    Selection.ClearContents\n    Range(\"G12\").Select\nEnd Sub\n</code></pre>\n\n<p>******EDIT\nI tried to edit the code as follows but still not getting the result I want\n    Sub CopyPasteClear()\n    '\n    ' CopyPasteClear Macro\n    '</p>\n\n<pre><code>'\nRange(\"A6:D1000\").Select\nSelection.Copy\nSheets(\"data\").Select\nlastrow = Sheets(\"data\").Cells(Rows.Count, \"A\").End(xlUp).Row\nRange(\"A:A\").Select\nActiveSheet.Paste Destination:=Worksheets(\"data\").Range(\"A\" &amp; lastrow)\n\nSheets(\"Recieve Tracker\").Select\nRange(\"B6\").Select\nApplication.CutCopyMode = False\nSelection.ClearContents\nRange(\"D6\").Select\nSelection.ClearContents\nRange(\"A8:D16\").Select\nSelection.ClearContents\nRange(\"G12\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548196965, "post_id": 54317010, "comment_id": 95454863, "body": "I am not completely sure I understand your goal, but I see a possible error here. Try changing range_data in your For Each statement to range_data.cells (same with other_range). That will loop through each cell in the range. Your other method wasn&#39;t looping through anything. (Try a line-break to double check that)"}, {"owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "reply_to_user": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "edited": false, "score": 0, "creation_date": 1548198809, "post_id": 54317010, "comment_id": 95455423, "body": "Thanks for the reply, the code seems to return the same answers with your suggested change. It is difficult to explain but I want to only loop through only some columns in the range &quot;other_range&quot;, not all of them. And the ones I want to loop through are the ones that meet the criteria of being smaller than the variable &quot;weeksOut&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "edited": false, "score": 0, "creation_date": 1548200215, "post_id": 54317782, "comment_id": 95455800, "body": "Yay your code is working perfectly, thank you so much!"}, {"owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "edited": false, "score": 0, "creation_date": 1548203031, "post_id": 54317782, "comment_id": 95456541, "body": "I added an If statement to the last For loop and the calculation is all working. But on when something on the workbook is changed the output of keeps reverting to 0 or not updating. Do you know why?"}], "tags": [], "owner": {"reputation": 176, "user_id": 8205642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d046f5a47794d15086a50a05a8283de3?s=128&d=identicon&r=PG&f=1", "display_name": "HMVBA", "link": "https://stackoverflow.com/users/8205642/hmvba"}, "is_accepted": true, "score": 2, "last_activity_date": 1548198656, "creation_date": 1548198656, "answer_id": 54317782, "question_id": 54317010, "link": "https://stackoverflow.com/questions/54317010/how-to-loop-through-cells-in-a-section-of-columns-within-a-range/54317782#54317782", "title": "How to loop through cells in a section of columns within a range?", "body": "<p>Based on your question, I have understood the following steps:</p>\n\n<ol>\n<li>Go through cells E4 to W4 and check the cell value</li>\n<li>If the cell value is less than or equal to the week number, then loop through that column rows 6 to 45</li>\n<li>Do something with the cell (maybe count it? this step isn't clear in your question. It looks like you know how to count what you want, you just need to know how to do steps 1 and 2 first)</li>\n</ol>\n\n<p>So, I have written a small function which should accomplish this task.  It returns the error description if it fails. Just plug in whatever it is you are counting.</p>\n\n<pre><code>Function ColumnLooper(iWeekNum As Long) As Variant\n    On Error GoTo errHandler\n\n    'declarations\n    Dim iCol As Long, iRow As Long\n    Dim myRange As Range\n\n    'initial cell, (top left)\n    Set myRange = Range(\"E4\")\n\n    'Check week number\n    'by looping through cells E4:W4\n    For iCol = 0 To 18\n        'Check if the cell value is less than or equal to\n        'the week number\n        If myRange.Offset(0, iCol).Value &lt;= iWeekNum Then\n            'Loop through the corresponding column\n            'if the above statement is true (You could\n            'also do anything else here)\n            For iRow = 2 To 41\n                'Do whatever you want here...\n                'if you want to reference the specific\n                'cell, use myRange.Offset(iRow, iCol)\n\n            Next iRow\n        End If\n    Next iCol\n\nExit Function\nerrHandler:\n    'return error\n    ColumnLooper = Err.Description\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10952425, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-156RpY-p7SU/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbwgTkKHPD5CkNAB6lh8nPgmL227w/mo/photo.jpg?sz=128", "display_name": "m.rainey", "link": "https://stackoverflow.com/users/10952425/m-rainey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 54317782, "answer_count": 1, "score": 0, "last_activity_date": 1548227349, "creation_date": 1548194028, "last_edit_date": 1548227349, "question_id": 54317010, "link": "https://stackoverflow.com/questions/54317010/how-to-loop-through-cells-in-a-section-of-columns-within-a-range", "title": "How to loop through cells in a section of columns within a range?", "body": "<p>I'm trying to create a planning schedule on Excel. In one sheet there is a section of cells E6:W45 that have the data I wish to loop through. Some cells in this section are populated and some aren't, and I am just checking to see if they do have something in them. </p>\n\n<p>I have managed to do this to calculate the \"actual\" percentage completed. However, now I am trying to calculate the \"planned\" percentage complete. To do this I need to first look at the range E4:W4 as each cell in this has a number showing what week it is. For each cell in this range that is less than or equal to what the actual week number is I then want to then loop through cells in the corrosponding columns in other range E6:E45.</p>\n\n<p>E.g. if it is currently week 10. The first thing that will happen is week 10, week 11, week 12... and so on up to week 16 are counted as they have past. Then in the other range I want to loop through ONLY the cells in those columns that were first counted. Does anyone know how I could do this, I have tried lots of things but they dont work. </p>\n\n<p>I think I may need to manually create a new range from outputs in the function. However, I am not sure how to do this. </p>\n\n<pre><code>Function CalcTarget1(range_data As Range, other_range As Range, weeksOut As Integer)\n\n    Dim cell As Range\n    Dim col As Range\n    Dim c As Range\n\n    Dim count As Double\n    Dim sum As Double\n    Dim box As Double\n\n    For Each cell In range_data\n        If cell.Style = \"Style 1\" Then\n            count = count + 1\n        End If\n    Next cell\n\n    If count &gt; 0 Then\n        sum = 100 / count\n    Else\n        sum = 0\n    End If\n\n    For Each col In range_data\n            If col.Value &gt; weeksOut Then\n                For Each c In other_range\n                    If c.Style = \"Style 1\" Then\n                          box = box + 1\n                     End If\n                Next c\n        End If\n    Next col\n\n    CalcTarget1 = Round(sum, 1) * box &amp; \"%\"\n\nEnd Function\n</code></pre>\n\n<p>This code isn't working right as it returns 0%</p>\n\n<p>Thank you for the time.</p>\n"}, {"tags": ["excel", "vba", "class", "add"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548194030, "post_id": 54316757, "comment_id": 95453902, "body": "Change the line that says <code>Public Property Let resultXLS(ByVal resultXLS As Workbook)</code> to <code>Public Property Set resultXLS(ByVal resultXLS As Workbook)</code> and it should work."}, {"owner": {"reputation": 13, "user_id": 10946222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/llILx.png?s=128&g=1", "display_name": "Mounty6961", "link": "https://stackoverflow.com/users/10946222/mounty6961"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548195708, "post_id": 54316757, "comment_id": 95454474, "body": "Unfortunately this does not solve it. I used Let and Get so far for encapsulation of all class members (as i learned it from web) and it works. I just tested your approach. The result (error 91) is unfortunately the same as before."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548196217, "post_id": 54316757, "comment_id": 95454602, "body": "Oops... change it to <code>Public Property Set resultXLS(ByRef resultXLS As Workbook)</code>."}, {"owner": {"reputation": 13, "user_id": 10946222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/llILx.png?s=128&g=1", "display_name": "Mounty6961", "link": "https://stackoverflow.com/users/10946222/mounty6961"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1548197779, "post_id": 54316757, "comment_id": 95455119, "body": "Sorry, I tried my best but still get the same error. What I saw in my investigations is that there must be a problem in asign the new workbook to the class variable. But I had no idea how to solve it."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10946222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/llILx.png?s=128&g=1", "display_name": "Mounty6961", "link": "https://stackoverflow.com/users/10946222/mounty6961"}, "edited": false, "score": 0, "creation_date": 1548233407, "post_id": 54320248, "comment_id": 95465168, "body": "I have taken it into my environment, tested it and it works. You saved me so much time!"}], "tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": true, "score": 0, "last_activity_date": 1548219327, "creation_date": 1548219327, "answer_id": 54320248, "question_id": 54316757, "link": "https://stackoverflow.com/questions/54316757/workbooks-add-with-workbook-in-class/54320248#54320248", "title": "Workbooks.Add with Workbook in Class", "body": "<p>Here is the class module that works and the main code that works. Please see the following code:</p>\n\n<pre><code>    Option Explicit\n\n    Private resWrkBook As Workbook         'resultXLS - Result workbook\n\n    'Properties\n    Public Property Set resultXLS(ByVal resultXLS As Workbook)   'Write value to class variable\n        Set resWrkBook = resultXLS                                               'Assign value to property\n    End Property\n\n    Public Property Get resultXLS() As Workbook     'Read value from class variable\n        Set resultXLS = resWrkBook                  'Return value from property\n    End Property\n</code></pre>\n\n<p>And now, the calling code which needs to change (notice the NEW keyword):</p>\n\n<pre><code>    Public Sub main()\n        Dim wbs As XlsClass_Module          'declaration\n\n        Set wbs = New XlsClass_Module\n\n        'Short (version S)\n        Set wbs.resultXLS = Workbooks.Add    '=&gt; Error 91\n\n        'Long (version L, alternative)\n        Dim wrk As Workbook\n        Set wbs = New XlsClass_Module       'instance of Workbook Class\n        Set wrk = Workbooks.Add\n        Set wbs.resultXLS = wrk                 '=&gt; Error 91\n    End Sub\n</code></pre>\n\n<p>Also, for the variables that you use SET on you need to set them to nothing so that you free up memory:</p>\n\n<p>EX: <code>set wbs = Nothing</code></p>\n"}], "owner": {"reputation": 13, "user_id": 10946222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/llILx.png?s=128&g=1", "display_name": "Mounty6961", "link": "https://stackoverflow.com/users/10946222/mounty6961"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 54320248, "answer_count": 1, "score": 0, "last_activity_date": 1548227341, "creation_date": 1548192796, "last_edit_date": 1548227341, "question_id": 54316757, "link": "https://stackoverflow.com/questions/54316757/workbooks-add-with-workbook-in-class", "title": "Workbooks.Add with Workbook in Class", "body": "<h2>1.Intro</h2>\n\n<p>This is my first VBA project and my first post. So please forgive me, if \u2026\nIt tried everything I could find on the web and I could think of for some days now and finally gave up.\nI did several class implementations in the way I understood the web recommendations. Unfortunately this one (but the others) does not work. If I give up the data encapsulation using PRIVATE it would work, but seems to be not clean programming.\nI copied the essential part of the code below. This should be enough to reproduce the error (91).\nI hope that someone knows some magic characters. I guess it is not much.</p>\n\n<p>Thanks in advance,\nMounty</p>\n\n<h2>2. Infrastructure</h2>\n\n<p>PC: Win7Enterprise-64 SP1, Excel 365 ProPlus-32 (1808)</p>\n\n<h2>3. Code</h2>\n\n<p>Class Module</p>\n\n<pre><code>Option Explicit\nPrivate resWrkBook As Workbook         'resultXLS - Result workbook\n\n\u2018Properties\nPublic Property Let resultXLS(ByVal resultXLS As Workbook)    'Write value to class variable\n    Set resWrkBook = resultXLS                                               'Assign value to property\nEnd Property\n\nPublic Property Get resultXLS() As Workbook     'Read value from class variable\n    Set resultXLS = resWrkBook                  'Return value from property\nEnd Property\n</code></pre>\n\n<p>Programming Module</p>\n\n<pre><code>Option Explicit\n\nPublic Sub main()\n    Dim wbs As XlsClass_Module         'declaration\n\n    \u2018Short (version S)\n    Set wbs.resultXLS = Workbooks.Add    '=&gt; Error 91\n\n    \u2018Long (version L, alternative)\n    Dim wrk As Workbook\n    Set wbs = New XlsClass_Module       'instance of Workbook Class\n    Set wrk = Workbooks.Add\n    Set wbs.resultXLS = wrk                 '=&gt; Error 91\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548193068, "post_id": 54316739, "comment_id": 95453516, "body": "Which line is the error?"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1548193276, "post_id": 54316739, "comment_id": 95453604, "body": "error starts on this line     <code>strFile = Application.GetOpenFilename(&quot;Text Files (*.PRN),*.PRN&quot;, , &quot;Please select text file...&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1548260612, "post_id": 54317789, "comment_id": 95481047, "body": "Worked like a charm. Thanks for your help!!"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1548198692, "creation_date": 1548198692, "answer_id": 54317789, "question_id": 54316739, "link": "https://stackoverflow.com/questions/54316739/open-excel-file-to-import-data-to-that-file-using-outlook-vba/54317789#54317789", "title": "Open Excel file, to import data to that file, using Outlook VBA", "body": "<p>Your host application is Outlook while GetOpenFilename() is an Excel Application function</p>\n\n<p>So call it via Excel application object:</p>\n\n<pre><code>strFile = xlApp.GetOpenFilename(\"Text Files (*.PRN),*.PRN\", , \"Please select text file...\")\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 54317789, "answer_count": 1, "score": 0, "last_activity_date": 1595893881, "creation_date": 1548192705, "last_edit_date": 1595893881, "question_id": 54316739, "link": "https://stackoverflow.com/questions/54316739/open-excel-file-to-import-data-to-that-file-using-outlook-vba", "title": "Open Excel file, to import data to that file, using Outlook VBA", "body": "<p>I'm trying to set up the following process.</p>\n<p>When I open Outlook in the morning it will look in a network folder. If the file in that folder does not have today's date as a save date open the file and import data from a chosen path then save it.</p>\n<p>It will open Excel but it errors on <code>strFile = Application.GetOpenFilename(&quot;Text Files (*.PRN),*.PRN&quot;, , &quot;Please select text file...&quot;)</code>.</p>\n<blockquote>\n<p>&quot;Object doesn't Support this property or Method&quot;</p>\n</blockquote>\n<pre><code>Sub Application_Startup()\n\n   Dim xlApp As Excel.Application\n   Dim sourceWB As Excel.Workbook\n   Dim sourceSH As Excel.Worksheet\n   Dim oXL As Excel.Application\n   Dim oWB As Excel.Workbook\n\n 'Check if file doesn't have today's date (need to write code)\n\n  Set xlApp = New Excel.Application\n      With xlApp\n      .Visible = True\n      .EnableEvents = True\n      '.UserControl = True\n      '.DisplayAlerts = True\n      '.AskToUpdateLinks = True\n    End With\n\n strFile = &quot;S:\\NFInventory\\groups\\CID\\CID Database\\BigPic Files\\BigPic 2019.xlsx&quot;\n\n'Import process (Error starts next line)\n strFile = Application.GetOpenFilename(&quot;Text Files (*.PRN),*.PRN&quot;, , &quot;Please select text file...&quot;)\n\nWith wb.QueryTables.Add(Connection:=&quot;TEXT;&quot; &amp; strFile, Destination:=ws.Range(&quot;A1&quot;))\n    .TextFileParseType = xlDelimited\n    .TextFileCommaDelimiter = True\n    .Refresh\nEnd With\n\n 'open File\n  Set sourceWB = xlApp.Workbooks.Open(strFile, , , , , , , , , True)\n  Set sourceSH = sourceWB.Worksheets(&quot;Sheet1&quot;)\n  sourceWB.Activate\n\n 'Save and Close\n     'Workbooks(&quot;BigPic 2019.xlsx&quot;).Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10952423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22b4d2690fc94010b1a8872b5515146?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Campbell", "link": "https://stackoverflow.com/users/10952423/lee-campbell"}, "edited": false, "score": 0, "creation_date": 1548366588, "post_id": 54319182, "comment_id": 95526818, "body": "Thank you!! This is exactly what we were needing. Much appreciated."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1548212102, "last_edit_date": 1548212102, "creation_date": 1548210166, "answer_id": 54319182, "question_id": 54316554, "link": "https://stackoverflow.com/questions/54316554/how-to-highlight-multiple-duplicate-columns-with-varying-colors/54319182#54319182", "title": "How to highlight multiple duplicate columns with varying colors?", "body": "<p>if my understanding of your requirement is as follows \n<a href=\"https://i.stack.imgur.com/t1v6b.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t1v6b.jpg\" alt=\"enter image description here\"></a>\nThen may try</p>\n\n<pre><code> Sub ColorCompanyDuplicates()\n'Updateby Extendoffice 20160704\n    Dim xRg As Range\n    Dim xRng1 As Range\n    Dim xRng2 As Range\n    Dim xTxt As String\n    Dim xCIndex As Long\n    Dim Ws As Worksheet\n    Dim I As Long, I2 As Long, FirstRow As Long, FirstCol As Long, LastRow As Long, LastCol As Long\n    Dim MatchTrue As Boolean, MatchCount As Long\n\n    Set Ws = ThisWorkbook.ActiveSheet\n    With Ws\n\n        If Selection.Count &gt; 1 Then\n        xTxt = Selection.AddressLocal\n        Else\n        xTxt = .UsedRange.AddressLocal\n        End If\n\n    xTxt = InputBox(\"please select the data range:\", \"Kutools for Excel\", xTxt)\n\n    On Error Resume Next\n    Set xRg = .Range(xTxt)\n    On Error GoTo 0\n\n    If xRg Is Nothing Then Exit Sub\n    xRg.Interior.ColorIndex = xlNone\n    FirstRow = xRg.Row\n    FirstCol = xRg.Column\n\n    LastRow = FirstRow + xRg.Rows.Count - 1\n    LastCol = FirstCol + xRg.Columns.Count - 1\n\n    xCIndex = 2\n    For I = FirstCol To LastCol\n    'skips already re-colored columns\n    If .Cells(FirstRow, I).Interior.ColorIndex = xlNone Then\n    MatchCount = 0\n        For I2 = I + 1 To LastCol\n        MatchTrue = True\n            For I3 = FirstRow To LastRow\n                If .Cells(I3, I).Value &lt;&gt; .Cells(I3, I2).Value Then\n                MatchTrue = False\n                Exit For\n                End If\n            Next I3\n\n            If MatchTrue Then\n            MatchCount = MatchCount + 1\n                If MatchCount = 1 Then\n                xCIndex = xCIndex + 1\n                .Range(.Cells(FirstRow, I), .Cells(LastRow, I)).Interior.ColorIndex = xCIndex\n                End If\n            .Range(.Cells(FirstRow, I2), .Cells(LastRow, I2)).Interior.ColorIndex = xCIndex\n            End If\n        Next I2\n\n        If MatchCount &gt; 0 Then\n        'may remove the msgbox to avoid interruptions\n        MsgBox MatchCount &amp; \" duplicate companies found!\", vbCritical, \"Kutools for Excel\"\n        End If\n     End If\n     Next I\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10952423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22b4d2690fc94010b1a8872b5515146?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Campbell", "link": "https://stackoverflow.com/users/10952423/lee-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1548212102, "creation_date": 1548191757, "last_edit_date": 1548201800, "question_id": 54316554, "link": "https://stackoverflow.com/questions/54316554/how-to-highlight-multiple-duplicate-columns-with-varying-colors", "title": "How to highlight multiple duplicate columns with varying colors?", "body": "<p>I have 23 columns of data and have been tasked with highlighting (with different colors) the columns that are duplicates. </p>\n\n<p>For example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/gPSON.png\" alt=\"Screenshot of example data\"></p>\n\n<p>In the above example, Col A and C would be highlighted one color, while Col B and D would be highlighted another. I have tried editing the below code (only highlights duplicate values WITHIN the same column) to accomplish what I am after, but to no avail. </p>\n\n<pre><code>Sub ColorCompanyDuplicates()\n'Updateby Extendoffice 20160704\n    Dim xRg As Range\n    Dim xTxt As String\n    Dim xCell As Range\n    Dim xChar As String\n    Dim xCellPre As Range\n    Dim xCIndex As Long\n    Dim xCol As Collection\n    Dim I As Long\n    On Error Resume Next\n    If ActiveWindow.RangeSelection.Count &gt; 1 Then\n      xTxt = ActiveWindow.RangeSelection.AddressLocal\n    Else\n      xTxt = ActiveSheet.UsedRange.AddressLocal\n    End If\n    Set xRg = Application.InputBox(\"please select the data range:\", \"Kutools for Excel\", xTxt, , , , , 8)\n    If xRg Is Nothing Then Exit Sub\n    xCIndex = 2\n    Set xCol = New Collection\n    For Each xCell In xRg\n      On Error Resume Next\n      xCol.Add xCell, xCell.Text\n      If Err.Number = 457 Then\n        xCIndex = xCIndex + 1\n        Set xCellPre = xCol(xCell.Text)\n        If xCellPre.Interior.ColorIndex = xlNone Then xCellPre.Interior.ColorIndex = xCIndex\n        xCell.Interior.ColorIndex = xCellPre.Interior.ColorIndex\n      ElseIf Err.Number = 9 Then\n        MsgBox \"Too many duplicate companies!\", vbCritical, \"Kutools for Excel\"\n        Exit Sub\n      End If\n      On Error GoTo 0\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1548194124, "post_id": 54316521, "comment_id": 95453943, "body": "Where does this <b>Range(&quot;BurnData[[#Headers],[est_po_place]]&quot;)</b> point to in the document?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1548202548, "post_id": 54316521, "comment_id": 95456444, "body": "I&#39;m guessing this has to do with your headers being included in your text to columns. Perhaps try starting on Range(&quot;EN3&quot;)?"}, {"owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 0, "creation_date": 1548264780, "post_id": 54316521, "comment_id": 95483093, "body": "That doesn&#39;t work. I have tried so many ways to fix this issue, I am nearly just done with it all and resigning myself to handling it manually after the fact. If I put EN3, it jumps up 2 rows, so I tried to put in EN1 and it worked kinda. The data has blanks at some points in it, meaning the xlDown only goes to the next piece of data.   The overall problem with all of this is I was using Columns(&quot;EN:EN&quot;).Select instead. But this causes the table to be extended down thousands of rows, randomly. Sometimes 50k, sometimes 100k+. Then I have to resize the table and delete data EVERY TIME."}, {"owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 0, "creation_date": 1548264866, "post_id": 54316521, "comment_id": 95483126, "body": "I tried to keep that code but find new code to just resize the table, nothing I found would work. No errors, just nothing happens. Then I tried to delete all rows below the last cell in a particular column. No effect. No errors, just nothing happened. I have no idea anymore.  I don&#39;t necessarily care about my code being all short and neat and tidy. I&#39;d much rather it just -work- first. I&#39;ll worry about it being efficient later."}, {"owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 0, "creation_date": 1548274011, "post_id": 54316521, "comment_id": 95487184, "body": "And VBasic2008, BurnData is the worksheet I am on testing this. est_po_place is the name of the header that has dates under it. This macro converts the dates to a Short Date form i need for other formulas."}, {"owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "edited": false, "score": 0, "creation_date": 1548348442, "post_id": 54316521, "comment_id": 95518516, "body": "Just FYI, I indirectly fixed this entire issue by using the EN1 option above then adding code to delete all blank rows (some formula fields have like #ref! in them but most are blank) below my data based around a column that always has something in every cell. This way it deletes all superfluous rows, cells and deleting the rows in a table shortens said table. TBH I half-expected Excel to maintain table size even after deleting rows involving it."}], "owner": {"reputation": 3, "user_id": 10806959, "user_type": "registered", "profile_image": "https://graph.facebook.com/2207590169265747/picture?type=large", "display_name": "Boubamoo", "link": "https://stackoverflow.com/users/10806959/boubamoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548191611, "creation_date": 1548191611, "question_id": 54316521, "link": "https://stackoverflow.com/questions/54316521/excel-vba-texttocolumns-pushing-text-up-and-overwriting-header", "title": "Excel VBA TextToColumns pushing text up and overwriting header", "body": "<p>This code is a sliver of my main code so I know it is missing a line for, say, calling out the sheet, but I got that covered.</p>\n\n<p>I've narrowed down the problem to this but I don't understand excel enough to figure out -why-. I assume it has to do with the array but not sure. Basically, what happens is I run this and it takes the column of data and pushes it up 1 row, overwriting the header with the value in EN2. The last cell in the column doesn't go blank, but copies itself. It is like the last value is copied and pasted at the bottom but instead of overwriting the cell, pushes ALL the cell data up one row. Weird.</p>\n\n<pre><code>Sub RoutineTest()\nRange(Range(\"EN2\"), Range(\"EN2\").End(xlDown)).Select\n    Selection.TextToColumns Destination:=Range( _\n        \"BurnData[[#Headers],[est_po_place]]\"), DataType:=xlDelimited, TextQualifier _\n        :=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:= _\n        False, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(1, 3) _\n        , TrailingMinusNumbers:=True\nEnd Sub\n</code></pre>\n\n<p>Hope someone can help me figure out why.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548190604, "post_id": 54316294, "comment_id": 95452521, "body": "Can you put <code>Debug.Print rng.Offset(0, pIndex - 1)</code> before <code>xResult = xResult &amp; &quot;;&quot; &amp; rng.Offset(0, pIndex - 1)</code> and see what that&#39;s returning?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1548190829, "post_id": 54316294, "comment_id": 95452611, "body": "If you have Office 365: <code>=TEXTJOIN(&quot;;&quot;,TRUE,IF(A1:A1000=&quot;MyValue&quot;,D1:D1000,&quot;&quot;))</code> As an Array Formula with Ctrl-Shift-Enter"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548190919, "post_id": 54316294, "comment_id": 95452658, "body": "@dwirony it still has a bunch of ; after"}, {"owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548190951, "post_id": 54316294, "comment_id": 95452671, "body": "@scott craner where am I adding that?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548191025, "post_id": 54316294, "comment_id": 95452703, "body": "it is a formula that you add on the sheet changing the ranges to the desired input and output, it is not vba"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548191527, "post_id": 54316294, "comment_id": 95452916, "body": "@PaigeHilliard Forget my first comment - what range are you selecting for <code>pWorkRng</code>? It must contain ALOT of blank cells."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548191979, "post_id": 54316294, "comment_id": 95453104, "body": "try: <code>If rng = pValue And rng.Offset(0, pIndex - 1) &lt;&gt; &quot;&quot; Then</code> for your If and <code>MYVLOOKUP = Left(xResult,Len(xResult)-1)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1548193046, "post_id": 54316294, "comment_id": 95453508, "body": "@dwirony Good question. I&#39;m not sure how OP&#39;s code <i>can</i> result in a bunch of blank items, other than <code>pValue</code> being <code>&quot;&quot;</code>, or <code>On Error Resume Next</code> being specified (scrubbed for posting, I guess?) and <code>rng.Vaue</code> being e.g. <code>#N&#47;A</code> for all these values. Below answer dodges that bullet though."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1548190904, "creation_date": 1548190904, "answer_id": 54316383, "question_id": 54316294, "link": "https://stackoverflow.com/questions/54316294/how-to-vlookup-to-return-multiple-values-in-one-cell-in-excel/54316383#54316383", "title": "How To Vlookup To Return Multiple Values In One Cell In Excel?", "body": "<p>I'd work with an array for this. Start by sizing it to fit the entire source:</p>\n\n<pre><code>Dim results As Variant\nReDim results(1 To pWorkRng.Count)\n</code></pre>\n\n<p>Then maintain a counter for the index of the last item in that array, and write at that index:</p>\n\n<pre><code>Dim currentIndex As Long\n\nFor Each rng In pWorkRng\n    If Not IsError(rng.Value) Then\n        If rng.Value = pValue Then\n            currentIndex = currentIndex + 1\n            results(currentIndex) = rng.Offset(0, pIndex - 1)\n        End If\n    End If\nNext\n</code></pre>\n\n<p>When the loop completes, you'll have all the results up to <code>currentIndex</code>, and then a bunch of <code>Empty</code> values; truncate the array with <code>ReDim Preserve</code>:</p>\n\n<pre><code>ReDim Preserve results(1 To currentIndex)\n</code></pre>\n\n<p>And now you can return a string with all the results, using <code>String.Join</code>:</p>\n\n<pre><code>MYVLOOKUP = String.Join(results, \";\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 741, "user_id": 10938799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXg7z.png?s=128&g=1", "display_name": "IAmNerd2000", "link": "https://stackoverflow.com/users/10938799/iamnerd2000"}, "is_accepted": false, "score": 0, "last_activity_date": 1548220057, "creation_date": 1548220057, "answer_id": 54320348, "question_id": 54316294, "link": "https://stackoverflow.com/questions/54316294/how-to-vlookup-to-return-multiple-values-in-one-cell-in-excel/54320348#54320348", "title": "How To Vlookup To Return Multiple Values In One Cell In Excel?", "body": "<p>If Mathieu Guindons method doesn't work then, try to add the following to your code after the following line:</p>\n\n<p><code>xResult = xResult &amp; \";\" &amp; rng.Offset(0, pIndex - 1)</code></p>\n\n<pre><code>    Do While (InStr(xResult, \";;\") &gt; 0)\n        xResult = Replace(xResult, \";;\", \";\")\n    Loop\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 10918598, "user_type": "registered", "profile_image": "https://graph.facebook.com/2329969930369485/picture?type=large", "display_name": "Paige Hilliard", "link": "https://stackoverflow.com/users/10918598/paige-hilliard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548220057, "creation_date": 1548190412, "last_edit_date": 1548190616, "question_id": 54316294, "link": "https://stackoverflow.com/questions/54316294/how-to-vlookup-to-return-multiple-values-in-one-cell-in-excel", "title": "How To Vlookup To Return Multiple Values In One Cell In Excel?", "body": "<p>So I have the code that pastes multiple values into one cell but I was hoping to be able to put a semicolon in between the cell's value. </p>\n\n<p>This code allows a vlookup to find multiple cell values and output them in one cell. </p>\n\n<pre><code>Function MYVLOOKUP(pValue As String, pWorkRng As Range, pIndex As Long)\n'Update 20150310\nDim rng As Range\nDim xResult As String\nxResult = \"\"\nFor Each rng In pWorkRng\n    If rng = pValue Then\n        xResult = xResult &amp; \";\" &amp; rng.Offset(0, pIndex - 1)\n    End If\nNext\nMYVLOOKUP = xResult\nEnd Function\n</code></pre>\n\n<p>When I do this it does put a semicolon in between the values like I want, but also has a billion semicolons after. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548190109, "post_id": 54316178, "comment_id": 95452301, "body": "<code>Worksheets(&quot;NewSheetName&quot;).Range(&quot;A1&quot;).Resize(ubound(ArrayVa&zwnj;&#8203;r,1),ubound(ArrayVar&zwnj;&#8203;,2)).Value = ArrayVar</code>"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548190872, "post_id": 54316178, "comment_id": 95452634, "body": "Do I make <code>ArrayVar</code> my variable name?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548190939, "post_id": 54316178, "comment_id": 95452665, "body": "yes, I had to guess as you did not tell us the name, or provide any code that would make this a truly answerable question."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548191498, "post_id": 54316178, "comment_id": 95452903, "body": "I updated the question. Sorry."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548191551, "post_id": 54316178, "comment_id": 95452924, "body": "my line would go outside the loop."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1548191608, "post_id": 54316178, "comment_id": 95452951, "body": "and remove the <code>(i,1)</code> in both Ubounds."}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548193136, "creation_date": 1548189877, "last_edit_date": 1548193136, "question_id": 54316178, "link": "https://stackoverflow.com/questions/54316178/vba-print-variable-array-to-new-sheet", "title": "VBA, Print variable/array to new sheet", "body": "<p>I am trying to debug and print my variable (<code>Debug.Print</code>), but there is over 4000 values which i dont want to step through using f8 to find what I'm looking for. If I f5 through the variable, the immediate window does not let me see all values.</p>\n\n<p>my code is like so:</p>\n\n<pre><code>For i = 1 To UBound(irShocks, 1)\n    irShocks(i, 1) = irShocks(i, 3) &amp; \"|\" &amp; irShocks(i, 2) \n    Debug.Print irShocks(i, 1)\n    Worksheets(\"NewSheetName2\").Range(\"A1\").Resize(UBound(irShocks(i, 1), 1), UBound(irShocks(i, 1), 2)).value = irShocks(i, 1)\nNext i\n</code></pre>\n\n<p>I get a <code>type mismatch</code> when trying to print my variable to a new sheet. <code>Debug.Print</code> works fine.</p>\n\n<p>How can I print all these values into a new sheet to view them all at once?</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "edited": false, "score": 0, "creation_date": 1548202694, "post_id": 54316097, "comment_id": 95456471, "body": "It doesn&#39;t solve the underlying issue, but does setting the following resolve the prompt? <code>Application.DisplayAlerts = False</code>"}, {"owner": {"reputation": 27, "user_id": 10886402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KpFr8bxxP5I/AAAAAAAAAAI/AAAAAAAAADc/g2lriclFpu4/photo.jpg?sz=128", "display_name": "Sylvia Liu", "link": "https://stackoverflow.com/users/10886402/sylvia-liu"}, "reply_to_user": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "edited": false, "score": 0, "creation_date": 1548251509, "post_id": 54316097, "comment_id": 95475536, "body": "I still got this notification as shown in the screen shot with all the methods I have tried..."}, {"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1548370214, "post_id": 54316097, "comment_id": 95528041, "body": "Perhaps the &#39;file now available&#39; prompt is for the ADO recordset/connection objects?  Maybe you could try a client-side cursor, or if possible try closing the recordset/connection before closing the workbook to see if that helps?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10886402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KpFr8bxxP5I/AAAAAAAAAAI/AAAAAAAAADc/g2lriclFpu4/photo.jpg?sz=128", "display_name": "Sylvia Liu", "link": "https://stackoverflow.com/users/10886402/sylvia-liu"}, "edited": false, "score": 0, "creation_date": 1548426736, "post_id": 54356356, "comment_id": 95548438, "body": "Your code works perfect!!! Thanks for recommending the way of dealing with large loop. I will use this method in my future codes. Besides, your <code>Public Function GetExcelApp() As Object</code> works perfect. However, I also tries another similar function but it does not work well when my loop is actually tries to open different excel files, may I ask for the reason? Sorry, I am quite new to Access.. Code follows in next comment due to limit of characters."}, {"owner": {"reputation": 27, "user_id": 10886402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KpFr8bxxP5I/AAAAAAAAAAI/AAAAAAAAADc/g2lriclFpu4/photo.jpg?sz=128", "display_name": "Sylvia Liu", "link": "https://stackoverflow.com/users/10886402/sylvia-liu"}, "edited": false, "score": 0, "creation_date": 1548426760, "post_id": 54356356, "comment_id": 95548452, "body": "<code>Public Function GetExcelObject() As Object        On Error Resume Next     Dim xlo As Object     Set xlo = GetObject(&quot;Excel.Application&quot;)     If xlo Is Nothing Then         Set xlo = CreateObject(&quot;Excel.Application&quot;)     End If     Set GetExcelObject = xlo End Function</code>"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 27, "user_id": 10886402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KpFr8bxxP5I/AAAAAAAAAAI/AAAAAAAAADc/g2lriclFpu4/photo.jpg?sz=128", "display_name": "Sylvia Liu", "link": "https://stackoverflow.com/users/10886402/sylvia-liu"}, "edited": false, "score": 0, "creation_date": 1548438815, "post_id": 54356356, "comment_id": 95555212, "body": "I don&#39;t understand. Please ask a new question. If this answer is correct then mark it with the green check mark to close this question."}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": true, "score": 1, "last_activity_date": 1548369173, "creation_date": 1548369173, "answer_id": 54356356, "question_id": 54316097, "link": "https://stackoverflow.com/questions/54316097/access-vba-open-excel-file-and-close-turn-off-file-now-available/54356356#54356356", "title": "Access VBA (open excel file and close): turn off &quot;file now available&quot;", "body": "<p>You can't manually control garbage collection in VBA but you can structure your data so that garbage collection is more predictable. The first thing I recommend is to place the Excel inter-op code in to it's own procedure that is called from your main loop. The reason is that when the procedure ends, the garbage collection will occur. Next time the loop calls the open procedure you will be working with a fresh set of object handles, instead of recycling the objects as you are currently doing. If you do it this way you never have to set your objects to nothing because they are destroyed as they go out of scope at the end of the procedure. Just be sure to always use local variables.</p>\n\n<p>In order to do this without closing and opening Excel repetitively you need to get a handle on the currently running Excel instance. That is provided by the <code>GetExcelApp</code> procedure below.</p>\n\n<p>EXAMPLE:</p>\n\n<pre><code>Private Sub YourMainLoop()\n    For Each fileName in fileNames\n        ProcessExcelData fileName\n    Next fileName\nEnd Sub\n\nPrivate Sub ProcessExcelData(ByVal fileName as String)\n    Dim xl As Object\n    Set xl = GetExcelApp\n    xl.Application.DisplayAlerts = False\n    Set wb = xl.Workbooks.Open(fileName, ReadOnly = True, editable = True, notify = False)\n    Set ws = wb.Sheets(\"Sheet1\")\n    Set ws2 = wb.Worksheets.Add\n    cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; fileName &amp; \";Extended Properties=\"\"Excel 8.0;HDR=YES;IMEX=1;\"\";\"\n    ' Process the data, blah blah blah\n    wb.Close savechanges:=False\n    rs.Close\n    cn.Close\nEnd Sub\n\nPublic Function GetExcelApp() As Object\n' Returns open excel instance.\n'   If it doesn't exist, creates one to return\nOn Error GoTo ErrHandler\nConst ERR_APP_NOTRUNNING As Long = 429    \n\n    Set GetExcelApp = GetObject(, \"Excel.Application\")\n\nCleanExit:\n    Exit Function\nErrHandler:\n    If Err.number = ERR_APP_NOTRUNNING Then\n        Set GetExcelApp = CreateObject(\"Excel.Application\")\n        Resume CleanExit\n    Else\n        ShowErrorMessageBox\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10886402, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KpFr8bxxP5I/AAAAAAAAAAI/AAAAAAAAADc/g2lriclFpu4/photo.jpg?sz=128", "display_name": "Sylvia Liu", "link": "https://stackoverflow.com/users/10886402/sylvia-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 1, "accepted_answer_id": 54356356, "answer_count": 1, "score": 2, "last_activity_date": 1548369173, "creation_date": 1548189443, "last_edit_date": 1548210482, "question_id": 54316097, "link": "https://stackoverflow.com/questions/54316097/access-vba-open-excel-file-and-close-turn-off-file-now-available", "title": "Access VBA (open excel file and close): turn off &quot;file now available&quot;", "body": "<p>I used the following Access VBA code to open four different excel workbooks in a loop while I need to edit the excel data and then update the Access table through recordset.</p>\n\n<pre><code>xl.Application.DisplayAlerts = False\nSet wb = xl.Workbooks.Open(fileName, ReadOnly = True, editable = True, notify = False)\nSet ws = wb.Sheets(\"Sheet1\")\nSet ws2 = wb.Worksheets.Add\ncn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; fileName &amp; \";Extended Properties=\"\"Excel 8.0;HDR=YES;IMEX=1;\"\";\"\n</code></pre>\n\n<p>*****Other Codes******</p>\n\n<pre><code>wb.Close savechanges:=False\nSet wb = Nothing\nSet xlc = Nothing\nSet ws = Nothing\nSet ws2 = Nothing\nSet xl = Nothing\nrs.Close\nSet rs = Nothing\ncn.Close\nSet cn = Nothing\n</code></pre>\n\n<p>However, even though I close the excel file without saving for all the four files, I still receive the following notice after the full loop.\n<img src=\"https://i.stack.imgur.com/VYzyQ.png\" alt=\"enter image description here\"><br>\nwith <code>Set wb = xl.Workbooks.Open(fileName, ReadOnly = True, editable = True, notify = False)</code>, I was still not able to turn off the notice.</p>\n\n<p>PS. I did not receive the read-write notification for all the four files, normally one or two, which really confused me.</p>\n\n<p>Any recommendations for solving the issue?</p>\n\n<p>Thanks in advance for all the help!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 9206171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6b558dd95066c7057eadeda8218cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tate Garringer", "link": "https://stackoverflow.com/users/9206171/tate-garringer"}, "is_accepted": true, "score": 0, "last_activity_date": 1548189777, "creation_date": 1548189777, "answer_id": 54316164, "question_id": 54316062, "link": "https://stackoverflow.com/questions/54316062/copy-data-using-vba-in-excel-with-specific-condition/54316164#54316164", "title": "Copy data using vba in excel with specific condition", "body": "<p>Instead of using <code>(xlUp)</code> or <code>(xlDown)</code> you could use the row number of <code>c</code> to output to the appropriate matching row</p>\n\n<pre><code>Sub VendorStop()\n\nFor Each c In Range(\"C2:C170\")\n    If c.Value = Range(\"O14\").Value Then\n        Range(\"E\" &amp; c.Row &amp; \":J\" &amp; c.Row) = Range(\"P14:U14\")\n    End If\nNext c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 10952252, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-teMU8blyixw/AAAAAAAAAAI/AAAAAAAAF48/DdsfDng0_qQ/photo.jpg?sz=128", "display_name": "Abdul Hussain", "link": "https://stackoverflow.com/users/10952252/abdul-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 54316164, "answer_count": 1, "score": 0, "last_activity_date": 1548227273, "creation_date": 1548189261, "last_edit_date": 1548227273, "question_id": 54316062, "link": "https://stackoverflow.com/questions/54316062/copy-data-using-vba-in-excel-with-specific-condition", "title": "Copy data using vba in excel with specific condition", "body": "<p>My boss has asked me to fill out customer-rates in an excel file that contains 171 cities (each city has 5 different rates - ie. If city = Cell A1, the Cells A2:A6 = rates based on different weight classes)</p>\n\n<p>I'm writing a VBA code (never done this before for work) that would copy the rates from the source worksheet to this worksheet after matching City-Name and pasting corresponding rates next to the city.</p>\n\n<p>My code is able to scan and match the city names but it always pastes the 5 rate classes on the first row instead of beside the actual city it matched. I'm learning about the x1Down thing but it's complicated. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Button54_Click()\n\nFor Each c In Range(\"C2:C170\")\n If c.Value = Range(\"O14\").Value Then\n\n*****O14 contains the source city name which I pasted from the source file. I can fix this later****\n\n Range(\"E2:J2\").Value = Range(\"P14:U14\").Value\n</code></pre>\n\n<p>****P14:U14 contain the source file rates that I pasted. I can fix this later as well****</p>\n\n<pre><code> End If\nNext c\nEnd Sub\n</code></pre>\n\n<p>I would like help with the (xlUp) bit so that Range(\"E2:J2\") would go up in increments as it scans the list for matching city name. I've been playing around with it but assistance would be appreciated.</p>\n"}, {"tags": ["regex", "excel", "vba", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1548188732, "post_id": 54315877, "comment_id": 95451745, "body": "Not sure lookaheads are supported in VBScript-flavored regex though."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1548188818, "post_id": 54315877, "comment_id": 95451783, "body": "@MathieuGuindon Lookaheads <b>ARE</b> supported. Lookbehinds aren&#39;t."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1548188349, "creation_date": 1548188349, "answer_id": 54315877, "question_id": 54315840, "link": "https://stackoverflow.com/questions/54315840/vba-excel-replace-last-2-digits-of-number-if-occurs-at-beginning-of-string/54315877#54315877", "title": "VBA Excel Replace last 2 digits of number if occurs at beginning of string", "body": "<p>You may use</p>\n\n<pre><code>^(\\d*)\\d{2}\\b\n</code></pre>\n\n<p>Or, if you cannot rely on a word boundary, you may also use</p>\n\n<pre><code>^(\\d*)\\d{2}(?!\\d) ' no digit is allowed after the 2-digit sequence\n^(\\d*)\\d{2}(?!\\S) ' a whitespace boundary\n</code></pre>\n\n<p>And replace with <code>$1XX BLOCK</code>.</p>\n\n<p>See the <a href=\"https://regex101.com/r/DpHNBx/1\" rel=\"nofollow noreferrer\">regex demo</a>.</p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>(\\d*)</code> - Group 1: zero or more digits</li>\n<li><code>\\d{2}</code> - two digits</li>\n<li><code>\\b</code> - a word boundary, no digit, letter or <code>_</code> is allowed right after the two digits</li>\n<li><code>(?!\\d)</code> - a negative lookahead that fails the match if there is a digit immediately to the right of the current location</li>\n<li><code>(?!\\S)</code> - a negative lookahead that fails the match if there is a non-whitespace char immediately to the right of the current location.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 2, "last_activity_date": 1548192066, "creation_date": 1548192066, "answer_id": 54316610, "question_id": 54315840, "link": "https://stackoverflow.com/questions/54315840/vba-excel-replace-last-2-digits-of-number-if-occurs-at-beginning-of-string/54316610#54316610", "title": "VBA Excel Replace last 2 digits of number if occurs at beginning of string", "body": "<p><em><a href=\"https://regex101.com/r/M1QrPZ/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/M1QrPZ/1</a></em></p>\n\n<blockquote>\n<pre><code>Pattern = \"^\\d{2}(\\d{2})\"\n</code></pre>\n</blockquote>\n\n<p><em>Try the following</em> </p>\n\n<pre><code>Option Explicit\nPrivate Sub Example()\n    Dim RegExp As New RegExp\n    Dim Pattern As String\n    Dim rng As Range\n    Dim Cel As Range\n\n    Set rng = ActiveWorkbook.Sheets(\"Sheet1\" _\n                            ).Range(\"A1\", Range(\"A9999\" _\n                            ).End(xlUp))\n\n\n    Dim Matches As Variant\n    For Each Cel In rng\n        DoEvents\n        Pattern = \"^\\d{2}(\\d{2})\"\n\n        If Pattern &lt;&gt; \"\" Then\n            With RegExp\n                .Global = True\n                .MultiLine = True\n                .IgnoreCase = False\n                .Pattern = Pattern\n                 Set Matches = .Execute(Cel.Value)\n            End With\n\n            If Matches.Count &gt; 0 Then\n                Debug.Print Matches(0) ' full mach\n                Debug.Print Matches(0).SubMatches(0) ' sub match\n               Cel.Value = Replace(CStr(Cel), Matches(0).SubMatches(0), \"XX BLOCK\")\n            End If\n        End If\n\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 8006721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6362471fab1b1ba7fc9f2541beebd082?s=128&d=identicon&r=PG&f=1", "display_name": "siushi", "link": "https://stackoverflow.com/users/8006721/siushi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 54315877, "answer_count": 2, "score": 2, "last_activity_date": 1548192066, "creation_date": 1548188206, "last_edit_date": 1548188477, "question_id": 54315840, "link": "https://stackoverflow.com/questions/54315840/vba-excel-replace-last-2-digits-of-number-if-occurs-at-beginning-of-string", "title": "VBA Excel Replace last 2 digits of number if occurs at beginning of string", "body": "<p>I'm trying to replace the last two digits of number with \"<code>XX BLOCK</code>\" if it occurs at the start of the string and has more than 2 digits. </p>\n\n<p>I'm using the <em>Microsoft VBScript Regular Expressions 5.5</em> reference. </p>\n\n<pre><code>Dim regEx As New RegExp\nWith regEx\n    .Global = True 'Matches whole string, not just first occurrence\n    .IgnoreCase = True 'Matches upper or lowercase\n    .MultiLine = True 'Checks each line in case cell has multiple lines\n    .pattern = \"^(\\d{2,})\" 'Checks beginning of string for at least 2 digits\nEnd With\n\n'cell is set earlier in code not shown, refers to an Excel cell\nregEx.replace(cell.Value, \"XX BLOCK\")\n</code></pre>\n\n<p>Desired results:</p>\n\n<pre><code>\"1091 foo address\"      --&gt; \"10XX BLOCK foo address\"\n\"1016 foo 1010 address\" --&gt; \"10XX BLOCK foo 1010 address\"\n\"foo 1081 address\"      --&gt; \"foo 1081 address\"\n\"10 bar address\"        --&gt; \"XX BLOCK bar address\"\n\"8 baz address\"         --&gt; \"8 baz address\"\n</code></pre>\n\n<p>I'm new to regex and not sure where to start. I tried using <code>^(\\d{2,})</code> but then it replaces the entire number. </p>\n\n<p>There is also a guarantee that the number (if exists) will <em>always</em> be followed with a white space. </p>\n"}]