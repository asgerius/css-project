[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504137794, "post_id": 45971049, "comment_id": 78901757, "body": "You&#39;ll get that error if the sheet is protected"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504138531, "post_id": 45971049, "comment_id": 78901894, "body": "I ran a simplified version of your code and it worked fine giving no error at all, so I don&#39;t think that line of code is the problem. I then protected the sheet, as per Tim Williams&#39; suggestion, and got your same error on that line of code."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504139005, "post_id": 45971049, "comment_id": 78901992, "body": "Set myWS = myWB.Worksheets(belegIdString) :    you did not defined belegIdString"}, {"owner": {"reputation": 21, "user_id": 4411149, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdIEexehTSw/AAAAAAAAAAI/AAAAAAAAB_0/lobyOFLxLAs/photo.jpg?sz=128", "display_name": "fl0_at", "link": "https://stackoverflow.com/users/4411149/fl0-at"}, "reply_to_user": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504161019, "post_id": 45971049, "comment_id": 78907920, "body": "@Dy.Lee I forgot to change that variable before posting the code. It should be &quot;sheetName&quot;. Will edit my post accordingly."}, {"owner": {"reputation": 21, "user_id": 4411149, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdIEexehTSw/AAAAAAAAAAI/AAAAAAAAB_0/lobyOFLxLAs/photo.jpg?sz=128", "display_name": "fl0_at", "link": "https://stackoverflow.com/users/4411149/fl0-at"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504174068, "post_id": 45971049, "comment_id": 78916349, "body": "@TimWilliams Thanks for the tip!"}, {"owner": {"reputation": 21, "user_id": 4411149, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdIEexehTSw/AAAAAAAAAAI/AAAAAAAAB_0/lobyOFLxLAs/photo.jpg?sz=128", "display_name": "fl0_at", "link": "https://stackoverflow.com/users/4411149/fl0-at"}, "reply_to_user": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504174487, "post_id": 45971049, "comment_id": 78916647, "body": "@TonyM I forgot to add the lines myWS.Unprotect and myWS.Protect. I&#39;ll post this as the answer to my question!"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4411149, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdIEexehTSw/AAAAAAAAAAI/AAAAAAAAB_0/lobyOFLxLAs/photo.jpg?sz=128", "display_name": "fl0_at", "link": "https://stackoverflow.com/users/4411149/fl0-at"}, "is_accepted": true, "score": 0, "last_activity_date": 1504208215, "last_edit_date": 1504208215, "creation_date": 1504174438, "answer_id": 45978902, "question_id": 45971049, "link": "https://stackoverflow.com/questions/45971049/vba-runtime-error-1004-on-set-chartobject-myws-chartobjects-add0-0-100-100/45978902#45978902", "title": "VBA Runtime Error 1004 on Set chartObject = myWS.Chartobjects.Add(0,0,100,100)", "body": "<p>Thanks to the comments of @TimWilliams and @TonyM my code works now. The Runtime Error 1004 was thrown because the sheet was still protected.</p>\n\n<p>So I added</p>\n\n<pre><code>myWS.Unprotect\n</code></pre>\n\n<p>and</p>\n\n<pre><code>myWS.Protect\n</code></pre>\n\n<p>to the following code:</p>\n\n<pre><code>Function RangeToImage(sheetName As String, rangeToBeExported As String)\n\n    Dim exportRange As Range\n    Dim fName As String: fName = sheetName &amp; getConstNameForRange(rangeToBeExported)\n    Dim cObject As ChartObject 'ChartObject\n    Dim myChart As Chart\n    Dim myWB As Workbook, myWS As Worksheet\n\n    Set myWB = Application.ActiveWorkbook\n    Set myWS = myWB.Worksheets(sheetName)\n\n    myWS.Unprotect\n\n    myWS.Activate\n    ActiveWindow.DisplayGridlines = False\n\n    Call goToThisRange(myWS.Cells(1, 1))\n\n    Set exportRange = Worksheets(sheetName).Range(rangeToBeExported)\n    ActiveWindow.DisplayGridlines = False\n    exportRange.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n    Set cObject = myWS.ChartObjects.Add(0, 0, 100, 100)\n    cObject.Width = exportRange.Width\n    cObject.Height = exportRange.Height\n    cObject.Activate\n\n    Set myChart = cObject.Chart\n    myChart.Paste\n    myChart.Export getSpeicherort(fName) &amp; IMAGEFORMATEXT, IMAGEFORMAT\n    myChart.Parent.Delete\n\n    myWS.Protect    \n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4411149, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xdIEexehTSw/AAAAAAAAAAI/AAAAAAAAB_0/lobyOFLxLAs/photo.jpg?sz=128", "display_name": "fl0_at", "link": "https://stackoverflow.com/users/4411149/fl0-at"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "accepted_answer_id": 45978902, "answer_count": 1, "score": 0, "last_activity_date": 1504208215, "creation_date": 1504135045, "last_edit_date": 1504208138, "question_id": 45971049, "link": "https://stackoverflow.com/questions/45971049/vba-runtime-error-1004-on-set-chartobject-myws-chartobjects-add0-0-100-100", "title": "VBA Runtime Error 1004 on Set chartObject = myWS.Chartobjects.Add(0,0,100,100)", "body": "<p>I came across a problem in my VBA code. What I am trying to do is create a chartObject, add a chart to my worksheet and paste an image into it.</p>\n\n<p>My Code so far is as follows:</p>\n\n<pre><code>Function RangeToImage(sheetName As String, rangeToBeExported As String)\n\n    Dim exportRange As Range\n    Dim fName As String: fName = sheetName &amp; getConstNameForRange(rangeToBeExported)\n    Dim cObject As ChartObject 'ChartObject\n    Dim myChart As Chart\n    Dim myWB As Workbook, myWS As Worksheet\n\n    Set myWB = Application.ActiveWorkbook\n    Set myWS = myWB.Worksheets(sheetName)\n\n    myWS.Activate\n    ActiveWindow.DisplayGridlines = False\n\n    Call goToThisRange(myWS.Cells(1, 1))\n\n    Set exportRange = Worksheets(sheetName).Range(rangeToBeExported)\n    ActiveWindow.DisplayGridlines = False\n    exportRange.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n    Set cObject = myWS.ChartObjects.Add(0, 0, 100, 100)\n    cObject.Width = exportRange.Width\n    cObject.Height = exportRange.Height\n    cObject.Activate\n\n    Set myChart = cObject.Chart\n    myChart.Paste\n    myChart.Export getSpeicherort(fName) &amp; IMAGEFORMATEXT, IMAGEFORMAT\n    myChart.Parent.Delete\n\nEnd Function\n</code></pre>\n\n<p>However, the line</p>\n\n<pre><code>Set cObject = myWS.ChartObjects.Add(0, 0, 100, 100)\n</code></pre>\n\n<p>throws</p>\n\n<blockquote>\n  <p>Runtime Error 1004: Application-defined or Object-defined error</p>\n</blockquote>\n\n<p>I'm completely lost with this one, is there anything I am missing or misunderstanding here?</p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "date", "pdf", "text"], "comments": [{"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504132605, "post_id": 45970565, "comment_id": 78900571, "body": "For problems like this, consider pasting into Word and using Advanced Find/Replace. If needed, wildcard searches can be very powerful. Here&#39;s one site describing those: <a href=\"http://wordmvp.com/FAQs/General/UsingWildcards.htm\" rel=\"nofollow noreferrer\">wordmvp.com/FAQs/General/UsingWildcards.htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8540300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2235f43e2f649f759ee7b25cdcbeb47c?s=128&d=identicon&r=PG&f=1", "display_name": "Gravity_B", "link": "https://stackoverflow.com/users/8540300/gravity-b"}, "edited": false, "score": 0, "creation_date": 1504173314, "post_id": 45974287, "comment_id": 78915753, "body": "I did run the code, change the path and enabled Microsoft Word and PDF in the project references library.  I got the &#39;run-time 1004&#39; error though.  I stepped into the code and it just runs in the For-Next repeatedly."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 11, "user_id": 8540300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2235f43e2f649f759ee7b25cdcbeb47c?s=128&d=identicon&r=PG&f=1", "display_name": "Gravity_B", "link": "https://stackoverflow.com/users/8540300/gravity-b"}, "edited": false, "score": 0, "creation_date": 1504195500, "post_id": 45974287, "comment_id": 78931532, "body": "make sure that you have a blank worksheet.   it should put values in to the cells"}, {"owner": {"reputation": 11, "user_id": 8540300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2235f43e2f649f759ee7b25cdcbeb47c?s=128&d=identicon&r=PG&f=1", "display_name": "Gravity_B", "link": "https://stackoverflow.com/users/8540300/gravity-b"}, "edited": false, "score": 0, "creation_date": 1504778027, "post_id": 45974287, "comment_id": 79148144, "body": "Is there a solution that could fix the pasted values in MS Excel?"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 1, "last_activity_date": 1504159295, "creation_date": 1504159295, "answer_id": 45974287, "question_id": 45970565, "link": "https://stackoverflow.com/questions/45970565/fix-pasted-text-from-pdf-credit-statement/45974287#45974287", "title": "Fix pasted text from PDF credit statement", "body": "<p>this is some test code that imports the content of a pdf file into excel by running it through msWord</p>\n\n<pre><code>Sub pdf2excel()\n\n    ' import pdf file text into excel, using msWord as a proxy\n\n    ' set reference to microsoft word object library\n\n    Dim wdApp As Word.Application\n    Set wdApp = New Word.Application\n\n    Dim file As String\n    file = \"C:\\statements\\statement.pdf\"\n\n    Dim wdDoc As Word.Document\n    Set wdDoc = wdApp.Documents.Open( _\n                    Filename:=file, ConfirmConversions:=False, _\n                    ReadOnly:=True, AddToRecentFiles:=False, _\n                    PasswordDocument:=\"\", PasswordTemplate:=\"\", Revert:=False, _\n                    WritePasswordDocument:=\"\", WritePasswordTemplate:=\"\", _\n                    Format:=wdOpenFormatAuto, XMLTransform:=\"\")\n\n'   wdApp.Visible = false                   ' can make msWord visible if you want ... would help in determining location of data\n\n    Dim cel As Range\n    Set cel = Range(\"d2\")                   ' put paragraph text in column D\n\n    Dim prgf As Paragraph\n    For Each prgf In wdDoc.Paragraphs\n        cel = prgf.Range.Text               ' put paragraph into worksheet cell\n        Set cel = cel.offset(1)             ' point to next cell down\n    Next prgf\n\n    Set cel = Range(\"b2\")                   ' put word text in column D\n\n    Dim wrd As Word.Range\n    For Each wrd In wdDoc.Words\n        cel = wrd.Text\n        Set cel = cel.offset(1)\n    Next wrd\n\n    wdDoc.Close False\n    Set wdDoc = Nothing\n\n    wdApp.Quit\n    Set wdApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8540300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2235f43e2f649f759ee7b25cdcbeb47c?s=128&d=identicon&r=PG&f=1", "display_name": "Gravity_B", "link": "https://stackoverflow.com/users/8540300/gravity-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504159295, "creation_date": 1504131755, "last_edit_date": 1504143075, "question_id": 45970565, "link": "https://stackoverflow.com/questions/45970565/fix-pasted-text-from-pdf-credit-statement", "title": "Fix pasted text from PDF credit statement", "body": "<p>I have this text file that I copied from a credit card statement</p>\n\n<p>Sample line 1:</p>\n\n<pre><code>August 18       August 18       Balance Conversion      :02/06          4,671.30\n</code></pre>\n\n<p>Sample line 2:</p>\n\n<pre><code>August 1        August 2        *Php-Anytiefit-Ezypay   Kuala Lumpur    2,300.00\n</code></pre>\n\n<p>I copy it from a PDF file into an MS Excel file.  I would get the text below with double spaces and each line is just pasted into one cell like below.</p>\n\n<p>I tried using text functions <code>=RIGHT(B73,LEN(B73)-E73+2)</code> and array <code>=MIN(SEARCH({0,1,2,3,4,5,6,7,8,9},B73&amp;\"0123456789\"))</code> etc. The array I got from research but I would still tweak the formula since the month character number changes every month, and the single or double digit day.</p>\n\n<p>The amount is constant at two decimals places, using a comma and dot separator.  Unless there is an installment line e.g. 01/24, this \"one of twenty-four\" will come before the amount 2,916.25 like <code>0 1 / 2 4 2 , 9 1 6 . 2 5</code></p>\n\n<p>I'm looking to use a VBA solution or function to fix the pasted values. </p>\n\n<p>A u g u s t 1 8 A u g u s t 1 8 P o w e r M a c C e n t e r - G b 3 : 0 1 / 2 4 2 , 9 1 6 . 2 5<br>\nA u g u s t 1 8 A u g u s t 1 8 B a l a n c e C o n v e r s i o n : 0 2 / 0 6 4 , 6 7 1 . 3 0<br>\nA u g u s t 1 A u g u s t 2 * P h p - A n y t i m e f i t - E z y p a y K u a l a L u m p u r 2 , 3 0 0 . 0 0<br>\nA u g u s t 1 3 A u g u s t 1 5 S t a r b u c k s C o n g r e s s Q c 2 7 5 . 0 0</p>\n"}, {"tags": ["vba", "function", "ms-access", "save", "global"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504131952, "post_id": 45970403, "comment_id": 78900398, "body": "I&#39;ll ask the same questions I asked on your previous question: (1) What does your class do? (2) How is that associated with the form that the user is on? (3) What part of your code is trying to invoke the class&#39; <code>Close</code> function? (I get the feeling from a comment that you are trying to close the class when the user tries to close a form.) (4) Is the <code>Close</code> function actually in a class, or just in a standard code module?"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1504166550, "creation_date": 1504166550, "answer_id": 45976286, "question_id": 45970403, "link": "https://stackoverflow.com/questions/45970403/in-access-is-it-possible-to-close-a-variable-from-a-global-function/45976286#45976286", "title": "In Access is it possible to close a variable from a global function?", "body": "<p>A bound form will by default save changed data when closed, so you don't need all this.</p>\n\n<p>Thus, all you need is a single code line:</p>\n\n<pre><code>DoCmd.Quit\n</code></pre>\n\n<p>If you systematically wish to add features or behaviour to forms or controls, use <em>WithEvents</em>. </p>\n\n<p>An example can be found <a href=\"https://www.experts-exchange.com/articles/29554/Create-Windows-Phone-Colour-Palette-and-Selector-using-WithEvents.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 8443203, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4b254cfcd0e1a8aabb059fb12d4d6217?s=128&d=identicon&r=PG&f=1", "display_name": "Everton", "link": "https://stackoverflow.com/users/8443203/everton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594639202, "creation_date": 1504130843, "last_edit_date": 1594639202, "question_id": 45970403, "link": "https://stackoverflow.com/questions/45970403/in-access-is-it-possible-to-close-a-variable-from-a-global-function", "title": "In Access is it possible to close a variable from a global function?", "body": "<p>In my access program I am going to ask the user every time they close the program if they want to save. This can be done from any form. The problem arises as I want to create a global function in order to cut down on repetitive code. How would this be done?? In a class module? (How is that set up??)</p>\n\n<p>If it helps my code is as follows;</p>\n\n<pre><code>If Me.Dirty Then\n Dim LResponse As Integer\n\n LResponse = MsgBox(\"You have unsaved changes. Do you really want to close the database\", vbYesNo, \"Close form\")\n\n If LResponse = vbYes Then\n  DoCmd.Close\n  Cancel = True\n End If\nElse\n DoCmd.CloseDatabase\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504128568, "post_id": 45969928, "comment_id": 78899233, "body": "That is a circular reference, and should be handled with vba not formulas."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1504131620, "post_id": 45969928, "comment_id": 78900277, "body": "That&#39;s a dangerous approach. How would you know by just looking at the data that the Not Billed has already been added to the &lt;48 column if you overwrite the existing value?"}], "answers": [{"tags": [], "owner": {"reputation": 836, "user_id": 5184993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjJCR.jpg?s=128&g=1", "display_name": "9953-div-37", "link": "https://stackoverflow.com/users/5184993/9953-div-37"}, "is_accepted": true, "score": 0, "last_activity_date": 1504159609, "last_edit_date": 1504159609, "creation_date": 1504158845, "answer_id": 45974180, "question_id": 45969928, "link": "https://stackoverflow.com/questions/45969928/excel-macro-add-one-column-to-another/45974180#45974180", "title": "Excel macro - add one column to another", "body": "<p>From your question, I wrote a tested and working <strong>macro</strong> as requested.<br>\nAssuming your Cell <strong>columns</strong> is the same as in the section below. (Note that the rows may differ and may start on different positions)  </p>\n\n<p>You can select the rows that needs to be processed as displayed in the picture.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/68ELS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/68ELS.png\" alt=\"enter image description here\"></a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Sub calculate()\n    ' Calculates for each row in any selection\n    ' Takes value in C and add value in F if value in F is larger than 0 then afterwards makes value in f equal to 0\n    ' Asumes that Column \"C\" have the \"Visit\" and Column \"F\" is the \"Not Billed\" columns\n\n    Dim sel As Range\n    Dim rw As Range\n    Dim l As Long\n\n        Set sel = Selection\n\n        For Each rw In sel ' Adapt this to however you need to specify the selection you want to work with\n            If (Cells(rw.Row, 6).Value &gt; 0) Then ' Test if the value need to be processed\n                l = Cells(rw.Row, 3).Value + Cells(rw.Row, 6).Value\n                Cells(rw.Row, 6).Value = 0\n                Cells(rw.Row, 3).Value = l\n                'Cells(rw.Row, 3) would be column C\n                'Cells(rw.Row, 6) would be column F\n            End If\n        Next\n\n    End Sub\n</code></pre>\n\n<p>After running the macro your file will look like:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/Yg6mr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yg6mr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Let me know if it works for you.  </p>\n"}], "owner": {"reputation": 3, "user_id": 8540283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d75c2a5f4222f99fea4cf20997b7f0?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Parso", "link": "https://stackoverflow.com/users/8540283/frank-parso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 45974180, "answer_count": 1, "score": -1, "last_activity_date": 1504164613, "creation_date": 1504128294, "last_edit_date": 1531161705, "question_id": 45969928, "link": "https://stackoverflow.com/questions/45969928/excel-macro-add-one-column-to-another", "title": "Excel macro - add one column to another", "body": "<p>Hi I have a Excel worksheet with data like this:  </p>\n\n<pre><code>VISIT  &lt;48  &gt;48  TOTAL BILLED   NOT BILLED\n\n10      4   3         7             3\n</code></pre>\n\n<p>I need a macro that will add the <em>not-billed</em> to the <em>&lt;48</em> i.e. 3+4= 7. \n7 would then replace the 4.  </p>\n\n<p>I tried <code>C13=C13+F13</code> but it does not compile.  </p>\n"}, {"tags": ["vba", "excel", "href", "scrape"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528449085, "post_id": 45969864, "comment_id": 88521974, "body": "What is txt in this context and gr ?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1536645931, "last_edit_date": 1536645931, "creation_date": 1528451159, "answer_id": 50757822, "question_id": 45969864, "link": "https://stackoverflow.com/questions/45969864/vba-scrape-src-instead-of-href/50757822#50757822", "title": "VBA scrape src instead of href", "body": "<p>You could try using a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selector</a>.</p>\n\n<pre><code>#wrapper div.category-products &gt; ul a\n</code></pre>\n\n<p>This is a reduced version of the full selector that targets <code>a</code> tags within the products category. You then parse the <code>outerHTML</code> for the hrefs as that is where the information is located.</p>\n\n<hr>\n\n<p>Site image (Sample view)</p>\n\n<p><a href=\"https://i.stack.imgur.com/FJrc2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FJrc2.png\" alt=\"Sample view\"></a></p>\n\n<hr>\n\n<p>Output from code (Sample view)</p>\n\n<p><a href=\"https://i.stack.imgur.com/0JO8w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0JO8w.png\" alt=\"Sample immediate window output\"></a></p>\n\n<hr>\n\n<p>Code</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim oHtml As HTMLDocument, nodeList As Object, currentItem As Long\n    Const URL As String = \"https://www.jjfox.co.uk/cigars/show/all.html\"\n    Set oHtml = New HTMLDocument\n    With CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n        .Open \"GET\", URL, False\n        .send\n        oHtml.body.innerHTML = .responseText\n    End With\n\n    Set nodeList = oHtml.querySelectorAll(\"#wrapper div.category-products &gt; ul a\")\n    For currentItem = 0 To nodeList.Length - 1\n        On Error Resume Next\n        Debug.Print Split(Split(nodeList.item(currentItem).outerHTML, \"&lt;A href=\")(1), \"&gt;\")(0)\n        On Error GoTo 0\n    Next currentItem\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Or more simply, use the following</p>\n\n<pre><code>For currentItem = 0 To nodeList.Length - 1\n    On Error Resume Next\n    Debug.Print nodeList.item(currentItem).href\n    On Error GoTo 0\nNext currentItem\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6740849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10210920695398338/picture?type=large", "display_name": "Suren Grigoryan", "link": "https://stackoverflow.com/users/6740849/suren-grigoryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 50757822, "answer_count": 1, "score": 0, "last_activity_date": 1536645931, "creation_date": 1504127987, "last_edit_date": 1531164843, "question_id": 45969864, "link": "https://stackoverflow.com/questions/45969864/vba-scrape-src-instead-of-href", "title": "VBA scrape src instead of href", "body": "<p>I am using the code below code but it brings the value of 'src' instead of 'href' for some reason. Anyone can help please?</p>\n\n<pre><code>Sub bringfox(txt As String)\n\nDim oHtml       As HTMLDocument\nDim oElement    As Object\nSet oHtml = New HTMLDocument\n\nmaintext2 = \"https://www.jjfox.co.uk/cigars/show/all.html\"\n\nWith CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n    .Open \"GET\", maintext2 &amp; gr, False\n    .send\n    oHtml.body.innerHTML = .responseText\nEnd With\n\n\n\ncounter = cnt\n'oElement(i).Children(0).getAttribute (\"href\")\nSet oElement = oHtml.getElementsByClassName(\"products-grid products-grid--max-3-col\")(0).getElementsByTagName(\"a\")\ni = 0\nWhile i &lt; oElement.Length\n    Debug.Print oElement(i).Children(0).getAttribute(\"href\")\n\n    i = i + 1\n\nWend\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "background-color"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1504128155, "post_id": 45969671, "comment_id": 78899093, "body": "You do not set the array size so it is empty."}], "answers": [{"comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1504131136, "post_id": 45969924, "comment_id": 78900136, "body": "Upvoted for the technique of referencing the worksheet with <code>Application.Caller.Parent</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1504131350, "last_edit_date": 1504131350, "creation_date": 1504128288, "answer_id": 45969924, "question_id": 45969671, "link": "https://stackoverflow.com/questions/45969671/excel-vba-return-max-value-of-colored-cell/45969924#45969924", "title": "Excel VBA Return Max Value of Colored Cell", "body": "<p>Arrays are not dynamic, you must set the size progamatically.</p>\n\n<p>In this case there is no need for the array, it adds no benefit, just test it and replace the variable if value is larger:</p>\n\n<pre><code>Function ColorMax(Color As Integer) As Single\n\nDim x As Integer\nDim y As Integer\nColorMax = 0\nWith Application.Caller.Parent\n    For x = 1 To 1000\n        For y = 1 To 1000\n            If Cells(x, y).Interior.ColorIndex = Color And .Cells(x, y).Value &gt; ColorMax  Then\n                ColorMax = .Cells(x, y).Value\n            End If\n        Next\n    Next\nEnd With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8540176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03f14a3f8415609d39ea230a7398cc9e?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch Keller", "link": "https://stackoverflow.com/users/8540176/mitch-keller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504131350, "creation_date": 1504127063, "question_id": 45969671, "link": "https://stackoverflow.com/questions/45969671/excel-vba-return-max-value-of-colored-cell", "title": "Excel VBA Return Max Value of Colored Cell", "body": "<p>I'm trying to create a function go through the sheet and return the highest value of all the green (user input color) colored cells. I'm very new to VBA and I cannot get the function to output anything besides \"#VALUE!\". Here is what my code looks like: </p>\n\n<pre><code>Function ColorMax(Color As Integer) As Single\nDim array1()\nDim x As Integer\nDim y As Integer\nDim n As Integer\nn = 1\nFor x = 1 To 1000\n    For y = 1 To 1000\n        If Cells(x, y).Interior.ColorIndex = Color Then\n            array1(n) = Cells(x, y).Value\n            n = n + 1\n        End If\n    Next\nNext\nColorMax = Application.WorksheetFunction.max(array1)\nEnd Function\n</code></pre>\n\n<p>Is there a way to fix this in order to get my desired output?</p>\n"}, {"tags": ["vba", "excel", "do-while"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1504126984, "post_id": 45969627, "comment_id": 78898562, "body": "It sounds like this can be done with in sheet formulas.  Can you please provide sample data and expected results?"}, {"owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1504127567, "post_id": 45969627, "comment_id": 78898803, "body": "I have edited to show an example, I thought it could be done with in sheet formulas the only problem is that the range changes constantly and rows will be cut out and pasted etc...."}, {"owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1504127774, "post_id": 45969627, "comment_id": 78898905, "body": "Numbers in red are what I would like, simply adding 1 to the number above it."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1504127788, "post_id": 45969627, "comment_id": 78898915, "body": "In cell A7 and copied down: <code>=COUNTIF($B$7:$B7,0)</code>"}, {"owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1504128189, "post_id": 45969627, "comment_id": 78899107, "body": "That works, except for when it encounters  a &quot;QI&quot; row, where the value in B for that is also a 0. I may be able to take away that 0 but it could mess up the rest of my sheet. Is there anyway to add a criteria that it the corresponding cell in A cant be &quot;QI?&quot;"}], "owner": {"reputation": 51, "user_id": 6464971, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10205342851604737/picture?type=large", "display_name": "Thomas Breakell", "link": "https://stackoverflow.com/users/6464971/thomas-breakell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504127711, "creation_date": 1504126863, "last_edit_date": 1504127711, "question_id": 45969627, "link": "https://stackoverflow.com/questions/45969627/excel-user-function-to-return-a-value-based-on-last-number-in-column", "title": "Excel User Function to return a value based on last number in column", "body": "<p>Function Purpose: Return a number value which is the sum of the number above it in the column + 1. This function will be used to number the item number when I add an \"item\" (a copied form, which will include the function in a cell to automatically number it). If it is the first item in my table (row 6) it should be a 0.</p>\n\n<p>Problem: Returning a value of 0 regardless, Column A, where the function will be located can contain 3 different things, A string, blank space or a number.\nThis is an example of where the function would be used.</p>\n\n<p>The space inbetween 0's varies, where it can be anything from no space to 100.</p>\n\n<p><a href=\"https://i.stack.imgur.com/y2ME1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y2ME1.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/cSn21.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cSn21.png\" alt=\"enter image description here\"></a></p>\n\n<p>Code,</p>\n\n<pre><code>Public Function ItemNum() As Integer\n\nDim loc As range\nDim numChkCell As range\nSet loc = Application.Caller\n\n\nIf loc.Row = 7 Then\n    ItemNum = 1\n    Exit Function\nEnd If\nSet numChkCell = loc.Offset(-1, 0)\n\nDo While Application.WorksheetFunction.IsNumber(numChkCell) = False\n    If (numChkCell.Value &lt;&gt; loc.Value2 And \nApplication.WorksheetFunction.IsNumber(numChkCell) = True) Then\n     ItemNum = numChkCell.Value2 + 1\n\n     Exit Do\n    Else\n     Set numChkCell = numChkCell.Offset(-1, 0)\n    End If\n Loop\n ItemNum = numChkCell.Value2 + 1\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "selenium", "google-chrome", "ms-access", "firefox"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504126244, "post_id": 45969325, "comment_id": 78898233, "body": "If you&#39;re asking for a software recommendation, see <a href=\"https://softwarerecs.stackexchange.com/\">softwarerecs.stackexchange.com</a>. Else: provide a detailed description of what you tried, and any errors that follow, so we can help you solve the issue."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504281105, "post_id": 45969325, "comment_id": 78968691, "body": "You might want to re-ask this question with a title like &quot;Selenium TimeourError when calling from Access VBA&quot;. I can&#39;t cast reopen votes, but I&#39;m all for answering this question, and since it&#39;s quite different from when you first asked it, re-asking it will be appropriate. But let&#39;s leave the autofilling out of it, and just try to fix the timeout. Have you disabled the Windows Firewall to see if that makes a difference?"}, {"owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504286127, "post_id": 45969325, "comment_id": 78971196, "body": "Dear Erik, thank you very much for your help. I haven&#39;t tried that yet. I am following your advises as well as I can. Apologies for my mistakes, I am not used to ask in forums, this is the second time I make a question in a forum, and the first here. I will try this and let you know."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504286702, "post_id": 45969325, "comment_id": 78971432, "body": "Glad to help, always good to have new members. You will notice StackOverflow is a lot different from other fora, in the sense that it&#39;s really about coding questions, which should be as small, clear and simple as possible, and answers, which should be the same, and that for both questions and answers, some effort and research is expected. So no conversations (except in the comments) or anything like that. The <a href=\"https://stackoverflow.com/tour\">tour</a> is a good place to get acquainted with the site."}], "owner": {"reputation": 11, "user_id": 8539957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700c0d8d74ced10edcea6fb14d4a24d6?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando M.", "link": "https://stackoverflow.com/users/8539957/fernando-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 824, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594587687, "creation_date": 1504125531, "last_edit_date": 1594587687, "question_id": 45969325, "link": "https://stackoverflow.com/questions/45969325/selenium-timeout-issue-when-calling", "title": "Selenium Timeout issue when calling", "body": "<p>Running this code in Access VBA:</p>\n\n<pre><code>Private Sub cmd_OpenFirefox_Click()\n\nDim driver as New FirefoxDriver\ndriver.Get \"http://www.google.com\"\n\nEnd Sub\n</code></pre>\n\n<p>Will open a new Firefox window, but it remains completely blank. And VBA will display error code \"21\" with this comment: \n\"TimeoutError\"\n\"Firefox failed to open the listening port 127.0.0.1:51724 within 15s\"</p>\n\n<p>I have installed SELENIUM BASIC version 2.0.9.0, and I'm trying to open a site using Chrome, Firefox or Edge, from code in ACCESS 2016 VBA. I've already checked \"Selenium Type Library\" in Tools-> References.</p>\n\n<p>The same happens with Chrome and Edge.</p>\n\n<p>Browsers versions:</p>\n\n<p>Google Chrome: Version 60.0.3112.113 (Official Build) (64-bit)</p>\n\n<p>Microsoft Edge: Microsoft Edge 40.15063.0.0 / Microsoft EdgeHTML 15.15063</p>\n\n<p>Mozilla Firefox: Firefox 55.0.3 (32-bit)</p>\n\n<p>What's wrong?</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1528962391, "last_edit_date": 1528962391, "creation_date": 1528921336, "answer_id": 50845661, "question_id": 45969316, "link": "https://stackoverflow.com/questions/45969316/submit-or-bypass-form-for-a-web-query/50845661#50845661", "title": "Submit or bypass form for a Web Query", "body": "<p>You can use the bcb.gov.br <a href=\"https://dadosabertos.bcb.gov.br/en/\" rel=\"nofollow noreferrer\">Open Data Portal</a>. </p>\n\n<p>Send a request for a JSON response with the conversion rates from their <a href=\"https://dadosabertos.bcb.gov.br/en/dataset/exchange-rates-daily-bulletins\" rel=\"nofollow noreferrer\">Exchange rates \u2013 daily bulletins</a>. </p>\n\n<p>With the received response, amongst other methods, you can then:</p>\n\n<ol>\n<li>Use the <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">JSON Converter</a> and set the convert the response into a JSON object and work with that;</li>\n<li>Parse the response as a string with a regex to get the values</li>\n</ol>\n\n<hr>\n\n<p>Looking at the results for today's rate on the <a href=\"http://www4.bcb.gov.br/pec/conversao/conversao.asp\" rel=\"nofollow noreferrer\">site</a>:</p>\n\n<p><strong>Input:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/veCxy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/veCxy.png\" alt=\"Input\"></a></p>\n\n<p><strong>Output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/qx3mM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qx3mM.png\" alt=\"Rates\"></a></p>\n\n<p><strong>Result:</strong> </p>\n\n<p>You can see USD 1 = 3,7048 BRL</p>\n\n<hr>\n\n<h2>\u2460 <strong>Using JSON object:</strong></h2>\n\n<p>Example string to make request:</p>\n\n<pre><code>\"https://olinda.bcb.gov.br/olinda/service/PTAX/version/v1/odata/ExchangeRatePeriod(moeda=@moeda,dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?%40moeda=%27\" &amp; TARGET_CURRENCY &amp; \"%27&amp;%40dataInicial=%27\" &amp; START_DATE &amp; \"%27&amp;%40dataFinalCotacao=%27\" &amp; END_DATE &amp; \"%27&amp;%24format=json\"\n</code></pre>\n\n<p>I include the start date, end date and currency in the string as well as specify the response format as JSON. I have selected the date to match the website view shown in the images above.</p>\n\n<p>The JSON response is as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/69pWZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/69pWZ.png\" alt=\"JSON response\"></a></p>\n\n<p>I read the response into a string variable and then use <code>JsonConverter.ParseJson(strJSON)</code> to convert to a JSON object, stored in <code>json</code> variable. A quick inspection of the structure:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sgEc9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sgEc9.png\" alt=\"JSON structure\"></a></p>\n\n<p>The begining \"{\" tells me that <code>json</code> is a dictionary.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LPGOz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LPGOz.png\" alt=\"dictionary\"></a></p>\n\n<p>I can also see that <code>json(\"value\")</code> is a collection of dictionaries and that the value I am interested in,  <code>3,7048</code> - remember from the website images above, is stored as <code>\"cotacaoCompra\"</code>.</p>\n\n<p>I can thus use the following script to access that value. The JSON response actually gives rates at 5 different times on that date in question. These are all printed out. The <code>Fechamento</code> (Closing) bulletin rate of 3,7048 we can see matches.</p>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim strURL As String, strJSON As String, item As Variant, http As Object, json As Object\n    Const TARGET_CURRENCY As String = \"USD\"\n    Const START_DATE As String = \"06-13-2018\"\n    Const END_DATE As String = \"06-13-2018\"\n\n    strURL = \"https://olinda.bcb.gov.br/olinda/service/PTAX/version/v1/odata/ExchangeRatePeriod(moeda=@moeda,dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?%40moeda=%27\" &amp; TARGET_CURRENCY &amp; \"%27&amp;%40dataInicial=%27\" &amp; START_DATE &amp; \"%27&amp;%40dataFinalCotacao=%27\" &amp; END_DATE &amp; \"%27&amp;%24format=json\"\n\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n    http.Open \"GET\", strURL, False\n    http.send\n    strJSON = http.responseText\n    Set json = JsonConverter.ParseJson(strJSON)\n\n    For Each item In json(\"value\")\n        Debug.Print \"rate \" &amp; item(\"cotacaoCompra\") &amp; \" at \" &amp; item(\"dataHoraCotacao\")\n    Next item\nEnd Sub\n</code></pre>\n\n<p><strong>Script output:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/dqaFG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dqaFG.png\" alt=\"Script output\"></a></p>\n\n<hr>\n\n<p><strong>Notes:</strong></p>\n\n<p>Requires JSONConverter bas added and VBE > Tools > References > Microsoft Scripting RunTime) </p>\n\n<hr>\n\n<h2>\u2461 <strong>Parsing the responseText with a regex to get the rates:</strong></h2>\n\n<p>The regex I will use is </p>\n\n<pre><code>\"cotacaoCompra\":\\d{1,}.\\d{1,}\n</code></pre>\n\n<p>This looks for the literal string  <code>\"cotacaoCompra\":</code>, followed by 1 or more numbers then a \".\", then one of more numbers.</p>\n\n<p><a href=\"https://i.stack.imgur.com/b7g6t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b7g6t.png\" alt=\"Example matches\"></a></p>\n\n<p>I then have to remove the string <code>\"cotacaoCompra\":</code> with a straight forward replace. Ideally, I would just extract the numbers with <code>\"(?&lt;=\"\"cotacaoCompra\"\":)\\d{1,}.\\d{1,}\"</code>; basically, that says after, but not including <code>\"cotacaoCompra\":</code>. But that doesn't appear to be supported.</p>\n\n<p>With that in mind the script to get the rates with regex:</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Public Sub GetInfo2()\n\n    Dim strURL As String, strJSON As String, item As Variant, http As Object, json As Object\n    Const TARGET_CURRENCY As String = \"USD\"\n    Const START_DATE As String = \"06-13-2018\"\n    Const END_DATE As String = \"06-13-2018\"\n\n    strURL = \"https://olinda.bcb.gov.br/olinda/service/PTAX/version/v1/odata/ExchangeRatePeriod(moeda=@moeda,dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?%40moeda=%27\" &amp; TARGET_CURRENCY &amp; \"%27&amp;%40dataInicial=%27\" &amp; START_DATE &amp; \"%27&amp;%40dataFinalCotacao=%27\" &amp; END_DATE &amp; \"%27&amp;%24format=json\"\n\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n    http.Open \"GET\", strURL, False\n    http.send\n    strJSON = http.responseText\n    Dim Matches As Object\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"\"\"cotacaoCompra\"\":\\d{1,}.\\d{1,}\"  'The pattern I really wanted, \"(?&lt;=\"\"cotacaoCompra\"\":)\\d{1,}.\\d{1,}\", doesn't appear to be supported\n\n        If Not .test(strJSON) Then Exit Sub\n        Set Matches = .Execute(strJSON)\n\n        Dim match As Object\n        For Each match In Matches\n            Debug.Print Replace(match, \"\"\"cotacaoCompra\"\":\", vbNullString)\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8540072, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ibnFzldx6iM/AAAAAAAAAAI/AAAAAAAAAA8/E9ckpL_f6bY/photo.jpg?sz=128", "display_name": "Igor Medici", "link": "https://stackoverflow.com/users/8540072/igor-medici"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1580106100, "creation_date": 1504125486, "last_edit_date": 1580106100, "question_id": 45969316, "link": "https://stackoverflow.com/questions/45969316/submit-or-bypass-form-for-a-web-query", "title": "Submit or bypass form for a Web Query", "body": "<p>I'm trying to get dollar exchange rate from <a href=\"http://www4.bcb.gov.br/pec/taxas/port/ptaxnpesq.asp?id=txcotacao\" rel=\"nofollow noreferrer\">http://www4.bcb.gov.br/pec/taxas/port/ptaxnpesq.asp?id=txcotacao</a> into a Excel spreadsheet.</p>\n\n<p>I tried to paste as refreshable web query, however, the page opens one step earlier with a form, which has default inputs (that work for me) and then the query copies stuff from this page. </p>\n\n<p>I tried to write a code to submit the form. I tried the <code>.submit</code>, <code>.Click</code>, <code>.FireEvent</code> and many other things I found on internet.</p>\n\n<p>I tried to refer to the button by its name, class, tag, ... </p>\n\n<pre><code>&lt;input title=\"Pesquisar\" class=\"botao\" onclick=\"limparVazio()\" type=\"submit\" value=\"Pesquisar\"&gt;\n</code></pre>\n\n<p>I tried to trigger the form directly or bypass it</p>\n\n<pre><code>&lt;form name=\"consultarBoletimForm\" action=\"/ptax_internet/consultaBoletim.do?method=consultarBoletim\" method=\"post\"&gt;\n</code></pre>\n"}, {"tags": ["database", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504124544, "post_id": 45968990, "comment_id": 78897400, "body": "It is possible with formula, but with large amounts of data it is not the best solution.  You will want vba."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1504124860, "post_id": 45968990, "comment_id": 78897564, "body": "It would be most reasonable to perform this function with code; the formula method would... take a while longer.  Automation is your friend.  If you have any code you&#39;ve tried yourself, please provide so we can work to help you advance code to a working solution.  Note that Stack Overflow does not simply code for people, but collaborates to help fix issues with coding.  A suggestion for this particular topic would be to loop through your initial data and use a Select Case for parameters, assuming your list of physical characteristics would have be fixed maximum parameters."}, {"owner": {"reputation": 1, "user_id": 8540005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea49165982ed34267056bf28d8f41f1?s=128&d=identicon&r=PG&f=1", "display_name": "Jet Munday", "link": "https://stackoverflow.com/users/8540005/jet-munday"}, "edited": false, "score": 0, "creation_date": 1504124922, "post_id": 45968990, "comment_id": 78897605, "body": "I&#39;ll try to work through some code tonight and post results tomorrow."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1504135560, "post_id": 45968990, "comment_id": 78901337, "body": "If you have Excel 2010 or later, you can use <code>Power Pivot</code>, aka <code>Get &amp; Transform</code> in 2016.  Merely Pivot on the <code>Parameter</code> Column; select <code>Value</code> for the <code>Values</code> column, and <code>do not aggregate</code> under <code>Advanced Options</code>.  It will produce exactly what you show."}, {"owner": {"reputation": 1, "user_id": 8540005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea49165982ed34267056bf28d8f41f1?s=128&d=identicon&r=PG&f=1", "display_name": "Jet Munday", "link": "https://stackoverflow.com/users/8540005/jet-munday"}, "edited": false, "score": 0, "creation_date": 1504173173, "post_id": 45968990, "comment_id": 78915660, "body": "This works perfectly, thanks!"}], "owner": {"reputation": 1, "user_id": 8540005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea49165982ed34267056bf28d8f41f1?s=128&d=identicon&r=PG&f=1", "display_name": "Jet Munday", "link": "https://stackoverflow.com/users/8540005/jet-munday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504134695, "creation_date": 1504124142, "last_edit_date": 1531161705, "question_id": 45968990, "link": "https://stackoverflow.com/questions/45968990/transforming-unique-rows-to-columns-in-excel-while-keeping-their-values", "title": "Transforming unique rows to columns in excel while keeping their values", "body": "<p>I am currently trying to work out a problem: I want to clean-up a system that has a product's parameters written in one column and their values next to them, whereas it should have the parameters as different columns with values underneath them. In addition, some products don't have some parameters.</p>\n\n<p>This is perfectly illustrated by the example below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dATsa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dATsa.png\" alt=\"Illustration of issue and goal\"></a></p>\n\n<p>Is this only possible with macros and code? What are the options to do this for reasonably large databases?</p>\n"}, {"tags": ["vba", "exit", "private-pub"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1504124224, "post_id": 45968966, "comment_id": 78897208, "body": "Create a global variable and update it at the end of your Copier method then check it before DoDays is called...."}, {"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1504124392, "post_id": 45968966, "comment_id": 78897306, "body": "that sounds easy enough, let me try shortly thanks."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1504124810, "post_id": 45968966, "comment_id": 78897537, "body": "Or call <code>DoDays</code> (when required) from within <code>Copier</code> instead of from within <code>COPY_NUMBER_Click</code>.  (But that will still leave <code>COPY_NUMBER.BackColor = 12500670</code> <code>COPY_NUMBER.Enabled = True</code> being executed within <code>COPY_NUMBER_Click</code>, so maybe that isn&#39;t a good idea, or maybe it is a better idea than exiting before those statements.)"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1504124871, "post_id": 45968966, "comment_id": 78897571, "body": "Or switch <code>copier</code> to a boolean function and set it equal to true just before the <code>End Function</code>. Then switch your call to <code>If Not Copier Then Exit Sub</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504124918, "post_id": 45968966, "comment_id": 78897601, "body": "^ basically <i>anything</i> but a global variable ;-)"}, {"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "edited": false, "score": 0, "creation_date": 1504125003, "post_id": 45968966, "comment_id": 78897644, "body": "Seems like second answers works better.  What did I do wrong in the first? See image above."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1504125199, "post_id": 45968966, "comment_id": 78897742, "body": "Oh, please don&#39;t do that. Paste your actual code into the post, with 4 leading spaces for every line (like you did with that code block at the top). Nobody wants to work off screenshots."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1504125496, "post_id": 45968966, "comment_id": 78897875, "body": "What you did wrong is not making it a global variable. You declared <code>z</code> within <code>Copier</code> so its scope is limited to that one procedure."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504125742, "post_id": 45968966, "comment_id": 78897989, "body": "Move your <code>COPY_NUMBER.BackColor = 12500670</code> <code>COPY_NUMBER.Enabled = False</code> statements after where <code>DoDays</code> now is.  (Or, better still, just move your <code>Copier</code> code into <code>COPY_NUMBER_Click</code>.)"}, {"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "edited": false, "score": 0, "creation_date": 1504126073, "post_id": 45968966, "comment_id": 78898146, "body": "So I want them to be able to click the button again to enter the copier input again so last option is not an option."}, {"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "edited": false, "score": 0, "creation_date": 1504126367, "post_id": 45968966, "comment_id": 78898291, "body": "Global variable works.  Can you post as answer so I can accept."}, {"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1504126481, "post_id": 45968966, "comment_id": 78898341, "body": "@ChristopherD. how do I set the copier function to a boolean?"}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "edited": false, "score": 0, "creation_date": 1504126527, "post_id": 45969525, "comment_id": 78898368, "body": "that would probably work also,  i will test that later"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1504126414, "creation_date": 1504126414, "answer_id": 45969525, "question_id": 45968966, "link": "https://stackoverflow.com/questions/45968966/vba-end-private-sub-if-first-sub-routine-is-exited/45969525#45969525", "title": "VBA End Private Sub if First Sub Routine is exited", "body": "<p>I would merge the <code>Copier</code> procedure into the <code>COPY_NUMBER_Click</code> event procedure:</p>\n\n<pre><code>Private Sub COPY_NUMBER_Click()\n    COPY_NUMBER.BackColor = 12713921\n\n    Dim x As String\n    x = InputBox(\"Enter Number of Days in Month\")\n    If x = \"\" Then\n         MsgBox \"User Pressed Cancel!\" &amp; vbCrLf &amp; _\n                \"or did not enter a value!\", vbOKOnly + vbInformation, _\n                \"Inputbox Result:\"\n         Exit Sub\n    ElseIf CInt(x) = 0 Then\n         MsgBox \"User Pressed Cancel!\" &amp; vbCrLf &amp; _\n                \"or did not enter a value!\", vbOKOnly + vbInformation, _\n                \"Inputbox Result:\"\n         Exit Sub\n    End If\n    y = CInt(x) - 1\n    For numtimes = 1 To y\n        ActiveWorkbook.Sheets(\"Sheet1\").Copy _\n                     After:=ActiveWorkbook.Sheets(\"Sheet1\")\n    Next\n\n    DoDays\n\n    COPY_NUMBER.BackColor = 12500670\n    COPY_NUMBER.Enabled = False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1504126639, "creation_date": 1504126639, "answer_id": 45969577, "question_id": 45968966, "link": "https://stackoverflow.com/questions/45968966/vba-end-private-sub-if-first-sub-routine-is-exited/45969577#45969577", "title": "VBA End Private Sub if First Sub Routine is exited", "body": "<p>Create a global variable and update it at the end of your Copier method then check it before DoDays is called</p>\n\n<pre><code>Private bRunDoDays As Boolean\nSub Copier()\n'set to false\nbRunDoDays = False\nDim x As String\nDim z As Integer\nx = InputBox(\"Enter Number of Days in Month\")\nIf x = \"\" Then\n     MsgBox \"User Pressed Cancel!\" &amp; vbCrLf &amp; _\n            \"or did not enter a value!\", vbOKOnly + vbInformation, _\n            \"Inputbox Result:\"\n     z = 10\n     Exit Sub\nElseIf CInt(x) = 0 Then\n     MsgBox \"User Pressed Cancel!\" &amp; vbCrLf &amp; _\n            \"or did not enter a value!\", vbOKOnly + vbInformation, _\n            \"Inputbox Result:\"\n     z = 10\n     Exit Sub\nElse: End If\ny = CInt(x) - 1\nFor numtimes = 1 To y\nActiveWorkbook.Sheets(\"Sheet1\").Copy _\nafter:=ActiveWorkbook.Sheets(\"Sheet1\")\nNext\n'set to true\nbRunDoDays = True\n\nEnd Sub\n\n\n\nPrivate Sub COPY_NUMBER_Click()\nCOPY_NUMBER.BackColor = 12713921\nCopier\nIf bRunDoDays = False Then Exit Sub\nDoDays\nCOPY_NUMBER.BackColor = 12500670\nCOPY_NUMBER.Enabled = False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1504126646, "creation_date": 1504126646, "answer_id": 45969582, "question_id": 45968966, "link": "https://stackoverflow.com/questions/45968966/vba-end-private-sub-if-first-sub-routine-is-exited/45969582#45969582", "title": "VBA End Private Sub if First Sub Routine is exited", "body": "<p>You can change <code>Copier</code> to a Boolean Function and edit the call to test whether it executed successfully.</p>\n\n<p>Your call would look like:</p>\n\n<pre><code>If Not Copier Then Exit Sub\n</code></pre>\n\n<p>Your <code>Copier</code> Function would look like:</p>\n\n<pre><code>Public Function Copier() As Boolean   \n  'Does Stuff\n  Copier = True\nEnd Function\n</code></pre>\n\n<p>Make sure you have <code>Option Explicit</code> enabled. It should have thrown a compile error on the <code>If z = 10 Then Exit Sub</code> since it is out of scope.</p>\n"}], "owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1330, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1504126646, "creation_date": 1504124039, "last_edit_date": 1504125656, "question_id": 45968966, "link": "https://stackoverflow.com/questions/45968966/vba-end-private-sub-if-first-sub-routine-is-exited", "title": "VBA End Private Sub if First Sub Routine is exited", "body": "<p>I want the entire Private Sub to Exit if the Copier routine is exited. So the DoDays routines is never called.</p>\n\n<pre><code>Sub Copier()\nDim x As String\nDim z As Integer\nx = InputBox(\"Enter Number of Days in Month\")\nIf x = \"\" Then\n     MsgBox \"User Pressed Cancel!\" &amp; vbCrLf &amp; _\n            \"or did not enter a value!\", vbOKOnly + vbInformation, _\n            \"Inputbox Result:\"\n     z = 10\n     Exit Sub\nElseIf CInt(x) = 0 Then\n     MsgBox \"User Pressed Cancel!\" &amp; vbCrLf &amp; _\n            \"or did not enter a value!\", vbOKOnly + vbInformation, _\n            \"Inputbox Result:\"\n     z = 10\n     Exit Sub\nElse: End If\ny = CInt(x) - 1\nFor numtimes = 1 To y\nActiveWorkbook.Sheets(\"Sheet1\").Copy _\nafter:=ActiveWorkbook.Sheets(\"Sheet1\")\nNext\n\nDoDays\n\nEnd Sub\n\n\n\nPrivate Sub COPY_NUMBER_Click()\nCOPY_NUMBER.BackColor = 12713921\nCopier\n' DoDays\nCOPY_NUMBER.BackColor = 12500670\nCOPY_NUMBER.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>The call to the DoDays in the Copier sub doesn't seem to work because I literally need to exit the Private Sub so the button remains enabled.</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504124082, "post_id": 45968870, "comment_id": 78897126, "body": "Use an <code>Else</code> clause in your <code>If</code> statement - <code>If Range(&quot;B1&quot;).Value = DateSerial(2017,8,1) Then ... Else ...</code> or, if you have several possible conditions, use a multi-line <code>If</code> (i.e. <code>If ... Then</code> <code>...</code> <code>ElseIf ... Then</code> <code>...</code> <code>ElseIf ... Then</code> <code>...</code> <code>Else</code> <code>...</code> <code>End If</code>) or a <code>Select Case Range(&quot;B1&quot;).Value</code> block."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1504124136, "post_id": 45968870, "comment_id": 78897157, "body": "Don&#39;t forget to end your <code>If</code> statements with <code>End If</code>, always!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1504124171, "post_id": 45968870, "comment_id": 78897178, "body": "@dwirony Not on single-line <code>If</code> statements, only on multi-line ones."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504124248, "post_id": 45968870, "comment_id": 78897233, "body": "@YowE3K Wow, I didn&#39;t even know you could do that... I always figured that was just bad formatting. Looks like I&#39;m still an excel noob!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1504124287, "post_id": 45968870, "comment_id": 78897257, "body": "@dwirony LOL - we are <b>all</b> Excel noobs !!"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504124297, "post_id": 45968870, "comment_id": 78897265, "body": "As you have it now, the code will copy the range specified only if B1 equals 8/1/2017. But in your question you seem to want the range copied if B1 equals 8/2/2017 -- is that just a typo?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504124597, "post_id": 45968870, "comment_id": 78897424, "body": "Apart from using <code>Else</code> conditions on the <code>If</code>, if there is any pattern to what worksheet / range needs to be updated on the different dates, it might be possible to calculate the worksheet name based on the date (e.g. if the sheet was &quot;Dispute 01&quot; on the 1st of the month and &quot;Dispute 02&quot; on the 2nd of the month, you could use <code>Worksheets(&quot;Dispute &quot; &amp; Format(Range(&quot;B1&quot;).Value, &quot;dd&quot;)).Range...</code>) and avoid the <code>If</code> altogether."}], "owner": {"reputation": 11, "user_id": 8127207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FMeSO0g0hGw/AAAAAAAAAAI/AAAAAAAAAN0/1WN6UpqEDB4/photo.jpg?sz=128", "display_name": "Jv Fernandez", "link": "https://stackoverflow.com/users/8127207/jv-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504204172, "creation_date": 1504123627, "last_edit_date": 1504204172, "question_id": 45968870, "link": "https://stackoverflow.com/questions/45968870/copy-cell-data-and-paste-on-different-ranges-based-on-date", "title": "Copy cell data and paste on different ranges based on date", "body": "<p>Hi I'm extremely new to this and I would like to seek assistance with my code. </p>\n\n<p>Please see my code below:</p>\n\n<pre><code>Sub Copy_Cells_Loop()\n\nApplication.ScreenUpdating = False\n\nIf Range(\"B1\").Value = \"8/1/2017\" Then Worksheets(\"Dispute\").Range(\"C2:C76\").Value = Range(\"H9:H83\").Value\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>So what i'm looking for is that if the value of B1 changed from 8/1/2017 to 8/2/2017, the date will be paste to another worksheet to a different range. Please help me. :(</p>\n"}, {"tags": ["ms-access", "listbox", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1504165047, "post_id": 45968742, "comment_id": 78910175, "body": "<code>AfterUpdate</code> events don&#39;t fire when you change the control&#39;s value via code."}, {"owner": {"reputation": 344, "user_id": 2879786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b267ee8399aa7f44e10c1b4dfb2870?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ibarra", "link": "https://stackoverflow.com/users/2879786/nicholas-ibarra"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1504191961, "post_id": 45968742, "comment_id": 78929119, "body": "@Andre that is what I thought, but it does fire when the form loads. But changing the value in code after the form has already loaded does not fire the event. I would like to disable this function, although I&#39;m pretty sure that is not possible."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1504125373, "creation_date": 1504125373, "answer_id": 45969300, "question_id": 45968742, "link": "https://stackoverflow.com/questions/45968742/access-listbox-afterupdate-not-firing-when-selected-true/45969300#45969300", "title": "Access Listbox AfterUpdate Not Firing when Selected = True", "body": "<p>You could use two custom functions and use optional parameters to know the context in which it is called. That way you have full control over when which function does which.</p>\n\n<p>E.g. </p>\n\n<pre><code>Public Sub MyFunc1 (Optional CalledFromLoad As Boolean)\nPublic Sub MyFunc2 (Optional CalledFromLoad As Boolean)\n\nPrivate Sub comboBox_AfterUpdate()\n     Call MyFunc1 False\nEnd Sub\nPrivate Sub listbox_AFterUpdate()\n   Call MyFunc2 False\nEnd Sub\nPrivate Sub Form_Open(Cancel As Integer)\n   Call MyFunc1 True\nEnd Sub\n</code></pre>\n\n<p>Moving all your code gives you a greater degree of customization, and can help you avoid calling the same code twice.</p>\n\n<p>You could possibly set a global variable in <code>MyFunc1</code>, then trigger <code>MyFunc2</code> by changing the listbox, and then reset that global variable again. Numerous solutions are possible.</p>\n"}], "owner": {"reputation": 344, "user_id": 2879786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b267ee8399aa7f44e10c1b4dfb2870?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Ibarra", "link": "https://stackoverflow.com/users/2879786/nicholas-ibarra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 45969300, "answer_count": 1, "score": 1, "last_activity_date": 1504125373, "creation_date": 1504123027, "last_edit_date": 1504123497, "question_id": 45968742, "link": "https://stackoverflow.com/questions/45968742/access-listbox-afterupdate-not-firing-when-selected-true", "title": "Access Listbox AfterUpdate Not Firing when Selected = True", "body": "<p>I have an Access form with a listbox and a combo box. </p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n   '... misc code\n   me.comboBox.RowSource = \"sql statement\"\n   call comboBox_AfterUpdate\nEnd Sub\n\nPrivate Sub comboBox_AfterUpdate()\n   listbox.Selected(0) = true\nEnd Sub\n\nPrivate Sub listbox_AFterUpdate()\n   '.... important code that updates the form\nEnd Sub\n</code></pre>\n\n<p>On the form load/open, the the code runs as</p>\n\n<pre><code>Form_Open &gt; comboBox_AfterUpdate &gt; listbox_AfterUpdate \n</code></pre>\n\n<p>However after the form has already loaded, when the combo box is changed and the comboBox_AfterUpdate is triggered, the listbox_AfterUpdate() is NOT triggered. </p>\n\n<p>I would move the code in the listbox_AfterUpdate() to a separate sub-routine, but that would call the code to run twice when the form loads. Any ideas on why this happens? </p>\n\n<p>Similar issue here: \n<a href=\"http://www.tek-tips.com/viewthread.cfm?qid=1395160\" rel=\"nofollow noreferrer\">http://www.tek-tips.com/viewthread.cfm?qid=1395160</a></p>\n"}, {"tags": ["vba", "excel", "dbf", "dbase"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504139468, "post_id": 45968735, "comment_id": 78902054, "body": "In Access,  import your excel sheet,  and in Access export the table as dbf."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504159683, "post_id": 45968735, "comment_id": 78907320, "body": "I want that has done programmatically and without user prompt . (Silent) Which code can write in Excel module with this approach, that get me <code>.dbf</code> format result from an initial Excel <code>Range</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1504182046, "post_id": 45975040, "comment_id": 78921817, "body": "I want code works in memory (silent) without save (temp) data and using path and file name."}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1504183065, "post_id": 45975040, "comment_id": 78922505, "body": "Is there any quick and quite way to export directly <code>dbf</code> from excel range?; as using <code>ADOBE</code> connection or ect..."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1504162394, "creation_date": 1504162394, "answer_id": 45975040, "question_id": 45968735, "link": "https://stackoverflow.com/questions/45968735/export-dbf-from-a-table-in-excel-with-consider-and-pay-attention-to-datatype-an/45975040#45975040", "title": "Export DBF from a Table in Excel (with consider and pay attention to Datatype and length of fields)", "body": "<p>This code is not perfect. Just refer to it.</p>\n\n<pre><code>Sub myQuery()\n    Dim path As String, pathExcel As String\n    Dim dbName As String\n    'Dim App As Access.Application\n    Dim App As Object\n\n    'Set App = New Access.Application\n    On Error Resume Next\n    Set App = CreateObject(\"Access.Application\")\n\n    path = \"C:\\Users\\Administrator\\Documents\\\"\n    pathExcel = ThisWorkbook.FullName\n\n    dbName = \"C:\\Users\\Administrator\\Documents\\Database1.accdb\" '&lt;~~ in access, you create accdb(Database1.accdb) before.\n\n    App.OpenCurrentDatabase dbName\n\n    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"Sheet1\", pathExcel '&lt;~~from sheet1 to access\n\n    App.DoCmd.TransferDatabase acExport, \"DBase IV\", path, acTable, \"Sheet1\", \"test.dbf\" '&lt;~~ access table to dbf\n    DoCmd.DeleteObject acTable, \"Sheet1\"\n\n    App.DoCmd.Close\n    App.DoCmd.Quit\n    App.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1098, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504191252, "creation_date": 1504122999, "last_edit_date": 1531164843, "question_id": 45968735, "link": "https://stackoverflow.com/questions/45968735/export-dbf-from-a-table-in-excel-with-consider-and-pay-attention-to-datatype-an", "title": "Export DBF from a Table in Excel (with consider and pay attention to Datatype and length of fields)", "body": "<p>I'm working in an macro container Excel <code>Workbook</code> on a <code>Table</code> in <code>Sheet1</code>.</p>\n\n<p>And have to create DBF file from the <code>Table</code> With <code>VBA</code> macro.</p>\n\n<p>1-note that after 2003, Excel not support <code>DBF</code> format, thus I cannot use bellow...</p>\n\n<pre><code>ActiveWorkbook.SaveAs _\n    Filename:=\"C:\\insurance.dbf\", _\n    FileFormat:=xlDBF4, _\n    CreateBackup:=False\n</code></pre>\n\n<p>So, please write a <code>VBA</code> macro which save <code>DBF</code> from a <code>Filtered</code> range (a range with multi <code>Area</code>) of that <code>Table</code> in MS-Excel <code>Worksheet</code>.</p>\n\n<p>2- May i define my customized data type to each field in created <code>DBF</code> by above hypothetical <code>VBA</code> macro?</p>\n\n<p><strong>I Don't want opening or edit an existing <code>*.dbf</code>. I'm just going create and save <code>DBF</code> with customized <code>Datatype</code> and <code>length</code> if possible; from a multi area filtered range table in <code>Worksheet</code> with a <code>VBA</code> <code>function</code>.</strong></p>\n\n<p>Can we use:</p>\n\n<pre><code>Dim appAccess as Object\nset appAccess = CreateObject(\"Acss.App\")\n...\nappAccess.Run ...\n</code></pre>\n\n<p>For that?! (As an idea)</p>\n\n<p>Thanks.</p>\n\n<p>For more description:</p>\n\n<p>Are there any quick and quiet way to export <code>dbf</code> file from a range of Excel? If existing direct way to create and save <code>dbf</code> file from that range, that is better.</p>\n"}, {"tags": ["vba", "excel", "internet-explorer-11"], "comments": [{"owner": {"reputation": 611, "user_id": 6088149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d79fb7d7780ae4e18563361cd4512c48?s=128&d=identicon&r=PG", "display_name": "exSnake", "link": "https://stackoverflow.com/users/6088149/exsnake"}, "edited": false, "score": 0, "creation_date": 1504125045, "post_id": 45968711, "comment_id": 78897666, "body": "Can you post the link to the page or something similar for testing your code?"}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 1, "creation_date": 1504125111, "post_id": 45968711, "comment_id": 78897705, "body": "Is this handled from the click event or are all 8 options hard coded in the HTML page?  For the first one, you may try <code>IE.Document.getElementById(&quot;the id you have&quot;).SelectedIndex = 0</code>.  For the second one, you can try <code>IE.Document.getElementById(&quot;the id you have&quot;).Value = &quot;custom&quot;</code>."}, {"owner": {"reputation": 135, "user_id": 5104055, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8199307b213a1c7fc74ff82098bf2f98?s=128&d=identicon&r=PG&f=1", "display_name": "acvbasql", "link": "https://stackoverflow.com/users/5104055/acvbasql"}, "edited": false, "score": 0, "creation_date": 1504125523, "post_id": 45968711, "comment_id": 78897887, "body": "I can&#39;t post the link, it&#39;s behind a login page.  I added the code for that section though.  There are no element IDs, just the names"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 5104055, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8199307b213a1c7fc74ff82098bf2f98?s=128&d=identicon&r=PG&f=1", "display_name": "acvbasql", "link": "https://stackoverflow.com/users/5104055/acvbasql"}, "edited": false, "score": 0, "creation_date": 1504201576, "post_id": 45971927, "comment_id": 78934672, "body": "I don&#39;t follow.  Do you have more detail?"}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1504143142, "creation_date": 1504143142, "answer_id": 45971927, "question_id": 45968711, "link": "https://stackoverflow.com/questions/45968711/vba-ie11-locking-in-a-change-to-a-dropdown-value/45971927#45971927", "title": "VBA IE11 locking in a change to a dropdown value", "body": "<p>you need to set the <code>selected</code> attribute .... ref: <a href=\"https://www.w3schools.com/tags/tryit.asp?filename=tryhtml_option_selected\" rel=\"nofollow noreferrer\">https://www.w3schools.com/tags/tryit.asp?filename=tryhtml_option_selected</a></p>\n"}], "owner": {"reputation": 135, "user_id": 5104055, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8199307b213a1c7fc74ff82098bf2f98?s=128&d=identicon&r=PG&f=1", "display_name": "acvbasql", "link": "https://stackoverflow.com/users/5104055/acvbasql"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504143142, "creation_date": 1504122923, "last_edit_date": 1504125488, "question_id": 45968711, "link": "https://stackoverflow.com/questions/45968711/vba-ie11-locking-in-a-change-to-a-dropdown-value", "title": "VBA IE11 locking in a change to a dropdown value", "body": "<p>I'm using VBA to open a website, login, and navigate to a certain page.  There is a dropdown with 8 options.  </p>\n\n<p>I used this code to change the dropdown to the value I want, but it always reverts back to the default as I continue.  How do I lock this change in?  </p>\n\n<pre><code>Set Element = IE.Document.getElementsByName(\"date_range\")\nElement.Item(0).Value = \"custom\"\n</code></pre>\n\n<p>Here's the page code:</p>\n\n<pre><code>&lt;div class=\"SelectInput\"&gt;\n&lt;select class=\"SelectInput-select\" name=\"date_range\"&gt;\n    &lt;option value=\"all_time\"&gt;All Time&lt;/option&gt;\n    &lt;option value=\"today\"&gt;Today&lt;/option&gt;\n    &lt;option value=\"yesterday\"&gt;Yesterday&lt;/option&gt;\n    &lt;option value=\"this_month\"&gt;Month to date&lt;/option&gt;\n    &lt;option value=\"last_month\"&gt;Last Month&lt;/option&gt;\n    &lt;option value=\"this_year\"&gt;Year to date&lt;/option&gt;\n    &lt;option value=\"last_year\"&gt;Last year&lt;/option&gt;\n    &lt;option value=\"custom\"&gt;Between...&lt;/option&gt;\n&lt;/select&gt;\n&lt;div class=\"SelectInput-arrows\"&gt;...&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["vb.net", "vba", "ms-word"], "comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1504123046, "post_id": 45968357, "comment_id": 78896600, "body": "<b><i>and... What have you tried?</i></b>"}, {"owner": {"reputation": 1, "user_id": 8520969, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qmQ3ilYwC-M/AAAAAAAAAAI/AAAAAAAAFVk/lY1-Q1fTs4M/photo.jpg?sz=128", "display_name": "Tareq Mhedi", "link": "https://stackoverflow.com/users/8520969/tareq-mhedi"}, "reply_to_user": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1504124533, "post_id": 45968357, "comment_id": 78897391, "body": "Public Class Form1     Dim oWord As Word.Application     Dim oDoc As Word.Document     Dim oRng As Word.Range     Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click         oWord = New Word.Application         oDoc = oWord.Documents.Open(&quot;C:\\file.docx&quot;)         oWord.Visible = True         oRng = oDoc.Content         If oRng.Font.Color = Word.WdColor.wdColorBlack Then             oRng.Delete()         End If         oWord.Documents.Item(1).Save()         oWord.Quit()         oWord = Nothing End Sub End Class"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1504134314, "post_id": 45968357, "comment_id": 78901031, "body": "<a href=\"https://stackoverflow.com/posts/45968357/edit\">Edit</a> your post and add the code you tried along with a specific problem or question and maybe tit will get reopened.  Study <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and maybe visit the <a href=\"https://stackoverflow.com/help\">help center</a> for tips on asking a good question"}], "owner": {"reputation": 1, "user_id": 8520969, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qmQ3ilYwC-M/AAAAAAAAAAI/AAAAAAAAFVk/lY1-Q1fTs4M/photo.jpg?sz=128", "display_name": "Tareq Mhedi", "link": "https://stackoverflow.com/users/8520969/tareq-mhedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1504170993, "creation_date": 1504121328, "last_edit_date": 1504147228, "question_id": 45968357, "link": "https://stackoverflow.com/questions/45968357/how-to-remove-colored-text-in-microsoft-word-document-via-vb-net", "title": "How to remove colored text in Microsoft Word document via VB.NET?", "body": "<p>How to remove colored text in <em>Microsoft Word</em> via <a href=\"/questions/tagged/vb.net\" class=\"post-tag\" title=\"show questions tagged &#39;vb.net&#39;\" rel=\"tag\">vb.net</a></p>\n\n<pre><code>Public Class Form1\n    Dim oWord As Word.Application \n    Dim oDoc As Word.Document \n    Dim oRng As Word.Range \n\n    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click \n    oWord = New Word.Application \n    oDoc = oWord.Documents.Open(\"C:\\file.docx\") \n    oWord.Visible = True \n    oRng = oDoc.Content \n    If oRng.Font.Color = Word.WdColor.wdColorBlack Then \n        oRng.Delete() \n    End If \n    oWord.Documents.Item(1).Save() \n    oWord.Quit() \n    oWord = Nothing \n    End Sub \nEnd Class\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/0V0NO.png\" alt=\"\"></p>\n"}, {"tags": ["vba", "formula"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8539763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d79a4e0faa4ddaabec681e6c02d54a1?s=128&d=identicon&r=PG&f=1", "display_name": "Growth128", "link": "https://stackoverflow.com/users/8539763/growth128"}, "edited": false, "score": 0, "creation_date": 1504125889, "post_id": 45968862, "comment_id": 78898053, "body": "Yes, CName is the cell I want to have in the formula, which is dynamic depending on the data.  So CName may be F2, D2 or whatever depending on the data.  I was going down this exact same road as what you have above, but for some reason it does not work, but I do not get an error from vba editor either.  Any idea?  Also, what do you dim CName as?  Thank you."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 1, "user_id": 8539763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d79a4e0faa4ddaabec681e6c02d54a1?s=128&d=identicon&r=PG&f=1", "display_name": "Growth128", "link": "https://stackoverflow.com/users/8539763/growth128"}, "edited": false, "score": 0, "creation_date": 1504191256, "post_id": 45968862, "comment_id": 78928626, "body": "Tehscript&#39;s answer is more complete and you&#39;ll have the CHR(34) that eliminates the need for two quotes.   Dim CName as a string, since the .address returns a string."}, {"owner": {"reputation": 1, "user_id": 8539763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d79a4e0faa4ddaabec681e6c02d54a1?s=128&d=identicon&r=PG&f=1", "display_name": "Growth128", "link": "https://stackoverflow.com/users/8539763/growth128"}, "edited": false, "score": 0, "creation_date": 1504194311, "post_id": 45968862, "comment_id": 78930789, "body": "Yeah, thank you to Tehscript, but his script hardcodes F3 into the formula.  Though he did gave me intuition into where by my codes showed no errors but just didn&#39;t run.  Thank you to you both!"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1504123580, "creation_date": 1504123580, "answer_id": 45968862, "question_id": 45968328, "link": "https://stackoverflow.com/questions/45968328/vba-to-write-formula-with-dynamic-cell-reference/45968862#45968862", "title": "vba to write formula with dynamic cell reference", "body": "<p>If CName is the address of the cell you want to have the formula in, then try something like:</p>\n\n<pre><code>ActiveCell.Formula = \"=BDP(\" &amp; CName &amp; \"\"&amp; cusip\"\", \"\"security des\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 1, "last_activity_date": 1504123677, "creation_date": 1504123677, "answer_id": 45968882, "question_id": 45968328, "link": "https://stackoverflow.com/questions/45968328/vba-to-write-formula-with-dynamic-cell-reference/45968882#45968882", "title": "vba to write formula with dynamic cell reference", "body": "<p>You can make <code>Cname</code> variable dynamic if you like:</p>\n\n<pre><code>CName = Range(\"F3\").Address\nActiveCell.Formula = \"=BDP(\" &amp; CName &amp; Chr(34) &amp; \" cusip\" &amp; Chr(34) &amp; \", \" &amp; Chr(34) &amp; \"security des\" &amp; Chr(34) &amp; \")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1504199227, "post_id": 45985508, "comment_id": 78933508, "body": "Don&#39;t forget to upvote the help and select an answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 8539763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d79a4e0faa4ddaabec681e6c02d54a1?s=128&d=identicon&r=PG&f=1", "display_name": "Growth128", "link": "https://stackoverflow.com/users/8539763/growth128"}, "is_accepted": true, "score": 0, "last_activity_date": 1504194535, "creation_date": 1504194535, "answer_id": 45985508, "question_id": 45968328, "link": "https://stackoverflow.com/questions/45968328/vba-to-write-formula-with-dynamic-cell-reference/45985508#45985508", "title": "vba to write formula with dynamic cell reference", "body": "<p>Thank you all for the feedback and support!  I figured it out after taking a break and reviewing your ideas!  So by inserting the below will do the trick!  I guess .address (,) is absolutely necessary.</p>\n\n<p>&amp; CName.Address(False, False) &amp; </p>\n\n<p>Thanks again! </p>\n"}], "owner": {"reputation": 1, "user_id": 8539763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d79a4e0faa4ddaabec681e6c02d54a1?s=128&d=identicon&r=PG&f=1", "display_name": "Growth128", "link": "https://stackoverflow.com/users/8539763/growth128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2106, "favorite_count": 0, "accepted_answer_id": 45985508, "answer_count": 3, "score": 0, "last_activity_date": 1504194535, "creation_date": 1504121250, "last_edit_date": 1504121944, "question_id": 45968328, "link": "https://stackoverflow.com/questions/45968328/vba-to-write-formula-with-dynamic-cell-reference", "title": "vba to write formula with dynamic cell reference", "body": "<pre><code>=BDP(F3&amp; \" cusip\", \"security des\")\n</code></pre>\n\n<p>Hi all,</p>\n\n<p>I am trying to write a macro that will insert the above exact formula (with the only difference being the F3 reference cell) into my current active cell.  Below is the actual vba code.  </p>\n\n<p>I just need the <code>\"F3\"</code> cell below to reference a variable cell that is determined by Excel/vba every time that I run the macro.  </p>\n\n<p>I already have the code to have vba/Excel determine the cell.  Lets just say this variable cell is set as <code>CName</code>.  So <code>CName</code> houses the cell I would like to use--be it F3, D2 or whatever.</p>\n\n<pre><code>ActiveCell.Formula = \"=BDP(F3&amp;\"\" cusip\"\", \"\"security des\"\")\"\n</code></pre>\n\n<p>Can someone help?  Thank you!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1504124140, "post_id": 45968252, "comment_id": 78897160, "body": "This article should help you out. <a href=\"https://msdn.microsoft.com/en-us/library/office/bb687891.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/bb687891.aspx</a> Specifically the part about using Volatile"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1504131763, "post_id": 45968252, "comment_id": 78900335, "body": "Why do you think you need to wait before running formulas? When the data changes, the formulas will update immediately. What is the problem?"}, {"owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "edited": false, "score": 0, "creation_date": 1504162160, "post_id": 45968252, "comment_id": 78908468, "body": "Really don&#39;t know what is your actual problem :("}, {"owner": {"reputation": 11, "user_id": 8539794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e399ddc11181a716ce8c1e70a59aa16?s=128&d=identicon&r=PG&f=1", "display_name": "Hans H", "link": "https://stackoverflow.com/users/8539794/hans-h"}, "edited": false, "score": 0, "creation_date": 1504583744, "post_id": 45968252, "comment_id": 79053092, "body": "I figured it out.  I cannot use a formula type like an if statement on the first sheet.  When I move the formula to the second sheet it works... strange but it only took 8 hours of different approaches...."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8539794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e399ddc11181a716ce8c1e70a59aa16?s=128&d=identicon&r=PG&f=1", "display_name": "Hans H", "link": "https://stackoverflow.com/users/8539794/hans-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1504584060, "creation_date": 1504584060, "answer_id": 46046824, "question_id": 45968252, "link": "https://stackoverflow.com/questions/45968252/delaying-formula-execution-in-excel-to-populate-secondary-sheet/46046824#46046824", "title": "Delaying formula execution in Excel to populate secondary sheet", "body": "<p>By placing the if statement on the second sheet I got the correct results.  </p>\n\n<p>In the Example place the formula on Sheet 2, A15=IF(ISBLANK(A1),A4,A1) verses referencing the result as in the example.</p>\n"}], "owner": {"reputation": 11, "user_id": 8539794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e399ddc11181a716ce8c1e70a59aa16?s=128&d=identicon&r=PG&f=1", "display_name": "Hans H", "link": "https://stackoverflow.com/users/8539794/hans-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504584060, "creation_date": 1504120913, "last_edit_date": 1531161705, "question_id": 45968252, "link": "https://stackoverflow.com/questions/45968252/delaying-formula-execution-in-excel-to-populate-secondary-sheet", "title": "Delaying formula execution in Excel to populate secondary sheet", "body": "<p>I have a workbook that has the first sheet populated from another application similar function as a mail merge.  When the company field is empty I would like the Quote form on the second sheet to use the first and last name fields (concatenated) from sheet one.  I have also tried formating <code>A1,A2,A3,A4</code> as text.  Tried <code>isempty</code>, <code>istext</code> with combinations of Trim, Len all with no results.  If the data is populated from top to bottom and left to right will I need to use a macro to wait for the data to be populated before I can run formulas?</p>\n\n<p>Thanks in advance,</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>Sheet 1\nA1 [Company Name]\nA2 [First Name]\nA3 [Last Name]\nA4 =concatenate(A2,\" \",A3)\nA5 =IF(ISBLANK(A1),A4,A1)\n\nSheet 2\nA15 ='Sheet 1'!$A5\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1504121154, "post_id": 45968196, "comment_id": 78895683, "body": "Have you tried using conditional formatting?"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1504121855, "post_id": 45968196, "comment_id": 78896039, "body": "I need this VBA, for a report. Not something I need to set, or rely on a user to set, unless you are saying that by VBA I can set the conditional formatting, verses coloring the rows.. that would be different. This is a large macro, takes values from various reports, and compiles month after month. The rows with &quot;Deleted&quot;  value in 35, would be highlighted until the next month the report was processed, then I would turn them back clear, rerun steps to identify the new &quot;Deleted:..  But I can just as easily wipe out their value in 35 (as that is hidden for my own intents), if that is better"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1504122067, "post_id": 45968196, "comment_id": 78896138, "body": "I&#39;m open to whatever way makes the most sense, is best approach, and works the fastest, as this is such a large sheet."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504122940, "post_id": 45968509, "comment_id": 78896546, "body": "The value is in AI, or column index 35, however it needs to be phrased, and wherever the value of any cell within columns AI = &quot;Deleted&quot;, it needs to be light red/coral color index 22.  I don&#39;t need to color just the cell, I need to highlight the entire row, or the range from A to AI, in any row where the value of AI is deleted, until the last row the sheet contains. Month after month, the last row will move, as about 1500 rows are added each monthly update."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504123065, "post_id": 45968509, "comment_id": 78896613, "body": "I tried using the conditional format, I did not see where to define the range, or set the entire row.  I can&#39;t seem to get that to work"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504123528, "post_id": 45968509, "comment_id": 78896858, "body": "also it is giving a Syntax error on second line : With sht.Range(sht.Rows(1), sht.Rows(sht.Cells(sht.Rows.Count.End(xlUp).Row, 1))"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504123604, "post_id": 45968509, "comment_id": 78896889, "body": "Give me a sec to update and I&#39;ll leave some comments in where you put your specifics.  As listed, the entire rows will be colored, not just the cell.  The formulas are based on the cell value, though."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504124018, "post_id": 45968509, "comment_id": 78897089, "body": "Try now, for the conditional formatting piece.  If you are adding more items regularly, and the code will have to keep re-applying the conditional formatting, the straight VBA could (last option) would be more appropriate, as it is input directly to your code in the Else part of the if statement."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504125030, "post_id": 45968509, "comment_id": 78897661, "body": "Thank you!!! Btw...  we meet again! I believe you have helped guide me before. I am thinking honestly coding it into the macro without formatting might be best approach.  I did this.  I see it came out a lovely shade of green.   ONLY ONE PROBLEM.. it appears to have skipped a few that have a value of  &quot;Deleted&quot; - any reason why this might happen?"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504125132, "post_id": 45968509, "comment_id": 78897713, "body": "There is not any spaces, or user entry, or other on these cells in the column.  The step above in the code is the ONLY ACTION that touches this column, and places a value in it.  Why would it recognize some deleted, and not others?  - Other than that it is PERFECT, and I think the direction I am going to take.  Just need it to not miss any."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504125223, "post_id": 45968509, "comment_id": 78897754, "body": "and.. last but not least.  Is there a way it highlights A to AI, instead of row?  if the value of AI is &quot;Deleted&quot;"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504125626, "post_id": 45968509, "comment_id": 78897932, "body": "sht.Rows(i) is a Worksheet and a Range.  You can define the Range however you would like, such as Range(Cells(i,1),Cells(i,35)) to specify only so many columns being affected.  As for the &quot;Deleted&quot; not being picked up, see that there isn&#39;t a space, e.g., &quot;Deleted &quot;.  Regarding the color, record a macro and fill a cell with your desired color; copy/paste that into the macro for the desired result."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504182561, "post_id": 45968509, "comment_id": 78922175, "body": "That is the first thing I checked for was hidden spacing. It isn&#39;t plausible as right before I am setting the color, I am setting the value of any cells that do not run through the previous logic statements with an Else statement that sets those to &quot;Deleted&quot;. It is not manual entry, or user entry, or performed in any other action."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504182696, "post_id": 45968509, "comment_id": 78922275, "body": "Is it because I do not have something written to say (but in proper syntax)  &quot;If value of 35 of any cell = Deleted, color it red 22&quot;?  I say this because if may be shading but maybe I don&#39;t have that correct logic.  I am going to update the code snip it above with what the current code is now incorporating your suggestion. :) BTW... thank you for all your help, we meet again :)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504182790, "post_id": 45968509, "comment_id": 78922337, "body": "No worries; hopefully we can get this fixed for you.  I can&#39;t make any promises, but we can look through what you&#39;ve added and hopefully there is something jarring!"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504183242, "post_id": 45968509, "comment_id": 78922630, "body": "Edited it.  Thank you! You are very kind. I am doing rather well and have wrapped up 99% of this, but this last thing was throwing me for a loop, and I find that I overthink where steps could go, and in conjunction with other steps, or in their own block. That is what tends to stump the chump so to speak! lol I am more a workflow Goddess as of late, and I get stuck in that mindset of order of operations, which in a macro, doesn&#39;t necessarily need to flow that same way.."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504183826, "post_id": 45968509, "comment_id": 78923093, "body": "Just ran it again, same result. It is still missing highlighting about 25% of these. It is set to autofilter the result and copy it to another sheet later, in steps after this, but before macro ends, so I see it right away when it completes.  Not sure why it skips these values.. :("}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504185146, "post_id": 45968509, "comment_id": 78924117, "body": "So, the code looks correct, regarding your Else statement.  My guess is your loop For i = 1 to UBound(vDB,1) is causing an issue that makes the loop skip cells.  Have you tried making the backend of the loop a single variable, defined as an integer, e.g., <i>Dim LR as Integer</i>?  Also, specify the Step in that scenario to really make sure, e.g.. <i>For i = 1 to LR Step 1</i>.  That&#39;s about all i can guess at this point.  You may want to use F8 and step-through the code to see if the cells are being assessed or not."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504188418, "post_id": 45968509, "comment_id": 78926537, "body": "I&#39;ve tried to use F8, but it goes so fast, that it literally blinks and changes the cells red. It doesn&#39;t select or show anything.  There is 20K rows on this sheet, so that probably accounts for why as well."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504188587, "post_id": 45968509, "comment_id": 78926663, "body": "I am not sure how to accomplish what you stated for the loop.  The loop is identifying the cells as deleted correctly, it isn&#39;t missing any.  What it tends to skip is the formatting step. After defining ones that are deleted, it does not seem to color them all, without any rhyme or reason that I can see, what it is skipping some. I wish I could post a screenshot, and show you. If I can&#39;t do it during this step, then I need to write a block of syntax that looks for cells with value of &quot;Deleted&quot; in AI, and highlights them red."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504188665, "post_id": 45968509, "comment_id": 78926726, "body": "I am also struggling with A:AI turning red, verses entire row. I have tried to set a new range called colorRng, to refer to, using the A, I and AI, I, and cannot seem to get it work without giving me error."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504191114, "post_id": 45968509, "comment_id": 78928525, "body": "See my edit; hopefully I hit on all topics.  I do believe you&#39;ve an issue with the vDB and how the UBound you&#39;re using in your loop is being utilized."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504196912, "post_id": 45968509, "comment_id": 78932312, "body": "Ok.. here is where I am at.  I ran it using the other way this time, in a stand alone block, and not placed with the VDB, I literally pasted what you wrote as the first option."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504197201, "post_id": 45968509, "comment_id": 78932462, "body": "Specifically the  Dim LR as Integer, copied and pasted it exact.  It is working better..   BUT... It seems to stop.  Is there a limit to how many rows this method will work on?  It quits after row 20,580 .  anything after that, it wont color.  It is also coloring entire row. I need to DIM a range to color A : AI, and that will take from first available row of results to last row of results of autofilter by &quot;delete&quot;  typically this will be MUCH LESS a return than what it is giving now. Around 1308 have value of delete.  Normally it will be under 100 I assume."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504200071, "post_id": 45968509, "comment_id": 78933975, "body": "Whoops, the whole row is my bad.  I displayed it in my code, but didn&#39;t put it in the &quot;similarly:&quot; section with your actual code.  Regarding the LR, it is based on CONTIGUOUS cells, so they must have information filled into the adjacent cells.  I commented in that line of code that it most likely will NOT work as is, because i don&#39;t know what column fulfills the contiguous requirement.  In the LR = Cells(Rows.Count,1) section, that 1 is the column, so you can change that number to 4 for D, or put in &quot;D&quot; and it will read the same."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504296996, "post_id": 45968509, "comment_id": 78975787, "body": "Made  few changes.. 3, 333,333 time trying this better be the charm! LOL :)  None the less.. This really is giving mixed results. I tried just changing to cells, and it cycled right through it. Acted like it worked..Didn&#39;t even put one &quot;DELETED&quot; in. Same result if I change the whole block to the cell method... it literally is not running that else condition, but runs statements that I through in there after to fill columns, and you guessed it.. is working till last row.. Why oh why Excel????!!"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504297126, "post_id": 45968509, "comment_id": 78975830, "body": "best result so far has been with first option, but it literally doesn&#39;t work to last row and stops for whatever reason around 20,580.  But any other conditional formatting I have created manually (I have some icons) are working till last row perfectly.  I may start another question to try to troubleshoot the exact problem with my code method from where we are now..  that is working the best. This is really frustrating me. I am almost done with this thing.. I just have a set of red to make for deleted, and a set of green for added. Then I AM DONE!! and I can&#39;t get there.. ughh!"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504298310, "post_id": 45968509, "comment_id": 78976306, "body": "I have made a new question and tagged you (hopefully you received notification, and that is okay, I don&#39;t want to wear out my welcome or take advantage of your kindness).  I thought it was best to start a new thread as this original problem  you answered, and it has taken on new life.. with just not executing correctly."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504615863, "post_id": 45968509, "comment_id": 79070312, "body": "Tag didn&#39;t show up, but no worries; I&#39;m sure someone else will be able to weigh in.  My only other suggestion in the mean time is to try hard coding some values to ensure that you&#39;re not having <i>another</i> issue, e.g., define your search range from 2 to row 99,999 and run the loop.  If something gets missed, you have a better understanding of the problem."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504617243, "post_id": 45968509, "comment_id": 79071369, "body": "I have no solution as of yet. The only thing people have stated is to change LR to = Long, not integer, but when I do that, the next statements give an error"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504617368, "post_id": 45968509, "comment_id": 79071477, "body": "It is now giving me a 438 object error on .formatconditions.add statement"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504619040, "post_id": 45968509, "comment_id": 79072766, "body": "Dim LR as Long versus Dim LR as Integer are about the same for this, though Long is the safer bet regarding storage and depending on your system.  See <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\" title=\"why use integer instead of long\">stackoverflow.com/questions/26409117/&hellip;</a> .  Not sure what&#39;s causing the 438 error (object not supported), provided you use: Dim LR as Long LR = Cells(Rows.Count, 1).End(xlUp).Row .  Unless you&#39;re executing from a different sheet than what the data is being pulled from; you would have sht.Range(sht.Rows(1),sht.Row(LR)) to ensure it pulls correct data (at least an option)."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504619809, "post_id": 45968509, "comment_id": 79073374, "body": "I ended up deleting the block as visually they looked the same, then I added it back in, and it is working fine. I have LR as integer. But will attempt as Long. I played around with this.. I got it working.. but.. it is highlighting the entire row.  :(  but it is making it to the end."}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504620745, "post_id": 45968509, "comment_id": 79074038, "body": "I had to have it work in two spots to achieve this. But now I have another area. As always, user requirements changed again, and they want icons to identify rows with certain conditions (past due, etc).  I have this working, but it is by conditional formatting. If I delete the conditional formatting rules, I need to put them back in using VBA to make the icons, or I need a method that will not use conditional formatting, so I do not need to wipe it out before the coloring."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504621059, "post_id": 45968509, "comment_id": 79074269, "body": "Two things: .1) we need to close out this thread if possible, or it stays in an open state indefinitely. .2) I would recommend doing all the conditional formatting in VBA as the ranges will be changing, per earlier discussion.  Take a look at this link to help with using icons: <a href=\"https://stackoverflow.com/questions/18232480/how-can-i-use-vba-to-format-symbols-icons-into-cells-without-using-conditional\" title=\"how can i use vba to format symbols icons into cells without using conditional\">stackoverflow.com/questions/18232480/&hellip;</a>"}, {"owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504621106, "post_id": 45968509, "comment_id": 79074294, "body": "I just updated the code in my question above, to show you the two spots I am running the same block essentially.  The combination of these two efforts are running to Last row perfectly.  It just is highlighting whole row, which at this point Cyril... I am over it! LOL! It can highlight the entire row, just as long as it works. If I remove either block, it does not work till end, and produces the EXACT SAME RESULT. It is crazy! The both together, work. My only issue now is to change the second block to not use conditional formatting."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "edited": false, "score": 0, "creation_date": 1504621979, "post_id": 45968509, "comment_id": 79074965, "body": "lol, we&#39;ve solved the issue with the row versus the specific columns!  With sht.Range(&quot;1:&quot; &amp; LR) becomes  With sht.Range(sht.Cells(i,1),sht.Cells(i,35)), provided it is within the loop (not what you&#39;ve currently written).  If you want the loop to apply colors, without using conditional formatting, that is also in the answer to this post: With sht.Rows(i).Interior     .Color=RGB(0,255,0) &#39;arbitrary color     .TintAndShade = 0.8 End With.  Similarly, you would change the sht.Rows(i) to the suggested range with .range(.cells(),.cells())."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1504200093, "last_edit_date": 1504200093, "creation_date": 1504122049, "answer_id": 45968509, "question_id": 45968196, "link": "https://stackoverflow.com/questions/45968196/change-interior-color-of-entire-row-based-on-column-value-vba/45968509#45968509", "title": "Change interior color of entire row based on column value VBA", "body": "<p>If you can use conditional formatting, use the rule type: <em>Use formula to determine which cells to format</em>, in the formula bar type <em>=$AJ35=\"Deleted\"</em>, then define your range such as <em>=1:1000</em>.  The Position of the $ in the formula is the key to that.  You then would choose what happens when the criteria is met and set the rule.</p>\n\n<p>You can do this from VBA, setting conditional formatting, such as:</p>\n\n<pre><code>Dim LR as Integer\nLR = Cells(Rows.Count, 1).End(xlUp).Row 'just finding the row # of the last row\nsht.Cells.FormatConditions.Delete\nWith sht.Range(\"1:\" &amp; LR) 'The range you're working with... specify the Rows() to ensure the whole row is colored \n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=$AI1=\"\"Deleted\"\"\" 'Where you put the cell you want to evaluate and criteria\n    With .FormatConditions(.FormatConditions.Count)\n        .SetFirstPriority\n        With .Interior\n            .Color = RGB(0, 70, 255) 'Arbitrary; you will need to find the specific color you want.\n            .TintAndShade = 0.8\n        End With\n    End With\nEnd With\n</code></pre>\n\n<p>Note that I remove existing conditional each time.</p>\n\n<p>Additionally, another option is to just say, which doesn't use conditional formatting:</p>\n\n<pre><code>With sht.Rows(i).Interior\n    .Color=RGB(0,255,0) 'arbitrary color\n    .TintAndShade = 0.8\nEnd With\n</code></pre>\n\n<hr>\n\n<p>Edit:  With your adjusted code and desire for columns 1 to 35 to be color-coded:</p>\n\n<pre><code>Else\n    vDB(i, 35).Value = \"Deleted\"\n    With sht.Range(sht.Cells(i,1),sht.Cells(i,35)).Interior\n        .Color = RGB(247, 167, 184) 'light red\n        .TintAndShade = 0.8\n    End With\nEnd If\n</code></pre>\n\n<p>I'm thinking something is up with your vDB, so maybe it will be more appropriate to just use Cells?</p>\n\n<pre><code>Else\n    Cells(i, 35).Value = \"Deleted\"\n    With sht.Range(sht.Cells(i,1),sht.Cells(i,35)).Interior\n        .Color = RGB(247, 167, 184) 'light red\n        .TintAndShade = 0.8\n    End With\nEnd If\n</code></pre>\n\n<p>Similarly: </p>\n\n<pre><code>Dim i, LR as Integer\nLR = Cells(Rows.Count,1).End(xlUp).Row 'Assumes row 1 is contiguous... probably not, given the rest of this code\nFor i = 1 To LR\n    If Cells(i, 1) &lt;&gt; \"\" Then\n        Set rng = rngData.Find(Cells(i, 1), LookIn:=xlValues, Lookat:=xlWhole)\n        If Not rng Is Nothing Then\n            Cells(i, ABCCodeCell).Value = rng.Offset(, 7).Value\n            Cells(i, 27).Value = rng.Offset(, 5).Value\n            Cells(i, 34).Value = rng.Offset(, 9).Value\n        Else\n            Cells(i, 35).Value = \"Deleted\"\n            With sht.Range(sht.Cells(i,1),sht.Cells(i,35)).Interior\n                .Color = RGB(247, 167, 184) 'light red\n                .TintAndShade = 0.8\n            End With\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8259560, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5886bfdd82fa5c15f2e64a0e01844772?s=128&d=identicon&r=PG&f=1", "display_name": "SharePoint0508", "link": "https://stackoverflow.com/users/8259560/sharepoint0508"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1071, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504620979, "creation_date": 1504120644, "last_edit_date": 1504620979, "question_id": 45968196, "link": "https://stackoverflow.com/questions/45968196/change-interior-color-of-entire-row-based-on-column-value-vba", "title": "Change interior color of entire row based on column value VBA", "body": "<p>Need to insert a statement that when VDB (i,35) = Deleted that the entire row interior color turns color index 22 (coral).</p>\n\n<p>I need this step to occur within this block, without needing to add code in a new block (unless absolutely necessary), as sheet has 20K plus entries.  I am assuming since this is where I am identifying when the item has a status of \"Deleted\", and placing \"Deleted\" into column 35, I should be able to color it in this same step/block, and it would be most efficient method. I may be wrong..</p>\n\n<p>Is there another line I can add after the last line, that will color these entries that =\"Deleted\" in col index 35?</p>\n\n<p>I have tried passing  vDB(i,35) to another variable as a range, and setting it, and then using if it = Deleted to change the entirerow.interior.color index = 22 , but I can't get the phrasing right, and may be taking wrong approach. I am still in learning curve but try to figure out my own issues, before bugging the group, but I can't seem to get it right.</p>\n\n<p>Here is snip it.</p>\n\n<pre><code>'Execute Find (Vlookup)\n\nFor i = 1 To UBound(vDB, 1)\n'If sht.Cells(i, 1).Value &lt;&gt; \"\" Then\n    If vDB(i, 1) &lt;&gt; \"\" Then\n        Set rng = rngData.Find(vDB(i, 1), LookIn:=xlValues, Lookat:=xlWhole) 'Matches entire contents of cell for an exact match\n        If Not rng Is Nothing Then\n           'If found return value of column 9 of ABC Recalc Cycle Count Remainder Browse (offset by 2), into ABC Matrix monthly ABC Code column, as determined by variable\n            vDB(i, ABCCodeCell) = rng.Offset(, 7)\n            'If found, return the value of column 7 of ABC Recalc Cycle Count Remainder Browse (offset by 2), into ABC Matrix column 27\n            vDB(i, 27) = rng.Offset(, 5)\n            'If found, return the value of column 11 of ABC Recalc Cycle Count Remainder Browse (offset by 2), into ABC Matrix column 34\n            vDB(i, 33) = rng.Offset(, 9)\n            'If found, place value of ABCMatrixMonthSelect.ComboBox1 in column AO Col Index 41\n            vDB(i, 41) = ABCMatrixMonthSelect.ComboBox1.value\n        Else\n            vDB(i, 35) = \"Deleted\"\n            vDB(i, 41) = ABCMatrixMonthSelect.ComboBox1.value\n            With vDB(i, 1) = sht.Cells.Interior.Color = RGB(247, 119, 109) 'Light Red\n            End With\n        End If\n    End If\n    If vDB(i, ABCCodeCell) = vDB(i, lastMonthABCCode) Then\n    vDB(i, 36) = \"No\"\n    Else\n    vDB(i, 36) = \"Yes\"\n    End If\nDoEvents\nNext\nrngDB = vDB\n\nDim LR As Long\nLR = sht.Cells(Rows.Count, 1).End(xlUp).Row\nsht.Cells.FormatConditions.Delete\nWith sht.Range(\"1:\" &amp; LR)\n    .FormatConditions.Add Type:=xlExpression, Formula1:=\"=$AI1=\"\"Deleted\"\"\" 'Searches for value \"Deleted\" in Range 1 to last row\n    With .FormatConditions(.FormatConditions.Count)\n       .SetFirstPriority\n       With .Interior\n           .Color = RGB(247, 119, 109) 'Light Red\n       End With\n    End With\nEnd With\n\n'Reset Excel Status Bar\nApplication.StatusBar = False\ne here\n</code></pre>\n"}, {"tags": ["excel", "csv", "excel-formula", "powerbi", "vba"], "comments": [{"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1504124964, "post_id": 45968164, "comment_id": 78897623, "body": "Are you hoping to do this on Windows?"}, {"owner": {"reputation": 1, "user_id": 8539766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76bca22708047ce07b30878ef90c039f?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Miller", "link": "https://stackoverflow.com/users/8539766/trent-miller"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1504129995, "post_id": 45968164, "comment_id": 78899765, "body": "Have access to Windows (7 and 10) and Mac OS Sierra with Excel 2016 or Numbers."}], "answers": [{"tags": [], "owner": {"reputation": 2583, "user_id": 2908576, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/yhWY7.jpg?s=128&g=1", "display_name": "HaveSpacesuit", "link": "https://stackoverflow.com/users/2908576/havespacesuit"}, "is_accepted": false, "score": 0, "last_activity_date": 1504128916, "creation_date": 1504128916, "answer_id": 45970053, "question_id": 45968164, "link": "https://stackoverflow.com/questions/45968164/generate-numerical-range-from-excel-or-csv-dataset/45970053#45970053", "title": "Generate numerical range from Excel or .csv dataset", "body": "<p>I'm sure other users will have more elegant answers. If you just need a quick hack, this will do. The first row takes a little special treatment.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RBDoP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RBDoP.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/MCG6S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MCG6S.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here are the formulas from row 2 going across:</p>\n\n<p>B2: <code>=IF(A2-1=A1,\"\",A2)</code></p>\n\n<p>C2: <code>=IF(AND(A2+1=A3,A2-1&lt;&gt;A1),\"-\",\"\")</code></p>\n\n<p>D2: <code>=IF(A2+1=A3,\"\",A2)</code></p>\n\n<p>E2: <code>=IF(C2=\"-\",INDEX(D2:D$11,MATCH(TRUE,ISNUMBER(D2:D$11),0)),\"\")</code>*</p>\n\n<p>*This uses an array formula, so you'll need to <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd> after typing it. You'll also change <code>D$11</code> to reference the bottom row you're using.</p>\n\n<p>F2: <code>=CONCAT(B2,C2,E2)</code></p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1504134202, "last_edit_date": 1504134202, "creation_date": 1504132782, "answer_id": 45970734, "question_id": 45968164, "link": "https://stackoverflow.com/questions/45968164/generate-numerical-range-from-excel-or-csv-dataset/45970734#45970734", "title": "Generate numerical range from Excel or .csv dataset", "body": "<p>The subs bellow will sort the main column (A, Sheet1), and generate the results in a new column</p>\n\n<hr>\n\n<pre><code>Option Explicit\nPublic Sub CreateSets()\n    Dim arr As Variant, workCol As Long, workSet As Range\n    Dim r As Long, rCount As Long, lastVal As Long, ub As Long\n    Set workSet = Sheet1.UsedRange.Columns(1)           '&lt;-- Update Sheet1 and Col\n    SortCol workSet             'Sort main column, and add a new column to its right\n    arr = workSet.Resize(workSet.Rows.Count, 2)         'Copy the 2 columns to array\n    ub = UBound(arr)\n    For r = 1 To ub\n        If r = ub Then\n            arr(r, 2) = arr(r, 1)\n            Exit For\n        End If\n        If arr(r + 1, 1) &lt;&gt; arr(r, 1) Then          'Ignore dupes\n            lastVal = arr(r, 1)\n            rCount = r\n            If rCount &lt; ub Then\n                Do\n                    If arr(rCount + 1, 1) = arr(rCount, 1) + 1 Then\n                        lastVal = arr(rCount + 1, 1)\n                        rCount = rCount + 1\n                        If rCount = ub Then Exit Do\n                    End If\n                Loop While arr(rCount + 1, 1) = arr(rCount, 1) + 1\n            End If\n            arr(r, 2) = arr(r, 1)\n            If lastVal &lt;&gt; arr(r, 1) Then            'If a set was found, skip it\n                arr(r, 2) = arr(r, 2) &amp; \"-\" &amp; lastVal\n                r = rCount\n            End If\n        End If\n    Next\n    workSet.Offset(, 1).NumberFormat = \"@\"          'Change 2nd column to Text format\n    workSet.Resize(workSet.Rows.Count, 2) = arr     'Copy results back to range\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub SortCol(ByRef oneColRng As Range)\n    Dim ws As Worksheet\n\n    If Not oneColRng Is Nothing Then\n        Set ws = oneColRng.Parent\n        Application.ScreenUpdating = False\n        With ws.Sort\n            .SortFields.Clear\n            .SortFields.Add Key:=oneColRng.Cells(1, 1), _\n                            SortOn:=xlSortOnValues, _\n                            Order:=xlAscending\n            .SetRange oneColRng\n            .Header = xlNo           '&lt;-- Change this to \"xlYes\" if there are Headers\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n        With oneColRng.Offset(, 1)\n            .Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n            .AutoFit\n        End With\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/VsxHt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VsxHt.png\" alt=\"Sets - 1 of 2\"></a>\n<a href=\"https://i.stack.imgur.com/is0iP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/is0iP.png\" alt=\"Sets - 2 of 2\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1504167312, "last_edit_date": 1504167312, "creation_date": 1504166947, "answer_id": 45976420, "question_id": 45968164, "link": "https://stackoverflow.com/questions/45968164/generate-numerical-range-from-excel-or-csv-dataset/45976420#45976420", "title": "Generate numerical range from Excel or .csv dataset", "body": "<p>I would do it with<code>awk</code> something like this:</p>\n\n<pre><code>awk 'NR==1   {b=e=$1; next}         # first line, set begin and end of current range, move to next line\n     $1==e+1 {e=$1; next}           # if this line contiguous with previous, update range end and move on\n             {print b,e; b=e=$1}    # not contiguous, print last range, start new range\n     END     {print b,e}' data.csv\n</code></pre>\n\n<p>Or, the same but as a one-liner:</p>\n\n<pre><code>awk 'NR==1{b=e=$1;next} $1==e+1{e=$1;next} {print b,e;b=e=$1} END{print b,e}' data.csv\n</code></pre>\n\n<p><strong>Sample Output</strong></p>\n\n<pre><code>3 3\n7 7\n9 12\n17 17\n22 24\n28 28\n3 3\n7 7\n9 12\n17 17\n22 24\n28 28\n</code></pre>\n\n<p>The output can be reformatted to more closely match your needs, or you can run it through <code>awk</code> again:</p>\n\n<pre><code>awk 'NR==1{b=e=$1;next} $1==e+1{e=$1;next} {print b,e;b=e=$1} END{print b,e}' data.csv |\n   awk '{x=$1; if($1!=$2)x=x \"-\" $2;print x}'\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>3\n7\n9-12\n17\n22-24\n28\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3648, "user_id": 7346922, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/272fd618206744f794467b795bea29f1?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Pincince", "link": "https://stackoverflow.com/users/7346922/marc-pincince"}, "is_accepted": false, "score": 0, "last_activity_date": 1504180447, "creation_date": 1504180447, "answer_id": 45980862, "question_id": 45968164, "link": "https://stackoverflow.com/questions/45968164/generate-numerical-range-from-excel-or-csv-dataset/45980862#45980862", "title": "Generate numerical range from Excel or .csv dataset", "body": "<p><strong>If you want to try it with Power Query, you can do this:</strong></p>\n\n<p>Start with your table of values:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pI9fq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pI9fq.png\" alt=\"enter image description here\"></a></p>\n\n<p>Add an index column by clicking the \"Add Column\" tab, then \"Index Column\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/yokhx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yokhx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Add another column by clicking the \"Add Column\" tab, then \"Custom Column\" and typing <code>try if Number.From(#\"Added Index\"{[Index]}[Values]) = Number.From(#\"Added Index\"{[Index]+1}[Values])-1 then Text.From(Number.From(#\"Added Index\"{[Index]}[Values])) else Text.From(Number.From(#\"Added Index\"{[Index]}[Values])) &amp; \"-\" &amp; Text.From(Number.From(#\"Added Index\"{[Index]+1}[Values])-1) otherwise Text.From(Number.From(#\"Added Index\"{[Index]}[Values]))</code> in the \"Custom column formula\" box of the window that pops up.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AEfhf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AEfhf.png\" alt=\"enter image description here\"></a></p>\n\n<p>You'll get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jpMjV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jpMjV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the query code:</p>\n\n<pre><code>let\nSource = Table1,\n#\"Added Index\" = Table.AddIndexColumn(Source, \"Index\", 0, 1),\n#\"Added Custom1\" = Table.AddColumn(#\"Added Index\", \"NewValues\", each \n    try \n        if Number.From(#\"Added Index\"{[Index]}[Values]) = Number.From(#\"Added Index\"{[Index]+1}[Values])-1 \n        then Text.From(Number.From(#\"Added Index\"{[Index]}[Values]))\n        else Text.From(Number.From(#\"Added Index\"{[Index]}[Values])) &amp; \"-\" &amp; Text.From(Number.From(#\"Added Index\"{[Index]+1}[Values])-1) \n    otherwise Text.From(Number.From(#\"Added Index\"{[Index]}[Values])))\nin\n#\"Added Custom1\"\n</code></pre>\n\n<p><em>I used the <code>Number.From</code> and <code>Text.From</code> to force proper types needed for the use of <code>+</code>, <code>-</code>, and <code>&amp;</code>.</em></p>\n"}], "owner": {"reputation": 1, "user_id": 8539766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76bca22708047ce07b30878ef90c039f?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Miller", "link": "https://stackoverflow.com/users/8539766/trent-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1504180447, "creation_date": 1504120528, "last_edit_date": 1531161705, "question_id": 45968164, "link": "https://stackoverflow.com/questions/45968164/generate-numerical-range-from-excel-or-csv-dataset", "title": "Generate numerical range from Excel or .csv dataset", "body": "<p>Working with some data sets containing an incomplete list of numbers (ex. 3, 7, 9, 10, 11, 12, 17, 22, 23, 24, 28, etc...) contained in a single column.</p>\n\n<p>Hoping to compile them into a collection of hyphenated ranges more similar to 3, 7, 9-12, 17, 22-24, 28, etc...</p>\n\n<p>Inputting location data within an area so data does not need to correlate to any other cells, just need to reduce the total data set from thousands of individual values to hopefully a few hundred numerical ranges</p>\n\n<p><a href=\"https://i.stack.imgur.com/J9nwj.png\" rel=\"nofollow noreferrer\">Example data set</a></p>\n\n<p>Had assumed there would be a simple option for this but not having any luck in Excel or Power BI.</p>\n\n<p>Thanks and all the best,</p>\n\n<p>Trent</p>\n"}, {"tags": ["excel", "vba", "loops", "search", "find"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1504120260, "post_id": 45967978, "comment_id": 78895205, "body": "Open macro recorder, find &quot;TRUE&quot; (make sure you do it by Rows), then find next. Stop macro recorder. Then do a logic check where the row of the two values are the same. Then fill the range with yellow. This is a starting point for you. Try to replace the <code>selection</code>s in your macro with your cell references. Come and ask a new question wherever you get stuck."}, {"owner": {"reputation": 1, "user_id": 8539684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e574369e27b8738702edf67d1a85a513?s=128&d=identicon&r=PG&f=1", "display_name": "Mohi Bouki", "link": "https://stackoverflow.com/users/8539684/mohi-bouki"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1504120496, "post_id": 45967978, "comment_id": 78895331, "body": "Thanks for the info but every sheet has a new starting hour depending on week. Would macro not be too static?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1504120779, "post_id": 45967978, "comment_id": 78895473, "body": "Yes it is static. You need to have it in a loop after you are done with my above comment. But first things first, you need to figure out how to find consecutive values in a row and fill the range with yellow. Then you can come and ask how to put it in a loop for many rows and different sheets."}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1504122241, "post_id": 45967978, "comment_id": 78896208, "body": "Well I guess we are not on the same page."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504144033, "post_id": 45967978, "comment_id": 78902974, "body": "you could do a &quot;brute force&quot; technique .... go row by row ... start with &quot;no color&quot;  .... scan each row from left to right  .... if true then change color (none2yellow or yellow2none) .... paint cell (none or yellow) .... repeat for each cell in row"}], "answers": [{"tags": [], "owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "is_accepted": false, "score": 0, "last_activity_date": 1504280270, "last_edit_date": 1504280270, "creation_date": 1504279823, "answer_id": 46003580, "question_id": 45967978, "link": "https://stackoverflow.com/questions/45967978/excel-vba-finding-pair-of-boolean-values-in-range-row-by-row/46003580#46003580", "title": "Excel vba: Finding pair of boolean values in range row by row", "body": "<p>You can do this with conditional formatting.</p>\n\n<p>Select the full range and then use the formulas below in conditional formatting.</p>\n\n<p><code>=COUNTIF($A1:A1,\"TRUE\")&gt;1</code> formatted as white</p>\n\n<p><code>=COUNTIF($B1:B1,\"TRUE\")&gt;0</code> formatted as yellow</p>\n\n<p>The formulas count the the number of cells with \"True\" for the specified range.</p>\n\n<p><a href=\"https://i.stack.imgur.com/veuDG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/veuDG.jpg\" alt=\"Conditional Formatting\"></a></p>\n\n<p>Another way could be to add 2 columns to the right of your data and use formulas to find the start and finish times and then conditionally format based on the time headings and the 2 new values.</p>\n"}], "owner": {"reputation": 1, "user_id": 8539684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e574369e27b8738702edf67d1a85a513?s=128&d=identicon&r=PG&f=1", "display_name": "Mohi Bouki", "link": "https://stackoverflow.com/users/8539684/mohi-bouki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504280270, "creation_date": 1504119786, "last_edit_date": 1504147328, "question_id": 45967978, "link": "https://stackoverflow.com/questions/45967978/excel-vba-finding-pair-of-boolean-values-in-range-row-by-row", "title": "Excel vba: Finding pair of boolean values in range row by row", "body": "<p>I'm trying to solve a rather basic question in a excel sheet using vba but I can't find the answer...</p>\n\n<p>I am working on a timetable which is dynamically populated from an other excel sheet with boolean values True or False. \nThe named range is called \"A\" in excel and contains boolean values True or False. Every column represents a possible start hour. Every row represents a different collage with a starting hour and an end hour. Each row can have NO values (entire row = False = collage is on leave)\nOR the row can have two values TRUE on different cells in the same row representing start hour and end hour. \nWhat I would like to achieve is a to find ROW by ROW  for a couple of boolean TRUE. If found the cells between the first and second True should be colored in let's say yelow. </p>\n\n<p>I am able to loop in a named range finding a specific value but I'm unable to find a pair of TRUE values in a specific row. As a double check I want to be sure that the first an second TRUE MUST be on the same row. So it is impossible to color between 2 cells in a different row.</p>\n\n<p>See picture :</p>\n\n<p><img src=\"https://i.stack.imgur.com/Tstyf.jpg\" alt=\"\"></p>\n\n<p>Some advice or thought would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel", "shape"], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1504120891, "post_id": 45968111, "comment_id": 78895541, "body": "Great, just one question, how do I keep the shape the same size.  Some sheets have wider columns than others, which makes some wider than others."}, {"owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 2, "creation_date": 1504121899, "post_id": 45968111, "comment_id": 78896067, "body": "Before the hyperlink line, try adding <code>GoToSummary.Placement = xlMove</code>  and <code>GoToSummary.Width = 300</code>"}], "tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": true, "score": 2, "last_activity_date": 1504120318, "creation_date": 1504120318, "answer_id": 45968111, "question_id": 45967281, "link": "https://stackoverflow.com/questions/45967281/vba-create-edit-and-hyperlink-shape/45968111#45968111", "title": "VBA - Create, edit, and hyperlink shape", "body": "<p>You were pretty close!</p>\n\n<pre><code>Sub test()\nDim GoToSummary As Shape\n\nFor s = 7 To Sheets.Count\n    Set GoToSummary = Sheets(s).Shapes.AddShape(msoShapeRoundedRectangle, 400, 153 + 12.75 * 2, 300, 50)\n    GoToSummary.TextFrame.Characters.Text = \"Go Back To Summary\"\n    Sheets(s).Hyperlinks.Add Anchor:=GoToSummary, Address:=\"\", SubAddress:=\"Summary!A1\"\nNext s\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li><code>Dim GoToSummary</code> outside of the loop</li>\n<li>Once you've defined GoToSummary with Set, you can just refer to it directly, i.e. as <code>GoToSummary</code> instead of <code>.Shapes(GoToSummary)</code></li>\n<li>Added the hyperlink as well</li>\n</ul>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 45968111, "answer_count": 1, "score": 2, "last_activity_date": 1504120318, "creation_date": 1504117170, "last_edit_date": 1504119655, "question_id": 45967281, "link": "https://stackoverflow.com/questions/45967281/vba-create-edit-and-hyperlink-shape", "title": "VBA - Create, edit, and hyperlink shape", "body": "<p>In my tool I am trying to create a shape, rename it, have it move with the shifting widths of columns, and hyperlink it to a summary sheet.  This is what I have so far, thanks in advance.  </p>\n\n<pre><code>For s = 7 To Sheets.Count\n    With Sheets(s)\n        Dim GoToSummary As Shape\n        Set GoToSummary = .Shapes.AddShape(msoShapeRoundedRectangle, 400, 153 + 12.75 * 2, 300, 50)\n\n        .Shapes(GoToSummary).TextFrame.Characters.Text = \"Go Back To Summary\"\n    End With\nNext s  \n</code></pre>\n\n<p>I know this is not correct, that is why I am reaching out, because I couldn't find anything similar to my situation.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504144256, "post_id": 45967276, "comment_id": 78903019, "body": "you cannot delete a file that is open in an application"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7520629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b25f99659b098c9615d136de718d03c?s=128&d=identicon&r=PG&f=1", "display_name": "noldak", "link": "https://stackoverflow.com/users/7520629/noldak"}, "edited": false, "score": 0, "creation_date": 1504118950, "post_id": 45967726, "comment_id": 78894548, "body": "We have tried this sub by itself, and it works with the path provided. It is just in the context of the rest of the code that things get messed up."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 7520629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b25f99659b098c9615d136de718d03c?s=128&d=identicon&r=PG&f=1", "display_name": "noldak", "link": "https://stackoverflow.com/users/7520629/noldak"}, "edited": false, "score": 0, "creation_date": 1504119247, "post_id": 45967726, "comment_id": 78894687, "body": "@noldak - then put a stop before the <code>Kill</code>, and write <code>Application.ScreenUpdating = True</code>. Then press F5 again. You might get lucky. Just for the record - by any chance, do you have <code>On Error Resume Next</code> somewhere in your code?"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1504119477, "post_id": 45967726, "comment_id": 78894824, "body": "I think you can just paste that into Immediate window (entire &quot;kill ...&quot; line only), press Enter and see if the file disappears. If not, try putting the full path and see if it works. That should give you some clues."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1504119988, "post_id": 45967726, "comment_id": 78895088, "body": "@LoganReed - pasting it in the immediate window is the same as the code, yup."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1504118737, "creation_date": 1504118737, "answer_id": 45967726, "question_id": 45967276, "link": "https://stackoverflow.com/questions/45967276/vba-kill-function-not-deleting-file/45967726#45967726", "title": "VBA Kill function not deleting file", "body": "<p>Probably you are looking at the wrong file. <code>Kill</code> is a function, that makes no mistakes. \nSimply try the following:</p>\n\n<pre><code>Sub KillTheFile\n    Kill \"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\desktop\\form.docx\"\nEnd Sub\n</code></pre>\n\n<p>Then see if it works. Probably you are having a file <code>frm.docx</code> or similar.</p>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1504120797, "last_edit_date": 1504120797, "creation_date": 1504120164, "answer_id": 45968085, "question_id": 45967276, "link": "https://stackoverflow.com/questions/45967276/vba-kill-function-not-deleting-file/45968085#45968085", "title": "VBA Kill function not deleting file", "body": "<p>Try it like this instead</p>\n\n<pre><code>On Error Goto 0\nDim sDocName as string\nsDocName = Doc.FullName\nDoc.Close\nKill sDocName\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7520629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b25f99659b098c9615d136de718d03c?s=128&d=identicon&r=PG&f=1", "display_name": "noldak", "link": "https://stackoverflow.com/users/7520629/noldak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1822, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504120797, "creation_date": 1504117162, "question_id": 45967276, "link": "https://stackoverflow.com/questions/45967276/vba-kill-function-not-deleting-file", "title": "VBA Kill function not deleting file", "body": "<p>I have written VBA code for Microsoft Word to send an email when a button is clicked. When the button is clicked, and the macro is completed, I would like the file to be deleted from the Desktop. </p>\n\n<p>When I run this macro now, Microsoft Word closes out, but the file is not deleted from my desktop.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim OL              As Object\nDim EmailItem       As Object\nDim Doc             As Document\nDim FileName        As String\nDim FilePath        As String\nDim DeletePath      As String\n\nApplication.ScreenUpdating = False\nSet OL = CreateObject(\"Outlook.Application\")\nSet EmailItem = OL.CreateItem(olMailItem)\nSet Doc = ActiveDocument\nmyFileName = \"Form\"\nFilePath = \"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\desktop\\\"\nDoc.SaveAs2 FileName:=FilePath &amp; myFileName &amp; \".docx\", Fileformat:=wdFormatXMLDocument, AddToRecentFiles:=False\nWith EmailItem\n    .Subject = \"Bid Award Form\"\n    .Body = \"Please Review the attached Bid Award form\"\n    .To = \"EMAILADDRESS@DOMAIN.COM\"\n    .Importance = olImportanceNormal 'Or olImprotanceHigh Or olImprotanceLow\n    .Attachments.Add Doc.FullName\n    .Send\nEnd With\n\n    'display a message using named arguments\nMsgBox _\nprompt:=\"Your email has been sent. Please check your Outlook sent mail for confirmation\", _\nButtons:=vbOKOnly, _\nTitle:=\"Email Confirmation\"\n\n\n\n'Close the File\nDoc.Close\n\nKill \"C:\\Users\\\" &amp; Environ(\"Username\") &amp; \"\\desktop\\form.docx\"\n\n'Close the Application of the document we are going to delete\nApplication.Quit\n\nApplication.ScreenUpdating = True\n\nSet Doc = Nothing\nSet OL = Nothing\nSet EmailItem = Nothing\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help that you can provide will be very helpful!</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "edited": false, "score": 0, "creation_date": 1504123787, "post_id": 45967911, "comment_id": 78896969, "body": "What can I do in Dcom to fix this or what can I do to fix this or what do I need to tell the domain admin?  There must be a domain or gpedit fix is there not?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "edited": false, "score": 0, "creation_date": 1504124622, "post_id": 45967911, "comment_id": 78897440, "body": "There is not much you can do - Outlook (like any other Office app) cannot be used from a service such as the Task Scheduler."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1504119485, "creation_date": 1504119485, "answer_id": 45967911, "question_id": 45967200, "link": "https://stackoverflow.com/questions/45967200/problems-with-outlook-automatically-closing-from-access-database/45967911#45967911", "title": "Problems With Outlook Automatically Closing From Access Database", "body": "<p>Task scheduler runs as a service in a security context different  from the currently logged in user even if the local user account is the same. COM system refuses to marshal calls between processes running in different security contexts. </p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1504188773, "creation_date": 1504188773, "answer_id": 45983625, "question_id": 45967200, "link": "https://stackoverflow.com/questions/45967200/problems-with-outlook-automatically-closing-from-access-database/45983625#45983625", "title": "Problems With Outlook Automatically Closing From Access Database", "body": "<p>I have office 2013 and windows 10.  I could use the above code with Windows 7 and the task scheduler.  I am on a domain with certain policies that I can't change and I don't have admin rights.  At home not on a domain I can use that code too.  With that being said I can at least terminate outlook from access and get the job done closing an outlook session so when the autoexec runs in the access database it closes outlook and then runs the reports and sends, Create Object Outlook.Application and it sends emails no problems.  Here is how I terminate the code.  The reason is I don't want multiple outlook sessions running.</p>\n\n<pre><code>Public Function OutlookClose1()\nDim objOutlook As Outlook.Application\n\ndelay = 30000 'delay in milliseconds to let Outlook close gracefully\nstrComputer = \".\"\nSet objWMIService = GetObject(\"winmgmts:\" _\n&amp; \"{impersonationLevel=impersonate}!\\\\\" &amp; strComputer &amp; \"\\root\\cimv2\")\n\nSet colProcessList = objWMIService.ExecQuery _\n(\"Select * from Win32_Process Where Name = 'Outlook.exe'\")\nFor Each objProcess In colProcessList\nobjProcess.Terminate\nNext\nSet objWMIService = Nothing\nSet objOutlook = Nothing\nSet colProcessList = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504188773, "creation_date": 1504116872, "question_id": 45967200, "link": "https://stackoverflow.com/questions/45967200/problems-with-outlook-automatically-closing-from-access-database", "title": "Problems With Outlook Automatically Closing From Access Database", "body": "<p>I was just upgraded to windows 10.  This version of outlook I have enabled the macros in the trust center however it limits me on running vba from outlook.  Also access is having issues when I run the task scheduler and run from a bat file the access database.  An autoexec excutes and I tell the system to shut outlook down but it won't shut down the current instance of the outlook.  Here Is the code I am using.</p>\n\n<pre><code>Public Function OutlookClose1()\nOn Error Resume Next\nstrComputer = \".\"\nSet objWMIService = GetObject(\"winmgmts:\" _\n&amp; \"{impersonationLevel=impersonate}!\\\\\" &amp; strComputer &amp; \"\\root\\cimv2\")\nSet colProcessList = objWMIService.ExecQuery _\n(\"Select * from Win32_Process Where Name = 'Outlook.exe'\")\nFor Each objProcess In colProcessList\nSet objOutlook = GetObject(Class:=\"Outlook.application\")\nobjOutlook.Quit\nNext\n\nEnd Function\nPublic Function OutlookClose2()\nDim objAppOL As Outlook.Application\nOn Error Resume Next\nSet objAppOL = GetObject(Class:=\"Outlook.application\")\n    objAppOL.Quit\nSet objAppOL = Nothing\nExit Function\nEnd Function\n</code></pre>\n\n<p>I have tried outlookclose1 and 2 and neither work.  DOes anyone have suggestions?</p>\n\n<p>Also when running the outlookclose1 from the vba editor it does close.  It takes the exchange offline, which I don't want.  But from a bat file running the access database and having the autoexec run it it doesn't close down outlook.</p>\n"}, {"tags": ["vba", "database", "ms-access", "odbc"], "answers": [{"comments": [{"owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "edited": false, "score": 0, "creation_date": 1504199457, "post_id": 45986848, "comment_id": 78933621, "body": "I&#39;ve already made a solution, I&#39;m just finishing coding it and then I&#39;ll answer my own question"}], "tags": [], "owner": {"reputation": 47, "user_id": 1930587, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89e2216552160713ff381f644a2d8d17?s=128&d=identicon&r=PG", "display_name": "C Zandstra", "link": "https://stackoverflow.com/users/1930587/c-zandstra"}, "is_accepted": false, "score": 0, "last_activity_date": 1504199373, "creation_date": 1504199373, "answer_id": 45986848, "question_id": 45967043, "link": "https://stackoverflow.com/questions/45967043/combobox-max-records-reached/45986848#45986848", "title": "ComboBox max records reached", "body": "<p>There's a known bug where there are sometimes issues with large recordsets like this.  Are you sorting on a text based field?  Try removing the sort if so and seeing if it fixes the issue.</p>\n"}, {"tags": [], "owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "is_accepted": true, "score": 1, "last_activity_date": 1504203774, "creation_date": 1504203774, "answer_id": 45987843, "question_id": 45967043, "link": "https://stackoverflow.com/questions/45967043/combobox-max-records-reached/45987843#45987843", "title": "ComboBox max records reached", "body": "<p>Access ComboBoxes have a maximum record count of 65535.</p>\n\n<p>To circumvent this, I found <a href=\"http://allenbrowne.com/ser-32.html\" rel=\"nofollow noreferrer\">an article</a> that gave me the groundwork required to write a function that sets the rowSource dynamically once a certain number of characters have been typed.</p>\n\n<p>This is the function that sets the rowSource. I refactored the code so that it can be used on any comboBox in any Form with any Query.</p>\n\n<pre><code>Dim inputStub As String\n\nFunction ComboLimiter(targetCombo As ComboBox, minChars As Integer, Query As String, searchField As String)\n    Dim inputStr As String: inputStr = targetCombo.Text 'Set input string\n    Dim newStub As String: newStub = Nz(Left(inputStr, minChars), \"\") 'Set first n characters of targetCombo.Text\n\n    If newStub &lt;&gt; inputStub Then 'If first n chars are the same as previously, do nothing.\n        If Len(newStub) &lt; minChars Then\n            'Remove the RowSource\n            targetCombo.RowSource = Query &amp; \" WHERE (False);\"\n            inputStub = \"\"\n        Else\n            'New RowSource\n            targetCombo.RowSource = Query &amp; \" WHERE (\" &amp; searchField &amp; \" Like \"\"\" &amp; newStub &amp; \"*\"\") ORDER BY \" &amp; searchField &amp; \";\"\n            inputStub = newStub\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<p>And the function can be bound to the ComboBox change event like this:</p>\n\n<pre><code>Private Sub UPCCombo_Change()\n    Call ComboLimiter(Me.UPCCombo, 1, _\n    \"SELECT ID, UPC_Case, Description FROM itemlist\", \"UPC_Case\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2958, "user_id": 952248, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/u2n4V.jpg?s=128&g=1", "display_name": "Mark Kramer", "link": "https://stackoverflow.com/users/952248/mark-kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 45987843, "answer_count": 2, "score": 2, "last_activity_date": 1594548843, "creation_date": 1504116373, "last_edit_date": 1594548843, "question_id": 45967043, "link": "https://stackoverflow.com/questions/45967043/combobox-max-records-reached", "title": "ComboBox max records reached", "body": "<p>I have a table in MySQL accessed through a linked table (via ODBC) in Microsoft Access 2013.</p>\n\n<p>This table contains over 124,000 records and I need a ComboBox in a form to be able to search through the UPC column.</p>\n\n<p>This is the query that is the current datasource for the ComboBox:</p>\n\n<pre><code>SELECT [ID], [UPC_Case], [Description] FROM itemlist ORDER BY [UPC_Case];\n</code></pre>\n\n<p>This works perfectly except that the table view under the ComboBox won't go past record number 62287 (however the auto-fill still works for records that the table can't see), is there a way to make it able to view all the records?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5896636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1076666275724761/picture?type=large", "display_name": "Scott Jethro Hardwick", "link": "https://stackoverflow.com/users/5896636/scott-jethro-hardwick"}, "edited": false, "score": 0, "creation_date": 1504221341, "post_id": 45966711, "comment_id": 78942809, "body": "978 entries later is when this started happening, formatted &#39;&quot;&amp;pid&amp;&quot;&#39; to &quot;&amp;pid&amp;&quot; seemed to fix it, so far lol"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1504115030, "creation_date": 1504115030, "answer_id": 45966711, "question_id": 45966596, "link": "https://stackoverflow.com/questions/45966596/random-bug-started-to-show-up/45966711#45966711", "title": "Random Bug started to show up", "body": "<p>You need to format your date expression:</p>\n\n<pre><code>strCriteria = \"([PetID] = '\" &amp; pid &amp; \"') And ([ApptDate] = #\" &amp; Format(aptdate, \"yyyy\\/mm\\/dd\") &amp; \"#)\"\n</code></pre>\n\n<p>And if pid is numeric, not text:</p>\n\n<pre><code>strCriteria = \"([PetID] = \" &amp; pid &amp; \") And ([ApptDate] = #\" &amp; Format(aptdate, \"yyyy\\/mm\\/dd\") &amp; \"#)\"\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5896636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1076666275724761/picture?type=large", "display_name": "Scott Jethro Hardwick", "link": "https://stackoverflow.com/users/5896636/scott-jethro-hardwick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 45966711, "answer_count": 1, "score": 0, "last_activity_date": 1504115030, "creation_date": 1504114629, "question_id": 45966596, "link": "https://stackoverflow.com/questions/45966596/random-bug-started-to-show-up", "title": "Random Bug started to show up", "body": "<p>Have been running a program for weeks now, that enters groomers times into a database. Have never had a problem with it.</p>\n\n<p>Yesterday, the 1st time entered worked fine, no problems.\nThe second time entered threw an error.</p>\n\n<p>Didn't have time to look at it yesterday, so just manually entered all the times.</p>\n\n<p>Today, the same thing. 1st time entered, worked perfectly, no problems.\n2nd time entered, throws an error.</p>\n\n<p>The code stops on this line:</p>\n\n<pre><code>If DCount(\"[PetID]\", \"[TimeLog]\", strCriteria) &gt; 0 Then\n</code></pre>\n\n<p>With Run-Time 3464, Data type mismatch in criteria expression</p>\n\n<p>The entire code for that section:</p>\n\n<pre><code>'Set variables for error checking duplicates\nDim pid As Integer\nDim aptdate As Date\npid = CmbPetName.Column(2)\n    'MsgBox (pid)\naptdate = txtAptDate.Value\n    'MsgBox (aptdate)\nDim strCriteria As String\n\n'Set Criteria for DCount()\nstrCriteria = \"([PetID] = '\" &amp; pid &amp; \"') And ([ApptDate] = #\" &amp; aptdate &amp; \"#)\"\n    'MsgBox (strCriteria)\n\n'Error checking for duplicates\nIf DCount(\"[PetID]\", \"[TimeLog]\", strCriteria) &gt; 0 Then\n    MsgBox (\"Record Already Exists\")\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>At a total loss for why all of a sudden this is happening, and why it is random</p>\n\n<p>ANY advise on this will be greatly appreciated.</p>\n"}, {"tags": ["sql-server", "vba", "sql-server-express", "adodb"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504114922, "post_id": 45966470, "comment_id": 78892294, "body": "double quotes in a string are escaped my &quot;doubling&quot; .... your sql string can be written as <code>strSQL = &quot;Select * from Contact where Lastname like &quot;&quot;%&quot; + LastSearch + &quot;&quot;&quot; And Firstname like &quot;&quot;%&quot; + FirstSearch + &quot;&quot;&quot;&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8516849, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9a2a63cc9cc16aff9d643007792e0fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Luv", "link": "https://stackoverflow.com/users/8516849/luv"}, "edited": false, "score": 0, "creation_date": 1504115405, "post_id": 45966599, "comment_id": 78892531, "body": "Once I do that, I get a different error:  Sql server does not exist or access denied.     Runtime error -21474767259 (80004005)"}, {"owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "reply_to_user": {"reputation": 49, "user_id": 8516849, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9a2a63cc9cc16aff9d643007792e0fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Luv", "link": "https://stackoverflow.com/users/8516849/luv"}, "edited": false, "score": 0, "creation_date": 1504120558, "post_id": 45966599, "comment_id": 78895365, "body": "@Luv, I updated my answer to specify .\\SQLEXPRESS as a server name."}], "tags": [], "owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1504120842, "last_edit_date": 1504120842, "creation_date": 1504114643, "answer_id": 45966599, "question_id": 45966470, "link": "https://stackoverflow.com/questions/45966470/vba-connecting-to-sql-server-express-database-issue/45966599#45966599", "title": "VBA connecting to SQL Server Express database issue", "body": "<p>Add <code>Integrated Security=SSPI</code> to your connection string to indicate a trusted connection is desired:</p>\n\n<pre><code>objMyConn.ConnectionString = \"Provider=SQLOLEDB;Data Source=localhost;Initial Catalog=Contact;Integrated Security=SSPI\"\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>SQL Server Express installs a named instance by default so you may need to change the data source to include the instance name:</p>\n\n<pre><code>objMyConn.ConnectionString = \"Provider=SQLOLEDB;Data Source=.\\SQLEXPRESS;Initial Catalog=Contact;Integrated Security=SSPI\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1504114715, "creation_date": 1504114715, "answer_id": 45966608, "question_id": 45966470, "link": "https://stackoverflow.com/questions/45966470/vba-connecting-to-sql-server-express-database-issue/45966608#45966608", "title": "VBA connecting to SQL Server Express database issue", "body": "<p>use something like this instead of <code>localhost</code></p>\n\n<pre><code>HP8300-0792\\SQLEXPRESS\n</code></pre>\n\n<p>where HP8300-0792 is the name of your computer.</p>\n"}], "owner": {"reputation": 49, "user_id": 8516849, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9a2a63cc9cc16aff9d643007792e0fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Luv", "link": "https://stackoverflow.com/users/8516849/luv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 0, "accepted_answer_id": 45966599, "answer_count": 2, "score": 0, "last_activity_date": 1504120842, "creation_date": 1504114154, "last_edit_date": 1504118816, "question_id": 45966470, "link": "https://stackoverflow.com/questions/45966470/vba-connecting-to-sql-server-express-database-issue", "title": "VBA connecting to SQL Server Express database issue", "body": "<p>I installed a copy of SQL Server Express (latest). I am having trouble connecting to it.</p>\n\n<p>Since I am the admin on this computer, it should be not needing user name password, because I created the database, and everything should fall under Windows authentication. My code is below.  </p>\n\n<p>I get an error:</p>\n\n<blockquote>\n  <p>Run-time error '-2147217843 (80040e4d)':<br>\n  Invalid authorization specification</p>\n</blockquote>\n\n<p>This error happens on attempting to open the connection.</p>\n\n<p>When I launch a subform from main form, this code runs in initialize:</p>\n\n<pre><code>Option Explicit\nPrivate objMyConn As ADODB.Connection\nPrivate objMyRecordset As ADODB.Recordset\n\nPrivate Sub UserForm_Initialize()\n    'Declare variables'\n        Set objMyConn = New ADODB.Connection\n        Set objMyRecordset = New ADODB.Recordset\n        Dim strSQL As String\n\n        objMyConn.ConnectionString = \"Provider=SQLOLEDB;Data Source=localhost;Initial Catalog=Contact;\"\n        objMyConn.Open\n\n        strSQL = \"Select * from Contact where Lastname like \" + Chr(39) + \"%\" + LastSearch + Chr(39) + \" And Firstname like \" + Chr(39) + \"%\" + FirstSearch + Chr(39)\n        MsgBox strSQL\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1504111825, "post_id": 45965792, "comment_id": 78890587, "body": "Assuming he can&#39;t/will not update anything other than the data in tables, you can grab his database and import his tables into your latest version (replacing the ones you have).  If you made structure changes, then it gets a little trickier, but still easy to do."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504111841, "post_id": 45965792, "comment_id": 78890599, "body": "You will have to be specific about what you&#39;re changing. You can just copy most objects (queries/forms/reports/macro&#39;s/modules) from one database to another. Table structure changes and relationships are more difficult, but also possible."}, {"owner": {"reputation": 2020, "user_id": 5715852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/69cf2e00c81bc89731652db2b9ca1dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Ahron M. Galitzky", "link": "https://stackoverflow.com/users/5715852/ahron-m-galitzky"}, "edited": false, "score": 0, "creation_date": 1504112056, "post_id": 45965792, "comment_id": 78890707, "body": "This time its just to add a field in a table that has no relationships to anything just being displayed in a form. But i asked in general what would be the most efficient way of doing it now and in the feature."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1504112884, "post_id": 45965792, "comment_id": 78891143, "body": "The short story is, we would place VBA code to handle all types of structure changes and execute that code the first time the database was deployed and opened. You could do something similar where you just ship the new database to your friend and have it perform all the steps you would have manually performed. I can provide further detail of how it was done if you are interested. The big question is: How often will you need to do this? Once or twice... do it manually... lots of times? do it via code.."}], "answers": [{"comments": [{"owner": {"reputation": 2020, "user_id": 5715852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/69cf2e00c81bc89731652db2b9ca1dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Ahron M. Galitzky", "link": "https://stackoverflow.com/users/5715852/ahron-m-galitzky"}, "edited": false, "score": 0, "creation_date": 1504118790, "post_id": 45966646, "comment_id": 78894458, "body": "Where do i find that wizard?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2020, "user_id": 5715852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/69cf2e00c81bc89731652db2b9ca1dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Ahron M. Galitzky", "link": "https://stackoverflow.com/users/5715852/ahron-m-galitzky"}, "edited": false, "score": 0, "creation_date": 1504123934, "post_id": 45966646, "comment_id": 78897048, "body": "This really shouldn&#39;t cause you trouble ... anyway, hint, menu Database Tools."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1504114828, "creation_date": 1504114828, "answer_id": 45966646, "question_id": 45965792, "link": "https://stackoverflow.com/questions/45965792/update-access-application-file-without-changing-the-data/45966646#45966646", "title": "Update access application file without changing the data", "body": "<p>The real answer is to <em>split</em> the database into two: A <em>backend</em> with tables only, and a <em>frontend</em> with all forms, reports, etc.</p>\n\n<p>There is a wizard that will do 99% of this for you.</p>\n\n<p>When done, you can update the frontend at any time and relink the tables from the backend.</p>\n"}], "owner": {"reputation": 2020, "user_id": 5715852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/69cf2e00c81bc89731652db2b9ca1dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Ahron M. Galitzky", "link": "https://stackoverflow.com/users/5715852/ahron-m-galitzky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 45966646, "answer_count": 1, "score": 0, "last_activity_date": 1504114828, "creation_date": 1504111587, "question_id": 45965792, "link": "https://stackoverflow.com/questions/45965792/update-access-application-file-without-changing-the-data", "title": "Update access application file without changing the data", "body": "<p>I just finished developing a Microsoft Access database application for a friend and he started entering data already.</p>\n\n<p>He just contacted me that he would like to add additional features to the application (Nothing Major).</p>\n\n<p>He is using his computer (to enter data) at one location and i use a different computer at a different location (to build the application). My Question is, is there a way when i finish updating my (empty) copy of the application to replace it with his copy of the application without effecting the data he entered into the database?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1504111425, "post_id": 45965613, "comment_id": 78890384, "body": "Not sure what the technical term is, but you need an action on that final line. Put another <code>debug.print</code> in front and it should work."}, {"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1504112541, "post_id": 45965613, "comment_id": 78890953, "body": "You should use other approach, like <code>Debug.Print r.Cells(1, 1).DisplayFormat.Interior.Color</code>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1504113197, "post_id": 45965613, "comment_id": 78891306, "body": "<code>r(1, 1).DisplayFormat.Interior.Color</code> gets/sets an object property value (color) depending on which side of the equation it is located .... you have to do something with it (print it, assign it to a variable, assign to it etc. ...)  .... the way you have it written, color is a method of a range.DisplayFormat.Interior object, except that it is not a method of that object"}], "owner": {"reputation": 269, "user_id": 4134174, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/47e8d6f4b9f315491a56c971a02d3e6d?s=128&d=identicon&r=PG", "display_name": "user78655", "link": "https://stackoverflow.com/users/4134174/user78655"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 737, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504110903, "creation_date": 1504110903, "last_edit_date": 1531164843, "question_id": 45965613, "link": "https://stackoverflow.com/questions/45965613/vba-get-color-from-range-object-cell", "title": "VBA - Get color from range object (cell)", "body": "<p>I'm trying to print the color of a cell using VBA using two different ways, the second one doesn't work and I'm not sure why. Here's the code:</p>\n\n<pre><code>Sub GetColors()\n  ' Cell A1 has a red interior, both of these commands should print 255\n  Dim r As Range\n\n  Debug.Print Range(\"A1\").DisplayFormat.Interior.Color ' Working - Prints 255\n\n  ' Using ranges &amp; indexing\n  Set r = Range(\"A1:A5\")\n  ' r(1, 1) is the first element of r, and is also a range...\n  Debug.Print TypeName(r(1, 1)) ' Prints Range\n  ' Since r(1, 1) is a range, we should be able to get the color like before...\n  r(1, 1).DisplayFormat.Interior.Color ' Object doesn't support this property or method\nEnd Sub\n</code></pre>\n\n<p>I don't understand why the second method doesn't work, VBA knows that <code>r(1, 1)</code> is a <code>Range</code> object so it should give <code>r(1, 1)</code> all the same properties and methods as any other <code>Range</code>. Is there something special about accessing ranges through indexes? Or am I just missing something? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "collections", "bubble-sort", "heapsort"], "comments": [{"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1504112469, "post_id": 45965559, "comment_id": 78890912, "body": "can you post your script."}, {"owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "reply_to_user": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1504112589, "post_id": 45965559, "comment_id": 78890984, "body": "Not really, I&#39;m about 1500 lines in and all the data is coming from a variety of angles. What more information do you need?"}, {"owner": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1504112794, "post_id": 45965559, "comment_id": 78891098, "body": "can you add the part where you are creating the collection and trying to get the highest number."}, {"owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "reply_to_user": {"reputation": 1137, "user_id": 6031975, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/424668263f27dbda974c0ee3326e9ffb?s=128&d=identicon&r=PG&f=1", "display_name": "ShanayL", "link": "https://stackoverflow.com/users/6031975/shanayl"}, "edited": false, "score": 0, "creation_date": 1504112902, "post_id": 45965559, "comment_id": 78891152, "body": "added an attempt at a heapsort algorithm"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504115592, "post_id": 45965559, "comment_id": 78892649, "body": "you could copy the key/value pairs into a hidden worksheet and do the sort there, then copy back"}, {"owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "edited": false, "score": 0, "creation_date": 1504124965, "post_id": 45965559, "comment_id": 78897624, "body": "Good idea. I was trying to keep away from using hidden worksheets, but it might work best for now. Cheers."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1504132167, "post_id": 45965559, "comment_id": 78900459, "body": "If you use a Dictionary object instead of a Collection and you can sort by value as shown <a href=\"http://xl-central.com/sort-a-dictionary-by-item.html\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "reply_to_user": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "edited": false, "score": 0, "creation_date": 1504145591, "post_id": 45965559, "comment_id": 78903322, "body": "@Domenic, after some modification, this works well. Please create an answer for it to be accepted. Cheers."}], "answers": [{"tags": [], "owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "is_accepted": true, "score": 0, "last_activity_date": 1504746545, "creation_date": 1504746545, "answer_id": 46086377, "question_id": 45965559, "link": "https://stackoverflow.com/questions/45965559/vba-sorting-a-collection-by-value/46086377#46086377", "title": "VBA sorting a collection by value", "body": "<p>As per Domenic in comment and he hasn't answered. </p>\n\n<p>\"If you use a Dictionary object instead of a Collection and you can sort by value as shown <a href=\"http://xl-central.com/sort-a-dictionary-by-item.html\" rel=\"nofollow noreferrer\">here</a>. \u2013 Domenic Aug 30 at 22:29 \"</p>\n\n<p>This works now. </p>\n"}], "owner": {"reputation": 383, "user_id": 5050423, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/25alZ.jpg?s=128&g=1", "display_name": "Iorek", "link": "https://stackoverflow.com/users/5050423/iorek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2275, "favorite_count": 1, "accepted_answer_id": 46086377, "answer_count": 1, "score": 1, "last_activity_date": 1504746545, "creation_date": 1504110694, "last_edit_date": 1504112881, "question_id": 45965559, "link": "https://stackoverflow.com/questions/45965559/vba-sorting-a-collection-by-value", "title": "VBA sorting a collection by value", "body": "<p>I have the VBA collection below </p>\n\n<p><a href=\"https://i.stack.imgur.com/vlwUt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vlwUt.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ENTlT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ENTlT.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to sort by the value such that the collection will end up with the highest double value in the highest index position (i.e. \"e\" with value 14 is in first index, \"c\" with value 10 is second, etc). How is this possible?</p>\n\n<pre><code>Public Function SortCollection(ByVal c As Collection) As Collection\n    Dim n As Long: n = c.Count\n\n    If n = 0 Then\n        Set SortCollection = New Collection\n    Exit Function\n\n    ReDim Index(0 To n - 1) As Long ' allocate index array\n    Dim i As Long, m As Long\n\n    For i = 0 To n - 1: Index(i) = i + 1: Next ' fill index array\n\n    For i = n \\ 2 - 1 To 0 Step -1 ' generate ordered heap\n        Heapify c, Index, i, n\n    Next\n\n    For m = n To 2 Step -1 ' sort the index array\n        Exchange Index, 0, m - 1 ' move highest element to top\n        Heapify c, Index, 0, m - 1\n    Next\n\n    Dim c2 As New Collection\n    For i = 0 To n - 1 ' fill output collection\n         c2.Add c.item(Index(i))\n    Next\n\n    Set SortCollection = c2\n\n   End Function\n\nPrivate Sub Heapify(ByVal c As Collection, Index() As Long, ByVal i1 As Long, ByVal n As Long)\n   ' Heap order rule: a[i] &gt;= a[2*i+1] and a[i] &gt;= a[2*i+2]\n   Dim nDiv2 As Long: nDiv2 = n \\ 2\n   Dim i As Long: i = i1\n   Do While i &lt; nDiv2\n      Dim k As Long: k = 2 * i + 1\n      If k + 1 &lt; n Then\n         If c.item(Index(k)) &lt; c.item(Index(k + 1)) Then k = k + 1\n         End If\n      If c.item(Index(i)) &gt;= c.item(Index(k)) Then Exit Do\n      Exchange Index, i, k\n      i = k\n      Loop\n   End Sub\n\nPrivate Sub Exchange(Index() As Long, ByVal i As Long, ByVal j As Long)\n   Dim Temp As Long: Temp = Index(i)\n   Index(i) = Index(j)\n   Index(j) = Temp\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "printing"], "comments": [{"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 1, "creation_date": 1504111393, "post_id": 45965509, "comment_id": 78890372, "body": "When a file is opened it&#39;s loaded into memory, the interface is displayed and at that time any workbook-specific calculations can take place.  Excel used to launch fast for versions 2010 and prior, but it&#39;s become significantly slower since. There are ways to open Excel files so they they are not seen by the user, but the file still needs to be loaded into memory before any printing can occur. If the file is large, there&#39;s not much you can do about that.  Besides getting a faster computer, the only thing I can think of is to turn off auto calculations, but I&#39;m guessing you need those to print."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504113817, "post_id": 45965509, "comment_id": 78891673, "body": "how about using a SQL query to pull data from closed workbook into current workbook and print that   ..... <a href=\"https://stackoverflow.com/questions/10506223/retrieving-data-from-closed-workbook-using-adodb-connection-some-data-is-skippe#10506406\" title=\"retrieving data from closed workbook using adodb connection some data is skippe%2310506406\">stackoverflow.com/questions/10506223/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 8533263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6e53af47c376a22bff677dc2c49745?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry-F", "link": "https://stackoverflow.com/users/8533263/jerry-f"}, "reply_to_user": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504164348, "post_id": 45965509, "comment_id": 78909726, "body": "@TonyM Thank you for your prompt answer :) Could you indicate me the way to open files without display it please ?"}, {"owner": {"reputation": 21, "user_id": 8533263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6e53af47c376a22bff677dc2c49745?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry-F", "link": "https://stackoverflow.com/users/8533263/jerry-f"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504164405, "post_id": 45965509, "comment_id": 78909762, "body": "@jsotola Will this solution also works with images that are contained in my close workbook please ? :)"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504164883, "post_id": 45965509, "comment_id": 78910100, "body": "For example, the 2nd answer on this page but setting appXL.Visible = False    <a href=\"https://stackoverflow.com/questions/18775969/open-specific-excel-file-in-new-instance-of-excel-when-file-is-opened\" title=\"open specific excel file in new instance of excel when file is opened\">stackoverflow.com/questions/18775969/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 8533263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6e53af47c376a22bff677dc2c49745?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry-F", "link": "https://stackoverflow.com/users/8533263/jerry-f"}, "reply_to_user": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 0, "creation_date": 1504174756, "post_id": 45965509, "comment_id": 78916830, "body": "@TonyM Ok perfect thank you so much :)"}], "owner": {"reputation": 21, "user_id": 8533263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6e53af47c376a22bff677dc2c49745?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry-F", "link": "https://stackoverflow.com/users/8533263/jerry-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1329, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504110506, "creation_date": 1504110506, "question_id": 45965509, "link": "https://stackoverflow.com/questions/45965509/print-excel-file-without-open-it-vba", "title": "Print excel file without open it - VBA", "body": "<p>Now working on an Excel file, I found out how to print another worksheet from another workbook, but I need to open it before. Here is the code :</p>\n\n<pre><code>Workbooks.Open (\"C:\\...\\myFile.xls\")\nApplication.ActiveWorkbook.PrintOut From:=1, To:=2, Copies:=1, IgnorePrintAreas:=False\nApplication.ActiveWorkbook.Close\n</code></pre>\n\n<p>The problem is, my \"mother file\" is really huge. Open other files (might be a loop to open - now - and print 1X files makes it really long to calculate.</p>\n\n<p>I'm looking for a code to print my excel files without open it.\nFound some codes like \"PrintOut\" function or others but without open it, doesn't seems to work...</p>\n\n<p>Anyone has an idea ?</p>\n\n<p>Thank you for your help :)</p>\n\n<p>Jerry</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 767, "user_id": 8411349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hdm06.jpg?s=128&g=1", "display_name": "PeterH", "link": "https://stackoverflow.com/users/8411349/peterh"}, "edited": false, "score": 0, "creation_date": 1504110307, "post_id": 45965417, "comment_id": 78889727, "body": "Could be some useful info here <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/workbook-beforesave-event-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/VBA/Excel-VBA/articles/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504188590, "post_id": 45967316, "comment_id": 78926667, "body": "Which code do I use and do I add it on to my code because my code is altered here then there is a entire other code under here."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504189513, "post_id": 45967316, "comment_id": 78927365, "body": "Add the <code>Private Sub Workbook_BeforeSave</code> in your <code>ThisWorkbook</code> module under <code>Microsoft Excel Objects</code> folder in your project explorer. You can put the other two subs in any module of your choosing as long as they are in the same module together since the <code>EmptyCells</code> is <code>Private</code>. If you make <code>EmptyCells</code> <code>Public</code>, you can put it in any module as well. Which code do you use? All of it. Maybe I don&#39;t understand your ?"}, {"owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504190114, "post_id": 45967316, "comment_id": 78927810, "body": "Alright I just wasn&#39;t sure because it was two different comments that&#39;s all"}, {"owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504282406, "post_id": 45967316, "comment_id": 78969392, "body": "I couldn&#39;t get it to work I keep getting an error that says Compile Error Sub or Function undefined when I placed in the first code that says Call EditEmptyCells but it highlights the code lines ahead of that in yellow"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504283823, "post_id": 45967316, "comment_id": 78970079, "body": "I added an extra set of parenthesis on the Call EditEmptyCells which I took off. The compiler should&#39;ve done that already for you though. Are you sure the <code>Private Sub Workbook_BeforeSave</code> is in your ThisWorkbook section of code? Your other two can be anywhere as long as they are in the same VBAProject."}, {"owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504284551, "post_id": 45967316, "comment_id": 78970430, "body": "Yes I do have it in ThisWorkbook its under all of the different sheets I have but it still doesn&#39;t work it doesn&#39;t have parenthesis on Call EditEmptyCells but it still doesn&#39;t work for me"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504285714, "post_id": 45967316, "comment_id": 78971021, "body": "Okay, you probably need to move your code out of the <code>Sheet1</code>, <code>Sheet2</code>, etc. modules and move them into <code>modules</code> themselves. The <code>Sheet1</code> and such are (I&#39;m guessing) probably meant for specific sheet events just as the <code>ThisWorkbook</code> is used for workbook events, like <code>BeforeSave</code>. Right-click on any item in your Project Explorer, then go to Insert &gt; Module, probably want to rename it as well, then put the <code>EditEmptyCells</code> and <code>EmptyCells</code> there. If you need to also do the same action for <i>every</i> sheet or just the <code>ActiveSheet</code>, let me know and I&#39;ll modify the code."}, {"owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504615496, "post_id": 45967316, "comment_id": 79070016, "body": "Can you alter the code for an active sheet I&#39;ve created a module and placed the code that has Call Editemptycells and then I placed the other two codes into a sheet. The code I had before doesn&#39;t trigger why is that ?"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504616419, "post_id": 45967316, "comment_id": 79070728, "body": "Done for <code>ActiveSheet</code>. Your before save event won&#39;t fire unless the <code>BeforeSave</code> function is in your <code>Workbook</code> in project explorer. Let me know if my edits help."}, {"owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504888010, "post_id": 45967316, "comment_id": 79204274, "body": "I can&#39;t get it to work I&#39;m not sure why but it will not work at all I&#39;ve followed all the directions and even researched what I was unsure about and it still has the error with yellow highlighting when I place the before save event into This Workbook"}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 0, "last_activity_date": 1504616362, "last_edit_date": 1504616362, "creation_date": 1504117298, "answer_id": 45967316, "question_id": 45965417, "link": "https://stackoverflow.com/questions/45965417/vba-code-to-delete-for-excel-2010/45967316#45967316", "title": "VBA Code to Delete for Excel 2010", "body": "<p>Your code appears to work fine and it sounds like you are just looking for how to loop through the rows. Here is a loop example that goes through each row in the <code>UsedRange</code>:</p>\n\n<p>Code for <code>Workbook</code> in project explorer:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, _\n    Cancel As Boolean)\n\n    Call EditEmptyCells(5, 1)\n\nEnd Sub\n</code></pre>\n\n<p>Code for <code>Module</code> in project explorer:</p>\n\n<pre><code>Sub EditEmptyCells(colToCheck As Integer, colToEmpty As Integer)\n\n    Dim i As Integer\n    Dim s As Sheet1\n    Set s = ActiveWorkbook.ActiveSheet\n\n    For i = 1 To s.UsedRange.Rows.Count\n\n        EmptyCells s.Cells(i), colToEmpty\n\n    Next i\n\nEnd Sub\n\nPrivate Sub EmptyCells(ByVal Target As Range, colToEmpty As Integer)\n\n    'Don't need to check if it's column 5, you are already passing in column 5\n    If Target.Value = vbEmpty Or Len(Trim(CStr(Target.Value))) = 0 Then\n\n        Cells(Target.Row, colToEmpty).ClearContents\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong> Missed the before save part</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "edited": false, "score": 0, "creation_date": 1504188627, "post_id": 45967372, "comment_id": 78926696, "body": "Which code do I use and do I add it on to my code because my code is altered here then there is a entire other code under here"}], "tags": [], "owner": {"reputation": 15, "user_id": 8538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98851e2132df163aa142f1acf61513c8?s=128&d=identicon&r=PG&f=1", "display_name": "B0WS3R", "link": "https://stackoverflow.com/users/8538652/b0ws3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1504117750, "last_edit_date": 1504117750, "creation_date": 1504117476, "answer_id": 45967372, "question_id": 45965417, "link": "https://stackoverflow.com/questions/45965417/vba-code-to-delete-for-excel-2010/45967372#45967372", "title": "VBA Code to Delete for Excel 2010", "body": "<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n\n    Dim ws As Worksheet\n    Set ws = wb.Sheets(\"sheet1\")\n\n    For i = firstRow To lastRow\n\n        If ws.Cells(i, col1) = vbEmpty Then\n            ws.Cells(i, col2) = vbEmpty\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8512382, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5feca145551e0e89a5c2bc14607643b3?s=128&d=identicon&r=PG&f=1", "display_name": "MarQuisM", "link": "https://stackoverflow.com/users/8512382/marquism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1504616362, "creation_date": 1504110142, "last_edit_date": 1504115839, "question_id": 45965417, "link": "https://stackoverflow.com/questions/45965417/vba-code-to-delete-for-excel-2010", "title": "VBA Code to Delete for Excel 2010", "body": "<p>I have a VBA code that deletes the content in a cell that\u2019s in Column A when the content in a cell in Column E is cleared same row. Can the code do that and be altered to check each row and see if the cells in column E is empty and delete what\u2019s in column A upon saving the spreadsheet</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target as Range)\n    If Target.Column = 5 Then\n       If Target.Value = vbEmpty Then\n          Cells(Target.Row,1).ClearContents\n       End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "cell", "vba"], "answers": [{"comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 3, "user_id": 8539139, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kLGC0bz8e_Q/AAAAAAAAAAI/AAAAAAAAAAA/YOxzYTZYGKo/photo.jpg?sz=128", "display_name": "Carolina Yumi Yida", "link": "https://stackoverflow.com/users/8539139/carolina-yumi-yida"}, "edited": false, "score": 0, "creation_date": 1504149975, "post_id": 45965538, "comment_id": 78904310, "body": "@CarolinaYumiYida You&#39;re welcome! Please take a minute to accept the solution to mark your question as Solved."}, {"owner": {"reputation": 3, "user_id": 8539139, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kLGC0bz8e_Q/AAAAAAAAAAI/AAAAAAAAAAA/YOxzYTZYGKo/photo.jpg?sz=128", "display_name": "Carolina Yumi Yida", "link": "https://stackoverflow.com/users/8539139/carolina-yumi-yida"}, "edited": false, "score": 0, "creation_date": 1508334724, "post_id": 45965538, "comment_id": 80570751, "body": "Sorry for the delay, I was trying to figure it out how to accept the solution."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1504110617, "creation_date": 1504110617, "answer_id": 45965538, "question_id": 45965387, "link": "https://stackoverflow.com/questions/45965387/how-to-reference-a-table-column-using-cell-value/45965538#45965538", "title": "How to reference a table column using cell value?", "body": "<p>Try it like this...</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"Table1[[\" &amp; Range(\"A1\").Value &amp; \"]:[\" &amp; Range(\"A4\").Value &amp; \"]]\").Copy\n</code></pre>\n\n<p>I assumed you had a typo shown in bold</p>\n\n<p>Worksheets(\"<strong>Sheets1</strong>\")</p>\n"}], "owner": {"reputation": 3, "user_id": 8539139, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kLGC0bz8e_Q/AAAAAAAAAAI/AAAAAAAAAAA/YOxzYTZYGKo/photo.jpg?sz=128", "display_name": "Carolina Yumi Yida", "link": "https://stackoverflow.com/users/8539139/carolina-yumi-yida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 45965538, "answer_count": 1, "score": 0, "last_activity_date": 1504263694, "creation_date": 1504110035, "last_edit_date": 1531161705, "question_id": 45965387, "link": "https://stackoverflow.com/questions/45965387/how-to-reference-a-table-column-using-cell-value", "title": "How to reference a table column using cell value?", "body": "<p>I have a table and I want to reference a column using a cell value.\nWell, I have this:</p>\n\n<pre><code>Worksheets(\"Sheets1\").Range(\"Table1[[Column1]:[Column3]]\").Copy\n</code></pre>\n\n<p>And I am trying to replace the name of the column (header) by a cell value, like this:</p>\n\n<pre><code>Worksheets(\"Sheets1\").Range(\"Table1[[Range(\"A1\")]:Range(\"A4\")]\").Copy\n</code></pre>\n\n<p>Please, suppose that I have \"Column1\" written in cell A1 and \"Column3\" written in cell A4.</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504110040, "post_id": 45965298, "comment_id": 78889562, "body": "That code compiles OK for me."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504110103, "post_id": 45965298, "comment_id": 78889605, "body": "I&#39;ve  pasted it into Notepad++ and reviewed it a few times but it looks fine. I don&#39;t know why Excel won&#39;t compile it for me."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1504110116, "post_id": 45965298, "comment_id": 78889616, "body": "Not compiling for me - <code>Product</code> in declarations is giving <code>User-defined type not defined</code>, <code>cname</code> isn&#39;t defined."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504110141, "post_id": 45965298, "comment_id": 78889630, "body": "It&#39;s part of a larger Class Module"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 2, "creation_date": 1504110218, "post_id": 45965298, "comment_id": 78889679, "body": "FYI: There is a typo in the line (Value): adjProd.PoundsSold = adjProd.PoundsSold + .ListColumns(&quot;Pounds Sold&quot;).DataBodyRange(lRow.Index).vlaue"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1504110328, "post_id": 45965298, "comment_id": 78889746, "body": "Word of advice: code patterns like this will be terribly difficult to debug (as you are now seeing). I would strongly recommend creating a product class that stores the values from your table, and dont bother the parent with the details of the child (<code>AddProduct arg1, arg2, arg3, arg4, etc.</code> would become <code>AddProduct Product</code>. Likewise, clean up indentation and spacing, that makes code easier to read as well."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504110381, "post_id": 45965298, "comment_id": 78889786, "body": "I have a product class. adjProduct is an instance of that class. This class is Customer"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504110399, "post_id": 45965298, "comment_id": 78889800, "body": "Additionally, an array would be far better suited for the task you&#39;re trying to accomplish. If you can properly index the array your code will be much easier to read, but it will also be a lot cleaner."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504110479, "post_id": 45965298, "comment_id": 78889842, "body": "@jDave1984 Then you need some kind of sub-class that holds the properties you are passing in as arguments. Having a paragraph of arguments is a very strong code smell."}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "edited": false, "score": 1, "creation_date": 1504110496, "post_id": 45965298, "comment_id": 78889853, "body": "This line has an error: <code>adjProd.PoundsSold = adjProd.PoundsSold + .ListColumns(&quot;Pounds Sold&quot;).DataBodyRange(lRow.Index).vlaue</code>. &quot;vlaue&quot;. Try fix that"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504110528, "post_id": 45965298, "comment_id": 78889878, "body": "Also I don&#39;t want to get defensive, but the code indentation is just fine and adheres to best practices. The reason I have the AddProduct method is based on preference. I would have to assign the properties the same way and would have needed a few more extra lines"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "edited": false, "score": 0, "creation_date": 1504110551, "post_id": 45965298, "comment_id": 78889889, "body": "@RafaelMatos that&#39;s been fixed, and isn&#39;t the issue"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504110606, "post_id": 45965298, "comment_id": 78889929, "body": "@BrandonBarney this class uses a Dictionary, which is needed. Thanks for the help, though"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 3, "creation_date": 1504110656, "post_id": 45965298, "comment_id": 78889963, "body": "@jDave1984 Indentation and spacing certainly doesnt adhere to best practices. Yes, you have indented by hierarchy, but there is literally no additional whitespace encouraging readability. The line continuation tokens confuse the code as well, and then the one line <code>If</code> block. Not being a jerk here, but there&#39;s a reason why these kinds of, otherwise easy to fix, bugs can hide so well."}, {"owner": {"reputation": 258, "user_id": 8339418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad52c3a6ccf181822e58ed3ad00bbcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Matos", "link": "https://stackoverflow.com/users/8339418/rafael-matos"}, "edited": false, "score": 1, "creation_date": 1504110719, "post_id": 45965298, "comment_id": 78890001, "body": "OK, then. I can&#39;t see the error, but I would try comment all the If statements, and uncomment it little by little, to see where the error is."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504110742, "post_id": 45965298, "comment_id": 78890015, "body": "The line tokens are a necessity in this case. Please don&#39;t turn this thread into an argument about best practices."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1504110800, "post_id": 45965298, "comment_id": 78890049, "body": "@jDave1984 I am not turning it into an argument about best practices. It is literally the reason why all of us are having a hard time finding the bug (or why the bug doesnt actually exist, but it is impossible to guarantee)."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504110860, "post_id": 45965298, "comment_id": 78890087, "body": "The code has compiled for @TimWilliams"}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 1, "creation_date": 1504110957, "post_id": 45965298, "comment_id": 78890145, "body": "In line 28 there is missing a <code>.Value</code>, but I think that is not the issue you are looking for"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504110989, "post_id": 45965298, "comment_id": 78890163, "body": "Nope. Already fixed, but not the issue. Thanks though"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1504111136, "post_id": 45965298, "comment_id": 78890245, "body": "You need to read about how to make a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. This code requires a ton of work on our part just to get it to compile... and then when we do, it compiles just fine - i.e. the code you&#39;re showing us is entirely irrevant to the problem you say you&#39;re having."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 1, "creation_date": 1504111265, "post_id": 45965298, "comment_id": 78890307, "body": "Maybe on line 34 there is a <code>(lRow.Index).Value</code> missing? Or is that ok?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504111455, "post_id": 45965298, "comment_id": 78890396, "body": "@TimWilliams me too (after adding <code>Sub AddProduct(ParamArray foo())</code> and 4 <code>Property Get</code>+<code>Property Let</code> members). Hence my voting to close for lack of a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504138585, "post_id": 45965298, "comment_id": 78901911, "body": "Considering @BrandonBarney and Mat were having trouble reading my code, I&#39;ve cleaned it up"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504196517, "post_id": 45965298, "comment_id": 78932100, "body": "@Mat&#39;sMug the entire question has been reworded. Please, if you can, open this again. I am wracking my brain about it"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504197259, "post_id": 45965298, "comment_id": 78932498, "body": "That&#39;s great, but it still doesn&#39;t reproduce the problem - code compiles fine... given a <code>Product</code> class with <code>Name</code>, <code>PoundsSold</code>, <code>PriceVariance</code>, <code>PrimalNumber</code>, <code>SalesDollars</code>, <code>SecondsNumber</code>, <code>TargetProfit</code> and <code>VolumeVariance</code> public fields (or properties). Did you try copying that code into a brand new VBA project and see for yourself that there is no compile error? Did you modify the code in any way before posting? Skipped parts maybe? I had to add an <code>AddProduct</code> method to the <code>Customer</code> class for it to compile."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504197568, "post_id": 45965298, "comment_id": 78932674, "body": "This is really strange. I&#39;ve literally taken the <code>ColectProductsForSalesChannel</code> sub and moved it to the top of the class, just above all of my property methods, and now the expected End Sub error hits in the <code>InitMe</code> method."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504197628, "post_id": 45965298, "comment_id": 78932718, "body": "And I did leave out the <code>AddProduct</code> method. My bad. I&#39;ll add that and the Product Class"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504197820, "post_id": 45965298, "comment_id": 78932806, "body": "In any case I think you&#39;re going to end up figuring it out on your own, much faster than you can make this post replicate your error. I&#39;d just delete the question."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504197882, "post_id": 45965298, "comment_id": 78932837, "body": "I&#39;ve just posted the Product class. I&#39;ve never ran into this error before, though. I assumed I was missing something obvious like forgot to close a code block, but I&#39;m not seeing it"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504198385, "post_id": 45965298, "comment_id": 78933081, "body": "Perhaps your project is somehow corrupted? Try exporting all modules and re-importing them. My <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> add-in has a tool to do that in one single step. If Rubberduck can parse your code, there is no compile error in the source. If Rubberduck can&#39;t parse your code, it will tell you exactly where the real problem is. The <i>code inspections</i> can highlight other potential issues, too. I can&#39;t help you with <i>this question</i>, but through Rubberduck I can help you with this and other VBA projects. Hope it helps!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504198958, "post_id": 45965298, "comment_id": 78933362, "body": "It&#39;s entirely possible the project is corrupted. VBA doesn&#39;t care much about the source code you can see and edit in the VBE; the VBE itself isn&#39;t displaying the source code you enter - when you hit [ENTER] it processes that instruction and renders the VBA code for the underlying P-Code. Sometimes a disconnect happens between the underlying P-Code and the VBA source code in the editor. Might be what&#39;s happening here."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504199099, "post_id": 45965298, "comment_id": 78933450, "body": "One of the reasons I absolutely hate the VBE. Although I think I might have isolated the problem into the Segment class (maybe). I exported all three classes into a new workbook and just tried to do a test. Intellisense stops working around the <code>AddCustomersAndProductsBySalesChannel</code> Method"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1506681545, "post_id": 45965298, "comment_id": 79928500, "body": "Your <code>PlantName</code> get property is not assigning a result, only reassigning your field."}], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504115415, "post_id": 45965886, "comment_id": 78892539, "body": "This answer does not help whatsoever. Thanks for trying, though"}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504116486, "post_id": 45965886, "comment_id": 78893178, "body": "I understand he did and I appreciate the help. Except the code structure is not the issue. Thanks again for your attempts"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 1, "creation_date": 1504128519, "post_id": 45965886, "comment_id": 78899223, "body": "@jDave1984 FWIW - I figured out where you problem likely lies, and if you took the time to not get defensive about your code, and instead tried to use the feedback to improve you would quickly find and solve the problem as well. The thing is, bad code makes it really easy to hide mistakes, such as removing the problem that caused the issue before posting to SO. Taking a wild guess here, but those 0&#39;s are actually properties you removed for confidentiality purposes? Another wild guess here, but you missed your missing <code>&quot;</code> or <code>( &#47; )</code> because of all of the in-necessary bits?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1504128623, "post_id": 45965886, "comment_id": 78899256, "body": "Before assuming we are wrong, assume you are wrong. I know that sounds cocky, but if I balked every time someone tried to help me improve my code, I would be a really crappy programmer who would spend more time fixing bad code than I would writing new code, and learning new things. I&#39;m not going to waste more time here, because there are plenty of SO users willing to accept the help we offer, but you will find yourself wasting a lot of time fixing bad code if you don&#39;t take the time to recognize bad code in the first place."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504135788, "post_id": 45965886, "comment_id": 78901382, "body": "1.) I&#39;ve always assumed I was wrong (which is why I post questions on SO). However, the formatting of the code, I knew wasn&#39;t the issue. I thank you for looking at it and attempting to help, what I don&#39;t appreciate is the personal attack.  And the 0&#39;s are hard-coded for now after I finish the initial test of the code.  Having said that, though, I did put those zeros a little hastily working behind a deadline. If you want to post that as the answer you&#39;ll get best answer, despite our initial rapport."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504136056, "post_id": 45965886, "comment_id": 78901450, "body": "Actually on further revision: that is not the issue."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "edited": false, "score": 0, "creation_date": 1504138222, "post_id": 45965886, "comment_id": 78901841, "body": "Cleaner code has been posted if you want to take another look at it."}, {"owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504193864, "post_id": 45965886, "comment_id": 78930454, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/153387/discussion-between-jdave1984-and-brandon-barney\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 1, "last_activity_date": 1504111940, "creation_date": 1504111940, "answer_id": 45965886, "question_id": 45965298, "link": "https://stackoverflow.com/questions/45965298/expected-end-sub-already-have-end-sub/45965886#45965886", "title": "Expected End Sub. Already have End Sub", "body": "<p>As noted in comments, part of the problem you are having is with the readability of your code. It doesnt take much to clean up dirty code (and it doesnt take much to make clean code dirty).</p>\n\n<p>Note, I havent changed what your code <em>does</em> just a little bit of <em>how</em> it does it. In the process, notice how I need fewer variables, less if blocks, and the code is much easier to read. Not to mention it doesnt push the right side of the screen.</p>\n\n<pre><code>Public Sub NewCollectProductsForSalesChannel(ByVal Table As ListObject)\n    Dim InputData As Variant\n    InputData = Table.Range.Value\n\n    Dim HeaderIndices As Scripting.Dictionary\n    Set HeaderIndices = GetHeaderIndices(InputData)\n\n    Dim i As Long\n    For i = LBound(InputData, 1) + 1 To UBound(InputData, 1)\n        ' Assuming cName is a private Class Variable?\n        ' Cut FoundCustomer since it doesnt do anything beyond create a non-needed If block.\n        If InputData(i, HeaderIndices(\"Customer\")) = cName Then\n            Dim ProductID As String\n            ProductID = InputData(i, HeaderIndices(\"Number\")) &amp; InputData(i, HeaderIndices(\"Alt Number\"))\n            If Not cProducts.Exists(ProductID) Then\n                ' Less than ideal, but in lieue of a proper defined type...\n                AddProduct _\n                    InputData(i, HeaderIndices(\"Plant Name\")), _\n                    InputData(i, HeaderIndices(\"Number\")), _\n                    InputData(i, HeaderIndices(\"Alt Number\")), _\n                    InputData(i, HeaderIndices(\"Product\")), _\n                    InputData(i, HeaderIndices(\"Product Line\")), _\n                    InputData(i, HeaderIndices(\"McD Factor\")), _\n                    InputData(i, HeaderIndices(\"Pounds Sold\")), _\n                    InputData(i, HeaderIndices(\"Sales Dollars\")), _\n                    0, _\n                    InputData(i, HeaderIndices(\"Target Profit\")), _\n                    0, _\n                    0, _\n                    0, _\n                    InputData(i, HeaderIndices(\"Volume Variance\"))\n            Else\n                With cProducts(ProductID)\n                    .PoundsSold = InputData(i, HeaderIndices(\"Pounds Sold\"))\n                    .SalesDollars = InputData(i, HeaderIndices(\"Sales Dollars\"))\n                    .TargetProfit = InputData(i, HeaderIndices(\"Target Profit\"))\n                    .VolumeVariance = InputData(i, HeaderIndices(\"Volume Variance\"))\n                End With\n\n                sumvol = sumvol + InputData(i, HeaderIndices(\"Pounds Sold\"))\n                sumRev = sumRev + InputData(i, HeaderIndices(\"Sales Dollars\"))\n                avgPrice = 0\n                sumVolVar = sumVolVar + InputData(i, HeaderIndices(\"Volume Variance\"))\n            End If\n        End If\n    Next\nEnd Sub\n\nPublic Function GetHeaderIndices(ByVal InputData As Variant) As Scripting.Dictionary\n    If IsEmpty(InputData) Then Exit Function\n\n    Dim HeaderIndices As Scripting.Dictionary\n    Set HeaderIndices = New Scripting.Dictionary\n\n    HeaderIndices.CompareMode = TextCompare\n\n    Dim i As Long\n    For i = LBound(InputData, 2) To UBound(InputData, 2)\n        If Not HeaderIndices.Exists(Trim(InputData(LBound(InputData, 1), i))) Then _\n           HeaderIndices.Add Trim(InputData(LBound(InputData, 1), i)), i\n    Next\n\n    Set GetHeaderIndices = HeaderIndices\nEnd Function\n</code></pre>\n\n<p>This didn't take long to write, and frankly I would have cleaned it up more if it was my code (this is begging for a sub class or two).</p>\n\n<p>Also, I would recommend browsing CodeReview for ideas on how to improve your classes. A well-known user, Mat's Mug, uses a <code>this</code> for his private variables and it is a game changer for classes.</p>\n\n<p>Best of luck. You may not like my advice, but you'll have a hard time arguing that your code is cleaner than mine.</p>\n"}], "owner": {"reputation": 760, "user_id": 3166766, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u1JFo.jpg?s=128&g=1", "display_name": "jDave1984", "link": "https://stackoverflow.com/users/3166766/jdave1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1504236319, "creation_date": 1504109778, "last_edit_date": 1531164843, "question_id": 45965298, "link": "https://stackoverflow.com/questions/45965298/expected-end-sub-already-have-end-sub", "title": "Expected End Sub. Already have End Sub", "body": "<p>I'm posting my entire class. I'm trying to run the <code>CollectProductsForSalesChannel</code> Sub called from another method in another module. However, this code won't compile and is telling me that an End Sub is expected. I don't see any blocks of code that haven't been completed and could really use another set of constructive eyes. </p>\n\n<p>I'm getting a compile error in the <code>CollectProductsForSalesChannel</code> sub just before the actual <code>End Sub</code>. </p>\n\n<p>Here is my <code>Customer</code> Class which works with another <code>Product</code> class</p>\n\n<pre><code>Private cProducts As Dictionary\nPrivate cName As String\nPrivate myEndRow As Long\nPrivate myStartRow As Long\nPrivate sumVolume As Double\nPrivate sumRev As Double\nPrivate avgPrice As Double\nPrivate sumVolVar As Double\n\nPublic Property Get SumPoundsSold() As Double\n    SumPoundsSold = sumVolume\nEnd Property\n\nPublic Property Let SumPoundsSold(val As Double)\n    sumVolume = val\nEnd Property\n\nPublic Property Get SumRevenue() As Double\n    SumRevenue = sumRev\nEnd Property\n\nPublic Property Let SumRevenue(val As Double)\n    sumRev = val\nEnd Property\n\nPublic Property Get AveragePrice() As Double\n    AveragePrice = avgPrice\nEnd Property\n\nPublic Property Let AveragePrice(val As Double)\n    avgPrice = val\nEnd Property\n\nPublic Property Get VolumeVariance() As Double\n    VolumeVariance = sumVolVar\nEnd Property\n\nPublic Property Let VolumeVariance(val As Double)\n    sumVolVar = val\nEnd Property\n\nPublic Property Set Products(col As Dictionary)\n    Set cProducts = col\nEnd Property\n\nPublic Property Get Products() As Dictionary\n    Set Products = cProducts\nEnd Property\n\nPublic Property Let Name(val As String)\n    cName = val\nEnd Property\n\nPublic Property Get Name() As String\n    Name = cName\nEnd Property\n\nPublic Property Let StartRow(val As Long)\n    myStartRow = val\nEnd Property\n\nPublic Property Get StartRow() As Long\n    StartRow = myStartRow\nEnd Property\n\nPublic Property Let EndRow(val As Long)\n    myEndRow = val\nEnd Property\n\nPublic Property Get EndRow() As Long\n    EndRow = myEndRow\nEnd Property\n\nPublic Sub InitMe()\n    Set cProducts = New Dictionary\nEnd Sub\n\nPublic Sub CollectProductsForSalesChannel(tbl As ListObject)\n\n    Dim productNumber As String 'Product search reference\n    Dim lRow As ListRow 'ListRow iteration\n    Dim adjProd As Product 'Existing product to append to\n    Dim newProduct As Product 'New Product\n\n    With tbl\n\n        For Each lRow In .ListRows\n\n            If .ListColumns(\"Customer\").DataBodyRange(lRow.Index).Value = cName Then\n\n                productNumber = .ListColumns(\"Number\").DataBodyRange(lRow.Index).Value &amp; .ListColumns(\"Alt Number\").DataBodyRange(lRow.Index).Value\n\n                Set newProduct = New Product\n                newProduct.PrimalNumber = .ListColumns(\"Number\").DataBodyRange(lRow.Index).Value\n                newProduct.SecondsNumber = .ListColumns(\"Alt Number\").DataBodyRange(lRow.Index).Value\n                newProduct.Name = .ListColumns(\"Product\").DataBodyRange(lRow.Index).Value\n                newProduct.PoundsSold = .ListColumns(\"Pounds Sold\").DataBodyRange(lRow.Index).Value\n                newProduct.SalesDollars = .ListColumns(\"Sales Dollars\").DataBodyRange(lRow.Index).Value\n                newProduct.TargetProfit = .ListColumns(\"Target Profit\").DataBodyRange(lRow.Index).Value\n                newProduct.VolumeVariance = .ListColumns(\"Volume Variance\").DataBodyRange(lRow.Index).Value\n                newProduct.PriceVariance = 0\n\n                If Not cProducts.Exists(productNumber) Then\n\n                    Me.AddProduct1 newProduct\n\n                Else\n\n                    Set adjProd = cProducts(productNumber)\n                    adjProd.PoundsSold = adjProd.PoundsSold + newProduct.PoundsSold\n                    adjProd.SalesDollars = adjProd.SalesDollars + newProduct.SalesDollars\n                    adjProd.TargetProfit = adjProd.TargetProfit + newProduct.TargetProfit\n                    adjProd.VolumeVariance = adjProd.VolumeVariance + newProduct.VolumeVariance\n\n                End If\n\n                Me.SumPoundsSold = Me.SumPoundsSold + newProduct.PoundsSold\n                Me.SumRevenue = Me.SumRevenue + newProduct.SalesDollars\n                Me.AveragePrice = 0\n                Me.VolumeVariance = Me.VolumeVariance + newProduct.VolumeVariance\n\n            End If\n\n        Next lRow\n\n    End With\n\nEnd Sub\n\nPublic Sub AddProduct1(prod As Product)\n\n    Dim productNumber As String: productNumber = prod.PrimalNumber &amp; prod.SecondsNumber\n    cProducts.Add productNumber, prod\n\nEnd Sub\n</code></pre>\n\n<p>Below is the <code>Segment Class</code>, which calls the <code>CollectProductsForSalesChannel</code> Sub.</p>\n\n<pre><code>Private sCustomers As Dictionary\nPrivate sName As String\nPrivate IsKA As Boolean\nPrivate CustChecks As Collection\n\nPublic Sub InitMe()\n    Set sCustomers = New Dictionary\n    Set CustChecks = New Collection\nEnd Sub\n\nPublic Property Set Customers(col As Dictionary)\n    Set sCustomers = col\nEnd Property\n\nPublic Property Get Customers() As Dictionary\n    Set Customers = sCustomers\nEnd Property\n\nPublic Property Let Name(val As String)\n    sName = val\nEnd Property\n\nPublic Property Get Name() As String\n    Name = sName\nEnd Property\n\nPublic Property Let IsKeyAccounts(val As Boolean)\n    IsKA = val\nEnd Property\n\nPublic Property Get IsKeyAccounts() As Boolean\n    IsKeyAccounts = IsKA\nEnd Property\n\nPublic Sub AddCustomerCheck(custStr As String)\n    CustChecks.Add custStr\nEnd Sub\n\n'This collects all Customers by Sales Channel as opposed to Segment name\nPublic Sub AddCustomersAndProductsBySalesChannel(tbl As ListObject)\n\n    Dim newCustomer As Customer\n    Dim lRow As ListRow\n\n    With tbl\n\n        For Each lRow In .ListRows\n\n            If .ListColumns(\"Sales Channel\").DataBodyRange(lRow.Index).Value = sName Then\n\n                If Not sCustomers.Exists(.ListColumns(\"Customer\").DataBodyRange(lRow.Index).Value) Then\n\n                    Set newCustomer = New Customer\n                    newCustomer.InitMe\n                    newCustomer.Name = .ListColumns(\"Customer\").DataBodyRange(lRow.Index).Value\n                    sCustomers.Add newCustomer.Name, newCustomer\n                    newCustomer.CollectProductsForSalesChannel tbl\n\n                End If\n\n            End If\n\n        Next lRow\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><code>Product</code> Class:</p>\n\n<pre><code>Private pName As String\nPrivate pNumber As String\nPrivate sNumber As String\nPrivate prodName As String\nPrivate pLine As Integer\nPrivate pMcDFactor As Double\nPrivate pProductionPounds As Double\nPrivate pPoundsSold As Double\nPrivate pSalesDollars As Double\nPrivate pEBITDAProfit As Double\nPrivate pTargetProfit As Double\nPrivate pMcDResChange As Double\nPrivate pPriceVar As Double\nPrivate pVolVar As Double\n\nPublic Property Let PriceVariance(val As Double)\n    pPriceVar = val\nEnd Property\n\nPublic Property Get PriceVaraince() As Double\n    PriceVariance = pPriceVar\nEnd Property\n\nPublic Property Let VolumeVariance(myVariance As Double)\n    pVolVar = myVariance\nEnd Property\n\nPublic Property Get VolumeVariance() As Double\n    VolumeVariance = pVolVar\nEnd Property\n\nPublic Property Let Name(val As String)\n    prodName = val\nEnd Property\n\nPublic Property Get Name() As String\n    Name = prodName\nEnd Property\n\nPublic Property Let PrimalNumber(val As String)\n    pNumber = val\nEnd Property\n\nPublic Property Get PrimalNumber() As String\n    PrimalNumber = pNumber\nEnd Property\n\nPublic Property Let SecondsNumber(val As String)\n    sNumber = val\nEnd Property\n\nPublic Property Get SecondsNumber() As String\n    SecondsNumber = sNumber\nEnd Property\n\nPublic Property Let PlantName(val As String)\n    pName = val\nEnd Property\n\nPublic Property Get PlantName() As String\n    pName = pName\nEnd Property\n\nPublic Property Let ProductLine(val As Integer)\n    pLine = val\nEnd Property\n\nPublic Property Get ProductLine() As Integer\n    ProductLine = pLine\nEnd Property\n\nPublic Property Let McDonaldsFactor(val As Double)\n    pMcDFactor = val\nEnd Property\n\nPublic Property Get McDonaldsFactor() As Double\n    McDonaldsFactor = pMcDFactor\nEnd Property\n\nPublic Property Let PoundsSold(val As Double)\n    pPoundsSold = val\nEnd Property\n\nPublic Property Get PoundsSold() As Double\n    PoundsSold = pPoundsSold\nEnd Property\n\nPublic Property Let SalesDollars(val As Double)\n    pSalesDollars = val\nEnd Property\n\nPublic Property Get SalesDollars() As Double\n    SalesDollars = pSalesDollars\nEnd Property\n\nPublic Property Let EBITDAProfit(val As Double)\n    pEBITDAProfit = val\nEnd Property\n\nPublic Property Get EBITDAProfit() As Double\n    EBITDAProfit = pEBITDAProfit\nEnd Property\n\nPublic Property Let TargetProfit(val As Double)\n    pTargetProfit = val\nEnd Property\n\nPublic Property Get TargetProfit() As Double\n    TargetProfit = pTargetProfit\nEnd Property\n\nPublic Property Let ProductionPounds(val As Double)\n    pProductionPounds = val\nEnd Property\n\nPublic Property Get ProductionPounds() As Double\n    ProductionPounds = pProductionPounds\nEnd Property\n\nPublic Property Let McDResChange(val As Double)\n    pMcDResChange = val\nEnd Property\n\nPublic Property Get McDResChange() As Double\n    McDResChange = pMcDResChange\nEnd Property\n</code></pre>\n\n<p>The only thing I can really think of would be maybe I missed something in my Get/Let methods but I'm obviously missing something. </p>\n"}, {"tags": ["vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 6300208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a90edea6f653d90419946c32b8fe878?s=128&d=identicon&r=PG&f=1", "display_name": "brett_x", "link": "https://stackoverflow.com/users/6300208/brett-x"}, "edited": false, "score": 0, "creation_date": 1504110043, "post_id": 45965233, "comment_id": 78889564, "body": "Thank you @simpLE MAn. I almost never use that drop down and had completely overlooked it."}, {"owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "reply_to_user": {"reputation": 156, "user_id": 6300208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a90edea6f653d90419946c32b8fe878?s=128&d=identicon&r=PG&f=1", "display_name": "brett_x", "link": "https://stackoverflow.com/users/6300208/brett-x"}, "edited": false, "score": 0, "creation_date": 1504110337, "post_id": 45965233, "comment_id": 78889752, "body": "@brett_x; No problem, I never use it myself ;)"}], "tags": [], "owner": {"reputation": 1476, "user_id": 2687063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd630664133fcc656f969d41f73e6602?s=128&d=identicon&r=PG&f=1", "display_name": "simpLE MAn", "link": "https://stackoverflow.com/users/2687063/simple-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1504109600, "creation_date": 1504109600, "answer_id": 45965233, "question_id": 45965077, "link": "https://stackoverflow.com/questions/45965077/vba-delete-userform-control-object-that-is-off-screen/45965233#45965233", "title": "VBA Delete userform control object that is off-screen", "body": "<p>On the \"Properties\" window (<code>F4</code>) in the top dropdown list select the <code>OptionButton1</code> then change the values in the <code>Left</code> and <code>Top</code> properties.</p>\n"}], "owner": {"reputation": 156, "user_id": 6300208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a90edea6f653d90419946c32b8fe878?s=128&d=identicon&r=PG&f=1", "display_name": "brett_x", "link": "https://stackoverflow.com/users/6300208/brett-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 0, "accepted_answer_id": 45965233, "answer_count": 1, "score": 0, "last_activity_date": 1504109600, "creation_date": 1504109066, "question_id": 45965077, "link": "https://stackoverflow.com/questions/45965077/vba-delete-userform-control-object-that-is-off-screen", "title": "VBA Delete userform control object that is off-screen", "body": "<p>I added an Option Button to a userform and it has disappeared off-screen.\nI know it is still there, and I can access it though code. </p>\n\n<p>It's not the end of the world, but for completeness, I'd prefer to delete it. I just can't access it in the UI. Obviously, if I could click on it in the IDE Userform window, I could easily delete it. </p>\n\n<p>My thought was that I could change its location :</p>\n\n<pre><code>Dim x As Variant\n\nFor Each x In Me.Controls\n    Debug.Print x.Name\n    If x.Name = \"OptionButton1\" Then\n        Debug.Print x.Left &amp; \", \" &amp; x.Top\n        x.Left = 1\n        x.Top = 1\n    End If\nNext x\n</code></pre>\n\n<p>This works, but only during runtime. It goes back to its original location as soon as the program ends.  FWIW, it's current location is 240, -528. </p>\n\n<p>Does anyone know another way to access the object? I've also tried </p>\n\n<pre><code>Me.Controls.Remove \"OptionButton1\"\n</code></pre>\n\n<p>which also only works during runtime. </p>\n\n<p>Any thoughts? </p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1504109671, "post_id": 45964906, "comment_id": 78889309, "body": "You could add the values to a dictionary as you go and check if it it already exists before adding to your sheet."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1504110148, "creation_date": 1504110148, "answer_id": 45965420, "question_id": 45964906, "link": "https://stackoverflow.com/questions/45964906/for-loop-that-loops-through-row-and-only-adds-unique-values/45965420#45965420", "title": "For Loop that loops through row and only adds unique values", "body": "<p>An option for this is to sort in your second loop and use a third loop for the addition such as:</p>\n\n<pre><code>Sheets(nme).Range(\"A4:XFD200\").Sort key1:=Sheets(nme).Range(\"D5:D200\"), order1:=xlAscending, Header:=xlYes\n\nDim i, j, k,l as integer\n\nj=0\nk=0\nl=0\n\nFor i = 6 to 200 'based on your range\n    l=l\n    k=l\n    If Cells(i,4).Value=Cells(i-1,4) Then\n        'Nothing\n    Else\n        j=Cells(i,4).Value\n        l=j+k\n    End If\nNext i\n\n'Output l in the desired cell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8538924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25ea7fa267eb037b493c9f3303f744a6?s=128&d=identicon&r=PG&f=1", "display_name": "EP17", "link": "https://stackoverflow.com/users/8538924/ep17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504121831, "creation_date": 1504108547, "last_edit_date": 1504121831, "question_id": 45964906, "link": "https://stackoverflow.com/questions/45964906/for-loop-that-loops-through-row-and-only-adds-unique-values", "title": "For Loop that loops through row and only adds unique values", "body": "<p>I have a macro that consists of 2 loops, but I am only looking for help with the second one (named as a comment as \"Deal Name For Loop\" for your reference). What the second loop does is it goes through my sheets, gathers the value in cell A1 in each sheet, and then places that value in the next(to the right) empty cell in row 4, in another sheet whose name corresponds with what is in the cell I3 in the sheet its looping through. Ill include my code because I understand its a bit confusing. </p>\n\n<p>What I would like this second loop to do, is to not allow duplicate values in row 4. Basically, the macro will be run many times, and I do not want it to compile all the values, from cell A1, into row 4 every time. For now I have been trying to find a way to delete duplicate values in row 4 (as seen towards the end of my code) but I realized that this wouldn't be an effective way of handling the issue. I would rather the For Loop skip the process of copying cell A1 if it reached a sheet whose cell A1 was already in row 4, in the other sheet.</p>\n\n<pre><code>Sub AggLoop()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim nme As String\n    Dim Crng As Range\n    Dim HdrCol As Range\n    Dim Site As String\n    Dim SearchRange As Range\n    Dim HdrRow As Range\n    Dim FinDate As Date\n\n\nApplication.ScreenUpdating = False\n\n ' Date For Loop\n    For Each ws In ActiveWorkbook.Worksheets\n    nme = ws.Range(\"I3\").Text\n    Set rng = ws.Range(\"T7:T200\")\n\n    'Dont Copy Data from these worksheets\n    If ws.Name &lt;&gt; \"Portfolio\" And ws.Name &lt;&gt; \"Master\" And ws.Name &lt;&gt; \"Template\" And ws.Name &lt;&gt; \"Coal\" And ws.Name &lt;&gt; \"E&amp;P\" And ws.Name &lt;&gt; \"Gas Gen\" And ws.Name &lt;&gt; \"Hydro\" And ws.Name &lt;&gt; \"LNG\" And ws.Name &lt;&gt; \"Midstream\" And ws.Name &lt;&gt; \"Solar\" And ws.Name &lt;&gt; \"Transmission\" And ws.Name &lt;&gt; \"Wind\" Then\n    'Storing Copied data into cell (A5)\n       If IsEmpty(Sheets(nme).[A1]) Then\n       rng.Copy Sheets(nme).Range(\"A\" &amp; Rows.Count).End(xlUp)\n\n    'Storing next copied data below previously filled cell\n      Else\n          rng.Copy Sheets(nme).Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n      'Delete duplicates\n          Sheets(nme).Range(\"A4:A200\").RemoveDuplicates Columns:=1, Header:=xlYes\n      'Sort by column A\n        Sheets(nme).Range(\"A4:XFD200\").Sort key1:=Sheets(nme).Range(\"A5:A200\"), order1:=xlAscending, Header:=xlYes\n\n    End If\n  End If\n\nNext ws\n\n' Deal Name For Loop\nFor Each ws In ActiveWorkbook.Worksheets\n    nme = ws.Range(\"I3\").Text\n    Set Crng = ws.Range(\"A1\")\n\n    'Dont Copy Data from these worksheets\n    If ws.Name &lt;&gt; \"Portfolio\" And ws.Name &lt;&gt; \"Master\" And ws.Name &lt;&gt; \"Template\" And ws.Name &lt;&gt; \"Coal\" And ws.Name &lt;&gt; \"E&amp;P\" And ws.Name &lt;&gt; \"Gas Gen\" And ws.Name &lt;&gt; \"Hydro\" And ws.Name &lt;&gt; \"LNG\" And ws.Name &lt;&gt; \"Midstream\" And ws.Name &lt;&gt; \"Solar\" And ws.Name &lt;&gt; \"Transmission\" And ws.Name &lt;&gt; \"Wind\" Then\n    'Storing Copied data into cell A4\n    If IsEmpty(Sheets(nme).[A4]) Then\n    Crng.Copy Sheets(nme).Range(4 &amp; Columns.Count).End(xlLeft)\n    'Storing next copied data below previously filled cell\n      Else\n          Crng.Copy Sheets(nme).Cells(4, Columns.Count).End(xlToLeft).Offset(0, 1)\n\n    'Delete duplicates, this is the part that I am trying to change, so that the For Loop can ignore rather than delete\n\n          Sheets(nme).Range(\"D4:XFD4\").RemoveDuplicates Columns:=Array(4, 500), Header:=xlNo\n\n    End If\nEnd If\n\nNext ws\n</code></pre>\n"}, {"tags": ["vba", "url", "dynamic"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8222808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e434456796e78784b63d490aff810639?s=128&d=identicon&r=PG&f=1", "display_name": "bjefko", "link": "https://stackoverflow.com/users/8222808/bjefko"}, "edited": false, "score": 0, "creation_date": 1504109412, "post_id": 45965104, "comment_id": 78889152, "body": "<i>facepalm</i> Thanks so much!  So easy and it works great!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1504109170, "creation_date": 1504109170, "answer_id": 45965104, "question_id": 45964893, "link": "https://stackoverflow.com/questions/45964893/dynamic-url-with-quertytables-add-vba/45965104#45965104", "title": "Dynamic URL with QuertyTables.Add VBA", "body": "<p>You need spaces around the <code>&amp;</code></p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n   \"URL;http://forecast.weather.gov/MapClick.php?lat=\" &amp; cityLat &amp; _\n    \"&amp;lon=\" &amp; cityLong &amp; \"&amp;unit=0&amp;lg=english&amp;FcstType=text&amp;TextType=2\", _\n        Destination:=Range(\"$A$1\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1504109440, "creation_date": 1504109440, "answer_id": 45965177, "question_id": 45964893, "link": "https://stackoverflow.com/questions/45964893/dynamic-url-with-quertytables-add-vba/45965177#45965177", "title": "Dynamic URL with QuertyTables.Add VBA", "body": "<p>this gets Chicago weather</p>\n\n<pre><code>Sub forecast_weather()\n    Dim cityLon As String\n    Dim cityLat As String\n\n    cityLat = \"41.8781\"\n    cityLong = \"-87.6298\"\n\n    With Worksheets(\"sheet1\").QueryTables.Add( _\n            Connection:=\"URL;http://forecast.weather.gov/MapClick.php?\" _\n            &amp; \"lat=\" &amp; cityLat _\n            &amp; \"&amp;lon=\" &amp; cityLong _\n            &amp; \"&amp;unit=0&amp;lg=english&amp;FcstType=text&amp;TextType=2\", Destination:=Range(\"$A$1\"))\n        .Name = \"q?s=usdCAd=x_1\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlEntirePage\n        .WebFormatting = xlWebFormattingNone\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8222808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e434456796e78784b63d490aff810639?s=128&d=identicon&r=PG&f=1", "display_name": "bjefko", "link": "https://stackoverflow.com/users/8222808/bjefko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 45965104, "answer_count": 2, "score": 0, "last_activity_date": 1504130370, "creation_date": 1504108509, "last_edit_date": 1504130370, "question_id": 45964893, "link": "https://stackoverflow.com/questions/45964893/dynamic-url-with-quertytables-add-vba", "title": "Dynamic URL with QuertyTables.Add VBA", "body": "<p>I'm trying to download data from a weather website (weather.gov) and trying to use variables for the latitude and longitude in the URL.  If I go to the website and switch out the latitude and longitude manually, I will be directed to the correct city's weather forecast.  However, when I try to set the latitude and longitude as a variable and combine the part of the URL that doesn't change with the variables for each city, it give me a compile error, <code>Expected: list separator or )</code>.  It keeps getting stuck on this section <code>(\"&amp;lon=-\")</code> in the URL.  I'm not sure if there's a better way to declare the variable or add them in, but it doesn't make much sense to me why it doesn't like that middle section.  Code below.  Thanks!</p>\n\n<p>P.S. The <code>cityLat</code> and <code>cityLong</code> variables would be values based on the city, but for right now I just have the actual latitude and longitude just to test it with.</p>\n\n<pre><code>Sub forecast_weather()\n    Dim cityLon As String\n    Dim cityLat As String\n\n    cityLat = \"41.8781\"\n    cityLong = \"87.6298\"\n\n    ActiveWorkbook.Worksheets(\"Chicago Weather\").Select\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n         \"URL;http://forecast.weather.gov/MapClick.php?lat=\"&amp;cityLat&amp;\"&amp;lon=-\n         \"&amp;cityLong&amp;\"&amp;unit=0&amp;lg=english&amp;FcstType=text&amp;TextType=2\", _\n         Destination:=Range(\"$A$1\"))\n         .Name = \"q?s=usdCAd=x_1\"\n         .FieldNames = True\n         .RowNumbers = False\n         .FillAdjacentFormulas = False\n         .PreserveFormatting = True\n         .RefreshOnFileOpen = False\n         .BackgroundQuery = True\n         .RefreshStyle = xlInsertDeleteCells\n         .SavePassword = False\n         .SaveData = True\n         .AdjustColumnWidth = True\n         .RefreshPeriod = 0\n         .WebSelectionType = xlEntirePage\n         .WebFormatting = xlWebFormattingNone\n         .WebPreFormattedTextToColumns = True\n         .WebConsecutiveDelimitersAsOne = True\n         .WebSingleBlockTextImport = False\n         .WebDisableDateRecognition = False\n         .WebDisableRedirections = False\n         .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "button", "activex"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1504108427, "post_id": 45964812, "comment_id": 78888484, "body": "why don&#39;t you create a hidden worksheet with all the buttons already set up and then make a copy of the worksheet and make the copy visible"}, {"owner": {"reputation": 11, "user_id": 7981147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2ed6604ed84945b165ca92d4eaa640?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa ", "link": "https://stackoverflow.com/users/7981147/melissa"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504118140, "post_id": 45964812, "comment_id": 78894084, "body": "I just tried that and the buttons copy over fine, and the code shows up but it doesn&#39;t actually execute. I think it may have something to do with the naming of the buttons? I don&#39;t know how to fix that. I renamed the buttons but I guess when it gets copied into a new sheet, the names don&#39;t carry over?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504141451, "post_id": 45964812, "comment_id": 78902406, "body": "maybe the worksheet needs some code that runs during open event, and it renames the buttons"}], "owner": {"reputation": 11, "user_id": 7981147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2ed6604ed84945b165ca92d4eaa640?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa ", "link": "https://stackoverflow.com/users/7981147/melissa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504121859, "creation_date": 1504108226, "last_edit_date": 1531164843, "question_id": 45964812, "link": "https://stackoverflow.com/questions/45964812/how-to-copy-a-button-to-a-new-sheet-with-a-macro", "title": "How to Copy a Button to a New Sheet with a Macro", "body": "<p>I have a Form in VBA that has a button that will create a new sheet within the workbook. </p>\n\n<p>On that new sheet, I need 4 buttons to be on there with their code already in place. </p>\n\n<p>When I hit the 'create new sheet' button, I have the following code for updating the new buttons on the new sheet:</p>\n\n<pre><code>'Update quantity button\nActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n, DisplayAsIcon:=False, Left:=150, Top:=20, Width:=123.75, Height _\n:=23.25).Select\nActiveSheet.OLEObjects(1).Object.Caption = \"Update Quantity\"\n\n'update quantity code\nWith ActiveWorkbook.VBProject.VBComponents(ActiveSheet.CodeName).CodeModule\n    LineNum = .CountOfLines + 1\n    .InsertLines LineNum, _\n        \"Private Sub CommandButton1_Click()\" &amp; vbLf &amp; _\n        \"Dim ComponentAmt As Double\" &amp; vbLf &amp; _\n        \"ComponentNum = Application.InputBox(\"\"Please provide a component number\"\", \"\"Component Number\"\", Type:=1)\" &amp; vbLf &amp; _\n        \"ComponentAmt = Application.InputBox(\"\"Quantity received of the component\"\", \"\"Quantity Received\"\", Type:=1)\" &amp; vbLf &amp; _\n        \"Set found = Range(\"\"A:A\"\").Find(what:=ComponentNum, LookIn:=xlValues, LookAt:=xlWhole)\" &amp; vbLf &amp; _\n        \"If found Is Nothing Then\" &amp; vbLf &amp; _\n        \"MsgBox \"\"Your component number was not found\" &amp; vbLf &amp; _\n        \"Else\" &amp; vbLf &amp; _\n        \"found.Offset(0, 2).Value = found.Offset(0,2).Value + ComponentAmt\" &amp; vbLf &amp; _\n        \"End If\" &amp; vbLf &amp; _\n        \"End Sub\"\nEnd With\n\n'Archive button\nActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n, DisplayAsIcon:=False, Left:=400, Top:=200, Width:=123.75, Height _\n:=23.25).Select\nActiveSheet.OLEObjects(2).Object.Caption = \"1. Export PO\"\n\n'Archive Code\nWith ActiveWorkbook.VBProject.VBComponents(ActiveSheet.CodeName).CodeModule\n    LineNum2 = .CountOfLines + 1\n    .InsertLines LineNum2, _\n        \"Private Sub CommandButton2_Click()\" &amp; vbLf &amp; _\n            \"ActiveSheet.Copy\" &amp; vbLf &amp; _\n            \"With ActiveSheet.UsedRange\" &amp; vbLf &amp; _\n                \".Copy\" &amp; vbLf &amp; _\n                \".PasteSpecial xlValue\" &amp; vbLf &amp; _\n                \".PasteSpecial xlFormats\" &amp; vbLf &amp; _\n            \"End With\" &amp; vbLf &amp; _\n            \"Application.CutCopyMode = False\" &amp; vbLf &amp; _\n            \"ActiveWorkbook.SaveAs \"\"Full Path/\"\"\" &amp; vbLf &amp; _\n        \"End Sub\"\nEnd With\n\n'Hide button\nActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n, DisplayAsIcon:=False, Left:=400, Top:=250, Width:=123.75, Height _\n:=23.25).Select\nActiveSheet.OLEObjects(3).Object.Caption = \"2. Done\"\n\n'hide button Code\nWith ActiveWorkbook.VBProject.VBComponents(ActiveSheet.CodeName).CodeModule\n    LineNum4 = .CountOfLines + 1\n    .InsertLines LineNum4, _\n        \"Private Sub CommandButton3_Click()\" &amp; vbLf &amp; _\n            \"ActiveSheet.Select\" &amp; vbLf &amp; _\n            \"ActiveWindow.SelectedSheets.Visible = False\" &amp; vbLf &amp; _\n        \"End Sub\"\nEnd With\n\n'View price button\nActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n, DisplayAsIcon:=False, Left:=200, Top:=20, Width:=123.75, Height _\n:=23.25).Select\nActiveSheet.OLEObjects(4).Object.Caption = \"View Price\"\n\n'View price code\nWith ActiveWorkbook.VBProject.VBComponents(ActiveSheet.CodeName).CodeModule\n    LineNum4 = .CountOfLines + 1\n    .InsertLines LineNum4, _\n        \"Private Sub CommandButton4_Click()\" &amp; vbLf &amp; _\n            \"Range(\"\"I10\"\").Select\" &amp; vbLf &amp; _\n            \"ActiveCell.FormulaR1C1 = \"\"=VLOOKUP(R[-8]C[-7],KitList!C[-8]:C[11],17,FALSE)\"\"\" &amp; vbLf &amp; _\n            \"Range(\"\"J10\"\").Select\" &amp; vbLf &amp; _\n            \"ActiveCell.FormulaR1C1 = \"\"=VLOOKUP(R[-8]C[-8],KitList!C[-9]:C[10],18,FALSE)\"\"\" &amp; vbLf &amp; _\n            \"Range(\"\"I11\"\").Select\" &amp; vbLf &amp; _\n            \"ActiveCell.FormulaR1C1 = \"\"=VLOOKUP(R[-9]C[-7],KitList!C[-8]:C[11],19,FALSE)\"\"\" &amp; vbLf &amp; _\n            \"Range(\"\"J11\"\").Select\" &amp; vbLf &amp; _\n            \"ActiveCell.FormulaR1C1 = \"\"=VLOOKUP(R[-9]C[-8],KitList!C[-9]:C[10],20,FALSE)\"\"\" &amp; vbLf &amp; _\n        \"End Sub\"\nEnd With\n</code></pre>\n\n<p>The buttons then show on the new worksheet, but when I click on them, nothing happens.</p>\n\n<p>Also, when clicking on the sheet in VBA I have the following code that is supposed to be for the buttons.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n'update quantity\nDim ComponentAmt As Double\nComponentNum = Application.InputBox(\"Please provide a component number\", \"Component Number\", Type:=1)\nComponentAmt = Application.InputBox(\"Quantity received of the component\", \"Quantity Received\", Type:=1)\nSet found = Range(\"A:A\").Find(what:=ComponentNum, LookIn:=xlValues, LookAt:=xlWhole)\nIf found Is Nothing Then\nMsgBox \"Your component number was not found\"\nElse\nfound.Offset(0, 2).Value = found.Offset(0, 2).Value + ComponentAmt\nEnd If\nEnd Sub\nPrivate Sub CommandButton2_Click()\n'export PO\nActiveSheet.Copy\nWith ActiveSheet.UsedRange\n.Copy\n.PasteSpecial xlValue\n.PasteSpecial xlFormats\nEnd With\nApplication.CutCopyMode = False\nActiveWorkbook.SaveAs \"Full Path/\"\nEnd Sub\nPrivate Sub CommandButton3_Click()\n'hides the PO in the document\nActiveSheet.Select\nActiveWindow.SelectedSheets.Visible = False\nEnd Sub\nPrivate Sub CommandButton4_Click()\n'view price\nRange(\"I10\").Select\nActiveCell.FormulaR1C1 = \"=VLOOKUP(R[-8]C[-7],KitList!C[-8]:C[11],17,FALSE)\"\nRange(\"J10\").Select\nActiveCell.FormulaR1C1 = \"=VLOOKUP(R[-8]C[-8],KitList!C[-9]:C[10],18,FALSE)\"\nRange(\"I11\").Select\nActiveCell.FormulaR1C1 = \"=VLOOKUP(R[-9]C[-7],KitList!C[-8]:C[11],19,FALSE)\"\nRange(\"J11\").Select\nActiveCell.FormulaR1C1 = \"=VLOOKUP(R[-9]C[-8],KitList!C[-9]:C[10],20,FALSE)\"\nEnd Sub\n</code></pre>\n\n<p>Should I make the code for each button as a sub then on the buttons call the sub?</p>\n\n<p>If I create more then one new sheet, are the button names going to change?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1504107907, "post_id": 45964265, "comment_id": 78888165, "body": "Can you provide a screen shot of your sheet and maybe end result? Also, you have a VBA tag, have you tried anything through VBA? if so, can you provide the code. It will help to understand your issue"}], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "is_accepted": false, "score": 0, "last_activity_date": 1504108306, "creation_date": 1504108306, "answer_id": 45964840, "question_id": 45964265, "link": "https://stackoverflow.com/questions/45964265/how-to-use-an-array-formula-inside-a-sumif-without-having-to-specific-text/45964840#45964840", "title": "How to use an array formula inside a sumif without having to &quot; &quot; specific text", "body": "<p>I finally found an answer, by using a sumproduct function first and then using a sumifs.</p>\n"}], "owner": {"reputation": 139, "user_id": 6168030, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5b3e5acd7199d291ef57c9bd08cadf33?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/6168030/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504108306, "creation_date": 1504106573, "last_edit_date": 1531161705, "question_id": 45964265, "link": "https://stackoverflow.com/questions/45964265/how-to-use-an-array-formula-inside-a-sumif-without-having-to-specific-text", "title": "How to use an array formula inside a sumif without having to &quot; &quot; specific text", "body": "<p>The currently formula I am using is =SUM(SUMIFS(Sheet2!E:E,Sheet2!$B:$B,A19,Sheet2!$A:$A,{\"704\",\"213\"}))</p>\n\n<p>This is a array inside a sumif function. However for the last part {\"704\",\"213\"}, I would like to reference cell reference instead of a text string. When I change  {\"704\",\"213\"} to {B12,B13} I get an error \"There's a problem with this formula\". Please help.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1504170657, "last_edit_date": 1525816189, "creation_date": 1504106736, "answer_id": 45964311, "question_id": 45964240, "link": "https://stackoverflow.com/questions/45964240/how-to-change-a-single-macro-in-many-excel-workbooks/45964311#45964311", "title": "How to change a single macro in many excel workbooks?", "body": "<p>Read this twice - <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a></p>\n\n<p>Then follow this sequence:</p>\n\n<ul>\n<li>create a new module with the new \"macro\".</li>\n<li>loop through all the files with the old \"macro\".</li>\n<li>delete the module, with the old \"macro\" (see <em>Deleting A Module From A Project</em>)</li>\n<li>add the new module with the new \"macro\". (see <em>Copy A Module From One Project To Another</em>)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8538851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/552ee58eefa31a9adf2bb4ac71d57650?s=128&d=identicon&r=PG&f=1", "display_name": "KoenC", "link": "https://stackoverflow.com/users/8538851/koenc"}, "is_accepted": false, "score": 0, "last_activity_date": 1504473003, "creation_date": 1504473003, "answer_id": 46027868, "question_id": 45964240, "link": "https://stackoverflow.com/questions/45964240/how-to-change-a-single-macro-in-many-excel-workbooks/46027868#46027868", "title": "How to change a single macro in many excel workbooks?", "body": "<p>This is the code I've ultimately used to change one macro and add one in \"ThisWorkbook\"</p>\n\n<pre><code>Sub UpdateAllFiles()\n    Dim folderPath As String\n    Dim wb As Workbook\n    Dim Files As New Collection\n    Dim FileName As Variant\n\n    'Optimize Macro Speed\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    folderPath = \"C:\\MyFolder\" 'MUST BE CHANGED\n\n    If Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath + \"\\\"\n\n   FileName = Dir(folderPath &amp; \"*.xlsm\")\n   Do While FileName &lt;&gt; \"\"\n      Files.Add FileName\n      FileName = Dir\n   Loop\n\n   For Each FileName In Files\n        Set wb = Workbooks.Open(folderPath &amp; FileName)\n        'Call a subroutine here to operate on the just-opened workbook\n        Call ChangeMacros\n        ' Close file\n        wb.Close SaveChanges:=True\n   Next FileName\n\n    'Reset Macro Optimization Settings\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n\nSub ChangeMacros()\n\n' change macro MyMacro\n\n    ChangeIsSucces = CopyModule(\"MyMacro\", ThisWorkbook.VBProject, ActiveWorkbook.VBProject, True)\n\n    If ChangeIsSucces = False Then\n        MsgBox \"Failed on \" &amp; ThisWorkbook.Name\n    End If\n\n' Add Onsave macro (Can be done more aefficiently without any doubt)\n\n        Dim CodePan As VBIDE.CodeModule\n        Dim S As String\n        Set CodePan = ActiveWorkbook.VBProject.VBComponents(\"ThisWorkbook\").CodeModule\n        S = _\n        \"Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\" &amp; vbNewLine &amp; _\n        \"   Dim relativePath As String\" &amp; vbNewLine &amp; _\n        \"   relativePath = ThisWorkbook.Path &amp; \"\"\\_MacroBook_.xlsb\"\"\" &amp; vbNewLine &amp; _\n        \"   Workbooks.Open Filename:=relativePath\" &amp; vbNewLine &amp; _\n        \"   ThisWorkbook.Activate\" &amp; vbNewLine &amp; _\n        \"   Application.Run (\"\"'_MacroBook_.xlsb'!ExportPlanning\"\")\" &amp; vbNewLine &amp; _\n        \"   Workbooks(\"\"_MacroBook_.xlsb\"\").Close SaveChanges:=False\" &amp; vbNewLine &amp; _\n        \"End Sub\"\n\n        With CodePan\n            .InsertLines .CountOfLines + 1, S\n        End With\n\nEnd Sub\n\nFunction CopyModule(ModuleName As String, _\n    FromVBProject As VBIDE.VBProject, _\n    ToVBProject As VBIDE.VBProject, _\n    OverwriteExisting As Boolean) As Boolean\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' Credits to http://www.cpearson.com/excel/vbe.aspx\n    ' \n    ' CopyModule\n    ' This function copies a module from one VBProject to\n    ' another. It returns True if successful or  False\n    ' if an error occurs.\n    '\n    ' Parameters:\n    ' --------------------------------\n    ' FromVBProject         The VBProject that contains the module\n    '                       to be copied.\n    '\n    ' ToVBProject           The VBProject into which the module is\n    '                       to be copied.\n    '\n    ' ModuleName            The name of the module to copy.\n    '\n    ' OverwriteExisting     If True, the VBComponent named ModuleName\n    '                       in ToVBProject will be removed before\n    '                       importing the module. If False and\n    '                       a VBComponent named ModuleName exists\n    '                       in ToVBProject, the code will return\n    '                       False.\n    '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n    Dim VBComp As VBIDE.VBComponent\n    Dim FName As String\n    Dim CompName As String\n    Dim S As String\n    Dim SlashPos As Long\n    Dim ExtPos As Long\n    Dim TempVBComp As VBIDE.VBComponent\n\n    '''''''''''''''''''''''''''''''''''''''''''''\n    ' Do some housekeeping validation.\n    '''''''''''''''''''''''''''''''''''''''''''''\n    If FromVBProject Is Nothing Then\n        CopyModule = False\n        Exit Function\n    End If\n\n    If Trim(ModuleName) = vbNullString Then\n        CopyModule = False\n        Exit Function\n    End If\n\n    If ToVBProject Is Nothing Then\n        CopyModule = False\n        Exit Function\n    End If\n\n    If FromVBProject.Protection = vbext_pp_locked Then\n        CopyModule = False\n        Exit Function\n    End If\n\n    If ToVBProject.Protection = vbext_pp_locked Then\n        CopyModule = False\n        Exit Function\n    End If\n\n    On Error Resume Next\n    Set VBComp = FromVBProject.VBComponents(ModuleName)\n    If Err.Number &lt;&gt; 0 Then\n        CopyModule = False\n        Exit Function\n    End If\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' FName is the name of the temporary file to be\n    ' used in the Export/Import code.\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''\n    FName = Environ(\"Temp\") &amp; \"\\\" &amp; ModuleName &amp; \".bas\"\n    If OverwriteExisting = True Then\n        ''''''''''''''''''''''''''''''''''''''\n        ' If OverwriteExisting is True, Kill\n        ' the existing temp file and remove\n        ' the existing VBComponent from the\n        ' ToVBProject.\n        ''''''''''''''''''''''''''''''''''''''\n        If Dir(FName, vbNormal + vbHidden + vbSystem) &lt;&gt; vbNullString Then\n            Err.Clear\n            Kill FName\n            If Err.Number &lt;&gt; 0 Then\n                CopyModule = False\n                Exit Function\n            End If\n        End If\n        With ToVBProject.VBComponents\n            .Remove .Item(ModuleName)\n        End With\n    Else\n        '''''''''''''''''''''''''''''''''''''''''\n        ' OverwriteExisting is False. If there is\n        ' already a VBComponent named ModuleName,\n        ' exit with a return code of False.\n        ''''''''''''''''''''''''''''''''''''''''''\n        Err.Clear\n        Set VBComp = ToVBProject.VBComponents(ModuleName)\n        If Err.Number &lt;&gt; 0 Then\n            If Err.Number = 9 Then\n                ' module doesn't exist. ignore error.\n            Else\n                ' other error. get out with return value of False\n                CopyModule = False\n                Exit Function\n            End If\n        End If\n    End If\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''\n    ' Do the Export and Import operation using FName\n    ' and then Kill FName.\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''\n    FromVBProject.VBComponents(ModuleName).Export FileName:=FName\n\n    '''''''''''''''''''''''''''''''''''''\n    ' Extract the module name from the\n    ' export file name.\n    '''''''''''''''''''''''''''''''''''''\n    SlashPos = InStrRev(FName, \"\\\")\n    ExtPos = InStrRev(FName, \".\")\n    CompName = Mid(FName, SlashPos + 1, ExtPos - SlashPos - 1)\n\n    ''''''''''''''''''''''''''''''''''''''''''''''\n    ' Document modules (SheetX and ThisWorkbook)\n    ' cannot be removed. So, if we are working with\n    ' a document object, delete all code in that\n    ' component and add the lines of FName\n    ' back in to the module.\n    ''''''''''''''''''''''''''''''''''''''''''''''\n    Set VBComp = Nothing\n    Set VBComp = ToVBProject.VBComponents(CompName)\n\n    If VBComp Is Nothing Then\n        ToVBProject.VBComponents.Import FileName:=FName\n    Else\n        If VBComp.Type = vbext_ct_Document Then\n            ' VBComp is destination module\n            Set TempVBComp = ToVBProject.VBComponents.Import(FName)\n            ' TempVBComp is source module\n            With VBComp.CodeModule\n                .DeleteLines 1, .CountOfLines\n                S = TempVBComp.CodeModule.Lines(1, TempVBComp.CodeModule.CountOfLines)\n                .InsertLines 1, S\n            End With\n            On Error GoTo 0\n            ToVBProject.VBComponents.Remove TempVBComp\n        End If\n    End If\n    Kill FName\n    CopyModule = True\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 8224420, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8d53f6c9226fbd86d9b159a2b9d1658e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Phi", "link": "https://stackoverflow.com/users/8224420/joe-phi"}, "is_accepted": false, "score": 0, "last_activity_date": 1512500033, "last_edit_date": 1512500033, "creation_date": 1512491985, "answer_id": 47658496, "question_id": 45964240, "link": "https://stackoverflow.com/questions/45964240/how-to-change-a-single-macro-in-many-excel-workbooks/47658496#47658496", "title": "How to change a single macro in many excel workbooks?", "body": "<p>I had the problem with Sub Workbook_BeforeSave: In a good number of old files this function prevented saving it if the Excel version was not Excel 2007. (i.e. even with Excel 2013 or 2016 it would not save the file).</p>\n\n<p>It was simple enough to DELETE the old Sub Workbook_BeforeSave but Excel (at least Excel 2016) acted up when the file was saved to another folder (.SaveAs) right after removing the sub (\"Excel has stopped working...\"). I then tried not to remove the whole sub but just it's content (all lines between 'Sub' and 'End Sub'; that cause Excel to stall.</p>\n\n<p>Also re-compiling with</p>\n\n<pre><code>   Dim objVBECommandBar            As Object\n   Dim compileMe                   As Object\n       Set objVBECommandBar = Application.VBE.CommandBars\n       Set compileMe = objVBECommandBar.FindControl(Type:=msoControlButton, ID:=578)\n       compileMe.Execute 'the project should hence be compiled\n</code></pre>\n\n<p>...didn't help. I suspect a mismatch of the Excel function address table after the manipulation of the code module.</p>\n\n<p>What did help was commenting out the content of Sub Workbook_BeforeSave(...), i.e. keeping </p>\n\n<pre><code>    Sub Workbook_BeforeSave (...)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>    End Sub\n</code></pre>\n\n<p>...and make everything inbetween as comment.</p>\n\n<pre><code>    Function CommentOutProcedureContent(filename As String, moduleName As String, procName As String) As Variant\n    Dim module      As CodeModule\n    Dim start       As Long\n    Dim realStart   As Long\n    Dim Lines       As Long\n    Dim rowIdx      As Long\n    Dim thisLine    As String\n    Dim tmpStr      As String\n\n        Set module = Workbooks(filename).VBProject.VBComponents(moduleName).CodeModule\n        On Error Resume Next\n        Err.Clear\n        With module\n            start = .ProcStartLine(procName, vbext_pk_Proc)\n            If Err.Number = 0 Then\n                Lines = .ProcCountLines(procName, vbext_pk_Proc)\n                ' find the real 'function' or 'sub' beginning\n                realStart = start\n                If .Find(\"Sub \" &amp; procName, realStart, 1, start + Lines, -1) Then\n                    '=&gt; realStart now has the real line number\n                ElseIf .Find(\"Function \" &amp; procName, realStart, 1, start + Lines, -1) Then\n                    '=&gt; realStart now has the real line number\n                Else\n                    Err.Raise 999\n                End If\n                If Err.Number = 0 Then\n                    For rowIdx = (realStart + 1) To (Lines + start - 2)\n                        tmpStr = module.Lines(rowIdx, 1)\n                        .DeleteLines rowIdx\n                        .InsertLines rowIdx, \"'\" &amp; tmpStr\n                    Next rowIdx\n                End If\n            End If\n        End With\n\n        CommentOutProcedureContent = Err.Number\n        On Error GoTo 0\n    End Function\n</code></pre>\n\n<p>The need for 2 variables, start and realStart, comes from the fact that module.ProcStartLine(...) returns the next line number after the 'End Sub' of the previous function/sub and not the line number of \"Sub Workbook_BeforeSave(...)\".</p>\n\n<p>So the upper layer looks like this :</p>\n\n<pre><code>    Function DisableWorkbookBeforeSave(filename As String) As Variant\n    Const thisFunction = \"DisableWorkbookBeforeSave\"\n    Dim objVBECommandBar            As Object\n    Dim compileMe                   As Object\n    Dim varTMP                      As Variant\n    Dim errMsg                      As String\n        Application.DisplayAlerts = False\n        errMsg = \"\"\n        varTMP = CommentOutProcedureContent(filename, \"ThisWorkbook\", \"Workbook_BeforeSave\")\n        If varTMP = 0 Then ' everything's ok\n            Application.Workbooks(LDRFilename).Activate\n            Set objVBECommandBar = Application.VBE.CommandBars\n            Set compileMe = objVBECommandBar.FindControl(Type:=msoControlButton, ID:=578)\n            compileMe.Execute 'the project should hence be compiled\n        Else\n            errMsg = thisFunction &amp; \" ended with ERROR! Commenting out Sub Workbook_BeforeSave\" _\n                                  &amp; \" in LDR &gt;\" &amp; LDRFilename &amp; \"&lt; failed.\" _\n                                  &amp; \" with error \" &amp; Err.Number &amp; \"(\" &amp; Err.Description &amp; \")\"\n            write2log errMsg, 1\n            MsgBox errMsg\n        End If\n        DisableWorkbookBeforeSave = varTMP\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8538851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/552ee58eefa31a9adf2bb4ac71d57650?s=128&d=identicon&r=PG&f=1", "display_name": "KoenC", "link": "https://stackoverflow.com/users/8538851/koenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 45964311, "answer_count": 3, "score": 1, "last_activity_date": 1512500033, "creation_date": 1504106489, "last_edit_date": 1504121919, "question_id": 45964240, "link": "https://stackoverflow.com/questions/45964240/how-to-change-a-single-macro-in-many-excel-workbooks", "title": "How to change a single macro in many excel workbooks?", "body": "<p>I have to make a minor change to an existing macro that is used in >100 XLSM files. The macro is saved locally in the files and has the same name in all files.\nIs there a way to automate this?</p>\n\n<p>I know it would have been better to store this macro in a separate sheet... \nThe reason for the request is exactly that we want to switch to a central macro and change the 'local' macro code to call the 'central' one.</p>\n"}, {"tags": ["vba", "loops", "criteria"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504106495, "post_id": 45964116, "comment_id": 78887258, "body": "you have written the answer in your question `if test = ActiveSheet.Cells(57 + j, 13).Value and test = ActiveSheet.Cells(57 + j, 37).Value then exit do"}], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1504106594, "creation_date": 1504106594, "answer_id": 45964270, "question_id": 45964116, "link": "https://stackoverflow.com/questions/45964116/test-multiple-criteria-in-vba-do-while-loop/45964270#45964270", "title": "Test Multiple Criteria in VBA DO While loop", "body": "<p>Check this loop</p>\n\n<pre><code>Do While test1 &lt;&gt; True Or test2 &lt;&gt; True\nk = k + Increment\nActiveSheet.Cells(56 + j, 17).Value = k\ntest1 = ActiveSheet.Cells(57 + j, 13).Value\ntest2 = ActiveSheet.Cells(57 + j, 37).Value\nLoop\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7487056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e0ce694b3b5b2d0419c00744d3b8974?s=128&d=identicon&r=PG&f=1", "display_name": "Noah", "link": "https://stackoverflow.com/users/7487056/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1024, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504109177, "creation_date": 1504106143, "last_edit_date": 1504109177, "question_id": 45964116, "link": "https://stackoverflow.com/questions/45964116/test-multiple-criteria-in-vba-do-while-loop", "title": "Test Multiple Criteria in VBA DO While loop", "body": "<p>I am trying to edit some VBA code which currently loops until a certain test is met. What I would like to do is loop until two conditions are met. I am having trouble getting it do so. Here is the original code, which works.</p>\n\n<pre><code>    Loop\n    For j = 1 To 29\n    Increment = Worksheets(\"Price &amp; Energy Curve\").Cells(8 + Start + j, 3).Value\n    l = Int((Worksheets(\"Capacity\").Cells(57 + j, 12).Value) * (-1) / Increment)\n    k = WorksheetFunction.Max((l + 1) * Increment, 0)\n    Worksheets(\"Capacity\").Activate\n    ActiveSheet.Cells(56 + j, 17).Value = k\n    test = ActiveSheet.Cells(57 + j, 13).Value\n    Do While test &lt;&gt; True\n    k = k + Increment\n    ActiveSheet.Cells(56 + j, 17).Value = k\n    test = ActiveSheet.Cells(57 + j, 13).Value\n    Loop\n    Next j\n</code></pre>\n\n<p>I would like to add the additional test of</p>\n\n<pre><code>   test = ActiveSheet.Cells(57 + j, 37).Value\n</code></pre>\n\n<p>So that when</p>\n\n<pre><code>   test = ActiveSheet.Cells(57 + j, 13).Value\n</code></pre>\n\n<p>and</p>\n\n<pre><code>  test = ActiveSheet.Cells(57 + j, 37).Value\n</code></pre>\n\n<p>are true, the loop exits.</p>\n"}, {"tags": ["vba", "powerpoint", "media"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "edited": false, "score": 0, "creation_date": 1504108442, "post_id": 45964460, "comment_id": 78888497, "body": "Ok thank you. But I&#39;ll need just one more thing, how to I change the &quot;Background playing&quot; to true (so that it plays in the background, in each slide)?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "edited": false, "score": 0, "creation_date": 1504108976, "post_id": 45964460, "comment_id": 78888853, "body": "@DanielCl&#237;maco if you use the Locals window in the VBE to view the object properties, it looks like you can do that via <code>newShp.AnimationSettings.PlaySettings</code>."}, {"owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "edited": false, "score": 0, "creation_date": 1504109518, "post_id": 45964460, "comment_id": 78889226, "body": "I can&#39;t find the propertie &quot;play between/through slides&quot;, that&#39;s the one I want (just forgot the name)"}, {"owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "edited": false, "score": 0, "creation_date": 1504111223, "post_id": 45964460, "comment_id": 78890284, "body": "How do I enable the propertie to play through the slides?"}, {"owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "edited": false, "score": 0, "creation_date": 1504113397, "post_id": 45964460, "comment_id": 78891412, "body": "Oh sorry didn&#39;t see the end of your answer."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "edited": false, "score": 0, "creation_date": 1504113499, "post_id": 45964460, "comment_id": 78891481, "body": "no problem, yes I added taht after you asked initially. I think you still need to click to get it to play initially, but once  playing it should continue through the slideshow."}, {"owner": {"reputation": 141, "user_id": 6317460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-Vs8kDsIy8-c/AAAAAAAAAAI/AAAAAAAAABc/eFB__XCZSgQ/photo.jpg?sz=128", "display_name": "codeEnthusiast", "link": "https://stackoverflow.com/users/6317460/codeenthusiast"}, "edited": false, "score": 0, "creation_date": 1606177594, "post_id": 45964460, "comment_id": 114878324, "body": "@DavidZemens Is it possible to fade to a particular volume, rather than fade all the way to muted?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1606177750, "post_id": 45964460, "comment_id": 114878359, "body": "What have you tried so far? Also, this should be asked as a new question, not as a comment on an existing answer..."}, {"owner": {"reputation": 141, "user_id": 6317460, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-Vs8kDsIy8-c/AAAAAAAAAAI/AAAAAAAAABc/eFB__XCZSgQ/photo.jpg?sz=128", "display_name": "codeEnthusiast", "link": "https://stackoverflow.com/users/6317460/codeenthusiast"}, "edited": false, "score": 0, "creation_date": 1606178335, "post_id": 45964460, "comment_id": 114878480, "body": "See <a href=\"https://stackoverflow.com/questions/64916028/fade-volume-of-background-media-on-specific-slide-in-powerpoint-using-vba\" title=\"fade volume of background media on specific slide in powerpoint using vba\">stackoverflow.com/questions/64916028/&hellip;</a>"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1504114997, "last_edit_date": 1504114997, "creation_date": 1504107153, "answer_id": 45964460, "question_id": 45963907, "link": "https://stackoverflow.com/questions/45963907/change-media-object-vba-powerpoint/45964460#45964460", "title": "Change Media Object (VBA PowerPoint)", "body": "<p>You're going to need to delete the existing shape and replace it with a new one, copying the properties as needed. <a href=\"https://msdn.microsoft.com/en-us/library/office/gg985317(v=office.14).aspx\" rel=\"nofollow noreferrer\">This MSDN article</a> enumerates some (all?) of the <code>MediaFormat</code> properties.</p>\n\n<pre><code>Option Explicit\n\nSub ReplaceMediaFormat()\nDim sld As Slide\nDim newShp As Shape\nDim shp As Shape\nDim mf As MediaFormat\nDim path As String\n\nSet sld = ActivePresentation.Slides(1) '// Modify as needed\nSet shp = sld.Shapes(\"bg_music\")\nSet mf = shp.MediaFormat\n\n'// Modify the path for your new media file:\npath = \"C:\\Users\\david.zemens\\Downloads\\2540.mp3\"\n\nSet newShp = sld.Shapes.AddMediaObject2(path)\nWith newShp\n    .Top = shp.Top\n    .Left = shp.Left\n    .Width = shp.Width\n    .Height = shp.Height\n    ' etc...\n\nEnd With\n\n' // copy the mediaformat properties as needed\n\nWith newShp.MediaFormat\n    .StartPoint = mf.StartPoint\n    .EndPoint = mf.EndPoint\n    .FadeInDuration = mf.FadeInDuration\n    .FadeOutDuration = mf.FadeOutDuration\n    .Muted = mf.Muted\n    .Volume = mf.Volume\n    ' etc...\nEnd With\n\n'// remove the original\nshp.Delete\n\nDim eff As Effect\n'// Creates an effect in the timeline which triggers this audio to play when the slideshow begins\nSet eff = sld.TimeLine.MainSequence.AddEffect(newShp, msoAnimEffectMediaPlay, trigger:=msoAnimTriggerWithPrevious)\n\nWith newShp.AnimationSettings.PlaySettings\n    .LoopUntilStopped = msoCTrue\n    .PauseAnimation = msoFalse\n    .PlayOnEntry = msoCTrue\n    .RewindMovie = msoCTrue\n    .StopAfterSlides = 999\n    .HideWhileNotPlaying = msoTrue\nEnd With\n</code></pre>\n\n<p>With help from <a href=\"https://msdn.microsoft.com/en-us/library/office/aa172814(v=office.11).aspx\" rel=\"nofollow noreferrer\">this article</a>, I can get the audio to play automatically by creating an <em>effect</em> (see above <code>Set eff = ...</code>).</p>\n"}], "owner": {"reputation": 69, "user_id": 8168070, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1798836273761991/picture?type=large", "display_name": "Daniel Cl&#237;maco", "link": "https://stackoverflow.com/users/8168070/daniel-cl%c3%admaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1078, "favorite_count": 0, "accepted_answer_id": 45964460, "answer_count": 1, "score": 0, "last_activity_date": 1593772966, "creation_date": 1504105544, "last_edit_date": 1593772966, "question_id": 45963907, "link": "https://stackoverflow.com/questions/45963907/change-media-object-vba-powerpoint", "title": "Change Media Object (VBA PowerPoint)", "body": "<p>I just want to change the music of a Media Object in PowerPoint using Macros. I have a music in a Slide, but I can't figure out how I can change it to different music. Or is it possible to replace it by a new one but with the same properties...?\nI tried playing around with following code but I don't know the rest...</p>\n\n<pre><code>Slide3.Shapes(\"bg_music\").MediaFormat. 'code that I don't know to change it's music/media\n</code></pre>\n"}, {"tags": ["excel", "runtime-error", "paste", "vba"], "comments": [{"owner": {"reputation": 893, "user_id": 2504372, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Cm6bh.jpg?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/2504372/vincent"}, "edited": false, "score": 1, "creation_date": 1504106304, "post_id": 45963729, "comment_id": 78887125, "body": "Welcome to SO ! Please, show a minimal example of your code so we can look for what may be the reason of your problem."}, {"owner": {"reputation": 21, "user_id": 8538609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2720315af2d5a1f52daffb36a1dc1074?s=128&d=identicon&r=PG&f=1", "display_name": "Chantal", "link": "https://stackoverflow.com/users/8538609/chantal"}, "reply_to_user": {"reputation": 893, "user_id": 2504372, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Cm6bh.jpg?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/2504372/vincent"}, "edited": false, "score": 1, "creation_date": 1504168245, "post_id": 45963729, "comment_id": 78912161, "body": "@vincent: i added the macro text"}, {"owner": {"reputation": 893, "user_id": 2504372, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Cm6bh.jpg?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/2504372/vincent"}, "edited": false, "score": 0, "creation_date": 1504172471, "post_id": 45963729, "comment_id": 78915145, "body": "Nice. Now, you should add tags, at least one specifying the language you use (VBA I think ?) so people competent in that language are more likely to see (and hence answer) your question."}, {"owner": {"reputation": 21, "user_id": 8538609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2720315af2d5a1f52daffb36a1dc1074?s=128&d=identicon&r=PG&f=1", "display_name": "Chantal", "link": "https://stackoverflow.com/users/8538609/chantal"}, "reply_to_user": {"reputation": 893, "user_id": 2504372, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Cm6bh.jpg?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/2504372/vincent"}, "edited": false, "score": 0, "creation_date": 1504181177, "post_id": 45963729, "comment_id": 78921223, "body": "@Vincent, done, thx!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9589346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/548b3254bedc60c8b6e27afa55fe2e2f?s=128&d=identicon&r=PG", "display_name": "Bernd", "link": "https://stackoverflow.com/users/9589346/bernd"}, "is_accepted": false, "score": 0, "last_activity_date": 1522734696, "creation_date": 1522734696, "answer_id": 49623114, "question_id": 45963729, "link": "https://stackoverflow.com/questions/45963729/macro-error-1004-when-pasting-but-only-on-other-computers/49623114#49623114", "title": "Macro error 1004 when pasting but only on other computers", "body": "<p>I recently came across a similar problem. For me, it was helpful to remove the 'Application.ScreenUpdating = False' statement. This statement seems to crash Excel sometimes when running within a CITRIX environment.</p>\n"}], "owner": {"reputation": 21, "user_id": 8538609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2720315af2d5a1f52daffb36a1dc1074?s=128&d=identicon&r=PG&f=1", "display_name": "Chantal", "link": "https://stackoverflow.com/users/8538609/chantal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1522734696, "creation_date": 1504105035, "last_edit_date": 1531164843, "question_id": 45963729, "link": "https://stackoverflow.com/questions/45963729/macro-error-1004-when-pasting-but-only-on-other-computers", "title": "Macro error 1004 when pasting but only on other computers", "body": "<p>My macro's work just fine on my (citrix) workpost, but on other workposts I get a 1004 error, and I don't understand why.</p>\n\n<p>It concerns a series of 18 macro's that copy/paste shapes from one (source) sheet to another (destination) sheet, deleting the former shape from the destination sheet before copy/pasting the next one.</p>\n\n<p>Goal is to guide the user through 18 infoscreens (=rectangular shapes with text in it)... he moves through the infoscreens by clicking on a button (in the infoscreen) that is linked to the macro's</p>\n\n<p>The error always occurs on the line that should paste the shape to the destination sheet.</p>\n\n<p>Strangely the 1004 error does not always occur in the same macro, sometimes I manage to get through several screens, sometimes it blocks at the first one.</p>\n\n<p>All help or suggestions would be very much appreciated!</p>\n\n<p>Macro text:</p>\n\n<blockquote>\n<pre><code>   Application.ScreenUpdating = False\n   ActiveSheet.Unprotect\n   ActiveSheet.Shapes.Range(Array(\"TFS9\")).Select\n   Selection.Delete\n   ActiveSheet.Shapes.Range(Array(\"TFS9TEL\")).Select\n   Selection.Delete\n   Sheets(\"Tour FIP Shop\").Visible = True\n   Sheets(\"Tour FIP Shop\").Select\n   ActiveSheet.Shapes.Range(Array(\"TFS10\")).Select\n   Selection.Copy\n   Sheets(\"FIP Shop\").Select\n   Range(\"e18\").Select\n   ActiveSheet.Paste\n   Application.CutCopyMode = False\n   Sheets(\"Tour FIP Shop\").Select\n   ActiveSheet.Shapes.Range(Array(\"TFS10TEL\")).Select\n   Selection.Copy\n   Sheets(\"FIP Shop\").Select\n   Range(\"Q41\").Select\n   ActiveSheet.Paste\n   Application.CutCopyMode = False\n   Sheets(\"Tour FIP Shop\").Select\n   ActiveWindow.SelectedSheets.Visible = False\n   Sheets(\"FIP Shop\").Select\n   ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n   Application.CutCopyMode = False\n   Application.ScreenUpdating = True\n</code></pre>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 0, "creation_date": 1504105484, "post_id": 45963557, "comment_id": 78886526, "body": "Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> on how to ask a good question on SO."}, {"owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "reply_to_user": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "edited": false, "score": 0, "creation_date": 1504105794, "post_id": 45963557, "comment_id": 78886771, "body": "Thanks for the link. I&#39;m new, now I&#39;ll get acquainted with the rules."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "edited": false, "score": 0, "creation_date": 1504105679, "post_id": 45963835, "comment_id": 78886664, "body": "Thanks for the answer! That&#39;s what I need! Tell me please, is it possible to check whether the IE browser print dialog box is already open with the help of the OLECMDID_PRINT command? For example, can I check whether the user opened the browser&#39;s print dialog box?"}], "tags": [], "owner": {"reputation": 1658, "user_id": 4350421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/p2Iig.png?s=128&g=1", "display_name": "silentsurfer", "link": "https://stackoverflow.com/users/4350421/silentsurfer"}, "is_accepted": true, "score": 0, "last_activity_date": 1504105358, "creation_date": 1504105358, "answer_id": 45963835, "question_id": 45963557, "link": "https://stackoverflow.com/questions/45963557/automate-ie-print-dialog-box-without-using-sendkeys/45963835#45963835", "title": "Automate IE print dialog box without using SendKeys", "body": "<p>It is, by using the InternetExplorer object's ExecWB method (see <a href=\"https://msdn.microsoft.com/en-us/library/aa752087(v=vs.85).aspx\" rel=\"nofollow noreferrer\">this link</a> for details). </p>\n\n<p>After adding a reference to the <em>Microsoft Internet Controls</em> library to your project, the following example should get you started:</p>\n\n<pre><code>Option Explicit\n\nSub PrintWebPage()\n\n    Dim ie As InternetExplorer\n\n    Set ie = New InternetExplorer\n\n    ie.Navigate \"http://www.google.com/\"\n    ie.Visible = 1\n\n    'Wait for page to finish loading\n    Do While ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\n     DoEvents\n    Loop\n\n    ie.ExecWB OLECMDID_PRINT, OLECMDEXECOPT_DONTPROMPTUSER\n\n    MsgBox \"Done printing.\", vbInformation\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "closed_date": 1504152637, "accepted_answer_id": 45963835, "answer_count": 1, "score": -3, "last_activity_date": 1504105358, "creation_date": 1504104575, "question_id": 45963557, "link": "https://stackoverflow.com/questions/45963557/automate-ie-print-dialog-box-without-using-sendkeys", "closed_reason": "Needs more focus", "title": "Automate IE print dialog box without using SendKeys", "body": "<p>Is it possible to control the IE browser print dialog box in VBA without using SendKeys?</p>\n"}, {"tags": ["html", "excel", "drop-down-menu", "vba"], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504106957, "post_id": 45963862, "comment_id": 78887586, "body": "Okay, so say Amy Jones leaves the company and Isabella Martin gets hired. <code>x = 0</code> would not be <code>Amy Jones</code> anymore, it would be <code>Brian Wyatt</code>, but I may be assigning something to Carl Lister while Amy is still with the company, then, when she leaves, <code>x = 2</code> would no longer equal <code>Carl Lister</code>, it would now be <code>Daniel Michaels</code>. Is there a way of selecting by the person&#39;s name instead of the index number? Or are the above codes doing just that and I&#39;m reading into it too much?"}, {"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504111702, "post_id": 45963862, "comment_id": 78890519, "body": "Nope, there&#39;s definitely a way to do that. It&#39;s just a matter of figuring out the best way. For example, the <code>value</code> attributes for your options are all 4-digit numbers; are those unique employee identification numbers? If so, you could change the code to target the option with a specific number instead, like <code>if option.value == &#39;0123&#39;</code>. That way, the order of employees, if any were added or removed, wouldn&#39;t matter."}, {"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504112338, "post_id": 45963862, "comment_id": 78890840, "body": "... or you could do it by employee name, if you wanted to. It would just be a matter of looping through the names that are currently there and selecting the right one, using <code>innerText</code>."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504112489, "post_id": 45963862, "comment_id": 78890925, "body": "No, the employee IDs are in parenthesis. I&#39;ve used these values before in another program, but that&#39;s for info that doesn&#39;t change. Employee names, IDs, and possibly the <code>option value</code> could change, therefore, I wanted to be able to mimic typing &quot;CAR&quot; for Carl Lister and have it pop up...which does work when typing manually."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504112581, "post_id": 45963862, "comment_id": 78890977, "body": "For the loop for the employee name, would I need to see if <code>option value=&quot;0345&quot;</code> equals <code>Carl Lister</code>? Not sure how we&#39;d set that up, but that&#39;s the option I&#39;d like to go."}, {"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504113519, "post_id": 45963862, "comment_id": 78891495, "body": "@Lou It would be very similar to that. I edited my answer to include a loop you could use to select an option based on employee name (at the bottom of the answer).  Does that do what you need?"}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504114944, "post_id": 45963862, "comment_id": 78892305, "body": "Getting closer. I don&#39;t want to &quot;change&quot; the option of the employee...I don&#39;t have that kind of access to the web site. What I am looking for is to be able to choose by name. What is happening is this is a tool for assigning work. The web site has the employee&#39;s name at the top. I capture that, then I want to use it to update the <code>select</code> drop down so as to automate the assignment process. That&#39;s the part I want to change is from &quot;--Select User--&quot; to their name."}, {"owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "reply_to_user": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504116036, "post_id": 45963862, "comment_id": 78892932, "body": "@Lou Ah okay, I&#39;ve updated the <code>for</code> loop to do that. Feed it in the employee name and it will find that option and &quot;select&quot; it, so it will be displayed in the <code>select</code> element instead of the default &quot;--Select User--&quot; text."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "edited": false, "score": 0, "creation_date": 1504117191, "post_id": 45963862, "comment_id": 78893587, "body": "Okay, I gave your code a try. It&#39;s saying there&#39;s no object for <code>el.childNodes</code>, but clearly <code>objIE.Document.getElementById(&quot;user&quot;)</code> should be setting the object."}, {"owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "reply_to_user": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "edited": false, "score": 0, "creation_date": 1504121443, "post_id": 45963862, "comment_id": 78895829, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/153295/discussion-between-lou-and-freginold\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "is_accepted": false, "score": 2, "last_activity_date": 1504117755, "last_edit_date": 1504117755, "creation_date": 1504105433, "answer_id": 45963862, "question_id": 45963540, "link": "https://stackoverflow.com/questions/45963540/excel-vba-change-option-in-the-html-select-tag/45963862#45963862", "title": "Excel VBA change option in the HTML select tag", "body": "<p>For a <code>select</code> element, the best way to change the displayed value is to \"select\" one of the <code>option</code> elements that's part of the menu.  To do that, you could change your code like this:</p>\n\n<pre><code>objIE.Document.getElementsByTagName(\"table\")(0).getElementsByTagName(\"td\").Item(64).GetElementsByClassName(\"txt_input1\")(0).childNodes(x).selected = true\n</code></pre>\n\n<p>The code above would select the child node (the <code>option</code> element) at index <code>x</code> and programmatically select it, so that value would be displayed in the <code>select</code> element.  The index for the options starts at 0, so for <code>x = 0</code> that would select the first option (in this case, <code>Amy Jones</code>).</p>\n\n<p>You could also simplify the above code to just read:</p>\n\n<pre><code>objIE.Document.getElementsByClassName(\"txt_input1\")(0).childNodes(x).selected = true\n</code></pre>\n\n<p>Or you could even do it by <code>id</code> since you have an ID assigned to the menu:</p>\n\n<pre><code>objIE.Document.getElementById(\"user\").childNodes(x).selected = true\n</code></pre>\n\n<hr>\n\n<p>If you wanted to select an employee name from the drop down list, you could loop through the existing options and find the correct one like this (code adapted from the VBA code in <a href=\"https://stackoverflow.com/questions/31411708/vba-loop-specific-childnodes-from-xml-code\">this question</a>):</p>\n\n<pre><code>Dim el As IXMLDOMNode\nDim childNode As IXMLDOMNode\n\nel = objIE.Document.getElementById(\"user\")\n\nFor Each childNode in el.ChildNodes\n    If InStr(childNode.innerText, emplName) Then\n        childNode.selected = true\n        Exit For\n    End If\nNext childNode\n</code></pre>\n\n<p>In this example, <code>emplName</code> is whichever employee you want to select.</p>\n\n<p>(My VBA is a little rusty, so I apologize if any of the syntax is off.)</p>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "is_accepted": true, "score": 2, "last_activity_date": 1504185380, "creation_date": 1504185380, "answer_id": 45982371, "question_id": 45963540, "link": "https://stackoverflow.com/questions/45963540/excel-vba-change-option-in-the-html-select-tag/45982371#45982371", "title": "Excel VBA change option in the HTML select tag", "body": "<p>Thanks, @freginold, for all your help. My team and I came up with a solution that expands upon our already developed solutions.</p>\n\n<pre><code>tdNode = 64\ni = 0\n\nFor Each objOption In objIE.Document.GetElementsByTagName(\"table\")(0).GetElementsByTagName(\"td\")(tdNode).GetElementsByClassName(\"txt_input1\")(0).Options\n    Q(i) = objOption.Text &amp; \"-\" &amp; objOption.Value\n    QNm = QNm &amp; \"|\" &amp; Q(i)\n    i = i + 1\n    If objOption.Selected Then\n     strWQ = objOption.Text\n    End If\n\n    If i &gt; 53 Then\n       MsgBox \"stuck\"\n       SetEverythingToNothing\n    End If\n\nNext\n\nQNm = QNm &amp; \"|=\" &amp; strWQ\n\na = 1\nMyArray = Split(QNm, \"|\")\n\nFor a = LBound(MyArray) To UBound(MyArray)\n    If InStr(MyArray(a), UserName) Then\n        strWQ = MyArray(a)\n    End If\nNext\n\nSelQ = Mid(strWQ, InStr(strWQ, \"-\") + 1, Len(strWQ) - InStr(strWQ, \"-\"))\n\nFor Each objOption In objIE.Document.GetElementsByTagName(\"table\")(0).GetElementsByTagName(\"td\")(tdNode).GetElementsByClassName(\"txt_input1\")(0).Options\n    If objOption.Value = SelQ Then\n        objOption.Selected = True\n        objIE.Document.GetElementsByTagName(\"table\")(0).GetElementsByTagName(\"td\")(tdNode).GetElementsByClassName(\"txt_input1\")(0).OnChange\n    Else\n        objOption.Selected = False\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 2572769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/976a9e06f1b5a38d8f6babe334d63401?s=128&d=identicon&r=PG", "display_name": "Lou", "link": "https://stackoverflow.com/users/2572769/lou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5676, "favorite_count": 0, "accepted_answer_id": 45982371, "answer_count": 2, "score": 1, "last_activity_date": 1504185380, "creation_date": 1504104535, "last_edit_date": 1531164843, "question_id": 45963540, "link": "https://stackoverflow.com/questions/45963540/excel-vba-change-option-in-the-html-select-tag", "title": "Excel VBA change option in the HTML select tag", "body": "<p>Recently, I posted the question <a href=\"https://stackoverflow.com/questions/24308183/vbscript-capture-text-in-the-html-select-option-tag\">vbscript capture text in the HTML select option tag</a>. This helped me tremendously on an Internet Explorer platform. However, I have a new project with a bit more complex of a web site. The web site has multiple nested tables that are formatted to hold <code>form</code> elements. My team and I have figured out how to get and set data within most of the elements except the drop down box (<code>select</code> tag). We are able to get the text from the drop down, but we can't change the value. Instead, all the options are wiped clear and the whole drop down is blank.</p>\n\n<p>Here's a revised version of the code for the web site as there is much more code involved, but only the pertinent code is shown:</p>\n\n<pre><code>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n  &lt;head&gt;...&lt;/head&gt;\n  &lt;body&gt;\n    &lt;form id=\"form1\" action=\"AssignOFS.aspx\" method=\"post\"&gt;\n      &lt;div class=\"aspNetHidden\"&gt;...&lt;/div&gt;\n      &lt;div class=\"aspNetHidden\"&gt;...&lt;/div&gt;\n      &lt;table width=\"100%\" align=\"center\" cellspacing=\"0\"&gt;\n        &lt;tbody&gt;\n          &lt;tr&gt;\n            &lt;td&gt;\n              &lt;table width=\"100%\" align=\"center\" cellspacing=\"0\"&gt;...&lt;/table&gt;\n            &lt;/td&gt;\n          &lt;/tr&gt;\n          &lt;tr&gt;\n            &lt;td&gt;\n              &lt;table width=\"100%\" align=\"center\" cellspacing=\"0\"&gt;\n                &lt;tbody&gt;\n                  &lt;tr&gt;...&lt;/tr&gt;\n                  &lt;tr&gt;...&lt;/tr&gt;\n                  &lt;tr class=\"tr_data\"&gt;...&lt;/tr&gt;\n                  &lt;tr&gt;\n                    &lt;td align=\"center\"&gt;\n                      &lt;div id=\"pnlBtn1\"&gt;...&lt;/div&gt;\n                      &lt;div id=\"pnlView\"&gt;\n                        &lt;table width=\"100%\" align=\"center\" cellspacing=\"0\"&gt;\n                          &lt;tbody&gt;\n                            &lt;tr&gt;...&lt;/tr&gt;\n                            &lt;tr&gt;...&lt;/tr&gt;\n                            &lt;tr class=\"tr_data\"&gt;\n                              &lt;td align=\"center\"&gt;...&lt;/td&gt;\n                              &lt;td valign=\"top\"&gt;...&lt;/td&gt;\n                              &lt;td valign=\"top\"&gt;...&lt;/td&gt;\n                              &lt;td valign=\"top\"&gt;...&lt;/td&gt;\n                              &lt;td nowrap=\"\" valign=\"top\"&gt;...&lt;/td&gt;\n                              &lt;td align=\"left\"&gt;...&lt;/td&gt;\n                              &lt;td align=\"center\"&gt;...&lt;/td&gt;\n                              &lt;td align=\"center\"&gt;\n                                &lt;select name=\"user\" class=\"txt_input1\" id=\"user\" onchange=\"javascript:addUser(227);\"&gt;\n                                  &lt;option value=\"\"&gt;--Select User--&lt;/option&gt;\n                                  &lt;option value=\"0123\"&gt;Amy Jones (000456321)&lt;/option&gt;\n                                  &lt;option value=\"0432\"&gt;Brian Wyatt (000745632)&lt;/option&gt;\n                                  &lt;option value=\"0345\"&gt;Carl Lister (000874563)&lt;/option&gt;\n                                  &lt;option value=\"0654\"&gt;Daniel Michaels (000987456)&lt;/option&gt;\n                                  &lt;option value=\"0567\"&gt;Elizabeth Sweeny (001456321)&lt;/option&gt;\n                                  &lt;option value=\"0876\"&gt;Fran Tarris (001745632)&lt;/option&gt;\n                                  &lt;option value=\"0789\"&gt;Gail McMurphy (001874563)&lt;/option&gt;\n                                  &lt;option value=\"1098\"&gt;Hannah Barisce (001987456)&lt;/option&gt;\n                                &lt;/select&gt;\n                              &lt;/td&gt;\n                            &lt;/tr&gt;\n                          &lt;/tbody&gt;\n                        &lt;/table\n                      &lt;/div&gt;\n                    &lt;/td&gt;\n                  &lt;/tr&gt;\n                &lt;/tbody&gt;\n              &lt;/table&gt;\n            &lt;/td&gt;\n          &lt;/tr&gt;\n        &lt;/tbody&gt;\n      &lt;/table&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>To be able to get the text from the drop down, we used the <code>class</code> name <code>txt_input1</code> after locating the node within the table that holds the drop down. This code will give us the entire list within the drop down:</p>\n\n<p><code>objIE.Document.getElementsByTagName(\"table\")(0).getElementsByTagName(\"td\").Item(64).GetElementsByClassName(\"txt_input1\")(0).innerText</code></p>\n\n<p>I've tried changing the value of the <code>select</code> drop down from \"--Select User--\" to one of the names in the list with the following code:</p>\n\n<p><code>objIE.Document.getElementsByTagName(\"table\")(0).getElementsByTagName(\"td\").Item(64).GetElementsByClassName(\"txt_input1\")(0).innerText = \"Carl Lister\"</code></p>\n\n<p>This resulted in the blank drop down. If I changed the ending to <code>.Value</code>, it only removes \"--Select User--\" from being shown. It still doesn't change the value to \"Carl Lister\". Is there something we're missing when it comes to selecting an <code>option</code> in a <code>select</code> drop down within nested tables?</p>\n"}, {"tags": ["vba", "excel", "fso"], "comments": [{"owner": {"reputation": 106, "user_id": 8340269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H13Pt.jpg?s=128&g=1", "display_name": "Benjamin Goldwater", "link": "https://stackoverflow.com/users/8340269/benjamin-goldwater"}, "edited": false, "score": 0, "creation_date": 1504104009, "post_id": 45963000, "comment_id": 78885356, "body": "Have you tested to see if the sFile string evaluates to exactly the path/file name? you can use Application.FileDialog(msoFileDialogFolderPicker).SelectedIt&zwnj;&#8203;ems(1) to see if the string matches your string exactly"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 106, "user_id": 8340269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H13Pt.jpg?s=128&g=1", "display_name": "Benjamin Goldwater", "link": "https://stackoverflow.com/users/8340269/benjamin-goldwater"}, "edited": false, "score": 0, "creation_date": 1504104359, "post_id": 45963000, "comment_id": 78885601, "body": "Hi @BenjaminGoldwater yes it appears to match perfectly"}, {"owner": {"reputation": 106, "user_id": 8340269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H13Pt.jpg?s=128&g=1", "display_name": "Benjamin Goldwater", "link": "https://stackoverflow.com/users/8340269/benjamin-goldwater"}, "edited": false, "score": 0, "creation_date": 1504105112, "post_id": 45963000, "comment_id": 78886200, "body": "I am not able to recreate the error. When I run the first 11 lines, I am able to identify a file and find that it exists. You could try replacing.Text with .Value or .Value2. .Text gives you a string representing what is displayed on the screen for the cell, so you could get &quot;####&quot;."}, {"owner": {"reputation": 106, "user_id": 8340269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H13Pt.jpg?s=128&g=1", "display_name": "Benjamin Goldwater", "link": "https://stackoverflow.com/users/8340269/benjamin-goldwater"}, "edited": false, "score": 0, "creation_date": 1504105159, "post_id": 45963000, "comment_id": 78886246, "body": "see <a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\" title=\"what is the difference between text value and value2\">stackoverflow.com/questions/17359835/&hellip;</a>"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5576, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504105432, "creation_date": 1504103008, "last_edit_date": 1504105432, "question_id": 45963000, "link": "https://stackoverflow.com/questions/45963000/deleting-a-file-using-vba", "title": "Deleting a File using VBA", "body": "<p>I currently have a code to delete files in a userform. I enter a reference and this in term populates to a sheet and all the calculations are worked out.</p>\n\n<p>What I am trying to do is delete the old existing document and then save a new copy with the word \"CLOSED\" in the title. I feel this code should work but cannot see why it is not finding the specified file.</p>\n\n<pre><code>Sub CloseDoc()\n\nDim FSO\nDim sFile As String\n\nsFile = \"M:\\Documents\\\" &amp; Range(\"B3\").Text &amp; \" - \" &amp; Range(\"B14\").Text &amp; \".xlsx\"\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nIf FSO.FileExists(sFile) Then\n    FSO.DeleteFile sFile, True\n        MsgBox \"Deleted The File Successfully, Ready to update with CLOSED information\", vbInformation, \"Done!\"\n    Else\n        MsgBox \"Specified File Not Found\", vbInformation, \"Not Found!\"\nEnd If\n\n    Sheets(\"ITC\").Copy\n\n    Range(\"A1:B54\").Select\n        Application.CutCopyMode = False\n        Selection.Copy\n        ActiveWindow.SmallScroll Down:=-60\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        Range(\"A1\").Select\n'Save Document to Dir\n    ActiveWorkbook.SaveAs Filename:= _\n        \"M:\\Documents\\\" &amp; Range(\"B3\").Text &amp; \" - \" &amp; Range(\"B14\").Text &amp; \" - CLOSED\" &amp; \" .xlsx\", FileFormat _\n        :=xlOpenXMLWorkbook, CreateBackup:=False\n    ActiveWorkbook.Close\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1504102843, "post_id": 45962866, "comment_id": 78884408, "body": "You&#39;re looping through columns <code>&quot;MX&quot;, </code>&quot;MS&quot;` and <code>&quot;MW&quot;</code>... if your data it truly in columns <code>A</code>,<code>B</code> and <code>C</code> then you need to change those for starters..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1504103114, "post_id": 45962866, "comment_id": 78884642, "body": "I don&#39;t believe <code>If True Then</code> and <code>If False Then</code> in your first loop is the proper syntax, but you&#39;re close!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504103143, "post_id": 45962866, "comment_id": 78884684, "body": "What are you expecting <code>If True Then</code> and <code>If False Then</code> to do? Try putting a breakpoint (F9) before the first loop, and stepping through your code (F8)."}, {"owner": {"reputation": 21, "user_id": 8486169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a46e458ec23139b3c878760ad555cfc?s=128&d=identicon&r=PG&f=1", "display_name": "Speely", "link": "https://stackoverflow.com/users/8486169/speely"}, "edited": false, "score": 0, "creation_date": 1504103212, "post_id": 45962866, "comment_id": 78884733, "body": "My bad, this is for a big project so forgot to change the referenced columns, just changed it to make it easier to understand"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1504103294, "post_id": 45962866, "comment_id": 78884800, "body": "To clarify a couple of comments, <code>If True Then</code> will <i>always</i> be triggered, as the condition <code>If __CONDITION__ Then</code> is always satisfied. Similarly, <code>If False Then</code> will <i>never</i> be triggered. If you add comments to your code (lines starting with an apostrophe) it would be clearer what you expect each bit to do."}, {"owner": {"reputation": 21, "user_id": 8486169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a46e458ec23139b3c878760ad555cfc?s=128&d=identicon&r=PG&f=1", "display_name": "Speely", "link": "https://stackoverflow.com/users/8486169/speely"}, "edited": false, "score": 0, "creation_date": 1504103322, "post_id": 45962866, "comment_id": 78884821, "body": "If the Boolean function returns true comparing the two cells, i want the code to print set value in column &quot;C&quot; , and continue through - i think this might be where im going wrong..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504103328, "post_id": 45962866, "comment_id": 78884827, "body": "Hint: <code>If True Then</code> is a constant expression; anything after <code>Then</code> will unconditionally execute. <code>If False Then</code> is also a constant expression; anything after <code>Then</code> is semantically unreachable code. Multi-line <code>If...Then</code> syntax commands an <code>End If</code> token somewhere - that first block can&#39;t compile."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1504103477, "post_id": 45962866, "comment_id": 78884924, "body": "<code>Do While &lt;Condition&gt; Loop</code> will do at least 1 run, check the condition and if it&#39;s false it will exit. The test you have in your nested loop (<code>If True</code>, which doesn&#39;t do anything) is already executed before you do your if statement. N.b. is there any reason you don&#39;t just use <code>=COUNTIF()</code> but VBA instead?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1504103633, "post_id": 45963127, "comment_id": 78885053, "body": "&quot;Try this {code dump}&quot; answers don&#39;t teach anything. Also unqualified <code>Range</code> calls are implicitly referring to <code>ActiveSheet</code> (or implicitly, <code>Me.Range</code> if the code is in a worksheet&#39;s code-behind module), which may or may not be in <code>ThisWorkbook</code>, and may or may not be <code>sht</code>."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1504103847, "post_id": 45963127, "comment_id": 78885230, "body": "@Mat&#39;sMug I edited and added more explicit references. I felt that OP had a good enough grasp on the concept to understand what I was writing, as he had 2 attempts that were &quot;close&quot; but flawed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504103929, "post_id": 45963127, "comment_id": 78885288, "body": "When I see <code>If True Then ...</code> and then <code>If False Then...</code>, I assume OP doesn&#39;t have a grasp on the basic-basics ;-) thanks for editing, upvoted."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504103960, "post_id": 45963127, "comment_id": 78885315, "body": "@Mat&#39;sMug That&#39;s true :S (no pun intended)."}, {"owner": {"reputation": 21, "user_id": 8486169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a46e458ec23139b3c878760ad555cfc?s=128&d=identicon&r=PG&f=1", "display_name": "Speely", "link": "https://stackoverflow.com/users/8486169/speely"}, "edited": false, "score": 0, "creation_date": 1504104042, "post_id": 45963127, "comment_id": 78885378, "body": "Thanks fellas, yeah im defs still a rook trying things out of his league ahah"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1504104125, "last_edit_date": 1504104125, "creation_date": 1504103366, "answer_id": 45963127, "question_id": 45962866, "link": "https://stackoverflow.com/questions/45962866/vba-nested-do-while-loop-vs-nested-do-while-if-loop/45963127#45963127", "title": "VBA Nested Do While Loop vs. Nested Do While If Loop", "body": "<p>Try this instead:</p>\n\n<pre><code>Option Explicit\nSub test()\nDim sht As Worksheet\nDim lastrow As Long, i as integer, j as integer, initial as integer\nSet sht = Workbooks(\"Book1\").Worksheets(\"Sheet1\") 'Don't forget to change this\nlastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 1 To lastrow\n    initial = 1\n    lastrow = sht.Cells(sht.Rows.Count, \"B\").End(xlUp).Row\n    For j = 1 To lastrow\n        If Workbooks(\"Book1\").Worksheets(\"Sheet1\").Range(\"A\" &amp; i).Value = Workbooks(\"Book1\").Worksheets(\"Sheet1\").Range(\"B\" &amp; j).Value Then\n            Workbooks(\"Book1\").Worksheets(\"Sheet1\").Range(\"C\" &amp; j).Value = initial\n            initial = initial + 1\n        End If\n    Next j\nNext i\nEnd Sub\n</code></pre>\n\n<p>I prefer using <code>For</code> loops as opposed to <code>While</code>s, just because I can see the ranges being looped through more easily. Here we use nested <code>For</code> loops, the first to loop through column A, the second to loop through column B. <code>If</code> our value in column A equals our value in column B, we place the initial number in column C using our variable from the nested loop.</p>\n\n<p>Notice how to make this work, we re-initialize our <code>lastrow</code> variable to make the ranges for our loops.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tS8ma.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tS8ma.png\" alt=\"BeforeAfter\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 1, "creation_date": 1504104014, "post_id": 45963320, "comment_id": 78885362, "body": "Equally you could add this method directly as worksheet functions, removing the need for VBA"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1504103943, "creation_date": 1504103943, "answer_id": 45963320, "question_id": 45962866, "link": "https://stackoverflow.com/questions/45962866/vba-nested-do-while-loop-vs-nested-do-while-if-loop/45963320#45963320", "title": "VBA Nested Do While Loop vs. Nested Do While If Loop", "body": "<p>It is useful to use countif.</p>\n\n<pre><code>Sub test()\n    Dim rngOrg As Range, rngDB As Range\n    Dim Wf As WorksheetFunction\n    Dim vR() As Variant\n    Dim i As Long, n As Long\n\n    Set Wf = WorksheetFunction\n\n    Set rngOrg = Range(\"a1\", Range(\"a\" &amp; Rows.Count).End(xlUp))\n    Set rngDB = Range(\"b1\", Range(\"b\" &amp; Rows.Count).End(xlUp))\n    n = rngDB.Rows.Count\n    ReDim vR(1 To n, 1 To 1)\n    For Each Rng In rngDB\n        i = i + 1\n        If Wf.CountIf(rngOrg, Rng) Then\n            vR(i, 1) = Wf.CountIf(Range(\"b1\", Rng), Rng)\n        End If\n    Next Rng\n    Range(\"c1\").Resize(n) = vR\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 0, "last_activity_date": 1504104265, "creation_date": 1504104265, "answer_id": 45963438, "question_id": 45962866, "link": "https://stackoverflow.com/questions/45962866/vba-nested-do-while-loop-vs-nested-do-while-if-loop/45963438#45963438", "title": "VBA Nested Do While Loop vs. Nested Do While If Loop", "body": "<p>Here is another method, this time using <code>Find</code>. This is <em>probably</em> quicker than the looping method since it leverages the in-built find function to skip to the next match. </p>\n\n<p>I've commented the code below for clarity, but basically we loop through values in column <code>A</code> (using a <code>For</code> loop because they're less prone to disguised infinite looping than <code>While</code>) and look for them in column <code>B</code>.</p>\n\n<p><strong>Note</strong>: This looks a bit longer, but that's mainly because (a) I've added lots of comments and (b) I've used a <code>With</code> statement to ensure the ranges are <em>fully qualified</em>. </p>\n\n<pre><code>Sub countdb()\n    Dim c As Range, fnd As Range, listrng As Range, cnt As Long, addr As String\n    ' Use with so that our ranges are fully qualified\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        ' Define the range to look up in (column B in this case)\n        Set listrng = .Range(\"B1\", .Range(\"B1\").End(xlDown))\n        ' Loop over values in the index range (column\n        For Each c In .Range(\"A1\", .Range(\"A1\").End(xlDown))\n            cnt = 0\n            ' Try and find the c value\n            Set fnd = listrng.Find(what:=c.Value, lookat:=xlWhole, LookIn:=xlValues, after:=listrng.Cells(listrng.Cells.Count))\n            If Not fnd Is Nothing Then\n                ' Store the address of the first find so we can stop when we find it again!\n                addr = fnd.Address\n                ' Loop over all other matches in the range. By using a \"Do ... Loop While\"\n                ' style loop, we ensure that the loop is run at least once!\n                Do\n                    ' Increase count and assign value to next column\n                    cnt = cnt + 1\n                    fnd.Offset(0, 1).Value = cnt\n                    ' Find next match after current\n                    Set fnd = listrng.Find(what:=c.Value, lookat:=xlWhole, LookIn:=xlValues, after:=fnd)\n                Loop While fnd.Address &lt;&gt; addr\n            End If\n        Next c\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1504104321, "creation_date": 1504104321, "answer_id": 45963455, "question_id": 45962866, "link": "https://stackoverflow.com/questions/45962866/vba-nested-do-while-loop-vs-nested-do-while-if-loop/45963455#45963455", "title": "VBA Nested Do While Loop vs. Nested Do While If Loop", "body": "<p>The trick is in making the declarations transparent. After that the programming is very easy.</p>\n\n<pre><code>Sub CountMatches()\n\n    Dim Rng As Range                    ' \"count\" range (= column \"B\")\n    Dim Itm As String                   ' item from the \"items' column (= \"A\")\n    Dim Rla As Long, Rlb As Long        ' last row in columns A and B\n    Dim Ra As Long, Rb As Long          ' row counters\n    Dim Counter As Long                 ' count matches\n\n    With ActiveSheet\n        ' look for the last used rows\n        Rla = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Rlb = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        ' start looking for matches from row 2\n        Set Rng = .Range(.Cells(2, \"B\"), .Cells(Rlb, \"B\"))\n\n        ' start looping in row 2\n        For Ra = 2 To Rla\n            Itm = .Cells(Ra, \"A\").Value\n            If Len(Trim(Itm)) Then      ' skip if blank\n                ' start comparing from row 2\n                For Rb = 2 To Rlb\n                    ' compare not case sensitive\n                    If StrComp(.Cells(Rb, \"B\").Value, Itm, vbTextCompare) = 0 Then\n                        Counter = Counter + 1\n                    End If\n                Next Rb\n                .Cells(Ra, \"C\").Value = Counter\n                Counter = 0\n            End If\n        Next Ra\n    End With\nEnd Sub\n</code></pre>\n\n<p>Now the question is whether the transparency that workred for me appears transparent to you. I hope it does. :-)</p>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1504104744, "creation_date": 1504104744, "answer_id": 45963621, "question_id": 45962866, "link": "https://stackoverflow.com/questions/45962866/vba-nested-do-while-loop-vs-nested-do-while-if-loop/45963621#45963621", "title": "VBA Nested Do While Loop vs. Nested Do While If Loop", "body": "<p>This should be significantly faster.</p>\n\n<pre><code>Sub CountMatches_2()\n\n    Dim Rng As Range                    ' \"count\" range (= column \"B\")\n    Dim Itm As String                   ' item from the \"items' column (= \"A\")\n    Dim Rla As Long, Rlb As Long        ' last row in columns A and B\n    Dim Ra As Long, Rb As Long          ' row counters\n\n    With ActiveSheet\n        ' look for the last used rows\n        Rla = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Rlb = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        ' start looking for matches from row 2\n        Set Rng = .Range(.Cells(2, \"B\"), .Cells(Rlb, \"B\"))\n\n        ' start looping in row 2\n        For Ra = 2 To Rla\n            Itm = .Cells(Ra, \"A\").Value\n            If Len(Trim(Itm)) Then      ' skip if blank\n                .Cells(Ra, \"C\").Value = Application.CountIf(Rng, Itm)\n            End If\n        Next Ra\n    End With\nEnd Sub\n</code></pre>\n\n<p>This code presumes that each item in column A is unique. If it is not duplicates will be created which, however, it would be easy to eliminate either before or after they are created.</p>\n"}], "owner": {"reputation": 21, "user_id": 8486169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a46e458ec23139b3c878760ad555cfc?s=128&d=identicon&r=PG&f=1", "display_name": "Speely", "link": "https://stackoverflow.com/users/8486169/speely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1834, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1504104744, "creation_date": 1504102612, "last_edit_date": 1531164843, "question_id": 45962866, "link": "https://stackoverflow.com/questions/45962866/vba-nested-do-while-loop-vs-nested-do-while-if-loop", "title": "VBA Nested Do While Loop vs. Nested Do While If Loop", "body": "<p>I'm not sure where I'm going wrong. I'm trying to compare values within a column (\"B\") to a cell referenced to (\"A1\"). If the values in Column \"B\" equal \"A1\" I want it to count up. When it gets to the end of Column \"B\" I'm trying to get it to loop back and compare values in column \"B\" with \"A2\", etc. For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/B16ww.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B16ww.png\" alt=\"enter image description here\"></a></p>\n\n<p>So Far I've written two different codes one with a nested do while loop and a nested do while if loop but i cant get them to loop through the whole column</p>\n\n<pre><code>Sub CountDb()\nDim i As Long\nDim iRow As Long\nDim initial As Long\n\ni = 1\niRow = 1\ninitial = 1\n\nDo While Cells(iRow, \"A\").Value &lt;&gt; \"\" 'initial loop, whilst there are values in cell \"A\" continue the loop \n    Do While Cells(i, \"B\").Value = Cells(iRow, \"A\").Value 'nested while loop, comparing the first B1 and cell A1.\n        If True Then Cells(i, \"C\") = initial 'if they A1 and B1 are equal, print 1 in column C\n        initial = initial + 1 'and move on comparing A1 with B2\n        If False Then\n            i = i + 1 'if not satisfied, move on to cell B2 etc. \n    Loop\niRow = iRow + 1 'when you get to the end of column B, start again and compare values with A2 and B\nLoop\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub CountDb()\nDim i As Long\nDim iRow As Long\nDim initial As Long\n'same comments as above, just different methodology\ni = 1\niRow = 1\ninitial = 1\n\nDo While Cells(iRow, \"A\").Value &lt;&gt; \"\"\n    If Cells(i, \"B\").Value = Cells(iRow, \"A\").Value Then\n        Cells(i, \"C\") = initial\n    Else\n\n    initial = initial + 1\n    i = i + 1\n\n    End If\n\n    iRow = iRow + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated. Thanks!</p>\n\n<p>*EDIT - fixed up column references \n**EDIT - applied comments to code </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1504104345, "post_id": 45962927, "comment_id": 78885593, "body": "Hey, that work well! Thanks! Can you plese tell me how can I use more than two values?"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1504104432, "post_id": 45962927, "comment_id": 78885642, "body": "I want to add to options &quot;Upg&quot; &quot;UPGRADE&quot; and &quot;Upgrade&quot; too."}, {"owner": {"reputation": 884, "user_id": 500099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d9e5814f18287bbd32374a417600b67?s=128&d=identicon&r=PG", "display_name": "user500099", "link": "https://stackoverflow.com/users/500099/user500099"}, "edited": false, "score": 1, "creation_date": 1504104871, "post_id": 45962927, "comment_id": 78885990, "body": "No need to check for Upgrade if you&#39;re already checking for Upg, to check any case combinations you can make it uppercase UCase() first check for      Instr(UCase(MFG_wb.Sheets(&quot;Aleris&quot;).Cells(i, 2).Value),&quot;UPG&quot;)&gt;0 or  UCase(MFG_wb.Sheets(&quot;Aleris&quot;).Cells(i, 2).Value) like &quot;UPG&quot;"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1504102757, "creation_date": 1504102757, "answer_id": 45962927, "question_id": 45962855, "link": "https://stackoverflow.com/questions/45962855/excel-vba-delete-rows-based-on-cell-value-containing-part-of-a-text/45962927#45962927", "title": "Excel VBA Delete Rows Based on Cell Value containing Part of a Text", "body": "<p>Use INSTR():</p>\n\n<pre><code>For i = Dep To 2 Step -1\n     If Instr(MFG_wb.Sheets(\"Aleris\").Cells(i, 2).Value,\"upg\")&gt;0 Or Instr(MFG_wb.Sheets(\"Aleris\").Cells(i, 2).Value,\"upgrade\") &gt;0 Then\n        MFG_wb.Sheets(\"Aleris\").Rows(i).Delete\n     End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 0, "accepted_answer_id": 45962927, "answer_count": 1, "score": 3, "last_activity_date": 1504102757, "creation_date": 1504102577, "question_id": 45962855, "link": "https://stackoverflow.com/questions/45962855/excel-vba-delete-rows-based-on-cell-value-containing-part-of-a-text", "title": "Excel VBA Delete Rows Based on Cell Value containing Part of a Text", "body": "<p>I want to delete rows based on cell value that contains the words \"upg\" or \"upgrade\" inside the cell. when this word are there, it is not the only words inside the cell. </p>\n\n<p>Here is part of my code, that not deletes anything:</p>\n\n<pre><code>Sub DeleteValues()\n\n\nDim i As Integer\nDim MFG_wb As Workbook\nDim Dep As Integer\n\n\n\nSet MFG_wb = Workbooks.Open _\n(\"C:\\Users\\rosipov\\Desktop\\eliran\\MFG - GSS\\MFG Daily\\Fast Daily \" &amp; Format(Now(), \"ddmmyy\") &amp; \".xlsx\", _\nUpdateLinks:=False, IgnoreReadOnlyRecommended:=True)\nMFG_wb.Sheets(\"Aleris\").Activate\n\nDep = MFG_wb.Sheets(\"Aleris\").Range(\"B2\").End(xlDown).Row\n\n\nFor i = Dep To 2 Step -1\n    Cells(i, 2).Select\n    If Not (Selection.Value = \"&amp; upg &amp;\" Or Selection.Value = \"*&amp; upgrade &amp;*\") Then\n        Rows(i).Delete\n    End If\nNext i\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Here is the problem:</p>\n\n<pre><code>For i = Dep To 2 Step -1\n    Cells(i, 2).Select\n    If Not (Selection.Value = \"&amp; upg &amp;\" Or Selection.Value = \"*&amp; upgrade &amp;*\") Then\n        Rows(i).Delete\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1504102546, "post_id": 45962781, "comment_id": 78884201, "body": "Look into LEFT() and INSTR() to find the first word."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1504105518, "creation_date": 1504105518, "answer_id": 45963897, "question_id": 45962781, "link": "https://stackoverflow.com/questions/45962781/how-to-add-new-column-to-existing-sheet-with-part-of-the-first-column/45963897#45963897", "title": "How to add new column to existing sheet with part of the first column", "body": "<p>Create this function in a module:</p>\n\n<pre><code>Public Function GetFirstWord(sFull As String) As String\n  GetFirstWord = Split(sFull, \" \")(0)\nEnd Function\n</code></pre>\n\n<p>Then you can use it in your cell formula like this:</p>\n\n<pre><code>=GetFirstWord(B1)\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 7884509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa1200bb39af68ba9962848bcb0afafa?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/7884509/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504105518, "creation_date": 1504102335, "last_edit_date": 1504102453, "question_id": 45962781, "link": "https://stackoverflow.com/questions/45962781/how-to-add-new-column-to-existing-sheet-with-part-of-the-first-column", "title": "How to add new column to existing sheet with part of the first column", "body": "<p>How add new column to the existing sheet with part of the firs column VBA</p>\n\n<p>Suppose i have below data:</p>\n\n<pre><code>Test 12212\nTest 6588476\nSomething 4125\nWhat is this 1254\n</code></pre>\n\n<p>And i want to do this:</p>\n\n<pre><code>Column1      Column2\nTest         Test 12212\nTest         Test 6588476\nSomething    Something 4125\nWhat         What is this 1254\n</code></pre>\n\n<p>Any help appreciated.</p>\n\n<p>Regards,</p>\n\n<p>Simon</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1504116905, "post_id": 45965634, "comment_id": 78893421, "body": "Good catch, avb.  I removed that chunk of code and re-ran.  It&#39;s bit faster, but not by twice as fast.  Although, your advice certainly helped cut down the time taken.  The entire code is looping through three pivots on three different worksheets.  Each pivot contains approx. 368 pivot items."}, {"owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "edited": false, "score": 0, "creation_date": 1504117560, "post_id": 45965634, "comment_id": 78893772, "body": "Just wondering if there is another way to uncheck these wildcard items without looping?"}], "tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 1, "last_activity_date": 1504110964, "creation_date": 1504110964, "answer_id": 45965634, "question_id": 45962692, "link": "https://stackoverflow.com/questions/45962692/increase-speed-of-deselect-pivotitems-from-pivot-table-using-wildcard/45965634#45965634", "title": "Increase speed of deselect pivotItems from Pivot table using Wildcard*", "body": "<p>this loop:</p>\n\n<pre><code>For Each myPI In .PivotItems\nmyPI.Visible = True\nNext myPI\n</code></pre>\n\n<p>is unnecessary, you iterate through every items twice, once making them all visible and then visible or not based on <code>Like</code> condition. Assuming the reason your macro is slow is iterating through huge amount of <code>PivotItems</code> deleting this loop wil make it twice faster.</p>\n"}], "owner": {"reputation": 251, "user_id": 6451218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a0578b1c77c327c900a26f0f02328fc?s=128&d=identicon&r=PG&f=1", "display_name": "XLmatters", "link": "https://stackoverflow.com/users/6451218/xlmatters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504110964, "creation_date": 1504102101, "last_edit_date": 1531164843, "question_id": 45962692, "link": "https://stackoverflow.com/questions/45962692/increase-speed-of-deselect-pivotitems-from-pivot-table-using-wildcard", "title": "Increase speed of deselect pivotItems from Pivot table using Wildcard*", "body": "<p>the following code deselects PivotItems that start with \"xyznames\" using a wildcard \"*.\"  It works, however, it is extremely slow.  Any ideas as to do the same thing, but faster?</p>\n\n<pre><code>Sub UncheckxyzName()\n'Purpose: Uncheck \"xyzname* from Pivot tables from \"Comparison\" tab\n\n Dim pt As PivotTable\n Dim myPI As PivotItem\n\n'stop Excel actions for speed enhancement\nWith Excel.Application\n   .ScreenUpdating = False\n   .EnableEvents = False\n   .Calculation = Excel.xlCalculationManual\n   .DisplayStatusBar = False\nEnd With\n\n'uncheck \"xyzname*\" from \"Comparison\" tab\nWith Worksheets(\"Comparison\").PivotTables(\"PivotTable1\").PivotFields(\"Type\")\n    .PivotItems(\"fnBid\").Visible = False\nEnd With\n\n With Worksheets(\"Comparison\").PivotTables(\"PivotTable1\").PivotFields(\"Resource Name\")\n\n For Each myPI In .PivotItems\n myPI.Visible = True\n Next myPI\n\n For Each myPI In .PivotItems\n    If myPI.name Like \"xyzname*\" Then\n        myPI.Visible = False\n    Else\n        myPI.Visible = True\n    End If\n    Next myPI\n End With\n\n'Turn back on Excel actions \nWith Excel.Application\n    .DisplayStatusBar = True\n    .Calculation = Excel.xlCalculationAutomatic\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Related to post: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/30808958/excel-macro-vba-filtering-using-wildcards\">excel macro vba Filtering using wildcards</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 8533306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f0154e3bf9010cc8d4d3807516bf44?s=128&d=identicon&r=PG&f=1", "display_name": "Xire", "link": "https://stackoverflow.com/users/8533306/xire"}, "is_accepted": false, "score": 0, "last_activity_date": 1504101561, "creation_date": 1504101561, "answer_id": 45962491, "question_id": 45962396, "link": "https://stackoverflow.com/questions/45962396/exclude-images-with-specific-name/45962491#45962491", "title": "Exclude images with specific name", "body": "<p>Use InStr to search in the filename your pattern \"-TH\" </p>\n\n<pre><code>Dim pos As Integer\n\npos = InStr(\"find the comma, in the string\", \",\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 5623953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65c2872adcaf59aca033e880262750c8?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/5623953/monika"}, "edited": false, "score": 0, "creation_date": 1504192521, "post_id": 45962567, "comment_id": 78929518, "body": "I tried the code, but it seems it doesn&#39;t look for the next image with that name, and exists, because  when I added this code it doesn&#39;t pull any image."}, {"owner": {"reputation": 1344, "user_id": 8521346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5adedecc5904449d9b448df60d69f5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bigbob556677", "link": "https://stackoverflow.com/users/8521346/bigbob556677"}, "reply_to_user": {"reputation": 61, "user_id": 5623953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65c2872adcaf59aca033e880262750c8?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/5623953/monika"}, "edited": false, "score": 0, "creation_date": 1504195943, "post_id": 45962567, "comment_id": 78931780, "body": "Did you put it around each of your &quot;Call Insert_Picutre&quot; lines? @Monika"}, {"owner": {"reputation": 61, "user_id": 5623953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65c2872adcaf59aca033e880262750c8?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/5623953/monika"}, "edited": false, "score": 0, "creation_date": 1504196767, "post_id": 45962567, "comment_id": 78932239, "body": "I just put it around this line   Call Insert_Picture(myPath + My_File, Ac_cell.Offset(0, 1))"}, {"owner": {"reputation": 1344, "user_id": 8521346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5adedecc5904449d9b448df60d69f5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bigbob556677", "link": "https://stackoverflow.com/users/8521346/bigbob556677"}, "reply_to_user": {"reputation": 61, "user_id": 5623953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65c2872adcaf59aca033e880262750c8?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/5623953/monika"}, "edited": false, "score": 0, "creation_date": 1504197141, "post_id": 45962567, "comment_id": 78932430, "body": "I included the code in my project and it pulls in a picture by that name just fine. check and see if your code is even able to find the picture youre looking for."}, {"owner": {"reputation": 61, "user_id": 5623953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65c2872adcaf59aca033e880262750c8?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/5623953/monika"}, "edited": false, "score": 0, "creation_date": 1504199224, "post_id": 45962567, "comment_id": 78933507, "body": "Thank you very much for your help. I&#39;ll go through the code again."}], "tags": [], "owner": {"reputation": 1344, "user_id": 8521346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5adedecc5904449d9b448df60d69f5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Bigbob556677", "link": "https://stackoverflow.com/users/8521346/bigbob556677"}, "is_accepted": true, "score": 2, "last_activity_date": 1504101990, "last_edit_date": 1504101990, "creation_date": 1504101769, "answer_id": 45962567, "question_id": 45962396, "link": "https://stackoverflow.com/questions/45962396/exclude-images-with-specific-name/45962567#45962567", "title": "Exclude images with specific name", "body": "<p>Put the EndsWith function in your code. (I included a starts with if it helps down the road) and use it like this:</p>\n\n<pre><code>            If My_File &gt; \" \" Then\n                If EndsWith(My_File,\"-TH\") Then\n                else\n                    Call Insert_Picture(myPath + My_File, Ac_cell.Offset(0, 1))\n                End If\n            End If\n</code></pre>\n\n<hr>\n\n<pre><code> Public Function EndsWith(str As String, ending As String) As Boolean\n Dim endingLen As Integer\n endingLen = Len(ending)\n EndsWith = (Right(Trim(UCase(str)), endingLen) = UCase(ending))\nEnd Function\n\nPublic Function StartsWith(str As String, start As String) As Boolean\n Dim startLen As Integer\n startLen = Len(start)\n StartsWith = (Left(Trim(UCase(str)), startLen) = UCase(start))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5623953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/65c2872adcaf59aca033e880262750c8?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/5623953/monika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 45962567, "answer_count": 2, "score": 0, "last_activity_date": 1504108102, "creation_date": 1504101286, "last_edit_date": 1504108102, "question_id": 45962396, "link": "https://stackoverflow.com/questions/45962396/exclude-images-with-specific-name", "title": "Exclude images with specific name", "body": "<p>I have a VBA code that pulls images and inserts in Excel file based on cell value in column A. But in my P drive, from where it pulls images, I have images that end with ' -TH ' and I want to exclude them. i.e. I have image in P drive, that named as \"CITY-B\" and the other one as \"CITY-B-TH\". And when I type 'CITY'(this is how I need the name to be typed in excel), I want it to insert the one without \"TH\". How can i do that?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n     If (Split(Target.Address, \"$\")(1) &lt;&gt; \"A\") Then Exit Sub\n    Call Inser_Image(Target)\nEnd Sub\n\nPrivate Sub Inser_Image(Ac_Cells As Range)\n    Dim myRng As Range\n    Dim Mycell As Range\n    Dim St As String\n    Dim myPath As String\n    Dim My_Pic As Shape\n    Dim My_File As String\n    Dim Ac_cell As Range\n\n\n    myPath = Sheet1.Cells(1, 5).Value\n\n    If Len(myPath) &gt; 3 Then\n        If Right(myPath, 1) &lt;&gt; \"\\\" Then\n            myPath = myPath + \"\\\"\n        End If\n    End If\n\n    For Each Ac_cell In Ac_Cells\n\n        For Each My_Pic In Sheet1.Shapes\n            If My_Pic.Left = Ac_cell.Offset(0, 1).Left And My_Pic.Top = Ac_cell.Offset(0, 1).Top Then\n                My_Pic.Delete\n                Exit For\n            End If\n        Next\n\n\n        St = Trim(Ac_cell.Value)\n\n        If Len(St) &gt; 4 Then\n            If LCase(Left(St, 4)) = \"http\" Then\n                Call Insert_Picture(St, Ac_cell.Offset(0, 1))\n                GoTo Nextse1\n            End If\n        End If\n            myPath = \"P:\\\"\n            If Right(myPath, 1) &lt;&gt; \"\\\" Then myPath = myPath + \"\\\"\n\n                If Not (Dir(myPath + St)) = \"\" Then\n                    My_File = St\n                Else\n                    My_File = Find_File(myPath, St)\n                End If\n\n\n                If My_File &gt; \" \" Then\n                    Call Insert_Picture(myPath + My_File, Ac_cell.Offset(0, 1))\n\n                End If\n\n    Application.ScreenUpdating = True\nNextse1:\n    Next\nEnd Sub\n\n\n\nSub Insert_Picture(thePath As String, theRange As Range)\n\n    On Error GoTo Err3\n    Dim myPict As Shape\n\n     Sheet1.Shapes.AddPicture thePath, True, True, theRange.Left, theRange.Top, theRange.Width, theRange.Height\n\n     Set myPict = Sheet1.Shapes(Sheet1.Shapes.Count)\n    With myPict\n            .LockAspectRatio = msoFalse\n            .Placement = xlMoveAndSize\n    End With\n\n    Set myPict = Nothing\n    Exit Sub\nErr3:\n    MsgBox Err.Description\nEnd Sub\n\n\n\nFunction Find_File(thePath As String, F_N As String) As String\n\n    file = Dir(thePath)\n    Do Until file = \"\"\n        If Len(file) &lt; Len(F_N) Then GoTo EXT_N1\n        If LCase(Left(file, Len(F_N))) = LCase(F_N) Then\n            Find_File = file\n            Exit Function\n        End If\nEXT_N1:\n      file = Dir()\n    Loop\n    Find_File = \"\"\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504101400, "post_id": 45962269, "comment_id": 78883304, "body": "Can you show your sheet&#39;s data?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1504101471, "post_id": 45962269, "comment_id": 78883368, "body": "&quot;Using VBA&quot;... What code do you have so far and where are you stuck?"}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "edited": false, "score": 0, "creation_date": 1504102699, "post_id": 45962763, "comment_id": 78884312, "body": "Setting the category type, major unit to 7, and axis between categories did exactly what I needed. Earlier in the code I set the MinimumScale and MaximumScale so I am all set for when the axis begins. Thank you!"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 3, "last_activity_date": 1504102286, "creation_date": 1504102286, "answer_id": 45962763, "question_id": 45962269, "link": "https://stackoverflow.com/questions/45962269/how-do-you-make-ticklabels-for-chart-start-with-the-monday-of-each-week/45962763#45962763", "title": "How do you make ticklabels for chart start with the Monday of each week?", "body": "<p>The trick is to set the Category axis to timescale, determine a Monday for the starting value and just add the ticks at every seventh day.</p>\n\n<pre><code>Sub Test()\nDim cht As Chart\nDim ax As Axis\n\nSet cht = Worksheets(1).ChartObjects(1).Chart\nSet ax = cht.Axes(xlCategory)\n\nWith ax\n    .CategoryType = xlTimeScale 'For dates\n    .MajorUnit = 7 'Only 1 tick every 7 days\n    .AxisBetweenCategories = False 'Tick exactly on the date, not between the values.\n    .CrossesAt = 42975 'the integer value of the date you wish to be the first one. In this case 2017-08-28.\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 45962763, "answer_count": 1, "score": 2, "last_activity_date": 1504102299, "creation_date": 1504100959, "last_edit_date": 1531164843, "question_id": 45962269, "link": "https://stackoverflow.com/questions/45962269/how-do-you-make-ticklabels-for-chart-start-with-the-monday-of-each-week", "title": "How do you make ticklabels for chart start with the Monday of each week?", "body": "<p>I am trying to show a trend over time based on progress each week with an excel chart. Using VBA, how do I force the tick labels for the xlCategory axis to snap to each Monday in my data set? Is this possible? I know how to format the axes, but don't know how to tell it to begin with each Monday. Thanks!</p>\n\n<p>I am aware there is an option to change the majorunit and minorunit, maybe I can use those somehow? This is what I have so far:</p>\n\n<pre><code>On Error Resume Next\nActiveSheet.ChartObjects.Delete\nOn Error GoTo 0\n\nSet metricschart = sht.Shapes.AddChart.Chart\n\nWith metricschart\n    .Parent.Name = \"metricschart\"\n    .HasTitle = True\n    .ChartTitle.Text = \"Business Requirements Tested Over Time\"\n    .ChartTitle.Characters.Font.Size = 14\n    .ChartType = xlXYScatterSmoothNoMarkers\n    .SetSourceData Source:=sht2.Range(\"A1:DA2\")\n    .Location where:=xlLocationAsObject, Name:=sht.Name\n    .Parent.Height = 325\n    .Parent.Width = 600\n    .Parent.Top = 70\n    .Parent.Left = 350\n    .Legend.LegendEntries(1).Delete\n    .Axes(xlCategory).MinimumScale = sht2.Range(\"A1\")\n    .Axes(xlCategory).MaximumScale = sht2.Range(\"DA1\")\n    .Axes(xlCategory).TickLabels.NumberFormat = \"m/d\"\n    .Axes(xlCategory).MajorUnit = vbMonday 'this doesn't work, shows way too many days\nEnd With\n</code></pre>\n\n<p>The code above makes the axis like this (every 2 days):\n<a href=\"https://i.stack.imgur.com/bBve7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bBve7.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is what my data looks like: \n<a href=\"https://i.stack.imgur.com/cS3qc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cS3qc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1504103227, "post_id": 45961963, "comment_id": 78884745, "body": "is there an Application.ScreenUpdating = False in getStateNames?"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1504103544, "post_id": 45961963, "comment_id": 78884989, "body": "@Moosli No there&#39;s not"}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1504103810, "post_id": 45961963, "comment_id": 78885198, "body": "Ok, lets go to a Caht. You can see it at the Comments in my Answer."}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1504101104, "post_id": 45962295, "comment_id": 78883046, "body": "Doesn&#39;t help. Screen updatin is <b>already</b> true when the sub starts. Commenting the second sub <b>helps</b>, because it obviously executes earlier than needed."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1504101273, "post_id": 45962295, "comment_id": 78883201, "body": "How much code is in editSub? Becuase if there are only a few lines, it can be that the UpdateEvent is to slow and it will be turnd off before Updating the Screen"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1504101388, "post_id": 45962295, "comment_id": 78883292, "body": "Quite a few lines. It takes some data, checks it, adds to array and only then edits the cells with values from array."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1504101906, "post_id": 45962295, "comment_id": 78883682, "body": "@Ans Ok, i addited my Awnser"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1504102460, "post_id": 45962295, "comment_id": 78884133, "body": "Unfortunatelly neither helps..... Waiting just results in longer execution time, while the cells are still empty, the <code>DoEvents</code> doesn&#39;t affect anything."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1504103733, "post_id": 45962295, "comment_id": 78885134, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/153264/discussion-between-moosli-and-ans\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 2, "last_activity_date": 1504103707, "last_edit_date": 1504103707, "creation_date": 1504101020, "answer_id": 45962295, "question_id": 45961963, "link": "https://stackoverflow.com/questions/45961963/excel-vba-why-doesnt-the-screen-update-update-cells-right-before-turning-off/45962295#45962295", "title": "Excel vba: Why doesn&#39;t the screen update, update cells right before turning off screen updating", "body": "<p>I really don't get why this is not working. \nBut you could try to call the SetupApp with a If Statement. For that you have to cahnge the editSub to a Function and at the end just return a true Value. Something like this:</p>\n\n<pre><code>Sub mainSub()\n        If editSub = True Then Call setupApp\nEnd Sub\n\nSub setupApp()\n        Application.ScreenUpdating = False\n        Application.DisplayAlerts = False\nEnd Sub\n\nFunction editSub() As Boolean\n'Code stuff in her\neditSub = True\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Second Solution</strong></p>\n\n<p>You can try to Force the Events with <code>DoEvents</code> to update the Screen.</p>\n\n<p>Like this:</p>\n\n<pre><code>Call editSub \nDoEvents\nCall setupApp \n</code></pre>\n\n<p>Or you Put the DoEvents right after you have written in the Cells.</p>\n\n<hr>\n\n<p>If this don't work, you could try the Wait Method:</p>\n\n<pre><code>Application.Wait \"00:00:01\"  \n</code></pre>\n\n<hr>\n\n<hr>\n\n<p><strong>First Solution</strong></p>\n\n<p>Have you tryed to turn the ScreenUpdating on Before Execut the Sub?</p>\n\n<pre><code>Sub mainSub()\n            Call setupApp(true)\n            Call editSub 'edit cell's value: .Cells(i, j).Value=...\n            Call setupApp (false)'turns off scren updating, when uncommented prevents the previous sub from getting visible results\n            ...\n    End Sub\n\n    Sub setupApp(bol as Boolean)\n            Application.ScreenUpdating = bol \n            Application.DisplayAlerts = bol \n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1815, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1504103707, "creation_date": 1504100164, "last_edit_date": 1504102937, "question_id": 45961963, "link": "https://stackoverflow.com/questions/45961963/excel-vba-why-doesnt-the-screen-update-update-cells-right-before-turning-off", "title": "Excel vba: Why doesn&#39;t the screen update, update cells right before turning off screen updating", "body": "<p>I have a sub that starts with calling another sub (that edits the workbook's cells) and then turns off screen updating and alerts. The thing is, even though the first sub that edits the workbook is located before the second sub, the cell isn't updated.</p>\n\n<p>When I turn off the second sub, the cell is updated. How can I update the cell and then turn off the screen updating?</p>\n\n<pre><code>Sub mainSub()\n        Call editSub 'edit cell's value: ThisWorkbook...Cells(i, j).Value=...\n        Call setupApp 'turns off scren updating, when uncommented prevents the previous sub from getting visible results\n        ...\nEnd Sub\n\nSub setupApp()\n        Application.ScreenUpdating = False\n        Application.DisplayAlerts = False\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>: Screen updating is <strong>already</strong> true when the <code>mainSub</code> starts; Commenting the <code>setupApp</code> sub out <strong>helps</strong>, because it obviously gets executed earlier than the cells are edited somewhy.</p>\n\n<pre><code>Sub editSub()\n    Dim resultArray() As String\n    resultArray = getStateNames()  'just returns an array of Strings\n\n    displayStateNameArray (resultArray)\nEnd Sub\n\nSub displayStateNameArray(resultArray As Variant)\n    ThisWorkbook.Worksheets(\"sheet 1\").Range(\"C6:C97\").Clear\n    Dim k As Integer\n    Dim i As Integer\n    i = 1\n    For k = LBound(resultArray) To UBound(resultArray)\n            ThisWorkbook.Worksheets(\"sheet 1\").Cells(5 + i, 3).Value = resultArray(k)\n            i = i + 1\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1504101101, "post_id": 45961707, "comment_id": 78883041, "body": "See this post: <a href=\"https://stackoverflow.com/questions/44019988/setting-the-sender-email-address-according-to-the-recipient/44033922#44033922\" title=\"setting the sender email address according to the recipient\">stackoverflow.com/questions/44019988/&hellip;</a>"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1504103077, "post_id": 45961707, "comment_id": 78884609, "body": "What is it exactly that you are trying to achieve?"}, {"owner": {"reputation": 3, "user_id": 8538224, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2702ba998d57000b70a5a9b68d8618c9?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/8538224/art"}, "edited": false, "score": 0, "creation_date": 1504103750, "post_id": 45961707, "comment_id": 78885150, "body": "Thanks for your replies guys. What i am trying to achieve is:  When someone is trying to compose a mail from specific account (account@mail.com) then automatically needs to be added recipient in CC field. if composing from any other configured emails account nothing should happen. If that make sense... thanks again for any help here guys..."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1504105522, "post_id": 45961707, "comment_id": 78886553, "body": "The easiest way to do this would be not to hook into the ItemLoad but the ItemSend event, i.e. check right before the mail is sent: <a href=\"https://msdn.microsoft.com/de-de/library/office/ff865076.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/de-de/library/office/ff865076.aspx</a>"}, {"owner": {"reputation": 3, "user_id": 8538224, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2702ba998d57000b70a5a9b68d8618c9?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/8538224/art"}, "edited": false, "score": 0, "creation_date": 1504105772, "post_id": 45961707, "comment_id": 78886747, "body": "Kostas K.:  Any clue where to specify in that particular code the email address i want to put in CC field? Sorry for the noob question."}, {"owner": {"reputation": 3, "user_id": 8538224, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2702ba998d57000b70a5a9b68d8618c9?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/8538224/art"}, "edited": false, "score": 0, "creation_date": 1504105992, "post_id": 45961707, "comment_id": 78886911, "body": "LocEngineer:  unfortunately changes has to be made before before person will click send button so they could actually see what they are sending..."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1515093646, "creation_date": 1515093646, "answer_id": 48102128, "question_id": 45961707, "link": "https://stackoverflow.com/questions/45961707/trigger-when-composing-e-mail/48102128#48102128", "title": "Trigger when composing e-mail", "body": "<p>You can test the <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-sent-property-outlook\" rel=\"nofollow noreferrer\">MailItem.Sent</a> property to determine whether composing mail or reading received mail.</p>\n\n<pre><code>Private Sub Application_ItemLoad(ByVal Item As Object)\n\n    Dim oAccount As Outlook.Explorer\n\n    If TypeName(Item) = \"MailItem\" Then\n\n        If item.Sent Then\n            MsgBox \"Not for processing\"\n        Else\n            MsgBox \"Processing this mail\"\n            Set oAccount = Application.ActiveExplorer   \n            MsgBox (oAccount.CurrentFolder.FolderPath)\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8538224, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2702ba998d57000b70a5a9b68d8618c9?s=128&d=identicon&r=PG&f=1", "display_name": "Art", "link": "https://stackoverflow.com/users/8538224/art"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1515093646, "creation_date": 1504099472, "last_edit_date": 1509804659, "question_id": 45961707, "link": "https://stackoverflow.com/questions/45961707/trigger-when-composing-e-mail", "title": "Trigger when composing e-mail", "body": "<p>This code is executed every time I select a message. I want this code to be executed only when I am composing new mail/replying/forwarding.</p>\n\n<pre><code>Private Sub Application_ItemLoad(ByVal Item As Object)\n    Dim oAccount As Outlook.Explorer\n    If TypeName(Item) = \"MailItem\" Then\n        MsgBox (\"this is mail\")\n        Set oAccount = Application.ActiveExplorer   \n        MsgBox (oAccount.CurrentFolder.FolderPath)\n    End If\nEnd Sub\n</code></pre>\n\n<p>What I am trying to achieve: When composing mail from specific account (account@mail.com) add recipient in CC field.</p>\n\n<p>I am a noob in programming.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 611, "user_id": 6088149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d79fb7d7780ae4e18563361cd4512c48?s=128&d=identicon&r=PG", "display_name": "exSnake", "link": "https://stackoverflow.com/users/6088149/exsnake"}, "edited": false, "score": 0, "creation_date": 1504099220, "post_id": 45961290, "comment_id": 78881462, "body": "Are you closing the wb in &quot;more stuff goes here&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1504099150, "post_id": 45961330, "comment_id": 78881399, "body": "Wrong. While this is true in other languages (c#, python, etc) it is not true for VBA. Further, OP&#39;s question pertains to iteration (so it&#39;s within the scope of the <code>While</code> loop anyways)."}], "tags": [], "owner": {"reputation": 303, "user_id": 7546132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pBkf0.jpg?s=128&g=1", "display_name": "phaen", "link": "https://stackoverflow.com/users/7546132/phaen"}, "is_accepted": false, "score": -3, "last_activity_date": 1504098437, "creation_date": 1504098437, "answer_id": 45961330, "question_id": 45961290, "link": "https://stackoverflow.com/questions/45961290/variable-value-being-forgotten-after-loop-vba/45961330#45961330", "title": "Variable value being forgotten after loop VBA", "body": "<p>You need to declare the variable outside the if statement, better outside the loop. Else you cant access it outside the if/loop statement. </p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 1, "creation_date": 1504099156, "post_id": 45961427, "comment_id": 78881406, "body": "This is fantastic- much more concise and solved the problem immediately. P.s. you were right, I was closing the workbook, so thank you for that addendum!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 7, "last_activity_date": 1504099276, "last_edit_date": 1504099276, "creation_date": 1504098711, "answer_id": 45961427, "question_id": 45961290, "link": "https://stackoverflow.com/questions/45961290/variable-value-being-forgotten-after-loop-vba/45961427#45961427", "title": "Variable value being forgotten after loop VBA", "body": "<p>Hard to say what the specific problem is without seeing more code, but I would suggest a more concise logic, like instead of this:</p>\n\n<pre><code>    If Not isExecuted Then\n\n        Dim rng As Range\n        Set rng = Application.InputBox(\"Select a Range\", \"Obtain Range Object\", Type:=8)\n        Debug.Print (rng.Address)\n        MsgBox \"The cells selected were \" &amp; rng.Address\n        isExecuted = True\n\n    End If\n</code></pre>\n\n<p>Do this:</p>\n\n<pre><code>If rng is Nothing Then\n    Set rng = Application.InputBox(\"Select a Range\", \"Obtain Range Object\", Type:=8)\nEnd If\n</code></pre>\n\n<p>NB: If you're closing the workbook during the <code>' more stuff goes here</code> part, that probably is killing the object reference to the range</p>\n\n<blockquote>\n  <p>Any ideas as to how to permanently set <code>rng.Address</code> to the specified cell range?</p>\n</blockquote>\n\n<p>Yes, just preserve the <code>Address</code> rather than the <em>object</em>. Since the <code>Address</code> is a string literal, you can retain this in a <code>String</code> variable even if the object reference goes out of scope:</p>\n\n<pre><code>Dim addr As String\nIf addr = vbNullString\n    addr = Application.InputBox(\"Select a Range\", \"Obtain Range Object\", Type:=8).Address\nEnd If\nSet SourceRange = WorkBk.Worksheets(1).Range(addr)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "edited": false, "score": 0, "creation_date": 1504099322, "post_id": 45961635, "comment_id": 78881562, "body": "David got there a little before you but yes this is also a viable way to get around the issue!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1504099430, "post_id": 45961635, "comment_id": 78881654, "body": "&quot;somehow connected&quot; -- <code>rng</code> is a property of a worksheet (which is a property of the workbook). It&#39;s not magic :) Also, it&#39;s not &quot;opening the next workbook&quot; which causes <code>rng</code> to go out of scope, it&#39;s <i>closing</i> the initial workbook that causes the <code>rng</code> to be lost. Cheers.."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1504099501, "post_id": 45961635, "comment_id": 78881705, "body": "right solution, though and I made small edit to your answer to clarify the above points."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1504099502, "post_id": 45961635, "comment_id": 78881707, "body": "@DavidZemens thank you for the Explination. and the edits"}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 4, "last_activity_date": 1504099477, "last_edit_date": 1504099477, "creation_date": 1504099270, "answer_id": 45961635, "question_id": 45961290, "link": "https://stackoverflow.com/questions/45961290/variable-value-being-forgotten-after-loop-vba/45961635#45961635", "title": "Variable value being forgotten after loop VBA", "body": "<p>The Problem is, that the Range Object is connected to the First Workbook. So when you close that workbook, the Range Object will be lost.</p>\n\n<p>You need to <strong>Save the Address in an String Variable</strong>, so you can access it on every Loop.</p>\n\n<pre><code>    Dim strAddress as String\n    isExecuted = False\n    Do While FileName &lt;&gt; \"\"\n        ' Open a workbook in the folder\n        Set WorkBk = Workbooks.Open(Folder &amp; \"\\\" &amp; FileName)\n\n            ' Conditional to select range only once\n            If Not isExecuted Then\n\n                Dim rng As Range\n                Set rng = Application.InputBox(\"Select a Range\", \"Obtain Range Object\", Type:=8)\n                Debug.Print (rng.Address)\n                MsgBox \"The cells selected were \" &amp; rng.Address\n                strAddress = rng.Address\n                isExecuted = True\n\n            End If\n\n\n        Set SourceRange = WorkBk.Worksheets(1).Range(strAddress )\n\n    ' more stuff goes here\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8461953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/475dcc34baf0f60e48ecc8e19b529ca1?s=128&d=identicon&r=PG&f=1", "display_name": "alex1stef2", "link": "https://stackoverflow.com/users/8461953/alex1stef2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "accepted_answer_id": 45961427, "answer_count": 3, "score": 2, "last_activity_date": 1504099477, "creation_date": 1504098315, "question_id": 45961290, "link": "https://stackoverflow.com/questions/45961290/variable-value-being-forgotten-after-loop-vba", "title": "Variable value being forgotten after loop VBA", "body": "<p>I am currently trying to set up a <code>Do While</code> loop in which one part of the loop only executes once. I am effectively trying to define a cell range for one sheet, and then have my loop apply this same cell range to all sheets/workbooks without having to re-specify the range. </p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>isExecuted = False\nDo While FileName &lt;&gt; \"\"\n    ' Open a workbook in the folder\n    Set WorkBk = Workbooks.Open(Folder &amp; \"\\\" &amp; FileName)\n\n        ' Conditional to select range only once\n        If Not isExecuted Then\n\n            Dim rng As Range\n            Set rng = Application.InputBox(\"Select a Range\", \"Obtain Range Object\", Type:=8)\n            Debug.Print (rng.Address)\n            MsgBox \"The cells selected were \" &amp; rng.Address\n            isExecuted = True\n\n        End If\n\n\n    Set SourceRange = WorkBk.Worksheets(1).Range(rng.Address)\n\n' more stuff goes here\n</code></pre>\n\n<p>In debug mode. the first time this loop executes everything works as expected, and I can see that my rng.Address is the cell range specified. However, on the second loop rng.Address becomes <code>&lt;ObjectRequired&gt;</code>, and so the rest of the script fails. Any ideas as to how to permanently set rng.Address to the specified cell range?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1504099716, "post_id": 45961152, "comment_id": 78881872, "body": "Perhaps add <code>p.Shaperange.lockaspectratio = False</code> before sizing it?"}, {"owner": {"reputation": 55, "user_id": 8538120, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/83f6c5baf9fb34388c68a63233b3eea8?s=128&d=identicon&r=PG&f=1", "display_name": "Amasian21", "link": "https://stackoverflow.com/users/8538120/amasian21"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1504100251, "post_id": 45961152, "comment_id": 78882314, "body": "@Rory This worked! Thank you for sharing Shaperange.lockaspectratio as I didn&#39;t know that was an option. Please place your comment in a form of an answer so I can reward you. Thank you."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504101878, "post_id": 45961152, "comment_id": 78883662, "body": ".Parent.Pictures.Paste &lt;~~ you must copy picture before paste."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1504100730, "creation_date": 1504100730, "answer_id": 45962176, "question_id": 45961152, "link": "https://stackoverflow.com/questions/45961152/pasting-image-to-fit-in-merged-cell-bug/45962176#45962176", "title": "Pasting image to fit in merged cell bug", "body": "<p>Add:</p>\n\n<pre><code>p.Shaperange.lockaspectratio = False\n</code></pre>\n\n<p>before resizing the picture and you should be able to alter both height and width independently.</p>\n"}], "owner": {"reputation": 55, "user_id": 8538120, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/83f6c5baf9fb34388c68a63233b3eea8?s=128&d=identicon&r=PG&f=1", "display_name": "Amasian21", "link": "https://stackoverflow.com/users/8538120/amasian21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "accepted_answer_id": 45962176, "answer_count": 1, "score": 0, "last_activity_date": 1504100730, "creation_date": 1504097996, "last_edit_date": 1531164843, "question_id": 45961152, "link": "https://stackoverflow.com/questions/45961152/pasting-image-to-fit-in-merged-cell-bug", "title": "Pasting image to fit in merged cell bug", "body": "<p>I have two different subs which which places an image into a merged cell. The file selection method, distorts the image to fit both the height and width of the merged cell, no matter what size it is. The paste version however, will not do both the width &amp; height. Only which ever one is used last within the programming code. How could I go about adjusting my sub paste, so that it distorts the image to fit both the width and height? </p>\n\n<pre><code>Sub FromFile()\n\n    Dim sFileName As String\n    Dim oShape As Shape\n\n    If TypeName(ActiveSheet) &lt;&gt; \"Worksheet\" Then Exit Sub\n\n    sFileName = Application.GetOpenFilename( _\n        FileFilter:=\"Images (*.gif;*.jpg;*.png), *.gif;*.jpg;*.png\", _\n        FilterIndex:=1, _\n        Title:=\"Insert Picture\", _\n        ButtonText:=\"Insert\", _\n        MultiSelect:=False)\n    If sFileName = \"False\" Then Exit Sub\n\n    With ActiveCell.MergeArea\n        ActiveSheet.Shapes.AddPicture _\n                Filename:=sFileName, _\n                LinkToFile:=msoFalse, _\n                SaveWithDocument:=msoTrue, _\n                Left:=.Left, _\n                Top:=.Top, _\n                Width:=.Width, _\n                Height:=.Height\n    End With\n\n\nEnd Sub\n\n\nPublic Sub Paste()\nDim p As Picture\n\n    Dim s As Shape, rng As Range\n    Set rng = Range(\"MyMerge\")\n\n    For Each s In ActiveSheet.Shapes\n        If Intersect(rng, s.TopLeftCell) Is Nothing Then\n        Else\n            s.Delete\n        End If\n    Next s\n\nWorksheets(\"Report\").Range(\"MyMerge\").Select\nWith ActiveCell.MergeArea\n    Set p = .Parent.Pictures.Paste\n    p.Left = .Left\n    p.Top = .Top\n    p.Height = .Height\n    p.Width = .Width\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": true, "score": 6, "last_activity_date": 1504097444, "creation_date": 1504097444, "answer_id": 45960953, "question_id": 45960778, "link": "https://stackoverflow.com/questions/45960778/apply-vba-macro-to-multiple-cells/45960953#45960953", "title": "Apply VBA macro to multiple cells", "body": "<p>Change</p>\n\n<pre><code>If Target.Address = \"$A$7\" Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If Not Intersect(Target, Range(\"A7:A18\")) Is Nothing Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 4225297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vVOhmxwSR7E/AAAAAAAAAAI/AAAAAAAAAS4/kItxZ-QFCos/photo.jpg?sz=128", "display_name": "John Ink", "link": "https://stackoverflow.com/users/4225297/john-ink"}, "is_accepted": false, "score": 0, "last_activity_date": 1504098425, "creation_date": 1504098425, "answer_id": 45961325, "question_id": 45960778, "link": "https://stackoverflow.com/questions/45960778/apply-vba-macro-to-multiple-cells/45961325#45961325", "title": "Apply VBA macro to multiple cells", "body": "<p>I used wild cards.</p>\n\n<pre><code>If Target.Address = \"$A$7\" Then\n</code></pre>\n\n<p>To</p>\n\n<pre><code>If Target.Address Like \"$A$[7-9]\" Or Target.Address Like \"$A$1[0-8]\" Then\n</code></pre>\n"}], "owner": {"reputation": 747, "user_id": 1627951, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2a0b27782c33908a6a310ba258ec2968?s=128&d=identicon&r=PG", "display_name": "Developer", "link": "https://stackoverflow.com/users/1627951/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2199, "favorite_count": 0, "accepted_answer_id": 45960953, "answer_count": 2, "score": 5, "last_activity_date": 1504098425, "creation_date": 1504097032, "last_edit_date": 1504097230, "question_id": 45960778, "link": "https://stackoverflow.com/questions/45960778/apply-vba-macro-to-multiple-cells", "title": "Apply VBA macro to multiple cells", "body": "<p>I would say I am not expert in VBA. I have a VBA code that append multiple values from selected list in one cell. The code works but now I would like to apply the code to multiple cells.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n'Code by Sumit Bansal from https://trumpexcel.com\n' To Select Multiple Items from a Drop Down List in Excel\nDim Oldvalue As String\nDim Newvalue As String\nApplication.EnableEvents = True\nOn Error GoTo Exitsub\nIf Target.Address = \"$A$7\" Then\n  If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n    GoTo Exitsub\n  Else: If Target.Value = \"\" Then GoTo Exitsub Else\n    Application.EnableEvents = False\n    Newvalue = Target.Value\n    Application.Undo\n    Oldvalue = Target.Value\n      If Oldvalue = \"\" Then\n        Target.Value = Newvalue\n      Else\n        If InStr(1, Oldvalue, Newvalue) = 0 Then\n            Target.Value = Oldvalue &amp; \",\" &amp; Chr(10) &amp; Newvalue\n      Else:\n        Target.Value = Oldvalue\n      End If\n    End If\n  End If\nEnd If\nApplication.EnableEvents = True\nExitsub:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>How can I extend my code to use cell range </p>\n\n<pre><code>$A$7:$A$18 \n</code></pre>\n\n<p>instead of <code>\"$A$7\"</code> so that I can apply the VBA code to multiple cells in Excel.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 611, "user_id": 6088149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d79fb7d7780ae4e18563361cd4512c48?s=128&d=identicon&r=PG", "display_name": "exSnake", "link": "https://stackoverflow.com/users/6088149/exsnake"}, "is_accepted": false, "score": 2, "last_activity_date": 1504097479, "creation_date": 1504097479, "answer_id": 45960964, "question_id": 45960646, "link": "https://stackoverflow.com/questions/45960646/excel-vba-delete-method-to-not-delete-the-headline/45960964#45960964", "title": "Excel VBA Delete Method To NOT Delete The Headline", "body": "<p>You cannot delete row where there is a table header, you have to convert the table in a interval then delete it. Or just on error resume next:</p>\n\n<pre><code>Sub DeleteValues()\n\n\nDim i As Integer\nDim MFG_wb As Workbook\nDim Dep As Integer\n\n\n\nSet MFG_wb = Workbooks.Open _\n    (\"C:\\Users\\rosipov\\Desktop\\eliran\\MFG - GSS\\MFG Daily\\Fast Daily \" &amp; \nFormat(Now(), \"ddmmyy\") &amp; \".xlsx\", _\nUpdateLinks:=False, IgnoreReadOnlyRecommended:=True)\nMFG_wb.Sheets(\"Aleris\").Activate\n\nDep = MFG_wb.Sheets(\"Aleris\").Range(\"O2\").End(xlDown).Row\n\nOn Error Resume Next\nFor i = Dep To 1 Step -1\n    If Not (Cells(i, 15).Value = \"SI\" Or Cells(i, 15).Value = \"OI\") Then\n        Cells(i, 15).EntireRow.Delete\n    End If\nNext i    \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": true, "score": 2, "last_activity_date": 1504097610, "creation_date": 1504097610, "answer_id": 45961009, "question_id": 45960646, "link": "https://stackoverflow.com/questions/45960646/excel-vba-delete-method-to-not-delete-the-headline/45961009#45961009", "title": "Excel VBA Delete Method To NOT Delete The Headline", "body": "<p>you need to fix the Loop Condition.\nFrom <strong>1</strong> to <strong>2</strong></p>\n\n<pre><code>For i = Dep To 2 Step -1\n    Cells(i, 15).Select\n    If Not (Selection.Value = \"SI\" Or Selection.Value = \"OI\") Then\n        Rows(i).Delete\n    End If\nNext i\n</code></pre>\n\n<p>For Example: if <strong>Dep</strong> is <strong>5</strong>. The loop will decrement till <strong>Dep</strong> is <strong>1</strong>. After that, it will decrement to <strong>0</strong> and it will jump out off the Loop.\nSo you have to Set the <strong>Loop Condition</strong> to <strong>2</strong>, so it would Exit the Loop when he get's to the Header Row.</p>\n"}, {"tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": false, "score": 3, "last_activity_date": 1504097688, "creation_date": 1504097688, "answer_id": 45961043, "question_id": 45960646, "link": "https://stackoverflow.com/questions/45960646/excel-vba-delete-method-to-not-delete-the-headline/45961043#45961043", "title": "Excel VBA Delete Method To NOT Delete The Headline", "body": "<p>just don't try to delete the top line.<br>\ninstead of <code>For i = Dep To 1 Step -1</code>, use:</p>\n\n<pre><code>For i = Dep To 2 Step -1\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 45961009, "answer_count": 3, "score": 1, "last_activity_date": 1504097688, "creation_date": 1504096646, "last_edit_date": 1504097603, "question_id": 45960646, "link": "https://stackoverflow.com/questions/45960646/excel-vba-delete-method-to-not-delete-the-headline", "title": "Excel VBA Delete Method To NOT Delete The Headline", "body": "<p>I am trying to make a loop which deletes all cells that has none of these two values: \"OI\" or \"SI\".</p>\n\n<p>When I execute the macro, I get:</p>\n\n<blockquote>\n  <p>Delete Method of range class failed</p>\n</blockquote>\n\n<p>I figure it out and it is becaues it tries to delete the headline. </p>\n\n<p>How can I avoid the deletion of the Headline?</p>\n\n<pre><code>Sub DeleteValues()   \n\nDim i As Integer\nDim MFG_wb As Workbook\nDim Dep As Integer\n\nSet MFG_wb = Workbooks.Open _\n(\"C:\\Users\\rosipov\\Desktop\\eliran\\MFG - GSS\\MFG Daily\\Fast Daily \" &amp; Format(Now(), \"ddmmyy\") &amp; \".xlsx\", _\nUpdateLinks:=False, IgnoreReadOnlyRecommended:=True)\nMFG_wb.Sheets(\"Aleris\").Activate\n\nDep = MFG_wb.Sheets(\"Aleris\").Range(\"O2\").End(xlDown).Row\n\nFor i = Dep To 1 Step -1\n    Cells(i, 15).Select\n    If Not (Selection.Value = \"SI\" Or Selection.Value = \"OI\") Then\n        Rows(i).Delete\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "colors", "find", "match"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1504094931, "post_id": 45959957, "comment_id": 78877975, "body": "Not sure what makes you think you can use Match like that. You can use the Find method with a format though."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1504112141, "post_id": 45959957, "comment_id": 78890741, "body": "Use a Range.Find in conjunction with the SearchFormat parameter to find the relevant cell"}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 2582950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z98oM.jpg?s=128&g=1", "display_name": "Cristiano Morgado", "link": "https://stackoverflow.com/users/2582950/cristiano-morgado"}, "is_accepted": false, "score": 0, "last_activity_date": 1504099601, "creation_date": 1504099601, "answer_id": 45961756, "question_id": 45959957, "link": "https://stackoverflow.com/questions/45959957/using-match-function-with-colour-criteria/45961756#45961756", "title": "Using match function with colour criteria", "body": "<p>You can use Range.Find's \"After\" parameter to keep going further until you match the Interior.Color you want.</p>\n\n<p>I made a little snippet to demonstrate what I mean:</p>\n\n<pre><code>Sub test()\nDim blankCode As Long\nDim tempRange As Range\nDim lookupValue As String\n\nblankCode = 16777215 'Blank cell\nlookupValue = \"testing this out\" 'what im looking for\nSet tempRange = Range(\"A1\") 'Starting in cell A1\n\nDo\n'Going through each match of the lookup value until the color is what we need\n    Set tempRange = Range(\"A:A\").Find(lookupValue, After:=tempRange)\n    If tempRange.Interior.Color = blankCode Then\n        MsgBox (\"Found it on cell \" &amp; tempRange.Address)\n        Exit Do\n    End If\n\n'This will loop indefinitely if the value isn't there, so I'd add a loop control that suits your project\nLoop While True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": false, "score": 0, "last_activity_date": 1504100112, "creation_date": 1504100112, "answer_id": 45961951, "question_id": 45959957, "link": "https://stackoverflow.com/questions/45959957/using-match-function-with-colour-criteria/45961951#45961951", "title": "Using match function with colour criteria", "body": "<p>I did my solution as a function that works pretty similarly to the regular <code>Match</code> function:</p>\n\n<pre><code>Public Function MatchUncolored(lookup_value, lookup_array As Range)\nDim cell As Range, ct As Long\n\nFor Each cell In Union(lookup_array.SpecialCells(xlCellTypeConstants), lookup_array.SpecialCells(xlCellTypeFormulas))\n\n    ct = ct + 1\n\n    If ct &gt; 10000 Then\n        MatchUncolored = \"#ERROR\"\n        Exit Function\n    End If\n\n    If cell.Value = lookup_value And cell.Interior.ColorIndex = xlNone Then\n        MatchUncolored = ct\n        Exit Function\n    End If\n\nNext cell\n\nEnd Function\n</code></pre>\n\n<p>Seems to work with what I tested it on, but your mileage may vary.</p>\n"}, {"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1504118198, "last_edit_date": 1504118198, "creation_date": 1504102481, "answer_id": 45962829, "question_id": 45959957, "link": "https://stackoverflow.com/questions/45959957/using-match-function-with-colour-criteria/45962829#45962829", "title": "Using match function with colour criteria", "body": "<p>Here's yet another approach.  This one uses the Find method to search for a match.  Also, it too uses a function to return the the row number.  However, if there's no match, it returns an error for which it can be tested.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim vRow As Variant\n    vRow = FindUncolored(\"123\", Range(\"A:A\"))\n    If IsError(vRow) Then\n        MsgBox \"No match found!\", vbInformation\n    Else\n        MsgBox \"Match found in Row \" &amp; vRow, vbInformation\n    End If\nEnd Sub\n\nFunction FindUncolored(strSearchFor As String, rngRange As Range)\n\n    Dim rngFound As Range\n\n    With Application.FindFormat\n        .Clear\n        .Interior.ColorIndex = xlNone\n    End With\n\n    With rngRange\n        Set rngFound = .Find(what:=strSearchFor, after:=.Cells(.Rows.Count), LookIn:=xlValues, _\n            lookat:=xlWhole, searchorder:=xlRows, searchdirection:=xlNext, MatchCase:=False, SearchFormat:=True)\n    End With\n\n    If Not rngFound Is Nothing Then\n        FindUncolored = rngFound.Row\n    Else\n        FindUncolored = CVErr(xlErrNA)\n    End If\n\n    Application.FindFormat.Clear\n\nEnd Function\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1504112373, "creation_date": 1504112373, "answer_id": 45965994, "question_id": 45959957, "link": "https://stackoverflow.com/questions/45959957/using-match-function-with-colour-criteria/45965994#45965994", "title": "Using match function with colour criteria", "body": "<p>Consider:</p>\n\n<pre><code>Application.FindFormat.Interior.ColorIndex = 0\nrowfound = Range(\"A:A\").Find(\"123\", SearchFormat:=True)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8381363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42381a89fadc7916b9688314685d272?s=128&d=identicon&r=PG&f=1", "display_name": "blankplank", "link": "https://stackoverflow.com/users/8381363/blankplank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1504118198, "creation_date": 1504094650, "question_id": 45959957, "link": "https://stackoverflow.com/questions/45959957/using-match-function-with-colour-criteria", "title": "Using match function with colour criteria", "body": "<p>I'm trying to find the row of a cell with the usage of match. I've been able to do this with</p>\n\n<pre><code>rowfound = Application.WorksheetFunction.Match(\"123\", Range(\"A:A\"), 0)\n</code></pre>\n\n<p>But here come's where i'm stuck at. The \"123\" may have appeared multiple times in the same column (these would have been filled with a colour already) and i'm trying to find the latest \"123\" cell. This cell would not be filled with any colour.</p>\n\n<p>I've tried to input it this way but i believe <code>Interior.ColorIndex = 0</code> only applies to objects and not ranges.</p>\n\n<pre><code>rowfound = Application.WorksheetFunction.Match(\"123\", Range(\"A:A\").Interior.ColorIndex = 0, 0)\n</code></pre>\n\n<p>I've also tried doing a <code>Selection.Address</code> on the uncoloured cells and doing a match from there but this will results in the match function giving a result that isn't the row of where the cell is in the worksheet (it'll give the row that it can be found in the selection) [i.e actual cell row of \"123\" = 2000 but result given is \"1\", which is the row in the selection]. My code for this is</p>\n\n<pre><code>RRR = Selection.Address\nrowfound = Application.WorksheetFunction.Match(\"123\", Range(RRR), O)\n</code></pre>\n\n<p>Any idea how to solve this? Hope i was clear in my explanation of my issue.</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 1, "creation_date": 1504095267, "post_id": 45959893, "comment_id": 78878227, "body": "Re-reading the code, it looks like it should already be going to the extents of the file, as <code>Len(txt)</code> would suggest.  Have you tried stepping through the code?  In the VB IDE, press F11 until you expect it to grab the final column, then check the variable values.  You can also utilize the watch, right click on variables and click add watch."}, {"owner": {"reputation": 427, "user_id": 8511544, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aec997d74024440fbb74f040f9f778ae?s=128&d=identicon&r=PG&f=1", "display_name": "dalleaux", "link": "https://stackoverflow.com/users/8511544/dalleaux"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1504095948, "post_id": 45959893, "comment_id": 78878790, "body": "the value of <code>y</code> is only going up to 14, but the last column is no. 15. May it be, that the problem is, that after the last value in the csv file there is no <code>;</code> ?"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1504096270, "post_id": 45959893, "comment_id": 78879042, "body": "I would assume then that it is going to 15 but the IF statement is causing it to ignore the content of the cell.  Keep stepping through, see if it gets to 15."}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1504096391, "post_id": 45959893, "comment_id": 78879132, "body": "The FileSystemObject.OpenTextFile method doesn&#39;t care about the general content, but your code does."}, {"owner": {"reputation": 427, "user_id": 8511544, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aec997d74024440fbb74f040f9f778ae?s=128&d=identicon&r=PG&f=1", "display_name": "dalleaux", "link": "https://stackoverflow.com/users/8511544/dalleaux"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1504096500, "post_id": 45959893, "comment_id": 78879224, "body": "no, <code>y</code> goes from 14 to 0"}, {"owner": {"reputation": 427, "user_id": 8511544, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aec997d74024440fbb74f040f9f778ae?s=128&d=identicon&r=PG&f=1", "display_name": "dalleaux", "link": "https://stackoverflow.com/users/8511544/dalleaux"}, "reply_to_user": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1504096611, "post_id": 45959893, "comment_id": 78879303, "body": "I think the code after the For Loop: ... <code>Next x Worksheets(Blatt).Cells((i Mod 65536) + 1, y + 1) = Mid(txt, alt + 1, x - alt - 1)</code> ... should add the last column but it doesn&#39;t"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 1, "creation_date": 1504096692, "post_id": 45959893, "comment_id": 78879369, "body": "Let me explain this better.  y cannot increment to 15 if the cell does not have a semi-colon, because y is incremented INSIDE of the if-statement."}], "answers": [{"comments": [{"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "edited": false, "score": 0, "creation_date": 1504097513, "post_id": 45960914, "comment_id": 78879960, "body": "I had thought about that but we don&#39;t know the content, or how far the actual &quot;used&quot; cells extend out to.  There probably was a specific reason they were using semi-colons to parse specific cells.  I think he can move the <code>y = y + 1</code> outside of the if statement safely."}, {"owner": {"reputation": 427, "user_id": 8511544, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aec997d74024440fbb74f040f9f778ae?s=128&d=identicon&r=PG&f=1", "display_name": "dalleaux", "link": "https://stackoverflow.com/users/8511544/dalleaux"}, "edited": false, "score": 0, "creation_date": 1504097557, "post_id": 45960914, "comment_id": 78879992, "body": "Thats it! Thank you:) (I tried to move y=y+1 outside.. doesn&#39;t work)"}, {"owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "reply_to_user": {"reputation": 427, "user_id": 8511544, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aec997d74024440fbb74f040f9f778ae?s=128&d=identicon&r=PG&f=1", "display_name": "dalleaux", "link": "https://stackoverflow.com/users/8511544/dalleaux"}, "edited": false, "score": 0, "creation_date": 1504097646, "post_id": 45960914, "comment_id": 78880071, "body": "@dalleaux Be warned, if you add more columns again, this method will be invalid.  This method will read all the columns with a semi-colon and the last column only."}, {"owner": {"reputation": 26, "user_id": 8537722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06868de9c9b1039a26bb0d4e82ec33fa?s=128&d=identicon&r=PG", "display_name": "Vishwa - LearnExcelMacro", "link": "https://stackoverflow.com/users/8537722/vishwa-learnexcelmacro"}, "edited": false, "score": 0, "creation_date": 1504098250, "post_id": 45960914, "comment_id": 78880607, "body": "Its not really a smart solution but I do not fully agree though with your point that it will not work when there are more columns added. No matter how many more columns are added... it will work as it is comparing x with the len(txt) and not a hard coded length. Or am I missing something here?"}], "tags": [], "owner": {"reputation": 26, "user_id": 8537722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06868de9c9b1039a26bb0d4e82ec33fa?s=128&d=identicon&r=PG", "display_name": "Vishwa - LearnExcelMacro", "link": "https://stackoverflow.com/users/8537722/vishwa-learnexcelmacro"}, "is_accepted": true, "score": 1, "last_activity_date": 1504097352, "creation_date": 1504097352, "answer_id": 45960914, "question_id": 45959893, "link": "https://stackoverflow.com/questions/45959893/how-to-extend-the-area-a-vba-script-imports-from-a-csv-file/45960914#45960914", "title": "How to extend the area a VBA script imports from a csv file?", "body": "<p>You can simply change this if condition like this:</p>\n\n<pre><code> If Mid(txt, x, 1) = \";\" Or x = Len(txt) Then\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 8511544, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/aec997d74024440fbb74f040f9f778ae?s=128&d=identicon&r=PG&f=1", "display_name": "dalleaux", "link": "https://stackoverflow.com/users/8511544/dalleaux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 45960914, "answer_count": 1, "score": 0, "last_activity_date": 1504097352, "creation_date": 1504094461, "question_id": 45959893, "link": "https://stackoverflow.com/questions/45959893/how-to-extend-the-area-a-vba-script-imports-from-a-csv-file", "title": "How to extend the area a VBA script imports from a csv file?", "body": "<p>I have to edit a VBA script I did not write myself.\nThat's why I do not really know what to do (and I tried a lot).</p>\n\n<p>The code:</p>\n\n<pre><code>Sub Datei_Auslesen_Modul1()\nOn Error GoTo errorhandler\nDim fso As Object, Dat As Object, i As Long, Blatt As Byte\n  Dim txt As String, x As Integer, y As Byte, alt As Integer\n  Dim Pfad_Maxforce As String\n  Application.ScreenUpdating = False\n  Set fso = CreateObject(\"Scripting.FileSystemObject\")\n  Pfad_Maxforce = InputBox(\"Bitte Pfad zum maxforce_Archiv (SICHERUNGEN) angeben.\", \"Maxforce_MT_FINAL_SIcherungen\", \"E:\\05_Messungen\\02_Skripte\\07_Versuchsauswertung\\01_Maximalkraftauslesen\\maxforce_MT_FINAL_Sicherungen\\\")\n\n  Set Dat = fso.OpenTextFile(Pfad_Maxforce &amp; Sheets(\"Daten_gesammelt\").Range(\"k9\"), 1, False) 'Dateiname aus Zelle g8 in Blatt\n\n  i = 0\n  Do While Dat.AtEndOfStream &lt;&gt; True\n    ' Tabellenblatt ermitteln\n    Blatt = (i \\ 65536) + 1   \n    txt = Dat.ReadLine\n    alt = 0\n    y = 0\n    For x = 1 To Len(txt)\n      If Mid(txt, x, 1) = \";\" Then\n      Worksheets(\"max_force_auslesen_Modul1\").Cells((i Mod 65536) + 1, y + 1) = Mid(txt, alt + 1, x - alt - 1)\n      alt = x\n      y = y + 1\n      End If\n    Next x\n    Worksheets(Blatt).Cells((i Mod 65536) + 1, y + 1) = Mid(txt, alt + 1, x - alt - 1)\n    i = i + 1\n  Loop\n  Dat.Close\n  Application.ScreenUpdating = True\n  Exit Sub\n</code></pre>\n\n<p>The Problem is, the Script does not import tha last column of the csv file. Where do I have to change the parameters?\nCheers.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1504092303, "post_id": 45959073, "comment_id": 78876043, "body": "Put VBA script in <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> for sheet(<code>sheetA</code>)"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1504094891, "post_id": 45959073, "comment_id": 78877940, "body": "Not an good idea. Update can make multiple changes in a worksheet...  @AbhinavRawat What code do you use to update <code>Sheet A</code>?"}, {"owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "reply_to_user": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1504095423, "post_id": 45959073, "comment_id": 78878326, "body": "@Micha\u0142Turczyn <code>SheetA</code> is linked with one of the trading software(New TT), which updates the sheet with live Market data automatically. for the code I mean they are just worksheet functions of NEW TT."}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1504095732, "creation_date": 1504095732, "answer_id": 45960310, "question_id": 45959073, "link": "https://stackoverflow.com/questions/45959073/auto-updating-data-coping-excel-vba-script/45960310#45960310", "title": "Auto updating data coping Excel-VBA script", "body": "<p>Since updating can raise multiple <code>Worksheet_Change</code> events, it's not practical to write copying routine in that method. More practical would be on workbook opening:\n<code>Private Sub Workbook_Open()</code> method is responsible for this event. So, now data in <code>Sheet B</code> will be updated, when workbook will be opened (so before any work). Even if updating code is opening workbook, then event is raised only once, therefore, the code will execute only once.</p>\n"}], "owner": {"reputation": 432, "user_id": 7379924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FXDXCx09s3o/AAAAAAAAAAI/AAAAAAAAAFI/jHSY6947Lnk/photo.jpg?sz=128", "display_name": "Abhinav Rawat", "link": "https://stackoverflow.com/users/7379924/abhinav-rawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 45960310, "answer_count": 1, "score": 0, "last_activity_date": 1504100933, "creation_date": 1504092135, "last_edit_date": 1531164843, "question_id": 45959073, "link": "https://stackoverflow.com/questions/45959073/auto-updating-data-coping-excel-vba-script", "title": "Auto updating data coping Excel-VBA script", "body": "<p>I have an <code>Excel</code> file, having a sheet(<code>SheetA</code>) which is linked with a software to imports live market data, so it auto updates(every second) according to the  software it is linked to. I am taking some data from specific cells(which are not fixed and very large in number... other i could have just linked them) of <code>SheetA</code> to another sheet(<code>SheetB</code>) using <code>VBA</code> script to do some calculations, I want to know a way to keep my <code>SheetB</code> calculations automatically synchronized as <code>SheetA</code> updates its cell values. \nTIA</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 2, "creation_date": 1504090451, "post_id": 45958371, "comment_id": 78874723, "body": "Not an answer; but when looking for bugs in your code, another good way is to <i>step through</i> it - that is, press <code>F8</code> to run your code line by line. This will allow you to find the exact line causing the error. If your code is long, and you know sections of it are valid, you can insert breakpoints at the end of those sections (either by typing <code>Stop</code>, or hitting <code>F9</code> when you have a particular line of code selected). Then when you run your code with <code>F5</code>, it will stop at these locations and you can then step through from there (<code>F8</code>) or run from there (<code>F5</code>)"}, {"owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1504090702, "post_id": 45958371, "comment_id": 78874897, "body": "Thanks, Greedo, that&#39;s a lot faster than writing MsgBoxes everywhere. Much appreciated comment!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1504091772, "post_id": 45958371, "comment_id": 78875641, "body": "If your intention in <code>Dim i, j, a As Integer</code> is to declare each of those variables to be an <code>Integer</code>, you have failed. Only <code>a</code> is declared to be an integer, the others are variants. In any event, why use <code>Integer</code> at all? On modern machines, there is no real reason to use it rather than <code>Long</code>. You are just risking overflow errors with no corresponding gain."}, {"owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "edited": false, "score": 0, "creation_date": 1504093299, "post_id": 45958371, "comment_id": 78876783, "body": "As you can see, I haven&#39;t done a lot of programming in my life. Thanks for the tip, I&#39;ll keep it in mind."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1504094687, "post_id": 45958371, "comment_id": 78877765, "body": "Where exactly does the Error apear? Dosn&#39;t it show it if you press Dubuger und the Error MEssage?"}, {"owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "edited": false, "score": 0, "creation_date": 1504094916, "post_id": 45958371, "comment_id": 78877962, "body": "When I press down F8 to let it go through the code fast, it stops at the line with  TopicCount = [TopicAmount].Cells(a, 1)  It doesn&#39;t give me a debug option. I can only press OK or Help."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1504095135, "post_id": 45958371, "comment_id": 78878127, "body": "Is there definitely something in TopicAmount when the code reaches that point as that line refers to a cell in the body area?"}, {"owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "edited": false, "score": 0, "creation_date": 1504164446, "post_id": 45958371, "comment_id": 78909788, "body": "Hi SJR, I tried to check if something is in it when the code reaches the TopicCount line. For a split second, there is a #REF! and then it changes to the right value. It seems like the file needs time to get the value from the other document. This might actually be it!"}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1504106853, "post_id": 45960258, "comment_id": 78887504, "body": "While it couldn&#39;t hurt to use <code>CLng()</code>, it doesn&#39;t seem to explain the nature of the problem. I don&#39;t think that downloading the file would change the cell formatting, but OP reports that the file error doesn&#39;t occur when the file is downloaded."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1504161445, "post_id": 45960258, "comment_id": 78908119, "body": "I thought the same, but i had once the same Problem, that the Numbers were written with quotation marks, so Excel will use it as a string. So you need to Convert it to a Number. And of Curse it could be aswell, that the Range or Sheet Name does not exists. But i wanted to check first if Clng() would solve the Problem."}, {"owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "edited": false, "score": 0, "creation_date": 1504164913, "post_id": 45960258, "comment_id": 78910110, "body": "I&#39;ve just tried to put CLng() around the code. Although it doesn&#39;t give me the error anymore, the TopicCount is the wrong value. It gives me back 2023 lines instead of 5. After the comment of SJR in one of the comments above, I believe that this is still caused by the #REF! that appears for a very short time. This would also explain why it does work when you go slowly through it step by step. And maybe also when doing it local because it can retrieve the values much easier."}, {"owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "edited": false, "score": 0, "creation_date": 1504175725, "post_id": 45960258, "comment_id": 78917482, "body": "The wait doesn&#39;t seem to solve it. I turned on ScreenUpdating so I can see better what&#39;s going on. When the application is waiting 1 second, it stays on #REF!. Even when the error pops up, the #REF! is still there. It only updates after I&#39;ve clicked OK on the error box. As I said before, once the reference has been placed once and the error is clicked away, that number of the loop will work the next time even if I delete it."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "edited": false, "score": 0, "creation_date": 1504201092, "post_id": 45960258, "comment_id": 78934459, "body": "@BartDeKleijn ok, what happen if you turn Alerts off with  Application.DisplayAlerts = False"}, {"owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "edited": false, "score": 0, "creation_date": 1504249478, "post_id": 45960258, "comment_id": 78949615, "body": "I still receive the Run-time error &#39;13&#39;: Type Mismatch when turning off the alerts."}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 0, "last_activity_date": 1504169236, "last_edit_date": 1504169236, "creation_date": 1504095564, "answer_id": 45960258, "question_id": 45958371, "link": "https://stackoverflow.com/questions/45958371/type-mismatch-occuring-only-once-in-online-file/45960258#45960258", "title": "Type Mismatch occuring only once in online file", "body": "<p>From your Comment i got, that the Problem since to be with the Reference.\nThat it will not be Updated Fast enough.</p>\n\n<p>So here is a Solution:</p>\n\n<p>You can use the <code>Application.Wait (Now + TimeValue(\"0:00:01\"))</code> just to wait a Second and give Excel Time to Update the Reference.</p>\n\n<p>If you wan't to do it a bit Preatier, you could use the <code>IsError()</code> Function Like this.</p>\n\n<pre><code>If IsError(TopicCount ) Then'When #Ref! Wait for 1 Second    \n    Application.Wait (Now + TimeValue(\"0:00:01\"))\n    DoEvents\nEnd If\n</code></pre>\n\n<p>Or you could do the same in a Loop and Check after Every Second if the Value is set Corectly.</p>\n\n<hr>\n\n<p><strong>Old Answer</strong></p>\n\n<p>I think that the Problem is, that there is a Number Formated as String in this cell. So you will get a type dismatch because you can not insert a string into a long Variable. </p>\n\n<p>you can try to convert the string to a Long like this:</p>\n\n<pre><code>TopicCount = CLng([TopicAmount].Cells(a, 1))\n</code></pre>\n\n<hr>\n\n<p>And secondly i would Deklare the VAriables like John Coleman said:</p>\n\n<pre><code> Dim path As String, file As String, sheet As String, sheet2 As String, TableName As String\n    Dim LastRow As Long, SectionCount As Long, StatusCount As Long, TopicCount As Long\n    Dim i As Integer, j As Integer, a As Integer\n    Dim Rng1 As Range\n</code></pre>\n\n<p>Beacuse:\n<code>Dim yxz, abc as Integer</code> is the equivalent of:</p>\n\n<pre><code>Dim yxz\nDim abc as Integer\n</code></pre>\n\n<p>and that is the equivalent of:</p>\n\n<pre><code>Dim yxz as Variant\nDim abc as Date\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7305874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04608657f03449023f1c273f3670fe12?s=128&d=identicon&r=PG&f=1", "display_name": "Bart De Kleijn", "link": "https://stackoverflow.com/users/7305874/bart-de-kleijn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504249609, "creation_date": 1504089955, "last_edit_date": 1531161705, "question_id": 45958371, "link": "https://stackoverflow.com/questions/45958371/type-mismatch-occuring-only-once-in-online-file", "title": "Type Mismatch occuring only once in online file", "body": "<p>In the code below, I run through a code several times depending on a number of entries in a table. In this case, it's 4. If I run the code, it gives a error 13 type mismatch the first time on a certain loop. So it'll give one when a = 1. But then the next time when I run one, it won't give an error on a = 1, but it will on a = 2. So I have to run the code 4 times and then it actually gives the result I want.</p>\n\n<p>When I put some MsgBoxes to check where the problem was located, it was situated somewhere around the TopicCount calculation with the following formula <code>TopicCount = [TopicAmount].Cells(a, 1)</code></p>\n\n<p>These documents are located on SharePoint and when I download them and run them locally, they don't give any error. So I suppose it has something to do with the path, but I can't locate the issue.</p>\n\n<p>If there is any information missing or you have additional questions, don't hesitate.</p>\n\n<p>Any interest and help would be highly appreciated, thank you so much.</p>\n\n<p><strong>EDIT1</strong>: To make it even weirder, I followed the tip of Greedo and used F9 and F8 to go through the code step by step. When I tap on F8 slowly when it comes to the TopicCount, it works perfectly throughout the entire code. When I hold F8 down instead of tapping it, I get the type mismatch error.</p>\n\n<p>Cheers,\nBart</p>\n\n<p><br></p>\n\n<pre><code>Sub PullValue()\n\nDim path As String, file As String, sheet As String, sheet2 As String, TableName As String\nDim LastRow As Long, SectionCount As Long, StatusCount As Long, TopicCount As Long\nDim i As Integer, j As Integer, a As Integer\n\n\nApplication.ScreenUpdating = False\nApplication.AutoCorrect.AutoFillFormulasInLists = False\n\n\nWorksheets(\"Consolidation\").Cells.ClearContents\n\nWith Worksheets(\"Hidden\").ListObjects(\"TopicAmount\")\n\n    If Not .DataBodyRange Is Nothing Then\n            .DataBodyRange.Delete\n    End If\n    .ListRows.Add AlwaysInsert:=True\n\nEnd With\n\nWith Worksheets(\"Sections\").ListObjects(\"Sections\")\n\n    SectionCount = .DataBodyRange.Rows.Count - _\n    Application.CountBlank(.DataBodyRange)\n\nEnd With\n\nWith Worksheets(\"Settings\").ListObjects(\"Status\")\n\n    StatusCount = .DataBodyRange.Rows.Count - _\n    Application.CountBlank(.DataBodyRange)\n\nEnd With\n\nFor a = 1 To SectionCount\n\n    With Worksheets(\"Consolidation\")\n\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    End With\n\n    If LastRow &lt;&gt; 1 Then\n\n        LastRow = LastRow + 2\n\n    End If\n\n    Cells(LastRow, \"A\").Value = [Sections].Cells(a, 1)\n\n    path = Application.ThisWorkbook.path + \"/\"\n    file = Worksheets(\"Consolidation\").Cells(LastRow, 1)\n    sheet = \"Overview\"\n    sheet2 = \"Hidden\"\n\n    Worksheets(\"Hidden\").ListObjects(\"TopicAmount\").ListRows.Add AlwaysInsert:=True\n\n    [TopicAmount].Cells(a, 1) = \"='\" &amp; path &amp; \"[\" &amp; file &amp; \".xlsm]\" &amp; _\n            sheet2 &amp; \"'!\" &amp; Cells(1, 4).Address &amp; \"\"\n\n    TopicCount = [TopicAmount].Cells(a, 1)\n\n    For i = LastRow + 1 To LastRow + TopicCount + 1\n\n        For j = 1 To StatusCount + 1\n\n            Cells(i, j).Formula = \"='\" &amp; path &amp; \"[\" &amp; file &amp; \".xlsm]\" &amp; _\n            sheet &amp; \"'!\" &amp; Cells(i - LastRow, j).Address &amp; \"\"\n\n        Next j\n\n    Next i\n\n    Worksheets(\"Consolidation\").ListObjects.Add(xlSrcRange, Range(Cells(LastRow + 1, 1), Cells(LastRow + TopicCount + 1, _\n    StatusCount + 1)), , xlYes).Name = [Sections].Cells(a, [Sections[Sections]].Column)\n\n    TableName = [Sections].Cells(a, 1)\n    Worksheets(\"Consolidation\").ListObjects(TableName).TableStyle = \"Testing Progress\"\n    Cells(LastRow + 1, 1).AutoFilter\n\nNext a\n\n\nApplication.ScreenUpdating = True\nApplication.AutoCorrect.AutoFillFormulasInLists = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1504090298, "post_id": 45956931, "comment_id": 78874594, "body": "Would moving the lower tables to the right of the table you are inserting into, or to another sheet solve the problem?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504092789, "post_id": 45956931, "comment_id": 78876443, "body": "Agreed with Mark. It would be best to first deal with the source of this kind of issue, the placing of your tables. Unless there is a specific reason why your tables must be arranged this way, you will inevitably run into issues any time you try to add data to them (even manually). That&#39;s not to say that they must move, but it will certainly complicate matters in general."}, {"owner": {"reputation": 23, "user_id": 8400420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34b013bcf25ccd387002d2a3aacdb9f?s=128&d=identicon&r=PG&f=1", "display_name": "macman644", "link": "https://stackoverflow.com/users/8400420/macman644"}, "edited": false, "score": 0, "creation_date": 1504103066, "post_id": 45956931, "comment_id": 78884595, "body": "Unfortunately, moving the tables in this case is not really possible."}], "answers": [{"tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": true, "score": 1, "last_activity_date": 1504088512, "last_edit_date": 1504088512, "creation_date": 1504088174, "answer_id": 45957751, "question_id": 45956931, "link": "https://stackoverflow.com/questions/45956931/adding-a-new-row-to-an-excel-table-using-vba-when-there-are-other-tables-of-dif/45957751#45957751", "title": "Adding a new row to an Excel table using VBA, when there are other tables of different width below it", "body": "<p>This code first adds new row below <code>ListObject</code> and then resizes table:</p>\n\n<pre><code>With ActiveCell.ListObject\n    ActiveSheet.Rows(.HeaderRowRange.Row + .ListRows.Count + 1).insert\n    .Resize (ActiveSheet.Range(.HeaderRowRange(1, 1), Cells(.HeaderRowRange.Row + .ListRows.Count + 1, .ListColumns.Count)))\nEnd With\n</code></pre>\n\n<p>of course you need to replace <code>ActiveCell.ListObject</code> and <code>Activesheet</code> with proper objects, this works for table that contains active cell.</p>\n"}, {"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504092687, "post_id": 45958278, "comment_id": 78876368, "body": "Be wary of the implicit <code>ActiveSheet</code> reference in your code. This will rely on the <code>ActiveSheet</code> being the target of the action, and will fail if the incorrect sheet is active."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1504092872, "post_id": 45958278, "comment_id": 78876514, "body": "Can you please explain what your code does, and why it may help? Your suggestion may help others, but it is only as useful as the explanation of <i>How</i> it works and <i>Why</i> it is better than the original code."}], "tags": [], "owner": {"reputation": 61, "user_id": 2916090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/006d4a317a723a298e444d4eb7459c4a?s=128&d=identicon&r=PG&f=1", "display_name": "mohagali", "link": "https://stackoverflow.com/users/2916090/mohagali"}, "is_accepted": false, "score": 0, "last_activity_date": 1504099032, "last_edit_date": 1504099032, "creation_date": 1504089695, "answer_id": 45958278, "question_id": 45956931, "link": "https://stackoverflow.com/questions/45956931/adding-a-new-row-to-an-excel-table-using-vba-when-there-are-other-tables-of-dif/45958278#45958278", "title": "Adding a new row to an Excel table using VBA, when there are other tables of different width below it", "body": "<p>Try with this code.</p>\n\n<pre><code>Sub AddName()\n    Dim NewRow As Range\n    Set NewRow = Range(\"Table1\").EntireRow(Range(\"Table1\").Rows.Count).Offset(1,0)\n\n    'Excel will include the newrow into table automaticlly\n    NewRow.Cells(1, 1).Value = \"newvalue\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 454, "user_id": 7437280, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154153054901080/picture?type=large", "display_name": "Daniel McCracken", "link": "https://stackoverflow.com/users/7437280/daniel-mccracken"}, "is_accepted": false, "score": 0, "last_activity_date": 1504103220, "creation_date": 1504103220, "answer_id": 45963076, "question_id": 45956931, "link": "https://stackoverflow.com/questions/45956931/adding-a-new-row-to-an-excel-table-using-vba-when-there-are-other-tables-of-dif/45963076#45963076", "title": "Adding a new row to an Excel table using VBA, when there are other tables of different width below it", "body": "<p>If you know that the tables will maintain the same number of columns, there's an easy workaround. Just arrange the tables vertically so that the tables with more columns are above the tables with fewer columns. </p>\n\n<p>So if you have 5 tables with (for example) 3, 4, 5, 5, and 6 columns, put the table with 6 columns at the top, the two tables with 5 columns below that, the table with 4 columns below those, and the table with 3 columns at the bottom. That should fix the problem.</p>\n\n<p>Incidentally, this bug also happens when you attempt to add ListColumns to a table that's on the same sheet + to the left of another table that has more rows.</p>\n"}], "owner": {"reputation": 23, "user_id": 8400420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a34b013bcf25ccd387002d2a3aacdb9f?s=128&d=identicon&r=PG&f=1", "display_name": "macman644", "link": "https://stackoverflow.com/users/8400420/macman644"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5898, "favorite_count": 0, "accepted_answer_id": 45957751, "answer_count": 3, "score": 2, "last_activity_date": 1504103220, "creation_date": 1504085931, "question_id": 45956931, "link": "https://stackoverflow.com/questions/45956931/adding-a-new-row-to-an-excel-table-using-vba-when-there-are-other-tables-of-dif", "title": "Adding a new row to an Excel table using VBA, when there are other tables of different width below it", "body": "<p>I am trying to add a new row to a table in Excel using VBA. This is relatively simple, however if I try to use the usual \u201cActiveSheet.ListObjects(\"Table1\").ListRows.Add\u201d then I get an error that says \u201cThis won\u2019t work because it would move cells in a table on your worksheet.\u201d I understand why I\u2019m getting this error (because a new row would move the cells in such a way that the table below would fall apart). </p>\n\n<p>So, is there an elegant way to add a row to this table, preferably in such a way that an entire row is added (there is no data to worry about horizontally from the table)? I have some code I\u2019ve written that adds a whole new row, however it relies on AutoFormat being enabled and also does not seem to consistently work when I\u2019m dealing with a large number of tables (my original file has a lot more, the screenshot is just from a dummy file I made). </p>\n\n<p>The reason why I\u2019m trying to do this is that I have a few tables with a list of the same names but different horizontal lengths and trying to create a Macro that will add a new name to all the tables. I also experimented with resizing the tables but that never seemed to work very well. Please see screenshot and code below.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Sub AddName()\n\nRange(\"Table1\").EntireRow(Range(\"Table1\").Rows.Count).Select\nSelection.Offset(1, 0).Select\nSelection.EntireRow.Insert\nSelection.Offset(-1, 0).Copy Destination:=Selection\nSelection.ClearContents\nSelection.Cells(1, 1).Value = Name\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.imgur.com/a/1WGSI\" rel=\"nofollow noreferrer\">http://i.imgur.com/a/1WGSI</a></p>\n"}, {"tags": ["excel", "vba", "ms-access", "adodb", "create-table"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1504086768, "creation_date": 1504086768, "answer_id": 45957216, "question_id": 45956581, "link": "https://stackoverflow.com/questions/45956581/vba-excel-macro-to-create-access-database-and-update-field-properties-date-ti/45957216#45957216", "title": "VBA - Excel macro to create Access database and update field properties (date/time format)", "body": "<p>The format is for <em>display</em> only. A true date value is a numeric value.</p>\n\n<p>So use this:</p>\n\n<pre><code>\"SELECT * FROM [Excel 12.0;HDR=YES;DATABASE=\" &amp; flatPath &amp; \"].\" &amp; \"[\" &amp; Application.ActiveSheet.name &amp; \"$]\"\n</code></pre>\n\n<p>as source in a simple select query. Add conversion (and filtering) as needed to make sure that you have true date values for <code>[Start Date]</code>. For example, the dates may be read as text, then convert with <em>DateValue</em>:</p>\n\n<pre><code>TrueStartDate: DateValue([DateColumnFromExcel])\n</code></pre>\n\n<p>Now, save that query and use it as source when you build <code>TheSQL</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 8536935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f5617a4fe80f5312406ac12b492946?s=128&d=identicon&r=PG&f=1", "display_name": "rGabiru", "link": "https://stackoverflow.com/users/8536935/rgabiru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1821, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1504086768, "creation_date": 1504084862, "last_edit_date": 1504085140, "question_id": 45956581, "link": "https://stackoverflow.com/questions/45956581/vba-excel-macro-to-create-access-database-and-update-field-properties-date-ti", "title": "VBA - Excel macro to create Access database and update field properties (date/time format)", "body": "<p>I have an Excel macro that copies data from several Excel Worksheets to a single Access table. Everything is working well except that the data in access should be converted to <code>mmmm yyyy</code> whilst when I copy it to access, it converts always to <code>dd/mm/yyyy</code>. </p>\n\n<p>The fields are \"Start Date\" and \"End Date\".</p>\n\n<p>Here is an extract of my code:</p>\n\n<pre><code>Dim Catalog As Object\nDim cn As ADODB.connection\nDim dbPath as String, scn as String\n\ndbPath = CPTwb.Path &amp; \"\\Flatfile.accdb\"`\nscn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath &amp; \";\"\n\nSet Catalog = CreateObject(\"ADOX.Catalog\")`\nCatalog.Create scn\nSet Catalog = Nothing\nSet cn = New ADODB.connection\n\nWith cn\n    .Open scn\n    .Execute \"CREATE TABLE Flatfile ([Tracker Product] text(255) WITH \n         Compression, \" &amp; \"[Contract ID] text(255) WITH Compression, \" &amp; _\n         \"[Client] text(255) WITH Compression, \" &amp; _\n         \"[Start Date] datetime, \" &amp; \"[End Date] datetime)\"\nEnd With\n\nTheSQL = \"INSERT INTO Flatfile ([Tracker Product], [ContractID], [Client],[Start Date], [End Date])\"\nTheSQL = TheSQL &amp; \"SELECT * FROM [Excel 12.0;HDR=YES;DATABASE=\" &amp; flatPath &amp; \"].\" &amp; \"[\" &amp; Application.ActiveSheet.name &amp; \"$]\"\n\ncn.Execute TheSQL\ncn.close\n</code></pre>\n\n<p>I understand the property \"datatime\" always gets the values as system date and that it is not possible to edit via DDL. </p>\n\n<p>Is there a way to apply via VBA the property like in this screenshot below?</p>\n\n<p><a href=\"https://i.stack.imgur.com/89tHy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/89tHy.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["string", "vba", "find", "ms-word"], "comments": [{"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1504084119, "post_id": 45956118, "comment_id": 78870331, "body": "What about creating a function which takes a search string argument and the splits at 255 charachters and performs the search? You wouldn&#39;t find whole paragraphs but if the exist in that way they would still be found."}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1504084774, "post_id": 45956118, "comment_id": 78870821, "body": "I need to find whole paragraph because the final goal is to add a comment on the whole found text."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1504091482, "post_id": 45957776, "comment_id": 78875436, "body": "Nice trick! I will try to adapt it however there is an <code>runtime error 4608</code> when I run the code. Seems it&#39;s related to the -1"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1504163835, "post_id": 45957776, "comment_id": 78909411, "body": "@Stackgeek on which line do you get the RTE 4608? Is it the <code>FoundStart = ...</code> line? I have tested the code with the <code>srchTxt</code> inside a larger body of text as well as the word doc only having <code>srchTxt</code>. But I do see is that you included a space after the fullstop in the <code>srchTxt</code> string. So if you are searching the document and using just the string as the body without the the additional space at the end it will give a runtime error because of the missing space. See my modified answer which includes a bit of error handling in checking that the <code>srchTxt</code> was found"}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1504171701, "post_id": 45957776, "comment_id": 78914596, "body": "Nice @Jean-Pierre Oosthuizen , in fact the error was related to the line you stated and the new code you provide works just fine when I removed the trailing space. Thank you for the time and the effort."}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1504194236, "post_id": 45957776, "comment_id": 78930742, "body": "I&#39;ve tried to tweak the code to fit my needs but I figured out that it just doesn&#39;t do the work as I wanted it since when using a loop it just searchs in the text for a word starting with similar word in the <code>srchTxt</code> and select that text from <code>FoundStart</code> to <code>FoundEnd</code> as <code>FoundRange</code> even when the two texts are different. Do you think it would be workable to compare each word from <code>FoundStart</code> to <code>FoundEnd</code> so to validate if it&#39;s the right matching text and only then set it as <code>FoundRange</code>? What do you think about that? It&#39;s the only solution I can think of @Jean-Pierre Oosthuizen."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1504246682, "post_id": 45957776, "comment_id": 78948375, "body": "@Stackgeek try it now. I added <code>vbTextCompare</code> to the <code>InStr</code> which should then only return exact word for word matches. It will only find the first case of <code>srchTxt</code> in the document. For the Loop if will be a bit hard because the you will need to shift the starting points of the <code>DocContentRange</code> and then also in the <code>Range</code> object characters are a bit different to what you will get from using the <code>Instr</code>. What you could try is search for the maximum number of <code>Charaters</code> and then do a text compare for the next amount of <code>Characters</code>. Look at the new second part to my answer."}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1504514986, "post_id": 45957776, "comment_id": 79026655, "body": "Sorry for the feedback&#39;s late  @Jean-Pierre Oosthuizen, It&#39;s only today I&#39;m testing your last code and I&#39;m so thankfull for the time you devoted to solve this. Thank you, It just solves my problem. Now I can move foward. thank you again."}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 2, "last_activity_date": 1504246728, "last_edit_date": 1504246728, "creation_date": 1504088256, "answer_id": 45957776, "question_id": 45956118, "link": "https://stackoverflow.com/questions/45956118/search-for-more-than-255-characters-long-string-in-vba-word/45957776#45957776", "title": "Search for more than 255 characters long string in VBA WORD", "body": "<p>What you can do is use the <code>IntStr</code> function to find the start and then add the <code>srchTxt</code> string length to it to find the range in the document.</p>\n\n<p>I have included some sort of an error handle if the <code>srchTxt</code> is not found.</p>\n\n<pre><code>Option Explicit\n\nSub FindTextAndHighlight()\n\n    Dim FoundStart As Long\n    Dim FoundEnd As Long\n    Dim DocContent As String\n    Dim srchTxt As String\n    Dim srchTxtLength As Long\n    Dim FoundRange As Range\n\n    srchTxt = \"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. \"\n    srchTxtLength = Len(srchTxt)\n\n    DocContent = ActiveDocument.Content\n\n    ' using -1 to include the first character of the srchTxr found\n    FoundStart = InStr(1, DocContent, srchTxt, vbTextCompare) - 1\n\n    If FoundStart &gt; 0 Then\n        FoundEnd = FoundStart + srchTxtLength\n\n        Set FoundRange = ActiveDocument.Range(FoundStart, FoundStart + srchTxtLength)\n\n        If Not FoundRange Is Nothing Then\n            With FoundRange\n                   .Font.ColorIndex = wdRed\n                   .Font.Bold = True\n            End With\n        End If\n    Else\n\n        MsgBox \"Seach String: \" &amp; vbCr &amp; vbCr &amp; srchTxt &amp; vbCr &amp; vbCr &amp; \"Not Found!\"\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>Have the search as a loop.</p>\n\n<pre><code>Option Explicit\n\nSub FindTextAndHighlight()\n\n    Dim FoundStart As Long\n    Dim FoundEnd As Long\n    Dim DocContentSearchRange As Range\n    Dim srchTxt As String\n    Dim srchTxtLength As Long\n    Dim FoundRange As Range\n\n    srchTxtShort = \"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. \"\n    srchTxtLong = \"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. \"\n    srchTxtLength = Len(srchTxtLong)\n\n    Set DocContentSearchRange = ActiveDocument.Range\n    Set FoundRange = ActiveDocument.Range\n\n    With DocContentSearchRange.Find\n        .Text = srchTxtShort\n        .MatchCase = True\n    End With\n\n    Do While DocContentSearchRange.Find.Execute\n\n        If DocContentSearchRange.Find.Found Then\n\n            FoundRange.Start = DocContentSearchRange.Start\n            FoundRange.End = FoundRange.Start + srchTxtLength\n            FoundRange.Select\n\n            If InStr(1, FoundRange.Text, srchTxtLong, vbTextCompare) &gt; 0 Then\n\n            With FoundRange\n                   .Font.ColorIndex = wdRed\n                   .Font.Bold = True\n            End With\n\n            Else\n\n                MsgBox \"Seach String: \" &amp; vbCr &amp; vbCr &amp; srchTxtLong &amp; vbCr &amp; vbCr &amp; \"Not Found!\"\n\n            End If\n\n            DocContentSearchRange.Start = FoundRange.End\n\n        End If   'If  DocContentSearchRange.Find.Found\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "accepted_answer_id": 45957776, "answer_count": 1, "score": 1, "last_activity_date": 1504246728, "creation_date": 1504083552, "question_id": 45956118, "link": "https://stackoverflow.com/questions/45956118/search-for-more-than-255-characters-long-string-in-vba-word", "title": "Search for more than 255 characters long string in VBA WORD", "body": "<p>I have a Word document where I would like to search for a text and if found perform a certain action but I'm getting an <code>runtime error 5854</code> stating that my search string is too long. I have been searching and trying different things since yesterday but can't come up with a working code. \nI would be thankful if some of you guys could help me with this.</p>\n\n<pre><code>Sub FindTextAndHighlight()\n    Dim srchTxt As Variant\n    srchTxt = \"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. \"        \n    With ActiveDocument.Content.Find\n     .Text = srchTxt\n     .Forward = True\n     .Execute\n        If .Found = True Then\n           .Font.ColorIndex = wdRed\n           .Wrap = wdFindStop\n           .Parent.Bold = True\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504108230, "post_id": 45959926, "comment_id": 78888388, "body": "<code>activecell</code> is any cell that you happen to click on while the code is running. ... you macro will fail catastrophically unless a specific cell is selected when you run the code. you need to get rid of all the <code>select ... activecell</code> code and refer to cells by their fully qualified name"}, {"owner": {"reputation": 25, "user_id": 8536862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca5db3419b8efb9963ad1182ebac6b?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Chrabaszcz", "link": "https://stackoverflow.com/users/8536862/krzysztof-chrabaszcz"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504164816, "post_id": 45959926, "comment_id": 78910049, "body": "@jsotola You are absolutely right and in the first place I&#39;ve just put a large inscription to select a specific cell before clicking the macro but then I&#39;ve updated it with this code which is finding and selecting first empty cell in selected column(in this case column 8 which means column H) &#39; Sub EmptyCell()     Dim ws As Worksheet     Set ws = ActiveSheet     For Each cell In ws.Columns(8).Cells         If IsEmpty(cell) = True Then cell.Select: Exit For     Next cell      Call AutoCalc2 End Sub &#39;"}, {"owner": {"reputation": 25, "user_id": 8536862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca5db3419b8efb9963ad1182ebac6b?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Chrabaszcz", "link": "https://stackoverflow.com/users/8536862/krzysztof-chrabaszcz"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504165192, "post_id": 45959926, "comment_id": 78910259, "body": "Sorry, I&#39;m new here, here&#39;s the code  <code>Sub EmptyCell()     Dim ws As Worksheet     Set ws = ActiveSheet     For Each cell In ws.Columns(8).Cells         If IsEmpty(cell) = True Then cell.Select: Exit For     Next cell      Call AutoCalc2 End Sub</code>"}], "tags": [], "owner": {"reputation": 25, "user_id": 8536862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca5db3419b8efb9963ad1182ebac6b?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Chrabaszcz", "link": "https://stackoverflow.com/users/8536862/krzysztof-chrabaszcz"}, "is_accepted": false, "score": 0, "last_activity_date": 1504094561, "creation_date": 1504094561, "answer_id": 45959926, "question_id": 45956051, "link": "https://stackoverflow.com/questions/45956051/use-macro-donw-the-rows/45959926#45959926", "title": "Use macro donw the rows", "body": "<p>Found the solution, I did the code by offsets not by named cells and then looped it down until it finds an empty cell in the next row. Here's the is the code if somebody would struggle with such thing like I did. You just need to make sure before playing this macro we need to make active the first cell in the first empty column next to the data</p>\n\n<pre><code>Sub AutoCalc2()\n\nDo\nActiveCell.Offset(0, -1).Select\n\nIf IsEmpty(ActiveCell) Then\n\nExit Do\n\nElse\n\nActiveCell.Offset(0, 1).Select\nActiveCell.Offset(0, -5).Copy\n    Sheets(\"Sheet2\").Select\n        Range(\"B2\").Select\n        ActiveSheet.Paste\n        Sheets(\"Sheet1\").Select\n        'Copy 1st cell which is +5 cells to the left next to the acive\n\nActiveCell.Offset(0, -4).Copy\n    Sheets(\"Sheet2\").Select\n        Range(\"B3\").Select\n        ActiveSheet.Paste\n        Sheets(\"Sheet1\").Select\n        'Copy 2nd cell which is +4 Cells to the left next to the acive\n\nActiveCell.Offset(0, -2).Copy\n    Sheets(\"Sheet2\").Select\n        Range(\"B4\").Select\n        ActiveSheet.Paste\n        Sheets(\"Sheet1\").Select\n        'Copy 3rd cell which is +2 cells to the left next to the acive\n\nActiveCell.Offset(0, -1).Copy\n    Sheets(\"Sheet2\").Select\n        Range(\"B5\").Select\n        ActiveSheet.Paste\n        Sheets(\"Sheet1\").Select\n        'Copy 4th cell which is +1 cells to the left next to the acive\n\n     Call CalculateBoxes\n     'Call your macro\n\nSheets(\"Sheet2\").Select\nRange(\"B6\").Select\nActiveCell.Copy\nSheets(\"Sheet1\").Select\nActiveCell.PasteSpecial\nActiveCell.Offset(1, 0).Select 'selects next cell to be active so it won't make it lasts forever block on first cell\nEnd If\nLoop\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8536862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca5db3419b8efb9963ad1182ebac6b?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Chrabaszcz", "link": "https://stackoverflow.com/users/8536862/krzysztof-chrabaszcz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504094561, "creation_date": 1504083350, "question_id": 45956051, "link": "https://stackoverflow.com/questions/45956051/use-macro-donw-the-rows", "title": "Use macro donw the rows", "body": "<p>I'm having a problem with setting up a macro. Let me try to explain:\nI've got two sheets, in sheet1 I've got pure data, in sheet2 I've got a macro that calculates how many pieces you can put into a certain container by using dimensions given in certain cells. As I said I've got a pure data in sheet1 which contains a box number, its width, length a container number its going to be packed and that container's width and length. Now what I want is I want the macro to copy the dims from sheet1, put them in the specific cells in sheet2, run the calculating macro, copy the cell with result, paste it in the sheet1 and carry on with the next row until there's no data in the column next to it.</p>\n\n<p>This what I've got so far but I don't know how to loop it for the next rows. I think there might be something with selecting cells that will make this possible rather then specifying the cells by name. Any help will be much appreciated.</p>\n\n<pre><code>Sub AutoCalculating()\n\n    Sheets(\"Sheet1\").Select\n    Range(\"A2\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"B2\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"B2\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"B3\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"D2\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"B4\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet1\").Select\n    Range(\"E2\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    Range(\"B5\").Select\n    ActiveSheet.Paste\n\n\n    Call CalculateBoxes\n\n\n    Range(\"B6\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"F2\").Select\n    ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 257, "user_id": 3092948, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/60bbd96ddbe583c0dbb6361328e19666?s=128&d=identicon&r=PG&f=1", "display_name": "Zeretil", "link": "https://stackoverflow.com/users/3092948/zeretil"}, "is_accepted": false, "score": 0, "last_activity_date": 1504083755, "creation_date": 1504083755, "answer_id": 45956183, "question_id": 45955869, "link": "https://stackoverflow.com/questions/45955869/if-i-copy-an-excel-document-with-procedures-scheduled-via-application-ontime-is/45956183#45956183", "title": "If I copy an Excel document with procedures scheduled via Application.OnTime, is the schedule copied to the new document?", "body": "<p>So because I am a very impatient man I decided to test it myself.</p>\n\n<p>Here is the code I used:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VrviU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VrviU.png\" alt=\"Testcode\"></a></p>\n\n<p>While the \"test\" procedure was being executed correctly every 20 seconds, I copied and opened the copy of the workbook.\n<a href=\"https://i.stack.imgur.com/eVPPm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eVPPm.png\" alt=\"Workbooks\"></a></p>\n\n<p>The schedule did in fact not get copied, so copying and replacing your document seems like the easiest solution to getting rid of OnTime events. Renaming your document to the original name does not cause the schedule to run on the copied document.</p>\n"}, {"comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1504085247, "post_id": 45956322, "comment_id": 78871140, "body": "@YowE3K Yes you&#39;re absolutely right. Amended the code snippet accordingly."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504085600, "post_id": 45956322, "comment_id": 78871380, "body": "@YowE3K Although that would be good practice, it&#39;s out of scope for a minimal example of &quot;How do I cancel a schedule&quot; and thus doesn&#39;t have to be included in the answer."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504086175, "post_id": 45956322, "comment_id": 78871809, "body": "BTW - I am going to do a test tomorrow (if I remember) - I know that Excel will force the workbook to be re-opened if the user has closed it and it is now time to run the macro, but I&#39;m not sure whether Excel will suppress running the <code>Workbook_Open</code> event in that case.  If it <b>does</b> run it, we could end up with multiple scheduled events if the <code>Open</code> also  schedules an event.  (Things always get interesting when you stop using linear code flow!)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504087077, "post_id": 45956322, "comment_id": 78872443, "body": "The schedule is in the application scope. If you close the app it won&#39;t run. If you close only the workbook it will reopen it to run the procedure."}, {"owner": {"reputation": 257, "user_id": 3092948, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/60bbd96ddbe583c0dbb6361328e19666?s=128&d=identicon&r=PG&f=1", "display_name": "Zeretil", "link": "https://stackoverflow.com/users/3092948/zeretil"}, "edited": false, "score": 0, "creation_date": 1504090207, "post_id": 45956322, "comment_id": 78874507, "body": "I was going to ask this but can only confirm that what @RikSportel says is correct. It will reopen the workbook when Excel is still running, but when the Excel process is stopped the workbook will not open. I did not know this also means the ontime events are canceled. This helps me greatly during testing!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1504123134, "post_id": 45956322, "comment_id": 78896654, "body": "I did my test and the answer is that, yes, the <code>Workbook_Open</code> <b>is</b> executed when the workbook is reopened to execute the macro.  That means that, if the <code>Workbook_Open</code> code is set up to start the schedule and then the workbook is closed/auto-reopened, you will have two instances of the event running (and three if you close the workbook again, etc), so including the initiation of the scheduled task in <code>Workbook_Open</code> is potentially dangerous if there is any chance that the workbook will be closed before the scheduled task is cancelled.  (This assumes the invoked macro reschedules itself.)"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 2, "last_activity_date": 1504087125, "last_edit_date": 1504087125, "creation_date": 1504084122, "answer_id": 45956322, "question_id": 45955869, "link": "https://stackoverflow.com/questions/45955869/if-i-copy-an-excel-document-with-procedures-scheduled-via-application-ontime-is/45956322#45956322", "title": "If I copy an Excel document with procedures scheduled via Application.OnTime, is the schedule copied to the new document?", "body": "<p>With <code>Application.OnTime</code> you'll schedule procedures within the scope of the current Application object. E.g. if you close it, all active schedules will be cancelled.</p>\n\n<p>It might be that the scheduled runs are set in a <code>Workbook_Open</code> event or something similar - In that case the schedule will be reinstated as soon as you open the (copied or original) document.</p>\n\n<p>As implied by Zeretil his answer: the schedule will refer to the workbook's procedure when the schedule was created. When you copy and open the workbook, this will not change and the procedure in the copy will of course not run.\nIf you close the application with the original workbook, the schedule will also stop running.</p>\n\n<p>Last but not least: There is an easy way to cancel the schedule in the current workbook, by using the <code>Schedule</code> parameter of the <code>OnTime</code> method:\nTo cancel the schedule for procedure \"test\":</p>\n\n<p><strong>Edit: Included schedule at variable time + cancel at the set time</strong></p>\n\n<pre><code>Sub RunTestOnTime()\nDim eTime as Variant\neTime = Now() + TimeValue(\"00:00:20\") 'Store the time in a variable\n\nApplication.Ontime EarliestTime:=eTime, Procedure:=\"test\" 'Schedule it\nApplication.OnTime EarliestTime:=eTime, Procedure:=\"test\", Schedule:=False 'Delete schedule.\nEnd Sub\n</code></pre>\n\n<p>Complete documentation on the <code>OnTime</code> method <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-ontime-method-excel\" rel=\"nofollow noreferrer\">here on MSDN</a></p>\n"}], "owner": {"reputation": 257, "user_id": 3092948, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/60bbd96ddbe583c0dbb6361328e19666?s=128&d=identicon&r=PG&f=1", "display_name": "Zeretil", "link": "https://stackoverflow.com/users/3092948/zeretil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 45956322, "answer_count": 2, "score": 0, "last_activity_date": 1504087125, "creation_date": 1504082739, "last_edit_date": 1531161705, "question_id": 45955869, "link": "https://stackoverflow.com/questions/45955869/if-i-copy-an-excel-document-with-procedures-scheduled-via-application-ontime-is", "title": "If I copy an Excel document with procedures scheduled via Application.OnTime, is the schedule copied to the new document?", "body": "<p>It's a very simple question, but I can't find an answer to it anywhere.</p>\n\n<p>Maybe some more information is necessary. I have a workbook with some procedures schedules in the future.</p>\n\n<p>Now I know there is no easy way to get rid of the schedules, so I wonder if I were to copy the document, would the schedule be copied too?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1504083259, "post_id": 45955832, "comment_id": 78869763, "body": "Did you atempt to do something already? If so, post your code. Try using <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> this Sub will occur every time data in Worksheet is changed."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1504083424, "post_id": 45955832, "comment_id": 78869866, "body": "You say conditional formatting has a problem for this case but it should be able to do exactly what you need given proper usage."}, {"owner": {"reputation": 139, "user_id": 5870693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/69b65bd8ca76bd9c52cb05e175a2e22d?s=128&d=identicon&r=PG&f=1", "display_name": "Phyo Htet Hlaing", "link": "https://stackoverflow.com/users/5870693/phyo-htet-hlaing"}, "edited": false, "score": 0, "creation_date": 1504083579, "post_id": 45955832, "comment_id": 78869967, "body": "<code>Sub RowFormat() Dim A As Range For Each A In Range(&quot;A1:A&quot; &amp; Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row) If Not IsError(A) Then     If A.Value = &quot;Yes&quot; Then         Range(&quot;B&quot; &amp; C.Row &amp; &quot;:BB&quot; &amp; C.Row).Interior.ColorIndex = 6     Else         Range(&quot;B&quot; &amp; C.Row &amp; &quot;:BB&quot; &amp; C.Row).Interior.ColorIndex = xlNone     End If End If Next A End Sub</code>"}, {"owner": {"reputation": 139, "user_id": 5870693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/69b65bd8ca76bd9c52cb05e175a2e22d?s=128&d=identicon&r=PG&f=1", "display_name": "Phyo Htet Hlaing", "link": "https://stackoverflow.com/users/5870693/phyo-htet-hlaing"}, "edited": false, "score": 0, "creation_date": 1504083791, "post_id": 45955832, "comment_id": 78870085, "body": "Hi Zerk, I tried with Conditional Formatting. By not really ok for me. If you have any suggestion pls!"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 5870693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/69b65bd8ca76bd9c52cb05e175a2e22d?s=128&d=identicon&r=PG&f=1", "display_name": "Phyo Htet Hlaing", "link": "https://stackoverflow.com/users/5870693/phyo-htet-hlaing"}, "edited": false, "score": 0, "creation_date": 1504084625, "post_id": 45956257, "comment_id": 78870710, "body": "I changed  <code>Sub RowFormat()</code> to <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> and it&#39;s work. Thank @Mrig"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 139, "user_id": 5870693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/69b65bd8ca76bd9c52cb05e175a2e22d?s=128&d=identicon&r=PG&f=1", "display_name": "Phyo Htet Hlaing", "link": "https://stackoverflow.com/users/5870693/phyo-htet-hlaing"}, "edited": false, "score": 0, "creation_date": 1504085122, "post_id": 45956257, "comment_id": 78871056, "body": "@PhyoHtetHlaing - See edit in answer. For <code>Worksheet_Change</code> you can check only for the cell changed and not the whole range."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1504085109, "last_edit_date": 1504085109, "creation_date": 1504083969, "answer_id": 45956257, "question_id": 45955832, "link": "https://stackoverflow.com/questions/45955832/how-to-change-background-color-of-cell-based-on-other-cell-value-by-vba/45956257#45956257", "title": "How to change background color of cell based on other cell value by VBA", "body": "<p>Made some changes in your code.</p>\n\n<pre><code>Sub RowFormat()\n    Dim A As Range\n    For Each A In Range(\"A1:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n        If Not IsError(A) Then\n            If A.Value = \"Yes\" Then\n                A.Offset(0, 1).Interior.ColorIndex = 6\n            ElseIf A.Value = \"No\" Then\n                A.Offset(0, 1).Interior.ColorIndex = 3\n            Else\n                A.Offset(0, 1).Interior.ColorIndex = xlNone\n            End If\n        End If\n    Next A\nEnd Sub\n</code></pre>\n\n<p>Using Conditional Formatting.</p>\n\n<p>For \"Yes\" use <code>=A1=\"Yes\"</code>,<br>\nfor \"No\" use <code>=A1=\"No\"</code> and format apply formatting accordingly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rkASK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rkASK.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>EDIT :</em></strong> </p>\n\n<p>If you are using <strong>Worksheet_Change</strong>  event then use below code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"A:A\")) Is Nothing Then Exit Sub 'check for range\n    If Target.Value = \"Yes\" Then 'check if yes\n        Target.Offset(0, 1).Interior.ColorIndex = 6\n    ElseIf Target.Value = \"No\" Then 'check if no\n        Target.Offset(0, 1).Interior.ColorIndex = 3\n    Else\n        Target.Offset(0, 1).Interior.ColorIndex = xlNone\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 767, "user_id": 8411349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hdm06.jpg?s=128&g=1", "display_name": "PeterH", "link": "https://stackoverflow.com/users/8411349/peterh"}, "is_accepted": false, "score": 0, "last_activity_date": 1504084123, "creation_date": 1504084123, "answer_id": 45956324, "question_id": 45955832, "link": "https://stackoverflow.com/questions/45955832/how-to-change-background-color-of-cell-based-on-other-cell-value-by-vba/45956324#45956324", "title": "How to change background color of cell based on other cell value by VBA", "body": "<p>To use conditional formatting</p>\n\n<p>Select Column B,\nClick Conditional Format > </p>\n\n<p>Highlight Cells Rules > </p>\n\n<p>Equal Too > Type \"Yes\"</p>\n\n<p>On the drop down to the right select Custom, </p>\n\n<p>choose your formatting,</p>\n\n<p>Repeat the process again for \"No\"</p>\n\n<p>There will be many easier to follow methods shown with a quick google search...</p>\n"}], "owner": {"reputation": 139, "user_id": 5870693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/69b65bd8ca76bd9c52cb05e175a2e22d?s=128&d=identicon&r=PG&f=1", "display_name": "Phyo Htet Hlaing", "link": "https://stackoverflow.com/users/5870693/phyo-htet-hlaing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5825, "favorite_count": 0, "accepted_answer_id": 45956257, "answer_count": 2, "score": 2, "last_activity_date": 1504085109, "creation_date": 1504082636, "last_edit_date": 1531161705, "question_id": 45955832, "link": "https://stackoverflow.com/questions/45955832/how-to-change-background-color-of-cell-based-on-other-cell-value-by-vba", "title": "How to change background color of cell based on other cell value by VBA", "body": "<p>I have two columns A and B in an excel sheet.\nA column is the drop down list that contains \"Yes\" and \"No\".\nAnd I would like to change the color of B cell that base on text value of A cell from drop down list.\nFor example, if I select \"Yes\" in A1 cell than the B1 cell should show Green color. A2, A3... etc.</p>\n\n<p>I am not a programmer so I am really noob at VBA coading. Conditional Formation also have a problem for this case.</p>\n\n<p>If anyone have an answer for this, That would be my pleasure.</p>\n"}, {"tags": ["excel", "vba", "icons"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8543735, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/42280fea64131b275ce2fe2dc039a3e3?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/8543735/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1504188086, "creation_date": 1504188086, "answer_id": 45983362, "question_id": 45955560, "link": "https://stackoverflow.com/questions/45955560/vba-editor-icons-vanish-when-hover-over-them/45983362#45983362", "title": "VBA Editor Icons Vanish when hover over them", "body": "<p>Have the same issue.</p>\n\n<p>Apparently this was caused by Windows Update KB4034664</p>\n\n<p>Just found out there is a fix.\nThe problem is listed as a Windows problem on dual monitor setup's where the main monitor is not top left (my setup).\nThe patch is KB4039884.</p>\n\n<p>REF: <a href=\"http://www.utteraccess.com/forum/index.php?showtopic=2044983\" rel=\"nofollow noreferrer\">http://www.utteraccess.com/forum/index.php?showtopic=2044983</a></p>\n"}], "owner": {"reputation": 3, "user_id": 5629223, "user_type": "registered", "profile_image": "https://graph.facebook.com/734203083377283/picture?type=large", "display_name": "Gregor Grimschitz", "link": "https://stackoverflow.com/users/5629223/gregor-grimschitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504188086, "creation_date": 1504081814, "last_edit_date": 1504085822, "question_id": 45955560, "link": "https://stackoverflow.com/questions/45955560/vba-editor-icons-vanish-when-hover-over-them", "title": "VBA Editor Icons Vanish when hover over them", "body": "<p>When I hover over the Toolbaricons in Excel VBA Editor, they are vanishing (See Pic).</p>\n\n<p><img src=\"https://i.stack.imgur.com/V2nXZ.png\" alt=\"Pic where Icons are vanished\"></p>\n\n<p>Any idea how to fix this?</p>\n\n<p>I tried:</p>\n\n<ul>\n<li>Closing and Opening the VBA Editor, Excel</li>\n<li>Open an empty workbook,</li>\n<li>Restart the PC</li>\n</ul>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1504084582, "post_id": 45955502, "comment_id": 78870676, "body": "First, be sure you have index on <i>ARPNR</i> and <i>&#196;nderungsdatum</i> in all tables. It could be a two-field (compound) index."}, {"owner": {"reputation": 53, "user_id": 5108202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a45157f296f7ed0c82ef769e629e84?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Menzel", "link": "https://stackoverflow.com/users/5108202/nicholas-menzel"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1504084961, "post_id": 45955502, "comment_id": 78870954, "body": "The compound index would have to be BTNR, ARPNR and &#196;nderungsdatum though, because ARPNR is a file with multiple BTNR in it and only one &#196;nderungsdatum. @Gustav But how would this increase performance?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1504087698, "post_id": 45955502, "comment_id": 78872828, "body": "You should <i>only</i> include fields you search. If BTNR must be included, add a parameter for that as well. Index is a key factor for speedy searching; if left out, a search will have to read the full table."}, {"owner": {"reputation": 53, "user_id": 5108202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a45157f296f7ed0c82ef769e629e84?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Menzel", "link": "https://stackoverflow.com/users/5108202/nicholas-menzel"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1504095899, "post_id": 45955502, "comment_id": 78878736, "body": "@Gustav Thank you, that is already somewhat faster."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1504105624, "post_id": 45955502, "comment_id": 78886624, "body": "Include some sample data in the question, clearly marking the ones that should be deleted. This can probably be achieved in three queries (one per table) instead of one delete query per duplicate, and will execute several times as fast if you do it that way."}, {"owner": {"reputation": 53, "user_id": 5108202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a45157f296f7ed0c82ef769e629e84?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Menzel", "link": "https://stackoverflow.com/users/5108202/nicholas-menzel"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504165206, "post_id": 45955502, "comment_id": 78910262, "body": "@ErikvonAsmuth I can query the non unique data in each table, but how would I check that they are not the newest version of that data and only delete all except the newest for each set of multiple data."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504166242, "post_id": 45955502, "comment_id": 78910926, "body": "Just use a subquery selecting only the newest, and then use a <code>NOT IN</code> clause. But as said, if you provide table structures, I can show you. I&#39;m assuming the tables do have a unique identifier."}, {"owner": {"reputation": 53, "user_id": 5108202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a45157f296f7ed0c82ef769e629e84?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Menzel", "link": "https://stackoverflow.com/users/5108202/nicholas-menzel"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1504256847, "post_id": 45955502, "comment_id": 78953478, "body": "@ErikvonAsmuth I have added the Table structure and an SQL query I tried, but unfortunately it doesn&#39;t work."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1504257576, "post_id": 45955502, "comment_id": 78953926, "body": "Your inner subquery should also have an alias for <code>ARPs</code> and use it for all fields you use from that table."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1504257815, "post_id": 45955502, "comment_id": 78954059, "body": "Try executing your inner subquery first, to test for errors, and specify the <code>JOIN</code> as <code>INNER JOIN</code> (and also, what @Andre said). Furthermore, remove <code>WHERE A1.BTNR = A.BTNR                             AND A1.ARPNR = A.ARPNR </code> from your subquery, and join on them, since they&#39;re out of scope in your subquery."}], "owner": {"reputation": 53, "user_id": 5108202, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/86a45157f296f7ed0c82ef769e629e84?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Menzel", "link": "https://stackoverflow.com/users/5108202/nicholas-menzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1594639190, "creation_date": 1504081627, "last_edit_date": 1594639190, "question_id": 45955502, "link": "https://stackoverflow.com/questions/45955502/optimise-deletion-of-non-unique-records-in-access", "title": "Optimise deletion of non unique records in Access", "body": "<p>I am creating a Recordset with all of the entries that appear multiple times and then go through each element in this RS and delete all older entries.\nOnly entries that are non unique on BTNR and ARPNR should be deleted.\nI also don't want to delete the newest of the multiple records.\nDoes anybody know how I could make this faster, because it takes a very long time as it has to regularly run through 600+ records. I am very new to VBA and SQL, so there is probably a better way to do this. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub DeleteMult()\nDim allMult As DAO.Recordset\nDim strSQL As String\n\nstrSQL = \"SELECT ARPs.ARPNR, ARPs.\u00c4nderungsdatum FROM ARPs WHERE ARPs.BTNR IN (SELECT BTNR FROM ARPs GROUP BY BTNR HAVING COUNT(BTNR) &gt; 1);\"\n\nSet allMult = CurrentDb.OpenRecordset(strSQL)\n\nWith allMult\n\n    'Check that RecordSet isn't empty\n    If Not .BOF And Not .EOF Then\n\n        .MoveLast\n        .MoveFirst\n\n        'Loop to the end of the RecordSet\n        While (Not allMult.EOF)\n            'Delete all multiple entries except the newest\n            With CurrentDb.CreateQueryDef(\"\", _\n                \"DELETE FROM ARPs WHERE ARPNR = prm0 AND \u00c4nderungsdatum &lt; prm1\")\n                .Parameters(\"prm0\") = allMult.Fields(\"ARPNR\")\n                .Parameters(\"prm1\") = allMult.Fields(\"\u00c4nderungsdatum\")\n                .Execute\n                .Close\n            End With\n\n            With CurrentDb.CreateQueryDef(\"\", _\n                \"DELETE FROM KoGr WHERE ARPNR = prm0 AND \u00c4nderungsdatum &lt; prm1\")\n                .Parameters(\"prm0\") = allMult.Fields(\"ARPNR\")\n                .Parameters(\"prm1\") = allMult.Fields(\"\u00c4nderungsdatum\")\n                .Execute\n                .Close\n            End With\n\n            With CurrentDb.CreateQueryDef(\"\", _\n                \"DELETE FROM SA WHERE ARPNR = prm0 AND \u00c4nderungsdatum &lt; prm1\")\n                .Parameters(\"prm0\") = allMult.Fields(\"ARPNR\")\n                .Parameters(\"prm1\") = allMult.Fields(\"\u00c4nderungsdatum\")\n                .Execute\n                .Close\n            End With\n\n            .MoveNext\n        Wend\n\n    End If\n\n    .Close\nEnd With\n\n'empty Memory\nSet allMult = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This is a sample Dataset. Data marked read should be deleted. Of course there are usually ~60 KoGr and SA for each BTNR. If the newest ARPNR has more than 1 BTNR in it all of them should be kept.\n<a href=\"https://i.stack.imgur.com/nEAff.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nEAff.png\" alt=\"This is a sample Dataset. Data marked read should be deleted. Of course there are usually ~60 KoGr and SA for each BTNR. If the newest ARPNR has more than 1 BTNR in it all of them should be kept.\"></a></p>\n\n<p>I have now tried An SQL statement as I stumbled over the MAX() functionality.</p>\n\n<pre><code>strSQL = \"Delete A \n          FROM ARPs AS A \n               JOIN (SELECT BTNR, ARPNR, \u00c4nderungsdatum \n                     FROM ARPs AS A1 \n                     WHERE A1.BTNR = A.BTNR \n                           AND A1.ARPNR = A.ARPNR \n                           AND A1.\u00c4nderungsdatum &lt;&gt; (SELECT MAX(\u00c4nderungsdatum) \n                                                     FROM ARPs \n                                                     WHERE BTNR = A1.BTNR \n                                                           AND ARPNR = A1.ARPNR)) AS R \n               ON R.ARPNR = A.ARPNR \n                  AND R.\u00c4nderungsdatum = T.\u00c4nderungdatum;\"\n</code></pre>\n\n<p>But it returns an Error in the FROM clause. </p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504081334, "post_id": 45955240, "comment_id": 78868657, "body": "If I am understanding the question correctly, you want to copy the code which you are currently doing for <code>Worksheets(&quot;MasterData&quot;)</code> and do it again for <code>Worksheets(&quot;X&quot;)</code>, <code>Worksheets(&quot;A&quot;)</code> and <code>Worksheets(&quot;C&quot;)</code>.  Is that correct?"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504081551, "post_id": 45955240, "comment_id": 78868785, "body": "Yes, assuming that the reference is on sheet x or a or c... I have a data entry userform which will qualify the data into 16 difference scenarios and tell it to which of the 4 sheets it needs to go in. sometimes its 2 of the 4 sometimes its 3 of the 4. It will ALWAYS go in the master data"}], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": true, "score": 1, "last_activity_date": 1504081579, "creation_date": 1504081579, "answer_id": 45955486, "question_id": 45955240, "link": "https://stackoverflow.com/questions/45955240/updating-multiple-sheets-with-a-userform/45955486#45955486", "title": "Updating multiple sheets with a userform", "body": "<p>Rather than dimming each sheet, what about just creating a collection for them, using a generic worksheet object, and iterating through the collection? see below.</p>\n\n<pre><code>Private Sub Update_Click()\n\nDim searchRange As Range\nDim foundCell As Range\nDim mysearch As String\nDim ws As Worksheet\nDim sheetCollection As Collection\nSet sheetCollection = New Collection\nWith sheetCollection\n    .Add Worksheets(\"MasterData\"), Worksheets(\"MasterData\").Name\n    .Add Worksheets(\"X\"), Worksheets(\"X\").Name\n    .Add Worksheets(\"A\"), Worksheets(\"A\").Name\n    .Add Worksheets(\"C\"), Worksheets(\"C\").Name\nEnd With\n\nmysearch = Me.Search.Value\n\nFor Each ws In sheetCollection\n    With ws\n        Set searchRange = .Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n    End With\n    Set foundCell = searchRange.Find(what:=mysearch, Lookat:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not foundCell Is Nothing Then\n            foundCell.Offset(0, 11).Value = Me.RD.Value\n            foundCell.Offset(0, 17).Value = Me.DD.Value\n            foundCell.Offset(0, 12).Value = Me.PD.Value\n            foundCell.Offset(0, 13).Value = Me.NP.Value\n            foundCell.Offset(0, 14).Value = Me.Brd.Value\n            foundCell.Offset(0, 15).Value = Me.Com.Value\n            foundCell.Offset(0, 25).Value = Me.Dt.Value\n            foundCell.Offset(0, 20).Value = Me.PrGp.Value\n            foundCell.Offset(0, 21).Value = Me.Iss.Value\n            foundCell.Offset(0, 7).Value = Me.CVal.Value\n            foundCell.Offset(0, 22).Value = Me.Un.Value\n            foundCell.Offset(0, 23).Value = Me.Wt.Value\n            foundCell.Offset(0, 24).Value = Me.Invd.Value\n            foundCell.Offset(0, 26).Value = Me.Sh.Value\n            foundCell.Offset(0, 19).Value = Me.FS.Value\n            foundCell.Offset(0, 18).Value = Me.Ln.Value\n            foundCell.Offset(0, 16).Value = Me.Add.Value\n    Else\n         MsgBox \"ID(\" &amp; mysearch &amp; \") does not exist in \" &amp; ws.name\n    End If\nNext ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "accepted_answer_id": 45955486, "answer_count": 1, "score": 0, "last_activity_date": 1504081579, "creation_date": 1504080755, "last_edit_date": 1504081047, "question_id": 45955240, "link": "https://stackoverflow.com/questions/45955240/updating-multiple-sheets-with-a-userform", "title": "Updating multiple sheets with a userform", "body": "<p>I have created a userform which searched a reference number and then populates the userform fields with entries on the line of that reference number in a \"Mastersheet\". The thing is that reference may actually be on 3 sheets with the same information and what I am wanting to do, is when I update the information pulled onto the userform to update all 3 sheets. Can you please assist?</p>\n\n<pre><code>Private Sub Update_Click()\n\nDim searchRange As Range\nDim foundCell As Range\nDim mysearch As String\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim ws4 As Worksheet\n\nSet ws1 = Worksheets(\"MasterData\")\nSet ws2 = Worksheets(\"X\")\nSet ws3 = Worksheets(\"A\")\nSet ws4 = Worksheets(\"C\")\n\nmysearch = Me.Search.Value\n\n    With ThisWorkbook.Sheets(\"MasterData\")\n        Set searchRange = .Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n    End With\n\nSet foundCell = searchRange.Find(what:=mysearch, Lookat:=xlWhole, MatchCase:=False, SearchFormat:=False)\n    If Not foundCell Is Nothing Then\n            foundCell.Offset(0, 11).Value = Me.RD.Value\n            foundCell.Offset(0, 17).Value = Me.DD.Value\n            foundCell.Offset(0, 12).Value = Me.PD.Value\n            foundCell.Offset(0, 13).Value = Me.NP.Value\n            foundCell.Offset(0, 14).Value = Me.Brd.Value\n            foundCell.Offset(0, 15).Value = Me.Com.Value\n            foundCell.Offset(0, 25).Value = Me.Dt.Value\n            foundCell.Offset(0, 20).Value = Me.PrGp.Value\n            foundCell.Offset(0, 21).Value = Me.Iss.Value\n            foundCell.Offset(0, 7).Value = Me.CVal.Value\n            foundCell.Offset(0, 22).Value = Me.Un.Value\n            foundCell.Offset(0, 23).Value = Me.Wt.Value\n            foundCell.Offset(0, 24).Value = Me.Invd.Value\n            foundCell.Offset(0, 26).Value = Me.Sh.Value\n            foundCell.Offset(0, 19).Value = Me.FS.Value\n            foundCell.Offset(0, 18).Value = Me.LN.Value\n            foundCell.Offset(0, 16).Value = Me.Add.Value\n\n    Else\n\n         MsgBox \"ID does not exist.\"\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504080921, "post_id": 45955183, "comment_id": 78868393, "body": "well, it&#39;s not B and it&#39;s not VL and it&#39;s not VP. .... your code says &quot;out of scope&quot; in that instance ..... what were you expecting?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 1, "creation_date": 1504081388, "post_id": 45955183, "comment_id": 78868695, "body": "If I am not wrong <code>Left(&quot;Z&quot; &amp; i, 1)</code> should be <code>Left(Range(&quot;A&quot; &amp; i), 1)</code> and likewise <code>Left(Range(&quot;Z&quot; &amp; i), 2)</code>."}, {"owner": {"reputation": 11, "user_id": 8536640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4091cf692a0db4a8045ae3c42aec114d?s=128&d=identicon&r=PG&f=1", "display_name": "Kasia", "link": "https://stackoverflow.com/users/8536640/kasia"}, "edited": false, "score": 0, "creation_date": 1504082999, "post_id": 45955183, "comment_id": 78869599, "body": "Hi Jsotola, the problem was that even if it was for example &quot;VP&quot; the macro still assigned &quot;out of scope&quot;. But its solved now :)"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504106017, "post_id": 45955183, "comment_id": 78886926, "body": "that is not what you said in your question"}], "owner": {"reputation": 11, "user_id": 8536640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4091cf692a0db4a8045ae3c42aec114d?s=128&d=identicon&r=PG&f=1", "display_name": "Kasia", "link": "https://stackoverflow.com/users/8536640/kasia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504081753, "creation_date": 1504080584, "question_id": 45955183, "link": "https://stackoverflow.com/questions/45955183/vba-excel-if-clause-excluding-values", "title": "VBA EXCEL - If clause excluding values", "body": "<p>I have the following code:</p>\n\n<pre><code>If Left(\"Z\" &amp; i, 1) &lt;&gt; \"B\" Then\nIf (Left(\"Z\" &amp; i, 2) &lt;&gt; \"VL\") And (Left(\"Z\" &amp; i, 2) &lt;&gt; \"VP\") Then\n    Range(\"AX\" &amp; i).Value = \"out of scope\"\n    Else\n    Range(\"AX\" &amp; i).Value = \"needs  checking\"\n    End If\nEnd If\nNext I\n</code></pre>\n\n<p>For some reason for values different than B, VL and VP the macro is assigning \"out of scope\" text instead of \"needs checking\". Why is that? What can be the solution?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1504080667, "post_id": 45955113, "comment_id": 78868252, "body": "Excuse me for saying, but what exactly are you trying to do here ? can you explain ? Because your code and the way you tru to use the <code>Find</code> function is full with run-time errors, and too much use of <code>Activate</code>, <code>Select</code> etc..."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504084539, "post_id": 45955113, "comment_id": 78870649, "body": "The error you&#39;re getting is due to the <code>.Activate</code> - The <code>Find</code> doesn&#39;t return anything so there&#39;s no object and when trying to activate it obviously crashes. Other than that: What @ShaiRado says... It&#39;s quite unclear what you&#39;re trying to achieve."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1504084694, "post_id": 45955113, "comment_id": 78870765, "body": "From what I can see he counts non-blank cells that contain date data."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1504084888, "post_id": 45955113, "comment_id": 78870900, "body": "Few more questions: Why do you calculate last row and column? From what I can see your table is within <code>.CurrentRegion</code>. Do you use <code>.Find</code> to activate next cell in a table? In every iteration you <code>Set cl = MyRange</code> though <b>MyRange</b> doesnt change. When check for <code>Value</code> in nested <code>If</code> you check whole table&#39;s value, not of the ActiveCell"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1504085264, "post_id": 45955113, "comment_id": 78871153, "body": "Edit your question and describe what you are trying to do, this way someone (me, for example) might offer another way of solving a problem."}, {"owner": {"reputation": 1, "user_id": 8536676, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_QzK3j1Le18/AAAAAAAAAAI/AAAAAAAAAZ0/U2WMiQch_hU/photo.jpg?sz=128", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/8536676/santhosh"}, "edited": false, "score": 0, "creation_date": 1504086493, "post_id": 45955113, "comment_id": 78872020, "body": "Am unable to edit the question. Actually I am trying to get last column and row to find out the N number of cell used.  Should I remove Activate, If I remove it, it throws an error."}, {"owner": {"reputation": 1, "user_id": 8536676, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_QzK3j1Le18/AAAAAAAAAAI/AAAAAAAAAZ0/U2WMiQch_hU/photo.jpg?sz=128", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/8536676/santhosh"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1504091235, "post_id": 45955113, "comment_id": 78875270, "body": "@Shai Rado and AntiDrondert... Edited the question, please check and answer."}], "owner": {"reputation": 1, "user_id": 8536676, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_QzK3j1Le18/AAAAAAAAAAI/AAAAAAAAAZ0/U2WMiQch_hU/photo.jpg?sz=128", "display_name": "Santhosh", "link": "https://stackoverflow.com/users/8536676/santhosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504087065, "creation_date": 1504080398, "last_edit_date": 1531164843, "question_id": 45955113, "link": "https://stackoverflow.com/questions/45955113/getting-object-variable-or-with-block-variable-not-set-in-excel-vba", "title": "Getting &quot;object variable or with block variable not set in excel vba&quot;", "body": "<pre><code>Sheets(\"Translator 2 Weeks\").Select\ntoday = Date - 15\nDim MyRange As Range, cl As Range\nSet MyRange = Range(\"a2\").CurrentRegion\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\nlCol = Cells(1, Columns.Count).End(xlToLeft).Column\nlCol = lCol + 1\n\nFor Each cl In MyRange\n\n If ActiveCell.Column &lt;= lCol Then\n If ActiveCell.Row &lt;= lRow Then\n\nCells.Find(What:=\"*\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=True).Activate\n\n\n    If cl.Value &lt;&gt; Empty And IsDate(cl.Value) Then\n    N = N + 1\n    End If\n\nEnd If\n\nEnd If\nNext cl\n</code></pre>\n\n<p>Getting error at line \"Cells.Find()\" Please help...\nI am trying to find out the N number of cells used and only cells populated with date.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1504079245, "post_id": 45954606, "comment_id": 78867339, "body": "Maybe this is what your trying to do? - <a href=\"https://stackoverflow.com/a/36672957/4539709\">stackoverflow.com/a/36672957/4539709</a>"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504079521, "post_id": 45954606, "comment_id": 78867534, "body": "<code>it does not work</code> is not a description of a problem. please be more specific"}, {"owner": {"reputation": 11, "user_id": 5461656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebafa10a2190df5e694897d665ec97e8?s=128&d=identicon&r=PG&f=1", "display_name": "mravenca", "link": "https://stackoverflow.com/users/5461656/mravenca"}, "edited": false, "score": 0, "creation_date": 1504079779, "post_id": 45954606, "comment_id": 78867678, "body": "I get error message &quot;The extract range has a missing or illegal field name&quot;."}, {"owner": {"reputation": 11, "user_id": 5461656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebafa10a2190df5e694897d665ec97e8?s=128&d=identicon&r=PG&f=1", "display_name": "mravenca", "link": "https://stackoverflow.com/users/5461656/mravenca"}, "edited": false, "score": 0, "creation_date": 1504085032, "post_id": 45954606, "comment_id": 78871001, "body": "I think that the error is in CopyToRange:=Workbooks(&quot;E-17-0308_Ubersicht&quot;).Sheets(&quot;List1&quot;&zwnj;&#8203;).Range(&quot;A3&quot;), Unique:=True . I don&#39;t know how to address the cell in another workbook correctly."}, {"owner": {"reputation": 11, "user_id": 5461656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebafa10a2190df5e694897d665ec97e8?s=128&d=identicon&r=PG&f=1", "display_name": "mravenca", "link": "https://stackoverflow.com/users/5461656/mravenca"}, "edited": false, "score": 0, "creation_date": 1504088141, "post_id": 45954606, "comment_id": 78873129, "body": "I solved this by putting the filter result to the same sheet and then making a copy from this sheet to the new file."}], "owner": {"reputation": 11, "user_id": 5461656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebafa10a2190df5e694897d665ec97e8?s=128&d=identicon&r=PG&f=1", "display_name": "mravenca", "link": "https://stackoverflow.com/users/5461656/mravenca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 937, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504080973, "creation_date": 1504078639, "last_edit_date": 1504080973, "question_id": 45954606, "link": "https://stackoverflow.com/questions/45954606/excel-vba-apply-advanced-filter-and-then-copy-data-to-another-workbook", "title": "Excel VBA - apply advanced filter and then copy data to another workbook", "body": "<p>I need to apply the advanced filter in VBA and then copy data to another workbook.</p>\n\n<p>I am trying to do this by  </p>\n\n<pre><code>ActiveSheet.Range(\"D:D\").AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Workbooks(\"E-17-0308_Ubersicht\").Sheets(\"List1\").Range(\"A3\"), Unique:=True\n</code></pre>\n\n<p>But it does not work and I probably have an error in the parameter CopyToRange.</p>\n\n<p>Can you help me?</p>\n\n<p>Thanks </p>\n\n<p>Vaclav</p>\n"}, {"tags": ["excel", "pivot", "olap", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6763656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1135cb794e4466529a38129eb0e0e360?s=128&d=identicon&r=PG&f=1", "display_name": "ScanGuard", "link": "https://stackoverflow.com/users/6763656/scanguard"}, "edited": false, "score": 0, "creation_date": 1504251490, "post_id": 45959638, "comment_id": 78950559, "body": "Hi Brandon,  Thanks for your response.  Here is the recorded code.  It errors when I try and run it.                                                                                                                      ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields( _         &quot;[Location].[Sales Region - Location].[Sales Region]&quot;).ClearAllFilters     ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields( _         &quot;[Location].[Sales Region - Location].[Sales Region]&quot;).CurrentPage = _         &quot;[Location].[Sales Region - Location].[Sales Region].&amp;[Craig]&quot;"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 1, "user_id": 6763656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1135cb794e4466529a38129eb0e0e360?s=128&d=identicon&r=PG&f=1", "display_name": "ScanGuard", "link": "https://stackoverflow.com/users/6763656/scanguard"}, "edited": false, "score": 0, "creation_date": 1504265067, "post_id": 45959638, "comment_id": 78958413, "body": "@ScanGuard Is the <code>EnableMultiplePageItems = False</code> set? Also, are you certain <code>Craig</code> is in the <code>Sales Region</code> dimension?"}, {"owner": {"reputation": 1, "user_id": 6763656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1135cb794e4466529a38129eb0e0e360?s=128&d=identicon&r=PG&f=1", "display_name": "ScanGuard", "link": "https://stackoverflow.com/users/6763656/scanguard"}, "edited": false, "score": 0, "creation_date": 1504297541, "post_id": 45959638, "comment_id": 78976002, "body": "Hi Brandon.  The code is as actually recorded, so yes, Craig is in the dimension.  The EnableMultiplePageItems check box is not ticked."}, {"owner": {"reputation": 1, "user_id": 6763656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1135cb794e4466529a38129eb0e0e360?s=128&d=identicon&r=PG&f=1", "display_name": "ScanGuard", "link": "https://stackoverflow.com/users/6763656/scanguard"}, "edited": false, "score": 0, "creation_date": 1504297561, "post_id": 45959638, "comment_id": 78976011, "body": "Hi Brandon.  The code is as actually recorded, so yes, Craig is in the dimension.  The EnableMultiplePageItems check box is not ticked."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 1, "user_id": 6763656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1135cb794e4466529a38129eb0e0e360?s=128&d=identicon&r=PG&f=1", "display_name": "ScanGuard", "link": "https://stackoverflow.com/users/6763656/scanguard"}, "edited": false, "score": 0, "creation_date": 1504366948, "post_id": 45959638, "comment_id": 78990813, "body": "@ScanGuard the <code>.CurrentPage</code> property of a <code>PageField</code> only works when the <code>.EnableMultiplePageItems</code> is first set to false. Be sure as well that you are working on a page field and not some other kind of field (such as a row field). Page fields show above the Pivot Table in the top left. I would also recommend using the immediate window and breakpoints to try getting the <code>CurrentPage</code> of the pivot table. Debugging tools will be a great help when it comes to using Macros with OLAP cubes."}, {"owner": {"reputation": 1, "user_id": 6763656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1135cb794e4466529a38129eb0e0e360?s=128&d=identicon&r=PG&f=1", "display_name": "ScanGuard", "link": "https://stackoverflow.com/users/6763656/scanguard"}, "edited": false, "score": 0, "creation_date": 1504571626, "post_id": 45959638, "comment_id": 79050876, "body": ".EnableMultiplePageItems is set to false. The dimension is a page filter.  Please advise what I should type in the immediate window to assist with debugging.     The 2nd line is highlighted in yellow when running the code      ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;[Locatio&zwnj;&#8203;n].[Sales Region - Location].[Sales Region]&quot;).ClearAllFilters     ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;[Locatio&zwnj;&#8203;n].[Sales Region - Location].[Sales Region]&quot;).CurrentPage = _         &quot;[Location].[Sales Region - Location].[Sales Region].&amp;[Craig]&quot;"}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1504093769, "creation_date": 1504093769, "answer_id": 45959638, "question_id": 45954232, "link": "https://stackoverflow.com/questions/45954232/excel-2013-recorded-macro-errors-when-changing-page-filter-on-olap-based-pivot/45959638#45959638", "title": "Excel 2013 - recorded macro errors when changing page filter on OLAP based pivot table", "body": "<p>This is too easy. Before posting an answer, I would highly recommend trying to debug your code a bit more in the future. Your problem is that you are trying to concatenate two strings, but you never close the first one. For example:</p>\n\n<pre><code>Dim Foo as String\nFoo = \"Apples\"\n\nDebug.Print \"I like Foo!\"\nDebug.Print \"I Like \" &amp; Foo &amp; \"!\"\n</code></pre>\n\n<p>Try it out, and see if you can decipher what is happening.</p>\n\n<p>Now for the solution. Same approach, minor fix:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n\"[Location].[Sales Region - Location].[Sales Region]\").CurrentPage = _\n\"[Location].[Sales Region - Location].[Sales Region].&amp;[\" &amp; SomeName &amp; \"]\"\n</code></pre>\n\n<p>Voila! To concatenate strings, you must use the variable in the same way you would use it elsewhere. That is to say, put the variable outside of the quotes, and concatenate the parts together.</p>\n\n<p>Worth noting, both of these will only work if <code>pt.EnableMultiplePageItems = False</code> and the <code>PivotField</code> is a <code>PageField</code>. Additionally, the reason why your second version doesn't work is because an <code>OLAP</code> cube doesn't recognize <code>\"some name\"</code>. It must know the entire dimension, e.g <code>\"[Foo].[Bar].[Baz].[Item]\"</code></p>\n\n<p>While I'm here, I highly recommend avoiding the <code>ActiveSheet</code> reference. That will cause you issues down the line. I recommend naming your pivot tables as well. Heck, name anything you use. It makes your code easier to read.</p>\n"}], "owner": {"reputation": 1, "user_id": 6763656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1135cb794e4466529a38129eb0e0e360?s=128&d=identicon&r=PG&f=1", "display_name": "ScanGuard", "link": "https://stackoverflow.com/users/6763656/scanguard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504267841, "creation_date": 1504077297, "last_edit_date": 1531161705, "question_id": 45954232, "link": "https://stackoverflow.com/questions/45954232/excel-2013-recorded-macro-errors-when-changing-page-filter-on-olap-based-pivot", "title": "Excel 2013 - recorded macro errors when changing page filter on OLAP based pivot table", "body": "<p>This is the recorded macro:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n    \"[Location].[Sales Region - Location].[Sales Region]\").ClearAllFilters\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields( _\n    \"[Location].[Sales Region - Location].[Sales Region]\").CurrentPage = _\n    \"[Location].[Sales Region - Location].[Sales Region].&amp;[some name]\"\n</code></pre>\n\n<p>I have changed the actual name to \"some name\" for the purposes of the post.</p>\n\n<p>I recorded that macro, then tried to run it.  I get an error:</p>\n\n<blockquote>\n  <p>Unable to set the CurrentPage property of the PivotField Class</p>\n</blockquote>\n\n<p>I have viewed other posts suggesting the use of</p>\n\n<pre><code>Dim pt As PivotTable\nDim NewRSM As String\n\nNewRSM = \"some name\"\n\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\n\nWith pt\n    .PivotFields(\"[Location].[Sales Region - Location].[Sales Region]\").ClearAllFilters\n    .PivotFields(\"[Location].[Sales Region - Location].[Sales Region]\").CurrentPage = NewRSM\nEnd With\n\npt.RefreshTable\n</code></pre>\n\n<p>This also fails.</p>\n"}, {"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 954, "user_id": 3898606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f8b8ea74a1d7fde222a1863b571b71?s=128&d=identicon&r=PG&f=1", "display_name": "oracle certified professional", "link": "https://stackoverflow.com/users/3898606/oracle-certified-professional"}, "edited": false, "score": 0, "creation_date": 1504078102, "post_id": 45954107, "comment_id": 78866678, "body": "I guess it&#39;s not just a case of changing <code>objExcel_target.Application.Quit</code> to <code>target.Application.Quit</code>?"}, {"owner": {"reputation": 3, "user_id": 6556598, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pXS1MLfGaUM/AAAAAAAAAAI/AAAAAAAAABU/ZoCveis92Q4/photo.jpg?sz=128", "display_name": "kalinkula", "link": "https://stackoverflow.com/users/6556598/kalinkula"}, "reply_to_user": {"reputation": 954, "user_id": 3898606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f8b8ea74a1d7fde222a1863b571b71?s=128&d=identicon&r=PG&f=1", "display_name": "oracle certified professional", "link": "https://stackoverflow.com/users/3898606/oracle-certified-professional"}, "edited": false, "score": 0, "creation_date": 1504079399, "post_id": 45954107, "comment_id": 78867442, "body": "No - unfortunately not. target is a workbook, which i can Close(). objExcel_target is an application, which i simply want to Quit()"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6556598, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pXS1MLfGaUM/AAAAAAAAAAI/AAAAAAAAABU/ZoCveis92Q4/photo.jpg?sz=128", "display_name": "kalinkula", "link": "https://stackoverflow.com/users/6556598/kalinkula"}, "edited": false, "score": 0, "creation_date": 1504090877, "post_id": 45956915, "comment_id": 78875015, "body": "Cool! This does the job. Thanks!!"}], "tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": true, "score": 3, "last_activity_date": 1504085876, "creation_date": 1504085876, "answer_id": 45956915, "question_id": 45954107, "link": "https://stackoverflow.com/questions/45954107/closing-excel-application-that-was-created-in-a-different-function/45956915#45956915", "title": "Closing Excel application that was created in a different function", "body": "<p>Once you close a workbook you don't have access to its properties anymore. Get the application from the workbook before closing it:</p>\n\n<pre><code>Function CloseTarget(target, reviewPeriod)\n    <b>Set xl = target.Application</b>\n\n    ' Save and close workbook\n    target.SaveAs \"Path_To_Another_File\"\n    target.Close (False)\n\n    <b>xl</b>.Quit\nEnd Function</code></pre>\n\n<p>You can't use <code>objExcel_target</code> because that appears to be a local variable in the function <code>OpenTarget()</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 6556598, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pXS1MLfGaUM/AAAAAAAAAAI/AAAAAAAAABU/ZoCveis92Q4/photo.jpg?sz=128", "display_name": "kalinkula", "link": "https://stackoverflow.com/users/6556598/kalinkula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 45956915, "answer_count": 1, "score": 0, "last_activity_date": 1504085876, "creation_date": 1504076860, "last_edit_date": 1531164843, "question_id": 45954107, "link": "https://stackoverflow.com/questions/45954107/closing-excel-application-that-was-created-in-a-different-function", "title": "Closing Excel application that was created in a different function", "body": "<p>I have two functions in one .vbs file:</p>\n\n<pre><code>Function OpenTarget(ByVal reviewPeriod)\n    ' check if file exists\n    Dim FSO\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    If fso.FileExists(\"FILE_\" &amp; reviewPeriod) Then\n        ' the target file is created for the first time for the given reviewPeriod, hence open the template\n        Set objExcel_target                       = CreateObject(\"Excel.Application\")\n        objExcel_target.Application.Visible       = True\n        objExcel_target.Application.DisplayAlerts = False\n        Set OpenTarget                            = objExcel_target.Workbooks.Open(\"FILE_\" &amp; reviewPeriod)\n    Else\n        ' the target file is created for the first time for the given reviewPeriod, hence open the template\n        Set objExcel_target                       = CreateObject(\"Excel.Application\")\n        objExcel_target.Application.Visible       = True\n        objExcel_target.Application.DisplayAlerts = False\n        Set OpenTarget                            = objExcel_target.Workbooks.Open(\"FILE_TEMPLATE\")\n    End If\nEnd Function\n\nFunction CloseTarget(target, reviewPeriod)\n    ' Save and close workbook\n    target.SaveAs \"Path_To_Another_File\"\n    target.Close (False)\n\n    objExcel_target.Application.Quit\nEnd Function\n</code></pre>\n\n<p>Now I would like to use these two functions in a third function, which is located in a second .vbs file. The script fails at this point:</p>\n\n<pre><code>objExcel_target.Application.Quit\n</code></pre>\n\n<p>I understand that <code>CloseTarget()</code> does not know about the <code>objExcel_target</code> but how can I eventually also close the application using the CloseTarget function?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8522178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3ea383507721749c13d7b18913b6e42a?s=128&d=identicon&r=PG&f=1", "display_name": "Indira", "link": "https://stackoverflow.com/users/8522178/indira"}, "edited": false, "score": 0, "creation_date": 1504082761, "post_id": 45954703, "comment_id": 78869463, "body": "Thanks ! I just modified it a little and it worked-   Dim lastrow as integer  lastrow = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row  If lastrow &gt; 35 Then  new_book.Sheets(&quot;Report&quot;).Range(&quot;A2&quot;).Select      With ActiveWindow         .SplitColumn = 0         .SplitRow = 1     End With     ActiveWindow.FreezePanes = True End If"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 1, "last_activity_date": 1504078975, "creation_date": 1504078975, "answer_id": 45954703, "question_id": 45954096, "link": "https://stackoverflow.com/questions/45954096/freeze-top-pane-only-if-the-data-exceeds-certain-number-of-rows/45954703#45954703", "title": "Freeze Top pane only if the Data exceeds certain number of Rows", "body": "<p>Simple... Get the last row, test if it exceeds 35. If yes, Freeze the Panes.</p>\n\n<p>The below runs on the active sheet.</p>\n\n<pre><code>Sub Test()\nDim lastrow As Integer\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nIf lastrow &gt; 35 Then\n    Range(\"A2\").Select\n    ActiveWindow.FreezePanes = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8522178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3ea383507721749c13d7b18913b6e42a?s=128&d=identicon&r=PG&f=1", "display_name": "Indira", "link": "https://stackoverflow.com/users/8522178/indira"}, "edited": false, "score": 0, "creation_date": 1504083093, "post_id": 45954704, "comment_id": 78869660, "body": "Thanks, but it worked without using Else..  so we may ignore the Else condition.."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 13, "user_id": 8522178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3ea383507721749c13d7b18913b6e42a?s=128&d=identicon&r=PG&f=1", "display_name": "Indira", "link": "https://stackoverflow.com/users/8522178/indira"}, "edited": false, "score": 0, "creation_date": 1504086233, "post_id": 45954704, "comment_id": 78871855, "body": "The else Condition was inserted, if you would delete some Rows and because of that, you will have less then 35 Rows, so it would deaktivate the Freeze Panes."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "reply_to_user": {"reputation": 13, "user_id": 8522178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3ea383507721749c13d7b18913b6e42a?s=128&d=identicon&r=PG&f=1", "display_name": "Indira", "link": "https://stackoverflow.com/users/8522178/indira"}, "edited": false, "score": 0, "creation_date": 1504086336, "post_id": 45954704, "comment_id": 78871918, "body": "@Indira and the benefit of this solution is, that it use the Events, so you don&#39;t have to run the Macro by hand, it will do this automatically on every sheet and you don&#39;t need to chagne the Code for every Workbook."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1504092637, "post_id": 45954704, "comment_id": 78876320, "body": "The unfreezing you have on the <code>Else</code> statement, should be within the <code>Worksheet_change</code> event so it indeed deactivates when you delete rows - that is, unless you wish to switch between sheets in order to trigger the event."}], "tags": [], "owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "is_accepted": false, "score": 0, "last_activity_date": 1504079292, "last_edit_date": 1504079292, "creation_date": 1504078977, "answer_id": 45954704, "question_id": 45954096, "link": "https://stackoverflow.com/questions/45954096/freeze-top-pane-only-if-the-data-exceeds-certain-number-of-rows/45954704#45954704", "title": "Freeze Top pane only if the Data exceeds certain number of Rows", "body": "<p>You can use the <code>Workbook_SheetActivate</code> Event in <strong>ThisWorkbook</strong> for this.</p>\n\n<p>So Every Time you are switching the Worksheet, it will check if there are more then 35 Rows. When there are More it will Freeze the First row. Hope this will Help you.</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n\n    Dim intLastRow As Integer\n\n    With Sh.UsedRange\n            intLastRow = .Rows(.Rows.Count).Row\n    End With\n\n    If intLastRow &gt; 35 Then        \n        Sh.Range(\"A2\").Select\n        With ActiveWindow\n            .SplitColumn = 0\n            .SplitRow = 1\n        End With\n        ActiveWindow.FreezePanes = True\n    Else\n        Sh.Range(\"A2\").Select\n        With ActiveWindow\n            .SplitColumn = 0\n            .SplitRow = 0\n        End With\n        ActiveWindow.FreezePanes = False\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8522178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3ea383507721749c13d7b18913b6e42a?s=128&d=identicon&r=PG&f=1", "display_name": "Indira", "link": "https://stackoverflow.com/users/8522178/indira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 45954703, "answer_count": 2, "score": 0, "last_activity_date": 1504091876, "creation_date": 1504076824, "last_edit_date": 1531164843, "question_id": 45954096, "link": "https://stackoverflow.com/questions/45954096/freeze-top-pane-only-if-the-data-exceeds-certain-number-of-rows", "title": "Freeze Top pane only if the Data exceeds certain number of Rows", "body": "<p>I want to format my Report by using VBA.</p>\n\n<p>I want the apply Freeze pane on the Worksheet only if there are more than 35 Rows. \nI need to show is that if the data exceeds one screen ( I am taking 35 rows), we should have a Freeze pane enabled. In any other case ( less than 35 rows of Data ) the Freeze Pane should be disabled.</p>\n\n<p>I have used the below code for Freeze Top pane. How can i do the Part with the checking the Rows?</p>\n\n<pre><code>    new_book.Sheets(\"Report_\").Range(\"A2\").Select\n    With ActiveWindow\n        .SplitColumn = 0\n        .SplitRow = 1\n    End With\n    ActiveWindow.FreezePanes = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "recordset"], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 7472937, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/019a89c540e4240beb41d05b5a03517a?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Liss", "link": "https://stackoverflow.com/users/7472937/kevin-liss"}, "edited": false, "score": 0, "creation_date": 1504085733, "post_id": 45954446, "comment_id": 78871479, "body": "Worked for me. Thank you."}], "tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": true, "score": 2, "last_activity_date": 1504078079, "creation_date": 1504078079, "answer_id": 45954446, "question_id": 45954028, "link": "https://stackoverflow.com/questions/45954028/vba-excel-loop-eecordset/45954446#45954446", "title": "VBA &amp; Excel - Loop eecordset", "body": "<p>So far you output all of the <code>recordsets</code> contents at once, which is way faster than looping every <code>field</code> in every <code>record</code> (at least for large recordsets).</p>\n\n<p><strong>If</strong> you wanted to actually loop, it would would something like this (messy and untested):</p>\n\n<pre><code>    Dim i As Integer, j as Integer\n    Dim fld As Object\n\n    ' print headers, starting from A4 to the left\n    i = 1\n    j = 4\n    For Each fld In .Fields\n        ThisWorkbook.Sheets(mySheet).Cells(j, i).Value = fld.Name\n        i = i + 1\n    Next fld\n\n    ' print record by record, field by field\n    i = 1\n    j = j + 1\n    While Not .EOF\n        For Each fld In .Fields\n            ThisWorkbook.Sheets(mySheet).Cells(j, i).Value = fld.Value\n            ' here you could test for something like\n            ' If fld.Name = \"change\" and fld.Value = \"X\" Then ThisWorkbook.Sheets(mySheet).Cells(j, i).Interior.Color = vbYellow\n            i = i + 1\n        Next fld\n        j = j + 1\n        .MoveNext\n    Wend\n</code></pre>\n\n<p>This can be streamlined quite some more, but generally, you would have to use <em>two</em> nested loops for the records, and for the fields in each record. Which might be too clumsy for what you try to do.</p>\n\n<p>A more reasonable approach would be to use something simple like</p>\n\n<pre><code>Dim cell As Object\nFor Each cell In Sheets(\"mySheet\").UsedRange '&lt;- replaced UsedRange with the column where \"change\" is printed, if there's the possibility that \"X\" is in other columns aswell\n    With cell\n        If .Value = \"X\" Then .Interior.Color = vbYellow\n    End With\nNext cell\n</code></pre>\n\n<p>to just format your cells, independent of your already processed recordset, or add conditional formatting to said range (with vba), which has the advantage of updating itself</p>\n"}], "owner": {"reputation": 136, "user_id": 7472937, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/019a89c540e4240beb41d05b5a03517a?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Liss", "link": "https://stackoverflow.com/users/7472937/kevin-liss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 45954446, "answer_count": 1, "score": 0, "last_activity_date": 1504079205, "creation_date": 1504076629, "last_edit_date": 1504079205, "question_id": 45954028, "link": "https://stackoverflow.com/questions/45954028/vba-excel-loop-eecordset", "title": "VBA &amp; Excel - Loop eecordset", "body": "<p>I need to loop an recordset in VBA to fill my Excel sheet. I want to do this for each row.</p>\n\n<p>What I've got now is:</p>\n\n<pre><code>comm.CommandText = str_SQL\nrec.Open comm\nSheets(\"mySheet\").Range(\"A4\").CopyFromRecordset rec\n</code></pre>\n\n<p>This works. But I want to change the color of the cell when the index <code>change</code> in my rec is <code>X</code>.</p>\n\n<p>Is this possbile? Has someone got another solution?</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504079194, "post_id": 45953755, "comment_id": 78867319, "body": "<code>ActiveCell.Value</code> is an undefined cell (happens to be any cell that you accidentally click while the macro is running)  .... <code>workbooks(&quot;myFile.xlsm&quot;).worksheets(&quot;Sheet1&quot;).range(&quot;a1&quot;).va&zwnj;&#8203;lue</code> .... there is no mistake about which cell this refers to   .... if working with only one workbook, then it is ok to leave out the workbook reference"}, {"owner": {"reputation": 3, "user_id": 8505701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa38d0411f1a8e4a5070f14831cfdcc9?s=128&d=identicon&r=PG&f=1", "display_name": "Snowgun", "link": "https://stackoverflow.com/users/8505701/snowgun"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504080045, "post_id": 45953755, "comment_id": 78867835, "body": "Thanks for your reply but this doesn&#39;t solve it. The error pops up at line15: If Not IsNull(DLookup(&quot;Name&quot;, &quot;MSysObjects&quot;, &quot;Name=&#39;FinalTable&#39; And Type In (1,4,6)&quot;)) Then"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504080377, "post_id": 45953755, "comment_id": 78868058, "body": "i think that you need to tell the code that you are referring to access   .....  <code>If Not xcess.IsNull(xcess.DLookup(&quot;Name&quot; ....</code>"}, {"owner": {"reputation": 3, "user_id": 8505701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa38d0411f1a8e4a5070f14831cfdcc9?s=128&d=identicon&r=PG&f=1", "display_name": "Snowgun", "link": "https://stackoverflow.com/users/8505701/snowgun"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504247443, "post_id": 45953755, "comment_id": 78948725, "body": "thank you all for your comments. I just found that I don&#39;t need the if statement so it is working without and there is no such problem anymore"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8505701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa38d0411f1a8e4a5070f14831cfdcc9?s=128&d=identicon&r=PG&f=1", "display_name": "Snowgun", "link": "https://stackoverflow.com/users/8505701/snowgun"}, "edited": false, "score": 0, "creation_date": 1504247432, "post_id": 45955786, "comment_id": 78948719, "body": "thank you all for your comments. I just found that I don&#39;t need the if statement so it is working without and there is no such problem anymore."}], "tags": [], "owner": {"reputation": 1, "user_id": 8515463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5ae26e834afd225dbc7950d984fa755?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/8515463/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1504087307, "last_edit_date": 1504087307, "creation_date": 1504082499, "answer_id": 45955786, "question_id": 45953755, "link": "https://stackoverflow.com/questions/45953755/run-time-error-462-the-remote-server-machine-does-not-exist-or-is-unavailable/45955786#45955786", "title": "&quot;Run-time error 462: The remote server machine does not exist or is unavailable&quot; when running VBA code in EXCEL for a second time (get ACCESS table)", "body": "<p>Maybe you could try changing the <code>\"Name='</code> in the criteria argument of the DLookup to <code>\"[Name]='</code> instead. The compiler might be thinking that <code>Name</code> is the undefined variable and not the reference variable from the domain.</p>\n\n<p>I say this because I have similar code but for the <code>DCount</code> function: <code>If DCount(\"PropertyID\", \"tbl_Properties\", \"[PropertyID] Like '*\" &amp; IDSearch &amp; \"*'\") &lt;&gt; 0 Then</code> And also the examples from <a href=\"https://msdn.microsoft.com/en-us/library/office/aa172176(v=office.11).aspx\" rel=\"nofollow noreferrer\">Microsoft</a> show similar code.</p>\n"}], "owner": {"reputation": 3, "user_id": 8505701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa38d0411f1a8e4a5070f14831cfdcc9?s=128&d=identicon&r=PG&f=1", "display_name": "Snowgun", "link": "https://stackoverflow.com/users/8505701/snowgun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 716, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504087307, "creation_date": 1504075646, "last_edit_date": 1504078040, "question_id": 45953755, "link": "https://stackoverflow.com/questions/45953755/run-time-error-462-the-remote-server-machine-does-not-exist-or-is-unavailable", "title": "&quot;Run-time error 462: The remote server machine does not exist or is unavailable&quot; when running VBA code in EXCEL for a second time (get ACCESS table)", "body": "<p>I have a macro in VBA EXCEL which opens an access file and runs 4 queries, closes the access file and finally load a table from ACCESS into EXCEL.\nMy problem is, when I run it the second time, I get the run-time error '462'.\nI read that it has something to do with the variable, that I would need to fully qualify the variables. Can you please suggest me how I have to allocate my variables?</p>\n\n<pre><code>    Sub open_Access()\n    Application.ScreenUpdating = False\n\n    Set xcess = New Access.Application\n\n    xcess.Visible = True\n\n    folderpath = ActiveWorkbook.Path\n    objectname2 = folderpath &amp; \"\\\"\n    fileName = \"Merge17.accdb\"\n    objectname = objectname2 &amp; fileName\n\n    xcess.OpenCurrentDatabase (objectname)\n\n    If Not IsNull(DLookup(\"Name\", \"MSysObjects\", \"Name='FinalTable' And Type In (1,4,6)\")) Then\n         'Table Exists\n\n         DoCmd.DeleteObject acTable, \"FinalTable\"\n\n    Else\n\n     'Table not exists\n     End If\n\n    xcess.DoCmd.OpenQuery \"start1a\"\n    xcess.DoCmd.OpenQuery \"start1b\"\n    xcess.DoCmd.OpenQuery \"start2\"\n    xcess.DoCmd.OpenQuery \"start3\"\n\n    xcess.Quit\n\n    Dim TextFileConn As ADODB.Connection\n    Dim TextFileData As ADODB.Recordset\n    Dim TextFileField As ADODB.Field\n\n    Set TextFileConn = CreateObject(\"ADODB.Connection\")\n    Set TextFileData = CreateObject(\"ADODB.Recordset\")\n\n    TextFileConn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; objectname\n\n    TextFileConn.Open\n\n    With TextFileData\n    .ActiveConnection = TextFileConn\n    .Source = \"FinalTable\"\n    .LockType = adLockReadOnly\n    .CursorType = adOpenForwardOnly\n    .Open\n\n    End With\n\n    Worksheets.Add\n    ActiveSheet.Name = \"DATA from ACCESS\"\n\n    For Each TextFileField In TextFileData.Fields\n        ActiveCell.Value = TextFileField.Name\n        ActiveCell.Offset(0, 1).Select\n    Next TextFileField\n\n    Range(\"A1\").Select\n    Range(\"A2\").CopyFromRecordset TextFileData\n    Range(\"A1\").CurrentRegion.EntireColumn.AutoFit\n\n    TextFileData.Close\n    TextFileConn.Close\n\n    SecondsElapsed = Round(Timer - StartTime, 2)\n    MsgBox (\"Loading Data Complete! Time elasped: \" &amp; SecondsElapsed &amp; \" seconds\")\n\n    End Sub\n</code></pre>\n\n<p>So how do I have to change my variables?\nThank you very much.</p>\n"}, {"tags": ["vba", "excel", "textbox"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1504076060, "post_id": 45953659, "comment_id": 78865498, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19125240/enterkey-to-press-button-in-vba-userform\">EnterKey to press button in VBA Userform</a> Alternatively, this solution might help: <a href=\"https://stackoverflow.com/questions/33244626/activate-userform-with-only-one-enter/33246450#33246450\" title=\"activate userform with only one enter\">stackoverflow.com/questions/33244626/&hellip;</a> Also note, that there is always one button on each form that is the <code>default</code> when the <code>Enter</code> key is pressed. Just look in the properties of the command button (on your form) you want to be the defaut and set <code>Default</code> to <code>True</code>. Then the macro behind that button will run whenever someone hits <code>enter</code>."}, {"owner": {"reputation": 71, "user_id": 8421072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/053b5d344511ac29bec902a014592852?s=128&d=identicon&r=PG&f=1", "display_name": "arifulromadhon", "link": "https://stackoverflow.com/users/8421072/arifulromadhon"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1504076507, "post_id": 45953659, "comment_id": 78865748, "body": "i don&#39;t use userform, just in excel with vba sir.. @ralph"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1504076789, "post_id": 45953659, "comment_id": 78865894, "body": "In this case you are probably looking for a solution like this: <a href=\"http://www.vbaexpress.com/forum/showthread.php?43146-Solved-leave-the-ActiveX-text-box-pressing-Enter\" rel=\"nofollow noreferrer\">vbaexpress.com/forum/&hellip;</a> ?"}, {"owner": {"reputation": 71, "user_id": 8421072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/053b5d344511ac29bec902a014592852?s=128&d=identicon&r=PG&f=1", "display_name": "arifulromadhon", "link": "https://stackoverflow.com/users/8421072/arifulromadhon"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1504079507, "post_id": 45953659, "comment_id": 78867528, "body": "it&#39;s absolutely amazing, sir. thank you @ralph"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1504076897, "creation_date": 1504076897, "answer_id": 45954120, "question_id": 45953659, "link": "https://stackoverflow.com/questions/45953659/push-enter-key-in-text-boxt-then-go-to-specific-cell/45954120#45954120", "title": "push enter key in text boxt then go to specific cell", "body": "<p>Instead of using the Change event, use the KeyUp event and check for the KeyCode vbKeyReturn:</p>\n\n<pre><code>Private Sub TextBox2_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = KeyCodeConstants.vbKeyReturn Then\n        Sheets(\"30\").Range(\"E19\").Select\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8421072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/053b5d344511ac29bec902a014592852?s=128&d=identicon&r=PG&f=1", "display_name": "arifulromadhon", "link": "https://stackoverflow.com/users/8421072/arifulromadhon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 45954120, "answer_count": 1, "score": 0, "last_activity_date": 1504076897, "creation_date": 1504075303, "last_edit_date": 1504076624, "question_id": 45953659, "link": "https://stackoverflow.com/questions/45953659/push-enter-key-in-text-boxt-then-go-to-specific-cell", "title": "push enter key in text boxt then go to specific cell", "body": "<p>How to move cursor in text box with enter in text box?</p>\n\n<p>Here is my code, it gives me a syntax error.</p>\n\n<pre><code>Private Sub TextBox2_Change()\n    Sheets(\"30\").Range(\"D18\") = TextBox2.Value\n    TextBox2.Enter Then Sheets(\"30\").Range(\"E19\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1504102803, "post_id": 45953657, "comment_id": 78884380, "body": "It need information of your sheet&#39;s data  and your chart type. There is another method."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1504990191, "post_id": 45953657, "comment_id": 79232165, "body": "Don&#39;t use square brackets as a shortcut to cell references. Try <code>.DataLabel.Text = Worksheets(&quot;Some Sheet&quot;).Range(&quot;Point1&quot;).Text</code>"}], "owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504083017, "creation_date": 1504075303, "last_edit_date": 1504083017, "question_id": 45953657, "link": "https://stackoverflow.com/questions/45953657/excel-vba-labelling-a-second-data-series", "title": "Excel VBA labelling a second data series", "body": "<p>I have created a multiple chart trend template that dynamically updates using the offset function depending on user input.</p>\n\n<p>I have been able to label the first data series using a defined name that uses the offset function, but I have been unable to label the second data series in the same way ...</p>\n\n<p>So INDEX(name,1) works to pull the relevant part of the array within a cell ... </p>\n\n<p>Is there a way to dynamically create a number of textboxes and link to named cells?  Possibly something like this? <a href=\"https://stackoverflow.com/questions/17582636/attaching-a-textbox-to-a-point-or-line-on-a-chart-in-excel-vba\">Attaching a Textbox to a point or line on a chart in Excel/VBA</a> </p>\n\n<p>The following code works but only with the set of defined names in one worksheert. Is there a way to modify this for multiple charts, using named cells on different worksheets?</p>\n\n<pre><code>Sub Add_Text_to_point()\n\nDim objCht As ChartObject\nDim ws As Worksheet\n\n' loop through sheets in this workbook\nFor Each ws In ThisWorkbook.Worksheets\n' loop through Chartobjects in sheet\nFor Each objCht In ws.ChartObjects\n    ' no need to select the chart or the series use With statement instead\n    With objCht.Chart.SeriesCollection(5).Points(1)\n            .DataLabel.Text = [Point1]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(2)\n            .DataLabel.Text = [Point2]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(3)\n            .DataLabel.Text = [Point3]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(4)\n            .DataLabel.Text = [Point4]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(5)\n            .DataLabel.Text = [Point5]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(6)\n            .DataLabel.Text = [Point6]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(7)\n            .DataLabel.Text = [Point7]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(8)\n            .DataLabel.Text = [Point8]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(9)\n            .DataLabel.Text = [Point9]\n    End With\n    With objCht.Chart.SeriesCollection(5).Points(10)\n            .DataLabel.Text = [Point10]\n    End With\n    Next objCht\n Next ws\n</code></pre>\n"}, {"tags": ["java", "excel", "rally", "vba"], "comments": [{"owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "edited": false, "score": 0, "creation_date": 1504078253, "post_id": 45953505, "comment_id": 78866763, "body": "What do you mean by rally?  Please make it more descriptive."}], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 4999950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MPNLm.jpg?s=128&g=1", "display_name": "NotApplicable", "link": "https://stackoverflow.com/users/4999950/notapplicable"}, "is_accepted": false, "score": 0, "last_activity_date": 1504081749, "creation_date": 1504081749, "answer_id": 45955548, "question_id": 45953505, "link": "https://stackoverflow.com/questions/45953505/how-to-update-bulk-test-cases-status-in-rally-from-excel/45955548#45955548", "title": "how to update bulk test cases status in rally from excel", "body": "<p>Agile Central (previously known as Rally), does not allow you to update the status of a testcase directly. You have to add a testcaseresult to it.</p>\n\n<p>If you look in the WSAPI docs (via the help), you may get a better understanding of what you can update in the artefact tables. SOme of the fields are shown as \"Read Only\" and are generated by the Agile Central backend when you read the artefact.</p>\n"}], "owner": {"reputation": 1, "user_id": 7563369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8cb3e44c9b575a2fd6616ee48a2e55?s=128&d=identicon&r=PG&f=1", "display_name": "Keerthi_1234", "link": "https://stackoverflow.com/users/7563369/keerthi-1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504081749, "creation_date": 1504074846, "last_edit_date": 1531164843, "question_id": 45953505, "link": "https://stackoverflow.com/questions/45953505/how-to-update-bulk-test-cases-status-in-rally-from-excel", "title": "how to update bulk test cases status in rally from excel", "body": "<p>I am new to rally and want to update bulk test cases status(Pass/Fail) in rally using excel macro or using java. Can anyone please help.</p>\n"}, {"tags": ["excel", "validation", "vba"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1504487222, "post_id": 45953850, "comment_id": 79018248, "body": "Hi Peter, big thanks for that. Amazing job. It does exactly what I want with no need for VBA. However, is there a way I can add another condition to only allow entry in D6 if E6&lt;&gt;&quot;&quot;. Same is for D7 up till D309, with their relative cells."}, {"owner": {"reputation": 15842, "user_id": 1867581, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mgZDV.jpg?s=128&g=1", "display_name": "Peter Albert", "link": "https://stackoverflow.com/users/1867581/peter-albert"}, "reply_to_user": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1504504776, "post_id": 45953850, "comment_id": 79021874, "body": "so just to understand - the direct cell below must be populated first? if the user starts in row 309 and has to populated it to the top?"}, {"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1504635158, "post_id": 45953850, "comment_id": 79082343, "body": "If E6 is populated (i.e. E6&lt;&gt;&quot;&quot;), then allow your data validation to work in D6. Similarly for D7 up till D309, where if E7 is populated (i.e. E7&lt;&gt;&quot;&quot;), then allow your data validation to work in D7, and so on. So, it&#39;s the adjacent cell that has to be populated first and not the cell below."}, {"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1504783555, "post_id": 45953850, "comment_id": 79151863, "body": "Are you able to help me?"}], "tags": [], "owner": {"reputation": 15842, "user_id": 1867581, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mgZDV.jpg?s=128&g=1", "display_name": "Peter Albert", "link": "https://stackoverflow.com/users/1867581/peter-albert"}, "is_accepted": true, "score": 0, "last_activity_date": 1504076060, "creation_date": 1504076060, "answer_id": 45953850, "question_id": 45953473, "link": "https://stackoverflow.com/questions/45953473/restricting-cells-to-a-specific-order-of-entering-a-specific-range-of-numbers/45953850#45953850", "title": "Restricting cells to a specific order of entering a specific range of numbers", "body": "<p>This can be done with some clever custom validations. To place a customer validation, select the cell(s) you want to apply this validation and then select Data->Data Validation. In the form under settings, select Custom in the \"Allow\" dropdown and enter the formula.</p>\n\n<p>In detail, you'll need to following three validations:</p>\n\n<ol>\n<li>Cell D6: <code>=D6=(MAX($D$7:$D$309,0)+1)</code></li>\n<li>Cells D7:D308 (make sure cell D7 is the active cell in the selection: <code>=D7=(MAX($D$6:$D6,$D8:$D$309,0)+1)</code></li>\n<li>Cell D309: <code>=D309=(MAX($D$6:$D$308,0)+1)</code></li>\n</ol>\n\n<p>If you want you can add a custom error message in the \"Error Alert\" tab to explain the logic to the user.</p>\n\n<p>Be aware: While this solution fulfills your conditions, you'll run into problems the moment any entry is deleted! In this the validations still force the user to enter the next highest number, so the deleted number cannot be entered unless all other numbers above it have be deleted!</p>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "edited": false, "score": 0, "creation_date": 1504487265, "post_id": 45954252, "comment_id": 79018256, "body": "Hi Mrig. Thanks for your effort. I&#39;d rather avoid VBA as i might have to share this workbook. Thanks, heaps though."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1504077371, "creation_date": 1504077371, "answer_id": 45954252, "question_id": 45953473, "link": "https://stackoverflow.com/questions/45953473/restricting-cells-to-a-specific-order-of-entering-a-specific-range-of-numbers/45954252#45954252", "title": "Restricting cells to a specific order of entering a specific range of numbers", "body": "<p>Following <code>Worksheet_Change</code> event should work. It does the following:</p>\n\n<p>1) check whether entered value is a number if not display message and exit<br>\n2) check for correct number to be entered</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"D6:D309\")) Is Nothing Or Target.Cells.Count &gt; 1 Then Exit Sub 'check for range\n\n    Application.EnableEvents = False\n    Dim countPrevNum As Long, largeNum As Long, currNum As Long\n\n    If Not IsNumeric(Target.Value) Then     'check if entered value is number\n        MsgBox \"Enter a number\"\n        Target.Cells.Clear\n        Target.Cells.Select\n        Application.EnableEvents = True\n        Exit Sub\n    End If\n\n    currNum = Target.Value      'value entered\n    Target.Cells.Clear          'clear the target cell\n\n    If WorksheetFunction.CountA(Range(\"D6:D309\")) Then\n        largeNum = WorksheetFunction.Large(Range(\"D6:D309\"), 1)   'get the largest number in the range\n    End If\n\n    If largeNum &lt;&gt; currNum - 1 Then     'check if previous largest number is equal to currNum-1\n        MsgBox \"Number to be entered : \" &amp; largeNum + 1\n        Target.Cells.Select         'select the target cell\n    Else\n        Target.Value = currNum      'enter the value target cell\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6829043, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac87e4d995313a182e7d2711a1244f48?s=128&d=identicon&r=PG&f=1", "display_name": "Omar", "link": "https://stackoverflow.com/users/6829043/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 45953850, "answer_count": 2, "score": 0, "last_activity_date": 1504077371, "creation_date": 1504074731, "last_edit_date": 1531161705, "question_id": 45953473, "link": "https://stackoverflow.com/questions/45953473/restricting-cells-to-a-specific-order-of-entering-a-specific-range-of-numbers", "title": "Restricting cells to a specific order of entering a specific range of numbers", "body": "<p>Here's the scenario. I have in columns E6:E309 all the job numbers. I would like the sales person to come and type in the relative cell in D6:D309 which job is to be drawn first by typing in the range D6:D309 any number from 1 to 303. If a sales person entered in column D11 \"1\", that means that job number is E11 is to be cut first. The hard part is the following two conditions:</p>\n\n<p><strong>1st Condition:</strong> The first entry in any cell belonging to the range D6:309 should be number 1, the second is number 2, the third is number 3, and so on up till number 309. <em>So, the sales person can not enter the number \"2\" in any cell belonging to D6:D309, unless the number \"1\" is entered somewhere else in any cell belonging to the range D6:D309 is entered, and so on.</em> </p>\n\n<p><strong>2nd Condition:</strong> There's no specific order for which cells are entered before the other. <em>The salesperson can start entering in any cell, per se D10 by entering \"1\", and then move to D18 where he can only enter \"2\", and then back to D3 where he can only enter \"3\", and so on.</em> </p>\n\n<p>Your help will be very much appreciated.</p>\n"}, {"tags": ["vba", "excel", "email"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1504072939, "post_id": 45952857, "comment_id": 78863844, "body": "Use Regular expressions - <a href=\"https://stackoverflow.com/a/39588282/4539709\">stackoverflow.com/a/39588282/4539709</a>"}, {"owner": {"reputation": 81, "user_id": 4743385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6fada56d97997bbd4aa0c9af0c3783ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz Adamczewski", "link": "https://stackoverflow.com/users/4743385/mariusz-adamczewski"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1504074520, "post_id": 45952857, "comment_id": 78864604, "body": "Thanks, I will try this. I just wondering what if I will have tons of these issues. Anyway I will try."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4743385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6fada56d97997bbd4aa0c9af0c3783ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz Adamczewski", "link": "https://stackoverflow.com/users/4743385/mariusz-adamczewski"}, "edited": false, "score": 0, "creation_date": 1504074569, "post_id": 45953007, "comment_id": 78864626, "body": "I will try this what did you wrote. Then if the email is correct I will send it and when will be issue I will write in other column &#39;wrong email&#39;. Then at the end after all of records I will delete these where is not information about error and I will get all email when the issue occurs.   Thanks! +1"}, {"owner": {"reputation": 184, "user_id": 5677618, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d54657702d3527fc738cf32b45ffd6b6?s=128&d=identicon&r=PG&f=1", "display_name": "RAFEL", "link": "https://stackoverflow.com/users/5677618/rafel"}, "reply_to_user": {"reputation": 81, "user_id": 4743385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6fada56d97997bbd4aa0c9af0c3783ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz Adamczewski", "link": "https://stackoverflow.com/users/4743385/mariusz-adamczewski"}, "edited": false, "score": 0, "creation_date": 1504094217, "post_id": 45953007, "comment_id": 78877439, "body": "Nie ma za co ;)"}], "tags": [], "owner": {"reputation": 184, "user_id": 5677618, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d54657702d3527fc738cf32b45ffd6b6?s=128&d=identicon&r=PG&f=1", "display_name": "RAFEL", "link": "https://stackoverflow.com/users/5677618/rafel"}, "is_accepted": true, "score": 1, "last_activity_date": 1504072991, "creation_date": 1504072991, "answer_id": 45953007, "question_id": 45952857, "link": "https://stackoverflow.com/questions/45952857/quickly-handle-error-sending-email-to-address-which-does-not-exist/45953007#45953007", "title": "Quickly handle error sending email to address which does not exist", "body": "<p>I would use <code>On Error Resume Next</code> after each <code>.Send</code> I would mark that record as send. When macro is done I could check your list for unsend markers, to check for errors.</p>\n\n<p>Checking if emial is correct, you will never know how long should email adress be so checking length is not an option. </p>\n\n<p>Is it posible that those records are know to you? Maybe some kinde of list, that you could comper those with?</p>\n"}], "owner": {"reputation": 81, "user_id": 4743385, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6fada56d97997bbd4aa0c9af0c3783ff?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz Adamczewski", "link": "https://stackoverflow.com/users/4743385/mariusz-adamczewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 45953007, "answer_count": 1, "score": 1, "last_activity_date": 1504272952, "creation_date": 1504072375, "last_edit_date": 1504272952, "question_id": 45952857, "link": "https://stackoverflow.com/questions/45952857/quickly-handle-error-sending-email-to-address-which-does-not-exist", "title": "Quickly handle error sending email to address which does not exist", "body": "<p>I am using the library - Microsoft Outlook in Excel. </p>\n\n<p>For example:<br>\nI have got 100 records when in each record is other mail address.\nBut in some records, there are 2-5 email addresses.</p>\n\n<p>When I am using the function called</p>\n\n<pre><code>.Send\n</code></pre>\n\n<p>It is sending the emails in 'background'. But when the VBA will meet error it is stopped.</p>\n\n<p>Example source issues:</p>\n\n<ul>\n<li>lack of dot in email address</li>\n<li>email addresses are not separated (example: email@gmail.comemail2@gmail.com</li>\n<li>wrong email address (emailgmailcom)</li>\n</ul>\n\n<p>The issue occurs when Outlook wants to send email on address which does not exist.</p>\n\n<p>Is any chance to check if the email addresses are good but not to write 30-50 lines of code?</p>\n"}, {"tags": ["javascript", "html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1504072759, "post_id": 45952701, "comment_id": 78863769, "body": "Did you try <code>getElementsByTagName(&quot;input&quot;)</code> ?  I&#39;ts not really clear what you&#39;re trying to do though - a little more of your current code would help."}, {"owner": {"reputation": 57, "user_id": 6539862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4be4b147ee95315f08d3462e36a8caa6?s=128&d=identicon&r=PG&f=1", "display_name": "dman", "link": "https://stackoverflow.com/users/6539862/dman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504109901, "post_id": 45952701, "comment_id": 78889472, "body": "I have attempted to use getElementsByTagName(&quot;input&quot;).value. The HTML I listed above is part of a secondary HTML form that resides under the main HTML pagelet. I am getting errors when I reference any tag inside the secondary HTML doc but can get the values for any tag in the first HTML doc. My question is, how do I use the getElementsByTagName() function to return values from the tags that are not a part of the first HTML document?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504110221, "post_id": 45952701, "comment_id": 78889681, "body": "You don&#39;t show enough HTML or enough of your existing code to give a real answer.  You should be aware though that <code>getElementsByTagName(&quot;input&quot;)</code> returns a <i>collection</i> of elements, not a single element (if there&#39;s only one input then it will still be a single-element collection).  That collection doesn&#39;t have a <code>Value</code> property: you need to loop over it and look at each member of the collection to find the one you want."}, {"owner": {"reputation": 57, "user_id": 6539862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4be4b147ee95315f08d3462e36a8caa6?s=128&d=identicon&r=PG&f=1", "display_name": "dman", "link": "https://stackoverflow.com/users/6539862/dman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504117873, "post_id": 45952701, "comment_id": 78893934, "body": "Thank you Tim, that was my issue."}], "owner": {"reputation": 57, "user_id": 6539862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4be4b147ee95315f08d3462e36a8caa6?s=128&d=identicon&r=PG&f=1", "display_name": "dman", "link": "https://stackoverflow.com/users/6539862/dman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504072118, "creation_date": 1504071692, "last_edit_date": 1504072118, "question_id": 45952701, "link": "https://stackoverflow.com/questions/45952701/html-and-javascript-web-scraping-with-vba", "title": "HTML and Javascript web scraping with VBA", "body": "<p>I am attempting to input values and read values from fields on an internal site I am building using VBA. Up to this point, I have been using the <code>getElementsByName()</code> methods to retrieve my data which has been working fine for the plain HTML elements. However, I am now to a portion of my site that includes nested tables and forms and I am getting either a runtime '438' or '91 error using the <code>getElementsByName()</code>.</p>\n\n<blockquote>\n  <p>Run-Time Error #438:\n  Object doesn't support this property or method.</p>\n  \n  <p>\"Runtime Error 91: Object variable or with block variable not set\"</p>\n</blockquote>\n\n<p>I assume this is due to me needing to declare the various parent elements but I don't have any luck. I am attaching the segment of the HTLM that I am trying to retrieve the value from. I am searching for the  tag and need to find the  name out of all the various input tags listed on my forms and tables within the HTML document. Thank you! </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;/DIV&gt;&lt;/td&gt;\r\n&lt;td colspan='6' rowspan='2' nowrap='nowrap'\u00a0 valign='top' align='left'&gt;\r\n&lt;DIV\u00a0\u00a0\u00a0 id='Search'&gt;&lt;input type='text' name='RBSearch\u2019 id='RBSearch' tabindex='1977' value=\"\"\u00a0 class='EDITBOX' style='width:156px; ' maxlength='254' onchange=\"addchg_win0(this);oChange_win0=this;\"\u00a0 PSnchg='0' /&gt;&lt;a class='HYPERLINK'\u00a0 name='RBSearch_Case' id='RBSearch_Case'\u00a0 role='button' tabindex='1978' href=\"javascript:pAction_win0(document.win0,'RBSearch);\"&gt;&lt;img src=\"/cs/CRMPRD/cache/PT1.gif\" alt='Look up Case' title='Look up (Alt+5)' border='0' align='absmiddle' /&gt;&lt;/a&gt;\r\n&lt;/DIV&gt;&lt;/td&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "edited": false, "score": 0, "creation_date": 1504147261, "post_id": 45963248, "comment_id": 78903697, "body": "Thanks for this. I won&#39;t be able to test it so I won&#39;t mark it as the answer. Your answer inspired me to a work-around: I just setup the same email account one more time in online mode and then I can count the mails in each folder (which will be exactly like on the server) with the code above. Then I can compare that to the local folders in the offline account. That is no perfect solution but it will do the job."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1504103707, "creation_date": 1504103707, "answer_id": 45963248, "question_id": 45952523, "link": "https://stackoverflow.com/questions/45952523/what-is-the-vba-property-for-server-folder-contains-x-itmes/45963248#45963248", "title": "What is the VBA property for: Server folder contains x itmes?", "body": "<p>You will need to open the folder in the online mode and retrieve its contents count. In Extended MAPI (C++ or Delphi) you would need to use <code>MAPI_NO_CACHE</code> bit when calling <code>IMAPISession::OpenEntry</code> - you can play with that bit in <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow noreferrer\">OutlookSpy</a>: click IMAPIFolder button, select PR_ENTRYID property, right click, select IMAPISession::OpenEntry, make sure MAPI_NO_CACHE is checked.</p>\n\n<p>In case of languages other than C++ or Delphi, you can use <a href=\"http://www.dimastr.com/redemption/\" rel=\"nofollow noreferrer\">Redemption</a> - its versions of <code>GetFolderFromID</code>, <code>GetMessageFromID</code>, etc. allow to pass flags to be used by <code>IMAPISession::OpenEntry</code>.</p>\n\n<pre><code>MAPI_NO_CACHE = &amp;H0200\nMAPI_BEST_ACCESS = &amp;H0010\nset OomFolder = Application.ActiveExplorer.CurrentFolder\nset Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset RdoFolder = Session.GetFolderFromID(OomFolder.EntryID, , MAPI_NO_CACHE Or MAPI_BEST_ACCESS)\nMsgBox \"Number of items in the online folder: \" &amp; RdoFolder.Items.Count\n</code></pre>\n"}], "owner": {"reputation": 1997, "user_id": 4409883, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/xZatI.jpg?s=128&g=1", "display_name": "Edgar", "link": "https://stackoverflow.com/users/4409883/edgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504103707, "creation_date": 1504070818, "question_id": 45952523, "link": "https://stackoverflow.com/questions/45952523/what-is-the-vba-property-for-server-folder-contains-x-itmes", "title": "What is the VBA property for: Server folder contains x itmes?", "body": "<p>I like to compare the amount of items in each folder on the Exchange server with the amount of items in my local Outlook file.</p>\n\n<p>In Outlook I can use the following to get the item count per folder</p>\n\n<pre><code>Dim Folder As Outlook.MAPIFolder\nSet Folder = objNS.Folders(\"xxx\").Folders(\"Inbox\")\nDebug.Print Folder.Items.Count\n</code></pre>\n\n<p>How do I get the item count on the server like in the following screenshot?\n<a href=\"https://i.stack.imgur.com/wJiVW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wJiVW.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "vba", "ms-word", "userform"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504070088, "post_id": 45952206, "comment_id": 78862807, "body": "put in  <code>debug.print i</code> line to print the value of <code>i</code> .... see if it changes"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504073274, "post_id": 45952206, "comment_id": 78863959, "body": "CName() and CAddress() should be globals for this to work, otherwise none of the elements will be maintained.  Also don&#39;t unload your form until you&#39;re done populating the text."}, {"owner": {"reputation": 11, "user_id": 8535901, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159178553280244/picture?type=large", "display_name": "Jenny Lynn", "link": "https://stackoverflow.com/users/8535901/jenny-lynn"}, "edited": false, "score": 0, "creation_date": 1504148143, "post_id": 45952206, "comment_id": 78903912, "body": "so the problem with i not counting was that I defined it publically in the module and it doesn&#39;t carry to the forms but when I tried defining CName() and CAddress() as public variables inside the form I get the compile error: &quot;constants, fixed-length strings, arrays, user-defined types and declare statements not allowed as Public members of object modules.&quot; any idea how I can either reference this public variable from the form or sneakily define publically within the form? because it won&#39;t store the values unless publically defined."}], "owner": {"reputation": 11, "user_id": 8535901, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159178553280244/picture?type=large", "display_name": "Jenny Lynn", "link": "https://stackoverflow.com/users/8535901/jenny-lynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504069131, "creation_date": 1504068995, "last_edit_date": 1504069131, "question_id": 45952206, "link": "https://stackoverflow.com/questions/45952206/saving-userform-inputs-in-an-array", "title": "saving userform inputs in an array", "body": "<p>I'm trying to use userforms in word VBA to save an undefined number of variables into an array to later input in a document but I can't get the incremental counter to work and it will only save the last input and it is saved as input 0. </p>\n\n<pre><code>Public i As Integer\nSub Macro6()\n    UF1.Show\nEnd Sub\n\nPrivate Sub btnAddC_Click()\nDim CName(100) As String\nDim CAddress(100) As String\n\nCName(i) = txtName.Text\nCAddress(i) = txtAddress.Text\n\ni = i + 1\n\nUnload Me\nUF1.Show\nEnd Sub\n\nPrivate Sub btnNext_Click()\nDim CName(100) As String\nDim CAddress(100) As String\nDim n As Integer\n\nCName(i) = txtName.Text\nCAddress(i) = txtAddress.Text\n\nUnload Me\n\nFor n = 0 To i\n  Selection.TypeText Text:=\"Client number \" &amp; n &amp; \" is \" &amp; CName(n) &amp; \".\"\n  Selection.TypeParagraph\n  Selection.TypeText Text:=\"Client number \" &amp; n &amp; \" is \" &amp; CAddress(n) &amp; \".\"\n  Selection.TypeParagraph\nNext\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\ntxtName.Text = \"\"\ntxtAddress.Text = \"\"\nEnd Sub\n</code></pre>\n\n<p>The output is always:</p>\n\n<p>Client number 0 is a.\nClient number 0 is b.</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1504072249, "post_id": 45952114, "comment_id": 78863594, "body": "Welcome to SO, Melissa. Can you tell us what do you mean by &quot;that didn&#39;t work&quot;? The code isn&#39;t working at all or it gives wrong results? Did you try debugging your code? You can find instructions on the Internet how to debug VBA code."}, {"owner": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1504096060, "post_id": 45952114, "comment_id": 78878871, "body": "Hi Egan. Sorry I wasn&#39;t clearer. I will try this code again and then update the post. I tried to many codes at that point so I want to make sure I reply with the correct answer. Also I am aware of the debug option, but I&#39;m still learning this language so it&#39;s been difficult to understand what is going on. Thanks again!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "edited": false, "score": 0, "creation_date": 1504103959, "post_id": 45962357, "comment_id": 78885313, "body": "Omg thank you so much. I will run this today and let you know what I get. Again thank you!!!!"}, {"owner": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "edited": false, "score": 0, "creation_date": 1504137073, "post_id": 45962357, "comment_id": 78901634, "body": "I tried the macro and it is leaving two values in the active worklist that it should delete (A2 and A4). Do you know what this means? I  updated the the Macro here:      Set compareFrom = wb1.Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:A20&quot;)"}, {"owner": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "edited": false, "score": 0, "creation_date": 1504140999, "post_id": 45962357, "comment_id": 78902306, "body": "I just realized that when I run the macro two more times, the A2 and A4 values get removed and only leaves the unique values in the active workbook. Seems like I&#39;m getting close but I can&#39;t figure out why it&#39;s not looking through the whole array. I tried Range(A:A) but Excel froze."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "edited": false, "score": 0, "creation_date": 1504184258, "post_id": 45962357, "comment_id": 78923438, "body": "@Melissa you&#39;re right my bad. The cell indices change when deleting a row. Common issue, see updated code. Should fix it."}, {"owner": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "edited": false, "score": 0, "creation_date": 1504228140, "post_id": 45962357, "comment_id": 78944138, "body": "WOW this is awesome! It works!!!  I will be stress testing this code over the next week to make sure it isn&#39;t missing any projects. THANK YOU SO MUCH!!!"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "edited": false, "score": 0, "creation_date": 1504251122, "post_id": 45962357, "comment_id": 78950402, "body": "If this was indeed what you were after, consider marking your question answered."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1504184234, "last_edit_date": 1504184234, "creation_date": 1504101182, "answer_id": 45962357, "question_id": 45952114, "link": "https://stackoverflow.com/questions/45952114/comparing-columns-in-different-excel-2013-files-and-deleting-the-duplicates-from/45962357#45962357", "title": "Comparing columns in different excel 2013 files and deleting the duplicates from one of the workbooks (need macro)", "body": "<p><strong>The question here:</strong></p>\n\n<blockquote>\n  <p>I am trying to create an Excel 2013 macro that will compare values in\n  column A on one workbook (\"active workbook\") to column A's of other\n  Excel files in a particular directory. Duplicate values (rows) would\n  then be deleted from the active workbook.</p>\n</blockquote>\n\n<p>So, let's break this down:</p>\n\n<ol>\n<li>There is a directory from which workbooks need to be opened.</li>\n<li>When one of the workbooks is open, you want to check column A (I assume this is on the first worksheet for the sake of the example below) for values you have in column A in your active workbook (the one that will run the macro).</li>\n<li>If there's a match, delete the row from the active workbook in which the value was stored.</li>\n<li>When done, continue with the next workbook in the directory.</li>\n</ol>\n\n<p><strong>Point 1 and 4: Open some files from a specific directory:</strong></p>\n\n<p>We will need some function to open and close the files. This question has been asked many times on SO, for example <a href=\"https://stackoverflow.com/questions/10380312/loop-through-files-in-a-folder-using-vba\">here</a></p>\n\n<p>Also, we're going to need the workbooks to be stored in some variable that we will pass to the comparison in the next step.</p>\n\n<pre><code>Public Sub LoopOverFiles()\n'Our variables:\nDim wb1 As Workbook 'To hold the active workbook / the macro workbook\nDim wb2 As Workbook 'To hold the workbook we'll be comparing to later on\nDim scanFolder As String 'To set the folder in which the files will be located\nDim fileNameToOpen As String 'To get the filenames that we will open\n\nSet wb1 = ThisWorkbook\nscanFolder = \"C:\\temp\\\"\nfileNameToOpen = Dir(scanFolder &amp; \"*.xlsx\")\n\n'And loop over the files:\nDo While Len(fileNameToOpen) &gt; 0 'To exit the loop when there's no more xlsx files\n    Set wb2 = Workbooks.Open(scanFolder &amp; fileNameToOpen)\n\n    'To do the actual comparison of the 2 workbooks, we call our compare routine.\n    DoTheComparison wb1, wb2 'Note we'll be passing the two workbooks as parameters to the compare function\n\n    wb2.Close SaveChanges:=False 'We don't want to leave it open after we're done with it.\n    fileNameToOpen = Dir 'To continue with the next file.\nLoop\nEnd Sub\n</code></pre>\n\n<p><strong>Point 2 and 3: Do the comparison and delete some rows</strong></p>\n\n<p>As you can see, the actual comparison will be done by a routine that's called <code>DoTheComparison</code> and that takes 2 workbooks as parameters. Based on the first routine, we know that the workbooks that will be passed are the correct ones (wb1 being the active one, wb2 being the variable one that gets opened during the loop).\nIn this example we'll stick to the first worksheet in wb2.</p>\n\n<pre><code>Public Sub DoTheComparison(wb1 as Workbook, wb2 as Workbook)\n'Dim compareFrom as Range - Not needed.\nDim compareTo as Range\nDim compareFromCell as Range\nDim compareToCell as Range\n\nDim i as Integer \n'EDIT: Since we delete, we need a backwards loop. This can't be done with \"for each\" so we'll use \"for\" with step -1. \n'That is why we also don't need the \"CompareFrom\" range variable anymore.\n\nSet compareTo = wb2.Worksheets(1).Range(\"A2:A20\")\n\nFor i = 20 to 2 step -1 \n    Set compareFromCell = wb1.Worksheets(\"RemoveValsFromHere\").Range(\"A\" &amp; i) 'We get the cells based on the index. \n    For Each compareToCell in compareTo\n\n        If compareFromCell.Value = compareToCell.Value Then 'Point 3:\n            compareFromCell.EntireRow.Delete shift:=xlUp\n            Exit For \n            'Note that we need to exit the inner loop: \n            'After a match was found, the \"compareFromCell\" is deleted after all.\n            'Therefore we have to continue with the next compareFromCell, otherwise we'll get an error.\n        End If\n\n    Next compareToCell\nNext i\nEnd Sub\n</code></pre>\n\n<p>Note that especially <code>DoTheComparison</code> is written for maximum clarity, not for optimal speed (far from it!). I see in your question you've been looking into comparing variants / arrays, which is indeed a lot faster.</p>\n\n<p><strong>EDIT:</strong> I altered the code above since you're facing the \"skipping cells\" issue due to cell deletion. In short: The index changes, so when moving to the next cell after deletion the index is wrong. The fix is an easy backwards for loop. Also see <a href=\"https://stackoverflow.com/questions/45006507/vba-delete-row-not-working-properly/45006781#45006781\">this question and answer</a></p>\n"}], "owner": {"reputation": 21, "user_id": 8535665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3e17290314b4ef3020aa10772e0e751?s=128&d=identicon&r=PG&f=1", "display_name": "Melissa", "link": "https://stackoverflow.com/users/8535665/melissa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 789, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1504184234, "creation_date": 1504068566, "last_edit_date": 1504086341, "question_id": 45952114, "link": "https://stackoverflow.com/questions/45952114/comparing-columns-in-different-excel-2013-files-and-deleting-the-duplicates-from", "title": "Comparing columns in different excel 2013 files and deleting the duplicates from one of the workbooks (need macro)", "body": "<p>This is my first question on this site and I'm not a programmer, so please bear with me. </p>\n\n<p>I am trying to create an Excel 2013 macro that will compare values in column A on one workbook (\"active workbook\") to column A's of other Excel files in a particular directory. Duplicate values (rows) would then be deleted from the active workbook. </p>\n\n<p>I have been working piece by piece trying to figure this out as I am not a programmer. So far I have been able to use conditional formatting to highlight unique values when the two columns are side by side (same worksheet). I used <code>=ISNA(MATCH($A2,$B$2:$B$12,0))</code>.</p>\n\n<p>Then I used a macro to print out the duplicate values to another column (instead of highlighting them.. I am still at this stage comparing two columns within the same worksheet). I did this by using the following macro:</p>\n\n<pre><code>Sub Find_Matches()\nDim CompareRange As Variant, x As Variant, y As Variant\n' Set CompareRange equal to the range to which you will\n' compare the selection.\nSet CompareRange = Range(\"C1:C12\")\n' NOTE: If the compare range is located on another workbook\n' or worksheet, use the following syntax.\n' Set CompareRange = Workbooks(\"Book2\"). _\n'   Worksheets(\"Sheet2\").Range(\"C1:C5\")\n'\n' Loop through each cell in the selection and compare it to\n' each cell in CompareRange.\nFor Each x In Selection\n    For Each y In CompareRange\n        If x = y Then x.Offset(0, 1) = x\n    Next y\nNext x\nEnd Sub\n</code></pre>\n\n<p>Then I tried removing duplicate values from two different worksheets but that didn't work: </p>\n\n<pre><code>Sub ProcessFiles()\n\nDim Filename, Pathname As String\nDim wb1 As Workbook\nDim wb2 As Workbook\n\nDim Sheet As Worksheet\nDim PasteStart As Range\nDim Counter As Integer\n\nSet wb1 = ActiveWorkbook\nSet PasteStart = [RRimport!A1]\n\nPathname = ActiveWorkbook.Path &amp; \"\\For Macro to run\\\"\nFilename = Dir(Pathname &amp; \"*.xls\")\nDo While Filename &lt;&gt; \"\"\n    Set wb2 = Workbooks.Open(Pathname &amp; Filename)\n    For Each Sheet In wb2.Sheets\n            With Sheet.UsedRange\n            .Copy PasteStart\n            Set PasteStart = PasteStart.Offset(.Rows.Count)\n        End With\n    Next Sheet\n    wb2.Close\n    Filename = Dir()\nLoop\nEnd Sub\n</code></pre>\n\n<p>I've been reading this site for couple of days and also searched through YouTube. I haven't had much success after the first two basic things I did. </p>\n\n<p>Background of the project: Everyday we have a list called \"Pending List\" which essentially is all of the projects we need to get done. Everyday this list grows. Each project is given a unique identifier (numeric value) that is listed in column A of the active workbook. Every day I create my own files of the projects that are being completed. Instead of manually checking off each project one by one by comparing several files every day, I would like Excel to be able to delete the duplicates (meaning the projects that are both on my pending list and in the other files, and only leave the unique projects that still need to be done. Hope I didn't confuse anyone but if I did, please let me know.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504066842, "post_id": 45951837, "comment_id": 78861966, "body": "<code>CharacterData</code> may not be the <code>ActiveSheet</code>, so use <code>Worksheets(&quot;CharacterData&quot;).Range(Worksheets(&quot;CharacterData&quot;&zwnj;&#8203;).Cells(m, &quot;A&quot;), Worksheets(&quot;CharacterData&quot;).Cells(n, &quot;F&quot;))</code> instead of just <code>Worksheets(&quot;CharacterData&quot;).Range(Cells(m, &quot;A&quot;), Cells(n, &quot;F&quot;))</code> - i.e. always qualify your <code>Range</code>, <code>Cells</code>, <code>Rows</code>, <code>Columns</code>, etc references with the sheet they are being applied to."}, {"owner": {"reputation": 11, "user_id": 8533267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdcb137300486f0fb8598f22b09dd7a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja Octopus", "link": "https://stackoverflow.com/users/8533267/ninja-octopus"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504067607, "post_id": 45951837, "comment_id": 78862149, "body": "@YowE3K it worked! I am so impressed people around here can look at code on a project they don&#39;t know much about and solve the problem quickly. Thank you so much!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504068002, "post_id": 45951837, "comment_id": 78862265, "body": "LOL - That is one of the errors we see a <b>LOT</b> of around here - wasn&#39;t hard to spot the probable issue even though your question didn&#39;t state which line was crashing."}, {"owner": {"reputation": 11, "user_id": 8533267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdcb137300486f0fb8598f22b09dd7a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja Octopus", "link": "https://stackoverflow.com/users/8533267/ninja-octopus"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504069133, "post_id": 45951837, "comment_id": 78862542, "body": "@YowE3K I guess it&#39;s like a second language to those with more experience. Sorry about that, I&#39;m new to Stack Overflow. I will try to have that figured out next time. I would upvote your answer, but I do not have enough rep. I&#39;ll come back and upvote it once I get enough."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504069203, "post_id": 45951837, "comment_id": 78862558, "body": "Don&#39;t mind answering the question, but it does get boring sometimes - I like it when there is something really weird that taxes the brain cells :D"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1504068371, "creation_date": 1504068371, "answer_id": 45952079, "question_id": 45951837, "link": "https://stackoverflow.com/questions/45951837/code-executing-one-time-then-triggering-run-time-error-1004-application-defi/45952079#45952079", "title": "Code executing one time then triggering &quot;Run-time error &#39;1004&#39;: Application-defined or object-defined error&quot;", "body": "<p>Your code refers to a range using</p>\n\n<pre><code>Worksheets(\"CharacterData\").Range(Cells(m, \"A\"), Cells(n, \"F\"))\n</code></pre>\n\n<p>Because you haven't specified which sheet is being referred to by your <code>Cells</code> objects, they are defaulting to <code>ActiveSheet.Cells</code> and therefore your code is equivalent to</p>\n\n<pre><code>Worksheets(\"CharacterData\").Range(ActiveSheet.Cells(m, \"A\"), ActiveSheet.Cells(n, \"F\"))\n</code></pre>\n\n<p>If <code>Worksheets(\"CharacterData\")</code> is the <code>ActiveSheet</code>, then that will be fine, but as soon as some other sheet is active then you are trying to reference a range on one worksheet which is bounded by cells on a completely different worksheet.</p>\n\n<p>You should change that part of your code to</p>\n\n<pre><code>Worksheets(\"CharacterData\").Range(Worksheets(\"CharacterData\").Cells(m, \"A\"), Worksheets(\"CharacterData\").Cells(n, \"F\"))\n</code></pre>\n\n<hr>\n\n<p>A good habit to get into is to <strong>always</strong> qualify your <code>Cells</code>, <code>Range</code>, <code>Rows</code>, <code>Columns</code>, etc, references by specifying which sheet they are referring to.</p>\n"}], "owner": {"reputation": 11, "user_id": 8533267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdcb137300486f0fb8598f22b09dd7a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja Octopus", "link": "https://stackoverflow.com/users/8533267/ninja-octopus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504068371, "creation_date": 1504066667, "last_edit_date": 1531164843, "question_id": 45951837, "link": "https://stackoverflow.com/questions/45951837/code-executing-one-time-then-triggering-run-time-error-1004-application-defi", "title": "Code executing one time then triggering &quot;Run-time error &#39;1004&#39;: Application-defined or object-defined error&quot;", "body": "<p>I am doing an excel sheet for a video game to practice my coding because it has been two years since I last used VBA and my training was quite basic. If you don't mind looking at my code and giving me an idea of what might be going, I would greatly appreciate it.</p>\n\n<p>Basically what I am attempting to do is allow the user to \"build\" the character by using drop-down menus on the main sheet. Then by clicking the \"Save\" button, the macro searches the CharacterData sheet (every 10 rows since the table is 9 rows and each table is separated by a space) for the table containing the character's name and updates (overwrites) it. The code works the first time, but then if I try to overwrite again, it will pop up the error. Could it possibly have to do with the data validation drop-down lists or the conditional formatting found in the table?</p>\n\n<p>(Build) <a href=\"https://imgur.com/GbsA4Fv\" rel=\"nofollow noreferrer\">http://imgur.com/GbsA4Fv</a> </p>\n\n<p>(Blank template before overwrite) <a href=\"https://imgur.com/a/wpg6m\" rel=\"nofollow noreferrer\">https://imgur.com/a/wpg6m</a></p>\n\n<p>Sidenote: The goal is that later on the user can use the drop-down menu on the build menu to chose the character they want and click the \"Load\" Button to load in all the data from the CharacterData sheet.</p>\n\n<pre><code>Sub SaveCharacter()\n\nFor i = 0 To 13 Step 1\n    If Worksheets(\"CharacterBuild\").Cells(2, \"C\") = Worksheets(\"CharacterData\").Cells((10 * i) + 1, \"B\") Then\n        m = (10 * i) + 1\n        n = m + 8\n        Worksheets(\"CharacterBuild\").Range(\"B2:G10\").Copy Worksheets(\"CharacterData\").Range(Cells(m, \"A\"), Cells(n, \"F\"))\n        Exit For\n    ElseIf i = 13 Then\n        MsgBox (\"Could not find save file. Must create one on CharacterData sheet.\")\n    End If\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504066538, "post_id": 45951653, "comment_id": 78861881, "body": "Excel may have stopped responding to you, but it is almost certainly still running.  Adding a <code>DoEvents</code> after your <code>Debug.Print i</code> will probably allow it to continue responding.  But you should consider rewriting the code so that it isn&#39;t so slow."}], "answers": [{"comments": [{"owner": {"reputation": 585, "user_id": 1955215, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/96ffd91fc3c892b5810cc3ea805b6da2?s=128&d=identicon&r=PG", "display_name": "user1955215", "link": "https://stackoverflow.com/users/1955215/user1955215"}, "edited": false, "score": 0, "creation_date": 1504102771, "post_id": 45952646, "comment_id": 78884360, "body": "Thanks a ton, Tim, for this brilliant piece of code. It is much faster than I expected and a great improvement over the old code I was using."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 5, "last_activity_date": 1504071399, "creation_date": 1504071399, "answer_id": 45952646, "question_id": 45951653, "link": "https://stackoverflow.com/questions/45951653/excel-stops-responding-while-executing-loop/45952646#45952646", "title": "Excel stops responding while executing loop", "body": "<p>In a quick test this completed a lookup of 200k rows against a table of 100k values in just less than 3 sec.</p>\n\n<p>It's a bit more complex than your original code, but if you want to optimize for speed that's sometimes unavoidable.</p>\n\n<p>Notes:</p>\n\n<ul>\n<li>use a scripting dictionary as a lookup</li>\n<li>read/write all values as arrays for maximum speed</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code> Sub IdentifyMissingsNew()\n\n    Dim ws1 As Worksheet\n    Dim rws As Worksheet, t, arr1, arr2\n    Dim dict As Object, rw As Range, res(), arr, nR As Long, i As Long\n\n    Set ws1 = ThisWorkbook.Sheets(\"New\")\n    Set rws = ThisWorkbook.Sheets(\"DelInt\")\n    Set dict = CreateObject(\"scripting.dictionary\")\n\n    t = Timer\n\n    'create a lookup from two arrays\n    arr1 = rws.Range(\"a1\").CurrentRegion.Columns(1).Value\n    arr2 = rws.Range(\"a1\").CurrentRegion.Columns(3).Value\n    For i = 2 To UBound(arr1, 1)\n        dict(arr1(i, 1)) = arr2(i, 1)\n    Next i\n\n    Debug.Print \"created lookup\", Timer - t\n\n    'get the values to look up\n    arr = ws1.Range(ws1.Range(\"A2\"), ws1.Cells(Rows.Count, 1).End(xlUp))\n    nR = UBound(arr, 1)        '&lt;&lt;number of \"rows\" in your dataset\n    ReDim res(1 To nR, 1 To 1) '&lt;&lt; resize the output array to match\n\n    'perform the lookup\n    For i = 1 To nR\n        If dict.exists(arr(i, 1)) Then\n            res(i, 1) = dict(arr(i, 1))\n        Else\n            res(i, 1) = \"No match!\"\n        End If\n    Next i\n\n    ws1.Range(\"AE2\").Resize(nR, 1).Value = res '&lt;&lt; populate the results\n\n    Debug.Print \"Done\", Timer - t\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 585, "user_id": 1955215, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/96ffd91fc3c892b5810cc3ea805b6da2?s=128&d=identicon&r=PG", "display_name": "user1955215", "link": "https://stackoverflow.com/users/1955215/user1955215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 3, "accepted_answer_id": 45952646, "answer_count": 1, "score": 1, "last_activity_date": 1550773137, "creation_date": 1504065490, "last_edit_date": 1550773137, "question_id": 45951653, "link": "https://stackoverflow.com/questions/45951653/excel-stops-responding-while-executing-loop", "title": "Excel stops responding while executing loop", "body": "<p>ws1lastrow value in the code below is 147583</p>\n\n<p>I am executing the code below from within the VB Editor. Debug.print is used to keep a track of rows processed. ws1lastrow value is 147583</p>\n\n<p>After executing till 5000 or 6000 (every time the count changes), the Excel stops responding and I have to restart and run. </p>\n\n<p>Any reason why this happens and any solutions/tips for handling this?</p>\n\n<pre> \n   Sub IdentifyMissingsNew()\n    Dim ws1 As Worksheet\n    Dim rws As Worksheet\n    Set ws1 = ThisWorkbook.Sheets(\"New\")\n    Set rws = ThisWorkbook.Sheets(\"DelInt\")\n    ws1lastrow = ws1.Cells(Rows.Count, 1).End(xlUp).Row\n    Set lookuprange = rws.Range(\"a1\").CurrentRegion\n    For i = 2 To ws1lastrow\n    ws1.Cells(i, \"ae\") = Application.VLookup(ws1.Cells(i, \"a\"), lookuprange, 3, False)\n    Debug.Print i\n    Next i\n    End Sub\n</pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1504064068, "post_id": 45951258, "comment_id": 78861306, "body": "Not sure in Access, but in Excel UserForm, you should be putting event on <code>txtDiscount_Change</code> for the discount label to show/hide automatically: <code>Me.lblDiscount.Visible = (Me.txtDiscount.Value &gt; 0)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1504085466, "creation_date": 1504085466, "answer_id": 45956778, "question_id": 45951258, "link": "https://stackoverflow.com/questions/45951258/make-a-label-and-text-discount-appear-in-report-when-the-number-more-than-0/45956778#45956778", "title": "Make a Label and Text (Discount) appear in report when the number (more than 0) enter at form", "body": "<p>In a form, it would be something like this:</p>\n\n<pre><code>Private Sub txtDiscount_AfterUpdate()\n\n    Me!lblDiscount.Visible = (Me.txtDiscount.Value &gt; 0)\n\nEnd Sub\n</code></pre>\n\n<p>In a report, you could use the <em>Format</em> event of the section of the report where the label is located.</p>\n"}], "owner": {"reputation": 21, "user_id": 8535634, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bMnRykPnPBY/AAAAAAAAAAI/AAAAAAAAAI8/2WjFn-0MFUc/photo.jpg?sz=128", "display_name": "wans39", "link": "https://stackoverflow.com/users/8535634/wans39"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1504085466, "creation_date": 1504062434, "last_edit_date": 1504063798, "question_id": 45951258, "link": "https://stackoverflow.com/questions/45951258/make-a-label-and-text-discount-appear-in-report-when-the-number-more-than-0", "title": "Make a Label and Text (Discount) appear in report when the number (more than 0) enter at form", "body": "<p>I had some difficulty to make the VBA or macro to do this function. basically, I'm making an MS access for sale service system and the system required of the discount section. the concept is when the user enters the percentage of discount in form site and also appear in the report when the percentage is 0, the system will hide the discount label.</p>\n\n<p>I try using some VBA code such as </p>\n\n<pre><code>Private Sub txtDiscount_Click(txtDiscount As Integer)\n    If Me.txtDiscount.Value = 0 Then\n        Me.lblDiscount.Visible = False\n    Else\n        Me.lblDiscount.Visible = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>but I don't how to make it work when press F5 it pop up macro name. I'm request expert to solve my problem. may show me some step to execute the VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1504054911, "post_id": 45950239, "comment_id": 78859460, "body": "Why not doing it via formula? <code>=$B$1&amp;A7&amp;&quot;,&quot;&amp;B7</code> for E7 and then copy down should do the trick"}, {"owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "edited": false, "score": 1, "creation_date": 1504057392, "post_id": 45950239, "comment_id": 78859986, "body": "That was what the line [  .Offset(0, 2) = &quot;CSWAH_&quot; &amp; lastN &amp; &quot;, &quot; &amp; firstN  ] was supposed to do in my answer for <a href=\"https://stackoverflow.com/questions/45929082/copy-over-column-data-and-adding-vba-right-function\" title=\"copy over column data and adding vba right function\">stackoverflow.com/questions/45929082/&hellip;</a>   You could substitute sepSh.Range($B$1) for &quot;CSWAH_&quot; in that line"}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1504068043, "creation_date": 1504068043, "answer_id": 45952028, "question_id": 45950239, "link": "https://stackoverflow.com/questions/45950239/how-to-merge-3-cells-with-using-an-absolute-cell-reference-in-vba/45952028#45952028", "title": "How to merge 3 cells with using an absolute cell reference in VBA", "body": "<p>Try this.</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim lastRow As Long\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")      'change Sheet1 to your data sheet\n    With ws\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row 'last row with data using Column A\n        Set rng = .Range(\"E7:E\" &amp; lastRow)               'set range in Column E\n        rng.Formula = \"=$B$1&amp;\"\"_\"\"&amp;A7&amp;\"\",\"\"&amp;B7\"          'enter formula in range\n        rng.Value = rng.Value                            'display values in range\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tgyQc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tgyQc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8503682, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e2cfed33a4c8296400965e4d6652ee10?s=128&d=identicon&r=PG&f=1", "display_name": "user8503682", "link": "https://stackoverflow.com/users/8503682/user8503682"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504068043, "creation_date": 1504053774, "last_edit_date": 1592644375, "question_id": 45950239, "link": "https://stackoverflow.com/questions/45950239/how-to-merge-3-cells-with-using-an-absolute-cell-reference-in-vba", "title": "How to merge 3 cells with using an absolute cell reference in VBA", "body": "<p>Trying to put together a VBA macro Im trying to reference Sheet1A8(CSWAH_) as an absolute cell reference and merge  SeparateA7(Last Name) and SeperateB7(First Name) so they'll display in SeperateE7(ASA Naming) and be able to carry it all the way down from E7 to E100.\nIs something like this even possible?</p>\n<p><a href=\"https://i.stack.imgur.com/odsnu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/odsnu.png\" alt=\"Excel VBA Macro\" /></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1504051023, "post_id": 45949834, "comment_id": 78858516, "body": "Tried <code>SaveCopyAs</code> ?"}, {"owner": {"reputation": 402, "user_id": 6807003, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5f1f23a80ed5f34e1e7c29d2aaabc674?s=128&d=identicon&r=PG&f=1", "display_name": "lostinOracle", "link": "https://stackoverflow.com/users/6807003/lostinoracle"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1504052788, "post_id": 45949834, "comment_id": 78858972, "body": "@TimWilliams that works. thank you."}], "owner": {"reputation": 402, "user_id": 6807003, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5f1f23a80ed5f34e1e7c29d2aaabc674?s=128&d=identicon&r=PG&f=1", "display_name": "lostinOracle", "link": "https://stackoverflow.com/users/6807003/lostinoracle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504050176, "creation_date": 1504050176, "last_edit_date": 1531164843, "question_id": 45949834, "link": "https://stackoverflow.com/questions/45949834/how-to-export-workbook-to-new-excel-workbook-but-keep-original-file-open", "title": "How to export workbook to new excel workbook, but keep original file open", "body": "<p>How do I export an open workbook to a new workbook, while keeping the originally opened workbook open? I believe this is related to my using the .saveAs function, is there another way of exporting a workbook so I can keep the original workbook open? </p>\n\n<pre><code>Sub exportXLS()\nDim MyPath As String\nDim MyFileName As String\n\nanswer = MsgBox(\"Do you want to export to Excel?\", vbYesNo + vbQuestion, \"Export to Excel\")\n    If answer = vbYes Then\n        Call reportR\n        Call reportS\n        Sheet27.Calculate\n        MyFileName = Application.GetSaveAsFilename(Year(Now()) &amp; \" - \" &amp; Format(Month(Now()), \"00\"), \"Excel Macro-Enabled Workbook (*.xlsm), *.xlsm\", , \"Save As XLSM file\")\n        If MyFileName &lt;&gt; \"False\" Then\n            ActiveWorkbook.SaveAs Filename:=MyFileName, FileFormat:=xlOpenXMLWorkbookMacroEnabled\n        End If\n    End If\nend sub()\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504059207, "post_id": 45949531, "comment_id": 78860314, "body": "what kind of actions are you wanting to perform ?"}, {"owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504069709, "post_id": 45949531, "comment_id": 78862700, "body": "Thanks for the answer! I need to click the &quot;OK&quot; button in the print dialog in the IE browser to automate the printing process. During the operation of the macro, a new IE browser window opens with the print dialog box already open. I want that when a new browser window appears with the print dialog box, you can automatically start the printing process by clicking the &quot;OK&quot; button in the dialog box."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504070361, "post_id": 45949531, "comment_id": 78862901, "body": "have you done research on the internet?  .... i just did a search for <code>print in IE using vba</code> and got a very useful hit"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504070462, "post_id": 45949531, "comment_id": 78862944, "body": "why is the new IE window opening with the print dialog open? do you have some code running?"}, {"owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504071374, "post_id": 45949531, "comment_id": 78863266, "body": "I was looking for an answer to this question on the Internet, but I did not find it. A new window of the IE browser opens with an already open print dialog box because during the operation of the macro the web form on the site is filled and then the &quot;print&quot; button on the site is pressed. After clicking this button, a new IE window opens with the printable document and the already opened IE print dialog box. For automation, I need to track the appearance of the IE print dialog box and immediately start printing. I tried to press SendKeys when the print window appeared, but it did not work."}, {"owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504071527, "post_id": 45949531, "comment_id": 78863315, "body": "I read about the printing method via OLECMDID_PRINT. As I understand it, this command opens the IE print dialog box?"}, {"owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504094287, "post_id": 45949531, "comment_id": 78877487, "body": "Can anybody help me? :-("}], "owner": {"reputation": 9, "user_id": 8454059, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/539d1172022a1d93913753b190cf2fa9?s=128&d=identicon&r=PG&f=1", "display_name": "footballplayer", "link": "https://stackoverflow.com/users/8454059/footballplayer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504049038, "creation_date": 1504047920, "last_edit_date": 1531164843, "question_id": 45949531, "link": "https://stackoverflow.com/questions/45949531/ie-browser-print-dialog-box", "title": "IE browser print dialog box", "body": "<p>Please help me.\nHow can I find out if the IE Print dialog box is open in the IE browser? I need to keep track of whether the IE print dialog is open to perform actions if the print window is open. I will be grateful for any help.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504056205, "post_id": 45949409, "comment_id": 78859719, "body": "you &quot;before&quot; paragraph example is incorrect. have another look at your paragraphs. then think about what you are replacing with what"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1504057620, "creation_date": 1504057620, "answer_id": 45950654, "question_id": 45949409, "link": "https://stackoverflow.com/questions/45949409/word-vba-macro-to-clean-empty-paragraphs-and-add-space-after-before/45950654#45950654", "title": "Word VBA Macro to Clean Empty Paragraphs and Add space after &amp; before", "body": "<p>You need to do this with a loop and start from the end of the document so that deleted paragraphs are eliminated from the count.</p>\n\n<pre><code>Sub FormatParagraphs()\n\n    Dim Para As Paragraph\n    Dim i As Long\n\n    Application.ScreenUpdating = False\n    With ActiveDocument\n        For i = .Paragraphs.Count To 1 Step -1\n            Set Para = .Paragraphs(i)\n            With Para\n                If .Range.End - .Range.Start = 1 Then\n                    .Range.Delete\n                Else\n                    .SpaceBefore = 6\n                    .SpaceAfter = 6\n                End If\n            End With\n        Next i\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8308803, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/732c91f8a4375cfa03c6363741d8f948?s=128&d=identicon&r=PG&f=1", "display_name": "Henrique Muzzi", "link": "https://stackoverflow.com/users/8308803/henrique-muzzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2031, "favorite_count": 0, "accepted_answer_id": 45950654, "answer_count": 1, "score": 0, "last_activity_date": 1504057620, "creation_date": 1504047109, "last_edit_date": 1504047284, "question_id": 45949409, "link": "https://stackoverflow.com/questions/45949409/word-vba-macro-to-clean-empty-paragraphs-and-add-space-after-before", "title": "Word VBA Macro to Clean Empty Paragraphs and Add space after &amp; before", "body": "<p>I have this little macro whose purpose is to remove all the empty paragraphs (^p) and then select all paragraphs and add space after and before (6 points each).</p>\n\n<p>This is the code so far</p>\n\n<pre><code>Sub format()\n\nActiveDocument.Range.Select\n\n' Selection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n.text = \"^p^p\"\n.Replacement.text = \"\"\n.Forward = True\n.Wrap = wdFindContinue\n.Format = False\n.MatchCase = False\n.MatchWholeWord = False\n.MatchByte = False\n.MatchAllWordForms = False\n.MatchSoundsLike = False\n.MatchWildcards = False\n.MatchFuzzy = False\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n\n\niParCount = ActiveDocument.Paragraphs.Count\nFor J = 1 To iParCount\n    ActiveDocument.Paragraphs(J).SpaceAfter = 6\n    ActiveDocument.Paragraphs(J).SpaceBefore = 6\nNext J\nEnd Sub\n</code></pre>\n\n<p>However when I run it, everything becomes a single paragraph. Supose I have like (^p are empty paragraphs)</p>\n\n<pre><code>paragraph 1 \n^p\nparagraph 2 \n^p\nparagraph 3\n</code></pre>\n\n<p>I always get </p>\n\n<pre><code>paragraph 1 paragraph 2 paragraph 3\n</code></pre>\n\n<p>What am I doing wrong? Thanks!</p>\n"}, {"tags": ["vba", "excel", "spreadsheet", "concat"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504047187, "post_id": 45949271, "comment_id": 78857527, "body": "If you want to use a <code>&quot;d&quot;</code> format for your days instead of a <code>&quot;dd&quot;</code> format, change <code>sDay = Addth(Format((dBasis + J - 1), &quot;dd&quot;))</code> to <code>sDay = Addth(Format((dBasis + J - 1), &quot;d&quot;))</code>.  <code>sDay</code> will then take values such as <code>1st</code>, <code>2nd</code>, <code>3rd</code>, <code>4th</code>, ...<code>22nd</code>, ...<code>30th</code>, <code>31st</code>."}, {"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504047507, "post_id": 45949271, "comment_id": 78857599, "body": "right then i get the order 10th, 11th, 12th...19th, 1st, 20th, 21st....29th, 2nd, 30th, 3rd, 4th, 5th, 6th, 7th, 8th, 9th.  I want the order to be 1st to 31st in order."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504048110, "post_id": 45949271, "comment_id": 78857763, "body": "Sorry - the question didn&#39;t mention the sorting of sheets you are doing after you create them, so I didn&#39;t notice it.  From the looks of your code, I think you can keep them in order if you remove the final <code>For j</code> loop that is sorting them into alphabetical order.  (As far as I can see, prior to that loop they are in numerical order.)  And, of course, remove the <code>Addth (sDay)</code> line which will crash out.  And the <code>If sDay &lt;= 9 Then sDay = Format((dBasis + J - 1), &quot;d&quot;)</code> line is redundant."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1504048259, "post_id": 45949271, "comment_id": 78857809, "body": "Tested - removing the final loop will leave them in the correct order."}, {"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1504048652, "post_id": 45949271, "comment_id": 78857910, "body": "Thanks, can you post as answer?"}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "edited": false, "score": 0, "creation_date": 1504062876, "post_id": 45949731, "comment_id": 78861061, "body": "does anyone have code for this in javascript for google docs?"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1504049386, "creation_date": 1504049386, "answer_id": 45949731, "question_id": 45949271, "link": "https://stackoverflow.com/questions/45949271/vba-sub-to-create-excel-sheets-for-days-of-month-change-01-31-to-1st-to-31st/45949731#45949731", "title": "VBA Sub to create Excel Sheets for Days of Month Change 01-31 to 1st to 31st", "body": "<p>In order to display dates using a <code>\"d\"</code> format (i.e. single digit output for single digit days, and double digit output for double digit days) instead of in a <code>\"dd\"</code> format (i.e. double digit output for both single and double digit days), you should change the line saying</p>\n\n<pre><code>sDay = Addth(Format((dBasis + J - 1), \"dd\"))\n</code></pre>\n\n<p>to be</p>\n\n<pre><code>sDay = Addth(Format((dBasis + J - 1), \"d\"))\n</code></pre>\n\n<hr>\n\n<p>Your refactored <code>DoDays</code> code could be:</p>\n\n<pre><code>Sub DoDays()\n    Dim J As Long\n    Dim sDay As String\n    Dim iTarget As Integer\n    Dim dBasis As Date\n\n    iTarget = 13\n    While (iTarget &lt; 1) Or (iTarget &gt; 12)\n        iTarget = Val(InputBox(\"Numeric month?\"))\n        If iTarget = 0 Then Exit Sub\n    Wend\n\n    Application.ScreenUpdating = False\n    'I changed this next line because I live in a dd/mm/yyyy locale, and your\n    'existing line was specific to a mm/dd/yyyy locale.  Using DateSerial gets\n    'rid of those sort of issues.\n    dBasis = DateSerial(Year(Now()), iTarget, 1)\n\n    For J = 1 To 31\n        sDay = Addth(Format(dBasis + J - 1, \"d\"))\n\n        'This line will crash once \"sDay\" is \"1st\" because \"st\" isn't numeric\n        'i.e. CLng(VBA.Right(pNumber, 1)) will get upset with it\n        '(I assume it was only in your code while you were testing various things.)\n        'Addth (sDay)\n\n        If Month(dBasis + J - 1) &lt;&gt; iTarget Then\n            Exit For ' No use processing 30 and 31 if no 29th in this month\n        End If\n\n        If J &lt;= Worksheets.Count Then\n            If Left(Worksheets(J).Name, 5) = \"Sheet\" Then\n                Worksheets(J).Name = sDay\n            Else\n                Worksheets.Add.Move After:=Worksheets(Worksheets.Count)\n                ActiveSheet.Name = sDay\n            End If\n        Else\n            Worksheets.Add.Move After:=Worksheets(Worksheets.Count)\n            ActiveSheet.Name = sDay\n        End If\n    Next J\n\n    'This loop sorts sheets into alphabetic order, and is not needed because\n    ' sheets are desired to be in existing order\n    'For J = 1 To (Sheets.Count - 1)\n    '    For K = J + 1 To Sheets.Count\n    '        If Right(Sheets(J).Name, 10) &gt; _\n    '          Right(Sheets(K).Name, 10) Then\n    '            Sheets(K).Move Before:=Sheets(J)\n    '        End If\n    '    Next K\n    'Next J\n\n    Worksheets(1).Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1504063093, "creation_date": 1504063093, "answer_id": 45951345, "question_id": 45949271, "link": "https://stackoverflow.com/questions/45949271/vba-sub-to-create-excel-sheets-for-days-of-month-change-01-31-to-1st-to-31st/45951345#45951345", "title": "VBA Sub to create Excel Sheets for Days of Month Change 01-31 to 1st to 31st", "body": "<ul>\n<li>Determine how many days in the month</li>\n<li>Add that many worksheets to the workbook</li>\n<li>Rename the Worksheets</li>\n</ul>\n\n<p>Note: I created an array to ordinal numbers from 1 to 31.  In this way, the day number will return the correct ordinal name.</p>\n\n<pre><code>Sub DoDays2()\n    Dim iMonth As Integer, DaysInMonth As Integer, i1stSheet As Integer, x As Integer\n\n    Do\n        iMonth = Val(InputBox(\"Numeric month?\"))\n        If iMonth = 0 Then\n            Exit Sub\n        ElseIf iMonth &gt;= 1 And iMonth &lt;= 12 Then\n            Exit Do\n        End If\n    Loop\n\n    DaysInMonth = Day(DateSerial(Year(Now), iMonth + 1, 1) - 1)\n\n    'For some reason the Worksheets are actually inserted before the last Worksheet.\n    Worksheets.Add After:=Worksheets(Worksheets.Count), Count:=DaysInMonth\n    i1stSheet = Worksheets.Count - DaysInMonth\n\n    For x = 0 To DaysInMonth - 1\n        Worksheets(i1stSheet + x).Name = Split(\"1st 2nd 3rd 4th 5th 6th 7th 8th 9th 10th 11th 12th 13th 14th 15th 16th 17th 18th 19th 20th 21st 22nd 23rd 24th 25th 26th 27th 28th 29th 30th 31st\", \" \")(x)\n    Next\n\n    'Move the worksheet Back\n    Worksheets(Worksheets.Count).Move Before:=Worksheets(\"1st\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 7607601, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10100582614592907/picture?type=large", "display_name": "Brian Wiley", "link": "https://stackoverflow.com/users/7607601/brian-wiley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 45949731, "answer_count": 2, "score": 0, "last_activity_date": 1504063093, "creation_date": 1504046193, "last_edit_date": 1531164843, "question_id": 45949271, "link": "https://stackoverflow.com/questions/45949271/vba-sub-to-create-excel-sheets-for-days-of-month-change-01-31-to-1st-to-31st", "title": "VBA Sub to create Excel Sheets for Days of Month Change 01-31 to 1st to 31st", "body": "<p>I have found this VBA Sub to rename sheets for the days of the month but I want to change the out put of the names.  Currently it goes 01, 02, 03, 04 .... 30, 31.  I want it to go 1st, 2nd, 3rd, 4th, ...22nd, ...30th, 31st.  Here is code.  I was able to add post string with this function as well but still have the leading zeros in the less than 10 values.</p>\n\n<pre><code>Function Addth(pNumber As String) As String\n'UpdatebyExtendoffice20160628\nSelect Case CLng(VBA.Right(pNumber, 1))\n    Case 1\n    Addth = pNumber &amp; \"st\"\n    Case 2\n    Addth = pNumber &amp; \"nd\"\n    Case 3\n    Addth = pNumber &amp; \"rd\"\n    Case Else\n    Addth = pNumber &amp; \"th\"\nEnd Select\nSelect Case VBA.CLng(VBA.Right(pNumber, 2))\n    Case 11, 12, 13\n    Addth = pNumber &amp; \"th\"\nEnd Select\nEnd Function\n\n\nSub DoDays()\n    Dim J As Integer\n    Dim K As Integer\n    Dim sDay As String\n    Dim sTemp As String\n    Dim iTarget As Integer\n    Dim dBasis As Date\n\n    iTarget = 13\n    While (iTarget &lt; 1) Or (iTarget &gt; 12)\n        iTarget = Val(InputBox(\"Numeric month?\"))\n        If iTarget = 0 Then Exit Sub\n    Wend\n\n    Application.ScreenUpdating = False\n    sTemp = Str(iTarget) &amp; \"/1/\" &amp; Year(Now())\n    dBasis = CDate(sTemp)\n\n    For J = 1 To 31\n        sDay = Addth(Format((dBasis + J - 1), \"dd\"))\n\n        Addth (sDay)\n\n\n        If Month(dBasis + J - 1) = iTarget Then\n\n            If J &lt;= Sheets.Count Then\n                If Left(Sheets(J).Name, 5) = \"Sheet\" Then\n                    Sheets(J).Name = sDay\n                Else\n                    Sheets.Add.Move after:=Sheets(Sheets.Count)\n                    ActiveSheet.Name = sDay\n                    If sDay &lt;= 9 Then sDay = Format((dBasis + J - 1), \"d\")\n                End If\n            Else\n                Sheets.Add.Move after:=Sheets(Sheets.Count)\n                ActiveSheet.Name = sDay\n            End If\n        End If\n    Next J\n\n    For J = 1 To (Sheets.Count - 1)\n        For K = J + 1 To Sheets.Count\n            If Right(Sheets(J).Name, 10) &gt; _\n              Right(Sheets(K).Name, 10) Then\n                Sheets(K).Move Before:=Sheets(J)\n\n            End If\n        Next K\n    Next J\n\n\n    Sheets(1).Activate\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "customization", "ribbon"], "comments": [{"owner": {"reputation": 11, "user_id": 8534931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9291075ee570d9a93ede57020eb0010?s=128&d=identicon&r=PG&f=1", "display_name": "codenovice31415", "link": "https://stackoverflow.com/users/8534931/codenovice31415"}, "edited": false, "score": 0, "creation_date": 1504403369, "post_id": 45949244, "comment_id": 78998984, "body": "I&#39;ve given up on this one and implemented the desired functionality via a custom right click menu.    If anyone has an idea I&#39;d still welcome it."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1504952671, "post_id": 45949244, "comment_id": 79221505, "body": "Show xml and code (if not using USysRibbons). Macros have to be enabled (trusted location). You tried <a href=\"http://www.accessribbon.de/en/?Downloads:3\" rel=\"nofollow noreferrer\">SampleRibbon3</a>. Provide a sample db."}], "owner": {"reputation": 11, "user_id": 8534931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9291075ee570d9a93ede57020eb0010?s=128&d=identicon&r=PG&f=1", "display_name": "codenovice31415", "link": "https://stackoverflow.com/users/8534931/codenovice31415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504056943, "creation_date": 1504045966, "last_edit_date": 1504056943, "question_id": 45949244, "link": "https://stackoverflow.com/questions/45949244/access-2010-custom-ribbon-is-not-working", "title": "Access 2010 Custom Ribbon is not working", "body": "<p>I am running a FE BE setup and want to provide a custom Ribbon to all users of the FE.  I have tried to create a custom ribbon by creating the USysRibbons table.  I am successful at least in this to the extent that when I go into the options for the current database I can select the new ribbons as the default ribbon.  However when I close and reopen the DB the ribbon has not changed.  Fearing I got the xml all wrong I downloaded the sample ribbons 2 DB found here: <a href=\"http://www.accessribbon.de/en/?Downloads\" rel=\"nofollow noreferrer\">http://www.accessribbon.de/en/?Downloads</a></p>\n\n<p>I then tried to set one of those custom ribbons as the default for that DB and it did not work.  Similarly I have tried to set one of the custom ribbons to the Ribbon Name property of a form and launching that form does not change the ribbon. I have set the add-in user interface errors to show and do not get errors when the database loads. I suspect the issue is with the security posture of our computers (just a guess).  If that is a case changing the security settings will be a non starter with my IT group.</p>\n\n<p>At the end of the day I need a pared down menu that includes the ability to export reports for the FE of my DB.  I can achieve this by customizing the ribbon and using macros for the buttons, but of course this only works for my computer.  I need a way to push this ribbon to all users.  So I either need the USysRibbons method to work or I need a way to programmatically import my customization file when the FE loads (or when the first form of my FE loads).</p>\n\n<p>Any thoughts on pitfalls that might be preventing the USysRibbons from displaying, or on a way to automate the ribbon file import?</p>\n"}, {"tags": ["excel", "vba", "path", "filepath", "short"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1504048206, "post_id": 45948905, "comment_id": 78857794, "body": "What&#39;s your code doing? &quot;I need XYZ, can someone do it for me&quot; isn&#39;t a valid question to ask on this site. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 1, "user_id": 8534848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69236449d1b6c9226e1d587931ee74b4?s=128&d=identicon&r=PG&f=1", "display_name": "TobesW", "link": "https://stackoverflow.com/users/8534848/tobesw"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1504103451, "post_id": 45948905, "comment_id": 78884912, "body": "I want the code to take a list of folder addresses, and convert them from the regular windows file path (example of one is above in the original question), to the short path format which is DOS/8.3 format. I have nearly 3000 paths to convert so I want column A to be the originals, and then spit out the short path version in column B. I don&#39;t have a code to post and say &quot;here is what I have so far&quot; because this isn&#39;t exactly my forte as stated above. I am just looking for some guidance or example codes so I can understand where to start."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8534848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69236449d1b6c9226e1d587931ee74b4?s=128&d=identicon&r=PG&f=1", "display_name": "TobesW", "link": "https://stackoverflow.com/users/8534848/tobesw"}, "edited": false, "score": 0, "creation_date": 1504045655, "post_id": 45949117, "comment_id": 78857090, "body": "Sorry I should have been clear on that, they are folders not files. So when the path/address is opened it will open the folder in question and the user can look at what they need specifically inside. Will this code still work for a folder and not a PDF (or some other type of actual file)?"}, {"owner": {"reputation": 1, "user_id": 8534848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69236449d1b6c9226e1d587931ee74b4?s=128&d=identicon&r=PG&f=1", "display_name": "TobesW", "link": "https://stackoverflow.com/users/8534848/tobesw"}, "edited": false, "score": 0, "creation_date": 1504045829, "post_id": 45949117, "comment_id": 78857126, "body": "Also, its going to get very tedious to paste the location of the folders in the red quotations, is there a way to have the sub automatically do this by looking at the current column I have, taking the location I listed, and putting it into those red quotations?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 1, "user_id": 8534848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69236449d1b6c9226e1d587931ee74b4?s=128&d=identicon&r=PG&f=1", "display_name": "TobesW", "link": "https://stackoverflow.com/users/8534848/tobesw"}, "edited": false, "score": 0, "creation_date": 1504046479, "post_id": 45949117, "comment_id": 78857312, "body": "I&#39;ve changed the routine to a function that you can use in a cell formula"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1504054030, "post_id": 45949117, "comment_id": 78859276, "body": "Maybe I got something wrong here. I was going to show an example why this may lead to problems, however: Using your script, it always outputs the long file path... <code>?GetShortPath(&quot;U:\\this is the new folder\\this is the new text file.txt&quot;)</code> returns &quot;U:\\this is the new folder\\this is the new text file.txt&quot; (folder &amp; file do exist)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1504054332, "post_id": 45949117, "comment_id": 78859336, "body": "@DirkReichel The function works OK for me on existing file or folder paths."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1504054451, "post_id": 45949117, "comment_id": 78859358, "body": "@DirkReichel Try it against a file on your <code>C:</code> drive, or a drive implementing NTFS/FAT32. <code>GetShortPath(&quot;C:\\Program Files (x86)\\Microsoft Office&quot;)</code> returns <code>C:\\PROGRA~2\\MICROS~2</code>. I suspect your <code>U:</code> drive is not a Windows drive, and there isn&#39;t any DOS version of the file name."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1504054639, "post_id": 45949117, "comment_id": 78859400, "body": "You are right. <code>U:</code> is a hosted network drive. Thanks for the clarification :)"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 3, "last_activity_date": 1504046453, "last_edit_date": 1504046453, "creation_date": 1504045123, "answer_id": 45949117, "question_id": 45948905, "link": "https://stackoverflow.com/questions/45948905/how-do-i-convert-a-list-of-file-paths-to-their-short-file-path-dos-8-3-format/45949117#45949117", "title": "How do I convert a list of file paths to their short file path, DOS/8,3 format, using a macro in VBA?", "body": "<p>The <code>FileSystemObject</code> can help you here. It's not clear whether your paths are files or folders, and whether you want just the folder/file shortname, or the entire path in short name format. I've allowed for either Folders or Files (and I check if they exist before trying to get their path), and I return the full path in short name format.</p>\n\n<p><strong>EDIT - Adapted to be used as a worksheet function</strong></p>\n\n<p>You can now use this function in a cell like <code>B1</code> with a formula like: <code>=GetShortPath(A1)</code></p>\n\n<pre><code>Option Explicit\n\nPublic Function GetShortPath(path As String) As String\n\n  'Add a reference to Microsoft Scripting Runtime\n\n  Static fso As FileSystemObject\n  If fso Is Nothing Then\n      Set fso = New FileSystemObject\n  End If\n\n  'If the path is a file - Output the full path in 8.3 format\n  If fso.FileExists(path) Then\n      GetShortPath =  fso.GetFile(path).ShortPath\n      Exit Function\n  End If\n\n  'If the path is a folder - Output the full path in 8.3 format\n  If fso.FolderExists(path) Then\n      GetShortPath = fso.GetFolder(path).ShortPath\n      Exit Function\n  End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8534848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69236449d1b6c9226e1d587931ee74b4?s=128&d=identicon&r=PG&f=1", "display_name": "TobesW", "link": "https://stackoverflow.com/users/8534848/tobesw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1480, "favorite_count": 0, "closed_date": 1504068772, "answer_count": 1, "score": -2, "last_activity_date": 1504106317, "creation_date": 1504043866, "last_edit_date": 1504106317, "question_id": 45948905, "link": "https://stackoverflow.com/questions/45948905/how-do-i-convert-a-list-of-file-paths-to-their-short-file-path-dos-8-3-format", "closed_reason": "Needs more focus", "title": "How do I convert a list of file paths to their short file path, DOS/8,3 format, using a macro in VBA?", "body": "<p>I have a list of file paths in cells in Excel that locate to sets of folders, example:</p>\n\n<pre><code>**Start:** G:\\TSB\\Bridge Shared\\Bridge Plans\\Bridge Plans-SCANNED\\2574 35_Long Creek\n</code></pre>\n\n<p><strong>Want this:</strong> G:\\TSB\\Bridge~1\\Bridge~1\\Bridge~1\\2574 35~1 (I wrote this by hand so it might not be perfect but hopefully you get what I mean)</p>\n\n<p>I have nearly 3000 file paths listed in Excel but would like them to be displayed in the short file path format, DOS or 8.3 format is what it is called I believe. </p>\n\n<p>Basically I have the folder locations listed in column A in Excel, and I want a macro to run that looks at each individual path and converts it to short path version in column B. There has to be some way to do this automatically and not one by one?</p>\n\n<p>Any help would be appreciated, just can't seem to find anything online to get me started as I am a beginner in VBA.</p>\n"}, {"tags": ["regex", "ms-access", "vbscript", "vba"], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 7150108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6275ac0064e7ad3bebdd8eaa196b0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Beth", "link": "https://stackoverflow.com/users/7150108/emily-beth"}, "edited": false, "score": 0, "creation_date": 1504046261, "post_id": 45948946, "comment_id": 78857246, "body": "Wow that was fast!  The one thing I think might need a tweak is the code for the subproject number.  This isn&#39;t just &quot;one or more digits.&quot;  It&#39;s exactly three digits.  So I think the tweak would be to simply change \\d+ to \\d{3}.  Seems to work.  That sound correct?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 485, "user_id": 7150108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6275ac0064e7ad3bebdd8eaa196b0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Beth", "link": "https://stackoverflow.com/users/7150108/emily-beth"}, "edited": false, "score": 0, "creation_date": 1504046337, "post_id": 45948946, "comment_id": 78857274, "body": "@EmilyFTW:  If the number of digits is always 3, yes, use <code>\\d{3}</code>."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1504044095, "creation_date": 1504044095, "answer_id": 45948946, "question_id": 45948898, "link": "https://stackoverflow.com/questions/45948898/validating-access-project-number-field-via-vba-and-regex/45948946#45948946", "title": "Validating Access project number field via VBA and regex", "body": "<p>Use</p>\n\n<pre><code>^[A-Z]{2}\\d{2}-[1-9]\\d*-\\d+(?: [A-Z]{2}\\d{2}-[1-9]\\d*-\\d+)*$\n</code></pre>\n\n<p>See the <a href=\"http://%5E[A-Z]%7B2%7D%5Cd%7B2%7D-[1-9]%5Cd*-%5Cd+(?:%20[A-Z]%7B2%7D%5Cd%7B2%7D-[1-9]%5Cd*-%5Cd%20)*$\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p>The single project code pattern is <code>[A-Z]{2}\\d{2}-[1-9]\\d*-\\d+</code>:</p>\n\n<ul>\n<li><code>[A-Z]{2}</code> - 2 uppercase ASCII letters (NOTE: if <code>objRegEx.IgnoreCase = True</code> then this will also match lowercase ASCII letters)</li>\n<li><code>\\d{2}</code> - 2 digits</li>\n<li><code>-</code> - a hyphen</li>\n<li><code>[1-9]\\d*</code> - a digit from <code>1</code> to <code>9</code> and then 0+ any digits</li>\n<li><code>-</code> - a hyphen</li>\n<li><code>\\d+</code> - 1 or more digits.</li>\n</ul>\n\n<p>The whole pattern is <code>^&lt;code&gt;(?: &lt;code&gt;)*$</code>:</p>\n\n<ul>\n<li><code>^</code> - start of string</li>\n<li><code>&lt;code&gt;</code> - the project code pattern as described above</li>\n<li><code>(?: &lt;code&gt;)*</code> - zero or more sequences of:\n\n<ul>\n<li><code> </code> - a space</li>\n<li><code>&lt;code&gt;</code> - project code pattern as described above</li>\n</ul></li>\n<li><code>$</code> - end of string.</li>\n</ul>\n\n<p>VBA code:</p>\n\n<pre><code>Function IsProjCodeValid(s As String) As Boolean\n    Dim objRegEx As Object\n    Set objRegEx = CreateObject(\"VBScript.RegExp\")\n    objRegEx.IgnoreCase = True\n    objRegEx.Pattern = \"^[A-Z]{2}\\d{2}-[1-9]\\d*-\\d+(?: [A-Z]{2}\\d{2}-[1-9]\\d*-\\d+)*$\"\n\n    IsProjCodeValid = objRegEx.Test(s)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 7150108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6275ac0064e7ad3bebdd8eaa196b0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Beth", "link": "https://stackoverflow.com/users/7150108/emily-beth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 45948946, "answer_count": 1, "score": 1, "last_activity_date": 1594639215, "creation_date": 1504043803, "last_edit_date": 1594639215, "question_id": 45948898, "link": "https://stackoverflow.com/questions/45948898/validating-access-project-number-field-via-vba-and-regex", "title": "Validating Access project number field via VBA and regex", "body": "<p>I want to validate entries into a textbox in my Access form.  The field behind the textbox stores project number(s) that identify each project record.  We currently have a very complicated Do While loop within the textbox's before_update event that successfully validates things, but I'm working on tightening up our code and would like to understand how to do a more elegant regex validation.  Here's the technical details.</p>\n\n<p>Project numbers have a standard format, such as PJ17-14-000, broken into three blocks, separated by dashes.  Here are the rules for each block.</p>\n\n<p>The first block is the project type/fiscal year block.  The first two characters are always alpha characters, and they change to reflect different high-level project types.  PJ, EL, RM, ER are some examples, but these could be any two alpha chars.  Then the next two characters are always numeric, and reflect the fiscal year within which the project started.  PJ17-14-000 started in fiscal year 2017, for instance.</p>\n\n<p>The second block is simply a number indicating the sequence in which projects were established.  So PJ17-1-000 is the first PJ project started in fiscal year 2017.  PJ17-2-000 is the second.  And so on.  There is no theoretical limit to the number of digits in this number, but practically it never exceeds four digits.  <em>But, and this is important, the leading digits can never be zero.</em>  So we never would use a project number such as PJ17-01-000, and the validation should reject such a number.  Instead, the analyst should enter simply PJ17-1-000.</p>\n\n<p>And finally, the last block is always exactly three numeric characters that represent subprojects.  Most projects just have one part (no subprojects), and so the last block is simply 000.  But some have many subprojects, so they may have PJ17-1-001, PJ17-1-002, PJ17-1-003 (and so on) records.  For the third block, the number can (and usually does) have leading zeros.</p>\n\n<p>Those are the rules for the project numbers themselves.  Here's the fun part:  Our database allows analysts to enter multiple project numbers separated by spaces into the project field.  (I know there is a better design that uses linked tables and a subform, but this is our legacy system.)  Why a project would have two numbers is a long complicated story, but sometimes (often) they do, and we have to allow for that.  So a project number field could need (and therefore should allow) an aggregate project number such as \"PJ17-1-000 ER16-143-000 PI16-23-000\".</p>\n\n<p>So the validation should follow the rules above for any single project number, and should allow for any number of project numbers that are separated by exactly one space.  How would I do that?</p>\n\n<p>I started playing around with vbscript.regexp, but couldn't figure out how to tackle this complicated problem.  Appreciate any help on how to make that work, or any other approach that you think would be elegant and easier to read/maintain than our current beast.</p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504056623, "post_id": 45948356, "comment_id": 78859822, "body": "that is an unreachable URL"}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1504073503, "post_id": 45948356, "comment_id": 78864076, "body": "It can&#39;t be reached as it is private web of a organization @jsotola"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1504142729, "creation_date": 1504142729, "answer_id": 45971889, "question_id": 45948356, "link": "https://stackoverflow.com/questions/45948356/extract-data-from-web-page-including-hyperlinks-in-it-using-vba/45971889#45971889", "title": "Extract Data from Web Page including HYPERLINKS in it - using VBA", "body": "<p>Can you just turn on the Macro recorder and click through the steps you need to perform?  I think that's your best bet.  This doesn't seem to be a URL that any Tom, Dick, and harry can access.  Good luck.</p>\n"}], "owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504142729, "creation_date": 1504040917, "question_id": 45948356, "link": "https://stackoverflow.com/questions/45948356/extract-data-from-web-page-including-hyperlinks-in-it-using-vba", "title": "Extract Data from Web Page including HYPERLINKS in it - using VBA", "body": "<p>I have extracted all the required data from a web page. Now the issue is that if the page contains any hyperlink then i have to extract the data with that hyperlinks also.I have attached the code for which the data is extracted.</p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;http://sienna/VBGSIWeb/Production/ItemStatus.aspx?item=\" &amp; PN, _\n        Destination:=Range(\"$N$1\"))\n        .Name = \"ItemStatus.aspx?item=BC-00003\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlOverwriteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = False\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebFormatting = xlWebFormattingNone\n        .WebTables = \"\"\"gvSAPRevHistory\"\"\"\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\n</code></pre>\n\n<p>`</p>\n\n<p>I have also attached the snapshot of the webquerytable.</p>\n\n<p><a href=\"https://i.stack.imgur.com/15i0S.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/15i0S.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>In this I have to copy and paste the CN# to desired cell including hyperlink.</p>\n"}]