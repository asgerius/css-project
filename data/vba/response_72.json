[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1464221111, "post_id": 37449341, "comment_id": 62400712, "body": "Look into <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells()</a>"}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464277653, "post_id": 37449801, "comment_id": 62429748, "body": "Is it possible to modify it so it only picks up columns &quot;S&quot; and &quot;I&quot;?"}], "tags": [], "owner": {"reputation": 126, "user_id": 3954781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTk2C.jpg?s=128&g=1", "display_name": "Altronicx", "link": "https://stackoverflow.com/users/3954781/altronicx"}, "is_accepted": false, "score": 0, "last_activity_date": 1464223343, "creation_date": 1464223343, "answer_id": 37449801, "question_id": 37449341, "link": "https://stackoverflow.com/questions/37449341/transferring-only-visible-rows-without-using-select-or-endxldown/37449801#37449801", "title": "Transferring only visible rows without using .select or .End(xlDown)", "body": "<p>You are probably looking to use the the built-in AutoFilter.Range object of the worksheet.</p>\n\n<pre><code>ActiveSheet.AutoFilter.Range.Copy\nWorkbooks.Add.Worksheets(1).Paste\n</code></pre>\n\n<p><a href=\"http://datapigtechnologies.com/blog/index.php/a-better-way-to-copy-filtered-rows-using-vba/\" rel=\"nofollow\">This link gives the full explanation</a></p>\n"}, {"comments": [{"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464277648, "post_id": 37456566, "comment_id": 62429742, "body": "Is it possible to modify it so it only picks up columns &quot;S&quot; and &quot;I&quot;?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464277698, "post_id": 37456566, "comment_id": 62429769, "body": "What&#39;s the headers of your table?"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464278037, "post_id": 37456566, "comment_id": 62429984, "body": "Person Responsible and Violations"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 1, "creation_date": 1464278124, "post_id": 37456566, "comment_id": 62430056, "body": "Have a look at my updated answer. Using either column positions or header names."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464278233, "post_id": 37456566, "comment_id": 62430127, "body": "Brilliant! Is there anything special about the syntax for pasting them or does it work with just .paste from there? To clarify, I need to paste them into Dashboard B and E in the first currently unused rows."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 1, "creation_date": 1464278290, "post_id": 37456566, "comment_id": 62430159, "body": "It should just work with <code>.paste</code> as normal. All we&#39;ve changed is how we selected the range for copying. You could however avoid copy and paste and just make a range equal to the column. Which would probably use less of an overhead"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464278387, "post_id": 37456566, "comment_id": 62430220, "body": "That is what I was trying to do with Dashboard.Range(&quot;B4:B1000&quot;).Value = PersonResponsible.Value                 Dashboard.Range(&quot;E4:E1000&quot;).Value = Violations.Value but I am not sure how to make it work with just the filtered rows"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 1, "creation_date": 1464279911, "post_id": 37456566, "comment_id": 62431277, "body": "Have a look at the last bit. It is quite a bit different from the others as it uses an array. If you want to use this method (which I highly recommend) You could do your entire data manipulation of the table in the array (i.e. in memory instead of in sheet - much quicker) before feeding back the results to your Dashboard. You could also reference the column positions using the <code>.ListColumns(&quot;Violations&quot;)</code> and <code>.ListColumns(&quot;Person Responsible)</code> methods instead of trying to find their positions"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464280668, "post_id": 37456566, "comment_id": 62431755, "body": "That is exactly what I was hoping to do in the beginning. I just didn&#39;t know how to structure it. I inserted your bottom suggestion of code but I am getting a type mismatch on the temp = line. Any thoughts?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 1, "creation_date": 1464280969, "post_id": 37456566, "comment_id": 62431953, "body": "I&#39;ve just updated it - it&#39;s probably a spelling mistake somewhere (I was free typing in here instead of writing it in the VBA editor)"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464281165, "post_id": 37456566, "comment_id": 62432058, "body": "It is only doing it for the first line of data. Should I just throw it in a loop or is there a better way to get it to move all of the data over?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464281270, "post_id": 37456566, "comment_id": 62432128, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/113059/discussion-between-tom-and-tonyp\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1464282988, "last_edit_date": 1464282988, "creation_date": 1464254313, "answer_id": 37456566, "question_id": 37449341, "link": "https://stackoverflow.com/questions/37449341/transferring-only-visible-rows-without-using-select-or-endxldown/37456566#37456566", "title": "Transferring only visible rows without using .select or .End(xlDown)", "body": "<p>This will only copy the visible rows from your table on the <code>Open_Jobs_Report</code> sheet</p>\n\n<pre><code>Open_Jobs_Report.ListObjects(1).DataBodyRange.SpecialCells(xlCellTypeVisible).Copy\n</code></pre>\n\n<hr>\n\n<p><strong>Update after comments:</strong></p>\n\n<pre><code>With Open_Jobs_Report.ListObjects(1)\n    Union(.ListColumns(9).DataBodyRange, .ListColumns(19).DataBodyRange).Copy\nEnd With\n</code></pre>\n\n<p>Or using header names:</p>\n\n<pre><code>With Open_Jobs_Report.ListObjects(1)\n    Union(.ListColumns(\"Person Responsible\").DataBodyRange, .ListColumns(\"Violations\").DataBodyRange).Copy\nEnd With\n</code></pre>\n\n<p>Thinking a bit more about it this is how I'd probably go about doing it:</p>\n\n<pre><code>Dim Open_Jobs_Report As Worksheet\nDim temp as Variant\n\nSet Open_Jobs_Report = ThisWorkbook.Sheets(\"Open Jobs Report\")\n\ntemp = Open_Jobs_Report.ListObjects(1).DataBodyRange.SpecialCells(xlCellTypeVisible).Value\n\nWith Dashboard\n    .Range(.Cells(4, 2), .Cells(3 + UBound(temp,1), 2)).Value = Application.Index(temp, , 9)\n    .Range(.cells(4, 5), .Cells(3 + UBound(temp, 1), 5)).Value = Application.Index(temp, , 19)\nEnd With\n</code></pre>\n\n<p>This puts the entire visible part of the table into an array in memory and then sets the range equal to the bits you're interested in. </p>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 37456566, "answer_count": 2, "score": 0, "last_activity_date": 1464282988, "creation_date": 1464219763, "question_id": 37449341, "link": "https://stackoverflow.com/questions/37449341/transferring-only-visible-rows-without-using-select-or-endxldown", "title": "Transferring only visible rows without using .select or .End(xlDown)", "body": "<p>The code currently filters the data the way I need it to but when it copies it over it copies everything not just the filtered data. I know I can make it work using .select and then copying and pasting etc. but I would rather avoid that if possible. Any help would be appreciated. </p>\n\n<pre><code>Sub Auto_Filter()\n\n    Dim RNG As Range\n    Dim Open_Jobs_Report As Worksheet\n        Set Open_Jobs_Report = ThisWorkbook.Sheets(\"Open Jobs Report\")\n    Dim Dashboard As Worksheet\n        Set Dashboard = ThisWorkbook.Sheets(\"Dashboard\")\n    Dim PersonResponsible As Range\n    Dim Violations As Range\n    Dim CLM1 As Long\n    Dim CLM2 As Long\n\n\n            With Sheets(\"Open Jobs Report\")\n                Set RNG = .Range(\"A1\", .Cells(.Cells(.Rows.Count, \"A\").End(xlUp).Row, .Cells(1, .Columns.Count).End(xlToLeft).Column))\n                RNG.AutoFilter Field:=19, Criteria1:=\"&lt;&gt;\"\n\n                CLM1 = .Range(\"1:1\").Find(What:=\"Person Responsible\").Column\n                    Set PersonResponsible = .Range(.Cells(1, CLM1), .Cells(1, CLM1).End(xlDown))\n                CLM2 = .Range(\"1:1\").Find(What:=\"Violations\").Column\n                    Set Violations = .Range(.Cells(1, CLM2), .Cells(1, CLM2).End(xlDown))\n\n            End With\n\n\n\n\n\n                Dashboard.Range(\"B4:B1000\").Value = PersonResponsible.Value\n                Dashboard.Range(\"E4:E1000\").Value = Violations.Value\n\n                    Dashboard.Range(\"B4:B1000\").RemoveDuplicates , Header:=xlYes\n                    Dashboard.Range(\"E4:E1000\").RemoveDuplicates , Header:=xlYes\n\n\n\n\n            Open_Jobs_Report.ListObjects(1).AutoFilter.ShowAllData\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1464217238, "creation_date": 1464217238, "answer_id": 37448987, "question_id": 37448636, "link": "https://stackoverflow.com/questions/37448636/excel-vba-insert-array-variable-into-single-field-in-access/37448987#37448987", "title": "Excel VBA insert array variable into single field in access", "body": "<p>MS Access does not have such a data type, more primitive types like string, boolean, long. But consider joining all items in array using <code>Join</code> into a single string and save that string to database table. Then use <code>Split</code> to pull back into array as needed:</p>\n\n<pre><code>Sub ArrayIntoSQL()\n\n   Dim SN(100) As String, TN() As String\n   Dim SNstr As String,\n\n   SN(0) = 123  'value of each entry'\n   SN(1) = 2412\n\n   SNstr = Join(SN, \"|\")   ' PIPE DELIMITER '\n   '123|2412|||||||||||||||||||||||||||||||||||||||||||||_\n    ||||||||||||||||||||||||||||||||||||||||||||||||||||||'\n\n   strSQL = \"INSERT INTO [TableName] ([FieldName]) Values ('\" &amp; SNstr &amp; \"')\"\n   ...\n\nEnd Sub\n\nSub ArrayOutofSQL()\n\n    Dim SN() As String\n    Dim SNstr As String\n\n    strSQL = \"SELECT [FieldName] FROM [TableName]\"\n\n    ...\n\n    Do While Not rst.EOF \n         SN() = Split(rst!FieldName, \"|\")      \n         rst.MoveNext\n    Loop\n    ...\n\nEnd Sub\n</code></pre>\n\n<p>Because the array items may exceed Access' 255 character limit for <em>short text</em> data type, use the <em>long text</em> type (previously called <em>memo</em>) which does not have a declared limit.</p>\n\n<hr>\n\n<p>However for best practices, wide tables (many columns) and stored objects like arrays in fields are more expensive than long tables (many rows) and linked objects. So simply save data iteratively:</p>\n\n<pre><code>For Each item in SN\n    strSQL = \"INSERT INTO [TableName] ([FieldName]) Values (\" &amp; item &amp; \")\"\n    ...\nNext item\n</code></pre>\n\n<p>Of course, save values with an identifier like <code>ID</code>, <code>Person</code>, <code>Date</code>!</p>\n"}], "owner": {"reputation": 23, "user_id": 3787620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1743de397fc305a486f81b3a625a9fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3787620", "link": "https://stackoverflow.com/users/3787620/user3787620"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 37448987, "answer_count": 1, "score": 0, "last_activity_date": 1593958518, "creation_date": 1464214990, "last_edit_date": 1593958518, "question_id": 37448636, "link": "https://stackoverflow.com/questions/37448636/excel-vba-insert-array-variable-into-single-field-in-access", "title": "Excel VBA insert array variable into single field in access", "body": "<p>In my project I'm trying to save indefinite entry in excel sheet into the database (access). I'm trying to use vba to do so. However, because I don't know how long the entries will be, and I can't create so many fields in the database to fit the unknown amount of entries. And I can't INSERT an array variable into one field in the table. How can I do this?</p>\n\n<p>Say I have below.</p>\n\n<pre><code>Dim SN(100) As String\nSN(0)=123    'value of each entry\nSN(1)=2412\n'so on and so many entries\n</code></pre>\n\n<p>Then in the SQL statement,</p>\n\n<pre><code>\"INSERT INTO [TableName] ([FieldName]) Values (SN)\"\n</code></pre>\n\n<p>It will say RunTime Error \"13\" Type mismatch.</p>\n\n<p>Is there any way the database field can accept a list or array as data type? So when I call the data out I can use the index to call the variable inside the list?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464213442, "post_id": 37448241, "comment_id": 62398421, "body": "Don&#39;t understand. You want it hidden in which workbook?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 2, "creation_date": 1464214345, "post_id": 37448241, "comment_id": 62398784, "body": "You need at least one sheet visible. In your code, near the end, you set all sheets to hidden. Try setting &quot;Cover&quot; to True."}, {"owner": {"reputation": 105, "user_id": 6194171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/85a5b03aa381dc9b2ca1a38872588f11?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6194171/eric"}, "edited": false, "score": 0, "creation_date": 1464265709, "post_id": 37448241, "comment_id": 62420691, "body": "My Parent file has (calculation file +9 other sheet). Those 9 sheets are hidden but 9 hidden files take data from calculation file. Once my calculation file is completed I click generate report. It creates NEW FILE which has 9 sheets and doesn&#39;t have calculation file anymore. These 9 sheets come from Parent file (I want them all visible in New file but remain hidden in Parent file). My macro unhides 9 files in parent sheet (which i dont want). and hides file in newly generated file (again which i dont want). So it does reverse of both i want."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464271993, "post_id": 37448241, "comment_id": 62425517, "body": "You switch between saying &#39;sheets&#39; and &#39;files&#39;... which is is please? After your code runs to Unhide, then hide, you never save the original workbook again -- you do a SaveAs -- which creates a new Workbook. Easy part first: in your above code, get rid of all the the ....Visible = False lines of code. That will result in your new workbook sheets being visible."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 6194171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/85a5b03aa381dc9b2ca1a38872588f11?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6194171/eric"}, "edited": false, "score": 0, "creation_date": 1464267598, "post_id": 37448827, "comment_id": 62422035, "body": "Thank you for the help. I will try to implement it."}, {"owner": {"reputation": 105, "user_id": 6194171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/85a5b03aa381dc9b2ca1a38872588f11?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6194171/eric"}, "edited": false, "score": 0, "creation_date": 1465224263, "post_id": 37448827, "comment_id": 62799295, "body": "Is there anyway I can keep 2 sheets Visible.  few diffrent try didnt help.     For Each ws In ActiveWorkbook.Sheets     If ws.Name &lt;&gt; &quot;Calculations&quot; And &quot;Sheet1&quot; Then      ws.Visible = xlSheetVeryHidden  Error: says type mismatch  I also Tried        For Each ws In ActiveWorkbook.Sheets      If ws.Name &lt;&gt; &quot;Sheet1&quot; Then      ws.Visible = xlSheetVeryHidden   Error : control Variable already in use.  Can you please help ? I also have my program in comment box at the bottom"}, {"owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "reply_to_user": {"reputation": 105, "user_id": 6194171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/85a5b03aa381dc9b2ca1a38872588f11?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6194171/eric"}, "edited": false, "score": 0, "creation_date": 1465228688, "post_id": 37448827, "comment_id": 62802221, "body": "Yeah, you can either do it by sheet index or sheet name. But it would look like this <code>If ws.name &lt;&gt; &quot;Cover&quot; and ws.name &lt;&gt; &quot;Other Name&quot; Then</code> or you could use <code>If ws.Index &lt;&gt; 1 and ws.index &lt;&gt; 2 Then</code>. But when you use an AND / OR logic modifier, you have to make a complete statement again."}], "tags": [], "owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "is_accepted": true, "score": 0, "last_activity_date": 1464216164, "creation_date": 1464216164, "answer_id": 37448827, "question_id": 37448241, "link": "https://stackoverflow.com/questions/37448241/how-do-i-use-vba-macro-on-hidden-worksheets-and-hide-them-back/37448827#37448827", "title": "How do I Use VBA Macro on Hidden Worksheets. and Hide them back", "body": "<p>Try hiding and unhiding your sheets like this, it will save you a lot of energy if needing to change later.</p>\n\n<pre><code>Dim ws As Worksheet\n\n'To unhide all sheets\nFor Each ws In ActiveWorkbook.Sheets\n    ws.Visible = xlSheetVisible\nNext\n\n'To hide all sheets except \"Cover\"\nFor Each ws In ActiveWorkbook.Sheets\n    If ws.Name &lt;&gt; \"Cover\" Then\n        ws.Visible = xlSheetHidden\n    End If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1464230305, "post_id": 37449927, "comment_id": 62402730, "body": "That&#39;s cool! Using a comparison where a boolean is expected!! Stored in my Useful file! Come to think of it, I use similar techniques in formulas all the time, but it never occurred to me to do the same in VBA."}, {"owner": {"reputation": 105, "user_id": 6194171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/85a5b03aa381dc9b2ca1a38872588f11?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6194171/eric"}, "edited": false, "score": 0, "creation_date": 1464267446, "post_id": 37449927, "comment_id": 62421901, "body": "Thank you for the help. Sorry I guess didn&#39;t Explain it clearly.  I want to Keep Things hidden in my calculation file(parent file)but still use it in macro on it so those 9 files get pulled as new file. And the NEW file which is generated, It pulls all the 9 hidden files from parent file (Cover+2 - 9). I want All 9 sheets Visible in NEW file, all the time So i can send them as report.   And if someone want to see my parent file all the time i want them to see only calculation worksheet and not mess with other 9 hidden sheets(not want them to know about hidden files).My Macro does reverse."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1464224553, "creation_date": 1464224553, "answer_id": 37449927, "question_id": 37448241, "link": "https://stackoverflow.com/questions/37448241/how-do-i-use-vba-macro-on-hidden-worksheets-and-hide-them-back/37449927#37449927", "title": "How do I Use VBA Macro on Hidden Worksheets. and Hide them back", "body": "<p>Would suggest you tweak this to ensure that <em>Cover</em> exists first.</p>\n\n<p>If so the loop to hide the sheets can be set more directly - doesn't actually need a <em>Then</em> test.</p>\n\n<pre><code>Sub Sheeted()\nDim ws As Worksheet\n\nOn Error Resume Next\nSet ws = Sheets(\"Cover\")\nOn Error GoTo 0\n\nIf ws Is Nothing Then Exit Sub\n\nFor Each ws In ActiveWorkbook.Sheets\n    ws.Visible = (ws.Name = \"Cover\")\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 6194171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/85a5b03aa381dc9b2ca1a38872588f11?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6194171/eric"}, "is_accepted": false, "score": 0, "last_activity_date": 1464288956, "creation_date": 1464288956, "answer_id": 37468966, "question_id": 37448241, "link": "https://stackoverflow.com/questions/37448241/how-do-i-use-vba-macro-on-hidden-worksheets-and-hide-them-back/37468966#37468966", "title": "How do I Use VBA Macro on Hidden Worksheets. and Hide them back", "body": "<p>Thank you guys \nI some how by trial and error and with your help figured it out. \nI just put .close thing which i saw somewhere on this group. </p>\n\n<p>Here is the modified code based on all the suggestions. May have some unnecessary things but somehow it works.\nMany Thanks to you all </p>\n\n<pre><code>Sub SaveMain()\n\nDim Flname As String\nDim ws As Worksheet\n\nApplication.EnableEvents = False\nFor Each ws In ActiveWorkbook.Sheets\nws.Visible = xlSheetVisible\nNext\n\nFlname = \"Pump Datasheet-\" &amp; InputBox(\"Enter Pump tag No P-XXXX:\") &amp; \".xls\"\n\nSheets(Array(\"Cover\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\")).Copy\n\nnewfilename = Flname\n\nWith ActiveWorkbook\n.SaveAs newfilename, FileFormat:=50\n.Close 0\nEnd With\nFor Each ws In ActiveWorkbook.Sheets\nIf ws.Name &lt;&gt; \"Calculations\" Then\n ws.Visible = xlSheetVeryHidden\n End If\n\nNext\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 6194171, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/85a5b03aa381dc9b2ca1a38872588f11?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/6194171/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4722, "favorite_count": 0, "accepted_answer_id": 37448827, "answer_count": 3, "score": 3, "last_activity_date": 1464297711, "creation_date": 1464213104, "last_edit_date": 1464297711, "question_id": 37448241, "link": "https://stackoverflow.com/questions/37448241/how-do-i-use-vba-macro-on-hidden-worksheets-and-hide-them-back", "title": "How do I Use VBA Macro on Hidden Worksheets. and Hide them back", "body": "<p>I am a beginner in VBA excel Macros. By using this forum i could write a code but i am stuck at one place.</p>\n\n<p>I have  10 sheets in a workbook. 1st Sheet is my input worksheet and does all the calculations. These calculations are pulled in later 9 sheets. These 9 sheets generate my report.In calculation file i want to hide all the next 9 files and run the macro. once the calculations are okay. I click a Generate report button and new file is created and opens on my desktop and get saved in my document.</p>\n\n<p>Problem - Somehow going through this forum i was able to generate a code that does everything but i am not able to get Hide and unhide part.\nThe code i wrote unhide all the files from calculation file.(Keeps them unhide) and hides the file in newly generated report.(as all files cannot be hidden in any new excel i get run-time error'1004' unable to set the visible property of the worksheet class). </p>\n\n<p>here is my code please help me solve it - So i can have only 1 sheet in calculation file while rest remain hidden when macro works. And newly generated file will have all the 9 tabs.</p>\n\n<pre><code>Sub SaveMain()\n\nApplication.EnableEvents = False\nSheets(\"Cover\").Visible = True\nSheets(\"2\").Visible = True\nSheets(\"3\").Visible = True\nSheets(\"4\").Visible = True\nSheets(\"5\").Visible = True\nSheets(\"6\").Visible = True\nSheets(\"7\").Visible = True\nSheets(\"8\").Visible = True\nSheets(\"9\").Visible = True\n\nDim Flname As String\n\n\nFlname = \"Pump Datasheet\" &amp; InputBox(\"Enter Pump tag No P-XXXX:\") &amp; \".xls\"\n\nSheets(Array(\"Cover\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\")).Copy\n\nSheets(\"Cover\").Visible = False\nSheets(\"2\").Visible = False\nSheets(\"3\").Visible = False\nSheets(\"4\").Visible = False\nSheets(\"5\").Visible = False\nSheets(\"6\").Visible = False\nSheets(\"7\").Visible = False\nSheets(\"8\").Visible = False\nSheets(\"9\").Visible = False\n\nnewfilename = Flname\n\nWith ActiveWorkbook\n.SaveAs newfilename, FileFormat:=50\n\nEnd With\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464212404, "post_id": 37448060, "comment_id": 62398010, "body": "Try adding <code>Sheets (&quot;data&quot;)</code> before each <code>cells</code>. Edit: also make sure <code>column</code> &gt; 0. Edit2 thanks to Scott: because the computer needs to know <i>which</i> <code>cells</code> you mean. Edit3: in before Scott, Mat or anyone tells me to post answer."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464212518, "post_id": 37448060, "comment_id": 62398065, "body": "@ScottCraner Why not =P"}, {"owner": {"reputation": 39, "user_id": 2237254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c1d6889e76e9ab73ce0488c73daeaddd?s=128&d=identicon&r=PG", "display_name": "user2237254", "link": "https://stackoverflow.com/users/2237254/user2237254"}, "edited": false, "score": 0, "creation_date": 1464213659, "post_id": 37448060, "comment_id": 62398516, "body": "Oh for... Thanks that fixed it! I can&#39;t seem to ever get with blocks working, but the manual typing option works just fine thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464212688, "post_id": 37448130, "comment_id": 62398126, "body": "Why is it hotter in the summer?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464212989, "post_id": 37448130, "comment_id": 62398248, "body": "The answer many college graduates give is that the earth is closer to the sun during the summer. @findwindow"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464213223, "post_id": 37448130, "comment_id": 62398331, "body": "Oh duh. You&#39;re interviewing engineers. I would have been like it&#39;s more romantic to feed each other ice cream than hot cocoa."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464213516, "post_id": 37448130, "comment_id": 62398459, "body": "@findwindow My father quotes a study of recent college grads from an ivy league school,  where 50% gave the answer above, which is wrong.  He uses it to show that many people we consider intelligent don&#39;t know the basic workings of our world.  That there is more to intelligence than a paycheck or a piece of paper from an institution.  This from a man who has a PHD.  But I agree.  Having lived 15 years in Phoenix, AZ.  I love the heat."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464213865, "post_id": 37448130, "comment_id": 62398604, "body": "lololol I thought <i>that</i> was the correct answer XD People mistake intelligence for accrual of knowledge/better memory."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464214603, "post_id": 37448130, "comment_id": 62398883, "body": "The correct answer is that because to the tilt of the earth the light rays are more direct or concentrated.  Therefore warmer.  It is like turning your face towards the sun.  Intelligence is the ability to use useless knowledge to the betterment of society, both individually and as a whole."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464214700, "post_id": 37448130, "comment_id": 62398917, "body": "But tilt means it&#39;s also closer?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464215207, "post_id": 37448130, "comment_id": 62399115, "body": "not enough to make any difference.  When the sun is 93 million miles away the difference of the tilt in distance is not significant enough to be noticeable in the heat.  remember the earth is a ball.  Tilt a ball and it does not get closer it just rotates around the center of gravity which remains in the same spot.  we are actually closer to the sun in february."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464215306, "post_id": 37448130, "comment_id": 62399157, "body": "Oh yeaaa duh XD Is there anything you don&#39;t know =P"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464216992, "post_id": 37448130, "comment_id": 62399715, "body": "@findwindow <code>What... is the air-speed velocity of an unladen swallow?</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464217075, "post_id": 37448130, "comment_id": 62399746, "body": "I heard of this joke before. Forget what the punchline is XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464217183, "post_id": 37448130, "comment_id": 62399766, "body": "@findwindow it is from Monte Python&#39;s Holy Grail.  <code>Bridgekeeper: What... is the air-speed velocity of an unladen swallow? King Arthur: What do you mean? An African or European swallow? Bridgekeeper: Huh? I... I don&#39;t know that.</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1464212625, "creation_date": 1464212625, "answer_id": 37448130, "question_id": 37448060, "link": "https://stackoverflow.com/questions/37448060/excel-vba-range-copy-from-another-sheet/37448130#37448130", "title": "Excel VBA range copy from another sheet", "body": "<p>Right now you have the Range looking at one sheet and the Cells are looking at the active sheet.  You need to make sure they are looking at the same sheet.</p>\n\n<p>You can do this in line:</p>\n\n<pre><code>Sheets (\"data\").Range(Sheets (\"data\").cells (2,1), Sheets (\"data\").cells (2, column)). Copy\n</code></pre>\n\n<p>Or you can use a With Block for less typing</p>\n\n<pre><code>With Sheets (\"data\")\n    .Range(Sheets (.cells (2,1), .cells (2, column)). Copy\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2237254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c1d6889e76e9ab73ce0488c73daeaddd?s=128&d=identicon&r=PG", "display_name": "user2237254", "link": "https://stackoverflow.com/users/2237254/user2237254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 37448130, "answer_count": 1, "score": 0, "last_activity_date": 1464212909, "creation_date": 1464212350, "last_edit_date": 1464212909, "question_id": 37448060, "link": "https://stackoverflow.com/questions/37448060/excel-vba-range-copy-from-another-sheet", "title": "Excel VBA range copy from another sheet", "body": "<p>I have a line of code that I am having issues troubleshooting.</p>\n\n<pre><code>Sheets(\"data\").Range(cells(2,1), cells(2, column).Copy\n</code></pre>\n\n<p>I'm getting a <code>1004 application or object defined error</code> on this. The code works if I remove the worksheet selection or replace the range chunk with a hardcoded reference (e4:e50 for example), but won't work together.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464213267, "post_id": 37447192, "comment_id": 62398355, "body": "The starred line should never produce a &quot;subscript out of range&quot; error - are you sure that&#39;s the problem line?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464213456, "post_id": 37447192, "comment_id": 62398434, "body": "Also: your <code>X</code> has dimensions (#rows, 3) so after the transpose <code>Y</code> will be (3, #rows).  You can&#39;t use Redim Preserve to adjust <i>both</i> dimensions: it only works on the last dimension of any multi-dimensional array."}, {"owner": {"reputation": 27, "user_id": 6372500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1e8a06de85ba30dda377a376186c9cb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/6372500/josh-m"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464216535, "post_id": 37447192, "comment_id": 62399583, "body": "Thank you for your reply! it turns out the redim statement was throwing the subscript error, despite the debugging showing the lngCnt (which didn&#39;t make sense to me). @TimWilliams  Regarding the second question, is there an easy way to accomplish that?"}, {"owner": {"reputation": 27, "user_id": 6372500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1e8a06de85ba30dda377a376186c9cb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/6372500/josh-m"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464217063, "post_id": 37447192, "comment_id": 62399741, "body": "I have updated the code above with what is working now, I forgot to add a row for the new array.   Also, it seems my logic for the minimum is not working (the part after the else) is there a logical fallacy I&#39;m missing here?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6372500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1e8a06de85ba30dda377a376186c9cb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/6372500/josh-m"}, "edited": false, "score": 0, "creation_date": 1464220751, "post_id": 37449085, "comment_id": 62400622, "body": "Thank you! I really appreciate your help"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1464217928, "creation_date": 1464217928, "answer_id": 37449085, "question_id": 37447192, "link": "https://stackoverflow.com/questions/37447192/determining-minima-subscript-out-of-range-error/37449085#37449085", "title": "Determining minima, subscript out of range error", "body": "<pre><code>Range(\"D2:F4300\") = Application.Transpose(Y)\n</code></pre>\n\n<p>could be</p>\n\n<pre><code>Range(\"D2\").resize(Ubound(Y,2), Ubound(Y,1)).Value = Application.Transpose(Y)\n</code></pre>\n\n<p>Without the transpose you would flip the bounds around:</p>\n\n<pre><code>Range(\"D2\").resize(Ubound(Y,1), Ubound(Y,2)).Value = Y\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6372500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1e8a06de85ba30dda377a376186c9cb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh M.", "link": "https://stackoverflow.com/users/6372500/josh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37449085, "answer_count": 1, "score": 1, "last_activity_date": 1464217928, "creation_date": 1464208724, "last_edit_date": 1464217125, "question_id": 37447192, "link": "https://stackoverflow.com/questions/37447192/determining-minima-subscript-out-of-range-error", "title": "Determining minima, subscript out of range error", "body": "<p>First time poster here, amateur VBA-ist. I have past code-logic experience in Matlab, but I've found VBA is beyond me. Below is the code I'm using to determine local minima and maxima for a certain data set with multiple peaks. Unfortunately the data is \"Noisy\"; meaning there are multiple local maxima/minima as we follow the trends between the true extrema due to the fluctuation in the meter reading.<br>\nI have edited some code I found elsewhere in a way I thought it would determine these true minimum points (I can determine them via when flow starts/stops), as the maxima never seemed a problem. But when it reaches the starred line (second round of lngCnt = lngCnt + 1) there is a \"Run time error 9: subscript out of range\". I tried to research the problem but I was not able to understand what was being prescribed to fix it, or see how the answer applied to my code. </p>\n\n<p>Here is my code I'm using:</p>\n\n<pre><code>Sub maxmin()\nDim X\nDim Y\nDim lngRow As Long\nDim lngCnt As Long\n\nX = Range([A2], Cells(Rows.Count, \"C\").End(xlUp)) 'self defining function for the range over which the data will be analyzed, data in spreadsheet must start in L26\nY = Application.Transpose(X) 'creates a column rather than a row\n\n\nFor lngRow = 2 To UBound(X, 1) - 1 'defines the function for the long variable row, to the upper bound of the column\n    If X(lngRow, 3) &gt; X(lngRow - 1, 3) Then 'logic statement to assist in max/min\n        If X(lngRow, 3) &gt; X(lngRow + 1, 3) Then 'logic statement\n            lngCnt = lngCnt + 1\n            Y(1, lngCnt) = X(lngRow, 1)\n            Y(2, lngCnt) = X(lngRow, 2)\n            Y(3, lngCnt) = X(lngRow, 3)\n        End If\n    Else\n        If X(lngRow - 1, 1) &lt; 100 Then 'this and the following line determine where the min is located based off the change in flow rate\n            If X(lngRow, 1) &gt; 150 Then\n                lngCnt = lngCnt + 1\n                Y(1, lngCnt) = X(lngRow, 1)\n                Y(2, lngCnt) = X(lngRow, 2)\n                Y(3, lngCnt) = X(lngRow, 3)\n            End If\n        End If\n    End If\nNext lngRow\n\nReDim Preserve Y(1 To 3, 1 To lngCnt)\n\nRange(\"D2:F4300 \") = Application.Transpose(Y) 'prints my data to desired cells\nEnd Sub\n</code></pre>\n\n<p>Sample set of data (over a period of approximately 55 minutes, where the ellipses represent a continuation of that trend) would read:  </p>\n\n<pre><code>0    3000  \n0    2900  \n0    2850  \n0    2825  \n0    2800  \n24   2800  \n23   2775   \n21   2775  \n19   2750  \n170  3400  \n245  3600  \n290  3800  \n290  4000  \n290  4200  \n...  \n305  11600  \n175  11800  \n23   11700  \n19   11600  \n20   11500  \n0    11400  \n0    11300  \n0    11200  \n0    11100  \n</code></pre>\n\n<p>What about the indexing with that line gives me a subscript error?</p>\n\n<p>Also, can anyone offer a better way to scale my output array to only the cells this needs? I've tried using the lngCnt value but it does not work. Previously the code worked by using array values in place of the 100 and 150. </p>\n\n<p>Thank you ahead of time for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464208665, "post_id": 37446942, "comment_id": 62396320, "body": "Find the ID of the button then do something with <code>Application.VBE.CommandBars(1).Controls</code>? Edit: er that&#39;s for VBE controls ooops XD but you get the idea ^_^; Edit2: excel 2000 <a href=\"https://support.microsoft.com/en-us/kb/213552\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464231596, "post_id": 37446942, "comment_id": 62403021, "body": "@findwindow Excel 2000, really? How useful is that advice for a ribbon command?"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464208275, "creation_date": 1464207808, "last_edit_date": 1531161705, "question_id": 37446942, "link": "https://stackoverflow.com/questions/37446942/worksheet-protection-event-similar-to-worksheet-change", "title": "Worksheet_Protection event, similar to Worksheet_Change?", "body": "<p>I've been looking around for a <code>Worksheet_Protection</code> event for Excel.  The idea being that when a user protects (or unprotects) a worksheet/workbook, I would like some macros to fire.</p>\n\n<p>Is there an event similar to <code>Worksheet_Change</code> or <code>Sheet_Change</code>?  If not, any ideas on a workaround?</p>\n\n<p>I was thinking I could use the <code>Workbook_Change</code> event to check if the workbook is protected each time a change occurs, but am thinking that might slow my workbook down, no?  </p>\n\n<p>(I know I could make a macro that locks the workbook, which is pretty straightforward. I was wondering though if there's a way to detect if the user used Excel's built in \"Protect Workbook\" button)</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 3, "creation_date": 1464206783, "post_id": 37446640, "comment_id": 62395298, "body": "Try <code>&quot;=IFERROR(VLOOKUP(RC[-1],C[8]:C[22],&quot; &amp; 3+MONTH &amp; &quot;,FALSE),0)&quot;</code> Edit: in before Scott tells me to post answer =P"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1464207102, "post_id": 37446640, "comment_id": 62395459, "body": "@findwindow Y U NO post an answer? ;o)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1464207142, "post_id": 37446640, "comment_id": 62395484, "body": "@Mat&#39;sMug ugh, should have included you on the <code>in before Scott</code> too XD Edit: CUZ I AM WAITING FOR YOOOU TO DOOO EEET"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464207483, "post_id": 37446640, "comment_id": 62395662, "body": "@findwindow Why? why does that work while the other does not?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464207525, "post_id": 37446640, "comment_id": 62395683, "body": "See? This is why I want one of you to do it so I can troll instead =P"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464207560, "post_id": 37446640, "comment_id": 62395701, "body": "As an side, y&#39;all need to upvote <a href=\"http://stackoverflow.com/questions/37443722/excel-multiply-text-and-sort-in-one-column#37443722\">this</a> because the logic is simply brilliant."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464207644, "post_id": 37446640, "comment_id": 62395748, "body": "@ScottCraner I don&#39;t know how to explain it. Because, when you enclose something in quotes, it&#39;s taken as text. But it&#39;s a variable so you place it outside the quotes and concatenate it with <code>&amp;</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464207695, "post_id": 37446640, "comment_id": 62395771, "body": "@findwindow good, now put all that in an answer."}, {"owner": {"reputation": 11, "user_id": 6263420, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209688718277727/picture?type=large", "display_name": "PingHung Wu", "link": "https://stackoverflow.com/users/6263420/pinghung-wu"}, "edited": false, "score": 0, "creation_date": 1464207714, "post_id": 37446640, "comment_id": 62395775, "body": "sorry guys this is literally my first time writing VBA, most of the project is finished my recording my action."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464207716, "post_id": 37446640, "comment_id": 62395781, "body": "@ScottCraner YOUU DOO EEEET"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464207739, "post_id": 37446640, "comment_id": 62395796, "body": "@PingHungWu you&#39;re doing just fine~ Edit: also tell Scott to post answer. Edit2: or tell Mat."}, {"owner": {"reputation": 11, "user_id": 6263420, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209688718277727/picture?type=large", "display_name": "PingHung Wu", "link": "https://stackoverflow.com/users/6263420/pinghung-wu"}, "edited": false, "score": 0, "creation_date": 1464207872, "post_id": 37446640, "comment_id": 62395868, "body": "with that.. &quot; &amp; 3 +MONTH &amp;&quot; works! But I still don&#39;t quite understand how it works. --------------- i understand it now, thanks!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464207898, "post_id": 37446640, "comment_id": 62395891, "body": "Aha! I can&#39;t explain it properly. Clearly I can&#39;t answer."}, {"owner": {"reputation": 11, "user_id": 6263420, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209688718277727/picture?type=large", "display_name": "PingHung Wu", "link": "https://stackoverflow.com/users/6263420/pinghung-wu"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464207966, "post_id": 37446640, "comment_id": 62395929, "body": "@findwindow thank you, what you just commented is very clear."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 1, "creation_date": 1464208220, "post_id": 37446640, "comment_id": 62396065, "body": "Could this just use a lookup in <a href=\"http://www.dummies.com/how-to/content/how-to-perform-a-twoway-lookup-in-excel-2013.html\" rel=\"nofollow noreferrer\">both directions</a> <code>=index(.,match,match)</code> what else is the macro doing?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1464209239, "post_id": 37446640, "comment_id": 62396609, "body": "Wow, only @gtwebb upvoted that link. I hate the rest of you."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1464208276, "post_id": 37447047, "comment_id": 62396102, "body": "@findwindow you bet!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464208319, "post_id": 37447047, "comment_id": 62396130, "body": "Well, gonna troll it by not creating CR account. Booyah."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464208338, "post_id": 37447047, "comment_id": 62396137, "body": "@findwindow anything to get you to be here less, jk =P"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 4, "creation_date": 1464208884, "post_id": 37447047, "comment_id": 62396435, "body": "@findwindow FWIW, I&#39;m not giving up. You&#39;ll end up reviewing VBA on <a href=\"https://codereview.stackexchange.com\">Code Review</a> one way or another. Answering lazy dupes on SO is one thing, reviewing working code where the OP put their best coding effort and says &quot;is there anything I can improve?&quot; is <i>something else</i> - and we&#39;re a fun bunch too. <a href=\"http://chat.stackexchange.com/rooms/8595/the-2nd-monitor\">The 2nd Monitor</a> is waiting for you =)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1464212384, "post_id": 37447047, "comment_id": 62397998, "body": "@findwindow pffft, you&#39;ll need a better reason; some of the top reviewers were exactly in your shoes (&quot;but I&#39;m not qualified! I suck! I know nothing! I&#39;m the Jon Snow of VBA!&quot;) a few months ago! and you learn much more, and faster, by reviewing working code, and reading other people&#39;s reviews =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1464210270, "last_edit_date": 1464210270, "creation_date": 1464208186, "answer_id": 37447047, "question_id": 37446640, "link": "https://stackoverflow.com/questions/37446640/vlookup-with-column-as-variable/37447047#37447047", "title": "Vlookup with Column as variable", "body": "<pre><code>\"=IFERROR(VLOOKUP(RC[-1],C[8]:C[22],3+MONTH,FALSE),0)\"\n</code></pre>\n\n<p>That's a <em>string literal</em>; you need to \"chop it\" and <em>insert</em> your variable in there.</p>\n\n<p>Use the <em>string concatenation operator</em> (<code>&amp;</code>) to put the pieces together</p>\n\n<pre><code>\"=IFERROR(VLOOKUP(RC[-1],C[8]:C[22],\" &amp; 3+MONTH &amp; \",FALSE),0)\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6263420, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209688718277727/picture?type=large", "display_name": "PingHung Wu", "link": "https://stackoverflow.com/users/6263420/pinghung-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464214997, "creation_date": 1464206720, "last_edit_date": 1464214997, "question_id": 37446640, "link": "https://stackoverflow.com/questions/37446640/vlookup-with-column-as-variable", "title": "Vlookup with Column as variable", "body": "<p>I want to use vlookup, and the column number as a variable which is dependent on users input. </p>\n\n<pre><code>Dim MONTH As Variant\nMONTH = InputBox(\"month number ex: Apr=4\")\n\nRange(\"F7\").Select\nActiveCell.FormulaR1C1 = \"=IFERROR(VLOOKUP(RC[-1],C[8]:C[22],3+MONTH,FALSE),0)\"\n</code></pre>\n\n<p>The function can run through but the column doesn't really take in user's input. So I am actually searching \"3+MONTH\"th column. </p>\n\n<p>Does anyone know how to properly solve it so i can really take user's input into the formula? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1464204813, "post_id": 37445792, "comment_id": 62394329, "body": "Check if your sheet name or range name is correct"}, {"owner": {"reputation": 29, "user_id": 4508321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfc7af80ea48e0fe773f4dba86ac0cf2?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib Ibradzic", "link": "https://stackoverflow.com/users/4508321/hasib-ibradzic"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1464205263, "post_id": 37445792, "comment_id": 62394568, "body": "Yeah the sheet names are correct.  I used copy/paste to make sure everything was 100% accurate.  I am assuming the problem is with the actual syntax on the <code>Sheets(Array(SheetsToPrint)).Printout</code> code"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4508321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfc7af80ea48e0fe773f4dba86ac0cf2?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib Ibradzic", "link": "https://stackoverflow.com/users/4508321/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1464205588, "post_id": 37446222, "comment_id": 62394720, "body": "This just prints out all of the sheets individually.  I need it to all print out as one job, because we print to pdf so if I use this method then every worksheet is a separate file."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 29, "user_id": 4508321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfc7af80ea48e0fe773f4dba86ac0cf2?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib Ibradzic", "link": "https://stackoverflow.com/users/4508321/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1464205632, "post_id": 37446222, "comment_id": 62394742, "body": "See my comment: &#39;This should also work as a 1 liner, I think &#39;Sheets(MyArr).PrintOut"}, {"owner": {"reputation": 29, "user_id": 4508321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfc7af80ea48e0fe773f4dba86ac0cf2?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib Ibradzic", "link": "https://stackoverflow.com/users/4508321/hasib-ibradzic"}, "edited": false, "score": 0, "creation_date": 1464205844, "post_id": 37446222, "comment_id": 62394837, "body": "Yeah I just noticed that after I ran it.  It works, but for some reason still splits it into 3 jobs.  I have 16 worksheets that I print.  It prints the first 10 then 4 then 2.  But it works!  Thank you so much!"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 2, "last_activity_date": 1464205728, "last_edit_date": 1464205728, "creation_date": 1464205229, "answer_id": 37446222, "question_id": 37445792, "link": "https://stackoverflow.com/questions/37445792/print-multiple-worksheets-at-once-based-off-user-selection/37446222#37446222", "title": "Print multiple worksheets at once based off user selection", "body": "<p>Give this a try, code is untested.</p>\n\n<pre><code>Sub PrintAllSheets()\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nDim DoesPrint       As Boolean\nDim SheetsToPrint   As String\nDim SheetCount      As Integer\nDim StartCount      As Integer\nDim MyArr()         As String\nDim StartRange      As String\nDim totalString     As String\nDim i               As Long\n\nDoesPrint = Application.Dialogs(xlDialogPrinterSetup).Show\n\nIf DoesPrint = False Then\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Exit Sub\nEnd If\n\nSheetsToPrint = Sheets(\"Printing\").Range(\"FirstSheetPrint\").Value\nSheetCount = Sheets(\"Printing\").Range(\"SheetsToPrintCount\").Value\nStartCount = 4\n\nIf SheetsToPrint = \"N\" Then\n    MsgBox \"Please select which sheets you would like to print\"\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Exit Sub\nElse\n    'SheetsToPrint = (\"\"\"\" &amp; SheetsToPrint &amp; \"\"\"\") 'Not sure if this is needed\n    For i = 1 To SheetCount\n        If Sheets(\"Printing\").Range(\"N\" &amp; StartCount).Value &gt; 0 Then\n            SheetsToPrint = (SheetsToPrint &amp; \",\" &amp; Sheets(\"Printing\").Range(\"L\" &amp; StartCount).Value)\n            StartCount = StartCount + 1\n        Else\n            StartCount = StartCount + 1\n        End If\n    Next i\n    MsgBox (\"We will print: \" &amp; SheetsToPrint)\nEnd If\n\n'Split the string into an array\nMyArr = Split(SheetsToPrint, \",\")\n\n'Print the array\nSheets(MyArr).PrintOut\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4508321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfc7af80ea48e0fe773f4dba86ac0cf2?s=128&d=identicon&r=PG&f=1", "display_name": "Hasib Ibradzic", "link": "https://stackoverflow.com/users/4508321/hasib-ibradzic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 37446222, "answer_count": 1, "score": 2, "last_activity_date": 1464205728, "creation_date": 1464203705, "last_edit_date": 1464204989, "question_id": 37445792, "link": "https://stackoverflow.com/questions/37445792/print-multiple-worksheets-at-once-based-off-user-selection", "title": "Print multiple worksheets at once based off user selection", "body": "<p>I need a way to be able to print multiple worksheets as one job, based off of what worksheets the user wants to print.</p>\n\n<p>I have a worksheet where in column A I have a lists of all the worksheets in the workbook.  Column B has a <code>dropdown</code> list where the user will either select Y or N to indicate if they want to print that sheet.  </p>\n\n<p>What my code is supposed to do is print all of the worksheets that have a Y in column B as one job. I have a cell reference called <code>FirstSheetPrint</code> that copies the name of the first worksheet in the list of worksheets that has a Y in column B.  I then take that name and add \"'s around it so that it can be uses as a worksheet name later.  Then I loop through all the rows that have a Y and add \"'s and the worksheet name to a single string (the string keeps growing as the loop continues).  </p>\n\n<p>My problem is that in the end when I try to assign this string of Sheet names to an array I get an error Subscript out of range.  I have added a screen shot of my message box that shows what the final string looks like and a screenshot of the error.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/89fIX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/89fIX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<pre><code>Sub PrintAllSheets()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nDim DoesPrint As Boolean\nDim SheetsToPrint As String\nDim SheetCount As Integer\nDim StartCount As Integer\nDim StartRange As String\nDim totalString As String\n\nDoesPrint = Application.Dialogs(xlDialogPrinterSetup).Show\n\nIf DoesPrint = False Then\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nExit Sub\nElse\nEnd If\n\nSheetsToPrint = Sheets(\"Printing\").Range(\"FirstSheetPrint\").Value\nSheetCount = Sheets(\"Printing\").Range(\"SheetsToPrintCount\").Value\nStartCount = 4\n\nIf SheetsToPrint = \"N\" Then\n    MsgBox \"Please select which sheets you would like to print\"\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Exit Sub\nElse\n    SheetsToPrint = (\"\"\"\" &amp; SheetsToPrint &amp; \"\"\"\")\n    For i = 1 To SheetCount\n\n        If Sheets(\"Printing\").Range(\"N\" &amp; StartCount).Value &gt; 0 Then\n            SheetsToPrint = (SheetsToPrint &amp; \", \" &amp; \"\"\"\" &amp; Sheets(\"Printing\").Range(\"L\" &amp; StartCount).Value &amp; \"\"\"\")\n            StartCount = StartCount + 1\n        Else\n            StartCount = StartCount + 1\n        End If\n    Next i\n\n    MsgBox (\"We will print: \" &amp; SheetsToPrint)\nEnd If\n\nSheets(Array(SheetsToPrint)).PrintOut\n\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/brS3x.png\" rel=\"nofollow noreferrer\">Error Message</a>\n<a href=\"https://i.stack.imgur.com/t1wvM.png\" rel=\"nofollow noreferrer\">Message Box</a></p>\n"}, {"tags": ["vba", "excel", "collections", "ldap"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1464206477, "post_id": 37445469, "comment_id": 62395143, "body": "Can you post the code? Initial thought, maybe just make a local collection/array to keep track of all this stuff?"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 1314420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2b6de34a1bb2c0bdacf57e8652f4c1c?s=128&d=identicon&r=PG", "display_name": "ffrugone", "link": "https://stackoverflow.com/users/1314420/ffrugone"}, "is_accepted": false, "score": 0, "last_activity_date": 1464207728, "creation_date": 1464207728, "answer_id": 37446923, "question_id": 37445469, "link": "https://stackoverflow.com/questions/37445469/index-of-object-from-ldap-query/37446923#37446923", "title": "Index of Object from LDAP Query", "body": "<p>Okay, I have figured this one out.  </p>\n\n<p>Apparently, you can take the colOU object and do a:</p>\n\n<pre><code>Set objADObject = colOU.GetObject(\"user\", &lt;RelativeDistinguishedName&gt;)\n</code></pre>\n\n<p>and it will set the objADObject to the correct user object.  So, I assigned <code>objADObject.name</code> (which is the RelativeDistinguishedName) to a hidden column 2 of the ListBox.  When I retrieve the value from the hidden column, I can just pass it as a variable to <code>colOU.GetObject</code> and I will have a reference to the correct user object.</p>\n\n<p>Huzzah!</p>\n\n<p>However, I would still like to know if <code>colOU</code> can be enumerated if anyone knows the answer.  </p>\n"}], "owner": {"reputation": 51, "user_id": 1314420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2b6de34a1bb2c0bdacf57e8652f4c1c?s=128&d=identicon&r=PG", "display_name": "ffrugone", "link": "https://stackoverflow.com/users/1314420/ffrugone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464207728, "creation_date": 1464202590, "last_edit_date": 1531164843, "question_id": 37445469, "link": "https://stackoverflow.com/questions/37445469/index-of-object-from-ldap-query", "title": "Index of Object from LDAP Query", "body": "<p>I run an LDAP Query in VBA and obtain an Object with the match using GetObject:</p>\n\n<pre><code>Set colOU = GetObject(\"LDAP://OU=LazyPeople,DC=somecompany,DC=com\")\ncolOU.Filter = Array(\"user\")\n</code></pre>\n\n<p>I have been looping through the <code>colOU</code> using a For Each statement:</p>\n\n<pre><code>For Each objADObject In colOU\n</code></pre>\n\n<p>However, what I need to do is present a ListBox with the name of each user from the <code>colOU</code> and have the user choose an entry.  Then I want to go back to that instance, (<code>objADObject</code>) from <code>colOU</code> that corresponds to the user selection and manipulate the properties.   </p>\n\n<p>What I would like to do is store an index for each <code>objADObject</code> in each entry of the ListBox, and use that index to recall that instance from <code>colOU</code> after the user makes a selection.  However, I cannot find a way of accessing <code>colOU</code> items by index, (.Items, .Item, .Members, .Count, and UBound generate errors).  I have been unsuccessful in trying to cast or convert <code>colOU</code> to a collection as well.  </p>\n\n<p>Any suggestions?</p>\n\n<p>Also, how can I investigate an object in VBA to find out if can be enumerated, (what in .NET I would call an IEnumerable).</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "loops", "figure", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6382813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CNDyy4DFI08/AAAAAAAAAAI/AAAAAAAAAsc/wYq9xOANmrU/photo.jpg?sz=128", "display_name": "Jordan Poitras", "link": "https://stackoverflow.com/users/6382813/jordan-poitras"}, "edited": false, "score": 0, "creation_date": 1464294406, "post_id": 37446535, "comment_id": 62439346, "body": "Thanks Tim. I&#39;ll give that a try as well"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1464206372, "creation_date": 1464206372, "answer_id": 37446535, "question_id": 37445454, "link": "https://stackoverflow.com/questions/37445454/create-unique-chart-for-each-sheet-with-vba/37446535#37446535", "title": "Create unique chart for each sheet with VBA", "body": "<p>Compiled but not tested:</p>\n\n<pre><code>Sub WorksheetLoop()\n\n    Dim WS As Worksheet, co As Object\n\n    For Each WS In ActiveWorkbook.Worksheets\n\n        Set co = WS.Shapes.AddChart()\n\n        ActiveSheet.Range(\"P2:AB2153\").Select\n\n        'adjust to suit...\n        co.Top = 100\n        co.Left = 100\n        co.Width = 300\n        co.Height = 250\n\n        With co.Chart\n            .ChartType = xlXYScatterLines\n            .SetSourceData Source:=WS.Range(\"$P$2:$AB$2153\")\n            .Axes(xlValue).MinimumScale = 0.5\n        End With\n\n        Debug.Print \"Processed: \" &amp; WS.Name\n\n    Next WS\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6382813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CNDyy4DFI08/AAAAAAAAAAI/AAAAAAAAAsc/wYq9xOANmrU/photo.jpg?sz=128", "display_name": "Jordan Poitras", "link": "https://stackoverflow.com/users/6382813/jordan-poitras"}, "is_accepted": false, "score": 0, "last_activity_date": 1464294379, "creation_date": 1464294379, "answer_id": 37470351, "question_id": 37445454, "link": "https://stackoverflow.com/questions/37445454/create-unique-chart-for-each-sheet-with-vba/37470351#37470351", "title": "Create unique chart for each sheet with VBA", "body": "<p>I came up with my own answer and added some other other stuff</p>\n\n<hr>\n\n<p>:</p>\n\n<p>Sub WorksheetLoopchart()</p>\n\n<pre><code>     Dim WS_Count As Integer\n     Dim I As Integer\n\n     ' Set WS_Count equal to the number of worksheets in the active\n     ' workbook.\n     WS_Count = ActiveWorkbook.Worksheets.Count\n\n     ' Begin the loop.\n     For I = 1 To WS_Count\n\n    Worksheets(ActiveSheet.Index + 1).Select\n    ActiveSheet.Range(\"P2:AB2153\").Select\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlXYScatterLines\n    ActiveChart.SetSourceData Source:=Range(\"$P$2:$AB$2153\")\n    ActiveChart.Axes(xlValue).MinimumScale = 0.1\n    ActiveChart.Axes(xlCategory, xlPrimary).HasTitle = True\n    ActiveChart.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Wavelength (nm)\"\n    ActiveChart.Axes(xlValue, xlPrimary).HasTitle = True\n    ActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Absolute Reflectance\"\n    ActiveChart.SetElement (msoElementLegendRight)\n\n        ' Insert your code here.\n        ' The following line shows how to reference a sheet within\n        ' the loop by displaying the worksheet name in a dialog box.\n        MsgBox ActiveWorkbook.Worksheets(I).Name\n\n     Next I\n\n  End Sub\n</code></pre>\n\n<p>The index + 1 did the trick</p>\n"}], "owner": {"reputation": 1, "user_id": 6382813, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CNDyy4DFI08/AAAAAAAAAAI/AAAAAAAAAsc/wYq9xOANmrU/photo.jpg?sz=128", "display_name": "Jordan Poitras", "link": "https://stackoverflow.com/users/6382813/jordan-poitras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464294379, "creation_date": 1464202525, "last_edit_date": 1531164843, "question_id": 37445454, "link": "https://stackoverflow.com/questions/37445454/create-unique-chart-for-each-sheet-with-vba", "title": "Create unique chart for each sheet with VBA", "body": "<p>I am attempting to create a chart in each sheet of my workbook using VBA. I have used code gleaned from the net. The closest I came to success was ending up with 28 of the same chart on the first sheet. </p>\n\n<p>Here is that code where each sheet has the data in the specified location</p>\n\n<pre><code>Sub WorksheetLoop()\n  Dim WS_Count As Integer\n  Dim I As Integer\n\n  ' Set WS_Count equal to the number of worksheets in the active\n  ' workbook.\n  WS_Count = ActiveWorkbook.Worksheets.Count\n\n  ' Begin the loop.\n  For I = 1 To WS_Count\n    ActiveSheet.Range(\"P2:AB2153\").Select\n    ActiveSheet.Shapes.AddChart.Select\n    ActiveChart.ChartType = xlXYScatterLines\n    ActiveChart.SetSourceData Source:=Range(\"$P$2:$AB$2153\")\n    ActiveChart.Axes(xlValue).MinimumScale = 0.5\n    ActiveChart.ChartArea.Select\n    ActiveSheet.Shapes(\"Chart 1\").IncrementLeft 393.75\n    ActiveSheet.Shapes(\"Chart 1\").IncrementTop -31243.1249606299\n\n    MsgBox ActiveWorkbook.Worksheets(I).Name\n  Next I\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You'll notice that I moved the shape after it is created. This was because the very first time they were all located at the bottom of a very long sheet </p>\n\n<p>I then tried  adding </p>\n\n<pre><code>Dim thisSheet As Worksheet\n\nFor Each sheet In Sheets\n</code></pre>\n\n<p>and changing <code>ActiveSheet to thisSheet</code></p>\n\n<p>No success.</p>\n\n<p>I have over 100 sheets in many workbooks\nAny help would be appreciated</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464204095, "post_id": 37445360, "comment_id": 62393924, "body": "At the very least, you need to provide an example of what kinds of results you expect. And posting the (perhaps inefficient) <code>If</code> statements would also help us understand what you have in mind."}, {"owner": {"reputation": 11, "user_id": 4023711, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tav2hPYmz88/AAAAAAAAAAI/AAAAAAAAF_o/iIdJ93oI62U/photo.jpg?sz=128", "display_name": "Clayton Hayes", "link": "https://stackoverflow.com/users/4023711/clayton-hayes"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464261003, "post_id": 37445360, "comment_id": 62417384, "body": "I updated the question to provide some more information.  I hope it gives an idea of what I hope to get."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464286687, "post_id": 37445360, "comment_id": 62435152, "body": "Mmmm, OK... One way to go about this would be to assign each checkbox a number that, when you add the numbers of the <i>checked</i> boxes you&#39;ll get a unique result for each combination. For example, assign them the values 2, 4, 8. If only the first is checked, the sum is 2; first + second: 6; first and third: 10; second, only: 4; and so on. Use a <code>Select Case</code> for each possible result. <code>Select Case</code> is faster then <code>If</code>."}, {"owner": {"reputation": 11, "user_id": 4023711, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tav2hPYmz88/AAAAAAAAAAI/AAAAAAAAF_o/iIdJ93oI62U/photo.jpg?sz=128", "display_name": "Clayton Hayes", "link": "https://stackoverflow.com/users/4023711/clayton-hayes"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464288665, "post_id": 37445360, "comment_id": 62436297, "body": "Ok so with 5 checkboxes I would go with 2, 4, 8, 16, 32?  How do I set the value to the checkbox? Then I&#39;m assuming I put that to an <code>Integer</code>.  I found how to use <code>Select Case</code>.  Also, how to call only the checked boxes?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464295716, "post_id": 37445360, "comment_id": 62440064, "body": "You could use the Tag property of the controls, for example, or make it part of the control names. You need to query each control whether or not it&#39;s checked, same as you do currently."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464296240, "post_id": 37445360, "comment_id": 62440325, "body": "Another possibility would be to keep a running sum when the user checks/unchecks the boxes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "edited": false, "score": 0, "creation_date": 1464434788, "post_id": 37445360, "comment_id": 62491764, "body": "You only need to do one calculation to benefit from the Select Case approach, e.g. allcbs = -(2*cint(IFBSectorHeader)+4*cint(inputSOPSectHeader)+etc.). Or you could use cstr(-cint(IFBSectorHeader)) &amp; cstr(-cint(inputSOPSectHeader))&amp;etc. to give you a 5 character string of &quot;00000&quot;, &quot;00001&quot; etc., which might add clarity to your Select Case. As long as you can only have results True and False, that is."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4023711, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tav2hPYmz88/AAAAAAAAAAI/AAAAAAAAF_o/iIdJ93oI62U/photo.jpg?sz=128", "display_name": "Clayton Hayes", "link": "https://stackoverflow.com/users/4023711/clayton-hayes"}, "is_accepted": true, "score": 0, "last_activity_date": 1465234294, "creation_date": 1465234294, "answer_id": 37663535, "question_id": 37445360, "link": "https://stackoverflow.com/questions/37445360/multiple-checkboxes-to-insert-text/37663535#37663535", "title": "Multiple checkboxes to insert text", "body": "<p>With the help of @CindyMeister I accomplished what I needed.  Here is what I came up with.</p>\n\n<pre><code>' IFB\nIf Me.inputIFBSectHeader.Value = True Then\n    Set oRng = ActiveDocument.Bookmarks(\"ifbSectHeader\").Range\n    ActiveDocument.AttachedTemplate.BuildingBlockEntries(\"headerIFBBB\").Insert _\n            Where:=oRng\n    modCalc = modCalc + 2\nEnd If\n\n' SOP\nIf Me.inputSOPSectHeader.Value = True Then\n    Set oRng = ActiveDocument.Bookmarks(\"sopSectHeader\").Range\n    ActiveDocument.AttachedTemplate.BuildingBlockEntries(\"headerSOPBB\").Insert _\n            Where:=oRng\n    modCalc = modCalc + 4\nEnd If\n\n' Plans\nIf Me.inputPlansSectHeader.Value = True Then\n    Set oRng = ActiveDocument.Bookmarks(\"plansSectHeader\").Range\n    ActiveDocument.AttachedTemplate.BuildingBlockEntries(\"headerPlansBB\").Insert _\n            Where:=oRng\n    modCalc = modCalc + 8\nEnd If\n\n' XSects\nIf Me.inputPlansSectHeader.Value = True Then\n    Set oRng = ActiveDocument.Bookmarks(\"xSectsSectHeader\").Range\n    ActiveDocument.AttachedTemplate.BuildingBlockEntries(\"headerXSectsBB\").Insert _\n            Where:=oRng\n    modCalc = modCalc + 16\nEnd If\n\n' PenInk\nIf Me.inputPenSectHeader.Value = True Then\n    Set oRng = ActiveDocument.Bookmarks(\"penInkSectHeader\").Range\n    ActiveDocument.AttachedTemplate.BuildingBlockEntries(\"headerPenInkBB\").Insert _\n            Where:=oRng\n    modCalc = modCalc + 32\nEnd If\n\n' CQ\nIf Me.inputCQSectHeader.Value = True Then\n    Set oRng = ActiveDocument.Bookmarks(\"cQSectHeader\").Range\n    ActiveDocument.AttachedTemplate.BuildingBlockEntries(\"headerCQBB\").Insert _\n            Where:=oRng\n    ActiveDocument.Bookmarks(\"cQDate\").Range.InsertBefore inputCQDateM &amp; \" \" &amp; _\n            inputCQDateD &amp; \", \" &amp; inputCQDateY\n    modCalc = modCalc + 64\nEnd If\n\nSelect Case modCalc\n    Case 2   ' IFB\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Invitation for Bids booklet.\" &amp; vbNewLine\n    Case 4   ' SOP\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Schedule of Prices.\" &amp; vbNewLine\n    Case 6   ' IFB,SOP\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Invitation for Bids booklet and Schedule of Prices.\" &amp; vbNewLine\n    Case 8   ' Plans\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Contract Plans.\" &amp; vbNewLine\n    Case 10  ' IFB,Plans\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Invitation for Bids booklet and Contract Plans.\" &amp; vbNewLine\n    Case 12  ' SOP,Plans\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Scedule of Prices and Contract Plans.\" &amp; vbNewLine\n    Case 14  ' IFB,SOP,Plans\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Invitation for Bids booklet, Schedule of Prices, and Contract Plans.\" &amp; vbNewLine\n    Case 16  ' XSects\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Cross-Sections.\" &amp; vbNewLine\n    Case 18  ' IFB,XSects\n        ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore vbNewLine &amp; secondPara &amp; _\n                    \"Invitation for Bids booklet and Cross-Sections.\" &amp; vbNewLine\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4023711, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tav2hPYmz88/AAAAAAAAAAI/AAAAAAAAF_o/iIdJ93oI62U/photo.jpg?sz=128", "display_name": "Clayton Hayes", "link": "https://stackoverflow.com/users/4023711/clayton-hayes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 37663535, "answer_count": 1, "score": -1, "last_activity_date": 1465234294, "creation_date": 1464202200, "last_edit_date": 1464272876, "question_id": 37445360, "link": "https://stackoverflow.com/questions/37445360/multiple-checkboxes-to-insert-text", "title": "Multiple checkboxes to insert text", "body": "<p>I am making a userform to input various information into a letter.  Part of the userform are five checkboxes.  Based on different combinations of the checkboxes I want to insert a different line of text.  I can do it with many If statements but I would like to think there is a better, more efficient way of checking which boxes are checked and which ones aren't.  Maybe with an array?  I'm still learning and am not totally sure how to go about completing an array/using the information later.  Any help is appreciated and I can provide any other information that may be needed.</p>\n\n<p>I'm hoping for something like </p>\n\n<pre><code>ifb = true\nsop = false\nplans = false\n</code></pre>\n\n<p>Will insert \"Invitation for Bids Booklet.\"</p>\n\n<pre><code>ifb = false\nsop = true\nplans = true\n</code></pre>\n\n<p>Will insert \"Schedule of Prices and Contract Plans.\"</p>\n\n<pre><code>ifb = true\nsop = true\nplans = true\n</code></pre>\n\n<p>Will insert \"Invitation for Bids Booklet, Schedule of Prices and Contract Plans.\"</p>\n\n<p>This is the If statement that I have right now and would have to keep going until I have covered every scenario.</p>\n\n<pre><code>If inputIFBSectHeader.Value = True &amp; inputSOPSectHeader.Value = False &amp; _\n        inputPlansSectHeader.Value = False &amp; inputPenSectHeader.Value = False &amp; _\n        inputCQSectHeader.Value = False Then\n    With ActiveDocument.Bookmarks(\"modifications\").Range.InsertBefore \"Invitation for Bids booklet.\"\n    End With\nEnd If\n</code></pre>\n\n<p>I know I have something wrong with the insert part but that's also what got me thinking that there had to be an easier/more efficient way.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3, "user_id": 6372907, "user_type": "registered", "profile_image": "https://graph.facebook.com/1211965302161312/picture?type=large", "display_name": "Evelin Dan&#225;s", "link": "https://stackoverflow.com/users/6372907/evelin-dan%c3%a1s"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464202536, "post_id": 37445316, "comment_id": 62393093, "body": "Function elso(bemenet) Dim kimenet(), koztes() As Variant Dim i, j, n, m, k As Long Dim sarok As Double elso = 1 n = bemenet.Rows.Count m = bemenet.Columns.Count ReDim kimenet(n + 1, m + 1) For i = 1 To n For j = 1 To m kimenet(i, j) = bemenet(i, j) Next j Next i For i = 1 To n kimenet(i, m + 1) = Application.Max(Application.Index(bemenet, i, 0)) Next i For j = 1 To m kimenet(n + 1, j) = Application.Average(Application.Index(bemenet, 0, j)) Next j"}, {"owner": {"reputation": 3, "user_id": 6372907, "user_type": "registered", "profile_image": "https://graph.facebook.com/1211965302161312/picture?type=large", "display_name": "Evelin Dan&#225;s", "link": "https://stackoverflow.com/users/6372907/evelin-dan%c3%a1s"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464202541, "post_id": 37445316, "comment_id": 62393096, "body": "For k = 1 To Application.Max(n, m) sarok = sarok + (bemenet(k, k)) Next k kimenet(n + 1, m + 1) = sarok elso = kimenet End Function"}, {"owner": {"reputation": 3, "user_id": 6372907, "user_type": "registered", "profile_image": "https://graph.facebook.com/1211965302161312/picture?type=large", "display_name": "Evelin Dan&#225;s", "link": "https://stackoverflow.com/users/6372907/evelin-dan%c3%a1s"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464202601, "post_id": 37445316, "comment_id": 62393128, "body": "Sorry, I&#39;m new in here and I don&#39;t know how to show my VBA code in a &#39;normal&#39; view."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1464202643, "post_id": 37445316, "comment_id": 62393148, "body": "Put the code in your question. Highlight it and then hit <code>Ctrl + K</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1464203637, "post_id": 37445316, "comment_id": 62393669, "body": "@EvelinDan&#225;s have a read <a href=\"http://stackoverflow.com/editing-help\">of this page</a> then please edit your question."}], "answers": [{"tags": [], "owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "is_accepted": true, "score": 0, "last_activity_date": 1464203750, "creation_date": 1464203750, "answer_id": 37445803, "question_id": 37445316, "link": "https://stackoverflow.com/questions/37445316/excel-vba-application-index-function/37445803#37445803", "title": "Excel VBA - application.index function", "body": "<p>It seems to be for getting specific values stored in memory from worksheets.  Please see <a href=\"https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/\" rel=\"nofollow\">https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/</a></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8209995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e156fa53420479f3eba10c9cec6d669?s=128&d=identicon&r=PG&f=1", "display_name": "Freiling", "link": "https://stackoverflow.com/users/8209995/freiling"}, "is_accepted": false, "score": 2, "last_activity_date": 1561747956, "creation_date": 1561747956, "answer_id": 56811934, "question_id": 37445316, "link": "https://stackoverflow.com/questions/37445316/excel-vba-application-index-function/56811934#56811934", "title": "Excel VBA - application.index function", "body": "<p>It's a worksheet function for pulling values from a range. The following function identically:</p>\n\n<pre><code>Application.Index(Array, Row_Number, Column_Number)\n\nApplication.WorksheetFunction.Index(Array, Row_Number, Column_Number)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6372907, "user_type": "registered", "profile_image": "https://graph.facebook.com/1211965302161312/picture?type=large", "display_name": "Evelin Dan&#225;s", "link": "https://stackoverflow.com/users/6372907/evelin-dan%c3%a1s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7559, "favorite_count": 1, "accepted_answer_id": 37445803, "answer_count": 2, "score": 0, "last_activity_date": 1561747956, "creation_date": 1464202018, "last_edit_date": 1531164843, "question_id": 37445316, "link": "https://stackoverflow.com/questions/37445316/excel-vba-application-index-function", "title": "Excel VBA - application.index function", "body": "<p>Could anyone help me when and why I have to use the <code>application.index</code> in the VBA? </p>\n\n<pre><code>Function elso(bemenet)\n\nDim kimenet(), koztes() As Variant\nDim i, j, n, m, k As Long\nDim sarok As Double\n\nelso = 1\nn = bemenet.Rows.count\nm = bemenet.Columns.count\nReDim kimenet(n + 1, m + 1)\n\nFor i = 1 To n\n    For j = 1 To m\n        kimenet(i, j) = bemenet(i, j)\n    Next j\nNext i\n\nFor i = 1 To n\n    kimenet(i, m + 1) = Application.max(Application.Index(bemenet, i, 0))\nNext i\n\nFor j = 1 To m\n    kimenet(n + 1, j) = Application.Average(Application.Index(bemenet, 0, j))\nNext j\n\nFor k = 1 To Application.max(n, m)\n    sarok = sarok + (bemenet(k, k))\nNext k\n\nkimenet(n + 1, m + 1) = sarok\nelso = kimenet\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "sumifs"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1464202525, "post_id": 37445284, "comment_id": 62393086, "body": "Ah! Careful, you didn&#39;t always explicitly tell what Sheet to use on some ranges. When you do simply <code>Cells(x,y)</code>, this runs on the ActiveSheet.  If you want that to be the cells on &quot;RMI Static Compare&quot; sheet, you need to add <code>Sheets(&quot;RMI Static Compare&quot;).</code> before <code>.Cells()</code>, similar how you did before <code>Range()</code>.  Same goes for your <code>Rows.Count</code>, you want to put a sheet in there too."}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "edited": false, "score": 0, "creation_date": 1464202556, "post_id": 37445284, "comment_id": 62393105, "body": "Do you need that the formula in the worksheet? Can you fill the rows with the result? It will be faster to do that."}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1464202777, "post_id": 37445284, "comment_id": 62393224, "body": "The formula is already saved in the first cell of that column, so if it is faster to fill down that would be better...is there a code for that?"}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464202827, "post_id": 37445284, "comment_id": 62393242, "body": "@BruceWayne ....What do you mean?"}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "edited": false, "score": 0, "creation_date": 1464203454, "post_id": 37445284, "comment_id": 62393557, "body": "Hags, I understand that you need to fill the range G2 to &#39;down&#39;, right?"}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "reply_to_user": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "edited": false, "score": 0, "creation_date": 1464203761, "post_id": 37445284, "comment_id": 62393738, "body": "@Kellsens I updated my code, I need all the formulas to fill down up until the last cell in column A"}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "edited": false, "score": 0, "creation_date": 1464204272, "post_id": 37445284, "comment_id": 62394040, "body": "Could you send a sample of the worksheet, containing the formulas?"}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "reply_to_user": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "edited": false, "score": 0, "creation_date": 1464204471, "post_id": 37445284, "comment_id": 62394149, "body": "How do I do that @Kellsens?"}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "edited": false, "score": 0, "creation_date": 1464204534, "post_id": 37445284, "comment_id": 62394187, "body": "Take a print of your sheet, containing the data and post"}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "edited": false, "score": 0, "creation_date": 1464204950, "post_id": 37445284, "comment_id": 62394402, "body": "Hags, I think that BruceWayne code will help you."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464205625, "post_id": 37445284, "comment_id": 62394738, "body": "your SUMIFS() has three full column references, In this case it resolves to <code>SUMIFS(A:A,A:A,AM:AM)</code>  I think you are missing an <code>R</code> in the second criteria. <code>&quot;=SUMIF(&#39;RMI Current&#39;!C[-6],&#39;RMI Static Compare&#39;!RC[-6],&#39;RMI Current&#39;!C[32])&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1464203969, "post_id": 37445757, "comment_id": 62393833, "body": "What would I do to accommodate the formulas I have above?"}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1464204434, "post_id": 37445757, "comment_id": 62394132, "body": "And its not automatically updating the formulas, I have to go back in the cell and drag the formula down for them to update..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1464204436, "post_id": 37445757, "comment_id": 62394133, "body": "@Hags - I&#39;m going to let you attempt this first.  Look over my post, and see if you can understand what I did.  Then, attempt this on your own, and post your code into your OP if you run into issues.  It&#39;s pretty straightforward (assuming of course your formulas work, and there are no other issues)."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1464204473, "post_id": 37445757, "comment_id": 62394153, "body": "@Hags - Ah, I think I know why you are having to drag down... I&#39;ll edit my post"}, {"owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1464205074, "post_id": 37445757, "comment_id": 62394469, "body": "That works but the processors run so slow, is there any way to speed up the process?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "edited": false, "score": 0, "creation_date": 1464205279, "post_id": 37445757, "comment_id": 62394576, "body": "Again, I don&#39;t know what all of your code is, but check my edit"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1464210711, "post_id": 37445757, "comment_id": 62397330, "body": "FYI there is no benefit to turning off calculation if you assign the formula to entire ranges at once - they have to calculate as you do it. It only helps if you populate the first row and then use <code>FillDown</code>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1464205375, "last_edit_date": 1464205375, "creation_date": 1464203594, "answer_id": 37445757, "question_id": 37445284, "link": "https://stackoverflow.com/questions/37445284/how-can-i-speed-up-the-vba-to-quickly-populate-these-formulas/37445757#37445757", "title": "How can I speed up the VBA to quickly populate these formulas?", "body": "<p>Without knowing the rest of your code, I suggest adding in a <code>lastRow</code> variable, and worksheet variable to save some coding space:</p>\n\n<pre><code>Sub t()\nDim lastRow&amp;\nDim rmiWS As Worksheet\nSet rmiWS = Sheets(\"RMI Static Compare\")\n\nlastRow = rmiWS.Cells(rmiWS.Rows.Count, \"A\").End(xlUp).Row\n\nWith rmiWS\n    .Range(\"G2:G\" &amp; lastRow).FormulaR1C1 = \"=SUMIF('RMI Current'!C[-6],'RMI Static Compare'!C[-6],'RMI Current'!C[32])\"\nEnd With\n\n'The above `With` statement is the exact same as the below line. Notice you can use `.` as a placeholder for whatever follows `With`\n' Sheets(\"RMI Static Compare\").Range(\"G2:G\" &amp; Sheets(\"RMI Static Compare\").Cells(Sheets(\"RMI Static Compare\").Rows.Count, \"A\").End(xlUp).Row).Formula = .Range(\"G2:G\" &amp; lastRow).FormulaR1C1 = \"=SUMIF('RMI Current'!C[-6],'RMI Static Compare'!C[-6],'RMI Current'!C[32])\"\n\nEnd Sub\n</code></pre>\n\n<p>Notice the <code>.</code> before <code>Range()</code>, which effectively \"attached\" whatever follows <code>With</code> to that statement.  This should help you. </p>\n\n<p>Also, from your Formula, you want to use <code>R1C1</code> format.</p>\n\n<p>Now the issue is, does the <code>lastRow</code>do what you want?  </p>\n\n<p>Edit: Woah, the original question has changed since this answer...but the theory still applies to all of your formulas.</p>\n\n<p>Basically, this:\n<code>Sheets(\"RMI Static Compare\").Range(\"G2:G\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"=SUMIF('RMI Current'!C[-6],'RMI Static Compare'!C[-6],'RMI Current'!C[32])\"\nSheets</code></p>\n\n<p>needs to be either:</p>\n\n<pre><code>Sheets(\"RMI Static Compare\").Range(\"G2:G\" &amp; Sheets(\"RMI Static Compare\").Cells(Sheets(\"RMI Static Compare\").Rows.Count, \"F\").End(xlUp).Row).FormulaR1C1 = \"=SUMIF('RMI Current'!C[-6],'RMI Static Compare'!C[-6],'RMI Current'!C[32])\"\n</code></pre>\n\n<p>or </p>\n\n<pre><code>With Sheets(\"RMI Static Compare\")\n    .Range(\"G2:G\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row).FormulaR1C1 = \"=SUMIF('RMI Current'!C[-6],'RMI Static Compare'!C[-6],'RMI Current'!C[32])\"\nEnd with\n</code></pre>\n\n<p>Edit2: To put your formula in a range, with it automatically updating so you don't have to drag, do this:</p>\n\n<pre><code>With Sheets(\"RMI Static Compare\")\n   .Range(\"G2:G2\").Resize(.Cells(.Rows.Count, \"F\").End(xlUp).row - 1).FormulaR1C1 = \"=SUMIF('RMI Current'!C[-6],'RMI Static Compare'!C[-6],'RMI Current'!C[32])\"\nEnd With\n</code></pre>\n\n<p>You just need to set a range to a cell, then resize the row count - 1</p>\n\n<p>Editx:  Also, add these lines to the top of your Sub, and the others at the bottom:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n</code></pre>\n\n<p>then at the bottom</p>\n\n<pre><code> Application.ScreenUpdating = True\n Application.Calculation = xlCalculationAutomatic\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6316145, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ea15e8fb821f09a4d0a1eb4105d07166?s=128&d=identicon&r=PG&f=1", "display_name": "Hags", "link": "https://stackoverflow.com/users/6316145/hags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464205375, "creation_date": 1464201929, "last_edit_date": 1464203442, "question_id": 37445284, "link": "https://stackoverflow.com/questions/37445284/how-can-i-speed-up-the-vba-to-quickly-populate-these-formulas", "title": "How can I speed up the VBA to quickly populate these formulas?", "body": "<pre><code>Sheets(\"RMI Static Compare\").Range(\"G2:G\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"=SUMIF('RMI Current'!C[-6],'RMI Static Compare'!C[-6],'RMI Current'!C[32])\"\nSheets(\"RMI Static Compare\").Range(\"H2:H\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"=SUMIF('RMI Previous'!C[-7],'RMI Static Compare'!C[-7],'RMI Previous'!C[31])\"\nSheets(\"RMI Static Compare\").Range(\"I2:I\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"ABS(RC[-2])\"\nSheets(\"RMI Static Compare\").Range(\"J2:J\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"RC[-3]-RC[-2]\"\nSheets(\"RMI Static Compare\").Range(\"K2:K\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"=IFERROR(((RC[-4]-RC[-3])/RC[-3]),\"\"Zero Balance\"\")\"\nSheets(\"RMI Static Compare\").Range(\"L2:L\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"=IF(RC[-3]&gt;500000,\"\"Material\"\",\"\"Immaterial\"\")\"\nSheets(\"RMI Static Compare\").Range(\"M2:M\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row).Formula = \"=IF(AND(RC[-2]&gt;-0.01,RC[-2]&lt;0.01),\"\"Y\"\",\"\"N\"\")\"\n</code></pre>\n\n<p>I have over 80,000 rows to accommodate these formula and I need the formulas to stop at the last cell in column A/quickly populate the answers without taking 10 minutes each. Please help!</p>\n"}, {"tags": ["excel", "ms-project", "gantt-chart", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4778306, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b3cd0af0b33c9b9b49f2385a7226c7?s=128&d=identicon&r=PG&f=1", "display_name": "mithirich", "link": "https://stackoverflow.com/users/4778306/mithirich"}, "edited": false, "score": 0, "creation_date": 1464375611, "post_id": 37453373, "comment_id": 62477528, "body": "Wow awesome!!! This works out a lot better than what I was trying to do, just have to tweak a few things but this is looking good so far! Thank you so much."}, {"owner": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "edited": false, "score": 0, "creation_date": 1480594589, "post_id": 37453373, "comment_id": 69033096, "body": "Hi - I&#39;m new to Project Macros so I thought I would start with your code how ever when running it in Project 2013 I get a &quot;Complie error: User-defined type not defined&quot; on the Dim xlApp As Excel.Application command. Reading up ( <a href=\"http://stackoverflow.com/questions/19680402/excel-vba-compile-throws-a-user-defined-type-not-defined-error-but-does-not-go\" title=\"excel vba compile throws a user defined type not defined error but does not go\">stackoverflow.com/questions/19680402/&hellip;</a> ) there seems to have been changes to the format of the code. Is this correct or do I need to look else where on my own Project set up as I would have thought the code backwards compatible ? Thanks in advance T"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "edited": false, "score": 0, "creation_date": 1480595344, "post_id": 37453373, "comment_id": 69033542, "body": "@TerranBrown can you open a new post with your question, tag my name with the <code>@</code> so I&#39;ll see it"}, {"owner": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "edited": false, "score": 0, "creation_date": 1480602564, "post_id": 37453373, "comment_id": 69038497, "body": "Hi Shai - I tried tagging you via @ but for some reason failed... I&#39;ve opened the new question at <a href=\"http://stackoverflow.com/questions/40913058/ms-project-to-excel-gantt-chart-using-vba-follow-on\" title=\"ms project to excel gantt chart using vba follow on\">stackoverflow.com/questions/40913058/&hellip;</a> - thanks for your help in advance"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1464244937, "creation_date": 1464244937, "answer_id": 37453373, "question_id": 37445158, "link": "https://stackoverflow.com/questions/37445158/ms-project-to-excel-gantt-chart-using-vba/37453373#37453373", "title": "MS Project to Excel Gantt Chart using VBA", "body": "<p>It is possible, I have a MACRO that does that for years.\nUse the piece of code below.</p>\n\n<pre><code>Sub ExportToExcel()\n\nDim xlApp As Excel.Application\nDim xlBook As Excel.Workbook\nDim xlSheet As Excel.Worksheet\nDim proj As Project\nDim t As Task\nDim pj As Project\nDim pjDuration As Integer\nDim i As Integer\nSet pj = ActiveProject\nSet xlApp = New Excel.Application\nxlApp.Visible = True\n'AppActivate \"Excel\"\nSet xlBook = xlApp.Workbooks.Add\nSet xlSheet = xlBook.Worksheets(1)\nxlSheet.cells(1, 1).Value = \"Project Name\"\nxlSheet.cells(1, 2).Value = pj.Name\nxlSheet.cells(2, 1).Value = \"Project Title\"\nxlSheet.cells(2, 2).Value = pj.Title\nxlSheet.cells(1, 4).Value = \"Project Start\"\nxlSheet.cells(1, 5).Value = pj.ProjectStart\nxlSheet.cells(2, 4).Value = \"Project Finish\"\nxlSheet.cells(2, 5).Value = pj.ProjectFinish\n\nxlSheet.cells(1, 7).Value = \"Project Duration\"\npjDuration = pj.ProjectFinish - pj.ProjectStart\nxlSheet.cells(1, 8).Value = pjDuration &amp; \"d\"\n\nxlSheet.cells(4, 1).Value = \"Task ID\"\nxlSheet.cells(4, 2).Value = \"Task Name\"\nxlSheet.cells(4, 3).Value = \"Task Start\"\nxlSheet.cells(4, 4).Value = \"Task Finish\"\n\n' Add day of the week headers for the entire Project's duration\nFor i = 0 To pjDuration\n    xlSheet.cells(4, i + 5).Value = pj.ProjectStart + i\n    xlSheet.cells(4, i + 5).NumberFormat = \"[$-409]d-mmm-yy;@\"\nNext\n\nFor Each t In pj.Tasks\n    xlSheet.cells(t.ID + 4, 1).Value = t.ID\n    xlSheet.cells(t.ID + 4, 2).Value = t.Name\n    xlSheet.cells(t.ID + 4, 3).Value = t.Start\n    xlSheet.cells(t.ID + 4, 3).NumberFormat = \"[$-409]d-mmm-yy;@\"\n    xlSheet.cells(t.ID + 4, 4).Value = t.Finish\n    xlSheet.cells(t.ID + 4, 4).NumberFormat = \"[$-409]d-mmm-yy;@\"\n\n    For i = 5 To pjDuration + 5\n        'Loop to add day of week headers and color cells to mimic Gantt chart\n        If t.Start &lt;= xlSheet.cells(4, i) And t.Finish &gt;= xlSheet.cells(4, i) Then\n            xlSheet.cells(t.ID + 4, i).Interior.ColorIndex = 37\n        End If\n     Next i\nNext t\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4778306, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f1b3cd0af0b33c9b9b49f2385a7226c7?s=128&d=identicon&r=PG&f=1", "display_name": "mithirich", "link": "https://stackoverflow.com/users/4778306/mithirich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5466, "favorite_count": 2, "accepted_answer_id": 37453373, "answer_count": 1, "score": 2, "last_activity_date": 1465669627, "creation_date": 1464201499, "last_edit_date": 1531161705, "question_id": 37445158, "link": "https://stackoverflow.com/questions/37445158/ms-project-to-excel-gantt-chart-using-vba", "title": "MS Project to Excel Gantt Chart using VBA", "body": "<p>I'm trying to export some tasks from MS Project to Excel using a VBA script in Project. So far I am able to export the data I want with no issue and it opens in Excel just fine. What I'm trying to do now is take that data in Excel and replicate into a Gantt chart similar to the one in Project. I know I know, what's the point of going through all this just to get a Gantt chart in Excel when I already have one in Project right? Well among other things this Excel gantt chart is being made so that everyone without MS Project can view the scheduled tasks without having MS Project. </p>\n\n<p>So what I've tried so far(since excel doesn't have a built in Gantt maker) is to make the chart on the spreadsheet, coloring the cells to mimic a Gantt chart. My two main issues: \n1. I don't know how to add an offset for each specific task depending on what day it starts on\n2. I don't know how to color the correct number of cells(right now it colors cells in multiples of 7, or weeks at a time instead of down to the specific day.</p>\n\n<pre><code>Sub ExportToExcel()\nDim xlApp As Excel.Application\nDim xlBook As Excel.Workbook\nDim xlSheet As Excel.Worksheet\nDim proj As Project\nDim t As Task\nDim pj As Project\nDim i As Integer\nSet pj = ActiveProject\nSet xlApp = New Excel.Application\nxlApp.Visible = True\nAppActivate \"Excel\"\nSet xlBook = xlApp.Workbooks.Add\nSet xlSheet = xlBook.Worksheets(1)\nxlSheet.Cells(1, 1).Value = \"Project Name\"\nxlSheet.Cells(1, 2).Value = pj.Name\nxlSheet.Cells(2, 1).Value = \"Project Title\"\nxlSheet.Cells(2, 2).Value = pj.Title\nxlSheet.Cells(4, 1).Value = \"Task ID\"\nxlSheet.Cells(4, 2).Value = \"Task Name\"\nxlSheet.Cells(4, 3).Value = \"Task Start\"\nxlSheet.Cells(4, 4).Value = \"Task Finish\"\n\nFor Each t In pj.Tasks\n    xlSheet.Cells(t.ID + 4, 1).Value = t.ID\n    xlSheet.Cells(t.ID + 4, 2).Value = t.Name\n    xlSheet.Cells(t.ID + 4, 3).Value = t.Start\n    xlSheet.Cells(t.ID + 4, 4).Value = t.Finish\n\n    Dim x As Integer\n    'x is the duration of task in days(i.e. half a day long task is 0.5)\n    x = t.Finish - t.Start\n    'Loop to add day of week headers and color cells to mimic Gantt chart\n    For i = 0 To x\n        xlSheet.Cells(4, (7 * i) + 5).Value = \"S\"\n        xlSheet.Cells(4, (7 * i) + 6).Value = \"M\"\n        xlSheet.Cells(4, (7 * i) + 7).Value = \"T\"\n        xlSheet.Cells(4, (7 * i) + 8).Value = \"W\"\n        xlSheet.Cells(4, (7 * i) + 9).Value = \"T\"\n        xlSheet.Cells(4, (7 * i) + 10).Value = \"F\"\n        xlSheet.Cells(4, (7 * i) + 11).Value = \"S\"\n\n        xlSheet.Cells(t.ID + 4, ((7 * i) + 5)).Interior.ColorIndex = 37\n        xlSheet.Cells(t.ID + 4, (7 * i) + 6).Interior.ColorIndex = 37\n        xlSheet.Cells(t.ID + 4, (7 * i) + 7).Interior.ColorIndex = 37\n        xlSheet.Cells(t.ID + 4, (7 * i) + 8).Interior.ColorIndex = 37\n        xlSheet.Cells(t.ID + 4, (7 * i) + 9).Interior.ColorIndex = 37\n        xlSheet.Cells(t.ID + 4, (7 * i) + 10).Interior.ColorIndex = 37\n        xlSheet.Cells(t.ID + 4, (7 * i) + 11).Interior.ColorIndex = 37\n    Next i\nNext t\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/nrDuH.png\" rel=\"nofollow\">Screenshot of current MS project output in Excel</a></p>\n\n<p>If anyone has any better suggestions please let me know. I'm pretty new to this and not sure if this is even possible or if it is possible and just so complicated that its not even worth it.</p>\n"}, {"tags": ["vba", "ms-access", "syntax", "import", "path"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1464213508, "post_id": 37444619, "comment_id": 62398457, "body": "Check your combo box. Is the name of the spreadsheet appearing in drop down the bound column or is a hidden ID the bound column?"}], "answers": [{"comments": [{"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464201406, "post_id": 37445001, "comment_id": 62392425, "body": "The code is running from a button I made on the same form as the combo box."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 1, "creation_date": 1464201459, "post_id": 37445001, "comment_id": 62392458, "body": "I think he uses makro not <code>vba</code> so it should be <code>= &quot;J:\\blah\\Spreadsheet_&quot; &amp; [Forms]![myForm]![Combo353].Value</code>"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464201518, "post_id": 37445001, "comment_id": 62392493, "body": "@whatwhatwhat I forgot to add the file extension. I have edited my answer. If you get the same error, post the control source of your combobox and the code opening the file."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "reply_to_user": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1464201544, "post_id": 37445001, "comment_id": 62392516, "body": "@BitAccesser yes, I am trying this in a macro. I listed VBA in case this is <i>impossible</i> with a macro (in order to keep things simple!)"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464202224, "post_id": 37445001, "comment_id": 62392904, "body": "Same error @ChristopherD. What do you mean by the control source and the code opening the file? For the combo box I&#39;m using the On Click event to run an Embedded Macro and then in the screen where one can create a macro I&#39;m using the ImportExportSpreadsheet action."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464202227, "post_id": 37445001, "comment_id": 62392908, "body": "@what Did my comment work for you , if not show the error message!"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "reply_to_user": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1464202467, "post_id": 37445001, "comment_id": 62393053, "body": "@BitAccesser it did not work. I get the same error message for all different combinations suggested so far (see the error in the question). It can&#39;t seem to &quot;find the object&quot;. I made sure to copy the path directly from the Windows File Explorer and also copy the first part of the file name so that there is no way I could make a typo."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464202766, "post_id": 37445001, "comment_id": 62393221, "body": "<code>The Microsoft database engine could not find the object &#39;J:\\blah\\&quot;J:\\blah\\Spreadsheet_&quot; &amp; [Forms]![MainForm]![Combo353].Value &amp; &quot;.xlsx&quot;&#39;. Make sure the object exists....</code>"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464202840, "post_id": 37445001, "comment_id": 62393252, "body": "That&#39;s really weird - it&#39;s recognizing the file path twice even though in my macro I certainly don&#39;t write it twice..."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464202922, "post_id": 37445001, "comment_id": 62393291, "body": "@what Please post your macro and the control source of your combo box. The control source is in the properties of your combo box. It should be a SQL statement. Edit your question to include those two things."}, {"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464202935, "post_id": 37445001, "comment_id": 62393295, "body": "@what you missed the <code>=</code> at start!"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464203082, "post_id": 37445001, "comment_id": 62393365, "body": "@ChristopherD. strange but the control source for the combo box is blank, yet I still get the 4 values I want.... editing the question in a bit, need to switch locations/computers."}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464263993, "post_id": 37445001, "comment_id": 62419503, "body": "I figured out what was causing that error. The problem was that while I was testing this out, I used some VBA code I found online to set the strPath to the file location. So I just cleared the variable using <code>Set strPath = Nothing</code>. But I&#39;m getting another error now - <code>Field &#39;F1&#39; doesn&#39;t exist in the destination table &#39;table_A.&#39;</code>"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 0, "creation_date": 1464264111, "post_id": 37445001, "comment_id": 62419577, "body": "My table has 2 fields: an autonumber <code>ID</code> field and an <code>item</code> field. I need to clear the contents of the table before importing, then only import the 1 column in the spreadsheet to the <code>item</code> column in the table. Any thoughts?"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "edited": false, "score": 1, "creation_date": 1464267368, "post_id": 37445001, "comment_id": 62421842, "body": "@whatwhatwhat I can&#39;t help you there since I don&#39;t know the macro importing the table. Considering you are getting an error on a new line, I suggest closing this question and asking another question to address your new issue."}], "tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": true, "score": 3, "last_activity_date": 1464201609, "last_edit_date": 1464201609, "creation_date": 1464200903, "answer_id": 37445001, "question_id": 37444619, "link": "https://stackoverflow.com/questions/37444619/ms-access-how-do-make-access-search-for-a-filename-based-on-what-a-user-selecte/37445001#37445001", "title": "MS Access: How do make Access search for a filename based on what a user selected in a combo box?", "body": "<p>Your syntax isn't quite right:</p>\n\n<pre><code>\"J:\\blah\\Spreadsheet_\" &amp; [Forms]![MyFormName]![Combo353].Value &amp; \".xls\"\n</code></pre>\n\n<p>Assuming the code is running from the form containing the combobox.</p>\n\n<p>The path is static, so that is considered a string. Strings are held in double-quotes. Then we want to add the combo value to the end of that string. When you add a string to a string, you perform \"Concatenation,\" which requires the ampersand to show that the two strings should be added together. Since the combobox reference is identifying the control whose value we want to drop into the string, that is left out of the quotations so Access evaluates the value instead of the control name itself.</p>\n"}], "owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 37445001, "answer_count": 1, "score": 0, "last_activity_date": 1464267804, "creation_date": 1464199551, "last_edit_date": 1464267804, "question_id": 37444619, "link": "https://stackoverflow.com/questions/37444619/ms-access-how-do-make-access-search-for-a-filename-based-on-what-a-user-selecte", "title": "MS Access: How do make Access search for a filename based on what a user selected in a combo box?", "body": "<p>I know how to make Access import a spreadsheet by stating its location and filename, but in the same folder I have 3 similar files. I want the user to be able to import the one they want by selecting a value in a combobox. </p>\n\n<p>For example, if the user selects \"A\" from the combobox, then Access should look for the spreadsheet called \"Spreadsheet_A\". What is the syntax to accomplish this?</p>\n\n<p><strong>What I've tried:</strong></p>\n\n<p>I tried making a macro and using the ImportExportSpreadsheet action. I tried specifying the file name as <code>J:\\blah\\Spreadsheet_[Combo353]</code> and also <code>J:\\blah\\Spreadsheet_+[Combo353]</code> and even <code>J:\\blah\\Spreadsheet_+\"[Combo353]</code>\" but they all return the same error: </p>\n\n<blockquote>\n  <p>The Microsoft Access database engine could not find the object 'J:\\blah\\Spreadsheet_[Combo353].xlsx. Make sure the object exists.....</p>\n</blockquote>\n\n<p>I'm positive that the path is correct, I just need to know the syntax of how to make it use the value in the combo box. If not possible, I'm happy with a VBA solution as well.</p>\n\n<hr>\n\n<p><strong>Solution was a two-part thing: write the correct syntax (see answer below) and also unset the <code>strpath</code> variable</strong></p>\n"}, {"tags": ["excel", "tableau-api", "crosstab", "vba"], "comments": [{"owner": {"reputation": 2852, "user_id": 4829177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/23ee6b9a75a63e48932516e446ae2818?s=128&d=identicon&r=PG", "display_name": "Bernardo", "link": "https://stackoverflow.com/users/4829177/bernardo"}, "edited": false, "score": 0, "creation_date": 1464222674, "post_id": 37444509, "comment_id": 62401085, "body": "What happens when you Copy the cross tab and paste it into an opened excel workbook?"}], "answers": [{"tags": [], "owner": {"reputation": 2260, "user_id": 5240970, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/16a645b64ff208b3ba9269dcf90305fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kabard", "link": "https://stackoverflow.com/users/5240970/kabard"}, "is_accepted": false, "score": 1, "last_activity_date": 1464284794, "creation_date": 1464284794, "answer_id": 37467778, "question_id": 37444509, "link": "https://stackoverflow.com/questions/37444509/problems-after-exporting-tableau-crosstab-to-excel/37467778#37467778", "title": "Problems after exporting Tableau Crosstab to Excel", "body": "<p>Because you are downloading a csv file not an excel file. So you are probably saving to excel format after opening and closing the crosstab. </p>\n\n<p>Take a look at the properties of the file after you download (before you open it) then after you open and close the file.</p>\n"}], "owner": {"reputation": 19, "user_id": 6376885, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/516a7bad088bfbfe70c18b9f64f7bfca?s=128&d=identicon&r=PG&f=1", "display_name": "William Moore", "link": "https://stackoverflow.com/users/6376885/william-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464284794, "creation_date": 1464199156, "last_edit_date": 1531164843, "question_id": 37444509, "link": "https://stackoverflow.com/questions/37444509/problems-after-exporting-tableau-crosstab-to-excel", "title": "Problems after exporting Tableau Crosstab to Excel", "body": "<p>Whenever I export Crosstab to Excell from Tableau, it works fine. But once it's done, I can't use any macros from my personal workbook or move the sheet to another workbook until I save, close, and reopen the new file. Is there some setting I can change to allow faster editing?</p>\n"}, {"tags": ["vba", "sharepoint", "ado"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4807548, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-VOm1ycCybyk/AAAAAAAAAAI/AAAAAAAACXU/n9BX1I1JVTw/photo.jpg?sz=128", "display_name": "Chris McKay", "link": "https://stackoverflow.com/users/4807548/chris-mckay"}, "edited": false, "score": 0, "creation_date": 1464210144, "post_id": 37445827, "comment_id": 62397070, "body": "Thanks, I tried that, still nothing.  No error, and also no AssignedTo value showing in my list"}], "tags": [], "owner": {"reputation": 36, "user_id": 1585408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1a7f4e1140295e3c88271bde1b5acb?s=128&d=identicon&r=PG", "display_name": "mriedel90", "link": "https://stackoverflow.com/users/1585408/mriedel90"}, "is_accepted": false, "score": 0, "last_activity_date": 1464203823, "creation_date": 1464203823, "answer_id": 37445827, "question_id": 37444300, "link": "https://stackoverflow.com/questions/37444300/how-do-i-assign-a-sharepoint-2013-task-to-someone-in-vba/37445827#37445827", "title": "How do I assign a sharepoint 2013 task to someone in VBA", "body": "<p>The value would have to be in the format of <code>LookupId;#LookupValue</code></p>\n\n<p>Where <strong>LookupId</strong> is the user's ID for that particular site and the <strong>LookupValue</strong> is the users Display Name</p>\n\n<p>So you would have:</p>\n\n<p>AssignedTo = \"48;#Chris McKay\"</p>\n"}], "owner": {"reputation": 37, "user_id": 4807548, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-VOm1ycCybyk/AAAAAAAAAAI/AAAAAAAACXU/n9BX1I1JVTw/photo.jpg?sz=128", "display_name": "Chris McKay", "link": "https://stackoverflow.com/users/4807548/chris-mckay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464203823, "creation_date": 1464198369, "question_id": 37444300, "link": "https://stackoverflow.com/questions/37444300/how-do-i-assign-a-sharepoint-2013-task-to-someone-in-vba", "title": "How do I assign a sharepoint 2013 task to someone in VBA", "body": "<p>Here is my code, I'm in using VBA.  I get no errors, the task is added to the sharepoint list, but the Assigned To field is blank.</p>\n\n<p>I have also listed all the fields in the recordset and there is no Assignment field available.  I noticed some unanswered questions on the web about how to query the value of a lookup field.</p>\n\n<pre><code>sConn = \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=0;RetrieveIds=Yes;\" &amp; _\n\"DATABASE=\" &amp; sSHAREPOINT_SITE &amp; \";\" &amp; _\n\"LIST=\" &amp; sTASK_LIST_GUID &amp; \";\"\n\n' Create some new objects.\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\n' Open the connection.\nWith cn\n.ConnectionString = sConn\n.Open\nEnd With\n\nsSQL = \"SELECT * FROM [Tasks] as tbl;\"\n\n' Open up the recordset.\nrs.Open sSQL, cn, adOpenStatic, adLockOptimistic\nWith rs\n    .AddNew\n    ![Task Name] = \"test\"\n    AssignedTo = \"SomeEmailAddress\"\n    ![Categories] = \"Data Requests\"\n    .Update\nEnd With\nrs.Close\n</code></pre>\n\n<p>I do know how to do this if I \"connect with Outlook\", but I was trying to avoid all that.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464198115, "post_id": 37444186, "comment_id": 62390575, "body": "On which line do you get the error?"}, {"owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464198182, "post_id": 37444186, "comment_id": 62390619, "body": "Set dColumns = wb.Worksheets(&quot;LL Columns to Delete&quot;).Range(&quot;A&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1464198899, "post_id": 37444250, "comment_id": 62391020, "body": "@AnthonyS.Erdenetuguldur - I haven&#39;t run it, but from looking at it, does it work? Can you use <code>Find</code> with a column reference?  It&#39;s looking in <code>Cells(i,1)</code> for ...&quot;Column A&quot;? But anyway - did changing the range fix the issue?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1464199193, "post_id": 37444250, "comment_id": 62391201, "body": "@AnthonyS.Erdenetuguldur - Yeah, that&#39;s what I was thinking.  In your OP, can you clarify what you&#39;re expecting to find in <code>Cells(1,i)</code>? Perhaps post some sample data?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1464199594, "post_id": 37444250, "comment_id": 62391427, "body": "@AnthonyS.Erdenetuguldur - <code>Cells(1,i)</code> is a single cell, not an area to search. Do you expect <code>Cells(1,i)</code> to have <code>A</code> in it, then we know to delete column A?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1464199792, "post_id": 37444250, "comment_id": 62391541, "body": "@AnthonyS.Erdenetuguldur the value that you are putting in <code>dColumns</code> in what cell is it?  I think you want <code>wb.Worksheets(&quot;LL Columns to Delete&quot;).Range(&quot;A1&quot;)</code> or some specific cell, with the value to find.  Or you have your <code>Find</code> fields backwards."}, {"owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1464199800, "post_id": 37444250, "comment_id": 62391548, "body": "@BruceWayne, Yes. I want to lookup all headers located in dColumns in cells(1,i), and delete it."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 1, "creation_date": 1464201311, "post_id": 37444250, "comment_id": 62392377, "body": "@AnthonyS.Erdenetuguldur you are looping trough the wrong things.  You need to loop through <code>dColumn</code> and use each individual cell value in your search of row 1 so say we do <code>For Each rng in dColumn</code> then our find would be <code>Set rngfind = wb2.Range(&quot;1:1&quot;).Find(dcolumn</code> then you would <code>Columns(rngfind.Column).delete</code>"}, {"owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464201541, "post_id": 37444250, "comment_id": 62392512, "body": "@ScottCraner, can you post the loop-code that will go under this section of my module. Dim dColumns As Range Set dColumns = wb.Worksheets(&quot;LL Columns to Delete&quot;).Range(&quot;A:A&quot;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "edited": false, "score": 0, "creation_date": 1464201711, "post_id": 37444250, "comment_id": 62392605, "body": "@AnthonyS.Erdenetuguldur sorry, I do not have the time at the moment.  Try it on your own for a little while.  If I get time later today I will try to loop back."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 3, "last_activity_date": 1464198243, "creation_date": 1464198243, "answer_id": 37444250, "question_id": 37444186, "link": "https://stackoverflow.com/questions/37444186/vba-loop-to-delete-multiple-columns/37444250#37444250", "title": "VBA Loop to Delete Multiple Columns", "body": "<p>You can't do just <code>Range(\"A\")</code>, replace that with <code>Range(\"A:A\")</code>.</p>\n\n<p>(But what are you trying to do with <code>dColumns</code>?)</p>\n"}, {"tags": [], "owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1464208885, "creation_date": 1464208885, "answer_id": 37447230, "question_id": 37444186, "link": "https://stackoverflow.com/questions/37444186/vba-loop-to-delete-multiple-columns/37447230#37447230", "title": "VBA Loop to Delete Multiple Columns", "body": "<p>I solved it by just deleting the column when I open wb2. This question is no longer need to be answered or solved. </p>\n"}], "owner": {"reputation": 465, "user_id": 6067330, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e845adc44c36a90ca47da0c5c2749613?s=128&d=identicon&r=PG&f=1", "display_name": "ASE Dev", "link": "https://stackoverflow.com/users/6067330/ase-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464208885, "creation_date": 1464198025, "last_edit_date": 1464200814, "question_id": 37444186, "link": "https://stackoverflow.com/questions/37444186/vba-loop-to-delete-multiple-columns", "title": "VBA Loop to Delete Multiple Columns", "body": "<p>I want to search/loop through all the columns headers located on row 1 of the opened file and delete it if it matches dColumns, which is a list of columns I do not needed and I put in a range. </p>\n\n<pre><code>Sub LLextract()\n\n'Last cell in column\nDim WS As Worksheet\nDim LastCell As Range\nDim LastCellRowNumber As Long\n\nSet WS = ThisWorkbook.Worksheets(\"Consolidated Data\")\nWith WS\n    Set LastCell = .Cells(.Rows.Count, \"A\").End(xlUp)\n    LastCellRowNumber = LastCell.Row + 0\nEnd With\n\nDim wb As Workbook, wb2 As Workbook\nDim vFile As Variant\n\n'Set source workbook\nSet wb = ActiveWorkbook\n\n'Open the target workbook\nvFile = Application.GetOpenFilename(\"CSV Files (*.csv), *.csv\", , _\n      \"Select a CSV file\", , False)\n\n'if the user didn't select a file, exit sub\nIf TypeName(vFile) = \"Boolean\" Then Exit Sub\nWorkbooks.Open vFile\n\n'Set selectedworkbook\nSet wb2 = ActiveWorkbook\n\nDim dColumns As Range\nSet dColumns = wb.Worksheets(\"LL Columns to Delete\").Range(\"A:A\")\n\n    Dim i As Integer\n    Dim A As Range\n    For i = 94 To 1 Step -1\n        Set A = wb2.Cells(1, i)\n        If wb2.Cells(1, i) = dColumns Then A.EntireColumn.Delete\n    Next i\n\n'wb2.Worksheets(1).Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464199574, "post_id": 37444009, "comment_id": 62391416, "body": "what is that <code>Call Delete_Pictures</code> for? Isn&#39;t it removing all pictures from the same worksheet whose <code>Range(&quot;BP73:BX87&quot;)</code> you&#39;re hoping to copy pictures from?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1464199721, "post_id": 37444009, "comment_id": 62391502, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17980854/vba-runtime-error-1004-application-defined-or-object-defined-error-when-select\">VBA Runtime Error 1004 &quot;Application-defined or Object-defined error&quot; when Selecting Range</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5389590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153195219322621/picture?type=large", "display_name": "Luis Lara", "link": "https://stackoverflow.com/users/5389590/luis-lara"}, "edited": false, "score": 1, "creation_date": 1464215304, "post_id": 37444222, "comment_id": 62399155, "body": "You were right. Using .Select was giving me issues. I already have a couple hours using your code and haven&#39;t appeared errors."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 5, "last_activity_date": 1464198919, "last_edit_date": 1495542705, "creation_date": 1464198136, "answer_id": 37444222, "question_id": 37444009, "link": "https://stackoverflow.com/questions/37444009/vba-runtime-error-1004-microsoft-excel-cannot-paste-the-data/37444222#37444222", "title": "vba runtime error 1004 microsoft excel cannot paste the data", "body": "<p>I'm betting it's the <code>.Select</code>. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this thread</a> on how to avoid using <code>.Select</code>, which can cause issues.  </p>\n\n<pre><code>Sub Button_US()\nDim myPic As Picture\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nCells(1, 1) = \"US\"\n\n'Call Delete_Pictures\n\nIf Cells(2, 1) = \"PC\" Then\n    Range(\"BP73:BX87\").Copy\n    With Worksheets(\"Main\")\n        Set myPic = .Pictures.Paste(Link:=True)\n        myPic.Left = .Range(\"Z7\").Left\n        myPic.Top = .Range(\"Z7\").Top\n'        .Range(\"Z7\").Pictures.Paste(Link:=True).Select\n    End With\nEnd If\n\nApplication.CutCopyMode = False\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>(Also, I got some insight from <a href=\"http://www.mrexcel.com/forum/excel-questions/836840-visual-basic-applications-paste-linked-picture-set-formula-named-range.html\" rel=\"nofollow noreferrer\">this thread</a>)</p>\n"}], "owner": {"reputation": 75, "user_id": 5389590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10153195219322621/picture?type=large", "display_name": "Luis Lara", "link": "https://stackoverflow.com/users/5389590/luis-lara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5448, "favorite_count": 0, "accepted_answer_id": 37444222, "answer_count": 1, "score": 0, "last_activity_date": 1464198919, "creation_date": 1464197489, "question_id": 37444009, "link": "https://stackoverflow.com/questions/37444009/vba-runtime-error-1004-microsoft-excel-cannot-paste-the-data", "title": "vba runtime error 1004 microsoft excel cannot paste the data", "body": "<p>I have some code in VBA, I have several Country and Product buttons.</p>\n\n<p><em>My goal is when I click a button, Cells (1, 1) will be overwrite with a text like \"US\", \"CA\", \"MX\" and cells (2, 1) with \"PC\", \"Printers\"</em></p>\n\n<p><em>Example: If Cells (1, 1) = US Then select a Range, copy the Range and finally paste it in the same sheet but as a picture and in a different Range.</em></p>\n\n<p><em>But firts I need to delete the previous picture to replace it with the new one.</em></p>\n\n<p>It works, but sometimes it appears a message with the following error and doesn't paste the range.</p>\n\n<p>'runtime error 1004 - microsoft excel cannot paste the data'</p>\n\n<p>The code to delete pictures.</p>\n\n<pre><code>Sub Delete_Pictures()\n    For Each Shape In ActiveSheet.Shapes\n        If Left(Shape.Name, 7) = \"Picture\" Then\n           Shape.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Let's suppose I already click on PC Button and Cells (2, 1) contains = 'PC'</p>\n\n<p>If I click US Button the macro should do the following.</p>\n\n<pre><code>Sub Button_US()\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n\n    Cells(1, 1) = \"US\"\n\n    Call Delete_Pictures\n\n       If Cells(2, 1) = \"PC\" Then\n       Range(\"BP73:BX87\").Select\n       Selection.Copy\n           With Worksheets(\"Main\")\n               .Activate\n               .Range(\"Z7\").Select\n               .Pictures.Paste(Link:=True).Select\n           End With\n       End If\n\n   Application.CutCopyMode = False\n\n   Application.ScreenUpdating = True\n   Application.EnableEvents = True\n\n End Sub\n</code></pre>\n\n<p>I want to know if there is a way to correct this one, or if there are other ways to copy and paste a range without this kind of errors.</p>\n"}, {"tags": ["regex", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464197747, "post_id": 37444067, "comment_id": 62390353, "body": "The post state that it must be done in VBA. your solution does not work in VBA"}, {"owner": {"reputation": 13556, "user_id": 1400971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825a9bf179b05302991fbbf9551355ac?s=128&d=identicon&r=PG", "display_name": "Ro Yo Mi", "link": "https://stackoverflow.com/users/1400971/ro-yo-mi"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464198001, "post_id": 37444067, "comment_id": 62390520, "body": "also included a vba example"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464198105, "post_id": 37444067, "comment_id": 62390568, "body": "What is <code>strReplace</code>"}], "tags": [], "owner": {"reputation": 13556, "user_id": 1400971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825a9bf179b05302991fbbf9551355ac?s=128&d=identicon&r=PG", "display_name": "Ro Yo Mi", "link": "https://stackoverflow.com/users/1400971/ro-yo-mi"}, "is_accepted": false, "score": 1, "last_activity_date": 1464198827, "last_edit_date": 1464198827, "creation_date": 1464197642, "answer_id": 37444067, "question_id": 37443992, "link": "https://stackoverflow.com/questions/37443992/implementing-regex-into-access-vba-for-password-complexity/37444067#37444067", "title": "Implementing Regex into Access VBA for Password Complexity", "body": "<p>with VB.net it would look something like:</p>\n\n<pre><code>Imports System.Text.RegularExpressions\nDim sourcestring as String = \"replace with your source string\"\nDim re As Regex = New Regex(\"^(?:(?=.*[a-z])(?:(?=.*[A-Z])(?=.*[\\d\\W])|(?=.*\\W)(?=.*\\d))|(?=.*\\W)(?=.*[A-Z])(?=.*\\d)).{7,12}$\")\nDim mc as MatchCollection = re.Matches(sourcestring)\n</code></pre>\n\n<p>With VBA it would look something like this:</p>\n\n<pre><code>    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"^(?:(?=.*[a-z])(?:(?=.*[A-Z])(?=.*[\\d\\W])|(?=.*\\W)(?=.*\\d))|(?=.*\\W)(?=.*[A-Z])(?=.*\\d)).{7,12}$\"\n    End With\n\n    If regEx.Test(strInput) Then\n        MsgBox (\"matched\")\n    Else\n        MsgBox (\"Not matched\")\n    End If\n</code></pre>\n\n<p>The variable MC could be tested, if it contains any values then your source string was matched by your regex.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6381584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7414ee5e43c78f85b20beaf281864931?s=128&d=identicon&r=PG&f=1", "display_name": "geeko55", "link": "https://stackoverflow.com/users/6381584/geeko55"}, "edited": false, "score": 0, "creation_date": 1464201608, "post_id": 37444189, "comment_id": 62392541, "body": "This is exactly what I was looking for! I got it to call properly in my form, so the big hurdle is done. Thank you very much for your help, I really appreciate it!"}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": true, "score": 3, "last_activity_date": 1464198033, "creation_date": 1464198033, "answer_id": 37444189, "question_id": 37443992, "link": "https://stackoverflow.com/questions/37443992/implementing-regex-into-access-vba-for-password-complexity/37444189#37444189", "title": "Implementing Regex into Access VBA for Password Complexity", "body": "<p>You need to return the answer, Also, the <code>test</code>\u00a0method is the one that return you a yes/no answer. <code>Execute</code>\u00a0returns a set of string that matches</p>\n\n<pre><code>Public Function fValPass(ByVal strPass As String) As Boolean\nDim result As String\nDim RE As Object\n'   Sets the regular expression object\nSet RE = CreateObject(\"VBScript.RegExp\")\nWith RE\n    .Pattern = \"^(?:(?=.*[a-z])(?:(?=.*[A-Z])(?=.*[\\d\\W])|(?=.*\\W)(?=.*\\d))|(?=.*\\W)(?=.*[A-Z])(?=.*\\d)).{7,12}$\"\n    '   Does not ignore case\n    .IgnoreCase = False\n    fValPass  = .Test(strPass) 'affecting to the name of the function is how you return a value in VBA\nend with\nEnd Function\n</code></pre>\n\n<p>P.S. I assumed that the message box was for tests only and removed it</p>\n"}], "owner": {"reputation": 33, "user_id": 6381584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7414ee5e43c78f85b20beaf281864931?s=128&d=identicon&r=PG&f=1", "display_name": "geeko55", "link": "https://stackoverflow.com/users/6381584/geeko55"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "accepted_answer_id": 37444189, "answer_count": 2, "score": 3, "last_activity_date": 1464198827, "creation_date": 1464197422, "question_id": 37443992, "link": "https://stackoverflow.com/questions/37443992/implementing-regex-into-access-vba-for-password-complexity", "title": "Implementing Regex into Access VBA for Password Complexity", "body": "<p>I'm currently working on a project that requires password validation, as End Users have the ability to change their login password, but there is no validation to ensure that the given password is within compliance. </p>\n\n<p>It's been a little tricky, as I'm fairly new to working with VBA and Regular Expressions, and I can't quite find the answer I'm looking for.</p>\n\n<p>The project has an Access 2010 Front End, and while I have the line of Regex code that I need to validate the passwords, I'm still a little unsure as to how I can implement it in a function, and call it in my form after the User enters a password.</p>\n\n<p>The code I've been trying to get work is as follows:</p>\n\n<pre><code>'Password must be between 7 to 12 characters\n'Password must contain at least 1 Lowercase, 1 Uppercase, 1 number, and/or 1 Special character\n\n\nPublic Function fValPass(ByVal strPass As String) As Boolean\nDim result As String\nDim RE As Object\n'   Sets the regular expression object\nSet RE = CreateObject(\"VBScript.RegExp\")\nWith RE\n    .Pattern = \"^(?:(?=.*[a-z])(?:(?=.*[A-Z])(?=.*[\\d\\W])|(?=.*\\W)(?=.*\\d))|(?=.*\\W)(?=.*[A-Z])(?=.*\\d)).{7,12}$\"\n    '   Does not ignore case\n    .IgnoreCase = False\nRE.Execute (strPass)\n\nIf fValPass = True Then\nMsgBox \"True\", vbOKOnly\nElse\n    MsgBox \"False\", vbOKOnly\n    End If\n    End With\nEnd Function\n</code></pre>\n\n<p>I know it might be clunky, but I'm really at a loss here. I'd appreciate any help getting me on the right track, but I realize this might be a rather niche thing I'm trying to build.</p>\n"}, {"tags": ["vba", "excel", "vbscript", "macros"], "comments": [{"owner": {"reputation": 285, "user_id": 5116833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4ce5802b57d6f980e717d03e389a292?s=128&d=identicon&r=PG&f=1", "display_name": "yarz-tech", "link": "https://stackoverflow.com/users/5116833/yarz-tech"}, "edited": false, "score": 0, "creation_date": 1464198160, "post_id": 37443803, "comment_id": 62390605, "body": "@JohnColeman  I have spent a large portion of my time trying to find an answer for this and it isn&#39;t out there."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1464199100, "post_id": 37443803, "comment_id": 62391146, "body": "The truth is out there! :-) I have the exact same requirement except it&#39;s CSV files. My add-in code detects if I open a csv file it checks if the file has the correct content and then asks if I want to do the add-in calculations. And the self install and auto update over internet for my users :-)"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1464208411, "post_id": 37443803, "comment_id": 62396176, "body": "just tell me if you need help implementing the code with your code."}], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 5116833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4ce5802b57d6f980e717d03e389a292?s=128&d=identicon&r=PG&f=1", "display_name": "yarz-tech", "link": "https://stackoverflow.com/users/5116833/yarz-tech"}, "edited": false, "score": 0, "creation_date": 1464197527, "post_id": 37443936, "comment_id": 62390229, "body": "If you could, yes I do need a self-install for add-in."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 0, "last_activity_date": 1464198796, "last_edit_date": 1464198796, "creation_date": 1464197208, "answer_id": 37443936, "question_id": 37443803, "link": "https://stackoverflow.com/questions/37443803/run-macro-from-desktop-shortcut/37443936#37443936", "title": "Run Macro from Desktop Shortcut", "body": "<p>You need to make it a excel add-in.  </p>\n\n<p>Then in the add-in make it run on workbook open with <code>Sub App_SheetActivate(ByVal Sh As Object)</code> in thisworkbook.  </p>\n\n<p>In the macro you can then have it only activate on certain workbook name or workbook type by: </p>\n\n<pre><code>If range(\"A1\").value = \"something\" ' something that makes the workbook type special.\n' Maybe you need B1 value and so on too.\n</code></pre>\n\n<p>Do you need a way to self-install the add in just let me know and I have a code for that too.  </p>\n\n<p>Self install:  </p>\n\n<pre><code>' if add-in is not installed and the workbook is a add-in (workbookcount =0)\n' Also take note that this code will only run if the add-in is not installed\nIf Dir(Application.UserLibraryPath &amp; \"YourWorkbookName.xlam\") = \"\" And Workbooks.Count = 0 Then\n     'optional ask user if he wants to install or not. Code not included.\n\n     ' copy file from current position to add-ins folder.\n     Result = apiCopyFile(ThisWorkbook.FullName, Application.UserLibraryPath &amp; \"YourWorkbookName.xlam\", False)\n     ' activate the add-in\n     AddIns(\"YourAdd-inName\").Installed = True\n\n     msgbox(\"add-in installed\")\n\n     ' Close Excel since add-ins does not work without restart of Excel\n     On Error Resume Next\n     Application.Interactive = False\n     AppActivate \"Microsoft Excel\"\n     Application.Quit\n     Exit Sub \nEnd If\n</code></pre>\n\n<p>Note that the file <strong>must</strong> be saved as a add-in. (xlam) this means there is no sheets, the workbook is VBA code only.<br>\nNormally, that does not mean the code needs to be written in a special way.<br>\nUsually Range(\"XX\").value works, but some commands may need to point towards the correct workbook. (you have two workbooks open with add-ins, the add-in with the code and the workbook with the sheets and numbers)</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 285, "user_id": 5116833, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4ce5802b57d6f980e717d03e389a292?s=128&d=identicon&r=PG&f=1", "display_name": "yarz-tech", "link": "https://stackoverflow.com/users/5116833/yarz-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3108, "favorite_count": 0, "accepted_answer_id": 37443936, "answer_count": 1, "score": 0, "last_activity_date": 1464198796, "creation_date": 1464196763, "last_edit_date": 1464198338, "question_id": 37443803, "link": "https://stackoverflow.com/questions/37443803/run-macro-from-desktop-shortcut", "title": "Run Macro from Desktop Shortcut", "body": "<p>I wrote a macro that does some calculations based on a particular type of excel sheet.  Im trying to distribute this to my coworkers but the addition of a macro to a workbook and then running the macro is something foreign to them.  I'd like to have a \"shortcut\" or some VBS program to open a specific workbook (specified by the user), run the macro, and display the results.</p>\n\n<p>Your help is appreciated!</p>\n\n<p>--Edit--\nI wrote a macro in VBA.  I exported the file to my desktop.  Its simply called \"Macro1\".  We have a standard form of excel sheet our company uses.  Its literally the same sheet with different numbers.  The macro I designed works on these kinds of sheets and does calculations.  My coworkers aren't good with macros, so I want some sort of \"code\" that will prompt one of my coworkers for an excel file, then execute the macro on the file.  Hopefully this clarifies any questions.</p>\n"}, {"tags": ["sql", "ms-access", "automation", "vba", "sql-insert"], "comments": [{"owner": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1464196782, "post_id": 37443596, "comment_id": 62389834, "body": "Why do you need these records? When do you want them to be added?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464197206, "post_id": 37443596, "comment_id": 62390067, "body": "Are you using the target table as the source also? Do you plan to run your code more than once?"}, {"owner": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "edited": false, "score": 0, "creation_date": 1464197688, "post_id": 37443596, "comment_id": 62390320, "body": "The target table is also the source. However, the duration value is also tied to the foreign key i.e. it&#39;s also stored and can be pulled from another table if using the target as the source creates extra issues. I plan on calling on the code automatically to append the extra records each time a new record is added to the table."}, {"owner": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "reply_to_user": {"reputation": 709, "user_id": 6269045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBdtv.jpg?s=128&g=1", "display_name": "BitAccesser", "link": "https://stackoverflow.com/users/6269045/bitaccesser"}, "edited": false, "score": 0, "creation_date": 1464198193, "post_id": 37443596, "comment_id": 62390629, "body": "@BitAccesser  I need these records to add data on the weekly level for campaigns, the table has more columns than simply the 4 I mentioned, but those are the only ones that matter for my question."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464198929, "post_id": 37443596, "comment_id": 62391035, "body": "I did some code for another person to do something similar. How mant total records do you ever expect in that table? If millions, you need an approach that doesn&#39;t touch every record when adding one new record. I suggest code that would set the initial table and could be run in the future to validate things are still ok, then code just to add the required records for a new record. How good are your VBA skills?"}, {"owner": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464199470, "post_id": 37443596, "comment_id": 62391370, "body": "@WayneG.Dunn We won&#39;t sniff 7 digits. We&#39;re only talking tens of thousands when all is said and done. My VBA is very weak, but as my username suggests I am trying to learn, and should be capable of adapting exisitng code to fit my exact circumtance"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1464201991, "creation_date": 1464201991, "answer_id": 37445308, "question_id": 37443596, "link": "https://stackoverflow.com/questions/37443596/how-to-insert-a-variable-number-of-records-into-an-access-table-based-on-a-field/37445308#37445308", "title": "How to Insert a Variable Number of Records into an Access Table Based on a Fields Value", "body": "<p>You can modify this function to have lngCount as a fixed value:</p>\n\n<pre><code>Public Sub CopyEmptyRecords()\n\n  Dim rstSource   As DAO.Recordset\n  Dim rstInsert   As DAO.Recordset\n  Dim fld         As DAO.Field\n  Dim strSQL      As String\n  Dim lngLoop     As Long\n  Dim lngCount    As Long\n  Dim booCopy     As Boolean\n\n  strSQL = \"SELECT * FROM tblStats\"\n  Set rstSource = CurrentDb.OpenRecordset(strSQL)\n\n  strSQL = \"SELECT TOP 1 * FROM tblStatsNull\"\n  Set rstInsert = CurrentDb.OpenRecordset(strSQL)\n\n  With rstSource\n    .MoveLast\n    .MoveFirst\n    lngCount = .RecordCount            ' Set to fixed value of 7.\n    For lngLoop = 1 To lngCount\n      With rstInsert\n        booCopy = False\n        .AddNew\n          For Each fld In rstSource.Fields\n            With fld\n              If .Attributes And dbAutoIncrField Then\n                ' Skip Autonumber or GUID field.\n              Else\n                ' Copy field content.\n                rstInsert.Fields(.Name).Value = .Value\n                If Len(Trim(Nz(.Value, vbNullString))) = 0 Then\n                  booCopy = True\n                End If\n              End If\n            End With\n          Next\n        If booCopy = True Then\n          .Update\n        Else\n          .CancelUpdate\n        End If\n      End With\n      .MoveNext\n    Next\n    rstInsert.Close\n    .Close\n  End With\n\n  Set rstInsert = Nothing\n  Set rstSource = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "edited": false, "score": 0, "creation_date": 1464203198, "post_id": 37445387, "comment_id": 62393411, "body": "Thank you! I am going to try to adapt this to my needs over the next couple days. My lack of VBA knowledge might make it a slow process for me, so I may follow up with some questions a bit down the line."}, {"owner": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "edited": false, "score": 0, "creation_date": 1464208279, "post_id": 37445387, "comment_id": 62396106, "body": "In this snippet:  <code>If iAdd &gt; 0 Then  &#39; Add new record  Add_Records lCampaign  iAdd = iAdd - 1</code>  Gets the ByRef Argument Type Mismatch error and highlights &quot;lCampaign&quot;. Any thoughts on what&#39;s going wrong here?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "edited": false, "score": 0, "creation_date": 1464213232, "post_id": 37445387, "comment_id": 62398340, "body": "Assumed the CampaignID was a Long Integer, thus the variable and the argument in the called subroutine will need to change to your datatype. For example, if it&#39;s a string, change &#39;lCampID As Long&#39; to &#39;... String&#39; and change &#39;lCampaignID as Long&#39; to &#39;... String&#39;  (Plus any other datatype changes that are necessary."}, {"owner": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "edited": false, "score": 0, "creation_date": 1464270634, "post_id": 37445387, "comment_id": 62424446, "body": "Thanks again Wayne. I changed the variable type when you declared your variables for the first function, Create_New_Rows, but forgot to do the same for the second, Add_Records. Now that I changed both, it seems to be working!"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": true, "score": 0, "last_activity_date": 1464202316, "creation_date": 1464202316, "answer_id": 37445387, "question_id": 37443596, "link": "https://stackoverflow.com/questions/37443596/how-to-insert-a-variable-number-of-records-into-an-access-table-based-on-a-field/37445387#37445387", "title": "How to Insert a Variable Number of Records into an Access Table Based on a Fields Value", "body": "<p>Here's one way to do it. Note that I planned for a scenario where someone changes the duration -- after adding the records.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nDim dbs     As DAO.Database\nDim rs      As DAO.recordSet\nDim rsOT    As DAO.recordSet\n\nFunction Create_New_Rows()\nDim strSQL          As String\nDim i               As Integer\nDim iAdd            As Integer\nDim iDuration       As Integer\nDim lCampaignID     As Long\n\n\n    On Error GoTo Error_trap\n\n    Set dbs = CurrentDb\n\n    strSQL = \"SELECT Count(Campaign.WeeklyID) AS NbrRecs, First(Campaign.Duration) AS Duration, Campaign.CampaignID \" &amp; _\n                \"FROM Campaign \" &amp; _\n                \"GROUP BY Campaign.CampaignID;\"\n    Set rs = dbs.OpenRecordset(strSQL)\n    Set rsOT = dbs.OpenRecordset(\"Campaign\")\n    If rs.EOF Then\n        MsgBox \"No records found!\", vbOKOnly + vbCritical, \"No Records\"\n        GoTo Exit_Code\n    Else\n        rs.MoveFirst\n    End If\n\n    Do While Not rs.EOF\n        Debug.Print \"Campaign: \" &amp; rs!CampaignID &amp; vbTab &amp; \"Duration: \" &amp; rs!Duration &amp; vbTab &amp; \"# Recs: \" &amp; rs!NbrRecs\n        iDuration = rs!Duration\n        lCampaignID = rs!CampaignID\n\n\n        ' Check if already have correct number of records for this ID\n        If iDuration = rs!NbrRecs Then\n            ' Do nothing... counts are good\n        ElseIf iDuration &lt; rs!NbrRecs Then\n            MsgBox \"Add code to resolve too many records for Campaign: \" &amp; lCampaignID &amp; vbCrLf &amp; _\n                \"Duration: \" &amp; iDuration &amp; vbCrLf &amp; _\n                \"Records: \" &amp; rs!NbrRecs, vbOKOnly + vbCritical, \"Too many records already!\"\n        Else\n            ' Finally, Duration is less than existing records... time to add...\n            iAdd = iDuration - rs!NbrRecs\n            Do\n                If iAdd &gt; 0 Then\n                    ' Add new record\n                    Add_Records lCampaignID\n                    iAdd = iAdd - 1\n                Else\n                    Exit Do\n                End If\n            Loop\n        End If\n        rs.MoveNext\n    Loop\n\nExit_Code:\n    If Not rs Is Nothing Then\n        rs.Close\n        Set rs = Nothing\n    End If\n    If Not rsOT Is Nothing Then\n        rsOT.Close\n        Set rsOT = Nothing\n    End If\n    dbs.Close\n    Set dbs = Nothing\n\n    MsgBox \"Finished\"\n\n    Exit Function\nError_trap:\n    Debug.Print Err.Number &amp; vbTab &amp; Err.Description &amp; vbCrLf &amp; \"In:   Create_New_Rows\"\n    MsgBox Err.Number &amp; vbTab &amp; Err.Description &amp; vbCrLf &amp; \"In: Create_New_Rows\"\n    Resume Exit_Code\n    Resume\nEnd Function\n\nFunction Add_Records(lCampID As Long)\n    With rsOT\n        .AddNew\n        !CampaignID = lCampID\n        ' Add code if you want to populate other fields...\n        .Update\n        'Debug.Print \"Added rec for CampaingID: \" &amp; lCampID\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6362575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de830fbc37307b3211a9e4b29435b7c2?s=128&d=identicon&r=PG&f=1", "display_name": "TryingtoLearn", "link": "https://stackoverflow.com/users/6362575/tryingtolearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 0, "accepted_answer_id": 37445387, "answer_count": 2, "score": 0, "last_activity_date": 1464202316, "creation_date": 1464196072, "question_id": 37443596, "link": "https://stackoverflow.com/questions/37443596/how-to-insert-a-variable-number-of-records-into-an-access-table-based-on-a-field", "title": "How to Insert a Variable Number of Records into an Access Table Based on a Fields Value", "body": "<p>I have an Access Table with the following columns: WeeklyID(PrimaryKey), CampaignID(Foreignkey), WeekEnded(Date Field), Duration(Number Field).</p>\n\n<p>I want to automatically add X number of records to the table, where X is the number stored in the Duration field. I want the added records to have the same CampaignID as the original record. So the automated process would be satisfied when the count of the records with one specific CampaignID was equal to the Duration number.</p>\n\n<p>If anyone could provide assistance on how to accomplish this, it would be much appreciated. If you need any further info, please ask!</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6382320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208026714439071/picture?type=large", "display_name": "Turner Herbek", "link": "https://stackoverflow.com/users/6382320/turner-herbek"}, "edited": false, "score": 0, "creation_date": 1464268692, "post_id": 37443559, "comment_id": 62422856, "body": "Thanks! It worked. I was confusing the use of the &amp; when it is used in C++"}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": false, "score": 0, "last_activity_date": 1464195937, "creation_date": 1464195937, "answer_id": 37443559, "question_id": 37443494, "link": "https://stackoverflow.com/questions/37443494/vba-getting-textbox-to-display-text-and-variable/37443559#37443559", "title": "VBA getting textbox to display text and variable", "body": "<p>Use this</p>\n\n<pre><code>Private Sub OverallScore_Click()\n\nOverallTotalScore = Attendance + DiligenceTotalScore + QualityTotalScore + SafetyTotalScore + TeamworkTotalScore + SkillsTotalScore\n\nSelect Case OverallTotalScore\n    Case 0 To 69\n        OverallScoreTextBox.Text = (OverallTotalScore &amp; \" Rate increase $0.20\")\n    Case 70 To 77\n        OverallScoreTextBox.Text = (OverallTotalScore &amp; \" Rate increase $0.25\")\n    Case 78 To 84\n        OverallScoreTextBox.Text = (OverallTotalScore &amp; \" Rate increase $0.35\")\n    Case 85 To 92\n        OverallScoreTextBox.Text = (OverallTotalScore &amp; \" Rate increase $0.45\")\n    Case 93 To 100\n        OverallScoreTextBox.Text = (OverallTotalScore &amp; \" Rate increase $0.50\")\n    End Select \nEnd sub\n</code></pre>\n\n<p>The <code>&amp;</code> is used to build your string (by concatenating them), so you can just switch what is on either side easily</p>\n"}], "owner": {"reputation": 1, "user_id": 6382320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208026714439071/picture?type=large", "display_name": "Turner Herbek", "link": "https://stackoverflow.com/users/6382320/turner-herbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 389, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1464195937, "creation_date": 1464195738, "question_id": 37443494, "link": "https://stackoverflow.com/questions/37443494/vba-getting-textbox-to-display-text-and-variable", "title": "VBA getting textbox to display text and variable", "body": "<p>I'm using Word 2010 and trying to get a text box to display a variable and then some text following the variable.</p>\n\n<p>I can code it vice versa like:</p>\n\n<pre><code>Private Sub OverallScore_Click()\n\nOverallTotalScore = Attendance + DiligenceTotalScore + QualityTotalScore + SafetyTotalScore + TeamworkTotalScore + SkillsTotalScore\n\nSelect Case OverallTotalScore\n    Case 0 To 69\n        OverallScoreTextBox.Text = (\"Rate increase $0.20 \" &amp; OverallTotalScore)\n    Case 70 To 77\n        OverallScoreTextBox.Text = (\"Rate increase $0.25 \" &amp; OverallTotalScore)\n    Case 78 To 84\n        OverallScoreTextBox.Text = (\"Rate increase $0.35 \" &amp; OverallTotalScore)\n    Case 85 To 92\n        OverallScoreTextBox.Text = (\"Rate increase $0.45 \" &amp; OverallTotalScore)\n    Case 93 To 100\n        OverallScoreTextBox.Text = (\"Rate increase $0.50 \" &amp; OverallTotalScore)\n    End Select \n</code></pre>\n\n<p>However, I want it displayed as score first and then the text</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6377167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86004291288ed89c97efc65c0b57a6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Navratil", "link": "https://stackoverflow.com/users/6377167/ivan-navratil"}, "edited": false, "score": 0, "creation_date": 1464200568, "post_id": 37443264, "comment_id": 62391963, "body": "I am having a problem with this currently, what part of the code should I replace with my own? I have replaced ButtonNext with name how is called in my database. Currently the button is not working at all."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 6377167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86004291288ed89c97efc65c0b57a6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Navratil", "link": "https://stackoverflow.com/users/6377167/ivan-navratil"}, "edited": false, "score": 0, "creation_date": 1464201684, "post_id": 37443264, "comment_id": 62392591, "body": "It probably shouldn&#39;t replace anything, just be inserted in that event. But only you will know ..."}, {"owner": {"reputation": 3, "user_id": 6377167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86004291288ed89c97efc65c0b57a6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Navratil", "link": "https://stackoverflow.com/users/6377167/ivan-navratil"}, "edited": false, "score": 0, "creation_date": 1464201891, "post_id": 37443264, "comment_id": 62392716, "body": "It&#39;s working now, but it&#39;s just avoiding last message, I am still getting empty record( as shown on 2nd picture)"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 6377167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86004291288ed89c97efc65c0b57a6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Navratil", "link": "https://stackoverflow.com/users/6377167/ivan-navratil"}, "edited": false, "score": 0, "creation_date": 1464249391, "post_id": 37443264, "comment_id": 62409866, "body": "That must be caused by something else than clicking the button."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1464194993, "creation_date": 1464194993, "answer_id": 37443264, "question_id": 37442863, "link": "https://stackoverflow.com/questions/37442863/how-to-give-a-warning-message-before-going-to-empty-record/37443264#37443264", "title": "How to give a warning message before going to empty record?", "body": "<p>It's easier to disable the button when the user reaches the new record:</p>\n\n<pre><code>Private Sub Form_Current\n\n    Me!ButtonNext.Enabled = Not Me.NewRecord\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6377167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86004291288ed89c97efc65c0b57a6dc?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Navratil", "link": "https://stackoverflow.com/users/6377167/ivan-navratil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464198225, "creation_date": 1464193520, "last_edit_date": 1464198225, "question_id": 37442863, "link": "https://stackoverflow.com/questions/37442863/how-to-give-a-warning-message-before-going-to-empty-record", "title": "How to give a warning message before going to empty record?", "body": "<p>When I am navigating through records in my form I want to be informed when I click on next button that there are no more records (if there are no more records, ofc). By default in access, I am first shown a blank record and when I click again warning message.</p>\n\n<p>Going through the record:</p>\n\n<p><img src=\"https://i.imgur.com/HuOcPof.jpg\" alt=\"http://imgur.com/a/IaS4J\"></p>\n\n<p>Going into an empty record:</p>\n\n<p><img src=\"https://i.imgur.com/Hv7gb62.jpg\" alt=\"\"></p>\n\n<p>Getting a warning message when clicking on next for the second time:</p>\n\n<p><img src=\"https://i.imgur.com/YLC0OS2.jpg\" alt=\"\"></p>\n"}, {"tags": ["vba", "excel", "reference"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1464193775, "post_id": 37442728, "comment_id": 62388167, "body": "Look at <a href=\"http://www.cpearson.com/excel/missingreferences.aspx\" rel=\"nofollow noreferrer\">this page</a>, does that help narrow your issue down (or even solve it)?"}, {"owner": {"reputation": 11, "user_id": 4851603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tdy3iGucojY/AAAAAAAAAAI/AAAAAAAAAPo/daKrw80dysc/photo.jpg?sz=128", "display_name": "Hung Trinh", "link": "https://stackoverflow.com/users/4851603/hung-trinh"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464226497, "post_id": 37442728, "comment_id": 62401923, "body": "Thanks for your comment. I have passed through that page, however that is not my problem. I am not missing of reference but it not keep been selected after I close excel."}], "owner": {"reputation": 11, "user_id": 4851603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Tdy3iGucojY/AAAAAAAAAAI/AAAAAAAAAPo/daKrw80dysc/photo.jpg?sz=128", "display_name": "Hung Trinh", "link": "https://stackoverflow.com/users/4851603/hung-trinh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464226516, "creation_date": 1464193138, "last_edit_date": 1464226516, "question_id": 37442728, "link": "https://stackoverflow.com/questions/37442728/vba-reference-lost-selected-after-close-application", "title": "VBA Reference lost Selected after close Application", "body": "<p>I create Vbaproject that need to select more reference beside default reference of Excel VBA.</p>\n\n<p>Everything work fine. However, when I save and close workbook. All Reference it reset to default choice, cause my code to error of missing reference.</p>\n\n<p>I use office 365. Anyone have face with this problem? I google but still no help with this issue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464193024, "post_id": 37442660, "comment_id": 62387725, "body": "<code>My face eagerly awaits my palm.</code> +1 Edit: which line throws error?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464193195, "post_id": 37442660, "comment_id": 62387826, "body": "@findwindow probably the one with the comment saying <code>&#39;****This is the line that throws the error.****</code> ;) ."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1464193309, "post_id": 37442660, "comment_id": 62387889, "body": "@VincentG thanks but one, too lazy to read through it (OP should always identify it in question). Two, didn&#39;t see it because it&#39;s past the scroll (see point one ^_^)."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1464193322, "post_id": 37442660, "comment_id": 62387902, "body": "You don&#39;t test the result of the return of your <code>srange.Find()</code>. If it fails to find anything trange will be Nothing and trange.Value will fail."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1464193501, "post_id": 37442660, "comment_id": 62388006, "body": "@VincentG where&#39;s <code>srange.Find()</code>? <code>Set srange = .Range(...</code>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1464193615, "post_id": 37442660, "comment_id": 62388062, "body": "@VincentG oh, you mean <code>.Cells(6, trange.Value).Value</code>. Yea, OP, you tested that on same line as <code>If Not trange.Value Is Nothing</code>."}, {"owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1464193730, "post_id": 37442660, "comment_id": 62388131, "body": "I&#39;ll make the edit to the OP now. Edit: misunderstood. I&#39;ve split the line into two IF&#39;s, and it still seems to be throwing the error."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464194158, "post_id": 37442660, "comment_id": 62388394, "body": "@findwindow two lines above the line that give error."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464194417, "post_id": 37442660, "comment_id": 62388545, "body": "Yea, what Jason said below. Remove the <code>.value</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 4, "last_activity_date": 1464194777, "last_edit_date": 1464194777, "creation_date": 1464193623, "answer_id": 37442898, "question_id": 37442660, "link": "https://stackoverflow.com/questions/37442660/excel-vba-object-required/37442898#37442898", "title": "Excel VBA - Object Required", "body": "<p>Another change. </p>\n\n<pre><code>If Not trange.Value Is Nothing Then\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>If Not trange Is Nothing Then\n</code></pre>\n\n<p>Rewrite your IF into two IFs:</p>\n\n<pre><code> If Not trange.Value Is Nothing Then\n        If .Cells(6, trange.Value).Value = \"BOL\" Then \n          'set first address\n          Set fr = .Range(trange.Address)\n          Do\n            'result counter\n             c = c + 1\n            'save each address within cache range\n            For Each i In addr\n                If i.Value = \"\" Then i.Value = trange.Address\n            Next i\n            Set trange = trange.FindNext(trange)\n         Loop While trange.Address &lt;&gt; fr.Address\n       End IF\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1464194506, "post_id": 37443049, "comment_id": 62388596, "body": "I&#39;ve been testing with mock data, so I know that trange is populated. However, I removed the .value and it seems to work so go figure."}, {"owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1464194785, "post_id": 37443049, "comment_id": 62388752, "body": "Yep, there&#39;s a definitely handprint on my face. I removed the .value from the first IF and when I looked at the 2nd IF, I realized I had used &quot;trange.value&quot; instead of &quot;trange.column&quot; to check the header above. Problem fixed. Thanks!"}], "tags": [], "owner": {"reputation": 1024, "user_id": 6040823, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/DDCAB.jpg?s=128&g=1", "display_name": "Jason Brady", "link": "https://stackoverflow.com/users/6040823/jason-brady"}, "is_accepted": true, "score": 3, "last_activity_date": 1464194190, "creation_date": 1464194190, "answer_id": 37443049, "question_id": 37442660, "link": "https://stackoverflow.com/questions/37442660/excel-vba-object-required/37443049#37443049", "title": "Excel VBA - Object Required", "body": "<p>I think it's your .value at the end of trange. When you do a find and nothing is found then the trange comes back as nothing. Then you are asking for the value of nothing, which is giving you the object required error.</p>\n\n<p>Just change it to <code>If Not trange Is Nothing...</code> but I think @Abe Gold is right, you'll need two if statements. Because you can't check '.cells(6, trange.value).value = \"BOM\"` if trange is nothing.</p>\n\n<p>Should look like this for your if statement (Taken from @Abe Gold code above)</p>\n\n<pre><code>If Not trange Is Nothing Then\n    If .Cells(6, trange.Value).Value = \"BOL\" Then \n      'set first address\n      Set fr = .Range(trange.Address)\n      Do\n        'result counter\n         c = c + 1\n        'save each address within cache range\n        For Each i In addr\n            If i.Value = \"\" Then i.Value = trange.Address\n        Next i\n        Set trange = trange.FindNext(trange)\n     Loop While trange.Address &lt;&gt; fr.Address\n   End IF\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1464267676, "post_id": 37444195, "comment_id": 62422094, "body": "I did not know that UI find settings affected the find method, but it definitely makes sense. Thanks!  I cleaned up the code a bit more after we solved the issue and caught the redundancy and the findnext mistake. :)  As for the SpecialCells, the purpose of the for loop is to find an empty cell within addr range to cache the address. Correct me if I&#39;m wrong, but shouldn&#39;t xlCellTypeConstants be xlCelltypeBlanks? And I think specialcells select ALL cells meeting the type criteria within range, whereas I&#39;m looking for a single cell to fill."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1464269833, "post_id": 37444195, "comment_id": 62423787, "body": "thank you for feedback. 1) yes, to select empty cells use <code>xlCellTypeBlanks</code> parameter instead of <code>xlCellTypeConstants</code> for <code>SpecialCells</code> method 2) <code>SpecialCells</code> method returns ALL (blank, if with <code>xlCellTypeBlanks</code> parameter) cells of the <code>range</code> he&#39;s called onto, so <code>addr.SpecialCells(xlCellTypeBlanks) = trange.Address</code> would fill ALL blank cells of <code>addr</code> <code>range</code> with <code>trange.Address</code>. which is precisely what your <code>For Each i In addr</code> loop did.  3) How could previous solutions work with that <code>Set trange = trange FindNext(trange)</code> statement (and with the <code>Find()</code> saved parameters issue)?"}, {"owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1464271247, "post_id": 37444195, "comment_id": 62424943, "body": "This is my mistake. I missed an <code>Exit For</code> in the original version of the loop. A careless oversight. I fixed that at some point early on after posting, as I saw that the cache was being filled with the first address. I caught and fixed the <code>FindNext</code> issue as soon as I stepped through the code and passed the IF statements error free. The saved parameters didn&#39;t affect my search tool as I hadn&#39;t performed a search with different parameters while troubleshooting. Definitely a good tip going forward though. I&#39;ll add the current version of the code in a separate response."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "edited": false, "score": 0, "creation_date": 1464274313, "post_id": 37444195, "comment_id": 62427462, "body": "well, from your last post you also found out you needed the <code>If .Cells(6, trange.Column).Value = &quot;BOL&quot; Then</code> check inside the <code>Do-Loop</code> rather then outside it...."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1464198056, "creation_date": 1464198056, "answer_id": 37444195, "question_id": 37442660, "link": "https://stackoverflow.com/questions/37442660/excel-vba-object-required/37444195#37444195", "title": "Excel VBA - Object Required", "body": "<p>I know there is both an accepted answer and two most upvoted ones, but I'm both proposing improvements and mainly <strong>missing something</strong> (see last point)</p>\n\n<p>please consider this code:</p>\n\n<pre><code>'Find search results in search range\nSet trange = srange.Find(BOL.Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False) '&lt;~~always specify those parameters since they are saved from any Find() usage, even that from UI\nIf Not trange Is Nothing Then 'If the cell is not empty and the header in row 6 has a value of \"BOL\"\n    If .Cells(6, trange.Column).Value = \"BOL\" Then\n        Set fr = trange '&lt;~~store first trange occurrence found\n        Do\n            c = c + 1 'update result counter\n            addr.SpecialCells(xlCellTypeConstants) = trange.Address '&lt;~~save current address within cache range\n            Set trange = srange.FindNext(trange) '&lt;~~search next occurrence of trange in srange\n        Loop While Not trange.Address &lt;&gt; fr.Address\n    End If\nEnd If\n</code></pre>\n\n<p>whose differences from the OP's one are hereby summarized:</p>\n\n<ul>\n<li><p><code>Set trange = srange.Find(BOL.Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)</code></p>\n\n<p>always specify those parameters since they are saved from any <code>Find()</code> usage, even that from UI, so that yo may find yourself involuntarily looking at string Part and/or minding Case Matching</p></li>\n<li><p><code>If Not trange Is Nothing Then</code></p>\n\n<p>ok, that has already been established by all answers and comments</p></li>\n<li><p><code>Set fr = trange</code></p>\n\n<p>since <code>.Range(trange.Address)</code> is redundant</p></li>\n<li><p><code>addr.SpecialCells(xlCellTypeConstants) = trange.Address</code></p>\n\n<p>instead of the <code>For Each i In addr</code> loop</p></li>\n<li><p><code>Set trange = srange.FindNext(trange)</code></p>\n\n<p><strong>here there was <code>Set trange = trange FindNext(trange)</code></strong></p>\n\n<p>shouldn't the second <code>trange</code> be <code>srange</code>? </p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464274928, "post_id": 37463126, "comment_id": 62427919, "body": "you can omit the <code>...Not trange Is Nothing ...</code> part in the <code>Loop While</code> ending condition since 1) the <code>Loop</code> begins only after <code>If Not trange Is Nothing</code> check passing 2) at every iteration <code>trange</code> is set to <code>srange.FindNext(trange)</code> which can <i>never</i> be Nothing since <code>FindNext</code> would always find a <code>BOL.Value</code> occurrence in <code>srange</code> range, caught in a circular loop inside it. from which the necessary check on the &quot;first address&quot; to end the loop"}, {"owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464290389, "post_id": 37463126, "comment_id": 62437243, "body": "Yep, I just left it in there cause I figured it wasn&#39;t hurting anyone, but for the sake of transparency, I&#39;ll remove it."}], "tags": [], "owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "is_accepted": false, "score": 0, "last_activity_date": 1464271719, "last_edit_date": 1464271719, "creation_date": 1464271369, "answer_id": 37463126, "question_id": 37442660, "link": "https://stackoverflow.com/questions/37442660/excel-vba-object-required/37463126#37463126", "title": "Excel VBA - Object Required", "body": "<p>This <code>If</code> statement was only being applied to the first found address. I moved it into the loop to be applied to every iterative result.</p>\n\n<pre><code>If .Cells(6, trange.Column).Value = \"BOL\" Then\n</code></pre>\n\n<p>Added a number of other changes/fixes outlined in above responses. Thanks!</p>\n\n<p>Current working code snip:</p>\n\n<pre><code>'Find search results in search range\nSet trange = srange.Find(BOL.Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)\n'If the cell is not empy and the header in row 6 has a value of \"BOL\"\nIf Not trange Is Nothing Then\n    'set first address\n    Set fr = trange\n    Do\n        If .Cells(6, trange.Column).Value = \"BOL\" Then\n        'result counter\n        c = c + 1\n        'save each address within cache range\n        For Each i In addr\n            If i.Value = \"\" Then\n                i.Value = trange.Address\n                Exit For\n            End If\n        Next i\n        End If\n    Set trange = srange.FindNext(trange)\n    Loop While Not trange Is Nothing And trange.Address &lt;&gt; fr.Address\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 4876372, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e046b2f2b7c23bcab1c2cb4b342650ed?s=128&d=identicon&r=PG&f=1", "display_name": "ssoong", "link": "https://stackoverflow.com/users/4876372/ssoong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2950, "favorite_count": 0, "accepted_answer_id": 37443049, "answer_count": 4, "score": 3, "last_activity_date": 1464290600, "creation_date": 1464192964, "last_edit_date": 1464290600, "question_id": 37442660, "link": "https://stackoverflow.com/questions/37442660/excel-vba-object-required", "title": "Excel VBA - Object Required", "body": "<p>I haven't had to use Excel VBA in awhile, but I decided to dig it up to build a few user-friendly and accessible templates for tracking monthly shipments.</p>\n\n<p>This specific search function is giving me a headache and I suspect it's because I'm quite rusty with the syntax.</p>\n\n<p>I've got myself to this point where I'm receiving an 'object required' error when calling a user form but from what I can see from stepping through, I've explicitly declared and defined everything related to the problem line.</p>\n\n<p>Appreciate any help/refreshers. My face eagerly awaits my palm.</p>\n\n<p>Edit: Current working code posted in response below</p>\n\n<p>Full code</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n'Clear result message\nMe.rResult.caption = \"\"\n\n'BOL (cached)\nDim BOL As Range\nSet BOL = ThisWorkbook.Sheets(\"Values\").Range(\"$A$3\")\n'Addresses (cached)\nDim addr As Range\nSet addr = ThisWorkbook.Sheets(\"Values\").Range(\"$A$4:$D$21\")\nDim i As Range\n'Search Range\nDim srange As Range\n'Target Range\nDim trange As Range\n'First result\nDim fr As Range\n'Result counter\nDim c As Integer\nc = 0\n\nWith ThisWorkbook.ActiveSheet\n    'Set search range\n    Set srange = .Range(.Cells(7, 6), _\n    .Cells(.Cells(Rows.Count, 5).End(xlUp).Row, _\n    .Cells(6, Columns.Count).End(xlToLeft).Column))\n\n    'Find search results in search range\n    Set trange = srange.Find(BOL.Value, LookIn:=xlValues)\n    'If the cell is not empty and the header in row 6 has a value of \"BOL\"\n    If Not trange.Value Is Nothing Then '***Problem Line***\n        If .Cells(6, trange.Value).Value = \"BOL\" Then\n        'set first address\n        Set fr = .Range(trange.Address)\n        Do\n            'result counter\n            c = c + 1\n            'save each address within cache range\n            For Each i In addr\n                If i.Value = \"\" Then i.Value = trange.Address\n            Next i\n            Set trange = trange.FindNext(trange)\n        Loop While Not trange Is Nothing And trange.Address &lt;&gt; fr.Address\n        End If\n    End If\nEnd With\n\n'Select the first address\nIf c &lt;&gt; 0 Then fr.Select\n\n'Result message\nMe.rResult.caption = \"Search found \" &amp; c &amp; _\n    \" result(s) for BOL: \" &amp; BOL.Value &amp; \".\"\n\n'clear cached BOL\nBOL.Clear\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464192683, "post_id": 37442447, "comment_id": 62387498, "body": "<code>Dim Fix_Version As Range</code> then you do <code>Cells(LastRow, Fix_Version)</code> but <code>cells</code> require a number not range. I presume the function works properly? Edit: you have 2 options, change function to return col number or set your variables to long and do <code>FindCol(&quot;Key&quot;).column</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464193008, "post_id": 37442447, "comment_id": 62387710, "body": "For <code>FindCol</code>, do you not need this instead? <code>Set FindCol = Rtn.Column</code>?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464193084, "post_id": 37442447, "comment_id": 62387761, "body": "Batman, it returns a range. Edit: but yes, makes more sense to return the col number^^"}, {"owner": {"reputation": 15, "user_id": 6222732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137f3cd32ed4a4e62b109bf5c82d7a2b?s=128&d=identicon&r=PG&f=1", "display_name": "kirby3021", "link": "https://stackoverflow.com/users/6222732/kirby3021"}, "edited": false, "score": 0, "creation_date": 1464193354, "post_id": 37442447, "comment_id": 62387927, "body": "I kept forgetting .column, as soon as I figured that out the rest was easy. Rookie mistake, sorry!"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464193171, "post_id": 37442670, "comment_id": 62387815, "body": "Oh snap. Smarter than my idea^^"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464194008, "post_id": 37442670, "comment_id": 62388321, "body": "@findwindow thanks since that is quite hard to ever happen"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464194311, "post_id": 37442670, "comment_id": 62388483, "body": "Wait what :o Pretty sure you mean the other way around^^"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464195174, "post_id": 37442670, "comment_id": 62388960, "body": "@findwindow not at all, I confirm what I wrote :-)"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464195292, "post_id": 37442670, "comment_id": 62389018, "body": "Dat flattery. Well, I already upvoted so have... an imaginary cookie XD"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1464193173, "last_edit_date": 1464193173, "creation_date": 1464193003, "answer_id": 37442670, "question_id": 37442447, "link": "https://stackoverflow.com/questions/37442447/excel-vba-copy-and-paste-selection-based-off-row-and-column-headers/37442670#37442670", "title": "Excel VBA: Copy and paste selection based off row and column headers", "body": "<pre><code>Sub Move_Severity()\nDim Severity As Range\nDim Key As Range\nDim Fix_Version As Range\nDim LastRow As Long\n\nSet Severity = FindCol(\"Severity\")\nSet Key = FindCol(\"Key\")\nSet Fix_Version = FindCol(\"Fix Version/s\")\n\nWith ActiveSheet '&lt;~~ change active sheet reference to whatever must it be \n    .Range(.Cells(2, Key.Column), .Cells(.Rows.Count, Severity.Column).End(xlUp)).Copy Destination:=Sheets(\"Priority Issues\").Range(\"A2\")\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>should you only need to paste values then change that <code>With-End With</code> part to</p>\n\n<pre><code>With ActiveSheet\n    With .Range(.Cells(2, Key.Column), .Cells(.Rows.Count, Severity.Column).End(xlUp))\n        Sheets(\"Priority Issues\").Range(\"A2\").Resize(.Rows.Count, .Columns.Count).Value = .Value\n    End With\nEnd With\n</code></pre>\n\n<p>which is much faster</p>\n"}], "owner": {"reputation": 15, "user_id": 6222732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137f3cd32ed4a4e62b109bf5c82d7a2b?s=128&d=identicon&r=PG&f=1", "display_name": "kirby3021", "link": "https://stackoverflow.com/users/6222732/kirby3021"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1146, "favorite_count": 0, "accepted_answer_id": 37442670, "answer_count": 1, "score": 1, "last_activity_date": 1464193173, "creation_date": 1464192368, "question_id": 37442447, "link": "https://stackoverflow.com/questions/37442447/excel-vba-copy-and-paste-selection-based-off-row-and-column-headers", "title": "Excel VBA: Copy and paste selection based off row and column headers", "body": "<p>I am trying to create a macro that will format and create a weekly report.\nIt has five columns that need to be moved: Key, Summary, Created, Status, Fix Version/s.</p>\n\n<p>I need to copy a selection that starts at Row 2 in the Key column and ends at the last row in the Fix Version/s column that will then be pasted into a sheet called \"Priority Issues\". I am unsure how to code this specific selection. </p>\n\n<p>I need to store the last row in a variable, as the last row may change from week to week. In essence, I am looking for code that allows me to make a selection from the intersection of row 2 and the Key column to the intersection of the last row and the Fix Version/s column, but am unsure how to do that.</p>\n\n<pre><code>Function FindCol(toFind As String) As Range\nDim Rtn As Range\nSet Rtn = Rows(1).Find(What:=toFind, LookIn:=xlValues, _\n          LookAt:=xlWhole, MatchCase:=True)\nSet FindCol = Rtn\nEnd Function\n\nSub Move_Severity()\nDim Severity As Range\nDim Key As Range\nDim Fix_Version As Range\nDim LastRow As Long\n\nSet Severity = FindCol(\"Severity\")\nSet Key = FindCol(\"Key\")\nSet Fix_Version = FindCol(\"Fix Version/s\")\nLastRow = Cells(Rows.Count, Severity.Column).End(xlUp).Row\n\n'This is where I am running into problems\nRange(Cells(2, Key), Cells(LastRow, Fix_Version)).Copy\nSheets(\"Priority Issues\").Range(\"A2\").Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vb6", "dcount"], "comments": [{"owner": {"reputation": 846, "user_id": 6018839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S0fZ1.jpg?s=128&g=1", "display_name": "OldBoyCoder", "link": "https://stackoverflow.com/users/6018839/oldboycoder"}, "edited": false, "score": 1, "creation_date": 1464192146, "post_id": 37442066, "comment_id": 62387168, "body": "Might be worth adding some brackets? strA = DCount (&quot;ClientID&quot;, &quot;tempClientInfoA&quot;, &quot;Dept = &#39;&quot; &amp; strDept &amp; &quot;&#39; and (status = &#39;1&#39; or status = &#39;2&#39;)&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 846, "user_id": 6018839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S0fZ1.jpg?s=128&g=1", "display_name": "OldBoyCoder", "link": "https://stackoverflow.com/users/6018839/oldboycoder"}, "is_accepted": true, "score": 1, "last_activity_date": 1464195201, "creation_date": 1464195201, "answer_id": 37443329, "question_id": 37442066, "link": "https://stackoverflow.com/questions/37442066/dcount-function-assistance-with-criteria/37443329#37443329", "title": "Dcount function --- assistance with criteria", "body": "<p>Issue is to do with the order the AND and OR are evaluated. This was accepted by the OP as working:</p>\n\n<pre><code>strA = DCount (\"ClientID\", \"tempClientInfoA\", \"Dept = '\" &amp; strDept &amp; \"' and (status = '1' or status = '2')\")\n</code></pre>\n"}], "owner": {"reputation": 222, "user_id": 5932559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2b032614454ca145d8715856daba434a?s=128&d=identicon&r=PG&f=1", "display_name": "FatBoySlim7", "link": "https://stackoverflow.com/users/5932559/fatboyslim7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 37443329, "answer_count": 1, "score": 0, "last_activity_date": 1464195201, "creation_date": 1464191298, "question_id": 37442066, "link": "https://stackoverflow.com/questions/37442066/dcount-function-assistance-with-criteria", "title": "Dcount function --- assistance with criteria", "body": "<p>I'm working on building a report and am trying to get the right count of records using the DCOUNT function. I'm in a pickle trying to adjust the CRITERIA part of it, so that it would pull the necessary records. Basically what I'm doing is taking a COUNT of records with the following criteria...</p>\n\n<pre><code>strA = DCount(\"ClienID\", \"tempClientInfoA\", \"Dept = '\" &amp; strDept &amp; \"' and Status = '1'\")\n</code></pre>\n\n<p>This is currently what I have. I'm taking a count of employees depending on department and STATUS (part time or fullTime). Status 1 is fulltime, but now I need to take into account Part Time which is Status 2. So I'm playing around with the function, but it doesn't seem count the right number of records. this is what I tried with</p>\n\n<pre><code>strA = DCount (\"ClientID\", \"tempClientInfoA\", \"Dept = '\" &amp; strDept &amp; \"' and status = '1' or status = '2''\") \n</code></pre>\n\n<p>this gives me some whacky numbers. How would i go about including the criteria so that it would pull both 1's and 2's?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1464190421, "post_id": 37441702, "comment_id": 62385858, "body": "Use <code>left</code>. <code>If Not left(CStr(Cells(r, cC),3) = &quot;722&quot;</code>"}, {"owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464190741, "post_id": 37441702, "comment_id": 62386087, "body": "the * way is more versatile and is helpful for future learning"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1464190822, "post_id": 37441702, "comment_id": 62386144, "body": "Versatility is not always good,  wildcards are much heavier to compute than <code>Left</code> If you don&#39;t need a Lamborgini then don&#39;t use it."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464190824, "post_id": 37441702, "comment_id": 62386146, "body": "Your requirement states <code>does not begin</code> so <code>left</code> is the right tool. Part of learning is to know which tool to use ~_^ If wildcards is needed, perhaps consider <code>instr</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464191349, "post_id": 37441702, "comment_id": 62386592, "body": "following @findwindow suggestion and your <i>versatility</i> need you may want to use <code>If Not (Left(CStr(Cells(r, cC)),3) = &quot;722&quot; and Len(Cells(r, cC))&gt;3)</code>. but really wouldn&#39;t say why..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464191448, "post_id": 37441702, "comment_id": 62386672, "body": "I think @litelite took a lambo to work today^^"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1464191585, "post_id": 37441702, "comment_id": 62386784, "body": "@user3598756 a string that is only &quot;722&quot; does begin with &quot;722&quot; your solution ignores that"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464191854, "post_id": 37441702, "comment_id": 62386974, "body": "@litelite I assumed that &quot;*&quot; would stand for <i>&quot;there is to be something more&quot;</i>.. Should it stand for <i>&quot;may be there is something more&quot;</i> then just change 3 with 2. but then it&#39;d loose any meaning..."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464191996, "post_id": 37441702, "comment_id": 62387077, "body": "@user3598756 yes it is <i>may</i> as in might not be there. And you still don&#39;t need the <code>&gt;2</code> because the <code>=722</code> will do it (if it&#39;s smaller than two how vould it ever be equal to 722)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464192233, "post_id": 37441702, "comment_id": 62387211, "body": "@litelite that&#39;s precisely what I meant with <i>&quot;but then it&#39;d loose any meaning...&quot;</i> so that either be done with <code>Left</code> only or with <code>Left</code> <i>and</i> <code>Len(..)&gt;3</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 2, "creation_date": 1464191156, "post_id": 37441978, "comment_id": 62386423, "body": "I just want to point out that the <code>like</code> operator will be much heavier to compute than a simple <code>=</code> and a <code>left</code>."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464191548, "post_id": 37441978, "comment_id": 62386748, "body": "@litelite yup, added it."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1464201218, "post_id": 37441978, "comment_id": 62392324, "body": "@litelite, where did you get the idea that the <code>like</code> operator is much heavier to compute than a left? Do you have some facts to support that?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1464253755, "post_id": 37441978, "comment_id": 62412682, "body": "@FlorentB. I originally didn&#39;t include it in my post because I never did the research but believed the others that posted here. I would think that Left is probably the most efficient because copying the first n characters of a string should be pretty quick. The question is if Like has overhead because it prepares for a more complex task?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1464254987, "post_id": 37441978, "comment_id": 62413542, "body": "@FlorentB. I just tried it and the Like method was 4 times as fast as Left. Maybe allocating new a string and then comparing it vs just comparing it makes the difference?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1464263041, "post_id": 37441978, "comment_id": 62418856, "body": "@arcadeprecinct, like you mentioned, the difference is so low, that recommending one solution over another for performance reason would be ridiculous. My guess is that the low complexity of the pattern beats the memory allocation/management for the new string."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 3, "last_activity_date": 1464257444, "last_edit_date": 1464257444, "creation_date": 1464191069, "answer_id": 37441978, "question_id": 37441702, "link": "https://stackoverflow.com/questions/37441702/excel-vba-logical-operator-not-wildcard/37441978#37441978", "title": "Excel VBA Logical operator Not wildcard*", "body": "<p>The easiest way would be to use <code>Left</code></p>\n\n<pre><code>If Not Left(CStr(Cells(r, cC),3) = \"722\"\n</code></pre>\n\n<p>If you want to use wildcards, use <code>Like</code>:</p>\n\n<pre><code>If Not Cells(r, cC)) Like \"722*\" Then\n</code></pre>\n\n<p>Comparing them with <code>=</code> treats <code>*</code> simply as a character.</p>\n\n<p>Edit2: apparently I was wrong about the computational effort of Like. Like seems to be the faster method (in this case), especially if there is no match (lazy evaluation I guess). Obviously the total cpu and memory usage is so small in both cases that it's up to your preference which one to choose.</p>\n\n<p>This is what I found:\n<code>s Like \"722*\"</code> is faster than <code>Left(s,3) = \"722\"</code></p>\n\n<p><code>s Like \"*722\"</code> is slower than <code>Right(s,3) = \"722\"</code></p>\n\n<p><code>s Like \"*722*\"</code> is slower than <code>Instr(1,s,\"722\")&gt;0</code></p>\n\n<p>The magnitude of the difference varies depending on string length and if there is a match or not (e.g. <code>s Like \"722*\"</code> is very fast if <code>s</code> doesn't start with <code>7</code> and <code>Left</code> and <code>Right</code> don't suffer as much as <code>Like</code> if you replace \"722\" with something longer)</p>\n"}], "owner": {"reputation": 1256, "user_id": 3128069, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4cdd27382d73700ac43edb0becdc1a7b?s=128&d=identicon&r=PG&f=1", "display_name": "phillipsK", "link": "https://stackoverflow.com/users/3128069/phillipsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464257444, "creation_date": 1464190354, "last_edit_date": 1464191131, "question_id": 37441702, "link": "https://stackoverflow.com/questions/37441702/excel-vba-logical-operator-not-wildcard", "title": "Excel VBA Logical operator Not wildcard*", "body": "<p>I'm struggling with the Excel Operators I have spent quite some time searching I feel as if I am close I'm trying to code this If statement if the value does not begin with 722* and does not equal PI then execute code immediately below else execute code under the else statement.</p>\n\n<pre><code>If Not CStr(Cells(r, cC)) = \"722*\" And Not CStr(Cells(r, cS)) = \"PI\" Then\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 1, "last_activity_date": 1464190684, "creation_date": 1464190684, "answer_id": 37441830, "question_id": 37441600, "link": "https://stackoverflow.com/questions/37441600/use-variable-to-select-records-in-a-recordset/37441830#37441830", "title": "Use variable to SELECT records in a recordset", "body": "<p>Enclose the criteria in quotes if it's a string. i.e.</p>\n\n<pre><code>strSQL = \"SELECT * FROM tblMember_Contact where id_members = '\" &amp; zBEN &amp; \"' ORDER BY id_members\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1464191090, "creation_date": 1464191090, "answer_id": 37441986, "question_id": 37441600, "link": "https://stackoverflow.com/questions/37441600/use-variable-to-select-records-in-a-recordset/37441986#37441986", "title": "Use variable to SELECT records in a recordset", "body": "<p>You can concatenate the variable's value instead of its name into the SQL statement text as Wayne already suggested:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>strSQL = \"SELECT * FROM tblMember_Contact where id_members = '\" &amp; zBEN &amp; \"' ORDER BY id_members\"\n</code></pre>\n\n<p>But if you switch to a parameter query approach, you needn't bother about the quotes:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>strSQL = \"SELECT * FROM tblMember_Contact where id_members = [which_id] ORDER BY id_members\"\nDim qdf As DAO.QueryDef\nSet qdf = dbsContacts.CreateQueryDef(vbNullString, strSQL )\nqdf.Parameters(\"which_id\").Value = Me!cbxMembersList.Value\nSet rcdContacts = qdf.OpenRecordset()\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6381957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b5f0a74920e1fbae7c0013f1f6cb9a7?s=128&d=identicon&r=PG&f=1", "display_name": "Karicula", "link": "https://stackoverflow.com/users/6381957/karicula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464191202, "creation_date": 1464190124, "last_edit_date": 1464191202, "question_id": 37441600, "link": "https://stackoverflow.com/questions/37441600/use-variable-to-select-records-in-a-recordset", "title": "Use variable to SELECT records in a recordset", "body": "<p>I am trying to select records from an Access table using a String variable from the result of a ComboBox selection.  I have confirmed the variable (zBEN) contains the correct data when selected.  If I manually enter the data in the <code>WHERE</code> part of the statement it works perfectly.  If I use zBEN it crashes - I get an error if I don't use the single quotes and I get an empty record set if I use the quotes.  The error is 3061, Too few parameters. Expected 1.  This error is usually a data type mismatch or incorrect field name.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdDisplayMembers_Click()\n'this displays a record in the dataset - from button click\nDim dbsContacts As DAO.Database\nDim rcdContacts As DAO.Recordset\nDim conArray As Variant              'this is the record array\nDim intArraySize As Integer         'array size\nDim iCtr As Integer                 'counter\nDim zBEN As Variant\nDim zName, strSQL  As String\nzBEN = Me.cbxMembersList\n\nSet dbsContacts = CurrentDb\n'this statement works: (and has the combobox value manually entered\nstrSQL = \"SELECT * FROM tblMember_Contact where id_members = '201208FEAR' ORDER BY id_members\"\n'this statement gives an error 3061, 1:\n'strSQL = \"SELECT * FROM tblMember_Contact where id_members = zBEN ORDER BY id_members\"\n'this statement gives an empty record set\n'strSQL = \"SELECT * FROM tblMember_Contact where id_members = 'zBEN' ORDER BY id_members\"\n\nSet rcdContacts = dbsContacts.OpenRecordset(strSQL)\nIf Not rcdContacts.EOF Then\n    rcdContacts.MoveFirst              'start the counter at Row #1\n    intArraySize = rcdContacts.RecordCount\n    iCtr = 1\n    ReDim conArray(10)\n\n    Do Until rcdContacts.EOF\n        conArray(iCtr) = rcdContacts.Fields(\"member_info\")\n        Debug.Print \"Item: \"; iCtr &amp; \" \" &amp; conArray(iCtr)\n\n        iCtr = iCtr + 1\n        rcdContacts.MoveNext\n    Loop\nMsgBox (\"Error no records\")\nEnd If\n\nIf IsObject(rcdContacts) Then Set rcdContacts = Nothing\ntxtCon1 = conArray(1)\ntxtCon2 = conArray(2)\nMsgBox (zBEN)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464190157, "post_id": 37441586, "comment_id": 62385677, "body": "<code>not tied to a textbox</code> then conditional formatting for a cell?"}, {"owner": {"reputation": 55, "user_id": 6381888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce38f8f91d9a87f5132b80291437d14?s=128&d=identicon&r=PG&f=1", "display_name": "drylkuch", "link": "https://stackoverflow.com/users/6381888/drylkuch"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464190357, "post_id": 37441586, "comment_id": 62385823, "body": "That would be infinitely easier. Unfortunately a cell is one of the few things that I can&#39;t use. It needs to be some kind of excel object (ie. textbox, lable ect.)."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464190542, "post_id": 37441586, "comment_id": 62385950, "body": "Hmm maybe use <code>worksheet_change</code> event?"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464190924, "post_id": 37441831, "comment_id": 62386228, "body": "You were probably writing this as I made my comment^^"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464190991, "post_id": 37441831, "comment_id": 62386284, "body": "@findwindow That I was, it is a fairly natural idea for any experienced VBA programmer -- but you did voice it first."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464191029, "post_id": 37441831, "comment_id": 62386307, "body": "Well, commenting is faster than answering =P"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464191598, "post_id": 37441831, "comment_id": 62386795, "body": "couldn&#39;t it simple be <code>If Target.Address = &quot;$A$1&quot; Then</code>  and <code>color = target.Value</code> ? thus eliminating <code>Dim cell As Range</code>,  <code>Set cell = Range(&quot;A1&quot;)</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464191763, "post_id": 37441831, "comment_id": 62386923, "body": "@user3598756 Yes, you are correct. I was making the code as similar to the original code as possible. It doesn&#39;t really make much difference though in the sense that in any case the code will execute before your finger is done leaving the enter key."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464192565, "post_id": 37441831, "comment_id": 62387431, "body": "I agree on the speed. I put that in just as a contribution to the issue of having a code as lean as possible for a (possibly) easier and better maintenance of it. Also, <code>Select Case - End Select</code> block in lieu of all those <code>If- Then</code> clauses could be suggested"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464192747, "post_id": 37441831, "comment_id": 62387535, "body": "@drylkuch if this solved your problem, please mark the checkmark. Only you can do this."}, {"owner": {"reputation": 55, "user_id": 6381888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce38f8f91d9a87f5132b80291437d14?s=128&d=identicon&r=PG&f=1", "display_name": "drylkuch", "link": "https://stackoverflow.com/users/6381888/drylkuch"}, "edited": false, "score": 0, "creation_date": 1464272029, "post_id": 37441831, "comment_id": 62425552, "body": "Thanks for the help. I really appreciate it!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1464190684, "creation_date": 1464190684, "answer_id": 37441831, "question_id": 37441586, "link": "https://stackoverflow.com/questions/37441586/excel-macro-change-textbox-color/37441831#37441831", "title": "Excel Macro Change TextBox Color", "body": "<p>As @findwindow suggested, you could use the <code>Worksheet_Change</code> event instead of the text-box event:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    'Declare Variables\n    Dim cell As Range\n    Dim color As String\n\n    If Target.Address = Range(\"A1\").Address Then\n        'Initialize Variables\n        Set cell = Range(\"A1\")\n        color = cell.Value\n\n        'Set TextBox Color\n        If color = \"\" Then TextBox1.BackColor = RGB(255, 255, 255) 'white\n        If color = \"1\" Then TextBox1.BackColor = RGB(255, 0, 0) 'red\n        If color = \"2\" Then TextBox1.BackColor = RGB(0, 255, 0) 'green\n        If color = \"3\" Then TextBox1.BackColor = RGB(0, 0, 255) 'blue\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6381888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ce38f8f91d9a87f5132b80291437d14?s=128&d=identicon&r=PG&f=1", "display_name": "drylkuch", "link": "https://stackoverflow.com/users/6381888/drylkuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3079, "favorite_count": 0, "accepted_answer_id": 37441831, "answer_count": 1, "score": 3, "last_activity_date": 1464203435, "creation_date": 1464190082, "last_edit_date": 1464203435, "question_id": 37441586, "link": "https://stackoverflow.com/questions/37441586/excel-macro-change-textbox-color", "title": "Excel Macro Change TextBox Color", "body": "<p>I am attempting to write an Excel macro to change the color of at textbox automatically based on an input value from a cell in the sheet. The code that I currently have is:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\n'Declare Variables\nDim cell As Range\nDim color As String\n\n'Initialize Variables\nSet cell = Range(\"A1\")\ncolor = cell.Value\n\n'Set TextBox Color\nIf color = \"\" Then TextBox1.BackColor = RGB(255, 255, 255) 'white\nIf color = \"1\" Then TextBox1.BackColor = RGB(255, 0, 0) 'red\nIf color = \"2\" Then TextBox1.BackColor = RGB(0, 255, 0) 'green\nIf color = \"3\" Then TextBox1.BackColor = RGB(0, 0, 255) 'blue\n\nEnd Sub\n</code></pre>\n\n<p>This is supposed to read a value from cell A1, then change the color of the textbox based on that value. My code does successfully change the color of the textbox, but it doesn't update until after I click into the textbox and type something. Is there a way to make the color update as soon as a value is entered into cell A1?</p>\n\n<p>If it would be easier to do this with some other object I am not tied to a textbox but cannot just use a cell.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6372578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28105c69b34962ae1158532002aa581?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny H.", "link": "https://stackoverflow.com/users/6372578/johnny-h"}, "edited": false, "score": 0, "creation_date": 1464189557, "post_id": 37441280, "comment_id": 62385235, "body": "thank you Joshua but this doesn&#39;t work. It still updates everything according to one record.. but now it&#39;s not the first, it is the one I click on. So all records have their fields visible if i click on a record that has a &quot;converted&quot; field value.... and invisible if I click on a record that does not."}, {"owner": {"reputation": 101, "user_id": 6282417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e61f2c5da9f4548c97e5df7fc296a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua R.", "link": "https://stackoverflow.com/users/6282417/joshua-r"}, "reply_to_user": {"reputation": 51, "user_id": 6372578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28105c69b34962ae1158532002aa581?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny H.", "link": "https://stackoverflow.com/users/6372578/johnny-h"}, "edited": false, "score": 0, "creation_date": 1464189768, "post_id": 37441280, "comment_id": 62385409, "body": "A screenshot of the form might help with diagnosing the issue - I&#39;m not quite sure what you mean by &quot;continuous form&quot; in your question."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464190255, "post_id": 37441280, "comment_id": 62385745, "body": "Take a look at the following link... it describes how to change the label fild to a text box then use conditional formatting (can&#39;t use conditional formatting on a label)  <a href=\"http://www.pcreview.co.uk/threads/conditional-formatting-on-a-label.2657374/\" rel=\"nofollow noreferrer\">pcreview.co.uk/threads/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 6372578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28105c69b34962ae1158532002aa581?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny H.", "link": "https://stackoverflow.com/users/6372578/johnny-h"}, "edited": false, "score": 0, "creation_date": 1464229568, "post_id": 37441280, "comment_id": 62402586, "body": "@JoshuaR. I added 2 pics. I can&#39;t post them here directly &#39;cause I&#39;m new and I don&#39;t have the rep to post according to stackoverflow. Basically I&#39;m trying to make a little check mark pop up next to those converted (or in absence of that, turn the background of the field to a different color for converted customers). When I say &quot;continuous form&quot; I meant that the form is set in the property sheet to Default View -&gt; Continuous Forms. Hope this helps."}, {"owner": {"reputation": 51, "user_id": 6372578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28105c69b34962ae1158532002aa581?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny H.", "link": "https://stackoverflow.com/users/6372578/johnny-h"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464230127, "post_id": 37441280, "comment_id": 62402694, "body": "@WayneG.Dunn -  It works. THANK YOU! I have to do what Joshua said along with what you said."}], "tags": [], "owner": {"reputation": 101, "user_id": 6282417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5e61f2c5da9f4548c97e5df7fc296a8?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua R.", "link": "https://stackoverflow.com/users/6282417/joshua-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1464189309, "creation_date": 1464189309, "answer_id": 37441280, "question_id": 37441072, "link": "https://stackoverflow.com/questions/37441072/set-label-visibility-in-continuous-form/37441280#37441280", "title": "Set label visibility in continuous form", "body": "<p>I think you're looking for the Current event, not the Load event. Current triggers when the record becomes the \"current\" record, so that's once every time you switch records. Just change Form_Load to Form_Current. Check out <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193159.aspx\" rel=\"nofollow\">this page</a> for more information, if you need it.</p>\n"}], "owner": {"reputation": 51, "user_id": 6372578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28105c69b34962ae1158532002aa581?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny H.", "link": "https://stackoverflow.com/users/6372578/johnny-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1220, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1464229434, "creation_date": 1464188774, "last_edit_date": 1464229434, "question_id": 37441072, "link": "https://stackoverflow.com/questions/37441072/set-label-visibility-in-continuous-form", "title": "Set label visibility in continuous form", "body": "<p><a href=\"http://i.stack.imgur.com/wtViB.png\" rel=\"nofollow\">table</a><a href=\"http://i.stack.imgur.com/w9UP3.png\" rel=\"nofollow\">continuous form</a>I need to update to visible or invisible a label in a continuous form based on the status of a field in the same record. </p>\n\n<p>I tried with the below but it only takes the value of the first record. In other words it updates visibility to all records based on the first one. If the first record has the field as \"converted\" then they all get visible... no matter if the rest of the records do NOT have \"converted\" in that field.</p>\n\n<p>I'm sure I'm doing something wrong but I can't figure out what. </p>\n\n<p>My guesstimate is that I'm addressing the fields wrong using me.fieldname in a continuous form... Should I do something else to get the value for each specific record and affect only that particular record based on that value?</p>\n\n<pre><code>Private Sub Form_Load()\n\nIf Me.convertedStatus = \"converted\" Then\n    Me.lblCheckMark.Visible = True\nElse\n    Me.lblCheckMark.Visible = False\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "row"], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1464189521, "creation_date": 1464189521, "answer_id": 37441368, "question_id": 37440668, "link": "https://stackoverflow.com/questions/37440668/line-break-into-new-rows-w-added-numbered-column/37441368#37441368", "title": "Line Break into New Rows w/ Added Numbered Column", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim vLine As Variant\n    Dim aData As Variant\n    Dim aResults() As Variant\n    Dim ResultIndex As Long\n    Dim lCount As Long\n    Dim lSplitCol As Long\n    Dim i As Long, j As Long\n\n    With ActiveWorkbook\n        Set wsData = .ActiveSheet\n        Set wsDest = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n    End With\n\n    lSplitCol = 5\n\n    aData = wsData.Range(\"A1\").CurrentRegion.Value\n    ReDim aResults(1 To 65000, 1 To UBound(aData, 2) + 1)\n\n    ResultIndex = 0\n    For i = LBound(aData, 1) To UBound(aData, 1)\n        lCount = 0\n        For Each vLine In Split(aData(i, lSplitCol), Chr(10))\n            lCount = lCount + 1\n            ResultIndex = ResultIndex + 1\n            aResults(ResultIndex, 1) = lCount\n            For j = LBound(aData, 2) To UBound(aData, 2)\n                If j = lSplitCol Then\n                    aResults(ResultIndex, j + 1) = vLine\n                Else\n                    aResults(ResultIndex, j + 1) = aData(i, j)\n                End If\n            Next j\n            If ResultIndex = UBound(aResults, 1) Then\n                wsDest.Cells(Rows.Count, \"A\").End(xlUp).Offset(1).Resize(UBound(aResults, 1), UBound(aResults, 2)).Value = aResults\n                ReDim aResults(1 To 65000, 1 To UBound(aData, 2) + 1)\n                ResultIndex = 0\n            End If\n        Next vLine\n    Next i\n\n    If ResultIndex &gt; 0 Then wsDest.Cells(Rows.Count, \"A\").End(xlUp).Offset(1).Resize(ResultIndex, UBound(aResults, 2)).Value = aResults\n    wsDest.Rows(1).EntireRow.Delete xlUp\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6381792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0ef4d708000613acbd881ab5be1c35?s=128&d=identicon&r=PG&f=1", "display_name": "jthespartan", "link": "https://stackoverflow.com/users/6381792/jthespartan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464192241, "creation_date": 1464187725, "last_edit_date": 1464192241, "question_id": 37440668, "link": "https://stackoverflow.com/questions/37440668/line-break-into-new-rows-w-added-numbered-column", "title": "Line Break into New Rows w/ Added Numbered Column", "body": "<p>I am using a macro to separate line breaks in an existing cell into new rows. I have that part worked out. Now I want to add a column that numbers each of the rows that were separated.</p>\n\n<p><strong>Single Cell</strong></p>\n\n<p>All Info</p>\n\n<p><strong>Old Setup (multiple rows, one column)</strong></p>\n\n<p>Row 1 Info</p>\n\n<p>Row 2 Info</p>\n\n<p>Row 3 Info</p>\n\n<p><strong>Desired setup (multiple rows, two columns)</strong></p>\n\n<p>1 Row 1 Info</p>\n\n<p>2 Row 2 Info</p>\n\n<p>3 Row 3 Info</p>\n\n<p>I want to start the sequence over when the macro begins to break up a new cell. </p>\n\n<p>Here's the code that I'm working with. Any help would be appreciated!</p>\n\n<pre><code>Sub CellSplitter()\nDim Temp As Variant\nDim CText As String\nDim J As Integer\nDim K As Integer\nDim L As Integer\nDim iColumn As Integer\nDim lNumCols As Long\nDim lNumRows As Long\n\niColumn = 5\n\nSet wksSource = ActiveSheet\nSet wksNew = Worksheets.Add\n\niTargetRow = 0\nWith wksSource\n    lNumCols = .Range(\"IV1\").End(xlToLeft).Column\n    lNumRows = .Range(\"A65536\").End(xlUp).Row\n    For J = 1 To lNumRows\n        CText = .Cells(J, iColumn).Value\n        Temp = Split(CText, Chr(10))\n        For K = 0 To UBound(Temp)\n            iTargetRow = iTargetRow + 1\n            For L = 1 To lNumCols\n                If L &lt;&gt; iColumn Then\n                    wksNew.Cells(iTargetRow, L) _\n                      = .Cells(J, L)\n                Else\n                    wksNew.Cells(iTargetRow, L) _\n                      = Temp(K)\n                End If\n            Next L\n        Next K\n    Next J\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1464189382, "post_id": 37440531, "comment_id": 62385109, "body": "This really isn&#39;t a programming question. You could delete the question here and ask it on <a href=\"http://superuser.com/\">superuser.com</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1464202418, "post_id": 37440531, "comment_id": 62393019, "body": "Did you try repairing Excel on that machine? If it&#39;s working everywhere else, that could be it."}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464187435, "creation_date": 1464187435, "last_edit_date": 1531161705, "question_id": 37440531, "link": "https://stackoverflow.com/questions/37440531/solver-causes-error-excel-has-stopped-working", "title": "Solver causes error &quot;Excel has stopped working&quot;", "body": "<p>I want to use the Excel-Solver-Add-In to solve the following simple calculation:</p>\n\n<pre><code>        1               2          \n   A Revenue       Variable of solver goes in here          \n   B Costs         A fix rate of -3000 goes in here\n   C Result        Result of A2+B2 is shown here\n   D Target        Result of A2+B2 should be 5000 by changing value in A2\n</code></pre>\n\n<p><em>I know I could also solve this by the goalseek function but this is just a simple example to explain you my issue and I will need the solver later in a much more complex calculation.</em></p>\n\n<p>I have installed the Excel Solver Add-In on four computers. All of them using Excel 2010. On three of them it works without any issue. However, on the last one I get the message \"Excel has stopped working\" once I click on the \"Solve\" Button within the Solver menu. It seems that the solver does not even start calculating. I have checked through all options in Excel and they are equal on each computer. Each file is set on \"Automatic Calculation\".</p>\n\n<p>Do you have any idea what could be the reason why excel breaks down when using the solver even for a simple problem as above?</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["vba", "excel", "vbscript", "udf"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1464187361, "post_id": 37440435, "comment_id": 62383513, "body": "Change all of your <code>As Integer</code> to be <code>As Long</code> instead and remove the <code>Application.Volatile</code>.  If it&#39;s still not working, can you please provide some sample data and expected results?"}, {"owner": {"reputation": 289, "user_id": 1449439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f2c73a77aa03d3575d63ae8893a57f48?s=128&d=identicon&r=PG", "display_name": "ssn", "link": "https://stackoverflow.com/users/1449439/ssn"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1464188589, "post_id": 37440435, "comment_id": 62384495, "body": "Still not working here is a sample... CUSTOMJULIAN(1999,1,17) should give 2451156 as per the formula"}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1464189385, "creation_date": 1464189385, "answer_id": 37441311, "question_id": 37440435, "link": "https://stackoverflow.com/questions/37440435/nagging-value-error-in-excel-udf/37441311#37441311", "title": "nagging #value! error in excel udf", "body": "<p>Replace following line</p>\n\n<pre><code>If JDay + (31 * (JMonth + 12 * JYear)) &gt;= (15 + (31 * (10 + 12 * 1582))) Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If JDay + (31 * (JMonth + 12 * JYear)) &gt;= (15 + (31 * (10 + 12 * CLng(1582)))) Then\n</code></pre>\n\n<p>See the details <a href=\"https://msdn.microsoft.com/en-us/library/aa264525(v=vs.60).aspx\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 289, "user_id": 1449439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f2c73a77aa03d3575d63ae8893a57f48?s=128&d=identicon&r=PG", "display_name": "ssn", "link": "https://stackoverflow.com/users/1449439/ssn"}, "is_accepted": false, "score": 0, "last_activity_date": 1464189398, "creation_date": 1464189398, "answer_id": 37441318, "question_id": 37440435, "link": "https://stackoverflow.com/questions/37440435/nagging-value-error-in-excel-udf/37441318#37441318", "title": "nagging #value! error in excel udf", "body": "<p>This was able to work</p>\n\n<pre><code>Option Explicit\nFunction CUSTOMJULIAN(JYear As Integer, JMonth As Integer, JDay As Integer) As Long\n\nDim iyear As Long\niyear = JYear\n\nDim imonth As Long\nimonth = JMonth + 1\n\nIf imonth &lt;= 2 Then\n    iyear = iyear - 1\n    imonth = imonth + 12\nEnd If\n\nCUSTOMJULIAN = Int(365.25 * iyear) + Int(30.6001 * imonth) + JDay + 1720995\n\nDim iday As Long\niday = 12 * JYear\niday = iday + JMonth\niday = iday * 31\n\nIf iday &gt;= 588829 Then\n\n    Dim iadjustment As Long\n    iadjustment = Int(0.01 * iyear)\n\n    CUSTOMJULIAN = CUSTOMJULIAN + 2 - iadjustment + Int(0.25 * iadjustment)\n\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 289, "user_id": 1449439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f2c73a77aa03d3575d63ae8893a57f48?s=128&d=identicon&r=PG", "display_name": "ssn", "link": "https://stackoverflow.com/users/1449439/ssn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464189398, "creation_date": 1464187209, "question_id": 37440435, "link": "https://stackoverflow.com/questions/37440435/nagging-value-error-in-excel-udf", "title": "nagging #value! error in excel udf", "body": "<p>I am new to vb and excel but I have to develop a custom udf for excel. I have read I have tried to alter my code below many times with the suggestions on this forum to no avail. What am I missing. This code is for working out a Julian date in integer form.</p>\n\n<pre><code>Option Explicit\nFunction CUSTOMJULIAN(JYear As Integer, JMonth As Integer, JDay As Integer) As Integer\n\nApplication.Volatile\n\nDim iyear As Integer\niyear = JYear\n\nDim imonth As Integer\nimonth = JMonth + 1\n\nIf imonth &lt;= 2 Then\n    iyear = iyear - 1\n    imonth = imonth + 12\nEnd If\n\nCUSTOMJULIAN = Int(365.25 * iyear) + Int(30.6001 * imonth) + JDay + 1720995\n\nIf JDay + (31 * (JMonth + 12 * JYear)) &gt;= (15 + (31 * (10 + 12 * 1582))) Then\n\n    Dim iadjustment As Integer\n    iadjustment = Int(0.01 * iyear)\n\n    CUSTOMJULIAN = CUSTOMJULIAN + 2 - iadjustment + Int(0.25 * iadjustment)\n\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1464187007, "post_id": 37440228, "comment_id": 62383209, "body": "Use a dictionary, and the .Exists to check for dupes and compile the list from column F then use this list and worksheetfunction.sumif and .countif to do it"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1464187795, "post_id": 37440228, "comment_id": 62383863, "body": "If a pivot table already gets you the necessary results, why do you need to do this in VBA?"}, {"owner": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1464188575, "post_id": 37440228, "comment_id": 62384485, "body": "@tigeravatar My end goal is not to create Pivot Tables for the results since I am doing something else with the data. I just created the Pivot Tables to show what Data I need"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1464189480, "post_id": 37440228, "comment_id": 62385185, "body": "I would use a dictionary with values which are 2-element arrays created with <code>Array()</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1464189811, "post_id": 37440228, "comment_id": 62385437, "body": "The most efficient approach would require sorting the data.  Is that ok?"}], "answers": [{"comments": [{"owner": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "edited": false, "score": 0, "creation_date": 1464201308, "post_id": 37441794, "comment_id": 62392374, "body": "Thankyou. Just a quick question when you wrote &#39;rData.Sort rData.Columns(1), xlAscending, Header:=xlYes&#39; why are there no brackets/assignment? When I write &#39;rData = rData.Sort(rData.Columns(1), xlAscending, Header:=xlYes)&#39; its wrong. I don&#39;t understand the syntax in play here"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "edited": false, "score": 0, "creation_date": 1464203462, "post_id": 37441794, "comment_id": 62393566, "body": "You only need the parentheses when you are assigning a value to an expression or method.  Unfortunately, you can&#39;t assign the sort method to a value, which is why it is on its own line, and then loaded into an array in the next line.  Because it is being sorted on its own line and there isn&#39;t any assignment or comparison going on (no <code>=</code> sign in the line), no parentheses are necessary for the Sort line."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1464190602, "creation_date": 1464190602, "answer_id": 37441794, "question_id": 37440228, "link": "https://stackoverflow.com/questions/37440228/excel-vba-mapping-different-values-to-an-entity/37441794#37441794", "title": "Excel VBA - Mapping different values to an entity", "body": "<p>Assuming you are allowed to sort the data, this will work just fine for you.  Tested on over 30,000 rows of data and it completed successfully in less than 0.1 seconds.  Commented code for clarity:</p>\n\n<pre><code>Sub ParseJobData()\n\n    Dim ws As Worksheet\n    Dim rData As Range\n    Dim aData As Variant\n    Dim aResults() As Variant\n    Dim sTemp As String\n    Dim ResultIndex As Long\n    Dim i As Long\n\n    Set ws = ActiveWorkbook.ActiveSheet          'Make sure this is the correct sheet\n    Set rData = ws.Range(\"F1\").CurrentRegion     'Make sure this is the correct range\n\n    rData.Sort rData.Columns(1), xlAscending, Header:=xlYes    'Sort data\n    aData = rData.Value                                        'Load data into array\n    ReDim aResults(1 To 65000, 1 To 3)                         'Save data in Results array\n\n    'Starting at 2 in order to skip header row\n    For i = 2 To UBound(aData, 1)\n\n        'Check if this is a new name\n        'Data is sorted, so new name only happens when previous name is completed\n        If aData(i, 1) &lt;&gt; sTemp Then\n            'New name, increase ResultIndex, store the name\n            ResultIndex = ResultIndex + 1\n            sTemp = aData(i, 1)\n            aResults(ResultIndex, 1) = sTemp\n        End If\n\n        'Column 2 is a count of jobs, increase it by 1\n        aResults(ResultIndex, 2) = aResults(ResultIndex, 2) + 1\n\n        'Column 3 is a sum of payment, increase by the amount\n        aResults(ResultIndex, 3) = aResults(ResultIndex, 3) + aData(i, 3)\n    Next i\n\n    'You have now built your array of unique values with a count and sum\n    'Do what you want with the array here\n    'This simply outputs it\n    ws.Range(\"J1\").Resize(ResultIndex, UBound(aResults, 2)).Value = aResults\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3600, "user_id": 2249815, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2tZpJ.png?s=128&g=1", "display_name": "Jebathon", "link": "https://stackoverflow.com/users/2249815/jebathon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 37441794, "answer_count": 1, "score": 0, "last_activity_date": 1464190602, "creation_date": 1464186659, "last_edit_date": 1592644375, "question_id": 37440228, "link": "https://stackoverflow.com/questions/37440228/excel-vba-mapping-different-values-to-an-entity", "title": "Excel VBA - Mapping different values to an entity", "body": "<p>In Excel I have a table that works like the following. There are a number of people and several thousand work orders associated with those people.</p>\n<p>This is a demo table below:</p>\n<p><a href=\"https://i.stack.imgur.com/ySL8m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ySL8m.png\" alt=\"enter image description here\" /></a></p>\n<p>What I want in VBA is a data structure that maps each person with the amount of jobs done and total amount of money earned. So we know Jonathan did 3 jobs and earned 400 dollars.</p>\n<p>e.x.</p>\n<blockquote>\n<p>(Key) -&gt; (Value, Value)</p>\n<p>(Person) -&gt; (Number of Jobs, Total Money)</p>\n</blockquote>\n<p>I need the values from the Pivot Tables above but don't want to draw Pivot Tables in VBA just to get those values.</p>\n<p><a href=\"https://i.stack.imgur.com/URFIf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/URFIf.png\" alt=\"enter image description here\" /></a></p>\n<p>So my questions are: one - how can I write a dictionary or collection that does this in VBA and two - is a dictionary the most efficient approach. ie is there a better approach?</p>\n"}, {"tags": ["excel", "vba", "pivot", "datasource", "auto-update"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6381678, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066045753457610/picture?type=large", "display_name": "Pedro Camacho D&#39;Andrea", "link": "https://stackoverflow.com/users/6381678/pedro-camacho-dandrea"}, "edited": false, "score": 0, "creation_date": 1464197251, "post_id": 37443389, "comment_id": 62390092, "body": "Beautiful! Fit as a glove. Thanks!"}, {"owner": {"reputation": 3, "user_id": 6381678, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066045753457610/picture?type=large", "display_name": "Pedro Camacho D&#39;Andrea", "link": "https://stackoverflow.com/users/6381678/pedro-camacho-dandrea"}, "edited": false, "score": 0, "creation_date": 1464199027, "post_id": 37443389, "comment_id": 62391098, "body": "Actually... I am having some trouble...  I am not able to change the source when I use the macro on other workbooks...  &#39;C:\\ACreative\\An&#225;lises\\Sell Out\\REWORKING\\Consolidar\\Download\\Maio\\30&#91;Coop.xlsx]Vend&zwnj;&#8203;as por Loja&#39;!$A$6:$BJ$30000  I don&#39;t know if It is a excel configuration problem... Maybe a problem with that Single Quotes that appear on the beggining? I am not sure, have tried to remove them but still getting the error."}, {"owner": {"reputation": 421, "user_id": 4709762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6dc02128bfdf4272ec606f489c2bef?s=128&d=identicon&r=PG", "display_name": "Peter Vandivier", "link": "https://stackoverflow.com/users/4709762/peter-vandivier"}, "reply_to_user": {"reputation": 3, "user_id": 6381678, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066045753457610/picture?type=large", "display_name": "Pedro Camacho D&#39;Andrea", "link": "https://stackoverflow.com/users/6381678/pedro-camacho-dandrea"}, "edited": false, "score": 0, "creation_date": 1464200446, "post_id": 37443389, "comment_id": 62391905, "body": "Try using R1C1 format to reference the range. In your example - <code>$A$6:$BJ$30000</code> would become <code>R6C1:R30000C62</code>"}, {"owner": {"reputation": 421, "user_id": 4709762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6dc02128bfdf4272ec606f489c2bef?s=128&d=identicon&r=PG", "display_name": "Peter Vandivier", "link": "https://stackoverflow.com/users/4709762/peter-vandivier"}, "reply_to_user": {"reputation": 3, "user_id": 6381678, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066045753457610/picture?type=large", "display_name": "Pedro Camacho D&#39;Andrea", "link": "https://stackoverflow.com/users/6381678/pedro-camacho-dandrea"}, "edited": false, "score": 0, "creation_date": 1464200814, "post_id": 37443389, "comment_id": 62392097, "body": "Also try using the <a href=\"https://support.office.com/en-us/article/Create-or-delete-a-macro-2841ba85-9da6-4bd7-93a4-0da90844f283#bmrecordmacro\" rel=\"nofollow noreferrer\">macro recorder</a> to capture the action you want to complete. It&#39;s usually a simple syntax issue like this that the macro record will smooth over ( albeit likely with a <i>LOT</i> of extra code padded on )."}], "tags": [], "owner": {"reputation": 421, "user_id": 4709762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6dc02128bfdf4272ec606f489c2bef?s=128&d=identicon&r=PG", "display_name": "Peter Vandivier", "link": "https://stackoverflow.com/users/4709762/peter-vandivier"}, "is_accepted": true, "score": 0, "last_activity_date": 1464200874, "last_edit_date": 1464200874, "creation_date": 1464195409, "answer_id": 37443389, "question_id": 37440156, "link": "https://stackoverflow.com/questions/37440156/change-a-pivot-table-source-to-a-different-workbook-based-on-cell-value/37443389#37443389", "title": "Change a Pivot table Source to a different workbook (based on cell value)", "body": "<h3>The <a href=\"https://support.office.com/en-us/article/Create-or-delete-a-macro-2841ba85-9da6-4bd7-93a4-0da90844f283#bmrecordmacro\" rel=\"nofollow\">Macro Recorder</a> is your friend.</h3>\n\n<p>As long as you know the different DataSources are all going to slide into the pivot table in question, try the below VBA snippet to quickly switch between either same-workbook or other-workbook ranges.</p>\n\n<pre><code>Sub ChangeDataSource()\n    Dim DataSource As String\n    Dim Green As Long, Red As Long\n    Green = -11489280\n    Red = -16776961\n\nOn Error GoTo ErrHandle\n\n    DataSource = Range(\"DataSource\").Value\n    ActiveSheet.PivotTables(\"PivotTable1\").ChangePivotCache ActiveWorkbook. _\n        PivotCaches.Create(SourceType:=xlDatabase, SourceData:=DataSource, Version _\n        :=xlPivotTableVersion15)\n\n    Range(\"DataSource\").Font.Color = Green\n    Range(\"CurrentDataSource\").Value = DataSource\n    Calculate\n\n    GoTo Success\n\nErrHandle:\n    MsgBox (\"DataSource is not valid.\")\n    Range(\"DataSource\").Font.Color = Red\n\nSuccess:\n\nEnd Sub\n</code></pre>\n\n<p>Note I've made some use of named ranges in the local workbook to assist the macro. I've uploaded <a href=\"https://github.com/petervandivier/hello-world/commit/83607e57b9c1a5c56846f178af7ff56c1593e6ae\" rel=\"nofollow\">some sample files here</a> rather than uploading screenshots so you can poke around yourself instead of trying to interpret static pictures on the forum post. </p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 3, "user_id": 6381678, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066045753457610/picture?type=large", "display_name": "Pedro Camacho D&#39;Andrea", "link": "https://stackoverflow.com/users/6381678/pedro-camacho-dandrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1390, "favorite_count": 0, "accepted_answer_id": 37443389, "answer_count": 1, "score": 0, "last_activity_date": 1464202801, "creation_date": 1464186509, "question_id": 37440156, "link": "https://stackoverflow.com/questions/37440156/change-a-pivot-table-source-to-a-different-workbook-based-on-cell-value", "title": "Change a Pivot table Source to a different workbook (based on cell value)", "body": "<p>I have to weekly update a database that has around 15 workbooks.</p>\n\n<p>The solution that I have come up to is to arrange the data with pivot tables (one pivot table for each file) and then consolidate them with a VBA code that copies the data to another single workbook (ALREADY DONE).</p>\n\n<p>The problem is that I need to manually change the data source for all those files, also it takes time to open each of them as they are heavy (10mb).</p>\n\n<p>What would be optimal is a code that changes the source for each file, looking on another folder (April week 1,2,3,4 // May week 1, 2, 3, 4...)</p>\n\n<p>Example <strong>FILE 1</strong>:</p>\n\n<p>Source April Week 3: 'C:\\ACreative\\April\\3[Coop.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>Source April Week 4: 'C:\\ACreative\\April\\4[Coop.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>Source May Week 1:  'C:\\ACreative\\May\\1[Coop.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>Source May Week 2: 'C:\\ACreative\\May\\2[Coop.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>Example <strong>FILE 2</strong>:</p>\n\n<p>Source April Week 3: 'C:\\ACreative\\April\\3[File2.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>Source April Week 4: 'C:\\ACreative\\April\\4[File2.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>Source May Week 1:  'C:\\ACreative\\May\\1[File2.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>Source May Week 2: 'C:\\ACreative\\May\\2[File2.XLS]Sheet1'!$A$6:$BJ$30000</p>\n\n<p>A solution that I tought was to write the (\\April\\3\\ ; \\May\\1) on a cell, and update the source based on that \"path+cell value\", but I am open to another one.</p>\n\n<p>Thank you!!!</p>\n"}, {"tags": ["database", "excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 1, "creation_date": 1464186567, "post_id": 37440078, "comment_id": 62382829, "body": "What error message are you getting?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 2430036, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a2a0a37952c6ea13ef56de08a27b73a?s=128&d=identicon&r=PG", "display_name": "user2430036", "link": "https://stackoverflow.com/users/2430036/user2430036"}, "edited": false, "score": 0, "creation_date": 1464191710, "post_id": 37442040, "comment_id": 62386877, "body": "Sorry for my limited knowledge and a silly question. Where am I inserting these macros in the same excel file or Access db?"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 45, "user_id": 2430036, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a2a0a37952c6ea13ef56de08a27b73a?s=128&d=identicon&r=PG", "display_name": "user2430036", "link": "https://stackoverflow.com/users/2430036/user2430036"}, "edited": false, "score": 0, "creation_date": 1464191840, "post_id": 37442040, "comment_id": 62386965, "body": "In Access. You will also have to supply a value for <code>fileName</code> in the code."}, {"owner": {"reputation": 45, "user_id": 2430036, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a2a0a37952c6ea13ef56de08a27b73a?s=128&d=identicon&r=PG", "display_name": "user2430036", "link": "https://stackoverflow.com/users/2430036/user2430036"}, "edited": false, "score": 0, "creation_date": 1464229396, "post_id": 37442040, "comment_id": 62402554, "body": "For second macro I am getting error &quot;An expression you entered is the wrong data type for one of the arguments. I am using ..  Sub ImportData()  Dim rst As DAO.Recordset Set rst = CurrentDb.OpenRecordset(&quot;tblSheetNames&quot;)  Do While Not rst.EOF          &#39;Link to SpreadSheet, <b>make sure you add the &#39;!&#39; to the spread-sheet-name for the <i>Range</i> parameter</b>     DoCmd.TransferSpreadsheet acLink, acSpreadsheetTypeExcel12, &quot;Temp&quot;, &quot;C:\\File.xlsx&quot;, rst!ShtNm &amp; &quot;!&quot;     &#39;Dump sheet into table &#39;MyTable&#39; and then Delete Link:     CurrenDb.TableDefs.Delete (&quot;Temp&quot;) rst.MoveNext: Loop  End Sub"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "reply_to_user": {"reputation": 45, "user_id": 2430036, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a2a0a37952c6ea13ef56de08a27b73a?s=128&d=identicon&r=PG", "display_name": "user2430036", "link": "https://stackoverflow.com/users/2430036/user2430036"}, "edited": false, "score": 0, "creation_date": 1464237739, "post_id": 37442040, "comment_id": 62404567, "body": "On what line do you get the error? what version of Access are you using? what version is the Excel? Have you created tables <code>tblSheetNames</code> and` MyTable`?"}, {"owner": {"reputation": 45, "user_id": 2430036, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a2a0a37952c6ea13ef56de08a27b73a?s=128&d=identicon&r=PG", "display_name": "user2430036", "link": "https://stackoverflow.com/users/2430036/user2430036"}, "edited": false, "score": 0, "creation_date": 1464239607, "post_id": 37442040, "comment_id": 62405101, "body": "I figured it out. Thanks for your help"}], "tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": true, "score": 0, "last_activity_date": 1464191236, "creation_date": 1464191236, "answer_id": 37442040, "question_id": 37440078, "link": "https://stackoverflow.com/questions/37440078/excel-multiple-worksheets-to-access-tables/37442040#37442040", "title": "Excel Multiple worksheets to Access tables", "body": "<p>Use <code>Excel.Application</code> Object, to get from the Excel <code>Workbook</code> all the names in the <code>Worksheets</code> Collection, and register all names of sheets in the workbook:</p>\n\n<pre><code>Dim App As Object                                            'Excel interface\nDim File As Object                                           'Your file     \nDim ws As Variant                                             'Your worksheet\n\nSet App = CreateObject(\"Excel.Application\")                  'This opens excel application windows\nSet File = App.Workbooks.Open(fileName)                      'This opens your particular excel file (or workbook)\n\nFor each ws In File\n    'Register Name in a table named tblSheetNames, Containing a field named 'ShtNm': \n    CurrentDb.Execute \"INSERT INTO tblSheetNames(ShtNm) VALUES ('\" &amp; ws.Name &amp; \"')\"\nNext\n'Close the App to allow link to the Excel file\nApp.Close: Set App = Nothing\n</code></pre>\n\n<p>Then import all these worksheets:  </p>\n\n<pre><code>'Import all these worksheets:\nDim rst as DAO.Recordset\nSet rst = CurrentDb.OpenRecordset(\"tblSheetNames\")\nDo While Not rst.Eof\n    'Link to SpreadSheet, **make sure you add the '!' to the spread-sheet-name for the *Range* parameter**\n    DoCmd.TransferSpreadsheet acLink, acSpreadsheetTypeExcel12, \"Temp\", fileName, rst!ShtNm &amp; \"!\"\n    'Dump sheet into table 'MyTable' and then Delete Link:\n    CurrenDb.TableDefs.Delete(\"Temp\")\nrst.MoveNext: Loop\n</code></pre>\n\n<p><a href=\"http://www.access-programmers.co.uk/forums/showthread.php?t=81948\" rel=\"nofollow\">add the '!' to the spread-sheet-name for the <em>Range</em> parameter</a></p>\n"}, {"comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1464347610, "post_id": 37471849, "comment_id": 62460598, "body": "Fine code and link you brought  @ryguy7272, please note the request was code for import Worksheets from one file."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1464300546, "creation_date": 1464300546, "answer_id": 37471849, "question_id": 37440078, "link": "https://stackoverflow.com/questions/37440078/excel-multiple-worksheets-to-access-tables/37471849#37471849", "title": "Excel Multiple worksheets to Access tables", "body": "<p>'Import Data from All EXCEL Files in a single Folder via TransferSpreadsheet (VBA)'</p>\n\n<pre><code>Dim strPathFile As String, strFile As String, strPath As String\nDim strTable As String\nDim blnHasFieldNames As Boolean\n\n' Change this next line to True if the first row in EXCEL worksheet\n' has field names\nblnHasFieldNames = False\n\n' Replace C:\\Documents\\ with the real path to the folder that\n' contains the EXCEL files\nstrPath = \"C:\\Documents\\\"\n\n' Replace tablename with the real name of the table into which\n' the data are to be imported\nstrTable = \"tablename\"\n\nstrFile = Dir(strPath &amp; \"*.xls\")\nDo While Len(strFile) &gt; 0\n      strPathFile = strPath &amp; strFile\n      DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, _\n            strTable, strPathFile, blnHasFieldNames\n\n' Uncomment out the next code step if you want to delete the\n' EXCEL file after it's been imported\n'       Kill strPathFile\n\n      strFile = Dir()\nLoop\n</code></pre>\n\n<p>The idea comes straight form here.</p>\n\n<p><a href=\"http://www.accessmvp.com/KDSnell/EXCEL_Import.htm#ImpFolderFiles\" rel=\"nofollow\">http://www.accessmvp.com/KDSnell/EXCEL_Import.htm#ImpFolderFiles</a></p>\n\n<p>Check out the link.  You will find several other really cool and utilitarian concepts there.</p>\n"}], "owner": {"reputation": 45, "user_id": 2430036, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a2a0a37952c6ea13ef56de08a27b73a?s=128&d=identicon&r=PG", "display_name": "user2430036", "link": "https://stackoverflow.com/users/2430036/user2430036"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 37442040, "answer_count": 2, "score": 0, "last_activity_date": 1464300546, "creation_date": 1464186344, "last_edit_date": 1531161705, "question_id": 37440078, "link": "https://stackoverflow.com/questions/37440078/excel-multiple-worksheets-to-access-tables", "title": "Excel Multiple worksheets to Access tables", "body": "<p>I have received a database dump from someone in a single Excel file .xlsx that has over 50 worksheets in it. In order for me to make sense of it, I will have to upload it to a database and start pulling some information together. </p>\n\n<p>I am more comfortable with Ms Access so staying with it for now.</p>\n\n<p>How can I import this single file with all 50 worksheets inside into 50 tables separately in Access db?</p>\n\n<p>Can someone please help as I am getting error message when using a simple External data option in Access. </p>\n"}, {"tags": ["arrays", "excel", "vba", "syntactic-sugar"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1464186340, "post_id": 37440000, "comment_id": 62382638, "body": "If your code is working and you are looking to simply discuss improvements etc, you might want to consider the following SE instead of this one:  <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464186998, "post_id": 37440000, "comment_id": 62383199, "body": "If you&#39;re using your UDF like that, is the sole purpose to save some keystrokes? (Because <code>=Offset(cell,-1,0)</code> is only maybe 7 more keys)"}, {"owner": {"reputation": 25, "user_id": 2451927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85ca62b333f6b168795eeae794e56a0?s=128&d=identicon&r=PG", "display_name": "Tim Galvin", "link": "https://stackoverflow.com/users/2451927/tim-galvin"}, "edited": false, "score": 0, "creation_date": 1464190973, "post_id": 37440000, "comment_id": 62386271, "body": "It&#39;s not just keystrokes. It&#39;s more for readability. Is offset faster?"}], "owner": {"reputation": 25, "user_id": 2451927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85ca62b333f6b168795eeae794e56a0?s=128&d=identicon&r=PG", "display_name": "Tim Galvin", "link": "https://stackoverflow.com/users/2451927/tim-galvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464186387, "creation_date": 1464186136, "last_edit_date": 1464186387, "question_id": 37440000, "link": "https://stackoverflow.com/questions/37440000/efficient-excel-range-index-lookup", "title": "Efficient excel range index lookup", "body": "<p>The following VBA UDF is used extensively in a spreadsheet I have created. It is syntactic sugar. </p>\n\n<pre><code>Function o(r As Range, t As Long) As Double\n\n\n    o = r.Cells(t - 2, 1)\n\n\nEnd Function\n</code></pre>\n\n<p>I have given all my columns names, as named ranges. In a formula this enables me to refer to a cell in a different column just by using the column's name. The function above allows me to do the same, but referring to rows by an offset value. </p>\n\n<p>for example if i have some enitre columns nameA and nameB, the formula:</p>\n\n<pre><code>= nameA + nameB\n</code></pre>\n\n<p>is valid.</p>\n\n<p>with o() i can do things like</p>\n\n<pre><code>= o(name,1) + name\n</code></pre>\n\n<p>Is there are more efficient/elegant way to do this? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1464186091, "creation_date": 1464186091, "answer_id": 37439980, "question_id": 37439753, "link": "https://stackoverflow.com/questions/37439753/vba-for-loop-through-named-range-error/37439980#37439980", "title": "VBA For loop through named range error", "body": "<p>You have this variable:</p>\n\n<pre><code>Dim files As Range\n</code></pre>\n\n<p>And then you set it here:</p>\n\n<pre><code>Set files = Worksheets(\"Control\").Range(\"All_Files\")\n</code></pre>\n\n<p>Then when you begin your loop your code is:</p>\n\n<pre><code>For Each rCell In Range(\"files\")\n</code></pre>\n\n<p>I think you mean for your code to read:</p>\n\n<pre><code>For Each rCell In files\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 2562294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd6592c7879b47c09015b6b388b7288?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/2562294/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 37439980, "answer_count": 1, "score": 0, "last_activity_date": 1464186091, "creation_date": 1464185494, "question_id": 37439753, "link": "https://stackoverflow.com/questions/37439753/vba-for-loop-through-named-range-error", "title": "VBA For loop through named range error", "body": "<p>I'm trying to use a <code>for</code>-loop to pick up data from multiple files, but somehow either the single cell range or the named range are not working:</p>\n\n<pre><code>Sub GetTTData()\n   ' Original from:\n   ' http://ccm.net/faq/24666-excel-vba-copy-data-to-another-workbook\n\n   ' CopyOpenItems Macro\n   ' Copy open items to sheet.\n   '\n   ' Keyboard Shortcut: Ctrl+Shift+O\n   '\n   Dim wbReport             As Workbook 'workbook where the data is to be pasted\n   Dim wbTTData             As Workbook 'workbook from where the data is to copied\n   Dim strName              As String   'name of the source sheet/ target workbook\n   Dim fileName             As String\n   Dim RAWDataSheet         As Worksheet\n   Dim SourceDataSheet      As Worksheet\n   Dim RAWData              As Range\n   Dim SourceData           As Range\n   Dim portName             As String\n   Dim rCell                As Range\n   Dim files                As Range\n\n   'set to the current active workbook (the source book)\n   Set wbReport = ThisWorkbook\n   'select Departure Airport\n   portName = Worksheets(\"Control\").Range(\"Dep_Airport\")\n   Set files = Worksheets(\"Control\").Range(\"All_Files\")\n\n   'select cell A2 on the target book\n   Set RAWDataSheet = wbReport.Worksheets(\"RAW TT Data\")\n   RAWDataSheet.Activate\n   Set RAWData = RAWDataSheet.Range(Range(\"A2\"), ActiveCell.SpecialCells(xlLastCell))\n\n   'clear existing values form target book\n   RAWData.ClearContents\n\n   For Each rCell In Range(\"files\")\n\n       'take source of TT Data from workbook and open file\n       fileName = Worksheets(\"Control\").Range(\"File_Path\") + Worksheets(\"Control\").Range(\"rCell\")\n       Set wbTTData = Workbooks.Open(fileName)\n\n       'activate the source book\n       wbTTData.Activate\n\n       'clear any thing on clipboard to maximize available memory\n       Application.CutCopyMode = False\n\n       'copy the range from source book\n       Set SourceDataSheet = wbTTData.Sheets(\"Sheet1\")\n\n       'filter RAW TT Data for Departure Airport\n       Set RAWData = SourceDataSheet.Range(Range(\"A1\"), ActiveCell.SpecialCells(xlLastCell))\n       RAWData.AutoFilter Field:=3, Criteria1:=Array(portName), Operator:=xlFilterValues\n\n       Set SourceData = SourceDataSheet.Range(Range(\"A2\"), ActiveCell.SpecialCells(xlLastCell))\n       SourceData.Copy\n\n       'paste the data on the target book\n       RAWDataSheet.Range(\"A2\").PasteSpecial\n\n       'clear any thing on clipboard to maximize available memory\n       Application.CutCopyMode = False\n\n       'save the target book\n       wbReport.Save\n\n       'close the workbook\n       wbTTData.Close savechanges:=False\n\n   Next rCell\n\n   'activate the source book again\n   wbReport.Activate\n\n   'clear memory\n   Set wbReport = Nothing\n   Set wbTTData = Nothing\n   Set SourceDataSheet = Nothing\n   Set SourceData = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1464188841, "creation_date": 1464188841, "answer_id": 37441099, "question_id": 37439593, "link": "https://stackoverflow.com/questions/37439593/add-elements-of-a-list-to-a-slide/37441099#37441099", "title": "Add elements of a list to a Slide", "body": "<p>I think this is the problem:</p>\n\n<pre><code>.Text = vbNewLine &amp; title\n</code></pre>\n\n<p>Each time through the loop, you're setting .Text to the current value of title, not appending the current value of title to the existing text.</p>\n\n<p>Change it to </p>\n\n<pre><code>.Text = .Text &amp; vbNewLine &amp; title\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 1826391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2d4f600308f041f2d6a9ec77e0656c72?s=128&d=identicon&r=PG", "display_name": "guguli", "link": "https://stackoverflow.com/users/1826391/guguli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484573046, "creation_date": 1464185133, "last_edit_date": 1484573046, "question_id": 37439593, "link": "https://stackoverflow.com/questions/37439593/add-elements-of-a-list-to-a-slide", "title": "Add elements of a list to a Slide", "body": "<p>I want to add the elements of a List to one slide. My code looks like this:</p>\n\n<pre><code>Sub Inhaltsverzeichnis_generator()\nSet titels = New Dictionary\nSet slideNr = New Collection\nDim sld As Slide\nDim inhaltsverzeichnis_Slide As Slide\nDim inhaltsverzeichnis_Shape_Titel As Shape\nDim inhaltsverzeichnis_Shape_Text As Shape  \nSet inhaltsverzeichnis_Slide = Application.ActivePresentation.Slides.Add(2, ppLayoutText)\n\nSet inhaltsverzeichnis_Shape_Titel = inhaltsverzeichnis_Slide.Shapes.AddTextbox(msoTextOrientationHorizontal, 30, 30, 650, 140)\nWith inhaltsverzeichnis_Shape_Titel.TextFrame.TextRange\n    .Font.Name = \"Arial\"\n    .Font.Size = 35\n    .Text = \"Introduction\"\n    .Lines.ParagraphFormat.SpaceWithin = 1.5\nEnd With\n\nFor Each sld In ActivePresentation.Slides\n    If sld.Shapes.HasTitle Then\n         'Debug.Print sld.SlideIndex &amp; \": \" &amp; sld.Shapes.Title.TextFrame.TextRange\n        titels.Add (sld.Shapes.title.TextFrame.TextRange.Text)\n        slideNr.Add (sld.SlideIndex)\n    End If\nNext\nSet inhaltsverzeichnis_Shape_Text = inhaltsverzeichnis_Slide.Shapes.AddTextbox(msoTextOrientationHorizontal, 30, 110, 650, 140)\nFor Each title In titels\n    With inhaltsverzeichnis_Shape_Text.TextFrame.TextRange\n        .Font.Name = \"Arial\"\n        .Font.Size = 10\n        .Text = vbNewLine &amp; title\n    End With\nNext\nEnd Sub\n</code></pre>\n\n<p>My problem is that only the last element of the List will be displayed. it seems like other elements are overwritten. </p>\n"}, {"tags": ["vba", "email", "outlook", "ms-office", "forward"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1464188254, "post_id": 37439543, "comment_id": 62384215, "body": "What code do you have now?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6381609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eb9bf742660e3f174ab890e647b2338?s=128&d=identicon&r=PG&f=1", "display_name": "L. Bader", "link": "https://stackoverflow.com/users/6381609/l-bader"}, "edited": false, "score": 0, "creation_date": 1464345488, "post_id": 37441007, "comment_id": 62459276, "body": "Hey! Thanks for your help in advance."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1464188632, "creation_date": 1464188632, "answer_id": 37441007, "question_id": 37439543, "link": "https://stackoverflow.com/questions/37439543/forward-mail-and-add-content-to-body-outlook-2007-vba/37441007#37441007", "title": "Forward mail and add content to body (Outlook 2007, VBA)", "body": "<p>In general you will need to handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686.aspx\" rel=\"nofollow\">NewMailEx</a> event of the Application class where you can check out the Subject property and decide whether to forward the email or not. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865399.aspx\" rel=\"nofollow\">Forward</a> method of the Application class allows you doing so - it executes the Forward action for an item and returns the resulting copy as a MailItem object.</p>\n\n<p>This <code>NewMailEx</code> event fires once for every received item that is processed by Microsoft Outlook. The item can be one of several different item types, for example, MailItem, MeetingItem, or SharingItem. The EntryIDsCollection string contains the Entry ID that corresponds to that item.  You can use the Entry ID returned in the EntryIDCollection array to call the <code>NameSpace.GetItemFromID</code> method and process the item. </p>\n\n<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a>.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a>.</li>\n<li>The Word editor. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">WordEditor</a> property of the Inspector class returns an instance of the Word Document which represents the message body. So, <strong>you can use the Word object model do whatever you need with the message body</strong>. </li>\n</ol>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> for more information.</p>\n"}], "owner": {"reputation": 1, "user_id": 6381609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5eb9bf742660e3f174ab890e647b2338?s=128&d=identicon&r=PG&f=1", "display_name": "L. Bader", "link": "https://stackoverflow.com/users/6381609/l-bader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 645, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464345665, "creation_date": 1464185001, "last_edit_date": 1464345665, "question_id": 37439543, "link": "https://stackoverflow.com/questions/37439543/forward-mail-and-add-content-to-body-outlook-2007-vba", "title": "Forward mail and add content to body (Outlook 2007, VBA)", "body": "<p>Can anyone help me with editing the VBA-Code for the following Problem:\nI want to forward e-mails with a specific subject to an specific E-Mail. In this process i want to add a text to the forwarded body. \nThank's for your help!</p>\n\n<p>edit.</p>\n\n<p>I have the code now, but it doesn't work properly. It sends the last E-Mail clicked on :(.</p>\n\n<pre><code>Sub Test(oMail As MailItem)\nDim MyItem As Outlook.MailItem\nDim obj_curitem As MailItem\nDim obj_newitem\nDim obj_Selection\nDim obj_curfolder\nDim obj_msgitems\nDim Forward As Object\n\nIf Err.Number = 0 Then\n    Set obj_Selection = Outlook.ActiveExplorer.Selection\n        If obj_Selection.Count &gt; 0 Then\n\n        For Each obj_curitem In obj_Selection\n            strID = obj_curitem.EntryID\n            Set olNS = Application.GetNamespace(\"MAPI\")\n\n            'Object auf einem neuen Item erstellen\n            Set obj_newitem = obj_curitem.Forward\n            With obj_curitem.Forward\n                .Forward = True\n                .SentOnBehalfOfName = \"###\"  'Deine Mailadresse\n                .Subject = \"WG\" &amp; .Subject                      'Betreff\n                .To = \"###\"                    'Empf\u00e4ngermail\n                .BODY = \"gepr\u00fcft\" &amp; .BODY                       'E-Mail Inhalt\n                .Send\n\n            End With\n        Next\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "cmd"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464184775, "post_id": 37439163, "comment_id": 62381342, "body": "Can you use any others (such as &quot;a&quot;, or &quot;b&quot;)? Or is it just the directional sendkeys that aren&#39;t working?"}, {"owner": {"reputation": 502, "user_id": 5479813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c740fef455c455270a1046943896d49?s=128&d=identicon&r=PG&f=1", "display_name": "Rod", "link": "https://stackoverflow.com/users/5479813/rod"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464270762, "post_id": 37439163, "comment_id": 62424543, "body": "All keys work in anothers applications. Same for arrows. &quot;a&quot; &quot;b&quot;, &quot;c&quot;, ... do nothing but because the program don&#39;t use them. Here only arrows don&#39;t work."}, {"owner": {"reputation": 502, "user_id": 5479813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c740fef455c455270a1046943896d49?s=128&d=identicon&r=PG&f=1", "display_name": "Rod", "link": "https://stackoverflow.com/users/5479813/rod"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1464536563, "post_id": 37439163, "comment_id": 62517156, "body": "Someone has a solution? There is an alternative?"}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 5479813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c740fef455c455270a1046943896d49?s=128&d=identicon&r=PG&f=1", "display_name": "Rod", "link": "https://stackoverflow.com/users/5479813/rod"}, "edited": false, "score": 0, "creation_date": 1464270499, "post_id": 37439962, "comment_id": 62424341, "body": "if i don&#39;t wait, the script send keys too quickly and the cmd.exe miss some keys. How i give the focus to my Shell call ?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 502, "user_id": 5479813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c740fef455c455270a1046943896d49?s=128&d=identicon&r=PG&f=1", "display_name": "Rod", "link": "https://stackoverflow.com/users/5479813/rod"}, "edited": false, "score": 0, "creation_date": 1464270731, "post_id": 37439962, "comment_id": 62424516, "body": "@Rodrigue  Please try to include <b>both</b> the <code>Wait</code> and the <code>DoEvents</code> ...............is there any improvement ??"}, {"owner": {"reputation": 502, "user_id": 5479813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c740fef455c455270a1046943896d49?s=128&d=identicon&r=PG&f=1", "display_name": "Rod", "link": "https://stackoverflow.com/users/5479813/rod"}, "edited": false, "score": 0, "creation_date": 1464271077, "post_id": 37439962, "comment_id": 62424804, "body": "With <code>Wait</code>, and <code>DoEvents</code> ? No change. Like the program does not recognize the key."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1464186050, "creation_date": 1464186050, "answer_id": 37439962, "question_id": 37439163, "link": "https://stackoverflow.com/questions/37439163/vba-excel-sendkeys-arrow-dont-work-in-cmd-exe/37439962#37439962", "title": "VBA Excel Sendkeys ARROW don&#39;t work in cmd.exe", "body": "<p>You are trying to <code>Wait</code> one second between each SendKey.  Rather than <code>wait</code>ing, give focus to the app between SendKeys:</p>\n\n<pre><code>Private Sub press_key(key As String)\n    SendKeys key, True\n    DoEvents\nEnd Sub\n</code></pre>\n\n<p>This will improve the interface between VBA and the app.</p>\n"}], "owner": {"reputation": 502, "user_id": 5479813, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c740fef455c455270a1046943896d49?s=128&d=identicon&r=PG&f=1", "display_name": "Rod", "link": "https://stackoverflow.com/users/5479813/rod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 37439962, "answer_count": 1, "score": 1, "last_activity_date": 1464186050, "creation_date": 1464184065, "question_id": 37439163, "link": "https://stackoverflow.com/questions/37439163/vba-excel-sendkeys-arrow-dont-work-in-cmd-exe", "title": "VBA Excel Sendkeys ARROW don&#39;t work in cmd.exe", "body": "<p>i have some troubles when i will use another key than <code>\"{ENTER}\"</code>.</p>\n\n<p><code>\"{UP}\"</code>, <code>\"{DOWN}\"</code>, <code>\"{LEFT}\"</code> and <code>\"{RIGHT}\"</code> don't work in <code>cmd.exe</code>, why ?</p>\n\n<pre><code>Private Sub press_key(key As String)\n    SendKeys key, True\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\nEnd Sub\n\nSub Test()\n\nCall Shell(\"C:\\ ... \\name.EXE\", vbNormalFocus)\n\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\npress_key (\"{ENTER}\")\npress_key (\"{ENTER}\")\npress_key (\"{DOWN}\")\npress_key (\"{DOWN}\")\npress_key (\"{DOWN}\")\npress_key (\"{RIGHT}\")\npress_key (\"{DOWN}\")\npress_key (\"{DOWN}\")\npress_key (\"{DOWN}\")\npress_key (\"{ENTER}\")\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KA0k0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KA0k0.png\" alt=\"Excel launch the console\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5856375, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XmIgd1MLY1E/AAAAAAAAAAI/AAAAAAAADQ0/hGeLfhI6APs/photo.jpg?sz=128", "display_name": "yash kondaveeti", "link": "https://stackoverflow.com/users/5856375/yash-kondaveeti"}, "edited": false, "score": 0, "creation_date": 1464238385, "post_id": 37444787, "comment_id": 62404763, "body": "Thank you very much Can you please brief me exactly what above code DO&#39;s is this macro runs automatically or need any manual update where do i have to update the column reference in the code to check the last updated column."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1464200157, "creation_date": 1464200157, "answer_id": 37444787, "question_id": 37439094, "link": "https://stackoverflow.com/questions/37439094/in-excel-i-want-to-compare-particular-cells-and-take-the-highest-value-and-place/37444787#37444787", "title": "In Excel I want to compare particular cells and take the highest value and place in parent cell when particular cells updates", "body": "<p>Use the worksheet change event,</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count &gt; 1 Then Exit Sub\n    If Target.Column &lt;&gt; 1 Then Exit Sub\n    If Target.Row = 1 Then Exit Sub\n\n    Cells(Target.Row, Target.Row) = Target.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5856375, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XmIgd1MLY1E/AAAAAAAAAAI/AAAAAAAADQ0/hGeLfhI6APs/photo.jpg?sz=128", "display_name": "yash kondaveeti", "link": "https://stackoverflow.com/users/5856375/yash-kondaveeti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1464208409, "creation_date": 1464183883, "last_edit_date": 1531164843, "question_id": 37439094, "link": "https://stackoverflow.com/questions/37439094/in-excel-i-want-to-compare-particular-cells-and-take-the-highest-value-and-place", "title": "In Excel I want to compare particular cells and take the highest value and place in parent cell when particular cells updates", "body": "<p><a href=\"https://i.stack.imgur.com/qdxv5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qdxv5.png\" alt=\"Excel screenshot\"></a></p>\n\n<ol>\n<li><p>In the above image, A column is having sum values. I need help me with any formula so that in A13 I need an updated highest value.</p></li>\n<li><p>I am running an automated sequence so first it will update A12 with 90 then 90 should be updated in A13 next again may A9 updates with 101 value so that A9 value should update in A13 so it should lookup in the latest cell and updated the value and should reflects in A13 cell. Help me even if it is macro but also be noticed I am running automated sequences I cannot run the macro manually so I need help with code that runs automatically based on an cell input.</p></li>\n</ol>\n"}, {"tags": ["xml", "excel", "vba"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1464208443, "post_id": 37439087, "comment_id": 62396196, "body": "Hello Jorge, please take a look at <a href=\"https://msdn.microsoft.com/en-us/library/aa468547.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa468547.aspx</a> for a beginners guide to MSXML. You can add the reference to MSXML 5.0 in the VBA -&gt; Tools -&gt; Add reference. (Warning, some older versions of excel don&#39;t have 5.0 installed, or newer don&#39;t have 3.0 installed) Using these libraries instead might help you avoid some issues (like not being able to get the nodes you want) and learn more about xml!"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6381320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e648d03e0e4a16adeaaa737a70e475e4?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/6381320/jorge"}, "is_accepted": false, "score": 0, "last_activity_date": 1464356575, "creation_date": 1464356575, "answer_id": 37485063, "question_id": 37439087, "link": "https://stackoverflow.com/questions/37439087/vba-and-xml-how-can-i-access-certain-data-when-attribute-name-is-the-same/37485063#37485063", "title": "VBA and XML: How can I access certain data when attribute name is the same?", "body": "<p>Nevermind, I figured it out after looking at the pattern in the XML file again.  I used this code instead and now have access to all of the data I need.  Unfortunately, it is highly dependent on the attributes appearing in the same order in every XML file, but it's a start I suppose!</p>\n\n<pre><code>Set all_Vuln_Num = xmlChecklist.SelectNodes(\"//CHECKLIST/VULN/STIG_DATA[0]/ATTRIBUTE_DATA\")\nSet all_Rule_ID = xmlChecklist.SelectNodes(\"//CHECKLIST/VULN/STIG_DATA[3]/ATTRIBUTE_DATA\")\nSet vuln_Status = xmlChecklist.SelectNodes(\"//CHECKLIST/VULN/STATUS\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6381320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e648d03e0e4a16adeaaa737a70e475e4?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge", "link": "https://stackoverflow.com/users/6381320/jorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464356575, "creation_date": 1464183871, "last_edit_date": 1531164843, "question_id": 37439087, "link": "https://stackoverflow.com/questions/37439087/vba-and-xml-how-can-i-access-certain-data-when-attribute-name-is-the-same", "title": "VBA and XML: How can I access certain data when attribute name is the same?", "body": "<p>I am using excel vba to get specific attributes within an XML file (working with XML is a new adventure for me).  After looking through dozens of tutorials and blogs, I can't find anything that shows me how to get some of the attributes I need from my XML file due to the format of the XML.  </p>\n\n<p>This is the basic format of the XML file:</p>\n\n<pre><code>&lt;CHECKLIST&gt;\n    &lt;STIG_INFO&gt;\n        &lt;STIG_TITLE&gt;Active Directory Domain Security Technical Implementation Guide (STIG)&lt;/STIG_TITLE&gt;\n    &lt;/STIG_INFO&gt;\n    &lt;VULN&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Vuln_Num&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;V-8521&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Severity&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;low&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Group_Title&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;Object Ownership Delegation&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Rule_ID&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;SV-9018r3_rule&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n    &lt;STATUS&gt;NotAFinding&lt;/STATUS&gt;\n     &lt;/VULN&gt;\n     &lt;VULN&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Vuln_Num&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;V-8522&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Severity&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;medium&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Group_Title&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;Directory Service Inter-Enclave VPN Usage&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n        &lt;STIG_DATA&gt;\n            &lt;VULN_ATTRIBUTE&gt;Rule_ID&lt;/VULN_ATTRIBUTE&gt;\n            &lt;ATTRIBUTE_DATA&gt;SV-30991r3_rule&lt;/ATTRIBUTE_DATA&gt;\n        &lt;/STIG_DATA&gt;\n    &lt;STATUS&gt;NotAFinding&lt;/STATUS&gt;\n     &lt;/VULN&gt;\n&lt;/CHECKLIST&gt;\n</code></pre>\n\n<p>I am trying to access all of the Vulnerability Number, the Rule ID, and the Status values.  So far I have only been successful in getting the Status values using the code below, but I can't seem to figure out how to get to the Vunerability Number and Rule ID.  For example, my all_Vuln_Num returns every ATTRIBUTE_DATA in the XML file.  My all_Rule_ID returns nothing.</p>\n\n<pre><code>Dim filename As String\nfilename = \"C:\\myfile.xml\"\nSet xmlChecklist = CreateObject(\"Microsoft.XMLDOM\")\nxmlChecklist.async = False\nxmlChecklist.validateOnParse = False\nxmlChecklist.Load (filename)\nSet all_Vuln_Num = xmlChecklist.SelectNodes(\"//CHECKLIST/VULN/STIG_DATA/ATTRIBUTE_DATA[0]/text()\")\nSet all_Rule_ID = xmlChecklist.SelectNodes(\"//CHECKLIST/VULN/STIG_DATA/ATTRIBUTE_DATA[3]/text()\")\nSet vuln_Status = xmlChecklist.SelectNodes(\"//CHECKLIST/VULN/STATUS/text()\")\n</code></pre>\n"}, {"tags": ["vba", "command", "ms-access-2013"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1464184381, "post_id": 37439053, "comment_id": 62381014, "body": "Likely a datatyping error, why are the references to <code>Me.TxtId</code> and <code>Me.TxtId.Tag</code> not encapsulated with single quotes?  Are these fields not returning strings, like textboxes usually do?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1464184500, "post_id": 37439053, "comment_id": 62381117, "body": "Bracket field names which include any characters other than letters, digits, and underscore (<code>_</code>): <code>[Cellphone&#47;Telephone]</code> and <code>[Address (Fisical)]</code>  In other words, do those field names for the <code>UPDATE</code> as you did them for the <code>INSERT</code>."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1464184705, "post_id": 37439053, "comment_id": 62381285, "body": "Consider switching to parameter queries instead of concatenating values into SQL statement text."}, {"owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "edited": false, "score": 0, "creation_date": 1464186600, "post_id": 37439053, "comment_id": 62382861, "body": "I did tried encapsulating me.txtID and me.txtId.Tag but it gave me an error when compiling it, something like statement expected, already bracket the fields but it does the same, same syntax error, and Im having trouble changing the values into SQL statement text :S....pretty confused, I know SQL but Im not that experienced with it"}], "answers": [{"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1464188713, "creation_date": 1464188713, "answer_id": 37441040, "question_id": 37439053, "link": "https://stackoverflow.com/questions/37439053/add-update-button-syntax-error/37441040#37441040", "title": "ADD/UPDATE BUTTON syntax error", "body": "<p>Looks close, think of it this way because i know it frustrates me when it happens. If the error says syntax error, its not lying, and more often than not for me it was not being able to see the wood for the trees. You're missing a few spaces:-</p>\n\n<pre><code>CurrentDb.Execute \"UPDATE [tblClients]\" &amp; _\n\" SET [ClientID] =\" &amp; Me.txtID &amp; _\n\", [ClientName]='\" &amp; Me.txtName &amp; \"'\" &amp; _\n\", [Gender]='\" &amp; Me.cboGender &amp; \"'\" &amp; _\n\", [City]='\" &amp; Me.cboCity &amp; \"'\" &amp; _\n\", [Cellphone/Telephone]='\" &amp; Me.txtCellphone &amp; \"'\" &amp; _\n\", [Address (Fisical)] ='\" &amp; Me.txtAddress &amp; \"'\" &amp; _\n\" WHERE [ClientID] =\" &amp; Me.txtID.Tag\n</code></pre>\n\n<ul>\n<li>Space before <code>SET ClientID...</code></li>\n<li>Space before <code>WHERE ClientID</code></li>\n<li>Bracket column and table names</li>\n</ul>\n\n<p>Also a trick I learned for this: -</p>\n\n<ol>\n<li>Open a new query and view the SQL</li>\n<li>Paste the string that would have been executed into it</li>\n<li>Run it</li>\n</ol>\n\n<p>You get more info on where the issue is.</p>\n"}], "owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 37441040, "answer_count": 1, "score": 0, "last_activity_date": 1464188713, "creation_date": 1464183806, "question_id": 37439053, "link": "https://stackoverflow.com/questions/37439053/add-update-button-syntax-error", "title": "ADD/UPDATE BUTTON syntax error", "body": "<p>Im currently coding my Add/Update button in MS Access 2013 but for some odd reason im having trouble trying to make it work all it tells me is that I have a 'syntax error on the UPDATE statement'... here is my code overall:</p>\n\n<pre><code>    Private Sub cmdAdd_Click()\n    'In the button add we have two options\n    '1. Insert\n    '2. Update\n    If Me.txtID.Tag &amp; \"\" = \"\" Then\n\n    CurrentDb.Execute \"INSERT INTO tblClients ( ClientID, ClientName, Gender, \" &amp; _\n                             \"City, [Address (Fisical)], [Cellphone/Telephone] ) \" &amp; _\n                                \"SELECT \" &amp; Me.txtID &amp; \",'\" &amp; Me.txtName &amp; \"','\" &amp; Me.cboGender &amp; \"', '\" &amp; Me.cboCity &amp; \"','\" &amp; Me.txtAddress &amp; \"','\" &amp; Me.txtCellphone &amp; \"'\"\n    Else\n    'Otherwise the data will be updated\n    CurrentDb.Execute \"UPDATE tblClients\" &amp; _\n    \"SET ClientID =\" &amp; Me.txtID &amp; _\n    \", ClientName='\" &amp; Me.txtName &amp; \"'\" &amp; _\n    \", Gender='\" &amp; Me.cboGender &amp; \"'\" &amp; _\n    \", City='\" &amp; Me.cboCity &amp; \"'\" &amp; _\n    \", Cellphone/Telephone='\" &amp; Me.txtCellphone &amp; \"'\" &amp; _\n    \", Address (Fisical) ='\" &amp; Me.txtAddress &amp; \"'\" &amp; _\n    \"WHERE ClientID =\" &amp; Me.txtID.Tag\n\n\n    End If\n\n\n   cmdClear_Click\n\n   tblClients_subform.Form.Requery\n\n\n   End Sub\n</code></pre>\n\n<p>please help needed</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1464190535, "post_id": 37439045, "comment_id": 62385946, "body": "Multi Select is set to None"}], "answers": [{"tags": [], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1470671913, "creation_date": 1470671913, "answer_id": 38833725, "question_id": 37439045, "link": "https://stackoverflow.com/questions/37439045/create-function-to-get-value-from-listboxes/38833725#38833725", "title": "Create function to get value from listboxes", "body": "<p>In order to get the selected item for a listbox, you can use this code here. I have an event called invoiceButton_Click which triggers the code to find the selected item in the list box and do something with it. I have taken out my code but left what's necessary. </p>\n\n<pre><code>'Moves selected item from items listbox to invoice listbox\nPrivate Sub invoiceButton_Click()\n\nDim rowIndex As Integer, pos1 As Integer, i As Integer, rowValue As String, str As String, strSQL As String\nDim strToCut As String, tempStr As String, JobLinkCode As String, val As String\n\n' ListBox row index clicked\nrowIndex = Me.lbItems.ListIndex\n\n'Checks if an item in the listbox is selected. If nothing is selected, end the program. If something is selected, Do Something.\n'The .Column(0) is telling my code to use the first column of the listbox since they can contain multiple values.\nIf IsNull(Me.lbItems.Column(0)) Then\n    End\nElse\n\n    'Do Something\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Also, you don't have to pass a listbox into a function/sub. You can access that control anywhere on that form, therefore it is not necessary to pass it in as a parameter. Just use Me.[listbox name].[function you want to use] to access it.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1470671913, "creation_date": 1464183786, "last_edit_date": 1464187970, "question_id": 37439045, "link": "https://stackoverflow.com/questions/37439045/create-function-to-get-value-from-listboxes", "title": "Create function to get value from listboxes", "body": "<p>Access 2010, Windows 7\nHave a form that has several list boxes with dropdowns. Trying to create a function that will return the value in a row selected in a list box. Here is the code I have;</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Public Function listboxSel(listName As Control) As Integer\n  Dim rowIndex As Integer\n  Dim rowValue As String\n  Dim rowIsSelected As Integer\n  Dim result As String\n\n  ' ListBox row index clicked\n  rowIndex = Me.xxxxx.ListIndex\n\n  ' Row value clicked\n  rowValue = Me.xxxxx.Column(0)\n  rowIsSelected = Me.xxxxx.Selected(rowIndex)\n  listboxSel = rowValue\n  End Function\n</code></pre>\n\n<p>First, I don't know how to pass the name of a listbox to the function.\nSecond, I don't think <code>listName As Control</code> is correct.  I've been trying bits of code I found on the web to no avail.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 11, "user_id": 6381350, "user_type": "registered", "profile_image": "https://graph.facebook.com/770699399733928/picture?type=large", "display_name": "Teddy Rogers", "link": "https://stackoverflow.com/users/6381350/teddy-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464188572, "creation_date": 1464183161, "last_edit_date": 1464188572, "question_id": 37438799, "link": "https://stackoverflow.com/questions/37438799/vba-find-and-write-functions", "title": "VBA find and write functions", "body": "<p>The problem I am trying to solve is I am looking to write a function to find a text string in a different workbook than I am writing to. The goal is to find the text in document A (not the source of the code. Just the database of the information), write an <code>\"P\"</code> in a box under that correlates with the text in the active sheet, document B. Right now I just want to search document A and write the <code>\"P\"</code> to a defined cell in document B.</p>\n\n<p>Note: I left out a few of the other functions to try and simplify what I am posting \nNote: The code doesn't show up perfectly on here. I am very new to posting. Sorry for the inconvenience. </p>\n\n<p>My code is adapted from: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff839746.aspx</a></p>\n\n<p>My code so far:</p>\n\n<pre><code> Sub CommandButton1_Click()\n    Dim dataBase As Workbook\n    Dim Config As String\n\n    'This makes it so the database will not visibly open\n    Application.ScreenUpdating = False\n\n\n    'this saves the full path name as well as the file name for the Route Chart template/open file\n    NegsFilePath = Application.ActiveWorkbook.FullName\n\n    'the getFile function opens up a file explorer in order to select the database. the line\n    'below the call for that is the location of it on my computer, and simply there for testing\n    'purposes\n    Config = GetFile(\"Select the Config file\")\n    'Config = \"C:\\Users\\Z003CPYE\\Desktop\\CP256_M1_Rev2.0.xlsm\"\n\n    'this is where we call to the functions that actually grab the data.\n    Application.StatusBar = \"Importing Data...\"\n    Call WriteInputs(Config)\n    Call FindRoutes(Config)\n    Call FindAddress(Config)\n\n    'I do not really know why this is done, but everything I read online said to do this\n    'if you set it to false.\n    Application.ScreenUpdating = True\nEnd Sub\n\nFunction GetFile(prompt As String) As String\n    Dim fNameAndPath As Variant\n\n    'This opens the file browser, and filters it for .xlsx and .xlsm files only.\n    'NOTE: it recieves prompt when called as an argument, and returns the string\n    'of the file that is selected's path.\n    fNameAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.XLSX;*.XLSM), *.XLSX;*.XLSM\", Title:=prompt)\n\n    'This is from the function Ifsafd saw online, I believe it is for the exit/close\n    'and cancel button being clicked\n    If fNameAndPath = False Then\n    Call stopAllMacros\n    End If\n\n    GetFile = fNameAndPath\n\nEnd Function\n\nSub stopAllMacros()\n    Application.ScreenUpdating = True\n    End\nEnd Sub\n\nSub FindAddress(Config As String)\n    Dim NegativesPath As Workbook\n    Dim cfg As Workbook\n    Dim GCell As Range\n    Dim Page$, Txt$, MyPath$, MyWB$, MySheet$\n\n\n    Set NegativesPath = ActiveWorkbook\n    Set cfg = Workbooks.Open(Config)\n\n    'The text for which to search.\n    Txt = \"1E Sig\"\n    'The path to the workbook in which to search.\n    MyPath = \"C:\\Users\\z003njcy\\Desktop\\\"\n    'The name of the workbook in which to search.\n    MyWB = \"CP256_M1_Rev2.0.xlsm\"\n\n    'If an error occurs, use the error handling routine at the end of this file.\n    On Error GoTo ErrorHandler\n\n    'Turn off screen updating, and then open the target workbook.\n    Application.ScreenUpdating = False\n\n\n    'Search for the specified text in master file\n    Set GCell = cfg.Worksheets(\"Location Input\").Cells.Find(Txt)\n\n    'Record the address of the data, along with the date, in sheet5 B4.\n    With Project.Worksheets.Range(\"B4\")\n        .Value = Txt\n        .Offset(0, 1).Value = \"P\"\n        .Columns.AutoFit\n        .Offset(1, 1).Columns.AutoFit\n    End With\n\n    'Close the data workbook, without saving any changes, and turn screen updating back on.\n    ActiveWorkbook.Close savechanges:=False\n    Application.ScreenUpdating = True\n    Exit Sub\n\n    'Error Handling section.\nErrorHandler:\n    Select Case Err.Number\n    'Common error #1: file path or workbook name is wrong.\n    Case 1004\n    Range(\"D10:E11\").ClearContents\n    Application.ScreenUpdating = True\n    MsgBox \"The workbook \" &amp; MyWB &amp; \" could not be found in the path\" &amp; vbCrLf &amp; MyPath &amp; \".\"\n\n\n    Exit Sub\n\n    'Common error #2: the specified text wasn't in the target workbook.\n    Case 9, 91\n    ThisWorkbook.Sheets(MySheet).Range(\"D10:E11\").ClearContents\n    Workbooks(MyWB).Close False\n    Application.ScreenUpdating = True\n    MsgBox \"The value \" &amp; Txt &amp; \" was not found.\"\n    Exit Sub\n\n    'General case: turn screenupdating back on, and exit.\n    Case Else\n    Application.ScreenUpdating = True\n    Exit Sub\n    End Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 1, "creation_date": 1464181620, "post_id": 37438104, "comment_id": 62378845, "body": "Show us what you tried so that we can help."}, {"owner": {"reputation": 1833, "user_id": 748133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2a6588c1ba88e39283d0b4b9e28884dc?s=128&d=identicon&r=PG", "display_name": "Guy Lowe", "link": "https://stackoverflow.com/users/748133/guy-lowe"}, "edited": false, "score": 0, "creation_date": 1464181998, "post_id": 37438104, "comment_id": 62379140, "body": "Of course you will. When are they supposed to end?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2299169"}, "reply_to_user": {"reputation": 1833, "user_id": 748133, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2a6588c1ba88e39283d0b4b9e28884dc?s=128&d=identicon&r=PG", "display_name": "Guy Lowe", "link": "https://stackoverflow.com/users/748133/guy-lowe"}, "edited": false, "score": 1, "creation_date": 1464182444, "post_id": 37438104, "comment_id": 62379504, "body": "You never change &quot;ENumber&quot; so if the expression evaluates false, in other words, you enter the loop, it will always do evaluate false == eternal loop. I assume this is what @GuyLowe meant :)"}, {"owner": {"reputation": 75, "user_id": 6318844, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33f5859b5adf53691e67e63b9e7644aa?s=128&d=identicon&r=PG&f=1", "display_name": "Lvassilopoulos", "link": "https://stackoverflow.com/users/6318844/lvassilopoulos"}, "edited": false, "score": 0, "creation_date": 1464182473, "post_id": 37438104, "comment_id": 62379528, "body": "I am new to VBA so I am sorry. This is the first loop I have written. I state when the first array is to stop when the element is equal to Enumber - 1. Can you explicitly write the code. I am new and I have stuck here for a long time"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2299169"}, "edited": false, "score": 0, "creation_date": 1464182699, "post_id": 37438104, "comment_id": 62379697, "body": "@Lvassilopoulos In &quot;Do...Loop&quot; cycles you set a boolean expression. This means if you add &quot;Do Until False&quot; it will be an eternal loop, as well as &quot;Do Until True&quot; will never enter the loop. So as long as &quot;Do Until IndexofE1(ENumber * (ENumber - 1) / 2) = Enumber - 1&quot; evaluates false, the cycle will not end and as you do not alter &quot;ENumber&quot; in your loop, it will. You also have a typo (&quot;ENumber&quot; vs &quot;Enumber&quot;) so add &quot;Option Explicit&quot; as the very first line of the code and fix any errors afterwards"}, {"owner": {"reputation": 75, "user_id": 6318844, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33f5859b5adf53691e67e63b9e7644aa?s=128&d=identicon&r=PG&f=1", "display_name": "Lvassilopoulos", "link": "https://stackoverflow.com/users/6318844/lvassilopoulos"}, "edited": false, "score": 0, "creation_date": 1464184075, "post_id": 37438104, "comment_id": 62380774, "body": "Thank you Mark but I do not understand since I am new to programming."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2299169"}, "edited": false, "score": 0, "creation_date": 1464184335, "post_id": 37438104, "comment_id": 62380979, "body": "Okay :D See answers below then. I&#39;d recommend at least trying though. If you don&#39;t understand whys and hows and not willing to learn, you&#39;ll bump into an issue every two seconds and won&#39;t have an idea how to solve them. No offense, just saying. Good luck"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 6318844, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33f5859b5adf53691e67e63b9e7644aa?s=128&d=identicon&r=PG&f=1", "display_name": "Lvassilopoulos", "link": "https://stackoverflow.com/users/6318844/lvassilopoulos"}, "edited": false, "score": 0, "creation_date": 1464183567, "post_id": 37438878, "comment_id": 62380368, "body": "Unfortunately I need it in array form only. but thanks"}], "tags": [], "owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "is_accepted": false, "score": 0, "last_activity_date": 1464184991, "last_edit_date": 1464184991, "creation_date": 1464183330, "answer_id": 37438878, "question_id": 37438104, "link": "https://stackoverflow.com/questions/37438104/2-arrays-increasing-in-a-specific-way/37438878#37438878", "title": "2 arrays increasing in a specific way", "body": "<p>How about</p>\n\n<pre><code>Dim int1 As Integer, int2 As Integer, intMax As Integer, intRes() As Integer, intIndex As Integer\n\nintMax = 4\nReDim intRes(1 To intMax * (intMax - 1) / 2, 1 To 2)\n\nDo\n    int1 = int1 + 1\n    If int1 = intMax Then\n        Exit Do\n    End If\n    For int2 = int1 + 1 To intMax\n        intIndex = intIndex + 1\n        intRes(intIndex, 1) = int1\n        intRes(intIndex, 2) = int2\n\n\n    Next\nLoop\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2299169"}, "edited": false, "score": 0, "creation_date": 1464184210, "post_id": 37439199, "comment_id": 62380879, "body": "nice method name Scott :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464184258, "post_id": 37439199, "comment_id": 62380919, "body": "@Mark the fingers will do what the fingers will do."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464185032, "post_id": 37439199, "comment_id": 62381527, "body": "but this way the <code>IndexofE2</code> will be the same as <code>IndexofE1</code>. I didn&#39;t get this was OP&#39;s request"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464185446, "post_id": 37439199, "comment_id": 62381876, "body": "@user3598756 yup mistyped. Fixed now."}, {"owner": {"reputation": 75, "user_id": 6318844, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33f5859b5adf53691e67e63b9e7644aa?s=128&d=identicon&r=PG&f=1", "display_name": "Lvassilopoulos", "link": "https://stackoverflow.com/users/6318844/lvassilopoulos"}, "edited": false, "score": 0, "creation_date": 1464193748, "post_id": 37439199, "comment_id": 62388147, "body": "Thank you Scott. This is the answer I understand and this is what I chose to use"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 75, "user_id": 6318844, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33f5859b5adf53691e67e63b9e7644aa?s=128&d=identicon&r=PG&f=1", "display_name": "Lvassilopoulos", "link": "https://stackoverflow.com/users/6318844/lvassilopoulos"}, "edited": false, "score": 0, "creation_date": 1464194475, "post_id": 37439199, "comment_id": 62388581, "body": "@Lvassilopoulos then please mark as correct by clicking check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1464185410, "last_edit_date": 1464185410, "creation_date": 1464184143, "answer_id": 37439199, "question_id": 37438104, "link": "https://stackoverflow.com/questions/37438104/2-arrays-increasing-in-a-specific-way/37439199#37439199", "title": "2 arrays increasing in a specific way", "body": "<p>This will do it.  I made one two dimensional array instead of 2 one dimensional arrays.</p>\n\n<pre><code>Sub khkljhlkjh()\nDim ENumber As Variant\nENumber = Worksheets(\"Inter\").Range(\"B1\")\nDim IndexofE1\nDim i&amp;, j&amp;\n\nDim m As Long\n\nReDim IndexofE1(1 To ENumber * (ENumber - 1) / 2, 1 To 2) As Variant\n\nm = 1\nFor i = 1 To ENumber - 1\n    For j = i + 1 To ENumber\n        IndexofE1(m, 1) = i\n        IndexofE1(m, 2) = j\n        m = m + 1g\n    Next j\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>If you want the two arrays the:</p>\n\n<pre><code>Sub khkljhlkjh()\nDim ENumber As Variant\nENumber = Worksheets(\"Inter\").Range(\"B1\")\nDim IndexofE1\nDim IndexofE2\nDim i&amp;, j&amp;\n\nDim m As Long\n\nReDim IndexofE1(1 To ENumber * (ENumber - 1) / 2) As Variant\nReDim IndexofE2(1 To ENumber * (ENumber - 1) / 2) As Variant\nm = 1\nFor i = 1 To ENumber - 1\n    For j = i + 1 To ENumber\n        IndexofE1(m) = i\n        IndexofE2(m) = j\n        m = m + 1\n    Next j\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Now neither of these do anything with the arrays as your snippet does not show what you want to do with them.  You will need to output the arrays to something so you can see the values.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1464189419, "last_edit_date": 1464189419, "creation_date": 1464184854, "answer_id": 37439478, "question_id": 37438104, "link": "https://stackoverflow.com/questions/37438104/2-arrays-increasing-in-a-specific-way/37439478#37439478", "title": "2 arrays increasing in a specific way", "body": "<p>two proposals</p>\n\n<p>a)\nthis will output two arrays with numbers you shown, although last array position is not used</p>\n\n<pre><code>Option Explicit\nSub main()\n    Dim ENumber As Long, currVal1 As Long, i As Long, index As Long\n    Dim array1 As Variant, array2 As Variant\n\n    ENumber = Worksheets(\"Inter\").Range(\"B1\")\n    ReDim IndexofE1(ENumber * (ENumber - 1) / 2) As Variant\n    ReDim IndexofE2(ENumber * (ENumber - 1) / 2) As Variant\n\n    currVal1 = 1\n    index = 0\n    Do While currVal1 &lt;= ENumber - 1\n        For i = currVal1 + 1 To ENumber\n            IndexofE1(index) = currVal1\n            IndexofE2(index) = i\n            index = index + 1\n        Next i\n        currVal1 = currVal1 + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>b)\nthis will output two variant arrays with no dimming issues</p>\n\n<pre><code>Option Explicit\n\nSub main2()\n    Dim ENumber As Long\n    Dim array1 As Variant, array2 As Variant\n\n    ENumber = Worksheets(\"Inter\").Range(\"B1\")\n\n    getArrays ENumber, array1, array2\n\nEnd Sub\n\nSub getArrays(ENumber As Long, array1 As Variant, array2 As Variant)\n    Dim currVal1 As Long, i As Long\n    Dim strng1 As String, strng2 As String\n\n    currVal1 = 1\n    Do While currVal1 &lt;= ENumber - 1\n        For i = currVal1 + 1 To ENumber\n            strng1 = strng1 &amp; currVal1 &amp; \" \"\n            strng2 = strng2 &amp; i &amp; \" \"\n        Next i\n        currVal1 = currVal1 + 1\n    Loop\n\n    array1 = Split(Left(strng1, Len(strng1) - 1))\n    array2 = Split(Left(strng2, Len(strng2) - 1))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6318844, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/33f5859b5adf53691e67e63b9e7644aa?s=128&d=identicon&r=PG&f=1", "display_name": "Lvassilopoulos", "link": "https://stackoverflow.com/users/6318844/lvassilopoulos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 37439199, "answer_count": 3, "score": 0, "last_activity_date": 1464189419, "creation_date": 1464181547, "last_edit_date": 1464181915, "question_id": 37438104, "link": "https://stackoverflow.com/questions/37438104/2-arrays-increasing-in-a-specific-way", "title": "2 arrays increasing in a specific way", "body": "<p>I need two arrays in VBA language thay will create the following values</p>\n\n<pre><code>1  2\n1  3\n1  4\n2  3\n2  4\n3  4\n</code></pre>\n\n<p>so when 4 is reached in the second array, the next element of array 1 is what it was plus 1 and the next element of array 2 is the next element of array 1 + 1. I  have tried do until loops but I get infinite calculations.</p>\n\n<p>I tried the following but I get infinite calculations</p>\n\n<p>Dim ENumber As Variant\n    ENumber = Worksheets(\"Inter\").Range(\"B1\")</p>\n\n<pre><code>Dim FirstLoop As Boolean\n\nDim m As Variant\n\nReDim IndexofE1(ENumber * (ENumber - 1) / 2) As Variant\nReDim IndexofE2(ENumber * (ENumber - 1) / 2) As Variant\n\nIndexofE1(0) = 1\n\nFirstLoop = True\n\nDo Until IndexofE1(ENumber * (ENumber - 1) / 2) = Enumber - 1\n\n    If IndexofEl2(m) &lt;&gt; ENumber Then\n\n        If FirstLoop = False Then\n            IndexofE1(m + 1) = IndexofE1(m)\n            IndexofE2(m + 1) = IndexofE1(m) + 1\n        End If\n\n        If FirstLoop = True Then IndexofE2(m + 1) = IndexofE1(m) + 1\n\n    Else\n        IndexofE1(m + 1) = IndexofE1(m) + 1\n        IndexofE2(m + 1) = IndexofE1(m + 1) + 1\n    End If\n\n    FirstLoop = False\n\nLoop\n</code></pre>\n"}, {"tags": ["sql", "vba", "sql-server-2008", "ms-access", "sql-server-2008-r2"], "comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1464179052, "post_id": 37437016, "comment_id": 62376704, "body": "The <code>HAVING</code> clause is intended for aggregate function conditions. Perhaps you should have a derived table (or cte)?"}, {"owner": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "reply_to_user": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1464179148, "post_id": 37437016, "comment_id": 62376775, "body": "Table changes are out of my control, unfortunately."}, {"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 1, "creation_date": 1464179435, "post_id": 37437016, "comment_id": 62376996, "body": "A derived table is simply a subquery with an alias."}, {"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 1, "creation_date": 1464179437, "post_id": 37437016, "comment_id": 62376998, "body": "Derived tables and cte&#39;s are SQL constructions, used to simplify queries."}, {"owner": {"reputation": 13129, "user_id": 1587819, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TpBdj.jpg?s=128&g=1", "display_name": "HoneyBadger", "link": "https://stackoverflow.com/users/1587819/honeybadger"}, "edited": false, "score": 1, "creation_date": 1464179477, "post_id": 37437016, "comment_id": 62377028, "body": "If <code>Rep_date</code> is of <code>date(time(2))</code> datatype, why not simply use <code>where MONTH(Rep_date) = 5 AND YEAR(Rep_date) = 2016</code>?"}, {"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1464179593, "post_id": 37437016, "comment_id": 62377117, "body": "Filtering on function results is usually slow."}], "answers": [{"tags": [], "owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1464179383, "creation_date": 1464179383, "answer_id": 37437192, "question_id": 37437016, "link": "https://stackoverflow.com/questions/37437016/rightconvert-part-of-varchar-103-to-120-datetime-to-display-results-as-120/37437192#37437192", "title": "(RIGHT(CONVERT part of varchar 103 to 120 DATETIME to display results as 120", "body": "<p>Step 1 - Create 2 variables, named startDate and endDate with your vba code.  Make startDate the 1st day of the year-month in question and endDate the first day of the following month.</p>\n\n<p>Step 2 - Use these variables as query parameters for sql having this logic:</p>\n\n<pre><code>where rep_date &gt;= startDate\nand rep_date &lt; endDate\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "is_accepted": true, "score": 0, "last_activity_date": 1464339386, "creation_date": 1464339386, "answer_id": 37479134, "question_id": 37437016, "link": "https://stackoverflow.com/questions/37437016/rightconvert-part-of-varchar-103-to-120-datetime-to-display-results-as-120/37479134#37479134", "title": "(RIGHT(CONVERT part of varchar 103 to 120 DATETIME to display results as 120", "body": "<p>I have answered my own question after coming back to it a few days later with a fresh head.. </p>\n\n<p>Since the Rep_date is a text field rather than a date field, I don't need any date conversions on it.</p>\n\n<pre><code>HAVING LEFT(Rep_date, 7) = '2016-05' \n</code></pre>\n\n<p>Works just fine. </p>\n"}], "owner": {"reputation": 13, "user_id": 6291844, "user_type": "registered", "profile_image": "https://graph.facebook.com/538641909642295/picture?type=large", "display_name": "Daniel Jones", "link": "https://stackoverflow.com/users/6291844/daniel-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 37479134, "answer_count": 2, "score": 0, "last_activity_date": 1594651422, "creation_date": 1464178971, "last_edit_date": 1594651422, "question_id": 37437016, "link": "https://stackoverflow.com/questions/37437016/rightconvert-part-of-varchar-103-to-120-datetime-to-display-results-as-120", "title": "(RIGHT(CONVERT part of varchar 103 to 120 DATETIME to display results as 120", "body": "<p>I have the below query bringing out all of the correct results I need for any specific date. However, my client would like to be able to search by any single month at a time, avoiding selecting each day of the month individually. I assumed I would be able to convert a portion of the date (month+year), convert it to another format, and then use that. Currently displaying as 05/2016 (103), but I need to be able to search as 2016-05% (120) for results to appear.\nThe code is to be placed inside an Access VBA form.</p>\n\n<pre><code>SELECT \n    os.shop, os.prefix, \n    Rep_date AS FDate, \n    SUM(RC) AS Fulfilled, \n    SUM(RF) AS Refunded, \n    SUM(OS) AS TotalOS, \n    SUM(CA) AS TotalCA, \n    SUM(RET) AS TotalRET, \n    SUM(LOST) AS TotalLOST, \n    SUM(SHOR) AS TotalSHOR, \n    SUM(Total) AS Total, \n    CAST((CAST(SUM(RC) AS DECIMAL(9, 4)) / CAST(SUM(Total) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS RCPC, \n    CAST((CAST(SUM(RF) AS DECIMAL(9, 4)) / CAST(SUM(Total) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS RFPC, \n    CAST((CAST(SUM(OS) AS DECIMAL(9, 4)) / CAST(SUM(Total) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS OSPC, \n    CAST((CAST(SUM(CA) AS DECIMAL(9, 4)) / CAST(SUM(Total) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS CAPC, \n    CAST((CAST(SUM(RET) AS DECIMAL(9, 4)) / CAST(SUM(Total) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS RETPC, \n    CAST((CAST(SUM(LOST) AS DECIMAL(9, 4)) / CAST(SUM(Total) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS LOSTPC, \n    CAST((CAST(SUM(SHOR) AS DECIMAL(9, 4)) / CAST(SUM(Total) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS SHORPC, \n    SUM(Orders) AS TotalOrders, \n    SUM(AmazonShipped) AS AmazonShipped, \n    SUM(AmazonCancelled) AS AmazonCancelled, \n    SUM(AmazonUnshipped) AS AmazonUnshipped, \n    CAST((CAST(SUM(AmazonShipped) AS DECIMAL(9, 4)) / CAST(SUM(Orders) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS AmazonShippedPC, \n    CAST((CAST(SUM(AmazonCancelled) AS DECIMAL(9, 4)) / CAST(SUM(Orders) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS AmazonCancelledPC, \n    CAST((CAST(SUM(AmazonUnshipped) AS DECIMAL(9, 4)) / CAST(SUM(Orders) AS DECIMAL(9, 4))) AS DECIMAL(9, 4)) AS AmazonUnshippedPC, \n    p.Description \nFROM \n    OrderStatusSummary os \nLEFT JOIN \n    Prefix p ON os.prefix = p.prefix \nGROUP BY \n    Rep_date, os.shop, os.prefix, p.Description \nHAVING \n   (CAST(CONVERT(nvarchar(10), Rep_date, 120) AS DATETIME) = CONVERT(DATETIME, '25/05/2016', 103)) \nORDER BY \n    CAST(CONVERT(nvarchar(10), Rep_date, 120) AS DATETIME) DESC\n</code></pre>\n\n<p>The above is working as a means of searching by a full date, the below is what I have tried to use to search by month/year only, to show you kind of what i'm trying to achieve. It is however not working.</p>\n\n<pre><code>HAVING (RIGHT(CONVERT(nvarchar(10), Rep_date, 103),7) = '05/2016') \n</code></pre>\n\n<p>The only part of code I have changed is the HAVING compared to the top block.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "is_accepted": false, "score": 0, "last_activity_date": 1464186598, "creation_date": 1464186598, "answer_id": 37440200, "question_id": 37436878, "link": "https://stackoverflow.com/questions/37436878/shared-mailbox-management/37440200#37440200", "title": "Shared Mailbox Management", "body": "<p>This works, I used a case to move the item if it came from a specific email address:</p>\n\n<pre><code>Dim i As Long\nPrivate WithEvents olInboxItems As Items\n\nPrivate Sub Application_Startup()\n  Dim objNS As NameSpace\n  Set objNS = Application.Session\n  Set olInboxItems = GetFolderPath(\"&gt;Digital Analytics\\Inbox\").Items\nSet objNS = Nothing\n\n    For Each Item In olInboxItems\n\nEnd Sub\n\nPrivate Sub olInboxItems_ItemAdd(ByVal Item As Object)\n\n    Dim objDestFolder As Outlook.MAPIFolder\n    Dim destFolder As String\n    Dim sendersAddress As String\n\n    If Item.Class = olMail Then\n\n        sendersAddress = Item.SenderEmailAddress\n\n        Select Case sendersAddress\n            Case \"no-reply@omniture.com\"\n                destFolder = \"&gt;Digital Analytics\\Inbox\\Reports\"\n            Case \"no-reply@edigitalresearch.com\"\n                destFolder = \"&gt;Digital Analytics\\Inbox\\Reports\"\n        End Select\n\nSet objDestFolder = GetFolderPath(destFolder)\n    Item.Move objDestFolder\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 5873603, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/04161459f78c5e179c23d0bb8d006511?s=128&d=identicon&r=PG&f=1", "display_name": "megatron77", "link": "https://stackoverflow.com/users/5873603/megatron77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464186598, "creation_date": 1464178679, "last_edit_date": 1464180511, "question_id": 37436878, "link": "https://stackoverflow.com/questions/37436878/shared-mailbox-management", "title": "Shared Mailbox Management", "body": "<p>I need a macro that will move messages received into a shared mailbox to a subfolder of that mailbox, depending on the sender's email address, basically a normal outlook rule.</p>\n\n<p>I've been looking at some articles on <a href=\"http://www.slipstick.com/\" rel=\"nofollow\">http://www.slipstick.com/</a> which has got me part way there but there isn't an exact solution for what I want to do and I'm not proficient enough with VBA in Outlook yet to work it out.</p>\n\n<p>So far I've got this code on ThisOutlookSession to watch the mailbox:</p>\n\n<pre><code>Dim i As Long\nPrivate WithEvents olInboxItems As Items\n\nPrivate Sub Application_Startup()\n  Dim objNS As NameSpace\n  Set objNS = Application.Session\n  Set olInboxItems = GetFolderPath(\"&gt;Digital Analytics\\Inbox\").Items\nSet objNS = Nothing\nEnd Sub\n</code></pre>\n\n<p>And this function in a module to obtain the path of the watched mailbox folder:</p>\n\n<pre><code>' Use the GetFolderPath function to find a folder in non-default mailboxes\nFunction GetFolderPath(ByVal FolderPath As String) As Outlook.Folder\n    Dim oFolder As Outlook.Folder\n    Dim FoldersArray As Variant\n    Dim i As Integer\n\n    On Error GoTo GetFolderPath_Error\n    If Left(FolderPath, 2) = \"\\\\\" Then\n        FolderPath = Right(FolderPath, Len(FolderPath) - 2)\n    End If\n    'Convert folderpath to array\n    FoldersArray = Split(FolderPath, \"\\\")\n    Set oFolder = Application.Session.Folders.Item(FoldersArray(0))\n    If Not oFolder Is Nothing Then\n        For i = 1 To UBound(FoldersArray, 1)\n            Dim SubFolders As Outlook.Folders\n            Set SubFolders = oFolder.Folders\n            Set oFolder = SubFolders.Item(FoldersArray(i))\n            If oFolder Is Nothing Then\n                Set GetFolderPath = Nothing\n            End If\n        Next\n    End If\n    'Return the oFolder\n    Set GetFolderPath = oFolder\n    Exit Function\n\nGetFolderPath_Error:\n    Set GetFolderPath = Nothing\n    Exit Function\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1464178640, "post_id": 37436594, "comment_id": 62376398, "body": "you have a ghost doublequote there: <code>If Dir(destinationFolder &quot;, 16)</code> fix this first"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1464178888, "post_id": 37436594, "comment_id": 62376590, "body": "so you turned your question from &quot;<i>can you help me to spot the problem in this code</i>&quot; which was fine, into &quot;<i>could you code this for me</i>&quot; which is not fine."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1464179159, "post_id": 37436594, "comment_id": 62376779, "body": "ok you changed it again. There was no VBA code anymore when I posted my comment"}], "answers": [{"tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 0, "last_activity_date": 1464178991, "creation_date": 1464178991, "answer_id": 37437023, "question_id": 37436594, "link": "https://stackoverflow.com/questions/37436594/vba-search-for-a-specific-subfolder-in-many-folders-and-move-all-the-files-in-it/37437023#37437023", "title": "VBA search for a specific subfolder in many folders and move all the files in it", "body": "<p>To found some folder use something like this</p>\n\n<pre><code>Sub findFolder()\n\n    Dim searchFolderName As String\n    searchFolderName = \"somePath\"\n\n    Dim FileSystem As Object\n\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n\n    doFolder FileSystem.getFolder(searchFolderName)\n\n\n\nEnd Sub\n\nSub doFolder(Folder)\n    Dim subFolder\n    On Error Resume Next\n    For Each subFolder In Folder.subfolders\n        If Split(subFolder, \"\\\")(UBound(Split(subFolder, \"\\\"))) = \"testFolder\" Then\n            MsgBox \"gotcha\"\n        End\n        End If\n\n        doFolder subFolder\n    Next subFolder\n\nEnd Sub\n</code></pre>\n\n<p>And then you can do whatever with that folder and its content. So with i little use of google (one maybe two words) you can achieve what you wana</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "edited": false, "score": 0, "creation_date": 1464340548, "post_id": 37437314, "comment_id": 62456082, "body": "can you please explaine more the strStartFolder ? i just put there the path"}, {"owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "reply_to_user": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "edited": false, "score": 0, "creation_date": 1464444789, "post_id": 37437314, "comment_id": 62494963, "body": "@mitsuki yes, just put the path of the folder you want to scan. StrMoveFolder is the name of the folder you are looking for. StrTargetFolder ise destination path for the files moved."}], "tags": [], "owner": {"reputation": 757, "user_id": 6330910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zdo0c.jpg?s=128&g=1", "display_name": "tk78", "link": "https://stackoverflow.com/users/6330910/tk78"}, "is_accepted": false, "score": 1, "last_activity_date": 1464179644, "creation_date": 1464179644, "answer_id": 37437314, "question_id": 37436594, "link": "https://stackoverflow.com/questions/37436594/vba-search-for-a-specific-subfolder-in-many-folders-and-move-all-the-files-in-it/37437314#37437314", "title": "VBA search for a specific subfolder in many folders and move all the files in it", "body": "<p>Here's a solution:</p>\n\n<pre><code>Dim fsoFileSystem As New FileSystemObject\nDim foFolder As Folder, foSubFolder As Folder\nDim fFile As File\nDim strStartFolder As String, strMoveFolder As String, strTargetFolder As String\n\nstrStartFolder = \"\\\\A\\B\\C\"\nstrMoveFolder = \"SearchFolder\"\nstrTargetFolder = \"\\\\B\\D\\E\"\n\nSet foFolder = fsoFileSystem.GetFolder(strStartFolder)\nFor Each foSubFolder In foFolder.SubFolders\n    If foSubFolder.Name = strMoveFolder Then\n        For Each fFile In foSubFolder.Files\n            fsoFileSystem.MoveFile fFile, strTargetFolder &amp; \"\\\"\n        Next\n    End If\nNext\n</code></pre>\n\n<p>strStartFolder is the folder to Screen for subfolders.\nstrMoveFolder is the name of the Folder to look for.\nstrTargetFolder is the Folder to where all the strMoveFolder's files shall be moved.</p>\n"}], "owner": {"reputation": 1, "user_id": 6310444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/261981d5ce527ee7a2850a3faf929890?s=128&d=identicon&r=PG&f=1", "display_name": "mitsuki", "link": "https://stackoverflow.com/users/6310444/mitsuki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4580, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1464179644, "creation_date": 1464177925, "last_edit_date": 1464178991, "question_id": 37436594, "link": "https://stackoverflow.com/questions/37436594/vba-search-for-a-specific-subfolder-in-many-folders-and-move-all-the-files-in-it", "title": "VBA search for a specific subfolder in many folders and move all the files in it", "body": "<p>can you help me?</p>\n\n<p>i want a macro vba that search for a <strong>SPECIFIC</strong> subfolder for example (Xfolder) between all the folders and subfolders that exist and move their files.</p>\n\n<pre><code>P:\\Desktop\\Folder1\\subfolder\\SUBFOLDER1\\Xfolder\n</code></pre>\n\n<p>I'm using the VBA Scripting Runtime objects</p>\n\n<pre><code>  Set  oSourceFolder = fso.GetFolder(source)\n\n    If Dir(destinationFolder, 16) = \"\" Then MkDir (destinationFolder)\n        For Each oFile In oFolder.Files\n                If Dir(destinationFolder,16) = \"\" Then\n                    fso.MoveFile oFile.Path, destinationFolder \n                End If\n\n            Next oFile\n                           fso.DeleteFolder oFolder.Path\n\n     Next oFolder\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1464172801, "creation_date": 1464172801, "answer_id": 37434665, "question_id": 37434604, "link": "https://stackoverflow.com/questions/37434604/how-to-search-for-multiple-strings-using-find/37434665#37434665", "title": "How to search for multiple strings using .find", "body": "<p>Why not use something along the lines of</p>\n\n<pre><code>for i = 1 to 7\n    if instr(1, Cells(i, 1), \"This\", vbtextcompare) &gt; 0 and instr(1, Cells(i, 1), \"test\", vbtextcompare) Then\n        Msgbox Cells(i,1).Value\n    end if\nnext i\n</code></pre>\n\n<p>You will need to mod this for your specific needs but this will look for both \"This\" and \"test\" in a cell and create a message box with the cells contents when found.</p>\n"}], "owner": {"reputation": 21, "user_id": 6380676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b490009c56e05916dab0801af21c743?s=128&d=identicon&r=PG&f=1", "display_name": "Padmanabhan", "link": "https://stackoverflow.com/users/6380676/padmanabhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464172801, "creation_date": 1464172637, "last_edit_date": 1531164843, "question_id": 37434604, "link": "https://stackoverflow.com/questions/37434604/how-to-search-for-multiple-strings-using-find", "title": "How to search for multiple strings using .find", "body": "<pre><code>Column A has values in the below rows \nA1=\"This is a test string\"\nA2=\"Hello how are you\"\nA3=\"Today is a good day\"\nA4=\"This is a test match\"\nA5=\"What is the time now\"\nA6=\"Test cell\"\nA7=\"This is true\"\n</code></pre>\n\n<p>I would like to find rows which have both \"This\" and \"test\". So the result should be \"This is a test string\" and \"This is a test match\"\nUsing excel-vba how can this be done?\nDo we need to use a nested .find?</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-office"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1464176284, "creation_date": 1464176284, "answer_id": 37435992, "question_id": 37434478, "link": "https://stackoverflow.com/questions/37434478/how-to-filter-the-form-record-source-query/37435992#37435992", "title": "How to filter the Form record source query?", "body": "<p>Change the RecordSource of the form to:</p>\n\n<pre><code>Select Top 1000000 * From YourQuery\n</code></pre>\n\n<p>After selecting a value in the combobox, adjust the <em>RecordSource</em>:</p>\n\n<pre><code>Dim RecordSource As String\nDim Records As Long\n\nRecordSource = \"Select Top 1000000 * From YourQuery\"\nRecords = Nz(Me!YourComboBox.Value, \"1000000\")\n\nMe.RecordSource = Replace(RecordSource, \"1000000\", Records)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5766891, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c5fc542d1044eb37df72f27579f23fb6?s=128&d=identicon&r=PG&f=1", "display_name": "Needsomehelp", "link": "https://stackoverflow.com/users/5766891/needsomehelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 37435992, "answer_count": 1, "score": 0, "last_activity_date": 1464176284, "creation_date": 1464172296, "question_id": 37434478, "link": "https://stackoverflow.com/questions/37434478/how-to-filter-the-form-record-source-query", "title": "How to filter the Form record source query?", "body": "<p>I'm creating a form that has a query as record source. I'm trying to build a filter option based on a Combo Box. When a value is selected in the Combo Box I want to show this filter on the form. So for example: if I select &lt;500 then the table needs to show only the field with less then 500 records. </p>\n\n<p>So the Form Record Source query needs to be updated. How can I achieve this?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "edited": false, "score": 1, "creation_date": 1464172482, "post_id": 37434463, "comment_id": 62372164, "body": "Here you can find info on how to check if file/workbook exists:   <a href=\"http://stackoverflow.com/questions/16351249/vba-check-if-file-exists\" title=\"vba check if file exists\">stackoverflow.com/questions/16351249/vba-check-if-file-exist&zwnj;&#8203;s</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1464177147, "post_id": 37434842, "comment_id": 62375320, "body": "Im sorry its not working. Is there any other way to do it. Please let me know."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1464178935, "post_id": 37434842, "comment_id": 62376632, "body": "What specifically isn&#39;t working? the only other thing to suggest with such little information is changing <code>.SaveAs</code> to <code>.SaveAs Filename:=Application.DefaultFilePath &amp; &quot;\\KPI&quot; &amp; &quot; &quot; &amp; s_AgingSCM &amp; &quot; &quot; &amp; Format_date &amp; &quot;.xlsx&quot;</code>"}, {"owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1464179650, "post_id": 37434842, "comment_id": 62377166, "body": "I haven&#39;t seen any changes in my result even after your code has been added. It give the same result as before. I have already a workbook with the <code>NewBook_SCM</code> when i inserted your code before the <code>.saveas</code>  it did not done anything. I have to re-execute the <code>NewBook_SCM</code>."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "edited": false, "score": 0, "creation_date": 1464179931, "post_id": 37434842, "comment_id": 62377407, "body": "Im not too eager to pursue this as I&#39;m not getting enough detail to help. Specifically, in your code, what one line is failing and what is the full error message."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1464173306, "creation_date": 1464173306, "answer_id": 37434842, "question_id": 37434463, "link": "https://stackoverflow.com/questions/37434463/re-execute-if-the-workbook-exists-or-not-using-vba-excel/37434842#37434842", "title": "Re-execute if the workbook exists or not using vba Excel", "body": "<p>A quick way to do it would be placing: -</p>\n\n<pre><code>If fso.FileExists(Application.DefaultFilePath &amp; \"\\KPI\" &amp; \" \" &amp; s_AgingSCM &amp; \" \" &amp; Format_date &amp; \".xlsx\")\n    fso.DeleteFile Application.DefaultFilePath &amp; \"\\KPI\" &amp; \" \" &amp; s_AgingSCM &amp; \" \" &amp; Format_date &amp; \".xlsx\", True\nEnd If\n</code></pre>\n\n<p>Above the line</p>\n\n<pre><code>.SaveAs Filename:=\"KPI\" &amp; \" \" &amp; s_AgingSCM &amp; \" \" &amp; Format_date &amp; \".xlsx\"\n</code></pre>\n\n<p>But this would not account for if the file could not be deleted (i.e. already open)</p>\n"}], "owner": {"reputation": 153, "user_id": 4863712, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/14fb10132886c0ea33bef2046a7c9d2f?s=128&d=identicon&r=PG&f=1", "display_name": "buddha sreekanth", "link": "https://stackoverflow.com/users/4863712/buddha-sreekanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464173306, "creation_date": 1464172245, "last_edit_date": 1531164843, "question_id": 37434463, "link": "https://stackoverflow.com/questions/37434463/re-execute-if-the-workbook-exists-or-not-using-vba-excel", "title": "Re-execute if the workbook exists or not using vba Excel", "body": "<p>I want to execute, if the workbook exists already then re- run it if not exists then create a workbook.</p>\n\n<p>I have uniques values(x) and array(names). I need to compare them if both are equal if not it has to create a workbook with name of array(names) that not had in uniques values(x)</p>\n\n<p>My code:</p>\n\n<pre><code>Sub mac()\n\nDim c as integer\nDim x as range\nDim s_AgingSCM as string\nDim Array_SCM_Aging as variant\nDim NewBook as workbook\nDim NewBook_SCM as workbook\nDim Master_workbook as workbook\nDim rngCopy_Aging as range\nDim rngFilter_Ws2 as range\n\nFor c = LBound(Array_SCM_Aging) To UBound(Array_SCM_Aging)\n            Set Master_workbook = ThisWorkbook\n            s_AgingSCM = Array_SCM_Aging(c, 1)\n            Set x = Master_workbook.Sheets(\"BASS\").Range(\"AY\" &amp; c)\n                    If x = s_AgingSCM Then                                                      \n\n                         With rngFilter_Ws2\n\n                                .AutoFilter field:=32, Criteria1:=\"&lt;&gt;(a)  0 - 360\", Operator:=xlFilterValues\n                                .AutoFilter field:=37, Criteria1:=s_AgingSCM, Operator:=xlFilterValues\n\n                         Set rngCopy_Aging = .SpecialCells(xlCellTypeVisible)\n                                             .AutoFilter ' Switch off AutoFilter\n                         End With\n\n                         rngCopy_Aging.Copy NewBook.Worksheets(\"Aging Inventory\").Cells(1, 1)\n                         Application.DisplayAlerts = False           \n                   Else\n\n                   Dim fso: Set fso = createObject(\"Scripting.FileSystemObject\")\n                    Dim folder: Set folder = fso.GetFolder(\"C:\\\")\n                    Dim file, fileNames                    \n                    Dim rngCopy_SCMAging As Range                   \n\n                    For Each file In folder.Files\n                            If Right(file.Name, 4) = \"xlsx\" Then\n                            fileNames = fileNames &amp; file.Name &amp; \";\"         ' will give a list of all filenames\n                            End If\n                    Next\n\n                    If InStr(fileNames, s_AgingSCM) = 0 Then                     \n\n                            With NewBook_SCM                            \n\n                                Set NewBook_SCM = Workbooks.Add\n                            .Title = s_AgingSCM\n                          NewBook_SCM.Worksheets(\"sheet1\").Name = \"Aging Inventory\"\n                            With rngFilter_Ws2\n\n                                .AutoFilter field:=32, Criteria1:=\"&lt;&gt;(a)  0 - 360\", Operator:=xlFilterValues\n                                .AutoFilter field:=37, Criteria1:=s_AgingSCM, Operator:=xlFilterValues\n\n                                Set rngCopy_SCMAging = .SpecialCells(xlCellTypeVisible)\n                                                       .AutoFilter ' Switch off AutoFilter\n                            End With\n\n                                rngCopy_SCMAging.Copy Destination:=NewBook_SCM.Worksheets(\"Aging Inventory\").Cells(1, 1)                            \n\n                          .SaveAs Filename:=\"KPI\" &amp; \" \" &amp; s_AgingSCM &amp; \" \" &amp; Format_date &amp; \".xlsx\"\n                          Application.DisplayAlerts = False\n                          NewBook_SCM.Close                           \n                        End With\n'                      Else\n                    End If\n\nEnd sub\n</code></pre>\n\n<p>I was stuck here since 2 days. All i want is if the workbook exists then overwrite with the new workbook or else if its not exists create a new workbook.</p>\n\n<p>Can someone please help me out.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1464171960, "post_id": 37434118, "comment_id": 62371767, "body": "A more accurate title would be &quot;Create user-defined function based on formula&quot;, but it would still be lacking. You should describe what you want to do specifically, not just generally. Also, your question should contain what you have attempted to solve the problem."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1464172109, "post_id": 37434118, "comment_id": 62371877, "body": "try <code>evaluate(&quot;SUM(IFERROR(VALUE(IF(LEN(H27:Q27)=4,IF(ISNUMBER(SE&zwnj;&#8203;ARCH(&quot;&quot;b&quot;&quot;,LEFT(H27:&zwnj;&#8203;Q27,2))),RIGHT(H27:Q&zwnj;&#8203;27,1),LEFT(H27:Q27,1&zwnj;&#8203;)),H27:Q27)),0))&quot;)</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464172448, "post_id": 37434118, "comment_id": 62372131, "body": "Is this actually an array formula over cells H27:Q27 ?"}, {"owner": {"reputation": 101, "user_id": 4241396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000239705022/picture?type=large", "display_name": "Mamed Aliyev", "link": "https://stackoverflow.com/users/4241396/mamed-aliyev"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464172936, "post_id": 37434118, "comment_id": 62372524, "body": "Range is not constant @robin I&#39;ve tried , but getting error as #value! <code>Public Function Rag(ggiRange As Range) As Single Dim rngCell As Range For Each rngCell In ggiRange Evaluate (&quot;SUM(IFERROR(VALUE(IF(LEN(E19:E20)=4,IF(ISNUMBER(SEARCH(&quot;&quot;b&zwnj;&#8203;&quot;&quot;,LEFT(E19:E20,2)))&zwnj;&#8203;,RIGHT(E19:E20,1),LE&zwnj;&#8203;FT(E19:E20,1)),E19:E&zwnj;&#8203;20)),0))&quot;) Rag = Rag + rngCell.Value Next rngCell End Function</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464173101, "post_id": 37434118, "comment_id": 62372625, "body": "So you want the function to iterate over some range - any beginning and end point - and then perform the logic? I ask because =LEN(A1:B1) as a normal formula will error (with #VALUE!) but an array formula will work."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464178544, "post_id": 37434118, "comment_id": 62376339, "body": "@MamedAliyev - by checking the link you posted in the question <a href=\"http://stackoverflow.com/questions/37406382/how-to-calculate-specific-cells-in-excel\">link</a> I can see that another poster suggested this formula to you as an array formula. I will go ahead and post an answer for you."}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1464178750, "creation_date": 1464178750, "answer_id": 37436914, "question_id": 37434118, "link": "https://stackoverflow.com/questions/37434118/create-vba-function-based-on-user-defined-function/37436914#37436914", "title": "Create VBA function based on user-defined function", "body": "<p>I think this function implements the formula. It's very difficult to test without your original set of data in the cells. Note the function is called from the Foo sub-routine below - so you can pass in a variable range to the function. Hope that helps.</p>\n\n<pre><code>Function DoIt(rng As Range)\n    ' VBA implementation for\n    '=SUM(IFERROR(VALUE(IF(LEN(H27:Q27)=4,IF(ISNUMBER(SEARCH(\"b\",LEFT(H27:Q27,2))),RIGHT(H27:Q27,1),LEFT(H27:Q27,1)),H27:Q27)),0))\n\n    Dim dblResult As Double\n    Dim rngCell As Range\n    Dim intLength As Integer\n    Dim strFragment1 As String\n    Dim strFragment2 As String\n    Dim intPos As Integer\n\n    'set result\n    dblResult = 0\n\n    'loop for the array formula\n    For Each rngCell In rngTarget\n\n        'check value length = 4\n        intLength = Len(rngCell.Value)\n        If intLength = 4 Then\n            'get bit of string and check for 'b' in string\n            strFragment1 = Left(rngCell.Value, 2)\n            'search for location of b in cell - use InStr for SEARCH\n            intPos = InStr(1, strFragment, \"b\", vbBinaryCompare)\n            If intPos &lt;&gt; 0 Then\n                'b in fragment\n                strFragment2 = Right(rngCell.Value, 1)\n            Else\n                'b not in fragment\n                strFragment2 = Left(rngCell.Value, 1)\n            End If\n\n            '2nd fragment should be a number?  use IsNumeric for ISNUMBER and Val for VALUE\n            If IsNumeric(strFragment2) Then\n                dblResult = dblResult + Val(strResult)\n            End If\n\n        Else\n            'cell value length &lt;&gt; 4\n            'add cell value to result if is numeric - use IsNumeric for ISNUMBER and Val for VALUE\n            If IsNumeric(rngCell.Value) Then\n                dblResult = dblResult + Val(rngCell.Value)\n            End If\n\n        End If\n    'next cell\n    Next rngCell\n\n    'return sum\n    DoIt = dblResult\n\nEnd Function\n\nSub Foo()\n    Dim rngTarget As Range\n\n    Set rng = Sheet1.Range(\"H27:Q27\")\n\n    Debug.Print DoIt(rng)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1464178819, "creation_date": 1464178819, "answer_id": 37436950, "question_id": 37434118, "link": "https://stackoverflow.com/questions/37434118/create-vba-function-based-on-user-defined-function/37436950#37436950", "title": "Create VBA function based on user-defined function", "body": "<p>Here you go:</p>\n\n<pre><code>Public Function GetTotal(rng As Range) As Long\n    Dim tot As Long\n    Dim celString As String\n    Dim t1String As String, t2String As String\n\n    For Each cel In rng\n        If IsNumeric(cel) Then\n            tot = tot + cel.Value\n        ElseIf Len(cel.Value) = 4 Then\n            celString = cel.Value\n            t1String = Left(celString, 2)\n            If InStr(1, t1String, \"b\") = 0 Then\n                t2String = Left(celString, 1)\n            Else\n                t2String = Right(celString, 1)\n            End If\n            tot = tot + t2String\n        End If\n        Debug.Print tot\n    Next\n    GetTotal = tot\nEnd Function\n</code></pre>\n\n<p>You have to give <code>range</code> as input.</p>\n\n<p>See the image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2w7I3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2w7I3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 101, "user_id": 4241396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000239705022/picture?type=large", "display_name": "Mamed Aliyev", "link": "https://stackoverflow.com/users/4241396/mamed-aliyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 37436950, "answer_count": 2, "score": 0, "last_activity_date": 1464178819, "creation_date": 1464171425, "last_edit_date": 1495541276, "question_id": 37434118, "link": "https://stackoverflow.com/questions/37434118/create-vba-function-based-on-user-defined-function", "title": "Create VBA function based on user-defined function", "body": "<p>Thanks to all friends who helped me on my question <a href=\"https://stackoverflow.com/questions/37406382/how-to-calculate-specific-cells-in-excel\">how to calculate specific cells in excel</a></p>\n\n<p>Now, I need help to code that excel function in VBA\nThe function is : <code>=SUM(IFERROR(VALUE(IF(LEN(H27:Q27)=4,IF(ISNUMBER(SEARCH(\"b\",LEFT(H27:Q27,2))),RIGHT(H27:Q27,1),LEFT(H27:Q27,1)),H27:Q27)),0))</code></p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1464171346, "post_id": 37434053, "comment_id": 62371362, "body": "Have a look at <a href=\"http://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">this: linky</a> It&#39;s got 5 different ways detailed for finding both the last row and the last column in a worksheet"}, {"owner": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1464174471, "post_id": 37434053, "comment_id": 62373504, "body": "Apologies for my ignorance (still learning the ropes) - but I&#39;m still stuck, as that link provides ways to find the last column (how would I utilise that in the range). In my scenario, if you see my code, I simply need the code to instead of use column O, use the last column. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1464179497, "last_edit_date": 1464179497, "creation_date": 1464175627, "answer_id": 37435717, "question_id": 37434053, "link": "https://stackoverflow.com/questions/37434053/need-to-use-code-to-get-the-last-column-in-my-data-rather-than-use-the-column-le/37435717#37435717", "title": "Need to use code to get the last column in my data rather than use the column letter", "body": "<pre><code> Sub edit_wb_1()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim lastRow As Long, i As Long\n    Dim lastColumn as Long\n    Dim value As String\n    Dim OldDate, NewDate As String\n\n    OldDate = Format(DateSerial(Year(Date), Month(Date) - 1, 0), \"ddmmyy\")\n    NewDate = Format(DateSerial(Year(Date), Month(Date), 0), \"ddmmyy\")\n\n\n\n    Set wb = Workbooks.Open(\"C:\\Users\\ashah\\Downloads\\HistoricSummary.xls\", 0)\n\n    Set ws = wb.Sheets(\"Historic Summary Page 1\")\n\n    lastRow = ws.Range(\"o\" &amp; ws.Rows.Count).End(xlUp).Row\n    lastColumn = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column ' gets last column in the first row (where you usually have headers so should be populated...\n\n    For i = lastRow To 2 Step -1\n    value = ws.Cells(i, lastColumn).value ' last col instead of Column O value.\n\n    ' Check if it contains one of the keywords.\n    If (value Like \"-\") Then\n    ws.Rows(i).ClearContents\n    End If\nNext\n\nwb.SaveAs Filename:=\"C:\\Users\\ashah\\Documents\\TPS Shapes\\TMB \" &amp; NewDate, FileFormat:=xlOpenXMLWorkbook\nwb.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1464175962, "creation_date": 1464175962, "answer_id": 37435851, "question_id": 37434053, "link": "https://stackoverflow.com/questions/37434053/need-to-use-code-to-get-the-last-column-in-my-data-rather-than-use-the-column-le/37435851#37435851", "title": "Need to use code to get the last column in my data rather than use the column letter", "body": "<p>The below alterations to your code should work.</p>\n\n<p>I have made an assumption the row 1 is a header row.</p>\n\n<p>I have also changed the variable name <code>value</code> to <code>StrValue</code> as <code>value</code> is used by built in Excel VBA functions and could cause ambiguity.</p>\n\n<pre><code>Sub edit_wb_1()\nDim wb          As Workbook\nDim ws          As Worksheet\nDim lastRow     As Long\nDim i           As Long\nDim Strvalue    As String\nDim OldDate     As String\nDim NewDate     As String\n\nOldDate = Format(DateSerial(Year(Date), Month(Date) - 1, 0), \"ddmmyy\")\nNewDate = Format(DateSerial(Year(Date), Month(Date), 0), \"ddmmyy\")\n\nSet wb = Workbooks.Open(\"C:\\Users\\ashah\\Downloads\\HistoricSummary.xls\", 0)\nSet ws = wb.Sheets(\"Historic Summary Page 1\")\n\n'This assumes row one is a header row\ni = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\nlastRow = ws.Cells(ws.Rows.Count, i).End(xlUp).Row\n\nFor i = lastRow To 2 Step -1\n    Strvalue = ws.Cells(i, 15).value ' Column O value.\n\n    ' Check if it contains one of the keywords.\n    If (Strvalue Like \"-\") Then\n        ws.Rows(i).ClearContents\n    End If\nNext\n\nSet ws = Nothing\n\nwb.SaveAs Filename:=\"C:\\Users\\ashah\\Documents\\TPS Shapes\\TMB \" &amp; NewDate, FileFormat:=xlOpenXMLWorkbook\nwb.Close 0\n\nSet wb = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6219515, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dbb06922ac958890f0d15da0ee4b45db?s=128&d=identicon&r=PG&f=1", "display_name": "chandu", "link": "https://stackoverflow.com/users/6219515/chandu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 37435717, "answer_count": 2, "score": 0, "last_activity_date": 1464181469, "creation_date": 1464171222, "last_edit_date": 1531164843, "question_id": 37434053, "link": "https://stackoverflow.com/questions/37434053/need-to-use-code-to-get-the-last-column-in-my-data-rather-than-use-the-column-le", "title": "Need to use code to get the last column in my data rather than use the column letter", "body": "<p>My code currently uses the last column (in this case column o) searches all the rows in that column and clears the whole row which have a certain value in column o of that row. Please can I get some help to modify my code to automatically choose the last column rather than use the letter \"o\" or the value \"15\" of that column as for other spreadsheets it may not always use column o. See my working code below:</p>\n\n<pre><code>Sub edit_wb_1()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim lastRow As Long, i As Long\n    Dim value As String\n    Dim OldDate, NewDate As String\n\n    OldDate = Format(DateSerial(Year(Date), Month(Date) - 1, 0), \"ddmmyy\")\n    NewDate = Format(DateSerial(Year(Date), Month(Date), 0), \"ddmmyy\")\n\n\n\n    Set wb = Workbooks.Open(\"C:\\Users\\ashah\\Downloads\\HistoricSummary.xls\", 0)\n\n    Set ws = wb.Sheets(\"Historic Summary Page 1\")\n\n    lastRow = ws.Range(\"o\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    For i = lastRow To 2 Step -1\n        value = ws.Cells(i, 15).value ' Column O value.\n\n        ' Check if it contains one of the keywords.\n        If (value Like \"-\") Then\n            ws.Rows(i).ClearContents\n        End If\n    Next\n\n    wb.SaveAs Filename:=\"C:\\Users\\ashah\\Documents\\TPS Shapes\\TMB \" &amp; NewDate, FileFormat:=xlOpenXMLWorkbook\n    wb.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464182173, "post_id": 37436596, "comment_id": 62379292, "body": "You sir are a star. I will adjust the code shortly and get back to you. thank you so much for this :)"}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464185494, "post_id": 37436596, "comment_id": 62381925, "body": "the [SolutionText] is a field within the table that stores troubleshooting steps for that specific model/manufacturer selected. This is the information that i need displayed in the list box. The column(1) stores the actual name of the manufacturer rather than the ID in column(0) which is what i need. strTableName is irelivant and has been removed"}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464186090, "post_id": 37436596, "comment_id": 62382427, "body": "Sorry for asking, but i cannot find &quot;Record Source&quot; on the list box, only control and row sources? Any ideas"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464186869, "post_id": 37436596, "comment_id": 62383074, "body": "@Batterdburrito sorry, I meant row source."}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464187657, "post_id": 37436596, "comment_id": 62383748, "body": "Im getting thrown an error with this. It says &quot;Undefined fucntion &#39;forms!Troubleshoot!cboManfact.Column&#39; in expression"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464188086, "post_id": 37436596, "comment_id": 62384082, "body": "Maybe try it without the <code>.column</code>. It will work based on what the bound column is in the properties of the combobox."}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464188958, "post_id": 37436596, "comment_id": 62384805, "body": "I think im really close to solving this. Your SQL command seems to want to return all table data into the listbox as it stands. What i need is the Tabledata &quot;SolutionText&quot; displayed in the listbox. Any ideas?"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464189204, "post_id": 37436596, "comment_id": 62384985, "body": "Yes, I thought you wanted all the data. See my edit. <code>SELECT *</code> will select all fields."}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464190015, "post_id": 37436596, "comment_id": 62385591, "body": "Thank you so much for your help Liam, its really appreciated. I have now got &quot;Testing issue&quot; displayed in the list box, however when i click requery, that value disappears"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464190292, "post_id": 37436596, "comment_id": 62385776, "body": "For &#39;simple&#39; queries try creating them in design view and then switch to SQL view and see what access produces. it will often start you in the right direction at least."}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464190695, "post_id": 37436596, "comment_id": 62386057, "body": "Im switching over to design view to see whats going on. It is working perfectly, but the only issue i have now is that the requery seems to just spaz out and makes the listbox refresh, but not display that refreshed data."}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464190824, "post_id": 37436596, "comment_id": 62386145, "body": "Does the fact that my Comboboxes get data from a seperate table make a difference at all, thats the only thing i can think of causing the problem (Apologies for not being able to initiate a chat, too new to forums unfortunatley)"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464246208, "post_id": 37436596, "comment_id": 62408007, "body": "I would have to test it myself, but i&#39;m guessing from what you are saying is when you update the combo boxes the listbox requeries. In which case you would not need the VBA <code>requery</code>."}, {"owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "edited": false, "score": 0, "creation_date": 1464357962, "post_id": 37436596, "comment_id": 62467369, "body": "Hello Liam, just to let you know, issue is now solved."}], "tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": true, "score": 0, "last_activity_date": 1464189240, "last_edit_date": 1464189240, "creation_date": 1464177929, "answer_id": 37436596, "question_id": 37433959, "link": "https://stackoverflow.com/questions/37433959/selecting-results-from-table-based-on-combo-box-data/37436596#37436596", "title": "Selecting results from table based on combo box data", "body": "<p>I have assumed you are using MS-Access, correct me if I am wrong. You may want to consider using <code>access-vba</code> tag if this is correct. </p>\n\n<p>There are a few things wrong with your code. Firstly, <code>docmd.RunSQL</code> cannot be used on select queries. This (SELECT) is not an action query and this command is reserved for action queries only. e.g. DELETE, UPDATE, ALTER, SELECT...INTO. </p>\n\n<p>When you use multiple where clauses use the word <code>AND</code> instead of the ampersand. You don't need to concatenate SQL  strings together. String values that are in a query and related to form values need encapsulating in single quotes, like so:</p>\n\n<p><code>\"...WHERE NAME='\" &amp; Me.name &amp; \"'\"</code></p>\n\n<p>You can use <code>debug.print strSQL</code> or <code>msgbox strSQL</code> to see how your SQL query reads for any errors.</p>\n\n<blockquote>\n  <p>So here's what I would do:</p>\n</blockquote>\n\n<p>Change the rowsource of the listbox to a query:</p>\n\n<p><code>SELECT [SolutionText] FROM [Solutions] WHERE solutions.ManufacturerSolution like forms![FORM_NAME]!cboManfact.Column(1) &amp; \"*\" AND solutions.ModelSolution like forms![FORM_NAME]!cboModel.Column(1) &amp; \"*\"</code></p>\n\n<p>The <code>like ... &amp; \"*\"</code> means that if the combobox is empty it will show all. </p>\n\n<p>You will need some VBA on the <code>on_click</code> event, which will be:</p>\n\n<pre><code>Private Sub dbSearch_Click()\n     me.listbox.requery\nend sub\n</code></pre>\n\n<p>The requery will change the listbox items based on the records selected in the combo boxes.</p>\n\n<ul>\n<li><p>I don't know what your intention is when using <code>[Solution Text]</code>?</p></li>\n<li><p>Are you sure you require <code>column(1)</code> and not <code>column(0)</code>?</p></li>\n<li><p>I am not sure what your intention was with <code>strTableName</code>?</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "is_accepted": false, "score": 0, "last_activity_date": 1464358023, "creation_date": 1464358023, "answer_id": 37485560, "question_id": 37433959, "link": "https://stackoverflow.com/questions/37433959/selecting-results-from-table-based-on-combo-box-data/37485560#37485560", "title": "Selecting results from table based on combo box data", "body": "<p>Solved the issue using the following code:</p>\n\n<pre><code>Private Sub dbSearch_Click()\n\nDim ManfactQuery As String\nDim ModelQuery As String\nDim strSQL As String\n\nManfactQuery = Me.cboManfact.Column(1)\nModelQuery = Me.cboModel.Column(1)\n\nIf Nz(ManfactQuery) = \"\" Then\n\nstrSQL = \"SELECT [Solutions].SolutionText FROM [Solutions] WHERE [Solutions].ModelSolution = '\" &amp; ModelQuery &amp; \"'\"\n\nElse\n\nIf Nz(ModelQuery) = \"\" Then\n\nstrSQL = \"SELECT [Solutions].SolutionText FROM [Solutions] WHERE [Solutions].ManufacturerSolution = '\" &amp; ManfactQuery &amp; \"'\"\n\nElse\n\nstrSQL = \"SELECT [Solutions].SolutionText FROM [Solutions] WHERE [Solutions].ManufacturerSolution = \" &amp; ManfactQuery &amp; \" AND [Solutions].ModelSolution = \" &amp; ModelQuery &amp; \"\"\n\nEnd If\n\nEnd If\n\nMe.lstSolution.RowSource = strSQL\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6380536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IDxjI.jpg?s=128&g=1", "display_name": "Batterdburrito", "link": "https://stackoverflow.com/users/6380536/batterdburrito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1332, "favorite_count": 0, "accepted_answer_id": 37436596, "answer_count": 2, "score": 0, "last_activity_date": 1594642049, "creation_date": 1464170959, "last_edit_date": 1594642049, "question_id": 37433959, "link": "https://stackoverflow.com/questions/37433959/selecting-results-from-table-based-on-combo-box-data", "title": "Selecting results from table based on combo box data", "body": "<p>Firstly I apologise for my lack of knowledge on SQL.</p>\n\n<p>I currently have two Comboboxes on a form and a list box which looks like the attached image </p>\n\n<p><a href=\"http://i.stack.imgur.com/xHVH7.png\" rel=\"nofollow\">TroubleshootPage</a></p>\n\n<p>The first combobox references a table with the list of manufacturers and then the second \"Model\" combobox updates with model numbers which match the first combobox' data</p>\n\n<p>The List box below needs to display data from the \"Solutions\" Table. ONLY THE \"SolutionText\" COLUMN</p>\n\n<p>The Manufacturer selected in \"cboManfact\" has to match the \"ManufacturerSolution\" in table \"Solutions\" and then return \"SolutionText\" if they match. Same for \"cboModel\" and \"ModelSolution\".</p>\n\n<p>I dont want the listbox to display any manufacturer or model text, just the \"SolutionText\" field when a button db_search is pressed.</p>\n\n<p>Thanks to the help of @LiamH, i currently have the following SQL Command on the RowSource of my list box</p>\n\n<p>This can happen either as the user selects options in the comboboxes or when clicking the green search icon</p>\n\n<p>The problem I am having is with the SQL Query. I currently have this below happening when the user clicks the search button</p>\n\n<pre><code>SELECT [SolutionText] FROM [Solutions] WHERE solutions.ManufacturerSolution like forms![Troubleshoot]!cboManfact &amp; \"*\" AND solutions.ModelSolution like forms![Troubleshoot]!cboModel &amp; \"*\"\n</code></pre>\n\n<p>It displays the SolutionText value in the listbox, but on clicking the \"db_search\" button, the listbox becomes empty</p>\n\n<p><code>Private Sub dbSearch_Click()\n     me.listbox.requery\nend sub</code></p>\n\n<p>Very close to getting this one now, any advice</p>\n"}, {"tags": ["vba", "outlook", "email-attachments", "outlook-2010"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6370751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209283228501970/picture?type=large", "display_name": "Antoine Myrd", "link": "https://stackoverflow.com/users/6370751/antoine-myrd"}, "edited": false, "score": 0, "creation_date": 1464338112, "post_id": 37442895, "comment_id": 62454587, "body": "Thanks Darren it works seamlessly, however I am looking for something which excludes instead of &quot;including&quot; only csv files. Is it possible to say something along the lines of &quot;If sExt= &quot;png;jpeg&quot; then don&#39;t save them&quot;?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 35, "user_id": 6370751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209283228501970/picture?type=large", "display_name": "Antoine Myrd", "link": "https://stackoverflow.com/users/6370751/antoine-myrd"}, "edited": false, "score": 0, "creation_date": 1464354532, "post_id": 37442895, "comment_id": 62465014, "body": "You can use a <code>Select Case</code> statement.  I&#39;ll update my code."}, {"owner": {"reputation": 35, "user_id": 6370751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209283228501970/picture?type=large", "display_name": "Antoine Myrd", "link": "https://stackoverflow.com/users/6370751/antoine-myrd"}, "edited": false, "score": 0, "creation_date": 1464357516, "post_id": 37442895, "comment_id": 62467070, "body": "Perfect works clean as a whistle, thanks a lot Darren!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1464363906, "last_edit_date": 1464363906, "creation_date": 1464193621, "answer_id": 37442895, "question_id": 37433626, "link": "https://stackoverflow.com/questions/37433626/exclude-signature-images-when-exporting-attachments-to-a-folder/37442895#37442895", "title": "Exclude Signature images when Exporting attachments to a folder", "body": "<p>If you're after downloading a specific file type you could check the extension of the attachment (untested, but should work):</p>\n\n<pre><code>Public Sub Renamefileandexcludesignature(Item As Outlook.MailItem)\n    Dim Atmt As Outlook.Attachment\n    Dim SavePath As String\n    Dim FileName As String\n\n    Dim objFSO As Object\n    Dim sExt As String\n\n    SavePath = \"C:\\Users\\Antoine\\Documents\"\n    FileName = \"Antoine\" &amp; \".csv\"\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    For Each Atmt In Item.Attachments\n        sExt = objFSO.GetExtensionName(Atmt.FileName)\n\n        Select Case sExt\n            Case \"jpg\", \"png\"\n                'Do nothing\n            Case Else\n                Atmt.SaveAsFile SavePath &amp; \"\\\" &amp; FileName\n        End Select\n    Next\n\n    Set Atmt = Nothing\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>But I have little to no knowledge in VBA and don't know where to place\n  in my code, especially the EndIf ( after or before the Next)</p>\n</blockquote>\n\n<p>These have to go in order -<br>\nIf you use <code>IF</code> and then <code>FOR</code> you have to use <code>NEXT</code> first to close the <code>FOR</code> and then <code>END IF</code> to close the <code>IF</code>.<br>\nIf you use <code>FOR</code> and then <code>IF</code> you have to use <code>END IF</code> to close the <code>IF</code> before you can use <code>NEXT</code> to close the <code>FOR</code>.  </p>\n\n<p>Hope that made sense.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 6370751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209283228501970/picture?type=large", "display_name": "Antoine Myrd", "link": "https://stackoverflow.com/users/6370751/antoine-myrd"}, "edited": false, "score": 0, "creation_date": 1464338258, "post_id": 37444653, "comment_id": 62454686, "body": "Thanks for your input Om3r! This looks like what I would need as it would save me the pain of isolating certain formats, however when I enter your code it says: Compile Error: Next without For Which I don&#39;t understand as you have a for 3 lines above..."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 35, "user_id": 6370751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209283228501970/picture?type=large", "display_name": "Antoine Myrd", "link": "https://stackoverflow.com/users/6370751/antoine-myrd"}, "edited": false, "score": 0, "creation_date": 1467519446, "post_id": 37444653, "comment_id": 63760885, "body": "@AntoineMyrd looks like I missed <code>End If</code> before <code>Next i</code>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1467519475, "last_edit_date": 1467519475, "creation_date": 1464199676, "answer_id": 37444653, "question_id": 37433626, "link": "https://stackoverflow.com/questions/37433626/exclude-signature-images-when-exporting-attachments-to-a-folder/37444653#37444653", "title": "Exclude Signature images when Exporting attachments to a folder", "body": "<p>To use <code>For i = lngCount To 1 Step -1</code> (<em>Looping through macro backwards</em>)</p>\n\n<p>Declare your variables </p>\n\n<pre><code>Dim objAttachments As Outlook.Attachments\nDim i As Long\nDim lngCount As Long\n</code></pre>\n\n<p>Now run your loop to save Object item</p>\n\n<pre><code>If Item.Attachments.Count &gt; 0 Then\n    For i = lngCount To 1 Step -1\n        If objAttachments.Item(i).Size &gt; 6000 Then\n           objAttachments.Item(i).SaveAsFile FileName\n        End If\n    Next i\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6370751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209283228501970/picture?type=large", "display_name": "Antoine Myrd", "link": "https://stackoverflow.com/users/6370751/antoine-myrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1987, "favorite_count": 0, "accepted_answer_id": 37442895, "answer_count": 2, "score": 1, "last_activity_date": 1593415767, "creation_date": 1464170078, "last_edit_date": 1593415767, "question_id": 37433626, "link": "https://stackoverflow.com/questions/37433626/exclude-signature-images-when-exporting-attachments-to-a-folder", "title": "Exclude Signature images when Exporting attachments to a folder", "body": "<p>I have code to export Outlook attachments to a local folder.</p>\n\n<p>I noticed the little images in the signature are also saved as attachments.</p>\n\n<p>I think excluding the signature images could be done with an If then along the lines of:</p>\n\n<pre><code> For i = lngCount To 1 Step -1\n If objAttachments.Item(i).Size &gt; 6000 Then\n</code></pre>\n\n<p>I don't know where to place in my code, especially the End If (after or before the Next).</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Public Sub Renamefileandexcludesignature(Item As Outlook.MailItem)\n    Dim Atmt As Outlook.Attachment\n    Dim SavePath As String\n    Dim FileName As String\n    SavePath = \"C:\\Users\\Antoine\\Documents\"\n    FileName = \"Antoine\" &amp; \".csv\"\n    For Each Atmt In Item.Attachments\n         Atmt.SaveAsFile SavePath &amp; \"\\\" &amp; FileName\n    Next\n    Set Atmt = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "db2"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1464173527, "post_id": 37433283, "comment_id": 62372884, "body": "Try with <code>VALUES (&quot;N&#39;&quot; &amp; value1 &amp; &quot;&#39;, N&#39;&quot; &amp; value2 &amp; &quot;&#39;, N&#39;&quot; &amp; ...</code> - The <code>N</code>prefix makes sure you insert Unicoded values."}, {"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 1, "creation_date": 1464176325, "post_id": 37433283, "comment_id": 62374701, "body": "Your assumption that &quot;this cannot work with normal Insert statement&quot; is incorrect."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "edited": false, "score": 0, "creation_date": 1464180063, "post_id": 37433283, "comment_id": 62377537, "body": "Why can&#39;t you do this. I do it everyday."}, {"owner": {"reputation": 1, "user_id": 6360225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd07c7c8ce8025a5747b1ee382d59d7?s=128&d=identicon&r=PG&f=1", "display_name": "nanatms", "link": "https://stackoverflow.com/users/6360225/nanatms"}, "edited": false, "score": 0, "creation_date": 1464589256, "post_id": 37433283, "comment_id": 62530596, "body": "I cannot use direct Insert Statement as it will show as ???."}, {"owner": {"reputation": 1, "user_id": 6360225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd07c7c8ce8025a5747b1ee382d59d7?s=128&d=identicon&r=PG&f=1", "display_name": "nanatms", "link": "https://stackoverflow.com/users/6360225/nanatms"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1480566136, "post_id": 37433283, "comment_id": 69018516, "body": "Hi @LocEngineer, I tried using the N prefix in VBA macro, but the wording after that get commented with the use of apostrophe. I tried putting the value in &quot; &quot; but the data get input in the database as it is (which is N&#39;xxx&#39;)."}, {"owner": {"reputation": 1, "user_id": 6360225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd07c7c8ce8025a5747b1ee382d59d7?s=128&d=identicon&r=PG&f=1", "display_name": "nanatms", "link": "https://stackoverflow.com/users/6360225/nanatms"}, "edited": false, "score": 0, "creation_date": 1480568495, "post_id": 37433283, "comment_id": 69019077, "body": "Also, to add to my original question, I am inserting the Chinese data to IBM OS/390. The connection from excel to the IBM OS/390 mainframe was established by DB2.  I am using connection string  CnStr = &quot;Provider=MSDASQL.1;Password=&quot; &amp; Password + &quot;;Persist Security Info=True;User ID=&quot; &amp; UserId + &quot;;Data Source=&quot; &amp; Db + &quot;;Mode=ReadWrite;  *Apologize if my explanation is confusing as I am no expert to the programming world."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1480584144, "post_id": 37433283, "comment_id": 69025980, "body": "Please post your VBA lines where you try to insert. What you posted above is a pseudo SQL string. For VBA you need to put it all in a string and concatenate where you pull in dynamic values or, better yet, use a parametrized query. Without proper code we are only stumbling in the blind."}, {"owner": {"reputation": 1, "user_id": 6360225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd07c7c8ce8025a5747b1ee382d59d7?s=128&d=identicon&r=PG&f=1", "display_name": "nanatms", "link": "https://stackoverflow.com/users/6360225/nanatms"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1481079550, "post_id": 37433283, "comment_id": 69225371, "body": "Hi @LocEngineer, This is my Insert statement in VBA:  oStr = &quot;INSERT INTO &quot;  &amp; tableName &amp;  &quot; ( &quot; &amp; field1 &amp;  &quot;,&quot; &amp; field2 &amp; &quot;) Values(&quot; &amp; data1 &quot;,&quot; &amp; &quot; N&#39; &quot; &amp; data2 &amp; &quot; &#39;)&quot;   where field1, field2, value1 and value2 values are from excel spreadsheet.   When I use this, I got error &quot;[IBM][CLI Driver][SQLDS/VM] SQL0105N The string constant beginning with &quot;&quot; is not valid. SQLSTATE=42604&quot;  If I put the N&#39; delimiter inside the double quote, then it will direct insert the N delimeter as part of the chinese character data."}], "answers": [{"tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1481111824, "creation_date": 1481111824, "answer_id": 41016839, "question_id": 37433283, "link": "https://stackoverflow.com/questions/37433283/loading-chinese-character-to-db2-using-sql-insert-statement/41016839#41016839", "title": "Loading Chinese character to DB2 using SQL Insert statement", "body": "<p>A few things:</p>\n\n<ol>\n<li>Not knowing your table and column names, enclose them with square brackets to be on the safe side</li>\n<li>There must be no space between the <code>N'</code> prefix and the Unicode data, nor a space after the value itself</li>\n<li>Your <code>data1</code> value is not enclosed in quotation marks; this means it must be a numeric value. If it is not a numeric value, enclose it in quotation marks. If it is a Unicode string, enclose it in <code>\"N'...\"'\"</code></li>\n</ol>\n\n<p>Try with this:</p>\n\n<pre><code>oStr = \"INSERT INTO [\" &amp; tableName &amp; \"] ([\" &amp; field1 &amp; \"], [\" &amp; field2 &amp; \"]) Values(\" &amp; data1 \",\" &amp; \" N'\" &amp; data2 &amp; \"');\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6360225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd07c7c8ce8025a5747b1ee382d59d7?s=128&d=identicon&r=PG&f=1", "display_name": "nanatms", "link": "https://stackoverflow.com/users/6360225/nanatms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1481111824, "creation_date": 1464169262, "last_edit_date": 1464171145, "question_id": 37433283, "link": "https://stackoverflow.com/questions/37433283/loading-chinese-character-to-db2-using-sql-insert-statement", "title": "Loading Chinese character to DB2 using SQL Insert statement", "body": "<p>I need to use <code>VBA excel macro</code> to load Chinese character data from excel spreadsheet to DB2 using SQL Insert Statement. I know that this cannot work with normal Insert statement as below:</p>\n\n<pre><code>INSERT INTO table_name\n       VALUES (value1,value2,value3,...);\n</code></pre>\n\n<p>Since this is my first time dealing with double byte character, can anybody help to guide me on which method I can use to load <code>DBCS data into DB2</code>.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "union"], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 0, "last_activity_date": 1464169644, "creation_date": 1464169644, "answer_id": 37433435, "question_id": 37432586, "link": "https://stackoverflow.com/questions/37432586/excel-vba-union-method-duplicates-cells-that-overlap/37433435#37433435", "title": "Excel vba Union method duplicates cells that overlap", "body": "<p>Yes, the Union operator is really more like a UNION ALL statement in SQL. Excel's Union operator does <em>not</em> return the distinct set of cells.</p>\n"}, {"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1464178536, "post_id": 37434434, "comment_id": 62376333, "body": "&quot;the way that Excel-VBA handles Union meshes with the way Excel treats multiple range selections in spreadsheet functions&quot;... Thats because the comma is a UNION operator, just like a space is an INTERSECTION operator. Eg. <code>Range(&quot;A:A 1:1&quot;)</code> and <code>=A:A 1:1</code> will return the <i>INTERSECTION</i> of <code>A:A</code> and <code>1:1</code> which is <code>A1</code>, just as <code>Range(&quot;A:A,1:1&quot;)</code> is the <i>UNION ALL</i> of <code>A:A</code> and <code>1:1</code>."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1464172173, "creation_date": 1464172173, "answer_id": 37434434, "question_id": 37432586, "link": "https://stackoverflow.com/questions/37432586/excel-vba-union-method-duplicates-cells-that-overlap/37434434#37434434", "title": "Excel vba Union method duplicates cells that overlap", "body": "<p>I find it somewhat pointless to speculate much about 20-year old closed-source design decisions, although it is interesting to note that the way that Excel-VBA handles <code>Union</code> meshes with the way Excel treats multiple range selections in spreadsheet functions. In this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/39Vts.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/39Vts.gif\" alt=\"enter image description here\"></a></p>\n\n<p>the sum evaluates to 12 and not 10. Thus it seems likely that VBA's approach was an attempt to come up with a Range object that corresponds to how Excel itself treats overlapping selections. This would push back the design-decision to pre-VBA Excel.</p>\n\n<p>If <code>Union</code> doesn't do what you want, then you need to write a different function. Chip Pearson is an extremely good VBA programmer, so I would be surprised if there is any easy work-around that he missed. Your actual question discussed the <em>count</em> of the union. If that is what you want, you could write a smaller function:</p>\n\n<pre><code>Function UnionCount(A As Range, B As Range) As Long\n    Dim adjustment As Long\n    If Not Intersect(A, B) Is Nothing Then\n        adjustment = Intersect(A, B).Cells.Count\n    End If\n    UnionCount = Union(A, B).Cells.Count - adjustment\nEnd Function\n</code></pre>\n\n<p>Then <code>UnionCount(Range(\"A1:B2\"), Range(\"B1:B4\"))</code> evaluates to 6.</p>\n"}, {"tags": [], "owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "is_accepted": false, "score": 0, "last_activity_date": 1464175447, "creation_date": 1464175447, "answer_id": 37435654, "question_id": 37432586, "link": "https://stackoverflow.com/questions/37432586/excel-vba-union-method-duplicates-cells-that-overlap/37435654#37435654", "title": "Excel vba Union method duplicates cells that overlap", "body": "<p>hil,</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/aa213609(v=office.11).aspx\" rel=\"nofollow\">union</a> method creates a range with n areas.</p>\n\n<p>It is interesting that this <code>Application.Union(Range(\"a1:c2\"), Range(\"a1:c2\"), Range(\"a1:c2\"))</code> creates a single area. And in fact for the case where one of the ranges contains all the others entirely you will only get back the 1 area. eg <code>Application.Union(Range(\"a1:f2\"), Range(\"b2:d2\"))</code>. Another interesting example is <code>Application.Union(Range(\"a1:f2\"), Range(\"b2:d3\"), Range(\"d2:e3\"))</code> this merged range(b2:e3) and created 2 areas.</p>\n\n<p>A point to make at this point is that contiguous ranges have to be rectangular.</p>\n\n<p>So Union will create the most efficient contiguous blocks of ranges, but there may still be some overlap.</p>\n\n<p>CPearson's website has been around since the dawn of time, so it is very unlikely that you will find a better source for many problems. (<em>I am not CPearson</em>). </p>\n\n<p>Regards\nGareth</p>\n"}], "owner": {"reputation": 121, "user_id": 4357630, "user_type": "registered", "profile_image": "https://graph.facebook.com/664096589/picture?type=large", "display_name": "hil", "link": "https://stackoverflow.com/users/4357630/hil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1464175447, "creation_date": 1464167532, "last_edit_date": 1525816150, "question_id": 37432586, "link": "https://stackoverflow.com/questions/37432586/excel-vba-union-method-duplicates-cells-that-overlap", "title": "Excel vba Union method duplicates cells that overlap", "body": "<p>I expected the following macro to display 6 but it displays 8. I understand that this is because Union duplicates cells that overlap as do cells b1:b2 in my example:</p>\n\n<pre><code>Sub a()\nDim myRange As Range\nSet myRange = Application.Union(Range(\"a1:b2\"), Range(\"b1:b4\"))\nMsgBox myRange.Count\nEnd Sub\n</code></pre>\n\n<p>I found this <a href=\"http://www.cpearson.com/excel/BetterUnion.aspx\" rel=\"nofollow noreferrer\">solution to the problem</a> but I'm interested to know why this is the way Union works and if there is any other way to get around this besides writing a new function as suggested by the above link.  </p>\n"}, {"tags": ["vba", "dynamic", "marshalling", "pass-by-reference", "callbyname"], "answers": [{"comments": [{"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1464183432, "post_id": 37438455, "comment_id": 62380255, "body": "I believe your paragraph ending in &quot;...it <i>has</i> to assume that it can&#39;t change them.&quot; to be incorrect. When using CallByName directly in VBA ByRef arguments work as expected, so there cannot be an inherent limitation in the CallByName implementation. IMO the problem is in passing the Args/Array to the declared function."}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "edited": false, "score": 0, "creation_date": 1464184590, "post_id": 37438455, "comment_id": 62381191, "body": "I agree byRef arguments work directly with CallByName so it seems strange that there would be a limitation. Is there a way round this? I need to pass an array of argument as I have no idea how many there will be until runtime"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1464186169, "post_id": 37438455, "comment_id": 62382493, "body": "@PhilS - Direct calls to <code>CallByName</code> aren&#39;t marshaled through the COM boundary."}, {"owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "edited": false, "score": 0, "creation_date": 1464192741, "post_id": 37438455, "comment_id": 62387528, "body": "Unfortunately the Methods are a proprietary external library as they allow me to connect to an external piece of software through COM object, so I cannot refactor or create a class."}, {"owner": {"reputation": 1991, "user_id": 447485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e4e2946c3270f4a20e60ec3d3c8f552?s=128&d=identicon&r=PG", "display_name": "airstrike", "link": "https://stackoverflow.com/users/447485/airstrike"}, "reply_to_user": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "edited": false, "score": 0, "creation_date": 1585798575, "post_id": 37438455, "comment_id": 107891504, "body": "@maracuja Wrap the arguments in an <code>Array()</code> call and have the function accept a regular array as its argument rather than ParamArray"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1464182311, "creation_date": 1464182311, "answer_id": 37438455, "question_id": 37432304, "link": "https://stackoverflow.com/questions/37432304/how-do-i-pass-an-array-of-arguments-byref-with-callbyname/37438455#37438455", "title": "How do I pass an array of arguments ByRef with CallByName?", "body": "<p>The the first clue to the answer lies in the function declaration for rtcCallByName (pulled from the exports table of vbe7.dll):</p>\n\n<pre><code>function CallByName(Object: IDispatch; ProcName: BSTR; CallType: VbCallType; Args: ^SafeArray; out lcid: I4): Variant; stdcall;\n</code></pre>\n\n<p>Note that <code>Args</code> is declared as a pointer to a <code>SafeArray</code>, but is <em>not</em> declared as an <code>out</code> parameter. This means that the COM contract for the function is basically saying that if you pass a <code>ParamArray</code> the only guarantee that it makes is that it won't change pointer to the <code>ParamArray</code> itself. The <code>ByRef</code> in the <code>Declare Function</code> only indicates that you are passing a pointer.</p>\n\n<p>As for the values <em>inside</em> the <code>ParamArray</code>, there really isn't much Microsoft documentation I can dig up specific to VBA, but the <a href=\"https://msdn.microsoft.com/en-us/library/ct363x9h.aspx\" rel=\"nofollow\">VB.NET version of the documentation</a> gives the second clue: </p>\n\n<blockquote>\n  <p>A ParamArray parameter is always declared using ByVal (Visual Basic).</p>\n</blockquote>\n\n<p>In the context of <code>CallByName</code>, this make perfect sense.  The <code>rtcCallByName</code> function itself doesn't (and can't) know which of the parameters for the called method are <em>themselves</em> declared <code>ByRef</code> or <code>ByVal</code>, so it <em>has to</em> assume that it can't change them.</p>\n\n<p>As far as implementations to work around this limitation, I'd suggest either refactoring to eliminate return values that are passed <code>ByRef</code> in code called by <code>CallByName</code> or wrapping the needed functionality in a class. </p>\n"}], "owner": {"reputation": 170, "user_id": 5445548, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/pmGVM.png?s=128&g=1", "display_name": "maracuja", "link": "https://stackoverflow.com/users/5445548/maracuja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 3, "answer_count": 1, "score": 6, "last_activity_date": 1464182311, "creation_date": 1464166772, "question_id": 37432304, "link": "https://stackoverflow.com/questions/37432304/how-do-i-pass-an-array-of-arguments-byref-with-callbyname", "title": "How do I pass an array of arguments ByRef with CallByName?", "body": "<p>I am currently using CallByName to dynamically call methods. There are several methods which I pick up daily from a table in server along with the arguments. For this reason, I send an array of the arguments to CallByName rather than a param array as I don't know the number of arguments until runtime. Given CallByName expects a paramarray I use a private declare function to bypass the VBA Type definition. </p>\n\n<pre><code>Private Declare PtrSafe Function rtcCallByName Lib \"VBE7.DLL\" ( _\n  ByVal Object As Object, _\n  ByVal ProcName As LongPtr, _\n  ByVal CallType As VbCallType, _\n  ByRef Args() As Any, _\n  Optional ByVal lcid As Long) As Variant\n\nPublic Function CallByNameMethod(Object As Object, ProcName As String, ByRef Args () As Variant)\n  AssignResult CallByNameMethod, rtcCallByName(Object, StrPtr(ProcName), VbMethod, Args)\nEnd Function \n\n Private Sub AssignResult(target, Result)\n  If VBA.IsObject(Result) Then Set target = Result Else target = Result\nEnd Sub\n</code></pre>\n\n<p>This works when I pass an object where the method changes its underlying properties. However, there are some methods where I pass an object and a method which changes the values of the passed arguments. For example, I pass an array with the following arguments</p>\n\n<pre><code> Dim Name as String, Value1 as double, Value2 as double, Value3 as double\n Dim Array(3) as Variant\n\n  String = \"Name\"\n  Value1 = 0\n  Value2 = 0\n  Value3 = 0\n\n  Array(0) = Name\n  Array(1) = Value1\n  Array(2) = Value2\n  Array(3) = Value3\n</code></pre>\n\n<p>When I Pass that array, the method just returns the array back with the same values, but I am expecting double type values for Array(1), Array(2), Array(3). Any ideas?</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6380082, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z7LGynR9nCw/AAAAAAAAAAI/AAAAAAAAAq4/tLPBpi6vDng/photo.jpg?sz=128", "display_name": "irishmcbride", "link": "https://stackoverflow.com/users/6380082/irishmcbride"}, "edited": false, "score": 1, "creation_date": 1464253535, "post_id": 37433236, "comment_id": 62412515, "body": "Amazing, worked like a dream. I see what I was doing wrong now, thanks a lot!"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1576826549, "post_id": 37433236, "comment_id": 105029070, "body": "Sender name showing in number format &quot;20191220-1012--RE_ PF Admin Charges&quot;"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1576827093, "post_id": 37433236, "comment_id": 105029255, "body": "Exactly where i need to add this line? &quot; sSenderEmailAddress = oMail.SenderEmailAddress&quot;"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1464169146, "creation_date": 1464169146, "answer_id": 37433236, "question_id": 37432082, "link": "https://stackoverflow.com/questions/37432082/macro-for-saving-emails-from-outlook-sender-name-query/37433236#37433236", "title": "Macro for saving emails from outlook - Sender name query", "body": "<p>If you are using <code>Dim sSenderEmailAddress As String</code> without ever setting it to anything that will be why you just get the double hyphen - it's empty.</p>\n\n<p>Try including:</p>\n\n<pre><code>Dim sSenderEmailAddress As String\nsSenderEmailAddress = oMail.SenderEmailAddress\n</code></pre>\n\n<p>before you create the file name like this:</p>\n\n<pre><code>sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n        vbUseSystem) &amp; Format(dtDate, \"-hhnn\", _\n        vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; sSenderEmailAddress &amp; \"-\" &amp; sName &amp; \".msg\n</code></pre>\n\n<p>You should also be able to use SenderName in this manner if you like, although you're probably best to still run it through your function to strip out certain characters.</p>\n"}], "owner": {"reputation": 23, "user_id": 6380082, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z7LGynR9nCw/AAAAAAAAAAI/AAAAAAAAAq4/tLPBpi6vDng/photo.jpg?sz=128", "display_name": "irishmcbride", "link": "https://stackoverflow.com/users/6380082/irishmcbride"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1555, "favorite_count": 0, "accepted_answer_id": 37433236, "answer_count": 1, "score": 2, "last_activity_date": 1593328060, "creation_date": 1464166137, "last_edit_date": 1593328060, "question_id": 37432082, "link": "https://stackoverflow.com/questions/37432082/macro-for-saving-emails-from-outlook-sender-name-query", "title": "Macro for saving emails from outlook - Sender name query", "body": "<p>So, the organisation I work for requires <em>all</em> project or task related emails to be saved, as part of a formal process, in a specific name format:</p>\n\n<p>YYMMDD-HHmm-SenderName-RecipientName-Subject.msg</p>\n\n<p>We're not allowed to use .pst files for some reason so as you can imagine, doing this individually is tedious in the extreme, and I am lazy, so I decided to try and automate this with a helpful macro. Some intensive googling led me to create the following with help from a website called slipstick:</p>\n\n<pre><code>Option Explicit\nPublic Sub SaveMessageAsMsg()\n  Dim oMail As Outlook.MailItem\n  Dim objItem As Object\n  Dim sPath As String\n  Dim dtDate As Date\n  Dim sName As String\n  Dim enviro As String\n  Dim strFolderpath As String\n\n\n    enviro = CStr(Environ(\"USERPROFILE\"))\nstrFolderpath = \"DESKTOP LOCATION HERE\"\n\n   For Each objItem In ActiveExplorer.Selection\n   If objItem.MessageClass = \"IPM.Note\" Then\n    Set oMail = objItem\n\n  sName = oMail.Subject\n  ReplaceCharsForFileName sName, \"-\"\n\n  dtDate = oMail.ReceivedTime\n  sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n    vbUseSystem) &amp; Format(dtDate, \"-hhnn\", _\n    vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; sName &amp; \".msg\"\n\n  sPath = strFolderpath &amp; \"\\\"\n  Debug.Print sPath &amp; sName\n  oMail.SaveAs sPath &amp; sName, olMSG\n\n  End If\n  Next\n\nEnd Sub\n\nPrivate Sub ReplaceCharsForFileName(sName As String, _\n  sChr As String _\n)\n  sName = Replace(sName, \"'\", sChr)\n  sName = Replace(sName, \"*\", sChr)\n  sName = Replace(sName, \"/\", sChr)\n  sName = Replace(sName, \"\\\", sChr)\n  sName = Replace(sName, \":\", sChr)\n  sName = Replace(sName, \"?\", sChr)\n  sName = Replace(sName, Chr(34), sChr)\n  sName = Replace(sName, \"&lt;\", sChr)\n  sName = Replace(sName, \"&gt;\", sChr)\n  sName = Replace(sName, \"|\", sChr)\nEnd Sub\n</code></pre>\n\n<p>This quite happily saves selected emails in a folder on my desktop (for moving on elsewhere) in the format</p>\n\n<p>YYYYMMDD-HHmm-Subject.msg</p>\n\n<p>Try as I might, however, I can't seem to get the sender's name to go in there as well. I've tried using</p>\n\n<pre><code>Dim sSenderName As String\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Dim sSenderEmailAddress As String\n</code></pre>\n\n<p>With the appropiate additions in the part of the macro which creates the file name:</p>\n\n<pre><code>sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n        vbUseSystem) &amp; Format(dtDate, \"-hhnn\", _\n        vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" *&amp; EXTRA BIT HERE* &amp; \"-\" &amp; sName &amp; \".msg\n</code></pre>\n\n<p>But all this seems to do is add an extra hyphen into my eventual filename.</p>\n\n<p>Note I'm not bothered about adding recipient into the filename, anything with more than a few recipeints would send it sailing past the character limit.</p>\n\n<p>So, what am I doing wrong? I'm a complete newcomer to VBA and have quite enjoyed this little project, so I'd love to know where I'm fouling up. In my defence I'm a mechanical engineer, and I'm pretty sure that hitting my macro with a hammer won't help.</p>\n\n<p>I'm considering trying to write something which will produce a little popup letting me fill in the pertinent info before saving the email, but that's probably a little way beyond me right now. Gotta walk before I can run.</p>\n\n<p>All tips and comments gratefully received.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464165597, "post_id": 37431557, "comment_id": 62367419, "body": "Please could you clarify what you mean by &#39;those two range would always be updated by offset function&#39;? Otherwise you can try: <code>Range(rg3.Address &amp; &quot;:&quot; &amp; rg4.Address).PasteSpecial (xlPasteAll)</code> but I think you are saying that isn&#39;t what you want."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1464165913, "post_id": 37431557, "comment_id": 62367614, "body": "Try the union function, as in <a href=\"http://stackoverflow.com/q/9903792/1490783\">this Q+A</a>."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6359987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/416ab9e2439bc1d729280120a53bc7c9?s=128&d=identicon&r=PG&f=1", "display_name": "Hui Man Chang", "link": "https://stackoverflow.com/users/6359987/hui-man-chang"}, "edited": false, "score": 0, "creation_date": 1464166300, "post_id": 37431976, "comment_id": 62367857, "body": "rg3 and rg4 is inside a for loop, each time it will move to next colmn by offset(0, 1)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 7, "user_id": 6359987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/416ab9e2439bc1d729280120a53bc7c9?s=128&d=identicon&r=PG&f=1", "display_name": "Hui Man Chang", "link": "https://stackoverflow.com/users/6359987/hui-man-chang"}, "edited": false, "score": 0, "creation_date": 1464168130, "post_id": 37431976, "comment_id": 62369094, "body": "You may be better using <code>Cells</code> rather than <code>Range</code> if you want to increase your range reference in a loop.  I&#39;ll add an example to my answer."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1464168240, "last_edit_date": 1464168240, "creation_date": 1464165843, "answer_id": 37431976, "question_id": 37431557, "link": "https://stackoverflow.com/questions/37431557/excel-vba-set-one-range-object-by-other-two-range-object/37431976#37431976", "title": "excel vba set one range object by other two range object", "body": "<p>When you enter <code>Range(</code> the intellisense will show <code>Range(Cell1, Cell2) as Range</code> indicating the the Range object is expecting two cells.  </p>\n\n<p>So, seeing as rg3 and rg4 are two cells you can use <code>Range(rg3, rg4)</code>.  </p>\n\n<p>You're using <code>xlPasteAll</code> so you could just use <code>RangeBeingCopiedReference.Copy Destination:=Range(rg3,rg4)</code></p>\n\n<p>Edit - and as @Robin says, what do you mean by the offsetting?</p>\n\n<p>Edit 2:<br>\nIf you want to loop through a range then using <code>Cells</code> is easier as it accepts a column number rather than a column letter.</p>\n\n<p>This example will copy columns A:J over to U:AD one column at a time.  </p>\n\n<pre><code>Sub Test()\n\n    Dim rg3 As Range, rg4 As Range\n    Dim x As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        For x = 1 To 10\n            .Range(.Cells(2, x), .Cells(3000, x)).Copy _\n                Destination:=.Range(.Cells(2, x + 20), .Cells(3000, x + 20))\n        Next x\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Also - look up reference on <code>WITH... END WITH</code> - <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/wc500chb.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1464174487, "creation_date": 1464174487, "answer_id": 37435322, "question_id": 37431557, "link": "https://stackoverflow.com/questions/37431557/excel-vba-set-one-range-object-by-other-two-range-object/37435322#37435322", "title": "excel vba set one range object by other two range object", "body": "<p>I'd like to better understand your needs for better help</p>\n\n<p>as a start, since your using of <code>.PasteSpecial xlPasteAll</code> I'd believe you're setting a source range outside a loop and paste it multiple times inside this latter shifting pasting range</p>\n\n<p>you also explained <em>\"rg3 and rg4 is inside a for loop, each time it will move to next colmn by offset(0, 1)\"</em></p>\n\n<p>so this would initially lead to:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim copyRng As Range, rg3 As Range, rg4 As Range\n    Dim i As Long\n\n    Set rg3 = Range(\"B2\") '&lt;~~ your rg3 range setting\n    Set rg4 = Range(\"B3000\") '&lt;~~ your rg4 range setting\n    Set copyRng = ... '&lt;~~ your setting of the \"source\" range to be copied once and pasted many\n    copyRng.Copy '&lt;~~ copy \"source\" Range once ...\n    With Range(rg3, rg4) '&lt;~~ ... set your initial \"target\" range ...\n        For i = 1 To 10\n            .Offset(, i).PasteSpecial xlPasteAll '&lt;~~ ... and paste \"source\" range offseting \"target\" once\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>but this would also be uselessly long and slow, since you could simply write:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim copyRng As Range, rg3 As Range\n\n    Set rg3 = Range(\"B2\") '&lt;~~ just set the \"beginning\" of the target range\n    Set copyRng = ... '&lt;~~ your setting of the \"source\" range to be copied once and pasted many\n    copyRng.Copy copyRng.Copy Destination:=rg3.Resize(, 10)   \nEnd Sub\n</code></pre>\n\n<p>so what's your real need?</p>\n"}], "owner": {"reputation": 7, "user_id": 6359987, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/416ab9e2439bc1d729280120a53bc7c9?s=128&d=identicon&r=PG&f=1", "display_name": "Hui Man Chang", "link": "https://stackoverflow.com/users/6359987/hui-man-chang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 37431976, "answer_count": 2, "score": 0, "last_activity_date": 1464174487, "creation_date": 1464164537, "question_id": 37431557, "link": "https://stackoverflow.com/questions/37431557/excel-vba-set-one-range-object-by-other-two-range-object", "title": "excel vba set one range object by other two range object", "body": "<p>Here is my problem. I have two Range Object. For example,</p>\n\n<pre><code>    Set rg3 = Range(\"B2\")\n    Set rg4 = Range(\"B3000\")\n</code></pre>\n\n<p>I want to do this</p>\n\n<pre><code>    Range(\"rg3:rg4\").PasteSpecial (xlPasteAll)\n</code></pre>\n\n<p>But it show error. How can I select the region by two range object. \nRange(\"B2:B3000\") is not correct in my case because those two range would always updated by offset function.</p>\n\n<p>Thanks for your help!!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 742, "user_id": 4830209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f36c805d87474402708042645313a454?s=128&d=identicon&r=PG&f=1", "display_name": "Sun", "link": "https://stackoverflow.com/users/4830209/sun"}, "edited": false, "score": 0, "creation_date": 1464176887, "post_id": 37431496, "comment_id": 62375112, "body": "Is creating helper columns an option for your worksheet structure?"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 5268478, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7v7cZXGJ5Bc/AAAAAAAAAAI/AAAAAAAAE-0/hRzn3OmYTBU/photo.jpg?sz=128", "display_name": "Divya Gopal", "link": "https://stackoverflow.com/users/5268478/divya-gopal"}, "is_accepted": false, "score": 0, "last_activity_date": 1464165405, "creation_date": 1464165405, "answer_id": 37431822, "question_id": 37431496, "link": "https://stackoverflow.com/questions/37431496/comparing-contents-of-two-spreadsheets/37431822#37431822", "title": "Comparing contents of two spreadsheets", "body": "<p>I had done this some time back. Basically I created the Excel sheets into a ODBC data source using administrator tool in windows. And then write Java code which uses ODBC connection to connect to the excel, then each sheet inside excel will become table. Then you can use SQL minus queries to perform comparison.</p>\n"}, {"tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1464188546, "creation_date": 1464188546, "answer_id": 37440981, "question_id": 37431496, "link": "https://stackoverflow.com/questions/37431496/comparing-contents-of-two-spreadsheets/37440981#37440981", "title": "Comparing contents of two spreadsheets", "body": "<p>Below code will search the set1(column A to D) and return its result in I column. Similarly you can do this for set2(E to H Column).</p>\n\n<pre><code>Sub test()\n    Dim flag As String, lastrow1 As Long, lastrow2 As Long, i As Long, j As Long\n    flag = \"no\"\n    lastrow1 = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lastrow2 = Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n    ReDim set1(lastrow1) As String\n    ReDim set2(lastrow2) As String\n    For i = 1 To lastrow1 - 1\n        For j = 1 To 4\n            If j &lt;&gt; 3 Then\n                out = out &amp; Cells(i + 1, j)\n            End If\n        Next j\n        set1(i) = out\n        out = \"\"\n    Next i\n    For i = 1 To lastrow2 - 1\n        For j = 5 To 7\n            out = out &amp; Cells(i + 1, j)\n        Next j\n        set2(i) = out\n        out = \"\"\n    Next i\n    For i = 1 To lastrow1\n        For j = 1 To lastrow2\n            If set1(i) = set2(j) Then\n                flag = \"yes\"\n            End If\n        Next j\n        If flag = \"no\" Then\n            Range(\"I\" &amp; i + 1).Value = \"Not Match\"\n            Range(\"D\" &amp; i + 1).Interior.ColorIndex = 6\n        Else\n            flag = \"no\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>Proof of work</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/cdZ2z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cdZ2z.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 6373130, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/66951fcdbf0e677ff29ee1d8c6f5036c?s=128&d=identicon&r=PG&f=1", "display_name": "Marcidee", "link": "https://stackoverflow.com/users/6373130/marcidee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1464188546, "creation_date": 1464164362, "last_edit_date": 1464181072, "question_id": 37431496, "link": "https://stackoverflow.com/questions/37431496/comparing-contents-of-two-spreadsheets", "title": "Comparing contents of two spreadsheets", "body": "<p>I have coped the contents of two different spreadsheets to one document \u2013 I need to compare the results of the two sheets (4 columns in each)</p>\n\n<p>In the first group of 4 columns there are 3 entries for the 17th May and in the second group of 4 there are 4 entries \u2013 Patricia Nightingale is missing.</p>\n\n<p>Is it feasible to write a script that highlights discrepancies in either sets? (ideally it would also compare the units) </p>\n\n<p>This is quite a long spreadsheets (I have coipied the first 4 columns A - D and second Columns F - I)</p>\n\n<p>I am not sure if this is possible but if it is could someone help me?</p>\n\n<pre><code> Name           Date         Units   Service User \n Alicia Haines  17 May 2016  1.00    Albert Nightingale \n Alicia Haines  17 May 2016  0.50    Eve Reed \n Alicia Haines  17 May 2016  0.75    Raymond Watson (Private) \n Alicia Haines  18 May 2016  0.50    Albert Nightingale \n Alicia Haines  18 May 2016  3.00    David Poole \n Alicia Haines  18 May 2016  0.25    Eve Reed \n\n Candidate      Date         Service User          Visit (mins)\n Alicia Haines  17 May 2016  Albert Nightingale    60\n Alicia Haines  17 May 2016  Eve Reed              30\n Alicia Haines  17 May 2016  Patricia Nightingale  15\n Alicia Haines  17 May 2016  Raymond Watson        45\n Alicia Haines  18 May 2016  Albert Nightingale    30\n Alicia Haines  18 May 2016  David Poole           180 \n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1464165720, "post_id": 37431861, "comment_id": 62367495, "body": "Thanks @trincot, I&#39;ll give a crack now and get back to you shortly."}, {"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "edited": false, "score": 0, "creation_date": 1465462939, "post_id": 37431861, "comment_id": 62914780, "body": "Hi, not had chance to try it out yet as I have been working on a diferent project the last few weeks. Should be back onto this next week so I will come back and let you know. Thank you :)"}], "tags": [], "owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "is_accepted": false, "score": 0, "last_activity_date": 1464165508, "creation_date": 1464165508, "answer_id": 37431861, "question_id": 37431460, "link": "https://stackoverflow.com/questions/37431460/ms-access-grouped-percentage-calculation/37431861#37431861", "title": "MS Access Grouped Percentage Calculation", "body": "<p>You could use this query to get the 4 different counts in 4 different columns to make the task easier:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT   [Date],\n         Sum(IIf(WebSitePage = \"Visits\", Visits, 0))   AS Visits,\n         Sum(IIf(WebSitePage = \"Basket\", Visits, 0))   AS Basket,\n         Sum(IIf(WebSitePage = \"CheckOut\", Visits, 0)) AS CheckOut,\n         Sum(IIf(WebSitePage = \"ThankYou\", Visits, 0)) AS ThankYou\nFROM     mytable\nGROUP BY [Date]\n</code></pre>\n\n<p>Note that with <a href=\"https://support.office.com/en-us/article/IIf-Function-32436ecf-c629-48a3-9900-647539c764e3\" rel=\"nofollow\"><code>IIf</code></a> you can solve issues where you would use <code>CASE WHEN</code> expressions in more ISO-compliant SQL databases. </p>\n\n<p>If you save the above statement as a Query in MS Access (let's call it MyQuery), then you can do things like this:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT   [Date],\n         100*Basket/CheckOut   AS Basket_CheckOut_Pct,\n         100*CheckOut/ThankYou AS CheckOut_ThankYou_Pct,\n         100*ThankYou/Visits   AS ThankYou_Visits_Pct\nFROM     MyQuery\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1464165508, "creation_date": 1464164237, "last_edit_date": 1464165482, "question_id": 37431460, "link": "https://stackoverflow.com/questions/37431460/ms-access-grouped-percentage-calculation", "title": "MS Access Grouped Percentage Calculation", "body": "<p>Not sure how to best to explain this one but I have a table that for example looks like this:</p>\n\n<pre><code>Date        WebSitePage  Visits\n01/01/2016  Visits       50\n01/01/2016  Basket       40\n01/01/2016  CheckOut     35\n01/01/2016  ThankYou     25\n02/01/2016  Visits       43\n02/01/2016  Basket       23\n02/01/2016  CheckOut     20\n02/01/2016  ThankYou     12\n</code></pre>\n\n<p>As you can see they are website pages (fictional for this example). I want to create a query, be it access query with a calculation or SQL or VBA (limited as you cant use a CASE statement in Access SQL), to calculate the WebSitePage conversion percentage e.g Basket/CheckOut, then CheckOut/ThankYou and also a visits conversion of ThankYou/Visits etc.</p>\n\n<p>I'm struggling how to compile the query or write the calculation.\nIts simple in Excel typically. But I also dont want to split the WebSitePage out into separate columns.</p>\n\n<p>Can anyone point me in the right direction?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1464166343, "creation_date": 1464166343, "answer_id": 37432160, "question_id": 37431426, "link": "https://stackoverflow.com/questions/37431426/put-excel-array-values-in-cache/37432160#37432160", "title": "Put Excel array values in cache", "body": "<p>Let's say that the 'materialType' column is A and the 'category' column is B and the 'finalCategory' column is U. Then you can try this:</p>\n\n<pre><code>Dim strFormula As String\n\nstrFormula = \"=IF(OR(A1=\"\"SERV\"\",B1=\"\"SERVICE\"\"),\"\"SERV\"\",\"\"\"\")\"\nSheet1.Range(\"U1:U700000\").Formula = strFormula\n</code></pre>\n\n<p>This avoids looping over the 700,000 rows and doing an indvidual operation, which can be painfully slow even with no screen updating.</p>\n"}], "owner": {"reputation": 54, "user_id": 5456618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PAC51.png?s=128&g=1", "display_name": "Vincent", "link": "https://stackoverflow.com/users/5456618/vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 37432160, "answer_count": 1, "score": 0, "last_activity_date": 1464166343, "creation_date": 1464164177, "question_id": 37431426, "link": "https://stackoverflow.com/questions/37431426/put-excel-array-values-in-cache", "title": "Put Excel array values in cache", "body": "<p>I have a large database (700.000+ lines in 20 columns) that I import in Excel and do different manipulations on. </p>\n\n<p>An example of such a manipulation is categorizing. For this I use 2 columns: <strong>material type</strong> and <strong>category</strong> and output it in a column '<strong>Final Category</strong>' by:</p>\n\n<pre><code>IF materialType = \"SERV\" or category = \"SERVICE\" then finalCategory = \"SERVICE\"\n</code></pre>\n\n<p>What would be the fastest way to perform this calculation? </p>\n\n<p>Currently I use a FOR loop and already disabled application.screenupdating. </p>\n\n<p>I am also wondering, is there a way to put these columns in cache and then run it?</p>\n\n<p>Hope you can help,</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "edited": false, "score": 0, "creation_date": 1464763239, "post_id": 37431182, "comment_id": 62610476, "body": "Do I understand you correctly? cell = cells in sheets(&quot;data&quot;).columns(&quot;U&quot;)    if cell = 8636 then paste the value to first empty cell in sheets(&quot;KomKo&quot;).columns(&quot;H&quot;) else if cell &lt;&gt; 8636 then paste the value to first empty cell in sheets(&quot;KomKo&quot;).columns(&quot;G&quot;)"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "reply_to_user": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "edited": false, "score": 0, "creation_date": 1464769893, "post_id": 37431182, "comment_id": 62614300, "body": "yes, thats correct"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "edited": false, "score": 0, "creation_date": 1464771186, "post_id": 37431182, "comment_id": 62615117, "body": "Please check the edited answer. Hope that is what you need."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1464613433, "post_id": 37431416, "comment_id": 62544229, "body": "thanks for your response, works just fine! could you check my edit as well?"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465389281, "post_id": 37431416, "comment_id": 62879274, "body": "thanks i checked now and i have the following problem. this code seperates the values &quot;8636&quot; to column H and rest to G as i wanted. but i need to not have a value in H and G in the same row. If a column has 8636 and the next column has another value, then this another value should be the in the next row&#39;s Column G not the current rows. What can i do for this?"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465391004, "post_id": 37431416, "comment_id": 62880581, "body": "Just change the <code>lRowH</code> and <code>lRowG</code> to <code>i</code>"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465457189, "post_id": 37431416, "comment_id": 62911263, "body": "do you mean this current code? it does not work right"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465460992, "post_id": 37431416, "comment_id": 62913599, "body": "Try the new code, I hope that this is what you are looking for."}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465466292, "post_id": 37431416, "comment_id": 62917026, "body": "i got actually one last final question, i have multiple &quot;data&quot; worksheets so i use your code for data, data (2), data(3) etc, so i create new variables like lRowU2; lRowU3 for the corresponding worksheets and i use your code multiple times. I want however the first data sheet to copy and paste it to row number 910, if its 8636 then it should be not on lastempty row in H but on H910 else it should be on G910. How can i do this last part ?"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465466941, "post_id": 37431416, "comment_id": 62917413, "body": "Just replace maxR with 910"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465472171, "post_id": 37431416, "comment_id": 62920820, "body": "my final question and i promise its the last:) when i copy columns from my copysheet, i want it to start copying from the row U2 , this code lets me copy from the row U1, how can i change this ?"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465472243, "post_id": 37431416, "comment_id": 62920875, "body": "Change <code>For i = 1 To lRowU</code> to <code>For i = 2 To lRowU</code>"}, {"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465475761, "post_id": 37431416, "comment_id": 62923539, "body": "there is one final thing i want to ask; i want to copy the colum T from the copy sheet and if this has in Column U of the same row the value 8636(the same thing that we did to seperate the columns) then i would like to paste the value of this in to Column Y to pasteSheet. Else i would like to paste the values of Column T( if there is any other value then 8636 in Column  U of the same row) to Column X in pasteSheet. Do you have any suggestions for this?"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465484433, "post_id": 37431416, "comment_id": 62930390, "body": "Basically you have all what u need in the code already. I would suggest that u get familiar wit basic vba. Anyways, I will update the code tomorrow as it is midnight here in Tokyo and I&#39;m going to bed..."}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "reply_to_user": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1465530991, "post_id": 37431416, "comment_id": 62949758, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/114299/discussion-between-dawid-sa-tokyo-and-yigit-tanverdi\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "is_accepted": true, "score": 2, "last_activity_date": 1465530530, "last_edit_date": 1465530530, "creation_date": 1464164155, "answer_id": 37431416, "question_id": 37431182, "link": "https://stackoverflow.com/questions/37431182/copying-and-pasting-datas-to-the-selected-row/37431416#37431416", "title": "Copying and pasting datas to the selected row", "body": "<p>Change <code>pasteSheet.Cells(Rows.Count, \"B\").End(xlUp).Offset(1, 0).Resize(.Rows.Count, .Columns.Count) = .Value</code> to that <code>pasteSheet.Range(\"B10\").Resize(.Rows.Count, .Columns.Count) = .Value</code></p>\n\n<p>************* ANSWER TO QUESTION EDIT ****************<br>\n******* Added maxR - highest last row from column H and G *******<br>\nYou could do something like this to get what you need:  </p>\n\n<pre><code>Sub check8636values()\n\n    Dim copySheet, pasteSheet As Worksheet\n    Dim lRowU, lRowH, lRowG, maxR, i As Long\n\n    'Dont forget to change to the correct sheet names!!!!\n    Set copySheet = ThisWorkbook.Sheets(\"data\")\n    Set pasteSheet = ThisWorkbook.Sheets(\"KomKo\")\n\n    lRowU = copySheet.Cells(copySheet.Rows.Count, \"U\").End(xlUp).Row\n\n    For i = 1 To lRowU\n\n        lRowG = pasteSheet.Cells(pasteSheet.Rows.Count, \"G\").End(xlUp).Row + 1\n        lRowH = pasteSheet.Cells(pasteSheet.Rows.Count, \"H\").End(xlUp).Row + 1\n        maxR = Application.Max(lRowG,lRowH)\n\n        If copySheet.Cells(i, \"U\").Value = \"8636\" Then\n\n            pasteSheet.Cells(maxR, \"H\").Value = copySheet.Cells(i, \"U\").Value\n            pasteSheet.Cells(maxR, \"Y\").Value = copySheet.Cells(i, \"T\").Value\n\n        Else\n\n            pasteSheet.Cells(maxR, \"G\").Value = copySheet.Cells(i, \"U\").Value\n            pasteSheet.Cells(maxR, \"X\").Value = copySheet.Cells(i, \"T\").Value\n\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "edited": false, "score": 0, "creation_date": 1464613447, "post_id": 37432170, "comment_id": 62544241, "body": "thanks for your response, works just fine! could you check my edit as well?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1464166364, "creation_date": 1464166364, "answer_id": 37432170, "question_id": 37431182, "link": "https://stackoverflow.com/questions/37431182/copying-and-pasting-datas-to-the-selected-row/37432170#37432170", "title": "Copying and pasting datas to the selected row", "body": "<p>since you're dealing with one-column ranges only there's no need for the <code>With-End With</code> blocks to abbreviate the <code>Resize</code> method parameters: just use <code>lRow</code> for the first one only</p>\n\n<p>moreover since you're not showing if <code>copySheet</code> and <code>pasteSheet</code> are from the same workbook it's safer to reference them before <code>.Rows.Count</code>, and prevent issue deriving from their source workbook excel version</p>\n\n<pre><code>    'Determine last row of Column B in copySheet\n    lRow = copySheet.Cells(copySheet.Rows.Count, 1).End(xlUp).Row\n\n    pasteSheet.Cells(pasteSheet.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Resize(lRow) = copySheet.Range(\"BX2:BX\" &amp; lRow).Value        \n    pasteSheet.Range(\"B10\").Resize(lRow).Value = copySheet.Range(\"CC2:CC\" &amp; lRow).Value\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 37431416, "answer_count": 2, "score": 1, "last_activity_date": 1465530530, "creation_date": 1464163404, "last_edit_date": 1464771915, "question_id": 37431182, "link": "https://stackoverflow.com/questions/37431182/copying-and-pasting-datas-to-the-selected-row", "title": "Copying and pasting datas to the selected row", "body": "<p>I have a code piece from my working code which copies and pastes datas from other Worksheets to one masterworkbooks mastersheet. The code below lets me copy and paste datas from column BX to column A's first empty row and does the same for column CC to column B's first empty row. However, I would like to paste the column CC to Column B's (10th) row. How can I do this?</p>\n\n<pre><code> lRow = copySheet.Cells(copySheet.Rows.Count, 1).End(xlUp).Row\n\n With copySheet.Range(\"BX2:BX\" &amp; lRow)\n   pasteSheet.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n   .Resize(.Rows.Count, .Columns.Count) = .Value\n End With\n\n 'Determine last row of Column B in copySheet\n lRow = copySheet.Cells(copySheet.Rows.Count, 1).End(xlUp).Row\n\n With copySheet.Range(\"CC2:CC\" &amp; lRow)\n  pasteSheet.Cells(Rows.Count, \"B\").End(xlUp).Offset(1, 0)\n  .Resize(.Rows.Count, .Columns.Count) = .Value\n End With\n</code></pre>\n\n<p>Could you show me how I can determine how many rows are seletected to be copied?</p>\n\n<p>Edit: Now I would like to add an <code>if</code> condition for another column, which should say: </p>\n\n<blockquote>\n  <p>if</p>\n  \n  <blockquote>\n    <p>column U in Worksheet \"data\" has cell value \"8636\" then these values\n    should be pasted to Column H in Worksheet \"KomKo\"(pastesheet); to the\n    next row as I used the code above in the \"with\" part.</p>\n  </blockquote>\n  \n  <p>Else( If the value in Column H is not 8636) then it should paste the</p>\n  \n  <blockquote>\n    <p>value inside this column to Column G at Worksheet \"KomKo\"(pastesheet)\n    with same preferences as above again</p>\n  </blockquote>\n</blockquote>\n\n<p>.</p>\n\n<p>How can I do this ?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1464168994, "post_id": 37431145, "comment_id": 62369719, "body": "I couldn&#39;t reproduce this with Office 16.0. Can you clarify what exactly happens? When you set one bookmark text all the others get removed (the text, not the bookmark that is)? Or is just the previously altered text removed?  When exactly is it removed?  What about other bookmarks in the document that you don&#39;t access via your code? What happens if you skip <code>obj_BMRange</code> and set <code>word_obj.activedocument.Bookmarks(&quot;Info2&quot;).Range.Text</code> directly?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464169582, "post_id": 37431145, "comment_id": 62370126, "body": "The bookmark is removed automatically, upon setting text to them. After the next bookmark is assigned, the previous altered text gets removed as well. At the end, I have no bookmarks (from the one I am dealing with) and only the last altered text left. Other bookmarks in the document, not specified by the code are not touched. I have tried to skip the obj_BMRange, but the result was the same."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1464171381, "post_id": 37431145, "comment_id": 62371379, "body": "So the bookmark is deleted but the text stays there and then upon altering the next bookmark&#39;s text the text that you entered before (that now has no bookmark anymore) gets removed? Do you have different versions of Word installed and can try another one? Also maybe running the macro from Word makes it easier to track down the issue without all the late binding."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464171886, "post_id": 37431145, "comment_id": 62371714, "body": "The first sentence is correct. No other versions on my PC. Probably running it from Word is a good idea, but I really do not want to put my any code there. Anyhow, I have found some kind of workaround - not using bookmarks and just using &quot;replace&quot;. Not as fancy, but the result is what I have expected. Thanks! :)"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1464173683, "post_id": 37431145, "comment_id": 62372990, "body": "Instead of <code>obj_BMRange.Text =</code>, what happens if you use <code>obj_BMRange.InsertAfter &quot;Info2&quot; &amp; vbCrLf</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1464175702, "post_id": 37434393, "comment_id": 62374283, "body": "If you really need to you could implement your own &quot;bookmark&quot; system by using tags and hiding them in the document. Something like &#167;(...)&#167; and hiding &#167;( and )&#167;. Then use regular expressions to find and replace them. This would let you alter the bookmark content more than once."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464180249, "post_id": 37434393, "comment_id": 62377690, "body": "Can you give an example? I am not quite sure I get what you mean... But is sounds interesting :)"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1464182531, "post_id": 37434393, "comment_id": 62379564, "body": "I imagine something like this: A bookmark looks like <code>&#167;Info001{VITYA1}&#167;</code> in plain text but you configure it such that <code>&#167;Info001{</code> and <code>}&#167;</code> are hidden (setting <code>Font.Hidden = true</code>). I chose <code>&#167;</code> in my case because I figured it&#39;s the least likely to appear elsewhere in my document but you can pick anything you like. Then you can write a function that looks for a regular expression that looks like <code>&#167;name{...}&#167;</code> and returns the range of <code>...</code>. It&#39;s a lot of effort for something that Word should be able to do better though."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1464184906, "post_id": 37434393, "comment_id": 62381422, "body": "Yes, sounds like a good idea, this thing with the regex and the &quot;&#167;&quot; sign. But yeah, it is like an overkill. And my code now looks pretty ok. Thanks! :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1464172059, "creation_date": 1464172059, "answer_id": 37434393, "question_id": 37431145, "link": "https://stackoverflow.com/questions/37431145/vba-word-bookmarks-disappearing-when-i-try-to-write-text-on-them/37434393#37434393", "title": "VBA - Word - Bookmarks disappearing when I try to write text on them", "body": "<p>Just some workaround I found - using replace in Word - the code is a little \"ugly\", not dry, but it works:</p>\n\n<pre><code>With word_obj.ActiveDocument.Content.Find\n  .Text = \"Info001\"\n  .Replacement.Text = \"VITYA1\"\n  .Execute Replace:=wdReplaceAll\n\n  .Text = \"Info002\"\n  .Replacement.Text = \"VITYA2\"\n  .Execute Replace:=wdReplaceAll\n\n  .Text = \"Info003\"\n  .Replacement.Text = \"VITYA3\"\n  .Execute Replace:=wdReplaceAll\n\n  .Text = \"Info004\"\n  .Replacement.Text = \"VITYA4\"\n  .Execute Replace:=wdReplaceAll\n\nEnd With\n\nWith word_obj.ActiveDocument.Shapes(1).TextFrame.TextRange.Find\n    .Text = \"Info005\"\n    .Replacement.Text = \"VITYATA5\"\n    .Execute Replace:=wdReplaceAll\n\n    .Text = \"Info006\"\n    .Replacement.Text = \"VITYATA6\"\n    .Execute Replace:=wdReplaceAll\n\n    .Text = \"Info007\"\n    .Replacement.Text = \"VITYATA7\"\n    .Execute Replace:=wdReplaceAll\n\n    .Text = \"Info008\"\n    .Replacement.Text = \"VITYATA8\"\n    .Execute Replace:=wdReplaceAll\n\nEnd With\n</code></pre>\n\n<p>Still, if someone has an idea about how to solve the original issue, I would like to see it :)</p>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1464335122, "post_id": 37445235, "comment_id": 62452865, "body": "Hi, thanks for the input. I have not tested it yet, but it seems ok. Concerning the on-error handling, in my code I set it back with the following code:     If [set_in_production] Then On Error GoTo Main_Error Else On Error GoTo 0"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1464201780, "creation_date": 1464201780, "answer_id": 37445235, "question_id": 37431145, "link": "https://stackoverflow.com/questions/37431145/vba-word-bookmarks-disappearing-when-i-try-to-write-text-on-them/37445235#37445235", "title": "VBA - Word - Bookmarks disappearing when I try to write text on them", "body": "<p>The following approach works for me. (Note that I had to remove the lines of code specific to your workbook and files since I don't have access to any of that. But it doesn't (shouldn't) change anything relevant to the problem you present.)</p>\n\n<p>Something that makes no sense in the code you posted is declaring a <code>word_doc</code> variable, then not using it, instead relying on <code>ActiveDocument</code>. I substituted <code>word_doc</code> as appropriate.</p>\n\n<p>I also inserted <code>On Error GoTo 0</code> to re-instate normal error handling. When you use <code>On Error Resume Next</code> normal error handling is deactivated, which you need for your approach with <code>GetObject</code>. But once the Word application is accessed it needs to be turned back on. Using it at the end of the routine makes no sense.</p>\n\n<p>As mentioned by others, Word removes a bookmark when content is written to it <em>if</em> the bookmark already has content (you see [square brackets]). To get around this, the bookmark needs to be recreated around the content assigned to the Range. Since this involves a couple of steps I wrote a separate function for writing to the bookmark - <code>WriteToBookmarkRetainBookmark</code>.</p>\n\n<p>When I test this from Excel the information is written to each bookmark and the bookmarks exist at the end.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Main()\n\n    Dim word_obj            As Object\n    Dim word_doc            As Object\n    Dim obj                 As Object\n    Dim rng_range           As Variant\n    Dim obj_table           As Object\n    Dim origDoc$\n    Dim l_row&amp;: l_row = 2\n\n    On Error Resume Next\n\n    Set word_obj = GetObject(, \"Word.application.14\")\n    If Err.Number = 429 Then\n        Set word_obj = CreateObject(\"Word.application.14\")\n        Err.Number = 0\n    End If\n    On Error GoTo 0\n\n    word_obj.Visible = True\n    word_obj.DisplayAlerts = False\n    Set word_doc = word_obj.ActiveDocument\n'    word_obj.ActiveDocument.SaveAs Filename:=origDoc\n\n    'after the saveas -&gt; write\n\n    Dim obj_BMRange     As Object\n\n    Set obj_BMRange = word_doc.Bookmarks(\"Info1\").Range\n    WriteToBookmarkRetainBookmark obj_BMRange, \"Info1\" &amp; vbCrLf\n    Set obj_BMRange = Nothing\n\n    Set obj_BMRange = word_doc.Bookmarks(\"Info2\").Range\n    WriteToBookmarkRetainBookmark obj_BMRange, \"Info2\" &amp; vbCrLf\n    Set obj_BMRange = Nothing\n\n    Set obj_BMRange = word_doc.Bookmarks(\"Info3\").Range\n    WriteToBookmarkRetainBookmark obj_BMRange, \"Info3\" &amp; vbCrLf\n    Set obj_BMRange = Nothing\n\n    word_obj.DisplayAlerts = False\n\n    Set word_obj = Nothing\n    Set word_doc = Nothing\n    Set rng_range = Nothing\n    Set obj = Nothing\n    Set obj_table = Nothing\n\n    Exit Sub\n\nMain_Error:\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Main of Sub mod_main\"\n\nEnd Sub\n\nFunction WriteToBookmarkRetainBookmark(rng As Object, content As String)\n    Dim sBkmName As String\n\n    sBkmName = rng.Bookmarks(1).Name\n    rng.Text = content\n    rng.Document.Bookmarks.Add sBkmName, rng\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1211, "favorite_count": 0, "accepted_answer_id": 37445235, "answer_count": 2, "score": 1, "last_activity_date": 1464201780, "creation_date": 1464163330, "last_edit_date": 1464169725, "question_id": 37431145, "link": "https://stackoverflow.com/questions/37431145/vba-word-bookmarks-disappearing-when-i-try-to-write-text-on-them", "title": "VBA - Word - Bookmarks disappearing when I try to write text on them", "body": "<p>I am trying to make a macro in Excel, which takes a sample Word file with some bookmarks on it and writes something on the bookmarks. It works for one bookmark, but for the second, third, etc it simply deletes the other entries.</p>\n\n<p>E.g. after the running of my code, I have only written \"Info4\". I see Info1, Info2 and Info 3 being written and deleted while the macro is run.</p>\n\n<p>Any ideas? Here comes the code:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Main()\n\n    If [set_in_production] Then On Error GoTo Main_Error\n\n    Dim word_obj            As Object\n    Dim word_doc            As Object\n    Dim obj                 As Object\n    Dim rng_range           As Variant\n    Dim obj_table           As Object\n    Dim origDoc$\n    Dim l_row&amp;: l_row = 2\n\n    On Error Resume Next\n\n    Set word_obj = GetObject(, \"Word.application.14\")\n    If Err.Number = 429 Then\n        Set word_obj = CreateObject(\"Word.application.14\")\n        Err.Number = 0\n    End If\n\n    If [set_in_production] Then On Error GoTo Main_Error Else On Error GoTo 0\n    origDoc$ = ActiveWorkbook.Path &amp; \"\\\" &amp; CStr(Replace(Time, \":\", \"_\")) &amp; \"_\" &amp; generate_name &amp; \".docx\"\n    word_obj.Visible = True\n    word_obj.DisplayAlerts = False\n    Set word_doc = word_obj.Documents.Open(ActiveWorkbook.Path &amp; \"\\SAMPLE_2.docx\")\n    word_obj.activedocument.SaveAs Filename:=origDoc\n\n    'after the saveas -&gt; write\n\n    Dim obj_BMRange     As Object\n\n    Set obj_BMRange = word_obj.activedocument.Bookmarks(\"Info1\").Range\n    obj_BMRange.Text = \"Info1\" &amp; vbCrLf\n    Set obj_BMRange = Nothing\n\n    Set obj_BMRange = word_obj.activedocument.Bookmarks(\"Info2\").Range\n    obj_BMRange.Text = \"Info2\" &amp; vbCrLf\n    Set obj_BMRange = Nothing\n\n    Set obj_BMRange = word_obj.activedocument.Bookmarks(\"Info3\").Range\n    obj_BMRange.Text = \"Info3\" &amp; vbCrLf\n    Set obj_BMRange = Nothing\n\n    Set obj_BMRange = word_obj.activedocument.Bookmarks(\"Info4\").Range\n    obj_BMRange.Text = \"Info4\" &amp; vbCrLf\n    Set obj_BMRange = Nothing\n    word_obj.DisplayAlerts = False\n\n    Set word_obj = Nothing\n    Set word_doc = Nothing\n    Set rng_range = Nothing\n    Set obj = Nothing\n    Set obj_table = Nothing\n\n    On Error GoTo 0\n    Exit Sub\n\nMain_Error:\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Main of Sub mod_main\"\n\nEnd Sub\n</code></pre>\n\n<p>I have tried to rewrite the bookmarks, once they are deleted, but the success was no different. Thus, waiting for ideas! :D</p>\n"}, {"tags": ["vba", "object", "required"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1464162180, "post_id": 37430690, "comment_id": 62365395, "body": "Where is you error? Plz be specific"}, {"owner": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1464162249, "post_id": 37430690, "comment_id": 62365432, "body": "Error in the function call line : &quot;col_new = findcol(S(j + 1), r)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464166347, "post_id": 37430950, "comment_id": 62367892, "body": "Thanks!!!The old error has been rectified if I declare TasksWB in the function. But I m getting another error &quot;Runtime - Automation error&quot; and I m asked to &quot;enter the task names correctly&quot; but all strings are correct.But the &quot;if&quot; condition is not getting executed in the function if the string is found"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1464162747, "creation_date": 1464162747, "answer_id": 37430950, "question_id": 37430690, "link": "https://stackoverflow.com/questions/37430690/error-object-required-in-vba-referred-to-duplicate-questions/37430950#37430950", "title": "Error &quot;object required&quot; in VBA , referred to duplicate questions", "body": "<p><code>tasksWB</code> isn't recognized in the <code>findcol</code> function as it is declared as <code>Private</code> (=<code>Dim</code>) in the main process.</p>\n\n<p>Declare it at the top of your module, and it'll work! ;)</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464172923, "post_id": 37431562, "comment_id": 62372518, "body": "Done!!!That error rectified long back .But still I m getting Runtime error-Automation error in line after the function call statement in sub workallotment() &quot; If (max &lt; tasksWB.Worksheets(&quot;May&quot;).Cells(r + 1, col_new).Value) Then max = tasksWB.Worksheets(&quot;May&quot;).Cells(r + 1, col_new).Value imps = tasksWB.Worksheets(&quot;May&quot;).Cells(r, col_new).Value &quot;"}, {"owner": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464176521, "post_id": 37431562, "comment_id": 62374840, "body": "I found out what the error is...When the function opens Workbooks.Open(&quot;E:/tasks.xlsx&quot;). It closes it when it comes back to sub workallotment().So it shows Runtime error because tasks.xlsx is not open.Can you help me fix this situation alone..please"}, {"owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "reply_to_user": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464181541, "post_id": 37431562, "comment_id": 62378774, "body": "Your code isn&#39;t closing the workbook. So it won&#39;t get closed just because it exists the method. You might want to re-paste your code above, to show what it now looks like. It&#39;s not clear from your various answers what you have done now. A Runtime error could be caused by the workbook not being in the place it says it is, or the worksheet name not being there."}, {"owner": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464184391, "post_id": 37431562, "comment_id": 62381025, "body": "I have edited the code and pasted it above after making changes"}, {"owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "reply_to_user": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464186935, "post_id": 37431562, "comment_id": 62383143, "body": "You&#39;re <code>findcol</code> is wrong. You are passing in the <code>theWB</code> in and then instantiating a new <code>tasksWB</code> by opening your testbook again. that will close the original file. only use <code>theWB</code> in your <code>findcol</code> method."}, {"owner": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464246657, "post_id": 37431562, "comment_id": 62408267, "body": "Thank you...I got the result correctly printed...But still I get a Runtime error message...after getting correct result ..Runtime error 1004 - Application defined or object defined error . I have re-pasted the code againa above after doing the changes you mentioned"}, {"owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "reply_to_user": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "edited": false, "score": 0, "creation_date": 1464247593, "post_id": 37431562, "comment_id": 62408806, "body": "Ive updated my answer with Edit 3. showing what the findcol should look like."}], "tags": [], "owner": {"reputation": 189, "user_id": 5740204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Ib7y.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/5740204/gareth"}, "is_accepted": true, "score": 1, "last_activity_date": 1464247542, "last_edit_date": 1464247542, "creation_date": 1464164546, "answer_id": 37431562, "question_id": 37430690, "link": "https://stackoverflow.com/questions/37430690/error-object-required-in-vba-referred-to-duplicate-questions/37431562#37431562", "title": "Error &quot;object required&quot; in VBA , referred to duplicate questions", "body": "<p>Krishnan,</p>\n\n<p>In your main proc <code>workallotment</code> you declare the variable <code>tasksWB</code>. </p>\n\n<p>In your method 'findcol' you then reference <code>tasksWB</code>. It looks like you've pulled this code out of the main proc. The tasksWB only has scope within <code>workallot</code> and so you need to give <code>findcol</code> this object so it will have it within it's scope as well.</p>\n\n<p>I would recommend that you pass the tasksWB into the method, as a third parameter.</p>\n\n<p>Your method would then look as follows.</p>\n\n<p>Edit for your comment of why findcol doesn't return. The <code>Exit Function</code> will ensure that the method is exited immediately after setting the return value. Without this you would end up in the asking for the correct task name again.</p>\n\n<pre><code>Public Function findcol(S As String, row As Integer, theWB as Workbook) As Integer\n    col = 2                  ' checking from column 2\n    Do While Not IsEmpty(theWB.Worksheets(\"May\").Cells(row, col).Value)\n        If (S = theWB.Worksheets(\"May\").Cells(row, col).Value) Then                   \n           findcol = col                         ' if task string is found in column                      \n           Exit Function\n        End If\n        'MsgBox (\"Enter correct task names\")  Not sure why this is here.\n        col = col + 1                            ' return column found\n    Loop\nEnd Function\n</code></pre>\n\n<p>and you'd call it with </p>\n\n<pre><code>col_new = findcol(S(j + 1), r, tasksWB)    ' ERROR line function to find column of task string\n</code></pre>\n\n<p>This will ensure that you do not \"leak\" your variable definition into global scope, and that you also ensure that your method doesn't depend on external globals.</p>\n\n<p>Edit 3:\nYour findcol is still wrong.</p>\n\n<pre><code>Public Function findcol(S As String, row As Integer, theWB As Workbook) As Integer\n    Dim col As Integer\n    '******* you don't need this because you can exit early\n    'Dim addr As Integer\n    col = 2                  ' checking from column 2\n\n    '*****   THIS LINE NEEDS TO BE REMOVED because you are using theWB being passed in *****\n    'Set tasksWB = Workbooks.Open(\"E:/tasks.xlsx\")\n\n\n    Do While Not IsEmpty(theWB.Worksheets(\"May\").Cells(row, col).Value)\n\n        '****** this line must use theWB\n        'If (StrComp(Trim(S), Trim(tasksWB.Worksheets(\"May\").Cells(row, col).Value)) = 0) Then\n        If (StrComp(Trim(S), Trim(theWB.Worksheets(\"May\").Cells(row, col).Value)) = 0) Then\n\n            '*************  you can exit early once you've found what you need.\n            'addr = col                         ' if task string is found in column\n            findcol = col\n            exit function            \n        End If\n        col = col + 1                            ' return column found\n    Loop\n    ' You can exit early so don't need this.\n    ' findcol = addr\nEnd Function\n</code></pre>\n\n<p>You should probably do a check when you call the function that the value hasn't returned 0, eg</p>\n\n<pre><code>new_col = findcol( .... )\nif new_col = 0 then\n   msgbox \"couldn't find the column with that str\" &amp; S(j + 1)\nend if\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6330204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad6b4ef00b29a089599b94f0affa30b?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnan G", "link": "https://stackoverflow.com/users/6330204/krishnan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 37431562, "answer_count": 2, "score": -1, "last_activity_date": 1464247542, "creation_date": 1464161964, "last_edit_date": 1464247173, "question_id": 37430690, "link": "https://stackoverflow.com/questions/37430690/error-object-required-in-vba-referred-to-duplicate-questions", "title": "Error &quot;object required&quot; in VBA , referred to duplicate questions", "body": "<p>My purpose is to split a task into constituent tasks and find the most important one.The macro is written in \"May\" sheet of workallotment.xlsm and the tasks are in tasks.xlsx</p>\n\n<p>For example:</p>\n\n<pre><code>                                   Constituents  Constituents  Important Imp\nPraveen T1  T2  T3  T4  T5  T6     T1+T2+T3 =T5  T3+T5+T6 =T9     T1      T6\n         4  3   1   2   8   9               \nKarthik P1  P2  P3  P4          \" among T1,T2,T3- T1 takes more time\".its imp       \n         6  3   2   2                       \nWalter  c1  c2  c3  c4                      \n        1   2   3   4                       \nArvind  g1  g2  g3                          \n         2  1   3                           \nSreelatha   h1  h2  h3                          \n            2   1   1                           \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Sub workallotment()\n    Dim workallotmentWB, tasksWB As Workbook\n    Dim waSheet As Worksheet\n    Dim str(9) As String\n    Dim splitArray() As String, S(10) As String\n    Dim col_new As Integer\n\n    Dim wa_nameRng As Range\n\n    Dim r As Integer, max As Integer, imps As String\n    Dim wa_nameRow, wa_firstRow, wa_lastRow As Integer  'work allotment rows\n    Dim t_firstRow, t_lastrow As Integer                'task rows\n\n    Dim curTaskCol As Integer   'current task column\n    Dim wa_tmpcol As Integer    'work allotment, temp column\n\n\n        Set workallotmentWB = ThisWorkbook\n        Set tasksWB = Workbooks.Open(\"E:/tasks.xlsx\")\n\n        'notes on data structure:\n        '- tasks workbook:\n            'first name starts in A1 of \"Sheet1\"\n        '- workallotment workbook:\n            'first name starts in A2 of Sheet named \"workallotment\"\n            'tasks are to be written starting in B2\n            'in Row 1 are headers (number of days)\n\n        t_firstRow = 1\n        wa_firstRow = 2\n        wa_nameRow = 0\n\n        Set waSheet = workallotmentWB.Worksheets(\"May\")             ' in this file - workallotment.xlsm\n\n        With tasksWB.Worksheets(\"May\")                              ' in tasks.xlsx which is attached\n\n            'finding the last rows\n            t_lastrow = .Range(\"A1000000\").End(xlUp).row + 1\n            wa_lastRow = waSheet.Range(\"A1000000\").End(xlUp).row\n\n            'goes through all the names in tasks_Sheet1\n            For r = t_firstRow To t_lastrow Step 2\n\n\n                Set wa_nameRng = waSheet.Range(\"A:A\").find(.Range(\"A\" &amp; r).Value, _\n                LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext, MatchCase:=False)\n\n                If Not wa_nameRng Is Nothing Then\n\n                    wa_nameRow = wa_nameRng.row\n\n                    curTaskCol = 2\n                    wa_tmpcol = 2\n\n                    Do While Not IsEmpty(.Cells(r, curTaskCol).Value)\n\n                        For C = 1 To .Cells(r + 1, curTaskCol).Value\n                            waSheet.Cells(wa_nameRow, wa_tmpcol).Value = .Cells(r, curTaskCol).Value\n                            wa_tmpcol = wa_tmpcol + 1\n                        Next C\n\n                        curTaskCol = curTaskCol + 1\n\n                    Loop\n\n                End If\n\n            Next r\n\n        End With\n\n        MsgBox (\"done\")\n\n\n\n    For r = t_firstRow To t_lastrow Step 2                ' loop to find importance\n\n    col = 2                                               'setting to initial col\n    curTaskCol = 17    ' position input - constituent jobs at 17th col in tasks.xls\n\n    Do While Not IsEmpty(tasksWB.Worksheets(\"May\").Cells(r, curTaskCol).Value)\n\n     str(curTaskCol - 16) = tasksWB.Worksheets(\"May\").Cells(r, curTaskCol).Value\n            ' reading input to first array of string element\n\n    substr = Left(str(curTaskCol - 16), Application.WorksheetFunction.find(\"=\", str(curTaskCol - 16)) - 1)         ' if T1+T2=T3 it'll look before \"=\" symbol\n    MsgBox (substr)\n    splitArray() = Split(substr, \"+\")  ' if T1+T2 it will be split as T1 &amp; T2\n\n\n    For i = LBound(splitArray) To UBound(splitArray)\n\n        S(i + 1) = splitArray(i)          ' assigning split elements to string array\n\n        Next i\n    For i = LBound(splitArray) To UBound(splitArray)\n        col_new = 2                   ' checking from 2nd column\n\n\n        Do While Not IsEmpty(tasksWB.Worksheets(\"May\").Cells(r, col_new).Value)\n         If (S(i + 1) = tasksWB.Worksheets(\"May\").Cells(r, col_new).Value) Then                 'initialising max and imps\n          imps = S(i + 1)       ' most important job\n\n          max = tasksWB.Worksheets(\"May\").Cells(r + 1, col_new).Value\n\n        End If                       ' maximum time taken for task\n        col_new = col_new + 1\n        Loop\n\n        For j = LBound(splitArray) To UBound(splitArray)\n\n          col_new = findcol(S(j + 1), r, tasksWB)\n\n\n          If (max &lt; tasksWB.Worksheets(\"May\").Cells(r + 1, col_new).Value) Then\n          max = tasksWB.Worksheets(\"May\").Cells(r + 1, col_new).Value\n          imps = tasksWB.Worksheets(\"May\").Cells(r, col_new).Value\n\n        End If\n        Next j\n\n        Next i\n    tasksWB.Worksheets(\"May\").Cells(r, curTaskCol + 6).Value = imps\n                                ' assign most IMPORTANT task on 6th column from current column\n    curTaskCol = curTaskCol + 1               ' RUNTIME ERROR 1004\n\n     Loop\n\n\n     Next r\n\n\nEnd Sub\n\nPublic Function findcol(S As String, row As Integer, theWB As Workbook) As Integer\n    Dim col As Integer, addr As Integer\n    col = 2                  ' checking from column 2\n    'Set tasksWB = Workbooks.Open(\"E:/tasks.xlsx\")\n\n\n    Do While Not IsEmpty(theWB.Worksheets(\"May\").Cells(row, col).Value)\n\n         If (StrComp(Trim(S), Trim(theWB.Worksheets(\"May\").Cells(row, col).Value)) = 0) Then\n           addr = col                         ' if task string is found in column\n        End If\n        col = col + 1                            ' return column found\n        Loop\n        findcol = addr\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1464161855, "post_id": 37430075, "comment_id": 62365231, "body": "The <code>Format</code> procedure converts the date to a string. Writing it back to the cell converts it to a date by guessing the format (which is no properly done since the year is now on 2 digits). To keep it as a string, you could add a quote in front: <code>Cells(...).Value = &quot;&#39;&quot; &amp; Format(...) </code>."}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1464161054, "creation_date": 1464161054, "answer_id": 37430393, "question_id": 37430075, "link": "https://stackoverflow.com/questions/37430075/vba-excel-2013-format-function-changes-date/37430393#37430393", "title": "VBA Excel 2013 Format Function changes Date", "body": "<p>If you wish to convert to an actual date and change the displayed format, use:</p>\n\n<pre><code>With rng.Cells(intStartRow, rng.Columns.Count + 1)\n   .Value = CDate(.Value)\n   .NumberFormat = \"mmm-yy\"\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "is_accepted": false, "score": 1, "last_activity_date": 1464162051, "creation_date": 1464162051, "answer_id": 37430721, "question_id": 37430075, "link": "https://stackoverflow.com/questions/37430075/vba-excel-2013-format-function-changes-date/37430721#37430721", "title": "VBA Excel 2013 Format Function changes Date", "body": "<p>The reason why it happens is that the date information is stored internally as decimal number and is displayed with the date format applied to the cell.\nIn your code you change the date information to a string as the result of the function <code>Format()</code> is always a string.\nA soultion to solve the problem is suppliey by Rory</p>\n"}], "owner": {"reputation": 130, "user_id": 5856153, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ea38303c73d487e4ecd63373176b7ba1?s=128&d=identicon&r=PG&f=1", "display_name": "flohdieter", "link": "https://stackoverflow.com/users/5856153/flohdieter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 37430393, "answer_count": 2, "score": 0, "last_activity_date": 1464162051, "creation_date": 1464160071, "question_id": 37430075, "link": "https://stackoverflow.com/questions/37430075/vba-excel-2013-format-function-changes-date", "title": "VBA Excel 2013 Format Function changes Date", "body": "<p>The following line of code changes not only the format of date, it also changes the value of the date. Why does this happen and how can I avoid it?</p>\n\n<p>Code:</p>\n\n<pre><code>rng.Cells(intStartRow, rng.Columns.Count + 1) = _\nFormat(rng.Cells(intStartRow, rng.Columns.Count + 1).Value, \"mmm-yy\")\n</code></pre>\n\n<p>Value of  <code>rng.Cells(intStartRow, rng.Columns.Count + 1).Value</code> before executing the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cbByL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cbByL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Value of  <code>rng.Cells(intStartRow, rng.Columns.Count + 1).Value</code> after executing the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/AtKFu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AtKFu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 1, "creation_date": 1464159189, "post_id": 37429671, "comment_id": 62363753, "body": "yes, you can loop columns and compare their fillColor (or what is it exactly) and if its red delete whole column. But i think nobody cant help you more if you didnt provide more info"}, {"owner": {"reputation": 130, "user_id": 5856153, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ea38303c73d487e4ecd63373176b7ba1?s=128&d=identicon&r=PG&f=1", "display_name": "flohdieter", "link": "https://stackoverflow.com/users/5856153/flohdieter"}, "edited": false, "score": 1, "creation_date": 1464160256, "post_id": 37429671, "comment_id": 62364326, "body": "Just loop trough the heading and delete the red ones<code>If TargetRange.Interior.ColorIndex = 3 Then TargetRange.Delete End If</code>"}, {"owner": {"reputation": 2298, "user_id": 6201755, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/001427804e7d9b7787a96ffbdc7c1fd8?s=128&d=identicon&r=PG&f=1", "display_name": "ib11", "link": "https://stackoverflow.com/users/6201755/ib11"}, "edited": false, "score": 0, "creation_date": 1464160256, "post_id": 37429671, "comment_id": 62364325, "body": "Can you paste a screen capture so we can see how your sheet looks?"}, {"owner": {"reputation": 1, "user_id": 6379539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_zCrmKF34Gw/AAAAAAAAAAI/AAAAAAAAyho/Y1sa9bQcpfA/photo.jpg?sz=128", "display_name": "Saritha Machadi", "link": "https://stackoverflow.com/users/6379539/saritha-machadi"}, "edited": false, "score": 0, "creation_date": 1464234740, "post_id": 37429671, "comment_id": 62403774, "body": "Can you help me writing complete code, Thanks"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "edited": false, "score": 0, "creation_date": 1464764443, "post_id": 37429671, "comment_id": 62611091, "body": "@SarithaMachadi Please check the edited answer."}, {"owner": {"reputation": 1, "user_id": 6379539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_zCrmKF34Gw/AAAAAAAAAAI/AAAAAAAAyho/Y1sa9bQcpfA/photo.jpg?sz=128", "display_name": "Saritha Machadi", "link": "https://stackoverflow.com/users/6379539/saritha-machadi"}, "edited": false, "score": 0, "creation_date": 1464766142, "post_id": 37429671, "comment_id": 62612049, "body": "I have got it..thank you all"}], "answers": [{"comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 1, "creation_date": 1464168592, "post_id": 37431184, "comment_id": 62369448, "body": "This is not an answer to the original question, but a comment to a new question posted as an answer... phew."}], "tags": [], "owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "is_accepted": false, "score": 1, "last_activity_date": 1464764370, "last_edit_date": 1464764370, "creation_date": 1464163406, "answer_id": 37431184, "question_id": 37429671, "link": "https://stackoverflow.com/questions/37429671/how-can-i-remove-columns-with-red-heading-in-vba/37431184#37431184", "title": "How can I remove columns with red heading in VBA", "body": "<p>Remove the space in the line <code>If Cells(1,ICntr). Font.ColorIndex = 3 Then</code> between <code>Cells(1,ICntr).</code> and <code>Font.ColorIndex</code> also change <code>Columns(ICntr).EntireColumn.Delete</code> to <code>Columns(ICntr).Delete</code></p>\n\n<p>************* EDIT ************:<br>\nAssuming that you have data/text in your headings (first cell of column) this macro will do the trick. Remember that when looping through ROWS or COLUMNS and deleting then, you should always REVERSE the loop to make sure all rows or columns were checked!</p>\n\n<pre><code>Sub DeleteColumnsWithRedHeader()\n\nDim ws As Worksheet\nDim lColumn As Long\nDim i As Long\n\n'Change to you sheet name!!!!!!!!!!!!!\nSet ws = Sheets(\"YOUR_SHEET_NAME\")\n\n'This will give you the last column index with data\nlColumn = ws.Cells(1, Columns.Count).End(xlToLeft).Column\n\n'Loop through all column with data - REVERSE LOOP TO CHECK ALL COLUMNS\nFor i = lColumn To 1 Step -1\n\n    'If first cell in column is RED then delete that column\n    If ws.Cells(1, i).Interior.ColorIndex = 3 Then ws.Columns(i).Delete\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6379539, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_zCrmKF34Gw/AAAAAAAAAAI/AAAAAAAAyho/Y1sa9bQcpfA/photo.jpg?sz=128", "display_name": "Saritha Machadi", "link": "https://stackoverflow.com/users/6379539/saritha-machadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1464764370, "creation_date": 1464158739, "last_edit_date": 1531164843, "question_id": 37429671, "link": "https://stackoverflow.com/questions/37429671/how-can-i-remove-columns-with-red-heading-in-vba", "title": "How can I remove columns with red heading in VBA", "body": "<p>I have file with red heading, and i want to delete whole column using VBA code?\nCan i use loop to find red heading and delete the column instead of Column Countrt??</p>\n"}, {"tags": ["c#", "vba", "serial-port", "modem", "mscomm32"], "owner": {"reputation": 220, "user_id": 5052045, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/6nru0.jpg?s=128&g=1", "display_name": "Dac", "link": "https://stackoverflow.com/users/5052045/dac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1469428922, "creation_date": 1464156820, "last_edit_date": 1469428922, "question_id": 37429108, "link": "https://stackoverflow.com/questions/37429108/oncomm-event-ring-not-firing", "title": "OnComm event &#39;Ring&#39; not firing", "body": "<p><a href=\"https://i.stack.imgur.com/Rc8SO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rc8SO.png\" alt=\"http://imgur.com/NZUl00t\"></a></p>\n\n<p>I made an app for calling and texting using an LG phone. I can connect to my phone through the serial in the image to make calls and text. However, when i receive a call, the 'Ring event' of my OnComm object doesn't fire. My onComm object receives an event, but not a 'Ring event'.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "date", "find", "vba"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1464156817, "post_id": 37428988, "comment_id": 62362482, "body": "just loop all cells and compare it with actual date, or if you dont care about data order, you can use autofilter, which can speed up process."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1464158047, "post_id": 37428988, "comment_id": 62363090, "body": "You need to define your question <i>much</i> more clearly. Show us what your data looks like, and explain what you mean by &quot;select only today&#39;s date&quot; and what you want to do with that date."}, {"owner": {"reputation": 41, "user_id": 6349656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEsjxu7kpDQ/AAAAAAAAAAI/AAAAAAAAJTs/9B2n6cu2Uk4/photo.jpg?sz=128", "display_name": "Levent Nergiz", "link": "https://stackoverflow.com/users/6349656/levent-nergiz"}, "edited": false, "score": 0, "creation_date": 1464159320, "post_id": 37428988, "comment_id": 62363830, "body": "I only need a macro that finds today&#39;s date between cells.I dont need other option like filter or others. Normally i can use ctrl-find but every time, i have to write today&#39;s date. so i thought a button-macro pair can do this for me.  it must be the easiest thing, but  i am totally new beginner for vba."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6349656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEsjxu7kpDQ/AAAAAAAAAAI/AAAAAAAAJTs/9B2n6cu2Uk4/photo.jpg?sz=128", "display_name": "Levent Nergiz", "link": "https://stackoverflow.com/users/6349656/levent-nergiz"}, "edited": false, "score": 0, "creation_date": 1464162597, "post_id": 37430492, "comment_id": 62365627, "body": "Thank  you so much :)"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 41, "user_id": 6349656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEsjxu7kpDQ/AAAAAAAAAAI/AAAAAAAAJTs/9B2n6cu2Uk4/photo.jpg?sz=128", "display_name": "Levent Nergiz", "link": "https://stackoverflow.com/users/6349656/levent-nergiz"}, "edited": false, "score": 0, "creation_date": 1464162789, "post_id": 37430492, "comment_id": 62365714, "body": "@Levent Nergiz In stack overflow saying thanks is by accepting the answer by ticking a right mark below lower triangle on left side. This is one thing which you can only do. I am glad that it worked for you."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": true, "score": 0, "last_activity_date": 1464161717, "last_edit_date": 1464161717, "creation_date": 1464161359, "answer_id": 37430492, "question_id": 37428988, "link": "https://stackoverflow.com/questions/37428988/find-date-in-a-range/37430492#37430492", "title": "Find date in a range", "body": "<p>I assume you have consistently filled data. If so we can use used Range to find out Last Row. \nPlease Try this code. It will colour the cells having current data. I have used limited range for testing purposes but I think it will work on a larger range also.</p>\n\n<pre><code>Sub Highlight()\n    Dim Rng As Range\n    Dim lastRow As Long, lngRow As Long\n    Dim strColumn As Integer\n    lastRow = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n    Dim lastColumn As Integer\n    lastColumn = ActiveSheet.UsedRange.Columns(ActiveSheet.UsedRange.Columns.Count).Column\n    For strColumn = 1 To lastColumn\n\n        With ActiveSheet\n            For lngRow = 2 To lastRow  ' Assuming Row 1 As a header Row\n                If IsDate(.Cells(lngRow, strColumn).Value) And CDate(.Cells(lngRow, strColumn).Value) = Date Then\n                .Cells(lngRow, strColumn).Interior.ColorIndex = 3\n                End If\n            Next lngRow\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NAewt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NAewt.jpg\" alt=\"Snapshot highlighting today&#39;s date\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 6349656, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pEsjxu7kpDQ/AAAAAAAAAAI/AAAAAAAAJTs/9B2n6cu2Uk4/photo.jpg?sz=128", "display_name": "Levent Nergiz", "link": "https://stackoverflow.com/users/6349656/levent-nergiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 37430492, "answer_count": 1, "score": -1, "last_activity_date": 1464161717, "creation_date": 1464156376, "last_edit_date": 1531164843, "question_id": 37428988, "link": "https://stackoverflow.com/questions/37428988/find-date-in-a-range", "title": "Find date in a range", "body": "<p>I have so many dates in a range like A1: WW1\nI mean there is a one date in every cell.</p>\n\n<p>I need a macro that selects only today's date between other dates.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 1775611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cef843751b8c5d1f982888606cf55ad8?s=128&d=identicon&r=PG", "display_name": "user1775611", "link": "https://stackoverflow.com/users/1775611/user1775611"}, "edited": false, "score": 0, "creation_date": 1464156505, "post_id": 37428909, "comment_id": 62362333, "body": "Thanks! Works like a charm. Didn&#39;t know about .Formula."}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 81, "user_id": 1775611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cef843751b8c5d1f982888606cf55ad8?s=128&d=identicon&r=PG", "display_name": "user1775611", "link": "https://stackoverflow.com/users/1775611/user1775611"}, "edited": false, "score": 0, "creation_date": 1464156545, "post_id": 37428909, "comment_id": 62362351, "body": "@user1775611 - Glad I could help."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1464156029, "creation_date": 1464156029, "answer_id": 37428909, "question_id": 37428796, "link": "https://stackoverflow.com/questions/37428796/move-values-from-range-while-preserving-formulas-in-excel-vba/37428909#37428909", "title": "Move values from range while preserving formulas in Excel VBA", "body": "<p>Try this:</p>\n\n<pre><code>Sheets(\"1 Income statement\").Range(\"E1:E23\").Formula = Sheets(\"1 Income statement\").Range(\"D1:D23\").Formula\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 1775611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cef843751b8c5d1f982888606cf55ad8?s=128&d=identicon&r=PG", "display_name": "user1775611", "link": "https://stackoverflow.com/users/1775611/user1775611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 37428909, "answer_count": 1, "score": 0, "last_activity_date": 1464158236, "creation_date": 1464155579, "last_edit_date": 1464158236, "question_id": 37428796, "link": "https://stackoverflow.com/questions/37428796/move-values-from-range-while-preserving-formulas-in-excel-vba", "title": "Move values from range while preserving formulas in Excel VBA", "body": "<p>I'm trying to make a macro that moves values from a range to another, while preserving formulas in the range.</p>\n\n<p>So far I have this:</p>\n\n<pre><code>Sub change_fiscal_year()\n\nSheets(\"1 Income statement\").Range(\"E1:E23\").Value = Sheets(\"1 Income statement\").Range(\"D1:D23\").Value\n\nEnd Sub\n</code></pre>\n\n<p>It works, but it copypastes the values instead of moving them, so formulas are not preserved. How can I get around this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6344183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef3bdeef7bd04110ecbcd87c26398f?s=128&d=identicon&r=PG&f=1", "display_name": "duncan297", "link": "https://stackoverflow.com/users/6344183/duncan297"}, "edited": false, "score": 0, "creation_date": 1464157534, "post_id": 37429023, "comment_id": 62362808, "body": "Many thanks Lubos, I follow the logic but not sure of where I need to edit the macro. The case sensitivity is not critical, am more concerned at getting the partial match sorted so should this line If ActiveSheet.Range(&quot;A1&quot;).Value = &quot;&quot; Then now be reading If ActiveSheet.Range(&quot;A1&quot;).Value like &quot;*&quot; Then?"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 11, "user_id": 6344183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef3bdeef7bd04110ecbcd87c26398f?s=128&d=identicon&r=PG&f=1", "display_name": "duncan297", "link": "https://stackoverflow.com/users/6344183/duncan297"}, "edited": false, "score": 0, "creation_date": 1464157865, "post_id": 37429023, "comment_id": 62362985, "body": "@duncan297 Right now you&#39;re testing your hide-condition like this: <code>cell.Value = ActiveSheet.Range(&quot;A1&quot;).Value</code>. Replace this part with whatever solution you like, using <code>cell.Value</code> as haystack."}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 11, "user_id": 6344183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef3bdeef7bd04110ecbcd87c26398f?s=128&d=identicon&r=PG&f=1", "display_name": "duncan297", "link": "https://stackoverflow.com/users/6344183/duncan297"}, "edited": false, "score": 0, "creation_date": 1464158024, "post_id": 37429023, "comment_id": 62363074, "body": "@duncan297 can you please update your question with this point? in comment its harder to read. But you need to use <code>Like</code> or or <code>instr</code> (as Verzweifler mentioned) instead other comparison operator. If you use = you checking if two variables are same, if you use &lt;&gt; they are not same, so instead of this you can use like, to check it partialy"}], "tags": [], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "is_accepted": false, "score": 2, "last_activity_date": 1464156506, "creation_date": 1464156506, "answer_id": 37429023, "question_id": 37428691, "link": "https://stackoverflow.com/questions/37428691/partial-string-searches-with-vba/37429023#37429023", "title": "Partial string searches with VBA", "body": "<p>First try to convert both your strings (needle and haystack) to <code>LCASE()</code> and then use <code>LIKE</code> operator. As in example below</p>\n\n<pre><code>if lcase(haystack) like \"*\" &amp; lcase(needle) &amp; \"*\" then\n'do something\n</code></pre>\n\n<p>which will works little like regexp. So it will look into string haystack if contains <em>needle</em>. Where * means everything (or nothing). Is this clear?</p>\n"}, {"comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1464157576, "post_id": 37429257, "comment_id": 62362833, "body": "good point, but i think, that VBA ignores <code>like</code>-sensitive characters in variable, but not sure with it. You gave me good point to think about :p"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 1, "creation_date": 1464157757, "post_id": 37429257, "comment_id": 62362928, "body": "I&#39;m pretty sure VBA doesn&#39;t ignore those characters. I&#39;ve used <code>like</code> to build custom searches based on these Expressions."}], "tags": [], "owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "is_accepted": false, "score": 2, "last_activity_date": 1464157410, "creation_date": 1464157410, "answer_id": 37429257, "question_id": 37428691, "link": "https://stackoverflow.com/questions/37428691/partial-string-searches-with-vba/37429257#37429257", "title": "Partial string searches with VBA", "body": "<p>Since we can't know if you needle contains <code>like</code>-sensitive characters like <code>#</code> or <code>?</code>, I'd suggest a solution via <a href=\"https://msdn.microsoft.com/de-de/library/8460tsh1%28v=vs.90%29.aspx\" rel=\"nofollow\">instr()</a>:</p>\n\n<pre><code>if instr(lcase(haystack), lcase(needle)) &gt; 0 then\n' Do Stuff\n</code></pre>\n\n<p>This gives you the starting position of the first occurrence of <code>needle</code> in <code>haystack</code>, or 0 if <code>needle</code> is not found.</p>\n"}], "owner": {"reputation": 11, "user_id": 6344183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef3bdeef7bd04110ecbcd87c26398f?s=128&d=identicon&r=PG&f=1", "display_name": "duncan297", "link": "https://stackoverflow.com/users/6344183/duncan297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1917, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464159111, "creation_date": 1464155062, "last_edit_date": 1531164843, "question_id": 37428691, "link": "https://stackoverflow.com/questions/37428691/partial-string-searches-with-vba", "title": "Partial string searches with VBA", "body": "<p>I am trying to write a macro for searching for and displaying rows of data based on a search term that is a partial string (typically 4 characters of potentially 16), am a complete beginner at this but so far I have the following (with help from Gord):</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\nDim cell As Range\nApplication.ScreenUpdating = False\nWith ActiveSheet\n    .Rows.Hidden = False    'unhides all rows\nEnd With\nFor Each cell In ActiveSheet.Range(\"C3:C1000\")\n    If cell.Value &lt;&gt; ActiveSheet.Range(\"A1\").Value Then _\n            cell.EntireRow.Hidden = True\n    If ActiveSheet.Range(\"A1\").Value = \"\" Then\n        cell.EntireRow.Hidden = False\n    End If\nNext\nRange(\"A1\").Select  'ready for next value input\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>How can I define the search term as a partial match not an exact match and loose case senstivity?</p>\n\n<p>TIA</p>\n\n<p>Duncan </p>\n\n<p>The data string has no special characters only 0-9 and A-Z so presumably the Like function will suit the task. If so how would the macro change? Apologies but am total newbie at this.\nIt tried editing: \nIf ActiveSheet.Range(\"A1\").Value = \"\" Then<br>\nto: If ActiveSheet.Range(\"A1\").Value like \"*\" Then\nbut no result </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 33, "user_id": 4923232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a74ed63ea794efc59291e70c4ef967?s=128&d=identicon&r=PG&f=1", "display_name": "Lure", "link": "https://stackoverflow.com/users/4923232/lure"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464155733, "post_id": 37428550, "comment_id": 62362042, "body": "Thanks Tim, works perfectly"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1464201231, "creation_date": 1464201231, "answer_id": 37445083, "question_id": 37428550, "link": "https://stackoverflow.com/questions/37428550/convert-excel-formula-to-vba-code/37445083#37445083", "title": "Convert Excel Formula to VBA code", "body": "<p>Migrated from comment...</p>\n\n<pre><code>Debug.Print Sheet1.Evaluate(\"SUMPRODUCT(SUBTOTAL(3,OFFSET((AT2:AT644),ROW(AT2:AT644)-MIN(ROW\u200c\u200b(AT2:AT644)), ,1)) * (AT2:AT644=\"\"6\"\"))\") \n</code></pre>\n\n<p>or whichever sheet you need to use, just don't use <code>Application.Evaluate</code> unless you want it to always evaluate in the context of the ActiveSheet.</p>\n"}], "owner": {"reputation": 33, "user_id": 4923232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a74ed63ea794efc59291e70c4ef967?s=128&d=identicon&r=PG&f=1", "display_name": "Lure", "link": "https://stackoverflow.com/users/4923232/lure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 37445083, "answer_count": 1, "score": 0, "last_activity_date": 1464201231, "creation_date": 1464154412, "question_id": 37428550, "link": "https://stackoverflow.com/questions/37428550/convert-excel-formula-to-vba-code", "title": "Convert Excel Formula to VBA code", "body": "<p>Could you please advise how to convert a formula to VBA code</p>\n\n<pre><code>=SUMPRODUCT(SUBTOTAL(3,OFFSET((AT2:AT644),ROW(AT2:AT644)-MIN(ROW(AT2:AT644)), ,1)) * (AT2:AT644=\"6\"))\n</code></pre>\n\n<p>i do like this, but question how to use \"offset\" in current code?</p>\n\n<pre><code>Application.WorksheetFunction.SumProduct(Application.WorksheetFunction.Subtotal(3, Application.Range.Offset((\"AT2:AT644\"), Application.Rows(\"AT2:AT644\") - Application.WorksheetFunction.Min(Application.Rows(\"AT2:AT644\")), , 1)) * (\"AT2:AT644\" = \"6\"))\n</code></pre>\n\n<p>Thanks,<br>\nRegards,<br>\nLure</p>\n"}, {"tags": ["vba", "ms-word", "listbox", "userform", "multi-select"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464203994, "post_id": 37428058, "comment_id": 62393854, "body": "It&#39;s not clear what you mean by &quot;a string of variables&quot;. Could you please use the <a href=\"https://stackoverflow.com/posts/37428058/edit\">edit</a> button under the Question and provide an example? Do you perhaps mean an <i>array</i> of values that you can loop over, executing code on each member?"}, {"owner": {"reputation": 1, "user_id": 6379247, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208120238115207/picture?type=large", "display_name": "Martha Wiles", "link": "https://stackoverflow.com/users/6379247/martha-wiles"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464208075, "post_id": 37428058, "comment_id": 62395992, "body": "Yes, an array is what I think I want. I edited the question and tried to clarify what I am attempting."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464286345, "post_id": 37428058, "comment_id": 62434954, "body": "OK, I&#39;m still confused :-) If you want an array, then you should change your function to return the array (use &quot;As Variant&quot; instead of &quot;As String&quot;). If you really do want a string, then don&#39;t create an array, create a string in the For-Loop, adding each new value to the string: sItems = sItems &amp; ListBoxClients.List(i) &amp; &quot;, &quot; and then return that from the function."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464286391, "post_id": 37428058, "comment_id": 62434983, "body": "Then there&#39;s the issue with the &quot;Find and Replace Sub&quot;. I understand what you mean, sort of, but it&#39;s not clear when this should be called if you don&#39;t want it connected to the &quot;OK&quot; button?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6379247, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208120238115207/picture?type=large", "display_name": "Martha Wiles", "link": "https://stackoverflow.com/users/6379247/martha-wiles"}, "is_accepted": false, "score": 0, "last_activity_date": 1464308954, "creation_date": 1464308954, "answer_id": 37473032, "question_id": 37428058, "link": "https://stackoverflow.com/questions/37428058/creating-a-variable-string-from-a-multiselect-listbox-in-ms-word/37473032#37473032", "title": "Creating a variable string from a multiselect listbox in MS Word", "body": "<p>So, through much trial and error and googling, I came up with the following solution, which works well for my purpose. First, after clicking F7 on my userform, I added the items to a list array.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n   'Creates and assigns the array to ListBoxClients when the form loads\n   With ListBoxClients\n   .AddItem \"Client 1\"\n   .AddItem \"Client 2\"\n   .AddItem \"Client 3\"\n   End With\nEnd Sub\n</code></pre>\n\n<p>Then, I created the following response to my \"OK\" command. First, it prompts the user to select the files to process and opens the first file:</p>\n\n<pre><code>Private Sub cmdOK_Click()\n   Me.Hide\n   MsgBox \"Click OK to browse and select files to exclude.\", vbInformation\n   Dim MyDialog As FileDialog, GetStr(1 To 3000) As String '3000 files is the maximum applying this code\n   On Error Resume Next\n   Set MyDialog = Application.FileDialog(msoFileDialogFilePicker)\n   With MyDialog\n       .Filters.Clear\n       .Filters.Add \"All WORD File \", \"*.docx\", 1\n       .AllowMultiSelect = True\n   i = 1\n   If .Show = -1 Then\n   For Each stiSelectedItem In .SelectedItems\n   GetStr(i) = stiSelectedItem\n   i = i + 1\n   Next\n   i = i - 1\n   End If\n   Application.ScreenUpdating = False\n   For j = 1 To i Step 1\n   Set Doc = Documents.Open(FileName:=GetStr(j), Visible:=True)\n   Windows(GetStr(j)).Activate\n</code></pre>\n\n<p>Then, I loop through the selected items in the array and replace each selected item with the same text, colored red (so my other macro--not shown here--will skip over it when it performs the find and replace):</p>\n\n<pre><code>'Find and replace listbox items in files\nDim ii As Integer\n   For ii = 0 To ListBoxClients.ListCount - 1\n      If ListBoxClients.Selected(ii) Then\n      Selection.Text = ListBoxClients.List(ii)\n      Selection.Find.ClearFormatting\n      Selection.Find.Replacement.ClearFormatting\n      Selection.Find.Replacement.Font.Color = 192\n            With Selection.Find\n                .Text = Selection.Text\n                .Replacement.Text = Selection.Text\n                .Forward = True\n                .Wrap = wdFindContinue\n                .Format = True\n                .MatchCase = False\n                .MatchWholeWord = False\n                .MatchWildcards = False\n                .MatchSoundsLike = False\n                .MatchAllWordForms = False\n            End With\n      Selection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>Before I finish, I get rid of the selected array item that for reasons unknown is pasted at the top of each of my files:</p>\n\n<pre><code>      ' delete mysterious added text at top of page (figure this out later)\n      Selection.HomeKey Unit:=wdStory\n      Selection.EndKey Unit:=wdLine, Extend:=wdExtend\n      Selection.Delete Unit:=wdCharacter, Count:=1\n      End If\n   Next ii\n</code></pre>\n\n<p>Then I have some code that closes the current document and returns it to the top section of the sub to open the next file (and eventually end). I have no idea why \"Application.Run macroname:=\"NEWMACROS\" is there, but it works, so I'm not going to delete it.</p>\n\n<pre><code>   Application.Run macroname:=\"NEWMACROS\"\n   ActiveDocument.Save\n   ActiveWindow.Close\n   Next\n   Application.ScreenUpdating = True\n   End With\nEnd Sub\n</code></pre>\n\n<p>Finally, I add the code to cancel the form if the user changes his/her mind:</p>\n\n<pre><code>Private Sub cmdCancel_Click()\n'User has cancelled so hide the form\nMe.Hide\nEnd Sub\n</code></pre>\n\n<p>That's it. I hope this helps someone else.</p>\n"}], "owner": {"reputation": 1, "user_id": 6379247, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208120238115207/picture?type=large", "display_name": "Martha Wiles", "link": "https://stackoverflow.com/users/6379247/martha-wiles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 686, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594050643, "creation_date": 1464151786, "last_edit_date": 1594050643, "question_id": 37428058, "link": "https://stackoverflow.com/questions/37428058/creating-a-variable-string-from-a-multiselect-listbox-in-ms-word", "title": "Creating a variable string from a multiselect listbox in MS Word", "body": "<p>I have created a userform with a multiselect listbox with an \"OK\" command. When my user makes selections from the listbox and clicks the OK command, I want to create an array (based on the user's selections in the listbox) that I can then loop over for each item in the array as I open multiple files the user has specified.  </p>\n\n<p>For example, if my user selects \"Client 1\" and \"Client 3\" in my listbox and then selects the \"OK\" command, I want to create an array from those values and then call up each value in the array in a \"find and replace\" Sub that replaces, e.g., \"Client 1\" with \"Client 1\" (colored red), \"Client 3\" with \"Client 3\" (colored red). (The red is so that my other find and replace macro can skip these items by specifying a different color to find for, along with text Client 1, Client 3, etc.) </p>\n\n<p>Reading elsewhere on this site, I created a function to try to generate the array, but I don't know how to get it into and use it in my UserForm Sub.</p>\n\n<p><strong>After finding an answer, below, I deleted the original code I had pasted here, because it was clearly all wrong and won't help anyone.</strong></p>\n\n<p>Additional information about the overall objective: I have already created a macro to do an initial find and replace in multiple files. This macro opens a bunch of files selected by the user and replaces certain client names with the text \"Confidential Client\". Now, people are asking me if they can exclude certain clients from being replaced. That is why I want to add the userform with a listbox that will let them select clients to exclude. </p>\n\n<p>Please help!   </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1464161487, "post_id": 37427548, "comment_id": 62365026, "body": "Not an answer to your question but <code>For Each cel In .Range(&quot;A1:A1&quot; &amp; lr)</code> should be <code>For Each cel In .Range(&quot;A1:A&quot; &amp; lr)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 5649139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e52f8bd285ef1ce26143b0b350f3f43?s=128&d=identicon&r=PG&f=1", "display_name": "kartina azman", "link": "https://stackoverflow.com/users/5649139/kartina-azman"}, "edited": false, "score": 0, "creation_date": 1464173347, "post_id": 37429760, "comment_id": 62372777, "body": "Just found out where I did wrong...the sheet that has the replacement list is named sheet1 where in fact the index at vba page shows it is sheet2.silly me .."}], "tags": [], "owner": {"reputation": 98, "user_id": 6192281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f573a80b8dba72de5f7bc6ebb6377c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cudny", "link": "https://stackoverflow.com/users/6192281/cudny"}, "is_accepted": false, "score": 1, "last_activity_date": 1464159040, "creation_date": 1464159040, "answer_id": 37429760, "question_id": 37427548, "link": "https://stackoverflow.com/questions/37427548/range-replace-method-doesnt-work/37429760#37429760", "title": "range.replace method doesn&#39;t work", "body": "<p>Code is fine, just make sure u use proper sheet names. Check in VBA project, or to be sure use Sheets(\"name_here\").</p>\n\n<p>And (probably it's obvious, but just to be sure :P) uncomment this line:\n<code>'Sheet15.Range(\"D:D\").Replace fromVal, toVal, xlWhole, , True  'replace at data sheet</code></p>\n"}], "owner": {"reputation": 28, "user_id": 5649139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e52f8bd285ef1ce26143b0b350f3f43?s=128&d=identicon&r=PG&f=1", "display_name": "kartina azman", "link": "https://stackoverflow.com/users/5649139/kartina-azman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1464159040, "creation_date": 1464148524, "last_edit_date": 1531161705, "question_id": 37427548, "link": "https://stackoverflow.com/questions/37427548/range-replace-method-doesnt-work", "title": "range.replace method doesn&#39;t work", "body": "<p>Here is what I would like to do:</p>\n\n<ul>\n<li>replace the words in <code>column D</code> of <code>sheet15</code> according to the list in <code>sheet1</code></li>\n<li>in <code>sheet1</code>, <code>col A</code> housed the list of words I want to replace, and the corresponding words I would like to replace it with is next to it (in <code>col B</code>)</li>\n</ul>\n\n<p>Below the code works fine when I try it in a new workbook but when I place it in my project, it does not.\nI debugged it line by line, no error, but the words are not being replaced accordingly.</p>\n\n<p>I can't figure out what's wrong. Does anybody here know where did I go wrong?</p>\n\n<pre><code>sub changeproc()        \nDim fromVal As String, toVal As String, cel As Range, lr As Long\n\nWith Sheet1  'validation list and replacement\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    For Each cel In .Range(\"A1:A1\" &amp; lr)  'ori list in col a\n        fromVal = cel.Value2\n        toVal = cel.Offset(0, 1).Value2  'replacement list in col b\n        'Sheet15.Range(\"D:D\").Replace fromVal, toVal, xlWhole, , True  'replace at data sheet\n\n    Next\nEnd With\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "oledb"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5769212, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/36528f6a2234a405458adab27fae87c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5769212", "link": "https://stackoverflow.com/users/5769212/user5769212"}, "edited": false, "score": 0, "creation_date": 1464167475, "post_id": 37431626, "comment_id": 62368626, "body": "so Do I need to download the drivers for the same ? the problem is with Lotus notes/LotusScript.."}, {"owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "reply_to_user": {"reputation": 27, "user_id": 5769212, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/36528f6a2234a405458adab27fae87c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5769212", "link": "https://stackoverflow.com/users/5769212/user5769212"}, "edited": false, "score": 0, "creation_date": 1464168923, "post_id": 37431626, "comment_id": 62369675, "body": "The reference will already be available in your MS application under tools, references. Just add the reference with the most recent version (it may not be 6.1 it could be lower). My knowledge with Lotus is very limited I&#39;m afraid, sorry. Not sure if this is of any use as it ODBC <a href=\"https://www.connectionstrings.com/lotus-notes/\" rel=\"nofollow noreferrer\">connectionstrings.com/lotus-notes</a>"}], "tags": [], "owner": {"reputation": 503, "user_id": 3917840, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/29eddfe24c81f5723f73a40455e06d49?s=128&d=identicon&r=PG&f=1", "display_name": "TSQL_Newbie", "link": "https://stackoverflow.com/users/3917840/tsql-newbie"}, "is_accepted": false, "score": 0, "last_activity_date": 1464164750, "creation_date": 1464164750, "answer_id": 37431626, "question_id": 37427430, "link": "https://stackoverflow.com/questions/37427430/provider-microsoft-jet-oledb-4-0-and-error-path-not-valid-for-csv-records-retr/37431626#37431626", "title": "Provider=Microsoft.Jet.OLEDB.4.0 And error : path not valid for CSV records retriving", "body": "<p>Have you added the reference to your VBA project?</p>\n\n<p><a href=\"https://i.stack.imgur.com/qt2XS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qt2XS.png\" alt=\"Reference\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 5769212, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/36528f6a2234a405458adab27fae87c3?s=128&d=identicon&r=PG&f=1", "display_name": "user5769212", "link": "https://stackoverflow.com/users/5769212/user5769212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464164750, "creation_date": 1464147804, "question_id": 37427430, "link": "https://stackoverflow.com/questions/37427430/provider-microsoft-jet-oledb-4-0-and-error-path-not-valid-for-csv-records-retr", "title": "Provider=Microsoft.Jet.OLEDB.4.0 And error : path not valid for CSV records retriving", "body": "<pre><code>currentPath2 = \"C:\\output-Cities.txt\"\n\nDim cn,rs\n\n\n    Set cn = createobject(\"ADODB.Connection\")\n    Set rs = createobject(\"ADODB.Recordset\")\n\n\n\nstrConn= \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; currentPath2 &amp; \";Extended Properties='text;HDR=No'\" \n    cn.ConnectionString = strConn\ncn.Open\n    RS.ActiveConnection = cn\n    RS.Source = \"select * from \" &amp; currentPath2`enter code here`\n</code></pre>\n\n<p>it gives error on Provider=... line says path is not valid, do I need to install OLEDB driver however that is I see OLE folder in my system folder of C drive, please lemme know if I have to achieve anything more. Baiscally I want to retrive   csv records as in recordsets, please lemme know if anybody can help me here., this has to work in both VBA and LotusScript.</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1464144779, "post_id": 37426936, "comment_id": 62358877, "body": "You can&#39;t insert into a form. Insert into the table instead. If the distinction between a form and a table isn&#39;t clear to you, you should find a tutorial and work your way through it."}, {"owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1464146467, "post_id": 37426936, "comment_id": 62359270, "body": "But i&#39;ve seen tutorials of people inserting data into a subform 0.o"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1464146537, "post_id": 37426936, "comment_id": 62359282, "body": "No, you have not, because a <b>form</b> is not a <b>table</b>. Tables contain data; forms allow people to view or edit that data. As I said, if you don&#39;t understand the difference between the two, find a tutorial."}, {"owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1464150076, "post_id": 37426936, "comment_id": 62360126, "body": "I did understand the difference between the two of them... My degree is about that... But I was rusty working with Access...I just changed it back to the table (tblClients) and it worked! thanks for the tip!"}], "owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 652, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464195284, "creation_date": 1464144176, "last_edit_date": 1464195284, "question_id": 37426936, "link": "https://stackoverflow.com/questions/37426936/run-time-error-3192-could-not-find-table", "title": "Run time error 3192 Could not find table", "body": "<p>I am doing a program in Access 2013 and Im trying to make my form insert data into the table (via VBA code), I created a subform (tblClients_subform) containing every \"tblClients\" data but for some odd reason its throwing me this error: </p>\n\n<pre><code>    \"Could not find tblClients_subform\" \n</code></pre>\n\n<p>Here is my entire block:</p>\n\n<pre><code>    \"CurrentDb.Execute \"INSERT INTO tblClients_subform (ClientID, ClientName, Gender, \" &amp; _\n    \"City, [Address], [Cellphone/Telephone])\" &amp; _\n    \"VALUES (\" &amp; Me.txtID &amp; \",'\" &amp; Me.txtName &amp; \"','\" &amp; Me.cboGender &amp; _\n    \"','\" &amp; Me.txtCity &amp; \"','\" &amp; Me.txtAddress &amp; \"','\" &amp; Me.txtCellphone &amp; \"')\"\n</code></pre>\n\n<p>what I am doing wrong? Is there another way to make my form insert data in the subform table? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1464142881, "post_id": 37426597, "comment_id": 62358505, "body": "So what&#39;s your question?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464302532, "post_id": 37426597, "comment_id": 62442888, "body": "Would you kindly give any gracious sign of at least appreciating all these (vane) efforts?"}], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 3604081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e645d40c09fd7f9572f1cb6db0ae8435?s=128&d=identicon&r=PG&f=1", "display_name": "meghlashomoy", "link": "https://stackoverflow.com/users/3604081/meghlashomoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1464145968, "creation_date": 1464145968, "answer_id": 37427148, "question_id": 37426597, "link": "https://stackoverflow.com/questions/37426597/excel-adding-worksheets/37427148#37427148", "title": "Excel Adding Worksheets", "body": "<p>If you don't want any duplicate then the best thing for you would be to remove the duplicate. If you want the original sheet unchanged then create a copy of the sheet and then remove the duplicates and create sheets.</p>\n"}, {"comments": [{"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1464152619, "post_id": 37427977, "comment_id": 62360894, "body": "It is a good approach to use and modify OP&#39;s code to the extent possible. It works perfectly."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1464151319, "creation_date": 1464151319, "answer_id": 37427977, "question_id": 37426597, "link": "https://stackoverflow.com/questions/37426597/excel-adding-worksheets/37427977#37427977", "title": "Excel Adding Worksheets", "body": "<p>It looks like the question is around ensuring duplicates are not created. I could think of two ways to do this but and have chosen what I believe to be the most efficient for this situation.</p>\n\n<ol>\n<li><strong>Remember the names</strong> (Chosen) - Remember the names of the sheets in a string that can be very quickly checked, would not be the best solution if you had large (25+ in length) city names across thousands of tabs, but at that point I suspect you would have different issues to consider.</li>\n<li><strong>Create an error handling proc that does the check</strong> - You could call out to a second procedure that would check if the sheet existed, this would make for a slower processing time but would be safer if used on a large scale.</li>\n</ol>\n\n<p>Below is your code with a check for duplicates included.</p>\n\n<pre><code>Sub addsheets()\nDim myCell      As Range\nDim Cities      As Range\nDim StrSheets   As String\nDim WkSht       As Excel.Worksheet\n\nWith ThisWorkbook.Worksheets(\"AllCities\")\n    Set Cities = Range(.Range(\"A2\"), .Range(\"A2\").End(xlDown))\nEnd With\n\nStrSheets = \"|\"\nFor Each WkSht In ThisWorkbook.Worksheets\n    StrSheets = StrSheets &amp; WkSht.Name &amp; \"|\"\nNext\n\nFor Each myCell In Cities\n    If Not myCell.Value = vbNullString Then\n        If InStr(1, StrSheets, \"|\" &amp; myCell.Value &amp; \"|\") = 0 Then\n            Sheets.Add After:=Sheets(Sheets.Count)\n            Sheets(Sheets.Count).Name = myCell.Value\n            StrSheets = StrSheets &amp; myCell.Value &amp; \"|\"\n        End If\n    End If\nNext myCell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464160829, "post_id": 37429934, "comment_id": 62364659, "body": "Fine thought to use Dics. As for sheet name checking logic, it&#39;d force you to loop through all sheets of <code>Sheets</code> collection for every sheet to be checked, while you could just check once for any exception using the specific sheet name. Finally there remains the _invalid sheet name_handling issue"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464172056, "post_id": 37429934, "comment_id": 62371841, "body": "@user3598756 thank you for your comment, but I always trying (as much as possible) do not use error handler mechanism."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464172294, "post_id": 37429934, "comment_id": 62372014, "body": "me too! but I also learned for very few specific cases it&#39;s <i>almost</i> wrong no to use it, like checking for item in any collection."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464177737, "post_id": 37429934, "comment_id": 62375763, "body": "@user3598756 I will not argue with you, I think, how many people, so many styles and views, depending on habbits, expirience and so on. I think, that It&#39;s not really necessary to to impose their point of view to others, sometimes it is enough just show the right direction and that&#39;s it."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464302791, "post_id": 37429934, "comment_id": 62442957, "body": "The sad thing is that there are people whose style and view is to throw a question, have other people like me, you and @GaryEvans dedicate time and give (fine) answers, but give no feedback at all! I&#39;ll be after these kind of people from now on..."}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1464171929, "last_edit_date": 1464171929, "creation_date": 1464159644, "answer_id": 37429934, "question_id": 37426597, "link": "https://stackoverflow.com/questions/37426597/excel-adding-worksheets/37429934#37429934", "title": "Excel Adding Worksheets", "body": "<p>Additional variant based on two assumptions, the first one is that the range of cells with cities might contain the duplicates, and the second one is that for some of the cities listed in a range, the sheet has been added already.</p>\n\n<pre><code>Sub addsheets()\n\n    Dim myCell As Range, Cities As Range, Dic As Object, sh As Worksheet, k\n    Set Dic = CreateObject(\"Scripting.Dictionary\"): Dic.CompareMode = vbTextCompare\n\n    With Sheets(\"AllCities\")\n        Set Cities = .Range(\"A2:A\" &amp; .Cells(Rows.Count, \"A\").End(xlUp).Row)\n    End With\n\n    For Each myCell In Cities\n    'if value is non blank and not duplicated in a range of cells then add to dictionary\n        If myCell.Value2 &lt;&gt; \"\" And Not Dic.exists(myCell.Value2) Then\n            Dic.Add CStr(myCell.Value2), Nothing\n        End If\n    Next myCell\n\n    For Each sh In ThisWorkbook.Sheets \n    'if sheet with name listed in Cities already exists then remove name from dictionary\n        If Dic.exists(sh.Name) Then Dic.Remove (sh.Name)\n    Next sh\n\n    For Each k In Dic\n    'add sheets with unique values stored in dictionary\n        Sheets.Add(After:=Sheets(Sheets.Count)).Name = k\n    Next k\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1464161083, "last_edit_date": 1464161083, "creation_date": 1464159781, "answer_id": 37429972, "question_id": 37426597, "link": "https://stackoverflow.com/questions/37426597/excel-adding-worksheets/37429972#37429972", "title": "Excel Adding Worksheets", "body": "<p>actually exploiting <code>RemoveDuplicates()</code> method of <code>Range</code> object would ask the very question:</p>\n\n<pre><code>Option Explicit\n\nSub AddSheets()\n    Dim myCell As Range\n    Dim Cities As Range\n\n    With Sheets(\"AllCities\")\n        Set Cities = .Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp)).SpecialCells(xlCellTypeConstants) '&lt;~~ consider non blank cells of column \"A\" from cell \"A2\" down to last non blank cell\n        Cities.RemoveDuplicates Columns:=Array(1), Header:=xlNo '&lt;~~ remove duplicates\n    End With\n\n    For Each myCell In Cities\n        Sheets.Add After:=Sheets(Sheets.Count)\n        ActiveSheet.Name = myCell.Value\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>provided you don't care all duplicates values are lost for ever! </p>\n\n<p>but it'd leave unhandled two important exceptions:</p>\n\n<p>1)  duplicate names with regards to sheets already existing prior to macro executing</p>\n\n<p>2)  invalid characters in sheet names</p>\n\n<p>you could handle those with dedicated functions which would give green light to next steps, like follows:</p>\n\n<pre><code>Option Explicit\n\nSub AddSheets()\n    Dim myCell As Range\n    Dim Cities As Range\n\n    With Sheets(\"AllCities\")\n        Set Cities = .Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp)).SpecialCells(xlCellTypeConstants) '&lt;~~ consider non blank cells of column \"A\" from cell \"A2\" down to last non blank cell\n        Cities.RemoveDuplicates Columns:=Array(1), Header:=xlNo '&lt;~~ remove duplicates from list\n    End With\n\n    For Each myCell In Cities\n        If CheckSheetName(myCell.Value) Then '&lt;~~ check for invalid sheet name...\n            If CheckSheetDuplicate(ActiveWorkbook, myCell.Value) Then '&lt;~~ ... if valid name then check for duplicates in existent sheets...\n                Sheets.Add After:=Sheets(Sheets.Count) '&lt;~~ ... if no duplicates sheets then finally add a new sheet...\n                ActiveSheet.Name = myCell.Value'&lt;~~ ... and give it proper name\n            End If\n        End If\n    Next myCell\n\nEnd Sub\n\n\nFunction CheckSheetName(shtName As String) As Boolean\n    Dim invalidChars As Variant\n    Dim myChar As Variant\n\n    invalidChars = Array(\":\", \"/\", \"\\\", \"?\", \"*\", \"[\", \"]\")\n\n     'check shtName for forbidden characters\n    CheckSheetName = True\n    For Each myChar In invalidChars\n        If InStr(shtName, myChar) &gt; 0 Then\n            CheckSheetName = False\n            Exit For\n        End If\n    Next myChar\nEnd Function\n\nFunction CheckSheetDuplicate(wb As Workbook, shtName As String) As Boolean\n    CheckSheetDuplicate = True '&lt;~~ set positive check result. it'll be turned to negative in case of problems ..\n    On Error Resume Next\n    CheckSheetDuplicate = wb.Sheets(shtName) Is Nothing '&lt;~~ set negative check result in case of problems from any attempt to use a sheet with given name:  for instance trying and use it as an object\nEnd Function\n</code></pre>\n\n<p>of course you could make further enhancements in checking functions and have them:</p>\n\n<ul>\n<li><p>correct the name</p>\n\n<p>for instance removing invalid characters</p></li>\n<li><p>admit duplicates</p>\n\n<p>for instance adding a duplicate name counter at the and of it</p></li>\n</ul>\n\n<p>Finally here is a very bold sub that (hopefully) consciously exploit the error handling removal to avoid checks and got to the final result</p>\n\n<pre><code>Sub BoldlyAddSheets()\n    Dim myCell As Range\n    Dim Cities As Range\n    Dim mysht As Worksheet\n    Dim currentShtName As String\n\n    With Sheets(\"AllCities\")\n        Set Cities = .Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp)).SpecialCells(xlCellTypeConstants) '&lt;~~ consider non blank cells of column \"A\" from cell \"A2\" down to last non blank cell\n    End With\n\n    Application.DisplayAlerts = False '&lt;~~ necessary not to have macro interrupted by any prompts risen by possible Delete() method over sheet objects\n    On Error Resume Next '&lt;~~ ignore errors -&gt; you must know what you are doing till the next \"On Error GoTo 0\" statement!\n\n    For Each myCell In Cities\n        Set mysht = Sheets(myCell.Value) '&lt;~~ try setting a sheet object with the current cell value and ...\n        If mysht Is Nothing Then '&lt;~~ ...if unsuccessful then there's no sheet with the wanted name already, so let's try adding it\n            Sheets.Add After:=Sheets(Sheets.Count) '&lt;~~ 1) add a new sheet\n            currentShtName = ActiveSheet.Name '&lt;~~ 2) store new sheet default name, to check for things to possibly go wrong...\n            ActiveSheet.Name = myCell.Value '&lt;~~ 3) try setting the new name...\n            If ActiveSheet.Name = currentShtName Then ActiveSheet.Delete '&lt;~~ ...if unsuccessful (sheet name with forbidden characters) delete the sheet\n        Else\n            Set mysht = Nothing '&lt;~~ set it back to Nothing for subsequent loops\n        End If\n    Next myCell\n\n    Application.DisplayAlerts = True '&lt;~~ at long last ... turn default alerts handling on...\n    On Error GoTo 0 '&lt;~~ ... and turn default error handling on, too. this latter just for clarity since \"On Error GoTo 0\" is automatically done at exiting any sub or function\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6378854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a7051cce34e2ecc278d01836be45846?s=128&d=identicon&r=PG&f=1", "display_name": "th65", "link": "https://stackoverflow.com/users/6378854/th65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1464171929, "creation_date": 1464141280, "last_edit_date": 1464145882, "question_id": 37426597, "link": "https://stackoverflow.com/questions/37426597/excel-adding-worksheets", "title": "Excel Adding Worksheets", "body": "<p>I need to create a sub where to create worksheets based off of a list of names in a worksheet named AllCities. The list of city names starts in cell A2. The worksheets need to be named after the cell value in the list, and it should not create any duplicate sheets. This is what I have so far:</p>\n\n<pre><code>Sub addsheets()\nDim myCell As Range\nDim Cities As Range\n\n\nWith Sheets(\"AllCities\")\nSet Cities = Sheets(\"AllCities\").Range(\"A2\")\nSet Cities = Range(Cities, Cities.End(xlDown))\nEnd With\n\nFor Each myCell In Cities\nIf Not myCell.Value = vbNullString Then\n    Sheets.Add After:=Sheets(Sheets.Count)\n    Sheets(Sheets.Count).Name = myCell.Value\nEnd If\nNext myCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "if-statement", "for-loop", "exit"], "answers": [{"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1464153143, "creation_date": 1464153143, "answer_id": 37428297, "question_id": 37426172, "link": "https://stackoverflow.com/questions/37426172/break-from-for-loop-back-into-if-statement-vba/37428297#37428297", "title": "Break from for loop back into if statement vba", "body": "<p>I added comments in the code to show my changes.</p>\n\n<p>You were close, but had one to many loops and like you say, needed to find the right place for the exit.</p>\n\n<pre><code>Sub hidePaid()\nDim day     As Range\nDim loanRng As Range\nDim loanSum As Worksheet\nDim dateRng As Range\nDim i       As Long\n\nSet loanSum = ThisWorkbook.Worksheets(\"Loan Sum\")\nloanSum.Activate\n\nSet dateRng = ActiveSheet.Range(\"D2:R2\")\nSet loanRng = ActiveSheet.Range(\"D4:R16\")\n\n'This loop processes by column\nFor Each day In dateRng\n\n    'Once the date in the column is greater than today, it will stop processing\n    'It assumes the values in dateRng are valid dates\n    '(I.e. '01/01/2016' not just 'Jan', you can use number format in Excel to\n    'get a date to show as 'Jan' if that is better for you)\n    If DateDiff(\"d\", Now(), day.Value) &gt; 0 Then Exit For\n\n    'The line of code you had should have worked in sense,\n    'it would have touched every column but only procesed those before today\n    'It also assumes that value in the cell to be an actual date\n    'If day.Value &lt; Date Then\n\n    'You do not need a column loop here as you are already in one in the\n    'previous loop\n    'For j = 1 To loanRng.Columns.Count\n\n    'This loop processes all the rows that are not already hidden and if\n    'the value is equal to 0 then it hides the row\n    'Note: you had the check to be less than 1, .50 is less than 1 and you don't\n    'want to get caught out on a loan!\n    For i = 1 To loanRng.Rows.Count\n\n        If (loanRng.Cells(i, day.Column - 3).Value = 0) And (loanRng.Cells(i, day.Column - 3).EntireRow.Hidden = False) Then\n            loanRng.Cells(i, day.Column - 3).EntireRow.Hidden = True\n        End If\n\n    Next i\n\nNext\n\n'Its good practice to clear out resources when finishing\nSet dateRng = Nothing\nSet loanRng = Nothing\nSet loanSum = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6104532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a5b44b6b1d8ebb518dd66982170aff33?s=128&d=identicon&r=PG&f=1", "display_name": "aoman49", "link": "https://stackoverflow.com/users/6104532/aoman49"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1418, "favorite_count": 0, "accepted_answer_id": 37428297, "answer_count": 1, "score": 0, "last_activity_date": 1464153143, "creation_date": 1464137551, "question_id": 37426172, "link": "https://stackoverflow.com/questions/37426172/break-from-for-loop-back-into-if-statement-vba", "title": "Break from for loop back into if statement vba", "body": "<p>I am trying to perform an action that will see if the date in range (dateRng) is less than today's date, and then, if it is, perform the for loop to hide the rows w.here a value in the column is zero. (I am paying off loans, and every month I want it to hide any loans that have been paid off.) Months are across columns, loans are in rows. Loan balance is (i, j).</p>\n\n<p>The problem is that it never exits the for loop to go back and check the date after every new 'j' (column). It just stays in the for loop. I have tried break, exit, continue, etc. None seem to work, at least where I place them. How do I get it to check for the date, compare to 'today', THEN run the for loop to check each cell in the column, before moving on to column 2, checking the date and performing the same for loop. </p>\n\n<p>It would be good to have it be dynamic, but that is not necessary, as every month I could just change the ranges in the code. This is strictly for my personal use. Any help is appreciated. thank you. </p>\n\n<pre><code>Sub hidePaid()\n\nDim day As Range, loanRng As Range, loanSum As Worksheet, dateRng As Range, cel2 As Range, i As Long, j As Long, col As Range\n\nSet loanSum = ThisWorkbook.Worksheets(\"Loan Sum\")\nloanSum.Activate\n\nSet dateRng = ActiveSheet.Range(\"D2:R2\")\nSet loanRng = ActiveSheet.Range(\"D4:R16\")\n\nFor Each day In dateRng\n\nIf day.Value &lt; Date Then\n\n    For j = 1 To loanRng.Columns.Count\n    For i = 1 To loanRng.Rows.Count\n\n        If loanRng.Cells(i, j).Value &lt; 1 Then\n               loanRng.Cells(i, j).EntireRow.Hidden = True\n        End If\n\n    Next i\n    Next j\n\n\n\nEnd If\n\nNext\nEnd sub\n</code></pre>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464153764, "post_id": 37426167, "comment_id": 62361271, "body": "<code>ReDim myRows(myrow)</code> - are you missing <code>Preserve</code> here ?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1464154317, "post_id": 37426167, "comment_id": 62361477, "body": "Can you add an example with an input and an expected output?"}, {"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464159817, "post_id": 37426167, "comment_id": 62364068, "body": "@TimWilliams You are correct this wipes out the array ! Good catch ! I will try this tomorrow first thing in the afternoon ! (evening shift eh!)  Thanks so much !"}, {"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "reply_to_user": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1464160023, "post_id": 37426167, "comment_id": 62364186, "body": "@FlorentB. My error very likely is that missing &#39;preserve&#39; statement that is wiping out the array each time a line is added. The LblCollection contains a bunch of object on a SAP GUI user area. Some of these objects are GuiLabels (just SAP labels).  The labels are arranged by line and columns but each line has a different amount of &#39;columns&#39;. Really it&#39;s just phrases built out of labels.  Each label has a text caption. The ID property looks like this &quot;wnd[0]/usr/lblsomething[24,3]&quot;. This would be a label at row #3 starting at column #24. Similar to a 80x25 console output."}, {"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464224028, "post_id": 37426167, "comment_id": 62401401, "body": "@TimWilliams That was it, now it works, thanks !"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "edited": false, "score": 0, "creation_date": 1464159887, "post_id": 37428630, "comment_id": 62364112, "body": "Thanks, looks like you guys have figured out my mistake, I&#39;ll post update tomorrow !"}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 0, "last_activity_date": 1464155271, "last_edit_date": 1464155271, "creation_date": 1464154780, "answer_id": 37428630, "question_id": 37426167, "link": "https://stackoverflow.com/questions/37426167/creating-a-jagged-array-in-vba-writing-seems-to-work-but-reading-fails-type-mis/37428630#37428630", "title": "Creating a jagged array in VBA, writing seems to work but reading fails Type Mismatch", "body": "<p>That error is thrown if the second dimension does not exist. My money would go on that as your problem.</p>\n\n<p>Here's an example of an array of jagged arrays, the last being empty. The last line will throw a Type Mismatch error because there is no second dimension.</p>\n\n<pre><code>Dim mainArray(0 To 3) As Variant\nDim subArray As Variant\n\nsubArray = Array(\"A\", \"B\", \"C\")\nmainArray(0) = subArray\nDebug.Print mainArray(0)(0)\n'prints A\n\nsubArray = Array(1, 2, 3, 4)\nmainArray(1) = subArray\nDebug.Print mainArray(1)(0)\n'prints 1\n\nsubArray = Split(\"HELLO|WORLD\", \"|\")\nmainArray(2) = subArray\nDebug.Print mainArray(2)(0)\n'prints HELLO\n\nmainArray(3) = Empty\nDebug.Print mainArray(3)(0)\n'Type mismatch\n</code></pre>\n\n<p>Have a look in your Locals Window and test if your arrays are correct.</p>\n\n<p>As noted in the comments, that <code>ReDim</code> without <code>Preserve</code> looks suspicious - I think you may be clearing your old arrays.</p>\n"}], "owner": {"reputation": 699, "user_id": 6104460, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7ed217925225ca2753edfa3539b97908?s=128&d=identicon&r=PG&f=1", "display_name": "Shodan", "link": "https://stackoverflow.com/users/6104460/shodan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 37428630, "answer_count": 1, "score": 0, "last_activity_date": 1464155271, "creation_date": 1464137536, "last_edit_date": 1495542760, "question_id": 37426167, "link": "https://stackoverflow.com/questions/37426167/creating-a-jagged-array-in-vba-writing-seems-to-work-but-reading-fails-type-mis", "title": "Creating a jagged array in VBA, writing seems to work but reading fails Type Mismatch", "body": "<p>I'm in SAP, trying to dump an array of GuiLabel s into a jagged array.</p>\n\n<p>First I parse the child's ID to get the row and column while filtering out non-GuiLabel objects.</p>\n\n<p>This part works.</p>\n\n<p>I created a variant array that represents the lines, in each line element I put an array of strings representing each 'label columns'.</p>\n\n<p>This part seems to work with no errors</p>\n\n<p>The problem occurs when I try to read back from this first variant array.</p>\n\n<p>I followed this great thread -> <a href=\"https://stackoverflow.com/questions/9435608/how-do-i-set-up-a-jagged-array-in-vba\">How do I set up a &quot;jagged array&quot; in VBA?</a></p>\n\n<p>and by the end of it, it seems I should be able to read each of my elements with a simple  Debug.Print myRows(0)(0) , however I get a type mismatch !</p>\n\n<p>Any advice appreciated !</p>\n\n<pre><code>Function LabelToArray(LblCollection As Variant) As Variant()\n\n    Dim myid As String\n    Dim mycolumn As String\n    Dim myrow As String\n    Dim intLastRow As Integer\n    Dim intLastCol As Integer\n    Dim myRows As Variant\n    Dim myColumns() As String\n\n    ' Create first row\n    ReDim myRows(0)\n\n    ' For every child object in the collection\n    For Each mychld In LblCollection\n\n        ' Only execute for labels\n        If mychld.Type = \"GuiLabel\" Then\n\n            ' Get column and row of current label\n            myid = Split(mychld.ID, \"[\")(4)\n            myid = Mid(myid, 1, Len(myid) - 1)\n            mycolumn = Split(myid, \",\")(0)\n            myrow = Split(myid, \",\")(1)\n\n            ' New row ? Reset column counter, set row counter and redim the array of rows\n            ' This will fail spectacularly if SAP stop giving rows in numerical order\n            If myrow &gt; intLastRow Then intLastCol = 0: intLastRow = myrow: ReDim myRows(myrow)\n\n            ' Reset or resize this line's columns array\n            If intLastCol = 0 Then\n                ' Set filled out 'myColumns' array into correct 'myRows' object\n                If myrow &lt;&gt; 0 Then myRows(myrow - 1) = myColumns\n                ' testing, print last column in this row\n                If myrow &lt;&gt; 0 Then Debug.Print myColumns(UBound(myColumns))\n                ' testing, print first column in this row\n                If myrow &lt;&gt; 0 Then Debug.Print myColumns(0)\n                ' testing, print number of columns\n                If myrow &lt;&gt; 0 Then Debug.Print UBound(myColumns)\n                ' Reset myColumns array because we're on a new line\n                ReDim myColumns(0)\n            Else\n                ReDim Preserve myColumns(intLastCol)\n            End If\n\n            myColumns(intLastCol) = mychld.Text\n\n            intLastCol = intLastCol + 1\n\n            'Debug.Print mycolumn &amp; \",\" &amp; myrow\n\n        End If\n\n    Next\n\n    ' Copy last row into array\n    myRows(myrow) = myColumns\n\n    ' SEEMS TO WORK FINE UP TO THIS POINT !\n\n    Debug.Print UBound(myRows)\n    Debug.Print myRows(0)(0)  'THIS LINE FAILS, TYPE MISMATCH (run-time error 13) ! I also tried cstr(myRows(0)(0))\n\n    LabelToArray = myRows\n\nEnd Function\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 5399736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153734041789047/picture?type=large", "display_name": "bcrimmins", "link": "https://stackoverflow.com/users/5399736/bcrimmins"}, "edited": false, "score": 0, "creation_date": 1464243505, "post_id": 37438468, "comment_id": 62406643, "body": "Thanks, @gustav.  I see what you&#39;re doing here and it makes sense.  We&#39;re using Windows integrated security, (i.e., Trusted_Connection = True), so I would need to rewrite the connection string but in principle I &quot;get it&quot;."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 115, "user_id": 5399736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153734041789047/picture?type=large", "display_name": "bcrimmins", "link": "https://stackoverflow.com/users/5399736/bcrimmins"}, "edited": false, "score": 0, "creation_date": 1464249297, "post_id": 37438468, "comment_id": 62409812, "body": "Yes, it shouldn&#39;t be much more than a simple replacement of the <code>ConnectionString</code> function."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1464182343, "creation_date": 1464182343, "answer_id": 37438468, "question_id": 37426141, "link": "https://stackoverflow.com/questions/37426141/access-vba-connection-to-test-existence-of-sql-server/37438468#37438468", "title": "Access VBA connection to test existence of SQL Server", "body": "<p>We use a pass-through query, VerifyConnection, which just opens a small table.</p>\n\n<p>The test alters the connection and checks if it can read the table:</p>\n\n<pre><code>Public Function IsSqlServer( _\n    ByVal TestNewConnection As Boolean, _\n    Optional ByVal Hostname As String, _\n    Optional ByVal Database As String, _\n    Optional ByVal Username As String, _\n    Optional ByVal Password As String, _\n    Optional ByRef ErrNumber As Long) _\n    As Boolean\n\n    Const cstrQuery     As String = \"VerifyConnection\"\n\n    Dim dbs             As DAO.Database\n    Dim qdp             As DAO.QueryDef\n    Dim rst             As DAO.Recordset\n\n    Dim booConnected    As Boolean\n    Dim strConnect      As String\n    Dim strConnectOld   As String\n    Dim booCheck        As Boolean\n\n    Set dbs = CurrentDb\n    Set qdp = dbs.QueryDefs(cstrQuery)\n\n    If Hostname &amp; Database &amp; Username &amp; Password = \"\" Then\n        If TestNewConnection = False Then\n            ' Verify current connection.\n            booCheck = True\n        Else\n            ' Fail. No check needed.\n            ' A new connection cannot be checked with empty parameters.\n        End If\n    Else\n        strConnectOld = qdp.Connect\n        strConnect = ConnectionString(Hostname, Database, Username, Password)\n        If strConnect &lt;&gt; strConnectOld Then\n            If TestNewConnection = False Then\n                ' Fail. No check needed.\n                ' Tables are currently connected to another database.\n            Else\n                ' Check a new connection.\n                qdp.Connect = strConnect\n                booCheck = True\n            End If\n        Else\n            ' Check the current connection.\n            strConnectOld = \"\"\n            booCheck = True\n        End If\n    End If\n\n    On Error GoTo Err_IsSqlServer\n\n    ' Perform check of a new connection or verify the current connection.\n    If booCheck = True Then\n        Set rst = qdp.OpenRecordset()\n        ' Tried to connect ...\n        If ErrNumber = 0 Then\n            If Not (rst.EOF Or rst.BOF) Then\n                ' Success.\n                booConnected = True\n            End If\n            rst.Close\n        End If\n\n        If strConnectOld &lt;&gt; \"\" Then\n            ' Restore old connection parameters.\n            qdp.Connect = strConnectOld\n        End If\n    End If\n\n    Set rst = Nothing\n    Set qdp = Nothing\n    Set dbs = Nothing\n\n    IsSqlServer = booConnected\n\nExit_IsSqlServer:\n    Exit Function\n\nErr_IsSqlServer:\n    ' Return error.\n    ErrNumber = Err.Number\n    ErrorMox \"Tilslutning af database\"\n    ' Resume to be able to restore qdp.Connect to strConnectOld.\n    Resume Next\n\nEnd Function\n</code></pre>\n\n<p>This way you will check the complete route all the way to a single table.</p>\n"}], "owner": {"reputation": 115, "user_id": 5399736, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/10153734041789047/picture?type=large", "display_name": "bcrimmins", "link": "https://stackoverflow.com/users/5399736/bcrimmins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 37438468, "answer_count": 1, "score": 2, "last_activity_date": 1594642070, "creation_date": 1464137309, "last_edit_date": 1594642070, "question_id": 37426141, "link": "https://stackoverflow.com/questions/37426141/access-vba-connection-to-test-existence-of-sql-server", "title": "Access VBA connection to test existence of SQL Server", "body": "<p>I have an Access application that needs to connect to one of several possible SQL Servers (i.e., connect linked tables) and I have a list of those possible SQL Server instance names.  When the application launches, it needs to go see which of the possible servers is available.  Considering the sluggishness of solutions like using SQLBrowseConnect or NetServerEnum, I'm wondering if there is a clean and fast way to 'ping' for a SQL Server based on its name.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464166787, "post_id": 37426085, "comment_id": 62368172, "body": "please could you clarify if you want to identify the first empty column (reading from the left) which may be sandwiched between other column content. Or, if you want to find the first empty column after the last column of content ignoring any blank columns that might be there?"}], "answers": [{"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464158654, "post_id": 37428152, "comment_id": 62363419, "body": "If there&#39;s an empty column between various populated columns I don&#39;t believe that the suggested update will find the real &#39;last&#39; column."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464166408, "post_id": 37428152, "comment_id": 62367940, "body": "@robin, please go through the question. He is asking the next empty column"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464166613, "post_id": 37428152, "comment_id": 62368057, "body": "understand your point; my interpretation of the question is that the OP is looking for the rightmost empty column. This is based on their coding where he works leftward from the last column in the sheet. Understand your code picks up the first empty column looking rightward from column 1. I&#39;ve asked the OP to elaborate."}, {"owner": {"reputation": 13, "user_id": 6358638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5986ab7c06bad24b2e8b932730b61937?s=128&d=identicon&r=PG&f=1", "display_name": "Hayley Watson", "link": "https://stackoverflow.com/users/6358638/hayley-watson"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1464218250, "post_id": 37428152, "comment_id": 62399993, "body": "@Robin the current code is something a co-worker gave me and not necessarily what I was after - I don&#39;t need the rightmost. Thank You for your assistance though :)"}, {"owner": {"reputation": 13, "user_id": 6358638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5986ab7c06bad24b2e8b932730b61937?s=128&d=identicon&r=PG&f=1", "display_name": "Hayley Watson", "link": "https://stackoverflow.com/users/6358638/hayley-watson"}, "edited": false, "score": 0, "creation_date": 1464218421, "post_id": 37428152, "comment_id": 62400028, "body": "@NanAvanIllai I&#39;m getting a Run Time 1004 error- &quot;Application defined or object-defined error. Debug shows it on the line    &#39;source.Range(&quot;m26:m35&quot;).Copy destination.Cells(1, emptyColumn)&#39;"}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "reply_to_user": {"reputation": 13, "user_id": 6358638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5986ab7c06bad24b2e8b932730b61937?s=128&d=identicon&r=PG&f=1", "display_name": "Hayley Watson", "link": "https://stackoverflow.com/users/6358638/hayley-watson"}, "edited": false, "score": 0, "creation_date": 1464251435, "post_id": 37428152, "comment_id": 62411077, "body": "@HayleyWatson, check your destination sheet name"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1464152426, "creation_date": 1464152426, "answer_id": 37428152, "question_id": 37426085, "link": "https://stackoverflow.com/questions/37426085/copy-paste-range-as-values-into-next-empty-column-on-another-sheet/37428152#37428152", "title": "Copy &amp; Paste range as values into next empty column on another sheet", "body": "<p>try with below</p>\n\n<pre><code>Sub CommandButton3_Click()\n    Dim source As Worksheet\n    Dim destination As Worksheet\n    Dim emptyColumn As Long\n    Set source = Sheets(\"Month Template\")\n    Set destination = Sheets(\"Sheet1\")\n    'find empty Column (actually cell in Row 1)'\n    emptyColumn = destination.Cells(1, 1).End(xlToRight).Column\n    If emptyColumn &gt; 1 Then\n        emptyColumn = emptyColumn + 1\n    End If\n    source.Range(\"m26:m35\").Copy destination.Cells(1, emptyColumn)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1574686565, "creation_date": 1574686565, "answer_id": 59032363, "question_id": 37426085, "link": "https://stackoverflow.com/questions/37426085/copy-paste-range-as-values-into-next-empty-column-on-another-sheet/59032363#59032363", "title": "Copy &amp; Paste range as values into next empty column on another sheet", "body": "<p>This is an old question that popped up.\nWhen reading the Op's question, it looks like they want to make sure the 1st column is used and then move over to column 2.</p>\n\n<pre><code>If emptyColumn &gt; 1 Then\n</code></pre>\n\n<p>When 1st using the copy&amp;paste code <code>emptycolumn</code> will never be greater than 1.</p>\n\n<p>A possible solution would be to 1st check if A1 =\"\" when emptycolumn=2.</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n    Dim source As Worksheet\n    Dim destination As Worksheet\n    Dim emptyColumn As Long\n\n    Set source = Sheets(\"Month Template\")\n    Set destination = Sheets(\"Sheet1\")\n\n    'find empty Column (actually cell in Row 1)'\n    emptyColumn = destination.Cells(1, destination.Columns.Count).End(xlToLeft).Column + 1\n\n    If destination.Cells(1, 1) = \"\" And emptyColumn = 2 Then emptyColumn = 1\n\n    source.Range(\"m26:m35\").Copy destination.Cells(1, emptyColumn)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6358638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5986ab7c06bad24b2e8b932730b61937?s=128&d=identicon&r=PG&f=1", "display_name": "Hayley Watson", "link": "https://stackoverflow.com/users/6358638/hayley-watson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7592, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1615652098, "creation_date": 1464136723, "last_edit_date": 1615652098, "question_id": 37426085, "link": "https://stackoverflow.com/questions/37426085/copy-paste-range-as-values-into-next-empty-column-on-another-sheet", "title": "Copy &amp; Paste range as values into next empty column on another sheet", "body": "<p>I am trying to copy a range (which varies based on inputs) as values into another sheet.<br />\nThe code below seems to be copying on top of the last entry rather than into the next empty column.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CommandButton3_Click()\n    \n    Dim source As Worksheet\n    Dim destination As Worksheet\n    Dim emptyColumn As Long\n        \n    Set source = Sheets(&quot;Month Template&quot;)\n    Set destination = Sheets(&quot;Sheet1&quot;)\n        \n    'find empty Column (actually cell in Row 1)'\n    emptyColumn = destination.Cells(1, destination.Columns.Count).End(xlToLeft).Column\n    If emptyColumn &gt; 1 Then\n        emptyColumn = emptyColumn + 1\n    End If\n    \n    source.Range(&quot;m26:m35&quot;).Copy destination.Cells(1, emptyColumn)\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2013"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 4, "creation_date": 1464138201, "post_id": 37425967, "comment_id": 62357503, "body": "Change &quot;Data Entry&quot; property to Yes."}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1464142123, "post_id": 37425967, "comment_id": 62358349, "body": "Don&#39;t use a datasheet; instead create a form to accept the values of the various columns and save the new row."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1464154481, "post_id": 37425967, "comment_id": 62361558, "body": "In addition to HansUp&#39;s suggestion, you can try setting RecordSource to something like &quot;select * from tblHours1 where false&quot;   User can then submit new record(s) without viewing any existing (though they will be able to see any records they enter in that session)"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1464160710, "post_id": 37425967, "comment_id": 62364587, "body": "Another suggestion is to open the form on <code>DoCmd.OpenForm &quot;Form_Name&quot;, acNormal, , &quot;1 = 0&quot;, , acDialog</code>. Then remove the record navigator from the base of the form in the properties.,"}], "owner": {"reputation": 597, "user_id": 2861976, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/35336c1627553c3d2575eee027c77f51?s=128&d=identicon&r=PG&f=1", "display_name": "goutam", "link": "https://stackoverflow.com/users/2861976/goutam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1572, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593958526, "creation_date": 1464135798, "last_edit_date": 1593958526, "question_id": 37425967, "link": "https://stackoverflow.com/questions/37425967/allow-only-additions-and-hide-existing-records-in-access-form", "title": "Allow only additions and hide existing records in access form", "body": "<p>I have a form in Access that is linked with a table. When a user opens the form, I do not want the user to access or view the existing records and only be able to submit a new entry.</p>\n\n<p>I have already given the following values for AllowAdditions, AllowDeletions and AllowEdits as shown in the image below but this gives a button to navigate through all the records in the table.</p>\n\n<ul>\n<li>AllowAdditions - Yes </li>\n<li>AllowDeletions - No </li>\n<li>AllowEdits - No</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/AyNKq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AyNKq.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1464132985, "post_id": 37425546, "comment_id": 62356272, "body": "The Range statement is looking for the last used row (lr) in column C by starting at C65536 and jumping upwards.  If you want to find parts of a string inside a cell value, you need to look at the <code>InStr</code> function..."}, {"owner": {"reputation": 843, "user_id": 2726160, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100001903297961/picture?type=large", "display_name": "Rob White", "link": "https://stackoverflow.com/users/2726160/rob-white"}, "edited": false, "score": 2, "creation_date": 1464133059, "post_id": 37425546, "comment_id": 62356296, "body": "If you just want to check if the cell contains certain characters you could use instr <a href=\"http://www.exceltrick.com/formulas_macros/vba-instr-function/\" rel=\"nofollow noreferrer\">exceltrick.com/formulas_macros/vba-instr-function</a> If i&#39;ve understood the question correctly"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 843, "user_id": 2726160, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100001903297961/picture?type=large", "display_name": "Rob White", "link": "https://stackoverflow.com/users/2726160/rob-white"}, "edited": false, "score": 1, "creation_date": 1464135585, "post_id": 37425546, "comment_id": 62356963, "body": "<code>InStr</code> tells you if the content you&#39;re looking for is in the string (and thus the origin of the name <code>InStr</code>). Instead of guessing whether you understand it correctly, you could read the page @Rob linked or read the documentation for the function."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "reply_to_user": {"reputation": 843, "user_id": 2726160, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100001903297961/picture?type=large", "display_name": "Rob White", "link": "https://stackoverflow.com/users/2726160/rob-white"}, "edited": false, "score": 0, "creation_date": 1464141337, "post_id": 37425546, "comment_id": 62358209, "body": "@RobWhite I did read the page that Rob linked. Thank you everyone for contributing I&#39;ll do my best to take it from here unless anyone else would care to comment."}], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1464157937, "creation_date": 1464157937, "answer_id": 37429403, "question_id": 37425546, "link": "https://stackoverflow.com/questions/37425546/vba-using-like-operator-with-wildcards/37429403#37429403", "title": "VBA using like operator with wildcards", "body": "<p>Your current macro doesn't compare anything the way you want it to, it just checks whether or not two columns are empty.</p>\n\n<p>You haven't been very specific with what you are trying to do, so this code is done with a bit of guess-work:</p>\n\n<pre><code>Sub droppeddata()\n    Dim lr As Long ' Declare the variable\n    lr = Range(\"C65536\").End(xlUp).Row ' Set the variable\n    ' lr now contains the last used row in column C\n\n    Application.ScreenUpdating = False\n\n    For a = lr To 1 Step -1\n        If IsEmpty(Cells(a, 19)) Or InStr(1, Cells(a, 13).Value, Cells(a, 19).Value, vbTextCompare) &gt; 0 Then\n        ' If Cells(a, 19) is empty OR\n        ' Search Cells(a, 13) for the value contained in Cells(a, 19)\n        ' If INSTR returns a match greater than 0, it means the string we're looking for is present\n        ' Enter the loop if either condition is true\n\n            ' In this section, avoiding SELECT is preferable. Working directly on the ranges is good.\n            With Cells(a, 10)\n                .NumberFormat = \"General\"\n                .Value = \"N\"\n            End With\n\n            With Cells(a, 11)\n                .NumberFormat = \"General\"\n                .Value = \"Dropped Data\"\n            End With\n        End If\n    Next a\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Change the ranges/cells to your need - the current ones aren't meant to work, I merely guessed based on your existing code.</p>\n"}], "owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 37429403, "answer_count": 1, "score": 0, "last_activity_date": 1464157937, "creation_date": 1464132647, "last_edit_date": 1464133421, "question_id": 37425546, "link": "https://stackoverflow.com/questions/37425546/vba-using-like-operator-with-wildcards", "title": "VBA using like operator with wildcards", "body": "<p>I'm trying to compare address data. My current macro compares two columns and inputs \"Dropped Data\" when they don't match. The problem is that a large number of these values haven't been dropped but integrated into another cell. I want to change my macro to be able to find the missing value using VBA's like operator. For example it would find \"Bldg 3\" in \"9825 Spectrum Dr Bldg 3\". I was able to get this code from looking around the web and I'm not sure what range <code>Range(\"C65536\")</code> is selecting.</p>\n\n<p>Edit: I see people are suggesting I use the Instr function which does seem to do what I want to do. I'm not sure how I would get it to work in my macro/ get it to reference the correct cells. It also (from what I understand) returns values equal to the number of characters found. So in the example I gave it would return a value of 6 if you include the space. </p>\n\n<pre><code>Sub droppeddata()\n\nApplication.ScreenUpdating = False\n\nlr = Range(\"C65536\").End(xlUp).Row\nFor a = lr To 1 Step -1\nIf Not IsEmpty(Cells(a, 13).Value) And IsEmpty(Cells(a, 19)) Then\nCells(a, 10).Select\nSelection.NumberFormat = \"General\"\n    ActiveCell.FormulaR1C1 = \"N\"\nCells(a, 11).Select\nSelection.NumberFormat = \"General\"\n    ActiveCell.FormulaR1C1 = \"Dropped Data\"\nEnd If\nNext a\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "csv", "ms-access", "import"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1464133287, "post_id": 37425250, "comment_id": 62356376, "body": "Run a select on the CSV file before doing the insert, then adjust your SQL statement to match the actual file."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6378550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uSoQJUtqwSY/AAAAAAAAAAI/AAAAAAAABCY/UdQRlHJEHqs/photo.jpg?sz=128", "display_name": "Cameron Butterfield", "link": "https://stackoverflow.com/users/6378550/cameron-butterfield"}, "edited": false, "score": 0, "creation_date": 1464198667, "post_id": 37425735, "comment_id": 62390869, "body": "This is a good workaround, it is case by case, but I should only have 2-3 different formats that would have different numbers of columns.In the first part of your code, the numfields string seems to end up being the number of commas in the entire file instead of just the first line. How can I fix this?"}, {"owner": {"reputation": 1, "user_id": 6378550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uSoQJUtqwSY/AAAAAAAAAAI/AAAAAAAABCY/UdQRlHJEHqs/photo.jpg?sz=128", "display_name": "Cameron Butterfield", "link": "https://stackoverflow.com/users/6378550/cameron-butterfield"}, "edited": false, "score": 0, "creation_date": 1464208737, "post_id": 37425735, "comment_id": 62396362, "body": "I figured it out. My csvs have carriage returns CR instead of line ends CRLF. It&#39;s always something."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1464133886, "creation_date": 1464133886, "answer_id": 37425735, "question_id": 37425250, "link": "https://stackoverflow.com/questions/37425250/how-do-i-insert-a-blank-value-when-field-does-not-exist-in-access/37425735#37425735", "title": "How do I insert a blank value when field does not exist in Access?", "body": "<p>Start by checking the number of fields in the file:</p>\n\n<pre><code>dim fso : Set fso = CreateObject(\"Scripting.FileSystemObject\")\ndim file : Set file = fso.OpenTextFile(\"C:\\ImportPath\\test.csv\")\nfirstLine = file.ReadLine ' read first line\nfieldArray = Split(firstLine, \"whateverfielddelimiteryouhave\")\nnumFields = UBound(fieldArray) + 1  'index on arrays from zero\n</code></pre>\n\n<p>This will tell you how many fields there are.  If you have defined both SQL with and without <code>[SKU-2]</code> then you can use a simple <code>IF</code> to select which to execute:</p>\n\n<pre><code>If numFields = 22 Then\nsql = \"INSERT INTO MumbyCSV (OrderID, Email, FirstName, LastName, Company, Phone, SecondaryPhone,\" &amp; _\n        \"Fax, ApproveStatus, OrderDate, [SKU-1], [SKU-2], Total, ShiptoName, ShipToAddress1, ShipToAddress2,\" &amp; _\n        \"ShipToCity, ShipToState, ShipToZip, ShipToCountry, ShippingMethod, Comments)\" &amp; _\n        \"SELECT OrderID, Email, FirstName, LastName, Company, Phone, SecondaryPhone,\" &amp; _\n        \"Fax, ApproveStatus, OrderDate, [SKU-1], [SKU-2], Total, ShiptoName, ShipToAddress1, ShipToAddress2,\" &amp; _\n        \"ShipToCity, ShipToState, ShipToZip, ShipToCountry, ShippingMethod, Comments \" &amp; _\n        \"FROM [Text;FMT=Delimited;HDR=YES;DATABASE=C:\\ImportPath].[test.csv]\" \nElse\nsql = \"INSERT INTO MumbyCSV (OrderID, Email, FirstName, LastName, Company, Phone, SecondaryPhone,\" &amp; _\n        \"Fax, ApproveStatus, OrderDate, [SKU-1], Total, ShiptoName, ShipToAddress1, ShipToAddress2,\" &amp; _\n        \"ShipToCity, ShipToState, ShipToZip, ShipToCountry, ShippingMethod, Comments)\" &amp; _\n        \"SELECT OrderID, Email, FirstName, LastName, Company, Phone, SecondaryPhone,\" &amp; _\n        \"Fax, ApproveStatus, OrderDate, [SKU-1], Total, ShiptoName, ShipToAddress1, ShipToAddress2,\" &amp; _\n        \"ShipToCity, ShipToState, ShipToZip, ShipToCountry, ShippingMethod, Comments \" &amp; _\n        \"FROM [Text;FMT=Delimited;HDR=YES;DATABASE=C:\\ImportPath].[test.csv]\"\nEnd If\n\nCurrentDB.Execute sql\n</code></pre>\n\n<p>A second option would be to read the values to be imported into an array, and where the value is an empty string, replace it with a NULL so that the field doesn't get set on the INSERT step. However if you must import directly from the file as per your code I don't think you can do this.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6378550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uSoQJUtqwSY/AAAAAAAAAAI/AAAAAAAABCY/UdQRlHJEHqs/photo.jpg?sz=128", "display_name": "Cameron Butterfield", "link": "https://stackoverflow.com/users/6378550/cameron-butterfield"}, "edited": false, "score": 0, "creation_date": 1464196823, "post_id": 37426426, "comment_id": 62389853, "body": "I was originally using this method, but it gives a lot of Import error tables  until an import specification file is set. However the second I define an import specification, it breaks if I try to import a csv with different fields than my specification file (which is my problem in the first place; differently formatted csv files flowing in)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 1, "user_id": 6378550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uSoQJUtqwSY/AAAAAAAAAAI/AAAAAAAABCY/UdQRlHJEHqs/photo.jpg?sz=128", "display_name": "Cameron Butterfield", "link": "https://stackoverflow.com/users/6378550/cameron-butterfield"}, "edited": false, "score": 0, "creation_date": 1464205750, "post_id": 37426426, "comment_id": 62394801, "body": "Hmmm...the import spec is optional and does tailor specifically to a structured file. But if your file is clearly comma-separated with column headers and data types aligning to destination table this should work."}, {"owner": {"reputation": 1, "user_id": 6378550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uSoQJUtqwSY/AAAAAAAAAAI/AAAAAAAABCY/UdQRlHJEHqs/photo.jpg?sz=128", "display_name": "Cameron Butterfield", "link": "https://stackoverflow.com/users/6378550/cameron-butterfield"}, "edited": false, "score": 0, "creation_date": 1464801145, "post_id": 37426426, "comment_id": 62637006, "body": "Thanks I did end up using your suggestion using several different spec files and also Dave&#39;s suggestion combined to get a fairly robust import now."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1464139828, "creation_date": 1464139828, "answer_id": 37426426, "question_id": 37425250, "link": "https://stackoverflow.com/questions/37425250/how-do-i-insert-a-blank-value-when-field-does-not-exist-in-access/37426426#37426426", "title": "How do I insert a blank value when field does not exist in Access?", "body": "<p>Consider using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835958.aspx\" rel=\"nofollow\">TransferText</a> which does not require any order of columns and ignores missing columns, just as long as the current file being imported maintains columns somewhere in the table:</p>\n\n<pre><code>DoCmd.TransferText acImportDelim, , \"MumbyCSV\", \"C:\\ImportPath\\test.csv\", True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6378550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uSoQJUtqwSY/AAAAAAAAAAI/AAAAAAAABCY/UdQRlHJEHqs/photo.jpg?sz=128", "display_name": "Cameron Butterfield", "link": "https://stackoverflow.com/users/6378550/cameron-butterfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1513158592, "creation_date": 1464130763, "last_edit_date": 1513158592, "question_id": 37425250, "link": "https://stackoverflow.com/questions/37425250/how-do-i-insert-a-blank-value-when-field-does-not-exist-in-access", "title": "How do I insert a blank value when field does not exist in Access?", "body": "<p>I am using vba code in Microsoft Access to import several csv files at once, unfortunately, not all the csv files have the same formatting; some files just have [SKU-1], but some of the files have a second field [SKU-2].</p>\n\n<p>My code works as written below for the files that have both sku-1 and sku-2 as fields in the csv file, however, if a file ONLY has [SKU-1], the import fails with \"Too few parameters. Expected 1.\" </p>\n\n<p>Is there any way to use some sort of case statement to drop a NULL value for SKU-2 if the field itself does not exist to be pulled from? </p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO MumbyCSV (OrderID, Email, FirstName, LastName, Company, Phone, SecondaryPhone,\" &amp; _\n        \"Fax, ApproveStatus, OrderDate, [SKU-1], [SKU-2], Total, ShiptoName, ShipToAddress1, ShipToAddress2,\" &amp; _\n        \"ShipToCity, ShipToState, ShipToZip, ShipToCountry, ShippingMethod, Comments)\" &amp; _\n        \"SELECT OrderID, Email, FirstName, LastName, Company, Phone, SecondaryPhone,\" &amp; _\n        \"Fax, ApproveStatus, OrderDate, [SKU-1], [SKU-2], Total, ShiptoName, ShipToAddress1, ShipToAddress2,\" &amp; _\n        \"ShipToCity, ShipToState, ShipToZip, ShipToCountry, ShippingMethod, Comments \" &amp; _\n        \"FROM [Text;FMT=Delimited;HDR=YES;DATABASE=C:\\ImportPath].[test.csv]\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464133257, "post_id": 37425598, "comment_id": 62356367, "body": "I would rather avoid a loop if I can. This used to work but I made some changes and I am not sure what would cause it to start including hidden fields."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464133295, "post_id": 37425598, "comment_id": 62356378, "body": "@TonyP, double comment."}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464133683, "post_id": 37425598, "comment_id": 62356481, "body": "@TonyP, <code>Calculations</code> worksheet in your code is not set. That would throw the error you speak of. My bad. I see you have it set within the dim statements."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464133837, "post_id": 37425598, "comment_id": 62356528, "body": "Isn&#39;t it set with                                                                          Set Calculations = ThisWorkbook.Sheets(&quot;Calculations&quot;)?"}, {"owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "reply_to_user": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "edited": false, "score": 0, "creation_date": 1464134599, "post_id": 37425598, "comment_id": 62356729, "body": "@TonyP. yes it is, I realized after I posted that comment. Can you temporarly create a sheet and replace the <code>calculations</code> sheet in the code? ie, <code>Destination:=Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;)</code>"}], "tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": false, "score": 0, "last_activity_date": 1464133391, "last_edit_date": 1464133391, "creation_date": 1464132968, "answer_id": 37425598, "question_id": 37425104, "link": "https://stackoverflow.com/questions/37425104/code-to-copy-only-filtered-data/37425598#37425598", "title": "Code to copy only filtered data", "body": "<p>Something like this would work, replace the ranges with any other ranges you need to copy data from.</p>\n\n<pre><code>dim r As Range \ndim x(1 to 100,1 to 1) \ni = 1 \n   For Each r In PersonResponsible.SpecialCells(xlCellTypeVisible)\n        x(i,1) = r :i = i + 1 \n   Next\n   Calculations.Range(\"A1\").resize(i-1).value = x\n</code></pre>\n\n<p>Edit:\nMaybe something like this,</p>\n\n<pre><code>PersonResponsible.SpecialCells(xlCellTypeVisible).Copy _\n        Destination:=Calculations.Range(\"A1\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "is_accepted": false, "score": 0, "last_activity_date": 1464133611, "creation_date": 1464133611, "answer_id": 37425696, "question_id": 37425104, "link": "https://stackoverflow.com/questions/37425104/code-to-copy-only-filtered-data/37425696#37425696", "title": "Code to copy only filtered data", "body": "<p>use <code>Advanced Filter</code> with something like this:</p>\n\n<pre><code>Dim rCriteria as Range\nSet rCriteria = [Headears of columns you want]\n\nRNG.AdvancedFilter Action:=xlFilterCopy, CriteriaRange:= rCriteria, _  \n                        CopyToRange:=[where you want], Unique:=True\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464133611, "creation_date": 1464129821, "question_id": 37425104, "link": "https://stackoverflow.com/questions/37425104/code-to-copy-only-filtered-data", "title": "Code to copy only filtered data", "body": "<p>This code works for the most part but it copies all data in the data set rather than just the data that has been filtered. The filter is working correctly when I step through it but it copies everything. What am I  doing wrong?</p>\n\n<pre><code>Sub Auto_Filter()\n\nDim RNG As Range\nDim Open_Jobs_Report As Worksheet\nSet Open_Jobs_Report = ThisWorkbook.Sheets(\"Open Jobs Report\")\nDim Calculations As Worksheet\nSet Calculations = ThisWorkbook.Sheets(\"Calculations\")\nDim PersonResponsible As Range\nDim Violations As Range\nDim CLM1 As Long\nDim CLM2 As Long\n\n\n    With Sheets(\"Open Jobs Report\")\n        Set RNG = .Range(\"A1\", .Cells(.Cells(.Rows.Count, \"A\").End(xlUp).Row, .Cells(1, .Columns.Count).End(xlToLeft).Column))\n        RNG.AutoFilter Field:=19, Criteria1:=\"&lt;&gt;\"\n\n        CLM1 = .Range(\"1:1\").Find(What:=\"Person Responsible\").Column\n        Set PersonResponsible = .Range(.Cells(1, CLM1), .Cells(1, CLM1).End(xlDown))\n        CLM2 = .Range(\"1:1\").Find(What:=\"Violations\").Column\n        Set Violations = .Range(.Cells(1, CLM2), .Cells(1, CLM2).End(xlDown))\n\n    End With\n\n\n    Calculations.Range(\"A:A\").Value = PersonResponsible.Value\n    Calculations.Range(\"B:B\").Value = Violations.Value\n\n\n\n\n    With Sheets(\"Open Jobs Report\")\n\n    ActiveSheet.ListObjects(1).AutoFilter.ShowAllData '&lt;= Fix this\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464127805, "post_id": 37424431, "comment_id": 62354617, "body": "how do you know that what you are looking for is AZSD1 in column E and not WHATEVER in F or whatever 2 in G etc.  Right now if I understand the pattern is the value in J is in the row that corresponds to K."}, {"owner": {"reputation": 511, "user_id": 2611889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5529ac140dc77f25406806aea65c4ca?s=128&d=identicon&r=PG", "display_name": "zack.lore", "link": "https://stackoverflow.com/users/2611889/zack-lore"}, "edited": false, "score": 0, "creation_date": 1464128494, "post_id": 37424431, "comment_id": 62354854, "body": "You want to search for the &#39;Find This&#39; value from doc 2 in doc 1 and when that value is found in any column you want the &#39;Want This&#39; column value from that same row to be put into your Result column?  Do I have that correct?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464128864, "post_id": 37424431, "comment_id": 62355004, "body": "How do you know for you last entry to go back to ID1 to the left and not take if from somewhere on the right?"}, {"owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "reply_to_user": {"reputation": 511, "user_id": 2611889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5529ac140dc77f25406806aea65c4ca?s=128&d=identicon&r=PG", "display_name": "zack.lore", "link": "https://stackoverflow.com/users/2611889/zack-lore"}, "edited": false, "score": 0, "creation_date": 1464130542, "post_id": 37424431, "comment_id": 62355574, "body": "@zack.lore You are correct. I&#39;ve edited my question to be more explicit."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464132252, "post_id": 37424431, "comment_id": 62356060, "body": "@Bort Scott brought up a good point.  I had assumed all IDs column J that you are searching for would be UNIQUE.  Is your list in J only unique items in terms that they will only be found by themselves once in columns B:H.  I understand that Column F they will be compounded with other words which makes column F different.  IF a value from column J can be found both in column B and Column H, do you want the first, last, or some other numbered occurrence to be returned?"}], "answers": [{"comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1464128994, "post_id": 37424904, "comment_id": 62355047, "body": "Did you test that? The column headers don&#39;t have the ID numbers."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1464129414, "post_id": 37424904, "comment_id": 62355192, "body": "@teylyn Where did it say the column headers dont have ID numbers?  I must have missed that part."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1464130109, "post_id": 37424904, "comment_id": 62355442, "body": "Column J is already established. The OP wants the formula for the result in column K in the screenshot of the question."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1464130111, "post_id": 37424904, "comment_id": 62355443, "body": "@teylyn his screen shot has ID2 and ID3 and ID4  they are just not in the header row.  Its how I was basing what number to bring over.  HOWEVER in hindsight, I think I miss understood the question and he is trying to generate column K based on given values in column J."}, {"owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464130208, "post_id": 37424904, "comment_id": 62355471, "body": "Indeed, I&#39;m trying to generate K from J, sorry for my confusing question. I also should have mentioned that the headers &quot;ID[#]&quot; are just example headers."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464130819, "post_id": 37424904, "comment_id": 62355660, "body": "@Tetlyn and I had interpreted the Q as find this based on my results. I was wrong. However its been cleared up now.  Its also why I prefaced original answer with &quot;If I understood..&quot;"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464131139, "post_id": 37424904, "comment_id": 62355742, "body": "@Bort  All good,  its what happens when there are uncertainties and answers are given prior to clarification.  With things cleared up you have multiple approaches options to choose from for what suits you best."}, {"owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464131169, "post_id": 37424904, "comment_id": 62355759, "body": "@ForwardEd  - You are saying that teylyn&#39;s current answer is solving the wrong problem? I&#39;m going to try testing these now, I&#39;ll update with results.."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464131305, "post_id": 37424904, "comment_id": 62355791, "body": "@Bort no, not at all, TEYLYN&#39;s answer is good!  it does what you want it to do, she provided that in proof of a screen shot. heck I even upvoted her answer!  I was the one that was originally backwards.  I deleted that part of my question when I got the clarification.  Both Tetlyn&#39;s and my updated answer should work.  I am assuming the VBA solution works as well."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464131678, "post_id": 37424904, "comment_id": 62355907, "body": "So, what happens when there is more than one value that matches.  With your sumproduct it will add the two rows together and create an error.  IMO use the aggregate or min(if()) to get the first one only."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464132034, "post_id": 37424904, "comment_id": 62356000, "body": "@ScottCranerI had tested that with the partial martch.  ie. column F has blah + ID being searched for.  It was working with that.  IF IDs are not unique then yes problems ensue!"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464133876, "post_id": 37424904, "comment_id": 62356545, "body": "@ScottCraner I figured out how to return the last row, but the first row is eluding me.  I tried the 1st small row number, but that is 0.  I tried throwing an if statement into the aggregate to make 0 results &quot;&quot; and that just made the thing return an error.  I know there is a way to return the 1st row but its currently eluding me 8(  I think the 30C+ temperatures fried my brain today.  I dont do well when its above 20C"}, {"owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464134469, "post_id": 37424904, "comment_id": 62356700, "body": "@ForwardEd - Both your formulas worked in my example file. Hopefully they will work with the real documents tomorrow! Noob question: For your first formula (for non-uniques), dragging the fill handle doesn&#39;t work, as the index array shifts down with the next row, so the results are exponentially shifted. If I recall, there is a way to use absolutes instead of relatives, right?  Your 2nd formula seems to fill just fine. Thanks! Now to test the other answers.."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464135197, "post_id": 37424904, "comment_id": 62356875, "body": "@Bort I just tried copying and pasting both formulas into an excel sheet.  After deleting the &#39;doc1&#39;! references, as they try and make excel open a work sheet that I do not have, I did a drag down and the only letter that changed was the J2.  When adjust the other ranges to suit your data, ensure you have a $ in front the letter and the number.  ensure the reference to J2 has no $ in front of the 2 as the 2 needs to change as you copy/drag down."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464136794, "post_id": 37424904, "comment_id": 62357221, "body": "Divide the row by the boolean do not multiply."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464137115, "post_id": 37424904, "comment_id": 62357290, "body": "@ScottCraner You left out the first step!  Apply palm of hand swiftly to forehead, then proceed with option 6 ignore errors!"}, {"owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464141656, "post_id": 37424904, "comment_id": 62358269, "body": "@ForwardEd - What in the world is going on with &quot;AGGREGATE(...)&quot;? I tried breaking it down with &quot;Evaluate Formula&quot; but I&#39;m still lost. I can make out that the multiplicand (doc1!$B$2:$H$14=J2) becomes a boolean array of comparisons with the J value. Then that is multiplied by ROW(...). But ROW(....) by itself returns an integer. So in the formula, it magically becomes an array. After AGGREGATE(...), it will then evaluate to the correct row #, but then 1 is subtracted. What even?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464144905, "post_id": 37424904, "comment_id": 62358908, "body": "Subtract 1 because you have a header row,  if your header row was 5 lines it would be minus 5.  What is going on inside the aggregate function is an array formula without having to do the CSE part. The gist with the multiplication is that only the row where something is true in the logical part is returned as false is 0 and true is 1"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464155870, "post_id": 37424904, "comment_id": 62362084, "body": "@Bort See Update 3 and if that explains it sufficiently.  You may want to wear a helmet d:)"}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": true, "score": 2, "last_activity_date": 1464155486, "last_edit_date": 1464155486, "creation_date": 1464128723, "answer_id": 37424904, "question_id": 37424431, "link": "https://stackoverflow.com/questions/37424431/how-can-i-lookup-data-from-one-column-when-the-value-im-referencing-changes-co/37424904#37424904", "title": "How can I lookup data from one column, when the value I&#39;m referencing changes columns?", "body": "<p>To generate column K based on given values of column J then you could use the following:</p>\n\n<pre><code>=INDEX(doc1!$D$2:$D$14,SUMPRODUCT((doc1!$B$2:$H$14=J2)*ROW(doc1!$B$2:$H$14))-1)\n</code></pre>\n\n<p>Copy that formula down as far as you need to go.</p>\n\n<p>It basically only returns the row of the where a matching column J is found.  we then find that row in the index of your D range to get your value in K.</p>\n\n<p>Proof of concept:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zjLtB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zjLtB.png\" alt=\"Proof of concept\"></a></p>\n\n<h2>UPDATE:</h2>\n\n<p>If you are working with non unique entities n column J.  That is the value on its own can be found in multiple rows and columns.  Consider using the following to return the Last row where there J value is found:</p>\n\n<pre><code>=INDEX(doc1!$D$2:$D$14,AGGREGATE(14,6,(doc1!$B$2:$H$14=J2)*ROW(doc1!$B$2:$H$14),1)-1)\n</code></pre>\n\n<h2>UPDATE 2:</h2>\n\n<p>And to return the first row where what you are looking in column J is found use:</p>\n\n<pre><code>=INDEX($D$2:$D$14,AGGREGATE(15,6,1/($B$2:$H$14=J2)*ROW($B$2:$H$14)-1,1))\n</code></pre>\n\n<p>Thanks to Scott Craner for the hint on the minimum formula.</p>\n\n<p>To determine if you have UNIQUE data from column J in your range B2:H14 you can enter this array formula.  In order to enter an array formula you need to press CTRL+SHFT+ENTER at the same time and not just ENTER.  You will know you have done it right when you see {} around your formula in the formula bar.  You cannot at the {} manually.</p>\n\n<pre><code>=IF(MAX(COUNTIF($B$2:$H$14,J2:J14))&gt;1,\"DUPLICATES\",\"UNIQUE\")\n</code></pre>\n\n<h2>UPDATE 3</h2>\n\n<p><a href=\"https://support.office.com/en-us/article/AGGREGATE-function-43b9278e-6aa7-4f17-92b6-e19993fa26df\" rel=\"nofollow noreferrer\">AGGREGATE</a> - A relatively new function to me but goes back to Excel 2010.  Aggregate is 19 functions rolled into 1.  It would be nice if they all worked the same way but they do not.   I think it is functions numbered 14 and up that will perform the same way an array formula or a CSE formula if you prefer.  The nice thing is you do not need to use CSE when entering or editing them.  SUMPRODUCT is another example of a regular formula that performs array formula calculations.  </p>\n\n<p>The meat of this explanation I believe is what is happening inside of the AGGREGATE brackets.  If you click on the link you will get an idea of what the first two arguments are.  The first defines which function you are using, and the second tell AGGREGATE how to deal with Errors, hidden rows, and some other nested functions.  That is the relatively easy part.  What I believe you want to know is what is happening with this:</p>\n\n<pre><code>(doc1!$B$2:$H$14=J2)*ROW(doc1!$B$2:$H$14)\n</code></pre>\n\n<p>For illustrative purpose lets reduce this formula to something a little smaller in scale that does the same thing.  I'll avoid starting in A1 as that can make life a little easier when counting since it the 1st row and first column.  So by placing the example range outside of it you can see some more special considerations potentially.</p>\n\n<p>What I want to know is what row each of the items list in Column C occurs in column B</p>\n\n<pre><code>  |    B     |    C\n3 | DOG      |  PLATYPUS\n4 | CAT      |  DOG\n5 | PLATYPUS |\n</code></pre>\n\n<p>The full formula for our mini example would be:</p>\n\n<pre><code>{=($B$3:$B$5=C2)*ROW($B$3:$B$5)}\n</code></pre>\n\n<p>And we are going to look at the following as an array</p>\n\n<pre><code>=INDEX($B$3:$B$5,AGGREGATE(14,6,($B$3:$B$5=C2)*ROW($B$3:$B$5),1)-2)\n</code></pre>\n\n<p>So the first brackets is going to be a Boolean array as you noted.  Every cell that is TRUE will TRUE until its forced into a math calculation.  When that happens, True becomes 1 and False becomes 0.I that formula was entered as a CSE formula and place in D2, it would break down as follows:</p>\n\n<pre><code>FALSE  X  3\nFALSE  X  4\nTRUE   X  5\n</code></pre>\n\n<p>The 3, 4 and 5 come from ROW() returning the value of the row number that it is dealing with at the time of the array math operation.  Little trick, we could have had ROW(1:3).  Just need to make sure the size of the array matches!  This is not matrix math is just straight across multiplication.  And since the Boolean is now experiencing a math operation we are now looking at:</p>\n\n<pre><code>0 X 3 = 0\n0 X 4 = 0\n1 X 5 = 5\n</code></pre>\n\n<p>So the array of {0,0,5} gets handed back to the aggregate for more processing.  The important thing to note here is that it contains ONLY 0 and the individual row numbers where we had a match.  So with the first aggregate formula, formula 14 was chosen which is the <a href=\"https://support.office.com/en-us/article/LARGE-function-3af0af19-1190-42bb-bb8b-01672ec00a64\" rel=\"nofollow noreferrer\">LARGE</a> function. And we also told it to ignore errors, which in this particular case does not matter.  So after providing the array to the aggregate function, there was a <code>,1)</code> to finish off the aggregate  function.  The 1 tells the aggregate function that we want the 1st larges number when the array is sorted from smallest to largest.  If that number was 2 it would be the 2nd largest number and so on.  So the last row or the only row that something is found on is returned.  So in our small example it would be 5.</p>\n\n<p>But wait that 5 was buried inside another function called Index.  and in our small example that INDEX formula would be:</p>\n\n<pre><code>=INDEX($B$3:$B$5,AGGREGATE(...)-2)\n</code></pre>\n\n<p>Well we know that the range is only 3 rows long, so asking for the 5th row, would have excel smacking you up side the head with an error because your index number is out of range.  So in comes the header row correction of -1 in the original formula or -2 for the small example and what we really see for the small example is:</p>\n\n<pre><code>=INDEX($B$3:$B$5,5-2)\n=INDEX($B$3:$B$5,3)\n</code></pre>\n\n<p>and here is a weird bit of info, That last one does not become PLATYPUS...it becomes the cell reference to =B5 which pulls PLATYPUS.  But that little nuance is a story for another time.</p>\n\n<p>Now in the comments Scott essentially told me to invert for the error to get the first row.  And this is important step for the aggregate and it had me running in circles for awhile.  So the full equation for the first row option in our mini example is</p>\n\n<pre><code>=INDEX($B$3:$B$5,AGGREGATE(15,6,1/($B$3:$B$5=C2)*ROW($B$3:$B$5),1)-2)\n</code></pre>\n\n<p>And what Scott Craner was actually suggesting which Skips one math step is:</p>\n\n<pre><code>=INDEX($B$3:$B$5,AGGREGATE(15,6,ROW($B$3:$B$5)/($B$3:$B$5=C2),1)-2)\n</code></pre>\n\n<p>However since I only realized this after writing this all up the explanation will continue with the first of these two equations</p>\n\n<p>So the important thing to note here is the change from function 14 to function 15 which is <a href=\"https://support.office.com/en-us/article/SMALL-function-17da8222-7c82-42b2-961b-14c45384df07\" rel=\"nofollow noreferrer\">SMALL</a>.  Think of it a finding the minimum.  And this time that 6 plays a huge factor along with the 1/.  So our array in the middle this time equates to:</p>\n\n<pre><code>1/FALSE X 3\n1/FALSE X 4\n1/TRUE  X 5\n</code></pre>\n\n<p>Which then becomes:</p>\n\n<pre><code>1/0 X 3\n1/0 X 4\n1/1 X 5\n</code></pre>\n\n<p>Which then has excel slapping you up side the head again because you are trying to divide by 0:</p>\n\n<pre><code>#div/0 X 3\n#div/0 X 4\n   1/1 X 5\n</code></pre>\n\n<p>But you were smart and you protected yourself from that slap upside the head when you told AGGREGATE to ignore error when you used 6 as the second argument/reference!  Therefore what is above becomes:</p>\n\n<pre><code>{5}\n</code></pre>\n\n<p>Since we are performing a <a href=\"https://support.office.com/en-us/article/SMALL-function-17da8222-7c82-42b2-961b-14c45384df07\" rel=\"nofollow noreferrer\">SMALL</a>, and we passed ,1) as the closing part of the AGGREGATE, we have essentially said give me the minimum row number or the 1st smallest number of the resulting array when sorted in ascending order.</p>\n\n<p>The rest plays out the same as it did for the LARGE AGGREGATE method.  The pitfall I fell into originally is I did not use the 1/ to force an error.  As a result, every time I tried getting the SMALL of the array I was getting 0 from all the false results.</p>\n\n<p>SUMPRODUCT works in a very similar fashion, but only works when your result array in the middle only returns 1 non zero answer.  The reason being is the last step of the SUMPRODUCT function is to all the individual elements of the resulting array.  So if you only have 1 non zero, you get that non zero number.  If you had two rows that matched for instance 12 and 31, then the SUMPRODUCT method would return 43 which is not any of the row numbers you wanted, where as aggregate large would have told you 31 and aggregate small would have told you 12.</p>\n"}, {"comments": [{"owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464271649, "post_id": 37424927, "comment_id": 62425265, "body": "I verified that this works, though I have to manually add or remove terms every time a column in doc1 is added or removed. For my specific case, I prefer Future Ed&#39;s solution because it searches a range of columns and doesn&#39;t need a term for each column. However, I&#39;m sure there may be scenarios where only specific columns should be searched, and this solution will come in handy."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1464128896, "creation_date": 1464128896, "answer_id": 37424927, "question_id": 37424431, "link": "https://stackoverflow.com/questions/37424431/how-can-i-lookup-data-from-one-column-when-the-value-im-referencing-changes-co/37424927#37424927", "title": "How can I lookup data from one column, when the value I&#39;m referencing changes columns?", "body": "<p>Something like this maybe, starting in K2 and copied down:</p>\n\n<pre><code>=IFERROR(INDEX(D:D,MAX(IFERROR(MATCH(J2,B:B,0),-1),IFERROR(MATCH(J2,E:E,0),-1),IFERROR(MATCH(J2,G:G,0),-1),IFERROR(MATCH(J2,H:H,0),-1))),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/sKt6a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sKt6a.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to keep the positions of the columns for the Match variable, consider creating generic range names for each column you want to check, like \"Col1\", \"Col2\", \"Col3\". Create a few more range names than you think you will need and reference them to <code>=$B:$B</code>, <code>=$E:$E</code> etc. Plug all range names into Match functions inside the Max() statement as above.</p>\n\n<p>When columns are added or removed from the table, adjust the range name definitions to the columns you want to check. </p>\n\n<p>For example, if you set up the formula with five Matches inside the Max(), and the table changes so you only want to check three columns, point three of the range names to the same column. The Max() will only return one result and one lookup, even if the same column is matched several times. </p>\n"}, {"tags": [], "owner": {"reputation": 511, "user_id": 2611889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5529ac140dc77f25406806aea65c4ca?s=128&d=identicon&r=PG", "display_name": "zack.lore", "link": "https://stackoverflow.com/users/2611889/zack-lore"}, "is_accepted": false, "score": 0, "last_activity_date": 1464129397, "creation_date": 1464129397, "answer_id": 37425028, "question_id": 37424431, "link": "https://stackoverflow.com/questions/37424431/how-can-i-lookup-data-from-one-column-when-the-value-im-referencing-changes-co/37425028#37425028", "title": "How can I lookup data from one column, when the value I&#39;m referencing changes columns?", "body": "<p>I came up with a vba solution if I understood correctly:</p>\n\n<pre><code>Sub DisplayActiveRange()\n    Dim sheetToSearch As Worksheet\n        Set sheetToSearch = Sheet2\n    Dim sheetToOutput As Worksheet\n        Set sheetToOutput = Sheet1\n\n    Dim search As Range\n    Dim output As Range\n    Dim searchCol As String\n        searchCol = \"J\"\n    Dim outputCol As String\n        outputCol = \"K\"\n    Dim valueCol As String\n        valueCol = \"D\"\n    Dim r As Range\n\n    Dim currentRow As Integer\n        currentRow = 1\n    Dim maxRow As Integer\n        maxRow = sheetToOutput.UsedRange.Rows.Count\n\n    For currentRow = 1 To maxRow\n\n        Set search = Range(\"J\" &amp; currentRow)\n\n        For Each r In sheetToSearch.UsedRange\n\n            If r.Value &lt;&gt; \"\" Then\n                If r.Value = search.Value Then\n\n                    Set output = sheetToOutput.Range(outputCol &amp; currentRow)\n                    output.Value = sheetToSearch.Range(valueCol &amp; currentRow).Value\n\n                    currentRow = currentRow + 1\n                    Set search = sheetToOutput.Range(searchCol &amp; currentRow)\n\n                End If\n            End If\n\n        Next\n\n    Next currentRow\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464141971, "post_id": 37425375, "comment_id": 62358331, "body": "Ctrl &amp; G? In windows, that is showing me the &quot;Goto&quot; window. Did you mean Alt &amp; F11, or is that different?"}, {"owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "reply_to_user": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "edited": false, "score": 0, "creation_date": 1464162330, "post_id": 37425375, "comment_id": 62365474, "body": "Sorry! Good spot. I have been working in Access over the last few days, and it&#39;s CTRL + G in Access. You are right, ALT + F11 takes you to the VBA Editor. Hopefully, all the other steps I have detailed will make sense and give you the solution. Davy"}], "tags": [], "owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1464131560, "creation_date": 1464131560, "answer_id": 37425375, "question_id": 37424431, "link": "https://stackoverflow.com/questions/37424431/how-can-i-lookup-data-from-one-column-when-the-value-im-referencing-changes-co/37425375#37425375", "title": "How can I lookup data from one column, when the value I&#39;m referencing changes columns?", "body": "<p>There might be better ways of doing it, but this will give you what you want. We assume headers in both \"source\" and \"destination\" sheets. You will need to adapt the \"Const\" declarations according to how your sheets are named. Press Control &amp; G in Excel to bring up the VBA window and copy and paste this code into \"This Workbook\" under the \"VBA Project\" group, then select \"Run\" from the menu:</p>\n\n<pre><code>        Option Explicit\n\n    Private Const sourceSheet = \"Source\"\n    Private Const destSheet = \"Destination\"\n\n    Public Sub FindColumns()\n\n        Dim rowCount As Long\n        Dim foundValue As String\n\n        Sheets(destSheet).Select\n\n        rowCount = 1 'Assume a header row\n\n        Do While Range(\"J\" &amp; rowCount + 1).value &lt;&gt; \"\"\n\n            rowCount = rowCount + 1\n            foundValue = FncFindText(Range(\"J\" &amp; rowCount).value)\n            Sheets(destSheet).Select\n            Range(\"K\" &amp; rowCount).value = foundValue\n\n        Loop\n\n    End Sub\n\n    Private Function FncFindText(value As String) As String\n\n        Dim rowLoop As Long\n        Dim colLoop As Integer\n        Dim found As Boolean\n        Dim pos As Long\n\n        Sheets(sourceSheet).Select\n        rowLoop = 1\n        colLoop = 0\n\n        Do While Range(alphaCon(colLoop + 1) &amp; rowLoop + 1).value &lt;&gt; \"\" And found = False\n\n            rowLoop = rowLoop + 1\n\n            Do While Range(alphaCon(colLoop + 1) &amp; rowLoop).value &lt;&gt; \"\" And found = False\n\n                colLoop = colLoop + 1\n\n                pos = InStr(Range(alphaCon(colLoop) &amp; rowLoop).value, value)\n\n                If pos &gt; 0 Then\n\n                    FncFindText = Mid(Range(alphaCon(colLoop) &amp; rowLoop).value, pos, Len(value))\n                    found = True\n\n                End If\n\n            Loop\n\n            colLoop = 0\n\n        Loop\n\n    End Function\n\n    Private Function alphaCon(aNumber As Integer) As String\n\n    Dim letterArray As String\n    Dim iterations As Integer\n\n    letterArray = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\n        If aNumber &lt;= 26 Then\n\n            alphaCon = (Mid$(letterArray, aNumber, 1))\n\n        Else\n\n            If aNumber Mod 26 = 0 Then\n\n                iterations = Int(aNumber / 26)\n                alphaCon = (Mid$(letterArray, iterations - 1, 1)) &amp; (Mid$(letterArray, 26, 1))\n\n            Else\n\n                'we deliberately round down using 'Int' as anything with decimal places is not a full iteration.\n                iterations = Int(aNumber / 26)\n                alphaCon = (Mid$(letterArray, iterations, 1)) &amp; (Mid$(letterArray, (aNumber - (26 * iterations)), 1))\n\n            End If\n\n        End If\n\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 892482, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cbe4a87f12b55f0b68cbd5b2a3a5402?s=128&d=identicon&r=PG", "display_name": "Bort", "link": "https://stackoverflow.com/users/892482/bort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 37424904, "answer_count": 4, "score": 0, "last_activity_date": 1464155486, "creation_date": 1464126286, "last_edit_date": 1531164843, "question_id": 37424431, "link": "https://stackoverflow.com/questions/37424431/how-can-i-lookup-data-from-one-column-when-the-value-im-referencing-changes-co", "title": "How can I lookup data from one column, when the value I&#39;m referencing changes columns?", "body": "<p>I want to do an <code>INDEX-MATCH</code>-like lookup between two documents, except my <code>MATCH's index array</code> doesn't stay in one column.<br>\nIn Vague-English: I want a value from a known column that matches another value that may be found in any column.</p>\n\n<p>Refer to the image below. Let's call everything to the left of the bold vertical line on column H doc1, and the right side will be doc2.  </p>\n\n<p>Doc2 has a column \"Find This\", which will be the <code>INDEX's array</code>.  It is compared with \"ID1\" from doc1 (Note that the values in \"Find This\" will <em>not</em> be in the same order as column ID1, but it's easier to undertsand this way).</p>\n\n<p>The \"[Result]\" column in doc2 will be the value from doc1's \"Want This\" column from the row that matches \"FIND THIS\" ...However, sometimes the value from \"FIND THIS\" is not in the \"ID1\" column, and is instead in \"ID2\",\"ID3\", etc.<br>\nSo, I'm trying to generate Col K from Col J. This would be like pressing <code>Ctrl+F</code> and searching for a value in Col J, then taking the value from Col D in that row and copying it to Col K.</p>\n\n<p>I made identical values from a column the same color in the other doc to make it easier to visualize where they are coming from.</p>\n\n<p><a href=\"https://i.stack.imgur.com/upcCz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/upcCz.png\" alt=\"Example documents\"></a></p>\n\n<p>Note also that in column F of doc1, the same value from doc2's \"Find This\" can be found after some other text. \nAlso note that the column headers are only there as examples, the ID columns are not actually numbered.</p>\n\n<p>I would simply hard-code the correct column to search from, but I'm not in control of doc1, and I'm worried that future versions may have new \"ID\" columns, with other's being removed.</p>\n\n<p>I'd prefer this to be a solution in the form of a formula, but VB will do.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464126473, "post_id": 37424417, "comment_id": 62354111, "body": "You can have code that deletes the row of the currently selected cell."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464126591, "post_id": 37424417, "comment_id": 62354155, "body": "If you were to remove the item manually, how would you do it (step by step) ?  That is the process which needs to be automated, but there&#39;s not enough information in your post to suggest what that should look like."}, {"owner": {"reputation": 11, "user_id": 6348507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22977c915c4d8950a9c9743158ebc434?s=128&d=identicon&r=PG&f=1", "display_name": "Ben The Noob", "link": "https://stackoverflow.com/users/6348507/ben-the-noob"}, "edited": false, "score": 0, "creation_date": 1464297334, "post_id": 37424417, "comment_id": 62440898, "body": "Thank you all for looking. I discovered that range names follow the inserted Item no matter what other lines are added to the sheet. This meant that I wrote some code to rename the inserted rows as their own range. After doing this I could write another sub to remove that newly named range when needed. This may be a very long way around, but it has worked for me thus far. Thanks again"}], "owner": {"reputation": 11, "user_id": 6348507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22977c915c4d8950a9c9743158ebc434?s=128&d=identicon&r=PG&f=1", "display_name": "Ben The Noob", "link": "https://stackoverflow.com/users/6348507/ben-the-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1464133622, "creation_date": 1464126216, "last_edit_date": 1464133622, "question_id": 37424417, "link": "https://stackoverflow.com/questions/37424417/excel-macro-to-remove-rows-that-have-been-added-via-another-macro", "title": "Excel macro to remove rows that have been added via another macro", "body": "<p>I have recently added a macro to add a selection from Sheets(\"Activities\") and insert it into a new row positioned at row 25 on Sheets(\"EP2\"). - Thus adding new pre-written \"activities\" into the sheet.</p>\n\n<p>There are a number of different selections (pre-written activities) from Sheets(\"Activities\") that have been assigned their own buttons.</p>\n\n<p>When the button is pressed, the appropriate selection from Sheets(\"Activities\") is inserted into the same position (row 25 on Sheets(\"EP2\"))</p>\n\n<p>This means that each time another activity is added, the last addition moves down the page. This is all fine.</p>\n\n<p>HOWEVER, I am wanting to add coinciding buttons to then remove certain activities (from Sheets(\"EP2\") at a later date. this poses a problem because when a certain activity is added to the sheet it may not have the same cell reference as when it was 1st added via the macro. Is there a way around this?</p>\n\n<p>Basically, this form has to be for people that have almost no understanding of excel whatsoever and needs to have these prewritten activities add-able at a click of a button and then removable at the click of a button. The code I am using is as follows..</p>\n\n<pre><code>Sub Insert_CV()\n\nDim Answer As VbMsgBoxResult\n\nAnswer = MsgBox(\"Are you sure you want to insert a CV agreement\" &amp; vbNewLine &amp; \"This cannot be undone.\", vbOKCancel, \"CV Agreement\")\n\nIf Answer = vbOK Then\n\n    Sheets(\"Activities\").Select\n    Rows(\"1:4\").Select\n    Selection.Copy\n    Sheets(\"EP2\").Select\n    Rows(\"24:24\").Select\n    Range(\"C24\").Activate\n    Selection.Insert Shift:=xlDown\n    Range(\"D20:U20\").Select\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464123168, "post_id": 37423636, "comment_id": 62352515, "body": "<code>i = lastRow(x)</code> are you calling a function here?"}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464123234, "post_id": 37423636, "comment_id": 62352558, "body": "yep another function in the same module, it returns an integer"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464123293, "post_id": 37423636, "comment_id": 62352602, "body": "Might want to post code for that?"}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464123393, "post_id": 37423636, "comment_id": 62352650, "body": "sure it is simply lastRow = x.Cells(1, 1).End(xlDown).Row"}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464123426, "post_id": 37423636, "comment_id": 62352668, "body": "I have also tried it with just replacing lastrow(x) with a random number, still crashes"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1464123622, "post_id": 37423636, "comment_id": 62352774, "body": "Can you edit the Question and provide the code for lastCol and lastRow functions?"}, {"owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 2, "creation_date": 1464123706, "post_id": 37423636, "comment_id": 62352825, "body": "What do you mean by &quot;it crashes&quot;? Does Excel simply quit stating it&#39;s not working any more? Or does your code just raise a run time error with an error message stating what the problem might be? In this case we would need to know the error message."}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "edited": false, "score": 1, "creation_date": 1464123780, "post_id": 37423636, "comment_id": 62352868, "body": "@ dave I got rid of the lastcol and last row and replaced it with integers, it still does not work, just to make it simpler"}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "reply_to_user": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "edited": false, "score": 0, "creation_date": 1464123935, "post_id": 37423636, "comment_id": 62352949, "body": "@leviathan Excel stops responding and I am forced to close it or wait for it to respond (which does not work. Once I press close program, excel briefly returns to normal then displays the error message &quot;run-time error &#39;-2147417848 (80010108)&#39;: method&#39;_default&#39; of object &#39;range&#39; failed&quot;"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464123998, "post_id": 37423636, "comment_id": 62352986, "body": "I am thinking it dies before the for loop... you&#39;re calling a lot of subs/functions. Comment them out one by one?"}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "edited": false, "score": 0, "creation_date": 1464124552, "post_id": 37423636, "comment_id": 62353256, "body": "I have used the debug to step into the module until it reaches the specified sub, it performs fine until it reaches the first for loop upon which excel stops responding immediately."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464124759, "post_id": 37423636, "comment_id": 62353344, "body": "What&#39;s your goal with &quot;x.Columns(n) = 1&quot;? I&#39;m not testing it but if it worked did you want to have all that column cells value set to 1?"}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "edited": false, "score": 0, "creation_date": 1464124930, "post_id": 37423636, "comment_id": 62353440, "body": "yes that is what it does"}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1464124963, "post_id": 37423636, "comment_id": 62353453, "body": "Could you check the Event Viewer to see if there are any application error associated with the crash of Excel?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1464124974, "post_id": 37423636, "comment_id": 62353460, "body": "You realize that&#39;s dropping a 1 into a million rows?"}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "edited": false, "score": 0, "creation_date": 1464125279, "post_id": 37423636, "comment_id": 62353588, "body": "I can write better code for that later, the code still crashes if I comment out that line."}, {"owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "reply_to_user": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1464125725, "post_id": 37423636, "comment_id": 62353782, "body": "@Karlomanio I can&#39;t appear to find and event logs associated with the crash of excel"}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1464127610, "post_id": 37423636, "comment_id": 62354559, "body": "@Walter, there must be a log somewhere that gives an error when it crashes.  Did you look in eventvwr.msc and search the Office log or an application log referring to the error?  Also, maybe Microsoft will have a log somewhere for Excel.  Keep looking for an error.  The only thing I can think of is somehow you are exiting the worksheet when you are executing the code.  If you can&#39;t find a log, can you step through the loop and see what it is doing in your worksheet before it crashes?  That would help too!"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1464130447, "post_id": 37423636, "comment_id": 62355547, "body": "@Walter - what is the simplest you can make the sub and it still crash? Have you tried re-typing the offending line (hidden character)?"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464126542, "post_id": 37424315, "comment_id": 62354134, "body": "This would make sense but OP is using 50 for <code>i</code> and is still &quot;crashing&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1464126684, "post_id": 37424315, "comment_id": 62354202, "body": "@findwindow Excel will always say &quot;(not responding)&quot; <i>whenever</i> there&#39;s VBA code running a loop and a user that starts clicking everywhere. Everything is running on a single thread."}, {"owner": {"reputation": 1803, "user_id": 5030129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d0f7c1816e64369016c23c3c04344f07?s=128&d=identicon&r=PG&f=1", "display_name": "Claudius", "link": "https://stackoverflow.com/users/5030129/claudius"}, "edited": false, "score": 0, "creation_date": 1464126689, "post_id": 37424315, "comment_id": 62354206, "body": "OP may have really slow pc"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1464125742, "last_edit_date": 1592644375, "creation_date": 1464125742, "answer_id": 37424315, "question_id": 37423636, "link": "https://stackoverflow.com/questions/37423636/vba-nested-for-loop-crashes/37424315#37424315", "title": "VBA nested for loop crashes", "body": "<h2>Based on the comment-conversation <a href=\"https://stackoverflow.com/questions/37423636/vba-nested-for-loop-crashes#comment62352825_37423636\">here</a>, <strong>your code isn't &quot;crashing&quot;</strong>.</h2>\n<p>It's <strong>working very hard</strong> and accessing cell values in a tight loop, which is <strong>the</strong> single slowest thing VBA code can do, and you're doing it for a large number of cells.</p>\n<p>Wait it out. Excel &quot;isn't responding&quot; because it's busy running your loop and keeping up with all the updates going on.</p>\n<p>Here's something that <em>may</em> help it complete faster:</p>\n<pre><code>Application.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\n' your code here\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n</code></pre>\n<p>If that doesn't complete in a more reasonable amount of time, then you need to look into an array-based approach, where you dump the interesting range into an in-memory array, work against the array, modify the array values, and then dump the array onto the worksheet <em>in a single write</em>.</p>\n"}], "owner": {"reputation": 9, "user_id": 6378184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc097e2c3df245e190872f473d89684?s=128&d=identicon&r=PG&f=1", "display_name": "Walter", "link": "https://stackoverflow.com/users/6378184/walter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464127334, "creation_date": 1464123038, "last_edit_date": 1464127334, "question_id": 37423636, "link": "https://stackoverflow.com/questions/37423636/vba-nested-for-loop-crashes", "title": "VBA nested for loop crashes", "body": "<p>I have this function in VBA, everything works except when it reaches the <code>For</code> loop it just crashes and I have to close Excel and everything, not really sure how to fix it.</p>\n\n<pre><code>Private Sub checkDuplicates(x As Worksheet)\n    Dim n As Integer, i As Long, j As Long\n\n    Sort x\n    addheader x, \"checkDup.\"\n    n = searchHeader(x, \"checkDup.\")\n    x.Columns(n) = 1\n    For i = 50 To 3 Step -1\n        For j = 1 To 5\n            If Not x.Cells(i, j) = x.Cells(i - 1, j).Value Then\n                x.Cells(i, n) = 0\n                Exit For\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464125934, "post_id": 37423544, "comment_id": 62353880, "body": "Do you need to use a template?  Can you instead use a regular .xlsm file (marked as &quot;read only&quot; if you&#39;re worried about someone overwriting it) ?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464135058, "post_id": 37423544, "comment_id": 62356829, "body": "You know, @TimWilliams, that&#39;s a possibility... There is a lot of formatting that was getting lost with my original process, and that led me to using the .XLTM. I may be able to use a .XLSM instead and get the same results. I&#39;ll have to look into that. Even if that ends up being suitable for my purposes, I&#39;d be interested in knowing if there is a way to do what I&#39;m asking in this question."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1464266050, "post_id": 37423544, "comment_id": 62420930, "body": "@TimWilliams - thank you for your suggestion. Converting from the .XLTM to .XLSM format does (after resetting all the links one time to point to the new template file) allow me to open the Excel file once for much quicker re-linking. I would invite you to post that as an answer, and I&#39;ll give you an upvote. However, I&#39;d still love to find out if it&#39;s possible to do what the title question asks."}], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 894, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464181488, "creation_date": 1464122755, "last_edit_date": 1464181488, "question_id": 37423544, "link": "https://stackoverflow.com/questions/37423544/how-do-i-open-an-excel-xltm-file-via-vba-as-a-template", "title": "How do I open an Excel .xltm file via VBA as a template?", "body": "<p>I have some code written in VBA to automate creation of PowerPoints. (Yes, I understand there's a special place in hell for this. Sometimes, however, one must do what is required whether it makes sense or not.)</p>\n\n<p>The process is as follows:</p>\n\n<ol>\n<li>Open an Excel template file <code>MyTemplate.XLTM</code> creating <code>MyTemplate1.XLTM</code>. </li>\n<li>Update data in <code>MyTemplate1.XLTM</code> as appropriate</li>\n<li>Save <code>MyTemplate1.XLTM</code> as <code>NewFile.XLSM</code></li>\n<li>Open a PowerPoint template file <code>MyPowerPoint.PPTM</code></li>\n<li>Loop through all the objects/shapes on all the slides in <code>MyPowerPoint.PPTM</code> looking for linked shapes\n\n<ol>\n<li>For each linked shape, change <code>Shape.LinkFormat.SourceFullName</code> from <code>MyTemplate.XLTM</code> to <code>NewFile.XLSM</code> (with appropriate gymnastics to link it to the proper location within <code>NewFile.XLSM</code>)</li>\n</ol></li>\n<li>Save <code>MyPowerPoint.PPTM</code> as <code>NewPPT.pptx</code></li>\n</ol>\n\n<p>As the code executes step 5.1, it opens <code>MyTemplate.XLTM</code>, adjusts the link location, then closes the file. For <em>every. single. linked. object.</em> in the entire PowerPoint presentation. This, obviously, is rather slow. My template file is only 621KB, but loading it from the network takes enough time that I can see the thermometer bar filling in the Excel status bar as it loads. (Yes, I can run with <code>.ScreenUpdating=False</code>, and I do, but it still takes time.)</p>\n\n<p>Once I've created the PowerPoint, I can open <code>NewFile.xlsm</code>, then open <code>NewPPT.pptx</code> and refresh all the links <em>very</em> quickly. If I don't open <code>NewFile.xlsm</code> first, the refresh all links takes <em>significantly</em> longer.</p>\n\n<p>Therefore, I'd like to open <code>MyTemplate.XLTM</code> in code <em>once</em> prior to step 5.1 so that it doesn't need to load <em>every time</em>. However, when I execute</p>\n\n<pre><code>Dim TemplateXL as Excel.Workbook\nSet TemplateXL = XLObj.Workbooks.Open(\"MyTemplate.xltm\")\n</code></pre>\n\n<p>I get a file called <code>MyTemplate1.xltm</code>, and PowerPoint still has to open <code>MyTemplate.xltm</code> each time I have to refresh a linked object.</p>\n\n<p>In Windows Explorer, I can right-click <code>MyTemplate.xltm</code> then select <code>open</code> and I am editing the actual template itself, instead of creating a new document based on that template.</p>\n\n<p>How do I emulate the <code>Right-Click | Open</code> functionality within Excel VBA code?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464125192, "post_id": 37423526, "comment_id": 62353546, "body": "You have a syntax error in two places. First change {like &#39; * &#39; * &#39;;&quot;}  to {like &#39;*&#39;;&quot;}   Then replace the {&#39;&#39;&#39;} with {&quot;&#39;&quot;}    [Had to edit because translated your string so not as you had shown]"}, {"owner": {"reputation": 61, "user_id": 6084118, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/kGHy0.png?s=128&g=1", "display_name": "p0tato", "link": "https://stackoverflow.com/users/6084118/p0tato"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464183460, "post_id": 37423526, "comment_id": 62380276, "body": "@WayneG.Dunn I tried replacing {&#39;&#39;&#39;} with {&quot;&#39;&quot;} but VBA treats that first quote as the ending of the statement and treats the apostrophe as the beginning of a comment"}, {"owner": {"reputation": 61, "user_id": 6084118, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/kGHy0.png?s=128&g=1", "display_name": "p0tato", "link": "https://stackoverflow.com/users/6084118/p0tato"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464183812, "post_id": 37423526, "comment_id": 62380545, "body": "@WayneG.Dunn Regarding {like &#39;*&#39;;&quot;} - I have it the way that I do because I want to make sure the field contains an apostrophe. Now that I think of it, I don&#39;t even need that WHERE clause"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1464187729, "post_id": 37423526, "comment_id": 62383809, "body": "Yes, the embedded quotes can be a nuisance... here is the correct syntax:  &quot;UPDATE &quot; &amp; strLimitRecordTable &amp; &quot; SET vCompanyMapped = Replace(vCompanyMapped, &quot;&quot;&#39;&quot;&quot;, &quot;&quot;&quot;&quot;) WHERE ((vCompanyMapped Like &quot;&quot;<i>&#39;</i>&quot;&quot;));&quot;   But, yes, I would get rid of the WHERE clause..."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6084118, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/kGHy0.png?s=128&g=1", "display_name": "p0tato", "link": "https://stackoverflow.com/users/6084118/p0tato"}, "edited": false, "score": 0, "creation_date": 1464183950, "post_id": 37424241, "comment_id": 62380662, "body": "Thank you, this was useful! I just had to add a parameter in your replace(): <code>replace(vCompanyMapped,Chr(39), &#39;&#39;)</code> As I noted above, I didn&#39;t even need that WHERE clause that was causing the syntax error."}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "reply_to_user": {"reputation": 61, "user_id": 6084118, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/kGHy0.png?s=128&g=1", "display_name": "p0tato", "link": "https://stackoverflow.com/users/6084118/p0tato"}, "edited": false, "score": 0, "creation_date": 1464186321, "post_id": 37424241, "comment_id": 62382621, "body": "If you can recommend my answer with changes, then I get extra points :)."}], "tags": [], "owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "is_accepted": true, "score": 2, "last_activity_date": 1464186335, "last_edit_date": 1464186335, "creation_date": 1464125414, "answer_id": 37424241, "question_id": 37423526, "link": "https://stackoverflow.com/questions/37423526/replace-apostrophe-with-null-in-vba-access/37424241#37424241", "title": "replace apostrophe with null in VBA Access", "body": "<p>I would use the ascii character for finding an apostrophe in this case I would recommend you try: </p>\n\n<pre><code>Dim strLimitRecordTable As String: strLimitRecordTable = \nMe.txtLimitRecordTable DoCmd.RunSQL \"UPDATE \" &amp; strLimitRecordTable &amp; \" SET \nvCompanyMapped = replace(vCompanyMapped, chr(39),'') \nWHERE vCompanyMapped like '*'*';\"\n</code></pre>\n\n<p>Often when I programmatically have to search for punctuation I find that it helps to use Ascii indicators.  It helps cause fewer errors.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1464168473, "creation_date": 1464168473, "answer_id": 37432951, "question_id": 37423526, "link": "https://stackoverflow.com/questions/37423526/replace-apostrophe-with-null-in-vba-access/37432951#37432951", "title": "replace apostrophe with null in VBA Access", "body": "<p>You can use this function to avoid this and most other troubles when concatenating SQL:</p>\n\n<pre><code>' Converts a value of any type to its string representation.\n' The function can be concatenated into an SQL expression as is\n' without any delimiters or leading/trailing white-space.\n'\n' Examples:\n'   SQL = \"Select * From TableTest Where [Amount]&gt;\" &amp; CSql(12.5) &amp; \"And [DueDate]&lt;\" &amp; CSql(Date) &amp; \"\"\n'   SQL -&gt; Select * From TableTest Where [Amount]&gt; 12.5 And [DueDate]&lt; #2016/01/30 00:00:00#\n'\n'   SQL = \"Insert Into TableTest ( [Street] ) Values (\" &amp; CSql(\" \") &amp; \")\"\n'   SQL -&gt; Insert Into TableTest ( [Street] ) Values ( Null )\n'\n' Trims text variables for leading/trailing Space and secures single quotes.\n' Replaces zero length strings with Null.\n' Formats date/time variables as safe string expressions.\n' Uses Str to format decimal values to string expressions.\n' Returns Null for values that cannot be expressed with a string expression.\n'\n' 2016-01-30. Gustav Brock, Cactus Data ApS, CPH.\n'\nPublic Function CSql( _\n    ByVal Value As Variant) _\n    As String\n\n    Const vbLongLong    As Integer = 20\n    Const SqlNull       As String = \" Null\"\n\n    Dim Sql             As String\n    Dim LongLong        As Integer\n\n    #If Win32 Then\n        LongLong = vbLongLong\n    #End If\n    #If Win64 Then\n        LongLong = VBA.vbLongLong\n    #End If\n\n    Select Case VarType(Value)\n        Case vbEmpty            '    0  Empty (uninitialized).\n            Sql = SqlNull\n        Case vbNull             '    1  Null (no valid data).\n            Sql = SqlNull\n        Case vbInteger          '    2  Integer.\n            Sql = Str(Value)\n        Case vbLong             '    3  Long integer.\n            Sql = Str(Value)\n        Case vbSingle           '    4  Single-precision floating-point number.\n            Sql = Str(Value)\n        Case vbDouble           '    5  Double-precision floating-point number.\n            Sql = Str(Value)\n        Case vbCurrency         '    6  Currency.\n            Sql = Str(Value)\n        Case vbDate             '    7  Date.\n            Sql = Format(Value, \" \\#yyyy\\/mm\\/dd hh\\:nn\\:ss\\#\")\n        Case vbString           '    8  String.\n            Sql = Replace(Trim(Value), \"'\", \"''\")\n            If Sql = \"\" Then\n                Sql = SqlNull\n            Else\n                Sql = \" '\" &amp; Sql &amp; \"'\"\n            End If\n        Case vbObject           '    9  Object.\n            Sql = SqlNull\n        Case vbError            '   10  Error.\n            Sql = SqlNull\n        Case vbBoolean          '   11  Boolean.\n            Sql = Str(Abs(Value))\n        Case vbVariant          '   12  Variant (used only with arrays of variants).\n            Sql = SqlNull\n        Case vbDataObject       '   13  A data access object.\n            Sql = SqlNull\n        Case vbDecimal          '   14  Decimal.\n            Sql = Str(Value)\n        Case vbByte             '   17  Byte.\n            Sql = Str(Value)\n        Case LongLong           '   20  LongLong integer (Valid on 64-bit platforms only).\n            Sql = Str(Value)\n        Case vbUserDefinedType  '   36  Variants that contain user-defined types.\n            Sql = SqlNull\n        Case vbArray            ' 8192  Array.\n            Sql = SqlNull\n        Case Else               '       Should not happen.\n            Sql = SqlNull\n    End Select\n\n    CSql = Sql &amp; \" \"\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6084118, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/kGHy0.png?s=128&g=1", "display_name": "p0tato", "link": "https://stackoverflow.com/users/6084118/p0tato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 0, "accepted_answer_id": 37424241, "answer_count": 2, "score": 0, "last_activity_date": 1464186335, "creation_date": 1464122711, "last_edit_date": 1464126362, "question_id": 37423526, "link": "https://stackoverflow.com/questions/37423526/replace-apostrophe-with-null-in-vba-access", "title": "replace apostrophe with null in VBA Access", "body": "<p>I'm trying to update a field in an Access table that replaces apostrophes with null. </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim strLimitRecordTable As String: strLimitRecordTable = Me.txtLimitRecordTable\nDoCmd.RunSQL \"UPDATE \" &amp; strLimitRecordTable &amp; \" SET vCompanyMapped = replace(vCompanyMapped, ''', '') WHERE vCompanyMapped like '*'*';\"\n</code></pre>\n\n<p>But I get this error: </p>\n\n<blockquote>\n  <p>Syntax error in expression replace(vCompanyMapped, ''', '') WHERE\n  vCompanyMapped like '<em>'</em>';\"</p>\n</blockquote>\n\n<p>I have a feeling it has to do with replacing ''' with and empty string ''</p>\n\n<p>What am I doing wrong here?</p>\n\n<p>I have another query that works fine:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.RunSQL \"UPDATE [\" &amp; strLimitRecordTable &amp; \"] SET Domain = Mid([Email],InStr([Email],'@')+1,Len([Email])-InStr([Email],'@')) WHERE Email Like '*@*.*';\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464122450, "post_id": 37423430, "comment_id": 62352136, "body": "<code>Set RNG = .Range(&quot;A1&quot;</code> you know how to set a <code>range</code>..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464122566, "post_id": 37423430, "comment_id": 62352202, "body": "do you really want to name the ranges, or is a way to use that range to put it in the variable?  Because you can skip the whole and <code>Set PersonResponsible = .Cells.Find(What:=&quot;Person Responsible&quot;)</code>"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464122629, "post_id": 37423430, "comment_id": 62352226, "body": "@ScottCraner That is exactly what I was trying to do! Thank you"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464122685, "post_id": 37423430, "comment_id": 62352255, "body": "also change this<code>Open_Jobs_Report.Range(PersonResponsible).Value</code> to this <code>PersonResponsible.Value</code>  The worksheet is already part of the range object."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464122790, "post_id": 37423430, "comment_id": 62352308, "body": "@ScottCraner How do I modify your suggestion to select the whole column where it finds the &quot;Person Responsible&quot;?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464122976, "post_id": 37423430, "comment_id": 62352408, "body": "You want PersonResponsible to be the full column of data?  I assume that &quot;Person Responsible&quot; is in the first row?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464123238, "post_id": 37423430, "comment_id": 62352561, "body": "<code>clm = .Range(&quot;1:1&quot;).Find(What:=&quot;Person Responsible&quot;).Column</code> and <code>Set PersonResponsible = .Range(.Cells(1, clm), .Cells(1, clm).End(xlDown))</code>"}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464123878, "post_id": 37423430, "comment_id": 62352913, "body": "@ScottCraner Yes. I need to use the code to find the column heading &quot; Person Responsible&quot; and then copy all of the data under that heading over to a new sheet. I tried what you suggested but it threw a Object variable or with block not set. I Dimmed CLM as Range and it is included in the With Sheets(&quot;...  statement."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1464124062, "post_id": 37423430, "comment_id": 62353017, "body": "clm is a long not a range.  and the two line are in place of the three as is."}, {"owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1464124274, "post_id": 37423430, "comment_id": 62353123, "body": "@ScottCraner It was that I had dimmed as range instead of long. Thanks for the help. It works perfectly now. If you post as an answer I will gladly accept and upvote."}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464122359, "creation_date": 1464122359, "question_id": 37423430, "link": "https://stackoverflow.com/questions/37423430/removing-activate-from-code", "title": "Removing .activate from code", "body": "<p>I am trying to name a range and set it equal to a variable and I think there is a better way to do that that would omit the .activate because it breaks if the user is on a different sheet. Any thoughts on how to fix it?</p>\n\n<pre><code>Sub Auto_Filter()\n\nDim RNG As Range\nDim Open_Jobs_Report As Worksheet\nSet Open_Jobs_Report = ThisWorkbook.Sheets(\"Open Jobs Report\")\nDim Calculations As Worksheet\nSet Calculations = ThisWorkbook.Sheets(\"Calculations\")\nDim PersonResponsible As Range\nDim Violations As Range\n\n\n    With Sheets(\"Open Jobs Report\")\n        Set RNG = .Range(\"A1\", .Cells(.Cells(.Rows.Count, \"A\").End(xlUp).Row, .Cells(1, .Columns.Count).End(xlToLeft).Column))\n        RNG.AutoFilter Field:=19, Criteria1:=\"&lt;&gt;\"\n\n        Cells.Find(What:=\"Person Responsible\").Activate ' &lt;= Here\n            Range(Selection, Selection.End(xlDown)).Name = \"Range1\"\n                Set PersonResponsible = Range(\"Range1\")\n        Cells.Find(What:=\"Violations\").Activate ' &lt;= And here\n            Range(Selection, Selection.End(xlDown)).Name = \"Range2\"\n                Set Violations = Range(\"Range2\")\n\n    End With\n\n\n    Open_Jobs_Report.Range(PersonResponsible).Value = Calculations.Range(\"A1:A3\").Value\n\n\n\n\n\n    ActiveSheet.ListObjects(1).AutoFilter.ShowAllData\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464123242, "post_id": 37423426, "comment_id": 62352563, "body": "rangeToFormat is startCell, its passed as parameter to the function...I&#39;ll edit the post..As an aside, I noted that the range naming was working correctly in the original post, it was the name retrieving that was not."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1464124619, "post_id": 37423426, "comment_id": 62353291, "body": "Apparently, there&#39;s a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff823060.aspx\" rel=\"nofollow noreferrer\">difference</a> between workbook and worksheet names. Edit: also <a href=\"http://stackoverflow.com/questions/3630496/how-do-you-get-a-range-to-return-its-name\">this</a>?"}, {"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464132883, "post_id": 37423426, "comment_id": 62356241, "body": "@ findwindow post that as the answer and Ill accept...it is Name.Name to retrieve the name and just Range.Name =.... to set it"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464187603, "post_id": 37423426, "comment_id": 62383712, "body": "Thanks but you can just upvote the answer in my link^_^"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1464814047, "post_id": 37423952, "comment_id": 62643828, "body": "@dinotom: did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1464124223, "creation_date": 1464124223, "answer_id": 37423952, "question_id": 37423426, "link": "https://stackoverflow.com/questions/37423426/vba-named-range-retrieves-as-sheetname-and-cell-address/37423952#37423952", "title": "VBA named range retrieves as sheetname and cell address", "body": "<p>Can't test it so I'm just trying to recall it. try using</p>\n\n<pre><code>Name(startCell)\n</code></pre>\n\n<p>To obtain the name attached to the Range reference </p>\n"}, {"comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "edited": false, "score": 0, "creation_date": 1464610036, "post_id": 37441793, "comment_id": 62542055, "body": "@dinotom comments don&#39;t last forever, and I didn&#39;t read them. Whatever, I&#39;ll make this a wiki, I&#39;m not trying to steal someone&#39;s rep or anything."}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": false, "score": 0, "last_activity_date": 1464190596, "creation_date": 1464190596, "answer_id": 37441793, "question_id": 37423426, "link": "https://stackoverflow.com/questions/37423426/vba-named-range-retrieves-as-sheetname-and-cell-address/37441793#37441793", "title": "VBA named range retrieves as sheetname and cell address", "body": "<p>I think you need to address the name object</p>\n\n<pre><code>rng.Name.Name\n</code></pre>\n"}], "owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 768, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1464190596, "creation_date": 1464122345, "last_edit_date": 1531164843, "question_id": 37423426, "link": "https://stackoverflow.com/questions/37423426/vba-named-range-retrieves-as-sheetname-and-cell-address", "title": "VBA named range retrieves as sheetname and cell address", "body": "<p>I have a routine that adds new customer ranges to an estimate and actual sheet along with validation, formulas and protection. I add named ranges to certain cells as they are used throughout the sheets in formulas.</p>\n\n<p>The code part that names the ranges is as follows (it works, the ranges are named correctly as seen in name manager)</p>\n\n<p>The function that does the name ranging is declared as so</p>\n\n<pre><code>Function InitializeAddedRange(rangeToFormat As Range, _\n    custName As String, currentSheet As Worksheet)\n</code></pre>\n\n<p>and is called as follows</p>\n\n<pre><code> Call InitializeAddedRange(startCell, customerName, sourceWorksheet)\n</code></pre>\n\n<p>so in the snippet below rangeToFormat is startCell</p>\n\n<pre><code>Set rangeToFormat = rangeToFormat.Offset(0, 1)\nIf currentSheet.Name = \"Actual Quarterly Sales\" Then\n    rangeToFormat.Name = Replace(custName, \" \", \"\") &amp; \"ActualBasePrice\"\n    rangeToFormat.Offset(0, 1).Name = Replace(custName, \" \", \"\") &amp; \"ActualIsCurrent\"\nElseIf currentSheet.Name = \"Quarterly Sales Projections\" Then\n    rangeToFormat.Name = Replace(custName, \" \", \"\") &amp; \"BasePrice\"\n    rangeToFormat.Offset(0, 1).Name = Replace(custName, \" \", \"\") &amp; \"IsCurrent\"\nEnd If\n</code></pre>\n\n<p>In a function that is called in the same subroutine but AFTER the code above,\nI am trying to retrieve the name of the range as its required in numerous formulas. (startCell.Name)</p>\n\n<pre><code>Set tempRange = Range(startCell.Offset(1, 3), startCell.Offset(1, 14))\nFor Each cCell In tempRange\n    With cCell\n        .Value = 0\n        .NumberFormat = \"$#,##0\"\n        .FormulaR1C1 = \"=DrumGallons*\" &amp; startCell.Name &amp; \"*R[-1]C\"\n        .Locked = True\n    End With\nNext cCell\n</code></pre>\n\n<p>The problem is <code>startCell.Name</code> returns the sheetname and cell address i.e. <strong>SalesEstimates$B$12</strong> instead of the named range which should be <strong>customernameBasePrice</strong>. I've done a lot of VBA work and I can't recall ever coming across this problem. Does this occur because the subroutine hasn't finished and the named range actually hasn't changed within excel yet before the function is trying to access it? I don't think that can be it but I've tried numerous things none of which work.</p>\n"}, {"tags": ["vba", "hyperlink", "range", "selection", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1464128522, "post_id": 37422899, "comment_id": 62354863, "body": "I recommend you look at the Cross-Reference functionality, because that is, essentially, what you&#39;re looking for - no need to re-invent the wheel."}], "answers": [{"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1464123687, "creation_date": 1464123687, "answer_id": 37423814, "question_id": 37422899, "link": "https://stackoverflow.com/questions/37422899/systematically-hyperlinking-text-in-word-vba/37423814#37423814", "title": "Systematically Hyperlinking text in Word VBA", "body": "<p>We can't just go ahead and write it for you, that is not the nature of the site, however, I don't want to tell you to go off and come back with some more effort and we'll support that.</p>\n\n<p>I want to provide some pointers for you to get you going. Once you have got so far but are getting stuck on specific issues (e.g. 'why do I get error X' or 'why is my loop not capturing everything'), that's the time this site will shine for you and give great support!</p>\n\n<p>So where to start? I'm going to assume non VBA experience and the below a crash course.</p>\n\n<p>First we need a procedure that we can run. In Word press Alt+F11, this opens the VBE (VBA-Editor) </p>\n\n<p>From the project window on the top left side (usually) double click on 'ThisDocument' and the main window will become a space for us to write code. The first first thing to write at the very top is <code>Option Explicit</code>, this is telling the VBA runtime that all variables must be declared, which is good practice.</p>\n\n<p>Next below that enter: -</p>\n\n<pre><code>Public Sub CreateLinks()\n\nEnd Sub\n</code></pre>\n\n<p>You have now created a procedure called <code>CreateLinks</code>, while your insertion point (vertical blinking line) is between these two lines of code you can push F8 to step through code line by line, or F5 to run it all in one go.</p>\n\n<p>That's the start of everything. Now what you need to do is.</p>\n\n<ol>\n<li>Connect to the document</li>\n<li>Find the text to link to</li>\n<li>Find the text to link from</li>\n<li>Create link</li>\n<li>Repeat steps 2 - 5 until all links are done.</li>\n</ol>\n\n<p>That should bring you to your answer.</p>\n\n<p>As further pointers/hints to help you: -</p>\n\n<p>The <code>Application</code> holds a collection of documents, you could look through them or open your document to connect to it</p>\n\n<p>a <code>Document</code> has a collection of bookmarks and hyperlinks, you can loop through these while getting to your goal</p>\n\n<p><code>Selection</code> is that active selected text</p>\n\n<p>I hope this is of help.</p>\n"}], "owner": {"reputation": 273, "user_id": 6143171, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/db29d0be3010bc85bccfacf8db7d3951?s=128&d=identicon&r=PG&f=1", "display_name": "IRNotSmart", "link": "https://stackoverflow.com/users/6143171/irnotsmart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1464123687, "creation_date": 1464120372, "question_id": 37422899, "link": "https://stackoverflow.com/questions/37422899/systematically-hyperlinking-text-in-word-vba", "title": "Systematically Hyperlinking text in Word VBA", "body": "<p>I work for a company that does custom reports in Microsoft Word very frequently.  I would like to write a VBA Macro that systematically goes through the following list and Hyperlinks ONLY the text (not paragraph symbols or tab arrows or list number) and links to a bookmark in the current document.  </p>\n\n<pre><code>1 \u2192 Description of Figure 1 \u00b6\n\u00b6\n2 \u2192 Description of Figure 2 \u00b6\n\u00b6\n3 \u2192 Description of Figure 3 \u00b6\n\u00b6\n4 \u2192 Description of Figure 5 \u00b6\n\u00b6\n</code></pre>\n\n<p>After the macro is complete, clicking on <code>\"Description of Figure 1\"</code> will go to bookmark <code>Figure_01</code> which exists later in the same document.  I appreciate any help that anyone can give!</p>\n"}, {"tags": ["excel", "vba", "msgbox"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1464120948, "post_id": 37422748, "comment_id": 62351296, "body": "So if the person was born <i>January 5 1948</i> you want the next message issued on <i>December 26 2016</i> ??"}, {"owner": {"reputation": 27, "user_id": 3320497, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e353c7b0709a59a68f29b012256b89cc?s=128&d=identicon&r=PG&f=1", "display_name": "Behedwin", "link": "https://stackoverflow.com/users/3320497/behedwin"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1464121128, "post_id": 37422748, "comment_id": 62351382, "body": "exactly, 10 days before the person will have a birthday. like a warning 10 days ahead for the user of the excel document. it needs to be written in vba"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1464121243, "post_id": 37422748, "comment_id": 62351445, "body": "Yes, it can be done. You can use Outlook or a nice calendar program to do that for you. Or you can write a macro that checks the dates, and warns you if one is less than 10 days away. The drawback is that you will have to open this Excel file every day for the macro to run. Or you can use <code>Application.OnTime</code>, and never turn off your computer and never close Excel."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 3, "creation_date": 1464121313, "post_id": 37422748, "comment_id": 62351492, "body": "&quot;it needs to be written in vba&quot; - why??? Wait, you don&#39;t expect <i>us</i> to do <i>your</i> homework/job for you for free, do you?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464121484, "post_id": 37422748, "comment_id": 62351579, "body": "How many names do you have? I mean, what happens if you need a warning for 1000 people? How do you want that handled? 1000 msgboxes? 1 long one with 1000 names?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3320497, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e353c7b0709a59a68f29b012256b89cc?s=128&d=identicon&r=PG&f=1", "display_name": "Behedwin", "link": "https://stackoverflow.com/users/3320497/behedwin"}, "edited": false, "score": 0, "creation_date": 1464123162, "post_id": 37423622, "comment_id": 62352513, "body": "after quick reading your post. am i right that you first calculated how many days until next birth day. Then in the VBA script telling a message to popup if the value is 10 or less?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 27, "user_id": 3320497, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e353c7b0709a59a68f29b012256b89cc?s=128&d=identicon&r=PG&f=1", "display_name": "Behedwin", "link": "https://stackoverflow.com/users/3320497/behedwin"}, "edited": false, "score": 0, "creation_date": 1464123462, "post_id": 37423622, "comment_id": 62352681, "body": "You are correct!................I use something similar, but I hi-light the names using Conditional Formatting rather than macros."}, {"owner": {"reputation": 27, "user_id": 3320497, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e353c7b0709a59a68f29b012256b89cc?s=128&d=identicon&r=PG&f=1", "display_name": "Behedwin", "link": "https://stackoverflow.com/users/3320497/behedwin"}, "edited": false, "score": 0, "creation_date": 1464123715, "post_id": 37423622, "comment_id": 62352833, "body": "cant figure out if this way is better than my way (below). is there any disadvantages than doing what i did in the code?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 27, "user_id": 3320497, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e353c7b0709a59a68f29b012256b89cc?s=128&d=identicon&r=PG&f=1", "display_name": "Behedwin", "link": "https://stackoverflow.com/users/3320497/behedwin"}, "edited": false, "score": 0, "creation_date": 1464124003, "post_id": 37423622, "comment_id": 62352989, "body": "@Behedwin If you are happy with your own code, then use it................I like my approach because I can see all the people and how close the birthdays are."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1464123010, "creation_date": 1464123010, "answer_id": 37423622, "question_id": 37422748, "link": "https://stackoverflow.com/questions/37422748/vba-msgbox-10-days-before-a-birthday/37423622#37423622", "title": "VBA - msgbox 10 days before a birthday", "body": "<p>In <strong>E1</strong> enter:</p>\n\n<pre><code>=DATE(YEAR(D1)+DATEDIF(D1,TODAY(),\"y\")+1,MONTH(D1),DAY(D1))\n</code></pre>\n\n<p>and copy down.  Then in <strong>F1</strong> enter:</p>\n\n<pre><code>=E1-TODAY()\n</code></pre>\n\n<p>and copy down.</p>\n\n<p>Column <strong>E</strong> are the upcoming birthdays and column <strong>F</strong> are the days until the next birthday.</p>\n\n<p>Finally in the worksheet code area, enter the following event macro:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Dim cel As Range, F As Range\n\n    Set F = Intersect(ActiveSheet.UsedRange, Range(\"F:F\"))\n    For Each cel In F\n        If cel.Value &lt; 11 Then\n            MsgBox cel.Offset(0, -4).Value &amp; \" will have a birthday in \" &amp; cel.Value &amp; \" days\"\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>You will get the messages whenever the worksheet is activated:</p>\n\n<p><a href=\"https://i.stack.imgur.com/n8Duv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n8Duv.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 3320497, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e353c7b0709a59a68f29b012256b89cc?s=128&d=identicon&r=PG&f=1", "display_name": "Behedwin", "link": "https://stackoverflow.com/users/3320497/behedwin"}, "is_accepted": false, "score": 0, "last_activity_date": 1464123022, "creation_date": 1464123022, "answer_id": 37423628, "question_id": 37422748, "link": "https://stackoverflow.com/questions/37422748/vba-msgbox-10-days-before-a-birthday/37423628#37423628", "title": "VBA - msgbox 10 days before a birthday", "body": "<p>I think i figured out a way to do what i wanted.</p>\n\n<p>Thanks for your kind commends btw.</p>\n\n<p>Below is the code that i got to work. But for it to work i had to first take the birthdate and devide it up into three cells, day, month and year.\nthen i again combine day and month but not the year, instead i used the year(now()) and got the birthdate this year.</p>\n\n<p>then i could use below code to add 1-10 days with dateadd.</p>\n\n<p>this feels a bit clumsy... but so far i think it will work.</p>\n\n<pre><code>Sub checkearlybirthday()\nDim ans As String\nDim cell As Range\n\nFor Each cell In Sheets(\"Personal\").Range(\"rf10:rf500\")\n    If cell = DateAdd(\"d\", 1, Date) Or cell = DateAdd(\"d\", 2, Date) Or cell = DateAdd(\"d\", 3, Date) Or cell = DateAdd(\"d\", 4, Date) Or cell = DateAdd(\"d\", 5, Date) Or cell = DateAdd(\"d\", 6, Date) Or cell = DateAdd(\"d\", 7, Date) Or cell = DateAdd(\"d\", 8, Date) Or cell = DateAdd(\"d\", 9, Date) Or cell = DateAdd(\"d\", 10, Date) Then\n        ans = ans &amp; vbNewLine &amp; Sheets(\"Personal\").Cells(cell.Row, 2).Value\n    End If\nNext\n\nIf Len(ans) &lt; 1 Then\n\nElse\n    MsgBox \"Hall\u00e5! \" &amp; vbNewLine &amp; \"Det \u00e4r 10 dagar eller mindre till dessa fyller \u00e5r. \" &amp; ans &amp; \"  \" &amp; vbNewLine &amp; \"\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 27, "user_id": 3320497, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e353c7b0709a59a68f29b012256b89cc?s=128&d=identicon&r=PG&f=1", "display_name": "Behedwin", "link": "https://stackoverflow.com/users/3320497/behedwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1916, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1464123022, "creation_date": 1464119856, "question_id": 37422748, "link": "https://stackoverflow.com/questions/37422748/vba-msgbox-10-days-before-a-birthday", "title": "VBA - msgbox 10 days before a birthday", "body": "<p>In sheet1 in column B i have names In sheet 1 in column D i have birthday dates</p>\n\n<pre><code>B:\nBen\nMikael\n\nD:\n3 MARCH 1987\n3 JUNE 1976\n</code></pre>\n\n<p>I want to find a VBA script to make a popup msgbox and print out \"There is 10 days or less untill NAME(from column B) have a birthday\".</p>\n\n<p>How can this be done?</p>\n"}, {"tags": ["vba", "excel", "vbscript", "macros", "hta"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464122293, "post_id": 37422687, "comment_id": 62352060, "body": "Where <b>exactly</b> in the workbook is the <code>RefreshConns</code> routine located?"}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464122508, "post_id": 37422687, "comment_id": 62352168, "body": "@Rory it&#39;s within a module in the VBAProject folder of the workbook"}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464122741, "post_id": 37422687, "comment_id": 62352277, "body": "@Rory Sorry, it&#39;s &quot;Module2&quot;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464122864, "post_id": 37422687, "comment_id": 62352344, "body": "Does it work if you use <code>objExcel.Run &quot;Scorecard.xlsm!Module2.RefreshConns&quot;</code>?"}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464123304, "post_id": 37422687, "comment_id": 62352606, "body": "@Rory No, it thinks that the workbook is in &quot;Documents&quot;. I tried: &quot;objExcel.Run &quot;objWorkbook!Module2.RefreshConns&quot; which references my direct path and that didn&#39;t work either."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464123522, "post_id": 37422687, "comment_id": 62352717, "body": "What do you mean &quot;it thinks the workbook is in Documents&quot;? Where does it say that?"}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464123659, "post_id": 37422687, "comment_id": 62352798, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/112832/discussion-between-midiman-and-rory\">continue this discussion in chat</a>."}, {"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1464124347, "post_id": 37422687, "comment_id": 62353159, "body": "@Rory please disregard my previous message. I am getting the same error as above. &quot;Cannot run the macro...&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "edited": false, "score": 0, "creation_date": 1466433346, "post_id": 37748823, "comment_id": 63300907, "body": "As I know longer have access to the VBS I can&#39;t test if this works or not but I&#39;ll make note of it should I be tasked with updating it again. Much appreciated."}], "tags": [], "owner": {"reputation": 67, "user_id": 3909735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YF2Tm.jpg?s=128&g=1", "display_name": "Dinesh Jeedimetla", "link": "https://stackoverflow.com/users/3909735/dinesh-jeedimetla"}, "is_accepted": false, "score": 2, "last_activity_date": 1465563239, "creation_date": 1465563239, "answer_id": 37748823, "question_id": 37422687, "link": "https://stackoverflow.com/questions/37422687/vbs-that-triggers-a-macro-via-hta-cannot-run-the-macro/37748823#37748823", "title": "VBS that triggers a macro via HTA (Cannot run the macro)", "body": "<p>objWorkbook.RunAutoMacros(1)</p>\n\n<p>Include above line of code in HTA code before the objExcel.Run \"RefreshConns\" line.</p>\n"}], "owner": {"reputation": 109, "user_id": 3930324, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d11c85203d3d0654318673e43004a748?s=128&d=identicon&r=PG&f=1", "display_name": "midiman", "link": "https://stackoverflow.com/users/3930324/midiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465563239, "creation_date": 1464119622, "question_id": 37422687, "link": "https://stackoverflow.com/questions/37422687/vbs-that-triggers-a-macro-via-hta-cannot-run-the-macro", "title": "VBS that triggers a macro via HTA (Cannot run the macro)", "body": "<p>I have a HTA script which ultimately triggers the vbs portion of the code to call a VBA macro but for some reason I'm getting this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5HVvu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5HVvu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I've already made sure that Trust access to VBA is enabled so I feel like it's something in my code that isn't HTA compatible. Here is the code: Thank you in advance for you time.</p>\n\n<pre><code>&lt;html&gt;\n &lt;title&gt;Report Generation&lt;/title&gt;\n&lt;head&gt;\n&lt;HTA:APPLICATION \n APPLICATIONNAME=\"Report Generation\"\n ID=\"objHTA\"  \n SCROLL=\"yes\"\n SINGLEINSTANCE=\"yes\"\n WINDOWSTATE=\"normal\"&gt;\n&lt;/head&gt;\n\n&lt;style&gt;\nBODY\n{\nbackground-color: buttonface;\nFont: arial,sans-serif\nmargin-top: 10px;\nmargin-left: 20px;\nmargin-right: 20px;\nmargin-bottom: 5px;\n}\n.button\n{\nwidth: 91px;\nheight: 25px;\nfont-family: arial,sans-serif;\nfont-size: 8pt;\n}\ntd\n{\nfont-family: arial,sans-serif;\nfont-size: 10pt;\n}                     \n#scroll\n{\nheight:100%;\noverflow:auto;\n}\nSELECT.FixedWidth \n{\nwidth: 17em;  /* maybe use px for pixels or pt for points here */\n}\n&lt;/style&gt;\n\n&lt;script language=\"vbscript\"&gt;\nOption Explicit    \n\nDim WinWidth : WinWidth = 350\nDim WinHeight : WinHeight = 250\nWindow.ResizeTo WinWidth, WinHeight\n\n\nSub Sleep(lngDelay)\n  CreateObject(\"WScript.Shell\").Run \"Timeout /T \" &amp; lngDelay &amp; \" /nobreak\", 0, True\nEnd Sub\n\nSub CheckBoxChange\n  If CheckBox(0).Checked Then\n  ExecuteScoreCard\n  Else\n  MsgBox \"CheckBox is not checked\"\n  End If\nEnd Sub\n\nSub ExecuteScoreCard() \n  Dim sitecode\n  Dim objExcel  \n  Dim objWorkbook\n  Dim objSheet\n\n  dim fso: set fso = CreateObject(\"Scripting.FileSystemObject\")\n  dim path: path = fso.GetAbsolutePathName(\".\")\n\n  Set objExcel = CreateObject(\"Excel.Application\")\n  Set objWorkbook = objExcel.Workbooks.Open(path &amp; \"\\Scorecard.xlsm\")\n  Set objSheet = objWorkbook.Worksheets(\"Cover Tab\") \n\n  sitecode = document.getElementById(\"sitecode\").value\n\n  objSheet.Cells(4, 2) = sitecode\n  objExcel.Run \"RefreshConns\"\n  Sleep 75 \n\n  objExcel.ActiveWorkbook.SaveAs path &amp; \"\\Scorecards\\\" &amp; \"Scorecard_\" &amp; sitecode &amp; \"_\" &amp; Year(Now()) &amp; Month(Now()) &amp; Day(Now()) &amp; \"_\" &amp; Hour(Now()) &amp; Minute(Now()) &amp;\".xlsm\", 52\n  objExcel.ActiveWorkbook.Close\n  objExcel.Quit   \n\n  MsgBox(\"Successfully generated scorecard.\")\n\nEnd Sub \n\n Sub ExitProgram\n  window.close()\n End Sub\n\n&lt;/script&gt;\n\n&lt;body&gt;\n  Site Code: &lt;input type=\"inputbox\" name=\"sitecode\" id=\"sitecode\"&gt;\n&lt;br&gt;\n  &lt;input type=\"checkbox\" name=\"CheckBox\"&gt; Scorecard\n&lt;br&gt;\n  &lt;input type=\"checkbox\" name=\"CheckBox\"&gt; Report2\n&lt;br&gt;\n  &lt;input type=\"checkbox\" name=\"CheckBox\"&gt; Report3\n&lt;br&gt;\n&lt;br&gt;\n  &lt;input type=\"submit\" name=\"accept\" value=\"Submit\" onclick=\"CheckBoxChange\"&gt;\n  &lt;input type=\"button\" value=\"Exit\" onClick=\"ExitProgram\"&gt;\n&lt;/body&gt;\n&lt;/html&gt; \n</code></pre>\n"}]